<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /auth/ldap/auth.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Aug 11 10:00:09 2016 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='auth/ldap';
filename='auth.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/auth/ldap/</a> -> <a href="auth.php.html">auth.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="auth.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="auth.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * Authentication Plugin: LDAP Authentication</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> * Authentication using LDAP (Lightweight Directory Access Protocol).</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> *</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @package auth_ldap</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @author Martin Dougiamas</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * @author IÃ±aki Arenaza</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> * @license http://www.gnu.org/copyleft/gpl.html GNU Public License</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment"> */</span>
<a name="l26"><span class="linenum">  26</span></a>  
<a name="l27"><span class="linenum">  27</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die();
<a name="l28"><span class="linenum">  28</span></a>  
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment">// See http://support.microsoft.com/kb/305144 to interprete these values.</span>
<a name="l30"><span class="linenum">  30</span></a>  if (!<a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('AUTH_AD_ACCOUNTDISABLE')" href="../../_constants/AUTH_AD_ACCOUNTDISABLE.html" onMouseOver="constPopup(event,'AUTH_AD_ACCOUNTDISABLE')">AUTH_AD_ACCOUNTDISABLE</a>')) {
<a name="l31"><span class="linenum">  31</span></a>      <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('AUTH_AD_ACCOUNTDISABLE')" href="../../_constants/AUTH_AD_ACCOUNTDISABLE.html" onMouseOver="constPopup(event,'AUTH_AD_ACCOUNTDISABLE')">AUTH_AD_ACCOUNTDISABLE</a>', 0x0002);
<a name="l32"><span class="linenum">  32</span></a>  }
<a name="l33"><span class="linenum">  33</span></a>  if (!<a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('AUTH_AD_NORMAL_ACCOUNT')" href="../../_constants/AUTH_AD_NORMAL_ACCOUNT.html" onMouseOver="constPopup(event,'AUTH_AD_NORMAL_ACCOUNT')">AUTH_AD_NORMAL_ACCOUNT</a>')) {
<a name="l34"><span class="linenum">  34</span></a>      <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('AUTH_AD_NORMAL_ACCOUNT')" href="../../_constants/AUTH_AD_NORMAL_ACCOUNT.html" onMouseOver="constPopup(event,'AUTH_AD_NORMAL_ACCOUNT')">AUTH_AD_NORMAL_ACCOUNT</a>', 0x0200);
<a name="l35"><span class="linenum">  35</span></a>  }
<a name="l36"><span class="linenum">  36</span></a>  if (!<a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('AUTH_NTLMTIMEOUT')" href="../../_constants/AUTH_NTLMTIMEOUT.html" onMouseOver="constPopup(event,'AUTH_NTLMTIMEOUT')">AUTH_NTLMTIMEOUT</a>')) {  // timewindow for the NTLM SSO process, in secs...
<a name="l37"><span class="linenum">  37</span></a>      <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('AUTH_NTLMTIMEOUT')" href="../../_constants/AUTH_NTLMTIMEOUT.html" onMouseOver="constPopup(event,'AUTH_NTLMTIMEOUT')">AUTH_NTLMTIMEOUT</a>', 10);
<a name="l38"><span class="linenum">  38</span></a>  }
<a name="l39"><span class="linenum">  39</span></a>  
<a name="l40"><span class="linenum">  40</span></a>  <span class="comment">// UF_DONT_EXPIRE_PASSWD value taken from MSDN directly</span>
<a name="l41"><span class="linenum">  41</span></a>  if (!<a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('UF_DONT_EXPIRE_PASSWD')" href="../../_constants/UF_DONT_EXPIRE_PASSWD.html" onMouseOver="constPopup(event,'UF_DONT_EXPIRE_PASSWD')">UF_DONT_EXPIRE_PASSWD</a>')) {
<a name="l42"><span class="linenum">  42</span></a>      <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a> ('<a class="constant" onClick="logConstant('UF_DONT_EXPIRE_PASSWD')" href="../../_constants/UF_DONT_EXPIRE_PASSWD.html" onMouseOver="constPopup(event,'UF_DONT_EXPIRE_PASSWD')">UF_DONT_EXPIRE_PASSWD</a>', 0x00010000);
<a name="l43"><span class="linenum">  43</span></a>  }
<a name="l44"><span class="linenum">  44</span></a>  
<a name="l45"><span class="linenum">  45</span></a>  <span class="comment">// The Posix uid and gid of the 'nobody' account and 'nogroup' group.</span>
<a name="l46"><span class="linenum">  46</span></a>  if (!<a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('AUTH_UID_NOBODY')" href="../../_constants/AUTH_UID_NOBODY.html" onMouseOver="constPopup(event,'AUTH_UID_NOBODY')">AUTH_UID_NOBODY</a>')) {
<a name="l47"><span class="linenum">  47</span></a>      <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('AUTH_UID_NOBODY')" href="../../_constants/AUTH_UID_NOBODY.html" onMouseOver="constPopup(event,'AUTH_UID_NOBODY')">AUTH_UID_NOBODY</a>', -2);
<a name="l48"><span class="linenum">  48</span></a>  }
<a name="l49"><span class="linenum">  49</span></a>  if (!<a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('AUTH_GID_NOGROUP')" href="../../_constants/AUTH_GID_NOGROUP.html" onMouseOver="constPopup(event,'AUTH_GID_NOGROUP')">AUTH_GID_NOGROUP</a>')) {
<a name="l50"><span class="linenum">  50</span></a>      <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('AUTH_GID_NOGROUP')" href="../../_constants/AUTH_GID_NOGROUP.html" onMouseOver="constPopup(event,'AUTH_GID_NOGROUP')">AUTH_GID_NOGROUP</a>', -2);
<a name="l51"><span class="linenum">  51</span></a>  }
<a name="l52"><span class="linenum">  52</span></a>  
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment">// Regular expressions for a valid NTLM username and domain name.</span>
<a name="l54"><span class="linenum">  54</span></a>  if (!<a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('AUTH_NTLM_VALID_USERNAME')" href="../../_constants/AUTH_NTLM_VALID_USERNAME.html" onMouseOver="constPopup(event,'AUTH_NTLM_VALID_USERNAME')">AUTH_NTLM_VALID_USERNAME</a>')) {
<a name="l55"><span class="linenum">  55</span></a>      <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('AUTH_NTLM_VALID_USERNAME')" href="../../_constants/AUTH_NTLM_VALID_USERNAME.html" onMouseOver="constPopup(event,'AUTH_NTLM_VALID_USERNAME')">AUTH_NTLM_VALID_USERNAME</a>', '[^/\\\\\\\\\[\]:;|=,+*?&lt;&gt;@&quot;]+');
<a name="l56"><span class="linenum">  56</span></a>  }
<a name="l57"><span class="linenum">  57</span></a>  if (!<a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('AUTH_NTLM_VALID_DOMAINNAME')" href="../../_constants/AUTH_NTLM_VALID_DOMAINNAME.html" onMouseOver="constPopup(event,'AUTH_NTLM_VALID_DOMAINNAME')">AUTH_NTLM_VALID_DOMAINNAME</a>')) {
<a name="l58"><span class="linenum">  58</span></a>      <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('AUTH_NTLM_VALID_DOMAINNAME')" href="../../_constants/AUTH_NTLM_VALID_DOMAINNAME.html" onMouseOver="constPopup(event,'AUTH_NTLM_VALID_DOMAINNAME')">AUTH_NTLM_VALID_DOMAINNAME</a>', '[^\\\\\\\\\/:*?&quot;&lt;&gt;|]+');
<a name="l59"><span class="linenum">  59</span></a>  }
<a name="l60"><span class="linenum">  60</span></a>  <span class="comment">// Default format for remote users if using NTLM SSO</span>
<a name="l61"><span class="linenum">  61</span></a>  if (!<a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('AUTH_NTLM_DEFAULT_FORMAT')" href="../../_constants/AUTH_NTLM_DEFAULT_FORMAT.html" onMouseOver="constPopup(event,'AUTH_NTLM_DEFAULT_FORMAT')">AUTH_NTLM_DEFAULT_FORMAT</a>')) {
<a name="l62"><span class="linenum">  62</span></a>      <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('AUTH_NTLM_DEFAULT_FORMAT')" href="../../_constants/AUTH_NTLM_DEFAULT_FORMAT.html" onMouseOver="constPopup(event,'AUTH_NTLM_DEFAULT_FORMAT')">AUTH_NTLM_DEFAULT_FORMAT</a>', '%domain%\\%username%');
<a name="l63"><span class="linenum">  63</span></a>  }
<a name="l64"><span class="linenum">  64</span></a>  if (!<a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('AUTH_NTLM_FASTPATH_ATTEMPT')" href="../../_constants/AUTH_NTLM_FASTPATH_ATTEMPT.html" onMouseOver="constPopup(event,'AUTH_NTLM_FASTPATH_ATTEMPT')">AUTH_NTLM_FASTPATH_ATTEMPT</a>')) {
<a name="l65"><span class="linenum">  65</span></a>      <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('AUTH_NTLM_FASTPATH_ATTEMPT')" href="../../_constants/AUTH_NTLM_FASTPATH_ATTEMPT.html" onMouseOver="constPopup(event,'AUTH_NTLM_FASTPATH_ATTEMPT')">AUTH_NTLM_FASTPATH_ATTEMPT</a>', 0);
<a name="l66"><span class="linenum">  66</span></a>  }
<a name="l67"><span class="linenum">  67</span></a>  if (!<a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('AUTH_NTLM_FASTPATH_YESFORM')" href="../../_constants/AUTH_NTLM_FASTPATH_YESFORM.html" onMouseOver="constPopup(event,'AUTH_NTLM_FASTPATH_YESFORM')">AUTH_NTLM_FASTPATH_YESFORM</a>')) {
<a name="l68"><span class="linenum">  68</span></a>      <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('AUTH_NTLM_FASTPATH_YESFORM')" href="../../_constants/AUTH_NTLM_FASTPATH_YESFORM.html" onMouseOver="constPopup(event,'AUTH_NTLM_FASTPATH_YESFORM')">AUTH_NTLM_FASTPATH_YESFORM</a>', 1);
<a name="l69"><span class="linenum">  69</span></a>  }
<a name="l70"><span class="linenum">  70</span></a>  if (!<a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('AUTH_NTLM_FASTPATH_YESATTEMPT')" href="../../_constants/AUTH_NTLM_FASTPATH_YESATTEMPT.html" onMouseOver="constPopup(event,'AUTH_NTLM_FASTPATH_YESATTEMPT')">AUTH_NTLM_FASTPATH_YESATTEMPT</a>')) {
<a name="l71"><span class="linenum">  71</span></a>      <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('AUTH_NTLM_FASTPATH_YESATTEMPT')" href="../../_constants/AUTH_NTLM_FASTPATH_YESATTEMPT.html" onMouseOver="constPopup(event,'AUTH_NTLM_FASTPATH_YESATTEMPT')">AUTH_NTLM_FASTPATH_YESATTEMPT</a>', 2);
<a name="l72"><span class="linenum">  72</span></a>  }
<a name="l73"><span class="linenum">  73</span></a>  
<a name="l74"><span class="linenum">  74</span></a>  <span class="comment">// Allows us to retrieve a diagnostic message in case of LDAP operation error</span>
<a name="l75"><span class="linenum">  75</span></a>  if (!<a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('LDAP_OPT_DIAGNOSTIC_MESSAGE')" href="../../_constants/LDAP_OPT_DIAGNOSTIC_MESSAGE.html" onMouseOver="constPopup(event,'LDAP_OPT_DIAGNOSTIC_MESSAGE')">LDAP_OPT_DIAGNOSTIC_MESSAGE</a>')) {
<a name="l76"><span class="linenum">  76</span></a>      <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LDAP_OPT_DIAGNOSTIC_MESSAGE')" href="../../_constants/LDAP_OPT_DIAGNOSTIC_MESSAGE.html" onMouseOver="constPopup(event,'LDAP_OPT_DIAGNOSTIC_MESSAGE')">LDAP_OPT_DIAGNOSTIC_MESSAGE</a>', 0x0032);
<a name="l77"><span class="linenum">  77</span></a>  }
<a name="l78"><span class="linenum">  78</span></a>  
<a name="l79"><span class="linenum">  79</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a>.'/authlib.php');
<a name="l80"><span class="linenum">  80</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a>.'/ldaplib.php');
<a name="l81"><span class="linenum">  81</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../user/lib.php.html">/user/lib.php</a>');
<a name="l82"><span class="linenum">  82</span></a>  
<a name="l83"><span class="linenum">  83</span></a>  <span class="comment">/**</span>
<a name="l84"><span class="linenum">  84</span></a>  <span class="comment"> * LDAP authentication plugin.</span>
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment"> */</span>
<a name="l86"><span class="linenum">  86</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('auth_plugin_ldap')" href="../../_classes/auth_plugin_ldap.html" onMouseOver="classPopup(event,'auth_plugin_ldap')">auth_plugin_ldap</a> <span class="keyword">extends</span> <a class="class" onClick="logClass('auth_plugin_base')" href="../../_classes/auth_plugin_base.html" onMouseOver="classPopup(event,'auth_plugin_base')">auth_plugin_base</a> {
<a name="l87"><span class="linenum">  87</span></a>  
<a name="l88"><span class="linenum">  88</span></a>      <span class="comment">/**</span>
<a name="l89"><span class="linenum">  89</span></a>  <span class="comment">     * Init plugin config from database settings depending on the plugin auth type.</span>
<a name="l90"><span class="linenum">  90</span></a>  <span class="comment">     */</span>
<a name="l91"><span class="linenum">  91</span></a>      function <a class="function" onClick="logFunction('init_plugin')" href="../../_functions/init_plugin.html" onMouseOver="funcPopup(event,'init_plugin')">init_plugin</a>(<a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('authtype')" href="../../_variables/authtype.html">$authtype</a>) {
<a name="l92"><span class="linenum">  92</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a> = 'auth/'.<a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('authtype')" href="../../_variables/authtype.html">$authtype</a>;
<a name="l93"><span class="linenum">  93</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a> = <a class="function" onClick="logFunction('get_config')" href="../../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l94"><span class="linenum">  94</span></a>          if (empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding)) {
<a name="l95"><span class="linenum">  95</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding = 'utf-8';
<a name="l96"><span class="linenum">  96</span></a>          }
<a name="l97"><span class="linenum">  97</span></a>          if (empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_type)) {
<a name="l98"><span class="linenum">  98</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_type = 'default';
<a name="l99"><span class="linenum">  99</span></a>          }
<a name="l100"><span class="linenum"> 100</span></a>  
<a name="l101"><span class="linenum"> 101</span></a>          <a class="var it24468" onMouseOver="hilite(24468)" onMouseOut="lolite()" onClick="logVariable('ldap_usertypes')" href="../../_variables/ldap_usertypes.html">$ldap_usertypes</a> = <a class="function" onClick="logFunction('ldap_supported_usertypes')" href="../../_functions/ldap_supported_usertypes.html" onMouseOver="funcPopup(event,'ldap_supported_usertypes')">ldap_supported_usertypes</a>();
<a name="l102"><span class="linenum"> 102</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_type_name = <a class="var it24468" onMouseOver="hilite(24468)" onMouseOut="lolite()" onClick="logVariable('ldap_usertypes')" href="../../_variables/ldap_usertypes.html">$ldap_usertypes</a>[<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_type];
<a name="l103"><span class="linenum"> 103</span></a>          unset(<a class="var it24468" onMouseOver="hilite(24468)" onMouseOut="lolite()" onClick="logVariable('ldap_usertypes')" href="../../_variables/ldap_usertypes.html">$ldap_usertypes</a>);
<a name="l104"><span class="linenum"> 104</span></a>  
<a name="l105"><span class="linenum"> 105</span></a>          <a class="var it777" onMouseOver="hilite(777)" onMouseOut="lolite()" onClick="logVariable('default')" href="../../_variables/default.html">$default</a> = <a class="function" onClick="logFunction('ldap_getdefaults')" href="../../_functions/ldap_getdefaults.html" onMouseOver="funcPopup(event,'ldap_getdefaults')">ldap_getdefaults</a>();
<a name="l106"><span class="linenum"> 106</span></a>  
<a name="l107"><span class="linenum"> 107</span></a>  <span class="comment">        // Use defaults if values not given</span>
<a name="l108"><span class="linenum"> 108</span></a>          foreach (<a class="var it777" onMouseOver="hilite(777)" onMouseOut="lolite()" onClick="logVariable('default')" href="../../_variables/default.html">$default</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l109"><span class="linenum"> 109</span></a>  <span class="comment">            // watch out - 0, false are correct values too</span>
<a name="l110"><span class="linenum"> 110</span></a>              if (!isset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;{<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>}) or <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;{<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>} == '') {
<a name="l111"><span class="linenum"> 111</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;{<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>} = <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>[<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_type];
<a name="l112"><span class="linenum"> 112</span></a>              }
<a name="l113"><span class="linenum"> 113</span></a>          }
<a name="l114"><span class="linenum"> 114</span></a>  
<a name="l115"><span class="linenum"> 115</span></a>  <span class="comment">        // Hack prefix to objectclass</span>
<a name="l116"><span class="linenum"> 116</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;objectclass = <a class="function" onClick="logFunction('ldap_normalise_objectclass')" href="../../_functions/ldap_normalise_objectclass.html" onMouseOver="funcPopup(event,'ldap_normalise_objectclass')">ldap_normalise_objectclass</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;objectclass);
<a name="l117"><span class="linenum"> 117</span></a>      }
<a name="l118"><span class="linenum"> 118</span></a>  
<a name="l119"><span class="linenum"> 119</span></a>      <span class="comment">/**</span>
<a name="l120"><span class="linenum"> 120</span></a>  <span class="comment">     * Constructor with initialisation.</span>
<a name="l121"><span class="linenum"> 121</span></a>  <span class="comment">     */</span>
<a name="l122"><span class="linenum"> 122</span></a>      public function <a class="function" onClick="logFunction('__construct')" href="../../_functions/__construct.html" onMouseOver="funcPopup(event,'__construct')">__construct</a>() {
<a name="l123"><span class="linenum"> 123</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('authtype')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/authtype.html">authtype</a> = 'ldap';
<a name="l124"><span class="linenum"> 124</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('roleauth')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/roleauth.html">roleauth</a> = 'auth_ldap';
<a name="l125"><span class="linenum"> 125</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a> = '[AUTH LDAP] ';
<a name="l126"><span class="linenum"> 126</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('init_plugin')" href="../../_functions/init_plugin.html" onMouseOver="funcPopup(event,'init_plugin')">init_plugin</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('authtype')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/authtype.html">authtype</a>);
<a name="l127"><span class="linenum"> 127</span></a>      }
<a name="l128"><span class="linenum"> 128</span></a>  
<a name="l129"><span class="linenum"> 129</span></a>      <span class="comment">/**</span>
<a name="l130"><span class="linenum"> 130</span></a>  <span class="comment">     * Old syntax of class constructor. Deprecated in PHP7.</span>
<a name="l131"><span class="linenum"> 131</span></a>  <span class="comment">     *</span>
<a name="l132"><span class="linenum"> 132</span></a>  <span class="comment">     * @deprecated since Moodle 3.1</span>
<a name="l133"><span class="linenum"> 133</span></a>  <span class="comment">     */</span>
<a name="l134"><span class="linenum"> 134</span></a>      public function <a class="function" onClick="logFunction('auth_plugin_ldap')" href="../../_functions/auth_plugin_ldap.html" onMouseOver="funcPopup(event,'auth_plugin_ldap')">auth_plugin_ldap</a>() {
<a name="l135"><span class="linenum"> 135</span></a>          <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Use of class name as constructor is deprecated', <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l136"><span class="linenum"> 136</span></a>          self::<a class="function" onClick="logFunction('__construct')" href="../../_functions/__construct.html" onMouseOver="funcPopup(event,'__construct')">__construct</a>();
<a name="l137"><span class="linenum"> 137</span></a>      }
<a name="l138"><span class="linenum"> 138</span></a>  
<a name="l139"><span class="linenum"> 139</span></a>      <span class="comment">/**</span>
<a name="l140"><span class="linenum"> 140</span></a>  <span class="comment">     * Returns true if the username and password work and false if they are</span>
<a name="l141"><span class="linenum"> 141</span></a>  <span class="comment">     * wrong or don't exist.</span>
<a name="l142"><span class="linenum"> 142</span></a>  <span class="comment">     *</span>
<a name="l143"><span class="linenum"> 143</span></a>  <span class="comment">     * @param string $username The username (without system magic quotes)</span>
<a name="l144"><span class="linenum"> 144</span></a>  <span class="comment">     * @param string $password The password (without system magic quotes)</span>
<a name="l145"><span class="linenum"> 145</span></a>  <span class="comment">     *</span>
<a name="l146"><span class="linenum"> 146</span></a>  <span class="comment">     * @return bool Authentication success or failure.</span>
<a name="l147"><span class="linenum"> 147</span></a>  <span class="comment">     */</span>
<a name="l148"><span class="linenum"> 148</span></a>      function <a class="function" onClick="logFunction('user_login')" href="../../_functions/user_login.html" onMouseOver="funcPopup(event,'user_login')">user_login</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, <a class="var it201" onMouseOver="hilite(201)" onMouseOut="lolite()" onClick="logVariable('password')" href="../../_variables/password.html">$password</a>) {
<a name="l149"><span class="linenum"> 149</span></a>          if (! <a class="phpfunction" onClick="logFunction('function_exists')" href="../../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>('ldap_bind')) {
<a name="l150"><span class="linenum"> 150</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('auth_ldapnotinstalled', 'auth_ldap');
<a name="l151"><span class="linenum"> 151</span></a>              return false;
<a name="l152"><span class="linenum"> 152</span></a>          }
<a name="l153"><span class="linenum"> 153</span></a>  
<a name="l154"><span class="linenum"> 154</span></a>          if (!<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a> or !<a class="var it201" onMouseOver="hilite(201)" onMouseOut="lolite()" onClick="logVariable('password')" href="../../_variables/password.html">$password</a>) {    // Don't allow blank usernames or passwords
<a name="l155"><span class="linenum"> 155</span></a>              return false;
<a name="l156"><span class="linenum"> 156</span></a>          }
<a name="l157"><span class="linenum"> 157</span></a>  
<a name="l158"><span class="linenum"> 158</span></a>          <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, 'utf-8', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding);
<a name="l159"><span class="linenum"> 159</span></a>          <a class="var it33956" onMouseOver="hilite(33956)" onMouseOut="lolite()" onClick="logVariable('extpassword')" href="../../_variables/extpassword.html">$extpassword</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it201" onMouseOver="hilite(201)" onMouseOut="lolite()" onClick="logVariable('password')" href="../../_variables/password.html">$password</a>, 'utf-8', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding);
<a name="l160"><span class="linenum"> 160</span></a>  
<a name="l161"><span class="linenum"> 161</span></a>  <span class="comment">        // Before we connect to LDAP, check if this is an AD SSO login</span>
<a name="l162"><span class="linenum"> 162</span></a>  <span class="comment">        // if we succeed in this block, we'll return success early.</span>
<a name="l163"><span class="linenum"> 163</span></a>  <span class="comment">        //</span>
<a name="l164"><span class="linenum"> 164</span></a>          <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <a class="function" onClick="logFunction('sesskey')" href="../../_functions/sesskey.html" onMouseOver="funcPopup(event,'sesskey')">sesskey</a>();
<a name="l165"><span class="linenum"> 165</span></a>          if (!empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ntlmsso_enabled) &amp;&amp; <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> === <a class="var it201" onMouseOver="hilite(201)" onMouseOut="lolite()" onClick="logVariable('password')" href="../../_variables/password.html">$password</a>) {
<a name="l166"><span class="linenum"> 166</span></a>              <a class="var it7104" onMouseOver="hilite(7104)" onMouseOut="lolite()" onClick="logVariable('cf')" href="../../_variables/cf.html">$cf</a> = <a class="function" onClick="logFunction('get_cache_flags')" href="../../_functions/get_cache_flags.html" onMouseOver="funcPopup(event,'get_cache_flags')">get_cache_flags</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>.'/ntlmsess');
<a name="l167"><span class="linenum"> 167</span></a>  <span class="comment">            // We only get the cache flag if we retrieve it before</span>
<a name="l168"><span class="linenum"> 168</span></a>  <span class="comment">            // it expires (AUTH_NTLMTIMEOUT seconds).</span>
<a name="l169"><span class="linenum"> 169</span></a>              if (!isset(<a class="var it7104" onMouseOver="hilite(7104)" onMouseOut="lolite()" onClick="logVariable('cf')" href="../../_variables/cf.html">$cf</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>]) || <a class="var it7104" onMouseOver="hilite(7104)" onMouseOut="lolite()" onClick="logVariable('cf')" href="../../_variables/cf.html">$cf</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>] === '') {
<a name="l170"><span class="linenum"> 170</span></a>                  return false;
<a name="l171"><span class="linenum"> 171</span></a>              }
<a name="l172"><span class="linenum"> 172</span></a>  
<a name="l173"><span class="linenum"> 173</span></a>              <a class="var it33957" onMouseOver="hilite(33957)" onMouseOut="lolite()" onClick="logVariable('sessusername')" href="../../_variables/sessusername.html">$sessusername</a> = <a class="var it7104" onMouseOver="hilite(7104)" onMouseOut="lolite()" onClick="logVariable('cf')" href="../../_variables/cf.html">$cf</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>];
<a name="l174"><span class="linenum"> 174</span></a>              if (<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a> === <a class="var it33957" onMouseOver="hilite(33957)" onMouseOut="lolite()" onClick="logVariable('sessusername')" href="../../_variables/sessusername.html">$sessusername</a>) {
<a name="l175"><span class="linenum"> 175</span></a>                  unset(<a class="var it33957" onMouseOver="hilite(33957)" onMouseOut="lolite()" onClick="logVariable('sessusername')" href="../../_variables/sessusername.html">$sessusername</a>);
<a name="l176"><span class="linenum"> 176</span></a>                  unset(<a class="var it7104" onMouseOver="hilite(7104)" onMouseOut="lolite()" onClick="logVariable('cf')" href="../../_variables/cf.html">$cf</a>);
<a name="l177"><span class="linenum"> 177</span></a>  
<a name="l178"><span class="linenum"> 178</span></a>  <span class="comment">                // Check that the user is inside one of the configured LDAP contexts</span>
<a name="l179"><span class="linenum"> 179</span></a>                  <a class="var it17929" onMouseOver="hilite(17929)" onMouseOut="lolite()" onClick="logVariable('validuser')" href="../../_variables/validuser.html">$validuser</a> = false;
<a name="l180"><span class="linenum"> 180</span></a>                  <a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="phpfunction" onClick="logFunction('ldap_connect')" href="../../_functions/ldap_connect.html" onMouseOver="phpfuncPopup(event,'ldap_connect')">ldap_connect</a>();
<a name="l181"><span class="linenum"> 181</span></a>  <span class="comment">                // if the user is not inside the configured contexts,</span>
<a name="l182"><span class="linenum"> 182</span></a>  <span class="comment">                // ldap_find_userdn returns false.</span>
<a name="l183"><span class="linenum"> 183</span></a>                  if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_find_userdn')" href="../../_functions/ldap_find_userdn.html" onMouseOver="funcPopup(event,'ldap_find_userdn')">ldap_find_userdn</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a>)) {
<a name="l184"><span class="linenum"> 184</span></a>                      <a class="var it17929" onMouseOver="hilite(17929)" onMouseOut="lolite()" onClick="logVariable('validuser')" href="../../_variables/validuser.html">$validuser</a> = true;
<a name="l185"><span class="linenum"> 185</span></a>                  }
<a name="l186"><span class="linenum"> 186</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_close')" href="../../_functions/ldap_close.html" onMouseOver="funcPopup(event,'ldap_close')">ldap_close</a>();
<a name="l187"><span class="linenum"> 187</span></a>  
<a name="l188"><span class="linenum"> 188</span></a>  <span class="comment">                // Shortcut here - SSO confirmed</span>
<a name="l189"><span class="linenum"> 189</span></a>                  return <a class="var it17929" onMouseOver="hilite(17929)" onMouseOut="lolite()" onClick="logVariable('validuser')" href="../../_variables/validuser.html">$validuser</a>;
<a name="l190"><span class="linenum"> 190</span></a>              }
<a name="l191"><span class="linenum"> 191</span></a>          } <span class="comment">// End SSO processing</span>
<a name="l192"><span class="linenum"> 192</span></a>          unset(<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>);
<a name="l193"><span class="linenum"> 193</span></a>  
<a name="l194"><span class="linenum"> 194</span></a>          <a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="phpfunction" onClick="logFunction('ldap_connect')" href="../../_functions/ldap_connect.html" onMouseOver="phpfuncPopup(event,'ldap_connect')">ldap_connect</a>();
<a name="l195"><span class="linenum"> 195</span></a>          <a class="var it33958" onMouseOver="hilite(33958)" onMouseOut="lolite()" onClick="logVariable('ldap_user_dn')" href="../../_variables/ldap_user_dn.html">$ldap_user_dn</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_find_userdn')" href="../../_functions/ldap_find_userdn.html" onMouseOver="funcPopup(event,'ldap_find_userdn')">ldap_find_userdn</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a>);
<a name="l196"><span class="linenum"> 196</span></a>  
<a name="l197"><span class="linenum"> 197</span></a>  <span class="comment">        // If ldap_user_dn is empty, user does not exist</span>
<a name="l198"><span class="linenum"> 198</span></a>          if (!<a class="var it33958" onMouseOver="hilite(33958)" onMouseOut="lolite()" onClick="logVariable('ldap_user_dn')" href="../../_variables/ldap_user_dn.html">$ldap_user_dn</a>) {
<a name="l199"><span class="linenum"> 199</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_close')" href="../../_functions/ldap_close.html" onMouseOver="funcPopup(event,'ldap_close')">ldap_close</a>();
<a name="l200"><span class="linenum"> 200</span></a>              return false;
<a name="l201"><span class="linenum"> 201</span></a>          }
<a name="l202"><span class="linenum"> 202</span></a>  
<a name="l203"><span class="linenum"> 203</span></a>  <span class="comment">        // Try to bind with current username and password</span>
<a name="l204"><span class="linenum"> 204</span></a>          <a class="var it33959" onMouseOver="hilite(33959)" onMouseOut="lolite()" onClick="logVariable('ldap_login')" href="../../_variables/ldap_login.html">$ldap_login</a> = @<a class="phpfunction" onClick="logFunction('ldap_bind')" href="../../_functions/ldap_bind.html" onMouseOver="phpfuncPopup(event,'ldap_bind')">ldap_bind</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33958" onMouseOver="hilite(33958)" onMouseOut="lolite()" onClick="logVariable('ldap_user_dn')" href="../../_variables/ldap_user_dn.html">$ldap_user_dn</a>, <a class="var it33956" onMouseOver="hilite(33956)" onMouseOut="lolite()" onClick="logVariable('extpassword')" href="../../_variables/extpassword.html">$extpassword</a>);
<a name="l205"><span class="linenum"> 205</span></a>  
<a name="l206"><span class="linenum"> 206</span></a>  <span class="comment">        // If login fails and we are using MS Active Directory, retrieve the diagnostic</span>
<a name="l207"><span class="linenum"> 207</span></a>  <span class="comment">        // message to see if this is due to an expired password, or that the user is forced to</span>
<a name="l208"><span class="linenum"> 208</span></a>  <span class="comment">        // change the password on first login. If it is, only proceed if we can change</span>
<a name="l209"><span class="linenum"> 209</span></a>  <span class="comment">        // password from Moodle (otherwise we'll get stuck later in the login process).</span>
<a name="l210"><span class="linenum"> 210</span></a>          if (!<a class="var it33959" onMouseOver="hilite(33959)" onMouseOut="lolite()" onClick="logVariable('ldap_login')" href="../../_variables/ldap_login.html">$ldap_login</a> &amp;&amp; (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_type == 'ad')
<a name="l211"><span class="linenum"> 211</span></a>              &amp;&amp; <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('can_change_password')" href="../../_functions/can_change_password.html" onMouseOver="funcPopup(event,'can_change_password')">can_change_password</a>()
<a name="l212"><span class="linenum"> 212</span></a>              &amp;&amp; (!empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;expiration) and (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;expiration == 1))) {
<a name="l213"><span class="linenum"> 213</span></a>  
<a name="l214"><span class="linenum"> 214</span></a>  <span class="comment">            // We need to get the diagnostic message right after the call to ldap_bind(),</span>
<a name="l215"><span class="linenum"> 215</span></a>  <span class="comment">            // before any other LDAP operation.</span>
<a name="l216"><span class="linenum"> 216</span></a>              <a class="phpfunction" onClick="logFunction('ldap_get_option')" href="../../_functions/ldap_get_option.html" onMouseOver="phpfuncPopup(event,'ldap_get_option')">ldap_get_option</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="constant" onClick="logConstant('LDAP_OPT_DIAGNOSTIC_MESSAGE')" href="../../_constants/LDAP_OPT_DIAGNOSTIC_MESSAGE.html" onMouseOver="constPopup(event,'LDAP_OPT_DIAGNOSTIC_MESSAGE')">LDAP_OPT_DIAGNOSTIC_MESSAGE</a>, <a class="var it33960" onMouseOver="hilite(33960)" onMouseOut="lolite()" onClick="logVariable('diagmsg')" href="../../_variables/diagmsg.html">$diagmsg</a>);
<a name="l217"><span class="linenum"> 217</span></a>  
<a name="l218"><span class="linenum"> 218</span></a>              if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_ad_pwdexpired_from_diagmsg')" href="../../_functions/ldap_ad_pwdexpired_from_diagmsg.html" onMouseOver="funcPopup(event,'ldap_ad_pwdexpired_from_diagmsg')">ldap_ad_pwdexpired_from_diagmsg</a>(<a class="var it33960" onMouseOver="hilite(33960)" onMouseOut="lolite()" onClick="logVariable('diagmsg')" href="../../_variables/diagmsg.html">$diagmsg</a>)) {
<a name="l219"><span class="linenum"> 219</span></a>  <span class="comment">                // If login failed because user must change the password now or the</span>
<a name="l220"><span class="linenum"> 220</span></a>  <span class="comment">                // password has expired, let the user in. We'll catch this later in the</span>
<a name="l221"><span class="linenum"> 221</span></a>  <span class="comment">                // login process when we explicitly check for expired passwords.</span>
<a name="l222"><span class="linenum"> 222</span></a>                  <a class="var it33959" onMouseOver="hilite(33959)" onMouseOut="lolite()" onClick="logVariable('ldap_login')" href="../../_variables/ldap_login.html">$ldap_login</a> = true;
<a name="l223"><span class="linenum"> 223</span></a>              }
<a name="l224"><span class="linenum"> 224</span></a>          }
<a name="l225"><span class="linenum"> 225</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_close')" href="../../_functions/ldap_close.html" onMouseOver="funcPopup(event,'ldap_close')">ldap_close</a>();
<a name="l226"><span class="linenum"> 226</span></a>          return <a class="var it33959" onMouseOver="hilite(33959)" onMouseOut="lolite()" onClick="logVariable('ldap_login')" href="../../_variables/ldap_login.html">$ldap_login</a>;
<a name="l227"><span class="linenum"> 227</span></a>      }
<a name="l228"><span class="linenum"> 228</span></a>  
<a name="l229"><span class="linenum"> 229</span></a>      <span class="comment">/**</span>
<a name="l230"><span class="linenum"> 230</span></a>  <span class="comment">     * Reads user information from ldap and returns it in array()</span>
<a name="l231"><span class="linenum"> 231</span></a>  <span class="comment">     *</span>
<a name="l232"><span class="linenum"> 232</span></a>  <span class="comment">     * Function should return all information available. If you are saving</span>
<a name="l233"><span class="linenum"> 233</span></a>  <span class="comment">     * this information to moodle user-table you should honor syncronization flags</span>
<a name="l234"><span class="linenum"> 234</span></a>  <span class="comment">     *</span>
<a name="l235"><span class="linenum"> 235</span></a>  <span class="comment">     * @param string $username username</span>
<a name="l236"><span class="linenum"> 236</span></a>  <span class="comment">     *</span>
<a name="l237"><span class="linenum"> 237</span></a>  <span class="comment">     * @return mixed array with no magic quotes or false on error</span>
<a name="l238"><span class="linenum"> 238</span></a>  <span class="comment">     */</span>
<a name="l239"><span class="linenum"> 239</span></a>      function <a class="function" onClick="logFunction('get_userinfo')" href="../../_functions/get_userinfo.html" onMouseOver="funcPopup(event,'get_userinfo')">get_userinfo</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>) {
<a name="l240"><span class="linenum"> 240</span></a>          <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, 'utf-8', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding);
<a name="l241"><span class="linenum"> 241</span></a>  
<a name="l242"><span class="linenum"> 242</span></a>          <a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="phpfunction" onClick="logFunction('ldap_connect')" href="../../_functions/ldap_connect.html" onMouseOver="phpfuncPopup(event,'ldap_connect')">ldap_connect</a>();
<a name="l243"><span class="linenum"> 243</span></a>          if(!(<a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_find_userdn')" href="../../_functions/ldap_find_userdn.html" onMouseOver="funcPopup(event,'ldap_find_userdn')">ldap_find_userdn</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a>))) {
<a name="l244"><span class="linenum"> 244</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_close')" href="../../_functions/ldap_close.html" onMouseOver="funcPopup(event,'ldap_close')">ldap_close</a>();
<a name="l245"><span class="linenum"> 245</span></a>              return false;
<a name="l246"><span class="linenum"> 246</span></a>          }
<a name="l247"><span class="linenum"> 247</span></a>  
<a name="l248"><span class="linenum"> 248</span></a>          <a class="var it23949" onMouseOver="hilite(23949)" onMouseOut="lolite()" onClick="logVariable('search_attribs')" href="../../_variables/search_attribs.html">$search_attribs</a> = array();
<a name="l249"><span class="linenum"> 249</span></a>          <a class="var it23948" onMouseOver="hilite(23948)" onMouseOut="lolite()" onClick="logVariable('attrmap')" href="../../_variables/attrmap.html">$attrmap</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_attributes')" href="../../_functions/ldap_attributes.html" onMouseOver="funcPopup(event,'ldap_attributes')">ldap_attributes</a>();
<a name="l250"><span class="linenum"> 250</span></a>          foreach (<a class="var it23948" onMouseOver="hilite(23948)" onMouseOut="lolite()" onClick="logVariable('attrmap')" href="../../_variables/attrmap.html">$attrmap</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>) {
<a name="l251"><span class="linenum"> 251</span></a>              if (!<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>)) {
<a name="l252"><span class="linenum"> 252</span></a>                  <a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a> = array(<a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>);
<a name="l253"><span class="linenum"> 253</span></a>              }
<a name="l254"><span class="linenum"> 254</span></a>              foreach (<a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a> as <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l255"><span class="linenum"> 255</span></a>                  if (!<a class="phpfunction" onClick="logFunction('in_array')" href="../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>, <a class="var it23949" onMouseOver="hilite(23949)" onMouseOut="lolite()" onClick="logVariable('search_attribs')" href="../../_variables/search_attribs.html">$search_attribs</a>)) {
<a name="l256"><span class="linenum"> 256</span></a>                      <a class="phpfunction" onClick="logFunction('array_push')" href="../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>(<a class="var it23949" onMouseOver="hilite(23949)" onMouseOut="lolite()" onClick="logVariable('search_attribs')" href="../../_variables/search_attribs.html">$search_attribs</a>, <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>);
<a name="l257"><span class="linenum"> 257</span></a>                  }
<a name="l258"><span class="linenum"> 258</span></a>              }
<a name="l259"><span class="linenum"> 259</span></a>          }
<a name="l260"><span class="linenum"> 260</span></a>  
<a name="l261"><span class="linenum"> 261</span></a>          if (!<a class="var it33962" onMouseOver="hilite(33962)" onMouseOut="lolite()" onClick="logVariable('user_info_result')" href="../../_variables/user_info_result.html">$user_info_result</a> = <a class="phpfunction" onClick="logFunction('ldap_read')" href="../../_functions/ldap_read.html" onMouseOver="phpfuncPopup(event,'ldap_read')">ldap_read</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>, '(objectClass=*)', <a class="var it23949" onMouseOver="hilite(23949)" onMouseOut="lolite()" onClick="logVariable('search_attribs')" href="../../_variables/search_attribs.html">$search_attribs</a>)) {
<a name="l262"><span class="linenum"> 262</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_close')" href="../../_functions/ldap_close.html" onMouseOver="funcPopup(event,'ldap_close')">ldap_close</a>();
<a name="l263"><span class="linenum"> 263</span></a>              return false; <span class="comment">// error!</span>
<a name="l264"><span class="linenum"> 264</span></a>          }
<a name="l265"><span class="linenum"> 265</span></a>  
<a name="l266"><span class="linenum"> 266</span></a>          <a class="var it33963" onMouseOver="hilite(33963)" onMouseOut="lolite()" onClick="logVariable('user_entry')" href="../../_variables/user_entry.html">$user_entry</a> = <a class="function" onClick="logFunction('ldap_get_entries_moodle')" href="../../_functions/ldap_get_entries_moodle.html" onMouseOver="funcPopup(event,'ldap_get_entries_moodle')">ldap_get_entries_moodle</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33962" onMouseOver="hilite(33962)" onMouseOut="lolite()" onClick="logVariable('user_info_result')" href="../../_variables/user_info_result.html">$user_info_result</a>);
<a name="l267"><span class="linenum"> 267</span></a>          if (empty(<a class="var it33963" onMouseOver="hilite(33963)" onMouseOut="lolite()" onClick="logVariable('user_entry')" href="../../_variables/user_entry.html">$user_entry</a>)) {
<a name="l268"><span class="linenum"> 268</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_close')" href="../../_functions/ldap_close.html" onMouseOver="funcPopup(event,'ldap_close')">ldap_close</a>();
<a name="l269"><span class="linenum"> 269</span></a>              return false; <span class="comment">// entry not found</span>
<a name="l270"><span class="linenum"> 270</span></a>          }
<a name="l271"><span class="linenum"> 271</span></a>  
<a name="l272"><span class="linenum"> 272</span></a>          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = array();
<a name="l273"><span class="linenum"> 273</span></a>          foreach (<a class="var it23948" onMouseOver="hilite(23948)" onMouseOut="lolite()" onClick="logVariable('attrmap')" href="../../_variables/attrmap.html">$attrmap</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>) {
<a name="l274"><span class="linenum"> 274</span></a>              if (!<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>)) {
<a name="l275"><span class="linenum"> 275</span></a>                  <a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a> = array(<a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>);
<a name="l276"><span class="linenum"> 276</span></a>              }
<a name="l277"><span class="linenum"> 277</span></a>              <a class="var it33964" onMouseOver="hilite(33964)" onMouseOut="lolite()" onClick="logVariable('ldapval')" href="../../_variables/ldapval.html">$ldapval</a> = NULL;
<a name="l278"><span class="linenum"> 278</span></a>              foreach (<a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a> as <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l279"><span class="linenum"> 279</span></a>                  <a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a> = <a class="phpfunction" onClick="logFunction('array_change_key_case')" href="../../_functions/array_change_key_case.html" onMouseOver="phpfuncPopup(event,'array_change_key_case')">array_change_key_case</a>(<a class="var it33963" onMouseOver="hilite(33963)" onMouseOut="lolite()" onClick="logVariable('user_entry')" href="../../_variables/user_entry.html">$user_entry</a>[0], CASE_LOWER);
<a name="l280"><span class="linenum"> 280</span></a>                  if ((<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> == 'dn') || (<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> == 'distinguishedname')) {
<a name="l281"><span class="linenum"> 281</span></a>                      <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>] = <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>;
<a name="l282"><span class="linenum"> 282</span></a>                      continue;
<a name="l283"><span class="linenum"> 283</span></a>                  }
<a name="l284"><span class="linenum"> 284</span></a>                  if (!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>, <a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a>)) {
<a name="l285"><span class="linenum"> 285</span></a>                      continue; <span class="comment">// wrong data mapping!</span>
<a name="l286"><span class="linenum"> 286</span></a>                  }
<a name="l287"><span class="linenum"> 287</span></a>                  if (<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a>[<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>])) {
<a name="l288"><span class="linenum"> 288</span></a>                      <a class="var it33965" onMouseOver="hilite(33965)" onMouseOut="lolite()" onClick="logVariable('newval')" href="../../_variables/newval.html">$newval</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a>[<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>][0], <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding, 'utf-8');
<a name="l289"><span class="linenum"> 289</span></a>                  } else {
<a name="l290"><span class="linenum"> 290</span></a>                      <a class="var it33965" onMouseOver="hilite(33965)" onMouseOut="lolite()" onClick="logVariable('newval')" href="../../_variables/newval.html">$newval</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a>[<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>], <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding, 'utf-8');
<a name="l291"><span class="linenum"> 291</span></a>                  }
<a name="l292"><span class="linenum"> 292</span></a>                  if (!empty(<a class="var it33965" onMouseOver="hilite(33965)" onMouseOut="lolite()" onClick="logVariable('newval')" href="../../_variables/newval.html">$newval</a>)) { // favour ldap entries that are set
<a name="l293"><span class="linenum"> 293</span></a>                      <a class="var it33964" onMouseOver="hilite(33964)" onMouseOut="lolite()" onClick="logVariable('ldapval')" href="../../_variables/ldapval.html">$ldapval</a> = <a class="var it33965" onMouseOver="hilite(33965)" onMouseOut="lolite()" onClick="logVariable('newval')" href="../../_variables/newval.html">$newval</a>;
<a name="l294"><span class="linenum"> 294</span></a>                  }
<a name="l295"><span class="linenum"> 295</span></a>              }
<a name="l296"><span class="linenum"> 296</span></a>              if (!<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it33964" onMouseOver="hilite(33964)" onMouseOut="lolite()" onClick="logVariable('ldapval')" href="../../_variables/ldapval.html">$ldapval</a>)) {
<a name="l297"><span class="linenum"> 297</span></a>                  <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>] = <a class="var it33964" onMouseOver="hilite(33964)" onMouseOut="lolite()" onClick="logVariable('ldapval')" href="../../_variables/ldapval.html">$ldapval</a>;
<a name="l298"><span class="linenum"> 298</span></a>              }
<a name="l299"><span class="linenum"> 299</span></a>          }
<a name="l300"><span class="linenum"> 300</span></a>  
<a name="l301"><span class="linenum"> 301</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_close')" href="../../_functions/ldap_close.html" onMouseOver="funcPopup(event,'ldap_close')">ldap_close</a>();
<a name="l302"><span class="linenum"> 302</span></a>          return <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l303"><span class="linenum"> 303</span></a>      }
<a name="l304"><span class="linenum"> 304</span></a>  
<a name="l305"><span class="linenum"> 305</span></a>      <span class="comment">/**</span>
<a name="l306"><span class="linenum"> 306</span></a>  <span class="comment">     * Reads user information from ldap and returns it in an object</span>
<a name="l307"><span class="linenum"> 307</span></a>  <span class="comment">     *</span>
<a name="l308"><span class="linenum"> 308</span></a>  <span class="comment">     * @param string $username username (with system magic quotes)</span>
<a name="l309"><span class="linenum"> 309</span></a>  <span class="comment">     * @return mixed object or false on error</span>
<a name="l310"><span class="linenum"> 310</span></a>  <span class="comment">     */</span>
<a name="l311"><span class="linenum"> 311</span></a>      function <a class="function" onClick="logFunction('get_userinfo_asobj')" href="../../_functions/get_userinfo_asobj.html" onMouseOver="funcPopup(event,'get_userinfo_asobj')">get_userinfo_asobj</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>) {
<a name="l312"><span class="linenum"> 312</span></a>          <a class="var it33966" onMouseOver="hilite(33966)" onMouseOut="lolite()" onClick="logVariable('user_array')" href="../../_variables/user_array.html">$user_array</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_userinfo')" href="../../_functions/get_userinfo.html" onMouseOver="funcPopup(event,'get_userinfo')">get_userinfo</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>);
<a name="l313"><span class="linenum"> 313</span></a>          if (<a class="var it33966" onMouseOver="hilite(33966)" onMouseOut="lolite()" onClick="logVariable('user_array')" href="../../_variables/user_array.html">$user_array</a> == false) {
<a name="l314"><span class="linenum"> 314</span></a>              return false; <span class="comment">//error or not found</span>
<a name="l315"><span class="linenum"> 315</span></a>          }
<a name="l316"><span class="linenum"> 316</span></a>          <a class="var it33966" onMouseOver="hilite(33966)" onMouseOut="lolite()" onClick="logVariable('user_array')" href="../../_variables/user_array.html">$user_array</a> = <a class="function" onClick="logFunction('truncate_userinfo')" href="../../_functions/truncate_userinfo.html" onMouseOver="funcPopup(event,'truncate_userinfo')">truncate_userinfo</a>(<a class="var it33966" onMouseOver="hilite(33966)" onMouseOut="lolite()" onClick="logVariable('user_array')" href="../../_variables/user_array.html">$user_array</a>);
<a name="l317"><span class="linenum"> 317</span></a>          <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a> = new stdClass();
<a name="l318"><span class="linenum"> 318</span></a>          foreach (<a class="var it33966" onMouseOver="hilite(33966)" onMouseOut="lolite()" onClick="logVariable('user_array')" href="../../_variables/user_array.html">$user_array</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>=&gt;<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l319"><span class="linenum"> 319</span></a>              <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;{<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>} = <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l320"><span class="linenum"> 320</span></a>          }
<a name="l321"><span class="linenum"> 321</span></a>          return <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>;
<a name="l322"><span class="linenum"> 322</span></a>      }
<a name="l323"><span class="linenum"> 323</span></a>  
<a name="l324"><span class="linenum"> 324</span></a>      <span class="comment">/**</span>
<a name="l325"><span class="linenum"> 325</span></a>  <span class="comment">     * Returns all usernames from LDAP</span>
<a name="l326"><span class="linenum"> 326</span></a>  <span class="comment">     *</span>
<a name="l327"><span class="linenum"> 327</span></a>  <span class="comment">     * get_userlist returns all usernames from LDAP</span>
<a name="l328"><span class="linenum"> 328</span></a>  <span class="comment">     *</span>
<a name="l329"><span class="linenum"> 329</span></a>  <span class="comment">     * @return array</span>
<a name="l330"><span class="linenum"> 330</span></a>  <span class="comment">     */</span>
<a name="l331"><span class="linenum"> 331</span></a>      function <a class="function" onClick="logFunction('get_userlist')" href="../../_functions/get_userlist.html" onMouseOver="funcPopup(event,'get_userlist')">get_userlist</a>() {
<a name="l332"><span class="linenum"> 332</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_get_userlist')" href="../../_functions/ldap_get_userlist.html" onMouseOver="funcPopup(event,'ldap_get_userlist')">ldap_get_userlist</a>(&quot;({<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_attribute}=*)&quot;);
<a name="l333"><span class="linenum"> 333</span></a>      }
<a name="l334"><span class="linenum"> 334</span></a>  
<a name="l335"><span class="linenum"> 335</span></a>      <span class="comment">/**</span>
<a name="l336"><span class="linenum"> 336</span></a>  <span class="comment">     * Checks if user exists on LDAP</span>
<a name="l337"><span class="linenum"> 337</span></a>  <span class="comment">     *</span>
<a name="l338"><span class="linenum"> 338</span></a>  <span class="comment">     * @param string $username</span>
<a name="l339"><span class="linenum"> 339</span></a>  <span class="comment">     */</span>
<a name="l340"><span class="linenum"> 340</span></a>      function <a class="function" onClick="logFunction('user_exists')" href="../../_functions/user_exists.html" onMouseOver="funcPopup(event,'user_exists')">user_exists</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>) {
<a name="l341"><span class="linenum"> 341</span></a>          <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, 'utf-8', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding);
<a name="l342"><span class="linenum"> 342</span></a>  
<a name="l343"><span class="linenum"> 343</span></a>  <span class="comment">        // Returns true if given username exists on ldap</span>
<a name="l344"><span class="linenum"> 344</span></a>          <a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_get_userlist')" href="../../_functions/ldap_get_userlist.html" onMouseOver="funcPopup(event,'ldap_get_userlist')">ldap_get_userlist</a>('('.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_attribute.'='.<a class="function" onClick="logFunction('ldap_filter_addslashes')" href="../../_functions/ldap_filter_addslashes.html" onMouseOver="funcPopup(event,'ldap_filter_addslashes')">ldap_filter_addslashes</a>(<a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a>).')');
<a name="l345"><span class="linenum"> 345</span></a>          return <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>);
<a name="l346"><span class="linenum"> 346</span></a>      }
<a name="l347"><span class="linenum"> 347</span></a>  
<a name="l348"><span class="linenum"> 348</span></a>      <span class="comment">/**</span>
<a name="l349"><span class="linenum"> 349</span></a>  <span class="comment">     * Creates a new user on LDAP.</span>
<a name="l350"><span class="linenum"> 350</span></a>  <span class="comment">     * By using information in userobject</span>
<a name="l351"><span class="linenum"> 351</span></a>  <span class="comment">     * Use user_exists to prevent duplicate usernames</span>
<a name="l352"><span class="linenum"> 352</span></a>  <span class="comment">     *</span>
<a name="l353"><span class="linenum"> 353</span></a>  <span class="comment">     * @param mixed $userobject  Moodle userobject</span>
<a name="l354"><span class="linenum"> 354</span></a>  <span class="comment">     * @param mixed $plainpass   Plaintext password</span>
<a name="l355"><span class="linenum"> 355</span></a>  <span class="comment">     */</span>
<a name="l356"><span class="linenum"> 356</span></a>      function <a class="function" onClick="logFunction('user_create')" href="../../_functions/user_create.html" onMouseOver="funcPopup(event,'user_create')">user_create</a>(<a class="var it14172" onMouseOver="hilite(14172)" onMouseOut="lolite()" onClick="logVariable('userobject')" href="../../_variables/userobject.html">$userobject</a>, <a class="var it33967" onMouseOver="hilite(33967)" onMouseOut="lolite()" onClick="logVariable('plainpass')" href="../../_variables/plainpass.html">$plainpass</a>) {
<a name="l357"><span class="linenum"> 357</span></a>          <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it14172" onMouseOver="hilite(14172)" onMouseOut="lolite()" onClick="logVariable('userobject')" href="../../_variables/userobject.html">$userobject</a>-&gt;<a onClick="logVariable('username')" class="var it43515" onMouseOver="hilite(43515)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>, 'utf-8', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding);
<a name="l358"><span class="linenum"> 358</span></a>          <a class="var it33956" onMouseOver="hilite(33956)" onMouseOut="lolite()" onClick="logVariable('extpassword')" href="../../_variables/extpassword.html">$extpassword</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it33967" onMouseOver="hilite(33967)" onMouseOut="lolite()" onClick="logVariable('plainpass')" href="../../_variables/plainpass.html">$plainpass</a>, 'utf-8', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding);
<a name="l359"><span class="linenum"> 359</span></a>  
<a name="l360"><span class="linenum"> 360</span></a>          switch (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;passtype) {
<a name="l361"><span class="linenum"> 361</span></a>              case 'md5':
<a name="l362"><span class="linenum"> 362</span></a>                  <a class="var it33956" onMouseOver="hilite(33956)" onMouseOut="lolite()" onClick="logVariable('extpassword')" href="../../_variables/extpassword.html">$extpassword</a> = '{MD5}' . <a class="phpfunction" onClick="logFunction('base64_encode')" href="../../_functions/base64_encode.html" onMouseOver="phpfuncPopup(event,'base64_encode')">base64_encode</a>(<a class="phpfunction" onClick="logFunction('pack')" href="../../_functions/pack.html" onMouseOver="phpfuncPopup(event,'pack')">pack</a>('H*', md5(<a class="var it33956" onMouseOver="hilite(33956)" onMouseOut="lolite()" onClick="logVariable('extpassword')" href="../../_variables/extpassword.html">$extpassword</a>)));
<a name="l363"><span class="linenum"> 363</span></a>                  break;
<a name="l364"><span class="linenum"> 364</span></a>              case 'sha1':
<a name="l365"><span class="linenum"> 365</span></a>                  <a class="var it33956" onMouseOver="hilite(33956)" onMouseOut="lolite()" onClick="logVariable('extpassword')" href="../../_variables/extpassword.html">$extpassword</a> = '{SHA}' . <a class="phpfunction" onClick="logFunction('base64_encode')" href="../../_functions/base64_encode.html" onMouseOver="phpfuncPopup(event,'base64_encode')">base64_encode</a>(<a class="phpfunction" onClick="logFunction('pack')" href="../../_functions/pack.html" onMouseOver="phpfuncPopup(event,'pack')">pack</a>('H*', <a class="phpfunction" onClick="logFunction('sha1')" href="../../_functions/sha1.html" onMouseOver="phpfuncPopup(event,'sha1')">sha1</a>(<a class="var it33956" onMouseOver="hilite(33956)" onMouseOut="lolite()" onClick="logVariable('extpassword')" href="../../_variables/extpassword.html">$extpassword</a>)));
<a name="l366"><span class="linenum"> 366</span></a>                  break;
<a name="l367"><span class="linenum"> 367</span></a>              case 'plaintext':
<a name="l368"><span class="linenum"> 368</span></a>              default:
<a name="l369"><span class="linenum"> 369</span></a>                  break; <span class="comment">// plaintext</span>
<a name="l370"><span class="linenum"> 370</span></a>          }
<a name="l371"><span class="linenum"> 371</span></a>  
<a name="l372"><span class="linenum"> 372</span></a>          <a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="phpfunction" onClick="logFunction('ldap_connect')" href="../../_functions/ldap_connect.html" onMouseOver="phpfuncPopup(event,'ldap_connect')">ldap_connect</a>();
<a name="l373"><span class="linenum"> 373</span></a>          <a class="var it23948" onMouseOver="hilite(23948)" onMouseOut="lolite()" onClick="logVariable('attrmap')" href="../../_variables/attrmap.html">$attrmap</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_attributes')" href="../../_functions/ldap_attributes.html" onMouseOver="funcPopup(event,'ldap_attributes')">ldap_attributes</a>();
<a name="l374"><span class="linenum"> 374</span></a>  
<a name="l375"><span class="linenum"> 375</span></a>          <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a> = array();
<a name="l376"><span class="linenum"> 376</span></a>  
<a name="l377"><span class="linenum"> 377</span></a>          foreach (<a class="var it23948" onMouseOver="hilite(23948)" onMouseOut="lolite()" onClick="logVariable('attrmap')" href="../../_variables/attrmap.html">$attrmap</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>) {
<a name="l378"><span class="linenum"> 378</span></a>              if (!<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>)) {
<a name="l379"><span class="linenum"> 379</span></a>                  <a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a> = array(<a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>);
<a name="l380"><span class="linenum"> 380</span></a>              }
<a name="l381"><span class="linenum"> 381</span></a>              foreach (<a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a> as <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l382"><span class="linenum"> 382</span></a>                  if (!empty(<a class="var it14172" onMouseOver="hilite(14172)" onMouseOut="lolite()" onClick="logVariable('userobject')" href="../../_variables/userobject.html">$userobject</a>-&gt;<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>) ) {
<a name="l383"><span class="linenum"> 383</span></a>                      <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>[<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>] = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it14172" onMouseOver="hilite(14172)" onMouseOut="lolite()" onClick="logVariable('userobject')" href="../../_variables/userobject.html">$userobject</a>-&gt;<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>, 'utf-8', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding);
<a name="l384"><span class="linenum"> 384</span></a>                  }
<a name="l385"><span class="linenum"> 385</span></a>              }
<a name="l386"><span class="linenum"> 386</span></a>          }
<a name="l387"><span class="linenum"> 387</span></a>  
<a name="l388"><span class="linenum"> 388</span></a>  <span class="comment">        //Following sets all mandatory and other forced attribute values</span>
<a name="l389"><span class="linenum"> 389</span></a>  <span class="comment">        //User should be creted as login disabled untill email confirmation is processed</span>
<a name="l390"><span class="linenum"> 390</span></a>  <span class="comment">        //Feel free to add your user type and send patches to paca@sci.fi to add them</span>
<a name="l391"><span class="linenum"> 391</span></a>  <span class="comment">        //Moodle distribution</span>
<a name="l392"><span class="linenum"> 392</span></a>  
<a name="l393"><span class="linenum"> 393</span></a>          switch (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_type)  {
<a name="l394"><span class="linenum"> 394</span></a>              case 'edir':
<a name="l395"><span class="linenum"> 395</span></a>                  <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>['objectClass']   = array('inetOrgPerson', 'organizationalPerson', 'person', 'top');
<a name="l396"><span class="linenum"> 396</span></a>                  <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>['uniqueId']      = <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a>;
<a name="l397"><span class="linenum"> 397</span></a>                  <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>['logindisabled'] = 'TRUE';
<a name="l398"><span class="linenum"> 398</span></a>                  <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>['userpassword']  = <a class="var it33956" onMouseOver="hilite(33956)" onMouseOut="lolite()" onClick="logVariable('extpassword')" href="../../_variables/extpassword.html">$extpassword</a>;
<a name="l399"><span class="linenum"> 399</span></a>                  <a class="var it33968" onMouseOver="hilite(33968)" onMouseOut="lolite()" onClick="logVariable('uadd')" href="../../_variables/uadd.html">$uadd</a> = <a class="phpfunction" onClick="logFunction('ldap_add')" href="../../_functions/ldap_add.html" onMouseOver="phpfuncPopup(event,'ldap_add')">ldap_add</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_attribute.'='.<a class="function" onClick="logFunction('ldap_addslashes')" href="../../_functions/ldap_addslashes.html" onMouseOver="funcPopup(event,'ldap_addslashes')">ldap_addslashes</a>(<a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a>).','.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;create_context, <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>);
<a name="l400"><span class="linenum"> 400</span></a>                  break;
<a name="l401"><span class="linenum"> 401</span></a>              case 'rfc2307':
<a name="l402"><span class="linenum"> 402</span></a>              case 'rfc2307bis':
<a name="l403"><span class="linenum"> 403</span></a>  <span class="comment">                // posixAccount object class forces us to specify a uidNumber</span>
<a name="l404"><span class="linenum"> 404</span></a>  <span class="comment">                // and a gidNumber. That is quite complicated to generate from</span>
<a name="l405"><span class="linenum"> 405</span></a>  <span class="comment">                // Moodle without colliding with existing numbers and without</span>
<a name="l406"><span class="linenum"> 406</span></a>  <span class="comment">                // race conditions. As this user is supposed to be only used</span>
<a name="l407"><span class="linenum"> 407</span></a>  <span class="comment">                // with Moodle (otherwise the user would exist beforehand) and</span>
<a name="l408"><span class="linenum"> 408</span></a>  <span class="comment">                // doesn't need to login into a operating system, we assign the</span>
<a name="l409"><span class="linenum"> 409</span></a>  <span class="comment">                // user the uid of user 'nobody' and gid of group 'nogroup'. In</span>
<a name="l410"><span class="linenum"> 410</span></a>  <span class="comment">                // addition to that, we need to specify a home directory. We</span>
<a name="l411"><span class="linenum"> 411</span></a>  <span class="comment">                // use the root directory ('/') as the home directory, as this</span>
<a name="l412"><span class="linenum"> 412</span></a>  <span class="comment">                // is the only one can always be sure exists. Finally, even if</span>
<a name="l413"><span class="linenum"> 413</span></a>  <span class="comment">                // it's not mandatory, we specify '/bin/false' as the login</span>
<a name="l414"><span class="linenum"> 414</span></a>  <span class="comment">                // shell, to prevent the user from login in at the operating</span>
<a name="l415"><span class="linenum"> 415</span></a>  <span class="comment">                // system level (Moodle ignores this).</span>
<a name="l416"><span class="linenum"> 416</span></a>  
<a name="l417"><span class="linenum"> 417</span></a>                  <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>['objectClass']   = array('posixAccount', 'inetOrgPerson', 'organizationalPerson', 'person', 'top');
<a name="l418"><span class="linenum"> 418</span></a>                  <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>['cn']            = <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a>;
<a name="l419"><span class="linenum"> 419</span></a>                  <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>['uid']           = <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a>;
<a name="l420"><span class="linenum"> 420</span></a>                  <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>['uidNumber']     = <a class="constant" onClick="logConstant('AUTH_UID_NOBODY')" href="../../_constants/AUTH_UID_NOBODY.html" onMouseOver="constPopup(event,'AUTH_UID_NOBODY')">AUTH_UID_NOBODY</a>;
<a name="l421"><span class="linenum"> 421</span></a>                  <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>['gidNumber']     = <a class="constant" onClick="logConstant('AUTH_GID_NOGROUP')" href="../../_constants/AUTH_GID_NOGROUP.html" onMouseOver="constPopup(event,'AUTH_GID_NOGROUP')">AUTH_GID_NOGROUP</a>;
<a name="l422"><span class="linenum"> 422</span></a>                  <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>['homeDirectory'] = '/';
<a name="l423"><span class="linenum"> 423</span></a>                  <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>['loginShell']    = '/bin/false';
<a name="l424"><span class="linenum"> 424</span></a>  
<a name="l425"><span class="linenum"> 425</span></a>  <span class="comment">                // IMPORTANT:</span>
<a name="l426"><span class="linenum"> 426</span></a>  <span class="comment">                // We have to create the account locked, but posixAccount has</span>
<a name="l427"><span class="linenum"> 427</span></a>  <span class="comment">                // no attribute to achive this reliably. So we are going to</span>
<a name="l428"><span class="linenum"> 428</span></a>  <span class="comment">                // modify the password in a reversable way that we can later</span>
<a name="l429"><span class="linenum"> 429</span></a>  <span class="comment">                // revert in user_activate().</span>
<a name="l430"><span class="linenum"> 430</span></a>  <span class="comment">                //</span>
<a name="l431"><span class="linenum"> 431</span></a>  <span class="comment">                // Beware that this can be defeated by the user if we are not</span>
<a name="l432"><span class="linenum"> 432</span></a>  <span class="comment">                // using MD5 or SHA-1 passwords. After all, the source code of</span>
<a name="l433"><span class="linenum"> 433</span></a>  <span class="comment">                // Moodle is available, and the user can see the kind of</span>
<a name="l434"><span class="linenum"> 434</span></a>  <span class="comment">                // modification we are doing and 'undo' it by hand (but only</span>
<a name="l435"><span class="linenum"> 435</span></a>  <span class="comment">                // if we are using plain text passwords).</span>
<a name="l436"><span class="linenum"> 436</span></a>  <span class="comment">                //</span>
<a name="l437"><span class="linenum"> 437</span></a>  <span class="comment">                // Also bear in mind that you need to use a binding user that</span>
<a name="l438"><span class="linenum"> 438</span></a>  <span class="comment">                // can create accounts and has read/write privileges on the</span>
<a name="l439"><span class="linenum"> 439</span></a>  <span class="comment">                // 'userPassword' attribute for this to work.</span>
<a name="l440"><span class="linenum"> 440</span></a>  
<a name="l441"><span class="linenum"> 441</span></a>                  <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>['userPassword']  = '*'.<a class="var it33956" onMouseOver="hilite(33956)" onMouseOut="lolite()" onClick="logVariable('extpassword')" href="../../_variables/extpassword.html">$extpassword</a>;
<a name="l442"><span class="linenum"> 442</span></a>                  <a class="var it33968" onMouseOver="hilite(33968)" onMouseOut="lolite()" onClick="logVariable('uadd')" href="../../_variables/uadd.html">$uadd</a> = <a class="phpfunction" onClick="logFunction('ldap_add')" href="../../_functions/ldap_add.html" onMouseOver="phpfuncPopup(event,'ldap_add')">ldap_add</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_attribute.'='.<a class="function" onClick="logFunction('ldap_addslashes')" href="../../_functions/ldap_addslashes.html" onMouseOver="funcPopup(event,'ldap_addslashes')">ldap_addslashes</a>(<a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a>).','.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;create_context, <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>);
<a name="l443"><span class="linenum"> 443</span></a>                  break;
<a name="l444"><span class="linenum"> 444</span></a>              case 'ad':
<a name="l445"><span class="linenum"> 445</span></a>  <span class="comment">                // User account creation is a two step process with AD. First you</span>
<a name="l446"><span class="linenum"> 446</span></a>  <span class="comment">                // create the user object, then you set the password. If you try</span>
<a name="l447"><span class="linenum"> 447</span></a>  <span class="comment">                // to set the password while creating the user, the operation</span>
<a name="l448"><span class="linenum"> 448</span></a>  <span class="comment">                // fails.</span>
<a name="l449"><span class="linenum"> 449</span></a>  
<a name="l450"><span class="linenum"> 450</span></a>  <span class="comment">                // Passwords in Active Directory must be encoded as Unicode</span>
<a name="l451"><span class="linenum"> 451</span></a>  <span class="comment">                // strings (UCS-2 Little Endian format) and surrounded with</span>
<a name="l452"><span class="linenum"> 452</span></a>  <span class="comment">                // double quotes. See http://support.microsoft.com/?kbid=269190</span>
<a name="l453"><span class="linenum"> 453</span></a>                  if (!<a class="phpfunction" onClick="logFunction('function_exists')" href="../../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>('mb_convert_encoding')) {
<a name="l454"><span class="linenum"> 454</span></a>                      <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('auth_ldap_no_mbstring', 'auth_ldap');
<a name="l455"><span class="linenum"> 455</span></a>                  }
<a name="l456"><span class="linenum"> 456</span></a>  
<a name="l457"><span class="linenum"> 457</span></a>  <span class="comment">                // Check for invalid sAMAccountName characters.</span>
<a name="l458"><span class="linenum"> 458</span></a>                  if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('#[/\\[\]:;|=,+*?&lt;&gt;@&quot;]#', <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a>)) {
<a name="l459"><span class="linenum"> 459</span></a>                      <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a> ('auth_ldap_ad_invalidchars', 'auth_ldap');
<a name="l460"><span class="linenum"> 460</span></a>                  }
<a name="l461"><span class="linenum"> 461</span></a>  
<a name="l462"><span class="linenum"> 462</span></a>  <span class="comment">                // First create the user account, and mark it as disabled.</span>
<a name="l463"><span class="linenum"> 463</span></a>                  <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>['objectClass'] = array('top', 'person', 'user', 'organizationalPerson');
<a name="l464"><span class="linenum"> 464</span></a>                  <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>['sAMAccountName'] = <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a>;
<a name="l465"><span class="linenum"> 465</span></a>                  <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>['userAccountControl'] = <a class="constant" onClick="logConstant('AUTH_AD_NORMAL_ACCOUNT')" href="../../_constants/AUTH_AD_NORMAL_ACCOUNT.html" onMouseOver="constPopup(event,'AUTH_AD_NORMAL_ACCOUNT')">AUTH_AD_NORMAL_ACCOUNT</a> |
<a name="l466"><span class="linenum"> 466</span></a>                                                   <a class="constant" onClick="logConstant('AUTH_AD_ACCOUNTDISABLE')" href="../../_constants/AUTH_AD_ACCOUNTDISABLE.html" onMouseOver="constPopup(event,'AUTH_AD_ACCOUNTDISABLE')">AUTH_AD_ACCOUNTDISABLE</a>;
<a name="l467"><span class="linenum"> 467</span></a>                  <a class="var it33969" onMouseOver="hilite(33969)" onMouseOut="lolite()" onClick="logVariable('userdn')" href="../../_variables/userdn.html">$userdn</a> = 'cn='.<a class="function" onClick="logFunction('ldap_addslashes')" href="../../_functions/ldap_addslashes.html" onMouseOver="funcPopup(event,'ldap_addslashes')">ldap_addslashes</a>(<a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a>).','.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;create_context;
<a name="l468"><span class="linenum"> 468</span></a>                  if (!<a class="phpfunction" onClick="logFunction('ldap_add')" href="../../_functions/ldap_add.html" onMouseOver="phpfuncPopup(event,'ldap_add')">ldap_add</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33969" onMouseOver="hilite(33969)" onMouseOut="lolite()" onClick="logVariable('userdn')" href="../../_variables/userdn.html">$userdn</a>, <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>)) {
<a name="l469"><span class="linenum"> 469</span></a>                      <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('auth_ldap_ad_create_req', 'auth_ldap');
<a name="l470"><span class="linenum"> 470</span></a>                  }
<a name="l471"><span class="linenum"> 471</span></a>  
<a name="l472"><span class="linenum"> 472</span></a>  <span class="comment">                // Now set the password</span>
<a name="l473"><span class="linenum"> 473</span></a>                  unset(<a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>);
<a name="l474"><span class="linenum"> 474</span></a>                  <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>['unicodePwd'] = <a class="phpfunction" onClick="logFunction('mb_convert_encoding')" href="../../_functions/mb_convert_encoding.html" onMouseOver="phpfuncPopup(event,'mb_convert_encoding')">mb_convert_encoding</a>('&quot;' . <a class="var it33956" onMouseOver="hilite(33956)" onMouseOut="lolite()" onClick="logVariable('extpassword')" href="../../_variables/extpassword.html">$extpassword</a> . '&quot;',
<a name="l475"><span class="linenum"> 475</span></a>                                                               'UCS-2LE', 'UTF-8');
<a name="l476"><span class="linenum"> 476</span></a>                  if(!ldap_modify(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33969" onMouseOver="hilite(33969)" onMouseOut="lolite()" onClick="logVariable('userdn')" href="../../_variables/userdn.html">$userdn</a>, <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>)) {
<a name="l477"><span class="linenum"> 477</span></a>  <span class="comment">                    // Something went wrong: delete the user account and error out</span>
<a name="l478"><span class="linenum"> 478</span></a>                      <a class="phpfunction" onClick="logFunction('ldap_delete')" href="../../_functions/ldap_delete.html" onMouseOver="phpfuncPopup(event,'ldap_delete')">ldap_delete</a> (<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33969" onMouseOver="hilite(33969)" onMouseOut="lolite()" onClick="logVariable('userdn')" href="../../_variables/userdn.html">$userdn</a>);
<a name="l479"><span class="linenum"> 479</span></a>                      <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('auth_ldap_ad_create_req', 'auth_ldap');
<a name="l480"><span class="linenum"> 480</span></a>                  }
<a name="l481"><span class="linenum"> 481</span></a>                  <a class="var it33968" onMouseOver="hilite(33968)" onMouseOut="lolite()" onClick="logVariable('uadd')" href="../../_variables/uadd.html">$uadd</a> = true;
<a name="l482"><span class="linenum"> 482</span></a>                  break;
<a name="l483"><span class="linenum"> 483</span></a>              default:
<a name="l484"><span class="linenum"> 484</span></a>                 <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('auth_ldap_unsupportedusertype', 'auth_ldap', '', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_type_name);
<a name="l485"><span class="linenum"> 485</span></a>          }
<a name="l486"><span class="linenum"> 486</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_close')" href="../../_functions/ldap_close.html" onMouseOver="funcPopup(event,'ldap_close')">ldap_close</a>();
<a name="l487"><span class="linenum"> 487</span></a>          return <a class="var it33968" onMouseOver="hilite(33968)" onMouseOut="lolite()" onClick="logVariable('uadd')" href="../../_variables/uadd.html">$uadd</a>;
<a name="l488"><span class="linenum"> 488</span></a>      }
<a name="l489"><span class="linenum"> 489</span></a>  
<a name="l490"><span class="linenum"> 490</span></a>      <span class="comment">/**</span>
<a name="l491"><span class="linenum"> 491</span></a>  <span class="comment">     * Returns true if plugin allows resetting of password from moodle.</span>
<a name="l492"><span class="linenum"> 492</span></a>  <span class="comment">     *</span>
<a name="l493"><span class="linenum"> 493</span></a>  <span class="comment">     * @return bool</span>
<a name="l494"><span class="linenum"> 494</span></a>  <span class="comment">     */</span>
<a name="l495"><span class="linenum"> 495</span></a>      function <a class="function" onClick="logFunction('can_reset_password')" href="../../_functions/can_reset_password.html" onMouseOver="funcPopup(event,'can_reset_password')">can_reset_password</a>() {
<a name="l496"><span class="linenum"> 496</span></a>          return !empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;stdchangepassword);
<a name="l497"><span class="linenum"> 497</span></a>      }
<a name="l498"><span class="linenum"> 498</span></a>  
<a name="l499"><span class="linenum"> 499</span></a>      <span class="comment">/**</span>
<a name="l500"><span class="linenum"> 500</span></a>  <span class="comment">     * Returns true if plugin can be manually set.</span>
<a name="l501"><span class="linenum"> 501</span></a>  <span class="comment">     *</span>
<a name="l502"><span class="linenum"> 502</span></a>  <span class="comment">     * @return bool</span>
<a name="l503"><span class="linenum"> 503</span></a>  <span class="comment">     */</span>
<a name="l504"><span class="linenum"> 504</span></a>      function <a class="function" onClick="logFunction('can_be_manually_set')" href="../../_functions/can_be_manually_set.html" onMouseOver="funcPopup(event,'can_be_manually_set')">can_be_manually_set</a>() {
<a name="l505"><span class="linenum"> 505</span></a>          return true;
<a name="l506"><span class="linenum"> 506</span></a>      }
<a name="l507"><span class="linenum"> 507</span></a>  
<a name="l508"><span class="linenum"> 508</span></a>      <span class="comment">/**</span>
<a name="l509"><span class="linenum"> 509</span></a>  <span class="comment">     * Returns true if plugin allows signup and user creation.</span>
<a name="l510"><span class="linenum"> 510</span></a>  <span class="comment">     *</span>
<a name="l511"><span class="linenum"> 511</span></a>  <span class="comment">     * @return bool</span>
<a name="l512"><span class="linenum"> 512</span></a>  <span class="comment">     */</span>
<a name="l513"><span class="linenum"> 513</span></a>      function <a class="function" onClick="logFunction('can_signup')" href="../../_functions/can_signup.html" onMouseOver="funcPopup(event,'can_signup')">can_signup</a>() {
<a name="l514"><span class="linenum"> 514</span></a>          return (!empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;auth_user_create) and !empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;create_context));
<a name="l515"><span class="linenum"> 515</span></a>      }
<a name="l516"><span class="linenum"> 516</span></a>  
<a name="l517"><span class="linenum"> 517</span></a>      <span class="comment">/**</span>
<a name="l518"><span class="linenum"> 518</span></a>  <span class="comment">     * Sign up a new user ready for confirmation.</span>
<a name="l519"><span class="linenum"> 519</span></a>  <span class="comment">     * Password is passed in plaintext.</span>
<a name="l520"><span class="linenum"> 520</span></a>  <span class="comment">     *</span>
<a name="l521"><span class="linenum"> 521</span></a>  <span class="comment">     * @param object $user new user object</span>
<a name="l522"><span class="linenum"> 522</span></a>  <span class="comment">     * @param boolean $notify print notice with link and terminate</span>
<a name="l523"><span class="linenum"> 523</span></a>  <span class="comment">     * @return boolean success</span>
<a name="l524"><span class="linenum"> 524</span></a>  <span class="comment">     */</span>
<a name="l525"><span class="linenum"> 525</span></a>      function <a class="function" onClick="logFunction('user_signup')" href="../../_functions/user_signup.html" onMouseOver="funcPopup(event,'user_signup')">user_signup</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>, <a class="var it5442" onMouseOver="hilite(5442)" onMouseOut="lolite()" onClick="logVariable('notify')" href="../../_variables/notify.html">$notify</a>=true) {
<a name="l526"><span class="linenum"> 526</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>, <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>;
<a name="l527"><span class="linenum"> 527</span></a>  
<a name="l528"><span class="linenum"> 528</span></a>          require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../user/profile/lib.php.html">/user/profile/lib.php</a>');
<a name="l529"><span class="linenum"> 529</span></a>          require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../user/lib.php.html">/user/lib.php</a>');
<a name="l530"><span class="linenum"> 530</span></a>  
<a name="l531"><span class="linenum"> 531</span></a>          if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('user_exists')" href="../../_functions/user_exists.html" onMouseOver="funcPopup(event,'user_exists')">user_exists</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>)) {
<a name="l532"><span class="linenum"> 532</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('auth_ldap_user_exists', 'auth_ldap');
<a name="l533"><span class="linenum"> 533</span></a>          }
<a name="l534"><span class="linenum"> 534</span></a>  
<a name="l535"><span class="linenum"> 535</span></a>          <a class="var it33970" onMouseOver="hilite(33970)" onMouseOut="lolite()" onClick="logVariable('plainslashedpassword')" href="../../_variables/plainslashedpassword.html">$plainslashedpassword</a> = <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('password')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/password.html">password</a>;
<a name="l536"><span class="linenum"> 536</span></a>          unset(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('password')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/password.html">password</a>);
<a name="l537"><span class="linenum"> 537</span></a>  
<a name="l538"><span class="linenum"> 538</span></a>          if (! <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('user_create')" href="../../_functions/user_create.html" onMouseOver="funcPopup(event,'user_create')">user_create</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>, <a class="var it33970" onMouseOver="hilite(33970)" onMouseOut="lolite()" onClick="logVariable('plainslashedpassword')" href="../../_variables/plainslashedpassword.html">$plainslashedpassword</a>)) {
<a name="l539"><span class="linenum"> 539</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('auth_ldap_create_error', 'auth_ldap');
<a name="l540"><span class="linenum"> 540</span></a>          }
<a name="l541"><span class="linenum"> 541</span></a>  
<a name="l542"><span class="linenum"> 542</span></a>          <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="function" onClick="logFunction('user_create_user')" href="../../_functions/user_create_user.html" onMouseOver="funcPopup(event,'user_create_user')">user_create_user</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>, false, false);
<a name="l543"><span class="linenum"> 543</span></a>  
<a name="l544"><span class="linenum"> 544</span></a>          <a class="function" onClick="logFunction('user_add_password_history')" href="../../_functions/user_add_password_history.html" onMouseOver="funcPopup(event,'user_add_password_history')">user_add_password_history</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it33970" onMouseOver="hilite(33970)" onMouseOut="lolite()" onClick="logVariable('plainslashedpassword')" href="../../_variables/plainslashedpassword.html">$plainslashedpassword</a>);
<a name="l545"><span class="linenum"> 545</span></a>  
<a name="l546"><span class="linenum"> 546</span></a>  <span class="comment">        // Save any custom profile field information</span>
<a name="l547"><span class="linenum"> 547</span></a>          <a class="function" onClick="logFunction('profile_save_data')" href="../../_functions/profile_save_data.html" onMouseOver="funcPopup(event,'profile_save_data')">profile_save_data</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>);
<a name="l548"><span class="linenum"> 548</span></a>  
<a name="l549"><span class="linenum"> 549</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('update_user_record')" href="../../_functions/update_user_record.html" onMouseOver="funcPopup(event,'update_user_record')">update_user_record</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>);
<a name="l550"><span class="linenum"> 550</span></a>  <span class="comment">        // This will also update the stored hash to the latest algorithm</span>
<a name="l551"><span class="linenum"> 551</span></a>  <span class="comment">        // if the existing hash is using an out-of-date algorithm (or the</span>
<a name="l552"><span class="linenum"> 552</span></a>  <span class="comment">        // legacy md5 algorithm).</span>
<a name="l553"><span class="linenum"> 553</span></a>          <a class="function" onClick="logFunction('update_internal_user_password')" href="../../_functions/update_internal_user_password.html" onMouseOver="funcPopup(event,'update_internal_user_password')">update_internal_user_password</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>, <a class="var it33970" onMouseOver="hilite(33970)" onMouseOut="lolite()" onClick="logVariable('plainslashedpassword')" href="../../_variables/plainslashedpassword.html">$plainslashedpassword</a>);
<a name="l554"><span class="linenum"> 554</span></a>  
<a name="l555"><span class="linenum"> 555</span></a>          <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user', array('id'=&gt;<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l556"><span class="linenum"> 556</span></a>  
<a name="l557"><span class="linenum"> 557</span></a>          \core\event\<a class="class" onClick="logClass('user_created')" href="../../_classes/user_created.html" onMouseOver="classPopup(event,'user_created')">user_created</a>::<a class="function" onClick="logFunction('create_from_userid')" href="../../_functions/create_from_userid.html" onMouseOver="funcPopup(event,'create_from_userid')">create_from_userid</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>)-&gt;<a class="function" onClick="logFunction('trigger')" href="../../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l558"><span class="linenum"> 558</span></a>  
<a name="l559"><span class="linenum"> 559</span></a>          if (! <a class="function" onClick="logFunction('send_confirmation_email')" href="../../_functions/send_confirmation_email.html" onMouseOver="funcPopup(event,'send_confirmation_email')">send_confirmation_email</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>)) {
<a name="l560"><span class="linenum"> 560</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('noemail', 'auth_ldap');
<a name="l561"><span class="linenum"> 561</span></a>          }
<a name="l562"><span class="linenum"> 562</span></a>  
<a name="l563"><span class="linenum"> 563</span></a>          if (<a class="var it5442" onMouseOver="hilite(5442)" onMouseOut="lolite()" onClick="logVariable('notify')" href="../../_variables/notify.html">$notify</a>) {
<a name="l564"><span class="linenum"> 564</span></a>              <a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('emailconfirm')" href="../../_variables/emailconfirm.html">$emailconfirm</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailconfirm');
<a name="l565"><span class="linenum"> 565</span></a>              <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('set_url')" href="../../_functions/set_url.html" onMouseOver="funcPopup(event,'set_url')">set_url</a>('<a class="filename" href="../../auth/ldap/auth.php.html">/auth/ldap/auth.php</a>');
<a name="l566"><span class="linenum"> 566</span></a>              <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a onClick="logVariable('navbar')" class="var it42916" onMouseOver="hilite(42916)" onMouseOut="lolite()" href="../../_variables/navbar.html">navbar</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>(<a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('emailconfirm')" href="../../_variables/emailconfirm.html">$emailconfirm</a>);
<a name="l567"><span class="linenum"> 567</span></a>              <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('set_title')" href="../../_functions/set_title.html" onMouseOver="funcPopup(event,'set_title')">set_title</a>(<a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('emailconfirm')" href="../../_variables/emailconfirm.html">$emailconfirm</a>);
<a name="l568"><span class="linenum"> 568</span></a>              <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('set_heading')" href="../../_functions/set_heading.html" onMouseOver="funcPopup(event,'set_heading')">set_heading</a>(<a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('emailconfirm')" href="../../_variables/emailconfirm.html">$emailconfirm</a>);
<a name="l569"><span class="linenum"> 569</span></a>              echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="phpfunction" onClick="logFunction('header')" href="../../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>();
<a name="l570"><span class="linenum"> 570</span></a>              <a class="function" onClick="logFunction('notice')" href="../../_functions/notice.html" onMouseOver="funcPopup(event,'notice')">notice</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailconfirmsent', '', <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('email')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/email.html">email</a>), &quot;{<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>}/index.php&quot;);
<a name="l571"><span class="linenum"> 571</span></a>          } else {
<a name="l572"><span class="linenum"> 572</span></a>              return true;
<a name="l573"><span class="linenum"> 573</span></a>          }
<a name="l574"><span class="linenum"> 574</span></a>      }
<a name="l575"><span class="linenum"> 575</span></a>  
<a name="l576"><span class="linenum"> 576</span></a>      <span class="comment">/**</span>
<a name="l577"><span class="linenum"> 577</span></a>  <span class="comment">     * Returns true if plugin allows confirming of new users.</span>
<a name="l578"><span class="linenum"> 578</span></a>  <span class="comment">     *</span>
<a name="l579"><span class="linenum"> 579</span></a>  <span class="comment">     * @return bool</span>
<a name="l580"><span class="linenum"> 580</span></a>  <span class="comment">     */</span>
<a name="l581"><span class="linenum"> 581</span></a>      function <a class="function" onClick="logFunction('can_confirm')" href="../../_functions/can_confirm.html" onMouseOver="funcPopup(event,'can_confirm')">can_confirm</a>() {
<a name="l582"><span class="linenum"> 582</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('can_signup')" href="../../_functions/can_signup.html" onMouseOver="funcPopup(event,'can_signup')">can_signup</a>();
<a name="l583"><span class="linenum"> 583</span></a>      }
<a name="l584"><span class="linenum"> 584</span></a>  
<a name="l585"><span class="linenum"> 585</span></a>      <span class="comment">/**</span>
<a name="l586"><span class="linenum"> 586</span></a>  <span class="comment">     * Confirm the new user as registered.</span>
<a name="l587"><span class="linenum"> 587</span></a>  <span class="comment">     *</span>
<a name="l588"><span class="linenum"> 588</span></a>  <span class="comment">     * @param string $username</span>
<a name="l589"><span class="linenum"> 589</span></a>  <span class="comment">     * @param string $confirmsecret</span>
<a name="l590"><span class="linenum"> 590</span></a>  <span class="comment">     */</span>
<a name="l591"><span class="linenum"> 591</span></a>      function <a class="function" onClick="logFunction('user_confirm')" href="../../_functions/user_confirm.html" onMouseOver="funcPopup(event,'user_confirm')">user_confirm</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, <a class="var it5445" onMouseOver="hilite(5445)" onMouseOut="lolite()" onClick="logVariable('confirmsecret')" href="../../_variables/confirmsecret.html">$confirmsecret</a>) {
<a name="l592"><span class="linenum"> 592</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l593"><span class="linenum"> 593</span></a>  
<a name="l594"><span class="linenum"> 594</span></a>          <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a> = <a class="function" onClick="logFunction('get_complete_user_data')" href="../../_functions/get_complete_user_data.html" onMouseOver="funcPopup(event,'get_complete_user_data')">get_complete_user_data</a>('username', <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>);
<a name="l595"><span class="linenum"> 595</span></a>  
<a name="l596"><span class="linenum"> 596</span></a>          if (!empty(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>)) {
<a name="l597"><span class="linenum"> 597</span></a>              if (<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/auth.html">auth</a> != <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('authtype')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/authtype.html">authtype</a>) {
<a name="l598"><span class="linenum"> 598</span></a>                  return <a class="constant" onClick="logConstant('AUTH_CONFIRM_ERROR')" href="../../_constants/AUTH_CONFIRM_ERROR.html" onMouseOver="constPopup(event,'AUTH_CONFIRM_ERROR')">AUTH_CONFIRM_ERROR</a>;
<a name="l599"><span class="linenum"> 599</span></a>  
<a name="l600"><span class="linenum"> 600</span></a>              } else if (<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('secret')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/secret.html">secret</a> == <a class="var it5445" onMouseOver="hilite(5445)" onMouseOut="lolite()" onClick="logVariable('confirmsecret')" href="../../_variables/confirmsecret.html">$confirmsecret</a> &amp;&amp; <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('confirmed')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/confirmed.html">confirmed</a>) {
<a name="l601"><span class="linenum"> 601</span></a>                  return <a class="constant" onClick="logConstant('AUTH_CONFIRM_ALREADY')" href="../../_constants/AUTH_CONFIRM_ALREADY.html" onMouseOver="constPopup(event,'AUTH_CONFIRM_ALREADY')">AUTH_CONFIRM_ALREADY</a>;
<a name="l602"><span class="linenum"> 602</span></a>  
<a name="l603"><span class="linenum"> 603</span></a>              } else if (<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('secret')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/secret.html">secret</a> == <a class="var it5445" onMouseOver="hilite(5445)" onMouseOut="lolite()" onClick="logVariable('confirmsecret')" href="../../_variables/confirmsecret.html">$confirmsecret</a>) {   // They have provided the secret key to get in
<a name="l604"><span class="linenum"> 604</span></a>                  if (!<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('user_activate')" href="../../_functions/user_activate.html" onMouseOver="funcPopup(event,'user_activate')">user_activate</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>)) {
<a name="l605"><span class="linenum"> 605</span></a>                      return <a class="constant" onClick="logConstant('AUTH_CONFIRM_FAIL')" href="../../_constants/AUTH_CONFIRM_FAIL.html" onMouseOver="constPopup(event,'AUTH_CONFIRM_FAIL')">AUTH_CONFIRM_FAIL</a>;
<a name="l606"><span class="linenum"> 606</span></a>                  }
<a name="l607"><span class="linenum"> 607</span></a>                  <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('confirmed')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/confirmed.html">confirmed</a> = 1;
<a name="l608"><span class="linenum"> 608</span></a>                  <a class="function" onClick="logFunction('user_update_user')" href="../../_functions/user_update_user.html" onMouseOver="funcPopup(event,'user_update_user')">user_update_user</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>, false);
<a name="l609"><span class="linenum"> 609</span></a>                  return <a class="constant" onClick="logConstant('AUTH_CONFIRM_OK')" href="../../_constants/AUTH_CONFIRM_OK.html" onMouseOver="constPopup(event,'AUTH_CONFIRM_OK')">AUTH_CONFIRM_OK</a>;
<a name="l610"><span class="linenum"> 610</span></a>              }
<a name="l611"><span class="linenum"> 611</span></a>          } else {
<a name="l612"><span class="linenum"> 612</span></a>              return <a class="constant" onClick="logConstant('AUTH_CONFIRM_ERROR')" href="../../_constants/AUTH_CONFIRM_ERROR.html" onMouseOver="constPopup(event,'AUTH_CONFIRM_ERROR')">AUTH_CONFIRM_ERROR</a>;
<a name="l613"><span class="linenum"> 613</span></a>          }
<a name="l614"><span class="linenum"> 614</span></a>      }
<a name="l615"><span class="linenum"> 615</span></a>  
<a name="l616"><span class="linenum"> 616</span></a>      <span class="comment">/**</span>
<a name="l617"><span class="linenum"> 617</span></a>  <span class="comment">     * Return number of days to user password expires</span>
<a name="l618"><span class="linenum"> 618</span></a>  <span class="comment">     *</span>
<a name="l619"><span class="linenum"> 619</span></a>  <span class="comment">     * If userpassword does not expire it should return 0. If password is already expired</span>
<a name="l620"><span class="linenum"> 620</span></a>  <span class="comment">     * it should return negative value.</span>
<a name="l621"><span class="linenum"> 621</span></a>  <span class="comment">     *</span>
<a name="l622"><span class="linenum"> 622</span></a>  <span class="comment">     * @param mixed $username username</span>
<a name="l623"><span class="linenum"> 623</span></a>  <span class="comment">     * @return integer</span>
<a name="l624"><span class="linenum"> 624</span></a>  <span class="comment">     */</span>
<a name="l625"><span class="linenum"> 625</span></a>      function <a class="function" onClick="logFunction('password_expire')" href="../../_functions/password_expire.html" onMouseOver="funcPopup(event,'password_expire')">password_expire</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>) {
<a name="l626"><span class="linenum"> 626</span></a>          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = 0;
<a name="l627"><span class="linenum"> 627</span></a>  
<a name="l628"><span class="linenum"> 628</span></a>          <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, 'utf-8', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding);
<a name="l629"><span class="linenum"> 629</span></a>  
<a name="l630"><span class="linenum"> 630</span></a>          <a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="phpfunction" onClick="logFunction('ldap_connect')" href="../../_functions/ldap_connect.html" onMouseOver="phpfuncPopup(event,'ldap_connect')">ldap_connect</a>();
<a name="l631"><span class="linenum"> 631</span></a>          <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_find_userdn')" href="../../_functions/ldap_find_userdn.html" onMouseOver="funcPopup(event,'ldap_find_userdn')">ldap_find_userdn</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a>);
<a name="l632"><span class="linenum"> 632</span></a>          <a class="var it23949" onMouseOver="hilite(23949)" onMouseOut="lolite()" onClick="logVariable('search_attribs')" href="../../_variables/search_attribs.html">$search_attribs</a> = array(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;expireattr);
<a name="l633"><span class="linenum"> 633</span></a>          <a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a> = <a class="phpfunction" onClick="logFunction('ldap_read')" href="../../_functions/ldap_read.html" onMouseOver="phpfuncPopup(event,'ldap_read')">ldap_read</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>, '(objectClass=*)', <a class="var it23949" onMouseOver="hilite(23949)" onMouseOut="lolite()" onClick="logVariable('search_attribs')" href="../../_variables/search_attribs.html">$search_attribs</a>);
<a name="l634"><span class="linenum"> 634</span></a>          if (<a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a>)  {
<a name="l635"><span class="linenum"> 635</span></a>              <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a> = <a class="function" onClick="logFunction('ldap_get_entries_moodle')" href="../../_functions/ldap_get_entries_moodle.html" onMouseOver="funcPopup(event,'ldap_get_entries_moodle')">ldap_get_entries_moodle</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a>);
<a name="l636"><span class="linenum"> 636</span></a>              if (!empty (<a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>)) {
<a name="l637"><span class="linenum"> 637</span></a>                  <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a> = <a class="phpfunction" onClick="logFunction('array_change_key_case')" href="../../_functions/array_change_key_case.html" onMouseOver="phpfuncPopup(event,'array_change_key_case')">array_change_key_case</a>(<a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>[0], CASE_LOWER);
<a name="l638"><span class="linenum"> 638</span></a>                  if (isset(<a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>[<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;expireattr][0])) {
<a name="l639"><span class="linenum"> 639</span></a>                      <a class="var it11924" onMouseOver="hilite(11924)" onMouseOut="lolite()" onClick="logVariable('expiretime')" href="../../_variables/expiretime.html">$expiretime</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_expirationtime2unix')" href="../../_functions/ldap_expirationtime2unix.html" onMouseOver="funcPopup(event,'ldap_expirationtime2unix')">ldap_expirationtime2unix</a>(<a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>[<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;expireattr][0], <a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>);
<a name="l640"><span class="linenum"> 640</span></a>                      if (<a class="var it11924" onMouseOver="hilite(11924)" onMouseOut="lolite()" onClick="logVariable('expiretime')" href="../../_variables/expiretime.html">$expiretime</a> != 0) {
<a name="l641"><span class="linenum"> 641</span></a>                          <a class="var it3027" onMouseOver="hilite(3027)" onMouseOut="lolite()" onClick="logVariable('now')" href="../../_variables/now.html">$now</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l642"><span class="linenum"> 642</span></a>                          if (<a class="var it11924" onMouseOver="hilite(11924)" onMouseOut="lolite()" onClick="logVariable('expiretime')" href="../../_variables/expiretime.html">$expiretime</a> &gt; <a class="var it3027" onMouseOver="hilite(3027)" onMouseOut="lolite()" onClick="logVariable('now')" href="../../_variables/now.html">$now</a>) {
<a name="l643"><span class="linenum"> 643</span></a>                              <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = <a class="phpfunction" onClick="logFunction('ceil')" href="../../_functions/ceil.html" onMouseOver="phpfuncPopup(event,'ceil')">ceil</a>((<a class="var it11924" onMouseOver="hilite(11924)" onMouseOut="lolite()" onClick="logVariable('expiretime')" href="../../_variables/expiretime.html">$expiretime</a> - <a class="var it3027" onMouseOver="hilite(3027)" onMouseOut="lolite()" onClick="logVariable('now')" href="../../_variables/now.html">$now</a>) / <a class="constant" onClick="logConstant('DAYSECS')" href="../../_constants/DAYSECS.html" onMouseOver="constPopup(event,'DAYSECS')">DAYSECS</a>);
<a name="l644"><span class="linenum"> 644</span></a>                          } else {
<a name="l645"><span class="linenum"> 645</span></a>                              <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = <a class="phpfunction" onClick="logFunction('floor')" href="../../_functions/floor.html" onMouseOver="phpfuncPopup(event,'floor')">floor</a>((<a class="var it11924" onMouseOver="hilite(11924)" onMouseOut="lolite()" onClick="logVariable('expiretime')" href="../../_variables/expiretime.html">$expiretime</a> - <a class="var it3027" onMouseOver="hilite(3027)" onMouseOut="lolite()" onClick="logVariable('now')" href="../../_variables/now.html">$now</a>) / <a class="constant" onClick="logConstant('DAYSECS')" href="../../_constants/DAYSECS.html" onMouseOver="constPopup(event,'DAYSECS')">DAYSECS</a>);
<a name="l646"><span class="linenum"> 646</span></a>                          }
<a name="l647"><span class="linenum"> 647</span></a>                      }
<a name="l648"><span class="linenum"> 648</span></a>                  }
<a name="l649"><span class="linenum"> 649</span></a>              }
<a name="l650"><span class="linenum"> 650</span></a>          } else {
<a name="l651"><span class="linenum"> 651</span></a>              <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('didtfindexpiretime', 'auth_ldap'));
<a name="l652"><span class="linenum"> 652</span></a>          }
<a name="l653"><span class="linenum"> 653</span></a>  
<a name="l654"><span class="linenum"> 654</span></a>          return <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l655"><span class="linenum"> 655</span></a>      }
<a name="l656"><span class="linenum"> 656</span></a>  
<a name="l657"><span class="linenum"> 657</span></a>      <span class="comment">/**</span>
<a name="l658"><span class="linenum"> 658</span></a>  <span class="comment">     * Syncronizes user fron external LDAP server to moodle user table</span>
<a name="l659"><span class="linenum"> 659</span></a>  <span class="comment">     *</span>
<a name="l660"><span class="linenum"> 660</span></a>  <span class="comment">     * Sync is now using username attribute.</span>
<a name="l661"><span class="linenum"> 661</span></a>  <span class="comment">     *</span>
<a name="l662"><span class="linenum"> 662</span></a>  <span class="comment">     * Syncing users removes or suspends users that dont exists anymore in external LDAP.</span>
<a name="l663"><span class="linenum"> 663</span></a>  <span class="comment">     * Creates new users and updates coursecreator status of users.</span>
<a name="l664"><span class="linenum"> 664</span></a>  <span class="comment">     *</span>
<a name="l665"><span class="linenum"> 665</span></a>  <span class="comment">     * @param bool $do_updates will do pull in data updates from LDAP if relevant</span>
<a name="l666"><span class="linenum"> 666</span></a>  <span class="comment">     */</span>
<a name="l667"><span class="linenum"> 667</span></a>      function <a class="function" onClick="logFunction('sync_users')" href="../../_functions/sync_users.html" onMouseOver="funcPopup(event,'sync_users')">sync_users</a>(<a class="var it33971" onMouseOver="hilite(33971)" onMouseOut="lolite()" onClick="logVariable('do_updates')" href="../../_variables/do_updates.html">$do_updates</a>=true) {
<a name="l668"><span class="linenum"> 668</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l669"><span class="linenum"> 669</span></a>  
<a name="l670"><span class="linenum"> 670</span></a>          <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('connectingldap', 'auth_ldap');
<a name="l671"><span class="linenum"> 671</span></a>          <a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="phpfunction" onClick="logFunction('ldap_connect')" href="../../_functions/ldap_connect.html" onMouseOver="phpfuncPopup(event,'ldap_connect')">ldap_connect</a>();
<a name="l672"><span class="linenum"> 672</span></a>  
<a name="l673"><span class="linenum"> 673</span></a>          <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_manager')" href="../../_functions/get_manager.html" onMouseOver="funcPopup(event,'get_manager')">get_manager</a>();
<a name="l674"><span class="linenum"> 674</span></a>  
<a name="l675"><span class="linenum"> 675</span></a>  <span class="comment">    /// Define table user to be created</span>
<a name="l676"><span class="linenum"> 676</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('tmp_extuser');
<a name="l677"><span class="linenum"> 677</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', <a class="constant" onClick="logConstant('XMLDB_UNSIGNED')" href="../../_constants/XMLDB_UNSIGNED.html" onMouseOver="constPopup(event,'XMLDB_UNSIGNED')">XMLDB_UNSIGNED</a>, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l678"><span class="linenum"> 678</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('username', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '100', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l679"><span class="linenum"> 679</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('mnethostid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', <a class="constant" onClick="logConstant('XMLDB_UNSIGNED')" href="../../_constants/XMLDB_UNSIGNED.html" onMouseOver="constPopup(event,'XMLDB_UNSIGNED')">XMLDB_UNSIGNED</a>, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l680"><span class="linenum"> 680</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l681"><span class="linenum"> 681</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('username', <a class="constant" onClick="logConstant('XMLDB_INDEX_UNIQUE')" href="../../_constants/XMLDB_INDEX_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_UNIQUE')">XMLDB_INDEX_UNIQUE</a>, array('mnethostid', 'username'));
<a name="l682"><span class="linenum"> 682</span></a>  
<a name="l683"><span class="linenum"> 683</span></a>          <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('creatingtemptable', 'auth_ldap', 'tmp_extuser');
<a name="l684"><span class="linenum"> 684</span></a>          <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_temp_table')" href="../../_functions/create_temp_table.html" onMouseOver="funcPopup(event,'create_temp_table')">create_temp_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l685"><span class="linenum"> 685</span></a>  
<a name="l686"><span class="linenum"> 686</span></a>  <span class="comment">        ////</span>
<a name="l687"><span class="linenum"> 687</span></a>  <span class="comment">        //// get user's list from ldap to sql in a scalable fashion</span>
<a name="l688"><span class="linenum"> 688</span></a>  <span class="comment">        ////</span>
<a name="l689"><span class="linenum"> 689</span></a>  <span class="comment">        // prepare some data we'll need</span>
<a name="l690"><span class="linenum"> 690</span></a>          <a class="var it1336" onMouseOver="hilite(1336)" onMouseOut="lolite()" onClick="logVariable('filter')" href="../../_variables/filter.html">$filter</a> = '(&amp;('.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_attribute.'=*)'.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;objectclass.')';
<a name="l691"><span class="linenum"> 691</span></a>  
<a name="l692"><span class="linenum"> 692</span></a>          <a class="var it2537" onMouseOver="hilite(2537)" onMouseOut="lolite()" onClick="logVariable('contexts')" href="../../_variables/contexts.html">$contexts</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(';', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;contexts);
<a name="l693"><span class="linenum"> 693</span></a>  
<a name="l694"><span class="linenum"> 694</span></a>          if (!empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;create_context)) {
<a name="l695"><span class="linenum"> 695</span></a>              <a class="phpfunction" onClick="logFunction('array_push')" href="../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>(<a class="var it2537" onMouseOver="hilite(2537)" onMouseOut="lolite()" onClick="logVariable('contexts')" href="../../_variables/contexts.html">$contexts</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;create_context);
<a name="l696"><span class="linenum"> 696</span></a>          }
<a name="l697"><span class="linenum"> 697</span></a>  
<a name="l698"><span class="linenum"> 698</span></a>          <a class="var it24474" onMouseOver="hilite(24474)" onMouseOut="lolite()" onClick="logVariable('ldap_pagedresults')" href="../../_variables/ldap_pagedresults.html">$ldap_pagedresults</a> = <a class="function" onClick="logFunction('ldap_paged_results_supported')" href="../../_functions/ldap_paged_results_supported.html" onMouseOver="funcPopup(event,'ldap_paged_results_supported')">ldap_paged_results_supported</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldap_version);
<a name="l699"><span class="linenum"> 699</span></a>          <a class="var it24479" onMouseOver="hilite(24479)" onMouseOut="lolite()" onClick="logVariable('ldap_cookie')" href="../../_variables/ldap_cookie.html">$ldap_cookie</a> = '';
<a name="l700"><span class="linenum"> 700</span></a>          foreach (<a class="var it2537" onMouseOver="hilite(2537)" onMouseOut="lolite()" onClick="logVariable('contexts')" href="../../_variables/contexts.html">$contexts</a> as <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>) {
<a name="l701"><span class="linenum"> 701</span></a>              <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l702"><span class="linenum"> 702</span></a>              if (empty(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>)) {
<a name="l703"><span class="linenum"> 703</span></a>                  continue;
<a name="l704"><span class="linenum"> 704</span></a>              }
<a name="l705"><span class="linenum"> 705</span></a>  
<a name="l706"><span class="linenum"> 706</span></a>              do {
<a name="l707"><span class="linenum"> 707</span></a>                  if (<a class="var it24474" onMouseOver="hilite(24474)" onMouseOut="lolite()" onClick="logVariable('ldap_pagedresults')" href="../../_variables/ldap_pagedresults.html">$ldap_pagedresults</a>) {
<a name="l708"><span class="linenum"> 708</span></a>                      ldap_control_paged_result(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;pagesize, true, <a class="var it24479" onMouseOver="hilite(24479)" onMouseOut="lolite()" onClick="logVariable('ldap_cookie')" href="../../_variables/ldap_cookie.html">$ldap_cookie</a>);
<a name="l709"><span class="linenum"> 709</span></a>                  }
<a name="l710"><span class="linenum"> 710</span></a>                  if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;search_sub) {
<a name="l711"><span class="linenum"> 711</span></a>  <span class="comment">                    // Use ldap_search to find first user from subtree.</span>
<a name="l712"><span class="linenum"> 712</span></a>                      <a class="var it24483" onMouseOver="hilite(24483)" onMouseOut="lolite()" onClick="logVariable('ldap_result')" href="../../_variables/ldap_result.html">$ldap_result</a> = <a class="phpfunction" onClick="logFunction('ldap_search')" href="../../_functions/ldap_search.html" onMouseOver="phpfuncPopup(event,'ldap_search')">ldap_search</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>, <a class="var it1336" onMouseOver="hilite(1336)" onMouseOut="lolite()" onClick="logVariable('filter')" href="../../_variables/filter.html">$filter</a>, array(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_attribute));
<a name="l713"><span class="linenum"> 713</span></a>                  } else {
<a name="l714"><span class="linenum"> 714</span></a>  <span class="comment">                    // Search only in this context.</span>
<a name="l715"><span class="linenum"> 715</span></a>                      <a class="var it24483" onMouseOver="hilite(24483)" onMouseOut="lolite()" onClick="logVariable('ldap_result')" href="../../_variables/ldap_result.html">$ldap_result</a> = <a class="phpfunction" onClick="logFunction('ldap_list')" href="../../_functions/ldap_list.html" onMouseOver="phpfuncPopup(event,'ldap_list')">ldap_list</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>, <a class="var it1336" onMouseOver="hilite(1336)" onMouseOut="lolite()" onClick="logVariable('filter')" href="../../_variables/filter.html">$filter</a>, array(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_attribute));
<a name="l716"><span class="linenum"> 716</span></a>                  }
<a name="l717"><span class="linenum"> 717</span></a>                  if(!<a class="var it24483" onMouseOver="hilite(24483)" onMouseOut="lolite()" onClick="logVariable('ldap_result')" href="../../_variables/ldap_result.html">$ldap_result</a>) {
<a name="l718"><span class="linenum"> 718</span></a>                      continue;
<a name="l719"><span class="linenum"> 719</span></a>                  }
<a name="l720"><span class="linenum"> 720</span></a>                  if (<a class="var it24474" onMouseOver="hilite(24474)" onMouseOut="lolite()" onClick="logVariable('ldap_pagedresults')" href="../../_variables/ldap_pagedresults.html">$ldap_pagedresults</a>) {
<a name="l721"><span class="linenum"> 721</span></a>                      ldap_control_paged_result_response(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it24483" onMouseOver="hilite(24483)" onMouseOut="lolite()" onClick="logVariable('ldap_result')" href="../../_variables/ldap_result.html">$ldap_result</a>, <a class="var it24479" onMouseOver="hilite(24479)" onMouseOut="lolite()" onClick="logVariable('ldap_cookie')" href="../../_variables/ldap_cookie.html">$ldap_cookie</a>);
<a name="l722"><span class="linenum"> 722</span></a>                  }
<a name="l723"><span class="linenum"> 723</span></a>                  if (<a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a> = @<a class="phpfunction" onClick="logFunction('ldap_first_entry')" href="../../_functions/ldap_first_entry.html" onMouseOver="phpfuncPopup(event,'ldap_first_entry')">ldap_first_entry</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it24483" onMouseOver="hilite(24483)" onMouseOut="lolite()" onClick="logVariable('ldap_result')" href="../../_variables/ldap_result.html">$ldap_result</a>)) {
<a name="l724"><span class="linenum"> 724</span></a>                      do {
<a name="l725"><span class="linenum"> 725</span></a>                          <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="phpfunction" onClick="logFunction('ldap_get_values_len')" href="../../_functions/ldap_get_values_len.html" onMouseOver="phpfuncPopup(event,'ldap_get_values_len')">ldap_get_values_len</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_attribute);
<a name="l726"><span class="linenum"> 726</span></a>                          <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>[0], <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding, 'utf-8');
<a name="l727"><span class="linenum"> 727</span></a>                          <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>);
<a name="l728"><span class="linenum"> 728</span></a>                          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_bulk_insert')" href="../../_functions/ldap_bulk_insert.html" onMouseOver="funcPopup(event,'ldap_bulk_insert')">ldap_bulk_insert</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>);
<a name="l729"><span class="linenum"> 729</span></a>                      } while (<a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a> = <a class="phpfunction" onClick="logFunction('ldap_next_entry')" href="../../_functions/ldap_next_entry.html" onMouseOver="phpfuncPopup(event,'ldap_next_entry')">ldap_next_entry</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a>));
<a name="l730"><span class="linenum"> 730</span></a>                  }
<a name="l731"><span class="linenum"> 731</span></a>                  unset(<a class="var it24483" onMouseOver="hilite(24483)" onMouseOut="lolite()" onClick="logVariable('ldap_result')" href="../../_variables/ldap_result.html">$ldap_result</a>); <span class="comment">// Free mem.</span>
<a name="l732"><span class="linenum"> 732</span></a>              } while (<a class="var it24474" onMouseOver="hilite(24474)" onMouseOut="lolite()" onClick="logVariable('ldap_pagedresults')" href="../../_variables/ldap_pagedresults.html">$ldap_pagedresults</a> &amp;&amp; <a class="var it24479" onMouseOver="hilite(24479)" onMouseOut="lolite()" onClick="logVariable('ldap_cookie')" href="../../_variables/ldap_cookie.html">$ldap_cookie</a> !== null &amp;&amp; <a class="var it24479" onMouseOver="hilite(24479)" onMouseOut="lolite()" onClick="logVariable('ldap_cookie')" href="../../_variables/ldap_cookie.html">$ldap_cookie</a> != '');
<a name="l733"><span class="linenum"> 733</span></a>          }
<a name="l734"><span class="linenum"> 734</span></a>  
<a name="l735"><span class="linenum"> 735</span></a>  <span class="comment">        // If LDAP paged results were used, the current connection must be completely</span>
<a name="l736"><span class="linenum"> 736</span></a>  <span class="comment">        // closed and a new one created, to work without paged results from here on.</span>
<a name="l737"><span class="linenum"> 737</span></a>          if (<a class="var it24474" onMouseOver="hilite(24474)" onMouseOut="lolite()" onClick="logVariable('ldap_pagedresults')" href="../../_variables/ldap_pagedresults.html">$ldap_pagedresults</a>) {
<a name="l738"><span class="linenum"> 738</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_close')" href="../../_functions/ldap_close.html" onMouseOver="funcPopup(event,'ldap_close')">ldap_close</a>(true);
<a name="l739"><span class="linenum"> 739</span></a>              <a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="phpfunction" onClick="logFunction('ldap_connect')" href="../../_functions/ldap_connect.html" onMouseOver="phpfuncPopup(event,'ldap_connect')">ldap_connect</a>();
<a name="l740"><span class="linenum"> 740</span></a>          }
<a name="l741"><span class="linenum"> 741</span></a>  
<a name="l742"><span class="linenum"> 742</span></a>  <span class="comment">        /// preserve our user database</span>
<a name="l743"><span class="linenum"> 743</span></a>  <span class="comment">        /// if the temp table is empty, it probably means that something went wrong, exit</span>
<a name="l744"><span class="linenum"> 744</span></a>  <span class="comment">        /// so as to avoid mass deletion of users; which is hard to undo</span>
<a name="l745"><span class="linenum"> 745</span></a>          <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records_sql')" href="../../_functions/count_records_sql.html" onMouseOver="funcPopup(event,'count_records_sql')">count_records_sql</a>('SELECT <a class="phpfunction" onClick="logFunction('COUNT')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">COUNT</a>(username) AS count, 1 FROM {tmp_extuser}');
<a name="l746"><span class="linenum"> 746</span></a>          if (<a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a> &lt; 1) {
<a name="l747"><span class="linenum"> 747</span></a>              <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('didntgetusersfromldap', 'auth_ldap');
<a name="l748"><span class="linenum"> 748</span></a>              exit;
<a name="l749"><span class="linenum"> 749</span></a>          } else {
<a name="l750"><span class="linenum"> 750</span></a>              <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('gotcountrecordsfromldap', 'auth_ldap', <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a>);
<a name="l751"><span class="linenum"> 751</span></a>          }
<a name="l752"><span class="linenum"> 752</span></a>  
<a name="l753"><span class="linenum"> 753</span></a>  
<a name="l754"><span class="linenum"> 754</span></a>  <span class="comment">/// User removal</span>
<a name="l755"><span class="linenum"> 755</span></a>  <span class="comment">        // Find users in DB that aren't in ldap -- to be removed!</span>
<a name="l756"><span class="linenum"> 756</span></a>  <span class="comment">        // this is still not as scalable (but how often do we mass delete?)</span>
<a name="l757"><span class="linenum"> 757</span></a>  
<a name="l758"><span class="linenum"> 758</span></a>          if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;removeuser == <a class="constant" onClick="logConstant('AUTH_REMOVEUSER_FULLDELETE')" href="../../_constants/AUTH_REMOVEUSER_FULLDELETE.html" onMouseOver="constPopup(event,'AUTH_REMOVEUSER_FULLDELETE')">AUTH_REMOVEUSER_FULLDELETE</a>) {
<a name="l759"><span class="linenum"> 759</span></a>              <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT u.*
<a name="l760"><span class="linenum"> 760</span></a>                        FROM {user} u
<a name="l761"><span class="linenum"> 761</span></a>                   LEFT JOIN {tmp_extuser} e <a class="function" onClick="logFunction('ON')" href="../../_functions/on.html" onMouseOver="funcPopup(event,'on')">ON</a> (u.username = e.username AND u.mnethostid = e.mnethostid)
<a name="l762"><span class="linenum"> 762</span></a>                       WHERE u.auth = :auth
<a name="l763"><span class="linenum"> 763</span></a>                             AND u.deleted = 0
<a name="l764"><span class="linenum"> 764</span></a>                             AND e.username IS NULL&quot;;
<a name="l765"><span class="linenum"> 765</span></a>              <a class="var it33972" onMouseOver="hilite(33972)" onMouseOut="lolite()" onClick="logVariable('remove_users')" href="../../_variables/remove_users.html">$remove_users</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, array('auth'=&gt;<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('authtype')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/authtype.html">authtype</a>));
<a name="l766"><span class="linenum"> 766</span></a>  
<a name="l767"><span class="linenum"> 767</span></a>              if (!empty(<a class="var it33972" onMouseOver="hilite(33972)" onMouseOut="lolite()" onClick="logVariable('remove_users')" href="../../_variables/remove_users.html">$remove_users</a>)) {
<a name="l768"><span class="linenum"> 768</span></a>                  <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('userentriestoremove', 'auth_ldap', <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it33972" onMouseOver="hilite(33972)" onMouseOut="lolite()" onClick="logVariable('remove_users')" href="../../_variables/remove_users.html">$remove_users</a>));
<a name="l769"><span class="linenum"> 769</span></a>                  foreach (<a class="var it33972" onMouseOver="hilite(33972)" onMouseOut="lolite()" onClick="logVariable('remove_users')" href="../../_variables/remove_users.html">$remove_users</a> as <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>) {
<a name="l770"><span class="linenum"> 770</span></a>                      if (<a class="function" onClick="logFunction('delete_user')" href="../../_functions/delete_user.html" onMouseOver="funcPopup(event,'delete_user')">delete_user</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>)) {
<a name="l771"><span class="linenum"> 771</span></a>                          echo &quot;\t&quot;; <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('auth_dbdeleteuser', 'auth_db', array('name'=&gt;<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>, 'id'=&gt;<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>)); echo &quot;\n&quot;;
<a name="l772"><span class="linenum"> 772</span></a>                      } else {
<a name="l773"><span class="linenum"> 773</span></a>                          echo &quot;\t&quot;; <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('auth_dbdeleteusererror', 'auth_db', <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>); echo &quot;\n&quot;;
<a name="l774"><span class="linenum"> 774</span></a>                      }
<a name="l775"><span class="linenum"> 775</span></a>                  }
<a name="l776"><span class="linenum"> 776</span></a>              } else {
<a name="l777"><span class="linenum"> 777</span></a>                  <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('nouserentriestoremove', 'auth_ldap');
<a name="l778"><span class="linenum"> 778</span></a>              }
<a name="l779"><span class="linenum"> 779</span></a>              unset(<a class="var it33972" onMouseOver="hilite(33972)" onMouseOut="lolite()" onClick="logVariable('remove_users')" href="../../_variables/remove_users.html">$remove_users</a>); <span class="comment">// Free mem!</span>
<a name="l780"><span class="linenum"> 780</span></a>  
<a name="l781"><span class="linenum"> 781</span></a>          } else if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;removeuser == <a class="constant" onClick="logConstant('AUTH_REMOVEUSER_SUSPEND')" href="../../_constants/AUTH_REMOVEUSER_SUSPEND.html" onMouseOver="constPopup(event,'AUTH_REMOVEUSER_SUSPEND')">AUTH_REMOVEUSER_SUSPEND</a>) {
<a name="l782"><span class="linenum"> 782</span></a>              <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT u.*
<a name="l783"><span class="linenum"> 783</span></a>                        FROM {user} u
<a name="l784"><span class="linenum"> 784</span></a>                   LEFT JOIN {tmp_extuser} e <a class="function" onClick="logFunction('ON')" href="../../_functions/on.html" onMouseOver="funcPopup(event,'on')">ON</a> (u.username = e.username AND u.mnethostid = e.mnethostid)
<a name="l785"><span class="linenum"> 785</span></a>                       WHERE u.auth = :auth
<a name="l786"><span class="linenum"> 786</span></a>                             AND u.deleted = 0
<a name="l787"><span class="linenum"> 787</span></a>                             AND u.suspended = 0
<a name="l788"><span class="linenum"> 788</span></a>                             AND e.username IS NULL&quot;;
<a name="l789"><span class="linenum"> 789</span></a>              <a class="var it33972" onMouseOver="hilite(33972)" onMouseOut="lolite()" onClick="logVariable('remove_users')" href="../../_variables/remove_users.html">$remove_users</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, array('auth'=&gt;<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('authtype')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/authtype.html">authtype</a>));
<a name="l790"><span class="linenum"> 790</span></a>  
<a name="l791"><span class="linenum"> 791</span></a>              if (!empty(<a class="var it33972" onMouseOver="hilite(33972)" onMouseOut="lolite()" onClick="logVariable('remove_users')" href="../../_variables/remove_users.html">$remove_users</a>)) {
<a name="l792"><span class="linenum"> 792</span></a>                  <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('userentriestoremove', 'auth_ldap', <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it33972" onMouseOver="hilite(33972)" onMouseOut="lolite()" onClick="logVariable('remove_users')" href="../../_variables/remove_users.html">$remove_users</a>));
<a name="l793"><span class="linenum"> 793</span></a>  
<a name="l794"><span class="linenum"> 794</span></a>                  foreach (<a class="var it33972" onMouseOver="hilite(33972)" onMouseOut="lolite()" onClick="logVariable('remove_users')" href="../../_variables/remove_users.html">$remove_users</a> as <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>) {
<a name="l795"><span class="linenum"> 795</span></a>                      <a class="var it13862" onMouseOver="hilite(13862)" onMouseOut="lolite()" onClick="logVariable('updateuser')" href="../../_variables/updateuser.html">$updateuser</a> = new stdClass();
<a name="l796"><span class="linenum"> 796</span></a>                      <a class="var it13862" onMouseOver="hilite(13862)" onMouseOut="lolite()" onClick="logVariable('updateuser')" href="../../_variables/updateuser.html">$updateuser</a>-&gt;<a onClick="logVariable('id')" class="var it44289" onMouseOver="hilite(44289)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l797"><span class="linenum"> 797</span></a>                      <a class="var it13862" onMouseOver="hilite(13862)" onMouseOut="lolite()" onClick="logVariable('updateuser')" href="../../_variables/updateuser.html">$updateuser</a>-&gt;<a onClick="logVariable('suspended')" class="var it44289" onMouseOver="hilite(44289)" onMouseOut="lolite()" href="../../_variables/suspended.html">suspended</a> = 1;
<a name="l798"><span class="linenum"> 798</span></a>                      <a class="function" onClick="logFunction('user_update_user')" href="../../_functions/user_update_user.html" onMouseOver="funcPopup(event,'user_update_user')">user_update_user</a>(<a class="var it13862" onMouseOver="hilite(13862)" onMouseOut="lolite()" onClick="logVariable('updateuser')" href="../../_variables/updateuser.html">$updateuser</a>, false);
<a name="l799"><span class="linenum"> 799</span></a>                      echo &quot;\t&quot;; <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('auth_dbsuspenduser', 'auth_db', array('name'=&gt;<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>, 'id'=&gt;<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>)); echo &quot;\n&quot;;
<a name="l800"><span class="linenum"> 800</span></a>                      \core\session\<a class="class" onClick="logClass('manager')" href="../../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('kill_user_sessions')" href="../../_functions/kill_user_sessions.html" onMouseOver="funcPopup(event,'kill_user_sessions')">kill_user_sessions</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l801"><span class="linenum"> 801</span></a>                  }
<a name="l802"><span class="linenum"> 802</span></a>              } else {
<a name="l803"><span class="linenum"> 803</span></a>                  <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('nouserentriestoremove', 'auth_ldap');
<a name="l804"><span class="linenum"> 804</span></a>              }
<a name="l805"><span class="linenum"> 805</span></a>              unset(<a class="var it33972" onMouseOver="hilite(33972)" onMouseOut="lolite()" onClick="logVariable('remove_users')" href="../../_variables/remove_users.html">$remove_users</a>); <span class="comment">// Free mem!</span>
<a name="l806"><span class="linenum"> 806</span></a>          }
<a name="l807"><span class="linenum"> 807</span></a>  
<a name="l808"><span class="linenum"> 808</span></a>  <span class="comment">/// Revive suspended users</span>
<a name="l809"><span class="linenum"> 809</span></a>          if (!empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;removeuser) and <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;removeuser == <a class="constant" onClick="logConstant('AUTH_REMOVEUSER_SUSPEND')" href="../../_constants/AUTH_REMOVEUSER_SUSPEND.html" onMouseOver="constPopup(event,'AUTH_REMOVEUSER_SUSPEND')">AUTH_REMOVEUSER_SUSPEND</a>) {
<a name="l810"><span class="linenum"> 810</span></a>              <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT u.id, u.username
<a name="l811"><span class="linenum"> 811</span></a>                        FROM {user} u
<a name="l812"><span class="linenum"> 812</span></a>                        JOIN {tmp_extuser} e <a class="function" onClick="logFunction('ON')" href="../../_functions/on.html" onMouseOver="funcPopup(event,'on')">ON</a> (u.username = e.username AND u.mnethostid = e.mnethostid)
<a name="l813"><span class="linenum"> 813</span></a>                       <a class="function" onClick="logFunction('WHERE')" href="../../_functions/where.html" onMouseOver="funcPopup(event,'where')">WHERE</a> (u.auth = 'nologin' <a class="function" onClick="logFunction('OR')" href="../../_functions/or.html" onMouseOver="funcPopup(event,'or')">OR</a> (u.auth = ? AND u.suspended = 1)) AND u.deleted = 0&quot;;
<a name="l814"><span class="linenum"> 814</span></a>  <span class="comment">            // Note: 'nologin' is there for backwards compatibility.</span>
<a name="l815"><span class="linenum"> 815</span></a>              <a class="var it33973" onMouseOver="hilite(33973)" onMouseOut="lolite()" onClick="logVariable('revive_users')" href="../../_variables/revive_users.html">$revive_users</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, array(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('authtype')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/authtype.html">authtype</a>));
<a name="l816"><span class="linenum"> 816</span></a>  
<a name="l817"><span class="linenum"> 817</span></a>              if (!empty(<a class="var it33973" onMouseOver="hilite(33973)" onMouseOut="lolite()" onClick="logVariable('revive_users')" href="../../_variables/revive_users.html">$revive_users</a>)) {
<a name="l818"><span class="linenum"> 818</span></a>                  <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('userentriestorevive', 'auth_ldap', <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it33973" onMouseOver="hilite(33973)" onMouseOut="lolite()" onClick="logVariable('revive_users')" href="../../_variables/revive_users.html">$revive_users</a>));
<a name="l819"><span class="linenum"> 819</span></a>  
<a name="l820"><span class="linenum"> 820</span></a>                  foreach (<a class="var it33973" onMouseOver="hilite(33973)" onMouseOut="lolite()" onClick="logVariable('revive_users')" href="../../_variables/revive_users.html">$revive_users</a> as <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>) {
<a name="l821"><span class="linenum"> 821</span></a>                      <a class="var it13862" onMouseOver="hilite(13862)" onMouseOut="lolite()" onClick="logVariable('updateuser')" href="../../_variables/updateuser.html">$updateuser</a> = new stdClass();
<a name="l822"><span class="linenum"> 822</span></a>                      <a class="var it13862" onMouseOver="hilite(13862)" onMouseOut="lolite()" onClick="logVariable('updateuser')" href="../../_variables/updateuser.html">$updateuser</a>-&gt;<a onClick="logVariable('id')" class="var it44289" onMouseOver="hilite(44289)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l823"><span class="linenum"> 823</span></a>                      <a class="var it13862" onMouseOver="hilite(13862)" onMouseOut="lolite()" onClick="logVariable('updateuser')" href="../../_variables/updateuser.html">$updateuser</a>-&gt;<a onClick="logVariable('auth')" class="var it44289" onMouseOver="hilite(44289)" onMouseOut="lolite()" href="../../_variables/auth.html">auth</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('authtype')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/authtype.html">authtype</a>;
<a name="l824"><span class="linenum"> 824</span></a>                      <a class="var it13862" onMouseOver="hilite(13862)" onMouseOut="lolite()" onClick="logVariable('updateuser')" href="../../_variables/updateuser.html">$updateuser</a>-&gt;<a onClick="logVariable('suspended')" class="var it44289" onMouseOver="hilite(44289)" onMouseOut="lolite()" href="../../_variables/suspended.html">suspended</a> = 0;
<a name="l825"><span class="linenum"> 825</span></a>                      <a class="function" onClick="logFunction('user_update_user')" href="../../_functions/user_update_user.html" onMouseOver="funcPopup(event,'user_update_user')">user_update_user</a>(<a class="var it13862" onMouseOver="hilite(13862)" onMouseOut="lolite()" onClick="logVariable('updateuser')" href="../../_variables/updateuser.html">$updateuser</a>, false);
<a name="l826"><span class="linenum"> 826</span></a>                      echo &quot;\t&quot;; <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('auth_dbreviveduser', 'auth_db', array('name'=&gt;<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>, 'id'=&gt;<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>)); echo &quot;\n&quot;;
<a name="l827"><span class="linenum"> 827</span></a>                  }
<a name="l828"><span class="linenum"> 828</span></a>              } else {
<a name="l829"><span class="linenum"> 829</span></a>                  <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('nouserentriestorevive', 'auth_ldap');
<a name="l830"><span class="linenum"> 830</span></a>              }
<a name="l831"><span class="linenum"> 831</span></a>  
<a name="l832"><span class="linenum"> 832</span></a>              unset(<a class="var it33973" onMouseOver="hilite(33973)" onMouseOut="lolite()" onClick="logVariable('revive_users')" href="../../_variables/revive_users.html">$revive_users</a>);
<a name="l833"><span class="linenum"> 833</span></a>          }
<a name="l834"><span class="linenum"> 834</span></a>  
<a name="l835"><span class="linenum"> 835</span></a>  
<a name="l836"><span class="linenum"> 836</span></a>  <span class="comment">/// User Updates - time-consuming (optional)</span>
<a name="l837"><span class="linenum"> 837</span></a>          if (<a class="var it33971" onMouseOver="hilite(33971)" onMouseOut="lolite()" onClick="logVariable('do_updates')" href="../../_variables/do_updates.html">$do_updates</a>) {
<a name="l838"><span class="linenum"> 838</span></a>  <span class="comment">            // Narrow down what fields we need to update</span>
<a name="l839"><span class="linenum"> 839</span></a>              <a class="var it33974" onMouseOver="hilite(33974)" onMouseOut="lolite()" onClick="logVariable('all_keys')" href="../../_variables/all_keys.html">$all_keys</a> = <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="phpfunction" onClick="logFunction('get_object_vars')" href="../../_functions/get_object_vars.html" onMouseOver="phpfuncPopup(event,'get_object_vars')">get_object_vars</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>));
<a name="l840"><span class="linenum"> 840</span></a>              <a class="var it33975" onMouseOver="hilite(33975)" onMouseOut="lolite()" onClick="logVariable('updatekeys')" href="../../_variables/updatekeys.html">$updatekeys</a> = array();
<a name="l841"><span class="linenum"> 841</span></a>              foreach (<a class="var it33974" onMouseOver="hilite(33974)" onMouseOut="lolite()" onClick="logVariable('all_keys')" href="../../_variables/all_keys.html">$all_keys</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>) {
<a name="l842"><span class="linenum"> 842</span></a>                  if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^field_updatelocal_(.+)$/', <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>, <a class="var it149" onMouseOver="hilite(149)" onMouseOut="lolite()" onClick="logVariable('match')" href="../../_variables/match.html">$match</a>)) {
<a name="l843"><span class="linenum"> 843</span></a>  <span class="comment">                    // If we have a field to update it from</span>
<a name="l844"><span class="linenum"> 844</span></a>  <span class="comment">                    // and it must be updated 'onlogin' we</span>
<a name="l845"><span class="linenum"> 845</span></a>  <span class="comment">                    // update it on cron</span>
<a name="l846"><span class="linenum"> 846</span></a>                      if (!empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;{'field_map_'.<a class="var it149" onMouseOver="hilite(149)" onMouseOut="lolite()" onClick="logVariable('match')" href="../../_variables/match.html">$match</a>[1]})
<a name="l847"><span class="linenum"> 847</span></a>                           and <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;{<a class="var it149" onMouseOver="hilite(149)" onMouseOut="lolite()" onClick="logVariable('match')" href="../../_variables/match.html">$match</a>[0]} === 'onlogin') {
<a name="l848"><span class="linenum"> 848</span></a>                          <a class="phpfunction" onClick="logFunction('array_push')" href="../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>(<a class="var it33975" onMouseOver="hilite(33975)" onMouseOut="lolite()" onClick="logVariable('updatekeys')" href="../../_variables/updatekeys.html">$updatekeys</a>, <a class="var it149" onMouseOver="hilite(149)" onMouseOut="lolite()" onClick="logVariable('match')" href="../../_variables/match.html">$match</a>[1]); <span class="comment">// the actual key name</span>
<a name="l849"><span class="linenum"> 849</span></a>                      }
<a name="l850"><span class="linenum"> 850</span></a>                  }
<a name="l851"><span class="linenum"> 851</span></a>              }
<a name="l852"><span class="linenum"> 852</span></a>              if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;suspended_attribute &amp;&amp; <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;sync_suspended) {
<a name="l853"><span class="linenum"> 853</span></a>                  <a class="var it33975" onMouseOver="hilite(33975)" onMouseOut="lolite()" onClick="logVariable('updatekeys')" href="../../_variables/updatekeys.html">$updatekeys</a>[] = 'suspended';
<a name="l854"><span class="linenum"> 854</span></a>              }
<a name="l855"><span class="linenum"> 855</span></a>              unset(<a class="var it33974" onMouseOver="hilite(33974)" onMouseOut="lolite()" onClick="logVariable('all_keys')" href="../../_variables/all_keys.html">$all_keys</a>); unset(<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>);
<a name="l856"><span class="linenum"> 856</span></a>  
<a name="l857"><span class="linenum"> 857</span></a>          } else {
<a name="l858"><span class="linenum"> 858</span></a>              <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('noupdatestobedone', 'auth_ldap');
<a name="l859"><span class="linenum"> 859</span></a>          }
<a name="l860"><span class="linenum"> 860</span></a>          if (<a class="var it33971" onMouseOver="hilite(33971)" onMouseOut="lolite()" onClick="logVariable('do_updates')" href="../../_variables/do_updates.html">$do_updates</a> and !empty(<a class="var it33975" onMouseOver="hilite(33975)" onMouseOut="lolite()" onClick="logVariable('updatekeys')" href="../../_variables/updatekeys.html">$updatekeys</a>)) { // run updates only if relevant
<a name="l861"><span class="linenum"> 861</span></a>              <a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>('SELECT u.username, u.id
<a name="l862"><span class="linenum"> 862</span></a>                                               FROM {user} u
<a name="l863"><span class="linenum"> 863</span></a>                                              WHERE u.deleted = 0 AND u.auth = ? AND u.mnethostid = ?',
<a name="l864"><span class="linenum"> 864</span></a>                                            array(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('authtype')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/authtype.html">authtype</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/mnet_localhost_id.html">mnet_localhost_id</a>));
<a name="l865"><span class="linenum"> 865</span></a>              if (!empty(<a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>)) {
<a name="l866"><span class="linenum"> 866</span></a>                  <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('userentriestoupdate', 'auth_ldap', <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>));
<a name="l867"><span class="linenum"> 867</span></a>  
<a name="l868"><span class="linenum"> 868</span></a>                  <a class="var it2136" onMouseOver="hilite(2136)" onMouseOut="lolite()" onClick="logVariable('sitecontext')" href="../../_variables/sitecontext.html">$sitecontext</a> = <a class="class" onClick="logClass('context_system')" href="../../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>();
<a name="l869"><span class="linenum"> 869</span></a>                  if (!empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;creators) and !empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;memberattribute)
<a name="l870"><span class="linenum"> 870</span></a>                    and <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('roles')" href="../../_variables/roles.html">$roles</a> = <a class="function" onClick="logFunction('get_archetype_roles')" href="../../_functions/get_archetype_roles.html" onMouseOver="funcPopup(event,'get_archetype_roles')">get_archetype_roles</a>('coursecreator')) {
<a name="l871"><span class="linenum"> 871</span></a>                      <a class="var it12208" onMouseOver="hilite(12208)" onMouseOut="lolite()" onClick="logVariable('creatorrole')" href="../../_variables/creatorrole.html">$creatorrole</a> = <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('roles')" href="../../_variables/roles.html">$roles</a>);      <span class="comment">// We can only use one, let's use the first one</span>
<a name="l872"><span class="linenum"> 872</span></a>                  } else {
<a name="l873"><span class="linenum"> 873</span></a>                      <a class="var it12208" onMouseOver="hilite(12208)" onMouseOut="lolite()" onClick="logVariable('creatorrole')" href="../../_variables/creatorrole.html">$creatorrole</a> = false;
<a name="l874"><span class="linenum"> 874</span></a>                  }
<a name="l875"><span class="linenum"> 875</span></a>  
<a name="l876"><span class="linenum"> 876</span></a>                  <a class="var it4224" onMouseOver="hilite(4224)" onMouseOut="lolite()" onClick="logVariable('transaction')" href="../../_variables/transaction.html">$transaction</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('start_delegated_transaction')" href="../../_functions/start_delegated_transaction.html" onMouseOver="funcPopup(event,'start_delegated_transaction')">start_delegated_transaction</a>();
<a name="l877"><span class="linenum"> 877</span></a>                  <a class="var it33976" onMouseOver="hilite(33976)" onMouseOut="lolite()" onClick="logVariable('xcount')" href="../../_variables/xcount.html">$xcount</a> = 0;
<a name="l878"><span class="linenum"> 878</span></a>                  <a class="var it33977" onMouseOver="hilite(33977)" onMouseOut="lolite()" onClick="logVariable('maxxcount')" href="../../_variables/maxxcount.html">$maxxcount</a> = 100;
<a name="l879"><span class="linenum"> 879</span></a>  
<a name="l880"><span class="linenum"> 880</span></a>                  foreach (<a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a> as <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>) {
<a name="l881"><span class="linenum"> 881</span></a>                      echo &quot;\t&quot;; <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('auth_dbupdatinguser', 'auth_db', array('name'=&gt;<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>, 'id'=&gt;<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l882"><span class="linenum"> 882</span></a>                      if (!<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('update_user_record')" href="../../_functions/update_user_record.html" onMouseOver="funcPopup(event,'update_user_record')">update_user_record</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>, <a class="var it33975" onMouseOver="hilite(33975)" onMouseOut="lolite()" onClick="logVariable('updatekeys')" href="../../_variables/updatekeys.html">$updatekeys</a>, true)) {
<a name="l883"><span class="linenum"> 883</span></a>                          echo ' - '.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('skipped');
<a name="l884"><span class="linenum"> 884</span></a>                      }
<a name="l885"><span class="linenum"> 885</span></a>                      echo &quot;\n&quot;;
<a name="l886"><span class="linenum"> 886</span></a>                      <a class="var it33976" onMouseOver="hilite(33976)" onMouseOut="lolite()" onClick="logVariable('xcount')" href="../../_variables/xcount.html">$xcount</a>++;
<a name="l887"><span class="linenum"> 887</span></a>  
<a name="l888"><span class="linenum"> 888</span></a>  <span class="comment">                    // Update course creators if needed</span>
<a name="l889"><span class="linenum"> 889</span></a>                      if (<a class="var it12208" onMouseOver="hilite(12208)" onMouseOut="lolite()" onClick="logVariable('creatorrole')" href="../../_variables/creatorrole.html">$creatorrole</a> !== false) {
<a name="l890"><span class="linenum"> 890</span></a>                          if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('iscreator')" href="../../_functions/iscreator.html" onMouseOver="funcPopup(event,'iscreator')">iscreator</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>)) {
<a name="l891"><span class="linenum"> 891</span></a>                              <a class="function" onClick="logFunction('role_assign')" href="../../_functions/role_assign.html" onMouseOver="funcPopup(event,'role_assign')">role_assign</a>(<a class="var it12208" onMouseOver="hilite(12208)" onMouseOut="lolite()" onClick="logVariable('creatorrole')" href="../../_variables/creatorrole.html">$creatorrole</a>-&gt;<a onClick="logVariable('id')" class="var it43848" onMouseOver="hilite(43848)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it2136" onMouseOver="hilite(2136)" onMouseOut="lolite()" onClick="logVariable('sitecontext')" href="../../_variables/sitecontext.html">$sitecontext</a>-&gt;<a onClick="logVariable('id')" class="var it44370" onMouseOver="hilite(44370)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('roleauth')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/roleauth.html">roleauth</a>);
<a name="l892"><span class="linenum"> 892</span></a>                          } else {
<a name="l893"><span class="linenum"> 893</span></a>                              <a class="function" onClick="logFunction('role_unassign')" href="../../_functions/role_unassign.html" onMouseOver="funcPopup(event,'role_unassign')">role_unassign</a>(<a class="var it12208" onMouseOver="hilite(12208)" onMouseOut="lolite()" onClick="logVariable('creatorrole')" href="../../_variables/creatorrole.html">$creatorrole</a>-&gt;<a onClick="logVariable('id')" class="var it43848" onMouseOver="hilite(43848)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it2136" onMouseOver="hilite(2136)" onMouseOut="lolite()" onClick="logVariable('sitecontext')" href="../../_variables/sitecontext.html">$sitecontext</a>-&gt;<a onClick="logVariable('id')" class="var it44370" onMouseOver="hilite(44370)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('roleauth')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/roleauth.html">roleauth</a>);
<a name="l894"><span class="linenum"> 894</span></a>                          }
<a name="l895"><span class="linenum"> 895</span></a>                      }
<a name="l896"><span class="linenum"> 896</span></a>                  }
<a name="l897"><span class="linenum"> 897</span></a>                  <a class="var it4224" onMouseOver="hilite(4224)" onMouseOut="lolite()" onClick="logVariable('transaction')" href="../../_variables/transaction.html">$transaction</a>-&gt;<a class="function" onClick="logFunction('allow_commit')" href="../../_functions/allow_commit.html" onMouseOver="funcPopup(event,'allow_commit')">allow_commit</a>();
<a name="l898"><span class="linenum"> 898</span></a>                  unset(<a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>); <span class="comment">// free mem</span>
<a name="l899"><span class="linenum"> 899</span></a>              }
<a name="l900"><span class="linenum"> 900</span></a>          } else { // end do updates
<a name="l901"><span class="linenum"> 901</span></a>              <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('noupdatestobedone', 'auth_ldap');
<a name="l902"><span class="linenum"> 902</span></a>          }
<a name="l903"><span class="linenum"> 903</span></a>  
<a name="l904"><span class="linenum"> 904</span></a>  <span class="comment">/// User Additions</span>
<a name="l905"><span class="linenum"> 905</span></a>  <span class="comment">        // Find users missing in DB that are in LDAP</span>
<a name="l906"><span class="linenum"> 906</span></a>  <span class="comment">        // and gives me a nifty object I don't want.</span>
<a name="l907"><span class="linenum"> 907</span></a>  <span class="comment">        // note: we do not care about deleted accounts anymore, this feature was replaced by suspending to nologin auth plugin</span>
<a name="l908"><span class="linenum"> 908</span></a>          <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = 'SELECT e.id, e.username
<a name="l909"><span class="linenum"> 909</span></a>                    FROM {tmp_extuser} e
<a name="l910"><span class="linenum"> 910</span></a>                    LEFT JOIN {user} u <a class="function" onClick="logFunction('ON')" href="../../_functions/on.html" onMouseOver="funcPopup(event,'on')">ON</a> (e.username = u.username AND e.mnethostid = u.mnethostid)
<a name="l911"><span class="linenum"> 911</span></a>                   WHERE u.id IS NULL';
<a name="l912"><span class="linenum"> 912</span></a>          <a class="var it33978" onMouseOver="hilite(33978)" onMouseOut="lolite()" onClick="logVariable('add_users')" href="../../_variables/add_users.html">$add_users</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>);
<a name="l913"><span class="linenum"> 913</span></a>  
<a name="l914"><span class="linenum"> 914</span></a>          if (!empty(<a class="var it33978" onMouseOver="hilite(33978)" onMouseOut="lolite()" onClick="logVariable('add_users')" href="../../_variables/add_users.html">$add_users</a>)) {
<a name="l915"><span class="linenum"> 915</span></a>              <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('userentriestoadd', 'auth_ldap', <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it33978" onMouseOver="hilite(33978)" onMouseOut="lolite()" onClick="logVariable('add_users')" href="../../_variables/add_users.html">$add_users</a>));
<a name="l916"><span class="linenum"> 916</span></a>  
<a name="l917"><span class="linenum"> 917</span></a>              <a class="var it2136" onMouseOver="hilite(2136)" onMouseOut="lolite()" onClick="logVariable('sitecontext')" href="../../_variables/sitecontext.html">$sitecontext</a> = <a class="class" onClick="logClass('context_system')" href="../../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>();
<a name="l918"><span class="linenum"> 918</span></a>              if (!empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;creators) and !empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;memberattribute)
<a name="l919"><span class="linenum"> 919</span></a>                and <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('roles')" href="../../_variables/roles.html">$roles</a> = <a class="function" onClick="logFunction('get_archetype_roles')" href="../../_functions/get_archetype_roles.html" onMouseOver="funcPopup(event,'get_archetype_roles')">get_archetype_roles</a>('coursecreator')) {
<a name="l920"><span class="linenum"> 920</span></a>                  <a class="var it12208" onMouseOver="hilite(12208)" onMouseOut="lolite()" onClick="logVariable('creatorrole')" href="../../_variables/creatorrole.html">$creatorrole</a> = <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('roles')" href="../../_variables/roles.html">$roles</a>);      <span class="comment">// We can only use one, let's use the first one</span>
<a name="l921"><span class="linenum"> 921</span></a>              } else {
<a name="l922"><span class="linenum"> 922</span></a>                  <a class="var it12208" onMouseOver="hilite(12208)" onMouseOut="lolite()" onClick="logVariable('creatorrole')" href="../../_variables/creatorrole.html">$creatorrole</a> = false;
<a name="l923"><span class="linenum"> 923</span></a>              }
<a name="l924"><span class="linenum"> 924</span></a>  
<a name="l925"><span class="linenum"> 925</span></a>              <a class="var it4224" onMouseOver="hilite(4224)" onMouseOut="lolite()" onClick="logVariable('transaction')" href="../../_variables/transaction.html">$transaction</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('start_delegated_transaction')" href="../../_functions/start_delegated_transaction.html" onMouseOver="funcPopup(event,'start_delegated_transaction')">start_delegated_transaction</a>();
<a name="l926"><span class="linenum"> 926</span></a>              foreach (<a class="var it33978" onMouseOver="hilite(33978)" onMouseOut="lolite()" onClick="logVariable('add_users')" href="../../_variables/add_users.html">$add_users</a> as <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>) {
<a name="l927"><span class="linenum"> 927</span></a>                  <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_userinfo_asobj')" href="../../_functions/get_userinfo_asobj.html" onMouseOver="funcPopup(event,'get_userinfo_asobj')">get_userinfo_asobj</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>);
<a name="l928"><span class="linenum"> 928</span></a>  
<a name="l929"><span class="linenum"> 929</span></a>  <span class="comment">                // Prep a few params</span>
<a name="l930"><span class="linenum"> 930</span></a>                  <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('modified')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/modified.html">modified</a>   = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l931"><span class="linenum"> 931</span></a>                  <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('confirmed')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/confirmed.html">confirmed</a>  = 1;
<a name="l932"><span class="linenum"> 932</span></a>                  <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/auth.html">auth</a>       = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('authtype')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/authtype.html">authtype</a>;
<a name="l933"><span class="linenum"> 933</span></a>                  <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/mnethostid.html">mnethostid</a> = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/mnet_localhost_id.html">mnet_localhost_id</a>;
<a name="l934"><span class="linenum"> 934</span></a>  <span class="comment">                // get_userinfo_asobj() might have replaced $user-&gt;username with the value</span>
<a name="l935"><span class="linenum"> 935</span></a>  <span class="comment">                // from the LDAP server (which can be mixed-case). Make sure it's lowercase</span>
<a name="l936"><span class="linenum"> 936</span></a>                  <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/username.html">username</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>));
<a name="l937"><span class="linenum"> 937</span></a>  <span class="comment">                // It isn't possible to just rely on the configured suspension attribute since</span>
<a name="l938"><span class="linenum"> 938</span></a>  <span class="comment">                // things like active directory use bit masks, other things using LDAP might</span>
<a name="l939"><span class="linenum"> 939</span></a>  <span class="comment">                // do different stuff as well.</span>
<a name="l940"><span class="linenum"> 940</span></a>  <span class="comment">                //</span>
<a name="l941"><span class="linenum"> 941</span></a>  <span class="comment">                // The cast to int is a workaround for MDL-53959.</span>
<a name="l942"><span class="linenum"> 942</span></a>                  <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('suspended')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/suspended.html">suspended</a> = (int)<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_user_suspended')" href="../../_functions/is_user_suspended.html" onMouseOver="funcPopup(event,'is_user_suspended')">is_user_suspended</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>);
<a name="l943"><span class="linenum"> 943</span></a>                  if (empty(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('lang')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/lang.html">lang</a>)) {
<a name="l944"><span class="linenum"> 944</span></a>                      <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('lang')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/lang.html">lang</a> = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('lang')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/lang.html">lang</a>;
<a name="l945"><span class="linenum"> 945</span></a>                  }
<a name="l946"><span class="linenum"> 946</span></a>                  if (empty(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('calendartype')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/calendartype.html">calendartype</a>)) {
<a name="l947"><span class="linenum"> 947</span></a>                      <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('calendartype')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/calendartype.html">calendartype</a> = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('calendartype')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/calendartype.html">calendartype</a>;
<a name="l948"><span class="linenum"> 948</span></a>                  }
<a name="l949"><span class="linenum"> 949</span></a>  
<a name="l950"><span class="linenum"> 950</span></a>                  <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> = <a class="function" onClick="logFunction('user_create_user')" href="../../_functions/user_create_user.html" onMouseOver="funcPopup(event,'user_create_user')">user_create_user</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>, false);
<a name="l951"><span class="linenum"> 951</span></a>                  echo &quot;\t&quot;; <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('auth_dbinsertuser', 'auth_db', array('name'=&gt;<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>, 'id'=&gt;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>)); echo &quot;\n&quot;;
<a name="l952"><span class="linenum"> 952</span></a>                  <a class="var it33979" onMouseOver="hilite(33979)" onMouseOut="lolite()" onClick="logVariable('euser')" href="../../_variables/euser.html">$euser</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user', array('id' =&gt; <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>));
<a name="l953"><span class="linenum"> 953</span></a>  
<a name="l954"><span class="linenum"> 954</span></a>                  if (!empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;forcechangepassword)) {
<a name="l955"><span class="linenum"> 955</span></a>                      <a class="function" onClick="logFunction('set_user_preference')" href="../../_functions/set_user_preference.html" onMouseOver="funcPopup(event,'set_user_preference')">set_user_preference</a>('auth_forcepasswordchange', 1, <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>);
<a name="l956"><span class="linenum"> 956</span></a>                  }
<a name="l957"><span class="linenum"> 957</span></a>  
<a name="l958"><span class="linenum"> 958</span></a>  <span class="comment">                // Add course creators if needed</span>
<a name="l959"><span class="linenum"> 959</span></a>                  if (<a class="var it12208" onMouseOver="hilite(12208)" onMouseOut="lolite()" onClick="logVariable('creatorrole')" href="../../_variables/creatorrole.html">$creatorrole</a> !== false and <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('iscreator')" href="../../_functions/iscreator.html" onMouseOver="funcPopup(event,'iscreator')">iscreator</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>)) {
<a name="l960"><span class="linenum"> 960</span></a>                      <a class="function" onClick="logFunction('role_assign')" href="../../_functions/role_assign.html" onMouseOver="funcPopup(event,'role_assign')">role_assign</a>(<a class="var it12208" onMouseOver="hilite(12208)" onMouseOut="lolite()" onClick="logVariable('creatorrole')" href="../../_variables/creatorrole.html">$creatorrole</a>-&gt;<a onClick="logVariable('id')" class="var it43848" onMouseOver="hilite(43848)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>, <a class="var it2136" onMouseOver="hilite(2136)" onMouseOut="lolite()" onClick="logVariable('sitecontext')" href="../../_variables/sitecontext.html">$sitecontext</a>-&gt;<a onClick="logVariable('id')" class="var it44370" onMouseOver="hilite(44370)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('roleauth')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/roleauth.html">roleauth</a>);
<a name="l961"><span class="linenum"> 961</span></a>                  }
<a name="l962"><span class="linenum"> 962</span></a>  
<a name="l963"><span class="linenum"> 963</span></a>              }
<a name="l964"><span class="linenum"> 964</span></a>              <a class="var it4224" onMouseOver="hilite(4224)" onMouseOut="lolite()" onClick="logVariable('transaction')" href="../../_variables/transaction.html">$transaction</a>-&gt;<a class="function" onClick="logFunction('allow_commit')" href="../../_functions/allow_commit.html" onMouseOver="funcPopup(event,'allow_commit')">allow_commit</a>();
<a name="l965"><span class="linenum"> 965</span></a>              unset(<a class="var it33978" onMouseOver="hilite(33978)" onMouseOut="lolite()" onClick="logVariable('add_users')" href="../../_variables/add_users.html">$add_users</a>); <span class="comment">// free mem</span>
<a name="l966"><span class="linenum"> 966</span></a>          } else {
<a name="l967"><span class="linenum"> 967</span></a>              <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('nouserstobeadded', 'auth_ldap');
<a name="l968"><span class="linenum"> 968</span></a>          }
<a name="l969"><span class="linenum"> 969</span></a>  
<a name="l970"><span class="linenum"> 970</span></a>          <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('drop_table')" href="../../_functions/drop_table.html" onMouseOver="funcPopup(event,'drop_table')">drop_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l971"><span class="linenum"> 971</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_close')" href="../../_functions/ldap_close.html" onMouseOver="funcPopup(event,'ldap_close')">ldap_close</a>();
<a name="l972"><span class="linenum"> 972</span></a>  
<a name="l973"><span class="linenum"> 973</span></a>          return true;
<a name="l974"><span class="linenum"> 974</span></a>      }
<a name="l975"><span class="linenum"> 975</span></a>  
<a name="l976"><span class="linenum"> 976</span></a>      <span class="comment">/**</span>
<a name="l977"><span class="linenum"> 977</span></a>  <span class="comment">     * Update a local user record from an external source.</span>
<a name="l978"><span class="linenum"> 978</span></a>  <span class="comment">     * This is a lighter version of the one in moodlelib -- won't do</span>
<a name="l979"><span class="linenum"> 979</span></a>  <span class="comment">     * expensive ops such as enrolment.</span>
<a name="l980"><span class="linenum"> 980</span></a>  <span class="comment">     *</span>
<a name="l981"><span class="linenum"> 981</span></a>  <span class="comment">     * If you don't pass $updatekeys, there is a performance hit and</span>
<a name="l982"><span class="linenum"> 982</span></a>  <span class="comment">     * values removed from LDAP won't be removed from moodle.</span>
<a name="l983"><span class="linenum"> 983</span></a>  <span class="comment">     *</span>
<a name="l984"><span class="linenum"> 984</span></a>  <span class="comment">     * @param string $username username</span>
<a name="l985"><span class="linenum"> 985</span></a>  <span class="comment">     * @param boolean $updatekeys true to update the local record with the external LDAP values.</span>
<a name="l986"><span class="linenum"> 986</span></a>  <span class="comment">     * @param bool $triggerevent set false if user_updated event should not be triggered.</span>
<a name="l987"><span class="linenum"> 987</span></a>  <span class="comment">     *             This will not affect user_password_updated event triggering.</span>
<a name="l988"><span class="linenum"> 988</span></a>  <span class="comment">     * @return stdClass|bool updated user record or false if there is no new info to update.</span>
<a name="l989"><span class="linenum"> 989</span></a>  <span class="comment">     */</span>
<a name="l990"><span class="linenum"> 990</span></a>      function <a class="function" onClick="logFunction('update_user_record')" href="../../_functions/update_user_record.html" onMouseOver="funcPopup(event,'update_user_record')">update_user_record</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, <a class="var it33975" onMouseOver="hilite(33975)" onMouseOut="lolite()" onClick="logVariable('updatekeys')" href="../../_variables/updatekeys.html">$updatekeys</a> = false, <a class="var it19995" onMouseOver="hilite(19995)" onMouseOut="lolite()" onClick="logVariable('triggerevent')" href="../../_variables/triggerevent.html">$triggerevent</a> = false) {
<a name="l991"><span class="linenum"> 991</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l992"><span class="linenum"> 992</span></a>  
<a name="l993"><span class="linenum"> 993</span></a>  <span class="comment">        // Just in case check text case</span>
<a name="l994"><span class="linenum"> 994</span></a>          <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>));
<a name="l995"><span class="linenum"> 995</span></a>  
<a name="l996"><span class="linenum"> 996</span></a>  <span class="comment">        // Get the current user record</span>
<a name="l997"><span class="linenum"> 997</span></a>          <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user', array('username'=&gt;<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, 'mnethostid'=&gt;<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/mnet_localhost_id.html">mnet_localhost_id</a>));
<a name="l998"><span class="linenum"> 998</span></a>          if (empty(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>)) { // trouble
<a name="l999"><span class="linenum"> 999</span></a>              <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('auth_dbusernotexist', 'auth_db', '', <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>));
<a name="l1000"><span class="linenum">1000</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('auth_dbusernotexist', 'auth_db', '', <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>);
<a name="l1001"><span class="linenum">1001</span></a>              die;
<a name="l1002"><span class="linenum">1002</span></a>          }
<a name="l1003"><span class="linenum">1003</span></a>  
<a name="l1004"><span class="linenum">1004</span></a>  <span class="comment">        // Protect the userid from being overwritten</span>
<a name="l1005"><span class="linenum">1005</span></a>          <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a> = <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l1006"><span class="linenum">1006</span></a>  
<a name="l1007"><span class="linenum">1007</span></a>          if (<a class="var it3199" onMouseOver="hilite(3199)" onMouseOut="lolite()" onClick="logVariable('newinfo')" href="../../_variables/newinfo.html">$newinfo</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_userinfo')" href="../../_functions/get_userinfo.html" onMouseOver="funcPopup(event,'get_userinfo')">get_userinfo</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>)) {
<a name="l1008"><span class="linenum">1008</span></a>              <a class="var it3199" onMouseOver="hilite(3199)" onMouseOut="lolite()" onClick="logVariable('newinfo')" href="../../_variables/newinfo.html">$newinfo</a> = <a class="function" onClick="logFunction('truncate_userinfo')" href="../../_functions/truncate_userinfo.html" onMouseOver="funcPopup(event,'truncate_userinfo')">truncate_userinfo</a>(<a class="var it3199" onMouseOver="hilite(3199)" onMouseOut="lolite()" onClick="logVariable('newinfo')" href="../../_variables/newinfo.html">$newinfo</a>);
<a name="l1009"><span class="linenum">1009</span></a>  
<a name="l1010"><span class="linenum">1010</span></a>              if (empty(<a class="var it33975" onMouseOver="hilite(33975)" onMouseOut="lolite()" onClick="logVariable('updatekeys')" href="../../_variables/updatekeys.html">$updatekeys</a>)) { // all keys? this does not support removing values
<a name="l1011"><span class="linenum">1011</span></a>                  <a class="var it33975" onMouseOver="hilite(33975)" onMouseOut="lolite()" onClick="logVariable('updatekeys')" href="../../_variables/updatekeys.html">$updatekeys</a> = <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it3199" onMouseOver="hilite(3199)" onMouseOut="lolite()" onClick="logVariable('newinfo')" href="../../_variables/newinfo.html">$newinfo</a>);
<a name="l1012"><span class="linenum">1012</span></a>              }
<a name="l1013"><span class="linenum">1013</span></a>  
<a name="l1014"><span class="linenum">1014</span></a>              if (!empty(<a class="var it33975" onMouseOver="hilite(33975)" onMouseOut="lolite()" onClick="logVariable('updatekeys')" href="../../_variables/updatekeys.html">$updatekeys</a>)) {
<a name="l1015"><span class="linenum">1015</span></a>                  <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a> = new stdClass();
<a name="l1016"><span class="linenum">1016</span></a>                  <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('id')" class="var it43022" onMouseOver="hilite(43022)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>;
<a name="l1017"><span class="linenum">1017</span></a>  <span class="comment">                // The cast to int is a workaround for MDL-53959.</span>
<a name="l1018"><span class="linenum">1018</span></a>                  <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('suspended')" class="var it43022" onMouseOver="hilite(43022)" onMouseOut="lolite()" href="../../_variables/suspended.html">suspended</a> = (int)<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_user_suspended')" href="../../_functions/is_user_suspended.html" onMouseOver="funcPopup(event,'is_user_suspended')">is_user_suspended</a>((object) <a class="var it3199" onMouseOver="hilite(3199)" onMouseOut="lolite()" onClick="logVariable('newinfo')" href="../../_variables/newinfo.html">$newinfo</a>);
<a name="l1019"><span class="linenum">1019</span></a>  
<a name="l1020"><span class="linenum">1020</span></a>                  foreach (<a class="var it33975" onMouseOver="hilite(33975)" onMouseOut="lolite()" onClick="logVariable('updatekeys')" href="../../_variables/updatekeys.html">$updatekeys</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>) {
<a name="l1021"><span class="linenum">1021</span></a>                      if (isset(<a class="var it3199" onMouseOver="hilite(3199)" onMouseOut="lolite()" onClick="logVariable('newinfo')" href="../../_variables/newinfo.html">$newinfo</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>])) {
<a name="l1022"><span class="linenum">1022</span></a>                          <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="var it3199" onMouseOver="hilite(3199)" onMouseOut="lolite()" onClick="logVariable('newinfo')" href="../../_variables/newinfo.html">$newinfo</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>];
<a name="l1023"><span class="linenum">1023</span></a>                      } else {
<a name="l1024"><span class="linenum">1024</span></a>                          <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = '';
<a name="l1025"><span class="linenum">1025</span></a>                      }
<a name="l1026"><span class="linenum">1026</span></a>  
<a name="l1027"><span class="linenum">1027</span></a>                      if (!empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;{'field_updatelocal_' . <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>})) {
<a name="l1028"><span class="linenum">1028</span></a>  <span class="comment">                        // Only update if it's changed.</span>
<a name="l1029"><span class="linenum">1029</span></a>                          if (<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;{<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>} != <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l1030"><span class="linenum">1030</span></a>                              <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>-&gt;<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l1031"><span class="linenum">1031</span></a>                          }
<a name="l1032"><span class="linenum">1032</span></a>                      }
<a name="l1033"><span class="linenum">1033</span></a>                  }
<a name="l1034"><span class="linenum">1034</span></a>                  <a class="function" onClick="logFunction('user_update_user')" href="../../_functions/user_update_user.html" onMouseOver="funcPopup(event,'user_update_user')">user_update_user</a>(<a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>, false, <a class="var it19995" onMouseOver="hilite(19995)" onMouseOut="lolite()" onClick="logVariable('triggerevent')" href="../../_variables/triggerevent.html">$triggerevent</a>);
<a name="l1035"><span class="linenum">1035</span></a>              }
<a name="l1036"><span class="linenum">1036</span></a>          } else {
<a name="l1037"><span class="linenum">1037</span></a>              return false;
<a name="l1038"><span class="linenum">1038</span></a>          }
<a name="l1039"><span class="linenum">1039</span></a>          return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user', array('id'=&gt;<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, 'deleted'=&gt;0));
<a name="l1040"><span class="linenum">1040</span></a>      }
<a name="l1041"><span class="linenum">1041</span></a>  
<a name="l1042"><span class="linenum">1042</span></a>      <span class="comment">/**</span>
<a name="l1043"><span class="linenum">1043</span></a>  <span class="comment">     * Bulk insert in SQL's temp table</span>
<a name="l1044"><span class="linenum">1044</span></a>  <span class="comment">     */</span>
<a name="l1045"><span class="linenum">1045</span></a>      function <a class="function" onClick="logFunction('ldap_bulk_insert')" href="../../_functions/ldap_bulk_insert.html" onMouseOver="funcPopup(event,'ldap_bulk_insert')">ldap_bulk_insert</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>) {
<a name="l1046"><span class="linenum">1046</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l1047"><span class="linenum">1047</span></a>  
<a name="l1048"><span class="linenum">1048</span></a>          <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>); <span class="comment">// usernames are __always__ lowercase.</span>
<a name="l1049"><span class="linenum">1049</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record_raw')" href="../../_functions/insert_record_raw.html" onMouseOver="funcPopup(event,'insert_record_raw')">insert_record_raw</a>('tmp_extuser', array('username'=&gt;<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>,
<a name="l1050"><span class="linenum">1050</span></a>                                                      'mnethostid'=&gt;<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/mnet_localhost_id.html">mnet_localhost_id</a>), false, true);
<a name="l1051"><span class="linenum">1051</span></a>          echo '.';
<a name="l1052"><span class="linenum">1052</span></a>      }
<a name="l1053"><span class="linenum">1053</span></a>  
<a name="l1054"><span class="linenum">1054</span></a>      <span class="comment">/**</span>
<a name="l1055"><span class="linenum">1055</span></a>  <span class="comment">     * Activates (enables) user in external LDAP so user can login</span>
<a name="l1056"><span class="linenum">1056</span></a>  <span class="comment">     *</span>
<a name="l1057"><span class="linenum">1057</span></a>  <span class="comment">     * @param mixed $username</span>
<a name="l1058"><span class="linenum">1058</span></a>  <span class="comment">     * @return boolean result</span>
<a name="l1059"><span class="linenum">1059</span></a>  <span class="comment">     */</span>
<a name="l1060"><span class="linenum">1060</span></a>      function <a class="function" onClick="logFunction('user_activate')" href="../../_functions/user_activate.html" onMouseOver="funcPopup(event,'user_activate')">user_activate</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>) {
<a name="l1061"><span class="linenum">1061</span></a>          <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, 'utf-8', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding);
<a name="l1062"><span class="linenum">1062</span></a>  
<a name="l1063"><span class="linenum">1063</span></a>          <a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="phpfunction" onClick="logFunction('ldap_connect')" href="../../_functions/ldap_connect.html" onMouseOver="phpfuncPopup(event,'ldap_connect')">ldap_connect</a>();
<a name="l1064"><span class="linenum">1064</span></a>  
<a name="l1065"><span class="linenum">1065</span></a>          <a class="var it33969" onMouseOver="hilite(33969)" onMouseOut="lolite()" onClick="logVariable('userdn')" href="../../_variables/userdn.html">$userdn</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_find_userdn')" href="../../_functions/ldap_find_userdn.html" onMouseOver="funcPopup(event,'ldap_find_userdn')">ldap_find_userdn</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a>);
<a name="l1066"><span class="linenum">1066</span></a>          switch (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_type)  {
<a name="l1067"><span class="linenum">1067</span></a>              case 'edir':
<a name="l1068"><span class="linenum">1068</span></a>                  <a class="var it3199" onMouseOver="hilite(3199)" onMouseOut="lolite()" onClick="logVariable('newinfo')" href="../../_variables/newinfo.html">$newinfo</a>['loginDisabled'] = 'FALSE';
<a name="l1069"><span class="linenum">1069</span></a>                  break;
<a name="l1070"><span class="linenum">1070</span></a>              case 'rfc2307':
<a name="l1071"><span class="linenum">1071</span></a>              case 'rfc2307bis':
<a name="l1072"><span class="linenum">1072</span></a>  <span class="comment">                // Remember that we add a '*' character in front of the</span>
<a name="l1073"><span class="linenum">1073</span></a>  <span class="comment">                // external password string to 'disable' the account. We just</span>
<a name="l1074"><span class="linenum">1074</span></a>  <span class="comment">                // need to remove it.</span>
<a name="l1075"><span class="linenum">1075</span></a>                  <a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a> = <a class="phpfunction" onClick="logFunction('ldap_read')" href="../../_functions/ldap_read.html" onMouseOver="phpfuncPopup(event,'ldap_read')">ldap_read</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33969" onMouseOver="hilite(33969)" onMouseOut="lolite()" onClick="logVariable('userdn')" href="../../_variables/userdn.html">$userdn</a>, '(objectClass=*)',
<a name="l1076"><span class="linenum">1076</span></a>                                  array('userPassword'));
<a name="l1077"><span class="linenum">1077</span></a>                  <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a> = <a class="phpfunction" onClick="logFunction('ldap_get_entries')" href="../../_functions/ldap_get_entries.html" onMouseOver="phpfuncPopup(event,'ldap_get_entries')">ldap_get_entries</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a>);
<a name="l1078"><span class="linenum">1078</span></a>                  <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>[0] = <a class="phpfunction" onClick="logFunction('array_change_key_case')" href="../../_functions/array_change_key_case.html" onMouseOver="phpfuncPopup(event,'array_change_key_case')">array_change_key_case</a>(<a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>[0], CASE_LOWER);
<a name="l1079"><span class="linenum">1079</span></a>                  <a class="var it3199" onMouseOver="hilite(3199)" onMouseOut="lolite()" onClick="logVariable('newinfo')" href="../../_variables/newinfo.html">$newinfo</a>['userPassword'] = <a class="phpfunction" onClick="logFunction('ltrim')" href="../../_functions/ltrim.html" onMouseOver="phpfuncPopup(event,'ltrim')">ltrim</a>(<a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>[0]['userpassword'][0], '*');
<a name="l1080"><span class="linenum">1080</span></a>                  break;
<a name="l1081"><span class="linenum">1081</span></a>              case 'ad':
<a name="l1082"><span class="linenum">1082</span></a>  <span class="comment">                // We need to unset the ACCOUNTDISABLE bit in the</span>
<a name="l1083"><span class="linenum">1083</span></a>  <span class="comment">                // userAccountControl attribute ( see</span>
<a name="l1084"><span class="linenum">1084</span></a>  <span class="comment">                // http://support.microsoft.com/kb/305144 )</span>
<a name="l1085"><span class="linenum">1085</span></a>                  <a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a> = <a class="phpfunction" onClick="logFunction('ldap_read')" href="../../_functions/ldap_read.html" onMouseOver="phpfuncPopup(event,'ldap_read')">ldap_read</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33969" onMouseOver="hilite(33969)" onMouseOut="lolite()" onClick="logVariable('userdn')" href="../../_variables/userdn.html">$userdn</a>, '(objectClass=*)',
<a name="l1086"><span class="linenum">1086</span></a>                                  array('userAccountControl'));
<a name="l1087"><span class="linenum">1087</span></a>                  <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a> = <a class="phpfunction" onClick="logFunction('ldap_get_entries')" href="../../_functions/ldap_get_entries.html" onMouseOver="phpfuncPopup(event,'ldap_get_entries')">ldap_get_entries</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a>);
<a name="l1088"><span class="linenum">1088</span></a>                  <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>[0] = <a class="phpfunction" onClick="logFunction('array_change_key_case')" href="../../_functions/array_change_key_case.html" onMouseOver="phpfuncPopup(event,'array_change_key_case')">array_change_key_case</a>(<a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>[0], CASE_LOWER);
<a name="l1089"><span class="linenum">1089</span></a>                  <a class="var it3199" onMouseOver="hilite(3199)" onMouseOut="lolite()" onClick="logVariable('newinfo')" href="../../_variables/newinfo.html">$newinfo</a>['userAccountControl'] = <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>[0]['useraccountcontrol'][0]
<a name="l1090"><span class="linenum">1090</span></a>                                                   &amp; (~<a class="constant" onClick="logConstant('AUTH_AD_ACCOUNTDISABLE')" href="../../_constants/AUTH_AD_ACCOUNTDISABLE.html" onMouseOver="constPopup(event,'AUTH_AD_ACCOUNTDISABLE')">AUTH_AD_ACCOUNTDISABLE</a>);
<a name="l1091"><span class="linenum">1091</span></a>                  break;
<a name="l1092"><span class="linenum">1092</span></a>              default:
<a name="l1093"><span class="linenum">1093</span></a>                  <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('user_activatenotsupportusertype', 'auth_ldap', '', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_type_name);
<a name="l1094"><span class="linenum">1094</span></a>          }
<a name="l1095"><span class="linenum">1095</span></a>          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = ldap_modify(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33969" onMouseOver="hilite(33969)" onMouseOut="lolite()" onClick="logVariable('userdn')" href="../../_variables/userdn.html">$userdn</a>, <a class="var it3199" onMouseOver="hilite(3199)" onMouseOut="lolite()" onClick="logVariable('newinfo')" href="../../_variables/newinfo.html">$newinfo</a>);
<a name="l1096"><span class="linenum">1096</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_close')" href="../../_functions/ldap_close.html" onMouseOver="funcPopup(event,'ldap_close')">ldap_close</a>();
<a name="l1097"><span class="linenum">1097</span></a>          return <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l1098"><span class="linenum">1098</span></a>      }
<a name="l1099"><span class="linenum">1099</span></a>  
<a name="l1100"><span class="linenum">1100</span></a>      <span class="comment">/**</span>
<a name="l1101"><span class="linenum">1101</span></a>  <span class="comment">     * Returns true if user should be coursecreator.</span>
<a name="l1102"><span class="linenum">1102</span></a>  <span class="comment">     *</span>
<a name="l1103"><span class="linenum">1103</span></a>  <span class="comment">     * @param mixed $username    username (without system magic quotes)</span>
<a name="l1104"><span class="linenum">1104</span></a>  <span class="comment">     * @return mixed result      null if course creators is not configured, boolean otherwise.</span>
<a name="l1105"><span class="linenum">1105</span></a>  <span class="comment">     */</span>
<a name="l1106"><span class="linenum">1106</span></a>      function <a class="function" onClick="logFunction('iscreator')" href="../../_functions/iscreator.html" onMouseOver="funcPopup(event,'iscreator')">iscreator</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>) {
<a name="l1107"><span class="linenum">1107</span></a>          if (empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;creators) or empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;memberattribute)) {
<a name="l1108"><span class="linenum">1108</span></a>              return null;
<a name="l1109"><span class="linenum">1109</span></a>          }
<a name="l1110"><span class="linenum">1110</span></a>  
<a name="l1111"><span class="linenum">1111</span></a>          <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, 'utf-8', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding);
<a name="l1112"><span class="linenum">1112</span></a>  
<a name="l1113"><span class="linenum">1113</span></a>          <a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="phpfunction" onClick="logFunction('ldap_connect')" href="../../_functions/ldap_connect.html" onMouseOver="phpfuncPopup(event,'ldap_connect')">ldap_connect</a>();
<a name="l1114"><span class="linenum">1114</span></a>  
<a name="l1115"><span class="linenum">1115</span></a>          if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;memberattribute_isdn) {
<a name="l1116"><span class="linenum">1116</span></a>              if(!(<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_find_userdn')" href="../../_functions/ldap_find_userdn.html" onMouseOver="funcPopup(event,'ldap_find_userdn')">ldap_find_userdn</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a>))) {
<a name="l1117"><span class="linenum">1117</span></a>                  return false;
<a name="l1118"><span class="linenum">1118</span></a>              }
<a name="l1119"><span class="linenum">1119</span></a>          } else {
<a name="l1120"><span class="linenum">1120</span></a>              <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a> = <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a>;
<a name="l1121"><span class="linenum">1121</span></a>          }
<a name="l1122"><span class="linenum">1122</span></a>  
<a name="l1123"><span class="linenum">1123</span></a>          <a class="var it33980" onMouseOver="hilite(33980)" onMouseOut="lolite()" onClick="logVariable('group_dns')" href="../../_variables/group_dns.html">$group_dns</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(';', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;creators);
<a name="l1124"><span class="linenum">1124</span></a>          <a class="var it1962" onMouseOver="hilite(1962)" onMouseOut="lolite()" onClick="logVariable('creator')" href="../../_variables/creator.html">$creator</a> = <a class="function" onClick="logFunction('ldap_isgroupmember')" href="../../_functions/ldap_isgroupmember.html" onMouseOver="funcPopup(event,'ldap_isgroupmember')">ldap_isgroupmember</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, <a class="var it33980" onMouseOver="hilite(33980)" onMouseOut="lolite()" onClick="logVariable('group_dns')" href="../../_variables/group_dns.html">$group_dns</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;memberattribute);
<a name="l1125"><span class="linenum">1125</span></a>  
<a name="l1126"><span class="linenum">1126</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_close')" href="../../_functions/ldap_close.html" onMouseOver="funcPopup(event,'ldap_close')">ldap_close</a>();
<a name="l1127"><span class="linenum">1127</span></a>  
<a name="l1128"><span class="linenum">1128</span></a>          return <a class="var it1962" onMouseOver="hilite(1962)" onMouseOut="lolite()" onClick="logVariable('creator')" href="../../_variables/creator.html">$creator</a>;
<a name="l1129"><span class="linenum">1129</span></a>      }
<a name="l1130"><span class="linenum">1130</span></a>  
<a name="l1131"><span class="linenum">1131</span></a>      <span class="comment">/**</span>
<a name="l1132"><span class="linenum">1132</span></a>  <span class="comment">     * Called when the user record is updated.</span>
<a name="l1133"><span class="linenum">1133</span></a>  <span class="comment">     *</span>
<a name="l1134"><span class="linenum">1134</span></a>  <span class="comment">     * Modifies user in external LDAP server. It takes olduser (before</span>
<a name="l1135"><span class="linenum">1135</span></a>  <span class="comment">     * changes) and newuser (after changes) compares information and</span>
<a name="l1136"><span class="linenum">1136</span></a>  <span class="comment">     * saves modified information to external LDAP server.</span>
<a name="l1137"><span class="linenum">1137</span></a>  <span class="comment">     *</span>
<a name="l1138"><span class="linenum">1138</span></a>  <span class="comment">     * @param mixed $olduser     Userobject before modifications    (without system magic quotes)</span>
<a name="l1139"><span class="linenum">1139</span></a>  <span class="comment">     * @param mixed $newuser     Userobject new modified userobject (without system magic quotes)</span>
<a name="l1140"><span class="linenum">1140</span></a>  <span class="comment">     * @return boolean result</span>
<a name="l1141"><span class="linenum">1141</span></a>  <span class="comment">     *</span>
<a name="l1142"><span class="linenum">1142</span></a>  <span class="comment">     */</span>
<a name="l1143"><span class="linenum">1143</span></a>      function <a class="function" onClick="logFunction('user_update')" href="../../_functions/user_update.html" onMouseOver="funcPopup(event,'user_update')">user_update</a>(<a class="var it12910" onMouseOver="hilite(12910)" onMouseOut="lolite()" onClick="logVariable('olduser')" href="../../_variables/olduser.html">$olduser</a>, <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>) {
<a name="l1144"><span class="linenum">1144</span></a>          global <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>;
<a name="l1145"><span class="linenum">1145</span></a>  
<a name="l1146"><span class="linenum">1146</span></a>          if (isset(<a class="var it12910" onMouseOver="hilite(12910)" onMouseOut="lolite()" onClick="logVariable('olduser')" href="../../_variables/olduser.html">$olduser</a>-&gt;<a onClick="logVariable('username')" class="var it43023" onMouseOver="hilite(43023)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>) and isset(<a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('username')" class="var it43022" onMouseOver="hilite(43022)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>) and <a class="var it12910" onMouseOver="hilite(12910)" onMouseOut="lolite()" onClick="logVariable('olduser')" href="../../_variables/olduser.html">$olduser</a>-&gt;<a onClick="logVariable('username')" class="var it43023" onMouseOver="hilite(43023)" onMouseOut="lolite()" href="../../_variables/username.html">username</a> != <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('username')" class="var it43022" onMouseOver="hilite(43022)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>) {
<a name="l1147"><span class="linenum">1147</span></a>              <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('renamingnotallowed', 'auth_ldap'));
<a name="l1148"><span class="linenum">1148</span></a>              return false;
<a name="l1149"><span class="linenum">1149</span></a>          }
<a name="l1150"><span class="linenum">1150</span></a>  
<a name="l1151"><span class="linenum">1151</span></a>          if (isset(<a class="var it12910" onMouseOver="hilite(12910)" onMouseOut="lolite()" onClick="logVariable('olduser')" href="../../_variables/olduser.html">$olduser</a>-&gt;<a onClick="logVariable('auth')" class="var it43023" onMouseOver="hilite(43023)" onMouseOut="lolite()" href="../../_variables/auth.html">auth</a>) and <a class="var it12910" onMouseOver="hilite(12910)" onMouseOut="lolite()" onClick="logVariable('olduser')" href="../../_variables/olduser.html">$olduser</a>-&gt;<a onClick="logVariable('auth')" class="var it43023" onMouseOver="hilite(43023)" onMouseOut="lolite()" href="../../_variables/auth.html">auth</a> != <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('authtype')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/authtype.html">authtype</a>) {
<a name="l1152"><span class="linenum">1152</span></a>              return true; <span class="comment">// just change auth and skip update</span>
<a name="l1153"><span class="linenum">1153</span></a>          }
<a name="l1154"><span class="linenum">1154</span></a>  
<a name="l1155"><span class="linenum">1155</span></a>          <a class="var it23948" onMouseOver="hilite(23948)" onMouseOut="lolite()" onClick="logVariable('attrmap')" href="../../_variables/attrmap.html">$attrmap</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_attributes')" href="../../_functions/ldap_attributes.html" onMouseOver="funcPopup(event,'ldap_attributes')">ldap_attributes</a>();
<a name="l1156"><span class="linenum">1156</span></a>  <span class="comment">        // Before doing anything else, make sure we really need to update anything</span>
<a name="l1157"><span class="linenum">1157</span></a>  <span class="comment">        // in the external LDAP server.</span>
<a name="l1158"><span class="linenum">1158</span></a>          <a class="var it33981" onMouseOver="hilite(33981)" onMouseOut="lolite()" onClick="logVariable('update_external')" href="../../_variables/update_external.html">$update_external</a> = false;
<a name="l1159"><span class="linenum">1159</span></a>          foreach (<a class="var it23948" onMouseOver="hilite(23948)" onMouseOut="lolite()" onClick="logVariable('attrmap')" href="../../_variables/attrmap.html">$attrmap</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it33982" onMouseOver="hilite(33982)" onMouseOut="lolite()" onClick="logVariable('ldapkeys')" href="../../_variables/ldapkeys.html">$ldapkeys</a>) {
<a name="l1160"><span class="linenum">1160</span></a>              if (!empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;{'field_updateremote_'.<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>})) {
<a name="l1161"><span class="linenum">1161</span></a>                  <a class="var it33981" onMouseOver="hilite(33981)" onMouseOut="lolite()" onClick="logVariable('update_external')" href="../../_variables/update_external.html">$update_external</a> = true;
<a name="l1162"><span class="linenum">1162</span></a>                  break;
<a name="l1163"><span class="linenum">1163</span></a>              }
<a name="l1164"><span class="linenum">1164</span></a>          }
<a name="l1165"><span class="linenum">1165</span></a>          if (!<a class="var it33981" onMouseOver="hilite(33981)" onMouseOut="lolite()" onClick="logVariable('update_external')" href="../../_variables/update_external.html">$update_external</a>) {
<a name="l1166"><span class="linenum">1166</span></a>              return true;
<a name="l1167"><span class="linenum">1167</span></a>          }
<a name="l1168"><span class="linenum">1168</span></a>  
<a name="l1169"><span class="linenum">1169</span></a>          <a class="var it33983" onMouseOver="hilite(33983)" onMouseOut="lolite()" onClick="logVariable('extoldusername')" href="../../_variables/extoldusername.html">$extoldusername</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it12910" onMouseOver="hilite(12910)" onMouseOut="lolite()" onClick="logVariable('olduser')" href="../../_variables/olduser.html">$olduser</a>-&gt;<a onClick="logVariable('username')" class="var it43023" onMouseOver="hilite(43023)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>, 'utf-8', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding);
<a name="l1170"><span class="linenum">1170</span></a>  
<a name="l1171"><span class="linenum">1171</span></a>          <a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="phpfunction" onClick="logFunction('ldap_connect')" href="../../_functions/ldap_connect.html" onMouseOver="phpfuncPopup(event,'ldap_connect')">ldap_connect</a>();
<a name="l1172"><span class="linenum">1172</span></a>  
<a name="l1173"><span class="linenum">1173</span></a>          <a class="var it23949" onMouseOver="hilite(23949)" onMouseOut="lolite()" onClick="logVariable('search_attribs')" href="../../_variables/search_attribs.html">$search_attribs</a> = array();
<a name="l1174"><span class="linenum">1174</span></a>          foreach (<a class="var it23948" onMouseOver="hilite(23948)" onMouseOut="lolite()" onClick="logVariable('attrmap')" href="../../_variables/attrmap.html">$attrmap</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>) {
<a name="l1175"><span class="linenum">1175</span></a>              if (!<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>)) {
<a name="l1176"><span class="linenum">1176</span></a>                  <a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a> = array(<a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>);
<a name="l1177"><span class="linenum">1177</span></a>              }
<a name="l1178"><span class="linenum">1178</span></a>              foreach (<a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a> as <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l1179"><span class="linenum">1179</span></a>                  if (!<a class="phpfunction" onClick="logFunction('in_array')" href="../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>, <a class="var it23949" onMouseOver="hilite(23949)" onMouseOut="lolite()" onClick="logVariable('search_attribs')" href="../../_variables/search_attribs.html">$search_attribs</a>)) {
<a name="l1180"><span class="linenum">1180</span></a>                      <a class="phpfunction" onClick="logFunction('array_push')" href="../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>(<a class="var it23949" onMouseOver="hilite(23949)" onMouseOut="lolite()" onClick="logVariable('search_attribs')" href="../../_variables/search_attribs.html">$search_attribs</a>, <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>);
<a name="l1181"><span class="linenum">1181</span></a>                  }
<a name="l1182"><span class="linenum">1182</span></a>              }
<a name="l1183"><span class="linenum">1183</span></a>          }
<a name="l1184"><span class="linenum">1184</span></a>  
<a name="l1185"><span class="linenum">1185</span></a>          if(!(<a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_find_userdn')" href="../../_functions/ldap_find_userdn.html" onMouseOver="funcPopup(event,'ldap_find_userdn')">ldap_find_userdn</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33983" onMouseOver="hilite(33983)" onMouseOut="lolite()" onClick="logVariable('extoldusername')" href="../../_variables/extoldusername.html">$extoldusername</a>))) {
<a name="l1186"><span class="linenum">1186</span></a>              return false;
<a name="l1187"><span class="linenum">1187</span></a>          }
<a name="l1188"><span class="linenum">1188</span></a>  
<a name="l1189"><span class="linenum">1189</span></a>          <a class="var it432" onMouseOver="hilite(432)" onMouseOut="lolite()" onClick="logVariable('success')" href="../../_variables/success.html">$success</a> = true;
<a name="l1190"><span class="linenum">1190</span></a>          <a class="var it33962" onMouseOver="hilite(33962)" onMouseOut="lolite()" onClick="logVariable('user_info_result')" href="../../_variables/user_info_result.html">$user_info_result</a> = <a class="phpfunction" onClick="logFunction('ldap_read')" href="../../_functions/ldap_read.html" onMouseOver="phpfuncPopup(event,'ldap_read')">ldap_read</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>, '(objectClass=*)', <a class="var it23949" onMouseOver="hilite(23949)" onMouseOut="lolite()" onClick="logVariable('search_attribs')" href="../../_variables/search_attribs.html">$search_attribs</a>);
<a name="l1191"><span class="linenum">1191</span></a>          if (<a class="var it33962" onMouseOver="hilite(33962)" onMouseOut="lolite()" onClick="logVariable('user_info_result')" href="../../_variables/user_info_result.html">$user_info_result</a>) {
<a name="l1192"><span class="linenum">1192</span></a>              <a class="var it33963" onMouseOver="hilite(33963)" onMouseOut="lolite()" onClick="logVariable('user_entry')" href="../../_variables/user_entry.html">$user_entry</a> = <a class="function" onClick="logFunction('ldap_get_entries_moodle')" href="../../_functions/ldap_get_entries_moodle.html" onMouseOver="funcPopup(event,'ldap_get_entries_moodle')">ldap_get_entries_moodle</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33962" onMouseOver="hilite(33962)" onMouseOut="lolite()" onClick="logVariable('user_info_result')" href="../../_variables/user_info_result.html">$user_info_result</a>);
<a name="l1193"><span class="linenum">1193</span></a>              if (empty(<a class="var it33963" onMouseOver="hilite(33963)" onMouseOut="lolite()" onClick="logVariable('user_entry')" href="../../_variables/user_entry.html">$user_entry</a>)) {
<a name="l1194"><span class="linenum">1194</span></a>                  <a class="var it8182" onMouseOver="hilite(8182)" onMouseOut="lolite()" onClick="logVariable('attribs')" href="../../_variables/attribs.html">$attribs</a> = <a class="function" onClick="logFunction('join')" href="../../_functions/join.html" onMouseOver="funcPopup(event,'join')">join</a> (', ', <a class="var it23949" onMouseOver="hilite(23949)" onMouseOut="lolite()" onClick="logVariable('search_attribs')" href="../../_variables/search_attribs.html">$search_attribs</a>);
<a name="l1195"><span class="linenum">1195</span></a>                  <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('updateusernotfound', 'auth_ldap',
<a name="l1196"><span class="linenum">1196</span></a>                                                            array('userdn'=&gt;<a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>,
<a name="l1197"><span class="linenum">1197</span></a>                                                                  'attribs'=&gt;<a class="var it8182" onMouseOver="hilite(8182)" onMouseOut="lolite()" onClick="logVariable('attribs')" href="../../_variables/attribs.html">$attribs</a>)));
<a name="l1198"><span class="linenum">1198</span></a>                  return false; <span class="comment">// old user not found!</span>
<a name="l1199"><span class="linenum">1199</span></a>              } else if (<a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it33963" onMouseOver="hilite(33963)" onMouseOut="lolite()" onClick="logVariable('user_entry')" href="../../_variables/user_entry.html">$user_entry</a>) &gt; 1) {
<a name="l1200"><span class="linenum">1200</span></a>                  <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('morethanoneuser', 'auth_ldap'));
<a name="l1201"><span class="linenum">1201</span></a>                  return false;
<a name="l1202"><span class="linenum">1202</span></a>              }
<a name="l1203"><span class="linenum">1203</span></a>  
<a name="l1204"><span class="linenum">1204</span></a>              <a class="var it33963" onMouseOver="hilite(33963)" onMouseOut="lolite()" onClick="logVariable('user_entry')" href="../../_variables/user_entry.html">$user_entry</a> = <a class="phpfunction" onClick="logFunction('array_change_key_case')" href="../../_functions/array_change_key_case.html" onMouseOver="phpfuncPopup(event,'array_change_key_case')">array_change_key_case</a>(<a class="var it33963" onMouseOver="hilite(33963)" onMouseOut="lolite()" onClick="logVariable('user_entry')" href="../../_variables/user_entry.html">$user_entry</a>[0], CASE_LOWER);
<a name="l1205"><span class="linenum">1205</span></a>  
<a name="l1206"><span class="linenum">1206</span></a>              foreach (<a class="var it23948" onMouseOver="hilite(23948)" onMouseOut="lolite()" onClick="logVariable('attrmap')" href="../../_variables/attrmap.html">$attrmap</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it33982" onMouseOver="hilite(33982)" onMouseOut="lolite()" onClick="logVariable('ldapkeys')" href="../../_variables/ldapkeys.html">$ldapkeys</a>) {
<a name="l1207"><span class="linenum">1207</span></a>                  <a class="var it19795" onMouseOver="hilite(19795)" onMouseOut="lolite()" onClick="logVariable('profilefield')" href="../../_variables/profilefield.html">$profilefield</a> = '';
<a name="l1208"><span class="linenum">1208</span></a>  <span class="comment">                // Only process if the moodle field ($key) has changed and we</span>
<a name="l1209"><span class="linenum">1209</span></a>  <span class="comment">                // are set to update LDAP with it</span>
<a name="l1210"><span class="linenum">1210</span></a>                  <a class="var it33984" onMouseOver="hilite(33984)" onMouseOut="lolite()" onClick="logVariable('customprofilefield')" href="../../_variables/customprofilefield.html">$customprofilefield</a> = 'profile_field_' . <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>;
<a name="l1211"><span class="linenum">1211</span></a>                  if (isset(<a class="var it12910" onMouseOver="hilite(12910)" onMouseOut="lolite()" onClick="logVariable('olduser')" href="../../_variables/olduser.html">$olduser</a>-&gt;<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>) and isset(<a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>-&gt;<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>)
<a name="l1212"><span class="linenum">1212</span></a>                      and (<a class="var it12910" onMouseOver="hilite(12910)" onMouseOut="lolite()" onClick="logVariable('olduser')" href="../../_variables/olduser.html">$olduser</a>-&gt;<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> !== <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>-&gt;<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>)) {
<a name="l1213"><span class="linenum">1213</span></a>                      <a class="var it19795" onMouseOver="hilite(19795)" onMouseOut="lolite()" onClick="logVariable('profilefield')" href="../../_variables/profilefield.html">$profilefield</a> = <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>;
<a name="l1214"><span class="linenum">1214</span></a>                  } else if (isset(<a class="var it12910" onMouseOver="hilite(12910)" onMouseOut="lolite()" onClick="logVariable('olduser')" href="../../_variables/olduser.html">$olduser</a>-&gt;<a class="var it33984" onMouseOver="hilite(33984)" onMouseOut="lolite()" onClick="logVariable('customprofilefield')" href="../../_variables/customprofilefield.html">$customprofilefield</a>) &amp;&amp; isset(<a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>-&gt;<a class="var it33984" onMouseOver="hilite(33984)" onMouseOut="lolite()" onClick="logVariable('customprofilefield')" href="../../_variables/customprofilefield.html">$customprofilefield</a>)
<a name="l1215"><span class="linenum">1215</span></a>                      &amp;&amp; <a class="var it12910" onMouseOver="hilite(12910)" onMouseOut="lolite()" onClick="logVariable('olduser')" href="../../_variables/olduser.html">$olduser</a>-&gt;<a class="var it33984" onMouseOver="hilite(33984)" onMouseOut="lolite()" onClick="logVariable('customprofilefield')" href="../../_variables/customprofilefield.html">$customprofilefield</a> !== <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>-&gt;<a class="var it33984" onMouseOver="hilite(33984)" onMouseOut="lolite()" onClick="logVariable('customprofilefield')" href="../../_variables/customprofilefield.html">$customprofilefield</a>) {
<a name="l1216"><span class="linenum">1216</span></a>                      <a class="var it19795" onMouseOver="hilite(19795)" onMouseOut="lolite()" onClick="logVariable('profilefield')" href="../../_variables/profilefield.html">$profilefield</a> = <a class="var it33984" onMouseOver="hilite(33984)" onMouseOut="lolite()" onClick="logVariable('customprofilefield')" href="../../_variables/customprofilefield.html">$customprofilefield</a>;
<a name="l1217"><span class="linenum">1217</span></a>                  }
<a name="l1218"><span class="linenum">1218</span></a>  
<a name="l1219"><span class="linenum">1219</span></a>                  if (!empty(<a class="var it19795" onMouseOver="hilite(19795)" onMouseOut="lolite()" onClick="logVariable('profilefield')" href="../../_variables/profilefield.html">$profilefield</a>) &amp;&amp; !empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;{'field_updateremote_' . <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>})) {
<a name="l1220"><span class="linenum">1220</span></a>  <span class="comment">                    // For ldap values that could be in more than one</span>
<a name="l1221"><span class="linenum">1221</span></a>  <span class="comment">                    // ldap key, we will do our best to match</span>
<a name="l1222"><span class="linenum">1222</span></a>  <span class="comment">                    // where they came from</span>
<a name="l1223"><span class="linenum">1223</span></a>                      <a class="var it33985" onMouseOver="hilite(33985)" onMouseOut="lolite()" onClick="logVariable('ambiguous')" href="../../_variables/ambiguous.html">$ambiguous</a> = true;
<a name="l1224"><span class="linenum">1224</span></a>                      <a class="var it549" onMouseOver="hilite(549)" onMouseOut="lolite()" onClick="logVariable('changed')" href="../../_variables/changed.html">$changed</a>   = false;
<a name="l1225"><span class="linenum">1225</span></a>                      if (!<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it33982" onMouseOver="hilite(33982)" onMouseOut="lolite()" onClick="logVariable('ldapkeys')" href="../../_variables/ldapkeys.html">$ldapkeys</a>)) {
<a name="l1226"><span class="linenum">1226</span></a>                          <a class="var it33982" onMouseOver="hilite(33982)" onMouseOut="lolite()" onClick="logVariable('ldapkeys')" href="../../_variables/ldapkeys.html">$ldapkeys</a> = array(<a class="var it33982" onMouseOver="hilite(33982)" onMouseOut="lolite()" onClick="logVariable('ldapkeys')" href="../../_variables/ldapkeys.html">$ldapkeys</a>);
<a name="l1227"><span class="linenum">1227</span></a>                      }
<a name="l1228"><span class="linenum">1228</span></a>                      if (<a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it33982" onMouseOver="hilite(33982)" onMouseOut="lolite()" onClick="logVariable('ldapkeys')" href="../../_variables/ldapkeys.html">$ldapkeys</a>) &lt; 2) {
<a name="l1229"><span class="linenum">1229</span></a>                          <a class="var it33985" onMouseOver="hilite(33985)" onMouseOut="lolite()" onClick="logVariable('ambiguous')" href="../../_variables/ambiguous.html">$ambiguous</a> = false;
<a name="l1230"><span class="linenum">1230</span></a>                      }
<a name="l1231"><span class="linenum">1231</span></a>  
<a name="l1232"><span class="linenum">1232</span></a>                      <a class="var it33986" onMouseOver="hilite(33986)" onMouseOut="lolite()" onClick="logVariable('nuvalue')" href="../../_variables/nuvalue.html">$nuvalue</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../../_variables/newuser.html">$newuser</a>-&gt;<a class="var it19795" onMouseOver="hilite(19795)" onMouseOut="lolite()" onClick="logVariable('profilefield')" href="../../_variables/profilefield.html">$profilefield</a>, 'utf-8', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding);
<a name="l1233"><span class="linenum">1233</span></a>                      empty(<a class="var it33986" onMouseOver="hilite(33986)" onMouseOut="lolite()" onClick="logVariable('nuvalue')" href="../../_variables/nuvalue.html">$nuvalue</a>) ? <a class="var it33986" onMouseOver="hilite(33986)" onMouseOut="lolite()" onClick="logVariable('nuvalue')" href="../../_variables/nuvalue.html">$nuvalue</a> = array() : <a class="var it33986" onMouseOver="hilite(33986)" onMouseOut="lolite()" onClick="logVariable('nuvalue')" href="../../_variables/nuvalue.html">$nuvalue</a>;
<a name="l1234"><span class="linenum">1234</span></a>                      <a class="var it33987" onMouseOver="hilite(33987)" onMouseOut="lolite()" onClick="logVariable('ouvalue')" href="../../_variables/ouvalue.html">$ouvalue</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it12910" onMouseOver="hilite(12910)" onMouseOut="lolite()" onClick="logVariable('olduser')" href="../../_variables/olduser.html">$olduser</a>-&gt;<a class="var it19795" onMouseOver="hilite(19795)" onMouseOut="lolite()" onClick="logVariable('profilefield')" href="../../_variables/profilefield.html">$profilefield</a>, 'utf-8', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding);
<a name="l1235"><span class="linenum">1235</span></a>  
<a name="l1236"><span class="linenum">1236</span></a>                      foreach (<a class="var it33982" onMouseOver="hilite(33982)" onMouseOut="lolite()" onClick="logVariable('ldapkeys')" href="../../_variables/ldapkeys.html">$ldapkeys</a> as <a class="var it33988" onMouseOver="hilite(33988)" onMouseOut="lolite()" onClick="logVariable('ldapkey')" href="../../_variables/ldapkey.html">$ldapkey</a>) {
<a name="l1237"><span class="linenum">1237</span></a>                          <a class="var it33988" onMouseOver="hilite(33988)" onMouseOut="lolite()" onClick="logVariable('ldapkey')" href="../../_variables/ldapkey.html">$ldapkey</a>   = <a class="var it33988" onMouseOver="hilite(33988)" onMouseOut="lolite()" onClick="logVariable('ldapkey')" href="../../_variables/ldapkey.html">$ldapkey</a>;
<a name="l1238"><span class="linenum">1238</span></a>                          <a class="var it33989" onMouseOver="hilite(33989)" onMouseOut="lolite()" onClick="logVariable('ldapvalue')" href="../../_variables/ldapvalue.html">$ldapvalue</a> = <a class="var it33963" onMouseOver="hilite(33963)" onMouseOut="lolite()" onClick="logVariable('user_entry')" href="../../_variables/user_entry.html">$user_entry</a>[<a class="var it33988" onMouseOver="hilite(33988)" onMouseOut="lolite()" onClick="logVariable('ldapkey')" href="../../_variables/ldapkey.html">$ldapkey</a>][0];
<a name="l1239"><span class="linenum">1239</span></a>                          if (!<a class="var it33985" onMouseOver="hilite(33985)" onMouseOut="lolite()" onClick="logVariable('ambiguous')" href="../../_variables/ambiguous.html">$ambiguous</a>) {
<a name="l1240"><span class="linenum">1240</span></a>  <span class="comment">                            // Skip update if the values already match</span>
<a name="l1241"><span class="linenum">1241</span></a>                              if (<a class="var it33986" onMouseOver="hilite(33986)" onMouseOut="lolite()" onClick="logVariable('nuvalue')" href="../../_variables/nuvalue.html">$nuvalue</a> !== <a class="var it33989" onMouseOver="hilite(33989)" onMouseOut="lolite()" onClick="logVariable('ldapvalue')" href="../../_variables/ldapvalue.html">$ldapvalue</a>) {
<a name="l1242"><span class="linenum">1242</span></a>  <span class="comment">                                // This might fail due to schema validation</span>
<a name="l1243"><span class="linenum">1243</span></a>                                  if (@ldap_modify(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>, array(<a class="var it33988" onMouseOver="hilite(33988)" onMouseOut="lolite()" onClick="logVariable('ldapkey')" href="../../_variables/ldapkey.html">$ldapkey</a> =&gt; <a class="var it33986" onMouseOver="hilite(33986)" onMouseOut="lolite()" onClick="logVariable('nuvalue')" href="../../_variables/nuvalue.html">$nuvalue</a>))) {
<a name="l1244"><span class="linenum">1244</span></a>                                      <a class="var it549" onMouseOver="hilite(549)" onMouseOut="lolite()" onClick="logVariable('changed')" href="../../_variables/changed.html">$changed</a> = true;
<a name="l1245"><span class="linenum">1245</span></a>                                      continue;
<a name="l1246"><span class="linenum">1246</span></a>                                  } else {
<a name="l1247"><span class="linenum">1247</span></a>                                      <a class="var it432" onMouseOver="hilite(432)" onMouseOut="lolite()" onClick="logVariable('success')" href="../../_variables/success.html">$success</a> = false;
<a name="l1248"><span class="linenum">1248</span></a>                                      <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a> ('updateremfail', 'auth_ldap',
<a name="l1249"><span class="linenum">1249</span></a>                                                                               array('errno'=&gt;<a class="phpfunction" onClick="logFunction('ldap_errno')" href="../../_functions/ldap_errno.html" onMouseOver="phpfuncPopup(event,'ldap_errno')">ldap_errno</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>),
<a name="l1250"><span class="linenum">1250</span></a>                                                                                     'errstring'=&gt;<a class="phpfunction" onClick="logFunction('ldap_err2str')" href="../../_functions/ldap_err2str.html" onMouseOver="phpfuncPopup(event,'ldap_err2str')">ldap_err2str</a>(<a class="phpfunction" onClick="logFunction('ldap_errno')" href="../../_functions/ldap_errno.html" onMouseOver="phpfuncPopup(event,'ldap_errno')">ldap_errno</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>)),
<a name="l1251"><span class="linenum">1251</span></a>                                                                                     'key'=&gt;<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>,
<a name="l1252"><span class="linenum">1252</span></a>                                                                                     'ouvalue'=&gt;<a class="var it33987" onMouseOver="hilite(33987)" onMouseOut="lolite()" onClick="logVariable('ouvalue')" href="../../_variables/ouvalue.html">$ouvalue</a>,
<a name="l1253"><span class="linenum">1253</span></a>                                                                                     'nuvalue'=&gt;<a class="var it33986" onMouseOver="hilite(33986)" onMouseOut="lolite()" onClick="logVariable('nuvalue')" href="../../_variables/nuvalue.html">$nuvalue</a>)));
<a name="l1254"><span class="linenum">1254</span></a>                                      continue;
<a name="l1255"><span class="linenum">1255</span></a>                                  }
<a name="l1256"><span class="linenum">1256</span></a>                              }
<a name="l1257"><span class="linenum">1257</span></a>                          } else {
<a name="l1258"><span class="linenum">1258</span></a>  <span class="comment">                            // Ambiguous. Value empty before in Moodle (and LDAP) - use</span>
<a name="l1259"><span class="linenum">1259</span></a>  <span class="comment">                            // 1st ldap candidate field, no need to guess</span>
<a name="l1260"><span class="linenum">1260</span></a>                              if (<a class="var it33987" onMouseOver="hilite(33987)" onMouseOut="lolite()" onClick="logVariable('ouvalue')" href="../../_variables/ouvalue.html">$ouvalue</a> === '') { // value empty before - use 1st ldap candidate
<a name="l1261"><span class="linenum">1261</span></a>  <span class="comment">                                // This might fail due to schema validation</span>
<a name="l1262"><span class="linenum">1262</span></a>                                  if (@ldap_modify(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>, array(<a class="var it33988" onMouseOver="hilite(33988)" onMouseOut="lolite()" onClick="logVariable('ldapkey')" href="../../_variables/ldapkey.html">$ldapkey</a> =&gt; <a class="var it33986" onMouseOver="hilite(33986)" onMouseOut="lolite()" onClick="logVariable('nuvalue')" href="../../_variables/nuvalue.html">$nuvalue</a>))) {
<a name="l1263"><span class="linenum">1263</span></a>                                      <a class="var it549" onMouseOver="hilite(549)" onMouseOut="lolite()" onClick="logVariable('changed')" href="../../_variables/changed.html">$changed</a> = true;
<a name="l1264"><span class="linenum">1264</span></a>                                      continue;
<a name="l1265"><span class="linenum">1265</span></a>                                  } else {
<a name="l1266"><span class="linenum">1266</span></a>                                      <a class="var it432" onMouseOver="hilite(432)" onMouseOut="lolite()" onClick="logVariable('success')" href="../../_variables/success.html">$success</a> = false;
<a name="l1267"><span class="linenum">1267</span></a>                                      <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a> ('updateremfail', 'auth_ldap',
<a name="l1268"><span class="linenum">1268</span></a>                                                                               array('errno'=&gt;<a class="phpfunction" onClick="logFunction('ldap_errno')" href="../../_functions/ldap_errno.html" onMouseOver="phpfuncPopup(event,'ldap_errno')">ldap_errno</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>),
<a name="l1269"><span class="linenum">1269</span></a>                                                                                     'errstring'=&gt;<a class="phpfunction" onClick="logFunction('ldap_err2str')" href="../../_functions/ldap_err2str.html" onMouseOver="phpfuncPopup(event,'ldap_err2str')">ldap_err2str</a>(<a class="phpfunction" onClick="logFunction('ldap_errno')" href="../../_functions/ldap_errno.html" onMouseOver="phpfuncPopup(event,'ldap_errno')">ldap_errno</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>)),
<a name="l1270"><span class="linenum">1270</span></a>                                                                                     'key'=&gt;<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>,
<a name="l1271"><span class="linenum">1271</span></a>                                                                                     'ouvalue'=&gt;<a class="var it33987" onMouseOver="hilite(33987)" onMouseOut="lolite()" onClick="logVariable('ouvalue')" href="../../_variables/ouvalue.html">$ouvalue</a>,
<a name="l1272"><span class="linenum">1272</span></a>                                                                                     'nuvalue'=&gt;<a class="var it33986" onMouseOver="hilite(33986)" onMouseOut="lolite()" onClick="logVariable('nuvalue')" href="../../_variables/nuvalue.html">$nuvalue</a>)));
<a name="l1273"><span class="linenum">1273</span></a>                                      continue;
<a name="l1274"><span class="linenum">1274</span></a>                                  }
<a name="l1275"><span class="linenum">1275</span></a>                              }
<a name="l1276"><span class="linenum">1276</span></a>  
<a name="l1277"><span class="linenum">1277</span></a>  <span class="comment">                            // We found which ldap key to update!</span>
<a name="l1278"><span class="linenum">1278</span></a>                              if (<a class="var it33987" onMouseOver="hilite(33987)" onMouseOut="lolite()" onClick="logVariable('ouvalue')" href="../../_variables/ouvalue.html">$ouvalue</a> !== '' and <a class="var it33987" onMouseOver="hilite(33987)" onMouseOut="lolite()" onClick="logVariable('ouvalue')" href="../../_variables/ouvalue.html">$ouvalue</a> === <a class="var it33989" onMouseOver="hilite(33989)" onMouseOut="lolite()" onClick="logVariable('ldapvalue')" href="../../_variables/ldapvalue.html">$ldapvalue</a> ) {
<a name="l1279"><span class="linenum">1279</span></a>  <span class="comment">                                // This might fail due to schema validation</span>
<a name="l1280"><span class="linenum">1280</span></a>                                  if (@ldap_modify(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>, array(<a class="var it33988" onMouseOver="hilite(33988)" onMouseOut="lolite()" onClick="logVariable('ldapkey')" href="../../_variables/ldapkey.html">$ldapkey</a> =&gt; <a class="var it33986" onMouseOver="hilite(33986)" onMouseOut="lolite()" onClick="logVariable('nuvalue')" href="../../_variables/nuvalue.html">$nuvalue</a>))) {
<a name="l1281"><span class="linenum">1281</span></a>                                      <a class="var it549" onMouseOver="hilite(549)" onMouseOut="lolite()" onClick="logVariable('changed')" href="../../_variables/changed.html">$changed</a> = true;
<a name="l1282"><span class="linenum">1282</span></a>                                      continue;
<a name="l1283"><span class="linenum">1283</span></a>                                  } else {
<a name="l1284"><span class="linenum">1284</span></a>                                      <a class="var it432" onMouseOver="hilite(432)" onMouseOut="lolite()" onClick="logVariable('success')" href="../../_variables/success.html">$success</a> = false;
<a name="l1285"><span class="linenum">1285</span></a>                                      <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a> ('updateremfail', 'auth_ldap',
<a name="l1286"><span class="linenum">1286</span></a>                                                                               array('errno'=&gt;<a class="phpfunction" onClick="logFunction('ldap_errno')" href="../../_functions/ldap_errno.html" onMouseOver="phpfuncPopup(event,'ldap_errno')">ldap_errno</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>),
<a name="l1287"><span class="linenum">1287</span></a>                                                                                     'errstring'=&gt;<a class="phpfunction" onClick="logFunction('ldap_err2str')" href="../../_functions/ldap_err2str.html" onMouseOver="phpfuncPopup(event,'ldap_err2str')">ldap_err2str</a>(<a class="phpfunction" onClick="logFunction('ldap_errno')" href="../../_functions/ldap_errno.html" onMouseOver="phpfuncPopup(event,'ldap_errno')">ldap_errno</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>)),
<a name="l1288"><span class="linenum">1288</span></a>                                                                                     'key'=&gt;<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>,
<a name="l1289"><span class="linenum">1289</span></a>                                                                                     'ouvalue'=&gt;<a class="var it33987" onMouseOver="hilite(33987)" onMouseOut="lolite()" onClick="logVariable('ouvalue')" href="../../_variables/ouvalue.html">$ouvalue</a>,
<a name="l1290"><span class="linenum">1290</span></a>                                                                                     'nuvalue'=&gt;<a class="var it33986" onMouseOver="hilite(33986)" onMouseOut="lolite()" onClick="logVariable('nuvalue')" href="../../_variables/nuvalue.html">$nuvalue</a>)));
<a name="l1291"><span class="linenum">1291</span></a>                                      continue;
<a name="l1292"><span class="linenum">1292</span></a>                                  }
<a name="l1293"><span class="linenum">1293</span></a>                              }
<a name="l1294"><span class="linenum">1294</span></a>                          }
<a name="l1295"><span class="linenum">1295</span></a>                      }
<a name="l1296"><span class="linenum">1296</span></a>  
<a name="l1297"><span class="linenum">1297</span></a>                      if (<a class="var it33985" onMouseOver="hilite(33985)" onMouseOut="lolite()" onClick="logVariable('ambiguous')" href="../../_variables/ambiguous.html">$ambiguous</a> and !<a class="var it549" onMouseOver="hilite(549)" onMouseOut="lolite()" onClick="logVariable('changed')" href="../../_variables/changed.html">$changed</a>) {
<a name="l1298"><span class="linenum">1298</span></a>                          <a class="var it432" onMouseOver="hilite(432)" onMouseOut="lolite()" onClick="logVariable('success')" href="../../_variables/success.html">$success</a> = false;
<a name="l1299"><span class="linenum">1299</span></a>                          <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a> ('updateremfailamb', 'auth_ldap',
<a name="l1300"><span class="linenum">1300</span></a>                                                                   array('key'=&gt;<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>,
<a name="l1301"><span class="linenum">1301</span></a>                                                                         'ouvalue'=&gt;<a class="var it33987" onMouseOver="hilite(33987)" onMouseOut="lolite()" onClick="logVariable('ouvalue')" href="../../_variables/ouvalue.html">$ouvalue</a>,
<a name="l1302"><span class="linenum">1302</span></a>                                                                         'nuvalue'=&gt;<a class="var it33986" onMouseOver="hilite(33986)" onMouseOut="lolite()" onClick="logVariable('nuvalue')" href="../../_variables/nuvalue.html">$nuvalue</a>)));
<a name="l1303"><span class="linenum">1303</span></a>                      }
<a name="l1304"><span class="linenum">1304</span></a>                  }
<a name="l1305"><span class="linenum">1305</span></a>              }
<a name="l1306"><span class="linenum">1306</span></a>          } else {
<a name="l1307"><span class="linenum">1307</span></a>              <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a> ('usernotfound', 'auth_ldap'));
<a name="l1308"><span class="linenum">1308</span></a>              <a class="var it432" onMouseOver="hilite(432)" onMouseOut="lolite()" onClick="logVariable('success')" href="../../_variables/success.html">$success</a> = false;
<a name="l1309"><span class="linenum">1309</span></a>          }
<a name="l1310"><span class="linenum">1310</span></a>  
<a name="l1311"><span class="linenum">1311</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_close')" href="../../_functions/ldap_close.html" onMouseOver="funcPopup(event,'ldap_close')">ldap_close</a>();
<a name="l1312"><span class="linenum">1312</span></a>          return <a class="var it432" onMouseOver="hilite(432)" onMouseOut="lolite()" onClick="logVariable('success')" href="../../_variables/success.html">$success</a>;
<a name="l1313"><span class="linenum">1313</span></a>  
<a name="l1314"><span class="linenum">1314</span></a>      }
<a name="l1315"><span class="linenum">1315</span></a>  
<a name="l1316"><span class="linenum">1316</span></a>      <span class="comment">/**</span>
<a name="l1317"><span class="linenum">1317</span></a>  <span class="comment">     * Changes userpassword in LDAP</span>
<a name="l1318"><span class="linenum">1318</span></a>  <span class="comment">     *</span>
<a name="l1319"><span class="linenum">1319</span></a>  <span class="comment">     * Called when the user password is updated. It assumes it is</span>
<a name="l1320"><span class="linenum">1320</span></a>  <span class="comment">     * called by an admin or that you've otherwise checked the user's</span>
<a name="l1321"><span class="linenum">1321</span></a>  <span class="comment">     * credentials</span>
<a name="l1322"><span class="linenum">1322</span></a>  <span class="comment">     *</span>
<a name="l1323"><span class="linenum">1323</span></a>  <span class="comment">     * @param  object  $user        User table object</span>
<a name="l1324"><span class="linenum">1324</span></a>  <span class="comment">     * @param  string  $newpassword Plaintext password (not crypted/md5'ed)</span>
<a name="l1325"><span class="linenum">1325</span></a>  <span class="comment">     * @return boolean result</span>
<a name="l1326"><span class="linenum">1326</span></a>  <span class="comment">     *</span>
<a name="l1327"><span class="linenum">1327</span></a>  <span class="comment">     */</span>
<a name="l1328"><span class="linenum">1328</span></a>      function <a class="function" onClick="logFunction('user_update_password')" href="../../_functions/user_update_password.html" onMouseOver="funcPopup(event,'user_update_password')">user_update_password</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>, <a class="var it3329" onMouseOver="hilite(3329)" onMouseOut="lolite()" onClick="logVariable('newpassword')" href="../../_variables/newpassword.html">$newpassword</a>) {
<a name="l1329"><span class="linenum">1329</span></a>          global <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>;
<a name="l1330"><span class="linenum">1330</span></a>  
<a name="l1331"><span class="linenum">1331</span></a>          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = false;
<a name="l1332"><span class="linenum">1332</span></a>          <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a> = <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>;
<a name="l1333"><span class="linenum">1333</span></a>  
<a name="l1334"><span class="linenum">1334</span></a>          <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, 'utf-8', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding);
<a name="l1335"><span class="linenum">1335</span></a>          <a class="var it33956" onMouseOver="hilite(33956)" onMouseOut="lolite()" onClick="logVariable('extpassword')" href="../../_variables/extpassword.html">$extpassword</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it3329" onMouseOver="hilite(3329)" onMouseOut="lolite()" onClick="logVariable('newpassword')" href="../../_variables/newpassword.html">$newpassword</a>, 'utf-8', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding);
<a name="l1336"><span class="linenum">1336</span></a>  
<a name="l1337"><span class="linenum">1337</span></a>          switch (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;passtype) {
<a name="l1338"><span class="linenum">1338</span></a>              case 'md5':
<a name="l1339"><span class="linenum">1339</span></a>                  <a class="var it33956" onMouseOver="hilite(33956)" onMouseOut="lolite()" onClick="logVariable('extpassword')" href="../../_variables/extpassword.html">$extpassword</a> = '{MD5}' . <a class="phpfunction" onClick="logFunction('base64_encode')" href="../../_functions/base64_encode.html" onMouseOver="phpfuncPopup(event,'base64_encode')">base64_encode</a>(<a class="phpfunction" onClick="logFunction('pack')" href="../../_functions/pack.html" onMouseOver="phpfuncPopup(event,'pack')">pack</a>('H*', md5(<a class="var it33956" onMouseOver="hilite(33956)" onMouseOut="lolite()" onClick="logVariable('extpassword')" href="../../_variables/extpassword.html">$extpassword</a>)));
<a name="l1340"><span class="linenum">1340</span></a>                  break;
<a name="l1341"><span class="linenum">1341</span></a>              case 'sha1':
<a name="l1342"><span class="linenum">1342</span></a>                  <a class="var it33956" onMouseOver="hilite(33956)" onMouseOut="lolite()" onClick="logVariable('extpassword')" href="../../_variables/extpassword.html">$extpassword</a> = '{SHA}' . <a class="phpfunction" onClick="logFunction('base64_encode')" href="../../_functions/base64_encode.html" onMouseOver="phpfuncPopup(event,'base64_encode')">base64_encode</a>(<a class="phpfunction" onClick="logFunction('pack')" href="../../_functions/pack.html" onMouseOver="phpfuncPopup(event,'pack')">pack</a>('H*', <a class="phpfunction" onClick="logFunction('sha1')" href="../../_functions/sha1.html" onMouseOver="phpfuncPopup(event,'sha1')">sha1</a>(<a class="var it33956" onMouseOver="hilite(33956)" onMouseOut="lolite()" onClick="logVariable('extpassword')" href="../../_variables/extpassword.html">$extpassword</a>)));
<a name="l1343"><span class="linenum">1343</span></a>                  break;
<a name="l1344"><span class="linenum">1344</span></a>              case 'plaintext':
<a name="l1345"><span class="linenum">1345</span></a>              default:
<a name="l1346"><span class="linenum">1346</span></a>                  break; <span class="comment">// plaintext</span>
<a name="l1347"><span class="linenum">1347</span></a>          }
<a name="l1348"><span class="linenum">1348</span></a>  
<a name="l1349"><span class="linenum">1349</span></a>          <a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="phpfunction" onClick="logFunction('ldap_connect')" href="../../_functions/ldap_connect.html" onMouseOver="phpfuncPopup(event,'ldap_connect')">ldap_connect</a>();
<a name="l1350"><span class="linenum">1350</span></a>  
<a name="l1351"><span class="linenum">1351</span></a>          <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_find_userdn')" href="../../_functions/ldap_find_userdn.html" onMouseOver="funcPopup(event,'ldap_find_userdn')">ldap_find_userdn</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a>);
<a name="l1352"><span class="linenum">1352</span></a>  
<a name="l1353"><span class="linenum">1353</span></a>          if (!<a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>) {
<a name="l1354"><span class="linenum">1354</span></a>              <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a> ('nodnforusername', 'auth_ldap', <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>));
<a name="l1355"><span class="linenum">1355</span></a>              return false;
<a name="l1356"><span class="linenum">1356</span></a>          }
<a name="l1357"><span class="linenum">1357</span></a>  
<a name="l1358"><span class="linenum">1358</span></a>          switch (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_type) {
<a name="l1359"><span class="linenum">1359</span></a>              case 'edir':
<a name="l1360"><span class="linenum">1360</span></a>  <span class="comment">                // Change password</span>
<a name="l1361"><span class="linenum">1361</span></a>                  <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = ldap_modify(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>, array('userPassword' =&gt; <a class="var it33956" onMouseOver="hilite(33956)" onMouseOut="lolite()" onClick="logVariable('extpassword')" href="../../_variables/extpassword.html">$extpassword</a>));
<a name="l1362"><span class="linenum">1362</span></a>                  if (!<a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>) {
<a name="l1363"><span class="linenum">1363</span></a>                      <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a> ('updatepasserror', 'auth_ldap',
<a name="l1364"><span class="linenum">1364</span></a>                                                                 array('errno'=&gt;<a class="phpfunction" onClick="logFunction('ldap_errno')" href="../../_functions/ldap_errno.html" onMouseOver="phpfuncPopup(event,'ldap_errno')">ldap_errno</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>),
<a name="l1365"><span class="linenum">1365</span></a>                                                                       'errstring'=&gt;<a class="phpfunction" onClick="logFunction('ldap_err2str')" href="../../_functions/ldap_err2str.html" onMouseOver="phpfuncPopup(event,'ldap_err2str')">ldap_err2str</a>(<a class="phpfunction" onClick="logFunction('ldap_errno')" href="../../_functions/ldap_errno.html" onMouseOver="phpfuncPopup(event,'ldap_errno')">ldap_errno</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>)))));
<a name="l1366"><span class="linenum">1366</span></a>                  }
<a name="l1367"><span class="linenum">1367</span></a>  <span class="comment">                // Update password expiration time, grace logins count</span>
<a name="l1368"><span class="linenum">1368</span></a>                  <a class="var it23949" onMouseOver="hilite(23949)" onMouseOut="lolite()" onClick="logVariable('search_attribs')" href="../../_variables/search_attribs.html">$search_attribs</a> = array(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;expireattr, 'passwordExpirationInterval', 'loginGraceLimit');
<a name="l1369"><span class="linenum">1369</span></a>                  <a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a> = <a class="phpfunction" onClick="logFunction('ldap_read')" href="../../_functions/ldap_read.html" onMouseOver="phpfuncPopup(event,'ldap_read')">ldap_read</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>, '(objectClass=*)', <a class="var it23949" onMouseOver="hilite(23949)" onMouseOut="lolite()" onClick="logVariable('search_attribs')" href="../../_variables/search_attribs.html">$search_attribs</a>);
<a name="l1370"><span class="linenum">1370</span></a>                  if (<a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a>) {
<a name="l1371"><span class="linenum">1371</span></a>                      <a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a> = <a class="function" onClick="logFunction('ldap_get_entries_moodle')" href="../../_functions/ldap_get_entries_moodle.html" onMouseOver="funcPopup(event,'ldap_get_entries_moodle')">ldap_get_entries_moodle</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a>);
<a name="l1372"><span class="linenum">1372</span></a>                      <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a> = <a class="phpfunction" onClick="logFunction('array_change_key_case')" href="../../_functions/array_change_key_case.html" onMouseOver="phpfuncPopup(event,'array_change_key_case')">array_change_key_case</a>(<a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a>[0], CASE_LOWER);
<a name="l1373"><span class="linenum">1373</span></a>                      <a class="var it33990" onMouseOver="hilite(33990)" onMouseOut="lolite()" onClick="logVariable('newattrs')" href="../../_variables/newattrs.html">$newattrs</a> = array();
<a name="l1374"><span class="linenum">1374</span></a>                      if (!empty(<a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>[<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;expireattr][0])) {
<a name="l1375"><span class="linenum">1375</span></a>  <span class="comment">                        // Set expiration time only if passwordExpirationInterval is defined</span>
<a name="l1376"><span class="linenum">1376</span></a>                          if (!empty(<a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>['passwordexpirationinterval'][0])) {
<a name="l1377"><span class="linenum">1377</span></a>                             <a class="var it25192" onMouseOver="hilite(25192)" onMouseOut="lolite()" onClick="logVariable('expirationtime')" href="../../_variables/expirationtime.html">$expirationtime</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() + <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>['passwordexpirationinterval'][0];
<a name="l1378"><span class="linenum">1378</span></a>                             <a class="var it33991" onMouseOver="hilite(33991)" onMouseOut="lolite()" onClick="logVariable('ldapexpirationtime')" href="../../_variables/ldapexpirationtime.html">$ldapexpirationtime</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_unix2expirationtime')" href="../../_functions/ldap_unix2expirationtime.html" onMouseOver="funcPopup(event,'ldap_unix2expirationtime')">ldap_unix2expirationtime</a>(<a class="var it25192" onMouseOver="hilite(25192)" onMouseOut="lolite()" onClick="logVariable('expirationtime')" href="../../_variables/expirationtime.html">$expirationtime</a>);
<a name="l1379"><span class="linenum">1379</span></a>                             <a class="var it33990" onMouseOver="hilite(33990)" onMouseOut="lolite()" onClick="logVariable('newattrs')" href="../../_variables/newattrs.html">$newattrs</a>['passwordExpirationTime'] = <a class="var it33991" onMouseOver="hilite(33991)" onMouseOut="lolite()" onClick="logVariable('ldapexpirationtime')" href="../../_variables/ldapexpirationtime.html">$ldapexpirationtime</a>;
<a name="l1380"><span class="linenum">1380</span></a>                          }
<a name="l1381"><span class="linenum">1381</span></a>  
<a name="l1382"><span class="linenum">1382</span></a>  <span class="comment">                        // Set gracelogin count</span>
<a name="l1383"><span class="linenum">1383</span></a>                          if (!empty(<a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>['logingracelimit'][0])) {
<a name="l1384"><span class="linenum">1384</span></a>                             <a class="var it33990" onMouseOver="hilite(33990)" onMouseOut="lolite()" onClick="logVariable('newattrs')" href="../../_variables/newattrs.html">$newattrs</a>['loginGraceRemaining']= <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>['logingracelimit'][0];
<a name="l1385"><span class="linenum">1385</span></a>                          }
<a name="l1386"><span class="linenum">1386</span></a>  
<a name="l1387"><span class="linenum">1387</span></a>  <span class="comment">                        // Store attribute changes in LDAP</span>
<a name="l1388"><span class="linenum">1388</span></a>                          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = ldap_modify(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>, <a class="var it33990" onMouseOver="hilite(33990)" onMouseOut="lolite()" onClick="logVariable('newattrs')" href="../../_variables/newattrs.html">$newattrs</a>);
<a name="l1389"><span class="linenum">1389</span></a>                          if (!<a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>) {
<a name="l1390"><span class="linenum">1390</span></a>                              <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a> ('updatepasserrorexpiregrace', 'auth_ldap',
<a name="l1391"><span class="linenum">1391</span></a>                                                                         array('errno'=&gt;<a class="phpfunction" onClick="logFunction('ldap_errno')" href="../../_functions/ldap_errno.html" onMouseOver="phpfuncPopup(event,'ldap_errno')">ldap_errno</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>),
<a name="l1392"><span class="linenum">1392</span></a>                                                                               'errstring'=&gt;<a class="phpfunction" onClick="logFunction('ldap_err2str')" href="../../_functions/ldap_err2str.html" onMouseOver="phpfuncPopup(event,'ldap_err2str')">ldap_err2str</a>(<a class="phpfunction" onClick="logFunction('ldap_errno')" href="../../_functions/ldap_errno.html" onMouseOver="phpfuncPopup(event,'ldap_errno')">ldap_errno</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>)))));
<a name="l1393"><span class="linenum">1393</span></a>                          }
<a name="l1394"><span class="linenum">1394</span></a>                      }
<a name="l1395"><span class="linenum">1395</span></a>                  }
<a name="l1396"><span class="linenum">1396</span></a>                  else {
<a name="l1397"><span class="linenum">1397</span></a>                      <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a> ('updatepasserrorexpire', 'auth_ldap',
<a name="l1398"><span class="linenum">1398</span></a>                                                               array('errno'=&gt;<a class="phpfunction" onClick="logFunction('ldap_errno')" href="../../_functions/ldap_errno.html" onMouseOver="phpfuncPopup(event,'ldap_errno')">ldap_errno</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>),
<a name="l1399"><span class="linenum">1399</span></a>                                                                     'errstring'=&gt;<a class="phpfunction" onClick="logFunction('ldap_err2str')" href="../../_functions/ldap_err2str.html" onMouseOver="phpfuncPopup(event,'ldap_err2str')">ldap_err2str</a>(<a class="phpfunction" onClick="logFunction('ldap_errno')" href="../../_functions/ldap_errno.html" onMouseOver="phpfuncPopup(event,'ldap_errno')">ldap_errno</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>)))));
<a name="l1400"><span class="linenum">1400</span></a>                  }
<a name="l1401"><span class="linenum">1401</span></a>                  break;
<a name="l1402"><span class="linenum">1402</span></a>  
<a name="l1403"><span class="linenum">1403</span></a>              case 'ad':
<a name="l1404"><span class="linenum">1404</span></a>  <span class="comment">                // Passwords in Active Directory must be encoded as Unicode</span>
<a name="l1405"><span class="linenum">1405</span></a>  <span class="comment">                // strings (UCS-2 Little Endian format) and surrounded with</span>
<a name="l1406"><span class="linenum">1406</span></a>  <span class="comment">                // double quotes. See http://support.microsoft.com/?kbid=269190</span>
<a name="l1407"><span class="linenum">1407</span></a>                  if (!<a class="phpfunction" onClick="logFunction('function_exists')" href="../../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>('mb_convert_encoding')) {
<a name="l1408"><span class="linenum">1408</span></a>                      <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a> ('needmbstring', 'auth_ldap'));
<a name="l1409"><span class="linenum">1409</span></a>                      return false;
<a name="l1410"><span class="linenum">1410</span></a>                  }
<a name="l1411"><span class="linenum">1411</span></a>                  <a class="var it33956" onMouseOver="hilite(33956)" onMouseOut="lolite()" onClick="logVariable('extpassword')" href="../../_variables/extpassword.html">$extpassword</a> = <a class="phpfunction" onClick="logFunction('mb_convert_encoding')" href="../../_functions/mb_convert_encoding.html" onMouseOver="phpfuncPopup(event,'mb_convert_encoding')">mb_convert_encoding</a>('&quot;'.<a class="var it33956" onMouseOver="hilite(33956)" onMouseOut="lolite()" onClick="logVariable('extpassword')" href="../../_variables/extpassword.html">$extpassword</a>.'&quot;', &quot;UCS-2LE&quot;, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding);
<a name="l1412"><span class="linenum">1412</span></a>                  <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = ldap_modify(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>, array('unicodePwd' =&gt; <a class="var it33956" onMouseOver="hilite(33956)" onMouseOut="lolite()" onClick="logVariable('extpassword')" href="../../_variables/extpassword.html">$extpassword</a>));
<a name="l1413"><span class="linenum">1413</span></a>                  if (!<a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>) {
<a name="l1414"><span class="linenum">1414</span></a>                      <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a> ('updatepasserror', 'auth_ldap',
<a name="l1415"><span class="linenum">1415</span></a>                                                               array('errno'=&gt;<a class="phpfunction" onClick="logFunction('ldap_errno')" href="../../_functions/ldap_errno.html" onMouseOver="phpfuncPopup(event,'ldap_errno')">ldap_errno</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>),
<a name="l1416"><span class="linenum">1416</span></a>                                                                     'errstring'=&gt;<a class="phpfunction" onClick="logFunction('ldap_err2str')" href="../../_functions/ldap_err2str.html" onMouseOver="phpfuncPopup(event,'ldap_err2str')">ldap_err2str</a>(<a class="phpfunction" onClick="logFunction('ldap_errno')" href="../../_functions/ldap_errno.html" onMouseOver="phpfuncPopup(event,'ldap_errno')">ldap_errno</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>)))));
<a name="l1417"><span class="linenum">1417</span></a>                  }
<a name="l1418"><span class="linenum">1418</span></a>                  break;
<a name="l1419"><span class="linenum">1419</span></a>  
<a name="l1420"><span class="linenum">1420</span></a>              default:
<a name="l1421"><span class="linenum">1421</span></a>  <span class="comment">                // Send LDAP the password in cleartext, it will md5 it itself</span>
<a name="l1422"><span class="linenum">1422</span></a>                  <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = ldap_modify(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>, array('userPassword' =&gt; <a class="var it33956" onMouseOver="hilite(33956)" onMouseOut="lolite()" onClick="logVariable('extpassword')" href="../../_variables/extpassword.html">$extpassword</a>));
<a name="l1423"><span class="linenum">1423</span></a>                  if (!<a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>) {
<a name="l1424"><span class="linenum">1424</span></a>                      <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a> ('updatepasserror', 'auth_ldap',
<a name="l1425"><span class="linenum">1425</span></a>                                                               array('errno'=&gt;<a class="phpfunction" onClick="logFunction('ldap_errno')" href="../../_functions/ldap_errno.html" onMouseOver="phpfuncPopup(event,'ldap_errno')">ldap_errno</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>),
<a name="l1426"><span class="linenum">1426</span></a>                                                                     'errstring'=&gt;<a class="phpfunction" onClick="logFunction('ldap_err2str')" href="../../_functions/ldap_err2str.html" onMouseOver="phpfuncPopup(event,'ldap_err2str')">ldap_err2str</a>(<a class="phpfunction" onClick="logFunction('ldap_errno')" href="../../_functions/ldap_errno.html" onMouseOver="phpfuncPopup(event,'ldap_errno')">ldap_errno</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>)))));
<a name="l1427"><span class="linenum">1427</span></a>                  }
<a name="l1428"><span class="linenum">1428</span></a>  
<a name="l1429"><span class="linenum">1429</span></a>          }
<a name="l1430"><span class="linenum">1430</span></a>  
<a name="l1431"><span class="linenum">1431</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_close')" href="../../_functions/ldap_close.html" onMouseOver="funcPopup(event,'ldap_close')">ldap_close</a>();
<a name="l1432"><span class="linenum">1432</span></a>          return <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l1433"><span class="linenum">1433</span></a>      }
<a name="l1434"><span class="linenum">1434</span></a>  
<a name="l1435"><span class="linenum">1435</span></a>      <span class="comment">/**</span>
<a name="l1436"><span class="linenum">1436</span></a>  <span class="comment">     * Take expirationtime and return it as unix timestamp in seconds</span>
<a name="l1437"><span class="linenum">1437</span></a>  <span class="comment">     *</span>
<a name="l1438"><span class="linenum">1438</span></a>  <span class="comment">     * Takes expiration timestamp as read from LDAP and returns it as unix timestamp in seconds</span>
<a name="l1439"><span class="linenum">1439</span></a>  <span class="comment">     * Depends on $this-&gt;config-&gt;user_type variable</span>
<a name="l1440"><span class="linenum">1440</span></a>  <span class="comment">     *</span>
<a name="l1441"><span class="linenum">1441</span></a>  <span class="comment">     * @param mixed time   Time stamp read from LDAP as it is.</span>
<a name="l1442"><span class="linenum">1442</span></a>  <span class="comment">     * @param string $ldapconnection Only needed for Active Directory.</span>
<a name="l1443"><span class="linenum">1443</span></a>  <span class="comment">     * @param string $user_dn User distinguished name for the user we are checking password expiration (only needed for Active Directory).</span>
<a name="l1444"><span class="linenum">1444</span></a>  <span class="comment">     * @return timestamp</span>
<a name="l1445"><span class="linenum">1445</span></a>  <span class="comment">     */</span>
<a name="l1446"><span class="linenum">1446</span></a>      function <a class="function" onClick="logFunction('ldap_expirationtime2unix')" href="../../_functions/ldap_expirationtime2unix.html" onMouseOver="funcPopup(event,'ldap_expirationtime2unix')">ldap_expirationtime2unix</a> (<a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('time')" href="../../_variables/time.html">$time</a>, <a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>) {
<a name="l1447"><span class="linenum">1447</span></a>          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = false;
<a name="l1448"><span class="linenum">1448</span></a>          switch (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_type) {
<a name="l1449"><span class="linenum">1449</span></a>              case 'edir':
<a name="l1450"><span class="linenum">1450</span></a>                  <a class="var it5709" onMouseOver="hilite(5709)" onMouseOut="lolite()" onClick="logVariable('yr')" href="../../_variables/yr.html">$yr</a>=<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('time')" href="../../_variables/time.html">$time</a>, 0, 4);
<a name="l1451"><span class="linenum">1451</span></a>                  <a class="var it33992" onMouseOver="hilite(33992)" onMouseOut="lolite()" onClick="logVariable('mo')" href="../../_variables/mo.html">$mo</a>=<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('time')" href="../../_variables/time.html">$time</a>, 4, 2);
<a name="l1452"><span class="linenum">1452</span></a>                  <a class="var it5714" onMouseOver="hilite(5714)" onMouseOut="lolite()" onClick="logVariable('dt')" href="../../_variables/dt.html">$dt</a>=<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('time')" href="../../_variables/time.html">$time</a>, 6, 2);
<a name="l1453"><span class="linenum">1453</span></a>                  <a class="var it5745" onMouseOver="hilite(5745)" onMouseOut="lolite()" onClick="logVariable('hr')" href="../../_variables/hr.html">$hr</a>=<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('time')" href="../../_variables/time.html">$time</a>, 8, 2);
<a name="l1454"><span class="linenum">1454</span></a>                  <a class="var it2299" onMouseOver="hilite(2299)" onMouseOut="lolite()" onClick="logVariable('min')" href="../../_variables/min.html">$min</a>=<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('time')" href="../../_variables/time.html">$time</a>, 10, 2);
<a name="l1455"><span class="linenum">1455</span></a>                  <a class="var it5746" onMouseOver="hilite(5746)" onMouseOut="lolite()" onClick="logVariable('sec')" href="../../_variables/sec.html">$sec</a>=<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('time')" href="../../_variables/time.html">$time</a>, 12, 2);
<a name="l1456"><span class="linenum">1456</span></a>                  <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = <a class="phpfunction" onClick="logFunction('mktime')" href="../../_functions/mktime.html" onMouseOver="phpfuncPopup(event,'mktime')">mktime</a>(<a class="var it5745" onMouseOver="hilite(5745)" onMouseOut="lolite()" onClick="logVariable('hr')" href="../../_variables/hr.html">$hr</a>, <a class="var it2299" onMouseOver="hilite(2299)" onMouseOut="lolite()" onClick="logVariable('min')" href="../../_variables/min.html">$min</a>, <a class="var it5746" onMouseOver="hilite(5746)" onMouseOut="lolite()" onClick="logVariable('sec')" href="../../_variables/sec.html">$sec</a>, <a class="var it33992" onMouseOver="hilite(33992)" onMouseOut="lolite()" onClick="logVariable('mo')" href="../../_variables/mo.html">$mo</a>, <a class="var it5714" onMouseOver="hilite(5714)" onMouseOut="lolite()" onClick="logVariable('dt')" href="../../_variables/dt.html">$dt</a>, <a class="var it5709" onMouseOver="hilite(5709)" onMouseOut="lolite()" onClick="logVariable('yr')" href="../../_variables/yr.html">$yr</a>);
<a name="l1457"><span class="linenum">1457</span></a>                  break;
<a name="l1458"><span class="linenum">1458</span></a>              case 'rfc2307':
<a name="l1459"><span class="linenum">1459</span></a>              case 'rfc2307bis':
<a name="l1460"><span class="linenum">1460</span></a>                  <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('time')" href="../../_variables/time.html">$time</a> * <a class="constant" onClick="logConstant('DAYSECS')" href="../../_constants/DAYSECS.html" onMouseOver="constPopup(event,'DAYSECS')">DAYSECS</a>; <span class="comment">// The shadowExpire contains the number of DAYS between 01/01/1970 and the actual expiration date</span>
<a name="l1461"><span class="linenum">1461</span></a>                  break;
<a name="l1462"><span class="linenum">1462</span></a>              case 'ad':
<a name="l1463"><span class="linenum">1463</span></a>                  <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_get_ad_pwdexpire')" href="../../_functions/ldap_get_ad_pwdexpire.html" onMouseOver="funcPopup(event,'ldap_get_ad_pwdexpire')">ldap_get_ad_pwdexpire</a>(<a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('time')" href="../../_variables/time.html">$time</a>, <a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>);
<a name="l1464"><span class="linenum">1464</span></a>                  break;
<a name="l1465"><span class="linenum">1465</span></a>              default:
<a name="l1466"><span class="linenum">1466</span></a>                  <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('auth_ldap_usertypeundefined', 'auth_ldap');
<a name="l1467"><span class="linenum">1467</span></a>          }
<a name="l1468"><span class="linenum">1468</span></a>          return <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l1469"><span class="linenum">1469</span></a>      }
<a name="l1470"><span class="linenum">1470</span></a>  
<a name="l1471"><span class="linenum">1471</span></a>      <span class="comment">/**</span>
<a name="l1472"><span class="linenum">1472</span></a>  <span class="comment">     * Takes unix timestamp and returns it formated for storing in LDAP</span>
<a name="l1473"><span class="linenum">1473</span></a>  <span class="comment">     *</span>
<a name="l1474"><span class="linenum">1474</span></a>  <span class="comment">     * @param integer unix time stamp</span>
<a name="l1475"><span class="linenum">1475</span></a>  <span class="comment">     */</span>
<a name="l1476"><span class="linenum">1476</span></a>      function <a class="function" onClick="logFunction('ldap_unix2expirationtime')" href="../../_functions/ldap_unix2expirationtime.html" onMouseOver="funcPopup(event,'ldap_unix2expirationtime')">ldap_unix2expirationtime</a>(<a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('time')" href="../../_variables/time.html">$time</a>) {
<a name="l1477"><span class="linenum">1477</span></a>          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = false;
<a name="l1478"><span class="linenum">1478</span></a>          switch (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_type) {
<a name="l1479"><span class="linenum">1479</span></a>              case 'edir':
<a name="l1480"><span class="linenum">1480</span></a>                  <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>=<a class="phpfunction" onClick="logFunction('date')" href="../../_functions/date.html" onMouseOver="phpfuncPopup(event,'date')">date</a>('YmdHis', <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('time')" href="../../_variables/time.html">$time</a>).'Z';
<a name="l1481"><span class="linenum">1481</span></a>                  break;
<a name="l1482"><span class="linenum">1482</span></a>              case 'rfc2307':
<a name="l1483"><span class="linenum">1483</span></a>              case 'rfc2307bis':
<a name="l1484"><span class="linenum">1484</span></a>                  <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('time')" href="../../_variables/time.html">$time</a> ; <span class="comment">// Already in correct format</span>
<a name="l1485"><span class="linenum">1485</span></a>                  break;
<a name="l1486"><span class="linenum">1486</span></a>              default:
<a name="l1487"><span class="linenum">1487</span></a>                  <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('auth_ldap_usertypeundefined2', 'auth_ldap');
<a name="l1488"><span class="linenum">1488</span></a>          }
<a name="l1489"><span class="linenum">1489</span></a>          return <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l1490"><span class="linenum">1490</span></a>  
<a name="l1491"><span class="linenum">1491</span></a>      }
<a name="l1492"><span class="linenum">1492</span></a>  
<a name="l1493"><span class="linenum">1493</span></a>      <span class="comment">/**</span>
<a name="l1494"><span class="linenum">1494</span></a>  <span class="comment">     * Returns user attribute mappings between moodle and LDAP</span>
<a name="l1495"><span class="linenum">1495</span></a>  <span class="comment">     *</span>
<a name="l1496"><span class="linenum">1496</span></a>  <span class="comment">     * @return array</span>
<a name="l1497"><span class="linenum">1497</span></a>  <span class="comment">     */</span>
<a name="l1498"><span class="linenum">1498</span></a>  
<a name="l1499"><span class="linenum">1499</span></a>      function <a class="function" onClick="logFunction('ldap_attributes')" href="../../_functions/ldap_attributes.html" onMouseOver="funcPopup(event,'ldap_attributes')">ldap_attributes</a> () {
<a name="l1500"><span class="linenum">1500</span></a>          <a class="var it23951" onMouseOver="hilite(23951)" onMouseOut="lolite()" onClick="logVariable('moodleattributes')" href="../../_variables/moodleattributes.html">$moodleattributes</a> = array();
<a name="l1501"><span class="linenum">1501</span></a>  <span class="comment">        // If we have custom fields then merge them with user fields.</span>
<a name="l1502"><span class="linenum">1502</span></a>          <a class="var it13855" onMouseOver="hilite(13855)" onMouseOut="lolite()" onClick="logVariable('customfields')" href="../../_variables/customfields.html">$customfields</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_custom_user_profile_fields')" href="../../_functions/get_custom_user_profile_fields.html" onMouseOver="funcPopup(event,'get_custom_user_profile_fields')">get_custom_user_profile_fields</a>();
<a name="l1503"><span class="linenum">1503</span></a>          if (!empty(<a class="var it13855" onMouseOver="hilite(13855)" onMouseOut="lolite()" onClick="logVariable('customfields')" href="../../_variables/customfields.html">$customfields</a>) &amp;&amp; !empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('userfields')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/userfields.html">userfields</a>)) {
<a name="l1504"><span class="linenum">1504</span></a>              <a class="var it4004" onMouseOver="hilite(4004)" onMouseOut="lolite()" onClick="logVariable('userfields')" href="../../_variables/userfields.html">$userfields</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('userfields')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/userfields.html">userfields</a>, <a class="var it13855" onMouseOver="hilite(13855)" onMouseOut="lolite()" onClick="logVariable('customfields')" href="../../_variables/customfields.html">$customfields</a>);
<a name="l1505"><span class="linenum">1505</span></a>          } else {
<a name="l1506"><span class="linenum">1506</span></a>              <a class="var it4004" onMouseOver="hilite(4004)" onMouseOut="lolite()" onClick="logVariable('userfields')" href="../../_variables/userfields.html">$userfields</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('userfields')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/userfields.html">userfields</a>;
<a name="l1507"><span class="linenum">1507</span></a>          }
<a name="l1508"><span class="linenum">1508</span></a>  
<a name="l1509"><span class="linenum">1509</span></a>          foreach (<a class="var it4004" onMouseOver="hilite(4004)" onMouseOut="lolite()" onClick="logVariable('userfields')" href="../../_variables/userfields.html">$userfields</a> as <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>) {
<a name="l1510"><span class="linenum">1510</span></a>              if (!empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;{&quot;field_map_<a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>&quot;})) {
<a name="l1511"><span class="linenum">1511</span></a>                  <a class="var it23951" onMouseOver="hilite(23951)" onMouseOut="lolite()" onClick="logVariable('moodleattributes')" href="../../_variables/moodleattributes.html">$moodleattributes</a>[<a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>] = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;{&quot;field_map_<a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>&quot;}));
<a name="l1512"><span class="linenum">1512</span></a>                  if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/,/', <a class="var it23951" onMouseOver="hilite(23951)" onMouseOut="lolite()" onClick="logVariable('moodleattributes')" href="../../_variables/moodleattributes.html">$moodleattributes</a>[<a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>])) {
<a name="l1513"><span class="linenum">1513</span></a>                      <a class="var it23951" onMouseOver="hilite(23951)" onMouseOut="lolite()" onClick="logVariable('moodleattributes')" href="../../_variables/moodleattributes.html">$moodleattributes</a>[<a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>] = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(',', <a class="var it23951" onMouseOver="hilite(23951)" onMouseOut="lolite()" onClick="logVariable('moodleattributes')" href="../../_variables/moodleattributes.html">$moodleattributes</a>[<a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>]); <span class="comment">// split ?</span>
<a name="l1514"><span class="linenum">1514</span></a>                  }
<a name="l1515"><span class="linenum">1515</span></a>              }
<a name="l1516"><span class="linenum">1516</span></a>          }
<a name="l1517"><span class="linenum">1517</span></a>          <a class="var it23951" onMouseOver="hilite(23951)" onMouseOut="lolite()" onClick="logVariable('moodleattributes')" href="../../_variables/moodleattributes.html">$moodleattributes</a>['username'] = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_attribute));
<a name="l1518"><span class="linenum">1518</span></a>          <a class="var it23951" onMouseOver="hilite(23951)" onMouseOut="lolite()" onClick="logVariable('moodleattributes')" href="../../_variables/moodleattributes.html">$moodleattributes</a>['suspended'] = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;suspended_attribute));
<a name="l1519"><span class="linenum">1519</span></a>          return <a class="var it23951" onMouseOver="hilite(23951)" onMouseOut="lolite()" onClick="logVariable('moodleattributes')" href="../../_variables/moodleattributes.html">$moodleattributes</a>;
<a name="l1520"><span class="linenum">1520</span></a>      }
<a name="l1521"><span class="linenum">1521</span></a>  
<a name="l1522"><span class="linenum">1522</span></a>      <span class="comment">/**</span>
<a name="l1523"><span class="linenum">1523</span></a>  <span class="comment">     * Returns all usernames from LDAP</span>
<a name="l1524"><span class="linenum">1524</span></a>  <span class="comment">     *</span>
<a name="l1525"><span class="linenum">1525</span></a>  <span class="comment">     * @param $filter An LDAP search filter to select desired users</span>
<a name="l1526"><span class="linenum">1526</span></a>  <span class="comment">     * @return array of LDAP user names converted to UTF-8</span>
<a name="l1527"><span class="linenum">1527</span></a>  <span class="comment">     */</span>
<a name="l1528"><span class="linenum">1528</span></a>      function <a class="function" onClick="logFunction('ldap_get_userlist')" href="../../_functions/ldap_get_userlist.html" onMouseOver="funcPopup(event,'ldap_get_userlist')">ldap_get_userlist</a>(<a class="var it1336" onMouseOver="hilite(1336)" onMouseOut="lolite()" onClick="logVariable('filter')" href="../../_variables/filter.html">$filter</a>='*') {
<a name="l1529"><span class="linenum">1529</span></a>          <a class="var it33993" onMouseOver="hilite(33993)" onMouseOut="lolite()" onClick="logVariable('fresult')" href="../../_variables/fresult.html">$fresult</a> = array();
<a name="l1530"><span class="linenum">1530</span></a>  
<a name="l1531"><span class="linenum">1531</span></a>          <a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="phpfunction" onClick="logFunction('ldap_connect')" href="../../_functions/ldap_connect.html" onMouseOver="phpfuncPopup(event,'ldap_connect')">ldap_connect</a>();
<a name="l1532"><span class="linenum">1532</span></a>  
<a name="l1533"><span class="linenum">1533</span></a>          if (<a class="var it1336" onMouseOver="hilite(1336)" onMouseOut="lolite()" onClick="logVariable('filter')" href="../../_variables/filter.html">$filter</a> == '*') {
<a name="l1534"><span class="linenum">1534</span></a>             <a class="var it1336" onMouseOver="hilite(1336)" onMouseOut="lolite()" onClick="logVariable('filter')" href="../../_variables/filter.html">$filter</a> = '(&amp;('.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_attribute.'=*)'.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;objectclass.')';
<a name="l1535"><span class="linenum">1535</span></a>          }
<a name="l1536"><span class="linenum">1536</span></a>  
<a name="l1537"><span class="linenum">1537</span></a>          <a class="var it2537" onMouseOver="hilite(2537)" onMouseOut="lolite()" onClick="logVariable('contexts')" href="../../_variables/contexts.html">$contexts</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(';', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;contexts);
<a name="l1538"><span class="linenum">1538</span></a>          if (!empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;create_context)) {
<a name="l1539"><span class="linenum">1539</span></a>              <a class="phpfunction" onClick="logFunction('array_push')" href="../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>(<a class="var it2537" onMouseOver="hilite(2537)" onMouseOut="lolite()" onClick="logVariable('contexts')" href="../../_variables/contexts.html">$contexts</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;create_context);
<a name="l1540"><span class="linenum">1540</span></a>          }
<a name="l1541"><span class="linenum">1541</span></a>  
<a name="l1542"><span class="linenum">1542</span></a>          <a class="var it24479" onMouseOver="hilite(24479)" onMouseOut="lolite()" onClick="logVariable('ldap_cookie')" href="../../_variables/ldap_cookie.html">$ldap_cookie</a> = '';
<a name="l1543"><span class="linenum">1543</span></a>          <a class="var it24474" onMouseOver="hilite(24474)" onMouseOut="lolite()" onClick="logVariable('ldap_pagedresults')" href="../../_variables/ldap_pagedresults.html">$ldap_pagedresults</a> = <a class="function" onClick="logFunction('ldap_paged_results_supported')" href="../../_functions/ldap_paged_results_supported.html" onMouseOver="funcPopup(event,'ldap_paged_results_supported')">ldap_paged_results_supported</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldap_version);
<a name="l1544"><span class="linenum">1544</span></a>          foreach (<a class="var it2537" onMouseOver="hilite(2537)" onMouseOut="lolite()" onClick="logVariable('contexts')" href="../../_variables/contexts.html">$contexts</a> as <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>) {
<a name="l1545"><span class="linenum">1545</span></a>              <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l1546"><span class="linenum">1546</span></a>              if (empty(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>)) {
<a name="l1547"><span class="linenum">1547</span></a>                  continue;
<a name="l1548"><span class="linenum">1548</span></a>              }
<a name="l1549"><span class="linenum">1549</span></a>  
<a name="l1550"><span class="linenum">1550</span></a>              do {
<a name="l1551"><span class="linenum">1551</span></a>                  if (<a class="var it24474" onMouseOver="hilite(24474)" onMouseOut="lolite()" onClick="logVariable('ldap_pagedresults')" href="../../_variables/ldap_pagedresults.html">$ldap_pagedresults</a>) {
<a name="l1552"><span class="linenum">1552</span></a>                      ldap_control_paged_result(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;pagesize, true, <a class="var it24479" onMouseOver="hilite(24479)" onMouseOut="lolite()" onClick="logVariable('ldap_cookie')" href="../../_variables/ldap_cookie.html">$ldap_cookie</a>);
<a name="l1553"><span class="linenum">1553</span></a>                  }
<a name="l1554"><span class="linenum">1554</span></a>                  if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;search_sub) {
<a name="l1555"><span class="linenum">1555</span></a>  <span class="comment">                    // Use ldap_search to find first user from subtree.</span>
<a name="l1556"><span class="linenum">1556</span></a>                      <a class="var it24483" onMouseOver="hilite(24483)" onMouseOut="lolite()" onClick="logVariable('ldap_result')" href="../../_variables/ldap_result.html">$ldap_result</a> = <a class="phpfunction" onClick="logFunction('ldap_search')" href="../../_functions/ldap_search.html" onMouseOver="phpfuncPopup(event,'ldap_search')">ldap_search</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>, <a class="var it1336" onMouseOver="hilite(1336)" onMouseOut="lolite()" onClick="logVariable('filter')" href="../../_variables/filter.html">$filter</a>, array(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_attribute));
<a name="l1557"><span class="linenum">1557</span></a>                  } else {
<a name="l1558"><span class="linenum">1558</span></a>  <span class="comment">                    // Search only in this context.</span>
<a name="l1559"><span class="linenum">1559</span></a>                      <a class="var it24483" onMouseOver="hilite(24483)" onMouseOut="lolite()" onClick="logVariable('ldap_result')" href="../../_variables/ldap_result.html">$ldap_result</a> = <a class="phpfunction" onClick="logFunction('ldap_list')" href="../../_functions/ldap_list.html" onMouseOver="phpfuncPopup(event,'ldap_list')">ldap_list</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>, <a class="var it1336" onMouseOver="hilite(1336)" onMouseOut="lolite()" onClick="logVariable('filter')" href="../../_variables/filter.html">$filter</a>, array(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_attribute));
<a name="l1560"><span class="linenum">1560</span></a>                  }
<a name="l1561"><span class="linenum">1561</span></a>                  if(!<a class="var it24483" onMouseOver="hilite(24483)" onMouseOut="lolite()" onClick="logVariable('ldap_result')" href="../../_variables/ldap_result.html">$ldap_result</a>) {
<a name="l1562"><span class="linenum">1562</span></a>                      continue;
<a name="l1563"><span class="linenum">1563</span></a>                  }
<a name="l1564"><span class="linenum">1564</span></a>                  if (<a class="var it24474" onMouseOver="hilite(24474)" onMouseOut="lolite()" onClick="logVariable('ldap_pagedresults')" href="../../_variables/ldap_pagedresults.html">$ldap_pagedresults</a>) {
<a name="l1565"><span class="linenum">1565</span></a>                      ldap_control_paged_result_response(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it24483" onMouseOver="hilite(24483)" onMouseOut="lolite()" onClick="logVariable('ldap_result')" href="../../_variables/ldap_result.html">$ldap_result</a>, <a class="var it24479" onMouseOver="hilite(24479)" onMouseOut="lolite()" onClick="logVariable('ldap_cookie')" href="../../_variables/ldap_cookie.html">$ldap_cookie</a>);
<a name="l1566"><span class="linenum">1566</span></a>                  }
<a name="l1567"><span class="linenum">1567</span></a>                  <a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a> = <a class="function" onClick="logFunction('ldap_get_entries_moodle')" href="../../_functions/ldap_get_entries_moodle.html" onMouseOver="funcPopup(event,'ldap_get_entries_moodle')">ldap_get_entries_moodle</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it24483" onMouseOver="hilite(24483)" onMouseOut="lolite()" onClick="logVariable('ldap_result')" href="../../_variables/ldap_result.html">$ldap_result</a>);
<a name="l1568"><span class="linenum">1568</span></a>  <span class="comment">                // Add found users to list.</span>
<a name="l1569"><span class="linenum">1569</span></a>                  for (<a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> = 0; <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> &lt; <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>); <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>++) {
<a name="l1570"><span class="linenum">1570</span></a>                      <a class="var it33994" onMouseOver="hilite(33994)" onMouseOut="lolite()" onClick="logVariable('extuser')" href="../../_variables/extuser.html">$extuser</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>[<a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>][<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_attribute][0],
<a name="l1571"><span class="linenum">1571</span></a>                                                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldapencoding, 'utf-8');
<a name="l1572"><span class="linenum">1572</span></a>                      <a class="phpfunction" onClick="logFunction('array_push')" href="../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>(<a class="var it33993" onMouseOver="hilite(33993)" onMouseOut="lolite()" onClick="logVariable('fresult')" href="../../_variables/fresult.html">$fresult</a>, <a class="var it33994" onMouseOver="hilite(33994)" onMouseOut="lolite()" onClick="logVariable('extuser')" href="../../_variables/extuser.html">$extuser</a>);
<a name="l1573"><span class="linenum">1573</span></a>                  }
<a name="l1574"><span class="linenum">1574</span></a>                  unset(<a class="var it24483" onMouseOver="hilite(24483)" onMouseOut="lolite()" onClick="logVariable('ldap_result')" href="../../_variables/ldap_result.html">$ldap_result</a>); <span class="comment">// Free mem.</span>
<a name="l1575"><span class="linenum">1575</span></a>              } while (<a class="var it24474" onMouseOver="hilite(24474)" onMouseOut="lolite()" onClick="logVariable('ldap_pagedresults')" href="../../_variables/ldap_pagedresults.html">$ldap_pagedresults</a> &amp;&amp; !empty(<a class="var it24479" onMouseOver="hilite(24479)" onMouseOut="lolite()" onClick="logVariable('ldap_cookie')" href="../../_variables/ldap_cookie.html">$ldap_cookie</a>));
<a name="l1576"><span class="linenum">1576</span></a>          }
<a name="l1577"><span class="linenum">1577</span></a>  
<a name="l1578"><span class="linenum">1578</span></a>  <span class="comment">        // If paged results were used, make sure the current connection is completely closed</span>
<a name="l1579"><span class="linenum">1579</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('ldap_close')" href="../../_functions/ldap_close.html" onMouseOver="funcPopup(event,'ldap_close')">ldap_close</a>(<a class="var it24474" onMouseOver="hilite(24474)" onMouseOut="lolite()" onClick="logVariable('ldap_pagedresults')" href="../../_variables/ldap_pagedresults.html">$ldap_pagedresults</a>);
<a name="l1580"><span class="linenum">1580</span></a>          return <a class="var it33993" onMouseOver="hilite(33993)" onMouseOut="lolite()" onClick="logVariable('fresult')" href="../../_variables/fresult.html">$fresult</a>;
<a name="l1581"><span class="linenum">1581</span></a>      }
<a name="l1582"><span class="linenum">1582</span></a>  
<a name="l1583"><span class="linenum">1583</span></a>      <span class="comment">/**</span>
<a name="l1584"><span class="linenum">1584</span></a>  <span class="comment">     * Indicates if password hashes should be stored in local moodle database.</span>
<a name="l1585"><span class="linenum">1585</span></a>  <span class="comment">     *</span>
<a name="l1586"><span class="linenum">1586</span></a>  <span class="comment">     * @return bool true means flag 'not_cached' stored instead of password hash</span>
<a name="l1587"><span class="linenum">1587</span></a>  <span class="comment">     */</span>
<a name="l1588"><span class="linenum">1588</span></a>      function <a class="function" onClick="logFunction('prevent_local_passwords')" href="../../_functions/prevent_local_passwords.html" onMouseOver="funcPopup(event,'prevent_local_passwords')">prevent_local_passwords</a>() {
<a name="l1589"><span class="linenum">1589</span></a>          return !empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;preventpassindb);
<a name="l1590"><span class="linenum">1590</span></a>      }
<a name="l1591"><span class="linenum">1591</span></a>  
<a name="l1592"><span class="linenum">1592</span></a>      <span class="comment">/**</span>
<a name="l1593"><span class="linenum">1593</span></a>  <span class="comment">     * Returns true if this authentication plugin is 'internal'.</span>
<a name="l1594"><span class="linenum">1594</span></a>  <span class="comment">     *</span>
<a name="l1595"><span class="linenum">1595</span></a>  <span class="comment">     * @return bool</span>
<a name="l1596"><span class="linenum">1596</span></a>  <span class="comment">     */</span>
<a name="l1597"><span class="linenum">1597</span></a>      function <a class="function" onClick="logFunction('is_internal')" href="../../_functions/is_internal.html" onMouseOver="funcPopup(event,'is_internal')">is_internal</a>() {
<a name="l1598"><span class="linenum">1598</span></a>          return false;
<a name="l1599"><span class="linenum">1599</span></a>      }
<a name="l1600"><span class="linenum">1600</span></a>  
<a name="l1601"><span class="linenum">1601</span></a>      <span class="comment">/**</span>
<a name="l1602"><span class="linenum">1602</span></a>  <span class="comment">     * Returns true if this authentication plugin can change the user's</span>
<a name="l1603"><span class="linenum">1603</span></a>  <span class="comment">     * password.</span>
<a name="l1604"><span class="linenum">1604</span></a>  <span class="comment">     *</span>
<a name="l1605"><span class="linenum">1605</span></a>  <span class="comment">     * @return bool</span>
<a name="l1606"><span class="linenum">1606</span></a>  <span class="comment">     */</span>
<a name="l1607"><span class="linenum">1607</span></a>      function <a class="function" onClick="logFunction('can_change_password')" href="../../_functions/can_change_password.html" onMouseOver="funcPopup(event,'can_change_password')">can_change_password</a>() {
<a name="l1608"><span class="linenum">1608</span></a>          return !empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;stdchangepassword) or !empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;changepasswordurl);
<a name="l1609"><span class="linenum">1609</span></a>      }
<a name="l1610"><span class="linenum">1610</span></a>  
<a name="l1611"><span class="linenum">1611</span></a>      <span class="comment">/**</span>
<a name="l1612"><span class="linenum">1612</span></a>  <span class="comment">     * Returns the URL for changing the user's password, or empty if the default can</span>
<a name="l1613"><span class="linenum">1613</span></a>  <span class="comment">     * be used.</span>
<a name="l1614"><span class="linenum">1614</span></a>  <span class="comment">     *</span>
<a name="l1615"><span class="linenum">1615</span></a>  <span class="comment">     * @return moodle_url</span>
<a name="l1616"><span class="linenum">1616</span></a>  <span class="comment">     */</span>
<a name="l1617"><span class="linenum">1617</span></a>      function <a class="function" onClick="logFunction('change_password_url')" href="../../_functions/change_password_url.html" onMouseOver="funcPopup(event,'change_password_url')">change_password_url</a>() {
<a name="l1618"><span class="linenum">1618</span></a>          if (empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;stdchangepassword)) {
<a name="l1619"><span class="linenum">1619</span></a>              if (!empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;changepasswordurl)) {
<a name="l1620"><span class="linenum">1620</span></a>                  return <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;changepasswordurl);
<a name="l1621"><span class="linenum">1621</span></a>              } else {
<a name="l1622"><span class="linenum">1622</span></a>                  return null;
<a name="l1623"><span class="linenum">1623</span></a>              }
<a name="l1624"><span class="linenum">1624</span></a>          } else {
<a name="l1625"><span class="linenum">1625</span></a>              return null;
<a name="l1626"><span class="linenum">1626</span></a>          }
<a name="l1627"><span class="linenum">1627</span></a>      }
<a name="l1628"><span class="linenum">1628</span></a>  
<a name="l1629"><span class="linenum">1629</span></a>      <span class="comment">/**</span>
<a name="l1630"><span class="linenum">1630</span></a>  <span class="comment">     * Will get called before the login page is shownr. Ff NTLM SSO</span>
<a name="l1631"><span class="linenum">1631</span></a>  <span class="comment">     * is enabled, and the user is in the right network, we'll redirect</span>
<a name="l1632"><span class="linenum">1632</span></a>  <span class="comment">     * to the magic NTLM page for SSO...</span>
<a name="l1633"><span class="linenum">1633</span></a>  <span class="comment">     *</span>
<a name="l1634"><span class="linenum">1634</span></a>  <span class="comment">     */</span>
<a name="l1635"><span class="linenum">1635</span></a>      function <a class="function" onClick="logFunction('loginpage_hook')" href="../../_functions/loginpage_hook.html" onMouseOver="funcPopup(event,'loginpage_hook')">loginpage_hook</a>() {
<a name="l1636"><span class="linenum">1636</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../../_variables/SESSION.html">$SESSION</a>;
<a name="l1637"><span class="linenum">1637</span></a>  
<a name="l1638"><span class="linenum">1638</span></a>  <span class="comment">        // HTTPS is potentially required</span>
<a name="l1639"><span class="linenum">1639</span></a>  <span class="comment">        //httpsrequired(); - this must be used before setting the URL, it is already done on the login/index.php</span>
<a name="l1640"><span class="linenum">1640</span></a>  
<a name="l1641"><span class="linenum">1641</span></a>          if ((<a class="var it836" onMouseOver="hilite(836)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['REQUEST_METHOD'] === 'GET'         // Only on initial GET of loginpage
<a name="l1642"><span class="linenum">1642</span></a>               || (<a class="var it836" onMouseOver="hilite(836)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['REQUEST_METHOD'] === 'POST'
<a name="l1643"><span class="linenum">1643</span></a>                   &amp;&amp; (<a class="function" onClick="logFunction('get_local_referer')" href="../../_functions/get_local_referer.html" onMouseOver="funcPopup(event,'get_local_referer')">get_local_referer</a>() != <a class="function" onClick="logFunction('strip_querystring')" href="../../_functions/strip_querystring.html" onMouseOver="funcPopup(event,'strip_querystring')">strip_querystring</a>(<a class="function" onClick="logFunction('qualified_me')" href="../../_functions/qualified_me.html" onMouseOver="funcPopup(event,'qualified_me')">qualified_me</a>()))))
<a name="l1644"><span class="linenum">1644</span></a>  <span class="comment">                                                          // Or when POSTed from another place</span>
<a name="l1645"><span class="linenum">1645</span></a>  <span class="comment">                                                          // See MDL-14071</span>
<a name="l1646"><span class="linenum">1646</span></a>              &amp;&amp; !empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ntlmsso_enabled)     // SSO enabled
<a name="l1647"><span class="linenum">1647</span></a>              &amp;&amp; !empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ntlmsso_subnet)      // have a subnet to test for
<a name="l1648"><span class="linenum">1648</span></a>              &amp;&amp; empty(<a class="var it385" onMouseOver="hilite(385)" onMouseOut="lolite()" onClick="logVariable('_GET')" href="../../_variables/_GET.html">$_GET</a>['authldap_skipntlmsso'])       // haven't failed it yet
<a name="l1649"><span class="linenum">1649</span></a>              &amp;&amp; (<a class="function" onClick="logFunction('isguestuser')" href="../../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>() || !<a class="function" onClick="logFunction('isloggedin')" href="../../_functions/isloggedin.html" onMouseOver="funcPopup(event,'isloggedin')">isloggedin</a>())           // guestuser or not-logged-in users
<a name="l1650"><span class="linenum">1650</span></a>              &amp;&amp; <a class="function" onClick="logFunction('address_in_subnet')" href="../../_functions/address_in_subnet.html" onMouseOver="funcPopup(event,'address_in_subnet')">address_in_subnet</a>(<a class="function" onClick="logFunction('getremoteaddr')" href="../../_functions/getremoteaddr.html" onMouseOver="funcPopup(event,'getremoteaddr')">getremoteaddr</a>(), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ntlmsso_subnet)) {
<a name="l1651"><span class="linenum">1651</span></a>  
<a name="l1652"><span class="linenum">1652</span></a>  <span class="comment">            // First, let's remember where we were trying to get to before we got here</span>
<a name="l1653"><span class="linenum">1653</span></a>              if (empty(<a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it42907" onMouseOver="hilite(42907)" onMouseOut="lolite()" href="../../_variables/wantsurl.html">wantsurl</a>)) {
<a name="l1654"><span class="linenum">1654</span></a>                  <a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it42907" onMouseOver="hilite(42907)" onMouseOut="lolite()" href="../../_variables/wantsurl.html">wantsurl</a> = null;
<a name="l1655"><span class="linenum">1655</span></a>                  <a class="var it382" onMouseOver="hilite(382)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../_variables/referer.html">$referer</a> = <a class="function" onClick="logFunction('get_local_referer')" href="../../_functions/get_local_referer.html" onMouseOver="funcPopup(event,'get_local_referer')">get_local_referer</a>(false);
<a name="l1656"><span class="linenum">1656</span></a>                  if (<a class="var it382" onMouseOver="hilite(382)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../_variables/referer.html">$referer</a> &amp;&amp;
<a name="l1657"><span class="linenum">1657</span></a>                          <a class="var it382" onMouseOver="hilite(382)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../_variables/referer.html">$referer</a> != <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a> &amp;&amp;
<a name="l1658"><span class="linenum">1658</span></a>                          <a class="var it382" onMouseOver="hilite(382)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../_variables/referer.html">$referer</a> != <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a> . '/' &amp;&amp;
<a name="l1659"><span class="linenum">1659</span></a>                          <a class="var it382" onMouseOver="hilite(382)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../_variables/referer.html">$referer</a> != <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('httpswwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/httpswwwroot.html">httpswwwroot</a> . '/login/' &amp;&amp;
<a name="l1660"><span class="linenum">1660</span></a>                          <a class="var it382" onMouseOver="hilite(382)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../_variables/referer.html">$referer</a> != <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('httpswwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/httpswwwroot.html">httpswwwroot</a> . '<a class="filename" href="../../login/index.php.html">/login/index.php</a>') {
<a name="l1661"><span class="linenum">1661</span></a>                      <a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it42907" onMouseOver="hilite(42907)" onMouseOut="lolite()" href="../../_variables/wantsurl.html">wantsurl</a> = <a class="var it382" onMouseOver="hilite(382)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../_variables/referer.html">$referer</a>;
<a name="l1662"><span class="linenum">1662</span></a>                  }
<a name="l1663"><span class="linenum">1663</span></a>              }
<a name="l1664"><span class="linenum">1664</span></a>  
<a name="l1665"><span class="linenum">1665</span></a>  <span class="comment">            // Now start the whole NTLM machinery.</span>
<a name="l1666"><span class="linenum">1666</span></a>              if(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ntlmsso_ie_fastpath == <a class="constant" onClick="logConstant('AUTH_NTLM_FASTPATH_YESATTEMPT')" href="../../_constants/AUTH_NTLM_FASTPATH_YESATTEMPT.html" onMouseOver="constPopup(event,'AUTH_NTLM_FASTPATH_YESATTEMPT')">AUTH_NTLM_FASTPATH_YESATTEMPT</a> ||
<a name="l1667"><span class="linenum">1667</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ntlmsso_ie_fastpath == <a class="constant" onClick="logConstant('AUTH_NTLM_FASTPATH_YESFORM')" href="../../_constants/AUTH_NTLM_FASTPATH_YESFORM.html" onMouseOver="constPopup(event,'AUTH_NTLM_FASTPATH_YESFORM')">AUTH_NTLM_FASTPATH_YESFORM</a>) {
<a name="l1668"><span class="linenum">1668</span></a>                  if (<a class="class" onClick="logClass('core_useragent')" href="../../_classes/core_useragent.html" onMouseOver="classPopup(event,'core_useragent')">core_useragent</a>::<a class="function" onClick="logFunction('is_ie')" href="../../_functions/is_ie.html" onMouseOver="funcPopup(event,'is_ie')">is_ie</a>()) {
<a name="l1669"><span class="linenum">1669</span></a>                      <a class="var it9164" onMouseOver="hilite(9164)" onMouseOut="lolite()" onClick="logVariable('sesskey')" href="../../_variables/sesskey.html">$sesskey</a> = <a class="function" onClick="logFunction('sesskey')" href="../../_functions/sesskey.html" onMouseOver="funcPopup(event,'sesskey')">sesskey</a>();
<a name="l1670"><span class="linenum">1670</span></a>                      <a class="function" onClick="logFunction('redirect')" href="../../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>.'/auth/ldap/ntlmsso_magic.php?sesskey='.<a class="var it9164" onMouseOver="hilite(9164)" onMouseOut="lolite()" onClick="logVariable('sesskey')" href="../../_variables/sesskey.html">$sesskey</a>);
<a name="l1671"><span class="linenum">1671</span></a>                  } else if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ntlmsso_ie_fastpath == <a class="constant" onClick="logConstant('AUTH_NTLM_FASTPATH_YESFORM')" href="../../_constants/AUTH_NTLM_FASTPATH_YESFORM.html" onMouseOver="constPopup(event,'AUTH_NTLM_FASTPATH_YESFORM')">AUTH_NTLM_FASTPATH_YESFORM</a>) {
<a name="l1672"><span class="linenum">1672</span></a>                      <a class="function" onClick="logFunction('redirect')" href="../../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('httpswwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/httpswwwroot.html">httpswwwroot</a>.'/login/index.php?authldap_skipntlmsso=1');
<a name="l1673"><span class="linenum">1673</span></a>                  }
<a name="l1674"><span class="linenum">1674</span></a>              }
<a name="l1675"><span class="linenum">1675</span></a>              <a class="function" onClick="logFunction('redirect')" href="../../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>.'<a class="filename" href="../../auth/ldap/ntlmsso_attempt.php.html">/auth/ldap/ntlmsso_attempt.php</a>');
<a name="l1676"><span class="linenum">1676</span></a>          }
<a name="l1677"><span class="linenum">1677</span></a>  
<a name="l1678"><span class="linenum">1678</span></a>  <span class="comment">        // No NTLM SSO, Use the normal login page instead.</span>
<a name="l1679"><span class="linenum">1679</span></a>  
<a name="l1680"><span class="linenum">1680</span></a>  <span class="comment">        // If $SESSION-&gt;wantsurl is empty and we have a 'Referer:' header, the login</span>
<a name="l1681"><span class="linenum">1681</span></a>  <span class="comment">        // page insists on redirecting us to that page after user validation. If</span>
<a name="l1682"><span class="linenum">1682</span></a>  <span class="comment">        // we clicked on the redirect link at the ntlmsso_finish.php page (instead</span>
<a name="l1683"><span class="linenum">1683</span></a>  <span class="comment">        // of waiting for the redirection to happen) then we have a 'Referer:' header</span>
<a name="l1684"><span class="linenum">1684</span></a>  <span class="comment">        // we don't want to use at all. As we can't get rid of it, just point</span>
<a name="l1685"><span class="linenum">1685</span></a>  <span class="comment">        // $SESSION-&gt;wantsurl to $CFG-&gt;wwwroot (after all, we came from there).</span>
<a name="l1686"><span class="linenum">1686</span></a>          if (empty(<a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it42907" onMouseOver="hilite(42907)" onMouseOut="lolite()" href="../../_variables/wantsurl.html">wantsurl</a>)
<a name="l1687"><span class="linenum">1687</span></a>              &amp;&amp; (<a class="function" onClick="logFunction('get_local_referer')" href="../../_functions/get_local_referer.html" onMouseOver="funcPopup(event,'get_local_referer')">get_local_referer</a>() == <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('httpswwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/httpswwwroot.html">httpswwwroot</a>.'<a class="filename" href="../../auth/ldap/ntlmsso_finish.php.html">/auth/ldap/ntlmsso_finish.php</a>')) {
<a name="l1688"><span class="linenum">1688</span></a>  
<a name="l1689"><span class="linenum">1689</span></a>              <a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it42907" onMouseOver="hilite(42907)" onMouseOut="lolite()" href="../../_variables/wantsurl.html">wantsurl</a> = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>;
<a name="l1690"><span class="linenum">1690</span></a>          }
<a name="l1691"><span class="linenum">1691</span></a>      }
<a name="l1692"><span class="linenum">1692</span></a>  
<a name="l1693"><span class="linenum">1693</span></a>      <span class="comment">/**</span>
<a name="l1694"><span class="linenum">1694</span></a>  <span class="comment">     * To be called from a page running under NTLM's</span>
<a name="l1695"><span class="linenum">1695</span></a>  <span class="comment">     * &quot;Integrated Windows Authentication&quot;.</span>
<a name="l1696"><span class="linenum">1696</span></a>  <span class="comment">     *</span>
<a name="l1697"><span class="linenum">1697</span></a>  <span class="comment">     * If successful, it will set a special &quot;cookie&quot; (not an HTTP cookie!)</span>
<a name="l1698"><span class="linenum">1698</span></a>  <span class="comment">     * in cache_flags under the $this-&gt;pluginconfig/ntlmsess &quot;plugin&quot; and return true.</span>
<a name="l1699"><span class="linenum">1699</span></a>  <span class="comment">     * The &quot;cookie&quot; will be picked up by ntlmsso_finish() to complete the</span>
<a name="l1700"><span class="linenum">1700</span></a>  <span class="comment">     * process.</span>
<a name="l1701"><span class="linenum">1701</span></a>  <span class="comment">     *</span>
<a name="l1702"><span class="linenum">1702</span></a>  <span class="comment">     * On failure it will return false for the caller to display an appropriate</span>
<a name="l1703"><span class="linenum">1703</span></a>  <span class="comment">     * error message (probably saying that Integrated Windows Auth isn't enabled!)</span>
<a name="l1704"><span class="linenum">1704</span></a>  <span class="comment">     *</span>
<a name="l1705"><span class="linenum">1705</span></a>  <span class="comment">     * NOTE that this code will execute under the OS user credentials,</span>
<a name="l1706"><span class="linenum">1706</span></a>  <span class="comment">     * so we MUST avoid dealing with files -- such as session files.</span>
<a name="l1707"><span class="linenum">1707</span></a>  <span class="comment">     * (The caller should define('NO_MOODLE_COOKIES', true) before including config.php)</span>
<a name="l1708"><span class="linenum">1708</span></a>  <span class="comment">     *</span>
<a name="l1709"><span class="linenum">1709</span></a>  <span class="comment">     */</span>
<a name="l1710"><span class="linenum">1710</span></a>      function <a class="function" onClick="logFunction('ntlmsso_magic')" href="../../_functions/ntlmsso_magic.html" onMouseOver="funcPopup(event,'ntlmsso_magic')">ntlmsso_magic</a>(<a class="var it9164" onMouseOver="hilite(9164)" onMouseOut="lolite()" onClick="logVariable('sesskey')" href="../../_variables/sesskey.html">$sesskey</a>) {
<a name="l1711"><span class="linenum">1711</span></a>          if (isset(<a class="var it836" onMouseOver="hilite(836)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['REMOTE_USER']) &amp;&amp; !empty(<a class="var it836" onMouseOver="hilite(836)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['REMOTE_USER'])) {
<a name="l1712"><span class="linenum">1712</span></a>  
<a name="l1713"><span class="linenum">1713</span></a>  <span class="comment">            // HTTP __headers__ seem to be sent in ISO-8859-1 encoding</span>
<a name="l1714"><span class="linenum">1714</span></a>  <span class="comment">            // (according to my reading of RFC-1945, RFC-2616 and RFC-2617 and</span>
<a name="l1715"><span class="linenum">1715</span></a>  <span class="comment">            // my local tests), so we need to convert the REMOTE_USER value</span>
<a name="l1716"><span class="linenum">1716</span></a>  <span class="comment">            // (i.e., what we got from the HTTP WWW-Authenticate header) into UTF-8</span>
<a name="l1717"><span class="linenum">1717</span></a>              <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it836" onMouseOver="hilite(836)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['REMOTE_USER'], 'iso-8859-1', 'utf-8');
<a name="l1718"><span class="linenum">1718</span></a>  
<a name="l1719"><span class="linenum">1719</span></a>              switch (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ntlmsso_type) {
<a name="l1720"><span class="linenum">1720</span></a>                  case 'ntlm':
<a name="l1721"><span class="linenum">1721</span></a>  <span class="comment">                    // The format is now configurable, so try to extract the username</span>
<a name="l1722"><span class="linenum">1722</span></a>                      <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_ntlm_remote_user')" href="../../_functions/get_ntlm_remote_user.html" onMouseOver="funcPopup(event,'get_ntlm_remote_user')">get_ntlm_remote_user</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>);
<a name="l1723"><span class="linenum">1723</span></a>                      if (empty(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>)) {
<a name="l1724"><span class="linenum">1724</span></a>                          return false;
<a name="l1725"><span class="linenum">1725</span></a>                      }
<a name="l1726"><span class="linenum">1726</span></a>                      break;
<a name="l1727"><span class="linenum">1727</span></a>                  case 'kerberos':
<a name="l1728"><span class="linenum">1728</span></a>  <span class="comment">                    // Format is username@DOMAIN</span>
<a name="l1729"><span class="linenum">1729</span></a>                      <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, 0, <a class="phpfunction" onClick="logFunction('strpos')" href="../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, '@'));
<a name="l1730"><span class="linenum">1730</span></a>                      break;
<a name="l1731"><span class="linenum">1731</span></a>                  default:
<a name="l1732"><span class="linenum">1732</span></a>                      <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a> ('ntlmsso_unknowntype', 'auth_ldap'));
<a name="l1733"><span class="linenum">1733</span></a>                      return false; <span class="comment">// Should never happen!</span>
<a name="l1734"><span class="linenum">1734</span></a>              }
<a name="l1735"><span class="linenum">1735</span></a>  
<a name="l1736"><span class="linenum">1736</span></a>              <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>); <span class="comment">// Compatibility hack</span>
<a name="l1737"><span class="linenum">1737</span></a>              <a class="function" onClick="logFunction('set_cache_flag')" href="../../_functions/set_cache_flag.html" onMouseOver="funcPopup(event,'set_cache_flag')">set_cache_flag</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>.'/ntlmsess', <a class="var it9164" onMouseOver="hilite(9164)" onMouseOut="lolite()" onClick="logVariable('sesskey')" href="../../_variables/sesskey.html">$sesskey</a>, <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, <a class="constant" onClick="logConstant('AUTH_NTLMTIMEOUT')" href="../../_constants/AUTH_NTLMTIMEOUT.html" onMouseOver="constPopup(event,'AUTH_NTLMTIMEOUT')">AUTH_NTLMTIMEOUT</a>);
<a name="l1738"><span class="linenum">1738</span></a>              return true;
<a name="l1739"><span class="linenum">1739</span></a>          }
<a name="l1740"><span class="linenum">1740</span></a>          return false;
<a name="l1741"><span class="linenum">1741</span></a>      }
<a name="l1742"><span class="linenum">1742</span></a>  
<a name="l1743"><span class="linenum">1743</span></a>      <span class="comment">/**</span>
<a name="l1744"><span class="linenum">1744</span></a>  <span class="comment">     * Find the session set by ntlmsso_magic(), validate it and</span>
<a name="l1745"><span class="linenum">1745</span></a>  <span class="comment">     * call authenticate_user_login() to authenticate the user through</span>
<a name="l1746"><span class="linenum">1746</span></a>  <span class="comment">     * the auth machinery.</span>
<a name="l1747"><span class="linenum">1747</span></a>  <span class="comment">     *</span>
<a name="l1748"><span class="linenum">1748</span></a>  <span class="comment">     * It is complemented by a similar check in user_login().</span>
<a name="l1749"><span class="linenum">1749</span></a>  <span class="comment">     *</span>
<a name="l1750"><span class="linenum">1750</span></a>  <span class="comment">     * If it succeeds, it never returns.</span>
<a name="l1751"><span class="linenum">1751</span></a>  <span class="comment">     *</span>
<a name="l1752"><span class="linenum">1752</span></a>  <span class="comment">     */</span>
<a name="l1753"><span class="linenum">1753</span></a>      function <a class="function" onClick="logFunction('ntlmsso_finish')" href="../../_functions/ntlmsso_finish.html" onMouseOver="funcPopup(event,'ntlmsso_finish')">ntlmsso_finish</a>() {
<a name="l1754"><span class="linenum">1754</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../../_variables/SESSION.html">$SESSION</a>;
<a name="l1755"><span class="linenum">1755</span></a>  
<a name="l1756"><span class="linenum">1756</span></a>          <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <a class="function" onClick="logFunction('sesskey')" href="../../_functions/sesskey.html" onMouseOver="funcPopup(event,'sesskey')">sesskey</a>();
<a name="l1757"><span class="linenum">1757</span></a>          <a class="var it7104" onMouseOver="hilite(7104)" onMouseOut="lolite()" onClick="logVariable('cf')" href="../../_variables/cf.html">$cf</a> = <a class="function" onClick="logFunction('get_cache_flags')" href="../../_functions/get_cache_flags.html" onMouseOver="funcPopup(event,'get_cache_flags')">get_cache_flags</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>.'/ntlmsess');
<a name="l1758"><span class="linenum">1758</span></a>          if (!isset(<a class="var it7104" onMouseOver="hilite(7104)" onMouseOut="lolite()" onClick="logVariable('cf')" href="../../_variables/cf.html">$cf</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>]) || <a class="var it7104" onMouseOver="hilite(7104)" onMouseOut="lolite()" onClick="logVariable('cf')" href="../../_variables/cf.html">$cf</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>] === '') {
<a name="l1759"><span class="linenum">1759</span></a>              return false;
<a name="l1760"><span class="linenum">1760</span></a>          }
<a name="l1761"><span class="linenum">1761</span></a>          <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>   = <a class="var it7104" onMouseOver="hilite(7104)" onMouseOut="lolite()" onClick="logVariable('cf')" href="../../_variables/cf.html">$cf</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>];
<a name="l1762"><span class="linenum">1762</span></a>  
<a name="l1763"><span class="linenum">1763</span></a>  <span class="comment">        // Here we want to trigger the whole authentication machinery</span>
<a name="l1764"><span class="linenum">1764</span></a>  <span class="comment">        // to make sure no step is bypassed...</span>
<a name="l1765"><span class="linenum">1765</span></a>          <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a> = <a class="function" onClick="logFunction('authenticate_user_login')" href="../../_functions/authenticate_user_login.html" onMouseOver="funcPopup(event,'authenticate_user_login')">authenticate_user_login</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>);
<a name="l1766"><span class="linenum">1766</span></a>          if (<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>) {
<a name="l1767"><span class="linenum">1767</span></a>              <a class="function" onClick="logFunction('complete_user_login')" href="../../_functions/complete_user_login.html" onMouseOver="funcPopup(event,'complete_user_login')">complete_user_login</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>);
<a name="l1768"><span class="linenum">1768</span></a>  
<a name="l1769"><span class="linenum">1769</span></a>  <span class="comment">            // Cleanup the key to prevent reuse...</span>
<a name="l1770"><span class="linenum">1770</span></a>  <span class="comment">            // and to allow re-logins with normal credentials</span>
<a name="l1771"><span class="linenum">1771</span></a>              <a class="function" onClick="logFunction('unset_cache_flag')" href="../../_functions/unset_cache_flag.html" onMouseOver="funcPopup(event,'unset_cache_flag')">unset_cache_flag</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>.'/ntlmsess', <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>);
<a name="l1772"><span class="linenum">1772</span></a>  
<a name="l1773"><span class="linenum">1773</span></a>  <span class="comment">            // Redirection</span>
<a name="l1774"><span class="linenum">1774</span></a>              if (<a class="function" onClick="logFunction('user_not_fully_set_up')" href="../../_functions/user_not_fully_set_up.html" onMouseOver="funcPopup(event,'user_not_fully_set_up')">user_not_fully_set_up</a>(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>)) {
<a name="l1775"><span class="linenum">1775</span></a>                  <a class="var it357" onMouseOver="hilite(357)" onMouseOut="lolite()" onClick="logVariable('urltogo')" href="../../_variables/urltogo.html">$urltogo</a> = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>.'<a class="filename" href="../../user/edit.php.html">/user/edit.php</a>';
<a name="l1776"><span class="linenum">1776</span></a>  <span class="comment">                // We don't delete $SESSION-&gt;wantsurl yet, so we get there later</span>
<a name="l1777"><span class="linenum">1777</span></a>              } else if (isset(<a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it42907" onMouseOver="hilite(42907)" onMouseOut="lolite()" href="../../_variables/wantsurl.html">wantsurl</a>) and (<a class="phpfunction" onClick="logFunction('strpos')" href="../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it42907" onMouseOver="hilite(42907)" onMouseOut="lolite()" href="../../_variables/wantsurl.html">wantsurl</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>) === 0)) {
<a name="l1778"><span class="linenum">1778</span></a>                  <a class="var it357" onMouseOver="hilite(357)" onMouseOut="lolite()" onClick="logVariable('urltogo')" href="../../_variables/urltogo.html">$urltogo</a> = <a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it42907" onMouseOver="hilite(42907)" onMouseOut="lolite()" href="../../_variables/wantsurl.html">wantsurl</a>;    <span class="comment">// Because it's an address in this site</span>
<a name="l1779"><span class="linenum">1779</span></a>                  unset(<a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it42907" onMouseOver="hilite(42907)" onMouseOut="lolite()" href="../../_variables/wantsurl.html">wantsurl</a>);
<a name="l1780"><span class="linenum">1780</span></a>              } else {
<a name="l1781"><span class="linenum">1781</span></a>  <span class="comment">                // No wantsurl stored or external - go to homepage</span>
<a name="l1782"><span class="linenum">1782</span></a>                  <a class="var it357" onMouseOver="hilite(357)" onMouseOut="lolite()" onClick="logVariable('urltogo')" href="../../_variables/urltogo.html">$urltogo</a> = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>.'/';
<a name="l1783"><span class="linenum">1783</span></a>                  unset(<a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it42907" onMouseOver="hilite(42907)" onMouseOut="lolite()" href="../../_variables/wantsurl.html">wantsurl</a>);
<a name="l1784"><span class="linenum">1784</span></a>              }
<a name="l1785"><span class="linenum">1785</span></a>  <span class="comment">            // We do not want to redirect if we are in a PHPUnit test.</span>
<a name="l1786"><span class="linenum">1786</span></a>              if (!<a class="constant" onClick="logConstant('PHPUNIT_TEST')" href="../../_constants/PHPUNIT_TEST.html" onMouseOver="constPopup(event,'PHPUNIT_TEST')">PHPUNIT_TEST</a>) {
<a name="l1787"><span class="linenum">1787</span></a>                  <a class="function" onClick="logFunction('redirect')" href="../../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<a class="var it357" onMouseOver="hilite(357)" onMouseOut="lolite()" onClick="logVariable('urltogo')" href="../../_variables/urltogo.html">$urltogo</a>);
<a name="l1788"><span class="linenum">1788</span></a>              }
<a name="l1789"><span class="linenum">1789</span></a>          }
<a name="l1790"><span class="linenum">1790</span></a>  <span class="comment">        // Should never reach here.</span>
<a name="l1791"><span class="linenum">1791</span></a>          return false;
<a name="l1792"><span class="linenum">1792</span></a>      }
<a name="l1793"><span class="linenum">1793</span></a>  
<a name="l1794"><span class="linenum">1794</span></a>      <span class="comment">/**</span>
<a name="l1795"><span class="linenum">1795</span></a>  <span class="comment">     * Sync roles for this user</span>
<a name="l1796"><span class="linenum">1796</span></a>  <span class="comment">     *</span>
<a name="l1797"><span class="linenum">1797</span></a>  <span class="comment">     * @param $user object user object (without system magic quotes)</span>
<a name="l1798"><span class="linenum">1798</span></a>  <span class="comment">     */</span>
<a name="l1799"><span class="linenum">1799</span></a>      function <a class="function" onClick="logFunction('sync_roles')" href="../../_functions/sync_roles.html" onMouseOver="funcPopup(event,'sync_roles')">sync_roles</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>) {
<a name="l1800"><span class="linenum">1800</span></a>          <a class="var it33995" onMouseOver="hilite(33995)" onMouseOut="lolite()" onClick="logVariable('iscreator')" href="../../_variables/iscreator.html">$iscreator</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('iscreator')" href="../../_functions/iscreator.html" onMouseOver="funcPopup(event,'iscreator')">iscreator</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>);
<a name="l1801"><span class="linenum">1801</span></a>          if (<a class="var it33995" onMouseOver="hilite(33995)" onMouseOut="lolite()" onClick="logVariable('iscreator')" href="../../_variables/iscreator.html">$iscreator</a> === null) {
<a name="l1802"><span class="linenum">1802</span></a>              return; <span class="comment">// Nothing to sync - creators not configured</span>
<a name="l1803"><span class="linenum">1803</span></a>          }
<a name="l1804"><span class="linenum">1804</span></a>  
<a name="l1805"><span class="linenum">1805</span></a>          if (<a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('roles')" href="../../_variables/roles.html">$roles</a> = <a class="function" onClick="logFunction('get_archetype_roles')" href="../../_functions/get_archetype_roles.html" onMouseOver="funcPopup(event,'get_archetype_roles')">get_archetype_roles</a>('coursecreator')) {
<a name="l1806"><span class="linenum">1806</span></a>              <a class="var it12208" onMouseOver="hilite(12208)" onMouseOut="lolite()" onClick="logVariable('creatorrole')" href="../../_variables/creatorrole.html">$creatorrole</a> = <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('roles')" href="../../_variables/roles.html">$roles</a>);      <span class="comment">// We can only use one, let's use the first one</span>
<a name="l1807"><span class="linenum">1807</span></a>              <a class="var it221" onMouseOver="hilite(221)" onMouseOut="lolite()" onClick="logVariable('systemcontext')" href="../../_variables/systemcontext.html">$systemcontext</a> = <a class="class" onClick="logClass('context_system')" href="../../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>();
<a name="l1808"><span class="linenum">1808</span></a>  
<a name="l1809"><span class="linenum">1809</span></a>              if (<a class="var it33995" onMouseOver="hilite(33995)" onMouseOut="lolite()" onClick="logVariable('iscreator')" href="../../_variables/iscreator.html">$iscreator</a>) { // Following calls will not create duplicates
<a name="l1810"><span class="linenum">1810</span></a>                  <a class="function" onClick="logFunction('role_assign')" href="../../_functions/role_assign.html" onMouseOver="funcPopup(event,'role_assign')">role_assign</a>(<a class="var it12208" onMouseOver="hilite(12208)" onMouseOut="lolite()" onClick="logVariable('creatorrole')" href="../../_variables/creatorrole.html">$creatorrole</a>-&gt;<a onClick="logVariable('id')" class="var it43848" onMouseOver="hilite(43848)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it221" onMouseOver="hilite(221)" onMouseOut="lolite()" onClick="logVariable('systemcontext')" href="../../_variables/systemcontext.html">$systemcontext</a>-&gt;<a onClick="logVariable('id')" class="var it42913" onMouseOver="hilite(42913)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('roleauth')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/roleauth.html">roleauth</a>);
<a name="l1811"><span class="linenum">1811</span></a>              } else {
<a name="l1812"><span class="linenum">1812</span></a>  <span class="comment">                // Unassign only if previously assigned by this plugin!</span>
<a name="l1813"><span class="linenum">1813</span></a>                  <a class="function" onClick="logFunction('role_unassign')" href="../../_functions/role_unassign.html" onMouseOver="funcPopup(event,'role_unassign')">role_unassign</a>(<a class="var it12208" onMouseOver="hilite(12208)" onMouseOut="lolite()" onClick="logVariable('creatorrole')" href="../../_variables/creatorrole.html">$creatorrole</a>-&gt;<a onClick="logVariable('id')" class="var it43848" onMouseOver="hilite(43848)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it221" onMouseOver="hilite(221)" onMouseOut="lolite()" onClick="logVariable('systemcontext')" href="../../_variables/systemcontext.html">$systemcontext</a>-&gt;<a onClick="logVariable('id')" class="var it42913" onMouseOver="hilite(42913)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('roleauth')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/roleauth.html">roleauth</a>);
<a name="l1814"><span class="linenum">1814</span></a>              }
<a name="l1815"><span class="linenum">1815</span></a>          }
<a name="l1816"><span class="linenum">1816</span></a>      }
<a name="l1817"><span class="linenum">1817</span></a>  
<a name="l1818"><span class="linenum">1818</span></a>      <span class="comment">/**</span>
<a name="l1819"><span class="linenum">1819</span></a>  <span class="comment">     * Prints a form for configuring this authentication plugin.</span>
<a name="l1820"><span class="linenum">1820</span></a>  <span class="comment">     *</span>
<a name="l1821"><span class="linenum">1821</span></a>  <span class="comment">     * This function is called from admin/auth.php, and outputs a full page with</span>
<a name="l1822"><span class="linenum">1822</span></a>  <span class="comment">     * a form for configuring this plugin.</span>
<a name="l1823"><span class="linenum">1823</span></a>  <span class="comment">     *</span>
<a name="l1824"><span class="linenum">1824</span></a>  <span class="comment">     * @param array $page An object containing all the data for this page.</span>
<a name="l1825"><span class="linenum">1825</span></a>  <span class="comment">     */</span>
<a name="l1826"><span class="linenum">1826</span></a>      function <a class="function" onClick="logFunction('config_form')" href="../../_functions/config_form.html" onMouseOver="funcPopup(event,'config_form')">config_form</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>, <a class="var it210" onMouseOver="hilite(210)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../_variables/err.html">$err</a>, <a class="var it211" onMouseOver="hilite(211)" onMouseOut="lolite()" onClick="logVariable('user_fields')" href="../../_variables/user_fields.html">$user_fields</a>) {
<a name="l1827"><span class="linenum">1827</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>;
<a name="l1828"><span class="linenum">1828</span></a>  
<a name="l1829"><span class="linenum">1829</span></a>          if (!<a class="phpfunction" onClick="logFunction('function_exists')" href="../../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>('ldap_connect')) { // Is php-ldap really there?
<a name="l1830"><span class="linenum">1830</span></a>              echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('auth_ldap_noextension', 'auth_ldap'));
<a name="l1831"><span class="linenum">1831</span></a>              return;
<a name="l1832"><span class="linenum">1832</span></a>          }
<a name="l1833"><span class="linenum">1833</span></a>  
<a name="l1834"><span class="linenum">1834</span></a>          include(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../auth/ldap/config.html.html">/auth/ldap/config.html</a>');
<a name="l1835"><span class="linenum">1835</span></a>      }
<a name="l1836"><span class="linenum">1836</span></a>  
<a name="l1837"><span class="linenum">1837</span></a>      <span class="comment">/**</span>
<a name="l1838"><span class="linenum">1838</span></a>  <span class="comment">     * Processes and stores configuration data for this authentication plugin.</span>
<a name="l1839"><span class="linenum">1839</span></a>  <span class="comment">     */</span>
<a name="l1840"><span class="linenum">1840</span></a>      function <a class="function" onClick="logFunction('process_config')" href="../../_functions/process_config.html" onMouseOver="funcPopup(event,'process_config')">process_config</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>) {
<a name="l1841"><span class="linenum">1841</span></a>  <span class="comment">        // Set to defaults if undefined</span>
<a name="l1842"><span class="linenum">1842</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('host_url')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/host_url.html">host_url</a>)) {
<a name="l1843"><span class="linenum">1843</span></a>               <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('host_url')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/host_url.html">host_url</a> = '';
<a name="l1844"><span class="linenum">1844</span></a>          }
<a name="l1845"><span class="linenum">1845</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('start_tls')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/start_tls.html">start_tls</a>)) {
<a name="l1846"><span class="linenum">1846</span></a>               <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('start_tls')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/start_tls.html">start_tls</a> = false;
<a name="l1847"><span class="linenum">1847</span></a>          }
<a name="l1848"><span class="linenum">1848</span></a>          if (empty(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ldapencoding')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ldapencoding.html">ldapencoding</a>)) {
<a name="l1849"><span class="linenum">1849</span></a>           <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ldapencoding')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ldapencoding.html">ldapencoding</a> = 'utf-8';
<a name="l1850"><span class="linenum">1850</span></a>          }
<a name="l1851"><span class="linenum">1851</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('pagesize')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/pagesize.html">pagesize</a>)) {
<a name="l1852"><span class="linenum">1852</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('pagesize')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/pagesize.html">pagesize</a> = <a class="constant" onClick="logConstant('LDAP_DEFAULT_PAGESIZE')" href="../../_constants/LDAP_DEFAULT_PAGESIZE.html" onMouseOver="constPopup(event,'LDAP_DEFAULT_PAGESIZE')">LDAP_DEFAULT_PAGESIZE</a>;
<a name="l1853"><span class="linenum">1853</span></a>          }
<a name="l1854"><span class="linenum">1854</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('contexts')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/contexts.html">contexts</a>)) {
<a name="l1855"><span class="linenum">1855</span></a>               <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('contexts')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/contexts.html">contexts</a> = '';
<a name="l1856"><span class="linenum">1856</span></a>          }
<a name="l1857"><span class="linenum">1857</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('user_type')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/user_type.html">user_type</a>)) {
<a name="l1858"><span class="linenum">1858</span></a>               <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('user_type')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/user_type.html">user_type</a> = 'default';
<a name="l1859"><span class="linenum">1859</span></a>          }
<a name="l1860"><span class="linenum">1860</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('user_attribute')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/user_attribute.html">user_attribute</a>)) {
<a name="l1861"><span class="linenum">1861</span></a>               <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('user_attribute')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/user_attribute.html">user_attribute</a> = '';
<a name="l1862"><span class="linenum">1862</span></a>          }
<a name="l1863"><span class="linenum">1863</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('suspended_attribute')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/suspended_attribute.html">suspended_attribute</a>)) {
<a name="l1864"><span class="linenum">1864</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('suspended_attribute')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/suspended_attribute.html">suspended_attribute</a> = '';
<a name="l1865"><span class="linenum">1865</span></a>          }
<a name="l1866"><span class="linenum">1866</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('sync_suspended')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/sync_suspended.html">sync_suspended</a>)) {
<a name="l1867"><span class="linenum">1867</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('sync_suspended')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/sync_suspended.html">sync_suspended</a> = false;
<a name="l1868"><span class="linenum">1868</span></a>          }
<a name="l1869"><span class="linenum">1869</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('search_sub')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/search_sub.html">search_sub</a>)) {
<a name="l1870"><span class="linenum">1870</span></a>               <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('search_sub')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/search_sub.html">search_sub</a> = '';
<a name="l1871"><span class="linenum">1871</span></a>          }
<a name="l1872"><span class="linenum">1872</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('opt_deref')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/opt_deref.html">opt_deref</a>)) {
<a name="l1873"><span class="linenum">1873</span></a>               <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('opt_deref')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/opt_deref.html">opt_deref</a> = <a class="constant" onClick="logConstant('LDAP_DEREF_NEVER')" href="../../_constants/LDAP_DEREF_NEVER.html" onMouseOver="constPopup(event,'LDAP_DEREF_NEVER')">LDAP_DEREF_NEVER</a>;
<a name="l1874"><span class="linenum">1874</span></a>          }
<a name="l1875"><span class="linenum">1875</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('preventpassindb')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/preventpassindb.html">preventpassindb</a>)) {
<a name="l1876"><span class="linenum">1876</span></a>               <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('preventpassindb')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/preventpassindb.html">preventpassindb</a> = 0;
<a name="l1877"><span class="linenum">1877</span></a>          }
<a name="l1878"><span class="linenum">1878</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('bind_dn')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/bind_dn.html">bind_dn</a>)) {
<a name="l1879"><span class="linenum">1879</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('bind_dn')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/bind_dn.html">bind_dn</a> = '';
<a name="l1880"><span class="linenum">1880</span></a>          }
<a name="l1881"><span class="linenum">1881</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('bind_pw')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/bind_pw.html">bind_pw</a>)) {
<a name="l1882"><span class="linenum">1882</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('bind_pw')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/bind_pw.html">bind_pw</a> = '';
<a name="l1883"><span class="linenum">1883</span></a>          }
<a name="l1884"><span class="linenum">1884</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ldap_version')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ldap_version.html">ldap_version</a>)) {
<a name="l1885"><span class="linenum">1885</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ldap_version')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ldap_version.html">ldap_version</a> = '3';
<a name="l1886"><span class="linenum">1886</span></a>          }
<a name="l1887"><span class="linenum">1887</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('objectclass')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/objectclass.html">objectclass</a>)) {
<a name="l1888"><span class="linenum">1888</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('objectclass')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/objectclass.html">objectclass</a> = '';
<a name="l1889"><span class="linenum">1889</span></a>          }
<a name="l1890"><span class="linenum">1890</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('memberattribute')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/memberattribute.html">memberattribute</a>)) {
<a name="l1891"><span class="linenum">1891</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('memberattribute')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/memberattribute.html">memberattribute</a> = '';
<a name="l1892"><span class="linenum">1892</span></a>          }
<a name="l1893"><span class="linenum">1893</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('memberattribute_isdn')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/memberattribute_isdn.html">memberattribute_isdn</a>)) {
<a name="l1894"><span class="linenum">1894</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('memberattribute_isdn')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/memberattribute_isdn.html">memberattribute_isdn</a> = '';
<a name="l1895"><span class="linenum">1895</span></a>          }
<a name="l1896"><span class="linenum">1896</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('creators')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/creators.html">creators</a>)) {
<a name="l1897"><span class="linenum">1897</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('creators')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/creators.html">creators</a> = '';
<a name="l1898"><span class="linenum">1898</span></a>          }
<a name="l1899"><span class="linenum">1899</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('create_context')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/create_context.html">create_context</a>)) {
<a name="l1900"><span class="linenum">1900</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('create_context')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/create_context.html">create_context</a> = '';
<a name="l1901"><span class="linenum">1901</span></a>          }
<a name="l1902"><span class="linenum">1902</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('expiration')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/expiration.html">expiration</a>)) {
<a name="l1903"><span class="linenum">1903</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('expiration')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/expiration.html">expiration</a> = '';
<a name="l1904"><span class="linenum">1904</span></a>          }
<a name="l1905"><span class="linenum">1905</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('expiration_warning')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/expiration_warning.html">expiration_warning</a>)) {
<a name="l1906"><span class="linenum">1906</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('expiration_warning')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/expiration_warning.html">expiration_warning</a> = '10';
<a name="l1907"><span class="linenum">1907</span></a>          }
<a name="l1908"><span class="linenum">1908</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('expireattr')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/expireattr.html">expireattr</a>)) {
<a name="l1909"><span class="linenum">1909</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('expireattr')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/expireattr.html">expireattr</a> = '';
<a name="l1910"><span class="linenum">1910</span></a>          }
<a name="l1911"><span class="linenum">1911</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('gracelogins')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/gracelogins.html">gracelogins</a>)) {
<a name="l1912"><span class="linenum">1912</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('gracelogins')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/gracelogins.html">gracelogins</a> = '';
<a name="l1913"><span class="linenum">1913</span></a>          }
<a name="l1914"><span class="linenum">1914</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('graceattr')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/graceattr.html">graceattr</a>)) {
<a name="l1915"><span class="linenum">1915</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('graceattr')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/graceattr.html">graceattr</a> = '';
<a name="l1916"><span class="linenum">1916</span></a>          }
<a name="l1917"><span class="linenum">1917</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('auth_user_create')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/auth_user_create.html">auth_user_create</a>)) {
<a name="l1918"><span class="linenum">1918</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('auth_user_create')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/auth_user_create.html">auth_user_create</a> = '';
<a name="l1919"><span class="linenum">1919</span></a>          }
<a name="l1920"><span class="linenum">1920</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('forcechangepassword')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/forcechangepassword.html">forcechangepassword</a>)) {
<a name="l1921"><span class="linenum">1921</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('forcechangepassword')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/forcechangepassword.html">forcechangepassword</a> = 0;
<a name="l1922"><span class="linenum">1922</span></a>          }
<a name="l1923"><span class="linenum">1923</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('stdchangepassword')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/stdchangepassword.html">stdchangepassword</a>)) {
<a name="l1924"><span class="linenum">1924</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('stdchangepassword')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/stdchangepassword.html">stdchangepassword</a> = 0;
<a name="l1925"><span class="linenum">1925</span></a>          }
<a name="l1926"><span class="linenum">1926</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('passtype')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/passtype.html">passtype</a>)) {
<a name="l1927"><span class="linenum">1927</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('passtype')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/passtype.html">passtype</a> = 'plaintext';
<a name="l1928"><span class="linenum">1928</span></a>          }
<a name="l1929"><span class="linenum">1929</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('changepasswordurl')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/changepasswordurl.html">changepasswordurl</a>)) {
<a name="l1930"><span class="linenum">1930</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('changepasswordurl')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/changepasswordurl.html">changepasswordurl</a> = '';
<a name="l1931"><span class="linenum">1931</span></a>          }
<a name="l1932"><span class="linenum">1932</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('removeuser')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/removeuser.html">removeuser</a>)) {
<a name="l1933"><span class="linenum">1933</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('removeuser')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/removeuser.html">removeuser</a> = <a class="constant" onClick="logConstant('AUTH_REMOVEUSER_KEEP')" href="../../_constants/AUTH_REMOVEUSER_KEEP.html" onMouseOver="constPopup(event,'AUTH_REMOVEUSER_KEEP')">AUTH_REMOVEUSER_KEEP</a>;
<a name="l1934"><span class="linenum">1934</span></a>          }
<a name="l1935"><span class="linenum">1935</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ntlmsso_enabled')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ntlmsso_enabled.html">ntlmsso_enabled</a>)) {
<a name="l1936"><span class="linenum">1936</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ntlmsso_enabled')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ntlmsso_enabled.html">ntlmsso_enabled</a> = 0;
<a name="l1937"><span class="linenum">1937</span></a>          }
<a name="l1938"><span class="linenum">1938</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ntlmsso_subnet')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ntlmsso_subnet.html">ntlmsso_subnet</a>)) {
<a name="l1939"><span class="linenum">1939</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ntlmsso_subnet')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ntlmsso_subnet.html">ntlmsso_subnet</a> = '';
<a name="l1940"><span class="linenum">1940</span></a>          }
<a name="l1941"><span class="linenum">1941</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ntlmsso_ie_fastpath')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ntlmsso_ie_fastpath.html">ntlmsso_ie_fastpath</a>)) {
<a name="l1942"><span class="linenum">1942</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ntlmsso_ie_fastpath')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ntlmsso_ie_fastpath.html">ntlmsso_ie_fastpath</a> = 0;
<a name="l1943"><span class="linenum">1943</span></a>          }
<a name="l1944"><span class="linenum">1944</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ntlmsso_type')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ntlmsso_type.html">ntlmsso_type</a>)) {
<a name="l1945"><span class="linenum">1945</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ntlmsso_type')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ntlmsso_type.html">ntlmsso_type</a> = 'ntlm';
<a name="l1946"><span class="linenum">1946</span></a>          }
<a name="l1947"><span class="linenum">1947</span></a>          if (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ntlmsso_remoteuserformat')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ntlmsso_remoteuserformat.html">ntlmsso_remoteuserformat</a>)) {
<a name="l1948"><span class="linenum">1948</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ntlmsso_remoteuserformat')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ntlmsso_remoteuserformat.html">ntlmsso_remoteuserformat</a> = '';
<a name="l1949"><span class="linenum">1949</span></a>          }
<a name="l1950"><span class="linenum">1950</span></a>  
<a name="l1951"><span class="linenum">1951</span></a>  <span class="comment">        // Try to remove duplicates before storing the contexts (to avoid problems in sync_users()).</span>
<a name="l1952"><span class="linenum">1952</span></a>          <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('contexts')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/contexts.html">contexts</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(';', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('contexts')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/contexts.html">contexts</a>);
<a name="l1953"><span class="linenum">1953</span></a>          <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('contexts')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/contexts.html">contexts</a> = <a class="phpfunction" onClick="logFunction('array_map')" href="../../_functions/array_map.html" onMouseOver="phpfuncPopup(event,'array_map')">array_map</a>(<a class="phpfunction" onClick="logFunction('create_function')" href="../../_functions/create_function.html" onMouseOver="phpfuncPopup(event,'create_function')">create_function</a>('<a class="var it1123" onMouseOver="hilite(1123)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../_variables/x.html">$x</a>', 'return <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it1123" onMouseOver="hilite(1123)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../_variables/x.html">$x</a>));'),
<a name="l1954"><span class="linenum">1954</span></a>                                        <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('contexts')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/contexts.html">contexts</a>);
<a name="l1955"><span class="linenum">1955</span></a>          <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('contexts')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/contexts.html">contexts</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(';', <a class="phpfunction" onClick="logFunction('array_unique')" href="../../_functions/array_unique.html" onMouseOver="phpfuncPopup(event,'array_unique')">array_unique</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('contexts')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/contexts.html">contexts</a>));
<a name="l1956"><span class="linenum">1956</span></a>  
<a name="l1957"><span class="linenum">1957</span></a>  <span class="comment">        // Save settings</span>
<a name="l1958"><span class="linenum">1958</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('host_url', <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('host_url')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/host_url.html">host_url</a>), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1959"><span class="linenum">1959</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('start_tls', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('start_tls')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/start_tls.html">start_tls</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1960"><span class="linenum">1960</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('ldapencoding', <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ldapencoding')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ldapencoding.html">ldapencoding</a>), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1961"><span class="linenum">1961</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('pagesize', (int)<a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('pagesize')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/pagesize.html">pagesize</a>), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1962"><span class="linenum">1962</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('contexts', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('contexts')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/contexts.html">contexts</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1963"><span class="linenum">1963</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('user_type', <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('user_type')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/user_type.html">user_type</a>)), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1964"><span class="linenum">1964</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('user_attribute', <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('user_attribute')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/user_attribute.html">user_attribute</a>)), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1965"><span class="linenum">1965</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('suspended_attribute', <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('suspended_attribute')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/suspended_attribute.html">suspended_attribute</a>)), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1966"><span class="linenum">1966</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('sync_suspended', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('sync_suspended')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/sync_suspended.html">sync_suspended</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1967"><span class="linenum">1967</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('search_sub', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('search_sub')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/search_sub.html">search_sub</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1968"><span class="linenum">1968</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('opt_deref', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('opt_deref')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/opt_deref.html">opt_deref</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1969"><span class="linenum">1969</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('preventpassindb', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('preventpassindb')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/preventpassindb.html">preventpassindb</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1970"><span class="linenum">1970</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('bind_dn', <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('bind_dn')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/bind_dn.html">bind_dn</a>), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1971"><span class="linenum">1971</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('bind_pw', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('bind_pw')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/bind_pw.html">bind_pw</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1972"><span class="linenum">1972</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('ldap_version', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ldap_version')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ldap_version.html">ldap_version</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1973"><span class="linenum">1973</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('objectclass', <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('objectclass')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/objectclass.html">objectclass</a>), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1974"><span class="linenum">1974</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('memberattribute', <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('memberattribute')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/memberattribute.html">memberattribute</a>)), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1975"><span class="linenum">1975</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('memberattribute_isdn', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('memberattribute_isdn')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/memberattribute_isdn.html">memberattribute_isdn</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1976"><span class="linenum">1976</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('creators', <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('creators')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/creators.html">creators</a>), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1977"><span class="linenum">1977</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('create_context', <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('create_context')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/create_context.html">create_context</a>), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1978"><span class="linenum">1978</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('expiration', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('expiration')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/expiration.html">expiration</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1979"><span class="linenum">1979</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('expiration_warning', <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('expiration_warning')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/expiration_warning.html">expiration_warning</a>), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1980"><span class="linenum">1980</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('expireattr', <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('expireattr')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/expireattr.html">expireattr</a>)), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1981"><span class="linenum">1981</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('gracelogins', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('gracelogins')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/gracelogins.html">gracelogins</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1982"><span class="linenum">1982</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('graceattr', <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('graceattr')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/graceattr.html">graceattr</a>)), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1983"><span class="linenum">1983</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('auth_user_create', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('auth_user_create')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/auth_user_create.html">auth_user_create</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1984"><span class="linenum">1984</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('forcechangepassword', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('forcechangepassword')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/forcechangepassword.html">forcechangepassword</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1985"><span class="linenum">1985</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('stdchangepassword', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('stdchangepassword')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/stdchangepassword.html">stdchangepassword</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1986"><span class="linenum">1986</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('passtype', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('passtype')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/passtype.html">passtype</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1987"><span class="linenum">1987</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('changepasswordurl', <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('changepasswordurl')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/changepasswordurl.html">changepasswordurl</a>), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1988"><span class="linenum">1988</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('removeuser', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('removeuser')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/removeuser.html">removeuser</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1989"><span class="linenum">1989</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('ntlmsso_enabled', (int)<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ntlmsso_enabled')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ntlmsso_enabled.html">ntlmsso_enabled</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1990"><span class="linenum">1990</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('ntlmsso_subnet', <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ntlmsso_subnet')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ntlmsso_subnet.html">ntlmsso_subnet</a>), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1991"><span class="linenum">1991</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('ntlmsso_ie_fastpath', (int)<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ntlmsso_ie_fastpath')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ntlmsso_ie_fastpath.html">ntlmsso_ie_fastpath</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('pluginconfig')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/pluginconfig.html">pluginconfig</a>);
<a name="l1992"><span class="linenum">1992</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('ntlmsso_type', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ntlmsso_type')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ntlmsso_type.html">ntlmsso_type</a>, 'auth/ldap');
<a name="l1993"><span class="linenum">1993</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('ntlmsso_remoteuserformat', <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('ntlmsso_remoteuserformat')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/ntlmsso_remoteuserformat.html">ntlmsso_remoteuserformat</a>), 'auth/ldap');
<a name="l1994"><span class="linenum">1994</span></a>  
<a name="l1995"><span class="linenum">1995</span></a>          return true;
<a name="l1996"><span class="linenum">1996</span></a>      }
<a name="l1997"><span class="linenum">1997</span></a>  
<a name="l1998"><span class="linenum">1998</span></a>      <span class="comment">/**</span>
<a name="l1999"><span class="linenum">1999</span></a>  <span class="comment">     * Get password expiration time for a given user from Active Directory</span>
<a name="l2000"><span class="linenum">2000</span></a>  <span class="comment">     *</span>
<a name="l2001"><span class="linenum">2001</span></a>  <span class="comment">     * @param string $pwdlastset The time last time we changed the password.</span>
<a name="l2002"><span class="linenum">2002</span></a>  <span class="comment">     * @param resource $lcapconn The open LDAP connection.</span>
<a name="l2003"><span class="linenum">2003</span></a>  <span class="comment">     * @param string $user_dn The distinguished name of the user we are checking.</span>
<a name="l2004"><span class="linenum">2004</span></a>  <span class="comment">     *</span>
<a name="l2005"><span class="linenum">2005</span></a>  <span class="comment">     * @return string $unixtime</span>
<a name="l2006"><span class="linenum">2006</span></a>  <span class="comment">     */</span>
<a name="l2007"><span class="linenum">2007</span></a>      function <a class="function" onClick="logFunction('ldap_get_ad_pwdexpire')" href="../../_functions/ldap_get_ad_pwdexpire.html" onMouseOver="funcPopup(event,'ldap_get_ad_pwdexpire')">ldap_get_ad_pwdexpire</a>(<a class="var it33996" onMouseOver="hilite(33996)" onMouseOut="lolite()" onClick="logVariable('pwdlastset')" href="../../_variables/pwdlastset.html">$pwdlastset</a>, <a class="var it33997" onMouseOver="hilite(33997)" onMouseOut="lolite()" onClick="logVariable('ldapconn')" href="../../_variables/ldapconn.html">$ldapconn</a>, <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>){
<a name="l2008"><span class="linenum">2008</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l2009"><span class="linenum">2009</span></a>  
<a name="l2010"><span class="linenum">2010</span></a>          if (!<a class="phpfunction" onClick="logFunction('function_exists')" href="../../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>('bcsub')) {
<a name="l2011"><span class="linenum">2011</span></a>              <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a> ('needbcmath', 'auth_ldap'));
<a name="l2012"><span class="linenum">2012</span></a>              return 0;
<a name="l2013"><span class="linenum">2013</span></a>          }
<a name="l2014"><span class="linenum">2014</span></a>  
<a name="l2015"><span class="linenum">2015</span></a>  <span class="comment">        // If UF_DONT_EXPIRE_PASSWD flag is set in user's</span>
<a name="l2016"><span class="linenum">2016</span></a>  <span class="comment">        // userAccountControl attribute, the password doesn't expire.</span>
<a name="l2017"><span class="linenum">2017</span></a>          <a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a> = <a class="phpfunction" onClick="logFunction('ldap_read')" href="../../_functions/ldap_read.html" onMouseOver="phpfuncPopup(event,'ldap_read')">ldap_read</a>(<a class="var it33997" onMouseOver="hilite(33997)" onMouseOut="lolite()" onClick="logVariable('ldapconn')" href="../../_variables/ldapconn.html">$ldapconn</a>, <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>, '(objectClass=*)',
<a name="l2018"><span class="linenum">2018</span></a>                          array('userAccountControl'));
<a name="l2019"><span class="linenum">2019</span></a>          if (!<a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a>) {
<a name="l2020"><span class="linenum">2020</span></a>              <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a> ('useracctctrlerror', 'auth_ldap', <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>));
<a name="l2021"><span class="linenum">2021</span></a>  <span class="comment">            // Don't expire password, as we are not sure if it has to be</span>
<a name="l2022"><span class="linenum">2022</span></a>  <span class="comment">            // expired or not.</span>
<a name="l2023"><span class="linenum">2023</span></a>              return 0;
<a name="l2024"><span class="linenum">2024</span></a>          }
<a name="l2025"><span class="linenum">2025</span></a>  
<a name="l2026"><span class="linenum">2026</span></a>          <a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a> = <a class="function" onClick="logFunction('ldap_get_entries_moodle')" href="../../_functions/ldap_get_entries_moodle.html" onMouseOver="funcPopup(event,'ldap_get_entries_moodle')">ldap_get_entries_moodle</a>(<a class="var it33997" onMouseOver="hilite(33997)" onMouseOut="lolite()" onClick="logVariable('ldapconn')" href="../../_variables/ldapconn.html">$ldapconn</a>, <a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a>);
<a name="l2027"><span class="linenum">2027</span></a>          <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a> = <a class="phpfunction" onClick="logFunction('array_change_key_case')" href="../../_functions/array_change_key_case.html" onMouseOver="phpfuncPopup(event,'array_change_key_case')">array_change_key_case</a>(<a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a>[0], CASE_LOWER);
<a name="l2028"><span class="linenum">2028</span></a>          <a class="var it33998" onMouseOver="hilite(33998)" onMouseOut="lolite()" onClick="logVariable('useraccountcontrol')" href="../../_variables/useraccountcontrol.html">$useraccountcontrol</a> = <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>['useraccountcontrol'][0];
<a name="l2029"><span class="linenum">2029</span></a>          if (<a class="var it33998" onMouseOver="hilite(33998)" onMouseOut="lolite()" onClick="logVariable('useraccountcontrol')" href="../../_variables/useraccountcontrol.html">$useraccountcontrol</a> &amp; <a class="constant" onClick="logConstant('UF_DONT_EXPIRE_PASSWD')" href="../../_constants/UF_DONT_EXPIRE_PASSWD.html" onMouseOver="constPopup(event,'UF_DONT_EXPIRE_PASSWD')">UF_DONT_EXPIRE_PASSWD</a>) {
<a name="l2030"><span class="linenum">2030</span></a>  <span class="comment">            // Password doesn't expire.</span>
<a name="l2031"><span class="linenum">2031</span></a>              return 0;
<a name="l2032"><span class="linenum">2032</span></a>          }
<a name="l2033"><span class="linenum">2033</span></a>  
<a name="l2034"><span class="linenum">2034</span></a>  <span class="comment">        // If pwdLastSet is zero, the user must change his/her password now</span>
<a name="l2035"><span class="linenum">2035</span></a>  <span class="comment">        // (unless UF_DONT_EXPIRE_PASSWD flag is set, but we already</span>
<a name="l2036"><span class="linenum">2036</span></a>  <span class="comment">        // tested this above)</span>
<a name="l2037"><span class="linenum">2037</span></a>          if (<a class="var it33996" onMouseOver="hilite(33996)" onMouseOut="lolite()" onClick="logVariable('pwdlastset')" href="../../_variables/pwdlastset.html">$pwdlastset</a> === '0') {
<a name="l2038"><span class="linenum">2038</span></a>  <span class="comment">            // Password has expired</span>
<a name="l2039"><span class="linenum">2039</span></a>              return -1;
<a name="l2040"><span class="linenum">2040</span></a>          }
<a name="l2041"><span class="linenum">2041</span></a>  
<a name="l2042"><span class="linenum">2042</span></a>  <span class="comment">        // ----------------------------------------------------------------</span>
<a name="l2043"><span class="linenum">2043</span></a>  <span class="comment">        // Password expiration time in Active Directory is the composition of</span>
<a name="l2044"><span class="linenum">2044</span></a>  <span class="comment">        // two values:</span>
<a name="l2045"><span class="linenum">2045</span></a>  <span class="comment">        //</span>
<a name="l2046"><span class="linenum">2046</span></a>  <span class="comment">        //   - User's pwdLastSet attribute, that stores the last time</span>
<a name="l2047"><span class="linenum">2047</span></a>  <span class="comment">        //     the password was changed.</span>
<a name="l2048"><span class="linenum">2048</span></a>  <span class="comment">        //</span>
<a name="l2049"><span class="linenum">2049</span></a>  <span class="comment">        //   - Domain's maxPwdAge attribute, that sets how long</span>
<a name="l2050"><span class="linenum">2050</span></a>  <span class="comment">        //     passwords last in this domain.</span>
<a name="l2051"><span class="linenum">2051</span></a>  <span class="comment">        //</span>
<a name="l2052"><span class="linenum">2052</span></a>  <span class="comment">        // We already have the first value (passed in as a parameter). We</span>
<a name="l2053"><span class="linenum">2053</span></a>  <span class="comment">        // need to get the second one. As we don't know the domain DN, we</span>
<a name="l2054"><span class="linenum">2054</span></a>  <span class="comment">        // have to query rootDSE's defaultNamingContext attribute to get</span>
<a name="l2055"><span class="linenum">2055</span></a>  <span class="comment">        // it. Then we have to query that DN's maxPwdAge attribute to get</span>
<a name="l2056"><span class="linenum">2056</span></a>  <span class="comment">        // the real value.</span>
<a name="l2057"><span class="linenum">2057</span></a>  <span class="comment">        //</span>
<a name="l2058"><span class="linenum">2058</span></a>  <span class="comment">        // Once we have both values, we just need to combine them. But MS</span>
<a name="l2059"><span class="linenum">2059</span></a>  <span class="comment">        // chose to use a different base and unit for time measurements.</span>
<a name="l2060"><span class="linenum">2060</span></a>  <span class="comment">        // So we need to convert the values to Unix timestamps (see</span>
<a name="l2061"><span class="linenum">2061</span></a>  <span class="comment">        // details below).</span>
<a name="l2062"><span class="linenum">2062</span></a>  <span class="comment">        // ----------------------------------------------------------------</span>
<a name="l2063"><span class="linenum">2063</span></a>  
<a name="l2064"><span class="linenum">2064</span></a>          <a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a> = <a class="phpfunction" onClick="logFunction('ldap_read')" href="../../_functions/ldap_read.html" onMouseOver="phpfuncPopup(event,'ldap_read')">ldap_read</a>(<a class="var it33997" onMouseOver="hilite(33997)" onMouseOut="lolite()" onClick="logVariable('ldapconn')" href="../../_variables/ldapconn.html">$ldapconn</a>, <a class="constant" onClick="logConstant('ROOTDSE')" href="../../_constants/ROOTDSE.html" onMouseOver="constPopup(event,'ROOTDSE')">ROOTDSE</a>, '(objectClass=*)',
<a name="l2065"><span class="linenum">2065</span></a>                          array('defaultNamingContext'));
<a name="l2066"><span class="linenum">2066</span></a>          if (!<a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a>) {
<a name="l2067"><span class="linenum">2067</span></a>              <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a> ('rootdseerror', 'auth_ldap'));
<a name="l2068"><span class="linenum">2068</span></a>              return 0;
<a name="l2069"><span class="linenum">2069</span></a>          }
<a name="l2070"><span class="linenum">2070</span></a>  
<a name="l2071"><span class="linenum">2071</span></a>          <a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a> = <a class="function" onClick="logFunction('ldap_get_entries_moodle')" href="../../_functions/ldap_get_entries_moodle.html" onMouseOver="funcPopup(event,'ldap_get_entries_moodle')">ldap_get_entries_moodle</a>(<a class="var it33997" onMouseOver="hilite(33997)" onMouseOut="lolite()" onClick="logVariable('ldapconn')" href="../../_variables/ldapconn.html">$ldapconn</a>, <a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a>);
<a name="l2072"><span class="linenum">2072</span></a>          <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a> = <a class="phpfunction" onClick="logFunction('array_change_key_case')" href="../../_functions/array_change_key_case.html" onMouseOver="phpfuncPopup(event,'array_change_key_case')">array_change_key_case</a>(<a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a>[0], CASE_LOWER);
<a name="l2073"><span class="linenum">2073</span></a>          <a class="var it33999" onMouseOver="hilite(33999)" onMouseOut="lolite()" onClick="logVariable('domaindn')" href="../../_variables/domaindn.html">$domaindn</a> = <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>['defaultnamingcontext'][0];
<a name="l2074"><span class="linenum">2074</span></a>  
<a name="l2075"><span class="linenum">2075</span></a>          <a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a> = <a class="phpfunction" onClick="logFunction('ldap_read')" href="../../_functions/ldap_read.html" onMouseOver="phpfuncPopup(event,'ldap_read')">ldap_read</a> (<a class="var it33997" onMouseOver="hilite(33997)" onMouseOut="lolite()" onClick="logVariable('ldapconn')" href="../../_variables/ldapconn.html">$ldapconn</a>, <a class="var it33999" onMouseOver="hilite(33999)" onMouseOut="lolite()" onClick="logVariable('domaindn')" href="../../_variables/domaindn.html">$domaindn</a>, '(objectClass=*)',
<a name="l2076"><span class="linenum">2076</span></a>                           array('maxPwdAge'));
<a name="l2077"><span class="linenum">2077</span></a>          <a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a> = <a class="function" onClick="logFunction('ldap_get_entries_moodle')" href="../../_functions/ldap_get_entries_moodle.html" onMouseOver="funcPopup(event,'ldap_get_entries_moodle')">ldap_get_entries_moodle</a>(<a class="var it33997" onMouseOver="hilite(33997)" onMouseOut="lolite()" onClick="logVariable('ldapconn')" href="../../_variables/ldapconn.html">$ldapconn</a>, <a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a>);
<a name="l2078"><span class="linenum">2078</span></a>          <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a> = <a class="phpfunction" onClick="logFunction('array_change_key_case')" href="../../_functions/array_change_key_case.html" onMouseOver="phpfuncPopup(event,'array_change_key_case')">array_change_key_case</a>(<a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a>[0], CASE_LOWER);
<a name="l2079"><span class="linenum">2079</span></a>          <a class="var it34000" onMouseOver="hilite(34000)" onMouseOut="lolite()" onClick="logVariable('maxpwdage')" href="../../_variables/maxpwdage.html">$maxpwdage</a> = <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>['maxpwdage'][0];
<a name="l2080"><span class="linenum">2080</span></a>          if (<a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a> = <a class="phpfunction" onClick="logFunction('ldap_read')" href="../../_functions/ldap_read.html" onMouseOver="phpfuncPopup(event,'ldap_read')">ldap_read</a>(<a class="var it33997" onMouseOver="hilite(33997)" onMouseOut="lolite()" onClick="logVariable('ldapconn')" href="../../_variables/ldapconn.html">$ldapconn</a>, <a class="var it33961" onMouseOver="hilite(33961)" onMouseOut="lolite()" onClick="logVariable('user_dn')" href="../../_variables/user_dn.html">$user_dn</a>, '(objectClass=*)', array('msDS-ResultantPSO'))) {
<a name="l2081"><span class="linenum">2081</span></a>              if (<a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a> = <a class="function" onClick="logFunction('ldap_get_entries_moodle')" href="../../_functions/ldap_get_entries_moodle.html" onMouseOver="funcPopup(event,'ldap_get_entries_moodle')">ldap_get_entries_moodle</a>(<a class="var it33997" onMouseOver="hilite(33997)" onMouseOut="lolite()" onClick="logVariable('ldapconn')" href="../../_variables/ldapconn.html">$ldapconn</a>, <a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a>)) {
<a name="l2082"><span class="linenum">2082</span></a>                  <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a> = <a class="phpfunction" onClick="logFunction('array_change_key_case')" href="../../_functions/array_change_key_case.html" onMouseOver="phpfuncPopup(event,'array_change_key_case')">array_change_key_case</a>(<a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a>[0], CASE_LOWER);
<a name="l2083"><span class="linenum">2083</span></a>                  <a class="var it34001" onMouseOver="hilite(34001)" onMouseOut="lolite()" onClick="logVariable('userpso')" href="../../_variables/userpso.html">$userpso</a> = <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>['msds-resultantpso'][0];
<a name="l2084"><span class="linenum">2084</span></a>  
<a name="l2085"><span class="linenum">2085</span></a>  <span class="comment">                // If a PSO exists, FGPP is being utilized.</span>
<a name="l2086"><span class="linenum">2086</span></a>  <span class="comment">                // Grab the new maxpwdage from the msDS-MaximumPasswordAge attribute of the PSO.</span>
<a name="l2087"><span class="linenum">2087</span></a>                  if (!empty(<a class="var it34001" onMouseOver="hilite(34001)" onMouseOut="lolite()" onClick="logVariable('userpso')" href="../../_variables/userpso.html">$userpso</a>)) {
<a name="l2088"><span class="linenum">2088</span></a>                      <a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a> = <a class="phpfunction" onClick="logFunction('ldap_read')" href="../../_functions/ldap_read.html" onMouseOver="phpfuncPopup(event,'ldap_read')">ldap_read</a>(<a class="var it33997" onMouseOver="hilite(33997)" onMouseOut="lolite()" onClick="logVariable('ldapconn')" href="../../_variables/ldapconn.html">$ldapconn</a>, <a class="var it34001" onMouseOver="hilite(34001)" onMouseOut="lolite()" onClick="logVariable('userpso')" href="../../_variables/userpso.html">$userpso</a>, '(objectClass=*)', array('msDS-MaximumPasswordAge'));
<a name="l2089"><span class="linenum">2089</span></a>                      if (<a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a> = <a class="function" onClick="logFunction('ldap_get_entries_moodle')" href="../../_functions/ldap_get_entries_moodle.html" onMouseOver="funcPopup(event,'ldap_get_entries_moodle')">ldap_get_entries_moodle</a>(<a class="var it33997" onMouseOver="hilite(33997)" onMouseOut="lolite()" onClick="logVariable('ldapconn')" href="../../_variables/ldapconn.html">$ldapconn</a>, <a class="var it2713" onMouseOver="hilite(2713)" onMouseOut="lolite()" onClick="logVariable('sr')" href="../../_variables/sr.html">$sr</a>)) {
<a name="l2090"><span class="linenum">2090</span></a>                          <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a> = <a class="phpfunction" onClick="logFunction('array_change_key_case')" href="../../_functions/array_change_key_case.html" onMouseOver="phpfuncPopup(event,'array_change_key_case')">array_change_key_case</a>(<a class="var it2510" onMouseOver="hilite(2510)" onMouseOut="lolite()" onClick="logVariable('entry')" href="../../_variables/entry.html">$entry</a>[0], CASE_LOWER);
<a name="l2091"><span class="linenum">2091</span></a>  <span class="comment">                        // Default value of msds-maximumpasswordage is 42 and is always set.</span>
<a name="l2092"><span class="linenum">2092</span></a>                          <a class="var it34000" onMouseOver="hilite(34000)" onMouseOut="lolite()" onClick="logVariable('maxpwdage')" href="../../_variables/maxpwdage.html">$maxpwdage</a> = <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>['msds-maximumpasswordage'][0];
<a name="l2093"><span class="linenum">2093</span></a>                      }
<a name="l2094"><span class="linenum">2094</span></a>                  }
<a name="l2095"><span class="linenum">2095</span></a>              }
<a name="l2096"><span class="linenum">2096</span></a>          }
<a name="l2097"><span class="linenum">2097</span></a>  <span class="comment">        // ----------------------------------------------------------------</span>
<a name="l2098"><span class="linenum">2098</span></a>  <span class="comment">        // MSDN says that &quot;pwdLastSet contains the number of 100 nanosecond</span>
<a name="l2099"><span class="linenum">2099</span></a>  <span class="comment">        // intervals since January 1, 1601 (UTC), stored in a 64 bit integer&quot;.</span>
<a name="l2100"><span class="linenum">2100</span></a>  <span class="comment">        //</span>
<a name="l2101"><span class="linenum">2101</span></a>  <span class="comment">        // According to Perl's Date::Manip, the number of seconds between</span>
<a name="l2102"><span class="linenum">2102</span></a>  <span class="comment">        // this date and Unix epoch is 11644473600. So we have to</span>
<a name="l2103"><span class="linenum">2103</span></a>  <span class="comment">        // substract this value to calculate a Unix time, once we have</span>
<a name="l2104"><span class="linenum">2104</span></a>  <span class="comment">        // scaled pwdLastSet to seconds. This is the script used to</span>
<a name="l2105"><span class="linenum">2105</span></a>  <span class="comment">        // calculate the value shown above:</span>
<a name="l2106"><span class="linenum">2106</span></a>  <span class="comment">        //</span>
<a name="l2107"><span class="linenum">2107</span></a>  <span class="comment">        //    #!/usr/bin/perl -w</span>
<a name="l2108"><span class="linenum">2108</span></a>  <span class="comment">        //</span>
<a name="l2109"><span class="linenum">2109</span></a>  <span class="comment">        //    use Date::Manip;</span>
<a name="l2110"><span class="linenum">2110</span></a>  <span class="comment">        //</span>
<a name="l2111"><span class="linenum">2111</span></a>  <span class="comment">        //    $date1 = ParseDate (&quot;160101010000 UTC&quot;);</span>
<a name="l2112"><span class="linenum">2112</span></a>  <span class="comment">        //    $date2 = ParseDate (&quot;197001010000 UTC&quot;);</span>
<a name="l2113"><span class="linenum">2113</span></a>  <span class="comment">        //    $delta = DateCalc($date1, $date2, \$err);</span>
<a name="l2114"><span class="linenum">2114</span></a>  <span class="comment">        //    $secs = Delta_Format($delta, 0, &quot;%st&quot;);</span>
<a name="l2115"><span class="linenum">2115</span></a>  <span class="comment">        //    print &quot;$secs \n&quot;;</span>
<a name="l2116"><span class="linenum">2116</span></a>  <span class="comment">        //</span>
<a name="l2117"><span class="linenum">2117</span></a>  <span class="comment">        // MSDN also says that &quot;maxPwdAge is stored as a large integer that</span>
<a name="l2118"><span class="linenum">2118</span></a>  <span class="comment">        // represents the number of 100 nanosecond intervals from the time</span>
<a name="l2119"><span class="linenum">2119</span></a>  <span class="comment">        // the password was set before the password expires.&quot; We also need</span>
<a name="l2120"><span class="linenum">2120</span></a>  <span class="comment">        // to scale this to seconds. Bear in mind that this value is stored</span>
<a name="l2121"><span class="linenum">2121</span></a>  <span class="comment">        // as a _negative_ quantity (at least in my AD domain).</span>
<a name="l2122"><span class="linenum">2122</span></a>  <span class="comment">        //</span>
<a name="l2123"><span class="linenum">2123</span></a>  <span class="comment">        // As a last remark, if the low 32 bits of maxPwdAge are equal to 0,</span>
<a name="l2124"><span class="linenum">2124</span></a>  <span class="comment">        // the maximum password age in the domain is set to 0, which means</span>
<a name="l2125"><span class="linenum">2125</span></a>  <span class="comment">        // passwords do not expire (see</span>
<a name="l2126"><span class="linenum">2126</span></a>  <span class="comment">        // http://msdn2.microsoft.com/en-us/library/ms974598.aspx)</span>
<a name="l2127"><span class="linenum">2127</span></a>  <span class="comment">        //</span>
<a name="l2128"><span class="linenum">2128</span></a>  <span class="comment">        // As the quantities involved are too big for PHP integers, we</span>
<a name="l2129"><span class="linenum">2129</span></a>  <span class="comment">        // need to use BCMath functions to work with arbitrary precision</span>
<a name="l2130"><span class="linenum">2130</span></a>  <span class="comment">        // numbers.</span>
<a name="l2131"><span class="linenum">2131</span></a>  <span class="comment">        // ----------------------------------------------------------------</span>
<a name="l2132"><span class="linenum">2132</span></a>  
<a name="l2133"><span class="linenum">2133</span></a>  <span class="comment">        // If the low order 32 bits are 0, then passwords do not expire in</span>
<a name="l2134"><span class="linenum">2134</span></a>  <span class="comment">        // the domain. Just do '$maxpwdage mod 2^32' and check the result</span>
<a name="l2135"><span class="linenum">2135</span></a>  <span class="comment">        // (2^32 = 4294967296)</span>
<a name="l2136"><span class="linenum">2136</span></a>          if (<a class="phpfunction" onClick="logFunction('bcmod')" href="../../_functions/bcmod.html" onMouseOver="phpfuncPopup(event,'bcmod')">bcmod</a> (<a class="var it34000" onMouseOver="hilite(34000)" onMouseOut="lolite()" onClick="logVariable('maxpwdage')" href="../../_variables/maxpwdage.html">$maxpwdage</a>, 4294967296) === '0') {
<a name="l2137"><span class="linenum">2137</span></a>              return 0;
<a name="l2138"><span class="linenum">2138</span></a>          }
<a name="l2139"><span class="linenum">2139</span></a>  
<a name="l2140"><span class="linenum">2140</span></a>  <span class="comment">        // Add up pwdLastSet and maxPwdAge to get password expiration</span>
<a name="l2141"><span class="linenum">2141</span></a>  <span class="comment">        // time, in MS time units. Remember maxPwdAge is stored as a</span>
<a name="l2142"><span class="linenum">2142</span></a>  <span class="comment">        // _negative_ quantity, so we need to substract it in fact.</span>
<a name="l2143"><span class="linenum">2143</span></a>          <a class="var it34002" onMouseOver="hilite(34002)" onMouseOut="lolite()" onClick="logVariable('pwdexpire')" href="../../_variables/pwdexpire.html">$pwdexpire</a> = <a class="phpfunction" onClick="logFunction('bcsub')" href="../../_functions/bcsub.html" onMouseOver="phpfuncPopup(event,'bcsub')">bcsub</a> (<a class="var it33996" onMouseOver="hilite(33996)" onMouseOut="lolite()" onClick="logVariable('pwdlastset')" href="../../_variables/pwdlastset.html">$pwdlastset</a>, <a class="var it34000" onMouseOver="hilite(34000)" onMouseOut="lolite()" onClick="logVariable('maxpwdage')" href="../../_variables/maxpwdage.html">$maxpwdage</a>);
<a name="l2144"><span class="linenum">2144</span></a>  
<a name="l2145"><span class="linenum">2145</span></a>  <span class="comment">        // Scale the result to convert it to Unix time units and return</span>
<a name="l2146"><span class="linenum">2146</span></a>  <span class="comment">        // that value.</span>
<a name="l2147"><span class="linenum">2147</span></a>          return <a class="phpfunction" onClick="logFunction('bcsub')" href="../../_functions/bcsub.html" onMouseOver="phpfuncPopup(event,'bcsub')">bcsub</a>( <a class="phpfunction" onClick="logFunction('bcdiv')" href="../../_functions/bcdiv.html" onMouseOver="phpfuncPopup(event,'bcdiv')">bcdiv</a>(<a class="var it34002" onMouseOver="hilite(34002)" onMouseOut="lolite()" onClick="logVariable('pwdexpire')" href="../../_variables/pwdexpire.html">$pwdexpire</a>, '10000000'), '11644473600');
<a name="l2148"><span class="linenum">2148</span></a>      }
<a name="l2149"><span class="linenum">2149</span></a>  
<a name="l2150"><span class="linenum">2150</span></a>      <span class="comment">/**</span>
<a name="l2151"><span class="linenum">2151</span></a>  <span class="comment">     * Connect to the LDAP server, using the plugin configured</span>
<a name="l2152"><span class="linenum">2152</span></a>  <span class="comment">     * settings. It's actually a wrapper around ldap_connect_moodle()</span>
<a name="l2153"><span class="linenum">2153</span></a>  <span class="comment">     *</span>
<a name="l2154"><span class="linenum">2154</span></a>  <span class="comment">     * @return resource A valid LDAP connection (or dies if it can't connect)</span>
<a name="l2155"><span class="linenum">2155</span></a>  <span class="comment">     */</span>
<a name="l2156"><span class="linenum">2156</span></a>      function <a class="function" onClick="logFunction('ldap_connect')" href="../../_functions/ldap_connect.html" onMouseOver="funcPopup(event,'ldap_connect')">ldap_connect</a>() {
<a name="l2157"><span class="linenum">2157</span></a>  <span class="comment">        // Cache ldap connections. They are expensive to set up</span>
<a name="l2158"><span class="linenum">2158</span></a>  <span class="comment">        // and can drain the TCP/IP ressources on the server if we</span>
<a name="l2159"><span class="linenum">2159</span></a>  <span class="comment">        // are syncing a lot of users (as we try to open a new connection</span>
<a name="l2160"><span class="linenum">2160</span></a>  <span class="comment">        // to get the user details). This is the least invasive way</span>
<a name="l2161"><span class="linenum">2161</span></a>  <span class="comment">        // to reuse existing connections without greater code surgery.</span>
<a name="l2162"><span class="linenum">2162</span></a>          if(!empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('ldapconnection')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/ldapconnection.html">ldapconnection</a>)) {
<a name="l2163"><span class="linenum">2163</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('ldapconns')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/ldapconns.html">ldapconns</a>++;
<a name="l2164"><span class="linenum">2164</span></a>              return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('ldapconnection')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/ldapconnection.html">ldapconnection</a>;
<a name="l2165"><span class="linenum">2165</span></a>          }
<a name="l2166"><span class="linenum">2166</span></a>  
<a name="l2167"><span class="linenum">2167</span></a>          if(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a> = <a class="function" onClick="logFunction('ldap_connect_moodle')" href="../../_functions/ldap_connect_moodle.html" onMouseOver="funcPopup(event,'ldap_connect_moodle')">ldap_connect_moodle</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;host_url, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ldap_version,
<a name="l2168"><span class="linenum">2168</span></a>                                                   <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_type, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;bind_dn,
<a name="l2169"><span class="linenum">2169</span></a>                                                   <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;bind_pw, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;opt_deref,
<a name="l2170"><span class="linenum">2170</span></a>                                                   <a class="var it263" onMouseOver="hilite(263)" onMouseOut="lolite()" onClick="logVariable('debuginfo')" href="../../_variables/debuginfo.html">$debuginfo</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;start_tls)) {
<a name="l2171"><span class="linenum">2171</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('ldapconns')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/ldapconns.html">ldapconns</a> = 1;
<a name="l2172"><span class="linenum">2172</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('ldapconnection')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/ldapconnection.html">ldapconnection</a> = <a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>;
<a name="l2173"><span class="linenum">2173</span></a>              return <a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>;
<a name="l2174"><span class="linenum">2174</span></a>          }
<a name="l2175"><span class="linenum">2175</span></a>  
<a name="l2176"><span class="linenum">2176</span></a>          <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('auth_ldap_noconnect_all', 'auth_ldap', '', <a class="var it263" onMouseOver="hilite(263)" onMouseOut="lolite()" onClick="logVariable('debuginfo')" href="../../_variables/debuginfo.html">$debuginfo</a>);
<a name="l2177"><span class="linenum">2177</span></a>      }
<a name="l2178"><span class="linenum">2178</span></a>  
<a name="l2179"><span class="linenum">2179</span></a>      <span class="comment">/**</span>
<a name="l2180"><span class="linenum">2180</span></a>  <span class="comment">     * Disconnects from a LDAP server</span>
<a name="l2181"><span class="linenum">2181</span></a>  <span class="comment">     *</span>
<a name="l2182"><span class="linenum">2182</span></a>  <span class="comment">     * @param force boolean Forces closing the real connection to the LDAP server, ignoring any</span>
<a name="l2183"><span class="linenum">2183</span></a>  <span class="comment">     *                      cached connections. This is needed when we've used paged results</span>
<a name="l2184"><span class="linenum">2184</span></a>  <span class="comment">     *                      and want to use normal results again.</span>
<a name="l2185"><span class="linenum">2185</span></a>  <span class="comment">     */</span>
<a name="l2186"><span class="linenum">2186</span></a>      function <a class="function" onClick="logFunction('ldap_close')" href="../../_functions/ldap_close.html" onMouseOver="funcPopup(event,'ldap_close')">ldap_close</a>(<a class="var it116" onMouseOver="hilite(116)" onMouseOut="lolite()" onClick="logVariable('force')" href="../../_variables/force.html">$force</a>=false) {
<a name="l2187"><span class="linenum">2187</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('ldapconns')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/ldapconns.html">ldapconns</a>--;
<a name="l2188"><span class="linenum">2188</span></a>          if ((<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('ldapconns')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/ldapconns.html">ldapconns</a> == 0) || (<a class="var it116" onMouseOver="hilite(116)" onMouseOut="lolite()" onClick="logVariable('force')" href="../../_variables/force.html">$force</a>)) {
<a name="l2189"><span class="linenum">2189</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('ldapconns')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/ldapconns.html">ldapconns</a> = 0;
<a name="l2190"><span class="linenum">2190</span></a>              @<a class="function" onClick="logFunction('ldap_close')" href="../../_functions/ldap_close.html" onMouseOver="funcPopup(event,'ldap_close')">ldap_close</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('ldapconnection')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/ldapconnection.html">ldapconnection</a>);
<a name="l2191"><span class="linenum">2191</span></a>              unset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('ldapconnection')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/ldapconnection.html">ldapconnection</a>);
<a name="l2192"><span class="linenum">2192</span></a>          }
<a name="l2193"><span class="linenum">2193</span></a>      }
<a name="l2194"><span class="linenum">2194</span></a>  
<a name="l2195"><span class="linenum">2195</span></a>      <span class="comment">/**</span>
<a name="l2196"><span class="linenum">2196</span></a>  <span class="comment">     * Search specified contexts for username and return the user dn</span>
<a name="l2197"><span class="linenum">2197</span></a>  <span class="comment">     * like: cn=username,ou=suborg,o=org. It's actually a wrapper</span>
<a name="l2198"><span class="linenum">2198</span></a>  <span class="comment">     * around ldap_find_userdn().</span>
<a name="l2199"><span class="linenum">2199</span></a>  <span class="comment">     *</span>
<a name="l2200"><span class="linenum">2200</span></a>  <span class="comment">     * @param resource $ldapconnection a valid LDAP connection</span>
<a name="l2201"><span class="linenum">2201</span></a>  <span class="comment">     * @param string $extusername the username to search (in external LDAP encoding, no db slashes)</span>
<a name="l2202"><span class="linenum">2202</span></a>  <span class="comment">     * @return mixed the user dn (external LDAP encoding) or false</span>
<a name="l2203"><span class="linenum">2203</span></a>  <span class="comment">     */</span>
<a name="l2204"><span class="linenum">2204</span></a>      function <a class="function" onClick="logFunction('ldap_find_userdn')" href="../../_functions/ldap_find_userdn.html" onMouseOver="funcPopup(event,'ldap_find_userdn')">ldap_find_userdn</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a>) {
<a name="l2205"><span class="linenum">2205</span></a>          <a class="var it24476" onMouseOver="hilite(24476)" onMouseOut="lolite()" onClick="logVariable('ldap_contexts')" href="../../_variables/ldap_contexts.html">$ldap_contexts</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(';', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;contexts);
<a name="l2206"><span class="linenum">2206</span></a>          if (!empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;create_context)) {
<a name="l2207"><span class="linenum">2207</span></a>              <a class="phpfunction" onClick="logFunction('array_push')" href="../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>(<a class="var it24476" onMouseOver="hilite(24476)" onMouseOut="lolite()" onClick="logVariable('ldap_contexts')" href="../../_variables/ldap_contexts.html">$ldap_contexts</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;create_context);
<a name="l2208"><span class="linenum">2208</span></a>          }
<a name="l2209"><span class="linenum">2209</span></a>  
<a name="l2210"><span class="linenum">2210</span></a>          return <a class="function" onClick="logFunction('ldap_find_userdn')" href="../../_functions/ldap_find_userdn.html" onMouseOver="funcPopup(event,'ldap_find_userdn')">ldap_find_userdn</a>(<a class="var it24482" onMouseOver="hilite(24482)" onMouseOut="lolite()" onClick="logVariable('ldapconnection')" href="../../_variables/ldapconnection.html">$ldapconnection</a>, <a class="var it33955" onMouseOver="hilite(33955)" onMouseOut="lolite()" onClick="logVariable('extusername')" href="../../_variables/extusername.html">$extusername</a>, <a class="var it24476" onMouseOver="hilite(24476)" onMouseOut="lolite()" onClick="logVariable('ldap_contexts')" href="../../_variables/ldap_contexts.html">$ldap_contexts</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;objectclass,
<a name="l2211"><span class="linenum">2211</span></a>                                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_attribute, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;search_sub);
<a name="l2212"><span class="linenum">2212</span></a>      }
<a name="l2213"><span class="linenum">2213</span></a>  
<a name="l2214"><span class="linenum">2214</span></a>  
<a name="l2215"><span class="linenum">2215</span></a>      <span class="comment">/**</span>
<a name="l2216"><span class="linenum">2216</span></a>  <span class="comment">     * A chance to validate form data, and last chance to do stuff</span>
<a name="l2217"><span class="linenum">2217</span></a>  <span class="comment">     * before it is inserted in config_plugin</span>
<a name="l2218"><span class="linenum">2218</span></a>  <span class="comment">     *</span>
<a name="l2219"><span class="linenum">2219</span></a>  <span class="comment">     * @param object object with submitted configuration settings (without system magic quotes)</span>
<a name="l2220"><span class="linenum">2220</span></a>  <span class="comment">     * @param array $err array of error messages (passed by reference)</span>
<a name="l2221"><span class="linenum">2221</span></a>  <span class="comment">     */</span>
<a name="l2222"><span class="linenum">2222</span></a>      function <a class="function" onClick="logFunction('validate_form')" href="../../_functions/validate_form.html" onMouseOver="funcPopup(event,'validate_form')">validate_form</a>(<a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../_variables/form.html">$form</a>, &amp;<a class="var it210" onMouseOver="hilite(210)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../_variables/err.html">$err</a>) {
<a name="l2223"><span class="linenum">2223</span></a>          if (<a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../_variables/form.html">$form</a>-&gt;<a onClick="logVariable('ntlmsso_type')" class="var it43215" onMouseOver="hilite(43215)" onMouseOut="lolite()" href="../../_variables/ntlmsso_type.html">ntlmsso_type</a> == 'ntlm') {
<a name="l2224"><span class="linenum">2224</span></a>              <a class="var it606" onMouseOver="hilite(606)" onMouseOut="lolite()" onClick="logVariable('format')" href="../../_variables/format.html">$format</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../_variables/form.html">$form</a>-&gt;<a onClick="logVariable('ntlmsso_remoteuserformat')" class="var it43215" onMouseOver="hilite(43215)" onMouseOut="lolite()" href="../../_variables/ntlmsso_remoteuserformat.html">ntlmsso_remoteuserformat</a>);
<a name="l2225"><span class="linenum">2225</span></a>              if (!empty(<a class="var it606" onMouseOver="hilite(606)" onMouseOut="lolite()" onClick="logVariable('format')" href="../../_variables/format.html">$format</a>) &amp;&amp; !<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/%username%/i', <a class="var it606" onMouseOver="hilite(606)" onMouseOut="lolite()" onClick="logVariable('format')" href="../../_variables/format.html">$format</a>)) {
<a name="l2226"><span class="linenum">2226</span></a>                  <a class="var it210" onMouseOver="hilite(210)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../_variables/err.html">$err</a>['ntlmsso_remoteuserformat'] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('auth_ntlmsso_missing_username', 'auth_ldap');
<a name="l2227"><span class="linenum">2227</span></a>              }
<a name="l2228"><span class="linenum">2228</span></a>          }
<a name="l2229"><span class="linenum">2229</span></a>      }
<a name="l2230"><span class="linenum">2230</span></a>  
<a name="l2231"><span class="linenum">2231</span></a>  
<a name="l2232"><span class="linenum">2232</span></a>      <span class="comment">/**</span>
<a name="l2233"><span class="linenum">2233</span></a>  <span class="comment">     * When using NTLM SSO, the format of the remote username we get in</span>
<a name="l2234"><span class="linenum">2234</span></a>  <span class="comment">     * $_SERVER['REMOTE_USER'] may vary, depending on where from and how the web</span>
<a name="l2235"><span class="linenum">2235</span></a>  <span class="comment">     * server gets the data. So we let the admin configure the format using two</span>
<a name="l2236"><span class="linenum">2236</span></a>  <span class="comment">     * place holders (%domain% and %username%). This function tries to extract</span>
<a name="l2237"><span class="linenum">2237</span></a>  <span class="comment">     * the username (stripping the domain part and any separators if they are</span>
<a name="l2238"><span class="linenum">2238</span></a>  <span class="comment">     * present) from the value present in $_SERVER['REMOTE_USER'], using the</span>
<a name="l2239"><span class="linenum">2239</span></a>  <span class="comment">     * configured format.</span>
<a name="l2240"><span class="linenum">2240</span></a>  <span class="comment">     *</span>
<a name="l2241"><span class="linenum">2241</span></a>  <span class="comment">     * @param string $remoteuser The value from $_SERVER['REMOTE_USER'] (converted to UTF-8)</span>
<a name="l2242"><span class="linenum">2242</span></a>  <span class="comment">     *</span>
<a name="l2243"><span class="linenum">2243</span></a>  <span class="comment">     * @return string The remote username (without domain part or</span>
<a name="l2244"><span class="linenum">2244</span></a>  <span class="comment">     *                separators). Empty string if we can't extract the username.</span>
<a name="l2245"><span class="linenum">2245</span></a>  <span class="comment">     */</span>
<a name="l2246"><span class="linenum">2246</span></a>      protected function <a class="function" onClick="logFunction('get_ntlm_remote_user')" href="../../_functions/get_ntlm_remote_user.html" onMouseOver="funcPopup(event,'get_ntlm_remote_user')">get_ntlm_remote_user</a>(<a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>) {
<a name="l2247"><span class="linenum">2247</span></a>          if (empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ntlmsso_remoteuserformat)) {
<a name="l2248"><span class="linenum">2248</span></a>              <a class="var it606" onMouseOver="hilite(606)" onMouseOut="lolite()" onClick="logVariable('format')" href="../../_variables/format.html">$format</a> = <a class="constant" onClick="logConstant('AUTH_NTLM_DEFAULT_FORMAT')" href="../../_constants/AUTH_NTLM_DEFAULT_FORMAT.html" onMouseOver="constPopup(event,'AUTH_NTLM_DEFAULT_FORMAT')">AUTH_NTLM_DEFAULT_FORMAT</a>;
<a name="l2249"><span class="linenum">2249</span></a>          } else {
<a name="l2250"><span class="linenum">2250</span></a>              <a class="var it606" onMouseOver="hilite(606)" onMouseOut="lolite()" onClick="logVariable('format')" href="../../_variables/format.html">$format</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;ntlmsso_remoteuserformat;
<a name="l2251"><span class="linenum">2251</span></a>          }
<a name="l2252"><span class="linenum">2252</span></a>  
<a name="l2253"><span class="linenum">2253</span></a>          <a class="var it606" onMouseOver="hilite(606)" onMouseOut="lolite()" onClick="logVariable('format')" href="../../_variables/format.html">$format</a> = <a class="phpfunction" onClick="logFunction('preg_quote')" href="../../_functions/preg_quote.html" onMouseOver="phpfuncPopup(event,'preg_quote')">preg_quote</a>(<a class="var it606" onMouseOver="hilite(606)" onMouseOut="lolite()" onClick="logVariable('format')" href="../../_variables/format.html">$format</a>);
<a name="l2254"><span class="linenum">2254</span></a>          <a class="var it23237" onMouseOver="hilite(23237)" onMouseOut="lolite()" onClick="logVariable('formatregex')" href="../../_variables/formatregex.html">$formatregex</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>(array('#%domain%#', '#%username%#'),
<a name="l2255"><span class="linenum">2255</span></a>                                      array('('.<a class="constant" onClick="logConstant('AUTH_NTLM_VALID_DOMAINNAME')" href="../../_constants/AUTH_NTLM_VALID_DOMAINNAME.html" onMouseOver="constPopup(event,'AUTH_NTLM_VALID_DOMAINNAME')">AUTH_NTLM_VALID_DOMAINNAME</a>.')', '('.<a class="constant" onClick="logConstant('AUTH_NTLM_VALID_USERNAME')" href="../../_constants/AUTH_NTLM_VALID_USERNAME.html" onMouseOver="constPopup(event,'AUTH_NTLM_VALID_USERNAME')">AUTH_NTLM_VALID_USERNAME</a>.')'),
<a name="l2256"><span class="linenum">2256</span></a>                                      <a class="var it606" onMouseOver="hilite(606)" onMouseOut="lolite()" onClick="logVariable('format')" href="../../_variables/format.html">$format</a>);
<a name="l2257"><span class="linenum">2257</span></a>          if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('#^'.<a class="var it23237" onMouseOver="hilite(23237)" onMouseOut="lolite()" onClick="logVariable('formatregex')" href="../../_variables/formatregex.html">$formatregex</a>.'$#', <a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>, <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>)) {
<a name="l2258"><span class="linenum">2258</span></a>              <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a> = <a class="phpfunction" onClick="logFunction('end')" href="../../_functions/end.html" onMouseOver="phpfuncPopup(event,'end')">end</a>(<a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>);
<a name="l2259"><span class="linenum">2259</span></a>              return <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>;
<a name="l2260"><span class="linenum">2260</span></a>          }
<a name="l2261"><span class="linenum">2261</span></a>  
<a name="l2262"><span class="linenum">2262</span></a>          <span class="comment">/* We are unable to extract the username with the configured format. Probably</span>
<a name="l2263"><span class="linenum">2263</span></a>  <span class="comment">         * the format specified is wrong, so log a warning for the admin and return</span>
<a name="l2264"><span class="linenum">2264</span></a>  <span class="comment">         * an empty username.</span>
<a name="l2265"><span class="linenum">2265</span></a>  <span class="comment">         */</span>
<a name="l2266"><span class="linenum">2266</span></a>          <a class="phpfunction" onClick="logFunction('error_log')" href="../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('errorlogtag')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/errorlogtag.html">errorlogtag</a>.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a> ('auth_ntlmsso_maybeinvalidformat', 'auth_ldap'));
<a name="l2267"><span class="linenum">2267</span></a>          return '';
<a name="l2268"><span class="linenum">2268</span></a>      }
<a name="l2269"><span class="linenum">2269</span></a>  
<a name="l2270"><span class="linenum">2270</span></a>      <span class="comment">/**</span>
<a name="l2271"><span class="linenum">2271</span></a>  <span class="comment">     * Check if the diagnostic message for the LDAP login error tells us that the</span>
<a name="l2272"><span class="linenum">2272</span></a>  <span class="comment">     * login is denied because the user password has expired or the password needs</span>
<a name="l2273"><span class="linenum">2273</span></a>  <span class="comment">     * to be changed on first login (using interactive SMB/Windows logins, not</span>
<a name="l2274"><span class="linenum">2274</span></a>  <span class="comment">     * LDAP logins).</span>
<a name="l2275"><span class="linenum">2275</span></a>  <span class="comment">     *</span>
<a name="l2276"><span class="linenum">2276</span></a>  <span class="comment">     * @param string the diagnostic message for the LDAP login error</span>
<a name="l2277"><span class="linenum">2277</span></a>  <span class="comment">     * @return bool true if the password has expired or the password must be changed on first login</span>
<a name="l2278"><span class="linenum">2278</span></a>  <span class="comment">     */</span>
<a name="l2279"><span class="linenum">2279</span></a>      protected function <a class="function" onClick="logFunction('ldap_ad_pwdexpired_from_diagmsg')" href="../../_functions/ldap_ad_pwdexpired_from_diagmsg.html" onMouseOver="funcPopup(event,'ldap_ad_pwdexpired_from_diagmsg')">ldap_ad_pwdexpired_from_diagmsg</a>(<a class="var it33960" onMouseOver="hilite(33960)" onMouseOut="lolite()" onClick="logVariable('diagmsg')" href="../../_variables/diagmsg.html">$diagmsg</a>) {
<a name="l2280"><span class="linenum">2280</span></a>  <span class="comment">        // The format of the diagnostic message is (actual examples from W2003 and W2008):</span>
<a name="l2281"><span class="linenum">2281</span></a>  <span class="comment">        // &quot;80090308: LdapErr: DSID-0C090334, comment: AcceptSecurityContext error, data 52e, vece&quot;  (W2003)</span>
<a name="l2282"><span class="linenum">2282</span></a>  <span class="comment">        // &quot;80090308: LdapErr: DSID-0C090334, comment: AcceptSecurityContext error, data 773, vece&quot;  (W2003)</span>
<a name="l2283"><span class="linenum">2283</span></a>  <span class="comment">        // &quot;80090308: LdapErr: DSID-0C0903AA, comment: AcceptSecurityContext error, data 52e, v1771&quot; (W2008)</span>
<a name="l2284"><span class="linenum">2284</span></a>  <span class="comment">        // &quot;80090308: LdapErr: DSID-0C0903AA, comment: AcceptSecurityContext error, data 773, v1771&quot; (W2008)</span>
<a name="l2285"><span class="linenum">2285</span></a>  <span class="comment">        // We are interested in the 'data nnn' part.</span>
<a name="l2286"><span class="linenum">2286</span></a>  <span class="comment">        //   if nnn == 773 then user must change password on first login</span>
<a name="l2287"><span class="linenum">2287</span></a>  <span class="comment">        //   if nnn == 532 then user password has expired</span>
<a name="l2288"><span class="linenum">2288</span></a>          <a class="var it33960" onMouseOver="hilite(33960)" onMouseOut="lolite()" onClick="logVariable('diagmsg')" href="../../_variables/diagmsg.html">$diagmsg</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(',', <a class="var it33960" onMouseOver="hilite(33960)" onMouseOut="lolite()" onClick="logVariable('diagmsg')" href="../../_variables/diagmsg.html">$diagmsg</a>);
<a name="l2289"><span class="linenum">2289</span></a>          if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/<a class="function" onClick="logFunction('data')" href="../../_functions/data.html" onMouseOver="funcPopup(event,'data')">data</a> (773|532)/i', <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it33960" onMouseOver="hilite(33960)" onMouseOut="lolite()" onClick="logVariable('diagmsg')" href="../../_variables/diagmsg.html">$diagmsg</a>[2]))) {
<a name="l2290"><span class="linenum">2290</span></a>              return true;
<a name="l2291"><span class="linenum">2291</span></a>          }
<a name="l2292"><span class="linenum">2292</span></a>          return false;
<a name="l2293"><span class="linenum">2293</span></a>      }
<a name="l2294"><span class="linenum">2294</span></a>  
<a name="l2295"><span class="linenum">2295</span></a>      <span class="comment">/**</span>
<a name="l2296"><span class="linenum">2296</span></a>  <span class="comment">     * Check if a user is suspended. This function is intended to be used after calling</span>
<a name="l2297"><span class="linenum">2297</span></a>  <span class="comment">     * get_userinfo_asobj. This is needed because LDAP doesn't have a notion of disabled</span>
<a name="l2298"><span class="linenum">2298</span></a>  <span class="comment">     * users, however things like MS Active Directory support it and expose information</span>
<a name="l2299"><span class="linenum">2299</span></a>  <span class="comment">     * through a field.</span>
<a name="l2300"><span class="linenum">2300</span></a>  <span class="comment">     *</span>
<a name="l2301"><span class="linenum">2301</span></a>  <span class="comment">     * @param object $user the user object returned by get_userinfo_asobj</span>
<a name="l2302"><span class="linenum">2302</span></a>  <span class="comment">     * @return boolean</span>
<a name="l2303"><span class="linenum">2303</span></a>  <span class="comment">     */</span>
<a name="l2304"><span class="linenum">2304</span></a>      protected function <a class="function" onClick="logFunction('is_user_suspended')" href="../../_functions/is_user_suspended.html" onMouseOver="funcPopup(event,'is_user_suspended')">is_user_suspended</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>) {
<a name="l2305"><span class="linenum">2305</span></a>          if (!<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;suspended_attribute || !isset(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('suspended')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/suspended.html">suspended</a>)) {
<a name="l2306"><span class="linenum">2306</span></a>              return false;
<a name="l2307"><span class="linenum">2307</span></a>          }
<a name="l2308"><span class="linenum">2308</span></a>          if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;suspended_attribute == 'useraccountcontrol' &amp;&amp; <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;user_type == 'ad') {
<a name="l2309"><span class="linenum">2309</span></a>              return (bool)(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('suspended')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/suspended.html">suspended</a> &amp; <a class="constant" onClick="logConstant('AUTH_AD_ACCOUNTDISABLE')" href="../../_constants/AUTH_AD_ACCOUNTDISABLE.html" onMouseOver="constPopup(event,'AUTH_AD_ACCOUNTDISABLE')">AUTH_AD_ACCOUNTDISABLE</a>);
<a name="l2310"><span class="linenum">2310</span></a>          }
<a name="l2311"><span class="linenum">2311</span></a>  
<a name="l2312"><span class="linenum">2312</span></a>          return (bool)<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('suspended')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/suspended.html">suspended</a>;
<a name="l2313"><span class="linenum">2313</span></a>      }
<a name="l2314"><span class="linenum">2314</span></a>  
<a name="l2315"><span class="linenum">2315</span></a>  } <span class="comment">// End of the class</span>
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'kill_user_sessions': ['kill_user_sessions', 'Terminate all sessions of given user unconditionally. ', [['lib/classes/session','manager.php',633]], 13],
'data': ['data', 'Send an SMTP DATA command. Issues a data command and sends the msg_data to the server, finializing the mail transaction. $msg_data is the message that is to be send with the headers. Each header needs to be on a single line followed by a <CRLF> with the message headers and the message body being separated by and additional <CRLF>. Implements rfc 821: DATA <CRLF> ', [['lib/phpmailer','class.smtp.php',602],['lib/jquery','jquery-3.1.0.js',3959]], 437],
'ldap_connect_moodle': ['ldap_connect_moodle', 'Tries connect to specified ldap servers. Returns a valid LDAP connection or false. ', [['lib','ldaplib.php',163]], 5],
'ldap_get_entries_moodle': ['ldap_get_entries_moodle', 'Returns values like ldap_get_entries but is binary compatible and returns all attributes as array. ', [['lib','ldaplib.php',317]], 11],
'password_expire': ['password_expire', 'Return number of days to user password expires. ', [['auth/manual','auth.php',175],['auth/ldap','auth.php',616],['lib','authlib.php',364]], 8],
'notice': ['notice', 'Print a message and exit. ', [['lib','weblib.php',2626],['lib/mustache/src/Mustache/Logger','AbstractLogger.php',87],['lib/google/src/Google/Logger','Abstract.php',226],['lib/mustache/src/Mustache','Logger.php',92]], 70],
'prevent_local_passwords': ['prevent_local_passwords', '', [['auth/radius','auth.php',148],['auth/nntp','auth.php',86],['auth/email','auth.php',170],['auth/mnet','auth.php',585],['auth/imap','auth.php',107],['auth/shibboleth','auth.php',167],['auth/pam','auth.php',98],['auth/manual','auth.php',109],['auth/none','auth.php',86],['auth/ldap','auth.php',1583],['lib','authlib.php',224],['auth/fc','auth.php',167],['auth/pop3','auth.php',103],['auth/nologin','auth.php',67],['auth/cas','auth.php',59],['auth/db','auth.php',673]], 2],
'debugging': ['debugging', 'Standard Debugging Function ', [['lib','weblib.php',3012]], 1007],
'profile_save_data': ['profile_save_data', 'Saves profile data for a user. ', [['user/profile','lib.php',489]], 11],
'instance': ['instance', 'Returns an instance of the cache_factor method. ', [['cache','disabledlib.php',171],['cache','disabledlib.php',296],['lib/classes','useragent.php',101],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',80],['lib/htmlpurifier/HTMLPurifier','URISchemeRegistry.php',9],['search/classes','manager.php',109],['cache','locallib.php',52],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',53],['lib/classes','plugin_manager.php',103],['lib/htmlpurifier','HTMLPurifier.php',251],['course/format','lib.php',156],['lib/classes/update','checker.php',62],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',31],['admin/tool/installaddon/classes','installer.php',40],['lib','modinfolib.php',373],['cache/classes','helper.php',76],['lib/tests','string_manager_standard_test.php',124],['lib/portfolio','exporter.php',251],['lib/classes/update','validator.php',88],['search/classes','document_factory.php',49],['lib','accesslib.php',6235],['lib','accesslib.php',6487],['lib','accesslib.php',6665],['lib','accesslib.php',6919],['lib','accesslib.php',7180],['lib','accesslib.php',7392],['backup/cc/cc_lib','cc_utils.php',387],['backup/cc/cc_lib','cc_utils.php',443],['lib','filterlib.php',80],['search/tests/fixtures','testable_core_search.php',43],['lib/tests/fixtures','testable_update_checker.php',45],['backup/cc','validator.php',35],['cache/classes','config.php',87],['cache/classes','factory.php',114],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',29]], 4647],
'init_plugin': ['init_plugin', 'Init plugin config from database settings depending on the plugin auth type. ', [['auth/ldap','auth.php',88]], 2],
'set_user_preference': ['set_user_preference', 'Sets a preference for the specified user. ', [['lib','moodlelib.php',1827]], 172],
'get_userinfo': ['get_userinfo', 'Returns the user information for \'external\' users. In this case the attributes provided by Shibboleth ', [['auth/shibboleth','auth.php',96],['auth/ldap','auth.php',229],['lib','authlib.php',385],['auth/fc','auth.php',83],['auth/cas','auth.php',474],['auth/db','auth.php',197]], 8],
'can_confirm': ['can_confirm', 'Returns true if plugin allows confirming of new users. ', [['auth/email','auth.php',135],['auth/ldap','auth.php',576],['lib','authlib.php',332]], 1],
'ldap_unix2expirationtime': ['ldap_unix2expirationtime', 'Takes unix timestamp and returns it formated for storing in LDAP ', [['auth/ldap','auth.php',1471]], 1],
'user_exists': ['user_exists', 'Checks if user exists on LDAP ', [['auth/ldap','auth.php',335],['lib','authlib.php',353],['auth/db','auth.php',474]], 6],
'role_unassign': ['role_unassign', 'Removes one role assignment ', [['lib','accesslib.php',1773]], 31],
'user_update': ['user_update', 'Called when the user record is updated. ', [['auth/ldap','auth.php',1131],['lib','authlib.php',260],['auth/db','auth.php',599]], 3],
'add': ['add', 'Add HashTable item ', [['lib/phpexcel/PHPExcel','HashTable.php',78],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',95],['lib/horde/framework/Horde/Imap/Client','Tokenize.php',109],['lib/google/src/Google/Http','Batch.php',52],['lib/horde/framework/Horde/Imap/Client/Data/Format','List.php',37],['lib','csslib.php',1508],['lib/horde/framework/Horde/Mail/Rfc822','List.php',116],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Memory.php',33],['lib/horde/framework/Horde/Support','ConsistentHash.php',148],['lib/horde/framework/Horde','Variables.php',297],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Template.php.in',29],['lib','outputcomponents.php',2705],['lib','outputcomponents.php',3380],['lib/phpexcel/PHPExcel/Shared/PCLZip','pclzip.lib.php',436],['lib','adminlib.php',735],['lib','adminlib.php',894],['lib','adminlib.php',1446],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Cleanup.php',27],['lib/xhprof/xhprof_html/jquery','jquery-1.2.6.js',3450],['lib/horde/framework/Horde/Imap/Client/Interaction','Pipeline.php',80],['lib/google/src/Google/Service','Webmasters.php',436],['lib','navigationlib.php',304],['lib','navigationlib.php',761],['lib','navigationlib.php',3305],['lib','navigationlib.php',3583],['lib/horde/framework/Horde/Imap/Client','Ids.php',155],['backup/cc/cc_lib/gral_lib','cssparser.php',121],['lib/xhprof/xhprof_html/jquery','jquery.autocomplete.js',428],['lib/horde/framework/Horde','Stream.php',116],['comment','lib.php',679],['lib/mustache/src/Mustache','HelperCollection.php',56],['lib/htmlpurifier/HTMLPurifier','UnitConverter.php',207],['backup/cc/cc_lib','cc_utils.php',395],['backup/cc/cc_lib','cc_utils.php',454],['lib/lessphp/Output','Mapped.php',50],['lib','licenselib.php',32],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Decorator.php',50],['lib/phpexcel/PHPExcel/Reader/Excel5','MD5.php',74],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Null.php',14],['lib/horde/framework/Horde/Mail/Rfc822','GroupList.php',25],['lib/htmlpurifier/HTMLPurifier','IDAccumulator.php',31],['tag/classes','tag.php',152],['blog','locallib.php',242],['lib/classes','notification.php',50],['lib/lessphp','Output.php',18],['tag/classes/output','tagfeed.php',61],['backup/cc','validator.php',51],['lib/horde/framework/Horde/Stream','TempString.php',118],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Serializer.php',11]], 6188],
'get_string': ['get_string', 'Get String returns a requested string ', [['lib/classes','string_manager_install.php',95],['lib','moodlelib.php',6735],['lib','moodlelib.php',9695],['lib/external','externallib.php',102],['question/behaviour','behaviourbase.php',770],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38]], 20134],
'user_update_user': ['user_update_user', 'Update a user with a user object (will compare against the ID) ', [['user','lib.php',121]], 31],
'where': ['where', '', [['question/engine','datalib.php',1883],['question/engine','datalib.php',1965],['mod/glossary/classes','entry_query_builder.php',448],['question/classes/bank/search','hidden_condition.php',53],['question/classes/bank/search','category_condition.php',96]], 64],
'get_cache_flags': ['get_cache_flags', 'Get volatile flags ', [['lib','moodlelib.php',1637]], 8],
'ntlmsso_magic': ['ntlmsso_magic', 'To be called from a page running under NTLM\'s "Integrated Windows Authentication". ', [['auth/ldap','auth.php',1693]], 1],
'get_userlist': ['get_userlist', 'Returns all usernames from LDAP ', [['auth/ldap','auth.php',324],['auth/db','auth.php',499]], 1],
'update_user_record': ['update_user_record', 'Will update a local user record from an external source (MNET users can not be updated using this method!). ', [['lib','moodlelib.php',3776],['auth/ldap','auth.php',976],['auth/db','auth.php',538]], 6],
'ldap_connect': ['ldap_connect', 'Connect to the LDAP server, using the plugin configured settings. It\'s actually a wrapper around ldap_connect_moodle() ', [['enrol/ldap','lib.php',647],['auth/ldap','auth.php',2150]], 20],
'user_not_fully_set_up': ['user_not_fully_set_up', 'Determines if a user has completed setting up their account. ', [['lib','moodlelib.php',3135]], 8],
'auth_plugin_ldap': ['auth_plugin_ldap', 'Old syntax of class constructor. Deprecated in PHP7. ', [['auth/ldap','auth.php',129]], 1],
'or': ['or', '', [['lib/tcpdf','LICENSE.TXT',69]], 556],
'truncate_userinfo': ['truncate_userinfo', 'Will truncate userinfo as it comes from auth_get_userinfo (from external auth) which may have large fields. ', [['lib','moodlelib.php',3858]], 6],
'can_signup': ['can_signup', '', [['auth/email','auth.php',86],['auth/ldap','auth.php',508],['lib','authlib.php',298]], 6],
'ldap_close': ['ldap_close', 'Disconnects from a LDAP server ', [['enrol/ldap','lib.php',679],['auth/ldap','auth.php',2179]], 24],
'is_internal': ['is_internal', 'Returns true if this authentication plugin is \'internal\'. ', [['auth/radius','auth.php',152],['auth/nntp','auth.php',90],['auth/email','auth.php',174],['auth/mnet','auth.php',589],['auth/imap','auth.php',111],['auth/webservice','auth.php',100],['auth/shibboleth','auth.php',171],['auth/pam','auth.php',102],['auth/manual','auth.php',113],['auth/none','auth.php',90],['auth/ldap','auth.php',1592],['lib','authlib.php',203],['auth/fc','auth.php',171],['auth/pop3','auth.php',107],['auth/nologin','auth.php',72],['auth/cas','auth.php',77],['auth/db','auth.php',677]], 19],
'config_form': ['config_form', 'Prints a form for configuring this authentication plugin. ', [['auth/radius','auth.php',171],['auth/nntp','auth.php',109],['auth/email','auth.php',221],['message/output/jabber','message_output_jabber.php',98],['auth/mnet','auth.php',619],['auth/imap','auth.php',144],['auth/webservice','auth.php',140],['auth/shibboleth','auth.php',230],['auth/pam','auth.php',121],['auth/manual','auth.php',160],['auth/none','auth.php',137],['auth/ldap','auth.php',1818],['lib','authlib.php',399],['auth/fc','auth.php',214],['auth/pop3','auth.php',140],['auth/cas','auth.php',233],['auth/db','auth.php',749],['message/output/popup','message_output_popup.php',68],['message/output/email','message_output_email.php',104],['message/output/airnotifier','message_output_airnotifier.php',135]], 3],
'create_from_userid': ['create_from_userid', 'Create instance of event. ', [['lib/classes/event','user_created.php',117],['lib/classes/event','user_updated.php',117]], 17],
'loginpage_hook': ['loginpage_hook', 'Hook for login page ', [['auth/shibboleth','auth.php',190],['auth/ldap','auth.php',1629],['lib','authlib.php',433],['auth/cas','auth.php',96]], 1],
'ldap_isgroupmember': ['ldap_isgroupmember', 'Checks if user belongs to specific group(s) or is in a subtree. ', [['lib','ldaplib.php',113]], 2],
'__construct': ['__construct', '', [['lib/adodb/drivers','adodb-odbc_mssql.inc.php',50],['lib/adodb/drivers','adodb-odbc_mssql.inc.php',359],['question/classes/statistics/responses','analyser.php',69],['auth/radius','auth.php',38],['lib/xmldb','xmldb_file.php',43],['lib/lessphp/Tree/Mixin','Definition.php',18],['cache/stores/static','lib.php',127],['lib/classes/session','file.php',40],['lib/htmlpurifier/HTMLPurifier/Lexer','DOMLex.php',35],['backup/util/ui','base_moodleform.class.php',68],['lib/simplepie/library/SimplePie','Author.php',81],['lib/filestorage','zip_archive.php',66],['backup/util/structure','restore_path_element.class.php',47],['backup/util/structure','restore_path_element.class.php',128],['lib/htmlpurifier/HTMLPurifier/ChildDef','Chameleon.php',36],['lib/phpexcel/PHPExcel','HashTable.php',44],['mod/quiz/tests','repaginate_test.php',39],['lib/form','modvisible.php',43],['lib/phpexcel/PHPExcel/Worksheet','Row.php',44],['cache','disabledlib.php',44],['lib/phpexcel/PHPExcel/Worksheet','Dimension.php',58],['lib/mustache/src/Mustache/Cache','FilesystemCache.php',27],['question/type/ddwtos','question.php',61],['mnet/xmlrpc','client.php',25],['lib/horde/framework/Horde/Imap/Client','Url.php',112],['lib/classes','useragent.php',115],['lib/pear/HTML/QuickForm','advcheckbox.php',66],['lib/classes/update','checker_exception.php',37],['lib/phpexcel/PHPExcel/Reader','Excel2007.php',53],['lib/jabber/XMPP','XMPP.php',101],['lib/form','radio.php',44],['lib/spout/src/Spout/Reader/XLSX/Helper','StyleHelper.php',45],['auth/cas/CAS/CAS/ProxiedService/Http','Abstract.php',58],['lib/phpexcel/PHPExcel/Style','Border.php',67],['lib/htmlpurifier/HTMLPurifier','HTMLDefinition.php',182],['lib/adodb/drivers','adodb-oci8quercus.inc.php',31],['lib/adodb/drivers','adodb-oci8quercus.inc.php',45],['lib/spout/src/Spout/Reader/XLSX','SheetIterator.php',29],['lib/horde/framework/Horde/Imap/Client/Interaction','Server.php',91],['lib/phpexcel/PHPExcel','DocumentProperties.php',123],['lib/typo3','class.t3lib_cs.php',509],['mod/workshop/allocation/scheduled','lib.php',48],['lib/adodb/drivers','adodb-netezza.inc.php',53],['lib/adodb/drivers','adodb-netezza.inc.php',144],['mod/feedback/classes','complete_form.php',58],['search/classes','document.php',188],['webservice/rest','locallib.php',40],['lib/dml','mssql_native_moodle_recordset.php',34],['mod/assign/feedback/editpdf/fpdi','fpdi_pdf_parser.php',57],['lib/htmlpurifier/HTMLPurifier','TokenFactory.php',43],['backup/moodle2','backup_block_task.class.php',43],['lib/lessphp/Tree','Negative.php',14],['lib/minify/lib/Minify/Cache','APC.php',19],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',54],['lib/pear/HTML/QuickForm','header.php',33],['lib/spout/src/Spout/Reader/XLSX/Helper/SharedStringsCaching','InMemoryStrategy.php',26],['lib/phpexcel/PHPExcel/Worksheet','RowCellIterator.php',51],['lib/simplepie/library/SimplePie/XML/Declaration','Parser.php',110],['lib/phpexcel/PHPExcel/Worksheet','ColumnIterator.php',60],['lib/spout/src/Spout/Reader/ODS','Sheet.php',33],['question/type/calculated/tests','helper.php',205],['lib/adodb/drivers','adodb-odbtp.inc.php',38],['lib/adodb/drivers','adodb-odbtp.inc.php',673],['lib/adodb/drivers','adodb-odbtp.inc.php',796],['lib/adodb/drivers','adodb-odbtp.inc.php',806],['lib/adodb/drivers','adodb-odbtp.inc.php',816],['lib/adodb/drivers','adodb-odbtp.inc.php',826],['lib/adodb/drivers','adodb-odbtp.inc.php',836],['enrol/lti/ims-blti','blti.php',28],['backup/cc','cc2moodle.php',105],['mod/chat','locallib.php',181],['mod/chat','locallib.php',229],['user/filters','simpleselect.php',45],['lib/phpexcel/PHPExcel/CachedObjectStorage','Memcache.php',244],['lib/dml','pdo_moodle_database.php',42],['lib/adodb/drivers','adodb-sqlite3.inc.php',36],['lib/adodb/drivers','adodb-sqlite3.inc.php',350],['lib/pear/HTML/QuickForm','static.php',44],['competency/classes/external','comment_area_exporter.php',48],['lib/lessphp/Tree','Selector.php',31],['auth/cas/CAS/CAS','TypeMismatchException.php',43],['auth/fc','fcFPP.php',33],['lib/xmldb','xmldb_key.php',43],['grade/grading/form/rubric','rubriceditor.php',56],['lib/google/src/Google/Service','Cloudlatencytest.php',40],['course','moodleform_mod.php',69],['auth/nntp','auth.php',35],['grade/report/grader','lib.php',111],['admin/tool/generator/classes','course_backend.php',116],['lib/minify/lib','FirePHP.php',189],['lib/adodb/drivers','adodb-sqlitepo.inc.php',38],['lib/horde/framework/Horde/Imap/Client','Tokenize.php',67],['lib/phpexcel/PHPExcel/CachedObjectStorage','CacheBase.php',66],['lib/lessphp/Tree','Rule.php',24],['lib/behat/features/bootstrap','behat_init_context.php',45],['lib','dmllib.php',69],['lib','dmllib.php',84],['lib','dmllib.php',104],['lib','dmllib.php',129],['lib','dmllib.php',159],['lib','dmllib.php',187],['lib','dmllib.php',240],['lib','dmllib.php',270],['lib/google/src/Google/Service','DataTransfer.php',44],['lib/google/src/Google/Http','Batch.php',42],['backup/util/structure','base_processor.class.php',49],['admin/tool/lpmigrate/classes','framework_mapper.php',50],['lib/phpexcel/PHPExcel/Reader','OOCalc.php',46],['lib/lessphp/Tree','NameValue.php',22],['mod/quiz/classes','admin_review_setting.php',82],['lib/htmlpurifier/HTMLPurifier','Generator.php',67],['mod/quiz/report','attemptsreport_table.php',76],['blocks/lp/classes/output','summary.php',59],['lib/google/src/Google/IO','Stream.php',45],['lib/google/src/Google/Service','Freebase.php',38],['grade/tests','reportlib_test.php',36],['search/classes','manager.php',100],['question/behaviour/adaptive','behaviour.php',310],['admin/tool/lp/classes/form','framework_autocomplete.php',48],['lib/minify/lib','JSMinPlus.php',193],['lib/minify/lib','JSMinPlus.php',726],['lib/minify/lib','JSMinPlus.php',1638],['lib/minify/lib','JSMinPlus.php',1656],['lib/minify/lib','JSMinPlus.php',1748],['lib/simplepie/library/SimplePie','Copyright.php',73],['lib/phpexcel/PHPExcel/Style','Conditional.php',93],['lib/google/src/Google/Task','Runner.php',76],['backup/util/settings/root','root_backup_setting.class.php',34],['lib','componentlib.class.php',179],['lib','componentlib.class.php',610],['lib','componentlib.class.php',834],['lib/google/src/Google/Service','AdSense.php',68],['lib/htmlpurifier/HTMLPurifier/AttrDef','Clone.php',18],['lib/spout/src/Spout/Reader/CSV','Sheet.php',24],['lib/filebrowser','file_info_context_system.php',37],['lib/grade','grade_item.php',260],['lib/horde/framework/Horde/Imap/Client/Data/Format','Nstring.php',27],['repository/boxnet','lib.php',56],['auth/email','auth.php',34],['mod/wiki/editors','wikifiletable.php',40],['lib/google/src/Google/Service','Replicapool.php',51],['lib/dtl','database_exporter.php',55],['lib/horde/framework/Horde/Imap/Client/Namespace','List.php',34],['lib/phpexcel/PHPExcel/Writer','CSV.php',79],['lib/google/src/Google/Service','Tasks.php',44],['lib/dml','mysqli_native_moodle_recordset.php',42],['lib/google/src/Google/Service','GamesManagement.php',50],['lib/minify/lib/Minify','Source.php',43],['lib/jabber/XMPP','Roster.php',48],['lib/lessphp/Tree','Element.php',19],['lib/classes','string_manager_install.php',43],['question/type','questiontypebase.php',55],['question/type','questiontypebase.php',1442],['lib/form','filemanager.php',54],['lib/form','filemanager.php',316],['lib/htmlpurifier/HTMLPurifier/ChildDef','Custom.php',36],['backup/util/ui','renderer.php',813],['lib/simplepie/library/SimplePie','Rating.php',73],['lib/phpexcel/PHPExcel/Cell','Hyperlink.php',44],['question/classes/statistics/questions','calculator.php',66],['backup/moodle2','backup_xml_transformer.class.php',50],['lib/google/src/Google/Service','Resource.php',62],['lib/form','autocomplete.php',56],['lib/phpexcel/PHPExcel/Worksheet','RowIterator.php',60],['mod/lesson/classes','file_info.php',45],['question/type/tests','question_first_matching_answer_grading_strategy_test.php',40],['lib/google/src/Google/Service','Partners.php',43],['cache','lib.php',66],['cache','lib.php',109],['cache','lib.php',138],['cache','lib.php',183],['grade/edit/tree','lib.php',57],['grade/edit/tree','lib.php',635],['grade/edit/tree','lib.php',668],['grade/edit/tree','lib.php',834],['lib/simplepie/library/SimplePie','Cache.php',69],['mod/wiki/diff','difflib.php',277],['mod/wiki/diff','difflib.php',381],['mod/wiki/diff','difflib.php',478],['lib/pear/HTML/QuickForm','select.php',58],['lib/classes/output','mustache_javascript_helper.php',40],['lib/phpexcel/PHPExcel/Reader/Excel2007','Theme.php',68],['mod/data','export_form.php',16],['lib/pear/HTML/QuickForm','autocomplete.php',67],['question/type/shortanswer','question.php',44],['lib/google/src/Google/Service','AndroidPublisher.php',52],['lib/google/src/Google/Verifier','Pem.php',31],['lib/classes/antivirus','scanner.php',41],['lib/phpexcel/PHPExcel/Reader','Excel5.php',414],['lib/horde/framework/Horde/Imap/Client/Auth','DigestMD5.php',69],['lib/classes/output','mustache_filesystem_loader.php',39],['lib/classes/output','inplace_editable.php',107],['lib/adodb/drivers','adodb-informix.inc.php',37],['competency/classes','competency_rule.php',45],['lib/phpexcel/PHPExcel','RichText.php',37],['lib/phpexcel/PHPExcel/Shared/JAMA','Matrix.php',59],['lib/pear/HTML/QuickForm','input.php',38],['repository/picasa','lib.php',41],['mod/feedback/classes','structure.php',48],['backup/util/plan','backup_structure_step.class.php',38],['question/classes/bank','random_question_loader.php',61],['mod/quiz/report/statistics/classes','calculated.php',43],['lib/horde/framework/Horde/Stream','String.php',27],['backup/util/helper','restore_decode_content.class.php',50],['backup/util/helper','restore_decode_content.class.php',125],['mod/workshop/backup/moodle1','lib.php',308],['lib/google/src/Google/Service','YouTubeReporting.php',47],['grade/export/txt','grade_export_txt.php',27],['lib/mustache/src/Mustache/Exception','SyntaxException.php',23],['lib/tcpdf','tcpdf_barcodes_2d.php',58],['mod/imscp','locallib.php',289],['lib/form','selectyesno.php',42],['lib/horde/framework/Horde/Mail/Transport','Smtphorde.php',62],['mod/lti/service/toolsettings/classes/local/service','toolsettings.php',41],['mod/lti/service/profile/classes/local/service','profile.php',41],['repository/flickr_public','lib.php',49],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','BackgroundPosition.php',57],['admin/tool/lp/classes/output','template_cohorts_table.php',53],['lib/simplepie/library','SimplePie.php',611],['lib/horde/framework/Horde/Imap/Client/Base','Debug.php',55],['lib/google/src/Google/Service','Reseller.php',44],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Border.php',18],['lib/testing/generator','component_generator_base.php',45],['lib/horde/framework/Horde/Translation/Handler','Gettext.php',34],['lib/phpexcel/PHPExcel/Worksheet','HeaderFooter.php',175],['lib/classes','plugin_manager.php',91],['lib/horde/framework/Horde/Imap/Client/Data/Format','List.php',28],['lib/horde/framework/Horde/Support','CombineStream.php',29],['lib/xmldb','xmldb_field.php',84],['lib/adodb/drivers','adodb-ibase.inc.php',59],['lib/adodb/drivers','adodb-ibase.inc.php',764],['lib/htmlpurifier/HTMLPurifier/AttrDef','URI.php',23],['admin/roles/classes','view_role_definition_table.php',28],['lib/google/src/Google/Cache','Memcache.php',44],['lib/pear/HTML/QuickForm','radio.php',48],['lib/filebrowser','file_info_context_coursecat.php',39],['lib/spout/src/Spout/Writer/ODS/Internal','Workbook.php',37],['mod/workshop/eval/best','lib.php',44],['lib/phpexcel/PHPExcel/Writer/PDF','DomPDF.php',38],['grade/report','lib.php',156],['lib','csslib.php',1501],['lib','csslib.php',1587],['lib','csslib.php',2068],['lib','csslib.php',2136],['lib','csslib.php',2242],['availability/classes','info_module.php',40],['mod/book','locallib.php',414],['question/engine','datalib.php',68],['question/engine','datalib.php',1331],['question/engine','datalib.php',1632],['question/engine','datalib.php',1740],['question/engine','datalib.php',1870],['question/engine','datalib.php',1941],['webservice','lib.php',745],['webservice','lib.php',841],['lib/adodb/drivers','adodb-informix72.inc.php',59],['lib/adodb/drivers','adodb-informix72.inc.php',399],['lib/adodb','adodb-pager.inc.php',60],['user/classes/output/myprofile','category.php',68],['lib/lessphp/Visitor','extendFinder.php',15],['backup/util/settings','base_setting.class.php',89],['backup/util/settings','base_setting.class.php',556],['lib','filelib.php',2720],['lib','filelib.php',3601],['lib/phpunit/classes','database_driver_testcase.php',55],['lib/phpexcel/PHPExcel/Shared/OLE/PPS','File.php',32],['report/competency/classes/output','report.php',56],['lib/google/src/Google/Service','Computeaccounts.php',49],['question/type','edit_question_form.php',96],['lib/filebrowser','file_info_context_user.php',39],['admin/tool/lp/classes/output','template_plans_page.php',37],['lib/phpexcel/PHPExcel','Style.php',93],['lib/minify/lib/Minify','HTML.php',49],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','ListStyle.php',20],['lib/form','password.php',44],['backup','backup.class.php',146],['mod/feedback/classes','course_select_form.php',39],['lib/google/src/Google/Auth','AppIdentity.php',39],['lib/adodb','adodb-active-record.inc.php',121],['lib/phpexcel/PHPExcel','Chart.php',169],['lib/horde/framework/Horde/Mail/Rfc822','List.php',61],['admin/roles/classes','allow_switch_page.php',33],['lib/grade','grade_object.php',80],['lib/google/src/Google/IO','Exception.php',29],['auth/lti','auth.php',38],['mod/quiz/report/statistics/classes','calculator.php',39],['lib/htmlpurifier','HTMLPurifier.php',104],['admin/tool/lp/classes/output','user_competency_summary_in_plan.php',47],['mod/assign/feedback/editpdf/classes','widget.php',53],['lib/evalmath','evalmath.class.php',120],['lib/form','url.php',46],['lib/dml','pdo_moodle_recordset.php',41],['lib/htmlpurifier/HTMLPurifier/TagTransform','Simple.php',19],['backup/cc/cc_lib','xmlbase.php',52],['badges/lib','bakerlib.php',52],['lib/google/src/Google/Signer','P12.php',35],['availability/classes','info_section.php',40],['lib/form','static.php',47],['backup/converter','convertlib.php',52],['backup/converter','convertlib.php',277],['lib/google/src/Google/Service','YouTubeAnalytics.php',56],['admin/roles/classes','check_capability_table.php',40],['lib/htmlpurifier/HTMLPurifier','AttrTypes.php',14],['lib/adodb/drivers','adodb-postgres64.inc.php',127],['lib/adodb/drivers','adodb-postgres64.inc.php',919],['backup/util/helper','restore_prechecks_helper.class.php',213],['user/profile','lib.php',59],['lib/google/src/Google/Service','Admin.php',40],['lib/spout/src/Spout/Reader/CSV','RowIterator.php',62],['lib/google/src/Google/Service','MapsEngine.php',66],['lib','listlib.php',82],['lib','listlib.php',485],['lib/phpexcel/PHPExcel/Writer','HTML.php',128],['backup/moodle2','restore_activity_task.class.php',48],['lib/htmlpurifier/HTMLPurifier','HTMLModuleManager.php',68],['lib/simplepie/library/SimplePie','Source.php',61],['completion','data_object.php',68],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','ID.php',28],['grade/report/singleview/classes/local/ui','dropdown_attribute.php',49],['lib/horde/framework/Horde/Support','Stack.php',18],['lib/google/src/Google/Cache','File.php',41],['lib/horde/framework/Horde/Mail/Transport','Mock.php',76],['backup/util/ui','backup_moodleform.class.php',41],['availability/condition/grouping/classes','condition.php',46],['lib/classes/session','memcache.php',50],['cache/classes','dummystore.php',62],['badges/classes','assertion.php',49],['lib/xhprof/xhprof_lib/utils','xhprof_runs.php',87],['availability/tests/fixtures','mock_condition.php',52],['lib/mustache/src/Mustache/Loader','FilesystemLoader.php',33],['mod/quiz/report','attemptsreport_options.php',95],['lib/phpexcel/PHPExcel/Writer/PDF','tcPDF.php',39],['lib/minify/lib/Minify/CSS','Compressor.php',51],['lib/google/src/Google/Service','Dns.php',53],['question/type/calculatedmulti','edit_calculatedmulti_form.php',47],['backup/moodle2','restore_block_task.class.php',45],['lib/phpexcel/PHPExcel/Worksheet','AutoFilter.php',54],['lib/form','recaptcha.php',48],['lib','csvlib.class.php',64],['lib','csvlib.class.php',398],['lib/simplepie/library/SimplePie/Cache','File.php',82],['lib/phpexcel/PHPExcel/Chart','Legend.php',75],['lib/phpexcel/PHPExcel','WorksheetIterator.php',44],['cache/classes','loaders.php',196],['cache/classes','loaders.php',1189],['cache/classes','loaders.php',1586],['lib/google/src/Google/Service','Appengine.php',44],['admin/tool/lp/classes/output','template_cohorts_page.php',37],['search/classes','engine.php',77],['backup/cc/cc_lib','cc_assesment_essay.php',25],['lib/classes/progress','display.php',48],['lib/lessphp/Tree','Call.php',19],['course/format','lib.php',78],['question/type/calculated','datasetdefinitions_form.php',53],['lib/google/src/Google/Service','Translate.php',40],['enrol/database','settingslib.php',34],['lib/lessphp/Tree/Mixin','Call.php',14],['admin/tool/log/store/standard/classes/log','store.php',37],['lib/google/src/Google/Service','Urlshortener.php',40],['lib/horde/framework/Horde/Imap/Client','Socket.php',168],['lib/tests','collator_test.php',310],['lib/google/src/Google/Auth','Simple.php',31],['backup/cc/cc_lib','cc_manifest.php',45],['lib/bennu','iCalendar_properties.php',28],['lib/bennu','iCalendar_properties.php',220],['lib/bennu','iCalendar_properties.php',238],['lib/bennu','iCalendar_properties.php',259],['lib/bennu','iCalendar_properties.php',275],['lib/bennu','iCalendar_properties.php',296],['lib/bennu','iCalendar_properties.php',343],['lib/bennu','iCalendar_properties.php',358],['lib/bennu','iCalendar_properties.php',376],['lib/bennu','iCalendar_properties.php',391],['lib/bennu','iCalendar_properties.php',406],['lib/bennu','iCalendar_properties.php',447],['lib/bennu','iCalendar_properties.php',462],['lib/bennu','iCalendar_properties.php',485],['lib/bennu','iCalendar_properties.php',509],['lib/bennu','iCalendar_properties.php',524],['lib/bennu','iCalendar_properties.php',555],['lib/bennu','iCalendar_properties.php',573],['lib/bennu','iCalendar_properties.php',594],['lib/bennu','iCalendar_properties.php',637],['lib/bennu','iCalendar_properties.php',680],['lib/bennu','iCalendar_properties.php',724],['lib/bennu','iCalendar_properties.php',747],['lib/bennu','iCalendar_properties.php',782],['lib/bennu','iCalendar_properties.php',808],['lib/bennu','iCalendar_properties.php',849],['lib/bennu','iCalendar_properties.php',864],['lib/bennu','iCalendar_properties.php',905],['lib/bennu','iCalendar_properties.php',938],['lib/bennu','iCalendar_properties.php',952],['lib/bennu','iCalendar_properties.php',965],['lib/bennu','iCalendar_properties.php',987],['lib/bennu','iCalendar_properties.php',1017],['lib/bennu','iCalendar_properties.php',1031],['lib/bennu','iCalendar_properties.php',1061],['lib/bennu','iCalendar_properties.php',1075],['lib/bennu','iCalendar_properties.php',1098],['lib/bennu','iCalendar_properties.php',1110],['lib/bennu','iCalendar_properties.php',1139],['lib/bennu','iCalendar_properties.php',1160],['lib/bennu','iCalendar_properties.php',1181],['lib/bennu','iCalendar_properties.php',1203],['lib/bennu','iCalendar_properties.php',1227],['lib/bennu','iCalendar_properties.php',1260],['lib/bennu','iCalendar_properties.php',1386],['lib/bennu','iCalendar_properties.php',1407],['lib/bennu','iCalendar_properties.php',1429],['lib/bennu','iCalendar_properties.php',1450],['lib/mustache/src/Mustache/Exception','UnknownTemplateException.php',22],['lib/phpmailer','moodle_phpmailer.php',47],['availability/tests/fixtures','mock_info.php',40],['lib/horde/framework/Horde/Mail/Transport','Smtpmx.php',138],['admin/tool/lp/classes/form','persistent.php',68],['lib/adodb/drivers','adodb-mysqlt.inc.php',32],['lib/adodb/drivers','adodb-mysqlt.inc.php',96],['webservice/tests','lib_test.php',213],['lib/horde/framework/Horde/Imap/Client/Data/Format','Mailbox.php',35],['filter','local_settings_form.php',33],['mod/quiz/accessrule','accessrulebase.php',52],['lib/horde/framework/Horde/Exception','Wrapped.php',16],['mod/assign/feedback/editpdf/fpdi','pdf_parser.php',170],['lib/lessphp/Tree','Dimension.php',15],['lib/minify/lib/HTTP','ConditionalGet.php',109],['lib/adodb/perf','perf-oci8.inc.php',203],['lib/phpexcel','PHPExcel.php',361],['backup/util/helper','restore_questions_parser_processor.class.php',42],['backup/moodle2','backup_plugin.class.php',44],['lib/classes/antivirus','scanner_exception.php',38],['webservice/xmlrpc','lib.php',43],['report/loglive/classes','renderable.php',73],['course','dnduploadlib.php',109],['course','dnduploadlib.php',407],['lib/filebrowser','file_info.php',43],['lib/adodb/drivers','adodb-access.inc.php',34],['lib/adodb/drivers','adodb-access.inc.php',83],['mod/feedback/classes','responses_table.php',54],['lib/editor/tinymce','adminlib.php',36],['admin/tool/monitor/classes','rule.php',44],['lib/google/src/Google/Service','AdExchangeBuyer.php',55],['lib/filebrowser','virtual_root_file.php',45],['lib/phpexcel/PHPExcel/RichText','Run.php',35],['admin/tool/monitor/classes/output/managesubs','subs.php',51],['auth/cas/CAS/CAS','ProxyChain.php',48],['lib/htmlpurifier/HTMLPurifier','DefinitionCache.php',22],['lib/google/src/Google/Service','CivicInfo.php',40],['mod/feedback/classes/output','summary.php',52],['lib/minify/lib/Minify','Build.php',77],['lib/adodb/drivers','adodb-ado_mssql.inc.php',146],['lib/adodb/drivers','adodb-odbc.inc.php',44],['lib/adodb/drivers','adodb-odbc.inc.php',611],['lib','moodlelib.php',9421],['lib','moodlelib.php',9632],['user/selector','lib.php',85],['user/selector','lib.php',674],['admin/tool/lp/classes/output','plan_page.php',49],['repository/dropbox','lib.php',49],['lib/horde/framework/Horde/Mime','Part.php',261],['lib/spout/src/Spout/Reader/XLSX/Helper/SharedStringsCaching','CachingStrategyFactory.php',56],['lib/phpexcel/PHPExcel/Chart','Layout.php',143],['lib/mustache/src/Mustache/Loader','CascadingLoader.php',20],['lib/phpexcel/PHPExcel/Shared/JAMA','EigenvalueDecomposition.php',777],['lib/google/src/Google/Service','Books.php',60],['lib/google/src/Google/Service','Oauth2.php',50],['admin/tool/log/classes/log','store.php',30],['admin/tool/recyclebin/classes','category_bin.php',45],['lib/phpexcel/PHPExcel/Style','Color.php',64],['lib/phpexcel/PHPExcel/Worksheet','SheetView.php',69],['lib/htmlpurifier/HTMLPurifier/Token','Text.php',34],['lib/classes/update','checker.php',50],['lib/horde/framework/Horde/Socket','Client.php',52],['lib/phpexcel/PHPExcel/CachedObjectStorage','APC.php',243],['lib/horde/framework/Horde/Imap/Client/Cache','Backend.php',33],['lib/phpexcel/PHPExcel/Chart','Title.php',45],['lib/horde/framework/Horde/Imap/Client/Data','Format.php',32],['lib/adodb/drivers','adodb-text.inc.php',93],['lib/adodb/drivers','adodb-text.inc.php',379],['lib/phpexcel/PHPExcel','Calculation.php',2071],['lib/adodb/drivers','adodb-sqlite.inc.php',36],['lib/adodb/drivers','adodb-sqlite.inc.php',367],['lib/google/src/Google/Service','Analytics.php',77],['blocks/lp/classes/output','plans_to_review_page.php',48],['lib/google/src/Google/Service','Coordinate.php',48],['availability/condition/group/classes','condition.php',43],['lib/lessphp/Exception','Chunk.php',19],['lib/htmlpurifier/HTMLPurifier','PropertyListIterator.php',22],['backup/cc/cc_lib','cc_resources.php',102],['lib/horde/framework/Horde/Mail/Rfc822','Group.php',45],['backup/util/structure','base_optigroup.class.php',35],['backup/util/structure','base_optigroup.class.php',169],['question/classes/statistics/questions','calculated.php',181],['lib/horde/framework/Horde/Imap/Client/Interaction','Command.php',72],['lib/htmlpurifier/HTMLPurifier/Strategy','Core.php',8],['lib/htmlpurifier/HTMLPurifier/Filter','ExtractStyleBlocks.php',57],['backup/cc/cc_lib','cc_converter_url.php',29],['lib/xmldb','xmldb_structure.php',40],['lib/ddl','sqlite_sql_generator.php',73],['lib/pear/HTML/QuickForm','Renderer.php',31],['backup/util/helper','restore_moodlexml_parser_processor.class.php',38],['lib/pear/HTML/QuickForm','file.php',54],['lib/minify/lib/Minify/Cache','File.php',9],['lib/pear/HTML/QuickForm','xbutton.php',39],['lib/htmlpurifier','locallib.php',134],['admin/tool/recyclebin/classes','course_bin.php',45],['backup/util/plan','backup_task.class.php',32],['backup/util/plan','backup_task.class.php',56],['lib/phpexcel/PHPExcel/CachedObjectStorage','PHPTemp.php',174],['backup/util/helper','backup_helper.class.php',381],['lib/form','htmleditor.php',48],['lib','oauthlib.php',65],['lib','oauthlib.php',409],['auth/cas/CAS/CAS/PGTStorage','File.php',105],['auth/cas/CAS/CAS/ProxiedService','Imap.php',51],['repository/skydrive','lib.php',42],['lib/htmlpurifier/HTMLPurifier','ErrorCollector.php',57],['lib/classes/lock','postgres_lock_factory.php',81],['lib/phpexcel/PHPExcel/CachedObjectStorage','SQLite.php',260],['lib/horde/framework/Horde/Support','ConsistentHash.php',56],['lib/horde/framework/Horde/Exception','Pear.php',22],['lib/portfolio','exceptions.php',50],['backup/moodle2','restore_plugin.class.php',43],['lib/phpexcel/PHPExcel/CachedObjectStorage','DiscISAM.php',177],['lib/google/src/Google/Service','DoubleClickBidManager.php',40],['lib/minify/lib/Minify/JS','ClosureCompiler.php',101],['lib/horde/framework/Horde/Imap/Client/Data/Format','String.php',38],['lib/form','dateselector.php',70],['lib/spout/src/Spout/Common/Helper','EncodingHelper.php',38],['report/competency/classes/output','user_course_navigation.php',51],['lib/adodb/drivers','adodb-postgres7.inc.php',98],['lib/adodb/drivers','adodb-postgres7.inc.php',311],['lib/adodb/drivers','adodb-postgres7.inc.php',342],['lib/lessphp/Tree','Alpha.php',13],['mod/lti/service/memberships/classes/local/resource','linkmemberships.php',46],['lib/tcpdf','tcpdf.php',1822],['lib/adodb/drivers','adodb-sybase.inc.php',47],['lib/adodb/drivers','adodb-sybase.inc.php',313],['lib/adodb/drivers','adodb-sybase.inc.php',394],['lib/phpexcel/PHPExcel/Chart','PlotArea.php',44],['lib/phpexcel/PHPExcel/Chart','DataSeries.php',136],['mod/lesson','editpage_form.php',41],['question/classes/statistics/responses','analysis_for_question.php',58],['lib/horde/framework/Horde','Domhtml.php',53],['lib','formslib.php',142],['lib','formslib.php',1442],['lib','formslib.php',2653],['rating','lib.php',114],['rating','lib.php',1070],['lib/phpexcel/PHPExcel/Worksheet','Column.php',44],['lib/google/src/Google/Service','Script.php',67],['lib/adodb','adodb-xmlschema.inc.php',118],['lib/adodb','adodb-xmlschema.inc.php',245],['lib/adodb','adodb-xmlschema.inc.php',637],['lib/adodb','adodb-xmlschema.inc.php',781],['lib/adodb','adodb-xmlschema.inc.php',982],['lib/adodb','adodb-xmlschema.inc.php',1295],['lib/google/src/Google/Service','DeploymentManager.php',54],['mod/quiz','attemptlib.php',41],['mod/quiz','attemptlib.php',82],['mod/quiz','attemptlib.php',546],['mod/quiz','attemptlib.php',2337],['mod/quiz','attemptlib.php',2392],['backup/cc/cc_lib','cc_converter_forum.php',29],['lib','boxlib.php',264],['lib/simplepie/library/SimplePie','Restriction.php',81],['admin/roles/classes','allow_assign_page.php',31],['lib/adodb/drivers','adodb-pdo.inc.php',90],['lib/adodb/drivers','adodb-pdo.inc.php',553],['lib/adodb/drivers','adodb-pdo.inc.php',630],['tag/classes/output','tagareacollection.php',40],['admin/tool/lp/classes','template_statistics.php',62],['lib','weblib.php',313],['lib','weblib.php',3183],['lib','weblib.php',3483],['lib','weblib.php',3518],['lib','weblib.php',3593],['backup/cc/cc_lib','cc_converter_basiclti.php',29],['lib/html2text','Html2Text.php',232],['mod/assign/feedback/editpdf/classes','annotation.php',66],['lib/pear/HTML/QuickForm/Renderer','Array.php',143],['question/engine','lib.php',774],['question/engine','lib.php',1011],['question/engine','lib.php',1059],['lib/jabber/XMPP','XMLObj.php',76],['lib/horde/framework/Horde/Exception','PermissionDenied.php',15],['lib/editor/atto','adminlib.php',109],['lib/pear/HTML/QuickForm/Renderer','Tableless.php',116],['grade/report/history/classes/output','tablelog.php',72],['lib/google/src/Google/IO','Curl.php',38],['lib/editor/tinymce/plugins/spellchecker/classes/utils','Logger.php',31],['lib/pear/HTML/QuickForm','hiddenselect.php',41],['backup/util/ui','backup_ui_setting.class.php',70],['backup/util/ui','backup_ui_setting.class.php',200],['backup/util/ui','backup_ui_setting.class.php',398],['backup/util/ui','backup_ui_setting.class.php',504],['backup/util/ui','backup_ui_setting.class.php',583],['lib/adodb/drivers','adodb-mysqlpo.inc.php',35],['lib/adodb/drivers','adodb-mysqlpo.inc.php',82],['lib/adodb/drivers','adodb-mysqlpo.inc.php',119],['lib/google/src/Google/Service','Blogger.php',50],['backup/util/xml/output','file_xml_output.class.php',37],['lib/form','tags.php',75],['admin/tool/installaddon/classes','installer.php',219],['lib/htmlpurifier/HTMLPurifier/AttrDef','Enum.php',30],['lib/simplepie/library/SimplePie','IRI.php',252],['comment','locallib.php',39],['question/engine','states.php',61],['lib/spout/src/Spout/Reader/XLSX/Helper','CellValueFormatter.php',52],['lib/google/src/Google/Service','Dataflow.php',45],['mod/data','locallib.php',66],['mod/data','locallib.php',433],['lib/horde/framework/Horde','Variables.php',60],['backup/util/ui','base_ui.class.php',84],['lib/simplepie/library/SimplePie','Registry.php',99],['cache/locks/file','lib.php',66],['question/classes/statistics/responses','analysis_for_class.php',68],['lib/filebrowser','file_info_stored.php',51],['tag/classes/output','tagcollname.php',42],['competency/classes','persistent.php',54],['admin/tool/lp/classes/output','competency_plan_navigation.php',54],['lib/phpexcel/PHPExcel/Cell','DataValidation.php',146],['lib/pear/HTML/QuickForm','textarea.php',48],['lib/lessphp','Visitor.php',14],['lib/google/src/Google/Service','CloudUserAccounts.php',52],['question/classes/bank','column_base.php',44],['lib/minify/lib/MrClay','Cli.php',74],['lib','outputcomponents.php',80],['lib','outputcomponents.php',204],['lib','outputcomponents.php',469],['lib','outputcomponents.php',523],['lib','outputcomponents.php',589],['lib','outputcomponents.php',665],['lib','outputcomponents.php',783],['lib','outputcomponents.php',925],['lib','outputcomponents.php',1009],['lib','outputcomponents.php',2183],['lib','outputcomponents.php',2222],['lib','outputcomponents.php',2295],['lib','outputcomponents.php',2376],['lib','outputcomponents.php',2579],['lib','outputcomponents.php',2627],['lib','outputcomponents.php',2687],['lib','outputcomponents.php',2860],['lib','outputcomponents.php',3030],['lib','outputcomponents.php',3134],['lib','outputcomponents.php',3201],['lib','outputcomponents.php',3329],['lib','outputcomponents.php',3613],['lib','outputcomponents.php',3642],['lib','outputcomponents.php',3668],['lib','outputcomponents.php',3690],['lib','outputcomponents.php',3719],['lib','outputcomponents.php',3751],['lib/google/src/Google/Service','Pagespeedonline.php',39],['lib/phpexcel/PHPExcel','Cell.php',114],['lib/dml','sqlsrv_native_moodle_recordset.php',40],['repository/wikimedia','wikimedia.php',35],['lib/phpexcel/PHPExcel/Style','Fill.php',81],['lib/google/src/Google/Service','Cloudresourcemanager.php',42],['lib/editor/tinymce/classes','plugin.php',49],['mod/wiki/parser/markups','html.php',21],['lib/simplepie/library/SimplePie/Parse','Date.php',536],['lib/horde/framework/Horde/Support','Inflector.php',115],['question/type/gapselect','question.php',55],['lib/google/src/Google','Config.php',33],['badges/criteria','award_criteria_activity.php',45],['backup/util/xml/output','xml_output.class.php',52],['backup/util/xml/output','xml_output.class.php',158],['course/format/topics','renderer.php',38],['lib/adodb/drivers','adodb-oci8po.inc.php',33],['lib/adodb/drivers','adodb-oci8po.inc.php',99],['mod/workshop/allocation/random','lib.php',52],['mod/workshop/allocation/random','lib.php',727],['backup/util/structure','base_final_element.class.php',38],['backup/util/structure','base_final_element.class.php',239],['backup/util/structure','base_final_element.class.php',256],['lib/htmlpurifier/HTMLPurifier','Zipper.php',25],['lib/horde/framework/Horde/Imap/Client/Data','Thread.php',41],['lib/mustache/src/Mustache/Exception','UnknownHelperException.php',22],['backup/util/settings/activity','activity_backup_setting.class.php',25],['lib/filestorage','tgz_packer.php',749],['lib/filestorage','tgz_packer.php',831],['tag/classes','index_builder.php',96],['lib/pear/HTML/QuickForm','reset.php',37],['lib/classes/lock','lock.php',55],['admin/roles/classes','assign_user_selector_base.php',40],['backup/util/output','output_controller.class.php',44],['question/type/randomsamatch','question.php',114],['lib/google/src/Google/Service','Customsearch.php',38],['lib/lessphp/Tree','Extend.php',28],['lib/phpexcel/PHPExcel/Shared/PCLZip','pclzip.lib.php',215],['lib/google/src/Google/Service','TagManager.php',67],['question/type/gapselect/tests','edit_form_test.php',41],['mod/lesson','locallib.php',2004],['mod/lesson','locallib.php',2611],['backup/util/helper','restore_structure_parser_processor.class.php',41],['course','renderer.php',52],['backup/util/xml/parser/processors','selective_exact_parser_processor.class.php',35],['lib','modinfolib.php',429],['lib','modinfolib.php',1665],['lib','modinfolib.php',2492],['lib','tablelib.php',128],['lib','tablelib.php',1468],['lib','tablelib.php',1633],['lib','tablelib.php',1698],['user/filters','cohort.php',36],['user/filters','text.php',37],['lib','outputrenderers.php',120],['lib','outputrenderers.php',285],['lib','outputrenderers.php',408],['lib','outputrenderers.php',4578],['lib','outputrenderers.php',4831],['repository','lib.php',116],['repository','lib.php',533],['lib','adminlib.php',791],['lib','adminlib.php',1138],['lib','adminlib.php',1212],['lib','adminlib.php',1355],['lib','adminlib.php',1556],['lib','adminlib.php',1928],['lib','adminlib.php',2040],['lib','adminlib.php',2106],['lib','adminlib.php',2199],['lib','adminlib.php',2260],['lib','adminlib.php',2302],['lib','adminlib.php',2341],['lib','adminlib.php',2429],['lib','adminlib.php',2463],['lib','adminlib.php',2621],['lib','adminlib.php',2706],['lib','adminlib.php',2935],['lib','adminlib.php',3091],['lib','adminlib.php',3233],['lib','adminlib.php',3324],['lib','adminlib.php',3488],['lib','adminlib.php',3571],['lib','adminlib.php',3682],['lib','adminlib.php',3833],['lib','adminlib.php',4067],['lib','adminlib.php',4134],['lib','adminlib.php',4352],['lib','adminlib.php',4381],['lib','adminlib.php',4410],['lib','adminlib.php',4434],['lib','adminlib.php',4464],['lib','adminlib.php',4500],['lib','adminlib.php',4535],['lib','adminlib.php',4567],['lib','adminlib.php',4657],['lib','adminlib.php',4690],['lib','adminlib.php',4748],['lib','adminlib.php',4790],['lib','adminlib.php',4814],['lib','adminlib.php',4840],['lib','adminlib.php',4863],['lib','adminlib.php',4880],['lib','adminlib.php',4925],['lib','adminlib.php',4943],['lib','adminlib.php',5002],['lib','adminlib.php',5045],['lib','adminlib.php',5080],['lib','adminlib.php',5123],['lib','adminlib.php',5206],['lib','adminlib.php',5336],['lib','adminlib.php',5378],['lib','adminlib.php',5423],['lib','adminlib.php',5480],['lib','adminlib.php',5496],['lib','adminlib.php',5552],['lib','adminlib.php',5777],['lib','adminlib.php',5831],['lib','adminlib.php',5885],['lib','adminlib.php',5902],['lib','adminlib.php',5950],['lib','adminlib.php',5992],['lib','adminlib.php',6043],['lib','adminlib.php',6099],['lib','adminlib.php',6328],['lib','adminlib.php',6508],['lib','adminlib.php',6688],['lib','adminlib.php',6782],['lib','adminlib.php',6931],['lib','adminlib.php',7088],['lib','adminlib.php',7712],['lib','adminlib.php',8147],['lib','adminlib.php',8330],['lib','adminlib.php',8617],['lib','adminlib.php',8764],['lib','adminlib.php',8924],['lib','adminlib.php',9071],['lib','adminlib.php',9235],['lib','adminlib.php',9428],['lib','adminlib.php',9482],['lib','adminlib.php',9544],['lib','adminlib.php',9589],['lib','adminlib.php',9626],['backup/cc/cc_lib','cc_organization.php',47],['backup/cc/cc_lib','cc_organization.php',145],['lib/phpexcel/PHPExcel/Chart','DataSeriesValues.php',81],['lib/horde/framework/Horde/Mail/Rfc822','Identification.php',34],['question/type/numerical','questiontype.php',507],['auth/mnet','auth.php',35],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Cache.php',68],['lib/htmlpurifier/HTMLPurifier','PropertyList.php',29],['auth/imap','auth.php',35],['tag/classes/output','taglist.php',54],['lib','pdflib.php',161],['lib/phpexcel/PHPExcel/RichText','TextElement.php',35],['lib/dml','database_column_info.php',112],['lib/horde/framework/Horde/Imap/Client/Exception','NoSupportExtension.php',33],['mod/wiki/editors','wikieditor.php',36],['lib/lessphp/SourceMap','Base64VLQ.php',67],['repository/s3','lib.php',44],['admin/tool/uploadcourse/classes','course.php',111],['lib/google/src/Google/Service','Replicapoolupdater.php',51],['lib/horde/framework/Horde/Imap/Client/Data/Format','Date.php',25],['lib/bennu','iCalendar_components.php',21],['lib/bennu','iCalendar_components.php',333],['lib/bennu','iCalendar_components.php',355],['lib/bennu','iCalendar_components.php',433],['lib/bennu','iCalendar_components.php',513],['lib/bennu','iCalendar_components.php',551],['lib/bennu','iCalendar_components.php',602],['lib/bennu','iCalendar_components.php',659],['lib/bennu','iCalendar_components.php',679],['lib/phpexcel/PHPExcel/Calculation','FormulaToken.php',102],['mod/feedback/item','feedback_item_class.php',28],['lib/adodb/drivers','adodb-mssql_n.inc.php',245],['lib','badgeslib.php',133],['lib/pear/HTML/QuickForm','text.php',38],['lib/simplepie/library/SimplePie','Enclosure.php',219],['calendar/classes','rrule_manager.php',182],['auth/webservice','auth.php',35],['lib','outputrequirementslib.php',171],['mod/lti/service/toolsettings/classes/local/resource','contextsettings.php',44],['lib','questionlib.php',1261],['lib','questionlib.php',1505],['lib','uploadlib.php',40],['lib/spout/src/Spout/Writer/Common/Helper','ZipHelper.php',28],['lib/google/src/Google/Service','Cloudsearch.php',40],['backup/util/structure','backup_nested_element.class.php',44],['lib/spout/src/Spout/Writer/Common','Sheet.php',39],['question/behaviour','behaviourbase.php',50],['blocks/rss_client/classes/output','footer.php',47],['lib/dtl','file_xml_database_importer.php',34],['admin/roles/classes','capability_table_with_risks.php',45],['lib/adodb/drivers','adodb-mssql.inc.php',110],['lib/adodb/drivers','adodb-mssql.inc.php',870],['lib/adodb/drivers','adodb-mssql.inc.php',1077],['lib/google/src/Google/Service','Bigquery.php',62],['lib/google/src/Google/Service','ShoppingContent.php',50],['mod/lti','OAuth.php',73],['mod/lti','OAuth.php',89],['mod/lti','OAuth.php',244],['mod/lti','OAuth.php',499],['repository/equella','lib.php',42],['lib/phpexcel/PHPExcel/Worksheet','PageMargins.php',80],['backup/cc/cc_lib','cc_converter_quiz.php',33],['lib/horde/framework/Horde/Imap/Client/Interaction','Pipeline.php',60],['lib/phpexcel/PHPExcel/Shared/trend','polynomialBestFitClass.php',199],['backup/util/helper','restore_decode_processor.class.php',47],['backup/util/helper','restore_decode_processor.class.php',182],['cache/classes','helper.php',90],['lib/simplepie/library/SimplePie','Credit.php',81],['lib/classes','chart_series.php',62],['lib/classes/dml','recordset_walk.php',64],['lib/google/src/Google/Service','Webmasters.php',47],['lib/tcpdf/include/barcodes','qrcode.php',631],['backup/moodle2','backup_settingslib.php',42],['backup/moodle2','backup_settingslib.php',138],['lib/spout/src/Spout/Writer/XLSX/Helper','SharedStringsHelper.php',40],['course/tests/fixtures','course_capability_assignment.php',60],['mod/forum/classes','subscriber_selector_base.php',53],['lib','blocklib.php',54],['lib','blocklib.php',152],['report/loglive/classes','table_log.php',50],['lib','navigationlib.php',147],['lib','navigationlib.php',1015],['lib','navigationlib.php',2825],['lib','navigationlib.php',3086],['lib','navigationlib.php',3412],['lib','navigationlib.php',3459],['lib','navigationlib.php',4888],['lib','navigationlib.php',5070],['lib/phpexcel/PHPExcel/Shared/JAMA','CholeskyDecomposition.php',41],['grade/report/history/classes/output','user_button.php',40],['user/filters','courserole.php',34],['lib/phpexcel/PHPExcel','IOFactory.php',69],['lib/lessphp/Tree','Color.php',15],['lib/phpexcel/PHPExcel/Worksheet','MemoryDrawing.php',70],['lib/adodb/drivers','adodb-vfp.inc.php',72],['lib/horde/framework/Horde/Support','Backtrace.php',20],['lib/google/src/Google/Service','Clouddebugger.php',50],['lib/horde/framework/Horde/Exception','NotFound.php',15],['admin/tool/lp/classes/output','user_competency_course_navigation.php',55],['lib/lessphp/Tree','UnicodeDescriptor.php',14],['lib/phpexcel/PHPExcel/Worksheet','PageSetup.php',277],['grade/report/singleview/classes/local/ui','bulk_insert.php',40],['lib','mathslib.php',45],['lib/filestorage','tgz_extractor.php',119],['lib/horde/framework/Horde/Imap/Client/Interaction/Command','Continuation.php',42],['lib/horde/framework/Horde/Imap/Client','Exception.php',247],['filter/emoticon/tests','filter_test.php',68],['mnet/xmlrpc','xmlparser.php',15],['lib/spout/src/Spout/Reader/XLSX','Sheet.php',31],['admin/roles/classes','capability_table_base.php',51],['lib/simplepie/library/SimplePie','Item.php',82],['lib/form','selectgroups.php',57],['auth/shibboleth','auth.php',38],['admin/tool/langimport/classes','controller.php',48],['lib/form','warning.php',49],['lib/filestorage','stored_file.php',63],['grade/grading/form/guide','guideeditor.php',49],['lib/pear/HTML/QuickForm','group.php',80],['backup/moodle2','restore_subplugin.class.php',45],['grade/export','lib.php',60],['grade/export','lib.php',625],['lib/phpexcel/PHPExcel/Style','NumberFormat.php',98],['backup/moodle2','backup_section_task.class.php',40],['lib/htmlpurifier/HTMLPurifier','Config.php',100],['lib','flickrlib.php',53],['mod/assign/classes/output','grading_app.php',59],['grade/report/singleview/classes/local/ui','grade_attribute_format.php',47],['user/profile/field/menu','field.class.php',39],['lib/spout/src/Spout/Writer/Common/Internal','AbstractWorkbook.php',30],['lib/portfolio','exporter.php',113],['lib','ddllib.php',80],['lib','ddllib.php',93],['lib','ddllib.php',107],['lib','ddllib.php',126],['lib','ddllib.php',140],['lib/horde/framework/Horde/Crypt','Blowfish.php',54],['lib/horde/framework/Horde','Secret.php',48],['lib/htmlpurifier/HTMLPurifier/AttrDef','Integer.php',36],['lib/classes/update','info.php',48],['lib/htmlpurifier/HTMLPurifier/ConfigSchema','ValidatorAtom.php',31],['lib/lessphp/Tree','Anonymous.php',21],['admin/tool/lp/classes','course_competencies_form_element.php',43],['lib/lessphp/Tree','Comment.php',17],['auth/cas/CAS/CAS','OutOfSequenceBeforeAuthenticationCallException.php',47],['question/type/calculatedsimple','edit_calculatedsimple_form.php',72],['lib/adodb/drivers','adodb-mysql.inc.php',54],['lib/adodb/drivers','adodb-mysql.inc.php',717],['lib/adodb/drivers','adodb-mysql.inc.php',880],['enrol/ldap','lib.php',43],['mod/quiz/report/statistics','statistics_table.php',45],['lib/form','listing.php',68],['lib/google/src/Google/Service','Container.php',43],['mod/quiz','accessmanager.php',45],['lib/classes/message/inbound','processing_failed_exception.php',36],['blocks/online_users/classes','fetcher.php',45],['lib/pear/HTML/QuickForm','checkbox.php',48],['auth/cas/CAS/CAS','OutOfSequenceBeforeProxyException.php',48],['mod/lti/service/toolproxy/classes/local/service','toolproxy.php',41],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','URI.php',15],['lib/classes','chart_axis.php',65],['mod/glossary/classes','entry_query_builder.php',83],['mod/feedback/item/label','lib.php',26],['lib/adodb/drivers','adodb-mssqlnative.inc.php',131],['lib/adodb/drivers','adodb-mssqlnative.inc.php',847],['lib/adodb/drivers','adodb-mssqlnative.inc.php',1099],['lib/horde/framework/Horde/Imap/Client','Ids.php',78],['lib/form','editor.php',62],['lib','environmentlib.php',1258],['mod/workshop','fileinfolib.php',43],['mod/workshop','fileinfolib.php',198],['mod/feedback/classes','templates_table.php',39],['tag/classes','manage_table.php',44],['lib/adodb/drivers','adodb-odbc_db2.inc.php',115],['lib/adodb/drivers','adodb-odbc_db2.inc.php',309],['backup/cc/cc_lib/gral_lib','cssparser.php',21],['lib/horde/framework/Horde/Support','Array.php',21],['lib/google/src/Google/Service','GroupsMigration.php',40],['admin/tool/lp/classes/output','user_evidence_list_page.php',61],['lib/google/src/Google/Service','Audit.php',39],['lib/simplepie/library/SimplePie','File.php',68],['lib/horde/framework/Horde/Imap/Client','Mailbox.php',62],['enrol/lti/classes','manage_table.php',62],['lib/simplepie/library/SimplePie/Content/Type','Sniffer.php',69],['question/type','questionbase.php',124],['question/type','questionbase.php',438],['question/type','questionbase.php',531],['question/type','questionbase.php',750],['question/type','questionbase.php',835],['question/type','questionbase.php',868],['question/type','questionbase.php',914],['question/type','questionbase.php',1013],['question/type/ddimageortext','question.php',64],['question/type/ddimageortext','question.php',122],['lib','excellib.class.php',47],['lib','excellib.class.php',155],['lib','excellib.class.php',456],['lib/minify/lib','CSSmin.php',43],['lib/dml','moodle_temptables.php',51],['lib/minify/lib/Minify/Cache','ZendPlatform.php',23],['backup/util/xml/parser','progressive_parser.class.php',79],['backup/util/xml/parser','progressive_parser.class.php',305],['blocks/rss_client/classes/output','block.php',47],['question/type/ddmarker','question.php',417],['question/type/ddmarker','question.php',469],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Percentage.php',18],['admin/tool/lp/classes/output','user_competency_summary_in_course.php',51],['backup/util/helper','convert_helper.class.php',378],['lib/classes/update','validator.php',265],['lib/lessphp/Tree','Attribute.php',16],['admin/tool/generator/classes','backend.php',84],['backup/util/loggers','file_logger.class.php',35],['lib/adodb','adodb-exceptions.inc.php',30],['lib/google/src/Google','Client.php',70],['user/filters','profilefield.php',36],['backup/util/helper','restore_inforef_parser_processor.class.php',37],['cache/tests/fixtures','lib.php',326],['mod/lti/service/profile/classes/local/resource','profile.php',43],['competency/classes','invalid_persistent_exception.php',38],['backup/util/plan','backup_plan.class.php',36],['backup/util/plan','backup_plan.class.php',130],['lib/phpexcel/PHPExcel/Writer/Excel2007','WriterPart.php',63],['backup/util/settings','setting_dependency.class.php',68],['backup/util/settings','setting_dependency.class.php',175],['backup/util/settings','setting_dependency.class.php',328],['backup/util/settings','setting_dependency.class.php',439],['backup/util/settings','setting_dependency.class.php',465],['backup/util/settings','setting_dependency.class.php',491],['backup/util/settings','setting_dependency.class.php',556],['backup/util/xml','xml_writer.class.php',57],['backup/util/xml','xml_writer.class.php',284],['enrol/imsenterprise','locallib.php',38],['enrol/imsenterprise','locallib.php',115],['lib/dml','moodle_database.php',139],['search/classes','base.php',69],['admin/tool/lp/classes/output','competency_summary.php',54],['lib','upgradelib.php',45],['lib','upgradelib.php',61],['lib','upgradelib.php',76],['lib','upgradelib.php',94],['lib','upgradelib.php',111],['lib/htmlpurifier/HTMLPurifier/AttrTransform','NameSync.php',11],['mod/workshop/form/rubric','lib.php',105],['grade','lib.php',103],['grade','lib.php',927],['grade','lib.php',1089],['grade','lib.php',2053],['grade','lib.php',2213],['lib/horde/framework/Horde/Imap/Client/Data','Acl.php',32],['lib/phpexcel/PHPExcel/Reader/Excel5','RC4.php',35],['lib/google/src/Google/Service','Datastore.php',46],['admin/tool/lpmigrate/classes','framework_processor.php',98],['lib/dtl','database_importer.php',61],['lib/horde/framework/Horde/Imap/Client/Password','Xoauth2.php',44],['badges/lib','awardlib.php',55],['backup/util/helper','backup_array_iterator.class.php',39],['admin/tool/monitor/classes','subscription.php',43],['question/type/calculated','edit_calculated_form.php',51],['lib/spout/src/Spout/Reader/XLSX/Helper/SharedStringsCaching','FileBasedStrategy.php',57],['lib/form','datetimeselector.php',72],['lib/horde/framework/Horde/Imap/Client','Base.php',153],['lib/classes','collator.php',58],['admin/tool/lp/classes','course_competency_statistics.php',48],['lib/google/src/Google/Service','Storage.php',57],['lib/spout/src/Spout/Reader/CSV','SheetIterator.php',28],['lib/lessphp/Tree','Paren.php',14],['mod/lti/classes','service_exception_handler.php',63],['lib/tcpdf/include/barcodes','pdf417.php',523],['mod/assign/feedback/offline','importgradeslib.php',66],['lib/filestorage','file_exceptions.php',36],['lib/filestorage','file_exceptions.php',57],['lib/filestorage','file_exceptions.php',89],['lib/filestorage','file_exceptions.php',108],['lib/filestorage','file_exceptions.php',129],['lib/horde/framework/Horde/Mail/Transport','Smtp.php',100],['lib/htmlpurifier/HTMLPurifier/ConfigSchema/Interchange','Id.php',17],['question/engine/upgrade','upgradelib.php',283],['question/engine/upgrade','upgradelib.php',384],['question/type/numerical','question.php',323],['lib/pear/PEAR','Exception.php',107],['course/format','renderer.php',44],['lib/dml','oci_native_moodle_recordset.php',34],['question/behaviour','behaviourtypebase.php',133],['lib/pear/HTML','QuickForm.php',246],['lib/pear/HTML','QuickForm.php',1979],['backup/util/structure','base_atom.class.php',41],['backup/util/structure','base_atom.class.php',114],['backup/util/structure','base_atom.class.php',135],['backup/util/structure','base_atom.class.php',156],['lib/horde/framework/Horde/Imap/Client/Data','BaseSubject.php',39],['lib/google/src/Google/Auth','LoginTicket.php',37],['lib/adodb/drivers','adodb-csv.inc.php',41],['lib/adodb/drivers','adodb-csv.inc.php',196],['user/filters','yesno.php',33],['mod/wiki/parser','parser.php',98],['lib/htmlpurifier/HTMLPurifier/Token','Comment.php',19],['lib/phpexcel/PHPExcel/Calculation','FormulaParser.php',87],['backup/cc/cc_lib','cc_assesment_truefalse.php',27],['lib/htmlpurifier/HTMLPurifier','Encoder.php',10],['admin/tool/lpmigrate/classes/form','migrate_framework.php',45],['backup/util/xml/parser/tests','parser_test.php',797],['lib/htmlpurifier/HTMLPurifier/AttrTransform','EnumToCSS.php',34],['lib/tests','medialib_test.php',644],['lib/google/src/Google/Service','QPXExpress.php',39],['tag/classes/output','tagname.php',41],['lib/mustache/src/Mustache','Context.php',20],['lib/adodb/drivers','adodb-oracle.inc.php',32],['lib/adodb/drivers','adodb-oracle.inc.php',224],['backup/moodle2','restore_section_task.class.php',42],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Composite.php',25],['lib/htmlpurifier/HTMLPurifier/AttrTransform','Nofollow.php',16],['mod/forum/classes/output','forum_post.php',110],['admin/tool/assignmentupgrade','locallib.php',50],['admin/tool/assignmentupgrade','locallib.php',93],['repository/googledocs','lib.php',65],['cache/stores/memcache','lib.php',120],['lib/filestorage','file_storage.php',78],['admin/tool/monitor/classes/output/managerules','renderable.php',56],['mod/lti/service/toolsettings/classes/local/resource','linksettings.php',45],['lib/form','duration.php',55],['lib','outputlib.php',480],['lib','outputlib.php',2038],['filter/tex','latex.php',13],['backup/moodle2','backup_course_task.class.php',39],['lib/adodb','adodb.inc.php',310],['lib/adodb','adodb.inc.php',3035],['lib/adodb','adodb.inc.php',3160],['lib/adodb','adodb.inc.php',3242],['lib/adodb','adodb.inc.php',4353],['lib/horde/framework/Horde/Support','Randomid.php',26],['lib/google/src/Google/Logger','File.php',51],['admin/roles/classes','allow_role_page.php',37],['mod/quiz/report/overview','overview_table.php',41],['lib/lessphp/Tree','Keyword.php',17],['lib/htmlpurifier/HTMLPurifier/Node','Comment.php',19],['question/type/ddmarker','questiontype.php',48],['mod/folder','renderer.php',159],['lib','portfoliolib.php',101],['tag/classes/output','tagcollsearchable.php',40],['webservice/soap/classes','wsdl.php',88],['lib/lessphp/Exception','Parser.php',30],['badges','renderer.php',973],['badges','renderer.php',1014],['badges','renderer.php',1078],['badges','renderer.php',1111],['badges','renderer.php',1137],['competency/classes/external','exporter.php',56],['mod/lti/service/toolproxy/classes/local/resource','toolproxy.php',47],['lib/google/src/Google/Service','Genomics.php',63],['lib/phpexcel/PHPExcel/Writer','PDF.php',38],['lib/phpexcel/PHPExcel/Shared/trend','exponentialBestFitClass.php',125],['lib/google/src/Google/Service','Games.php',60],['backup/converter/moodle1','lib.php',725],['backup/converter/moodle1','lib.php',865],['backup/converter/moodle1','lib.php',1145],['backup/converter/moodle1','lib.php',1190],['backup/converter/moodle1','lib.php',1480],['backup/util/helper','restore_logs_processor.class.php',45],['backup/util/helper','restore_logs_processor.class.php',141],['lib/htmlpurifier/HTMLPurifier/AttrTransform','Input.php',14],['lib/google/src/Google/Service','Licensing.php',40],['mod/workshop/form/comments','lib.php',99],['backup/util/settings/section','section_backup_setting.class.php',25],['lib/htmlpurifier/HTMLPurifier','Doctype.php',48],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Font.php',22],['lib/google/src/Google/Service','Fitness.php',58],['blocks/private_files','renderer.php',83],['lib/phpexcel/PHPExcel/Worksheet','ColumnCellIterator.php',51],['enrol/flatfile','adminlib.php',35],['lib/xmldb','xmldb_object.php',55],['lib/google/src/Google/Service','Reports.php',47],['question/classes/statistics/responses','analysis_for_actual_response.php',70],['auth/pam','auth.php',53],['lib/horde/framework/Horde','Stream.php',50],['comment','lib.php',100],['lib/htmlpurifier/HTMLPurifier','URIParser.php',10],['lib/htmlpurifier/HTMLPurifier/Node','Text.php',35],['lib/phpexcel/PHPExcel/Worksheet','RowDimension.php',53],['lib/google/src/Google/Service','Gmail.php',64],['lib/google/src/Google/Service','Taskqueue.php',44],['lib/minify/lib/Minify','ImportProcessor.php',48],['lib/horde/framework/Horde/Mime','Related.php',32],['blocks','moodleblock.class.php',111],['lib/tcpdf','tcpdf_parser.php',92],['backup/util/plan','restore_structure_step.class.php',46],['blocks/rss_client/classes/output','channel_image.php',61],['lib/pear/HTML/QuickForm','hierselect.php',105],['question/type/numerical/tests','form_test.php',40],['badges/lib','backpacklib.php',40],['mod/workshop/allocation/manual','lib.php',51],['mod/quiz/report/responses','last_responses_table.php',39],['lib/simplepie','autoloader.php',62],['lib/spout/src/Spout/Common/Helper','StringHelper.php',21],['lib/phpexcel/PHPExcel/Worksheet','BaseDrawing.php',121],['lib/pear/Crypt','CHAP.php',82],['lib/pear/Crypt','CHAP.php',170],['lib/pear/Crypt','CHAP.php',424],['lib/spout/src/Spout/Writer/Common/Helper','AbstractStyleHelper.php',22],['backup/util/xml/parser/processors','progressive_parser_processor.class.php',57],['mod/quiz/classes/question','qubaids_for_users_attempts.php',37],['lib/spout/src/Spout/Reader/XLSX','RowIterator.php',63],['lib/phpexcel/PHPExcel/Reader/Excel5','Escher.php',77],['lib/simplepie/library/SimplePie','gzdecode.php',186],['mod/wiki','renderer.php',540],['lib/adodb','adodb-active-recordx.inc.php',138],['availability/classes','result.php',46],['lib','accesslib.php',5352],['lib','accesslib.php',5897],['lib','accesslib.php',6167],['lib','accesslib.php',6408],['lib','accesslib.php',6595],['lib','accesslib.php',6827],['lib','accesslib.php',7049],['lib','accesslib.php',7291],['lib/phpexcel/PHPExcel/Shared/OLE','PPS.php',110],['grade/grading/form','lib.php',82],['grade/grading/form','lib.php',766],['question/engine','questionusage.php',78],['question/engine','questionusage.php',973],['auth/manual','auth.php',46],['question/engine/upgrade','behaviourconverters.php',78],['mod/wiki/diff','diff_nwiki.php',35],['mod/wiki/diff','diff_nwiki.php',50],['mod/wiki/diff','diff_nwiki.php',63],['mod/wiki/diff','diff_nwiki.php',76],['mod/wiki/diff','diff_nwiki.php',495],['mod/wiki/diff','diff_nwiki.php',640],['mod/wiki/diff','diff_nwiki.php',850],['mod/wiki/diff','diff_nwiki.php',901],['mod/wiki/diff','diff_nwiki.php',953],['lib/adodb/drivers','adodb-proxy.inc.php',28],['lib/classes/lock','file_lock_factory.php',57],['lib/google/src/Google/Auth','OAuth2.php',55],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','Pixels.php',17],['lib/filebrowser','file_info_context_module.php',47],['auth/none','auth.php',34],['lib/simplepie/library/SimplePie/Cache','Base.php',70],['lib/htmlpurifier/HTMLPurifier','Queue.php',24],['lib/horde/framework/Horde/Text','Flowed.php',75],['admin/tool/log/store/legacy/classes/log','store.php',33],['lib/mustache/src/Mustache','HelperCollection.php',19],['backup/util/structure','backup_structure_processor.class.php',45],['backup/util/structure','backup_structure_processor.class.php',133],['admin/tool/lp/classes/output','related_competencies.php',47],['mod/quiz/classes/question/bank','custom_view.php',44],['files','renderer.php',1083],['lib/form','text.php',47],['lib/phpexcel/PHPExcel/Shared/trend','bestFitClass.php',398],['backup/cc','cc112moodle.php',59],['admin/tool/cohortroles/classes/output','cohort_role_assignments_table.php',45],['lib/horde/framework/Horde/Imap/Client/Data','Envelope.php',46],['lib/google/src/Google/Service','Logging.php',39],['lib/lessphp/Tree','Expression.php',16],['mod/lti/classes/local/ltiservice','service_base.php',63],['lib/phpexcel/PHPExcel/Reader','HTML.php',118],['search/engine/solr/classes','schema.php',60],['backup/util/xml/parser/processors','simplified_parser_processor.class.php',46],['lib/htmlpurifier/HTMLPurifier','UnitConverter.php',50],['lib/adodb/drivers','adodb-ado5.inc.php',42],['lib/adodb/drivers','adodb-ado5.inc.php',380],['mod/assign/feedback/editpdf/classes','comment.php',58],['cache/classes','interfaces.php',473],['lib/phpexcel/PHPExcel/Worksheet','Protection.php',157],['repository/merlot','lib.php',37],['lib/adodb/drivers','adodb-firebird.inc.php',69],['backup/util/settings','backup_setting.class.php',43],['lib/adodb/drivers','adodb-fbsql.inc.php',28],['lib/adodb/drivers','adodb-fbsql.inc.php',167],['mnet/xmlrpc','serverlib.php',674],['webservice/soap','lib.php',45],['admin/tool/log/store/database/classes/log','store.php',47],['lib/google/src/Google/Service','Doubleclicksearch.php',43],['lib/form','passwordunmask.php',46],['lib/lessphp/Tree','Variable.php',20],['report/log/classes','renderable.php',96],['mod/lti/service/toolsettings/classes/local/resource','systemsettings.php',43],['question/classes/bank','view.php',70],['grade/report/singleview/classes/local/ui','range.php',38],['lib/simplepie/library/SimplePie/Cache','MySQL.php',80],['admin/roles/classes','define_role_table_basic.php',31],['backup/cc/cc_lib','cc_converter_resource.php',28],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Mongo.php',78],['blocks/rss_client','editfeed.php',36],['admin/tool/lpmigrate/classes/output','migrate_framework_results.php',55],['blocks/lp/classes/output','competencies_to_review_page.php',49],['lib/horde/framework/Horde/Crypt/Blowfish/Php','Base.php',318],['backup/util/loggers','base_logger.class.php',42],['backup/util/loggers','base_logger.class.php',187],['mod/assign/feedback/file','renderable.php',44],['backup/cc/cc_lib','cc_utils.php',313],['backup/cc/cc_lib','cc_utils.php',381],['backup/cc/cc_lib','cc_utils.php',437],['lib/adodb/drivers','adodb-db2.inc.php',66],['lib/adodb/drivers','adodb-db2.inc.php',731],['lib/adodb','adodb-xmlschema03.inc.php',136],['lib/adodb','adodb-xmlschema03.inc.php',270],['lib/adodb','adodb-xmlschema03.inc.php',678],['lib/adodb','adodb-xmlschema03.inc.php',823],['lib/adodb','adodb-xmlschema03.inc.php',1081],['lib/adodb','adodb-xmlschema03.inc.php',1399],['repository/youtube','lib.php',58],['lib/phpexcel/PHPExcel/Writer/PDF','mPDF.php',38],['auth/cas/CAS/CAS','GracefullTerminationException.php',48],['lib/adodb/drivers','adodb-sybase_ase.inc.php',25],['lib/adodb/drivers','adodb-sybase_ase.inc.php',115],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Background.php',20],['lib/adodb','adodb-memcache.lib.inc.php',53],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','FrameTarget.php',19],['lib/phpexcel/PHPExcel/Writer','Excel2007.php',118],['lib/minify/lib/MrClay/Cli','Arg.php',82],['lib/phpexcel/PHPExcel/Worksheet/AutoFilter','Column.php',117],['lib/simplepie','moodle_simplepie.php',50],['lib/simplepie','moodle_simplepie.php',121],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','FontFamily.php',11],['lib/simplepie/library/SimplePie/Decode/HTML','Entities.php',80],['lib/spout/src/Spout/Common/Helper','FileSystemHelper.php',22],['lib/pear/HTML/QuickForm','button.php',37],['lib/google/src/Google/Service','Autoscaler.php',46],['lib/mustache/src/Mustache','Engine.php',63],['lib/google/src/Google/Http','MediaFileUpload.php',75],['lib/phpexcel/PHPExcel','Worksheet.php',327],['mod/assign','gradingtable.php',68],['lib/google/src/Google/Service','AdExchangeSeller.php',53],['question/engine/tests','helpers.php',582],['question/engine/tests','helpers.php',594],['question/engine/tests','helpers.php',608],['question/engine/tests','helpers.php',623],['question/engine/tests','helpers.php',637],['question/engine/tests','helpers.php',652],['question/engine/tests','helpers.php',665],['question/engine/tests','helpers.php',676],['question/engine/tests','helpers.php',1196],['repository/webdav','lib.php',38],['tag/classes/output','tagisstandard.php',39],['lib/google/src/Google/Service','Appsactivity.php',52],['badges/criteria','award_criteria_course.php',47],['lib','searchlib.php',53],['lib','searchlib.php',95],['lib/lessphp/Output','Mapped.php',39],['availability/classes','tree.php',118],['lib/lessphp/Tree','Javascript.php',20],['lib/horde/framework/Horde/Imap/Client','Cache.php',53],['lib/htmlpurifier/HTMLPurifier','AttrCollections.php',16],['lib/mustache/src/Mustache/Loader','InlineLoader.php',56],['repository/url','lib.php',46],['lib/phpexcel/PHPExcel/CachedObjectStorage','SQLite3.php',293],['lib/lessphp/Tree','Ruleset.php',45],['tag/classes/output','tagindex.php',52],['backup/util/ui','backup_ui_stage.class.php',43],['backup/util/ui','backup_ui_stage.class.php',79],['backup/util/ui','backup_ui_stage.class.php',234],['backup/util/ui','backup_ui_stage.class.php',387],['backup/util/ui','backup_ui_stage.class.php',516],['backup/util/ui','backup_ui_stage.class.php',575],['grade/report/singleview/classes/local/screen','screen.php',67],['lib/tcpdf/include/barcodes','datamatrix.php',229],['lib/horde/framework/Horde/Imap/Client/Socket','Catenate.php',37],['lib/google/src/Google/Service','Prediction.php',51],['lib/classes/output','notification.php',101],['lib/lessphp/Tree','Unit.php',16],['backup/util/settings/course','course_backup_setting.class.php',25],['lib/spout/src/Spout/Writer','AbstractWriter.php',68],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','DenyElementDecorator.php',21],['lib','outputfactories.php',120],['lib','outputfactories.php',367],['lib','dtllib.php',66],['mod/assign','assignmentplugin.php',50],['mnet/service/enrol','locallib.php',48],['mnet/service/enrol','locallib.php',466],['mnet/service/enrol','locallib.php',537],['backup/cc/cc_lib','cc_version11.php',57],['availability/condition/completion/classes','condition.php',48],['admin/roles/classes','allow_override_page.php',31],['mod/workshop/allocation','lib.php',103],['lib/htmlpurifier/HTMLPurifier/AttrTransform','BoolToCSS.php',24],['lib/horde/framework/Horde/Imap/Client/Base','Mailbox.php',59],['lib/spout/src/Spout/Reader/Wrapper','SimpleXMLElement.php',23],['lib/google/src/Google/Service','SiteVerification.php',43],['lib/phpexcel/PHPExcel/Calculation','Function.php',64],['availability/classes','capability_checker.php',49],['lib/google/src/Google/Service','Drive.php',76],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Decorator.php',12],['lib/phpexcel/PHPExcel/Shared/JAMA','LUDecomposition.php',56],['lib','setuplib.php',67],['lib','setuplib.php',113],['lib','setuplib.php',165],['lib','setuplib.php',184],['lib','setuplib.php',199],['lib','setuplib.php',219],['lib','setuplib.php',249],['lib','setuplib.php',271],['lib','setuplib.php',287],['lib','setuplib.php',309],['lib','setuplib.php',328],['lib','setuplib.php',346],['lib/form','textarea.php',50],['webservice/soap','locallib.php',57],['availability/classes','info.php',55],['lib/tcpdf','tcpdf_barcodes_1d.php',58],['lib/spout/src/Spout/Reader/XLSX/Helper','SheetHelper.php',49],['filter/urltolink/tests','filter_test.php',209],['lib/simplepie/library/SimplePie','Category.php',81],['admin/tool/lp/classes/output','manage_competencies_page.php',65],['lib/markdown','Markdown.php',99],['mod/assign','locallib.php',160],['mod/assign','locallib.php',8131],['lib/adodb/drivers','adodb-ldap.inc.php',48],['lib/adodb/drivers','adodb-ldap.inc.php',297],['lib/editor/tinymce/plugins/spellchecker/classes/utils','JSON.php',32],['lib/editor/tinymce/plugins/spellchecker/classes/utils','JSON.php',373],['lib','odslib.class.php',42],['lib','odslib.class.php',124],['lib','odslib.class.php',422],['lib','odslib.class.php',827],['lib/horde/framework/Horde/Crypt/Blowfish','Base.php',56],['lib/phpexcel/PHPExcel/Reader/Excel5','MD5.php',36],['grade/report/singleview/classes/local/ui','checkbox_attribute.php',42],['lib/lessphp/Tree','Quoted.php',20],['mod/lesson','mod_form.php',36],['blocks/rss_client/classes/output','item.php',89],['lib/google/src/Google/Service','IdentityToolkit.php',38],['lib/horde/framework/Horde/Stream','Temp.php',25],['tag/classes/output','tagflag.php',39],['admin/tool/monitor/classes/output/managesubs','rules.php',56],['lib/htmlpurifier/HTMLPurifier/ChildDef','Table.php',57],['lib/behat/form_field','behat_form_field.php',59],['lib/phpexcel/PHPExcel/Worksheet/Drawing','Shadow.php',93],['lib/spout/src/Spout/Reader/ODS/Helper','CellValueFormatter.php',42],['tag/classes','collections_table.php',36],['lib/google/src/Google/Service','Spectrum.php',38],['lib/htmlpurifier/HTMLPurifier/AttrTransform','Length.php',19],['admin/tool/lp/classes/output','user_competency_summary.php',49],['lib/phpexcel/PHPExcel','NamedRange.php',65],['lib/pear/HTML/QuickForm','image.php',36],['lib/htmlpurifier/HTMLPurifier/AttrDef/URI','Host.php',15],['lib/form','searchableselector.php',44],['lib/phpexcel/PHPExcel/Shared/JAMA','SingularValueDecomposition.php',52],['lib/adodb/drivers','adodb-oci805.inc.php',51],['lib/google/src/Google','Service.php',28],['lib/google/src/Google/IO','Abstract.php',50],['lib/spout/src/Spout/Writer/ODS/Internal','Worksheet.php',46],['lib/form','header.php',45],['question/type/randomsamatch/tests','helper.php',121],['mod/workshop/form/accumulative','lib.php',99],['lib/phpexcel/PHPExcel/Shared/trend','linearBestFitClass.php',89],['lib/form','submit.php',41],['report/log/classes','table_log.php',45],['admin/roles/classes','admins_potential_selector.php',30],['question/classes/engine/variants','least_used_strategy.php',51],['question/engine/upgrade','logger.php',42],['question/engine/upgrade','logger.php',87],['mod/data','lib.php',68],['mod/data','lib.php',2278],['mod/data','lib.php',2552],['mod/data','lib.php',2573],['backup/util/xml/parser/processors','grouped_parser_processor.class.php',67],['lib/horde/framework/Horde/Imap/Client/Exception','NoSupportPop3.php',26],['mod/scorm','renderer.php',129],['lib/phpunit/classes','advanced_testcase.php',45],['lib/spout/src/Spout/Reader/ODS','SheetIterator.php',41],['backup/cc/cc_lib','cc_version1.php',57],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','LinkTypes.php',21],['tag/classes','areas_table.php',36],['lib/phpexcel/PHPExcel/Shared/trend','powerBestFitClass.php',125],['lib/portfolio/formats/leap2a','lib.php',62],['lib/portfolio/formats/leap2a','lib.php',258],['lib/portfolio/formats/leap2a','lib.php',503],['lib/google/src/Google/Service','Proximitybeacon.php',42],['lib/pear','PEAR.php',139],['lib/pear','PEAR.php',818],['competency/classes/external','persistent_exporter.php',42],['lib/google/src/Google/Service','Groupssettings.php',40],['lib/phpexcel/PHPExcel/Reader','CSV.php',87],['lib/horde/framework/Horde/Exception','LastError.php',16],['lib/google/src/Google/Service','Directory.php',134],['lib/google/src/Google/Service','Fusiontables.php',48],['question/type/missingtype','edit_missingtype_form.php',38],['lib/google/src/Google/Service','AdSenseHost.php',49],['lib/lessphp/Tree','Directive.php',20],['auth/ldap','auth.php',119],['auth/cas/CAS/CAS','CookieJar.php',46],['lib/phpexcel/PHPExcel/CachedObjectStorage','Wincache.php',245],['availability/condition/date/classes','condition.php',52],['lib/horde/framework/Horde/Mime','Mail.php',93],['lib','outputactions.php',60],['lib','outputactions.php',91],['lib','outputactions.php',148],['lib/horde/framework/Horde/Crypt/Blowfish','Mcrypt.php',47],['lib/classes','string_manager_standard.php',53],['repository/skydrive','microsoftliveapi.php',50],['user/filters','globalrole.php',35],['enrol/lti/ims-blti','OAuth.php',16],['enrol/lti/ims-blti','OAuth.php',32],['enrol/lti/ims-blti','OAuth.php',187],['enrol/lti/ims-blti','OAuth.php',451],['course/classes/output','course_module_name.php',46],['lib/google/src/Google/Service','Plus.php',52],['lib/horde/framework/Horde/Mime','Mdn.php',35],['lib/pear/HTML/QuickForm','html.php',36],['repository/s3','S3.php',193],['repository/s3','S3.php',2018],['repository/s3','S3.php',2374],['lib/spout/src/Spout/Reader/XLSX/Helper','SharedStringsHelper.php',39],['question/classes/bank/search','hidden_condition.php',42],['lib/htmlpurifier/HTMLPurifier/ChildDef','Empty.php',22],['lib/pear/HTML/QuickForm','element.php',73],['question/classes/statistics/responses','analysis_for_subpart.php',50],['admin/tool/log/classes','setting_managestores.php',30],['lib/google/src/Google/Service','Mirror.php',49],['lib/adodb/drivers','adodb-db2ora.inc.php',80],['lib/minify/lib/HTTP','Encoder.php',75],['mod/feedback/classes','completion.php',47],['admin/tool/uploadcourse/classes','processor.php',122],['lib/lessphp','Parser.php',78],['lib/adodb/drivers','adodb-sapdb.inc.php',36],['lib/adodb/drivers','adodb-sapdb.inc.php',179],['lib/ddl','sql_generator.php',175],['lib/google/src/Google/Service','AndroidEnterprise.php',51],['admin/tool/lp/classes/output','template_competencies_page.php',70],['lib/horde/framework/Horde/Support','ObjectStub.php',29],['mod/assignment/backup/moodle1','lib.php',223],['blocks','edit_form.php',47],['lib/simplepie/library/SimplePie/Cache','Memcache.php',81],['mod/quiz/report/statistics','statistics_question_table.php',49],['mod/workshop/form/numerrors','lib.php',102],['mod/quiz/classes','repaginate.php',49],['lib/classes/session','memcached.php',51],['lib/phpexcel/PHPExcel/Shared/OLE/PPS','Root.php',43],['lib/phpexcel/PHPExcel/Writer/PDF','Core.php',206],['mod/workshop','mod_form.php',43],['mod/assign/feedback/editpdf/fpdi','pdf_context.php',48],['availability/condition/profile/classes','condition.php',73],['lib/horde/framework/Horde/Imap/Client','DateTime.php',29],['auth/cas/CAS/CAS','Client.php',862],['lib/xhprof','xhprof_moodle.php',788],['lib/dtl','file_xml_database_exporter.php',36],['course','lib.php',3061],['lib/adodb/drivers','adodb-mssqlpo.inc.php',54],['lib/xmldb','xmldb_table.php',49],['lib/adodb/perf','perf-postgres.inc.php',92],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Filter.php',15],['question/type/ddmarker','shapes.php',40],['question/type/ddmarker','shapes.php',203],['question/type/ddmarker','shapes.php',267],['question/type/ddmarker','shapes.php',332],['question/type/ddmarker','shapes.php',470],['mod/lti/classes/local/ltiservice','response.php',58],['backup/util/helper','restore_users_parser_processor.class.php',43],['lib/pear/HTML','Common.php',79],['mod/glossary','locallib.php',481],['lib/adodb/perf','perf-mssqlnative.inc.php',70],['lib/adodb/perf','perf-mssql.inc.php',70],['backup/util/plan','base_plan.class.php',39],['backup/util/plan','base_plan.class.php',215],['backup/util/plan','restore_task.class.php',32],['backup/util/plan','restore_task.class.php',121],['lib/classes/event','base.php',124],['lib/form','checkbox.php',46],['admin/roles/classes','permissions_table.php',38],['lib/pear/HTML/QuickForm','submit.php',37],['auth/fc','auth.php',37],['enrol/ldap','settingslib.php',32],['enrol/ldap','settingslib.php',90],['enrol/ldap','settingslib.php',204],['lib/minify/lib/Minify/Cache','Memcache.php',22],['lib/lessphp/Tree','Condition.php',18],['admin/tool/lp/classes/output','plans_page.php',59],['lib/mustache/src/Mustache','Autoloader.php',19],['lib/spout/src/Spout/Writer/XLSX/Internal','Worksheet.php',52],['lib/phpexcel/PHPExcel','Comment.php',93],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','AlphaValue.php',6],['lib/lessphp/Tree','Url.php',17],['mod/lesson','override_form.php',58],['lib/form','button.php',45],['admin/tool/lp/classes/output','manage_templates_page.php',56],['lib/google/src/Google/Service','Playmoviespartner.php',44],['backup/util/ui','base_ui_stage.class.php',67],['backup/cc/cc_lib','cc_converters.php',75],['lib/dtl','database_mover.php',33],['enrol','locallib.php',125],['enrol','locallib.php',1256],['enrol','locallib.php',1379],['enrol','locallib.php',1430],['enrol','locallib.php',1463],['lib/htmlpurifier/HTMLPurifier','URI.php',58],['backup/moodle2','restore_course_task.class.php',41],['lib/htmlpurifier/HTMLPurifier/Printer','ConfigForm.php',40],['lib/htmlpurifier/HTMLPurifier/Printer','ConfigForm.php',221],['lib','xmlize.php',31],['lib','googleapi.php',52],['lib','googleapi.php',243],['grade/report/singleview/classes/local/ui','element.php',47],['lib/html2text','lib.php',43],['user/filters','lib.php',52],['user/filters','lib.php',272],['auth/cas/CAS/CAS/PGTStorage','Db.php',122],['lib/classes/lock','db_record_lock_factory.php',61],['lib/pear/HTML/QuickForm','link.php',47],['backup/cc/cc_lib','cc_asssesment.php',290],['backup/cc/cc_lib','cc_asssesment.php',345],['backup/cc/cc_lib','cc_asssesment.php',364],['backup/cc/cc_lib','cc_asssesment.php',415],['backup/cc/cc_lib','cc_asssesment.php',476],['backup/cc/cc_lib','cc_asssesment.php',486],['backup/cc/cc_lib','cc_asssesment.php',561],['backup/cc/cc_lib','cc_asssesment.php',585],['backup/cc/cc_lib','cc_asssesment.php',635],['backup/cc/cc_lib','cc_asssesment.php',668],['backup/cc/cc_lib','cc_asssesment.php',693],['backup/cc/cc_lib','cc_asssesment.php',788],['backup/cc/cc_lib','cc_asssesment.php',814],['backup/cc/cc_lib','cc_asssesment.php',838],['backup/cc/cc_lib','cc_asssesment.php',965],['backup/cc/cc_lib','cc_asssesment.php',971],['backup/cc/cc_lib','cc_asssesment.php',986],['backup/cc/cc_lib','cc_asssesment.php',1003],['backup/cc/cc_lib','cc_asssesment.php',1017],['backup/cc/cc_lib','cc_asssesment.php',1045],['backup/cc/cc_lib','cc_asssesment.php',1186],['backup/cc/cc_lib','cc_asssesment.php',1263],['backup/cc/cc_lib','cc_asssesment.php',1317],['backup/cc/cc_lib','cc_asssesment.php',1389],['backup/cc/cc_lib','cc_asssesment.php',1451],['backup/cc/cc_lib','cc_asssesment.php',1558],['backup/cc/cc_lib','cc_asssesment.php',1620],['backup/cc/cc_lib','cc_asssesment.php',1648],['backup/cc/cc_lib','cc_asssesment.php',1716],['backup/cc/cc_lib','cc_asssesment.php',2155],['backup/cc/cc_lib','cc_asssesment.php',2264],['backup/cc/cc_lib','cc_asssesment.php',2469],['lib/phpunit/classes','hint_resultprinter.php',37],['lib/horde/framework/Horde/Mail/Transport','Mail.php',53],['auth/pop3','auth.php',35],['lib/adodb/drivers','adodb-oci8.inc.php',106],['lib/adodb/drivers','adodb-oci8.inc.php',1539],['lib/adodb/drivers','adodb-oci8.inc.php',1805],['lib/classes/session','database.php',52],['backup/util/ui','restore_ui_components.php',81],['backup/util/ui','restore_ui_components.php',287],['backup/util/ui','restore_ui_components.php',382],['question/classes/bank/search','category_condition.php',60],['lib/google/src/Google/Auth','AssertionCredentials.php',53],['backup/util/plan','restore_plan.class.php',43],['backup/util/plan','restore_plan.class.php',203],['backup/util/xml/parser/processors','findpaths_parser_processor.class.php',35],['lib/phpexcel/PHPExcel/CalcEngine','Logger.php',63],['lib/jabber/XMPP','Log.php',67],['lib/horde/framework/Horde/Imap/Client/Exception','ServerResponse.php',44],['lib/lessphp/Tree','Assignment.php',15],['lib/dtl','string_xml_database_importer.php',34],['admin/tool/lp/classes/output','manage_competency_frameworks_page.php',62],['question/type/calculated','question.php',188],['question/type/calculated','question.php',303],['repository/recent','lib.php',39],['grade/report/singleview/classes/local/ui','text_attribute.php',42],['admin/webservice','lib.php',38],['lib','coursecatlib.php',194],['lib','coursecatlib.php',2782],['lib/google/src/Google/Service','Cloudtrace.php',43],['lib','filterlib.php',73],['lib','filterlib.php',377],['lib','filterlib.php',456],['lib/classes/lock','lock_factory.php',39],['lib/filebrowser','file_info_context_course.php',39],['lib/filebrowser','file_info_context_course.php',492],['lib/filebrowser','file_info_context_course.php',596],['lib/filebrowser','file_info_context_course.php',745],['enrol','renderer.php',426],['enrol','renderer.php',723],['question/classes/statistics/questions','calculated_for_subquestion.php',57],['backup/moodle2','backup_format_plugin.class.php',40],['admin/tool/lp/classes','course_competency_rule_form_element.php',45],['auth/cas/CAS/CAS','ProxyTicketException.php',46],['lib/phpunit/classes','basic_testcase.php',39],['lib/spout/src/Spout/Reader/ODS','RowIterator.php',49],['backup/util/dbops','backup_dbops.class.php',37],['admin/tool/customlang','locallib.php',44],['admin/tool/customlang','locallib.php',405],['admin/tool/customlang','locallib.php',471],['backup/util/structure','backup_optigroup_element.class.php',51],['mod/quiz/report/grading','gradingsettings_form.php',44],['backup/util/plan','restore_step.class.php',32],['backup/util/plan','restore_step.class.php',104],['lib/form','hidden.php',44],['repository/filesystem','lib.php',48],['backup/controller','backup_controller.class.php',68],['backup/controller','backup_controller.class.php',409],['backup/util/helper','restore_log_rule.class.php',62],['tag/classes','tag.php',77],['lib/htmlpurifier/HTMLPurifier/AttrTransform','SafeParam.php',27],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Db.php',38],['lib/spout/src/Spout/Writer/Style','StyleBuilder.php',19],['lib/dml','sqlsrv_native_moodle_database.php',53],['user/filters','date.php',40],['auth/nologin','auth.php',35],['lib/google/src/Google','Model.php',35],['lib/horde/framework/Horde/Imap/Client/Socket','ClientSort.php',37],['lib/horde/framework/Horde/Imap/Client/Exception','SearchCharset.php',34],['lib/horde/framework/Horde/Support','StringStream.php',30],['lib/adodb/drivers','adodb-mysqli.inc.php',66],['lib/adodb/drivers','adodb-mysqli.inc.php',887],['lib/adodb/drivers','adodb-mysqli.inc.php',1193],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','ImportantDecorator.php',21],['lib/form','questioncategory.php',46],['lib/mustache/src/Mustache','Template.php',29],['backup/util/structure','base_nested_element.class.php',44],['backup/util/structure','base_nested_element.class.php',258],['lib/google/src/Google/Logger','Abstract.php',123],['backup/cc/cc_lib','cc_general.php',38],['lib/phpexcel/PHPExcel','ReferenceHelper.php',58],['lib/pear/HTML/QuickForm','password.php',37],['lib/dml','moodle_transaction.php',40],['lib/phpexcel/PHPExcel/Reader','Excel2003XML.php',53],['lib/htmlpurifier/HTMLPurifier/AttrDef','Switch.php',29],['repository/flickr','lib.php',51],['lib/form','grading.php',57],['lib/classes/update','api.php',71],['backup/cc/cc_lib','cc_converter_lti.php',29],['backup/moodle2','backup_subplugin.class.php',44],['lib/portfolio','caller.php',67],['lib/classes/progress','display_if_slow.php',60],['lib/adodb/perf','perf-informix.inc.php',66],['lib/classes','chart_base.php',52],['lib/lessphp/Tree','Media.php',18],['lib/spout/src/Spout/Common/Escaper','XLSX.php',19],['grade/export/ods','grade_export_ods.php',24],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Length.php',23],['lib/google/src/Google/Service','Calendar.php',50],['lib/form','group.php',44],['lib/phpexcel/PHPExcel/Writer','OpenDocument.php',44],['lib/pear/HTML/QuickForm/Renderer','Object.php',75],['admin/tool/lp/classes/output','user_evidence_page.php',48],['lib/horde/framework/Horde/Imap/Client/Fetch','Results.php',54],['grade/export/xls','grade_export_xls.php',24],['lib/classes/output','mustache_pix_helper.php',43],['lib/horde/framework/Horde/Imap/Client/Mailbox','List.php',46],['lib/google/src/Google/Auth','ComputeEngine.php',35],['cache/stores/session','lib.php',131],['lib/mustache/src/Mustache/Logger','StreamLogger.php',44],['admin/tool/log/store/database/backup/moodle2','backup_logstore_database_nested_element.php',43],['user','renderer.php',220],['lib/htmlpurifier/HTMLPurifier/ChildDef','Required.php',23],['availability/condition/grade/classes','condition.php',46],['lib/lessphp/Tree','RulesetCall.php',14],['blocks/rss_client/classes/output','feed.php',75],['lib/form','select.php',47],['lib/htmlpurifier/HTMLPurifier','ContentSets.php',33],['lib/lessphp/Visitor','toCSS.php',13],['lib','outputfragmentrequirementslib.php',40],['backup/util/ui','restore_moodleform.class.php',34],['lib/google/src/Google/Service','Cloudbilling.php',43],['lib/google/src/Google/Service','PlusDomains.php',72],['lib','externallib.php',37],['lib','externallib.php',531],['lib','externallib.php',562],['lib','externallib.php',593],['lib','externallib.php',622],['lib','externallib.php',648],['lib','externallib.php',778],['lib','externallib.php',813],['lib','externallib.php',984],['lib','externallib.php',1177],['blog','locallib.php',71],['blog','locallib.php',564],['blog','locallib.php',847],['blog','locallib.php',892],['blog','locallib.php',965],['blog','locallib.php',1016],['blog','locallib.php',1041],['blog','locallib.php',1051],['blog','locallib.php',1063],['blog','locallib.php',1084],['lib/phpexcel/PHPExcel/Worksheet','ColumnDimension.php',53],['auth/cas','auth.php',39],['lib','lexer.php',41],['lib','lexer.php',145],['lib','lexer.php',217],['lib/phpexcel/PHPExcel/Shared/JAMA','QRDecomposition.php',48],['lib/google/src/Google/Service','Exception.php',34],['lib/htmlpurifier/HTMLPurifier','Printer.php',21],['tag/classes/output','tagcloud.php',49],['lib/google/src/Google/Service','Storagetransfer.php',44],['user/filters','select.php',46],['cache/stores/mongodb','lib.php',116],['admin/tool/lp/classes/output','course_competencies_page.php',73],['lib/google/src/Google/Cache','Null.php',28],['lib','graphlib.php',1176],['lib/phpexcel/PHPExcel/Style','Protection.php',49],['lib/google/src/Google/Service','GamesConfiguration.php',42],['repository/dropbox','locallib.php',46],['lib/phpexcel/PHPExcel/Style','Alignment.php',100],['lib/htmlpurifier/HTMLPurifier','Language.php',63],['cache/stores/file','lib.php',117],['tag/classes/output','tagareashowstandard.php',41],['question/type/multianswer','edit_multianswer_form.php',63],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','Bool.php',22],['mod/assign','renderable.php',41],['mod/assign','renderable.php',71],['mod/assign','renderable.php',103],['mod/assign','renderable.php',139],['mod/assign','renderable.php',191],['mod/assign','renderable.php',242],['mod/assign','renderable.php',291],['mod/assign','renderable.php',395],['mod/assign','renderable.php',531],['mod/assign','renderable.php',586],['mod/assign','renderable.php',670],['mod/assign','renderable.php',707],['mod/assign','renderable.php',747],['mod/assign','renderable.php',800],['mod/assign','renderable.php',854],['lib/form','selectwithlink.php',56],['backup/moodle2','backup_activity_task.class.php',45],['lib/phpmailer','class.phpmailer.php',633],['lib/horde/framework/Horde/Imap/Client/Data','AclRights.php',39],['auth/db','auth.php',36],['lib/lessphp/Tree','Value.php',14],['lib/form','course.php',62],['question/engine','questionattemptstep.php',97],['question/engine','questionattemptstep.php',608],['cohort','locallib.php',37],['cohort','locallib.php',101],['badges/criteria','award_criteria.php',127],['lib/adodb/perf','perf-mysql.inc.php',86],['cache/stores/memcached','lib.php',133],['grade/report/singleview/classes/local/ui','empty_element.php',38],['lib/google/src/Google/Service','AppState.php',40],['lib/adodb/drivers','adodb-odbc_oracle.inc.php',107],['lib/pear/HTML/QuickForm/Renderer','Default.php',139],['tag/classes/output','tag.php',46],['question','previewlib.php',122],['backup/util/loggers','database_logger.class.php',40],['mod/forum/classes','potential_subscriber_selector.php',47],['lib/htmlpurifier/HTMLPurifier/ConfigSchema','InterchangeBuilder.php',15],['lib/phpexcel/PHPExcel/Reader','SYLK.php',67],['lib/form','submitlink.php',47],['backup/util/dbops','restore_dbops.class.php',1788],['lib/xmldb','xmldb_index.php',56],['question','category_class.php',58],['question','category_class.php',160],['lib/google/src/Google/Service','Webfonts.php',38],['webservice/xmlrpc','locallib.php',41],['admin/roles/classes','check_users_selector.php',38],['lib/htmlpurifier/HTMLPurifier/AttrTransform','ImgSpace.php',24],['user/profile/field/checkbox','field.class.php',33],['lib/form','cancel.php',47],['lib/google/src/Google/Service','Resourceviews.php',57],['lib/phpexcel/PHPExcel/Style','Font.php',100],['lib/portfolio','plugin.php',445],['calendar','lib.php',2003],['calendar','lib.php',2774],['mod/wiki','pagelib.php',93],['mod/wiki','pagelib.php',380],['mod/wiki','pagelib.php',981],['mod/wiki','pagelib.php',1190],['mod/wiki','pagelib.php',2194],['mod/wiki','pagelib.php',2422],['tag/classes/output','tagfeed.php',43],['tag/classes/output','tagareaenabled.php',38],['backup/util/xml/parser/processors','selective_like_parser_processor.class.php',35],['mod/workshop','locallib.php',183],['mod/workshop','locallib.php',2976],['mod/workshop','locallib.php',3411],['mod/workshop','locallib.php',3647],['mod/workshop','locallib.php',3889],['mod/workshop','locallib.php',3975],['mod/workshop','locallib.php',4060],['mod/workshop','locallib.php',4079],['lib/form','advcheckbox.php',48],['backup/cc/cc_lib','cc_assesment_sfib.php',27],['cohort/classes/output','cohortidnumber.php',37],['lib/adodb/drivers','adodb-ado.inc.php',42],['lib/adodb/drivers','adodb-ado.inc.php',346],['lib/form','filepicker.php',53],['mod/assign','adminlib.php',41],['mod/assign','adminlib.php',102],['lib/tests/fixtures','test_renderer_factory.php',41],['backup/cc/cc_lib','cc_converter_label.php',28],['lib/htmlpurifier/HTMLPurifier','Lexer.php',152],['grade/report/singleview','lib.php',69],['backup/cc/cc_lib','cc_converter_page.php',28],['lib/google/src/Google/Logger','Psr.php',39],['lib/simplepie/library/SimplePie/HTTP','Parser.php',131],['backup/util/plan','backup_step.class.php',32],['backup/util/plan','backup_step.class.php',55],['lib/lessphp/Tree','Import.php',30],['lib/jabber/XMPP','XMPP_Old.php',45],['lib/phpexcel/PHPExcel/Worksheet','Drawing.php',37],['lib/google/src/Google/Service','Classroom.php',60],['lib/phpexcel/PHPExcel/Chart/Renderer','jpgraph.php',875],['admin/tool/lp/classes/external','competency_path_exporter.php',38],['cohort/classes/output','cohortname.php',37],['grade/report/overview','lib.php',76],['lib/horde/framework/Horde/Mail/Rfc822','Address.php',66],['admin/roles/classes','admins_existing_selector.php',30],['lib/phpunit/classes','arraydataset.php',45],['question/engine','questionattempt.php',166],['question/engine','questionattempt.php',1532],['question/engine','questionattempt.php',1618],['question/engine','questionattempt.php',1703],['lib/horde/framework/Horde/Support','Uuid.php',23],['lib/horde/framework/Horde/Imap/Client/Data/Format','Nil.php',27],['webservice/rest','lib.php',47],['lib/phpexcel/PHPExcel/Worksheet','HeaderFooterDrawing.php',79],['backup/util/xml/output','memory_xml_output.class.php',37],['repository/flickr_public','image.php',34],['mod/lti/classes/local/ltiservice','resource_base.php',62],['admin/tool/lp/classes/output','template_plans_table.php',53],['mod/quiz','mod_form.php',48],['lib/simplepie/library/SimplePie','Caption.php',98],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Multiple.php',33],['lib/htmlpurifier/HTMLPurifier','PercentEncoder.php',20],['lib/phpexcel/PHPExcel/Calculation','ExceptionHandler.php',30],['lib/htmlpurifier/HTMLPurifier/Token','Tag.php',33],['backup/moodle2','backup_theme_plugin.class.php',61],['mod/chat','chatd.php',78],['mod/chat','chatd.php',103],['lib/phpexcel/PHPExcel','DocumentSecurity.php',65],['lib/htmlpurifier/HTMLPurifier','URIDefinition.php',21],['lib/spout/src/Spout/Writer/XLSX/Internal','Workbook.php',45],['lib/phpexcel/PHPExcel/Shared','XMLWriter.php',49],['lib/lessphp/Tree','Operation.php',19],['lib/htmlpurifier/HTMLPurifier/Lexer','PH5P.php',461],['lib/htmlpurifier/HTMLPurifier/Lexer','PH5P.php',1699],['backup/cc/cc_lib','cc_converter_folder.php',28],['backup/util/helper','restore_roles_parser_processor.class.php',39],['lib/simplepie/library/SimplePie','Locator.php',68],['lib/google/src/Google/Service','SQLAdmin.php',50],['lib/lessphp/Tree','DetachedRuleset.php',15],['admin/tool/assignmentupgrade','upgradableassignmentstable.php',49],['backup/cc','validator.php',30],['backup/cc','validator.php',116],['backup/cc','validator.php',202],['backup/cc','validator.php',230],['backup/cc','validator.php',236],['backup/cc','validator.php',242],['backup/cc','validator.php',248],['backup/cc','validator.php',254],['backup/cc','validator.php',260],['lib/horde/framework/Horde/Imap/Client/Interaction','Client.php',34],['mod/quiz','override_form.php',58],['auth/cas/CAS/CAS/PGTStorage','AbstractStorage.php',57],['lib/htmlpurifier/HTMLPurifier','Length.php',41],['backup/util/helper','restore_decode_rule.class.php',47],['backup/util/helper','restore_decode_rule.class.php',192],['lib/horde/framework/Horde/Imap/Client/Data','Sync.php',133],['lib/phpexcel/PHPExcel/Shared/trend','logarithmicBestFitClass.php',97],['lib/adodb/perf','perf-db2.inc.php',61],['lib/phpexcel/PHPExcel/Style','Supervisor.php',44],['lib/htmlpurifier/HTMLPurifier/AttrTransform','TargetBlank.php',17],['lib/ddl','database_manager.php',48],['lib/mustache/src/Mustache/Exception','UnknownFilterException.php',22],['admin/roles/classes','define_role_table_advanced.php',46],['lib/dml','oci_native_moodle_temptables.php',40],['lib/horde/framework/Horde/Stream','Existing.php',28],['enrol/manual','locallib.php',37],['enrol/manual','locallib.php',102],['availability/classes','multiple_messages.php',56],['lib/phpexcel/PHPExcel/Reader','Gnumeric.php',55],['admin/roles/classes','override_permissions_table_advanced.php',31],['lib/pear/Net','GeoIP.php',323],['lib/mustache/src/Mustache/Loader','ArrayLoader.php',31],['lib/form','modgrade.php',78],['admin/tool/log/store/database/backup/moodle2','restore_logstore_database_subplugin.class.php',40],['cache/classes','config.php',80],['lib/pear/HTML/QuickForm','hidden.php',37],['question/type/calculated','datasetitems_form.php',72],['lib/tests','navigationlib_test.php',554],['lib/tests','navigationlib_test.php',612],['lib/tests','navigationlib_test.php',639],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Number.php',18],['lib/tests','completionlib_test.php',882],['admin/tool/generator/classes','site_backend.php',58],['lib/jabber/XMPP','XMLStream.php',171],['lib/simplepie/library/SimplePie','Sanitize.php',75],['cache/classes','factory.php',149],['lib/minify/lib/Minify/Cache','WinCache.php',20],['user/classes/output/myprofile','node.php',82],['lib/horde/framework/Horde/Stream','TempString.php',40],['lib/adodb/drivers','adodb-borland_ibase.inc.php',83],['mod/forum','locallib.php',55],['mod/forum','locallib.php',419],['mod/lti/service/memberships/classes/local/resource','contextmemberships.php',44],['lib/phpexcel/PHPExcel/Worksheet/AutoFilter/Column','Rule.php',262],['lib/classes/update','code_manager.php',57],['search/engine/solr/classes','engine.php',103],['lib/horde/framework/Horde/Imap/Client/Interaction/Server','Tagged.php',36],['lib/google/src/Google/Service','Compute.php',89],['lib/phpexcel/PHPExcel/Style','Borders.php',113],['lib','completionlib.php',243],['lib/google/src/Google/Service','Pubsub.php',44],['lib/adodb/drivers','adodb-ads.inc.php',69],['lib/adodb/drivers','adodb-ads.inc.php',657],['lib/markdown','MarkdownExtra.php',56],['lib/minify/lib/Minify/Cache','XCache.php',22],['lib/google/src/Google/Service','YouTube.php',75],['lib/lessphp','Functions.php',15],['auth/cas/CAS/CAS','AuthenticationException.php',53],['mod/quiz','locallib.php',1923],['competency/classes/external','stored_file_exporter.php',45],['user/filters','checkbox.php',51],['backup/moodle2','restore_settingslib.php',86],['backup/moodle2','restore_settingslib.php',149],['lib/htmlpurifier/HTMLPurifier/Node','Element.php',39],['lib/pear/HTML/QuickForm','date.php',260],['lib/lessphp/SourceMap','Generator.php',82],['backup/util/plan','base_step.class.php',35],['backup/util/plan','base_step.class.php',127],['mod/lti/service/memberships/classes/local/service','memberships.php',50],['lib/google/src/Google/Cache','Apc.php',37],['backup/util/ui','restore_ui_stage.class.php',42],['backup/util/ui','restore_ui_stage.class.php',265],['backup/util/ui','restore_ui_stage.class.php',452],['backup/util/ui','restore_ui_stage.class.php',592],['backup/util/ui','restore_ui_stage.class.php',704],['backup/util/ui','restore_ui_stage.class.php',852],['backup/util/ui','restore_ui_stage.class.php',959],['backup/util/ui','restore_ui_stage.class.php',1100],['lib/pear/Auth','RADIUS.php',120],['lib/pear/Auth','RADIUS.php',579],['lib/pear/Auth','RADIUS.php',672],['lib/pear/Auth','RADIUS.php',879],['lib/adodb/drivers','adodb-ado_access.inc.php',46],['admin/tool/xmldb/actions','XMLDBAction.class.php',56],['backup/converter/moodle1','handlerlib.php',120],['backup/converter/moodle1','handlerlib.php',1710],['backup/converter/moodle1','handlerlib.php',1902],['backup/converter/moodle1','handlerlib.php',2155],['backup/controller','restore_controller.class.php',63],['backup/controller','restore_controller.class.php',519],['lib/google/src/Google/Http','Request.php',58],['lib/google/src/Google/Service','Dfareporting.php',99],['lib/google/src/Google/Service','Manager.php',60],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Hashtable.php',73],['lib/htmlpurifier/HTMLPurifier/ConfigSchema','Validator.php',30],['lib/google/src/Google/Service','CloudMonitoring.php',45],['lib/editor/tinymce/plugins/spellchecker/classes','SpellChecker.php',11],['lib/horde/framework/Horde/Imap/Client/Ids','Map.php',44],['lib/horde/framework/Horde/Mail/Transport','Sendmail.php',65],['lib','webdavlib.php',84],['lib/dml','pgsql_native_moodle_recordset.php',43],['lib/horde/framework/Horde/Support','Guid.php',24],['lib/mustache/src/Mustache','LambdaHelper.php',25],['question/engine/upgrade/tests','helper.php',45],['admin/tool/uploadcourse/classes','tracker.php',72],['grade/report/user','lib.php',188],['lib/adodb/drivers','adodb-sqlanywhere.inc.php',156],['auth/cas/CAS/CAS','OutOfSequenceBeforeClientException.php',47],['backup/util/plan','base_task.class.php',40],['backup/util/plan','base_task.class.php',277],['lib/adodb/drivers','adodb-db2oci.inc.php',220]], 1102],
'ldap_supported_usertypes': ['ldap_supported_usertypes', 'Returns predefined user types ', [['lib','ldaplib.php',30]], 5],
'insert_record_raw': ['insert_record_raw', 'Insert new record into database, as fast as possible, no safety checks, lobs not supported. ', [['lib/dml','pdo_moodle_database.php',343],['lib/dml','oci_native_moodle_database.php',1226],['lib/dml','pgsql_native_moodle_database.php',827],['lib/dml','mssql_native_moodle_database.php',861],['lib/dml','mysqli_native_moodle_database.php',1132],['lib/dml','sqlsrv_native_moodle_database.php',947],['lib/dml/tests','dml_test.php',5547]], 37],
'authenticate_user_login': ['authenticate_user_login', 'Authenticates a user against the chosen authentication mechanism ', [['lib','moodlelib.php',4077]], 19],
'get_record': ['get_record', 'Load a single record. ', [['competency/classes','persistent.php',738],['lib/dml','moodle_database.php',1462]], 3224],
'getremoteaddr': ['getremoteaddr', 'Returns most reliable client address ', [['lib','moodlelib.php',8569]], 61],
'set_title': ['set_title', 'Sets the title for the node ', [['lib','outputcomponents.php',2820],['backup/cc/cc_lib','cc_weblink.php',41],['backup/cc/cc_lib','cc_basiclti.php',57],['lib','pagelib.php',1157],['blocks/rss_client/classes/output','channel_image.php',110],['blocks/rss_client/classes/output','item.php',182],['backup/cc/cc_lib','cc_asssesment.php',595],['backup/cc/cc_lib','cc_asssesment.php',843],['backup/cc/cc_lib','cc_asssesment.php',1060],['backup/cc/cc_lib','cc_asssesment.php',1829],['backup/cc/cc_lib','cc_page.php',38],['lib/classes','chart_base.php',222],['blocks/rss_client/classes/output','feed.php',113],['backup/cc/cc_lib','cc_metadata.php',225],['mod/wiki','pagelib.php',215],['backup/cc/cc_lib','cc_forum.php',39]], 460],
'create_temp_table': ['create_temp_table', 'This function will create the temporary table passed as argument with all its fields/keys/indexes/sequences, everything based in the XMLDB object ', [['lib/ddl','database_manager.php',447]], 12],
'set_cache_flag': ['set_cache_flag', 'Set a volatile flag ', [['lib','moodlelib.php',1684]], 13],
'get_manager': ['get_manager', 'Returns the sql generator used for db manipulation. Used mostly in upgrade.php scripts. ', [['lib/dml','moodle_database.php',1080]], 229],
'ldap_attributes': ['ldap_attributes', 'Returns user attribute mappings between moodle and LDAP ', [['auth/ldap','auth.php',1493]], 3],
'print_string': ['print_string', 'Prints out a translated string. ', [['lib','moodlelib.php',6877]], 458],
'sync_roles': ['sync_roles', 'Sync roles for this user ', [['auth/ldap','auth.php',1794],['lib','authlib.php',376],['auth/fc','auth.php',190]], 1],
'add_index': ['add_index', 'This function will add one new index to the table with all its attributes defined ', [['lib/xmldb','xmldb_table.php',802],['lib/ddl','database_manager.php',802]], 92],
'count_records_sql': ['count_records_sql', 'Get the result of a SQL SELECT COUNT(...) query. ', [['lib/dml','moodle_database.php',1796]], 155],
'is_user_suspended': ['is_user_suspended', 'Check if a user is suspended. This function is intended to be used after calling get_userinfo_asobj. This is needed because LDAP doesn\'t have a notion of disabled users, however things like MS Active Directory support it and expose information through a field. ', [['auth/ldap','auth.php',2295]], 2],
'ldap_normalise_objectclass': ['ldap_normalise_objectclass', 'Normalise the supplied objectclass filter. ', [['lib','ldaplib.php',281]], 4],
'update_internal_user_password': ['update_internal_user_password', 'Update password hash in user object (if necessary). ', [['lib','moodlelib.php',4452]], 19],
'ldap_filter_addslashes': ['ldap_filter_addslashes', 'Quote control characters in texts used in LDAP filters - see RFC 4515/2254 ', [['lib','ldaplib.php',352]], 8],
'iscreator': ['iscreator', 'Returns true if user should be coursecreator. ', [['auth/ldap','auth.php',1100],['auth/fc','auth.php',133],['auth/cas','auth.php',421]], 4],
'ldap_addslashes': ['ldap_addslashes', 'Quote control characters in AttributeValue parts of a RelativeDistinguishedName used in LDAP distinguished names - See RFC 4514/2253 ', [['lib','ldaplib.php',402]], 4],
'complete_user_login': ['complete_user_login', 'Call to complete the user login process after authenticate_user_login() has succeeded. It will setup the $USER variable and other required bits and pieces. ', [['lib','moodlelib.php',4292]], 11],
'ldap_ad_pwdexpired_from_diagmsg': ['ldap_ad_pwdexpired_from_diagmsg', 'Check if the diagnostic message for the LDAP login error tells us that the login is denied because the user password has expired or the password needs to be changed on first login (using interactive SMB/Windows logins, not LDAP logins). ', [['auth/ldap','auth.php',2270]], 1],
'qualified_me': ['qualified_me', 'Guesses the full URL of the current script. ', [['lib','weblib.php',176]], 26],
'set_heading': ['set_heading', 'Sets the heading to use for the page. This is normally used as the main heading at the top of the content. ', [['lib','pagelib.php',1170]], 426],
'ldap_find_userdn': ['ldap_find_userdn', 'Search specified contexts for the specified userid and return the user dn like: cn=username,ou=suborg,o=org. It\'s actually a wrapper around ldap_find_userdn(). ', [['enrol/ldap','lib.php',828],['auth/ldap','auth.php',2195],['lib','ldaplib.php',229]], 12],
'ldap_bulk_insert': ['ldap_bulk_insert', 'Bulk insert in SQL\'s temp table ', [['auth/ldap','auth.php',1042]], 1],
'user_create': ['user_create', 'Creates a new user on LDAP. By using information in userobject Use user_exists to prevent duplicate usernames ', [['auth/ldap','auth.php',348]], 3],
'get_userinfo_asobj': ['get_userinfo_asobj', 'Reads user information from ldap and returns it in an object ', [['auth/ldap','auth.php',305],['auth/db','auth.php',523]], 2],
'change_password_url': ['change_password_url', 'Returns the URL for changing the user\'s pw, or empty if the default can be used. ', [['auth/email','auth.php',193],['auth/mnet','auth.php',609],['auth/imap','auth.php',130],['auth/webservice','auth.php',121],['auth/manual','auth.php',132],['auth/none','auth.php',109],['auth/ldap','auth.php',1611],['lib','authlib.php',162],['auth/pop3','auth.php',126],['auth/cas','auth.php',274],['auth/db','auth.php',724]], 9],
'join': ['join', 'Join a room. For internal use by the Games SDK only. Calling this method directly is unsupported. (rooms.join) ', [['lib/google/src/Google/Service','Games.php',1716],['lib/google/src/Google/Service','Games.php',2100]], 1030],
'user_login': ['user_login', 'Returns true if the username and password work and false if they are wrong or don\'t exist. ', [['auth/radius','auth.php',56],['auth/nntp','auth.php',53],['auth/email','auth.php',52],['auth/lti','auth.php',45],['auth/mnet','auth.php',54],['auth/imap','auth.php',53],['auth/webservice','auth.php',53],['auth/shibboleth','auth.php',56],['auth/pam','auth.php',72],['auth/manual','auth.php',66],['auth/none','auth.php',52],['auth/ldap','auth.php',139],['lib','authlib.php',132],['auth/fc','auth.php',55],['auth/pop3','auth.php',53],['auth/nologin','auth.php',52],['auth/cas','auth.php',63],['auth/db','auth.php',50]], 15],
'trigger': ['trigger', '', [['lib/evalmath','evalmath.class.php',448],['lib/classes/event','base.php',765]], 964],
'strip_querystring': ['strip_querystring', 'Remove query string from url. ', [['lib','weblib.php',144]], 5],
'ldap_paged_results_supported': ['ldap_paged_results_supported', '', [['lib','ldaplib.php',461]], 6],
'validate_form': ['validate_form', 'A chance to validate form data, and last chance to do stuff before it is inserted in config_plugin ', [['auth/ldap','auth.php',2215],['lib','authlib.php',413],['auth/cas','auth.php',261],['auth/db','auth.php',658]], 1],
'user_confirm': ['user_confirm', 'Confirm the new user as registered. ', [['auth/email','auth.php',144],['auth/webservice','auth.php',158],['auth/manual','auth.php',228],['auth/ldap','auth.php',585],['lib','authlib.php',342]], 5],
'get_archetype_roles': ['get_archetype_roles', 'Returns roles of a specified archetype ', [['lib','accesslib.php',3265]], 33],
'ldap_get_userlist': ['ldap_get_userlist', 'Returns all usernames from LDAP ', [['auth/ldap','auth.php',1522]], 3],
'get_config': ['get_config', 'Config get method. ', [['lib/classes/antivirus','scanner.php',54],['competency/classes','competency_rule.php',59],['question/engine','bank.php',109],['admin/tool/log/classes/helper','store.php',63],['lib','moodlelib.php',1409],['lib','enrollib.php',1142],['lib/editor/tinymce/classes','plugin.php',73],['competency/classes','competency_rule_points.php',43],['search/classes','base.php',169],['mod/assign','assignmentplugin.php',345],['lib/portfolio','plugin.php',546]], 934],
'allow_commit': ['allow_commit', 'Commit delegated transaction. The real database commit SQL is executed only after committing all delegated transactions. ', [['lib/dml','moodle_transaction.php',78]], 135],
'can_be_manually_set': ['can_be_manually_set', 'Returns true if plugin can be manually set. ', [['auth/email','auth.php',212],['auth/manual','auth.php',151],['auth/none','auth.php',128],['auth/ldap','auth.php',499],['lib','authlib.php',560],['auth/nologin','auth.php',98]], 2],
'user_create_user': ['user_create_user', 'Creates a user ', [['user','lib.php',25]], 15],
'notification': ['notification', 'Output a notification (that is, a status message about something that has just happened). ', [['lib','outputrenderers.php',2849],['lib','outputrenderers.php',4412],['lib','outputrenderers.php',4496]], 540],
'is_ie': ['is_ie', 'Checks the user agent is IE (of any version). ', [['lib/classes','useragent.php',530]], 16],
'start_delegated_transaction': ['start_delegated_transaction', 'On DBs that support it, switch to transaction mode and begin a transaction you\'ll need to ensure you call allow_commit() on the returned object or your changes *will* be lost. ', [['lib/dml','moodle_database.php',2393]], 145],
'send_confirmation_email': ['send_confirmation_email', 'Send email to specified user with confirmation text and activation link. ', [['lib','moodlelib.php',5980]], 2],
'can_change_password': ['can_change_password', 'Returns true if this authentication plugin can change the user\'s password. ', [['auth/radius','auth.php',161],['auth/nntp','auth.php',99],['auth/email','auth.php',183],['auth/mnet','auth.php',598],['auth/imap','auth.php',120],['auth/webservice','auth.php',111],['auth/shibboleth','auth.php',180],['auth/pam','auth.php',111],['auth/manual','auth.php',122],['auth/none','auth.php',99],['auth/ldap','auth.php',1601],['lib','authlib.php',151],['auth/fc','auth.php',180],['auth/pop3','auth.php',116],['auth/nologin','auth.php',82],['auth/cas','auth.php',86],['auth/db','auth.php',714]], 13],
'on': ['on', '', [['lib/requirejs','require.js',508],['lib/jquery','jquery-3.1.0.js',4809]], 3823],
'get_local_referer': ['get_local_referer', 'Returns the cleaned local URL of the HTTP_REFERER less the URL query string parameters if required. ', [['lib','weblib.php',219]], 31],
'print_error': ['print_error', 'Abort execution by throwing of a general exception, default exception handler displays the error message in most cases. ', [['lib','setuplib.php',481]], 1488],
'add_field': ['add_field', 'Add a field to select. ', [['mod/glossary/classes','entry_query_builder.php',99],['lib/xmldb','xmldb_table.php',766],['lib/ddl','database_manager.php',522]], 775],
'ldap_getdefaults': ['ldap_getdefaults', 'Initializes needed variables for ldap-module ', [['lib','ldaplib.php',46]], 2],
'ldap_expirationtime2unix': ['ldap_expirationtime2unix', 'Take expirationtime and return it as unix timestamp in seconds ', [['auth/ldap','auth.php',1435]], 1],
'get_ntlm_remote_user': ['get_ntlm_remote_user', 'When using NTLM SSO, the format of the remote username we get in $_SERVER[\'REMOTE_USER\'] may vary, depending on where from and how the web server gets the data. So we let the admin configure the format using two place holders (%domain% and %username%). This function tries to extract the username (stripping the domain part and any separators if they are present) from the value present in $_SERVER[\'REMOTE_USER\'], using the configured format. ', [['auth/ldap','auth.php',2232]], 1],
'drop_table': ['drop_table', 'This function will drop the table passed as argument and all the associated objects (keys, indexes, constraints, sequences, triggers) will be dropped too. ', [['lib/ddl','database_manager.php',315]], 60],
'isloggedin': ['isloggedin', 'Determines if a user is currently logged in ', [['lib','accesslib.php',1910]], 184],
'user_update_password': ['user_update_password', 'Updates the user\'s password. ', [['auth/email','auth.php',68],['auth/webservice','auth.php',82],['auth/manual','auth.php',91],['auth/none','auth.php',68],['auth/ldap','auth.php',1316],['lib','authlib.php',243],['auth/nologin','auth.php',60],['auth/db','auth.php',243]], 14],
'isguestuser': ['isguestuser', 'Determines if a user is logged in as real guest user with username \'guest\'. ', [['lib','accesslib.php',1923]], 260],
'get_complete_user_data': ['get_complete_user_data', 'Get a complete user record, which includes all the info in the user record. ', [['lib','moodlelib.php',4516]], 24],
'can_reset_password': ['can_reset_password', 'Returns true if plugin allows resetting of internal password. ', [['auth/email','auth.php',203],['auth/webservice','auth.php',131],['auth/manual','auth.php',142],['auth/none','auth.php',119],['auth/ldap','auth.php',490],['lib','authlib.php',288],['auth/nologin','auth.php',91],['auth/db','auth.php',740]], 3],
'sync_users': ['sync_users', 'Syncronizes user fron external LDAP server to moodle user table ', [['auth/ldap','auth.php',657],['auth/cas','auth.php',492],['auth/db','auth.php',270]], 24],
'user_activate': ['user_activate', 'Activates (enables) user in external LDAP so user can login ', [['auth/ldap','auth.php',1054]], 4],
'user_signup': ['user_signup', 'Sign up a new user ready for confirmation. Password is passed in plaintext. ', [['auth/email','auth.php',90],['auth/ldap','auth.php',517],['lib','authlib.php',308]], 4],
'role_assign': ['role_assign', 'Assigns the specified role to a user in the context. ', [['lib/testing/generator','data_generator.php',936],['lib','accesslib.php',1661]], 269],
'delete_user': ['delete_user', 'Marks user deleted in internal user database and notifies the auth plugin. Also unenrols user from all roles and does other cleanup. ', [['lib','moodlelib.php',3893]], 43],
'sesskey': ['sesskey', 'Makes sure that $USER->sesskey exists, if $USER itself exists. It sets a new sesskey if one does not already exist, but does not overwrite existing sesskeys. Returns the sesskey string if $USER exists, or boolean false if not. ', [['lib','sessionlib.php',28]], 641],
'convert': ['convert', '', [['lib','wiki_to_markdown.php',314],['backup/converter','convertlib.php',119],['backup/cc/cc_lib','cc_converter_url.php',36],['backup/cc/cc_lib','cc_converter_forum.php',36],['backup/cc/cc_lib','cc_converter_basiclti.php',36],['lib/html2text','Html2Text.php',325],['lib/editor/tinymce/tiny_mce/3.5.11','tiny_mce_src.js',18498],['backup/cc/cc_lib','cc_converter_quiz.php',40],['lib','navigationlib.php',4932],['lib/htmlpurifier/HTMLPurifier','UnitConverter.php',63],['backup/cc/cc_lib','cc_converter_resource.php',34],['backup/cc/cc_lib','cc_convert_moodle2.php',29],['backup/cc/cc_lib','cc_converter_lti.php',36],['lib/classes','text.php',162],['backup/cc/cc_lib','cc_converter_label.php',33],['backup/cc/cc_lib','cc_converter_page.php',35],['backup/cc/cc_lib','cc_converter_folder.php',33],['lib/lessphp','Functions.php',569],['backup/controller','restore_controller.class.php',439]], 141],
'ldap_get_ad_pwdexpire': ['ldap_get_ad_pwdexpire', 'Get password expiration time for a given user from Active Directory ', [['auth/ldap','auth.php',1998]], 1],
'user_add_password_history': ['user_add_password_history', 'Add password to the list of used hashes for this user. ', [['user','lib.php',942]], 28],
'unset_cache_flag': ['unset_cache_flag', 'Removes a single volatile flag ', [['lib','moodlelib.php',1729]], 2],
'process_config': ['process_config', 'Processes and stores configuration data for this authentication plugin. ', [['auth/radius','auth.php',185],['auth/nntp','auth.php',121],['auth/email','auth.php',233],['backup/moodle2','restore_stepslib.php',2363],['auth/mnet','auth.php',690],['auth/imap','auth.php',158],['auth/webservice','auth.php',151],['auth/shibboleth','auth.php',242],['auth/pam','auth.php',133],['auth/manual','auth.php',203],['auth/none','auth.php',149],['auth/ldap','auth.php',1837],['lib','authlib.php',423],['auth/fc','auth.php',226],['auth/pop3','auth.php',154],['auth/cas','auth.php',284],['auth/db','auth.php',764]], 3],
'set_config': ['set_config', 'Set a key in global configuration ', [['lib','moodlelib.php',1336],['lib','enrollib.php',1153],['lib/editor/tinymce/classes','plugin.php',84],['mod/assign','assignmentplugin.php',314],['lib/portfolio','plugin.php',515]], 1119],
'ntlmsso_finish': ['ntlmsso_finish', 'Find the session set by ntlmsso_magic(), validate it and call authenticate_user_login() to authenticate the user through the auth machinery. ', [['auth/ldap','auth.php',1743]], 2],
'address_in_subnet': ['address_in_subnet', 'Function to check the passed address is within the passed subnet ', [['lib','moodlelib.php',8284]], 80],
'get_records_sql': ['get_records_sql', 'Get a number of records as an array of objects. ', [['lib/dml','pdo_moodle_database.php',309],['lib/dml','oci_native_moodle_database.php',1145],['lib/dml','pgsql_native_moodle_database.php',732],['lib/dml','mssql_native_moodle_database.php',805],['lib/dml','mysqli_native_moodle_database.php',1057],['lib/dml','sqlsrv_native_moodle_database.php',890],['lib/dml/tests','dml_test.php',5545]], 700],
'get_custom_user_profile_fields': ['get_custom_user_profile_fields', 'Return custom user profile fields. ', [['lib','authlib.php',594]], 10],
'set_url': ['set_url', 'Convenience method handling moodle_urls. ', [['competency/classes','evidence.php',151],['lib','outputcomponents.php',2828],['backup/cc/cc_lib','cc_weblink.php',50],['lib','pagelib.php',1227],['blocks/rss_client/classes/output','channel_image.php',89],['backup/util/ui','restore_ui_components.php',141],['mod/wiki','pagelib.php',245],['mod/wiki','pagelib.php',333],['mod/wiki','pagelib.php',425],['mod/wiki','pagelib.php',696],['mod/wiki','pagelib.php',721],['mod/wiki','pagelib.php',835],['mod/wiki','pagelib.php',879],['mod/wiki','pagelib.php',1008],['mod/wiki','pagelib.php',1112],['mod/wiki','pagelib.php',1219],['mod/wiki','pagelib.php',1462],['mod/wiki','pagelib.php',1864],['mod/wiki','pagelib.php',1932],['mod/wiki','pagelib.php',2104],['mod/wiki','pagelib.php',2165],['mod/wiki','pagelib.php',2221],['mod/wiki','pagelib.php',2286],['mod/wiki','pagelib.php',2334],['mod/wiki','pagelib.php',2382],['mod/wiki','pagelib.php',2486]], 596],
'add_key': ['add_key', 'This function will add one new key to the table with all its attributes defined ', [['lib/xmldb','xmldb_table.php',787],['lib/ddl','database_manager.php',739]], 207],
'redirect': ['redirect', '', [['enrol/lti/ims-blti','blti.php',230],['lib','weblib.php',2659]], 999],
'preg_replace': ['preg_replace', '', [], 917],
'ldap_read': ['ldap_read', '', [], 16],
'array_key_exists': ['array_key_exists', '', [], 1445],
'sha1': ['sha1', '', [], 186],
'array_keys': ['array_keys', '', [], 1256],
'header': ['header', '', [], 1355],
'array_unique': ['array_unique', '', [], 171],
'preg_match': ['preg_match', '', [], 1286],
'ldap_add': ['ldap_add', '', [], 28],
'ldap_err2str': ['ldap_err2str', '', [], 8],
'get_object_vars': ['get_object_vars', '', [], 48],
'floor': ['floor', '', [], 514],
'function_exists': ['function_exists', '', [], 419],
'ldap_delete': ['ldap_delete', '', [], 20],
'date': ['date', '', [], 693],
'ltrim': ['ltrim', '', [], 92],
'ceil': ['ceil', '', [], 236],
'defined': ['defined', '', [], 4731],
'array_merge': ['array_merge', '', [], 2944],
'strtolower': ['strtolower', '', [], 817],
'bcmod': ['bcmod', '', [], 6],
'ldap_next_entry': ['ldap_next_entry', '', [], 4],
'ldap_get_values_len': ['ldap_get_values_len', '', [], 3],
'explode': ['explode', '', [], 1572],
'ldap_bind': ['ldap_bind', '', [], 5],
'pack': ['pack', '', [], 195],
'ldap_search': ['ldap_search', '', [], 10],
'substr': ['substr', '', [], 2823],
'array_shift': ['array_shift', '', [], 700],
'ldap_errno': ['ldap_errno', '', [], 17],
'end': ['end', '', [], 433],
'array_push': ['array_push', '', [], 240],
'ldap_first_entry': ['ldap_first_entry', '', [], 8],
'in_array': ['in_array', '', [], 1234],
'bcsub': ['bcsub', '', [], 2],
'mb_convert_encoding': ['mb_convert_encoding', '', [], 21],
'array_change_key_case': ['array_change_key_case', '', [], 32],
'ldap_connect': ['ldap_connect', '', [], 20],
'base64_encode': ['base64_encode', '', [], 134],
'is_null': ['is_null', '', [], 2003],
'array_map': ['array_map', '', [], 169],
'ldap_list': ['ldap_list', '', [], 7],
'mktime': ['mktime', '', [], 50],
'error_log': ['error_log', '', [], 90],
'implode': ['implode', '', [], 1281],
'ldap_get_option': ['ldap_get_option', '', [], 11],
'ldap_get_entries': ['ldap_get_entries', '', [], 10],
'strpos': ['strpos', '', [], 1604],
'create_function': ['create_function', '', [], 43],
'is_array': ['is_array', '', [], 1608],
'count': ['count', '', [], 4095],
'define': ['define', '', [], 2373],
'bcdiv': ['bcdiv', '', [], 8],
'time': ['time', '', [], 1959],
'preg_quote': ['preg_quote', '', [], 205],
'trim': ['trim', '', [], 1948]};
CLASS_DATA={
'moodle_url': ['moodle_url', 'Class for creating and manipulating urls. ', [['lib','weblib.php',238]], 3088],
'auth_plugin_ldap': ['auth_plugin_ldap', 'LDAP authentication plugin. ', [['auth/ldap','auth.php',83]], 3],
'core_text': ['core_text', 'defines string api\'s for manipulating strings ', [['lib/classes','text.php',27]], 566],
'manager': ['manager', 'Search subsystem manager. ', [['search/classes','manager.php',31],['user/classes/output/myprofile','manager.php',28],['lib/classes/antivirus','manager.php',29],['lib/classes/event','manager.php',30],['lib/classes/task','manager.php',28],['admin/tool/messageinbound/classes','manager.php',29],['lib/classes/message/inbound','manager.php',29],['admin/tool/log/classes/log','manager.php',29],['lib/classes/log','manager.php',29],['lib/classes/session','manager.php',29],['lib/classes/message','manager.php',31]], 585],
'context_system': ['context_system', 'System context class ', [['lib','accesslib.php',6157]], 1147],
'auth_plugin_base': ['auth_plugin_base', 'Abstract authentication plugin. ', [['lib','authlib.php',82]], 17],
'core_useragent': ['core_useragent', 'The user agent class. ', [['lib/classes','useragent.php',25]], 159],
'user_created': ['user_created', 'Event when new user profile is created. ', [['lib/classes/event','user_created.php',29]], 8],
'xmldb_table': ['xmldb_table', '', [['lib/xmldb','xmldb_table.php',29]], 230]};
CONST_DATA={
'AUTH_REMOVEUSER_KEEP': ['AUTH_REMOVEUSER_KEEP', '', [['lib','authlib.php',60]], 16],
'XMLDB_INDEX_UNIQUE': ['XMLDB_INDEX_UNIQUE', '', [['lib/xmldb','xmldb_constants.php',82]], 36],
'DEBUG_DEVELOPER': ['DEBUG_DEVELOPER', '', [['lib','setuplib.php',40]], 736],
'AUTH_NTLMTIMEOUT': ['AUTH_NTLMTIMEOUT', '', [['auth/ldap','auth.php',37]], 4],
'AUTH_NTLM_FASTPATH_YESFORM': ['AUTH_NTLM_FASTPATH_YESFORM', '', [['auth/ldap','auth.php',68]], 5],
'AUTH_NTLM_FASTPATH_YESATTEMPT': ['AUTH_NTLM_FASTPATH_YESATTEMPT', '', [['auth/ldap','auth.php',71]], 4],
'XMLDB_TYPE_INTEGER': ['XMLDB_TYPE_INTEGER', '', [['lib/xmldb','xmldb_constants.php',44]], 583],
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',140],['','install.php',93],['lib','setup.php',391]], 4153],
'LDAP_DEFAULT_PAGESIZE': ['LDAP_DEFAULT_PAGESIZE', '', [['lib','ldaplib.php',27]], 7],
'LDAP_DEREF_NEVER': ['LDAP_DEREF_NEVER', '', [['auth/cas','auth.php',251]], 18],
'AUTH_CONFIRM_OK': ['AUTH_CONFIRM_OK', '', [['lib','authlib.php',55]], 7],
'AUTH_CONFIRM_FAIL': ['AUTH_CONFIRM_FAIL', '', [['lib','authlib.php',54]], 2],
'AUTH_REMOVEUSER_FULLDELETE': ['AUTH_REMOVEUSER_FULLDELETE', '', [['lib','authlib.php',62]], 11],
'ROOTDSE': ['ROOTDSE', '', [['lib','ldaplib.php',22]], 3],
'AUTH_NTLM_VALID_USERNAME': ['AUTH_NTLM_VALID_USERNAME', '', [['auth/ldap','auth.php',55]], 3],
'DAYSECS': ['DAYSECS', '', [['lib','moodlelib.php',49]], 122],
'XMLDB_NOTNULL': ['XMLDB_NOTNULL', '', [['lib/xmldb','xmldb_constants.php',78]], 573],
'AUTH_UID_NOBODY': ['AUTH_UID_NOBODY', '', [['auth/ldap','auth.php',47]], 3],
'AUTH_CONFIRM_ERROR': ['AUTH_CONFIRM_ERROR', '', [['lib','authlib.php',57]], 7],
'AUTH_NTLM_FASTPATH_ATTEMPT': ['AUTH_NTLM_FASTPATH_ATTEMPT', '', [['auth/ldap','auth.php',65]], 3],
'AUTH_REMOVEUSER_SUSPEND': ['AUTH_REMOVEUSER_SUSPEND', '', [['lib','authlib.php',61]], 15],
'AUTH_AD_ACCOUNTDISABLE': ['AUTH_AD_ACCOUNTDISABLE', '', [['auth/ldap','auth.php',31]], 5],
'XMLDB_KEY_PRIMARY': ['XMLDB_KEY_PRIMARY', '', [['lib/xmldb','xmldb_constants.php',64]], 189],
'LDAP_OPT_DIAGNOSTIC_MESSAGE': ['LDAP_OPT_DIAGNOSTIC_MESSAGE', '', [['auth/ldap','auth.php',76]], 3],
'AUTH_NTLM_DEFAULT_FORMAT': ['AUTH_NTLM_DEFAULT_FORMAT', '', [['auth/ldap','auth.php',62]], 3],
'XMLDB_UNSIGNED': ['XMLDB_UNSIGNED', '', [['lib/xmldb','xmldb_constants.php',76]], 4],
'XMLDB_SEQUENCE': ['XMLDB_SEQUENCE', '', [['lib/xmldb','xmldb_constants.php',80]], 167],
'UF_DONT_EXPIRE_PASSWD': ['UF_DONT_EXPIRE_PASSWD', '', [['auth/ldap','auth.php',42]], 3],
'PHPUNIT_TEST': ['PHPUNIT_TEST', '', [['admin/cli','install.php',145],['','install.php',49],['lib/phpunit','bootstrap.php',63],['lib','setup.php',247]], 59],
'XMLDB_TYPE_CHAR': ['XMLDB_TYPE_CHAR', '', [['lib/xmldb','xmldb_constants.php',50]], 181],
'AUTH_AD_NORMAL_ACCOUNT': ['AUTH_AD_NORMAL_ACCOUNT', '', [['auth/ldap','auth.php',34]], 3],
'AUTH_GID_NOGROUP': ['AUTH_GID_NOGROUP', '', [['auth/ldap','auth.php',50]], 3],
'AUTH_CONFIRM_ALREADY': ['AUTH_CONFIRM_ALREADY', '', [['lib','authlib.php',56]], 7],
'AUTH_NTLM_VALID_DOMAINNAME': ['AUTH_NTLM_VALID_DOMAINNAME', '', [['auth/ldap','auth.php',58]], 3]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Aug 11 10:00:09 2016</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
