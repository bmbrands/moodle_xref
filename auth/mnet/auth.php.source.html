<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /auth/mnet/auth.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Aug 11 10:00:09 2016 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='auth/mnet';
filename='auth.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/auth/mnet/</a> -> <a href="auth.php.html">auth.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="auth.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="auth.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * Authentication Plugin: Moodle Network Authentication</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> * Multiple host authentication support for Moodle Network.</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> *</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @package auth_mnet</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @author Martin Dougiamas</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * @license http://www.gnu.org/copyleft/gpl.html GNU Public License</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> */</span>
<a name="l25"><span class="linenum">  25</span></a>  
<a name="l26"><span class="linenum">  26</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die();
<a name="l27"><span class="linenum">  27</span></a>  
<a name="l28"><span class="linenum">  28</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a>.'/authlib.php');
<a name="l29"><span class="linenum">  29</span></a>  
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment">/**</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment"> * Moodle Network authentication plugin.</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> */</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('auth_plugin_mnet')" href="../../_classes/auth_plugin_mnet.html" onMouseOver="classPopup(event,'auth_plugin_mnet')">auth_plugin_mnet</a> <span class="keyword">extends</span> <a class="class" onClick="logClass('auth_plugin_base')" href="../../_classes/auth_plugin_base.html" onMouseOver="classPopup(event,'auth_plugin_base')">auth_plugin_base</a> {
<a name="l34"><span class="linenum">  34</span></a>  
<a name="l35"><span class="linenum">  35</span></a>      <span class="comment">/**</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment">     * Constructor.</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment">     */</span>
<a name="l38"><span class="linenum">  38</span></a>      public function <a class="function" onClick="logFunction('__construct')" href="../../_functions/__construct.html" onMouseOver="funcPopup(event,'__construct')">__construct</a>() {
<a name="l39"><span class="linenum">  39</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('authtype')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/authtype.html">authtype</a> = 'mnet';
<a name="l40"><span class="linenum">  40</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a> = <a class="function" onClick="logFunction('get_config')" href="../../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>('auth_mnet');
<a name="l41"><span class="linenum">  41</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('mnet')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/mnet.html">mnet</a> = <a class="function" onClick="logFunction('get_mnet_environment')" href="../../_functions/get_mnet_environment.html" onMouseOver="funcPopup(event,'get_mnet_environment')">get_mnet_environment</a>();
<a name="l42"><span class="linenum">  42</span></a>      }
<a name="l43"><span class="linenum">  43</span></a>  
<a name="l44"><span class="linenum">  44</span></a>      <span class="comment">/**</span>
<a name="l45"><span class="linenum">  45</span></a>  <span class="comment">     * Old syntax of class constructor. Deprecated in PHP7.</span>
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment">     *</span>
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment">     * @deprecated since Moodle 3.1</span>
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment">     */</span>
<a name="l49"><span class="linenum">  49</span></a>      public function <a class="function" onClick="logFunction('auth_plugin_mnet')" href="../../_functions/auth_plugin_mnet.html" onMouseOver="funcPopup(event,'auth_plugin_mnet')">auth_plugin_mnet</a>() {
<a name="l50"><span class="linenum">  50</span></a>          <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Use of class name as constructor is deprecated', <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l51"><span class="linenum">  51</span></a>          self::<a class="function" onClick="logFunction('__construct')" href="../../_functions/__construct.html" onMouseOver="funcPopup(event,'__construct')">__construct</a>();
<a name="l52"><span class="linenum">  52</span></a>      }
<a name="l53"><span class="linenum">  53</span></a>  
<a name="l54"><span class="linenum">  54</span></a>      <span class="comment">/**</span>
<a name="l55"><span class="linenum">  55</span></a>  <span class="comment">     * This function is normally used to determine if the username and password</span>
<a name="l56"><span class="linenum">  56</span></a>  <span class="comment">     * are correct for local logins. Always returns false, as local users do not</span>
<a name="l57"><span class="linenum">  57</span></a>  <span class="comment">     * need to login over mnet xmlrpc.</span>
<a name="l58"><span class="linenum">  58</span></a>  <span class="comment">     *</span>
<a name="l59"><span class="linenum">  59</span></a>  <span class="comment">     * @param string $username The username</span>
<a name="l60"><span class="linenum">  60</span></a>  <span class="comment">     * @param string $password The password</span>
<a name="l61"><span class="linenum">  61</span></a>  <span class="comment">     * @return bool Authentication success or failure.</span>
<a name="l62"><span class="linenum">  62</span></a>  <span class="comment">     */</span>
<a name="l63"><span class="linenum">  63</span></a>      function <a class="function" onClick="logFunction('user_login')" href="../../_functions/user_login.html" onMouseOver="funcPopup(event,'user_login')">user_login</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, <a class="var it201" onMouseOver="hilite(201)" onMouseOut="lolite()" onClick="logVariable('password')" href="../../_variables/password.html">$password</a>) {
<a name="l64"><span class="linenum">  64</span></a>          return false; <span class="comment">// print_error(&quot;mnetlocal&quot;);</span>
<a name="l65"><span class="linenum">  65</span></a>      }
<a name="l66"><span class="linenum">  66</span></a>  
<a name="l67"><span class="linenum">  67</span></a>      <span class="comment">/**</span>
<a name="l68"><span class="linenum">  68</span></a>  <span class="comment">     * Return user data for the provided token, compare with user_agent string.</span>
<a name="l69"><span class="linenum">  69</span></a>  <span class="comment">     *</span>
<a name="l70"><span class="linenum">  70</span></a>  <span class="comment">     * @param  string $token    The unique ID provided by remotehost.</span>
<a name="l71"><span class="linenum">  71</span></a>  <span class="comment">     * @param  string $useragent       User Agent string.</span>
<a name="l72"><span class="linenum">  72</span></a>  <span class="comment">     * @return array  $userdata Array of user info for remote host</span>
<a name="l73"><span class="linenum">  73</span></a>  <span class="comment">     */</span>
<a name="l74"><span class="linenum">  74</span></a>      function <a class="function" onClick="logFunction('user_authorise')" href="../../_functions/user_authorise.html" onMouseOver="funcPopup(event,'user_authorise')">user_authorise</a>(<a class="var it310" onMouseOver="hilite(310)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>, <a class="var it1443" onMouseOver="hilite(1443)" onMouseOut="lolite()" onClick="logVariable('useragent')" href="../../_variables/useragent.html">$useragent</a>) {
<a name="l75"><span class="linenum">  75</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it940" onMouseOver="hilite(940)" onMouseOut="lolite()" onClick="logVariable('SITE')" href="../../_variables/SITE.html">$SITE</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l76"><span class="linenum">  76</span></a>          <a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a> = <a class="function" onClick="logFunction('get_mnet_remote_client')" href="../../_functions/get_mnet_remote_client.html" onMouseOver="funcPopup(event,'get_mnet_remote_client')">get_mnet_remote_client</a>();
<a name="l77"><span class="linenum">  77</span></a>          require_once <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a> . '<a class="filename" href="../../mnet/xmlrpc/serverlib.php.html">/mnet/xmlrpc/serverlib.php</a>';
<a name="l78"><span class="linenum">  78</span></a>  
<a name="l79"><span class="linenum">  79</span></a>          <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('mnet_session', array('token'=&gt;<a class="var it310" onMouseOver="hilite(310)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>, 'useragent'=&gt;<a class="var it1443" onMouseOver="hilite(1443)" onMouseOut="lolite()" onClick="logVariable('useragent')" href="../../_variables/useragent.html">$useragent</a>));
<a name="l80"><span class="linenum">  80</span></a>          if (empty(<a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>)) {
<a name="l81"><span class="linenum">  81</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('mnet_server_exception')" href="../../_classes/mnet_server_exception.html" onMouseOver="classPopup(event,'mnet_server_exception')">mnet_server_exception</a>(1, 'authfail_nosessionexists');
<a name="l82"><span class="linenum">  82</span></a>          }
<a name="l83"><span class="linenum">  83</span></a>  
<a name="l84"><span class="linenum">  84</span></a>  <span class="comment">        // check session confirm timeout</span>
<a name="l85"><span class="linenum">  85</span></a>          if (<a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('confirm_timeout')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/confirm_timeout.html">confirm_timeout</a> &lt; <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>()) {
<a name="l86"><span class="linenum">  86</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('mnet_server_exception')" href="../../_classes/mnet_server_exception.html" onMouseOver="classPopup(event,'mnet_server_exception')">mnet_server_exception</a>(2, 'authfail_sessiontimedout');
<a name="l87"><span class="linenum">  87</span></a>          }
<a name="l88"><span class="linenum">  88</span></a>  
<a name="l89"><span class="linenum">  89</span></a>  <span class="comment">        // session okay, try getting the user</span>
<a name="l90"><span class="linenum">  90</span></a>          if (!<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user', array('id'=&gt;<a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('userid')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>))) {
<a name="l91"><span class="linenum">  91</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('mnet_server_exception')" href="../../_classes/mnet_server_exception.html" onMouseOver="classPopup(event,'mnet_server_exception')">mnet_server_exception</a>(3, 'authfail_usermismatch');
<a name="l92"><span class="linenum">  92</span></a>          }
<a name="l93"><span class="linenum">  93</span></a>  
<a name="l94"><span class="linenum">  94</span></a>          <a class="var it7917" onMouseOver="hilite(7917)" onMouseOut="lolite()" onClick="logVariable('userdata')" href="../../_variables/userdata.html">$userdata</a> = <a class="function" onClick="logFunction('mnet_strip_user')" href="../../_functions/mnet_strip_user.html" onMouseOver="funcPopup(event,'mnet_strip_user')">mnet_strip_user</a>((array)<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>, <a class="function" onClick="logFunction('mnet_fields_to_send')" href="../../_functions/mnet_fields_to_send.html" onMouseOver="funcPopup(event,'mnet_fields_to_send')">mnet_fields_to_send</a>(<a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a>));
<a name="l95"><span class="linenum">  95</span></a>  
<a name="l96"><span class="linenum">  96</span></a>  <span class="comment">        // extra special ones</span>
<a name="l97"><span class="linenum">  97</span></a>          <a class="var it7917" onMouseOver="hilite(7917)" onMouseOut="lolite()" onClick="logVariable('userdata')" href="../../_variables/userdata.html">$userdata</a>['auth']                    = 'mnet';
<a name="l98"><span class="linenum">  98</span></a>          <a class="var it7917" onMouseOver="hilite(7917)" onMouseOut="lolite()" onClick="logVariable('userdata')" href="../../_variables/userdata.html">$userdata</a>['wwwroot']                 = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('mnet')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/mnet.html">mnet</a>-&gt;wwwroot;
<a name="l99"><span class="linenum">  99</span></a>          <a class="var it7917" onMouseOver="hilite(7917)" onMouseOut="lolite()" onClick="logVariable('userdata')" href="../../_variables/userdata.html">$userdata</a>['session.gc_maxlifetime']  = <a class="phpfunction" onClick="logFunction('ini_get')" href="../../_functions/ini_get.html" onMouseOver="phpfuncPopup(event,'ini_get')">ini_get</a>('session.gc_maxlifetime');
<a name="l100"><span class="linenum"> 100</span></a>  
<a name="l101"><span class="linenum"> 101</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>('picture', <a class="var it7917" onMouseOver="hilite(7917)" onMouseOut="lolite()" onClick="logVariable('userdata')" href="../../_variables/userdata.html">$userdata</a>) &amp;&amp; !empty(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('picture')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/picture.html">picture</a>)) {
<a name="l102"><span class="linenum"> 102</span></a>              <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a> = <a class="function" onClick="logFunction('get_file_storage')" href="../../_functions/get_file_storage.html" onMouseOver="funcPopup(event,'get_file_storage')">get_file_storage</a>();
<a name="l103"><span class="linenum"> 103</span></a>              <a class="var it639" onMouseOver="hilite(639)" onMouseOut="lolite()" onClick="logVariable('usercontext')" href="../../_variables/usercontext.html">$usercontext</a> = <a class="class" onClick="logClass('context_user')" href="../../_classes/context_user.html" onMouseOver="classPopup(event,'context_user')">context_user</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="constant" onClick="logConstant('MUST_EXIST')" href="../../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l104"><span class="linenum"> 104</span></a>              if (<a class="var it21677" onMouseOver="hilite(21677)" onMouseOut="lolite()" onClick="logVariable('usericonfile')" href="../../_variables/usericonfile.html">$usericonfile</a> = <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('get_file')" href="../../_functions/get_file.html" onMouseOver="funcPopup(event,'get_file')">get_file</a>(<a class="var it639" onMouseOver="hilite(639)" onMouseOut="lolite()" onClick="logVariable('usercontext')" href="../../_variables/usercontext.html">$usercontext</a>-&gt;<a onClick="logVariable('id')" class="var it43024" onMouseOver="hilite(43024)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'user', 'icon', 0, '/', 'f1.png')) {
<a name="l105"><span class="linenum"> 105</span></a>                  <a class="var it7917" onMouseOver="hilite(7917)" onMouseOut="lolite()" onClick="logVariable('userdata')" href="../../_variables/userdata.html">$userdata</a>['_mnet_userpicture_timemodified'] = <a class="var it21677" onMouseOver="hilite(21677)" onMouseOut="lolite()" onClick="logVariable('usericonfile')" href="../../_variables/usericonfile.html">$usericonfile</a>-&gt;<a class="function" onClick="logFunction('get_timemodified')" href="../../_functions/get_timemodified.html" onMouseOver="funcPopup(event,'get_timemodified')">get_timemodified</a>();
<a name="l106"><span class="linenum"> 106</span></a>                  <a class="var it7917" onMouseOver="hilite(7917)" onMouseOut="lolite()" onClick="logVariable('userdata')" href="../../_variables/userdata.html">$userdata</a>['_mnet_userpicture_mimetype'] = <a class="var it21677" onMouseOver="hilite(21677)" onMouseOut="lolite()" onClick="logVariable('usericonfile')" href="../../_variables/usericonfile.html">$usericonfile</a>-&gt;<a class="function" onClick="logFunction('get_mimetype')" href="../../_functions/get_mimetype.html" onMouseOver="funcPopup(event,'get_mimetype')">get_mimetype</a>();
<a name="l107"><span class="linenum"> 107</span></a>              } else if (<a class="var it21677" onMouseOver="hilite(21677)" onMouseOut="lolite()" onClick="logVariable('usericonfile')" href="../../_variables/usericonfile.html">$usericonfile</a> = <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('get_file')" href="../../_functions/get_file.html" onMouseOver="funcPopup(event,'get_file')">get_file</a>(<a class="var it639" onMouseOver="hilite(639)" onMouseOut="lolite()" onClick="logVariable('usercontext')" href="../../_variables/usercontext.html">$usercontext</a>-&gt;<a onClick="logVariable('id')" class="var it43024" onMouseOver="hilite(43024)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'user', 'icon', 0, '/', 'f1.jpg')) {
<a name="l108"><span class="linenum"> 108</span></a>                  <a class="var it7917" onMouseOver="hilite(7917)" onMouseOut="lolite()" onClick="logVariable('userdata')" href="../../_variables/userdata.html">$userdata</a>['_mnet_userpicture_timemodified'] = <a class="var it21677" onMouseOver="hilite(21677)" onMouseOut="lolite()" onClick="logVariable('usericonfile')" href="../../_variables/usericonfile.html">$usericonfile</a>-&gt;<a class="function" onClick="logFunction('get_timemodified')" href="../../_functions/get_timemodified.html" onMouseOver="funcPopup(event,'get_timemodified')">get_timemodified</a>();
<a name="l109"><span class="linenum"> 109</span></a>                  <a class="var it7917" onMouseOver="hilite(7917)" onMouseOut="lolite()" onClick="logVariable('userdata')" href="../../_variables/userdata.html">$userdata</a>['_mnet_userpicture_mimetype'] = <a class="var it21677" onMouseOver="hilite(21677)" onMouseOut="lolite()" onClick="logVariable('usericonfile')" href="../../_variables/usericonfile.html">$usericonfile</a>-&gt;<a class="function" onClick="logFunction('get_mimetype')" href="../../_functions/get_mimetype.html" onMouseOver="funcPopup(event,'get_mimetype')">get_mimetype</a>();
<a name="l110"><span class="linenum"> 110</span></a>              }
<a name="l111"><span class="linenum"> 111</span></a>          }
<a name="l112"><span class="linenum"> 112</span></a>  
<a name="l113"><span class="linenum"> 113</span></a>          <a class="var it7917" onMouseOver="hilite(7917)" onMouseOut="lolite()" onClick="logVariable('userdata')" href="../../_variables/userdata.html">$userdata</a>['myhosts'] = array();
<a name="l114"><span class="linenum"> 114</span></a>          if (<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a> = <a class="function" onClick="logFunction('enrol_get_users_courses')" href="../../_functions/enrol_get_users_courses.html" onMouseOver="funcPopup(event,'enrol_get_users_courses')">enrol_get_users_courses</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, false)) {
<a name="l115"><span class="linenum"> 115</span></a>              <a class="var it7917" onMouseOver="hilite(7917)" onMouseOut="lolite()" onClick="logVariable('userdata')" href="../../_variables/userdata.html">$userdata</a>['myhosts'][] = array('name'=&gt; <a class="var it940" onMouseOver="hilite(940)" onMouseOut="lolite()" onClick="logVariable('SITE')" href="../../_variables/SITE.html">$SITE</a>-&gt;<a onClick="logVariable('shortname')" class="var it43008" onMouseOver="hilite(43008)" onMouseOut="lolite()" href="../../_variables/shortname.html">shortname</a>, 'url' =&gt; <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>, 'count' =&gt; <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>));
<a name="l116"><span class="linenum"> 116</span></a>          }
<a name="l117"><span class="linenum"> 117</span></a>  
<a name="l118"><span class="linenum"> 118</span></a>          <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT h.name AS hostname, h.wwwroot, h.id AS hostid,
<a name="l119"><span class="linenum"> 119</span></a>                         <a class="phpfunction" onClick="logFunction('COUNT')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">COUNT</a>(c.id) AS count
<a name="l120"><span class="linenum"> 120</span></a>                    FROM {mnetservice_enrol_courses} c
<a name="l121"><span class="linenum"> 121</span></a>                    JOIN {mnetservice_enrol_enrolments} e <a class="function" onClick="logFunction('ON')" href="../../_functions/on.html" onMouseOver="funcPopup(event,'on')">ON</a> (e.hostid = c.hostid AND e.remotecourseid = c.remoteid)
<a name="l122"><span class="linenum"> 122</span></a>                    JOIN {mnet_host} h ON h.id = c.hostid
<a name="l123"><span class="linenum"> 123</span></a>                   WHERE e.userid = ? AND c.hostid = ?
<a name="l124"><span class="linenum"> 124</span></a>                GROUP BY h.name, h.wwwroot, h.id&quot;;
<a name="l125"><span class="linenum"> 125</span></a>  
<a name="l126"><span class="linenum"> 126</span></a>          if (<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, array(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a>-&gt;<a onClick="logVariable('id')" class="var it44373" onMouseOver="hilite(44373)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l127"><span class="linenum"> 127</span></a>              foreach(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a> as <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>) {
<a name="l128"><span class="linenum"> 128</span></a>                  <a class="var it7917" onMouseOver="hilite(7917)" onMouseOut="lolite()" onClick="logVariable('userdata')" href="../../_variables/userdata.html">$userdata</a>['myhosts'][] = array('name'=&gt; <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('hostname')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/hostname.html">hostname</a>, 'url' =&gt; <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>.'/auth/mnet/jump.php?hostid='.<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('hostid')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/hostid.html">hostid</a>, 'count' =&gt; <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('count')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/count.html">count</a>);
<a name="l129"><span class="linenum"> 129</span></a>              }
<a name="l130"><span class="linenum"> 130</span></a>          }
<a name="l131"><span class="linenum"> 131</span></a>  
<a name="l132"><span class="linenum"> 132</span></a>          return <a class="var it7917" onMouseOver="hilite(7917)" onMouseOut="lolite()" onClick="logVariable('userdata')" href="../../_variables/userdata.html">$userdata</a>;
<a name="l133"><span class="linenum"> 133</span></a>      }
<a name="l134"><span class="linenum"> 134</span></a>  
<a name="l135"><span class="linenum"> 135</span></a>      <span class="comment">/**</span>
<a name="l136"><span class="linenum"> 136</span></a>  <span class="comment">     * Generate a random string for use as an RPC session token.</span>
<a name="l137"><span class="linenum"> 137</span></a>  <span class="comment">     */</span>
<a name="l138"><span class="linenum"> 138</span></a>      function <a class="function" onClick="logFunction('generate_token')" href="../../_functions/generate_token.html" onMouseOver="funcPopup(event,'generate_token')">generate_token</a>() {
<a name="l139"><span class="linenum"> 139</span></a>          return <a class="phpfunction" onClick="logFunction('sha1')" href="../../_functions/sha1.html" onMouseOver="phpfuncPopup(event,'sha1')">sha1</a>(<a class="phpfunction" onClick="logFunction('str_shuffle')" href="../../_functions/str_shuffle.html" onMouseOver="phpfuncPopup(event,'str_shuffle')">str_shuffle</a>('' . <a class="phpfunction" onClick="logFunction('mt_rand')" href="../../_functions/mt_rand.html" onMouseOver="phpfuncPopup(event,'mt_rand')">mt_rand</a>() . <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>()));
<a name="l140"><span class="linenum"> 140</span></a>      }
<a name="l141"><span class="linenum"> 141</span></a>  
<a name="l142"><span class="linenum"> 142</span></a>      <span class="comment">/**</span>
<a name="l143"><span class="linenum"> 143</span></a>  <span class="comment">     * Starts an RPC jump session and returns the jump redirect URL.</span>
<a name="l144"><span class="linenum"> 144</span></a>  <span class="comment">     *</span>
<a name="l145"><span class="linenum"> 145</span></a>  <span class="comment">     * @param int $mnethostid id of the mnet host to jump to</span>
<a name="l146"><span class="linenum"> 146</span></a>  <span class="comment">     * @param string $wantsurl url to redirect to after the jump (usually on remote system)</span>
<a name="l147"><span class="linenum"> 147</span></a>  <span class="comment">     * @param boolean $wantsurlbackhere defaults to false, means that the remote system should bounce us back here</span>
<a name="l148"><span class="linenum"> 148</span></a>  <span class="comment">     *                                  rather than somewhere inside *its* wwwroot</span>
<a name="l149"><span class="linenum"> 149</span></a>  <span class="comment">     */</span>
<a name="l150"><span class="linenum"> 150</span></a>      function <a class="function" onClick="logFunction('start_jump_session')" href="../../_functions/start_jump_session.html" onMouseOver="funcPopup(event,'start_jump_session')">start_jump_session</a>(<a class="var it3328" onMouseOver="hilite(3328)" onMouseOut="lolite()" onClick="logVariable('mnethostid')" href="../../_variables/mnethostid.html">$mnethostid</a>, <a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('wantsurl')" href="../../_variables/wantsurl.html">$wantsurl</a>, <a class="var it21678" onMouseOver="hilite(21678)" onMouseOut="lolite()" onClick="logVariable('wantsurlbackhere')" href="../../_variables/wantsurlbackhere.html">$wantsurlbackhere</a>=false) {
<a name="l151"><span class="linenum"> 151</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l152"><span class="linenum"> 152</span></a>          require_once <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a> . '<a class="filename" href="../../mnet/xmlrpc/client.php.html">/mnet/xmlrpc/client.php</a>';
<a name="l153"><span class="linenum"> 153</span></a>  
<a name="l154"><span class="linenum"> 154</span></a>          if (\core\session\<a class="class" onClick="logClass('manager')" href="../../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('is_loggedinas')" href="../../_functions/is_loggedinas.html" onMouseOver="funcPopup(event,'is_loggedinas')">is_loggedinas</a>()) {
<a name="l155"><span class="linenum"> 155</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('notpermittedtojumpas', 'mnet');
<a name="l156"><span class="linenum"> 156</span></a>          }
<a name="l157"><span class="linenum"> 157</span></a>  
<a name="l158"><span class="linenum"> 158</span></a>  <span class="comment">        // check remote login permissions</span>
<a name="l159"><span class="linenum"> 159</span></a>          if (! <a class="function" onClick="logFunction('has_capability')" href="../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/site:mnetlogintoremote', <a class="class" onClick="logClass('context_system')" href="../../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>())
<a name="l160"><span class="linenum"> 160</span></a>                  or <a class="function" onClick="logFunction('is_mnet_remote_user')" href="../../_functions/is_mnet_remote_user.html" onMouseOver="funcPopup(event,'is_mnet_remote_user')">is_mnet_remote_user</a>(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>)
<a name="l161"><span class="linenum"> 161</span></a>                  or <a class="function" onClick="logFunction('isguestuser')" href="../../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>()
<a name="l162"><span class="linenum"> 162</span></a>                  or !<a class="function" onClick="logFunction('isloggedin')" href="../../_functions/isloggedin.html" onMouseOver="funcPopup(event,'isloggedin')">isloggedin</a>()) {
<a name="l163"><span class="linenum"> 163</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('notpermittedtojump', 'mnet');
<a name="l164"><span class="linenum"> 164</span></a>          }
<a name="l165"><span class="linenum"> 165</span></a>  
<a name="l166"><span class="linenum"> 166</span></a>  <span class="comment">        // check for SSO publish permission first</span>
<a name="l167"><span class="linenum"> 167</span></a>          if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('has_service')" href="../../_functions/has_service.html" onMouseOver="funcPopup(event,'has_service')">has_service</a>(<a class="var it3328" onMouseOver="hilite(3328)" onMouseOut="lolite()" onClick="logVariable('mnethostid')" href="../../_variables/mnethostid.html">$mnethostid</a>, 'sso_sp') == false) {
<a name="l168"><span class="linenum"> 168</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('hostnotconfiguredforsso', 'mnet');
<a name="l169"><span class="linenum"> 169</span></a>          }
<a name="l170"><span class="linenum"> 170</span></a>  
<a name="l171"><span class="linenum"> 171</span></a>  <span class="comment">        // set RPC timeout to 30 seconds if not configured</span>
<a name="l172"><span class="linenum"> 172</span></a>          if (empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;rpc_negotiation_timeout)) {
<a name="l173"><span class="linenum"> 173</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;rpc_negotiation_timeout = 30;
<a name="l174"><span class="linenum"> 174</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('rpc_negotiation_timeout', '30', 'auth_mnet');
<a name="l175"><span class="linenum"> 175</span></a>          }
<a name="l176"><span class="linenum"> 176</span></a>  
<a name="l177"><span class="linenum"> 177</span></a>  <span class="comment">        // get the host info</span>
<a name="l178"><span class="linenum"> 178</span></a>          <a class="var it1361" onMouseOver="hilite(1361)" onMouseOut="lolite()" onClick="logVariable('mnet_peer')" href="../../_variables/mnet_peer.html">$mnet_peer</a> = <span class="keyword">new </span><a class="class" onClick="logClass('mnet_peer')" href="../../_classes/mnet_peer.html" onMouseOver="classPopup(event,'mnet_peer')">mnet_peer</a>();
<a name="l179"><span class="linenum"> 179</span></a>          <a class="var it1361" onMouseOver="hilite(1361)" onMouseOut="lolite()" onClick="logVariable('mnet_peer')" href="../../_variables/mnet_peer.html">$mnet_peer</a>-&gt;<a class="function" onClick="logFunction('set_id')" href="../../_functions/set_id.html" onMouseOver="funcPopup(event,'set_id')">set_id</a>(<a class="var it3328" onMouseOver="hilite(3328)" onMouseOut="lolite()" onClick="logVariable('mnethostid')" href="../../_variables/mnethostid.html">$mnethostid</a>);
<a name="l180"><span class="linenum"> 180</span></a>  
<a name="l181"><span class="linenum"> 181</span></a>  <span class="comment">        // set up the session</span>
<a name="l182"><span class="linenum"> 182</span></a>          <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('mnet_session',
<a name="l183"><span class="linenum"> 183</span></a>                                     array('userid'=&gt;<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'mnethostid'=&gt;<a class="var it3328" onMouseOver="hilite(3328)" onMouseOut="lolite()" onClick="logVariable('mnethostid')" href="../../_variables/mnethostid.html">$mnethostid</a>,
<a name="l184"><span class="linenum"> 184</span></a>                                     'useragent'=&gt;<a class="phpfunction" onClick="logFunction('sha1')" href="../../_functions/sha1.html" onMouseOver="phpfuncPopup(event,'sha1')">sha1</a>(<a class="var it836" onMouseOver="hilite(836)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['HTTP_USER_AGENT'])));
<a name="l185"><span class="linenum"> 185</span></a>          if (<a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a> == false) {
<a name="l186"><span class="linenum"> 186</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a> = new stdClass();
<a name="l187"><span class="linenum"> 187</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/mnethostid.html">mnethostid</a> = <a class="var it3328" onMouseOver="hilite(3328)" onMouseOut="lolite()" onClick="logVariable('mnethostid')" href="../../_variables/mnethostid.html">$mnethostid</a>;
<a name="l188"><span class="linenum"> 188</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('userid')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> = <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l189"><span class="linenum"> 189</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('username')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/username.html">username</a> = <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('username')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>;
<a name="l190"><span class="linenum"> 190</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('useragent')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/useragent.html">useragent</a> = <a class="phpfunction" onClick="logFunction('sha1')" href="../../_functions/sha1.html" onMouseOver="phpfuncPopup(event,'sha1')">sha1</a>(<a class="var it836" onMouseOver="hilite(836)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['HTTP_USER_AGENT']);
<a name="l191"><span class="linenum"> 191</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('token')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/token.html">token</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('generate_token')" href="../../_functions/generate_token.html" onMouseOver="funcPopup(event,'generate_token')">generate_token</a>();
<a name="l192"><span class="linenum"> 192</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('confirm_timeout')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/confirm_timeout.html">confirm_timeout</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() + <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;rpc_negotiation_timeout;
<a name="l193"><span class="linenum"> 193</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('expires')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/expires.html">expires</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() + (integer)<a class="phpfunction" onClick="logFunction('ini_get')" href="../../_functions/ini_get.html" onMouseOver="phpfuncPopup(event,'ini_get')">ini_get</a>('session.gc_maxlifetime');
<a name="l194"><span class="linenum"> 194</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('session_id')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/session_id.html">session_id</a> = <a class="phpfunction" onClick="logFunction('session_id')" href="../../_functions/session_id.html" onMouseOver="phpfuncPopup(event,'session_id')">session_id</a>();
<a name="l195"><span class="linenum"> 195</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('id')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('mnet_session', <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>);
<a name="l196"><span class="linenum"> 196</span></a>          } else {
<a name="l197"><span class="linenum"> 197</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('useragent')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/useragent.html">useragent</a> = <a class="phpfunction" onClick="logFunction('sha1')" href="../../_functions/sha1.html" onMouseOver="phpfuncPopup(event,'sha1')">sha1</a>(<a class="var it836" onMouseOver="hilite(836)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['HTTP_USER_AGENT']);
<a name="l198"><span class="linenum"> 198</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('token')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/token.html">token</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('generate_token')" href="../../_functions/generate_token.html" onMouseOver="funcPopup(event,'generate_token')">generate_token</a>();
<a name="l199"><span class="linenum"> 199</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('confirm_timeout')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/confirm_timeout.html">confirm_timeout</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() + <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/config.html">config</a>-&gt;rpc_negotiation_timeout;
<a name="l200"><span class="linenum"> 200</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('expires')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/expires.html">expires</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() + (integer)<a class="phpfunction" onClick="logFunction('ini_get')" href="../../_functions/ini_get.html" onMouseOver="phpfuncPopup(event,'ini_get')">ini_get</a>('session.gc_maxlifetime');
<a name="l201"><span class="linenum"> 201</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('session_id')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/session_id.html">session_id</a> = <a class="phpfunction" onClick="logFunction('session_id')" href="../../_functions/session_id.html" onMouseOver="phpfuncPopup(event,'session_id')">session_id</a>();
<a name="l202"><span class="linenum"> 202</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('mnet_session', <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>);
<a name="l203"><span class="linenum"> 203</span></a>          }
<a name="l204"><span class="linenum"> 204</span></a>  
<a name="l205"><span class="linenum"> 205</span></a>  <span class="comment">        // construct the redirection URL</span>
<a name="l206"><span class="linenum"> 206</span></a>  <span class="comment">        //$transport = mnet_get_protocol($mnet_peer-&gt;transport);</span>
<a name="l207"><span class="linenum"> 207</span></a>          <a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('wantsurl')" href="../../_variables/wantsurl.html">$wantsurl</a> = <a class="phpfunction" onClick="logFunction('urlencode')" href="../../_functions/urlencode.html" onMouseOver="phpfuncPopup(event,'urlencode')">urlencode</a>(<a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('wantsurl')" href="../../_variables/wantsurl.html">$wantsurl</a>);
<a name="l208"><span class="linenum"> 208</span></a>          <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = &quot;{<a class="var it1361" onMouseOver="hilite(1361)" onMouseOut="lolite()" onClick="logVariable('mnet_peer')" href="../../_variables/mnet_peer.html">$mnet_peer</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it44374" onMouseOver="hilite(44374)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>}{<a class="var it1361" onMouseOver="hilite(1361)" onMouseOut="lolite()" onClick="logVariable('mnet_peer')" href="../../_variables/mnet_peer.html">$mnet_peer</a>-&gt;<a onClick="logVariable('application')" class="var it44374" onMouseOver="hilite(44374)" onMouseOut="lolite()" href="../../_variables/application.html">application</a>-&gt;sso_land_url}?token={<a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('token')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/token.html">token</a>}&amp;idp={<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('mnet')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/mnet.html">mnet</a>-&gt;wwwroot}&amp;wantsurl={<a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('wantsurl')" href="../../_variables/wantsurl.html">$wantsurl</a>}&quot;;
<a name="l209"><span class="linenum"> 209</span></a>          if (<a class="var it21678" onMouseOver="hilite(21678)" onMouseOut="lolite()" onClick="logVariable('wantsurlbackhere')" href="../../_variables/wantsurlbackhere.html">$wantsurlbackhere</a>) {
<a name="l210"><span class="linenum"> 210</span></a>              <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> .= '&amp;remoteurl=1';
<a name="l211"><span class="linenum"> 211</span></a>          }
<a name="l212"><span class="linenum"> 212</span></a>  
<a name="l213"><span class="linenum"> 213</span></a>          return <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>;
<a name="l214"><span class="linenum"> 214</span></a>      }
<a name="l215"><span class="linenum"> 215</span></a>  
<a name="l216"><span class="linenum"> 216</span></a>      <span class="comment">/**</span>
<a name="l217"><span class="linenum"> 217</span></a>  <span class="comment">     * This function confirms the remote (ID provider) host's mnet session</span>
<a name="l218"><span class="linenum"> 218</span></a>  <span class="comment">     * by communicating the token and UA over the XMLRPC transport layer, and</span>
<a name="l219"><span class="linenum"> 219</span></a>  <span class="comment">     * returns the local user record on success.</span>
<a name="l220"><span class="linenum"> 220</span></a>  <span class="comment">     *</span>
<a name="l221"><span class="linenum"> 221</span></a>  <span class="comment">     *   @param string    $token           The random session token.</span>
<a name="l222"><span class="linenum"> 222</span></a>  <span class="comment">     *   @param mnet_peer $remotepeer   The ID provider mnet_peer object.</span>
<a name="l223"><span class="linenum"> 223</span></a>  <span class="comment">     *   @return array The local user record.</span>
<a name="l224"><span class="linenum"> 224</span></a>  <span class="comment">     */</span>
<a name="l225"><span class="linenum"> 225</span></a>      function <a class="function" onClick="logFunction('confirm_mnet_session')" href="../../_functions/confirm_mnet_session.html" onMouseOver="funcPopup(event,'confirm_mnet_session')">confirm_mnet_session</a>(<a class="var it310" onMouseOver="hilite(310)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>, <a class="var it8151" onMouseOver="hilite(8151)" onMouseOut="lolite()" onClick="logVariable('remotepeer')" href="../../_variables/remotepeer.html">$remotepeer</a>) {
<a name="l226"><span class="linenum"> 226</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l227"><span class="linenum"> 227</span></a>          require_once <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a> . '<a class="filename" href="../../mnet/xmlrpc/client.php.html">/mnet/xmlrpc/client.php</a>';
<a name="l228"><span class="linenum"> 228</span></a>          require_once <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a> . '/gdlib.php';
<a name="l229"><span class="linenum"> 229</span></a>          require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../user/lib.php.html">/user/lib.php</a>');
<a name="l230"><span class="linenum"> 230</span></a>  
<a name="l231"><span class="linenum"> 231</span></a>  <span class="comment">        // verify the remote host is configured locally before attempting RPC call</span>
<a name="l232"><span class="linenum"> 232</span></a>          if (! <a class="var it21680" onMouseOver="hilite(21680)" onMouseOut="lolite()" onClick="logVariable('remotehost')" href="../../_variables/remotehost.html">$remotehost</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('mnet_host', array('wwwroot' =&gt; <a class="var it8151" onMouseOver="hilite(8151)" onMouseOut="lolite()" onClick="logVariable('remotepeer')" href="../../_variables/remotepeer.html">$remotepeer</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it44375" onMouseOver="hilite(44375)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>, 'deleted' =&gt; 0))) {
<a name="l233"><span class="linenum"> 233</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('notpermittedtoland', 'mnet');
<a name="l234"><span class="linenum"> 234</span></a>          }
<a name="l235"><span class="linenum"> 235</span></a>  
<a name="l236"><span class="linenum"> 236</span></a>  <span class="comment">        // set up the RPC request</span>
<a name="l237"><span class="linenum"> 237</span></a>          <a class="var it20403" onMouseOver="hilite(20403)" onMouseOut="lolite()" onClick="logVariable('mnetrequest')" href="../../_variables/mnetrequest.html">$mnetrequest</a> = <span class="keyword">new </span><a class="class" onClick="logClass('mnet_xmlrpc_client')" href="../../_classes/mnet_xmlrpc_client.html" onMouseOver="classPopup(event,'mnet_xmlrpc_client')">mnet_xmlrpc_client</a>();
<a name="l238"><span class="linenum"> 238</span></a>          <a class="var it20403" onMouseOver="hilite(20403)" onMouseOut="lolite()" onClick="logVariable('mnetrequest')" href="../../_variables/mnetrequest.html">$mnetrequest</a>-&gt;<a class="function" onClick="logFunction('set_method')" href="../../_functions/set_method.html" onMouseOver="funcPopup(event,'set_method')">set_method</a>('auth/mnet/auth.php/user_authorise');
<a name="l239"><span class="linenum"> 239</span></a>  
<a name="l240"><span class="linenum"> 240</span></a>  <span class="comment">        // set $token and $useragent parameters</span>
<a name="l241"><span class="linenum"> 241</span></a>          <a class="var it20403" onMouseOver="hilite(20403)" onMouseOut="lolite()" onClick="logVariable('mnetrequest')" href="../../_variables/mnetrequest.html">$mnetrequest</a>-&gt;<a class="function" onClick="logFunction('add_param')" href="../../_functions/add_param.html" onMouseOver="funcPopup(event,'add_param')">add_param</a>(<a class="var it310" onMouseOver="hilite(310)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>);
<a name="l242"><span class="linenum"> 242</span></a>          <a class="var it20403" onMouseOver="hilite(20403)" onMouseOut="lolite()" onClick="logVariable('mnetrequest')" href="../../_variables/mnetrequest.html">$mnetrequest</a>-&gt;<a class="function" onClick="logFunction('add_param')" href="../../_functions/add_param.html" onMouseOver="funcPopup(event,'add_param')">add_param</a>(<a class="phpfunction" onClick="logFunction('sha1')" href="../../_functions/sha1.html" onMouseOver="phpfuncPopup(event,'sha1')">sha1</a>(<a class="var it836" onMouseOver="hilite(836)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['HTTP_USER_AGENT']));
<a name="l243"><span class="linenum"> 243</span></a>  
<a name="l244"><span class="linenum"> 244</span></a>  <span class="comment">        // Thunderbirds are go! Do RPC call and store response</span>
<a name="l245"><span class="linenum"> 245</span></a>          if (<a class="var it20403" onMouseOver="hilite(20403)" onMouseOut="lolite()" onClick="logVariable('mnetrequest')" href="../../_variables/mnetrequest.html">$mnetrequest</a>-&gt;<a class="function" onClick="logFunction('send')" href="../../_functions/send.html" onMouseOver="funcPopup(event,'send')">send</a>(<a class="var it8151" onMouseOver="hilite(8151)" onMouseOut="lolite()" onClick="logVariable('remotepeer')" href="../../_variables/remotepeer.html">$remotepeer</a>) === true) {
<a name="l246"><span class="linenum"> 246</span></a>              <a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a> = (object) <a class="var it20403" onMouseOver="hilite(20403)" onMouseOut="lolite()" onClick="logVariable('mnetrequest')" href="../../_variables/mnetrequest.html">$mnetrequest</a>-&gt;<a onClick="logVariable('response')" class="var it44376" onMouseOver="hilite(44376)" onMouseOut="lolite()" href="../../_variables/response.html">response</a>;
<a name="l247"><span class="linenum"> 247</span></a>          } else {
<a name="l248"><span class="linenum"> 248</span></a>              foreach (<a class="var it20403" onMouseOver="hilite(20403)" onMouseOut="lolite()" onClick="logVariable('mnetrequest')" href="../../_variables/mnetrequest.html">$mnetrequest</a>-&gt;<a onClick="logVariable('error')" class="var it44376" onMouseOver="hilite(44376)" onMouseOut="lolite()" href="../../_variables/error.html">error</a> as <a class="var it2692" onMouseOver="hilite(2692)" onMouseOut="lolite()" onClick="logVariable('errormessage')" href="../../_variables/errormessage.html">$errormessage</a>) {
<a name="l249"><span class="linenum"> 249</span></a>                  <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it1960" onMouseOver="hilite(1960)" onMouseOut="lolite()" onClick="logVariable('code')" href="../../_variables/code.html">$code</a>, <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../_variables/message.html">$message</a>) = <a class="phpfunction" onClick="logFunction('array_map')" href="../../_functions/array_map.html" onMouseOver="phpfuncPopup(event,'array_map')">array_map</a>('trim',<a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(':', <a class="var it2692" onMouseOver="hilite(2692)" onMouseOut="lolite()" onClick="logVariable('errormessage')" href="../../_variables/errormessage.html">$errormessage</a>, 2));
<a name="l250"><span class="linenum"> 250</span></a>                  if(<a class="var it1960" onMouseOver="hilite(1960)" onMouseOut="lolite()" onClick="logVariable('code')" href="../../_variables/code.html">$code</a> == 702) {
<a name="l251"><span class="linenum"> 251</span></a>                      <a class="var it366" onMouseOver="hilite(366)" onMouseOut="lolite()" onClick="logVariable('site')" href="../../_variables/site.html">$site</a> = <a class="function" onClick="logFunction('get_site')" href="../../_functions/get_site.html" onMouseOver="funcPopup(event,'get_site')">get_site</a>();
<a name="l252"><span class="linenum"> 252</span></a>                      <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('mnet_session_prohibited', 'mnet', <a class="var it8151" onMouseOver="hilite(8151)" onMouseOut="lolite()" onClick="logVariable('remotepeer')" href="../../_variables/remotepeer.html">$remotepeer</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it44375" onMouseOver="hilite(44375)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>, <a class="function" onClick="logFunction('format_string')" href="../../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it366" onMouseOver="hilite(366)" onMouseOut="lolite()" onClick="logVariable('site')" href="../../_variables/site.html">$site</a>-&gt;<a onClick="logVariable('fullname')" class="var it42988" onMouseOver="hilite(42988)" onMouseOut="lolite()" href="../../_variables/fullname.html">fullname</a>));
<a name="l253"><span class="linenum"> 253</span></a>                      exit;
<a name="l254"><span class="linenum"> 254</span></a>                  }
<a name="l255"><span class="linenum"> 255</span></a>                  <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../_variables/message.html">$message</a> .= &quot;ERROR <a class="var it1960" onMouseOver="hilite(1960)" onMouseOut="lolite()" onClick="logVariable('code')" href="../../_variables/code.html">$code</a>:&lt;br/&gt;<a class="var it2692" onMouseOver="hilite(2692)" onMouseOut="lolite()" onClick="logVariable('errormessage')" href="../../_variables/errormessage.html">$errormessage</a>&lt;br/&gt;&quot;;
<a name="l256"><span class="linenum"> 256</span></a>              }
<a name="l257"><span class="linenum"> 257</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>(&quot;rpcerror&quot;, '', '', <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../_variables/message.html">$message</a>);
<a name="l258"><span class="linenum"> 258</span></a>          }
<a name="l259"><span class="linenum"> 259</span></a>          unset(<a class="var it20403" onMouseOver="hilite(20403)" onMouseOut="lolite()" onClick="logVariable('mnetrequest')" href="../../_variables/mnetrequest.html">$mnetrequest</a>);
<a name="l260"><span class="linenum"> 260</span></a>  
<a name="l261"><span class="linenum"> 261</span></a>          if (empty(<a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>) or empty(<a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>-&gt;<a onClick="logVariable('username')" class="var it44301" onMouseOver="hilite(44301)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>)) {
<a name="l262"><span class="linenum"> 262</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('unknownerror', 'mnet');
<a name="l263"><span class="linenum"> 263</span></a>              exit;
<a name="l264"><span class="linenum"> 264</span></a>          }
<a name="l265"><span class="linenum"> 265</span></a>  
<a name="l266"><span class="linenum"> 266</span></a>          if (<a class="function" onClick="logFunction('user_not_fully_set_up')" href="../../_functions/user_not_fully_set_up.html" onMouseOver="funcPopup(event,'user_not_fully_set_up')">user_not_fully_set_up</a>(<a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>)) {
<a name="l267"><span class="linenum"> 267</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('notenoughidpinfo', 'mnet');
<a name="l268"><span class="linenum"> 268</span></a>              exit;
<a name="l269"><span class="linenum"> 269</span></a>          }
<a name="l270"><span class="linenum"> 270</span></a>  
<a name="l271"><span class="linenum"> 271</span></a>          <a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a> = <a class="function" onClick="logFunction('mnet_strip_user')" href="../../_functions/mnet_strip_user.html" onMouseOver="funcPopup(event,'mnet_strip_user')">mnet_strip_user</a>(<a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>, <a class="function" onClick="logFunction('mnet_fields_to_import')" href="../../_functions/mnet_fields_to_import.html" onMouseOver="funcPopup(event,'mnet_fields_to_import')">mnet_fields_to_import</a>(<a class="var it8151" onMouseOver="hilite(8151)" onMouseOut="lolite()" onClick="logVariable('remotepeer')" href="../../_variables/remotepeer.html">$remotepeer</a>));
<a name="l272"><span class="linenum"> 272</span></a>  
<a name="l273"><span class="linenum"> 273</span></a>          <a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>-&gt;<a onClick="logVariable('auth')" class="var it44301" onMouseOver="hilite(44301)" onMouseOut="lolite()" href="../../_variables/auth.html">auth</a> = 'mnet';
<a name="l274"><span class="linenum"> 274</span></a>          <a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it44301" onMouseOver="hilite(44301)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a> = <a class="var it8151" onMouseOver="hilite(8151)" onMouseOut="lolite()" onClick="logVariable('remotepeer')" href="../../_variables/remotepeer.html">$remotepeer</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it44375" onMouseOver="hilite(44375)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>;
<a name="l275"><span class="linenum"> 275</span></a>  
<a name="l276"><span class="linenum"> 276</span></a>  <span class="comment">        // the user may roam from Moodle 1.x where lang has _utf8 suffix</span>
<a name="l277"><span class="linenum"> 277</span></a>  <span class="comment">        // also, make sure that the lang is actually installed, otherwise set site default</span>
<a name="l278"><span class="linenum"> 278</span></a>          if (isset(<a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>-&gt;<a onClick="logVariable('lang')" class="var it44301" onMouseOver="hilite(44301)" onMouseOut="lolite()" href="../../_variables/lang.html">lang</a>)) {
<a name="l279"><span class="linenum"> 279</span></a>              <a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>-&gt;<a onClick="logVariable('lang')" class="var it44301" onMouseOver="hilite(44301)" onMouseOut="lolite()" href="../../_variables/lang.html">lang</a> = <a class="function" onClick="logFunction('clean_param')" href="../../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('_utf8', '', <a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>-&gt;<a onClick="logVariable('lang')" class="var it44301" onMouseOver="hilite(44301)" onMouseOut="lolite()" href="../../_variables/lang.html">lang</a>), <a class="constant" onClick="logConstant('PARAM_LANG')" href="../../_constants/PARAM_LANG.html" onMouseOver="constPopup(event,'PARAM_LANG')">PARAM_LANG</a>);
<a name="l280"><span class="linenum"> 280</span></a>          }
<a name="l281"><span class="linenum"> 281</span></a>          if (empty(<a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>-&gt;<a onClick="logVariable('lang')" class="var it44301" onMouseOver="hilite(44301)" onMouseOut="lolite()" href="../../_variables/lang.html">lang</a>)) {
<a name="l282"><span class="linenum"> 282</span></a>              if (!empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('lang')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/lang.html">lang</a>)) {
<a name="l283"><span class="linenum"> 283</span></a>                  <a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>-&gt;<a onClick="logVariable('lang')" class="var it44301" onMouseOver="hilite(44301)" onMouseOut="lolite()" href="../../_variables/lang.html">lang</a> = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('lang')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/lang.html">lang</a>;
<a name="l284"><span class="linenum"> 284</span></a>              } else {
<a name="l285"><span class="linenum"> 285</span></a>                  <a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>-&gt;<a onClick="logVariable('lang')" class="var it44301" onMouseOver="hilite(44301)" onMouseOut="lolite()" href="../../_variables/lang.html">lang</a> = 'en';
<a name="l286"><span class="linenum"> 286</span></a>              }
<a name="l287"><span class="linenum"> 287</span></a>          }
<a name="l288"><span class="linenum"> 288</span></a>          <a class="var it21681" onMouseOver="hilite(21681)" onMouseOut="lolite()" onClick="logVariable('firsttime')" href="../../_variables/firsttime.html">$firsttime</a> = false;
<a name="l289"><span class="linenum"> 289</span></a>  
<a name="l290"><span class="linenum"> 290</span></a>  <span class="comment">        // get the local record for the remote user</span>
<a name="l291"><span class="linenum"> 291</span></a>          <a class="var it8152" onMouseOver="hilite(8152)" onMouseOut="lolite()" onClick="logVariable('localuser')" href="../../_variables/localuser.html">$localuser</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user', array('username'=&gt;<a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>-&gt;<a onClick="logVariable('username')" class="var it44301" onMouseOver="hilite(44301)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>, 'mnethostid'=&gt;<a class="var it21680" onMouseOver="hilite(21680)" onMouseOut="lolite()" onClick="logVariable('remotehost')" href="../../_variables/remotehost.html">$remotehost</a>-&gt;<a onClick="logVariable('id')" class="var it44302" onMouseOver="hilite(44302)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l292"><span class="linenum"> 292</span></a>  
<a name="l293"><span class="linenum"> 293</span></a>  <span class="comment">        // add the remote user to the database if necessary, and if allowed</span>
<a name="l294"><span class="linenum"> 294</span></a>  <span class="comment">        // TODO: refactor into a separate function</span>
<a name="l295"><span class="linenum"> 295</span></a>          if (empty(<a class="var it8152" onMouseOver="hilite(8152)" onMouseOut="lolite()" onClick="logVariable('localuser')" href="../../_variables/localuser.html">$localuser</a>) || ! <a class="var it8152" onMouseOver="hilite(8152)" onMouseOut="lolite()" onClick="logVariable('localuser')" href="../../_variables/localuser.html">$localuser</a>-&gt;<a onClick="logVariable('id')" class="var it44377" onMouseOver="hilite(44377)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>) {
<a name="l296"><span class="linenum"> 296</span></a>              <span class="comment">/*</span>
<a name="l297"><span class="linenum"> 297</span></a>  <span class="comment">            if (empty($this-&gt;config-&gt;auto_add_remote_users)) {</span>
<a name="l298"><span class="linenum"> 298</span></a>  <span class="comment">                print_error('nolocaluser', 'mnet');</span>
<a name="l299"><span class="linenum"> 299</span></a>  <span class="comment">            } See MDL-21327   for why this is commented out</span>
<a name="l300"><span class="linenum"> 300</span></a>  <span class="comment">            */</span>
<a name="l301"><span class="linenum"> 301</span></a>              <a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it44301" onMouseOver="hilite(44301)" onMouseOut="lolite()" href="../../_variables/mnethostid.html">mnethostid</a> = <a class="var it21680" onMouseOver="hilite(21680)" onMouseOut="lolite()" onClick="logVariable('remotehost')" href="../../_variables/remotehost.html">$remotehost</a>-&gt;<a onClick="logVariable('id')" class="var it44302" onMouseOver="hilite(44302)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l302"><span class="linenum"> 302</span></a>              <a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>-&gt;<a onClick="logVariable('firstaccess')" class="var it44301" onMouseOver="hilite(44301)" onMouseOut="lolite()" href="../../_variables/firstaccess.html">firstaccess</a> = 0;
<a name="l303"><span class="linenum"> 303</span></a>              <a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>-&gt;<a onClick="logVariable('confirmed')" class="var it44301" onMouseOver="hilite(44301)" onMouseOut="lolite()" href="../../_variables/confirmed.html">confirmed</a> = 1;
<a name="l304"><span class="linenum"> 304</span></a>  
<a name="l305"><span class="linenum"> 305</span></a>              <a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>-&gt;<a onClick="logVariable('id')" class="var it44301" onMouseOver="hilite(44301)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="function" onClick="logFunction('user_create_user')" href="../../_functions/user_create_user.html" onMouseOver="funcPopup(event,'user_create_user')">user_create_user</a>(<a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>, false);
<a name="l306"><span class="linenum"> 306</span></a>              <a class="var it21681" onMouseOver="hilite(21681)" onMouseOut="lolite()" onClick="logVariable('firsttime')" href="../../_variables/firsttime.html">$firsttime</a> = true;
<a name="l307"><span class="linenum"> 307</span></a>              <a class="var it8152" onMouseOver="hilite(8152)" onMouseOut="lolite()" onClick="logVariable('localuser')" href="../../_variables/localuser.html">$localuser</a> = <a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>;
<a name="l308"><span class="linenum"> 308</span></a>          }
<a name="l309"><span class="linenum"> 309</span></a>  
<a name="l310"><span class="linenum"> 310</span></a>  <span class="comment">        // check sso access control list for permission first</span>
<a name="l311"><span class="linenum"> 311</span></a>          if (!<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('can_login_remotely')" href="../../_functions/can_login_remotely.html" onMouseOver="funcPopup(event,'can_login_remotely')">can_login_remotely</a>(<a class="var it8152" onMouseOver="hilite(8152)" onMouseOut="lolite()" onClick="logVariable('localuser')" href="../../_variables/localuser.html">$localuser</a>-&gt;<a onClick="logVariable('username')" class="var it44377" onMouseOver="hilite(44377)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>, <a class="var it21680" onMouseOver="hilite(21680)" onMouseOut="lolite()" onClick="logVariable('remotehost')" href="../../_variables/remotehost.html">$remotehost</a>-&gt;<a onClick="logVariable('id')" class="var it44302" onMouseOver="hilite(44302)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>)) {
<a name="l312"><span class="linenum"> 312</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('sso_mnet_login_refused', 'mnet', '', array('user'=&gt;<a class="var it8152" onMouseOver="hilite(8152)" onMouseOut="lolite()" onClick="logVariable('localuser')" href="../../_variables/localuser.html">$localuser</a>-&gt;<a onClick="logVariable('username')" class="var it44377" onMouseOver="hilite(44377)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>, 'host'=&gt;<a class="var it21680" onMouseOver="hilite(21680)" onMouseOut="lolite()" onClick="logVariable('remotehost')" href="../../_variables/remotehost.html">$remotehost</a>-&gt;<a onClick="logVariable('name')" class="var it44302" onMouseOver="hilite(44302)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>));
<a name="l313"><span class="linenum"> 313</span></a>          }
<a name="l314"><span class="linenum"> 314</span></a>  
<a name="l315"><span class="linenum"> 315</span></a>          <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a> = <a class="function" onClick="logFunction('get_file_storage')" href="../../_functions/get_file_storage.html" onMouseOver="funcPopup(event,'get_file_storage')">get_file_storage</a>();
<a name="l316"><span class="linenum"> 316</span></a>  
<a name="l317"><span class="linenum"> 317</span></a>  <span class="comment">        // update the local user record with remote user data</span>
<a name="l318"><span class="linenum"> 318</span></a>          foreach ((array) <a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>) {
<a name="l319"><span class="linenum"> 319</span></a>  
<a name="l320"><span class="linenum"> 320</span></a>              if (<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> == '_mnet_userpicture_timemodified' and empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('disableuserimages')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/disableuserimages.html">disableuserimages</a>) and isset(<a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>-&gt;<a onClick="logVariable('picture')" class="var it44301" onMouseOver="hilite(44301)" onMouseOut="lolite()" href="../../_variables/picture.html">picture</a>)) {
<a name="l321"><span class="linenum"> 321</span></a>  <span class="comment">                // update the user picture if there is a newer verion at the identity provider</span>
<a name="l322"><span class="linenum"> 322</span></a>                  <a class="var it639" onMouseOver="hilite(639)" onMouseOut="lolite()" onClick="logVariable('usercontext')" href="../../_variables/usercontext.html">$usercontext</a> = <a class="class" onClick="logClass('context_user')" href="../../_classes/context_user.html" onMouseOver="classPopup(event,'context_user')">context_user</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it8152" onMouseOver="hilite(8152)" onMouseOut="lolite()" onClick="logVariable('localuser')" href="../../_variables/localuser.html">$localuser</a>-&gt;<a onClick="logVariable('id')" class="var it44377" onMouseOver="hilite(44377)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="constant" onClick="logConstant('MUST_EXIST')" href="../../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l323"><span class="linenum"> 323</span></a>                  if (<a class="var it21677" onMouseOver="hilite(21677)" onMouseOut="lolite()" onClick="logVariable('usericonfile')" href="../../_variables/usericonfile.html">$usericonfile</a> = <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('get_file')" href="../../_functions/get_file.html" onMouseOver="funcPopup(event,'get_file')">get_file</a>(<a class="var it639" onMouseOver="hilite(639)" onMouseOut="lolite()" onClick="logVariable('usercontext')" href="../../_variables/usercontext.html">$usercontext</a>-&gt;<a onClick="logVariable('id')" class="var it43024" onMouseOver="hilite(43024)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'user', 'icon', 0, '/', 'f1.png')) {
<a name="l324"><span class="linenum"> 324</span></a>                      <a class="var it21682" onMouseOver="hilite(21682)" onMouseOut="lolite()" onClick="logVariable('localtimemodified')" href="../../_variables/localtimemodified.html">$localtimemodified</a> = <a class="var it21677" onMouseOver="hilite(21677)" onMouseOut="lolite()" onClick="logVariable('usericonfile')" href="../../_variables/usericonfile.html">$usericonfile</a>-&gt;<a class="function" onClick="logFunction('get_timemodified')" href="../../_functions/get_timemodified.html" onMouseOver="funcPopup(event,'get_timemodified')">get_timemodified</a>();
<a name="l325"><span class="linenum"> 325</span></a>                  } else if (<a class="var it21677" onMouseOver="hilite(21677)" onMouseOut="lolite()" onClick="logVariable('usericonfile')" href="../../_variables/usericonfile.html">$usericonfile</a> = <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('get_file')" href="../../_functions/get_file.html" onMouseOver="funcPopup(event,'get_file')">get_file</a>(<a class="var it639" onMouseOver="hilite(639)" onMouseOut="lolite()" onClick="logVariable('usercontext')" href="../../_variables/usercontext.html">$usercontext</a>-&gt;<a onClick="logVariable('id')" class="var it43024" onMouseOver="hilite(43024)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'user', 'icon', 0, '/', 'f1.jpg')) {
<a name="l326"><span class="linenum"> 326</span></a>                      <a class="var it21682" onMouseOver="hilite(21682)" onMouseOut="lolite()" onClick="logVariable('localtimemodified')" href="../../_variables/localtimemodified.html">$localtimemodified</a> = <a class="var it21677" onMouseOver="hilite(21677)" onMouseOut="lolite()" onClick="logVariable('usericonfile')" href="../../_variables/usericonfile.html">$usericonfile</a>-&gt;<a class="function" onClick="logFunction('get_timemodified')" href="../../_functions/get_timemodified.html" onMouseOver="funcPopup(event,'get_timemodified')">get_timemodified</a>();
<a name="l327"><span class="linenum"> 327</span></a>                  } else {
<a name="l328"><span class="linenum"> 328</span></a>                      <a class="var it21682" onMouseOver="hilite(21682)" onMouseOut="lolite()" onClick="logVariable('localtimemodified')" href="../../_variables/localtimemodified.html">$localtimemodified</a> = 0;
<a name="l329"><span class="linenum"> 329</span></a>                  }
<a name="l330"><span class="linenum"> 330</span></a>  
<a name="l331"><span class="linenum"> 331</span></a>                  if (!empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>) and <a class="var it21682" onMouseOver="hilite(21682)" onMouseOut="lolite()" onClick="logVariable('localtimemodified')" href="../../_variables/localtimemodified.html">$localtimemodified</a> &lt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>) {
<a name="l332"><span class="linenum"> 332</span></a>                      <a class="function" onClick="logFunction('mnet_debug')" href="../../_functions/mnet_debug.html" onMouseOver="funcPopup(event,'mnet_debug')">mnet_debug</a>('refetching the user picture from the identity provider host');
<a name="l333"><span class="linenum"> 333</span></a>                      <a class="var it21683" onMouseOver="hilite(21683)" onMouseOut="lolite()" onClick="logVariable('fetchrequest')" href="../../_variables/fetchrequest.html">$fetchrequest</a> = <span class="keyword">new </span><a class="class" onClick="logClass('mnet_xmlrpc_client')" href="../../_classes/mnet_xmlrpc_client.html" onMouseOver="classPopup(event,'mnet_xmlrpc_client')">mnet_xmlrpc_client</a>();
<a name="l334"><span class="linenum"> 334</span></a>                      <a class="var it21683" onMouseOver="hilite(21683)" onMouseOut="lolite()" onClick="logVariable('fetchrequest')" href="../../_variables/fetchrequest.html">$fetchrequest</a>-&gt;<a class="function" onClick="logFunction('set_method')" href="../../_functions/set_method.html" onMouseOver="funcPopup(event,'set_method')">set_method</a>('auth/mnet/auth.php/fetch_user_image');
<a name="l335"><span class="linenum"> 335</span></a>                      <a class="var it21683" onMouseOver="hilite(21683)" onMouseOut="lolite()" onClick="logVariable('fetchrequest')" href="../../_variables/fetchrequest.html">$fetchrequest</a>-&gt;<a class="function" onClick="logFunction('add_param')" href="../../_functions/add_param.html" onMouseOver="funcPopup(event,'add_param')">add_param</a>(<a class="var it8152" onMouseOver="hilite(8152)" onMouseOut="lolite()" onClick="logVariable('localuser')" href="../../_variables/localuser.html">$localuser</a>-&gt;<a onClick="logVariable('username')" class="var it44377" onMouseOver="hilite(44377)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>);
<a name="l336"><span class="linenum"> 336</span></a>                      if (<a class="var it21683" onMouseOver="hilite(21683)" onMouseOut="lolite()" onClick="logVariable('fetchrequest')" href="../../_variables/fetchrequest.html">$fetchrequest</a>-&gt;<a class="function" onClick="logFunction('send')" href="../../_functions/send.html" onMouseOver="funcPopup(event,'send')">send</a>(<a class="var it8151" onMouseOver="hilite(8151)" onMouseOut="lolite()" onClick="logVariable('remotepeer')" href="../../_variables/remotepeer.html">$remotepeer</a>) === true) {
<a name="l337"><span class="linenum"> 337</span></a>                          if (<a class="function" onClick="logFunction('strlen')" href="../../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it21683" onMouseOver="hilite(21683)" onMouseOut="lolite()" onClick="logVariable('fetchrequest')" href="../../_variables/fetchrequest.html">$fetchrequest</a>-&gt;<a onClick="logVariable('response')" class="var it44378" onMouseOver="hilite(44378)" onMouseOut="lolite()" href="../../_variables/response.html">response</a>['f1']) &gt; 0) {
<a name="l338"><span class="linenum"> 338</span></a>                              <a class="var it21684" onMouseOver="hilite(21684)" onMouseOut="lolite()" onClick="logVariable('imagefilename')" href="../../_variables/imagefilename.html">$imagefilename</a> = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('tempdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/tempdir.html">tempdir</a> . '/mnet-usericon-' . <a class="var it8152" onMouseOver="hilite(8152)" onMouseOut="lolite()" onClick="logVariable('localuser')" href="../../_variables/localuser.html">$localuser</a>-&gt;<a onClick="logVariable('id')" class="var it44377" onMouseOver="hilite(44377)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l339"><span class="linenum"> 339</span></a>                              <a class="var it21685" onMouseOver="hilite(21685)" onMouseOut="lolite()" onClick="logVariable('imagecontents')" href="../../_variables/imagecontents.html">$imagecontents</a> = <a class="phpfunction" onClick="logFunction('base64_decode')" href="../../_functions/base64_decode.html" onMouseOver="phpfuncPopup(event,'base64_decode')">base64_decode</a>(<a class="var it21683" onMouseOver="hilite(21683)" onMouseOut="lolite()" onClick="logVariable('fetchrequest')" href="../../_variables/fetchrequest.html">$fetchrequest</a>-&gt;<a onClick="logVariable('response')" class="var it44378" onMouseOver="hilite(44378)" onMouseOut="lolite()" href="../../_variables/response.html">response</a>['f1']);
<a name="l340"><span class="linenum"> 340</span></a>                              <a class="phpfunction" onClick="logFunction('file_put_contents')" href="../../_functions/file_put_contents.html" onMouseOver="phpfuncPopup(event,'file_put_contents')">file_put_contents</a>(<a class="var it21684" onMouseOver="hilite(21684)" onMouseOut="lolite()" onClick="logVariable('imagefilename')" href="../../_variables/imagefilename.html">$imagefilename</a>, <a class="var it21685" onMouseOver="hilite(21685)" onMouseOut="lolite()" onClick="logVariable('imagecontents')" href="../../_variables/imagecontents.html">$imagecontents</a>);
<a name="l341"><span class="linenum"> 341</span></a>                              if (<a class="var it6011" onMouseOver="hilite(6011)" onMouseOut="lolite()" onClick="logVariable('newrev')" href="../../_variables/newrev.html">$newrev</a> = <a class="function" onClick="logFunction('process_new_icon')" href="../../_functions/process_new_icon.html" onMouseOver="funcPopup(event,'process_new_icon')">process_new_icon</a>(<a class="var it639" onMouseOver="hilite(639)" onMouseOut="lolite()" onClick="logVariable('usercontext')" href="../../_variables/usercontext.html">$usercontext</a>, 'user', 'icon', 0, <a class="var it21684" onMouseOver="hilite(21684)" onMouseOut="lolite()" onClick="logVariable('imagefilename')" href="../../_variables/imagefilename.html">$imagefilename</a>)) {
<a name="l342"><span class="linenum"> 342</span></a>                                  <a class="var it8152" onMouseOver="hilite(8152)" onMouseOut="lolite()" onClick="logVariable('localuser')" href="../../_variables/localuser.html">$localuser</a>-&gt;<a onClick="logVariable('picture')" class="var it44377" onMouseOver="hilite(44377)" onMouseOut="lolite()" href="../../_variables/picture.html">picture</a> = <a class="var it6011" onMouseOver="hilite(6011)" onMouseOut="lolite()" onClick="logVariable('newrev')" href="../../_variables/newrev.html">$newrev</a>;
<a name="l343"><span class="linenum"> 343</span></a>                              }
<a name="l344"><span class="linenum"> 344</span></a>                              <a class="phpfunction" onClick="logFunction('unlink')" href="../../_functions/unlink.html" onMouseOver="phpfuncPopup(event,'unlink')">unlink</a>(<a class="var it21684" onMouseOver="hilite(21684)" onMouseOut="lolite()" onClick="logVariable('imagefilename')" href="../../_variables/imagefilename.html">$imagefilename</a>);
<a name="l345"><span class="linenum"> 345</span></a>                          }
<a name="l346"><span class="linenum"> 346</span></a>  <span class="comment">                        // note that since Moodle 2.0 we ignore $fetchrequest-&gt;response['f2']</span>
<a name="l347"><span class="linenum"> 347</span></a>  <span class="comment">                        // the mimetype information provided is ignored and the type of the file is detected</span>
<a name="l348"><span class="linenum"> 348</span></a>  <span class="comment">                        // by process_new_icon()</span>
<a name="l349"><span class="linenum"> 349</span></a>                      }
<a name="l350"><span class="linenum"> 350</span></a>                  }
<a name="l351"><span class="linenum"> 351</span></a>              }
<a name="l352"><span class="linenum"> 352</span></a>  
<a name="l353"><span class="linenum"> 353</span></a>              if(<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> == 'myhosts') {
<a name="l354"><span class="linenum"> 354</span></a>                  <a class="var it8152" onMouseOver="hilite(8152)" onMouseOut="lolite()" onClick="logVariable('localuser')" href="../../_variables/localuser.html">$localuser</a>-&gt;<a onClick="logVariable('mnet_foreign_host_array')" class="var it44377" onMouseOver="hilite(44377)" onMouseOut="lolite()" href="../../_variables/mnet_foreign_host_array.html">mnet_foreign_host_array</a> = array();
<a name="l355"><span class="linenum"> 355</span></a>                  foreach(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a> as <a class="var it21686" onMouseOver="hilite(21686)" onMouseOut="lolite()" onClick="logVariable('rhost')" href="../../_variables/rhost.html">$rhost</a>) {
<a name="l356"><span class="linenum"> 356</span></a>                      <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>  = <a class="function" onClick="logFunction('clean_param')" href="../../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it21686" onMouseOver="hilite(21686)" onMouseOut="lolite()" onClick="logVariable('rhost')" href="../../_variables/rhost.html">$rhost</a>['name'], <a class="constant" onClick="logConstant('PARAM_ALPHANUM')" href="../../_constants/PARAM_ALPHANUM.html" onMouseOver="constPopup(event,'PARAM_ALPHANUM')">PARAM_ALPHANUM</a>);
<a name="l357"><span class="linenum"> 357</span></a>                      <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>   = <a class="function" onClick="logFunction('clean_param')" href="../../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it21686" onMouseOver="hilite(21686)" onMouseOut="lolite()" onClick="logVariable('rhost')" href="../../_variables/rhost.html">$rhost</a>['url'], <a class="constant" onClick="logConstant('PARAM_URL')" href="../../_constants/PARAM_URL.html" onMouseOver="constPopup(event,'PARAM_URL')">PARAM_URL</a>);
<a name="l358"><span class="linenum"> 358</span></a>                      <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a> = <a class="function" onClick="logFunction('clean_param')" href="../../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it21686" onMouseOver="hilite(21686)" onMouseOut="lolite()" onClick="logVariable('rhost')" href="../../_variables/rhost.html">$rhost</a>['count'], <a class="constant" onClick="logConstant('PARAM_INT')" href="../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>);
<a name="l359"><span class="linenum"> 359</span></a>                      <a class="var it21687" onMouseOver="hilite(21687)" onMouseOut="lolite()" onClick="logVariable('url_is_local')" href="../../_variables/url_is_local.html">$url_is_local</a> = <a class="phpfunction" onClick="logFunction('stristr')" href="../../_functions/stristr.html" onMouseOver="phpfuncPopup(event,'stristr')">stristr</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> , <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>);
<a name="l360"><span class="linenum"> 360</span></a>                      if (!empty(<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>) &amp;&amp; !empty(<a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a>) &amp;&amp; empty(<a class="var it21687" onMouseOver="hilite(21687)" onMouseOut="lolite()" onClick="logVariable('url_is_local')" href="../../_variables/url_is_local.html">$url_is_local</a>)) {
<a name="l361"><span class="linenum"> 361</span></a>                          <a class="var it8152" onMouseOver="hilite(8152)" onMouseOut="lolite()" onClick="logVariable('localuser')" href="../../_variables/localuser.html">$localuser</a>-&gt;<a onClick="logVariable('mnet_foreign_host_array')" class="var it44377" onMouseOver="hilite(44377)" onMouseOut="lolite()" href="../../_variables/mnet_foreign_host_array.html">mnet_foreign_host_array</a>[] = array('name'  =&gt; <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>,
<a name="l362"><span class="linenum"> 362</span></a>                                                                        'url'   =&gt; <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>,
<a name="l363"><span class="linenum"> 363</span></a>                                                                        'count' =&gt; <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a>);
<a name="l364"><span class="linenum"> 364</span></a>                      }
<a name="l365"><span class="linenum"> 365</span></a>                  }
<a name="l366"><span class="linenum"> 366</span></a>              }
<a name="l367"><span class="linenum"> 367</span></a>  
<a name="l368"><span class="linenum"> 368</span></a>              <a class="var it8152" onMouseOver="hilite(8152)" onMouseOut="lolite()" onClick="logVariable('localuser')" href="../../_variables/localuser.html">$localuser</a>-&gt;{<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>} = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>;
<a name="l369"><span class="linenum"> 369</span></a>          }
<a name="l370"><span class="linenum"> 370</span></a>  
<a name="l371"><span class="linenum"> 371</span></a>          <a class="var it8152" onMouseOver="hilite(8152)" onMouseOut="lolite()" onClick="logVariable('localuser')" href="../../_variables/localuser.html">$localuser</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it44377" onMouseOver="hilite(44377)" onMouseOut="lolite()" href="../../_variables/mnethostid.html">mnethostid</a> = <a class="var it8151" onMouseOver="hilite(8151)" onMouseOut="lolite()" onClick="logVariable('remotepeer')" href="../../_variables/remotepeer.html">$remotepeer</a>-&gt;<a onClick="logVariable('id')" class="var it44375" onMouseOver="hilite(44375)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l372"><span class="linenum"> 372</span></a>          <a class="function" onClick="logFunction('user_update_user')" href="../../_functions/user_update_user.html" onMouseOver="funcPopup(event,'user_update_user')">user_update_user</a>(<a class="var it8152" onMouseOver="hilite(8152)" onMouseOut="lolite()" onClick="logVariable('localuser')" href="../../_variables/localuser.html">$localuser</a>, false);
<a name="l373"><span class="linenum"> 373</span></a>  
<a name="l374"><span class="linenum"> 374</span></a>          if (!<a class="var it21681" onMouseOver="hilite(21681)" onMouseOut="lolite()" onClick="logVariable('firsttime')" href="../../_variables/firsttime.html">$firsttime</a>) {
<a name="l375"><span class="linenum"> 375</span></a>  <span class="comment">            // repeat customer! let the IDP know about enrolments</span>
<a name="l376"><span class="linenum"> 376</span></a>  <span class="comment">            // we have for this user.</span>
<a name="l377"><span class="linenum"> 377</span></a>  <span class="comment">            // set up the RPC request</span>
<a name="l378"><span class="linenum"> 378</span></a>              <a class="var it20403" onMouseOver="hilite(20403)" onMouseOut="lolite()" onClick="logVariable('mnetrequest')" href="../../_variables/mnetrequest.html">$mnetrequest</a> = <span class="keyword">new </span><a class="class" onClick="logClass('mnet_xmlrpc_client')" href="../../_classes/mnet_xmlrpc_client.html" onMouseOver="classPopup(event,'mnet_xmlrpc_client')">mnet_xmlrpc_client</a>();
<a name="l379"><span class="linenum"> 379</span></a>              <a class="var it20403" onMouseOver="hilite(20403)" onMouseOut="lolite()" onClick="logVariable('mnetrequest')" href="../../_variables/mnetrequest.html">$mnetrequest</a>-&gt;<a class="function" onClick="logFunction('set_method')" href="../../_functions/set_method.html" onMouseOver="funcPopup(event,'set_method')">set_method</a>('auth/mnet/auth.php/update_enrolments');
<a name="l380"><span class="linenum"> 380</span></a>  
<a name="l381"><span class="linenum"> 381</span></a>  <span class="comment">            // pass username and an assoc array of &quot;my courses&quot;</span>
<a name="l382"><span class="linenum"> 382</span></a>  <span class="comment">            // with info so that the IDP can maintain mnetservice_enrol_enrolments</span>
<a name="l383"><span class="linenum"> 383</span></a>              <a class="var it20403" onMouseOver="hilite(20403)" onMouseOut="lolite()" onClick="logVariable('mnetrequest')" href="../../_variables/mnetrequest.html">$mnetrequest</a>-&gt;<a class="function" onClick="logFunction('add_param')" href="../../_functions/add_param.html" onMouseOver="funcPopup(event,'add_param')">add_param</a>(<a class="var it19791" onMouseOver="hilite(19791)" onMouseOut="lolite()" onClick="logVariable('remoteuser')" href="../../_variables/remoteuser.html">$remoteuser</a>-&gt;<a onClick="logVariable('username')" class="var it44301" onMouseOver="hilite(44301)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>);
<a name="l384"><span class="linenum"> 384</span></a>              <a class="var it89" onMouseOver="hilite(89)" onMouseOut="lolite()" onClick="logVariable('fields')" href="../../_variables/fields.html">$fields</a> = 'id, category, sortorder, fullname, shortname, idnumber, summary, startdate, visible';
<a name="l385"><span class="linenum"> 385</span></a>              <a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a> = <a class="function" onClick="logFunction('enrol_get_users_courses')" href="../../_functions/enrol_get_users_courses.html" onMouseOver="funcPopup(event,'enrol_get_users_courses')">enrol_get_users_courses</a>(<a class="var it8152" onMouseOver="hilite(8152)" onMouseOut="lolite()" onClick="logVariable('localuser')" href="../../_variables/localuser.html">$localuser</a>-&gt;<a onClick="logVariable('id')" class="var it44377" onMouseOver="hilite(44377)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, false, <a class="var it89" onMouseOver="hilite(89)" onMouseOut="lolite()" onClick="logVariable('fields')" href="../../_variables/fields.html">$fields</a>, 'visible DESC,sortorder ASC');
<a name="l386"><span class="linenum"> 386</span></a>              if (<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>) &amp;&amp; !empty(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>)) {
<a name="l387"><span class="linenum"> 387</span></a>  <span class="comment">                // Second request to do the JOINs that we'd have done</span>
<a name="l388"><span class="linenum"> 388</span></a>  <span class="comment">                // inside enrol_get_users_courses() if we had been allowed</span>
<a name="l389"><span class="linenum"> 389</span></a>                  <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT c.id,
<a name="l390"><span class="linenum"> 390</span></a>                                 cc.name AS cat_name, cc.description AS cat_description
<a name="l391"><span class="linenum"> 391</span></a>                            FROM {course} c
<a name="l392"><span class="linenum"> 392</span></a>                            JOIN {course_categories} cc ON c.category = cc.id
<a name="l393"><span class="linenum"> 393</span></a>                           WHERE c.id IN (&quot; . <a class="function" onClick="logFunction('join')" href="../../_functions/join.html" onMouseOver="funcPopup(event,'join')">join</a>(',',<a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>)) . ')';
<a name="l394"><span class="linenum"> 394</span></a>                  <a class="var it812" onMouseOver="hilite(812)" onMouseOut="lolite()" onClick="logVariable('extra')" href="../../_variables/extra.html">$extra</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>);
<a name="l395"><span class="linenum"> 395</span></a>  
<a name="l396"><span class="linenum"> 396</span></a>                  <a class="var it408" onMouseOver="hilite(408)" onMouseOut="lolite()" onClick="logVariable('keys')" href="../../_variables/keys.html">$keys</a> = <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>);
<a name="l397"><span class="linenum"> 397</span></a>                  <a class="var it8891" onMouseOver="hilite(8891)" onMouseOut="lolite()" onClick="logVariable('studentroles')" href="../../_variables/studentroles.html">$studentroles</a> = <a class="function" onClick="logFunction('get_archetype_roles')" href="../../_functions/get_archetype_roles.html" onMouseOver="funcPopup(event,'get_archetype_roles')">get_archetype_roles</a>('student');
<a name="l398"><span class="linenum"> 398</span></a>                  if (!empty(<a class="var it8891" onMouseOver="hilite(8891)" onMouseOut="lolite()" onClick="logVariable('studentroles')" href="../../_variables/studentroles.html">$studentroles</a>)) {
<a name="l399"><span class="linenum"> 399</span></a>                      <a class="var it21688" onMouseOver="hilite(21688)" onMouseOut="lolite()" onClick="logVariable('defaultrole')" href="../../_variables/defaultrole.html">$defaultrole</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it8891" onMouseOver="hilite(8891)" onMouseOut="lolite()" onClick="logVariable('studentroles')" href="../../_variables/studentroles.html">$studentroles</a>);
<a name="l400"><span class="linenum"> 400</span></a>  <span class="comment">                    //$defaultrole = get_default_course_role($ccache[$shortname]); //TODO: rewrite this completely, there is no default course role any more!!!</span>
<a name="l401"><span class="linenum"> 401</span></a>                      foreach (<a class="var it408" onMouseOver="hilite(408)" onMouseOut="lolite()" onClick="logVariable('keys')" href="../../_variables/keys.html">$keys</a> AS <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>) {
<a name="l402"><span class="linenum"> 402</span></a>                          if (<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>[<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>]-&gt;visible == 0) {
<a name="l403"><span class="linenum"> 403</span></a>                              unset(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>[<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>]);
<a name="l404"><span class="linenum"> 404</span></a>                              continue;
<a name="l405"><span class="linenum"> 405</span></a>                          }
<a name="l406"><span class="linenum"> 406</span></a>                          <a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>[<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>]-&gt;cat_id          = <a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>[<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>]-&gt;category;
<a name="l407"><span class="linenum"> 407</span></a>                          <a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>[<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>]-&gt;defaultroleid   = <a class="var it21688" onMouseOver="hilite(21688)" onMouseOut="lolite()" onClick="logVariable('defaultrole')" href="../../_variables/defaultrole.html">$defaultrole</a>-&gt;<a onClick="logVariable('id')" class="var it44379" onMouseOver="hilite(44379)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l408"><span class="linenum"> 408</span></a>                          unset(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>[<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>]-&gt;category);
<a name="l409"><span class="linenum"> 409</span></a>                          unset(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>[<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>]-&gt;visible);
<a name="l410"><span class="linenum"> 410</span></a>  
<a name="l411"><span class="linenum"> 411</span></a>                          <a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>[<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>]-&gt;cat_name        = <a class="var it812" onMouseOver="hilite(812)" onMouseOut="lolite()" onClick="logVariable('extra')" href="../../_variables/extra.html">$extra</a>[<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>]-&gt;cat_name;
<a name="l412"><span class="linenum"> 412</span></a>                          <a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>[<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>]-&gt;cat_description = <a class="var it812" onMouseOver="hilite(812)" onMouseOut="lolite()" onClick="logVariable('extra')" href="../../_variables/extra.html">$extra</a>[<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>]-&gt;cat_description;
<a name="l413"><span class="linenum"> 413</span></a>                          <a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>[<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>]-&gt;defaultrolename = <a class="var it21688" onMouseOver="hilite(21688)" onMouseOut="lolite()" onClick="logVariable('defaultrole')" href="../../_variables/defaultrole.html">$defaultrole</a>-&gt;<a onClick="logVariable('name')" class="var it44379" onMouseOver="hilite(44379)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>;
<a name="l414"><span class="linenum"> 414</span></a>  <span class="comment">                        // coerce to array</span>
<a name="l415"><span class="linenum"> 415</span></a>                          <a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>[<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>] = (array)<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>[<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>];
<a name="l416"><span class="linenum"> 416</span></a>                      }
<a name="l417"><span class="linenum"> 417</span></a>                  } else {
<a name="l418"><span class="linenum"> 418</span></a>                      throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('unknownrole', 'error', '', 'student');
<a name="l419"><span class="linenum"> 419</span></a>                  }
<a name="l420"><span class="linenum"> 420</span></a>              } else {
<a name="l421"><span class="linenum"> 421</span></a>  <span class="comment">                // if the array is empty, send it anyway</span>
<a name="l422"><span class="linenum"> 422</span></a>  <span class="comment">                // we may be clearing out stale entries</span>
<a name="l423"><span class="linenum"> 423</span></a>                  <a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a> = array();
<a name="l424"><span class="linenum"> 424</span></a>              }
<a name="l425"><span class="linenum"> 425</span></a>              <a class="var it20403" onMouseOver="hilite(20403)" onMouseOut="lolite()" onClick="logVariable('mnetrequest')" href="../../_variables/mnetrequest.html">$mnetrequest</a>-&gt;<a class="function" onClick="logFunction('add_param')" href="../../_functions/add_param.html" onMouseOver="funcPopup(event,'add_param')">add_param</a>(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>);
<a name="l426"><span class="linenum"> 426</span></a>  
<a name="l427"><span class="linenum"> 427</span></a>  <span class="comment">            // Call 0800-RPC Now! -- we don't care too much if it fails</span>
<a name="l428"><span class="linenum"> 428</span></a>  <span class="comment">            // as it's just informational.</span>
<a name="l429"><span class="linenum"> 429</span></a>              if (<a class="var it20403" onMouseOver="hilite(20403)" onMouseOut="lolite()" onClick="logVariable('mnetrequest')" href="../../_variables/mnetrequest.html">$mnetrequest</a>-&gt;<a class="function" onClick="logFunction('send')" href="../../_functions/send.html" onMouseOver="funcPopup(event,'send')">send</a>(<a class="var it8151" onMouseOver="hilite(8151)" onMouseOut="lolite()" onClick="logVariable('remotepeer')" href="../../_variables/remotepeer.html">$remotepeer</a>) === false) {
<a name="l430"><span class="linenum"> 430</span></a>  <span class="comment">                // error_log(print_r($mnetrequest-&gt;error,1));</span>
<a name="l431"><span class="linenum"> 431</span></a>              }
<a name="l432"><span class="linenum"> 432</span></a>          }
<a name="l433"><span class="linenum"> 433</span></a>  
<a name="l434"><span class="linenum"> 434</span></a>          return <a class="var it8152" onMouseOver="hilite(8152)" onMouseOut="lolite()" onClick="logVariable('localuser')" href="../../_variables/localuser.html">$localuser</a>;
<a name="l435"><span class="linenum"> 435</span></a>      }
<a name="l436"><span class="linenum"> 436</span></a>  
<a name="l437"><span class="linenum"> 437</span></a>  
<a name="l438"><span class="linenum"> 438</span></a>      <span class="comment">/**</span>
<a name="l439"><span class="linenum"> 439</span></a>  <span class="comment">     * creates (or updates) the mnet session once</span>
<a name="l440"><span class="linenum"> 440</span></a>  <span class="comment">     * {@see confirm_mnet_session} and {@see complete_user_login} have both been called</span>
<a name="l441"><span class="linenum"> 441</span></a>  <span class="comment">     *</span>
<a name="l442"><span class="linenum"> 442</span></a>  <span class="comment">     * @param stdclass  $user the local user (must exist already</span>
<a name="l443"><span class="linenum"> 443</span></a>  <span class="comment">     * @param string    $token the jump/land token</span>
<a name="l444"><span class="linenum"> 444</span></a>  <span class="comment">     * @param mnet_peer $remotepeer the mnet_peer object of this users's idp</span>
<a name="l445"><span class="linenum"> 445</span></a>  <span class="comment">     */</span>
<a name="l446"><span class="linenum"> 446</span></a>      public function <a class="function" onClick="logFunction('update_mnet_session')" href="../../_functions/update_mnet_session.html" onMouseOver="funcPopup(event,'update_mnet_session')">update_mnet_session</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>, <a class="var it310" onMouseOver="hilite(310)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>, <a class="var it8151" onMouseOver="hilite(8151)" onMouseOut="lolite()" onClick="logVariable('remotepeer')" href="../../_variables/remotepeer.html">$remotepeer</a>) {
<a name="l447"><span class="linenum"> 447</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l448"><span class="linenum"> 448</span></a>          <a class="var it21689" onMouseOver="hilite(21689)" onMouseOut="lolite()" onClick="logVariable('session_gc_maxlifetime')" href="../../_variables/session_gc_maxlifetime.html">$session_gc_maxlifetime</a> = 1440;
<a name="l449"><span class="linenum"> 449</span></a>          if (isset(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('session_gc_maxlifetime')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/session_gc_maxlifetime.html">session_gc_maxlifetime</a>)) {
<a name="l450"><span class="linenum"> 450</span></a>              <a class="var it21689" onMouseOver="hilite(21689)" onMouseOut="lolite()" onClick="logVariable('session_gc_maxlifetime')" href="../../_variables/session_gc_maxlifetime.html">$session_gc_maxlifetime</a> = <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('session_gc_maxlifetime')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/session_gc_maxlifetime.html">session_gc_maxlifetime</a>;
<a name="l451"><span class="linenum"> 451</span></a>          }
<a name="l452"><span class="linenum"> 452</span></a>          if (!<a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('mnet_session',
<a name="l453"><span class="linenum"> 453</span></a>                                     array('userid'=&gt;<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'mnethostid'=&gt;<a class="var it8151" onMouseOver="hilite(8151)" onMouseOut="lolite()" onClick="logVariable('remotepeer')" href="../../_variables/remotepeer.html">$remotepeer</a>-&gt;<a onClick="logVariable('id')" class="var it44375" onMouseOver="hilite(44375)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l454"><span class="linenum"> 454</span></a>                                     'useragent'=&gt;<a class="phpfunction" onClick="logFunction('sha1')" href="../../_functions/sha1.html" onMouseOver="phpfuncPopup(event,'sha1')">sha1</a>(<a class="var it836" onMouseOver="hilite(836)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['HTTP_USER_AGENT'])))) {
<a name="l455"><span class="linenum"> 455</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a> = new stdClass();
<a name="l456"><span class="linenum"> 456</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/mnethostid.html">mnethostid</a> = <a class="var it8151" onMouseOver="hilite(8151)" onMouseOut="lolite()" onClick="logVariable('remotepeer')" href="../../_variables/remotepeer.html">$remotepeer</a>-&gt;<a onClick="logVariable('id')" class="var it44375" onMouseOver="hilite(44375)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l457"><span class="linenum"> 457</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('userid')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> = <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l458"><span class="linenum"> 458</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('username')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/username.html">username</a> = <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>;
<a name="l459"><span class="linenum"> 459</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('useragent')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/useragent.html">useragent</a> = <a class="phpfunction" onClick="logFunction('sha1')" href="../../_functions/sha1.html" onMouseOver="phpfuncPopup(event,'sha1')">sha1</a>(<a class="var it836" onMouseOver="hilite(836)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['HTTP_USER_AGENT']);
<a name="l460"><span class="linenum"> 460</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('token')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/token.html">token</a> = <a class="var it310" onMouseOver="hilite(310)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>; <span class="comment">// Needed to support simultaneous sessions</span>
<a name="l461"><span class="linenum"> 461</span></a>  <span class="comment">                                           // and preserving DB rec uniqueness</span>
<a name="l462"><span class="linenum"> 462</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('confirm_timeout')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/confirm_timeout.html">confirm_timeout</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l463"><span class="linenum"> 463</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('expires')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/expires.html">expires</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() + (integer)<a class="var it21689" onMouseOver="hilite(21689)" onMouseOut="lolite()" onClick="logVariable('session_gc_maxlifetime')" href="../../_variables/session_gc_maxlifetime.html">$session_gc_maxlifetime</a>;
<a name="l464"><span class="linenum"> 464</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('session_id')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/session_id.html">session_id</a> = <a class="phpfunction" onClick="logFunction('session_id')" href="../../_functions/session_id.html" onMouseOver="phpfuncPopup(event,'session_id')">session_id</a>();
<a name="l465"><span class="linenum"> 465</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('id')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('mnet_session', <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>);
<a name="l466"><span class="linenum"> 466</span></a>          } else {
<a name="l467"><span class="linenum"> 467</span></a>              <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>-&gt;<a onClick="logVariable('expires')" class="var it44372" onMouseOver="hilite(44372)" onMouseOut="lolite()" href="../../_variables/expires.html">expires</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() + (integer)<a class="var it21689" onMouseOver="hilite(21689)" onMouseOut="lolite()" onClick="logVariable('session_gc_maxlifetime')" href="../../_variables/session_gc_maxlifetime.html">$session_gc_maxlifetime</a>;
<a name="l468"><span class="linenum"> 468</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('mnet_session', <a class="var it21675" onMouseOver="hilite(21675)" onMouseOut="lolite()" onClick="logVariable('mnet_session')" href="../../_variables/mnet_session.html">$mnet_session</a>);
<a name="l469"><span class="linenum"> 469</span></a>          }
<a name="l470"><span class="linenum"> 470</span></a>      }
<a name="l471"><span class="linenum"> 471</span></a>  
<a name="l472"><span class="linenum"> 472</span></a>  
<a name="l473"><span class="linenum"> 473</span></a>  
<a name="l474"><span class="linenum"> 474</span></a>      <span class="comment">/**</span>
<a name="l475"><span class="linenum"> 475</span></a>  <span class="comment">     * Invoke this function _on_ the IDP to update it with enrolment info local to</span>
<a name="l476"><span class="linenum"> 476</span></a>  <span class="comment">     * the SP right after calling user_authorise()</span>
<a name="l477"><span class="linenum"> 477</span></a>  <span class="comment">     *</span>
<a name="l478"><span class="linenum"> 478</span></a>  <span class="comment">     * Normally called by the SP after calling user_authorise()</span>
<a name="l479"><span class="linenum"> 479</span></a>  <span class="comment">     *</span>
<a name="l480"><span class="linenum"> 480</span></a>  <span class="comment">     * @param string $username The username</span>
<a name="l481"><span class="linenum"> 481</span></a>  <span class="comment">     * @param array $courses  Assoc array of courses following the structure of mnetservice_enrol_courses</span>
<a name="l482"><span class="linenum"> 482</span></a>  <span class="comment">     * @return bool</span>
<a name="l483"><span class="linenum"> 483</span></a>  <span class="comment">     */</span>
<a name="l484"><span class="linenum"> 484</span></a>      function <a class="function" onClick="logFunction('update_enrolments')" href="../../_functions/update_enrolments.html" onMouseOver="funcPopup(event,'update_enrolments')">update_enrolments</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, <a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>) {
<a name="l485"><span class="linenum"> 485</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l486"><span class="linenum"> 486</span></a>          <a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a> = <a class="function" onClick="logFunction('get_mnet_remote_client')" href="../../_functions/get_mnet_remote_client.html" onMouseOver="funcPopup(event,'get_mnet_remote_client')">get_mnet_remote_client</a>();
<a name="l487"><span class="linenum"> 487</span></a>  
<a name="l488"><span class="linenum"> 488</span></a>          if (empty(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>) || !<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>)) {
<a name="l489"><span class="linenum"> 489</span></a>              return false;
<a name="l490"><span class="linenum"> 490</span></a>          }
<a name="l491"><span class="linenum"> 491</span></a>  <span class="comment">        // make sure it is a user we have an in active session</span>
<a name="l492"><span class="linenum"> 492</span></a>  <span class="comment">        // with that host...</span>
<a name="l493"><span class="linenum"> 493</span></a>          <a class="var it21690" onMouseOver="hilite(21690)" onMouseOut="lolite()" onClick="logVariable('mnetsessions')" href="../../_variables/mnetsessions.html">$mnetsessions</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('mnet_session', array('username' =&gt; <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, 'mnethostid' =&gt; <a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a>-&gt;<a onClick="logVariable('id')" class="var it44373" onMouseOver="hilite(44373)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>), '', 'id, userid');
<a name="l494"><span class="linenum"> 494</span></a>          <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a> = null;
<a name="l495"><span class="linenum"> 495</span></a>          foreach (<a class="var it21690" onMouseOver="hilite(21690)" onMouseOut="lolite()" onClick="logVariable('mnetsessions')" href="../../_variables/mnetsessions.html">$mnetsessions</a> as <a class="var it21691" onMouseOver="hilite(21691)" onMouseOut="lolite()" onClick="logVariable('mnetsession')" href="../../_variables/mnetsession.html">$mnetsession</a>) {
<a name="l496"><span class="linenum"> 496</span></a>              if (<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>)) {
<a name="l497"><span class="linenum"> 497</span></a>                  <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a> = <a class="var it21691" onMouseOver="hilite(21691)" onMouseOut="lolite()" onClick="logVariable('mnetsession')" href="../../_variables/mnetsession.html">$mnetsession</a>-&gt;<a onClick="logVariable('userid')" class="var it44380" onMouseOver="hilite(44380)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>;
<a name="l498"><span class="linenum"> 498</span></a>                  continue;
<a name="l499"><span class="linenum"> 499</span></a>              }
<a name="l500"><span class="linenum"> 500</span></a>              if (<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a> != <a class="var it21691" onMouseOver="hilite(21691)" onMouseOut="lolite()" onClick="logVariable('mnetsession')" href="../../_variables/mnetsession.html">$mnetsession</a>-&gt;<a onClick="logVariable('userid')" class="var it44380" onMouseOver="hilite(44380)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>) {
<a name="l501"><span class="linenum"> 501</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('mnet_server_exception')" href="../../_classes/mnet_server_exception.html" onMouseOver="classPopup(event,'mnet_server_exception')">mnet_server_exception</a>(3, 'authfail_usermismatch');
<a name="l502"><span class="linenum"> 502</span></a>              }
<a name="l503"><span class="linenum"> 503</span></a>          }
<a name="l504"><span class="linenum"> 504</span></a>  
<a name="l505"><span class="linenum"> 505</span></a>          if (empty(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>)) { // no courses? clear out quickly
<a name="l506"><span class="linenum"> 506</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('mnetservice_enrol_enrolments', array('hostid'=&gt;<a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a>-&gt;<a onClick="logVariable('id')" class="var it44373" onMouseOver="hilite(44373)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'userid'=&gt;<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>));
<a name="l507"><span class="linenum"> 507</span></a>              return true;
<a name="l508"><span class="linenum"> 508</span></a>          }
<a name="l509"><span class="linenum"> 509</span></a>  
<a name="l510"><span class="linenum"> 510</span></a>  <span class="comment">        // IMPORTANT: Ask for remoteid as the first element in the query, so</span>
<a name="l511"><span class="linenum"> 511</span></a>  <span class="comment">        // that the array that comes back is indexed on the same field as the</span>
<a name="l512"><span class="linenum"> 512</span></a>  <span class="comment">        // array that we have received from the remote client</span>
<a name="l513"><span class="linenum"> 513</span></a>          <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT c.remoteid, c.id, c.categoryid AS cat_id, c.categoryname AS cat_name, c.sortorder,
<a name="l514"><span class="linenum"> 514</span></a>                         c.fullname, c.shortname, c.idnumber, c.summary, c.summaryformat, c.startdate,
<a name="l515"><span class="linenum"> 515</span></a>                         e.id AS enrolmentid
<a name="l516"><span class="linenum"> 516</span></a>                    FROM {mnetservice_enrol_courses} c
<a name="l517"><span class="linenum"> 517</span></a>               LEFT JOIN {mnetservice_enrol_enrolments} e <a class="function" onClick="logFunction('ON')" href="../../_functions/on.html" onMouseOver="funcPopup(event,'on')">ON</a> (e.hostid = c.hostid AND e.remotecourseid = c.remoteid)
<a name="l518"><span class="linenum"> 518</span></a>                   WHERE e.userid = ? AND c.hostid = ?&quot;;
<a name="l519"><span class="linenum"> 519</span></a>  
<a name="l520"><span class="linenum"> 520</span></a>          <a class="var it21692" onMouseOver="hilite(21692)" onMouseOut="lolite()" onClick="logVariable('currentcourses')" href="../../_variables/currentcourses.html">$currentcourses</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, array(<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, <a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a>-&gt;<a onClick="logVariable('id')" class="var it44373" onMouseOver="hilite(44373)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l521"><span class="linenum"> 521</span></a>  
<a name="l522"><span class="linenum"> 522</span></a>          <a class="var it21693" onMouseOver="hilite(21693)" onMouseOut="lolite()" onClick="logVariable('local_courseid_array')" href="../../_variables/local_courseid_array.html">$local_courseid_array</a> = array();
<a name="l523"><span class="linenum"> 523</span></a>          foreach(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a> as <a class="var it12312" onMouseOver="hilite(12312)" onMouseOut="lolite()" onClick="logVariable('ix')" href="../../_variables/ix.html">$ix</a> =&gt; <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>) {
<a name="l524"><span class="linenum"> 524</span></a>  
<a name="l525"><span class="linenum"> 525</span></a>              <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>['remoteid'] = <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>['id'];
<a name="l526"><span class="linenum"> 526</span></a>              <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>['hostid']   =  (int)<a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a>-&gt;<a onClick="logVariable('id')" class="var it44373" onMouseOver="hilite(44373)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l527"><span class="linenum"> 527</span></a>              <a class="var it21694" onMouseOver="hilite(21694)" onMouseOut="lolite()" onClick="logVariable('userisregd')" href="../../_variables/userisregd.html">$userisregd</a>         = false;
<a name="l528"><span class="linenum"> 528</span></a>  
<a name="l529"><span class="linenum"> 529</span></a>  <span class="comment">            // if we do not have the the information about the remote course, it is not available</span>
<a name="l530"><span class="linenum"> 530</span></a>  <span class="comment">            // to us for remote enrolment - skip</span>
<a name="l531"><span class="linenum"> 531</span></a>              if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>['remoteid'], <a class="var it21692" onMouseOver="hilite(21692)" onMouseOut="lolite()" onClick="logVariable('currentcourses')" href="../../_variables/currentcourses.html">$currentcourses</a>)) {
<a name="l532"><span class="linenum"> 532</span></a>  <span class="comment">                // Pointer to current course:</span>
<a name="l533"><span class="linenum"> 533</span></a>                  <a class="var it6028" onMouseOver="hilite(6028)" onMouseOut="lolite()" onClick="logVariable('currentcourse')" href="../../_variables/currentcourse.html">$currentcourse</a> =&amp; <a class="var it21692" onMouseOver="hilite(21692)" onMouseOut="lolite()" onClick="logVariable('currentcourses')" href="../../_variables/currentcourses.html">$currentcourses</a>[<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>['remoteid']];
<a name="l534"><span class="linenum"> 534</span></a>  <span class="comment">                // We have a record - is it up-to-date?</span>
<a name="l535"><span class="linenum"> 535</span></a>                  <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>['id'] = <a class="var it6028" onMouseOver="hilite(6028)" onMouseOut="lolite()" onClick="logVariable('currentcourse')" href="../../_variables/currentcourse.html">$currentcourse</a>-&gt;<a onClick="logVariable('id')" class="var it44381" onMouseOver="hilite(44381)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l536"><span class="linenum"> 536</span></a>  
<a name="l537"><span class="linenum"> 537</span></a>                  <a class="var it21695" onMouseOver="hilite(21695)" onMouseOut="lolite()" onClick="logVariable('saveflag')" href="../../_variables/saveflag.html">$saveflag</a> = false;
<a name="l538"><span class="linenum"> 538</span></a>  
<a name="l539"><span class="linenum"> 539</span></a>                  foreach(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l540"><span class="linenum"> 540</span></a>                      if (<a class="var it6028" onMouseOver="hilite(6028)" onMouseOut="lolite()" onClick="logVariable('currentcourse')" href="../../_variables/currentcourse.html">$currentcourse</a>-&gt;<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> != <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l541"><span class="linenum"> 541</span></a>                          <a class="var it21695" onMouseOver="hilite(21695)" onMouseOut="lolite()" onClick="logVariable('saveflag')" href="../../_variables/saveflag.html">$saveflag</a> = true;
<a name="l542"><span class="linenum"> 542</span></a>                          <a class="var it6028" onMouseOver="hilite(6028)" onMouseOut="lolite()" onClick="logVariable('currentcourse')" href="../../_variables/currentcourse.html">$currentcourse</a>-&gt;<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l543"><span class="linenum"> 543</span></a>                      }
<a name="l544"><span class="linenum"> 544</span></a>                  }
<a name="l545"><span class="linenum"> 545</span></a>  
<a name="l546"><span class="linenum"> 546</span></a>                  if (<a class="var it21695" onMouseOver="hilite(21695)" onMouseOut="lolite()" onClick="logVariable('saveflag')" href="../../_variables/saveflag.html">$saveflag</a>) {
<a name="l547"><span class="linenum"> 547</span></a>                      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('mnetervice_enrol_courses', <a class="var it6028" onMouseOver="hilite(6028)" onMouseOut="lolite()" onClick="logVariable('currentcourse')" href="../../_variables/currentcourse.html">$currentcourse</a>);
<a name="l548"><span class="linenum"> 548</span></a>                  }
<a name="l549"><span class="linenum"> 549</span></a>  
<a name="l550"><span class="linenum"> 550</span></a>                  if (isset(<a class="var it6028" onMouseOver="hilite(6028)" onMouseOut="lolite()" onClick="logVariable('currentcourse')" href="../../_variables/currentcourse.html">$currentcourse</a>-&gt;<a onClick="logVariable('enrolmentid')" class="var it44381" onMouseOver="hilite(44381)" onMouseOut="lolite()" href="../../_variables/enrolmentid.html">enrolmentid</a>) &amp;&amp; <a class="phpfunction" onClick="logFunction('is_numeric')" href="../../_functions/is_numeric.html" onMouseOver="phpfuncPopup(event,'is_numeric')">is_numeric</a>(<a class="var it6028" onMouseOver="hilite(6028)" onMouseOut="lolite()" onClick="logVariable('currentcourse')" href="../../_variables/currentcourse.html">$currentcourse</a>-&gt;<a onClick="logVariable('enrolmentid')" class="var it44381" onMouseOver="hilite(44381)" onMouseOut="lolite()" href="../../_variables/enrolmentid.html">enrolmentid</a>)) {
<a name="l551"><span class="linenum"> 551</span></a>                      <a class="var it21694" onMouseOver="hilite(21694)" onMouseOut="lolite()" onClick="logVariable('userisregd')" href="../../_variables/userisregd.html">$userisregd</a> = true;
<a name="l552"><span class="linenum"> 552</span></a>                  }
<a name="l553"><span class="linenum"> 553</span></a>              } else {
<a name="l554"><span class="linenum"> 554</span></a>                  unset (<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>[<a class="var it12312" onMouseOver="hilite(12312)" onMouseOut="lolite()" onClick="logVariable('ix')" href="../../_variables/ix.html">$ix</a>]);
<a name="l555"><span class="linenum"> 555</span></a>                  continue;
<a name="l556"><span class="linenum"> 556</span></a>              }
<a name="l557"><span class="linenum"> 557</span></a>  
<a name="l558"><span class="linenum"> 558</span></a>  <span class="comment">            // By this point, we should always have a $dataObj-&gt;id</span>
<a name="l559"><span class="linenum"> 559</span></a>              <a class="var it21693" onMouseOver="hilite(21693)" onMouseOut="lolite()" onClick="logVariable('local_courseid_array')" href="../../_variables/local_courseid_array.html">$local_courseid_array</a>[] = <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>['id'];
<a name="l560"><span class="linenum"> 560</span></a>  
<a name="l561"><span class="linenum"> 561</span></a>  <span class="comment">            // Do we have a record for this assignment?</span>
<a name="l562"><span class="linenum"> 562</span></a>              if (<a class="var it21694" onMouseOver="hilite(21694)" onMouseOut="lolite()" onClick="logVariable('userisregd')" href="../../_variables/userisregd.html">$userisregd</a>) {
<a name="l563"><span class="linenum"> 563</span></a>  <span class="comment">                // Yes - we know about this one already</span>
<a name="l564"><span class="linenum"> 564</span></a>  <span class="comment">                // We don't want to do updates because the new data is probably</span>
<a name="l565"><span class="linenum"> 565</span></a>  <span class="comment">                // 'less complete' than the data we have.</span>
<a name="l566"><span class="linenum"> 566</span></a>              } else {
<a name="l567"><span class="linenum"> 567</span></a>  <span class="comment">                // No - create a record</span>
<a name="l568"><span class="linenum"> 568</span></a>                  <a class="var it21697" onMouseOver="hilite(21697)" onMouseOut="lolite()" onClick="logVariable('assignObj')" href="../../_variables/assignObj.html">$assignObj</a> = new stdClass();
<a name="l569"><span class="linenum"> 569</span></a>                  <a class="var it21697" onMouseOver="hilite(21697)" onMouseOut="lolite()" onClick="logVariable('assignObj')" href="../../_variables/assignObj.html">$assignObj</a>-&gt;<a onClick="logVariable('userid')" class="var it44382" onMouseOver="hilite(44382)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>    = <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>;
<a name="l570"><span class="linenum"> 570</span></a>                  <a class="var it21697" onMouseOver="hilite(21697)" onMouseOut="lolite()" onClick="logVariable('assignObj')" href="../../_variables/assignObj.html">$assignObj</a>-&gt;<a onClick="logVariable('hostid')" class="var it44382" onMouseOver="hilite(44382)" onMouseOut="lolite()" href="../../_variables/hostid.html">hostid</a>    = (int)<a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a>-&gt;<a onClick="logVariable('id')" class="var it44373" onMouseOver="hilite(44373)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l571"><span class="linenum"> 571</span></a>                  <a class="var it21697" onMouseOver="hilite(21697)" onMouseOut="lolite()" onClick="logVariable('assignObj')" href="../../_variables/assignObj.html">$assignObj</a>-&gt;<a onClick="logVariable('remotecourseid')" class="var it44382" onMouseOver="hilite(44382)" onMouseOut="lolite()" href="../../_variables/remotecourseid.html">remotecourseid</a> = <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>['remoteid'];
<a name="l572"><span class="linenum"> 572</span></a>                  <a class="var it21697" onMouseOver="hilite(21697)" onMouseOut="lolite()" onClick="logVariable('assignObj')" href="../../_variables/assignObj.html">$assignObj</a>-&gt;<a onClick="logVariable('rolename')" class="var it44382" onMouseOver="hilite(44382)" onMouseOut="lolite()" href="../../_variables/rolename.html">rolename</a>  = <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>['defaultrolename'];
<a name="l573"><span class="linenum"> 573</span></a>                  <a class="var it21697" onMouseOver="hilite(21697)" onMouseOut="lolite()" onClick="logVariable('assignObj')" href="../../_variables/assignObj.html">$assignObj</a>-&gt;<a onClick="logVariable('id')" class="var it44382" onMouseOver="hilite(44382)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('mnetservice_enrol_enrolments', <a class="var it21697" onMouseOver="hilite(21697)" onMouseOut="lolite()" onClick="logVariable('assignObj')" href="../../_variables/assignObj.html">$assignObj</a>);
<a name="l574"><span class="linenum"> 574</span></a>              }
<a name="l575"><span class="linenum"> 575</span></a>          }
<a name="l576"><span class="linenum"> 576</span></a>  
<a name="l577"><span class="linenum"> 577</span></a>  <span class="comment">        // Clean up courses that the user is no longer enrolled in.</span>
<a name="l578"><span class="linenum"> 578</span></a>          if (!empty(<a class="var it21693" onMouseOver="hilite(21693)" onMouseOut="lolite()" onClick="logVariable('local_courseid_array')" href="../../_variables/local_courseid_array.html">$local_courseid_array</a>)) {
<a name="l579"><span class="linenum"> 579</span></a>              <a class="var it21699" onMouseOver="hilite(21699)" onMouseOut="lolite()" onClick="logVariable('local_courseid_string')" href="../../_variables/local_courseid_string.html">$local_courseid_string</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(', ', <a class="var it21693" onMouseOver="hilite(21693)" onMouseOut="lolite()" onClick="logVariable('local_courseid_array')" href="../../_variables/local_courseid_array.html">$local_courseid_array</a>);
<a name="l580"><span class="linenum"> 580</span></a>              <a class="var it12380" onMouseOver="hilite(12380)" onMouseOut="lolite()" onClick="logVariable('whereclause')" href="../../_variables/whereclause.html">$whereclause</a> = &quot; userid = ? AND hostid = ? AND remotecourseid NOT IN (<a class="var it21699" onMouseOver="hilite(21699)" onMouseOut="lolite()" onClick="logVariable('local_courseid_string')" href="../../_variables/local_courseid_string.html">$local_courseid_string</a>)&quot;;
<a name="l581"><span class="linenum"> 581</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records_select')" href="../../_functions/delete_records_select.html" onMouseOver="funcPopup(event,'delete_records_select')">delete_records_select</a>('mnetservice_enrol_enrolments', <a class="var it12380" onMouseOver="hilite(12380)" onMouseOut="lolite()" onClick="logVariable('whereclause')" href="../../_variables/whereclause.html">$whereclause</a>, array(<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, <a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a>-&gt;<a onClick="logVariable('id')" class="var it44373" onMouseOver="hilite(44373)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l582"><span class="linenum"> 582</span></a>          }
<a name="l583"><span class="linenum"> 583</span></a>      }
<a name="l584"><span class="linenum"> 584</span></a>  
<a name="l585"><span class="linenum"> 585</span></a>      function <a class="function" onClick="logFunction('prevent_local_passwords')" href="../../_functions/prevent_local_passwords.html" onMouseOver="funcPopup(event,'prevent_local_passwords')">prevent_local_passwords</a>() {
<a name="l586"><span class="linenum"> 586</span></a>          return true;
<a name="l587"><span class="linenum"> 587</span></a>      }
<a name="l588"><span class="linenum"> 588</span></a>  
<a name="l589"><span class="linenum"> 589</span></a>      <span class="comment">/**</span>
<a name="l590"><span class="linenum"> 590</span></a>  <span class="comment">     * Returns true if this authentication plugin is 'internal'.</span>
<a name="l591"><span class="linenum"> 591</span></a>  <span class="comment">     *</span>
<a name="l592"><span class="linenum"> 592</span></a>  <span class="comment">     * @return bool</span>
<a name="l593"><span class="linenum"> 593</span></a>  <span class="comment">     */</span>
<a name="l594"><span class="linenum"> 594</span></a>      function <a class="function" onClick="logFunction('is_internal')" href="../../_functions/is_internal.html" onMouseOver="funcPopup(event,'is_internal')">is_internal</a>() {
<a name="l595"><span class="linenum"> 595</span></a>          return false;
<a name="l596"><span class="linenum"> 596</span></a>      }
<a name="l597"><span class="linenum"> 597</span></a>  
<a name="l598"><span class="linenum"> 598</span></a>      <span class="comment">/**</span>
<a name="l599"><span class="linenum"> 599</span></a>  <span class="comment">     * Returns true if this authentication plugin can change the user's</span>
<a name="l600"><span class="linenum"> 600</span></a>  <span class="comment">     * password.</span>
<a name="l601"><span class="linenum"> 601</span></a>  <span class="comment">     *</span>
<a name="l602"><span class="linenum"> 602</span></a>  <span class="comment">     * @return bool</span>
<a name="l603"><span class="linenum"> 603</span></a>  <span class="comment">     */</span>
<a name="l604"><span class="linenum"> 604</span></a>      function <a class="function" onClick="logFunction('can_change_password')" href="../../_functions/can_change_password.html" onMouseOver="funcPopup(event,'can_change_password')">can_change_password</a>() {
<a name="l605"><span class="linenum"> 605</span></a>  <span class="comment">        //TODO: it should be able to redirect, right?</span>
<a name="l606"><span class="linenum"> 606</span></a>          return false;
<a name="l607"><span class="linenum"> 607</span></a>      }
<a name="l608"><span class="linenum"> 608</span></a>  
<a name="l609"><span class="linenum"> 609</span></a>      <span class="comment">/**</span>
<a name="l610"><span class="linenum"> 610</span></a>  <span class="comment">     * Returns the URL for changing the user's pw, or false if the default can</span>
<a name="l611"><span class="linenum"> 611</span></a>  <span class="comment">     * be used.</span>
<a name="l612"><span class="linenum"> 612</span></a>  <span class="comment">     *</span>
<a name="l613"><span class="linenum"> 613</span></a>  <span class="comment">     * @return moodle_url</span>
<a name="l614"><span class="linenum"> 614</span></a>  <span class="comment">     */</span>
<a name="l615"><span class="linenum"> 615</span></a>      function <a class="function" onClick="logFunction('change_password_url')" href="../../_functions/change_password_url.html" onMouseOver="funcPopup(event,'change_password_url')">change_password_url</a>() {
<a name="l616"><span class="linenum"> 616</span></a>          return null;
<a name="l617"><span class="linenum"> 617</span></a>      }
<a name="l618"><span class="linenum"> 618</span></a>  
<a name="l619"><span class="linenum"> 619</span></a>      <span class="comment">/**</span>
<a name="l620"><span class="linenum"> 620</span></a>  <span class="comment">     * Prints a form for configuring this authentication plugin.</span>
<a name="l621"><span class="linenum"> 621</span></a>  <span class="comment">     *</span>
<a name="l622"><span class="linenum"> 622</span></a>  <span class="comment">     * This function is called from admin/auth.php, and outputs a full page with</span>
<a name="l623"><span class="linenum"> 623</span></a>  <span class="comment">     * a form for configuring this plugin.</span>
<a name="l624"><span class="linenum"> 624</span></a>  <span class="comment">     *</span>
<a name="l625"><span class="linenum"> 625</span></a>  <span class="comment">     * @param object $config</span>
<a name="l626"><span class="linenum"> 626</span></a>  <span class="comment">     * @param object $err</span>
<a name="l627"><span class="linenum"> 627</span></a>  <span class="comment">     * @param array $user_fields</span>
<a name="l628"><span class="linenum"> 628</span></a>  <span class="comment">     */</span>
<a name="l629"><span class="linenum"> 629</span></a>      function <a class="function" onClick="logFunction('config_form')" href="../../_functions/config_form.html" onMouseOver="funcPopup(event,'config_form')">config_form</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>, <a class="var it210" onMouseOver="hilite(210)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../_variables/err.html">$err</a>, <a class="var it211" onMouseOver="hilite(211)" onMouseOut="lolite()" onClick="logVariable('user_fields')" href="../../_variables/user_fields.html">$user_fields</a>) {
<a name="l630"><span class="linenum"> 630</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l631"><span class="linenum"> 631</span></a>  
<a name="l632"><span class="linenum"> 632</span></a>           <a class="var it249" onMouseOver="hilite(249)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../_variables/query.html">$query</a> = &quot;
<a name="l633"><span class="linenum"> 633</span></a>              SELECT
<a name="l634"><span class="linenum"> 634</span></a>                  h.id,
<a name="l635"><span class="linenum"> 635</span></a>                  h.name as hostname,
<a name="l636"><span class="linenum"> 636</span></a>                  h.wwwroot,
<a name="l637"><span class="linenum"> 637</span></a>                  h2idp.publish as idppublish,
<a name="l638"><span class="linenum"> 638</span></a>                  h2idp.subscribe as idpsubscribe,
<a name="l639"><span class="linenum"> 639</span></a>                  idp.name as idpname,
<a name="l640"><span class="linenum"> 640</span></a>                  h2sp.publish as sppublish,
<a name="l641"><span class="linenum"> 641</span></a>                  h2sp.subscribe as spsubscribe,
<a name="l642"><span class="linenum"> 642</span></a>                  sp.name as spname
<a name="l643"><span class="linenum"> 643</span></a>              FROM
<a name="l644"><span class="linenum"> 644</span></a>                  {mnet_host} h
<a name="l645"><span class="linenum"> 645</span></a>              LEFT JOIN
<a name="l646"><span class="linenum"> 646</span></a>                  {mnet_host2service} h2idp
<a name="l647"><span class="linenum"> 647</span></a>              ON
<a name="l648"><span class="linenum"> 648</span></a>                 (h.id = h2idp.hostid AND
<a name="l649"><span class="linenum"> 649</span></a>                 (h2idp.publish = 1 OR
<a name="l650"><span class="linenum"> 650</span></a>                  h2idp.subscribe = 1))
<a name="l651"><span class="linenum"> 651</span></a>              INNER JOIN
<a name="l652"><span class="linenum"> 652</span></a>                  {mnet_service} idp
<a name="l653"><span class="linenum"> 653</span></a>              ON
<a name="l654"><span class="linenum"> 654</span></a>                 (h2idp.serviceid = idp.id AND
<a name="l655"><span class="linenum"> 655</span></a>                  idp.name = 'sso_idp')
<a name="l656"><span class="linenum"> 656</span></a>              LEFT JOIN
<a name="l657"><span class="linenum"> 657</span></a>                  {mnet_host2service} h2sp
<a name="l658"><span class="linenum"> 658</span></a>              ON
<a name="l659"><span class="linenum"> 659</span></a>                 (h.id = h2sp.hostid AND
<a name="l660"><span class="linenum"> 660</span></a>                 (h2sp.publish = 1 OR
<a name="l661"><span class="linenum"> 661</span></a>                  h2sp.subscribe = 1))
<a name="l662"><span class="linenum"> 662</span></a>              INNER JOIN
<a name="l663"><span class="linenum"> 663</span></a>                  {mnet_service} sp
<a name="l664"><span class="linenum"> 664</span></a>              ON
<a name="l665"><span class="linenum"> 665</span></a>                 (h2sp.serviceid = sp.id AND
<a name="l666"><span class="linenum"> 666</span></a>                  sp.name = 'sso_sp')
<a name="l667"><span class="linenum"> 667</span></a>              WHERE
<a name="l668"><span class="linenum"> 668</span></a>                 ((h2idp.publish = 1 AND h2sp.subscribe = 1) OR
<a name="l669"><span class="linenum"> 669</span></a>                 (h2sp.publish = 1 AND h2idp.subscribe = 1)) AND
<a name="l670"><span class="linenum"> 670</span></a>                  h.id != ?
<a name="l671"><span class="linenum"> 671</span></a>              ORDER BY
<a name="l672"><span class="linenum"> 672</span></a>                  h.name ASC&quot;;
<a name="l673"><span class="linenum"> 673</span></a>  
<a name="l674"><span class="linenum"> 674</span></a>          <a class="var it3735" onMouseOver="hilite(3735)" onMouseOut="lolite()" onClick="logVariable('id_providers')" href="../../_variables/id_providers.html">$id_providers</a>       = array();
<a name="l675"><span class="linenum"> 675</span></a>          <a class="var it3736" onMouseOver="hilite(3736)" onMouseOut="lolite()" onClick="logVariable('service_providers')" href="../../_variables/service_providers.html">$service_providers</a>  = array();
<a name="l676"><span class="linenum"> 676</span></a>          if (<a class="var it21700" onMouseOver="hilite(21700)" onMouseOut="lolite()" onClick="logVariable('resultset')" href="../../_variables/resultset.html">$resultset</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it249" onMouseOver="hilite(249)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../_variables/query.html">$query</a>, array(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/mnet_localhost_id.html">mnet_localhost_id</a>))) {
<a name="l677"><span class="linenum"> 677</span></a>              foreach(<a class="var it21700" onMouseOver="hilite(21700)" onMouseOut="lolite()" onClick="logVariable('resultset')" href="../../_variables/resultset.html">$resultset</a> as <a class="var it21701" onMouseOver="hilite(21701)" onMouseOut="lolite()" onClick="logVariable('hostservice')" href="../../_variables/hostservice.html">$hostservice</a>) {
<a name="l678"><span class="linenum"> 678</span></a>                  if(!empty(<a class="var it21701" onMouseOver="hilite(21701)" onMouseOut="lolite()" onClick="logVariable('hostservice')" href="../../_variables/hostservice.html">$hostservice</a>-&gt;<a onClick="logVariable('idppublish')" class="var it44383" onMouseOver="hilite(44383)" onMouseOut="lolite()" href="../../_variables/idppublish.html">idppublish</a>) &amp;&amp; !empty(<a class="var it21701" onMouseOver="hilite(21701)" onMouseOut="lolite()" onClick="logVariable('hostservice')" href="../../_variables/hostservice.html">$hostservice</a>-&gt;<a onClick="logVariable('spsubscribe')" class="var it44383" onMouseOver="hilite(44383)" onMouseOut="lolite()" href="../../_variables/spsubscribe.html">spsubscribe</a>)) {
<a name="l679"><span class="linenum"> 679</span></a>                      <a class="var it3736" onMouseOver="hilite(3736)" onMouseOut="lolite()" onClick="logVariable('service_providers')" href="../../_variables/service_providers.html">$service_providers</a>[]= array('id' =&gt; <a class="var it21701" onMouseOver="hilite(21701)" onMouseOut="lolite()" onClick="logVariable('hostservice')" href="../../_variables/hostservice.html">$hostservice</a>-&gt;<a onClick="logVariable('id')" class="var it44383" onMouseOver="hilite(44383)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'name' =&gt; <a class="var it21701" onMouseOver="hilite(21701)" onMouseOut="lolite()" onClick="logVariable('hostservice')" href="../../_variables/hostservice.html">$hostservice</a>-&gt;<a onClick="logVariable('hostname')" class="var it44383" onMouseOver="hilite(44383)" onMouseOut="lolite()" href="../../_variables/hostname.html">hostname</a>, 'wwwroot' =&gt; <a class="var it21701" onMouseOver="hilite(21701)" onMouseOut="lolite()" onClick="logVariable('hostservice')" href="../../_variables/hostservice.html">$hostservice</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it44383" onMouseOver="hilite(44383)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>);
<a name="l680"><span class="linenum"> 680</span></a>                  }
<a name="l681"><span class="linenum"> 681</span></a>                  if(!empty(<a class="var it21701" onMouseOver="hilite(21701)" onMouseOut="lolite()" onClick="logVariable('hostservice')" href="../../_variables/hostservice.html">$hostservice</a>-&gt;<a onClick="logVariable('idpsubscribe')" class="var it44383" onMouseOver="hilite(44383)" onMouseOut="lolite()" href="../../_variables/idpsubscribe.html">idpsubscribe</a>) &amp;&amp; !empty(<a class="var it21701" onMouseOver="hilite(21701)" onMouseOut="lolite()" onClick="logVariable('hostservice')" href="../../_variables/hostservice.html">$hostservice</a>-&gt;<a onClick="logVariable('sppublish')" class="var it44383" onMouseOver="hilite(44383)" onMouseOut="lolite()" href="../../_variables/sppublish.html">sppublish</a>)) {
<a name="l682"><span class="linenum"> 682</span></a>                      <a class="var it3735" onMouseOver="hilite(3735)" onMouseOut="lolite()" onClick="logVariable('id_providers')" href="../../_variables/id_providers.html">$id_providers</a>[]= array('id' =&gt; <a class="var it21701" onMouseOver="hilite(21701)" onMouseOut="lolite()" onClick="logVariable('hostservice')" href="../../_variables/hostservice.html">$hostservice</a>-&gt;<a onClick="logVariable('id')" class="var it44383" onMouseOver="hilite(44383)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'name' =&gt; <a class="var it21701" onMouseOver="hilite(21701)" onMouseOut="lolite()" onClick="logVariable('hostservice')" href="../../_variables/hostservice.html">$hostservice</a>-&gt;<a onClick="logVariable('hostname')" class="var it44383" onMouseOver="hilite(44383)" onMouseOut="lolite()" href="../../_variables/hostname.html">hostname</a>, 'wwwroot' =&gt; <a class="var it21701" onMouseOver="hilite(21701)" onMouseOut="lolite()" onClick="logVariable('hostservice')" href="../../_variables/hostservice.html">$hostservice</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it44383" onMouseOver="hilite(44383)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>);
<a name="l683"><span class="linenum"> 683</span></a>                  }
<a name="l684"><span class="linenum"> 684</span></a>              }
<a name="l685"><span class="linenum"> 685</span></a>          }
<a name="l686"><span class="linenum"> 686</span></a>  
<a name="l687"><span class="linenum"> 687</span></a>          <span class="keyword">include</span> <a class="filename" href="../../auth/pop3/config.html.html" onMouseOver="reqPopup(event, 'config.html', '../../auth/pop3/config.html')"> &quot;config.html&quot;</a>;
<a name="l688"><span class="linenum"> 688</span></a>      }
<a name="l689"><span class="linenum"> 689</span></a>  
<a name="l690"><span class="linenum"> 690</span></a>      <span class="comment">/**</span>
<a name="l691"><span class="linenum"> 691</span></a>  <span class="comment">     * Processes and stores configuration data for this authentication plugin.</span>
<a name="l692"><span class="linenum"> 692</span></a>  <span class="comment">     */</span>
<a name="l693"><span class="linenum"> 693</span></a>      function <a class="function" onClick="logFunction('process_config')" href="../../_functions/process_config.html" onMouseOver="funcPopup(event,'process_config')">process_config</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>) {
<a name="l694"><span class="linenum"> 694</span></a>  <span class="comment">        // set to defaults if undefined</span>
<a name="l695"><span class="linenum"> 695</span></a>          if (!isset (<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('rpc_negotiation_timeout')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/rpc_negotiation_timeout.html">rpc_negotiation_timeout</a>)) {
<a name="l696"><span class="linenum"> 696</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('rpc_negotiation_timeout')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/rpc_negotiation_timeout.html">rpc_negotiation_timeout</a> = '30';
<a name="l697"><span class="linenum"> 697</span></a>          }
<a name="l698"><span class="linenum"> 698</span></a>          <span class="comment">/*</span>
<a name="l699"><span class="linenum"> 699</span></a>  <span class="comment">        if (!isset ($config-&gt;auto_add_remote_users)) {</span>
<a name="l700"><span class="linenum"> 700</span></a>  <span class="comment">            $config-&gt;auto_add_remote_users = '0';</span>
<a name="l701"><span class="linenum"> 701</span></a>  <span class="comment">        } See MDL-21327   for why this is commented out</span>
<a name="l702"><span class="linenum"> 702</span></a>  <span class="comment">        set_config('auto_add_remote_users',   $config-&gt;auto_add_remote_users,   'auth_mnet');</span>
<a name="l703"><span class="linenum"> 703</span></a>  <span class="comment">        */</span>
<a name="l704"><span class="linenum"> 704</span></a>  
<a name="l705"><span class="linenum"> 705</span></a>  <span class="comment">        // save settings</span>
<a name="l706"><span class="linenum"> 706</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('rpc_negotiation_timeout', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('rpc_negotiation_timeout')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/rpc_negotiation_timeout.html">rpc_negotiation_timeout</a>, 'auth_mnet');
<a name="l707"><span class="linenum"> 707</span></a>  
<a name="l708"><span class="linenum"> 708</span></a>          return true;
<a name="l709"><span class="linenum"> 709</span></a>      }
<a name="l710"><span class="linenum"> 710</span></a>  
<a name="l711"><span class="linenum"> 711</span></a>      <span class="comment">/**</span>
<a name="l712"><span class="linenum"> 712</span></a>  <span class="comment">     * Poll the IdP server to let it know that a user it has authenticated is still</span>
<a name="l713"><span class="linenum"> 713</span></a>  <span class="comment">     * online</span>
<a name="l714"><span class="linenum"> 714</span></a>  <span class="comment">     *</span>
<a name="l715"><span class="linenum"> 715</span></a>  <span class="comment">     * @return  void</span>
<a name="l716"><span class="linenum"> 716</span></a>  <span class="comment">     */</span>
<a name="l717"><span class="linenum"> 717</span></a>      function <a class="function" onClick="logFunction('keepalive_client')" href="../../_functions/keepalive_client.html" onMouseOver="funcPopup(event,'keepalive_client')">keepalive_client</a>() {
<a name="l718"><span class="linenum"> 718</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l719"><span class="linenum"> 719</span></a>          <a class="var it21706" onMouseOver="hilite(21706)" onMouseOut="lolite()" onClick="logVariable('cutoff')" href="../../_variables/cutoff.html">$cutoff</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() - 300; <span class="comment">// TODO - find out what the remote server's session</span>
<a name="l720"><span class="linenum"> 720</span></a>  <span class="comment">                                // cutoff is, and preempt that</span>
<a name="l721"><span class="linenum"> 721</span></a>  
<a name="l722"><span class="linenum"> 722</span></a>          <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;
<a name="l723"><span class="linenum"> 723</span></a>              select
<a name="l724"><span class="linenum"> 724</span></a>                  id,
<a name="l725"><span class="linenum"> 725</span></a>                  username,
<a name="l726"><span class="linenum"> 726</span></a>                  mnethostid
<a name="l727"><span class="linenum"> 727</span></a>              from
<a name="l728"><span class="linenum"> 728</span></a>                  {user}
<a name="l729"><span class="linenum"> 729</span></a>              where
<a name="l730"><span class="linenum"> 730</span></a>                  lastaccess &gt; ? AND
<a name="l731"><span class="linenum"> 731</span></a>                  mnethostid != ?
<a name="l732"><span class="linenum"> 732</span></a>              order by
<a name="l733"><span class="linenum"> 733</span></a>                  mnethostid&quot;;
<a name="l734"><span class="linenum"> 734</span></a>  
<a name="l735"><span class="linenum"> 735</span></a>          <a class="var it21707" onMouseOver="hilite(21707)" onMouseOut="lolite()" onClick="logVariable('immigrants')" href="../../_variables/immigrants.html">$immigrants</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, array(<a class="var it21706" onMouseOver="hilite(21706)" onMouseOut="lolite()" onClick="logVariable('cutoff')" href="../../_variables/cutoff.html">$cutoff</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/mnet_localhost_id.html">mnet_localhost_id</a>));
<a name="l736"><span class="linenum"> 736</span></a>  
<a name="l737"><span class="linenum"> 737</span></a>          if (<a class="var it21707" onMouseOver="hilite(21707)" onMouseOut="lolite()" onClick="logVariable('immigrants')" href="../../_variables/immigrants.html">$immigrants</a> == false) {
<a name="l738"><span class="linenum"> 738</span></a>              return true;
<a name="l739"><span class="linenum"> 739</span></a>          }
<a name="l740"><span class="linenum"> 740</span></a>  
<a name="l741"><span class="linenum"> 741</span></a>          <a class="var it21708" onMouseOver="hilite(21708)" onMouseOut="lolite()" onClick="logVariable('usersArray')" href="../../_variables/usersArray.html">$usersArray</a> = array();
<a name="l742"><span class="linenum"> 742</span></a>          foreach(<a class="var it21707" onMouseOver="hilite(21707)" onMouseOut="lolite()" onClick="logVariable('immigrants')" href="../../_variables/immigrants.html">$immigrants</a> as <a class="var it21709" onMouseOver="hilite(21709)" onMouseOut="lolite()" onClick="logVariable('immigrant')" href="../../_variables/immigrant.html">$immigrant</a>) {
<a name="l743"><span class="linenum"> 743</span></a>              <a class="var it21708" onMouseOver="hilite(21708)" onMouseOut="lolite()" onClick="logVariable('usersArray')" href="../../_variables/usersArray.html">$usersArray</a>[<a class="var it21709" onMouseOver="hilite(21709)" onMouseOut="lolite()" onClick="logVariable('immigrant')" href="../../_variables/immigrant.html">$immigrant</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it44384" onMouseOver="hilite(44384)" onMouseOut="lolite()" href="../../_variables/mnethostid.html">mnethostid</a>][] = <a class="var it21709" onMouseOver="hilite(21709)" onMouseOut="lolite()" onClick="logVariable('immigrant')" href="../../_variables/immigrant.html">$immigrant</a>-&gt;<a onClick="logVariable('username')" class="var it44384" onMouseOver="hilite(44384)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>;
<a name="l744"><span class="linenum"> 744</span></a>          }
<a name="l745"><span class="linenum"> 745</span></a>  
<a name="l746"><span class="linenum"> 746</span></a>          require_once <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a> . '<a class="filename" href="../../mnet/xmlrpc/client.php.html">/mnet/xmlrpc/client.php</a>';
<a name="l747"><span class="linenum"> 747</span></a>          foreach(<a class="var it21708" onMouseOver="hilite(21708)" onMouseOut="lolite()" onClick="logVariable('usersArray')" href="../../_variables/usersArray.html">$usersArray</a> as <a class="var it3328" onMouseOver="hilite(3328)" onMouseOut="lolite()" onClick="logVariable('mnethostid')" href="../../_variables/mnethostid.html">$mnethostid</a> =&gt; <a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>) {
<a name="l748"><span class="linenum"> 748</span></a>              <a class="var it1361" onMouseOver="hilite(1361)" onMouseOut="lolite()" onClick="logVariable('mnet_peer')" href="../../_variables/mnet_peer.html">$mnet_peer</a> = <span class="keyword">new </span><a class="class" onClick="logClass('mnet_peer')" href="../../_classes/mnet_peer.html" onMouseOver="classPopup(event,'mnet_peer')">mnet_peer</a>();
<a name="l749"><span class="linenum"> 749</span></a>              <a class="var it1361" onMouseOver="hilite(1361)" onMouseOut="lolite()" onClick="logVariable('mnet_peer')" href="../../_variables/mnet_peer.html">$mnet_peer</a>-&gt;<a class="function" onClick="logFunction('set_id')" href="../../_functions/set_id.html" onMouseOver="funcPopup(event,'set_id')">set_id</a>(<a class="var it3328" onMouseOver="hilite(3328)" onMouseOut="lolite()" onClick="logVariable('mnethostid')" href="../../_variables/mnethostid.html">$mnethostid</a>);
<a name="l750"><span class="linenum"> 750</span></a>  
<a name="l751"><span class="linenum"> 751</span></a>              <a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a> = <span class="keyword">new </span><a class="class" onClick="logClass('mnet_xmlrpc_client')" href="../../_classes/mnet_xmlrpc_client.html" onMouseOver="classPopup(event,'mnet_xmlrpc_client')">mnet_xmlrpc_client</a>();
<a name="l752"><span class="linenum"> 752</span></a>              <a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a>-&gt;<a class="function" onClick="logFunction('set_method')" href="../../_functions/set_method.html" onMouseOver="funcPopup(event,'set_method')">set_method</a>('auth/mnet/auth.php/keepalive_server');
<a name="l753"><span class="linenum"> 753</span></a>  
<a name="l754"><span class="linenum"> 754</span></a>  <span class="comment">            // set $token and $useragent parameters</span>
<a name="l755"><span class="linenum"> 755</span></a>              <a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a>-&gt;<a class="function" onClick="logFunction('add_param')" href="../../_functions/add_param.html" onMouseOver="funcPopup(event,'add_param')">add_param</a>(<a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>);
<a name="l756"><span class="linenum"> 756</span></a>  
<a name="l757"><span class="linenum"> 757</span></a>              if (<a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a>-&gt;<a class="function" onClick="logFunction('send')" href="../../_functions/send.html" onMouseOver="funcPopup(event,'send')">send</a>(<a class="var it1361" onMouseOver="hilite(1361)" onMouseOut="lolite()" onClick="logVariable('mnet_peer')" href="../../_variables/mnet_peer.html">$mnet_peer</a>) === true) {
<a name="l758"><span class="linenum"> 758</span></a>                  if (!isset(<a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a>-&gt;<a onClick="logVariable('response')" class="var it44385" onMouseOver="hilite(44385)" onMouseOut="lolite()" href="../../_variables/response.html">response</a>['code'])) {
<a name="l759"><span class="linenum"> 759</span></a>                      <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(&quot;Server side error has occured on host <a class="var it3328" onMouseOver="hilite(3328)" onMouseOut="lolite()" onClick="logVariable('mnethostid')" href="../../_variables/mnethostid.html">$mnethostid</a>&quot;);
<a name="l760"><span class="linenum"> 760</span></a>                      continue;
<a name="l761"><span class="linenum"> 761</span></a>                  } elseif (<a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a>-&gt;<a onClick="logVariable('response')" class="var it44385" onMouseOver="hilite(44385)" onMouseOut="lolite()" href="../../_variables/response.html">response</a>['code'] &gt; 0) {
<a name="l762"><span class="linenum"> 762</span></a>                      <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(<a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a>-&gt;<a onClick="logVariable('response')" class="var it44385" onMouseOver="hilite(44385)" onMouseOut="lolite()" href="../../_variables/response.html">response</a>['message']);
<a name="l763"><span class="linenum"> 763</span></a>                  }
<a name="l764"><span class="linenum"> 764</span></a>  
<a name="l765"><span class="linenum"> 765</span></a>                  if (!isset(<a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a>-&gt;<a onClick="logVariable('response')" class="var it44385" onMouseOver="hilite(44385)" onMouseOut="lolite()" href="../../_variables/response.html">response</a>['last log id'])) {
<a name="l766"><span class="linenum"> 766</span></a>                      <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(&quot;Server side error has occured on host <a class="var it3328" onMouseOver="hilite(3328)" onMouseOut="lolite()" onClick="logVariable('mnethostid')" href="../../_variables/mnethostid.html">$mnethostid</a>\nNo log ID was received.&quot;);
<a name="l767"><span class="linenum"> 767</span></a>                      continue;
<a name="l768"><span class="linenum"> 768</span></a>                  }
<a name="l769"><span class="linenum"> 769</span></a>              } else {
<a name="l770"><span class="linenum"> 770</span></a>                  <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(&quot;Server side error has occured on host <a class="var it3328" onMouseOver="hilite(3328)" onMouseOut="lolite()" onClick="logVariable('mnethostid')" href="../../_variables/mnethostid.html">$mnethostid</a>: &quot; .
<a name="l771"><span class="linenum"> 771</span></a>                            <a class="function" onClick="logFunction('join')" href="../../_functions/join.html" onMouseOver="funcPopup(event,'join')">join</a>(&quot;\n&quot;, <a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a>-&gt;<a onClick="logVariable('error')" class="var it44385" onMouseOver="hilite(44385)" onMouseOut="lolite()" href="../../_variables/error.html">error</a>));
<a name="l772"><span class="linenum"> 772</span></a>                  break;
<a name="l773"><span class="linenum"> 773</span></a>              }
<a name="l774"><span class="linenum"> 774</span></a>          }
<a name="l775"><span class="linenum"> 775</span></a>      }
<a name="l776"><span class="linenum"> 776</span></a>  
<a name="l777"><span class="linenum"> 777</span></a>      <span class="comment">/**</span>
<a name="l778"><span class="linenum"> 778</span></a>  <span class="comment">     * Receives an array of log entries from an SP and adds them to the mnet_log</span>
<a name="l779"><span class="linenum"> 779</span></a>  <span class="comment">     * table</span>
<a name="l780"><span class="linenum"> 780</span></a>  <span class="comment">     *</span>
<a name="l781"><span class="linenum"> 781</span></a>  <span class="comment">     * @deprecated since Moodle 2.8 Please don't use this function for recording mnet logs.</span>
<a name="l782"><span class="linenum"> 782</span></a>  <span class="comment">     * @param   array   $array      An array of usernames</span>
<a name="l783"><span class="linenum"> 783</span></a>  <span class="comment">     * @return  string              &quot;All ok&quot; or an error message</span>
<a name="l784"><span class="linenum"> 784</span></a>  <span class="comment">     */</span>
<a name="l785"><span class="linenum"> 785</span></a>      function <a class="function" onClick="logFunction('refresh_log')" href="../../_functions/refresh_log.html" onMouseOver="funcPopup(event,'refresh_log')">refresh_log</a>(<a class="var it497" onMouseOver="hilite(497)" onMouseOut="lolite()" onClick="logVariable('array')" href="../../_variables/array.html">$array</a>) {
<a name="l786"><span class="linenum"> 786</span></a>          <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('<a class="function" onClick="logFunction('refresh_log')" href="../../_functions/refresh_log.html" onMouseOver="funcPopup(event,'refresh_log')">refresh_log</a>() is deprecated, The transfer of logs through mnet are no longer recorded.', <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l787"><span class="linenum"> 787</span></a>          return array('code' =&gt; 0, 'message' =&gt; 'All ok');
<a name="l788"><span class="linenum"> 788</span></a>      }
<a name="l789"><span class="linenum"> 789</span></a>  
<a name="l790"><span class="linenum"> 790</span></a>      <span class="comment">/**</span>
<a name="l791"><span class="linenum"> 791</span></a>  <span class="comment">     * Receives an array of usernames from a remote machine and prods their</span>
<a name="l792"><span class="linenum"> 792</span></a>  <span class="comment">     * sessions to keep them alive</span>
<a name="l793"><span class="linenum"> 793</span></a>  <span class="comment">     *</span>
<a name="l794"><span class="linenum"> 794</span></a>  <span class="comment">     * @param   array   $array      An array of usernames</span>
<a name="l795"><span class="linenum"> 795</span></a>  <span class="comment">     * @return  string              &quot;All ok&quot; or an error message</span>
<a name="l796"><span class="linenum"> 796</span></a>  <span class="comment">     */</span>
<a name="l797"><span class="linenum"> 797</span></a>      function <a class="function" onClick="logFunction('keepalive_server')" href="../../_functions/keepalive_server.html" onMouseOver="funcPopup(event,'keepalive_server')">keepalive_server</a>(<a class="var it497" onMouseOver="hilite(497)" onMouseOut="lolite()" onClick="logVariable('array')" href="../../_variables/array.html">$array</a>) {
<a name="l798"><span class="linenum"> 798</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l799"><span class="linenum"> 799</span></a>          <a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a> = <a class="function" onClick="logFunction('get_mnet_remote_client')" href="../../_functions/get_mnet_remote_client.html" onMouseOver="funcPopup(event,'get_mnet_remote_client')">get_mnet_remote_client</a>();
<a name="l800"><span class="linenum"> 800</span></a>  
<a name="l801"><span class="linenum"> 801</span></a>  <span class="comment">        // We don't want to output anything to the client machine</span>
<a name="l802"><span class="linenum"> 802</span></a>          <a class="var it133" onMouseOver="hilite(133)" onMouseOut="lolite()" onClick="logVariable('start')" href="../../_variables/start.html">$start</a> = <a class="phpfunction" onClick="logFunction('ob_start')" href="../../_functions/ob_start.html" onMouseOver="phpfuncPopup(event,'ob_start')">ob_start</a>();
<a name="l803"><span class="linenum"> 803</span></a>  
<a name="l804"><span class="linenum"> 804</span></a>  <span class="comment">        // We'll get session records in batches of 30</span>
<a name="l805"><span class="linenum"> 805</span></a>          <a class="var it21711" onMouseOver="hilite(21711)" onMouseOut="lolite()" onClick="logVariable('superArray')" href="../../_variables/superArray.html">$superArray</a> = <a class="phpfunction" onClick="logFunction('array_chunk')" href="../../_functions/array_chunk.html" onMouseOver="phpfuncPopup(event,'array_chunk')">array_chunk</a>(<a class="var it497" onMouseOver="hilite(497)" onMouseOut="lolite()" onClick="logVariable('array')" href="../../_variables/array.html">$array</a>, 30);
<a name="l806"><span class="linenum"> 806</span></a>  
<a name="l807"><span class="linenum"> 807</span></a>          <a class="var it21712" onMouseOver="hilite(21712)" onMouseOut="lolite()" onClick="logVariable('returnString')" href="../../_variables/returnString.html">$returnString</a> = '';
<a name="l808"><span class="linenum"> 808</span></a>  
<a name="l809"><span class="linenum"> 809</span></a>          foreach(<a class="var it21711" onMouseOver="hilite(21711)" onMouseOut="lolite()" onClick="logVariable('superArray')" href="../../_variables/superArray.html">$superArray</a> as <a class="var it21713" onMouseOver="hilite(21713)" onMouseOut="lolite()" onClick="logVariable('subArray')" href="../../_variables/subArray.html">$subArray</a>) {
<a name="l810"><span class="linenum"> 810</span></a>              <a class="var it21713" onMouseOver="hilite(21713)" onMouseOut="lolite()" onClick="logVariable('subArray')" href="../../_variables/subArray.html">$subArray</a> = <a class="phpfunction" onClick="logFunction('array_values')" href="../../_functions/array_values.html" onMouseOver="phpfuncPopup(event,'array_values')">array_values</a>(<a class="var it21713" onMouseOver="hilite(21713)" onMouseOut="lolite()" onClick="logVariable('subArray')" href="../../_variables/subArray.html">$subArray</a>);
<a name="l811"><span class="linenum"> 811</span></a>              <a class="var it21714" onMouseOver="hilite(21714)" onMouseOut="lolite()" onClick="logVariable('instring')" href="../../_variables/instring.html">$instring</a> = &quot;('&quot;.<a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(&quot;', '&quot;,<a class="var it21713" onMouseOver="hilite(21713)" onMouseOut="lolite()" onClick="logVariable('subArray')" href="../../_variables/subArray.html">$subArray</a>).&quot;')&quot;;
<a name="l812"><span class="linenum"> 812</span></a>              <a class="var it249" onMouseOver="hilite(249)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../_variables/query.html">$query</a> = &quot;select id, session_id, username from {mnet_session} where username in <a class="var it21714" onMouseOver="hilite(21714)" onMouseOut="lolite()" onClick="logVariable('instring')" href="../../_variables/instring.html">$instring</a>&quot;;
<a name="l813"><span class="linenum"> 813</span></a>              <a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../../_variables/results.html">$results</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it249" onMouseOver="hilite(249)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../_variables/query.html">$query</a>);
<a name="l814"><span class="linenum"> 814</span></a>  
<a name="l815"><span class="linenum"> 815</span></a>              if (<a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../../_variables/results.html">$results</a> == false) {
<a name="l816"><span class="linenum"> 816</span></a>  <span class="comment">                // We seem to have a username that breaks our query:</span>
<a name="l817"><span class="linenum"> 817</span></a>  <span class="comment">                // TODO: Handle this error appropriately</span>
<a name="l818"><span class="linenum"> 818</span></a>                  <a class="var it21712" onMouseOver="hilite(21712)" onMouseOut="lolite()" onClick="logVariable('returnString')" href="../../_variables/returnString.html">$returnString</a> .= &quot;We failed to refresh the session for the following usernames: \n&quot;.<a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(&quot;\n&quot;, <a class="var it21713" onMouseOver="hilite(21713)" onMouseOut="lolite()" onClick="logVariable('subArray')" href="../../_variables/subArray.html">$subArray</a>).&quot;\n\n&quot;;
<a name="l819"><span class="linenum"> 819</span></a>              } else {
<a name="l820"><span class="linenum"> 820</span></a>                  foreach(<a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../../_variables/results.html">$results</a> as <a class="var it21715" onMouseOver="hilite(21715)" onMouseOut="lolite()" onClick="logVariable('emigrant')" href="../../_variables/emigrant.html">$emigrant</a>) {
<a name="l821"><span class="linenum"> 821</span></a>                      \core\session\<a class="class" onClick="logClass('manager')" href="../../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('touch_session')" href="../../_functions/touch_session.html" onMouseOver="funcPopup(event,'touch_session')">touch_session</a>(<a class="var it21715" onMouseOver="hilite(21715)" onMouseOut="lolite()" onClick="logVariable('emigrant')" href="../../_variables/emigrant.html">$emigrant</a>-&gt;<a onClick="logVariable('session_id')" class="var it44386" onMouseOver="hilite(44386)" onMouseOut="lolite()" href="../../_variables/session_id.html">session_id</a>);
<a name="l822"><span class="linenum"> 822</span></a>                  }
<a name="l823"><span class="linenum"> 823</span></a>              }
<a name="l824"><span class="linenum"> 824</span></a>          }
<a name="l825"><span class="linenum"> 825</span></a>  
<a name="l826"><span class="linenum"> 826</span></a>          <a class="var it1128" onMouseOver="hilite(1128)" onMouseOut="lolite()" onClick="logVariable('end')" href="../../_variables/end.html">$end</a> = <a class="phpfunction" onClick="logFunction('ob_end_clean')" href="../../_functions/ob_end_clean.html" onMouseOver="phpfuncPopup(event,'ob_end_clean')">ob_end_clean</a>();
<a name="l827"><span class="linenum"> 827</span></a>  
<a name="l828"><span class="linenum"> 828</span></a>          if (empty(<a class="var it21712" onMouseOver="hilite(21712)" onMouseOut="lolite()" onClick="logVariable('returnString')" href="../../_variables/returnString.html">$returnString</a>)) return array('code' =&gt; 0, 'message' =&gt; 'All ok', 'last log id' =&gt; <a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a>-&gt;<a onClick="logVariable('last_log_id')" class="var it44373" onMouseOver="hilite(44373)" onMouseOut="lolite()" href="../../_variables/last_log_id.html">last_log_id</a>);
<a name="l829"><span class="linenum"> 829</span></a>          return array('code' =&gt; 1, 'message' =&gt; <a class="var it21712" onMouseOver="hilite(21712)" onMouseOut="lolite()" onClick="logVariable('returnString')" href="../../_variables/returnString.html">$returnString</a>, 'last log id' =&gt; <a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a>-&gt;<a onClick="logVariable('last_log_id')" class="var it44373" onMouseOver="hilite(44373)" onMouseOut="lolite()" href="../../_variables/last_log_id.html">last_log_id</a>);
<a name="l830"><span class="linenum"> 830</span></a>      }
<a name="l831"><span class="linenum"> 831</span></a>  
<a name="l832"><span class="linenum"> 832</span></a>      <span class="comment">/**</span>
<a name="l833"><span class="linenum"> 833</span></a>  <span class="comment">     * Cron function will be called automatically by cron.php every 5 minutes</span>
<a name="l834"><span class="linenum"> 834</span></a>  <span class="comment">     *</span>
<a name="l835"><span class="linenum"> 835</span></a>  <span class="comment">     * @return void</span>
<a name="l836"><span class="linenum"> 836</span></a>  <span class="comment">     */</span>
<a name="l837"><span class="linenum"> 837</span></a>      function <a class="function" onClick="logFunction('cron')" href="../../_functions/cron.html" onMouseOver="funcPopup(event,'cron')">cron</a>() {
<a name="l838"><span class="linenum"> 838</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l839"><span class="linenum"> 839</span></a>  
<a name="l840"><span class="linenum"> 840</span></a>  <span class="comment">        // run the keepalive client</span>
<a name="l841"><span class="linenum"> 841</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('keepalive_client')" href="../../_functions/keepalive_client.html" onMouseOver="funcPopup(event,'keepalive_client')">keepalive_client</a>();
<a name="l842"><span class="linenum"> 842</span></a>  
<a name="l843"><span class="linenum"> 843</span></a>          <a class="var it21717" onMouseOver="hilite(21717)" onMouseOut="lolite()" onClick="logVariable('random100')" href="../../_variables/random100.html">$random100</a> = <a class="phpfunction" onClick="logFunction('rand')" href="../../_functions/rand.html" onMouseOver="phpfuncPopup(event,'rand')">rand</a>(0,100);
<a name="l844"><span class="linenum"> 844</span></a>          if (<a class="var it21717" onMouseOver="hilite(21717)" onMouseOut="lolite()" onClick="logVariable('random100')" href="../../_variables/random100.html">$random100</a> &lt; 10) {     // Approximately 10% of the time.
<a name="l845"><span class="linenum"> 845</span></a>  <span class="comment">            // nuke olden sessions</span>
<a name="l846"><span class="linenum"> 846</span></a>              <a class="var it21718" onMouseOver="hilite(21718)" onMouseOut="lolite()" onClick="logVariable('longtime')" href="../../_variables/longtime.html">$longtime</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() - (1 * 3600 * 24);
<a name="l847"><span class="linenum"> 847</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records_select')" href="../../_functions/delete_records_select.html" onMouseOver="funcPopup(event,'delete_records_select')">delete_records_select</a>('mnet_session', &quot;expires &lt; ?&quot;, array(<a class="var it21718" onMouseOver="hilite(21718)" onMouseOut="lolite()" onClick="logVariable('longtime')" href="../../_variables/longtime.html">$longtime</a>));
<a name="l848"><span class="linenum"> 848</span></a>          }
<a name="l849"><span class="linenum"> 849</span></a>      }
<a name="l850"><span class="linenum"> 850</span></a>  
<a name="l851"><span class="linenum"> 851</span></a>      <span class="comment">/**</span>
<a name="l852"><span class="linenum"> 852</span></a>  <span class="comment">     * Cleanup any remote mnet_sessions, kill the local mnet_session data</span>
<a name="l853"><span class="linenum"> 853</span></a>  <span class="comment">     *</span>
<a name="l854"><span class="linenum"> 854</span></a>  <span class="comment">     * This is called by require_logout in moodlelib</span>
<a name="l855"><span class="linenum"> 855</span></a>  <span class="comment">     *</span>
<a name="l856"><span class="linenum"> 856</span></a>  <span class="comment">     * @return   void</span>
<a name="l857"><span class="linenum"> 857</span></a>  <span class="comment">     */</span>
<a name="l858"><span class="linenum"> 858</span></a>      function <a class="function" onClick="logFunction('prelogout_hook')" href="../../_functions/prelogout_hook.html" onMouseOver="funcPopup(event,'prelogout_hook')">prelogout_hook</a>() {
<a name="l859"><span class="linenum"> 859</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>;
<a name="l860"><span class="linenum"> 860</span></a>  
<a name="l861"><span class="linenum"> 861</span></a>          if (!<a class="function" onClick="logFunction('is_enabled_auth')" href="../../_functions/is_enabled_auth.html" onMouseOver="funcPopup(event,'is_enabled_auth')">is_enabled_auth</a>('mnet')) {
<a name="l862"><span class="linenum"> 862</span></a>              return;
<a name="l863"><span class="linenum"> 863</span></a>          }
<a name="l864"><span class="linenum"> 864</span></a>  
<a name="l865"><span class="linenum"> 865</span></a>  <span class="comment">        // If the user is local to this Moodle:</span>
<a name="l866"><span class="linenum"> 866</span></a>          if (<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/mnethostid.html">mnethostid</a> == <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('mnet')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/mnet.html">mnet</a>-&gt;id) {
<a name="l867"><span class="linenum"> 867</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('kill_children')" href="../../_functions/kill_children.html" onMouseOver="funcPopup(event,'kill_children')">kill_children</a>(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('username')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>, <a class="phpfunction" onClick="logFunction('sha1')" href="../../_functions/sha1.html" onMouseOver="phpfuncPopup(event,'sha1')">sha1</a>(<a class="var it836" onMouseOver="hilite(836)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['HTTP_USER_AGENT']));
<a name="l868"><span class="linenum"> 868</span></a>  
<a name="l869"><span class="linenum"> 869</span></a>  <span class="comment">        // Else the user has hit 'logout' at a Service Provider Moodle:</span>
<a name="l870"><span class="linenum"> 870</span></a>          } else {
<a name="l871"><span class="linenum"> 871</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('kill_parent')" href="../../_functions/kill_parent.html" onMouseOver="funcPopup(event,'kill_parent')">kill_parent</a>(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('username')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>, <a class="phpfunction" onClick="logFunction('sha1')" href="../../_functions/sha1.html" onMouseOver="phpfuncPopup(event,'sha1')">sha1</a>(<a class="var it836" onMouseOver="hilite(836)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['HTTP_USER_AGENT']));
<a name="l872"><span class="linenum"> 872</span></a>  
<a name="l873"><span class="linenum"> 873</span></a>          }
<a name="l874"><span class="linenum"> 874</span></a>      }
<a name="l875"><span class="linenum"> 875</span></a>  
<a name="l876"><span class="linenum"> 876</span></a>      <span class="comment">/**</span>
<a name="l877"><span class="linenum"> 877</span></a>  <span class="comment">     * The SP uses this function to kill the session on the parent IdP</span>
<a name="l878"><span class="linenum"> 878</span></a>  <span class="comment">     *</span>
<a name="l879"><span class="linenum"> 879</span></a>  <span class="comment">     * @param   string  $username       Username for session to kill</span>
<a name="l880"><span class="linenum"> 880</span></a>  <span class="comment">     * @param   string  $useragent      SHA1 hash of user agent to look for</span>
<a name="l881"><span class="linenum"> 881</span></a>  <span class="comment">     * @return  string                  A plaintext report of what has happened</span>
<a name="l882"><span class="linenum"> 882</span></a>  <span class="comment">     */</span>
<a name="l883"><span class="linenum"> 883</span></a>      function <a class="function" onClick="logFunction('kill_parent')" href="../../_functions/kill_parent.html" onMouseOver="funcPopup(event,'kill_parent')">kill_parent</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, <a class="var it1443" onMouseOver="hilite(1443)" onMouseOut="lolite()" onClick="logVariable('useragent')" href="../../_variables/useragent.html">$useragent</a>) {
<a name="l884"><span class="linenum"> 884</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l885"><span class="linenum"> 885</span></a>  
<a name="l886"><span class="linenum"> 886</span></a>          require_once <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../mnet/xmlrpc/client.php.html">/mnet/xmlrpc/client.php</a>';
<a name="l887"><span class="linenum"> 887</span></a>          <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;
<a name="l888"><span class="linenum"> 888</span></a>              select
<a name="l889"><span class="linenum"> 889</span></a>                  *
<a name="l890"><span class="linenum"> 890</span></a>              from
<a name="l891"><span class="linenum"> 891</span></a>                  {mnet_session} s
<a name="l892"><span class="linenum"> 892</span></a>              where
<a name="l893"><span class="linenum"> 893</span></a>                  s.username   = ? AND
<a name="l894"><span class="linenum"> 894</span></a>                  s.useragent  = ? AND
<a name="l895"><span class="linenum"> 895</span></a>                  s.mnethostid = ?&quot;;
<a name="l896"><span class="linenum"> 896</span></a>  
<a name="l897"><span class="linenum"> 897</span></a>          <a class="var it21690" onMouseOver="hilite(21690)" onMouseOut="lolite()" onClick="logVariable('mnetsessions')" href="../../_variables/mnetsessions.html">$mnetsessions</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, array(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, <a class="var it1443" onMouseOver="hilite(1443)" onMouseOut="lolite()" onClick="logVariable('useragent')" href="../../_variables/useragent.html">$useragent</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/mnethostid.html">mnethostid</a>));
<a name="l898"><span class="linenum"> 898</span></a>  
<a name="l899"><span class="linenum"> 899</span></a>          <a class="var it21719" onMouseOver="hilite(21719)" onMouseOut="lolite()" onClick="logVariable('ignore')" href="../../_variables/ignore.html">$ignore</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('mnet_session',
<a name="l900"><span class="linenum"> 900</span></a>                                   array('username'=&gt;<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>,
<a name="l901"><span class="linenum"> 901</span></a>                                   'useragent'=&gt;<a class="var it1443" onMouseOver="hilite(1443)" onMouseOut="lolite()" onClick="logVariable('useragent')" href="../../_variables/useragent.html">$useragent</a>,
<a name="l902"><span class="linenum"> 902</span></a>                                   'mnethostid'=&gt;<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/mnethostid.html">mnethostid</a>));
<a name="l903"><span class="linenum"> 903</span></a>  
<a name="l904"><span class="linenum"> 904</span></a>          if (false != <a class="var it21690" onMouseOver="hilite(21690)" onMouseOut="lolite()" onClick="logVariable('mnetsessions')" href="../../_variables/mnetsessions.html">$mnetsessions</a>) {
<a name="l905"><span class="linenum"> 905</span></a>              <a class="var it1361" onMouseOver="hilite(1361)" onMouseOut="lolite()" onClick="logVariable('mnet_peer')" href="../../_variables/mnet_peer.html">$mnet_peer</a> = <span class="keyword">new </span><a class="class" onClick="logClass('mnet_peer')" href="../../_classes/mnet_peer.html" onMouseOver="classPopup(event,'mnet_peer')">mnet_peer</a>();
<a name="l906"><span class="linenum"> 906</span></a>              <a class="var it1361" onMouseOver="hilite(1361)" onMouseOut="lolite()" onClick="logVariable('mnet_peer')" href="../../_variables/mnet_peer.html">$mnet_peer</a>-&gt;<a class="function" onClick="logFunction('set_id')" href="../../_functions/set_id.html" onMouseOver="funcPopup(event,'set_id')">set_id</a>(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/mnethostid.html">mnethostid</a>);
<a name="l907"><span class="linenum"> 907</span></a>  
<a name="l908"><span class="linenum"> 908</span></a>              <a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a> = <span class="keyword">new </span><a class="class" onClick="logClass('mnet_xmlrpc_client')" href="../../_classes/mnet_xmlrpc_client.html" onMouseOver="classPopup(event,'mnet_xmlrpc_client')">mnet_xmlrpc_client</a>();
<a name="l909"><span class="linenum"> 909</span></a>              <a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a>-&gt;<a class="function" onClick="logFunction('set_method')" href="../../_functions/set_method.html" onMouseOver="funcPopup(event,'set_method')">set_method</a>('auth/mnet/auth.php/kill_children');
<a name="l910"><span class="linenum"> 910</span></a>  
<a name="l911"><span class="linenum"> 911</span></a>  <span class="comment">            // set $token and $useragent parameters</span>
<a name="l912"><span class="linenum"> 912</span></a>              <a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a>-&gt;<a class="function" onClick="logFunction('add_param')" href="../../_functions/add_param.html" onMouseOver="funcPopup(event,'add_param')">add_param</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>);
<a name="l913"><span class="linenum"> 913</span></a>              <a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a>-&gt;<a class="function" onClick="logFunction('add_param')" href="../../_functions/add_param.html" onMouseOver="funcPopup(event,'add_param')">add_param</a>(<a class="var it1443" onMouseOver="hilite(1443)" onMouseOut="lolite()" onClick="logVariable('useragent')" href="../../_variables/useragent.html">$useragent</a>);
<a name="l914"><span class="linenum"> 914</span></a>              if (<a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a>-&gt;<a class="function" onClick="logFunction('send')" href="../../_functions/send.html" onMouseOver="funcPopup(event,'send')">send</a>(<a class="var it1361" onMouseOver="hilite(1361)" onMouseOut="lolite()" onClick="logVariable('mnet_peer')" href="../../_variables/mnet_peer.html">$mnet_peer</a>) === false) {
<a name="l915"><span class="linenum"> 915</span></a>                  <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(<a class="function" onClick="logFunction('join')" href="../../_functions/join.html" onMouseOver="funcPopup(event,'join')">join</a>(&quot;\n&quot;, <a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a>-&gt;<a onClick="logVariable('error')" class="var it44385" onMouseOver="hilite(44385)" onMouseOut="lolite()" href="../../_variables/error.html">error</a>));
<a name="l916"><span class="linenum"> 916</span></a>                  return false;
<a name="l917"><span class="linenum"> 917</span></a>              }
<a name="l918"><span class="linenum"> 918</span></a>          }
<a name="l919"><span class="linenum"> 919</span></a>  
<a name="l920"><span class="linenum"> 920</span></a>          return true;
<a name="l921"><span class="linenum"> 921</span></a>      }
<a name="l922"><span class="linenum"> 922</span></a>  
<a name="l923"><span class="linenum"> 923</span></a>      <span class="comment">/**</span>
<a name="l924"><span class="linenum"> 924</span></a>  <span class="comment">     * The IdP uses this function to kill child sessions on other hosts</span>
<a name="l925"><span class="linenum"> 925</span></a>  <span class="comment">     *</span>
<a name="l926"><span class="linenum"> 926</span></a>  <span class="comment">     * @param   string  $username       Username for session to kill</span>
<a name="l927"><span class="linenum"> 927</span></a>  <span class="comment">     * @param   string  $useragent      SHA1 hash of user agent to look for</span>
<a name="l928"><span class="linenum"> 928</span></a>  <span class="comment">     * @return  string                  A plaintext report of what has happened</span>
<a name="l929"><span class="linenum"> 929</span></a>  <span class="comment">     */</span>
<a name="l930"><span class="linenum"> 930</span></a>      function <a class="function" onClick="logFunction('kill_children')" href="../../_functions/kill_children.html" onMouseOver="funcPopup(event,'kill_children')">kill_children</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, <a class="var it1443" onMouseOver="hilite(1443)" onMouseOut="lolite()" onClick="logVariable('useragent')" href="../../_variables/useragent.html">$useragent</a>) {
<a name="l931"><span class="linenum"> 931</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l932"><span class="linenum"> 932</span></a>          <a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a> = null;
<a name="l933"><span class="linenum"> 933</span></a>          if (<a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MNET_SERVER')" href="../../_constants/MNET_SERVER.html" onMouseOver="constPopup(event,'MNET_SERVER')">MNET_SERVER</a>')) {
<a name="l934"><span class="linenum"> 934</span></a>              <a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a> = <a class="function" onClick="logFunction('get_mnet_remote_client')" href="../../_functions/get_mnet_remote_client.html" onMouseOver="funcPopup(event,'get_mnet_remote_client')">get_mnet_remote_client</a>();
<a name="l935"><span class="linenum"> 935</span></a>          }
<a name="l936"><span class="linenum"> 936</span></a>          require_once <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../mnet/xmlrpc/client.php.html">/mnet/xmlrpc/client.php</a>';
<a name="l937"><span class="linenum"> 937</span></a>  
<a name="l938"><span class="linenum"> 938</span></a>          <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_field')" href="../../_functions/get_field.html" onMouseOver="funcPopup(event,'get_field')">get_field</a>('user', 'id', array('mnethostid'=&gt;<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/mnet_localhost_id.html">mnet_localhost_id</a>, 'username'=&gt;<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>));
<a name="l939"><span class="linenum"> 939</span></a>  
<a name="l940"><span class="linenum"> 940</span></a>          <a class="var it3903" onMouseOver="hilite(3903)" onMouseOut="lolite()" onClick="logVariable('returnstring')" href="../../_variables/returnstring.html">$returnstring</a> = '';
<a name="l941"><span class="linenum"> 941</span></a>  
<a name="l942"><span class="linenum"> 942</span></a>          <a class="var it21690" onMouseOver="hilite(21690)" onMouseOut="lolite()" onClick="logVariable('mnetsessions')" href="../../_variables/mnetsessions.html">$mnetsessions</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('mnet_session', array('userid' =&gt; <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, 'useragent' =&gt; <a class="var it1443" onMouseOver="hilite(1443)" onMouseOut="lolite()" onClick="logVariable('useragent')" href="../../_variables/useragent.html">$useragent</a>));
<a name="l943"><span class="linenum"> 943</span></a>  
<a name="l944"><span class="linenum"> 944</span></a>          if (false == <a class="var it21690" onMouseOver="hilite(21690)" onMouseOut="lolite()" onClick="logVariable('mnetsessions')" href="../../_variables/mnetsessions.html">$mnetsessions</a>) {
<a name="l945"><span class="linenum"> 945</span></a>              <a class="var it3903" onMouseOver="hilite(3903)" onMouseOut="lolite()" onClick="logVariable('returnstring')" href="../../_variables/returnstring.html">$returnstring</a> .= &quot;Could find no remote sessions\n&quot;;
<a name="l946"><span class="linenum"> 946</span></a>              <a class="var it21690" onMouseOver="hilite(21690)" onMouseOut="lolite()" onClick="logVariable('mnetsessions')" href="../../_variables/mnetsessions.html">$mnetsessions</a> = array();
<a name="l947"><span class="linenum"> 947</span></a>          }
<a name="l948"><span class="linenum"> 948</span></a>  
<a name="l949"><span class="linenum"> 949</span></a>          foreach(<a class="var it21690" onMouseOver="hilite(21690)" onMouseOut="lolite()" onClick="logVariable('mnetsessions')" href="../../_variables/mnetsessions.html">$mnetsessions</a> as <a class="var it21691" onMouseOver="hilite(21691)" onMouseOut="lolite()" onClick="logVariable('mnetsession')" href="../../_variables/mnetsession.html">$mnetsession</a>) {
<a name="l950"><span class="linenum"> 950</span></a>  <span class="comment">            // If this script is being executed by a remote peer, that means the user has clicked</span>
<a name="l951"><span class="linenum"> 951</span></a>  <span class="comment">            // logout on that peer, and the session on that peer can be deleted natively.</span>
<a name="l952"><span class="linenum"> 952</span></a>  <span class="comment">            // Skip over it.</span>
<a name="l953"><span class="linenum"> 953</span></a>              if (isset(<a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a>-&gt;<a onClick="logVariable('id')" class="var it44373" onMouseOver="hilite(44373)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>) &amp;&amp; (<a class="var it21691" onMouseOver="hilite(21691)" onMouseOut="lolite()" onClick="logVariable('mnetsession')" href="../../_variables/mnetsession.html">$mnetsession</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it44380" onMouseOver="hilite(44380)" onMouseOut="lolite()" href="../../_variables/mnethostid.html">mnethostid</a> == <a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a>-&gt;<a onClick="logVariable('id')" class="var it44373" onMouseOver="hilite(44373)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>)) {
<a name="l954"><span class="linenum"> 954</span></a>                  continue;
<a name="l955"><span class="linenum"> 955</span></a>              }
<a name="l956"><span class="linenum"> 956</span></a>              <a class="var it3903" onMouseOver="hilite(3903)" onMouseOut="lolite()" onClick="logVariable('returnstring')" href="../../_variables/returnstring.html">$returnstring</a> .=  &quot;Deleting session\n&quot;;
<a name="l957"><span class="linenum"> 957</span></a>  
<a name="l958"><span class="linenum"> 958</span></a>              <a class="var it1361" onMouseOver="hilite(1361)" onMouseOut="lolite()" onClick="logVariable('mnet_peer')" href="../../_variables/mnet_peer.html">$mnet_peer</a> = <span class="keyword">new </span><a class="class" onClick="logClass('mnet_peer')" href="../../_classes/mnet_peer.html" onMouseOver="classPopup(event,'mnet_peer')">mnet_peer</a>();
<a name="l959"><span class="linenum"> 959</span></a>              <a class="var it1361" onMouseOver="hilite(1361)" onMouseOut="lolite()" onClick="logVariable('mnet_peer')" href="../../_variables/mnet_peer.html">$mnet_peer</a>-&gt;<a class="function" onClick="logFunction('set_id')" href="../../_functions/set_id.html" onMouseOver="funcPopup(event,'set_id')">set_id</a>(<a class="var it21691" onMouseOver="hilite(21691)" onMouseOut="lolite()" onClick="logVariable('mnetsession')" href="../../_variables/mnetsession.html">$mnetsession</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it44380" onMouseOver="hilite(44380)" onMouseOut="lolite()" href="../../_variables/mnethostid.html">mnethostid</a>);
<a name="l960"><span class="linenum"> 960</span></a>  
<a name="l961"><span class="linenum"> 961</span></a>              <a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a> = <span class="keyword">new </span><a class="class" onClick="logClass('mnet_xmlrpc_client')" href="../../_classes/mnet_xmlrpc_client.html" onMouseOver="classPopup(event,'mnet_xmlrpc_client')">mnet_xmlrpc_client</a>();
<a name="l962"><span class="linenum"> 962</span></a>              <a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a>-&gt;<a class="function" onClick="logFunction('set_method')" href="../../_functions/set_method.html" onMouseOver="funcPopup(event,'set_method')">set_method</a>('auth/mnet/auth.php/kill_child');
<a name="l963"><span class="linenum"> 963</span></a>  
<a name="l964"><span class="linenum"> 964</span></a>  <span class="comment">            // set $token and $useragent parameters</span>
<a name="l965"><span class="linenum"> 965</span></a>              <a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a>-&gt;<a class="function" onClick="logFunction('add_param')" href="../../_functions/add_param.html" onMouseOver="funcPopup(event,'add_param')">add_param</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>);
<a name="l966"><span class="linenum"> 966</span></a>              <a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a>-&gt;<a class="function" onClick="logFunction('add_param')" href="../../_functions/add_param.html" onMouseOver="funcPopup(event,'add_param')">add_param</a>(<a class="var it1443" onMouseOver="hilite(1443)" onMouseOut="lolite()" onClick="logVariable('useragent')" href="../../_variables/useragent.html">$useragent</a>);
<a name="l967"><span class="linenum"> 967</span></a>              if (<a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a>-&gt;<a class="function" onClick="logFunction('send')" href="../../_functions/send.html" onMouseOver="funcPopup(event,'send')">send</a>(<a class="var it1361" onMouseOver="hilite(1361)" onMouseOut="lolite()" onClick="logVariable('mnet_peer')" href="../../_variables/mnet_peer.html">$mnet_peer</a>) === false) {
<a name="l968"><span class="linenum"> 968</span></a>                  <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(&quot;Server side error has occured on host <a class="var it21691" onMouseOver="hilite(21691)" onMouseOut="lolite()" onClick="logVariable('mnetsession')" href="../../_variables/mnetsession.html">$mnetsession</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it44380" onMouseOver="hilite(44380)" onMouseOut="lolite()" href="../../_variables/mnethostid.html">mnethostid</a>: &quot; .
<a name="l969"><span class="linenum"> 969</span></a>                            <a class="function" onClick="logFunction('join')" href="../../_functions/join.html" onMouseOver="funcPopup(event,'join')">join</a>(&quot;\n&quot;, <a class="var it21710" onMouseOver="hilite(21710)" onMouseOut="lolite()" onClick="logVariable('mnet_request')" href="../../_variables/mnet_request.html">$mnet_request</a>-&gt;<a onClick="logVariable('error')" class="var it44385" onMouseOver="hilite(44385)" onMouseOut="lolite()" href="../../_variables/error.html">error</a>));
<a name="l970"><span class="linenum"> 970</span></a>              }
<a name="l971"><span class="linenum"> 971</span></a>          }
<a name="l972"><span class="linenum"> 972</span></a>  
<a name="l973"><span class="linenum"> 973</span></a>          <a class="var it21719" onMouseOver="hilite(21719)" onMouseOut="lolite()" onClick="logVariable('ignore')" href="../../_variables/ignore.html">$ignore</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('mnet_session',
<a name="l974"><span class="linenum"> 974</span></a>                                   array('useragent'=&gt;<a class="var it1443" onMouseOver="hilite(1443)" onMouseOut="lolite()" onClick="logVariable('useragent')" href="../../_variables/useragent.html">$useragent</a>, 'userid'=&gt;<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>));
<a name="l975"><span class="linenum"> 975</span></a>  
<a name="l976"><span class="linenum"> 976</span></a>          if (isset(<a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a>) &amp;&amp; isset(<a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a>-&gt;<a onClick="logVariable('id')" class="var it44373" onMouseOver="hilite(44373)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>)) {
<a name="l977"><span class="linenum"> 977</span></a>              \core\session\<a class="class" onClick="logClass('manager')" href="../../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('kill_user_sessions')" href="../../_functions/kill_user_sessions.html" onMouseOver="funcPopup(event,'kill_user_sessions')">kill_user_sessions</a>(<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>);
<a name="l978"><span class="linenum"> 978</span></a>          }
<a name="l979"><span class="linenum"> 979</span></a>          return <a class="var it3903" onMouseOver="hilite(3903)" onMouseOut="lolite()" onClick="logVariable('returnstring')" href="../../_variables/returnstring.html">$returnstring</a>;
<a name="l980"><span class="linenum"> 980</span></a>      }
<a name="l981"><span class="linenum"> 981</span></a>  
<a name="l982"><span class="linenum"> 982</span></a>      <span class="comment">/**</span>
<a name="l983"><span class="linenum"> 983</span></a>  <span class="comment">     * When the IdP requests that child sessions are terminated,</span>
<a name="l984"><span class="linenum"> 984</span></a>  <span class="comment">     * this function will be called on each of the child hosts. The machine that</span>
<a name="l985"><span class="linenum"> 985</span></a>  <span class="comment">     * calls the function (over xmlrpc) provides us with the mnethostid we need.</span>
<a name="l986"><span class="linenum"> 986</span></a>  <span class="comment">     *</span>
<a name="l987"><span class="linenum"> 987</span></a>  <span class="comment">     * @param   string  $username       Username for session to kill</span>
<a name="l988"><span class="linenum"> 988</span></a>  <span class="comment">     * @param   string  $useragent      SHA1 hash of user agent to look for</span>
<a name="l989"><span class="linenum"> 989</span></a>  <span class="comment">     * @return  bool                    True on success</span>
<a name="l990"><span class="linenum"> 990</span></a>  <span class="comment">     */</span>
<a name="l991"><span class="linenum"> 991</span></a>      function <a class="function" onClick="logFunction('kill_child')" href="../../_functions/kill_child.html" onMouseOver="funcPopup(event,'kill_child')">kill_child</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, <a class="var it1443" onMouseOver="hilite(1443)" onMouseOut="lolite()" onClick="logVariable('useragent')" href="../../_variables/useragent.html">$useragent</a>) {
<a name="l992"><span class="linenum"> 992</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l993"><span class="linenum"> 993</span></a>          <a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a> = <a class="function" onClick="logFunction('get_mnet_remote_client')" href="../../_functions/get_mnet_remote_client.html" onMouseOver="funcPopup(event,'get_mnet_remote_client')">get_mnet_remote_client</a>();
<a name="l994"><span class="linenum"> 994</span></a>          <a class="var it2387" onMouseOver="hilite(2387)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../_variables/session.html">$session</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('mnet_session', array('username'=&gt;<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, 'mnethostid'=&gt;<a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a>-&gt;<a onClick="logVariable('id')" class="var it44373" onMouseOver="hilite(44373)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'useragent'=&gt;<a class="var it1443" onMouseOver="hilite(1443)" onMouseOut="lolite()" onClick="logVariable('useragent')" href="../../_variables/useragent.html">$useragent</a>));
<a name="l995"><span class="linenum"> 995</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('mnet_session', array('username'=&gt;<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, 'mnethostid'=&gt;<a class="var it21674" onMouseOver="hilite(21674)" onMouseOut="lolite()" onClick="logVariable('remoteclient')" href="../../_variables/remoteclient.html">$remoteclient</a>-&gt;<a onClick="logVariable('id')" class="var it44373" onMouseOver="hilite(44373)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'useragent'=&gt;<a class="var it1443" onMouseOver="hilite(1443)" onMouseOut="lolite()" onClick="logVariable('useragent')" href="../../_variables/useragent.html">$useragent</a>));
<a name="l996"><span class="linenum"> 996</span></a>          if (false != <a class="var it2387" onMouseOver="hilite(2387)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../_variables/session.html">$session</a>) {
<a name="l997"><span class="linenum"> 997</span></a>              \core\session\<a class="class" onClick="logClass('manager')" href="../../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('kill_session')" href="../../_functions/kill_session.html" onMouseOver="funcPopup(event,'kill_session')">kill_session</a>(<a class="var it2387" onMouseOver="hilite(2387)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../_variables/session.html">$session</a>-&gt;<a onClick="logVariable('session_id')" class="var it43343" onMouseOver="hilite(43343)" onMouseOut="lolite()" href="../../_variables/session_id.html">session_id</a>);
<a name="l998"><span class="linenum"> 998</span></a>              return true;
<a name="l999"><span class="linenum"> 999</span></a>          }
<a name="l1000"><span class="linenum">1000</span></a>          return false;
<a name="l1001"><span class="linenum">1001</span></a>      }
<a name="l1002"><span class="linenum">1002</span></a>  
<a name="l1003"><span class="linenum">1003</span></a>      <span class="comment">/**</span>
<a name="l1004"><span class="linenum">1004</span></a>  <span class="comment">     * To delete a host, we must delete all current sessions that users from</span>
<a name="l1005"><span class="linenum">1005</span></a>  <span class="comment">     * that host are currently engaged in.</span>
<a name="l1006"><span class="linenum">1006</span></a>  <span class="comment">     *</span>
<a name="l1007"><span class="linenum">1007</span></a>  <span class="comment">     * @param   string  $sessionidarray   An array of session hashes</span>
<a name="l1008"><span class="linenum">1008</span></a>  <span class="comment">     * @return  bool                      True on success</span>
<a name="l1009"><span class="linenum">1009</span></a>  <span class="comment">     */</span>
<a name="l1010"><span class="linenum">1010</span></a>      function <a class="function" onClick="logFunction('end_local_sessions')" href="../../_functions/end_local_sessions.html" onMouseOver="funcPopup(event,'end_local_sessions')">end_local_sessions</a>(&amp;<a class="var it21720" onMouseOver="hilite(21720)" onMouseOut="lolite()" onClick="logVariable('sessionArray')" href="../../_variables/sessionArray.html">$sessionArray</a>) {
<a name="l1011"><span class="linenum">1011</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l1012"><span class="linenum">1012</span></a>          if (<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it21720" onMouseOver="hilite(21720)" onMouseOut="lolite()" onClick="logVariable('sessionArray')" href="../../_variables/sessionArray.html">$sessionArray</a>)) {
<a name="l1013"><span class="linenum">1013</span></a>              while(<a class="var it2387" onMouseOver="hilite(2387)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../_variables/session.html">$session</a> = <a class="phpfunction" onClick="logFunction('array_pop')" href="../../_functions/array_pop.html" onMouseOver="phpfuncPopup(event,'array_pop')">array_pop</a>(<a class="var it21720" onMouseOver="hilite(21720)" onMouseOut="lolite()" onClick="logVariable('sessionArray')" href="../../_variables/sessionArray.html">$sessionArray</a>)) {
<a name="l1014"><span class="linenum">1014</span></a>                  \core\session\<a class="class" onClick="logClass('manager')" href="../../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('kill_session')" href="../../_functions/kill_session.html" onMouseOver="funcPopup(event,'kill_session')">kill_session</a>(<a class="var it2387" onMouseOver="hilite(2387)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../_variables/session.html">$session</a>-&gt;<a onClick="logVariable('session_id')" class="var it43343" onMouseOver="hilite(43343)" onMouseOut="lolite()" href="../../_variables/session_id.html">session_id</a>);
<a name="l1015"><span class="linenum">1015</span></a>              }
<a name="l1016"><span class="linenum">1016</span></a>              return true;
<a name="l1017"><span class="linenum">1017</span></a>          }
<a name="l1018"><span class="linenum">1018</span></a>          return false;
<a name="l1019"><span class="linenum">1019</span></a>      }
<a name="l1020"><span class="linenum">1020</span></a>  
<a name="l1021"><span class="linenum">1021</span></a>      <span class="comment">/**</span>
<a name="l1022"><span class="linenum">1022</span></a>  <span class="comment">     * Returns the user's profile image info</span>
<a name="l1023"><span class="linenum">1023</span></a>  <span class="comment">     *</span>
<a name="l1024"><span class="linenum">1024</span></a>  <span class="comment">     * If the user exists and has a profile picture, the returned array will contain keys:</span>
<a name="l1025"><span class="linenum">1025</span></a>  <span class="comment">     *  f1          - the content of the default 100x100px image</span>
<a name="l1026"><span class="linenum">1026</span></a>  <span class="comment">     *  f1_mimetype - the mimetype of the f1 file</span>
<a name="l1027"><span class="linenum">1027</span></a>  <span class="comment">     *  f2          - the content of the 35x35px variant of the image</span>
<a name="l1028"><span class="linenum">1028</span></a>  <span class="comment">     *  f2_mimetype - the mimetype of the f2 file</span>
<a name="l1029"><span class="linenum">1029</span></a>  <span class="comment">     *</span>
<a name="l1030"><span class="linenum">1030</span></a>  <span class="comment">     * The mimetype information was added in Moodle 2.0. In Moodle 1.x, images are always jpegs.</span>
<a name="l1031"><span class="linenum">1031</span></a>  <span class="comment">     *</span>
<a name="l1032"><span class="linenum">1032</span></a>  <span class="comment">     * @see process_new_icon()</span>
<a name="l1033"><span class="linenum">1033</span></a>  <span class="comment">     * @uses mnet_remote_client callable via MNet XML-RPC</span>
<a name="l1034"><span class="linenum">1034</span></a>  <span class="comment">     * @param int $username The id of the user</span>
<a name="l1035"><span class="linenum">1035</span></a>  <span class="comment">     * @return false|array false if user not found, empty array if no picture exists, array with data otherwise</span>
<a name="l1036"><span class="linenum">1036</span></a>  <span class="comment">     */</span>
<a name="l1037"><span class="linenum">1037</span></a>      function <a class="function" onClick="logFunction('fetch_user_image')" href="../../_functions/fetch_user_image.html" onMouseOver="funcPopup(event,'fetch_user_image')">fetch_user_image</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>) {
<a name="l1038"><span class="linenum">1038</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1039"><span class="linenum">1039</span></a>  
<a name="l1040"><span class="linenum">1040</span></a>          if (<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user', array('username' =&gt; <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, 'mnethostid' =&gt; <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/mnet_localhost_id.html">mnet_localhost_id</a>))) {
<a name="l1041"><span class="linenum">1041</span></a>              <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a> = <a class="function" onClick="logFunction('get_file_storage')" href="../../_functions/get_file_storage.html" onMouseOver="funcPopup(event,'get_file_storage')">get_file_storage</a>();
<a name="l1042"><span class="linenum">1042</span></a>              <a class="var it639" onMouseOver="hilite(639)" onMouseOut="lolite()" onClick="logVariable('usercontext')" href="../../_variables/usercontext.html">$usercontext</a> = <a class="class" onClick="logClass('context_user')" href="../../_classes/context_user.html" onMouseOver="classPopup(event,'context_user')">context_user</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="constant" onClick="logConstant('MUST_EXIST')" href="../../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l1043"><span class="linenum">1043</span></a>              <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a> = array();
<a name="l1044"><span class="linenum">1044</span></a>              if (<a class="var it8758" onMouseOver="hilite(8758)" onMouseOut="lolite()" onClick="logVariable('f1')" href="../../_variables/f1.html">$f1</a> = <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('get_file')" href="../../_functions/get_file.html" onMouseOver="funcPopup(event,'get_file')">get_file</a>(<a class="var it639" onMouseOver="hilite(639)" onMouseOut="lolite()" onClick="logVariable('usercontext')" href="../../_variables/usercontext.html">$usercontext</a>-&gt;<a onClick="logVariable('id')" class="var it43024" onMouseOver="hilite(43024)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'user', 'icon', 0, '/', 'f1.png')) {
<a name="l1045"><span class="linenum">1045</span></a>                  <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a>['f1'] = <a class="phpfunction" onClick="logFunction('base64_encode')" href="../../_functions/base64_encode.html" onMouseOver="phpfuncPopup(event,'base64_encode')">base64_encode</a>(<a class="var it8758" onMouseOver="hilite(8758)" onMouseOut="lolite()" onClick="logVariable('f1')" href="../../_variables/f1.html">$f1</a>-&gt;<a class="function" onClick="logFunction('get_content')" href="../../_functions/get_content.html" onMouseOver="funcPopup(event,'get_content')">get_content</a>());
<a name="l1046"><span class="linenum">1046</span></a>                  <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a>['f1_mimetype'] = <a class="var it8758" onMouseOver="hilite(8758)" onMouseOut="lolite()" onClick="logVariable('f1')" href="../../_variables/f1.html">$f1</a>-&gt;<a class="function" onClick="logFunction('get_mimetype')" href="../../_functions/get_mimetype.html" onMouseOver="funcPopup(event,'get_mimetype')">get_mimetype</a>();
<a name="l1047"><span class="linenum">1047</span></a>              } else if (<a class="var it8758" onMouseOver="hilite(8758)" onMouseOut="lolite()" onClick="logVariable('f1')" href="../../_variables/f1.html">$f1</a> = <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('get_file')" href="../../_functions/get_file.html" onMouseOver="funcPopup(event,'get_file')">get_file</a>(<a class="var it639" onMouseOver="hilite(639)" onMouseOut="lolite()" onClick="logVariable('usercontext')" href="../../_variables/usercontext.html">$usercontext</a>-&gt;<a onClick="logVariable('id')" class="var it43024" onMouseOver="hilite(43024)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'user', 'icon', 0, '/', 'f1.jpg')) {
<a name="l1048"><span class="linenum">1048</span></a>                  <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a>['f1'] = <a class="phpfunction" onClick="logFunction('base64_encode')" href="../../_functions/base64_encode.html" onMouseOver="phpfuncPopup(event,'base64_encode')">base64_encode</a>(<a class="var it8758" onMouseOver="hilite(8758)" onMouseOut="lolite()" onClick="logVariable('f1')" href="../../_variables/f1.html">$f1</a>-&gt;<a class="function" onClick="logFunction('get_content')" href="../../_functions/get_content.html" onMouseOver="funcPopup(event,'get_content')">get_content</a>());
<a name="l1049"><span class="linenum">1049</span></a>                  <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a>['f1_mimetype'] = <a class="var it8758" onMouseOver="hilite(8758)" onMouseOut="lolite()" onClick="logVariable('f1')" href="../../_variables/f1.html">$f1</a>-&gt;<a class="function" onClick="logFunction('get_mimetype')" href="../../_functions/get_mimetype.html" onMouseOver="funcPopup(event,'get_mimetype')">get_mimetype</a>();
<a name="l1050"><span class="linenum">1050</span></a>              }
<a name="l1051"><span class="linenum">1051</span></a>              if (<a class="var it10311" onMouseOver="hilite(10311)" onMouseOut="lolite()" onClick="logVariable('f2')" href="../../_variables/f2.html">$f2</a> = <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('get_file')" href="../../_functions/get_file.html" onMouseOver="funcPopup(event,'get_file')">get_file</a>(<a class="var it639" onMouseOver="hilite(639)" onMouseOut="lolite()" onClick="logVariable('usercontext')" href="../../_variables/usercontext.html">$usercontext</a>-&gt;<a onClick="logVariable('id')" class="var it43024" onMouseOver="hilite(43024)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'user', 'icon', 0, '/', 'f2.png')) {
<a name="l1052"><span class="linenum">1052</span></a>                  <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a>['f2'] = <a class="phpfunction" onClick="logFunction('base64_encode')" href="../../_functions/base64_encode.html" onMouseOver="phpfuncPopup(event,'base64_encode')">base64_encode</a>(<a class="var it10311" onMouseOver="hilite(10311)" onMouseOut="lolite()" onClick="logVariable('f2')" href="../../_variables/f2.html">$f2</a>-&gt;<a class="function" onClick="logFunction('get_content')" href="../../_functions/get_content.html" onMouseOver="funcPopup(event,'get_content')">get_content</a>());
<a name="l1053"><span class="linenum">1053</span></a>                  <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a>['f2_mimetype'] = <a class="var it10311" onMouseOver="hilite(10311)" onMouseOut="lolite()" onClick="logVariable('f2')" href="../../_variables/f2.html">$f2</a>-&gt;<a class="function" onClick="logFunction('get_mimetype')" href="../../_functions/get_mimetype.html" onMouseOver="funcPopup(event,'get_mimetype')">get_mimetype</a>();
<a name="l1054"><span class="linenum">1054</span></a>              } else if (<a class="var it10311" onMouseOver="hilite(10311)" onMouseOut="lolite()" onClick="logVariable('f2')" href="../../_variables/f2.html">$f2</a> = <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('get_file')" href="../../_functions/get_file.html" onMouseOver="funcPopup(event,'get_file')">get_file</a>(<a class="var it639" onMouseOver="hilite(639)" onMouseOut="lolite()" onClick="logVariable('usercontext')" href="../../_variables/usercontext.html">$usercontext</a>-&gt;<a onClick="logVariable('id')" class="var it43024" onMouseOver="hilite(43024)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'user', 'icon', 0, '/', 'f2.jpg')) {
<a name="l1055"><span class="linenum">1055</span></a>                  <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a>['f2'] = <a class="phpfunction" onClick="logFunction('base64_encode')" href="../../_functions/base64_encode.html" onMouseOver="phpfuncPopup(event,'base64_encode')">base64_encode</a>(<a class="var it10311" onMouseOver="hilite(10311)" onMouseOut="lolite()" onClick="logVariable('f2')" href="../../_variables/f2.html">$f2</a>-&gt;<a class="function" onClick="logFunction('get_content')" href="../../_functions/get_content.html" onMouseOver="funcPopup(event,'get_content')">get_content</a>());
<a name="l1056"><span class="linenum">1056</span></a>                  <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a>['f2_mimetype'] = <a class="var it10311" onMouseOver="hilite(10311)" onMouseOut="lolite()" onClick="logVariable('f2')" href="../../_variables/f2.html">$f2</a>-&gt;<a class="function" onClick="logFunction('get_mimetype')" href="../../_functions/get_mimetype.html" onMouseOver="funcPopup(event,'get_mimetype')">get_mimetype</a>();
<a name="l1057"><span class="linenum">1057</span></a>              }
<a name="l1058"><span class="linenum">1058</span></a>              return <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a>;
<a name="l1059"><span class="linenum">1059</span></a>          }
<a name="l1060"><span class="linenum">1060</span></a>          return false;
<a name="l1061"><span class="linenum">1061</span></a>      }
<a name="l1062"><span class="linenum">1062</span></a>  
<a name="l1063"><span class="linenum">1063</span></a>      <span class="comment">/**</span>
<a name="l1064"><span class="linenum">1064</span></a>  <span class="comment">     * Returns the theme information and logo url as strings.</span>
<a name="l1065"><span class="linenum">1065</span></a>  <span class="comment">     *</span>
<a name="l1066"><span class="linenum">1066</span></a>  <span class="comment">     * @return string     The theme info</span>
<a name="l1067"><span class="linenum">1067</span></a>  <span class="comment">     */</span>
<a name="l1068"><span class="linenum">1068</span></a>      function <a class="function" onClick="logFunction('fetch_theme_info')" href="../../_functions/fetch_theme_info.html" onMouseOver="funcPopup(event,'fetch_theme_info')">fetch_theme_info</a>() {
<a name="l1069"><span class="linenum">1069</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l1070"><span class="linenum">1070</span></a>  
<a name="l1071"><span class="linenum">1071</span></a>          <a class="var it8617" onMouseOver="hilite(8617)" onMouseOut="lolite()" onClick="logVariable('themename')" href="../../_variables/themename.html">$themename</a> = &quot;<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('theme')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/theme.html">theme</a>&quot;;
<a name="l1072"><span class="linenum">1072</span></a>          <a class="var it21721" onMouseOver="hilite(21721)" onMouseOut="lolite()" onClick="logVariable('logourl')" href="../../_variables/logourl.html">$logourl</a>   = &quot;<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>/theme/<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('theme')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/theme.html">theme</a>/images/logo.jpg&quot;;
<a name="l1073"><span class="linenum">1073</span></a>  
<a name="l1074"><span class="linenum">1074</span></a>          <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a>['themename'] = <a class="var it8617" onMouseOver="hilite(8617)" onMouseOut="lolite()" onClick="logVariable('themename')" href="../../_variables/themename.html">$themename</a>;
<a name="l1075"><span class="linenum">1075</span></a>          <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a>['logourl'] = <a class="var it21721" onMouseOver="hilite(21721)" onMouseOut="lolite()" onClick="logVariable('logourl')" href="../../_variables/logourl.html">$logourl</a>;
<a name="l1076"><span class="linenum">1076</span></a>          return <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a>;
<a name="l1077"><span class="linenum">1077</span></a>      }
<a name="l1078"><span class="linenum">1078</span></a>  
<a name="l1079"><span class="linenum">1079</span></a>      <span class="comment">/**</span>
<a name="l1080"><span class="linenum">1080</span></a>  <span class="comment">     * Determines if an MNET host is providing the nominated service.</span>
<a name="l1081"><span class="linenum">1081</span></a>  <span class="comment">     *</span>
<a name="l1082"><span class="linenum">1082</span></a>  <span class="comment">     * @param int    $mnethostid   The id of the remote host</span>
<a name="l1083"><span class="linenum">1083</span></a>  <span class="comment">     * @param string $servicename  The name of the service</span>
<a name="l1084"><span class="linenum">1084</span></a>  <span class="comment">     * @return bool                Whether the service is available on the remote host</span>
<a name="l1085"><span class="linenum">1085</span></a>  <span class="comment">     */</span>
<a name="l1086"><span class="linenum">1086</span></a>      function <a class="function" onClick="logFunction('has_service')" href="../../_functions/has_service.html" onMouseOver="funcPopup(event,'has_service')">has_service</a>(<a class="var it3328" onMouseOver="hilite(3328)" onMouseOut="lolite()" onClick="logVariable('mnethostid')" href="../../_variables/mnethostid.html">$mnethostid</a>, <a class="var it19256" onMouseOver="hilite(19256)" onMouseOut="lolite()" onClick="logVariable('servicename')" href="../../_variables/servicename.html">$servicename</a>) {
<a name="l1087"><span class="linenum">1087</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1088"><span class="linenum">1088</span></a>  
<a name="l1089"><span class="linenum">1089</span></a>          <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;
<a name="l1090"><span class="linenum">1090</span></a>              SELECT
<a name="l1091"><span class="linenum">1091</span></a>                  svc.id as serviceid,
<a name="l1092"><span class="linenum">1092</span></a>                  svc.name,
<a name="l1093"><span class="linenum">1093</span></a>                  svc.description,
<a name="l1094"><span class="linenum">1094</span></a>                  svc.offer,
<a name="l1095"><span class="linenum">1095</span></a>                  svc.apiversion,
<a name="l1096"><span class="linenum">1096</span></a>                  h2s.id as h2s_id
<a name="l1097"><span class="linenum">1097</span></a>              FROM
<a name="l1098"><span class="linenum">1098</span></a>                  {mnet_host} h,
<a name="l1099"><span class="linenum">1099</span></a>                  {mnet_service} svc,
<a name="l1100"><span class="linenum">1100</span></a>                  {mnet_host2service} h2s
<a name="l1101"><span class="linenum">1101</span></a>              WHERE
<a name="l1102"><span class="linenum">1102</span></a>                  h.deleted = '0' AND
<a name="l1103"><span class="linenum">1103</span></a>                  h.id = h2s.hostid AND
<a name="l1104"><span class="linenum">1104</span></a>                  h2s.hostid = ? AND
<a name="l1105"><span class="linenum">1105</span></a>                  h2s.serviceid = svc.id AND
<a name="l1106"><span class="linenum">1106</span></a>                  svc.name = ? AND
<a name="l1107"><span class="linenum">1107</span></a>                  h2s.subscribe = '1'&quot;;
<a name="l1108"><span class="linenum">1108</span></a>  
<a name="l1109"><span class="linenum">1109</span></a>          return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, array(<a class="var it3328" onMouseOver="hilite(3328)" onMouseOut="lolite()" onClick="logVariable('mnethostid')" href="../../_variables/mnethostid.html">$mnethostid</a>, <a class="var it19256" onMouseOver="hilite(19256)" onMouseOut="lolite()" onClick="logVariable('servicename')" href="../../_variables/servicename.html">$servicename</a>));
<a name="l1110"><span class="linenum">1110</span></a>      }
<a name="l1111"><span class="linenum">1111</span></a>  
<a name="l1112"><span class="linenum">1112</span></a>      <span class="comment">/**</span>
<a name="l1113"><span class="linenum">1113</span></a>  <span class="comment">     * Checks the MNET access control table to see if the username/mnethost</span>
<a name="l1114"><span class="linenum">1114</span></a>  <span class="comment">     * is permitted to login to this moodle.</span>
<a name="l1115"><span class="linenum">1115</span></a>  <span class="comment">     *</span>
<a name="l1116"><span class="linenum">1116</span></a>  <span class="comment">     * @param string $username   The username</span>
<a name="l1117"><span class="linenum">1117</span></a>  <span class="comment">     * @param int    $mnethostid The id of the remote mnethost</span>
<a name="l1118"><span class="linenum">1118</span></a>  <span class="comment">     * @return bool              Whether the user can login from the remote host</span>
<a name="l1119"><span class="linenum">1119</span></a>  <span class="comment">     */</span>
<a name="l1120"><span class="linenum">1120</span></a>      function <a class="function" onClick="logFunction('can_login_remotely')" href="../../_functions/can_login_remotely.html" onMouseOver="funcPopup(event,'can_login_remotely')">can_login_remotely</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, <a class="var it3328" onMouseOver="hilite(3328)" onMouseOut="lolite()" onClick="logVariable('mnethostid')" href="../../_variables/mnethostid.html">$mnethostid</a>) {
<a name="l1121"><span class="linenum">1121</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1122"><span class="linenum">1122</span></a>  
<a name="l1123"><span class="linenum">1123</span></a>          <a class="var it2362" onMouseOver="hilite(2362)" onMouseOut="lolite()" onClick="logVariable('accessctrl')" href="../../_variables/accessctrl.html">$accessctrl</a> = 'allow';
<a name="l1124"><span class="linenum">1124</span></a>          <a class="var it19960" onMouseOver="hilite(19960)" onMouseOut="lolite()" onClick="logVariable('aclrecord')" href="../../_variables/aclrecord.html">$aclrecord</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('mnet_sso_access_control', array('username'=&gt;<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>, 'mnet_host_id'=&gt;<a class="var it3328" onMouseOver="hilite(3328)" onMouseOut="lolite()" onClick="logVariable('mnethostid')" href="../../_variables/mnethostid.html">$mnethostid</a>));
<a name="l1125"><span class="linenum">1125</span></a>          if (!empty(<a class="var it19960" onMouseOver="hilite(19960)" onMouseOut="lolite()" onClick="logVariable('aclrecord')" href="../../_variables/aclrecord.html">$aclrecord</a>)) {
<a name="l1126"><span class="linenum">1126</span></a>              <a class="var it2362" onMouseOver="hilite(2362)" onMouseOut="lolite()" onClick="logVariable('accessctrl')" href="../../_variables/accessctrl.html">$accessctrl</a> = <a class="var it19960" onMouseOver="hilite(19960)" onMouseOut="lolite()" onClick="logVariable('aclrecord')" href="../../_variables/aclrecord.html">$aclrecord</a>-&gt;<a onClick="logVariable('accessctrl')" class="var it43260" onMouseOver="hilite(43260)" onMouseOut="lolite()" href="../../_variables/accessctrl.html">accessctrl</a>;
<a name="l1127"><span class="linenum">1127</span></a>          }
<a name="l1128"><span class="linenum">1128</span></a>          return <a class="var it2362" onMouseOver="hilite(2362)" onMouseOut="lolite()" onClick="logVariable('accessctrl')" href="../../_variables/accessctrl.html">$accessctrl</a> == 'allow';
<a name="l1129"><span class="linenum">1129</span></a>      }
<a name="l1130"><span class="linenum">1130</span></a>  
<a name="l1131"><span class="linenum">1131</span></a>      function <a class="function" onClick="logFunction('logoutpage_hook')" href="../../_functions/logoutpage_hook.html" onMouseOver="funcPopup(event,'logoutpage_hook')">logoutpage_hook</a>() {
<a name="l1132"><span class="linenum">1132</span></a>          global <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it4789" onMouseOver="hilite(4789)" onMouseOut="lolite()" onClick="logVariable('redirect')" href="../../_variables/redirect.html">$redirect</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1133"><span class="linenum">1133</span></a>  
<a name="l1134"><span class="linenum">1134</span></a>          if (!empty(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/mnethostid.html">mnethostid</a>) and <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/mnethostid.html">mnethostid</a> != <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/mnet_localhost_id.html">mnet_localhost_id</a>) {
<a name="l1135"><span class="linenum">1135</span></a>              <a class="var it213" onMouseOver="hilite(213)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../_variables/host.html">$host</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('mnet_host', array('id'=&gt;<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/mnethostid.html">mnethostid</a>));
<a name="l1136"><span class="linenum">1136</span></a>              <a class="var it4789" onMouseOver="hilite(4789)" onMouseOut="lolite()" onClick="logVariable('redirect')" href="../../_variables/redirect.html">$redirect</a> = <a class="var it213" onMouseOver="hilite(213)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../_variables/host.html">$host</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it43652" onMouseOver="hilite(43652)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>.'/';
<a name="l1137"><span class="linenum">1137</span></a>          }
<a name="l1138"><span class="linenum">1138</span></a>      }
<a name="l1139"><span class="linenum">1139</span></a>  
<a name="l1140"><span class="linenum">1140</span></a>      <span class="comment">/**</span>
<a name="l1141"><span class="linenum">1141</span></a>  <span class="comment">     * Trims a log line from mnet peer to limit each part to a length which can be stored in our DB</span>
<a name="l1142"><span class="linenum">1142</span></a>  <span class="comment">     *</span>
<a name="l1143"><span class="linenum">1143</span></a>  <span class="comment">     * @param object $logline The log information to be trimmed</span>
<a name="l1144"><span class="linenum">1144</span></a>  <span class="comment">     * @return object The passed logline object trimmed to not exceed storable limits</span>
<a name="l1145"><span class="linenum">1145</span></a>  <span class="comment">     */</span>
<a name="l1146"><span class="linenum">1146</span></a>      function <a class="function" onClick="logFunction('trim_logline')" href="../../_functions/trim_logline.html" onMouseOver="funcPopup(event,'trim_logline')">trim_logline</a> (<a class="var it21722" onMouseOver="hilite(21722)" onMouseOut="lolite()" onClick="logVariable('logline')" href="../../_variables/logline.html">$logline</a>) {
<a name="l1147"><span class="linenum">1147</span></a>          <a class="var it9785" onMouseOver="hilite(9785)" onMouseOut="lolite()" onClick="logVariable('limits')" href="../../_variables/limits.html">$limits</a> = array('ip' =&gt; 15, 'coursename' =&gt; 40, 'module' =&gt; 20, 'action' =&gt; 40,
<a name="l1148"><span class="linenum">1148</span></a>                          'url' =&gt; 255);
<a name="l1149"><span class="linenum">1149</span></a>          foreach (<a class="var it9785" onMouseOver="hilite(9785)" onMouseOut="lolite()" onClick="logVariable('limits')" href="../../_variables/limits.html">$limits</a> as <a class="var it1414" onMouseOver="hilite(1414)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a> =&gt; <a class="var it1051" onMouseOver="hilite(1051)" onMouseOut="lolite()" onClick="logVariable('limit')" href="../../_variables/limit.html">$limit</a>) {
<a name="l1150"><span class="linenum">1150</span></a>              if (isset(<a class="var it21722" onMouseOver="hilite(21722)" onMouseOut="lolite()" onClick="logVariable('logline')" href="../../_variables/logline.html">$logline</a>-&gt;<a class="var it1414" onMouseOver="hilite(1414)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a>)) {
<a name="l1151"><span class="linenum">1151</span></a>                  <a class="var it21722" onMouseOver="hilite(21722)" onMouseOut="lolite()" onClick="logVariable('logline')" href="../../_variables/logline.html">$logline</a>-&gt;<a class="var it1414" onMouseOver="hilite(1414)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it21722" onMouseOver="hilite(21722)" onMouseOut="lolite()" onClick="logVariable('logline')" href="../../_variables/logline.html">$logline</a>-&gt;<a class="var it1414" onMouseOver="hilite(1414)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a>, 0, <a class="var it1051" onMouseOver="hilite(1051)" onMouseOut="lolite()" onClick="logVariable('limit')" href="../../_variables/limit.html">$limit</a>);
<a name="l1152"><span class="linenum">1152</span></a>              }
<a name="l1153"><span class="linenum">1153</span></a>          }
<a name="l1154"><span class="linenum">1154</span></a>  
<a name="l1155"><span class="linenum">1155</span></a>          return <a class="var it21722" onMouseOver="hilite(21722)" onMouseOut="lolite()" onClick="logVariable('logline')" href="../../_variables/logline.html">$logline</a>;
<a name="l1156"><span class="linenum">1156</span></a>      }
<a name="l1157"><span class="linenum">1157</span></a>  
<a name="l1158"><span class="linenum">1158</span></a>      <span class="comment">/**</span>
<a name="l1159"><span class="linenum">1159</span></a>  <span class="comment">     * Returns a list of potential IdPs that this authentication plugin supports.</span>
<a name="l1160"><span class="linenum">1160</span></a>  <span class="comment">     * This is used to provide links on the login page.</span>
<a name="l1161"><span class="linenum">1161</span></a>  <span class="comment">     *</span>
<a name="l1162"><span class="linenum">1162</span></a>  <span class="comment">     * @param string $wantsurl the relative url fragment the user wants to get to.  You can use this to compose a returnurl, for example</span>
<a name="l1163"><span class="linenum">1163</span></a>  <span class="comment">     *</span>
<a name="l1164"><span class="linenum">1164</span></a>  <span class="comment">     * @return array like:</span>
<a name="l1165"><span class="linenum">1165</span></a>  <span class="comment">     *              array(</span>
<a name="l1166"><span class="linenum">1166</span></a>  <span class="comment">     *                  array(</span>
<a name="l1167"><span class="linenum">1167</span></a>  <span class="comment">     *                      'url' =&gt; 'http://someurl',</span>
<a name="l1168"><span class="linenum">1168</span></a>  <span class="comment">     *                      'icon' =&gt; new pix_icon(...),</span>
<a name="l1169"><span class="linenum">1169</span></a>  <span class="comment">     *                      'name' =&gt; get_string('somename', 'auth_yourplugin'),</span>
<a name="l1170"><span class="linenum">1170</span></a>  <span class="comment">     *                 ),</span>
<a name="l1171"><span class="linenum">1171</span></a>  <span class="comment">     *             )</span>
<a name="l1172"><span class="linenum">1172</span></a>  <span class="comment">     */</span>
<a name="l1173"><span class="linenum">1173</span></a>      function <a class="function" onClick="logFunction('loginpage_idp_list')" href="../../_functions/loginpage_idp_list.html" onMouseOver="funcPopup(event,'loginpage_idp_list')">loginpage_idp_list</a>(<a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('wantsurl')" href="../../_variables/wantsurl.html">$wantsurl</a>) {
<a name="l1174"><span class="linenum">1174</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l1175"><span class="linenum">1175</span></a>  
<a name="l1176"><span class="linenum">1176</span></a>  <span class="comment">        // strip off wwwroot, since the remote site will prefix it's return url with this</span>
<a name="l1177"><span class="linenum">1177</span></a>          <a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('wantsurl')" href="../../_variables/wantsurl.html">$wantsurl</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/(' . <a class="phpfunction" onClick="logFunction('preg_quote')" href="../../_functions/preg_quote.html" onMouseOver="phpfuncPopup(event,'preg_quote')">preg_quote</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>, '/') . '|' . <a class="phpfunction" onClick="logFunction('preg_quote')" href="../../_functions/preg_quote.html" onMouseOver="phpfuncPopup(event,'preg_quote')">preg_quote</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('httpswwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/httpswwwroot.html">httpswwwroot</a>, '/') . ')/', '', <a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('wantsurl')" href="../../_variables/wantsurl.html">$wantsurl</a>);
<a name="l1178"><span class="linenum">1178</span></a>  
<a name="l1179"><span class="linenum">1179</span></a>          <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT DISTINCT h.id, h.wwwroot, h.name, a.sso_jump_url, a.name as application
<a name="l1180"><span class="linenum">1180</span></a>                    FROM {mnet_host} h
<a name="l1181"><span class="linenum">1181</span></a>                    JOIN {mnet_host2service} m ON h.id = m.hostid
<a name="l1182"><span class="linenum">1182</span></a>                    JOIN {mnet_service} s ON s.id = m.serviceid
<a name="l1183"><span class="linenum">1183</span></a>                    JOIN {mnet_application} a ON h.applicationid = a.id
<a name="l1184"><span class="linenum">1184</span></a>                   WHERE s.name = ? AND h.deleted = ? AND m.publish = ?&quot;;
<a name="l1185"><span class="linenum">1185</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('sso_sp', 0, 1);
<a name="l1186"><span class="linenum">1186</span></a>  
<a name="l1187"><span class="linenum">1187</span></a>          if (!empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_all_hosts_id')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/mnet_all_hosts_id.html">mnet_all_hosts_id</a>)) {
<a name="l1188"><span class="linenum">1188</span></a>              <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> .= &quot; AND h.id &lt;&gt; ?&quot;;
<a name="l1189"><span class="linenum">1189</span></a>              <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>[] = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_all_hosts_id')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/mnet_all_hosts_id.html">mnet_all_hosts_id</a>;
<a name="l1190"><span class="linenum">1190</span></a>          }
<a name="l1191"><span class="linenum">1191</span></a>  
<a name="l1192"><span class="linenum">1192</span></a>          if (!<a class="var it899" onMouseOver="hilite(899)" onMouseOut="lolite()" onClick="logVariable('hosts')" href="../../_variables/hosts.html">$hosts</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>)) {
<a name="l1193"><span class="linenum">1193</span></a>              return array();
<a name="l1194"><span class="linenum">1194</span></a>          }
<a name="l1195"><span class="linenum">1195</span></a>  
<a name="l1196"><span class="linenum">1196</span></a>          <a class="var it21723" onMouseOver="hilite(21723)" onMouseOut="lolite()" onClick="logVariable('idps')" href="../../_variables/idps.html">$idps</a> = array();
<a name="l1197"><span class="linenum">1197</span></a>          foreach (<a class="var it899" onMouseOver="hilite(899)" onMouseOut="lolite()" onClick="logVariable('hosts')" href="../../_variables/hosts.html">$hosts</a> as <a class="var it213" onMouseOver="hilite(213)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../_variables/host.html">$host</a>) {
<a name="l1198"><span class="linenum">1198</span></a>              <a class="var it21723" onMouseOver="hilite(21723)" onMouseOut="lolite()" onClick="logVariable('idps')" href="../../_variables/idps.html">$idps</a>[] = array(
<a name="l1199"><span class="linenum">1199</span></a>                  'url'  =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>(<a class="var it213" onMouseOver="hilite(213)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../_variables/host.html">$host</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it43652" onMouseOver="hilite(43652)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a> . <a class="var it213" onMouseOver="hilite(213)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../_variables/host.html">$host</a>-&gt;<a onClick="logVariable('sso_jump_url')" class="var it43652" onMouseOver="hilite(43652)" onMouseOut="lolite()" href="../../_variables/sso_jump_url.html">sso_jump_url</a>, array('hostwwwroot' =&gt; <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>, 'wantsurl' =&gt; <a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('wantsurl')" href="../../_variables/wantsurl.html">$wantsurl</a>, 'remoteurl' =&gt; 1)),
<a name="l1200"><span class="linenum">1200</span></a>                  'icon' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('pix_icon')" href="../../_classes/pix_icon.html" onMouseOver="classPopup(event,'pix_icon')">pix_icon</a>('i/' . <a class="var it213" onMouseOver="hilite(213)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../_variables/host.html">$host</a>-&gt;<a onClick="logVariable('application')" class="var it43652" onMouseOver="hilite(43652)" onMouseOut="lolite()" href="../../_variables/application.html">application</a> . '_host', <a class="var it213" onMouseOver="hilite(213)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../_variables/host.html">$host</a>-&gt;<a onClick="logVariable('name')" class="var it43652" onMouseOver="hilite(43652)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>),
<a name="l1201"><span class="linenum">1201</span></a>                  'name' =&gt; <a class="var it213" onMouseOver="hilite(213)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../_variables/host.html">$host</a>-&gt;<a onClick="logVariable('name')" class="var it43652" onMouseOver="hilite(43652)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>,
<a name="l1202"><span class="linenum">1202</span></a>              );
<a name="l1203"><span class="linenum">1203</span></a>          }
<a name="l1204"><span class="linenum">1204</span></a>          return <a class="var it21723" onMouseOver="hilite(21723)" onMouseOut="lolite()" onClick="logVariable('idps')" href="../../_variables/idps.html">$idps</a>;
<a name="l1205"><span class="linenum">1205</span></a>      }
<a name="l1206"><span class="linenum">1206</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'has_capability': ['has_capability', 'Wrapper round the has_capability funciton that automatically passes in the quiz context. ', [['mod/quiz','attemptlib.php',299],['mod/quiz','attemptlib.php',922],['lib','accesslib.php',344]], 2064],
'delete_records_select': ['delete_records_select', '', [['lib/dml','pdo_moodle_database.php',208],['lib/dml','oci_native_moodle_database.php',1495],['lib/dml','pgsql_native_moodle_database.php',1162],['lib/dml','mssql_native_moodle_database.php',1146],['lib/dml','mysqli_native_moodle_database.php',1477],['lib/dml','sqlsrv_native_moodle_database.php',1220],['lib/dml/tests','dml_test.php',5553]], 163],
'keepalive_server': ['keepalive_server', 'Receives an array of usernames from a remote machine and prods their sessions to keep them alive ', [['auth/mnet','auth.php',790]], 0],
'start_jump_session': ['start_jump_session', 'Starts an RPC jump session and returns the jump redirect URL. ', [['auth/mnet','auth.php',142]], 2],
'user_update_user': ['user_update_user', 'Update a user with a user object (will compare against the ID) ', [['user','lib.php',121]], 31],
'process_new_icon': ['process_new_icon', 'Stores optimised icon images in icon file area. ', [['lib','gdlib.php',90]], 6],
'get_records': ['get_records', 'Load a list of records. ', [['competency/classes','persistent.php',709],['mod/glossary/classes','entry_query_builder.php',295],['lib/dml','moodle_database.php',1285],['lib','coursecatlib.php',651],['question','category_class.php',63]], 965],
'instance': ['instance', 'Returns an instance of the cache_factor method. ', [['cache','disabledlib.php',171],['cache','disabledlib.php',296],['lib/classes','useragent.php',101],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',80],['lib/htmlpurifier/HTMLPurifier','URISchemeRegistry.php',9],['search/classes','manager.php',109],['cache','locallib.php',52],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',53],['lib/classes','plugin_manager.php',103],['lib/htmlpurifier','HTMLPurifier.php',251],['course/format','lib.php',156],['lib/classes/update','checker.php',62],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',31],['admin/tool/installaddon/classes','installer.php',40],['lib','modinfolib.php',373],['cache/classes','helper.php',76],['lib/tests','string_manager_standard_test.php',124],['lib/portfolio','exporter.php',251],['lib/classes/update','validator.php',88],['search/classes','document_factory.php',49],['lib','accesslib.php',6235],['lib','accesslib.php',6487],['lib','accesslib.php',6665],['lib','accesslib.php',6919],['lib','accesslib.php',7180],['lib','accesslib.php',7392],['backup/cc/cc_lib','cc_utils.php',387],['backup/cc/cc_lib','cc_utils.php',443],['lib','filterlib.php',80],['search/tests/fixtures','testable_core_search.php',43],['lib/tests/fixtures','testable_update_checker.php',45],['backup/cc','validator.php',35],['cache/classes','config.php',87],['cache/classes','factory.php',114],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',29]], 4647],
'kill_parent': ['kill_parent', 'The SP uses this function to kill the session on the parent IdP ', [['auth/mnet','auth.php',876]], 1],
'send': ['send', 'Send the request to the server - decode and return the response ', [['mnet/xmlrpc','client.php',128],['auth/cas/CAS/CAS/ProxiedService/Http','Abstract.php',126],['lib/horde/framework/Horde/Mail/Transport','Smtphorde.php',116],['auth/cas/CAS/CAS/Request','RequestInterface.php',136],['lib/horde/framework/Horde/Mail/Transport','Mock.php',91],['auth/cas/CAS/CAS/Request','MultiRequestInterface.php',75],['lib/horde/framework/Horde/Mail/Transport','Smtpmx.php',179],['lib/horde/framework/Horde/Mime','Part.php',1679],['auth/cas/CAS/CAS/Request','AbstractRequest.php',223],['lib/htmlpurifier/HTMLPurifier','ErrorCollector.php',65],['backup/util/xml/output','file_xml_output.class.php',66],['lib/jabber/XMPP','BOSH.php',150],['lib/horde/framework/Horde/Mail/Transport','Null.php',54],['lib','excellib.class.php',132],['lib/horde/framework/Horde/Mail/Transport','Smtp.php',158],['auth/cas/CAS/CAS/ProxiedService','Http.php',62],['lib/google/src/Google/Service','Gmail.php',816],['lib/google/src/Google/Service','Gmail.php',1145],['lib','odslib.class.php',84],['auth/cas/CAS/CAS/Request','CurlMultiRequest.php',99],['lib/horde/framework/Horde/Mime','Mail.php',372],['mod/lti/classes/local/ltiservice','response.php',205],['lib/horde/framework/Horde/Mail/Transport','Mail.php',60],['lib/phpmailer','class.phpmailer.php',1168],['backup/util/xml/output','memory_xml_output.class.php',59],['lib/jabber/XMPP','XMLStream.php',677],['lib/pear/Auth','RADIUS.php',380],['lib/horde/framework/Horde/Mail/Transport','Sendmail.php',89]], 193],
'update_mnet_session': ['update_mnet_session', 'creates (or updates) the mnet session once {@see confirm_mnet_session} and {@see complete_user_login} have both been called ', [['auth/mnet','auth.php',438]], 1],
'loginpage_idp_list': ['loginpage_idp_list', 'Returns a list of potential IdPs that this authentication plugin supports. This is used to provide links on the login page. ', [['auth/mnet','auth.php',1158],['lib','authlib.php',575]], 1],
'kill_user_sessions': ['kill_user_sessions', 'Terminate all sessions of given user unconditionally. ', [['lib/classes/session','manager.php',633]], 13],
'get_mnet_remote_client': ['get_mnet_remote_client', 'during xmlrpc server code execution, any code wishing to access information about the remote peer must use this to get it. ', [['lib','moodlelib.php',9463]], 19],
'debugging': ['debugging', 'Standard Debugging Function ', [['lib','weblib.php',3012]], 1007],
'fetch_theme_info': ['fetch_theme_info', 'Returns the theme information and logo url as strings. ', [['auth/mnet','auth.php',1063]], 0],
'prevent_local_passwords': ['prevent_local_passwords', '', [['auth/radius','auth.php',148],['auth/nntp','auth.php',86],['auth/email','auth.php',170],['auth/mnet','auth.php',585],['auth/imap','auth.php',107],['auth/shibboleth','auth.php',167],['auth/pam','auth.php',98],['auth/manual','auth.php',109],['auth/none','auth.php',86],['auth/ldap','auth.php',1583],['lib','authlib.php',224],['auth/fc','auth.php',167],['auth/pop3','auth.php',103],['auth/nologin','auth.php',67],['auth/cas','auth.php',59],['auth/db','auth.php',673]], 2],
'add_param': ['add_param', 'Add a parameter to the array of parameters. ', [['mnet/xmlrpc','client.php',79]], 24],
'auth_plugin_mnet': ['auth_plugin_mnet', 'Old syntax of class constructor. Deprecated in PHP7. ', [['auth/mnet','auth.php',44]], 1],
'get_content': ['get_content', '', [['blocks/blog_menu','block_blog_menu.php',52],['blocks/course_overview','block_course_overview.php',45],['blocks/completionstatus','block_completionstatus.php',44],['blocks/globalsearch','block_globalsearch.php',45],['blocks/calendar_upcoming','block_calendar_upcoming.php',33],['blocks/private_files','block_private_files.php',43],['blocks/admin_bookmarks','block_admin_bookmarks.php',69],['blocks/myprofile','block_myprofile.php',47],['blocks/mentees','block_mentees.php',43],['blocks/html','block_html.php',47],['blocks/section_links','block_section_links.php',53],['lib/filebrowser','virtual_root_file.php',106],['blocks/lp','block_lp.php',54],['blocks/site_main_menu','block_site_main_menu.php',34],['blocks/social_activities','block_social_activities.php',34],['blocks/tag_flickr','block_tag_flickr.php',46],['blocks/mnet_hosts','block_mnet_hosts.php',42],['blocks/quiz_results','block_quiz_results.php',52],['lib','modinfolib.php',1235],['blocks/settings','block_settings.php',103],['blocks/activity_modules','block_activity_modules.php',33],['lib','navigationlib.php',568],['lib/simplepie/library/SimplePie','Item.php',372],['lib/filestorage','stored_file.php',451],['blocks/glossary_random','block_glossary_random.php',223],['blocks/news_items','block_news_items.php',37],['blocks/blog_tags','block_blog_tags.php',62],['blocks/feedback','block_feedback.php',39],['blocks','moodleblock.class.php',143],['blocks/search_forums','block_search_forums.php',30],['blocks/navigation','block_navigation.php',118],['blocks/comments','block_comments.php',48],['blocks/badges','block_badges.php',69],['blocks/blog_recent','block_blog_recent.php',46],['blocks/selfcompletion','block_selfcompletion.php',45],['blocks/community','block_community.php',50],['blocks/recent_activity','block_recent_activity.php',50],['blocks/tag_youtube','block_tag_youtube.php',63],['blocks/course_summary','block_course_summary.php',48],['blocks/tags','block_tags.php',52],['blocks/participants','block_participants.php',30],['blocks/online_users','block_online_users.php',41],['mod/workshop','locallib.php',4032],['blocks/login','block_login.php',34],['blocks/activity_results','block_activity_results.php',138],['blocks/calendar_month','block_calendar_month.php',33],['blocks/course_list','block_course_list.php',37],['blocks/messages','block_messages.php',30],['blocks/rss_client','block_rss_client.php',80]], 71],
'get_record': ['get_record', 'Load a single record. ', [['competency/classes','persistent.php',738],['lib/dml','moodle_database.php',1462]], 3224],
'kill_children': ['kill_children', 'The IdP uses this function to kill child sessions on other hosts ', [['auth/mnet','auth.php',923]], 1],
'get_timemodified': ['get_timemodified', 'Returns time modified unix timestamp if known ', [['lib/filebrowser','file_info.php',295],['lib/filebrowser','virtual_root_file.php',272],['lib/filebrowser','file_info_stored.php',258],['lib/filestorage','stored_file.php',756]], 63],
'user_not_fully_set_up': ['user_not_fully_set_up', 'Determines if a user has completed setting up their account. ', [['lib','moodlelib.php',3135]], 8],
'is_internal': ['is_internal', 'Returns true if this authentication plugin is \'internal\'. ', [['auth/radius','auth.php',152],['auth/nntp','auth.php',90],['auth/email','auth.php',174],['auth/mnet','auth.php',589],['auth/imap','auth.php',111],['auth/webservice','auth.php',100],['auth/shibboleth','auth.php',171],['auth/pam','auth.php',102],['auth/manual','auth.php',113],['auth/none','auth.php',90],['auth/ldap','auth.php',1592],['lib','authlib.php',203],['auth/fc','auth.php',171],['auth/pop3','auth.php',107],['auth/nologin','auth.php',72],['auth/cas','auth.php',77],['auth/db','auth.php',677]], 19],
'config_form': ['config_form', 'Prints a form for configuring this authentication plugin. ', [['auth/radius','auth.php',171],['auth/nntp','auth.php',109],['auth/email','auth.php',221],['message/output/jabber','message_output_jabber.php',98],['auth/mnet','auth.php',619],['auth/imap','auth.php',144],['auth/webservice','auth.php',140],['auth/shibboleth','auth.php',230],['auth/pam','auth.php',121],['auth/manual','auth.php',160],['auth/none','auth.php',137],['auth/ldap','auth.php',1818],['lib','authlib.php',399],['auth/fc','auth.php',214],['auth/pop3','auth.php',140],['auth/cas','auth.php',233],['auth/db','auth.php',749],['message/output/popup','message_output_popup.php',68],['message/output/email','message_output_email.php',104],['message/output/airnotifier','message_output_airnotifier.php',135]], 3],
'strlen': ['strlen', 'Counts the number of characters. Unit-tested by Kasper (single byte charsets only) ', [['lib/typo3','class.t3lib_cs.php',1520],['lib/classes','text.php',305]], 1649],
'__construct': ['__construct', '', [['lib/adodb/drivers','adodb-odbc_mssql.inc.php',50],['lib/adodb/drivers','adodb-odbc_mssql.inc.php',359],['question/classes/statistics/responses','analyser.php',69],['auth/radius','auth.php',38],['lib/xmldb','xmldb_file.php',43],['lib/lessphp/Tree/Mixin','Definition.php',18],['cache/stores/static','lib.php',127],['lib/classes/session','file.php',40],['lib/htmlpurifier/HTMLPurifier/Lexer','DOMLex.php',35],['backup/util/ui','base_moodleform.class.php',68],['lib/simplepie/library/SimplePie','Author.php',81],['lib/filestorage','zip_archive.php',66],['backup/util/structure','restore_path_element.class.php',47],['backup/util/structure','restore_path_element.class.php',128],['lib/htmlpurifier/HTMLPurifier/ChildDef','Chameleon.php',36],['lib/phpexcel/PHPExcel','HashTable.php',44],['mod/quiz/tests','repaginate_test.php',39],['lib/form','modvisible.php',43],['lib/phpexcel/PHPExcel/Worksheet','Row.php',44],['cache','disabledlib.php',44],['lib/phpexcel/PHPExcel/Worksheet','Dimension.php',58],['lib/mustache/src/Mustache/Cache','FilesystemCache.php',27],['question/type/ddwtos','question.php',61],['mnet/xmlrpc','client.php',25],['lib/horde/framework/Horde/Imap/Client','Url.php',112],['lib/classes','useragent.php',115],['lib/pear/HTML/QuickForm','advcheckbox.php',66],['lib/classes/update','checker_exception.php',37],['lib/phpexcel/PHPExcel/Reader','Excel2007.php',53],['lib/jabber/XMPP','XMPP.php',101],['lib/form','radio.php',44],['lib/spout/src/Spout/Reader/XLSX/Helper','StyleHelper.php',45],['auth/cas/CAS/CAS/ProxiedService/Http','Abstract.php',58],['lib/phpexcel/PHPExcel/Style','Border.php',67],['lib/htmlpurifier/HTMLPurifier','HTMLDefinition.php',182],['lib/adodb/drivers','adodb-oci8quercus.inc.php',31],['lib/adodb/drivers','adodb-oci8quercus.inc.php',45],['lib/spout/src/Spout/Reader/XLSX','SheetIterator.php',29],['lib/horde/framework/Horde/Imap/Client/Interaction','Server.php',91],['lib/phpexcel/PHPExcel','DocumentProperties.php',123],['lib/typo3','class.t3lib_cs.php',509],['mod/workshop/allocation/scheduled','lib.php',48],['lib/adodb/drivers','adodb-netezza.inc.php',53],['lib/adodb/drivers','adodb-netezza.inc.php',144],['mod/feedback/classes','complete_form.php',58],['search/classes','document.php',188],['webservice/rest','locallib.php',40],['lib/dml','mssql_native_moodle_recordset.php',34],['mod/assign/feedback/editpdf/fpdi','fpdi_pdf_parser.php',57],['lib/htmlpurifier/HTMLPurifier','TokenFactory.php',43],['backup/moodle2','backup_block_task.class.php',43],['lib/lessphp/Tree','Negative.php',14],['lib/minify/lib/Minify/Cache','APC.php',19],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',54],['lib/pear/HTML/QuickForm','header.php',33],['lib/spout/src/Spout/Reader/XLSX/Helper/SharedStringsCaching','InMemoryStrategy.php',26],['lib/phpexcel/PHPExcel/Worksheet','RowCellIterator.php',51],['lib/simplepie/library/SimplePie/XML/Declaration','Parser.php',110],['lib/phpexcel/PHPExcel/Worksheet','ColumnIterator.php',60],['lib/spout/src/Spout/Reader/ODS','Sheet.php',33],['question/type/calculated/tests','helper.php',205],['lib/adodb/drivers','adodb-odbtp.inc.php',38],['lib/adodb/drivers','adodb-odbtp.inc.php',673],['lib/adodb/drivers','adodb-odbtp.inc.php',796],['lib/adodb/drivers','adodb-odbtp.inc.php',806],['lib/adodb/drivers','adodb-odbtp.inc.php',816],['lib/adodb/drivers','adodb-odbtp.inc.php',826],['lib/adodb/drivers','adodb-odbtp.inc.php',836],['enrol/lti/ims-blti','blti.php',28],['backup/cc','cc2moodle.php',105],['mod/chat','locallib.php',181],['mod/chat','locallib.php',229],['user/filters','simpleselect.php',45],['lib/phpexcel/PHPExcel/CachedObjectStorage','Memcache.php',244],['lib/dml','pdo_moodle_database.php',42],['lib/adodb/drivers','adodb-sqlite3.inc.php',36],['lib/adodb/drivers','adodb-sqlite3.inc.php',350],['lib/pear/HTML/QuickForm','static.php',44],['competency/classes/external','comment_area_exporter.php',48],['lib/lessphp/Tree','Selector.php',31],['auth/cas/CAS/CAS','TypeMismatchException.php',43],['auth/fc','fcFPP.php',33],['lib/xmldb','xmldb_key.php',43],['grade/grading/form/rubric','rubriceditor.php',56],['lib/google/src/Google/Service','Cloudlatencytest.php',40],['course','moodleform_mod.php',69],['auth/nntp','auth.php',35],['grade/report/grader','lib.php',111],['admin/tool/generator/classes','course_backend.php',116],['lib/minify/lib','FirePHP.php',189],['lib/adodb/drivers','adodb-sqlitepo.inc.php',38],['lib/horde/framework/Horde/Imap/Client','Tokenize.php',67],['lib/phpexcel/PHPExcel/CachedObjectStorage','CacheBase.php',66],['lib/lessphp/Tree','Rule.php',24],['lib/behat/features/bootstrap','behat_init_context.php',45],['lib','dmllib.php',69],['lib','dmllib.php',84],['lib','dmllib.php',104],['lib','dmllib.php',129],['lib','dmllib.php',159],['lib','dmllib.php',187],['lib','dmllib.php',240],['lib','dmllib.php',270],['lib/google/src/Google/Service','DataTransfer.php',44],['lib/google/src/Google/Http','Batch.php',42],['backup/util/structure','base_processor.class.php',49],['admin/tool/lpmigrate/classes','framework_mapper.php',50],['lib/phpexcel/PHPExcel/Reader','OOCalc.php',46],['lib/lessphp/Tree','NameValue.php',22],['mod/quiz/classes','admin_review_setting.php',82],['lib/htmlpurifier/HTMLPurifier','Generator.php',67],['mod/quiz/report','attemptsreport_table.php',76],['blocks/lp/classes/output','summary.php',59],['lib/google/src/Google/IO','Stream.php',45],['lib/google/src/Google/Service','Freebase.php',38],['grade/tests','reportlib_test.php',36],['search/classes','manager.php',100],['question/behaviour/adaptive','behaviour.php',310],['admin/tool/lp/classes/form','framework_autocomplete.php',48],['lib/minify/lib','JSMinPlus.php',193],['lib/minify/lib','JSMinPlus.php',726],['lib/minify/lib','JSMinPlus.php',1638],['lib/minify/lib','JSMinPlus.php',1656],['lib/minify/lib','JSMinPlus.php',1748],['lib/simplepie/library/SimplePie','Copyright.php',73],['lib/phpexcel/PHPExcel/Style','Conditional.php',93],['lib/google/src/Google/Task','Runner.php',76],['backup/util/settings/root','root_backup_setting.class.php',34],['lib','componentlib.class.php',179],['lib','componentlib.class.php',610],['lib','componentlib.class.php',834],['lib/google/src/Google/Service','AdSense.php',68],['lib/htmlpurifier/HTMLPurifier/AttrDef','Clone.php',18],['lib/spout/src/Spout/Reader/CSV','Sheet.php',24],['lib/filebrowser','file_info_context_system.php',37],['lib/grade','grade_item.php',260],['lib/horde/framework/Horde/Imap/Client/Data/Format','Nstring.php',27],['repository/boxnet','lib.php',56],['auth/email','auth.php',34],['mod/wiki/editors','wikifiletable.php',40],['lib/google/src/Google/Service','Replicapool.php',51],['lib/dtl','database_exporter.php',55],['lib/horde/framework/Horde/Imap/Client/Namespace','List.php',34],['lib/phpexcel/PHPExcel/Writer','CSV.php',79],['lib/google/src/Google/Service','Tasks.php',44],['lib/dml','mysqli_native_moodle_recordset.php',42],['lib/google/src/Google/Service','GamesManagement.php',50],['lib/minify/lib/Minify','Source.php',43],['lib/jabber/XMPP','Roster.php',48],['lib/lessphp/Tree','Element.php',19],['lib/classes','string_manager_install.php',43],['question/type','questiontypebase.php',55],['question/type','questiontypebase.php',1442],['lib/form','filemanager.php',54],['lib/form','filemanager.php',316],['lib/htmlpurifier/HTMLPurifier/ChildDef','Custom.php',36],['backup/util/ui','renderer.php',813],['lib/simplepie/library/SimplePie','Rating.php',73],['lib/phpexcel/PHPExcel/Cell','Hyperlink.php',44],['question/classes/statistics/questions','calculator.php',66],['backup/moodle2','backup_xml_transformer.class.php',50],['lib/google/src/Google/Service','Resource.php',62],['lib/form','autocomplete.php',56],['lib/phpexcel/PHPExcel/Worksheet','RowIterator.php',60],['mod/lesson/classes','file_info.php',45],['question/type/tests','question_first_matching_answer_grading_strategy_test.php',40],['lib/google/src/Google/Service','Partners.php',43],['cache','lib.php',66],['cache','lib.php',109],['cache','lib.php',138],['cache','lib.php',183],['grade/edit/tree','lib.php',57],['grade/edit/tree','lib.php',635],['grade/edit/tree','lib.php',668],['grade/edit/tree','lib.php',834],['lib/simplepie/library/SimplePie','Cache.php',69],['mod/wiki/diff','difflib.php',277],['mod/wiki/diff','difflib.php',381],['mod/wiki/diff','difflib.php',478],['lib/pear/HTML/QuickForm','select.php',58],['lib/classes/output','mustache_javascript_helper.php',40],['lib/phpexcel/PHPExcel/Reader/Excel2007','Theme.php',68],['mod/data','export_form.php',16],['lib/pear/HTML/QuickForm','autocomplete.php',67],['question/type/shortanswer','question.php',44],['lib/google/src/Google/Service','AndroidPublisher.php',52],['lib/google/src/Google/Verifier','Pem.php',31],['lib/classes/antivirus','scanner.php',41],['lib/phpexcel/PHPExcel/Reader','Excel5.php',414],['lib/horde/framework/Horde/Imap/Client/Auth','DigestMD5.php',69],['lib/classes/output','mustache_filesystem_loader.php',39],['lib/classes/output','inplace_editable.php',107],['lib/adodb/drivers','adodb-informix.inc.php',37],['competency/classes','competency_rule.php',45],['lib/phpexcel/PHPExcel','RichText.php',37],['lib/phpexcel/PHPExcel/Shared/JAMA','Matrix.php',59],['lib/pear/HTML/QuickForm','input.php',38],['repository/picasa','lib.php',41],['mod/feedback/classes','structure.php',48],['backup/util/plan','backup_structure_step.class.php',38],['question/classes/bank','random_question_loader.php',61],['mod/quiz/report/statistics/classes','calculated.php',43],['lib/horde/framework/Horde/Stream','String.php',27],['backup/util/helper','restore_decode_content.class.php',50],['backup/util/helper','restore_decode_content.class.php',125],['mod/workshop/backup/moodle1','lib.php',308],['lib/google/src/Google/Service','YouTubeReporting.php',47],['grade/export/txt','grade_export_txt.php',27],['lib/mustache/src/Mustache/Exception','SyntaxException.php',23],['lib/tcpdf','tcpdf_barcodes_2d.php',58],['mod/imscp','locallib.php',289],['lib/form','selectyesno.php',42],['lib/horde/framework/Horde/Mail/Transport','Smtphorde.php',62],['mod/lti/service/toolsettings/classes/local/service','toolsettings.php',41],['mod/lti/service/profile/classes/local/service','profile.php',41],['repository/flickr_public','lib.php',49],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','BackgroundPosition.php',57],['admin/tool/lp/classes/output','template_cohorts_table.php',53],['lib/simplepie/library','SimplePie.php',611],['lib/horde/framework/Horde/Imap/Client/Base','Debug.php',55],['lib/google/src/Google/Service','Reseller.php',44],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Border.php',18],['lib/testing/generator','component_generator_base.php',45],['lib/horde/framework/Horde/Translation/Handler','Gettext.php',34],['lib/phpexcel/PHPExcel/Worksheet','HeaderFooter.php',175],['lib/classes','plugin_manager.php',91],['lib/horde/framework/Horde/Imap/Client/Data/Format','List.php',28],['lib/horde/framework/Horde/Support','CombineStream.php',29],['lib/xmldb','xmldb_field.php',84],['lib/adodb/drivers','adodb-ibase.inc.php',59],['lib/adodb/drivers','adodb-ibase.inc.php',764],['lib/htmlpurifier/HTMLPurifier/AttrDef','URI.php',23],['admin/roles/classes','view_role_definition_table.php',28],['lib/google/src/Google/Cache','Memcache.php',44],['lib/pear/HTML/QuickForm','radio.php',48],['lib/filebrowser','file_info_context_coursecat.php',39],['lib/spout/src/Spout/Writer/ODS/Internal','Workbook.php',37],['mod/workshop/eval/best','lib.php',44],['lib/phpexcel/PHPExcel/Writer/PDF','DomPDF.php',38],['grade/report','lib.php',156],['lib','csslib.php',1501],['lib','csslib.php',1587],['lib','csslib.php',2068],['lib','csslib.php',2136],['lib','csslib.php',2242],['availability/classes','info_module.php',40],['mod/book','locallib.php',414],['question/engine','datalib.php',68],['question/engine','datalib.php',1331],['question/engine','datalib.php',1632],['question/engine','datalib.php',1740],['question/engine','datalib.php',1870],['question/engine','datalib.php',1941],['webservice','lib.php',745],['webservice','lib.php',841],['lib/adodb/drivers','adodb-informix72.inc.php',59],['lib/adodb/drivers','adodb-informix72.inc.php',399],['lib/adodb','adodb-pager.inc.php',60],['user/classes/output/myprofile','category.php',68],['lib/lessphp/Visitor','extendFinder.php',15],['backup/util/settings','base_setting.class.php',89],['backup/util/settings','base_setting.class.php',556],['lib','filelib.php',2720],['lib','filelib.php',3601],['lib/phpunit/classes','database_driver_testcase.php',55],['lib/phpexcel/PHPExcel/Shared/OLE/PPS','File.php',32],['report/competency/classes/output','report.php',56],['lib/google/src/Google/Service','Computeaccounts.php',49],['question/type','edit_question_form.php',96],['lib/filebrowser','file_info_context_user.php',39],['admin/tool/lp/classes/output','template_plans_page.php',37],['lib/phpexcel/PHPExcel','Style.php',93],['lib/minify/lib/Minify','HTML.php',49],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','ListStyle.php',20],['lib/form','password.php',44],['backup','backup.class.php',146],['mod/feedback/classes','course_select_form.php',39],['lib/google/src/Google/Auth','AppIdentity.php',39],['lib/adodb','adodb-active-record.inc.php',121],['lib/phpexcel/PHPExcel','Chart.php',169],['lib/horde/framework/Horde/Mail/Rfc822','List.php',61],['admin/roles/classes','allow_switch_page.php',33],['lib/grade','grade_object.php',80],['lib/google/src/Google/IO','Exception.php',29],['auth/lti','auth.php',38],['mod/quiz/report/statistics/classes','calculator.php',39],['lib/htmlpurifier','HTMLPurifier.php',104],['admin/tool/lp/classes/output','user_competency_summary_in_plan.php',47],['mod/assign/feedback/editpdf/classes','widget.php',53],['lib/evalmath','evalmath.class.php',120],['lib/form','url.php',46],['lib/dml','pdo_moodle_recordset.php',41],['lib/htmlpurifier/HTMLPurifier/TagTransform','Simple.php',19],['backup/cc/cc_lib','xmlbase.php',52],['badges/lib','bakerlib.php',52],['lib/google/src/Google/Signer','P12.php',35],['availability/classes','info_section.php',40],['lib/form','static.php',47],['backup/converter','convertlib.php',52],['backup/converter','convertlib.php',277],['lib/google/src/Google/Service','YouTubeAnalytics.php',56],['admin/roles/classes','check_capability_table.php',40],['lib/htmlpurifier/HTMLPurifier','AttrTypes.php',14],['lib/adodb/drivers','adodb-postgres64.inc.php',127],['lib/adodb/drivers','adodb-postgres64.inc.php',919],['backup/util/helper','restore_prechecks_helper.class.php',213],['user/profile','lib.php',59],['lib/google/src/Google/Service','Admin.php',40],['lib/spout/src/Spout/Reader/CSV','RowIterator.php',62],['lib/google/src/Google/Service','MapsEngine.php',66],['lib','listlib.php',82],['lib','listlib.php',485],['lib/phpexcel/PHPExcel/Writer','HTML.php',128],['backup/moodle2','restore_activity_task.class.php',48],['lib/htmlpurifier/HTMLPurifier','HTMLModuleManager.php',68],['lib/simplepie/library/SimplePie','Source.php',61],['completion','data_object.php',68],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','ID.php',28],['grade/report/singleview/classes/local/ui','dropdown_attribute.php',49],['lib/horde/framework/Horde/Support','Stack.php',18],['lib/google/src/Google/Cache','File.php',41],['lib/horde/framework/Horde/Mail/Transport','Mock.php',76],['backup/util/ui','backup_moodleform.class.php',41],['availability/condition/grouping/classes','condition.php',46],['lib/classes/session','memcache.php',50],['cache/classes','dummystore.php',62],['badges/classes','assertion.php',49],['lib/xhprof/xhprof_lib/utils','xhprof_runs.php',87],['availability/tests/fixtures','mock_condition.php',52],['lib/mustache/src/Mustache/Loader','FilesystemLoader.php',33],['mod/quiz/report','attemptsreport_options.php',95],['lib/phpexcel/PHPExcel/Writer/PDF','tcPDF.php',39],['lib/minify/lib/Minify/CSS','Compressor.php',51],['lib/google/src/Google/Service','Dns.php',53],['question/type/calculatedmulti','edit_calculatedmulti_form.php',47],['backup/moodle2','restore_block_task.class.php',45],['lib/phpexcel/PHPExcel/Worksheet','AutoFilter.php',54],['lib/form','recaptcha.php',48],['lib','csvlib.class.php',64],['lib','csvlib.class.php',398],['lib/simplepie/library/SimplePie/Cache','File.php',82],['lib/phpexcel/PHPExcel/Chart','Legend.php',75],['lib/phpexcel/PHPExcel','WorksheetIterator.php',44],['cache/classes','loaders.php',196],['cache/classes','loaders.php',1189],['cache/classes','loaders.php',1586],['lib/google/src/Google/Service','Appengine.php',44],['admin/tool/lp/classes/output','template_cohorts_page.php',37],['search/classes','engine.php',77],['backup/cc/cc_lib','cc_assesment_essay.php',25],['lib/classes/progress','display.php',48],['lib/lessphp/Tree','Call.php',19],['course/format','lib.php',78],['question/type/calculated','datasetdefinitions_form.php',53],['lib/google/src/Google/Service','Translate.php',40],['enrol/database','settingslib.php',34],['lib/lessphp/Tree/Mixin','Call.php',14],['admin/tool/log/store/standard/classes/log','store.php',37],['lib/google/src/Google/Service','Urlshortener.php',40],['lib/horde/framework/Horde/Imap/Client','Socket.php',168],['lib/tests','collator_test.php',310],['lib/google/src/Google/Auth','Simple.php',31],['backup/cc/cc_lib','cc_manifest.php',45],['lib/bennu','iCalendar_properties.php',28],['lib/bennu','iCalendar_properties.php',220],['lib/bennu','iCalendar_properties.php',238],['lib/bennu','iCalendar_properties.php',259],['lib/bennu','iCalendar_properties.php',275],['lib/bennu','iCalendar_properties.php',296],['lib/bennu','iCalendar_properties.php',343],['lib/bennu','iCalendar_properties.php',358],['lib/bennu','iCalendar_properties.php',376],['lib/bennu','iCalendar_properties.php',391],['lib/bennu','iCalendar_properties.php',406],['lib/bennu','iCalendar_properties.php',447],['lib/bennu','iCalendar_properties.php',462],['lib/bennu','iCalendar_properties.php',485],['lib/bennu','iCalendar_properties.php',509],['lib/bennu','iCalendar_properties.php',524],['lib/bennu','iCalendar_properties.php',555],['lib/bennu','iCalendar_properties.php',573],['lib/bennu','iCalendar_properties.php',594],['lib/bennu','iCalendar_properties.php',637],['lib/bennu','iCalendar_properties.php',680],['lib/bennu','iCalendar_properties.php',724],['lib/bennu','iCalendar_properties.php',747],['lib/bennu','iCalendar_properties.php',782],['lib/bennu','iCalendar_properties.php',808],['lib/bennu','iCalendar_properties.php',849],['lib/bennu','iCalendar_properties.php',864],['lib/bennu','iCalendar_properties.php',905],['lib/bennu','iCalendar_properties.php',938],['lib/bennu','iCalendar_properties.php',952],['lib/bennu','iCalendar_properties.php',965],['lib/bennu','iCalendar_properties.php',987],['lib/bennu','iCalendar_properties.php',1017],['lib/bennu','iCalendar_properties.php',1031],['lib/bennu','iCalendar_properties.php',1061],['lib/bennu','iCalendar_properties.php',1075],['lib/bennu','iCalendar_properties.php',1098],['lib/bennu','iCalendar_properties.php',1110],['lib/bennu','iCalendar_properties.php',1139],['lib/bennu','iCalendar_properties.php',1160],['lib/bennu','iCalendar_properties.php',1181],['lib/bennu','iCalendar_properties.php',1203],['lib/bennu','iCalendar_properties.php',1227],['lib/bennu','iCalendar_properties.php',1260],['lib/bennu','iCalendar_properties.php',1386],['lib/bennu','iCalendar_properties.php',1407],['lib/bennu','iCalendar_properties.php',1429],['lib/bennu','iCalendar_properties.php',1450],['lib/mustache/src/Mustache/Exception','UnknownTemplateException.php',22],['lib/phpmailer','moodle_phpmailer.php',47],['availability/tests/fixtures','mock_info.php',40],['lib/horde/framework/Horde/Mail/Transport','Smtpmx.php',138],['admin/tool/lp/classes/form','persistent.php',68],['lib/adodb/drivers','adodb-mysqlt.inc.php',32],['lib/adodb/drivers','adodb-mysqlt.inc.php',96],['webservice/tests','lib_test.php',213],['lib/horde/framework/Horde/Imap/Client/Data/Format','Mailbox.php',35],['filter','local_settings_form.php',33],['mod/quiz/accessrule','accessrulebase.php',52],['lib/horde/framework/Horde/Exception','Wrapped.php',16],['mod/assign/feedback/editpdf/fpdi','pdf_parser.php',170],['lib/lessphp/Tree','Dimension.php',15],['lib/minify/lib/HTTP','ConditionalGet.php',109],['lib/adodb/perf','perf-oci8.inc.php',203],['lib/phpexcel','PHPExcel.php',361],['backup/util/helper','restore_questions_parser_processor.class.php',42],['backup/moodle2','backup_plugin.class.php',44],['lib/classes/antivirus','scanner_exception.php',38],['webservice/xmlrpc','lib.php',43],['report/loglive/classes','renderable.php',73],['course','dnduploadlib.php',109],['course','dnduploadlib.php',407],['lib/filebrowser','file_info.php',43],['lib/adodb/drivers','adodb-access.inc.php',34],['lib/adodb/drivers','adodb-access.inc.php',83],['mod/feedback/classes','responses_table.php',54],['lib/editor/tinymce','adminlib.php',36],['admin/tool/monitor/classes','rule.php',44],['lib/google/src/Google/Service','AdExchangeBuyer.php',55],['lib/filebrowser','virtual_root_file.php',45],['lib/phpexcel/PHPExcel/RichText','Run.php',35],['admin/tool/monitor/classes/output/managesubs','subs.php',51],['auth/cas/CAS/CAS','ProxyChain.php',48],['lib/htmlpurifier/HTMLPurifier','DefinitionCache.php',22],['lib/google/src/Google/Service','CivicInfo.php',40],['mod/feedback/classes/output','summary.php',52],['lib/minify/lib/Minify','Build.php',77],['lib/adodb/drivers','adodb-ado_mssql.inc.php',146],['lib/adodb/drivers','adodb-odbc.inc.php',44],['lib/adodb/drivers','adodb-odbc.inc.php',611],['lib','moodlelib.php',9421],['lib','moodlelib.php',9632],['user/selector','lib.php',85],['user/selector','lib.php',674],['admin/tool/lp/classes/output','plan_page.php',49],['repository/dropbox','lib.php',49],['lib/horde/framework/Horde/Mime','Part.php',261],['lib/spout/src/Spout/Reader/XLSX/Helper/SharedStringsCaching','CachingStrategyFactory.php',56],['lib/phpexcel/PHPExcel/Chart','Layout.php',143],['lib/mustache/src/Mustache/Loader','CascadingLoader.php',20],['lib/phpexcel/PHPExcel/Shared/JAMA','EigenvalueDecomposition.php',777],['lib/google/src/Google/Service','Books.php',60],['lib/google/src/Google/Service','Oauth2.php',50],['admin/tool/log/classes/log','store.php',30],['admin/tool/recyclebin/classes','category_bin.php',45],['lib/phpexcel/PHPExcel/Style','Color.php',64],['lib/phpexcel/PHPExcel/Worksheet','SheetView.php',69],['lib/htmlpurifier/HTMLPurifier/Token','Text.php',34],['lib/classes/update','checker.php',50],['lib/horde/framework/Horde/Socket','Client.php',52],['lib/phpexcel/PHPExcel/CachedObjectStorage','APC.php',243],['lib/horde/framework/Horde/Imap/Client/Cache','Backend.php',33],['lib/phpexcel/PHPExcel/Chart','Title.php',45],['lib/horde/framework/Horde/Imap/Client/Data','Format.php',32],['lib/adodb/drivers','adodb-text.inc.php',93],['lib/adodb/drivers','adodb-text.inc.php',379],['lib/phpexcel/PHPExcel','Calculation.php',2071],['lib/adodb/drivers','adodb-sqlite.inc.php',36],['lib/adodb/drivers','adodb-sqlite.inc.php',367],['lib/google/src/Google/Service','Analytics.php',77],['blocks/lp/classes/output','plans_to_review_page.php',48],['lib/google/src/Google/Service','Coordinate.php',48],['availability/condition/group/classes','condition.php',43],['lib/lessphp/Exception','Chunk.php',19],['lib/htmlpurifier/HTMLPurifier','PropertyListIterator.php',22],['backup/cc/cc_lib','cc_resources.php',102],['lib/horde/framework/Horde/Mail/Rfc822','Group.php',45],['backup/util/structure','base_optigroup.class.php',35],['backup/util/structure','base_optigroup.class.php',169],['question/classes/statistics/questions','calculated.php',181],['lib/horde/framework/Horde/Imap/Client/Interaction','Command.php',72],['lib/htmlpurifier/HTMLPurifier/Strategy','Core.php',8],['lib/htmlpurifier/HTMLPurifier/Filter','ExtractStyleBlocks.php',57],['backup/cc/cc_lib','cc_converter_url.php',29],['lib/xmldb','xmldb_structure.php',40],['lib/ddl','sqlite_sql_generator.php',73],['lib/pear/HTML/QuickForm','Renderer.php',31],['backup/util/helper','restore_moodlexml_parser_processor.class.php',38],['lib/pear/HTML/QuickForm','file.php',54],['lib/minify/lib/Minify/Cache','File.php',9],['lib/pear/HTML/QuickForm','xbutton.php',39],['lib/htmlpurifier','locallib.php',134],['admin/tool/recyclebin/classes','course_bin.php',45],['backup/util/plan','backup_task.class.php',32],['backup/util/plan','backup_task.class.php',56],['lib/phpexcel/PHPExcel/CachedObjectStorage','PHPTemp.php',174],['backup/util/helper','backup_helper.class.php',381],['lib/form','htmleditor.php',48],['lib','oauthlib.php',65],['lib','oauthlib.php',409],['auth/cas/CAS/CAS/PGTStorage','File.php',105],['auth/cas/CAS/CAS/ProxiedService','Imap.php',51],['repository/skydrive','lib.php',42],['lib/htmlpurifier/HTMLPurifier','ErrorCollector.php',57],['lib/classes/lock','postgres_lock_factory.php',81],['lib/phpexcel/PHPExcel/CachedObjectStorage','SQLite.php',260],['lib/horde/framework/Horde/Support','ConsistentHash.php',56],['lib/horde/framework/Horde/Exception','Pear.php',22],['lib/portfolio','exceptions.php',50],['backup/moodle2','restore_plugin.class.php',43],['lib/phpexcel/PHPExcel/CachedObjectStorage','DiscISAM.php',177],['lib/google/src/Google/Service','DoubleClickBidManager.php',40],['lib/minify/lib/Minify/JS','ClosureCompiler.php',101],['lib/horde/framework/Horde/Imap/Client/Data/Format','String.php',38],['lib/form','dateselector.php',70],['lib/spout/src/Spout/Common/Helper','EncodingHelper.php',38],['report/competency/classes/output','user_course_navigation.php',51],['lib/adodb/drivers','adodb-postgres7.inc.php',98],['lib/adodb/drivers','adodb-postgres7.inc.php',311],['lib/adodb/drivers','adodb-postgres7.inc.php',342],['lib/lessphp/Tree','Alpha.php',13],['mod/lti/service/memberships/classes/local/resource','linkmemberships.php',46],['lib/tcpdf','tcpdf.php',1822],['lib/adodb/drivers','adodb-sybase.inc.php',47],['lib/adodb/drivers','adodb-sybase.inc.php',313],['lib/adodb/drivers','adodb-sybase.inc.php',394],['lib/phpexcel/PHPExcel/Chart','PlotArea.php',44],['lib/phpexcel/PHPExcel/Chart','DataSeries.php',136],['mod/lesson','editpage_form.php',41],['question/classes/statistics/responses','analysis_for_question.php',58],['lib/horde/framework/Horde','Domhtml.php',53],['lib','formslib.php',142],['lib','formslib.php',1442],['lib','formslib.php',2653],['rating','lib.php',114],['rating','lib.php',1070],['lib/phpexcel/PHPExcel/Worksheet','Column.php',44],['lib/google/src/Google/Service','Script.php',67],['lib/adodb','adodb-xmlschema.inc.php',118],['lib/adodb','adodb-xmlschema.inc.php',245],['lib/adodb','adodb-xmlschema.inc.php',637],['lib/adodb','adodb-xmlschema.inc.php',781],['lib/adodb','adodb-xmlschema.inc.php',982],['lib/adodb','adodb-xmlschema.inc.php',1295],['lib/google/src/Google/Service','DeploymentManager.php',54],['mod/quiz','attemptlib.php',41],['mod/quiz','attemptlib.php',82],['mod/quiz','attemptlib.php',546],['mod/quiz','attemptlib.php',2337],['mod/quiz','attemptlib.php',2392],['backup/cc/cc_lib','cc_converter_forum.php',29],['lib','boxlib.php',264],['lib/simplepie/library/SimplePie','Restriction.php',81],['admin/roles/classes','allow_assign_page.php',31],['lib/adodb/drivers','adodb-pdo.inc.php',90],['lib/adodb/drivers','adodb-pdo.inc.php',553],['lib/adodb/drivers','adodb-pdo.inc.php',630],['tag/classes/output','tagareacollection.php',40],['admin/tool/lp/classes','template_statistics.php',62],['lib','weblib.php',313],['lib','weblib.php',3183],['lib','weblib.php',3483],['lib','weblib.php',3518],['lib','weblib.php',3593],['backup/cc/cc_lib','cc_converter_basiclti.php',29],['lib/html2text','Html2Text.php',232],['mod/assign/feedback/editpdf/classes','annotation.php',66],['lib/pear/HTML/QuickForm/Renderer','Array.php',143],['question/engine','lib.php',774],['question/engine','lib.php',1011],['question/engine','lib.php',1059],['lib/jabber/XMPP','XMLObj.php',76],['lib/horde/framework/Horde/Exception','PermissionDenied.php',15],['lib/editor/atto','adminlib.php',109],['lib/pear/HTML/QuickForm/Renderer','Tableless.php',116],['grade/report/history/classes/output','tablelog.php',72],['lib/google/src/Google/IO','Curl.php',38],['lib/editor/tinymce/plugins/spellchecker/classes/utils','Logger.php',31],['lib/pear/HTML/QuickForm','hiddenselect.php',41],['backup/util/ui','backup_ui_setting.class.php',70],['backup/util/ui','backup_ui_setting.class.php',200],['backup/util/ui','backup_ui_setting.class.php',398],['backup/util/ui','backup_ui_setting.class.php',504],['backup/util/ui','backup_ui_setting.class.php',583],['lib/adodb/drivers','adodb-mysqlpo.inc.php',35],['lib/adodb/drivers','adodb-mysqlpo.inc.php',82],['lib/adodb/drivers','adodb-mysqlpo.inc.php',119],['lib/google/src/Google/Service','Blogger.php',50],['backup/util/xml/output','file_xml_output.class.php',37],['lib/form','tags.php',75],['admin/tool/installaddon/classes','installer.php',219],['lib/htmlpurifier/HTMLPurifier/AttrDef','Enum.php',30],['lib/simplepie/library/SimplePie','IRI.php',252],['comment','locallib.php',39],['question/engine','states.php',61],['lib/spout/src/Spout/Reader/XLSX/Helper','CellValueFormatter.php',52],['lib/google/src/Google/Service','Dataflow.php',45],['mod/data','locallib.php',66],['mod/data','locallib.php',433],['lib/horde/framework/Horde','Variables.php',60],['backup/util/ui','base_ui.class.php',84],['lib/simplepie/library/SimplePie','Registry.php',99],['cache/locks/file','lib.php',66],['question/classes/statistics/responses','analysis_for_class.php',68],['lib/filebrowser','file_info_stored.php',51],['tag/classes/output','tagcollname.php',42],['competency/classes','persistent.php',54],['admin/tool/lp/classes/output','competency_plan_navigation.php',54],['lib/phpexcel/PHPExcel/Cell','DataValidation.php',146],['lib/pear/HTML/QuickForm','textarea.php',48],['lib/lessphp','Visitor.php',14],['lib/google/src/Google/Service','CloudUserAccounts.php',52],['question/classes/bank','column_base.php',44],['lib/minify/lib/MrClay','Cli.php',74],['lib','outputcomponents.php',80],['lib','outputcomponents.php',204],['lib','outputcomponents.php',469],['lib','outputcomponents.php',523],['lib','outputcomponents.php',589],['lib','outputcomponents.php',665],['lib','outputcomponents.php',783],['lib','outputcomponents.php',925],['lib','outputcomponents.php',1009],['lib','outputcomponents.php',2183],['lib','outputcomponents.php',2222],['lib','outputcomponents.php',2295],['lib','outputcomponents.php',2376],['lib','outputcomponents.php',2579],['lib','outputcomponents.php',2627],['lib','outputcomponents.php',2687],['lib','outputcomponents.php',2860],['lib','outputcomponents.php',3030],['lib','outputcomponents.php',3134],['lib','outputcomponents.php',3201],['lib','outputcomponents.php',3329],['lib','outputcomponents.php',3613],['lib','outputcomponents.php',3642],['lib','outputcomponents.php',3668],['lib','outputcomponents.php',3690],['lib','outputcomponents.php',3719],['lib','outputcomponents.php',3751],['lib/google/src/Google/Service','Pagespeedonline.php',39],['lib/phpexcel/PHPExcel','Cell.php',114],['lib/dml','sqlsrv_native_moodle_recordset.php',40],['repository/wikimedia','wikimedia.php',35],['lib/phpexcel/PHPExcel/Style','Fill.php',81],['lib/google/src/Google/Service','Cloudresourcemanager.php',42],['lib/editor/tinymce/classes','plugin.php',49],['mod/wiki/parser/markups','html.php',21],['lib/simplepie/library/SimplePie/Parse','Date.php',536],['lib/horde/framework/Horde/Support','Inflector.php',115],['question/type/gapselect','question.php',55],['lib/google/src/Google','Config.php',33],['badges/criteria','award_criteria_activity.php',45],['backup/util/xml/output','xml_output.class.php',52],['backup/util/xml/output','xml_output.class.php',158],['course/format/topics','renderer.php',38],['lib/adodb/drivers','adodb-oci8po.inc.php',33],['lib/adodb/drivers','adodb-oci8po.inc.php',99],['mod/workshop/allocation/random','lib.php',52],['mod/workshop/allocation/random','lib.php',727],['backup/util/structure','base_final_element.class.php',38],['backup/util/structure','base_final_element.class.php',239],['backup/util/structure','base_final_element.class.php',256],['lib/htmlpurifier/HTMLPurifier','Zipper.php',25],['lib/horde/framework/Horde/Imap/Client/Data','Thread.php',41],['lib/mustache/src/Mustache/Exception','UnknownHelperException.php',22],['backup/util/settings/activity','activity_backup_setting.class.php',25],['lib/filestorage','tgz_packer.php',749],['lib/filestorage','tgz_packer.php',831],['tag/classes','index_builder.php',96],['lib/pear/HTML/QuickForm','reset.php',37],['lib/classes/lock','lock.php',55],['admin/roles/classes','assign_user_selector_base.php',40],['backup/util/output','output_controller.class.php',44],['question/type/randomsamatch','question.php',114],['lib/google/src/Google/Service','Customsearch.php',38],['lib/lessphp/Tree','Extend.php',28],['lib/phpexcel/PHPExcel/Shared/PCLZip','pclzip.lib.php',215],['lib/google/src/Google/Service','TagManager.php',67],['question/type/gapselect/tests','edit_form_test.php',41],['mod/lesson','locallib.php',2004],['mod/lesson','locallib.php',2611],['backup/util/helper','restore_structure_parser_processor.class.php',41],['course','renderer.php',52],['backup/util/xml/parser/processors','selective_exact_parser_processor.class.php',35],['lib','modinfolib.php',429],['lib','modinfolib.php',1665],['lib','modinfolib.php',2492],['lib','tablelib.php',128],['lib','tablelib.php',1468],['lib','tablelib.php',1633],['lib','tablelib.php',1698],['user/filters','cohort.php',36],['user/filters','text.php',37],['lib','outputrenderers.php',120],['lib','outputrenderers.php',285],['lib','outputrenderers.php',408],['lib','outputrenderers.php',4578],['lib','outputrenderers.php',4831],['repository','lib.php',116],['repository','lib.php',533],['lib','adminlib.php',791],['lib','adminlib.php',1138],['lib','adminlib.php',1212],['lib','adminlib.php',1355],['lib','adminlib.php',1556],['lib','adminlib.php',1928],['lib','adminlib.php',2040],['lib','adminlib.php',2106],['lib','adminlib.php',2199],['lib','adminlib.php',2260],['lib','adminlib.php',2302],['lib','adminlib.php',2341],['lib','adminlib.php',2429],['lib','adminlib.php',2463],['lib','adminlib.php',2621],['lib','adminlib.php',2706],['lib','adminlib.php',2935],['lib','adminlib.php',3091],['lib','adminlib.php',3233],['lib','adminlib.php',3324],['lib','adminlib.php',3488],['lib','adminlib.php',3571],['lib','adminlib.php',3682],['lib','adminlib.php',3833],['lib','adminlib.php',4067],['lib','adminlib.php',4134],['lib','adminlib.php',4352],['lib','adminlib.php',4381],['lib','adminlib.php',4410],['lib','adminlib.php',4434],['lib','adminlib.php',4464],['lib','adminlib.php',4500],['lib','adminlib.php',4535],['lib','adminlib.php',4567],['lib','adminlib.php',4657],['lib','adminlib.php',4690],['lib','adminlib.php',4748],['lib','adminlib.php',4790],['lib','adminlib.php',4814],['lib','adminlib.php',4840],['lib','adminlib.php',4863],['lib','adminlib.php',4880],['lib','adminlib.php',4925],['lib','adminlib.php',4943],['lib','adminlib.php',5002],['lib','adminlib.php',5045],['lib','adminlib.php',5080],['lib','adminlib.php',5123],['lib','adminlib.php',5206],['lib','adminlib.php',5336],['lib','adminlib.php',5378],['lib','adminlib.php',5423],['lib','adminlib.php',5480],['lib','adminlib.php',5496],['lib','adminlib.php',5552],['lib','adminlib.php',5777],['lib','adminlib.php',5831],['lib','adminlib.php',5885],['lib','adminlib.php',5902],['lib','adminlib.php',5950],['lib','adminlib.php',5992],['lib','adminlib.php',6043],['lib','adminlib.php',6099],['lib','adminlib.php',6328],['lib','adminlib.php',6508],['lib','adminlib.php',6688],['lib','adminlib.php',6782],['lib','adminlib.php',6931],['lib','adminlib.php',7088],['lib','adminlib.php',7712],['lib','adminlib.php',8147],['lib','adminlib.php',8330],['lib','adminlib.php',8617],['lib','adminlib.php',8764],['lib','adminlib.php',8924],['lib','adminlib.php',9071],['lib','adminlib.php',9235],['lib','adminlib.php',9428],['lib','adminlib.php',9482],['lib','adminlib.php',9544],['lib','adminlib.php',9589],['lib','adminlib.php',9626],['backup/cc/cc_lib','cc_organization.php',47],['backup/cc/cc_lib','cc_organization.php',145],['lib/phpexcel/PHPExcel/Chart','DataSeriesValues.php',81],['lib/horde/framework/Horde/Mail/Rfc822','Identification.php',34],['question/type/numerical','questiontype.php',507],['auth/mnet','auth.php',35],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Cache.php',68],['lib/htmlpurifier/HTMLPurifier','PropertyList.php',29],['auth/imap','auth.php',35],['tag/classes/output','taglist.php',54],['lib','pdflib.php',161],['lib/phpexcel/PHPExcel/RichText','TextElement.php',35],['lib/dml','database_column_info.php',112],['lib/horde/framework/Horde/Imap/Client/Exception','NoSupportExtension.php',33],['mod/wiki/editors','wikieditor.php',36],['lib/lessphp/SourceMap','Base64VLQ.php',67],['repository/s3','lib.php',44],['admin/tool/uploadcourse/classes','course.php',111],['lib/google/src/Google/Service','Replicapoolupdater.php',51],['lib/horde/framework/Horde/Imap/Client/Data/Format','Date.php',25],['lib/bennu','iCalendar_components.php',21],['lib/bennu','iCalendar_components.php',333],['lib/bennu','iCalendar_components.php',355],['lib/bennu','iCalendar_components.php',433],['lib/bennu','iCalendar_components.php',513],['lib/bennu','iCalendar_components.php',551],['lib/bennu','iCalendar_components.php',602],['lib/bennu','iCalendar_components.php',659],['lib/bennu','iCalendar_components.php',679],['lib/phpexcel/PHPExcel/Calculation','FormulaToken.php',102],['mod/feedback/item','feedback_item_class.php',28],['lib/adodb/drivers','adodb-mssql_n.inc.php',245],['lib','badgeslib.php',133],['lib/pear/HTML/QuickForm','text.php',38],['lib/simplepie/library/SimplePie','Enclosure.php',219],['calendar/classes','rrule_manager.php',182],['auth/webservice','auth.php',35],['lib','outputrequirementslib.php',171],['mod/lti/service/toolsettings/classes/local/resource','contextsettings.php',44],['lib','questionlib.php',1261],['lib','questionlib.php',1505],['lib','uploadlib.php',40],['lib/spout/src/Spout/Writer/Common/Helper','ZipHelper.php',28],['lib/google/src/Google/Service','Cloudsearch.php',40],['backup/util/structure','backup_nested_element.class.php',44],['lib/spout/src/Spout/Writer/Common','Sheet.php',39],['question/behaviour','behaviourbase.php',50],['blocks/rss_client/classes/output','footer.php',47],['lib/dtl','file_xml_database_importer.php',34],['admin/roles/classes','capability_table_with_risks.php',45],['lib/adodb/drivers','adodb-mssql.inc.php',110],['lib/adodb/drivers','adodb-mssql.inc.php',870],['lib/adodb/drivers','adodb-mssql.inc.php',1077],['lib/google/src/Google/Service','Bigquery.php',62],['lib/google/src/Google/Service','ShoppingContent.php',50],['mod/lti','OAuth.php',73],['mod/lti','OAuth.php',89],['mod/lti','OAuth.php',244],['mod/lti','OAuth.php',499],['repository/equella','lib.php',42],['lib/phpexcel/PHPExcel/Worksheet','PageMargins.php',80],['backup/cc/cc_lib','cc_converter_quiz.php',33],['lib/horde/framework/Horde/Imap/Client/Interaction','Pipeline.php',60],['lib/phpexcel/PHPExcel/Shared/trend','polynomialBestFitClass.php',199],['backup/util/helper','restore_decode_processor.class.php',47],['backup/util/helper','restore_decode_processor.class.php',182],['cache/classes','helper.php',90],['lib/simplepie/library/SimplePie','Credit.php',81],['lib/classes','chart_series.php',62],['lib/classes/dml','recordset_walk.php',64],['lib/google/src/Google/Service','Webmasters.php',47],['lib/tcpdf/include/barcodes','qrcode.php',631],['backup/moodle2','backup_settingslib.php',42],['backup/moodle2','backup_settingslib.php',138],['lib/spout/src/Spout/Writer/XLSX/Helper','SharedStringsHelper.php',40],['course/tests/fixtures','course_capability_assignment.php',60],['mod/forum/classes','subscriber_selector_base.php',53],['lib','blocklib.php',54],['lib','blocklib.php',152],['report/loglive/classes','table_log.php',50],['lib','navigationlib.php',147],['lib','navigationlib.php',1015],['lib','navigationlib.php',2825],['lib','navigationlib.php',3086],['lib','navigationlib.php',3412],['lib','navigationlib.php',3459],['lib','navigationlib.php',4888],['lib','navigationlib.php',5070],['lib/phpexcel/PHPExcel/Shared/JAMA','CholeskyDecomposition.php',41],['grade/report/history/classes/output','user_button.php',40],['user/filters','courserole.php',34],['lib/phpexcel/PHPExcel','IOFactory.php',69],['lib/lessphp/Tree','Color.php',15],['lib/phpexcel/PHPExcel/Worksheet','MemoryDrawing.php',70],['lib/adodb/drivers','adodb-vfp.inc.php',72],['lib/horde/framework/Horde/Support','Backtrace.php',20],['lib/google/src/Google/Service','Clouddebugger.php',50],['lib/horde/framework/Horde/Exception','NotFound.php',15],['admin/tool/lp/classes/output','user_competency_course_navigation.php',55],['lib/lessphp/Tree','UnicodeDescriptor.php',14],['lib/phpexcel/PHPExcel/Worksheet','PageSetup.php',277],['grade/report/singleview/classes/local/ui','bulk_insert.php',40],['lib','mathslib.php',45],['lib/filestorage','tgz_extractor.php',119],['lib/horde/framework/Horde/Imap/Client/Interaction/Command','Continuation.php',42],['lib/horde/framework/Horde/Imap/Client','Exception.php',247],['filter/emoticon/tests','filter_test.php',68],['mnet/xmlrpc','xmlparser.php',15],['lib/spout/src/Spout/Reader/XLSX','Sheet.php',31],['admin/roles/classes','capability_table_base.php',51],['lib/simplepie/library/SimplePie','Item.php',82],['lib/form','selectgroups.php',57],['auth/shibboleth','auth.php',38],['admin/tool/langimport/classes','controller.php',48],['lib/form','warning.php',49],['lib/filestorage','stored_file.php',63],['grade/grading/form/guide','guideeditor.php',49],['lib/pear/HTML/QuickForm','group.php',80],['backup/moodle2','restore_subplugin.class.php',45],['grade/export','lib.php',60],['grade/export','lib.php',625],['lib/phpexcel/PHPExcel/Style','NumberFormat.php',98],['backup/moodle2','backup_section_task.class.php',40],['lib/htmlpurifier/HTMLPurifier','Config.php',100],['lib','flickrlib.php',53],['mod/assign/classes/output','grading_app.php',59],['grade/report/singleview/classes/local/ui','grade_attribute_format.php',47],['user/profile/field/menu','field.class.php',39],['lib/spout/src/Spout/Writer/Common/Internal','AbstractWorkbook.php',30],['lib/portfolio','exporter.php',113],['lib','ddllib.php',80],['lib','ddllib.php',93],['lib','ddllib.php',107],['lib','ddllib.php',126],['lib','ddllib.php',140],['lib/horde/framework/Horde/Crypt','Blowfish.php',54],['lib/horde/framework/Horde','Secret.php',48],['lib/htmlpurifier/HTMLPurifier/AttrDef','Integer.php',36],['lib/classes/update','info.php',48],['lib/htmlpurifier/HTMLPurifier/ConfigSchema','ValidatorAtom.php',31],['lib/lessphp/Tree','Anonymous.php',21],['admin/tool/lp/classes','course_competencies_form_element.php',43],['lib/lessphp/Tree','Comment.php',17],['auth/cas/CAS/CAS','OutOfSequenceBeforeAuthenticationCallException.php',47],['question/type/calculatedsimple','edit_calculatedsimple_form.php',72],['lib/adodb/drivers','adodb-mysql.inc.php',54],['lib/adodb/drivers','adodb-mysql.inc.php',717],['lib/adodb/drivers','adodb-mysql.inc.php',880],['enrol/ldap','lib.php',43],['mod/quiz/report/statistics','statistics_table.php',45],['lib/form','listing.php',68],['lib/google/src/Google/Service','Container.php',43],['mod/quiz','accessmanager.php',45],['lib/classes/message/inbound','processing_failed_exception.php',36],['blocks/online_users/classes','fetcher.php',45],['lib/pear/HTML/QuickForm','checkbox.php',48],['auth/cas/CAS/CAS','OutOfSequenceBeforeProxyException.php',48],['mod/lti/service/toolproxy/classes/local/service','toolproxy.php',41],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','URI.php',15],['lib/classes','chart_axis.php',65],['mod/glossary/classes','entry_query_builder.php',83],['mod/feedback/item/label','lib.php',26],['lib/adodb/drivers','adodb-mssqlnative.inc.php',131],['lib/adodb/drivers','adodb-mssqlnative.inc.php',847],['lib/adodb/drivers','adodb-mssqlnative.inc.php',1099],['lib/horde/framework/Horde/Imap/Client','Ids.php',78],['lib/form','editor.php',62],['lib','environmentlib.php',1258],['mod/workshop','fileinfolib.php',43],['mod/workshop','fileinfolib.php',198],['mod/feedback/classes','templates_table.php',39],['tag/classes','manage_table.php',44],['lib/adodb/drivers','adodb-odbc_db2.inc.php',115],['lib/adodb/drivers','adodb-odbc_db2.inc.php',309],['backup/cc/cc_lib/gral_lib','cssparser.php',21],['lib/horde/framework/Horde/Support','Array.php',21],['lib/google/src/Google/Service','GroupsMigration.php',40],['admin/tool/lp/classes/output','user_evidence_list_page.php',61],['lib/google/src/Google/Service','Audit.php',39],['lib/simplepie/library/SimplePie','File.php',68],['lib/horde/framework/Horde/Imap/Client','Mailbox.php',62],['enrol/lti/classes','manage_table.php',62],['lib/simplepie/library/SimplePie/Content/Type','Sniffer.php',69],['question/type','questionbase.php',124],['question/type','questionbase.php',438],['question/type','questionbase.php',531],['question/type','questionbase.php',750],['question/type','questionbase.php',835],['question/type','questionbase.php',868],['question/type','questionbase.php',914],['question/type','questionbase.php',1013],['question/type/ddimageortext','question.php',64],['question/type/ddimageortext','question.php',122],['lib','excellib.class.php',47],['lib','excellib.class.php',155],['lib','excellib.class.php',456],['lib/minify/lib','CSSmin.php',43],['lib/dml','moodle_temptables.php',51],['lib/minify/lib/Minify/Cache','ZendPlatform.php',23],['backup/util/xml/parser','progressive_parser.class.php',79],['backup/util/xml/parser','progressive_parser.class.php',305],['blocks/rss_client/classes/output','block.php',47],['question/type/ddmarker','question.php',417],['question/type/ddmarker','question.php',469],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Percentage.php',18],['admin/tool/lp/classes/output','user_competency_summary_in_course.php',51],['backup/util/helper','convert_helper.class.php',378],['lib/classes/update','validator.php',265],['lib/lessphp/Tree','Attribute.php',16],['admin/tool/generator/classes','backend.php',84],['backup/util/loggers','file_logger.class.php',35],['lib/adodb','adodb-exceptions.inc.php',30],['lib/google/src/Google','Client.php',70],['user/filters','profilefield.php',36],['backup/util/helper','restore_inforef_parser_processor.class.php',37],['cache/tests/fixtures','lib.php',326],['mod/lti/service/profile/classes/local/resource','profile.php',43],['competency/classes','invalid_persistent_exception.php',38],['backup/util/plan','backup_plan.class.php',36],['backup/util/plan','backup_plan.class.php',130],['lib/phpexcel/PHPExcel/Writer/Excel2007','WriterPart.php',63],['backup/util/settings','setting_dependency.class.php',68],['backup/util/settings','setting_dependency.class.php',175],['backup/util/settings','setting_dependency.class.php',328],['backup/util/settings','setting_dependency.class.php',439],['backup/util/settings','setting_dependency.class.php',465],['backup/util/settings','setting_dependency.class.php',491],['backup/util/settings','setting_dependency.class.php',556],['backup/util/xml','xml_writer.class.php',57],['backup/util/xml','xml_writer.class.php',284],['enrol/imsenterprise','locallib.php',38],['enrol/imsenterprise','locallib.php',115],['lib/dml','moodle_database.php',139],['search/classes','base.php',69],['admin/tool/lp/classes/output','competency_summary.php',54],['lib','upgradelib.php',45],['lib','upgradelib.php',61],['lib','upgradelib.php',76],['lib','upgradelib.php',94],['lib','upgradelib.php',111],['lib/htmlpurifier/HTMLPurifier/AttrTransform','NameSync.php',11],['mod/workshop/form/rubric','lib.php',105],['grade','lib.php',103],['grade','lib.php',927],['grade','lib.php',1089],['grade','lib.php',2053],['grade','lib.php',2213],['lib/horde/framework/Horde/Imap/Client/Data','Acl.php',32],['lib/phpexcel/PHPExcel/Reader/Excel5','RC4.php',35],['lib/google/src/Google/Service','Datastore.php',46],['admin/tool/lpmigrate/classes','framework_processor.php',98],['lib/dtl','database_importer.php',61],['lib/horde/framework/Horde/Imap/Client/Password','Xoauth2.php',44],['badges/lib','awardlib.php',55],['backup/util/helper','backup_array_iterator.class.php',39],['admin/tool/monitor/classes','subscription.php',43],['question/type/calculated','edit_calculated_form.php',51],['lib/spout/src/Spout/Reader/XLSX/Helper/SharedStringsCaching','FileBasedStrategy.php',57],['lib/form','datetimeselector.php',72],['lib/horde/framework/Horde/Imap/Client','Base.php',153],['lib/classes','collator.php',58],['admin/tool/lp/classes','course_competency_statistics.php',48],['lib/google/src/Google/Service','Storage.php',57],['lib/spout/src/Spout/Reader/CSV','SheetIterator.php',28],['lib/lessphp/Tree','Paren.php',14],['mod/lti/classes','service_exception_handler.php',63],['lib/tcpdf/include/barcodes','pdf417.php',523],['mod/assign/feedback/offline','importgradeslib.php',66],['lib/filestorage','file_exceptions.php',36],['lib/filestorage','file_exceptions.php',57],['lib/filestorage','file_exceptions.php',89],['lib/filestorage','file_exceptions.php',108],['lib/filestorage','file_exceptions.php',129],['lib/horde/framework/Horde/Mail/Transport','Smtp.php',100],['lib/htmlpurifier/HTMLPurifier/ConfigSchema/Interchange','Id.php',17],['question/engine/upgrade','upgradelib.php',283],['question/engine/upgrade','upgradelib.php',384],['question/type/numerical','question.php',323],['lib/pear/PEAR','Exception.php',107],['course/format','renderer.php',44],['lib/dml','oci_native_moodle_recordset.php',34],['question/behaviour','behaviourtypebase.php',133],['lib/pear/HTML','QuickForm.php',246],['lib/pear/HTML','QuickForm.php',1979],['backup/util/structure','base_atom.class.php',41],['backup/util/structure','base_atom.class.php',114],['backup/util/structure','base_atom.class.php',135],['backup/util/structure','base_atom.class.php',156],['lib/horde/framework/Horde/Imap/Client/Data','BaseSubject.php',39],['lib/google/src/Google/Auth','LoginTicket.php',37],['lib/adodb/drivers','adodb-csv.inc.php',41],['lib/adodb/drivers','adodb-csv.inc.php',196],['user/filters','yesno.php',33],['mod/wiki/parser','parser.php',98],['lib/htmlpurifier/HTMLPurifier/Token','Comment.php',19],['lib/phpexcel/PHPExcel/Calculation','FormulaParser.php',87],['backup/cc/cc_lib','cc_assesment_truefalse.php',27],['lib/htmlpurifier/HTMLPurifier','Encoder.php',10],['admin/tool/lpmigrate/classes/form','migrate_framework.php',45],['backup/util/xml/parser/tests','parser_test.php',797],['lib/htmlpurifier/HTMLPurifier/AttrTransform','EnumToCSS.php',34],['lib/tests','medialib_test.php',644],['lib/google/src/Google/Service','QPXExpress.php',39],['tag/classes/output','tagname.php',41],['lib/mustache/src/Mustache','Context.php',20],['lib/adodb/drivers','adodb-oracle.inc.php',32],['lib/adodb/drivers','adodb-oracle.inc.php',224],['backup/moodle2','restore_section_task.class.php',42],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Composite.php',25],['lib/htmlpurifier/HTMLPurifier/AttrTransform','Nofollow.php',16],['mod/forum/classes/output','forum_post.php',110],['admin/tool/assignmentupgrade','locallib.php',50],['admin/tool/assignmentupgrade','locallib.php',93],['repository/googledocs','lib.php',65],['cache/stores/memcache','lib.php',120],['lib/filestorage','file_storage.php',78],['admin/tool/monitor/classes/output/managerules','renderable.php',56],['mod/lti/service/toolsettings/classes/local/resource','linksettings.php',45],['lib/form','duration.php',55],['lib','outputlib.php',480],['lib','outputlib.php',2038],['filter/tex','latex.php',13],['backup/moodle2','backup_course_task.class.php',39],['lib/adodb','adodb.inc.php',310],['lib/adodb','adodb.inc.php',3035],['lib/adodb','adodb.inc.php',3160],['lib/adodb','adodb.inc.php',3242],['lib/adodb','adodb.inc.php',4353],['lib/horde/framework/Horde/Support','Randomid.php',26],['lib/google/src/Google/Logger','File.php',51],['admin/roles/classes','allow_role_page.php',37],['mod/quiz/report/overview','overview_table.php',41],['lib/lessphp/Tree','Keyword.php',17],['lib/htmlpurifier/HTMLPurifier/Node','Comment.php',19],['question/type/ddmarker','questiontype.php',48],['mod/folder','renderer.php',159],['lib','portfoliolib.php',101],['tag/classes/output','tagcollsearchable.php',40],['webservice/soap/classes','wsdl.php',88],['lib/lessphp/Exception','Parser.php',30],['badges','renderer.php',973],['badges','renderer.php',1014],['badges','renderer.php',1078],['badges','renderer.php',1111],['badges','renderer.php',1137],['competency/classes/external','exporter.php',56],['mod/lti/service/toolproxy/classes/local/resource','toolproxy.php',47],['lib/google/src/Google/Service','Genomics.php',63],['lib/phpexcel/PHPExcel/Writer','PDF.php',38],['lib/phpexcel/PHPExcel/Shared/trend','exponentialBestFitClass.php',125],['lib/google/src/Google/Service','Games.php',60],['backup/converter/moodle1','lib.php',725],['backup/converter/moodle1','lib.php',865],['backup/converter/moodle1','lib.php',1145],['backup/converter/moodle1','lib.php',1190],['backup/converter/moodle1','lib.php',1480],['backup/util/helper','restore_logs_processor.class.php',45],['backup/util/helper','restore_logs_processor.class.php',141],['lib/htmlpurifier/HTMLPurifier/AttrTransform','Input.php',14],['lib/google/src/Google/Service','Licensing.php',40],['mod/workshop/form/comments','lib.php',99],['backup/util/settings/section','section_backup_setting.class.php',25],['lib/htmlpurifier/HTMLPurifier','Doctype.php',48],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Font.php',22],['lib/google/src/Google/Service','Fitness.php',58],['blocks/private_files','renderer.php',83],['lib/phpexcel/PHPExcel/Worksheet','ColumnCellIterator.php',51],['enrol/flatfile','adminlib.php',35],['lib/xmldb','xmldb_object.php',55],['lib/google/src/Google/Service','Reports.php',47],['question/classes/statistics/responses','analysis_for_actual_response.php',70],['auth/pam','auth.php',53],['lib/horde/framework/Horde','Stream.php',50],['comment','lib.php',100],['lib/htmlpurifier/HTMLPurifier','URIParser.php',10],['lib/htmlpurifier/HTMLPurifier/Node','Text.php',35],['lib/phpexcel/PHPExcel/Worksheet','RowDimension.php',53],['lib/google/src/Google/Service','Gmail.php',64],['lib/google/src/Google/Service','Taskqueue.php',44],['lib/minify/lib/Minify','ImportProcessor.php',48],['lib/horde/framework/Horde/Mime','Related.php',32],['blocks','moodleblock.class.php',111],['lib/tcpdf','tcpdf_parser.php',92],['backup/util/plan','restore_structure_step.class.php',46],['blocks/rss_client/classes/output','channel_image.php',61],['lib/pear/HTML/QuickForm','hierselect.php',105],['question/type/numerical/tests','form_test.php',40],['badges/lib','backpacklib.php',40],['mod/workshop/allocation/manual','lib.php',51],['mod/quiz/report/responses','last_responses_table.php',39],['lib/simplepie','autoloader.php',62],['lib/spout/src/Spout/Common/Helper','StringHelper.php',21],['lib/phpexcel/PHPExcel/Worksheet','BaseDrawing.php',121],['lib/pear/Crypt','CHAP.php',82],['lib/pear/Crypt','CHAP.php',170],['lib/pear/Crypt','CHAP.php',424],['lib/spout/src/Spout/Writer/Common/Helper','AbstractStyleHelper.php',22],['backup/util/xml/parser/processors','progressive_parser_processor.class.php',57],['mod/quiz/classes/question','qubaids_for_users_attempts.php',37],['lib/spout/src/Spout/Reader/XLSX','RowIterator.php',63],['lib/phpexcel/PHPExcel/Reader/Excel5','Escher.php',77],['lib/simplepie/library/SimplePie','gzdecode.php',186],['mod/wiki','renderer.php',540],['lib/adodb','adodb-active-recordx.inc.php',138],['availability/classes','result.php',46],['lib','accesslib.php',5352],['lib','accesslib.php',5897],['lib','accesslib.php',6167],['lib','accesslib.php',6408],['lib','accesslib.php',6595],['lib','accesslib.php',6827],['lib','accesslib.php',7049],['lib','accesslib.php',7291],['lib/phpexcel/PHPExcel/Shared/OLE','PPS.php',110],['grade/grading/form','lib.php',82],['grade/grading/form','lib.php',766],['question/engine','questionusage.php',78],['question/engine','questionusage.php',973],['auth/manual','auth.php',46],['question/engine/upgrade','behaviourconverters.php',78],['mod/wiki/diff','diff_nwiki.php',35],['mod/wiki/diff','diff_nwiki.php',50],['mod/wiki/diff','diff_nwiki.php',63],['mod/wiki/diff','diff_nwiki.php',76],['mod/wiki/diff','diff_nwiki.php',495],['mod/wiki/diff','diff_nwiki.php',640],['mod/wiki/diff','diff_nwiki.php',850],['mod/wiki/diff','diff_nwiki.php',901],['mod/wiki/diff','diff_nwiki.php',953],['lib/adodb/drivers','adodb-proxy.inc.php',28],['lib/classes/lock','file_lock_factory.php',57],['lib/google/src/Google/Auth','OAuth2.php',55],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','Pixels.php',17],['lib/filebrowser','file_info_context_module.php',47],['auth/none','auth.php',34],['lib/simplepie/library/SimplePie/Cache','Base.php',70],['lib/htmlpurifier/HTMLPurifier','Queue.php',24],['lib/horde/framework/Horde/Text','Flowed.php',75],['admin/tool/log/store/legacy/classes/log','store.php',33],['lib/mustache/src/Mustache','HelperCollection.php',19],['backup/util/structure','backup_structure_processor.class.php',45],['backup/util/structure','backup_structure_processor.class.php',133],['admin/tool/lp/classes/output','related_competencies.php',47],['mod/quiz/classes/question/bank','custom_view.php',44],['files','renderer.php',1083],['lib/form','text.php',47],['lib/phpexcel/PHPExcel/Shared/trend','bestFitClass.php',398],['backup/cc','cc112moodle.php',59],['admin/tool/cohortroles/classes/output','cohort_role_assignments_table.php',45],['lib/horde/framework/Horde/Imap/Client/Data','Envelope.php',46],['lib/google/src/Google/Service','Logging.php',39],['lib/lessphp/Tree','Expression.php',16],['mod/lti/classes/local/ltiservice','service_base.php',63],['lib/phpexcel/PHPExcel/Reader','HTML.php',118],['search/engine/solr/classes','schema.php',60],['backup/util/xml/parser/processors','simplified_parser_processor.class.php',46],['lib/htmlpurifier/HTMLPurifier','UnitConverter.php',50],['lib/adodb/drivers','adodb-ado5.inc.php',42],['lib/adodb/drivers','adodb-ado5.inc.php',380],['mod/assign/feedback/editpdf/classes','comment.php',58],['cache/classes','interfaces.php',473],['lib/phpexcel/PHPExcel/Worksheet','Protection.php',157],['repository/merlot','lib.php',37],['lib/adodb/drivers','adodb-firebird.inc.php',69],['backup/util/settings','backup_setting.class.php',43],['lib/adodb/drivers','adodb-fbsql.inc.php',28],['lib/adodb/drivers','adodb-fbsql.inc.php',167],['mnet/xmlrpc','serverlib.php',674],['webservice/soap','lib.php',45],['admin/tool/log/store/database/classes/log','store.php',47],['lib/google/src/Google/Service','Doubleclicksearch.php',43],['lib/form','passwordunmask.php',46],['lib/lessphp/Tree','Variable.php',20],['report/log/classes','renderable.php',96],['mod/lti/service/toolsettings/classes/local/resource','systemsettings.php',43],['question/classes/bank','view.php',70],['grade/report/singleview/classes/local/ui','range.php',38],['lib/simplepie/library/SimplePie/Cache','MySQL.php',80],['admin/roles/classes','define_role_table_basic.php',31],['backup/cc/cc_lib','cc_converter_resource.php',28],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Mongo.php',78],['blocks/rss_client','editfeed.php',36],['admin/tool/lpmigrate/classes/output','migrate_framework_results.php',55],['blocks/lp/classes/output','competencies_to_review_page.php',49],['lib/horde/framework/Horde/Crypt/Blowfish/Php','Base.php',318],['backup/util/loggers','base_logger.class.php',42],['backup/util/loggers','base_logger.class.php',187],['mod/assign/feedback/file','renderable.php',44],['backup/cc/cc_lib','cc_utils.php',313],['backup/cc/cc_lib','cc_utils.php',381],['backup/cc/cc_lib','cc_utils.php',437],['lib/adodb/drivers','adodb-db2.inc.php',66],['lib/adodb/drivers','adodb-db2.inc.php',731],['lib/adodb','adodb-xmlschema03.inc.php',136],['lib/adodb','adodb-xmlschema03.inc.php',270],['lib/adodb','adodb-xmlschema03.inc.php',678],['lib/adodb','adodb-xmlschema03.inc.php',823],['lib/adodb','adodb-xmlschema03.inc.php',1081],['lib/adodb','adodb-xmlschema03.inc.php',1399],['repository/youtube','lib.php',58],['lib/phpexcel/PHPExcel/Writer/PDF','mPDF.php',38],['auth/cas/CAS/CAS','GracefullTerminationException.php',48],['lib/adodb/drivers','adodb-sybase_ase.inc.php',25],['lib/adodb/drivers','adodb-sybase_ase.inc.php',115],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Background.php',20],['lib/adodb','adodb-memcache.lib.inc.php',53],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','FrameTarget.php',19],['lib/phpexcel/PHPExcel/Writer','Excel2007.php',118],['lib/minify/lib/MrClay/Cli','Arg.php',82],['lib/phpexcel/PHPExcel/Worksheet/AutoFilter','Column.php',117],['lib/simplepie','moodle_simplepie.php',50],['lib/simplepie','moodle_simplepie.php',121],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','FontFamily.php',11],['lib/simplepie/library/SimplePie/Decode/HTML','Entities.php',80],['lib/spout/src/Spout/Common/Helper','FileSystemHelper.php',22],['lib/pear/HTML/QuickForm','button.php',37],['lib/google/src/Google/Service','Autoscaler.php',46],['lib/mustache/src/Mustache','Engine.php',63],['lib/google/src/Google/Http','MediaFileUpload.php',75],['lib/phpexcel/PHPExcel','Worksheet.php',327],['mod/assign','gradingtable.php',68],['lib/google/src/Google/Service','AdExchangeSeller.php',53],['question/engine/tests','helpers.php',582],['question/engine/tests','helpers.php',594],['question/engine/tests','helpers.php',608],['question/engine/tests','helpers.php',623],['question/engine/tests','helpers.php',637],['question/engine/tests','helpers.php',652],['question/engine/tests','helpers.php',665],['question/engine/tests','helpers.php',676],['question/engine/tests','helpers.php',1196],['repository/webdav','lib.php',38],['tag/classes/output','tagisstandard.php',39],['lib/google/src/Google/Service','Appsactivity.php',52],['badges/criteria','award_criteria_course.php',47],['lib','searchlib.php',53],['lib','searchlib.php',95],['lib/lessphp/Output','Mapped.php',39],['availability/classes','tree.php',118],['lib/lessphp/Tree','Javascript.php',20],['lib/horde/framework/Horde/Imap/Client','Cache.php',53],['lib/htmlpurifier/HTMLPurifier','AttrCollections.php',16],['lib/mustache/src/Mustache/Loader','InlineLoader.php',56],['repository/url','lib.php',46],['lib/phpexcel/PHPExcel/CachedObjectStorage','SQLite3.php',293],['lib/lessphp/Tree','Ruleset.php',45],['tag/classes/output','tagindex.php',52],['backup/util/ui','backup_ui_stage.class.php',43],['backup/util/ui','backup_ui_stage.class.php',79],['backup/util/ui','backup_ui_stage.class.php',234],['backup/util/ui','backup_ui_stage.class.php',387],['backup/util/ui','backup_ui_stage.class.php',516],['backup/util/ui','backup_ui_stage.class.php',575],['grade/report/singleview/classes/local/screen','screen.php',67],['lib/tcpdf/include/barcodes','datamatrix.php',229],['lib/horde/framework/Horde/Imap/Client/Socket','Catenate.php',37],['lib/google/src/Google/Service','Prediction.php',51],['lib/classes/output','notification.php',101],['lib/lessphp/Tree','Unit.php',16],['backup/util/settings/course','course_backup_setting.class.php',25],['lib/spout/src/Spout/Writer','AbstractWriter.php',68],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','DenyElementDecorator.php',21],['lib','outputfactories.php',120],['lib','outputfactories.php',367],['lib','dtllib.php',66],['mod/assign','assignmentplugin.php',50],['mnet/service/enrol','locallib.php',48],['mnet/service/enrol','locallib.php',466],['mnet/service/enrol','locallib.php',537],['backup/cc/cc_lib','cc_version11.php',57],['availability/condition/completion/classes','condition.php',48],['admin/roles/classes','allow_override_page.php',31],['mod/workshop/allocation','lib.php',103],['lib/htmlpurifier/HTMLPurifier/AttrTransform','BoolToCSS.php',24],['lib/horde/framework/Horde/Imap/Client/Base','Mailbox.php',59],['lib/spout/src/Spout/Reader/Wrapper','SimpleXMLElement.php',23],['lib/google/src/Google/Service','SiteVerification.php',43],['lib/phpexcel/PHPExcel/Calculation','Function.php',64],['availability/classes','capability_checker.php',49],['lib/google/src/Google/Service','Drive.php',76],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Decorator.php',12],['lib/phpexcel/PHPExcel/Shared/JAMA','LUDecomposition.php',56],['lib','setuplib.php',67],['lib','setuplib.php',113],['lib','setuplib.php',165],['lib','setuplib.php',184],['lib','setuplib.php',199],['lib','setuplib.php',219],['lib','setuplib.php',249],['lib','setuplib.php',271],['lib','setuplib.php',287],['lib','setuplib.php',309],['lib','setuplib.php',328],['lib','setuplib.php',346],['lib/form','textarea.php',50],['webservice/soap','locallib.php',57],['availability/classes','info.php',55],['lib/tcpdf','tcpdf_barcodes_1d.php',58],['lib/spout/src/Spout/Reader/XLSX/Helper','SheetHelper.php',49],['filter/urltolink/tests','filter_test.php',209],['lib/simplepie/library/SimplePie','Category.php',81],['admin/tool/lp/classes/output','manage_competencies_page.php',65],['lib/markdown','Markdown.php',99],['mod/assign','locallib.php',160],['mod/assign','locallib.php',8131],['lib/adodb/drivers','adodb-ldap.inc.php',48],['lib/adodb/drivers','adodb-ldap.inc.php',297],['lib/editor/tinymce/plugins/spellchecker/classes/utils','JSON.php',32],['lib/editor/tinymce/plugins/spellchecker/classes/utils','JSON.php',373],['lib','odslib.class.php',42],['lib','odslib.class.php',124],['lib','odslib.class.php',422],['lib','odslib.class.php',827],['lib/horde/framework/Horde/Crypt/Blowfish','Base.php',56],['lib/phpexcel/PHPExcel/Reader/Excel5','MD5.php',36],['grade/report/singleview/classes/local/ui','checkbox_attribute.php',42],['lib/lessphp/Tree','Quoted.php',20],['mod/lesson','mod_form.php',36],['blocks/rss_client/classes/output','item.php',89],['lib/google/src/Google/Service','IdentityToolkit.php',38],['lib/horde/framework/Horde/Stream','Temp.php',25],['tag/classes/output','tagflag.php',39],['admin/tool/monitor/classes/output/managesubs','rules.php',56],['lib/htmlpurifier/HTMLPurifier/ChildDef','Table.php',57],['lib/behat/form_field','behat_form_field.php',59],['lib/phpexcel/PHPExcel/Worksheet/Drawing','Shadow.php',93],['lib/spout/src/Spout/Reader/ODS/Helper','CellValueFormatter.php',42],['tag/classes','collections_table.php',36],['lib/google/src/Google/Service','Spectrum.php',38],['lib/htmlpurifier/HTMLPurifier/AttrTransform','Length.php',19],['admin/tool/lp/classes/output','user_competency_summary.php',49],['lib/phpexcel/PHPExcel','NamedRange.php',65],['lib/pear/HTML/QuickForm','image.php',36],['lib/htmlpurifier/HTMLPurifier/AttrDef/URI','Host.php',15],['lib/form','searchableselector.php',44],['lib/phpexcel/PHPExcel/Shared/JAMA','SingularValueDecomposition.php',52],['lib/adodb/drivers','adodb-oci805.inc.php',51],['lib/google/src/Google','Service.php',28],['lib/google/src/Google/IO','Abstract.php',50],['lib/spout/src/Spout/Writer/ODS/Internal','Worksheet.php',46],['lib/form','header.php',45],['question/type/randomsamatch/tests','helper.php',121],['mod/workshop/form/accumulative','lib.php',99],['lib/phpexcel/PHPExcel/Shared/trend','linearBestFitClass.php',89],['lib/form','submit.php',41],['report/log/classes','table_log.php',45],['admin/roles/classes','admins_potential_selector.php',30],['question/classes/engine/variants','least_used_strategy.php',51],['question/engine/upgrade','logger.php',42],['question/engine/upgrade','logger.php',87],['mod/data','lib.php',68],['mod/data','lib.php',2278],['mod/data','lib.php',2552],['mod/data','lib.php',2573],['backup/util/xml/parser/processors','grouped_parser_processor.class.php',67],['lib/horde/framework/Horde/Imap/Client/Exception','NoSupportPop3.php',26],['mod/scorm','renderer.php',129],['lib/phpunit/classes','advanced_testcase.php',45],['lib/spout/src/Spout/Reader/ODS','SheetIterator.php',41],['backup/cc/cc_lib','cc_version1.php',57],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','LinkTypes.php',21],['tag/classes','areas_table.php',36],['lib/phpexcel/PHPExcel/Shared/trend','powerBestFitClass.php',125],['lib/portfolio/formats/leap2a','lib.php',62],['lib/portfolio/formats/leap2a','lib.php',258],['lib/portfolio/formats/leap2a','lib.php',503],['lib/google/src/Google/Service','Proximitybeacon.php',42],['lib/pear','PEAR.php',139],['lib/pear','PEAR.php',818],['competency/classes/external','persistent_exporter.php',42],['lib/google/src/Google/Service','Groupssettings.php',40],['lib/phpexcel/PHPExcel/Reader','CSV.php',87],['lib/horde/framework/Horde/Exception','LastError.php',16],['lib/google/src/Google/Service','Directory.php',134],['lib/google/src/Google/Service','Fusiontables.php',48],['question/type/missingtype','edit_missingtype_form.php',38],['lib/google/src/Google/Service','AdSenseHost.php',49],['lib/lessphp/Tree','Directive.php',20],['auth/ldap','auth.php',119],['auth/cas/CAS/CAS','CookieJar.php',46],['lib/phpexcel/PHPExcel/CachedObjectStorage','Wincache.php',245],['availability/condition/date/classes','condition.php',52],['lib/horde/framework/Horde/Mime','Mail.php',93],['lib','outputactions.php',60],['lib','outputactions.php',91],['lib','outputactions.php',148],['lib/horde/framework/Horde/Crypt/Blowfish','Mcrypt.php',47],['lib/classes','string_manager_standard.php',53],['repository/skydrive','microsoftliveapi.php',50],['user/filters','globalrole.php',35],['enrol/lti/ims-blti','OAuth.php',16],['enrol/lti/ims-blti','OAuth.php',32],['enrol/lti/ims-blti','OAuth.php',187],['enrol/lti/ims-blti','OAuth.php',451],['course/classes/output','course_module_name.php',46],['lib/google/src/Google/Service','Plus.php',52],['lib/horde/framework/Horde/Mime','Mdn.php',35],['lib/pear/HTML/QuickForm','html.php',36],['repository/s3','S3.php',193],['repository/s3','S3.php',2018],['repository/s3','S3.php',2374],['lib/spout/src/Spout/Reader/XLSX/Helper','SharedStringsHelper.php',39],['question/classes/bank/search','hidden_condition.php',42],['lib/htmlpurifier/HTMLPurifier/ChildDef','Empty.php',22],['lib/pear/HTML/QuickForm','element.php',73],['question/classes/statistics/responses','analysis_for_subpart.php',50],['admin/tool/log/classes','setting_managestores.php',30],['lib/google/src/Google/Service','Mirror.php',49],['lib/adodb/drivers','adodb-db2ora.inc.php',80],['lib/minify/lib/HTTP','Encoder.php',75],['mod/feedback/classes','completion.php',47],['admin/tool/uploadcourse/classes','processor.php',122],['lib/lessphp','Parser.php',78],['lib/adodb/drivers','adodb-sapdb.inc.php',36],['lib/adodb/drivers','adodb-sapdb.inc.php',179],['lib/ddl','sql_generator.php',175],['lib/google/src/Google/Service','AndroidEnterprise.php',51],['admin/tool/lp/classes/output','template_competencies_page.php',70],['lib/horde/framework/Horde/Support','ObjectStub.php',29],['mod/assignment/backup/moodle1','lib.php',223],['blocks','edit_form.php',47],['lib/simplepie/library/SimplePie/Cache','Memcache.php',81],['mod/quiz/report/statistics','statistics_question_table.php',49],['mod/workshop/form/numerrors','lib.php',102],['mod/quiz/classes','repaginate.php',49],['lib/classes/session','memcached.php',51],['lib/phpexcel/PHPExcel/Shared/OLE/PPS','Root.php',43],['lib/phpexcel/PHPExcel/Writer/PDF','Core.php',206],['mod/workshop','mod_form.php',43],['mod/assign/feedback/editpdf/fpdi','pdf_context.php',48],['availability/condition/profile/classes','condition.php',73],['lib/horde/framework/Horde/Imap/Client','DateTime.php',29],['auth/cas/CAS/CAS','Client.php',862],['lib/xhprof','xhprof_moodle.php',788],['lib/dtl','file_xml_database_exporter.php',36],['course','lib.php',3061],['lib/adodb/drivers','adodb-mssqlpo.inc.php',54],['lib/xmldb','xmldb_table.php',49],['lib/adodb/perf','perf-postgres.inc.php',92],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Filter.php',15],['question/type/ddmarker','shapes.php',40],['question/type/ddmarker','shapes.php',203],['question/type/ddmarker','shapes.php',267],['question/type/ddmarker','shapes.php',332],['question/type/ddmarker','shapes.php',470],['mod/lti/classes/local/ltiservice','response.php',58],['backup/util/helper','restore_users_parser_processor.class.php',43],['lib/pear/HTML','Common.php',79],['mod/glossary','locallib.php',481],['lib/adodb/perf','perf-mssqlnative.inc.php',70],['lib/adodb/perf','perf-mssql.inc.php',70],['backup/util/plan','base_plan.class.php',39],['backup/util/plan','base_plan.class.php',215],['backup/util/plan','restore_task.class.php',32],['backup/util/plan','restore_task.class.php',121],['lib/classes/event','base.php',124],['lib/form','checkbox.php',46],['admin/roles/classes','permissions_table.php',38],['lib/pear/HTML/QuickForm','submit.php',37],['auth/fc','auth.php',37],['enrol/ldap','settingslib.php',32],['enrol/ldap','settingslib.php',90],['enrol/ldap','settingslib.php',204],['lib/minify/lib/Minify/Cache','Memcache.php',22],['lib/lessphp/Tree','Condition.php',18],['admin/tool/lp/classes/output','plans_page.php',59],['lib/mustache/src/Mustache','Autoloader.php',19],['lib/spout/src/Spout/Writer/XLSX/Internal','Worksheet.php',52],['lib/phpexcel/PHPExcel','Comment.php',93],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','AlphaValue.php',6],['lib/lessphp/Tree','Url.php',17],['mod/lesson','override_form.php',58],['lib/form','button.php',45],['admin/tool/lp/classes/output','manage_templates_page.php',56],['lib/google/src/Google/Service','Playmoviespartner.php',44],['backup/util/ui','base_ui_stage.class.php',67],['backup/cc/cc_lib','cc_converters.php',75],['lib/dtl','database_mover.php',33],['enrol','locallib.php',125],['enrol','locallib.php',1256],['enrol','locallib.php',1379],['enrol','locallib.php',1430],['enrol','locallib.php',1463],['lib/htmlpurifier/HTMLPurifier','URI.php',58],['backup/moodle2','restore_course_task.class.php',41],['lib/htmlpurifier/HTMLPurifier/Printer','ConfigForm.php',40],['lib/htmlpurifier/HTMLPurifier/Printer','ConfigForm.php',221],['lib','xmlize.php',31],['lib','googleapi.php',52],['lib','googleapi.php',243],['grade/report/singleview/classes/local/ui','element.php',47],['lib/html2text','lib.php',43],['user/filters','lib.php',52],['user/filters','lib.php',272],['auth/cas/CAS/CAS/PGTStorage','Db.php',122],['lib/classes/lock','db_record_lock_factory.php',61],['lib/pear/HTML/QuickForm','link.php',47],['backup/cc/cc_lib','cc_asssesment.php',290],['backup/cc/cc_lib','cc_asssesment.php',345],['backup/cc/cc_lib','cc_asssesment.php',364],['backup/cc/cc_lib','cc_asssesment.php',415],['backup/cc/cc_lib','cc_asssesment.php',476],['backup/cc/cc_lib','cc_asssesment.php',486],['backup/cc/cc_lib','cc_asssesment.php',561],['backup/cc/cc_lib','cc_asssesment.php',585],['backup/cc/cc_lib','cc_asssesment.php',635],['backup/cc/cc_lib','cc_asssesment.php',668],['backup/cc/cc_lib','cc_asssesment.php',693],['backup/cc/cc_lib','cc_asssesment.php',788],['backup/cc/cc_lib','cc_asssesment.php',814],['backup/cc/cc_lib','cc_asssesment.php',838],['backup/cc/cc_lib','cc_asssesment.php',965],['backup/cc/cc_lib','cc_asssesment.php',971],['backup/cc/cc_lib','cc_asssesment.php',986],['backup/cc/cc_lib','cc_asssesment.php',1003],['backup/cc/cc_lib','cc_asssesment.php',1017],['backup/cc/cc_lib','cc_asssesment.php',1045],['backup/cc/cc_lib','cc_asssesment.php',1186],['backup/cc/cc_lib','cc_asssesment.php',1263],['backup/cc/cc_lib','cc_asssesment.php',1317],['backup/cc/cc_lib','cc_asssesment.php',1389],['backup/cc/cc_lib','cc_asssesment.php',1451],['backup/cc/cc_lib','cc_asssesment.php',1558],['backup/cc/cc_lib','cc_asssesment.php',1620],['backup/cc/cc_lib','cc_asssesment.php',1648],['backup/cc/cc_lib','cc_asssesment.php',1716],['backup/cc/cc_lib','cc_asssesment.php',2155],['backup/cc/cc_lib','cc_asssesment.php',2264],['backup/cc/cc_lib','cc_asssesment.php',2469],['lib/phpunit/classes','hint_resultprinter.php',37],['lib/horde/framework/Horde/Mail/Transport','Mail.php',53],['auth/pop3','auth.php',35],['lib/adodb/drivers','adodb-oci8.inc.php',106],['lib/adodb/drivers','adodb-oci8.inc.php',1539],['lib/adodb/drivers','adodb-oci8.inc.php',1805],['lib/classes/session','database.php',52],['backup/util/ui','restore_ui_components.php',81],['backup/util/ui','restore_ui_components.php',287],['backup/util/ui','restore_ui_components.php',382],['question/classes/bank/search','category_condition.php',60],['lib/google/src/Google/Auth','AssertionCredentials.php',53],['backup/util/plan','restore_plan.class.php',43],['backup/util/plan','restore_plan.class.php',203],['backup/util/xml/parser/processors','findpaths_parser_processor.class.php',35],['lib/phpexcel/PHPExcel/CalcEngine','Logger.php',63],['lib/jabber/XMPP','Log.php',67],['lib/horde/framework/Horde/Imap/Client/Exception','ServerResponse.php',44],['lib/lessphp/Tree','Assignment.php',15],['lib/dtl','string_xml_database_importer.php',34],['admin/tool/lp/classes/output','manage_competency_frameworks_page.php',62],['question/type/calculated','question.php',188],['question/type/calculated','question.php',303],['repository/recent','lib.php',39],['grade/report/singleview/classes/local/ui','text_attribute.php',42],['admin/webservice','lib.php',38],['lib','coursecatlib.php',194],['lib','coursecatlib.php',2782],['lib/google/src/Google/Service','Cloudtrace.php',43],['lib','filterlib.php',73],['lib','filterlib.php',377],['lib','filterlib.php',456],['lib/classes/lock','lock_factory.php',39],['lib/filebrowser','file_info_context_course.php',39],['lib/filebrowser','file_info_context_course.php',492],['lib/filebrowser','file_info_context_course.php',596],['lib/filebrowser','file_info_context_course.php',745],['enrol','renderer.php',426],['enrol','renderer.php',723],['question/classes/statistics/questions','calculated_for_subquestion.php',57],['backup/moodle2','backup_format_plugin.class.php',40],['admin/tool/lp/classes','course_competency_rule_form_element.php',45],['auth/cas/CAS/CAS','ProxyTicketException.php',46],['lib/phpunit/classes','basic_testcase.php',39],['lib/spout/src/Spout/Reader/ODS','RowIterator.php',49],['backup/util/dbops','backup_dbops.class.php',37],['admin/tool/customlang','locallib.php',44],['admin/tool/customlang','locallib.php',405],['admin/tool/customlang','locallib.php',471],['backup/util/structure','backup_optigroup_element.class.php',51],['mod/quiz/report/grading','gradingsettings_form.php',44],['backup/util/plan','restore_step.class.php',32],['backup/util/plan','restore_step.class.php',104],['lib/form','hidden.php',44],['repository/filesystem','lib.php',48],['backup/controller','backup_controller.class.php',68],['backup/controller','backup_controller.class.php',409],['backup/util/helper','restore_log_rule.class.php',62],['tag/classes','tag.php',77],['lib/htmlpurifier/HTMLPurifier/AttrTransform','SafeParam.php',27],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Db.php',38],['lib/spout/src/Spout/Writer/Style','StyleBuilder.php',19],['lib/dml','sqlsrv_native_moodle_database.php',53],['user/filters','date.php',40],['auth/nologin','auth.php',35],['lib/google/src/Google','Model.php',35],['lib/horde/framework/Horde/Imap/Client/Socket','ClientSort.php',37],['lib/horde/framework/Horde/Imap/Client/Exception','SearchCharset.php',34],['lib/horde/framework/Horde/Support','StringStream.php',30],['lib/adodb/drivers','adodb-mysqli.inc.php',66],['lib/adodb/drivers','adodb-mysqli.inc.php',887],['lib/adodb/drivers','adodb-mysqli.inc.php',1193],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','ImportantDecorator.php',21],['lib/form','questioncategory.php',46],['lib/mustache/src/Mustache','Template.php',29],['backup/util/structure','base_nested_element.class.php',44],['backup/util/structure','base_nested_element.class.php',258],['lib/google/src/Google/Logger','Abstract.php',123],['backup/cc/cc_lib','cc_general.php',38],['lib/phpexcel/PHPExcel','ReferenceHelper.php',58],['lib/pear/HTML/QuickForm','password.php',37],['lib/dml','moodle_transaction.php',40],['lib/phpexcel/PHPExcel/Reader','Excel2003XML.php',53],['lib/htmlpurifier/HTMLPurifier/AttrDef','Switch.php',29],['repository/flickr','lib.php',51],['lib/form','grading.php',57],['lib/classes/update','api.php',71],['backup/cc/cc_lib','cc_converter_lti.php',29],['backup/moodle2','backup_subplugin.class.php',44],['lib/portfolio','caller.php',67],['lib/classes/progress','display_if_slow.php',60],['lib/adodb/perf','perf-informix.inc.php',66],['lib/classes','chart_base.php',52],['lib/lessphp/Tree','Media.php',18],['lib/spout/src/Spout/Common/Escaper','XLSX.php',19],['grade/export/ods','grade_export_ods.php',24],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Length.php',23],['lib/google/src/Google/Service','Calendar.php',50],['lib/form','group.php',44],['lib/phpexcel/PHPExcel/Writer','OpenDocument.php',44],['lib/pear/HTML/QuickForm/Renderer','Object.php',75],['admin/tool/lp/classes/output','user_evidence_page.php',48],['lib/horde/framework/Horde/Imap/Client/Fetch','Results.php',54],['grade/export/xls','grade_export_xls.php',24],['lib/classes/output','mustache_pix_helper.php',43],['lib/horde/framework/Horde/Imap/Client/Mailbox','List.php',46],['lib/google/src/Google/Auth','ComputeEngine.php',35],['cache/stores/session','lib.php',131],['lib/mustache/src/Mustache/Logger','StreamLogger.php',44],['admin/tool/log/store/database/backup/moodle2','backup_logstore_database_nested_element.php',43],['user','renderer.php',220],['lib/htmlpurifier/HTMLPurifier/ChildDef','Required.php',23],['availability/condition/grade/classes','condition.php',46],['lib/lessphp/Tree','RulesetCall.php',14],['blocks/rss_client/classes/output','feed.php',75],['lib/form','select.php',47],['lib/htmlpurifier/HTMLPurifier','ContentSets.php',33],['lib/lessphp/Visitor','toCSS.php',13],['lib','outputfragmentrequirementslib.php',40],['backup/util/ui','restore_moodleform.class.php',34],['lib/google/src/Google/Service','Cloudbilling.php',43],['lib/google/src/Google/Service','PlusDomains.php',72],['lib','externallib.php',37],['lib','externallib.php',531],['lib','externallib.php',562],['lib','externallib.php',593],['lib','externallib.php',622],['lib','externallib.php',648],['lib','externallib.php',778],['lib','externallib.php',813],['lib','externallib.php',984],['lib','externallib.php',1177],['blog','locallib.php',71],['blog','locallib.php',564],['blog','locallib.php',847],['blog','locallib.php',892],['blog','locallib.php',965],['blog','locallib.php',1016],['blog','locallib.php',1041],['blog','locallib.php',1051],['blog','locallib.php',1063],['blog','locallib.php',1084],['lib/phpexcel/PHPExcel/Worksheet','ColumnDimension.php',53],['auth/cas','auth.php',39],['lib','lexer.php',41],['lib','lexer.php',145],['lib','lexer.php',217],['lib/phpexcel/PHPExcel/Shared/JAMA','QRDecomposition.php',48],['lib/google/src/Google/Service','Exception.php',34],['lib/htmlpurifier/HTMLPurifier','Printer.php',21],['tag/classes/output','tagcloud.php',49],['lib/google/src/Google/Service','Storagetransfer.php',44],['user/filters','select.php',46],['cache/stores/mongodb','lib.php',116],['admin/tool/lp/classes/output','course_competencies_page.php',73],['lib/google/src/Google/Cache','Null.php',28],['lib','graphlib.php',1176],['lib/phpexcel/PHPExcel/Style','Protection.php',49],['lib/google/src/Google/Service','GamesConfiguration.php',42],['repository/dropbox','locallib.php',46],['lib/phpexcel/PHPExcel/Style','Alignment.php',100],['lib/htmlpurifier/HTMLPurifier','Language.php',63],['cache/stores/file','lib.php',117],['tag/classes/output','tagareashowstandard.php',41],['question/type/multianswer','edit_multianswer_form.php',63],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','Bool.php',22],['mod/assign','renderable.php',41],['mod/assign','renderable.php',71],['mod/assign','renderable.php',103],['mod/assign','renderable.php',139],['mod/assign','renderable.php',191],['mod/assign','renderable.php',242],['mod/assign','renderable.php',291],['mod/assign','renderable.php',395],['mod/assign','renderable.php',531],['mod/assign','renderable.php',586],['mod/assign','renderable.php',670],['mod/assign','renderable.php',707],['mod/assign','renderable.php',747],['mod/assign','renderable.php',800],['mod/assign','renderable.php',854],['lib/form','selectwithlink.php',56],['backup/moodle2','backup_activity_task.class.php',45],['lib/phpmailer','class.phpmailer.php',633],['lib/horde/framework/Horde/Imap/Client/Data','AclRights.php',39],['auth/db','auth.php',36],['lib/lessphp/Tree','Value.php',14],['lib/form','course.php',62],['question/engine','questionattemptstep.php',97],['question/engine','questionattemptstep.php',608],['cohort','locallib.php',37],['cohort','locallib.php',101],['badges/criteria','award_criteria.php',127],['lib/adodb/perf','perf-mysql.inc.php',86],['cache/stores/memcached','lib.php',133],['grade/report/singleview/classes/local/ui','empty_element.php',38],['lib/google/src/Google/Service','AppState.php',40],['lib/adodb/drivers','adodb-odbc_oracle.inc.php',107],['lib/pear/HTML/QuickForm/Renderer','Default.php',139],['tag/classes/output','tag.php',46],['question','previewlib.php',122],['backup/util/loggers','database_logger.class.php',40],['mod/forum/classes','potential_subscriber_selector.php',47],['lib/htmlpurifier/HTMLPurifier/ConfigSchema','InterchangeBuilder.php',15],['lib/phpexcel/PHPExcel/Reader','SYLK.php',67],['lib/form','submitlink.php',47],['backup/util/dbops','restore_dbops.class.php',1788],['lib/xmldb','xmldb_index.php',56],['question','category_class.php',58],['question','category_class.php',160],['lib/google/src/Google/Service','Webfonts.php',38],['webservice/xmlrpc','locallib.php',41],['admin/roles/classes','check_users_selector.php',38],['lib/htmlpurifier/HTMLPurifier/AttrTransform','ImgSpace.php',24],['user/profile/field/checkbox','field.class.php',33],['lib/form','cancel.php',47],['lib/google/src/Google/Service','Resourceviews.php',57],['lib/phpexcel/PHPExcel/Style','Font.php',100],['lib/portfolio','plugin.php',445],['calendar','lib.php',2003],['calendar','lib.php',2774],['mod/wiki','pagelib.php',93],['mod/wiki','pagelib.php',380],['mod/wiki','pagelib.php',981],['mod/wiki','pagelib.php',1190],['mod/wiki','pagelib.php',2194],['mod/wiki','pagelib.php',2422],['tag/classes/output','tagfeed.php',43],['tag/classes/output','tagareaenabled.php',38],['backup/util/xml/parser/processors','selective_like_parser_processor.class.php',35],['mod/workshop','locallib.php',183],['mod/workshop','locallib.php',2976],['mod/workshop','locallib.php',3411],['mod/workshop','locallib.php',3647],['mod/workshop','locallib.php',3889],['mod/workshop','locallib.php',3975],['mod/workshop','locallib.php',4060],['mod/workshop','locallib.php',4079],['lib/form','advcheckbox.php',48],['backup/cc/cc_lib','cc_assesment_sfib.php',27],['cohort/classes/output','cohortidnumber.php',37],['lib/adodb/drivers','adodb-ado.inc.php',42],['lib/adodb/drivers','adodb-ado.inc.php',346],['lib/form','filepicker.php',53],['mod/assign','adminlib.php',41],['mod/assign','adminlib.php',102],['lib/tests/fixtures','test_renderer_factory.php',41],['backup/cc/cc_lib','cc_converter_label.php',28],['lib/htmlpurifier/HTMLPurifier','Lexer.php',152],['grade/report/singleview','lib.php',69],['backup/cc/cc_lib','cc_converter_page.php',28],['lib/google/src/Google/Logger','Psr.php',39],['lib/simplepie/library/SimplePie/HTTP','Parser.php',131],['backup/util/plan','backup_step.class.php',32],['backup/util/plan','backup_step.class.php',55],['lib/lessphp/Tree','Import.php',30],['lib/jabber/XMPP','XMPP_Old.php',45],['lib/phpexcel/PHPExcel/Worksheet','Drawing.php',37],['lib/google/src/Google/Service','Classroom.php',60],['lib/phpexcel/PHPExcel/Chart/Renderer','jpgraph.php',875],['admin/tool/lp/classes/external','competency_path_exporter.php',38],['cohort/classes/output','cohortname.php',37],['grade/report/overview','lib.php',76],['lib/horde/framework/Horde/Mail/Rfc822','Address.php',66],['admin/roles/classes','admins_existing_selector.php',30],['lib/phpunit/classes','arraydataset.php',45],['question/engine','questionattempt.php',166],['question/engine','questionattempt.php',1532],['question/engine','questionattempt.php',1618],['question/engine','questionattempt.php',1703],['lib/horde/framework/Horde/Support','Uuid.php',23],['lib/horde/framework/Horde/Imap/Client/Data/Format','Nil.php',27],['webservice/rest','lib.php',47],['lib/phpexcel/PHPExcel/Worksheet','HeaderFooterDrawing.php',79],['backup/util/xml/output','memory_xml_output.class.php',37],['repository/flickr_public','image.php',34],['mod/lti/classes/local/ltiservice','resource_base.php',62],['admin/tool/lp/classes/output','template_plans_table.php',53],['mod/quiz','mod_form.php',48],['lib/simplepie/library/SimplePie','Caption.php',98],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Multiple.php',33],['lib/htmlpurifier/HTMLPurifier','PercentEncoder.php',20],['lib/phpexcel/PHPExcel/Calculation','ExceptionHandler.php',30],['lib/htmlpurifier/HTMLPurifier/Token','Tag.php',33],['backup/moodle2','backup_theme_plugin.class.php',61],['mod/chat','chatd.php',78],['mod/chat','chatd.php',103],['lib/phpexcel/PHPExcel','DocumentSecurity.php',65],['lib/htmlpurifier/HTMLPurifier','URIDefinition.php',21],['lib/spout/src/Spout/Writer/XLSX/Internal','Workbook.php',45],['lib/phpexcel/PHPExcel/Shared','XMLWriter.php',49],['lib/lessphp/Tree','Operation.php',19],['lib/htmlpurifier/HTMLPurifier/Lexer','PH5P.php',461],['lib/htmlpurifier/HTMLPurifier/Lexer','PH5P.php',1699],['backup/cc/cc_lib','cc_converter_folder.php',28],['backup/util/helper','restore_roles_parser_processor.class.php',39],['lib/simplepie/library/SimplePie','Locator.php',68],['lib/google/src/Google/Service','SQLAdmin.php',50],['lib/lessphp/Tree','DetachedRuleset.php',15],['admin/tool/assignmentupgrade','upgradableassignmentstable.php',49],['backup/cc','validator.php',30],['backup/cc','validator.php',116],['backup/cc','validator.php',202],['backup/cc','validator.php',230],['backup/cc','validator.php',236],['backup/cc','validator.php',242],['backup/cc','validator.php',248],['backup/cc','validator.php',254],['backup/cc','validator.php',260],['lib/horde/framework/Horde/Imap/Client/Interaction','Client.php',34],['mod/quiz','override_form.php',58],['auth/cas/CAS/CAS/PGTStorage','AbstractStorage.php',57],['lib/htmlpurifier/HTMLPurifier','Length.php',41],['backup/util/helper','restore_decode_rule.class.php',47],['backup/util/helper','restore_decode_rule.class.php',192],['lib/horde/framework/Horde/Imap/Client/Data','Sync.php',133],['lib/phpexcel/PHPExcel/Shared/trend','logarithmicBestFitClass.php',97],['lib/adodb/perf','perf-db2.inc.php',61],['lib/phpexcel/PHPExcel/Style','Supervisor.php',44],['lib/htmlpurifier/HTMLPurifier/AttrTransform','TargetBlank.php',17],['lib/ddl','database_manager.php',48],['lib/mustache/src/Mustache/Exception','UnknownFilterException.php',22],['admin/roles/classes','define_role_table_advanced.php',46],['lib/dml','oci_native_moodle_temptables.php',40],['lib/horde/framework/Horde/Stream','Existing.php',28],['enrol/manual','locallib.php',37],['enrol/manual','locallib.php',102],['availability/classes','multiple_messages.php',56],['lib/phpexcel/PHPExcel/Reader','Gnumeric.php',55],['admin/roles/classes','override_permissions_table_advanced.php',31],['lib/pear/Net','GeoIP.php',323],['lib/mustache/src/Mustache/Loader','ArrayLoader.php',31],['lib/form','modgrade.php',78],['admin/tool/log/store/database/backup/moodle2','restore_logstore_database_subplugin.class.php',40],['cache/classes','config.php',80],['lib/pear/HTML/QuickForm','hidden.php',37],['question/type/calculated','datasetitems_form.php',72],['lib/tests','navigationlib_test.php',554],['lib/tests','navigationlib_test.php',612],['lib/tests','navigationlib_test.php',639],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Number.php',18],['lib/tests','completionlib_test.php',882],['admin/tool/generator/classes','site_backend.php',58],['lib/jabber/XMPP','XMLStream.php',171],['lib/simplepie/library/SimplePie','Sanitize.php',75],['cache/classes','factory.php',149],['lib/minify/lib/Minify/Cache','WinCache.php',20],['user/classes/output/myprofile','node.php',82],['lib/horde/framework/Horde/Stream','TempString.php',40],['lib/adodb/drivers','adodb-borland_ibase.inc.php',83],['mod/forum','locallib.php',55],['mod/forum','locallib.php',419],['mod/lti/service/memberships/classes/local/resource','contextmemberships.php',44],['lib/phpexcel/PHPExcel/Worksheet/AutoFilter/Column','Rule.php',262],['lib/classes/update','code_manager.php',57],['search/engine/solr/classes','engine.php',103],['lib/horde/framework/Horde/Imap/Client/Interaction/Server','Tagged.php',36],['lib/google/src/Google/Service','Compute.php',89],['lib/phpexcel/PHPExcel/Style','Borders.php',113],['lib','completionlib.php',243],['lib/google/src/Google/Service','Pubsub.php',44],['lib/adodb/drivers','adodb-ads.inc.php',69],['lib/adodb/drivers','adodb-ads.inc.php',657],['lib/markdown','MarkdownExtra.php',56],['lib/minify/lib/Minify/Cache','XCache.php',22],['lib/google/src/Google/Service','YouTube.php',75],['lib/lessphp','Functions.php',15],['auth/cas/CAS/CAS','AuthenticationException.php',53],['mod/quiz','locallib.php',1923],['competency/classes/external','stored_file_exporter.php',45],['user/filters','checkbox.php',51],['backup/moodle2','restore_settingslib.php',86],['backup/moodle2','restore_settingslib.php',149],['lib/htmlpurifier/HTMLPurifier/Node','Element.php',39],['lib/pear/HTML/QuickForm','date.php',260],['lib/lessphp/SourceMap','Generator.php',82],['backup/util/plan','base_step.class.php',35],['backup/util/plan','base_step.class.php',127],['mod/lti/service/memberships/classes/local/service','memberships.php',50],['lib/google/src/Google/Cache','Apc.php',37],['backup/util/ui','restore_ui_stage.class.php',42],['backup/util/ui','restore_ui_stage.class.php',265],['backup/util/ui','restore_ui_stage.class.php',452],['backup/util/ui','restore_ui_stage.class.php',592],['backup/util/ui','restore_ui_stage.class.php',704],['backup/util/ui','restore_ui_stage.class.php',852],['backup/util/ui','restore_ui_stage.class.php',959],['backup/util/ui','restore_ui_stage.class.php',1100],['lib/pear/Auth','RADIUS.php',120],['lib/pear/Auth','RADIUS.php',579],['lib/pear/Auth','RADIUS.php',672],['lib/pear/Auth','RADIUS.php',879],['lib/adodb/drivers','adodb-ado_access.inc.php',46],['admin/tool/xmldb/actions','XMLDBAction.class.php',56],['backup/converter/moodle1','handlerlib.php',120],['backup/converter/moodle1','handlerlib.php',1710],['backup/converter/moodle1','handlerlib.php',1902],['backup/converter/moodle1','handlerlib.php',2155],['backup/controller','restore_controller.class.php',63],['backup/controller','restore_controller.class.php',519],['lib/google/src/Google/Http','Request.php',58],['lib/google/src/Google/Service','Dfareporting.php',99],['lib/google/src/Google/Service','Manager.php',60],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Hashtable.php',73],['lib/htmlpurifier/HTMLPurifier/ConfigSchema','Validator.php',30],['lib/google/src/Google/Service','CloudMonitoring.php',45],['lib/editor/tinymce/plugins/spellchecker/classes','SpellChecker.php',11],['lib/horde/framework/Horde/Imap/Client/Ids','Map.php',44],['lib/horde/framework/Horde/Mail/Transport','Sendmail.php',65],['lib','webdavlib.php',84],['lib/dml','pgsql_native_moodle_recordset.php',43],['lib/horde/framework/Horde/Support','Guid.php',24],['lib/mustache/src/Mustache','LambdaHelper.php',25],['question/engine/upgrade/tests','helper.php',45],['admin/tool/uploadcourse/classes','tracker.php',72],['grade/report/user','lib.php',188],['lib/adodb/drivers','adodb-sqlanywhere.inc.php',156],['auth/cas/CAS/CAS','OutOfSequenceBeforeClientException.php',47],['backup/util/plan','base_task.class.php',40],['backup/util/plan','base_task.class.php',277],['lib/adodb/drivers','adodb-db2oci.inc.php',220]], 1102],
'get_file': ['get_file', 'Downloads a repository file and saves to a path. ', [['repository/boxnet','lib.php',179],['repository/flickr_public','lib.php',453],['repository/dropbox','lib.php',410],['repository/skydrive','lib.php',130],['repository','lib.php',1647],['repository/s3','lib.php',227],['repository/equella','lib.php',166],['mod/data/field/picture','field.class.php',126],['mod/data/field/file','field.class.php',123],['repository/googledocs','lib.php',408],['lib/filestorage','file_storage.php',700],['repository/webdav','lib.php',73],['repository/filesystem','lib.php',398],['repository/flickr','lib.php',277],['lib','externallib.php',1076],['repository/dropbox','locallib.php',114],['lib','webdavlib.php',391]], 169],
'keepalive_client': ['keepalive_client', 'Poll the IdP server to let it know that a user it has authenticated is still online ', [['auth/mnet','auth.php',711]], 1],
'has_service': ['has_service', 'Determines if an MNET host is providing the nominated service. ', [['auth/mnet','auth.php',1079]], 1],
'logoutpage_hook': ['logoutpage_hook', '', [['auth/mnet','auth.php',1131],['auth/shibboleth','auth.php',203],['lib','authlib.php',503],['auth/cas','auth.php',509]], 1],
'get_field': ['get_field', 'Gets an instance of the form field. ', [['lib/behat','behat_field_manager.php',248],['mod/quiz/report/statistics/classes','calculated.php',109],['lib/dml','moodle_database.php',1546],['user/filters','lib.php',124]], 536],
'is_loggedinas': ['is_loggedinas', 'Is current $USER logged-in-as somebody else? ', [['lib/classes/session','manager.php',811]], 30],
'generate_token': ['generate_token', 'Generate a random string for use as an RPC session token. ', [['auth/mnet','auth.php',135]], 2],
'user_create_user': ['user_create_user', 'Creates a user ', [['user','lib.php',25]], 15],
'on': ['on', '', [['lib/requirejs','require.js',508],['lib/jquery','jquery-3.1.0.js',4809]], 3823],
'can_change_password': ['can_change_password', 'Returns true if this authentication plugin can change the user\'s password. ', [['auth/radius','auth.php',161],['auth/nntp','auth.php',99],['auth/email','auth.php',183],['auth/mnet','auth.php',598],['auth/imap','auth.php',120],['auth/webservice','auth.php',111],['auth/shibboleth','auth.php',180],['auth/pam','auth.php',111],['auth/manual','auth.php',122],['auth/none','auth.php',99],['auth/ldap','auth.php',1601],['lib','authlib.php',151],['auth/fc','auth.php',180],['auth/pop3','auth.php',116],['auth/nologin','auth.php',82],['auth/cas','auth.php',86],['auth/db','auth.php',714]], 13],
'fetch_user_image': ['fetch_user_image', 'Returns the user\'s profile image info ', [['auth/mnet','auth.php',1021]], 0],
'set_method': ['set_method', 'Set the path to the method or function we want to execute on the remote machine. Examples: mod/scorm/functionname auth/mnet/methodname In the case of auth and enrolment plugins, an object will be created and the method on that object will be called ', [['mnet/xmlrpc','client.php',60]], 18],
'print_error': ['print_error', 'Abort execution by throwing of a general exception, default exception handler displays the error message in most cases. ', [['lib','setuplib.php',481]], 1488],
'prelogout_hook': ['prelogout_hook', 'Cleanup any remote mnet_sessions, kill the local mnet_session data ', [['auth/mnet','auth.php',851],['lib','authlib.php',491]], 1],
'kill_session': ['kill_session', 'Kill one session, the session record is removed afterwards. ', [['lib/classes/session','file.php',107],['lib/classes/session','memcache.php',194],['lib/classes/session','memcached.php',217],['lib/classes/session','database.php',106],['lib/classes/session','manager.php',615]], 16],
'get_archetype_roles': ['get_archetype_roles', 'Returns roles of a specified archetype ', [['lib','accesslib.php',3265]], 33],
'mnet_fields_to_import': ['mnet_fields_to_import', 'return an array of the profile fields to import from the given host, when creating/updating user accounts ', [['mnet','lib.php',856]], 2],
'get_config': ['get_config', 'Config get method. ', [['lib/classes/antivirus','scanner.php',54],['competency/classes','competency_rule.php',59],['question/engine','bank.php',109],['admin/tool/log/classes/helper','store.php',63],['lib','moodlelib.php',1409],['lib','enrollib.php',1142],['lib/editor/tinymce/classes','plugin.php',73],['competency/classes','competency_rule_points.php',43],['search/classes','base.php',169],['mod/assign','assignmentplugin.php',345],['lib/portfolio','plugin.php',546]], 934],
'user_authorise': ['user_authorise', 'Return user data for the provided token, compare with user_agent string. ', [['auth/mnet','auth.php',67]], 0],
'get_mimetype': ['get_mimetype', 'Returns mimetype ', [['lib/filebrowser','file_info.php',277],['lib/filebrowser','virtual_root_file.php',254],['lib/filebrowser','file_info_stored.php',240],['lib/filestorage','stored_file.php',738],['lib','medialib.php',192],['lib/portfolio','caller.php',453]], 59],
'format_string': ['format_string', 'Given a simple string, this function returns the string processed by enabled string filters if $CFG->filterall is enabled ', [['lib','weblib.php',1379]], 880],
'is_mnet_remote_user': ['is_mnet_remote_user', 'Returns whether or not the user object is a remote MNET user. This function is in moodlelib because it does not rely on loading any of the MNET code. ', [['lib','moodlelib.php',9147]], 20],
'is_enabled_auth': ['is_enabled_auth', 'Checks if a given plugin is in the list of enabled authentication plugins. ', [['lib','moodlelib.php',3592]], 38],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required, Some conversions and safety checks are carried out. Lobs are supported. If the return ID isn\'t required, then this just reports success as true/false. $data is an object containing needed data ', [['lib/dml','pdo_moodle_database.php',387],['lib/dml','oci_native_moodle_database.php',1297],['lib/dml','pgsql_native_moodle_database.php',889],['lib/dml','mssql_native_moodle_database.php',962],['lib/dml','mysqli_native_moodle_database.php',1185],['question/engine/upgrade','upgradelib.php',124],['lib/dml','sqlsrv_native_moodle_database.php',1045],['lib/dml/tests','dml_test.php',5548]], 1611],
'touch_session': ['touch_session', 'Fake last access for given session, this prevents session timeout. ', [['lib/classes/session','manager.php',584]], 5],
'kill_child': ['kill_child', 'When the IdP requests that child sessions are terminated, this function will be called on each of the child hosts. The machine that calls the function (over xmlrpc) provides us with the mnethostid we need. ', [['auth/mnet','auth.php',982]], 0],
'enrol_get_users_courses': ['enrol_get_users_courses', 'Returns list of courses user is enrolled into. (Note: use enrol_get_all_users_courses if you want to use the list wihtout any cap checks ) ', [['lib','enrollib.php',679]], 17],
'user_login': ['user_login', 'Returns true if the username and password work and false if they are wrong or don\'t exist. ', [['auth/radius','auth.php',56],['auth/nntp','auth.php',53],['auth/email','auth.php',52],['auth/lti','auth.php',45],['auth/mnet','auth.php',54],['auth/imap','auth.php',53],['auth/webservice','auth.php',53],['auth/shibboleth','auth.php',56],['auth/pam','auth.php',72],['auth/manual','auth.php',66],['auth/none','auth.php',52],['auth/ldap','auth.php',139],['lib','authlib.php',132],['auth/fc','auth.php',55],['auth/pop3','auth.php',53],['auth/nologin','auth.php',52],['auth/cas','auth.php',63],['auth/db','auth.php',50]], 15],
'join': ['join', 'Join a room. For internal use by the Games SDK only. Calling this method directly is unsupported. (rooms.join) ', [['lib/google/src/Google/Service','Games.php',1716],['lib/google/src/Google/Service','Games.php',2100]], 1030],
'change_password_url': ['change_password_url', 'Returns the URL for changing the user\'s pw, or empty if the default can be used. ', [['auth/email','auth.php',193],['auth/mnet','auth.php',609],['auth/imap','auth.php',130],['auth/webservice','auth.php',121],['auth/manual','auth.php',132],['auth/none','auth.php',109],['auth/ldap','auth.php',1611],['lib','authlib.php',162],['auth/pop3','auth.php',126],['auth/cas','auth.php',274],['auth/db','auth.php',724]], 9],
'get_file_storage': ['get_file_storage', 'Returns local file storage instance ', [['lib','moodlelib.php',6144]], 546],
'set_id': ['set_id', 'Setter for $id. ', [['lib/classes/task','adhoc_task.php',43],['lib/classes/message/inbound','handler.php',100],['blocks/rss_client/classes/output','item.php',140],['mnet','peer.php',253]], 26],
'mnet_debug': ['mnet_debug', 'Output debug information about mnet.  this will go to the <b>error_log</b>. ', [['mnet','lib.php',556]], 24],
'set_config': ['set_config', 'Set a key in global configuration ', [['lib','moodlelib.php',1336],['lib','enrollib.php',1153],['lib/editor/tinymce/classes','plugin.php',84],['mod/assign','assignmentplugin.php',314],['lib/portfolio','plugin.php',515]], 1119],
'get_site': ['get_site', 'Returns $course object of the top-level site. ', [['lib','datalib.php',547]], 77],
'cron': ['cron', 'Find user\'s who have completed this criteria ', [['completion/criteria','completion_criteria_course.php',152],['enrol/manual','lib.php',284],['admin/registration','lib.php',50],['question/engine','bank.php',415],['completion/criteria','completion_criteria_date.php',144],['repository/dropbox','lib.php',704],['lib/classes/update','checker.php',193],['enrol/imsenterprise','lib.php',87],['lib','enrollib.php',1980],['repository','lib.php',2357],['auth/mnet','auth.php',832],['enrol/self','lib.php',423],['cache/classes','helper.php',659],['enrol/cohort','lib.php',164],['lib/filestorage','file_storage.php',2494],['enrol/category','lib.php',77],['mod/assign','assignmentplugin.php',534],['mod/assign','locallib.php',1880],['completion/criteria','completion_criteria_grade.php',185],['blocks/recent_activity','block_recent_activity.php',231],['completion/criteria','completion_criteria_activity.php',198],['enrol/paypal','lib.php',303],['completion/criteria','completion_criteria_duration.php',197],['blocks/rss_client','block_rss_client.php',262],['enrol/meta','lib.php',206]], 71],
'get_records_sql': ['get_records_sql', 'Get a number of records as an array of objects. ', [['lib/dml','pdo_moodle_database.php',309],['lib/dml','oci_native_moodle_database.php',1145],['lib/dml','pgsql_native_moodle_database.php',732],['lib/dml','mssql_native_moodle_database.php',805],['lib/dml','mysqli_native_moodle_database.php',1057],['lib/dml','sqlsrv_native_moodle_database.php',890],['lib/dml/tests','dml_test.php',5545]], 700],
'update_record': ['update_record', 'Update a record in a table ', [['lib/dml','pdo_moodle_database.php',461],['lib/dml','oci_native_moodle_database.php',1404],['lib/dml','pgsql_native_moodle_database.php',1089],['lib/dml','mssql_native_moodle_database.php',1067],['lib/dml','mysqli_native_moodle_database.php',1405],['lib/dml','sqlsrv_native_moodle_database.php',1148],['lib/dml/tests','dml_test.php',5551]], 650],
'update_enrolments': ['update_enrolments', 'Invoke this function _on_ the IDP to update it with enrolment info local to the SP right after calling user_authorise() ', [['auth/mnet','auth.php',474]], 0],
'end_local_sessions': ['end_local_sessions', 'To delete a host, we must delete all current sessions that users from that host are currently engaged in. ', [['auth/mnet','auth.php',1003]], 1],
'process_config': ['process_config', 'Processes and stores configuration data for this authentication plugin. ', [['auth/radius','auth.php',185],['auth/nntp','auth.php',121],['auth/email','auth.php',233],['backup/moodle2','restore_stepslib.php',2363],['auth/mnet','auth.php',690],['auth/imap','auth.php',158],['auth/webservice','auth.php',151],['auth/shibboleth','auth.php',242],['auth/pam','auth.php',133],['auth/manual','auth.php',203],['auth/none','auth.php',149],['auth/ldap','auth.php',1837],['lib','authlib.php',423],['auth/fc','auth.php',226],['auth/pop3','auth.php',154],['auth/cas','auth.php',284],['auth/db','auth.php',764]], 3],
'trim_logline': ['trim_logline', 'Trims a log line from mnet peer to limit each part to a length which can be stored in our DB ', [['auth/mnet','auth.php',1140]], 0],
'mnet_fields_to_send': ['mnet_fields_to_send', 'return an array of the profile fields to send with user information to the given mnet host. ', [['mnet','lib.php',844]], 2],
'clean_param': ['clean_param', 'Used by {@link optional_param()} and {@link required_param()} to clean the variables and/or cast to specific types, based on an options field. <code> $course->format = clean_param($course->format, PARAM_ALPHA); $selectedgradeitem = clean_param($selectedgradeitem, PARAM_INT); </code> ', [['lib','moodlelib.php',769]], 635],
'refresh_log': ['refresh_log', 'Receives an array of log entries from an SP and adds them to the mnet_log table ', [['auth/mnet','auth.php',777]], 2],
'mnet_strip_user': ['mnet_strip_user', 'given a user object (or array) and a list of allowed fields, strip out all the fields that should not be included. This can be used both for outgoing data and incoming data. ', [['mnet','lib.php',892]], 4],
'can_login_remotely': ['can_login_remotely', 'Checks the MNET access control table to see if the username/mnethost is permitted to login to this moodle. ', [['auth/mnet','auth.php',1112]], 1],
'delete_records': ['delete_records', 'Delete the records from a table where all the given conditions met. If conditions not specified, table is truncated. ', [['lib/dml','sqlite3_pdo_moodle_database.php',345],['lib/dml','moodle_database.php',1864]], 773],
'get_mnet_environment': ['get_mnet_environment', 'helper function to load up and initialise the mnet environment this must be called before you use mnet functions. ', [['lib','moodlelib.php',9446]], 14],
'list': ['list', '', [['mod/data/preset/imagegallery','jstemplate.js',9]], 2229],
'isloggedin': ['isloggedin', 'Determines if a user is currently logged in ', [['lib','accesslib.php',1910]], 184],
'confirm_mnet_session': ['confirm_mnet_session', 'This function confirms the remote (ID provider) host\'s mnet session by communicating the token and UA over the XMLRPC transport layer, and returns the local user record on success. ', [['auth/mnet','auth.php',216]], 1],
'isguestuser': ['isguestuser', 'Determines if a user is logged in as real guest user with username \'guest\'. ', [['lib','accesslib.php',1923]], 260],
'array_chunk': ['array_chunk', '', [], 14],
'substr': ['substr', '', [], 2823],
'explode': ['explode', '', [], 1572],
'rand': ['rand', '', [], 99],
'unlink': ['unlink', '', [], 256],
'count': ['count', '', [], 4095],
'is_numeric': ['is_numeric', '', [], 672],
'time': ['time', '', [], 1959],
'file_put_contents': ['file_put_contents', '', [], 94],
'array_values': ['array_values', '', [], 342],
'preg_quote': ['preg_quote', '', [], 205],
'implode': ['implode', '', [], 1281],
'array_pop': ['array_pop', '', [], 483],
'is_array': ['is_array', '', [], 1608],
'array_map': ['array_map', '', [], 169],
'session_id': ['session_id', '', [], 37],
'base64_encode': ['base64_encode', '', [], 134],
'is_null': ['is_null', '', [], 2003],
'ob_end_clean': ['ob_end_clean', '', [], 76],
'base64_decode': ['base64_decode', '', [], 92],
'stristr': ['stristr', '', [], 53],
'array_keys': ['array_keys', '', [], 1256],
'str_shuffle': ['str_shuffle', '', [], 7],
'ob_start': ['ob_start', '', [], 101],
'str_replace': ['str_replace', '', [], 1648],
'mt_rand': ['mt_rand', '', [], 47],
'array_key_exists': ['array_key_exists', '', [], 1445],
'reset': ['reset', '', [], 1213],
'sha1': ['sha1', '', [], 186],
'preg_replace': ['preg_replace', '', [], 917],
'urlencode': ['urlencode', '', [], 200],
'defined': ['defined', '', [], 4731],
'ini_get': ['ini_get', '', [], 121]};
CLASS_DATA={
'moodle_url': ['moodle_url', 'Class for creating and manipulating urls. ', [['lib','weblib.php',238]], 3088],
'mnet_xmlrpc_client': ['mnet_xmlrpc_client', 'Class representing an XMLRPC request against a remote machine ', [['mnet/xmlrpc','client.php',13]], 17],
'moodle_exception': ['moodle_exception', 'Base Moodle Exception class ', [['lib','setuplib.php',75]], 606],
'manager': ['manager', 'Search subsystem manager. ', [['search/classes','manager.php',31],['user/classes/output/myprofile','manager.php',28],['lib/classes/antivirus','manager.php',29],['lib/classes/event','manager.php',30],['lib/classes/task','manager.php',28],['admin/tool/messageinbound/classes','manager.php',29],['lib/classes/message/inbound','manager.php',29],['admin/tool/log/classes/log','manager.php',29],['lib/classes/log','manager.php',29],['lib/classes/session','manager.php',29],['lib/classes/message','manager.php',31]], 585],
'context_user': ['context_user', 'User context class ', [['lib','accesslib.php',6398]], 414],
'context_system': ['context_system', 'System context class ', [['lib','accesslib.php',6157]], 1147],
'auth_plugin_base': ['auth_plugin_base', 'Abstract authentication plugin. ', [['lib','authlib.php',82]], 17],
'mnet_peer': ['mnet_peer', '', [['mnet','peer.php',13]], 28],
'mnet_server_exception': ['mnet_server_exception', 'mnet server exception.  extends moodle_exception, but takes slightly different arguments. and unlike the rest of moodle, the actual int error code is used. this exception should only be used during an xmlrpc server request, ie, not for client requests. ', [['mnet/xmlrpc','serverlib.php',661]], 44],
'auth_plugin_mnet': ['auth_plugin_mnet', 'Moodle Network authentication plugin. ', [['auth/mnet','auth.php',30]], 2],
'pix_icon': ['pix_icon', 'Data structure representing an icon. ', [['lib','outputcomponents.php',497]], 275]};
CONST_DATA={
'DEBUG_DEVELOPER': ['DEBUG_DEVELOPER', '', [['lib','setuplib.php',40]], 736],
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',140],['','install.php',93],['lib','setup.php',391]], 4153],
'PARAM_ALPHANUM': ['PARAM_ALPHANUM', '', [['lib','moodlelib.php',88]], 112],
'MNET_SERVER': ['MNET_SERVER', '', [['mnet/xmlrpc','server.php',18]], 5],
'PARAM_INT': ['PARAM_INT', '', [['lib','moodlelib.php',156]], 3812],
'PARAM_LANG': ['PARAM_LANG', '', [['lib','moodlelib.php',161]], 19],
'PARAM_URL': ['PARAM_URL', '', [['lib','moodlelib.php',239]], 165],
'MUST_EXIST': ['MUST_EXIST', '', [['lib','dmllib.php',52]], 1384]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Aug 11 10:00:09 2016</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
