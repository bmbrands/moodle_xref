<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /report/security/locallib.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu May 28 19:17:31 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='report/security';
filename='locallib.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/report/security/</a> -> <a href="locallib.php.html">locallib.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="locallib.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="locallib.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * Lib functions</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * @package    report</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @subpackage security</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @copyright  2008 petr Skoda</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> */</span>
<a name="l25"><span class="linenum">  25</span></a>  
<a name="l26"><span class="linenum">  26</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die;
<a name="l27"><span class="linenum">  27</span></a>  
<a name="l28"><span class="linenum">  28</span></a>  
<a name="l29"><span class="linenum">  29</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('REPORT_SECURITY_OK')" href="../../_constants/REPORT_SECURITY_OK.html" onMouseOver="constPopup(event,'REPORT_SECURITY_OK')">REPORT_SECURITY_OK</a>', 'ok');
<a name="l30"><span class="linenum">  30</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('REPORT_SECURITY_INFO')" href="../../_constants/REPORT_SECURITY_INFO.html" onMouseOver="constPopup(event,'REPORT_SECURITY_INFO')">REPORT_SECURITY_INFO</a>', 'info');
<a name="l31"><span class="linenum">  31</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('REPORT_SECURITY_WARNING')" href="../../_constants/REPORT_SECURITY_WARNING.html" onMouseOver="constPopup(event,'REPORT_SECURITY_WARNING')">REPORT_SECURITY_WARNING</a>', 'warning');
<a name="l32"><span class="linenum">  32</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('REPORT_SECURITY_SERIOUS')" href="../../_constants/REPORT_SECURITY_SERIOUS.html" onMouseOver="constPopup(event,'REPORT_SECURITY_SERIOUS')">REPORT_SECURITY_SERIOUS</a>', 'serious');
<a name="l33"><span class="linenum">  33</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('REPORT_SECURITY_CRITICAL')" href="../../_constants/REPORT_SECURITY_CRITICAL.html" onMouseOver="constPopup(event,'REPORT_SECURITY_CRITICAL')">REPORT_SECURITY_CRITICAL</a>', 'critical');
<a name="l34"><span class="linenum">  34</span></a>  
<a name="l35"><span class="linenum">  35</span></a>  function <a class="function" onClick="logFunction('report_security_hide_timearning')" href="../../_functions/report_security_hide_timearning.html" onMouseOver="funcPopup(event,'report_security_hide_timearning')">report_security_hide_timearning</a>() {
<a name="l36"><span class="linenum">  36</span></a>       global <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>;
<a name="l37"><span class="linenum">  37</span></a>       <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a onClick="logVariable('requires')" class="var it39443" onMouseOver="hilite(39443)" onMouseOut="lolite()" href="../../_variables/requires.html">requires</a>-&gt;<a class="function" onClick="logFunction('js_init_code')" href="../../_functions/js_init_code.html" onMouseOver="funcPopup(event,'js_init_code')">js_init_code</a>(&quot;Y.one('#timewarning').<a class="function" onClick="logFunction('addClass')" href="../../_functions/addclass.html" onMouseOver="funcPopup(event,'addclass')">addClass</a>('timewarninghidden')&quot;);
<a name="l38"><span class="linenum">  38</span></a>  }
<a name="l39"><span class="linenum">  39</span></a>  
<a name="l40"><span class="linenum">  40</span></a>  function <a class="function" onClick="logFunction('report_security_get_issue_list')" href="../../_functions/report_security_get_issue_list.html" onMouseOver="funcPopup(event,'report_security_get_issue_list')">report_security_get_issue_list</a>() {
<a name="l41"><span class="linenum">  41</span></a>      return array(
<a name="l42"><span class="linenum">  42</span></a>          'report_security_check_unsecuredataroot',
<a name="l43"><span class="linenum">  43</span></a>          'report_security_check_displayerrors',
<a name="l44"><span class="linenum">  44</span></a>          'report_security_check_noauth',
<a name="l45"><span class="linenum">  45</span></a>          'report_security_check_embed',
<a name="l46"><span class="linenum">  46</span></a>          'report_security_check_mediafilterswf',
<a name="l47"><span class="linenum">  47</span></a>          'report_security_check_openprofiles',
<a name="l48"><span class="linenum">  48</span></a>          'report_security_check_google',
<a name="l49"><span class="linenum">  49</span></a>          'report_security_check_passwordpolicy',
<a name="l50"><span class="linenum">  50</span></a>          'report_security_check_emailchangeconfirmation',
<a name="l51"><span class="linenum">  51</span></a>          'report_security_check_cookiesecure',
<a name="l52"><span class="linenum">  52</span></a>          'report_security_check_configrw',
<a name="l53"><span class="linenum">  53</span></a>          'report_security_check_riskxss',
<a name="l54"><span class="linenum">  54</span></a>          'report_security_check_riskadmin',
<a name="l55"><span class="linenum">  55</span></a>          'report_security_check_riskbackup',
<a name="l56"><span class="linenum">  56</span></a>          'report_security_check_defaultuserrole',
<a name="l57"><span class="linenum">  57</span></a>          'report_security_check_guestrole',
<a name="l58"><span class="linenum">  58</span></a>          'report_security_check_frontpagerole',
<a name="l59"><span class="linenum">  59</span></a>          'report_security_check_webcron',
<a name="l60"><span class="linenum">  60</span></a>  
<a name="l61"><span class="linenum">  61</span></a>      );
<a name="l62"><span class="linenum">  62</span></a>  }
<a name="l63"><span class="linenum">  63</span></a>  
<a name="l64"><span class="linenum">  64</span></a>  function <a class="function" onClick="logFunction('report_security_doc_link')" href="../../_functions/report_security_doc_link.html" onMouseOver="funcPopup(event,'report_security_doc_link')">report_security_doc_link</a>(<a class="var it16414" onMouseOver="hilite(16414)" onMouseOut="lolite()" onClick="logVariable('issue')" href="../../_variables/issue.html">$issue</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>) {
<a name="l65"><span class="linenum">  65</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>;
<a name="l66"><span class="linenum">  66</span></a>  
<a name="l67"><span class="linenum">  67</span></a>      if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('docroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/docroot.html">docroot</a>)) {
<a name="l68"><span class="linenum">  68</span></a>          return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>;
<a name="l69"><span class="linenum">  69</span></a>      }
<a name="l70"><span class="linenum">  70</span></a>  
<a name="l71"><span class="linenum">  71</span></a>      return <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('doc_link')" href="../../_functions/doc_link.html" onMouseOver="funcPopup(event,'doc_link')">doc_link</a>('report/security/'.<a class="var it16414" onMouseOver="hilite(16414)" onMouseOut="lolite()" onClick="logVariable('issue')" href="../../_variables/issue.html">$issue</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>);
<a name="l72"><span class="linenum">  72</span></a>  }
<a name="l73"><span class="linenum">  73</span></a>  
<a name="l74"><span class="linenum">  74</span></a>  <span class="comment">///=============================================</span>
<a name="l75"><span class="linenum">  75</span></a>  <span class="comment">///               Issue checks</span>
<a name="l76"><span class="linenum">  76</span></a>  <span class="comment">///=============================================</span>
<a name="l77"><span class="linenum">  77</span></a>  
<a name="l78"><span class="linenum">  78</span></a>  
<a name="l79"><span class="linenum">  79</span></a>  <span class="comment">/**</span>
<a name="l80"><span class="linenum">  80</span></a>  <span class="comment"> * Verifies unsupported noauth setting</span>
<a name="l81"><span class="linenum">  81</span></a>  <span class="comment"> * @param bool $detailed</span>
<a name="l82"><span class="linenum">  82</span></a>  <span class="comment"> * @return object result</span>
<a name="l83"><span class="linenum">  83</span></a>  <span class="comment"> */</span>
<a name="l84"><span class="linenum">  84</span></a>  function <a class="function" onClick="logFunction('report_security_check_noauth')" href="../../_functions/report_security_check_noauth.html" onMouseOver="funcPopup(event,'report_security_check_noauth')">report_security_check_noauth</a>(<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>=false) {
<a name="l85"><span class="linenum">  85</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l86"><span class="linenum">  86</span></a>  
<a name="l87"><span class="linenum">  87</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = new stdClass();
<a name="l88"><span class="linenum">  88</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('issue')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/issue.html">issue</a>   = 'report_security_check_noauth';
<a name="l89"><span class="linenum">  89</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('name')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_noauth_name', 'report_security');
<a name="l90"><span class="linenum">  90</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = null;
<a name="l91"><span class="linenum">  91</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = null;
<a name="l92"><span class="linenum">  92</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = null;
<a name="l93"><span class="linenum">  93</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('link')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/link.html">link</a>    = null;
<a name="l94"><span class="linenum">  94</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('link')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/link.html">link</a>    = &quot;&lt;a href=\&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>/<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('admin')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/admin.html">admin</a>/settings.php?section=manageauths\&quot;&gt;&quot;.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('authsettings', 'admin').'&lt;/a&gt;';
<a name="l95"><span class="linenum">  95</span></a>  
<a name="l96"><span class="linenum">  96</span></a>      if (<a class="function" onClick="logFunction('is_enabled_auth')" href="../../_functions/is_enabled_auth.html" onMouseOver="funcPopup(event,'is_enabled_auth')">is_enabled_auth</a>('none')) {
<a name="l97"><span class="linenum">  97</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_CRITICAL')" href="../../_constants/REPORT_SECURITY_CRITICAL.html" onMouseOver="constPopup(event,'REPORT_SECURITY_CRITICAL')">REPORT_SECURITY_CRITICAL</a>;
<a name="l98"><span class="linenum">  98</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_noauth_error', 'report_security');
<a name="l99"><span class="linenum">  99</span></a>      } else {
<a name="l100"><span class="linenum"> 100</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_OK')" href="../../_constants/REPORT_SECURITY_OK.html" onMouseOver="constPopup(event,'REPORT_SECURITY_OK')">REPORT_SECURITY_OK</a>;
<a name="l101"><span class="linenum"> 101</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_noauth_ok', 'report_security');
<a name="l102"><span class="linenum"> 102</span></a>      }
<a name="l103"><span class="linenum"> 103</span></a>  
<a name="l104"><span class="linenum"> 104</span></a>      if (<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>) {
<a name="l105"><span class="linenum"> 105</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_noauth_details', 'report_security');
<a name="l106"><span class="linenum"> 106</span></a>      }
<a name="l107"><span class="linenum"> 107</span></a>  
<a name="l108"><span class="linenum"> 108</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l109"><span class="linenum"> 109</span></a>  }
<a name="l110"><span class="linenum"> 110</span></a>  
<a name="l111"><span class="linenum"> 111</span></a>  <span class="comment">/**</span>
<a name="l112"><span class="linenum"> 112</span></a>  <span class="comment"> * Verifies if password policy set</span>
<a name="l113"><span class="linenum"> 113</span></a>  <span class="comment"> * @param bool $detailed</span>
<a name="l114"><span class="linenum"> 114</span></a>  <span class="comment"> * @return object result</span>
<a name="l115"><span class="linenum"> 115</span></a>  <span class="comment"> */</span>
<a name="l116"><span class="linenum"> 116</span></a>  function <a class="function" onClick="logFunction('report_security_check_passwordpolicy')" href="../../_functions/report_security_check_passwordpolicy.html" onMouseOver="funcPopup(event,'report_security_check_passwordpolicy')">report_security_check_passwordpolicy</a>(<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>=false) {
<a name="l117"><span class="linenum"> 117</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l118"><span class="linenum"> 118</span></a>  
<a name="l119"><span class="linenum"> 119</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = new stdClass();
<a name="l120"><span class="linenum"> 120</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('issue')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/issue.html">issue</a>   = 'report_security_check_passwordpolicy';
<a name="l121"><span class="linenum"> 121</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('name')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_passwordpolicy_name', 'report_security');
<a name="l122"><span class="linenum"> 122</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = null;
<a name="l123"><span class="linenum"> 123</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = null;
<a name="l124"><span class="linenum"> 124</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = null;
<a name="l125"><span class="linenum"> 125</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('link')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/link.html">link</a>    = &quot;&lt;a href=\&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>/<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('admin')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/admin.html">admin</a>/settings.php?section=sitepolicies\&quot;&gt;&quot;.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('sitepolicies', 'admin').'&lt;/a&gt;';
<a name="l126"><span class="linenum"> 126</span></a>  
<a name="l127"><span class="linenum"> 127</span></a>      if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('passwordpolicy')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/passwordpolicy.html">passwordpolicy</a>)) {
<a name="l128"><span class="linenum"> 128</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_WARNING')" href="../../_constants/REPORT_SECURITY_WARNING.html" onMouseOver="constPopup(event,'REPORT_SECURITY_WARNING')">REPORT_SECURITY_WARNING</a>;
<a name="l129"><span class="linenum"> 129</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_passwordpolicy_error', 'report_security');
<a name="l130"><span class="linenum"> 130</span></a>      } else {
<a name="l131"><span class="linenum"> 131</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_OK')" href="../../_constants/REPORT_SECURITY_OK.html" onMouseOver="constPopup(event,'REPORT_SECURITY_OK')">REPORT_SECURITY_OK</a>;
<a name="l132"><span class="linenum"> 132</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_passwordpolicy_ok', 'report_security');
<a name="l133"><span class="linenum"> 133</span></a>      }
<a name="l134"><span class="linenum"> 134</span></a>  
<a name="l135"><span class="linenum"> 135</span></a>      if (<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>) {
<a name="l136"><span class="linenum"> 136</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_passwordpolicy_details', 'report_security');
<a name="l137"><span class="linenum"> 137</span></a>      }
<a name="l138"><span class="linenum"> 138</span></a>  
<a name="l139"><span class="linenum"> 139</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l140"><span class="linenum"> 140</span></a>  }
<a name="l141"><span class="linenum"> 141</span></a>  
<a name="l142"><span class="linenum"> 142</span></a>  <span class="comment">/**</span>
<a name="l143"><span class="linenum"> 143</span></a>  <span class="comment"> * Verifies sloppy embedding - this should have been removed long ago!!</span>
<a name="l144"><span class="linenum"> 144</span></a>  <span class="comment"> * @param bool $detailed</span>
<a name="l145"><span class="linenum"> 145</span></a>  <span class="comment"> * @return object result</span>
<a name="l146"><span class="linenum"> 146</span></a>  <span class="comment"> */</span>
<a name="l147"><span class="linenum"> 147</span></a>  function <a class="function" onClick="logFunction('report_security_check_embed')" href="../../_functions/report_security_check_embed.html" onMouseOver="funcPopup(event,'report_security_check_embed')">report_security_check_embed</a>(<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>=false) {
<a name="l148"><span class="linenum"> 148</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l149"><span class="linenum"> 149</span></a>  
<a name="l150"><span class="linenum"> 150</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = new stdClass();
<a name="l151"><span class="linenum"> 151</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('issue')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/issue.html">issue</a>   = 'report_security_check_embed';
<a name="l152"><span class="linenum"> 152</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('name')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_embed_name', 'report_security');
<a name="l153"><span class="linenum"> 153</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = null;
<a name="l154"><span class="linenum"> 154</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = null;
<a name="l155"><span class="linenum"> 155</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = null;
<a name="l156"><span class="linenum"> 156</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('link')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/link.html">link</a>    = &quot;&lt;a href=\&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>/<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('admin')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/admin.html">admin</a>/settings.php?section=sitepolicies\&quot;&gt;&quot;.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('sitepolicies', 'admin').'&lt;/a&gt;';
<a name="l157"><span class="linenum"> 157</span></a>  
<a name="l158"><span class="linenum"> 158</span></a>      if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('allowobjectembed')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/allowobjectembed.html">allowobjectembed</a>)) {
<a name="l159"><span class="linenum"> 159</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_CRITICAL')" href="../../_constants/REPORT_SECURITY_CRITICAL.html" onMouseOver="constPopup(event,'REPORT_SECURITY_CRITICAL')">REPORT_SECURITY_CRITICAL</a>;
<a name="l160"><span class="linenum"> 160</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_embed_error', 'report_security');
<a name="l161"><span class="linenum"> 161</span></a>      } else {
<a name="l162"><span class="linenum"> 162</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_OK')" href="../../_constants/REPORT_SECURITY_OK.html" onMouseOver="constPopup(event,'REPORT_SECURITY_OK')">REPORT_SECURITY_OK</a>;
<a name="l163"><span class="linenum"> 163</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_embed_ok', 'report_security');
<a name="l164"><span class="linenum"> 164</span></a>      }
<a name="l165"><span class="linenum"> 165</span></a>  
<a name="l166"><span class="linenum"> 166</span></a>      if (<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>) {
<a name="l167"><span class="linenum"> 167</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_embed_details', 'report_security');
<a name="l168"><span class="linenum"> 168</span></a>      }
<a name="l169"><span class="linenum"> 169</span></a>  
<a name="l170"><span class="linenum"> 170</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l171"><span class="linenum"> 171</span></a>  }
<a name="l172"><span class="linenum"> 172</span></a>  
<a name="l173"><span class="linenum"> 173</span></a>  <span class="comment">/**</span>
<a name="l174"><span class="linenum"> 174</span></a>  <span class="comment"> * Verifies sloppy swf embedding - this should have been removed long ago!!</span>
<a name="l175"><span class="linenum"> 175</span></a>  <span class="comment"> * @param bool $detailed</span>
<a name="l176"><span class="linenum"> 176</span></a>  <span class="comment"> * @return object result</span>
<a name="l177"><span class="linenum"> 177</span></a>  <span class="comment"> */</span>
<a name="l178"><span class="linenum"> 178</span></a>  function <a class="function" onClick="logFunction('report_security_check_mediafilterswf')" href="../../_functions/report_security_check_mediafilterswf.html" onMouseOver="funcPopup(event,'report_security_check_mediafilterswf')">report_security_check_mediafilterswf</a>(<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>=false) {
<a name="l179"><span class="linenum"> 179</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l180"><span class="linenum"> 180</span></a>  
<a name="l181"><span class="linenum"> 181</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = new stdClass();
<a name="l182"><span class="linenum"> 182</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('issue')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/issue.html">issue</a>   = 'report_security_check_mediafilterswf';
<a name="l183"><span class="linenum"> 183</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('name')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_mediafilterswf_name', 'report_security');
<a name="l184"><span class="linenum"> 184</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = null;
<a name="l185"><span class="linenum"> 185</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = null;
<a name="l186"><span class="linenum"> 186</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = null;
<a name="l187"><span class="linenum"> 187</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('link')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/link.html">link</a>    = &quot;&lt;a href=\&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>/<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('admin')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/admin.html">admin</a>/settings.php?section=filtersettingfiltermediaplugin\&quot;&gt;&quot;.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('filtersettings', 'admin').'&lt;/a&gt;';
<a name="l188"><span class="linenum"> 188</span></a>  
<a name="l189"><span class="linenum"> 189</span></a>      <a class="var it16416" onMouseOver="hilite(16416)" onMouseOut="lolite()" onClick="logVariable('activefilters')" href="../../_variables/activefilters.html">$activefilters</a> = <a class="function" onClick="logFunction('filter_get_globally_enabled')" href="../../_functions/filter_get_globally_enabled.html" onMouseOver="funcPopup(event,'filter_get_globally_enabled')">filter_get_globally_enabled</a>();
<a name="l190"><span class="linenum"> 190</span></a>  
<a name="l191"><span class="linenum"> 191</span></a>      if (<a class="phpfunction" onClick="logFunction('array_search')" href="../../_functions/array_search.html" onMouseOver="phpfuncPopup(event,'array_search')">array_search</a>('mediaplugin', <a class="var it16416" onMouseOver="hilite(16416)" onMouseOut="lolite()" onClick="logVariable('activefilters')" href="../../_variables/activefilters.html">$activefilters</a>) !== false and !empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('filter_mediaplugin_enable_swf')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/filter_mediaplugin_enable_swf.html">filter_mediaplugin_enable_swf</a>)) {
<a name="l192"><span class="linenum"> 192</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_CRITICAL')" href="../../_constants/REPORT_SECURITY_CRITICAL.html" onMouseOver="constPopup(event,'REPORT_SECURITY_CRITICAL')">REPORT_SECURITY_CRITICAL</a>;
<a name="l193"><span class="linenum"> 193</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_mediafilterswf_error', 'report_security');
<a name="l194"><span class="linenum"> 194</span></a>      } else {
<a name="l195"><span class="linenum"> 195</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_OK')" href="../../_constants/REPORT_SECURITY_OK.html" onMouseOver="constPopup(event,'REPORT_SECURITY_OK')">REPORT_SECURITY_OK</a>;
<a name="l196"><span class="linenum"> 196</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_mediafilterswf_ok', 'report_security');
<a name="l197"><span class="linenum"> 197</span></a>      }
<a name="l198"><span class="linenum"> 198</span></a>  
<a name="l199"><span class="linenum"> 199</span></a>      if (<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>) {
<a name="l200"><span class="linenum"> 200</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_mediafilterswf_details', 'report_security');
<a name="l201"><span class="linenum"> 201</span></a>      }
<a name="l202"><span class="linenum"> 202</span></a>  
<a name="l203"><span class="linenum"> 203</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l204"><span class="linenum"> 204</span></a>  }
<a name="l205"><span class="linenum"> 205</span></a>  
<a name="l206"><span class="linenum"> 206</span></a>  <span class="comment">/**</span>
<a name="l207"><span class="linenum"> 207</span></a>  <span class="comment"> * Verifies fatal misconfiguration of dataroot</span>
<a name="l208"><span class="linenum"> 208</span></a>  <span class="comment"> * @param bool $detailed</span>
<a name="l209"><span class="linenum"> 209</span></a>  <span class="comment"> * @return object result</span>
<a name="l210"><span class="linenum"> 210</span></a>  <span class="comment"> */</span>
<a name="l211"><span class="linenum"> 211</span></a>  function <a class="function" onClick="logFunction('report_security_check_unsecuredataroot')" href="../../_functions/report_security_check_unsecuredataroot.html" onMouseOver="funcPopup(event,'report_security_check_unsecuredataroot')">report_security_check_unsecuredataroot</a>(<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>=false) {
<a name="l212"><span class="linenum"> 212</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l213"><span class="linenum"> 213</span></a>  
<a name="l214"><span class="linenum"> 214</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = new stdClass();
<a name="l215"><span class="linenum"> 215</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('issue')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/issue.html">issue</a>   = 'report_security_check_unsecuredataroot';
<a name="l216"><span class="linenum"> 216</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('name')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_unsecuredataroot_name', 'report_security');
<a name="l217"><span class="linenum"> 217</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = null;
<a name="l218"><span class="linenum"> 218</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = null;
<a name="l219"><span class="linenum"> 219</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = null;
<a name="l220"><span class="linenum"> 220</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('link')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/link.html">link</a>    = null;
<a name="l221"><span class="linenum"> 221</span></a>  
<a name="l222"><span class="linenum"> 222</span></a>      <a class="var it11210" onMouseOver="hilite(11210)" onMouseOut="lolite()" onClick="logVariable('insecuredataroot')" href="../../_variables/insecuredataroot.html">$insecuredataroot</a> = <a class="function" onClick="logFunction('is_dataroot_insecure')" href="../../_functions/is_dataroot_insecure.html" onMouseOver="funcPopup(event,'is_dataroot_insecure')">is_dataroot_insecure</a>(true);
<a name="l223"><span class="linenum"> 223</span></a>  
<a name="l224"><span class="linenum"> 224</span></a>      if (<a class="var it11210" onMouseOver="hilite(11210)" onMouseOut="lolite()" onClick="logVariable('insecuredataroot')" href="../../_variables/insecuredataroot.html">$insecuredataroot</a> == <a class="constant" onClick="logConstant('INSECURE_DATAROOT_WARNING')" href="../../_constants/INSECURE_DATAROOT_WARNING.html" onMouseOver="constPopup(event,'INSECURE_DATAROOT_WARNING')">INSECURE_DATAROOT_WARNING</a>) {
<a name="l225"><span class="linenum"> 225</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_SERIOUS')" href="../../_constants/REPORT_SECURITY_SERIOUS.html" onMouseOver="constPopup(event,'REPORT_SECURITY_SERIOUS')">REPORT_SECURITY_SERIOUS</a>;
<a name="l226"><span class="linenum"> 226</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_unsecuredataroot_warning', 'report_security', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dataroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/dataroot.html">dataroot</a>);
<a name="l227"><span class="linenum"> 227</span></a>  
<a name="l228"><span class="linenum"> 228</span></a>      } else if (<a class="var it11210" onMouseOver="hilite(11210)" onMouseOut="lolite()" onClick="logVariable('insecuredataroot')" href="../../_variables/insecuredataroot.html">$insecuredataroot</a> == <a class="constant" onClick="logConstant('INSECURE_DATAROOT_ERROR')" href="../../_constants/INSECURE_DATAROOT_ERROR.html" onMouseOver="constPopup(event,'INSECURE_DATAROOT_ERROR')">INSECURE_DATAROOT_ERROR</a>) {
<a name="l229"><span class="linenum"> 229</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_CRITICAL')" href="../../_constants/REPORT_SECURITY_CRITICAL.html" onMouseOver="constPopup(event,'REPORT_SECURITY_CRITICAL')">REPORT_SECURITY_CRITICAL</a>;
<a name="l230"><span class="linenum"> 230</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_unsecuredataroot_error', 'report_security', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dataroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/dataroot.html">dataroot</a>);
<a name="l231"><span class="linenum"> 231</span></a>  
<a name="l232"><span class="linenum"> 232</span></a>      } else {
<a name="l233"><span class="linenum"> 233</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_OK')" href="../../_constants/REPORT_SECURITY_OK.html" onMouseOver="constPopup(event,'REPORT_SECURITY_OK')">REPORT_SECURITY_OK</a>;
<a name="l234"><span class="linenum"> 234</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_unsecuredataroot_ok', 'report_security');
<a name="l235"><span class="linenum"> 235</span></a>      }
<a name="l236"><span class="linenum"> 236</span></a>  
<a name="l237"><span class="linenum"> 237</span></a>      if (<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>) {
<a name="l238"><span class="linenum"> 238</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_unsecuredataroot_details', 'report_security');
<a name="l239"><span class="linenum"> 239</span></a>      }
<a name="l240"><span class="linenum"> 240</span></a>  
<a name="l241"><span class="linenum"> 241</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l242"><span class="linenum"> 242</span></a>  }
<a name="l243"><span class="linenum"> 243</span></a>  
<a name="l244"><span class="linenum"> 244</span></a>  <span class="comment">/**</span>
<a name="l245"><span class="linenum"> 245</span></a>  <span class="comment"> * Verifies displaying of errors - problem for lib files and 3rd party code</span>
<a name="l246"><span class="linenum"> 246</span></a>  <span class="comment"> * because we can not disable debugging in these scripts (they do not include config.php)</span>
<a name="l247"><span class="linenum"> 247</span></a>  <span class="comment"> * @param bool $detailed</span>
<a name="l248"><span class="linenum"> 248</span></a>  <span class="comment"> * @return object result</span>
<a name="l249"><span class="linenum"> 249</span></a>  <span class="comment"> */</span>
<a name="l250"><span class="linenum"> 250</span></a>  function <a class="function" onClick="logFunction('report_security_check_displayerrors')" href="../../_functions/report_security_check_displayerrors.html" onMouseOver="funcPopup(event,'report_security_check_displayerrors')">report_security_check_displayerrors</a>(<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>=false) {
<a name="l251"><span class="linenum"> 251</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = new stdClass();
<a name="l252"><span class="linenum"> 252</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('issue')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/issue.html">issue</a>   = 'report_security_check_displayerrors';
<a name="l253"><span class="linenum"> 253</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('name')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_displayerrors_name', 'report_security');
<a name="l254"><span class="linenum"> 254</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = null;
<a name="l255"><span class="linenum"> 255</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = null;
<a name="l256"><span class="linenum"> 256</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = null;
<a name="l257"><span class="linenum"> 257</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('link')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/link.html">link</a>    = null;
<a name="l258"><span class="linenum"> 258</span></a>  
<a name="l259"><span class="linenum"> 259</span></a>      if (<a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('WARN_DISPLAY_ERRORS_ENABLED')" href="../../_constants/WARN_DISPLAY_ERRORS_ENABLED.html" onMouseOver="constPopup(event,'WARN_DISPLAY_ERRORS_ENABLED')">WARN_DISPLAY_ERRORS_ENABLED</a>')) {
<a name="l260"><span class="linenum"> 260</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_WARNING')" href="../../_constants/REPORT_SECURITY_WARNING.html" onMouseOver="constPopup(event,'REPORT_SECURITY_WARNING')">REPORT_SECURITY_WARNING</a>;
<a name="l261"><span class="linenum"> 261</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_displayerrors_error', 'report_security');
<a name="l262"><span class="linenum"> 262</span></a>      } else {
<a name="l263"><span class="linenum"> 263</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_OK')" href="../../_constants/REPORT_SECURITY_OK.html" onMouseOver="constPopup(event,'REPORT_SECURITY_OK')">REPORT_SECURITY_OK</a>;
<a name="l264"><span class="linenum"> 264</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_displayerrors_ok', 'report_security');
<a name="l265"><span class="linenum"> 265</span></a>      }
<a name="l266"><span class="linenum"> 266</span></a>  
<a name="l267"><span class="linenum"> 267</span></a>      if (<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>) {
<a name="l268"><span class="linenum"> 268</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_displayerrors_details', 'report_security');
<a name="l269"><span class="linenum"> 269</span></a>      }
<a name="l270"><span class="linenum"> 270</span></a>  
<a name="l271"><span class="linenum"> 271</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l272"><span class="linenum"> 272</span></a>  }
<a name="l273"><span class="linenum"> 273</span></a>  
<a name="l274"><span class="linenum"> 274</span></a>  <span class="comment">/**</span>
<a name="l275"><span class="linenum"> 275</span></a>  <span class="comment"> * Verifies open profiles - originally open by default, not anymore because spammer abused it a lot</span>
<a name="l276"><span class="linenum"> 276</span></a>  <span class="comment"> * @param bool $detailed</span>
<a name="l277"><span class="linenum"> 277</span></a>  <span class="comment"> * @return object result</span>
<a name="l278"><span class="linenum"> 278</span></a>  <span class="comment"> */</span>
<a name="l279"><span class="linenum"> 279</span></a>  function <a class="function" onClick="logFunction('report_security_check_openprofiles')" href="../../_functions/report_security_check_openprofiles.html" onMouseOver="funcPopup(event,'report_security_check_openprofiles')">report_security_check_openprofiles</a>(<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>=false) {
<a name="l280"><span class="linenum"> 280</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l281"><span class="linenum"> 281</span></a>  
<a name="l282"><span class="linenum"> 282</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = new stdClass();
<a name="l283"><span class="linenum"> 283</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('issue')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/issue.html">issue</a>   = 'report_security_check_openprofiles';
<a name="l284"><span class="linenum"> 284</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('name')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_openprofiles_name', 'report_security');
<a name="l285"><span class="linenum"> 285</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = null;
<a name="l286"><span class="linenum"> 286</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = null;
<a name="l287"><span class="linenum"> 287</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = null;
<a name="l288"><span class="linenum"> 288</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('link')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/link.html">link</a>    = &quot;&lt;a href=\&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>/<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('admin')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/admin.html">admin</a>/settings.php?section=sitepolicies\&quot;&gt;&quot;.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('sitepolicies', 'admin').'&lt;/a&gt;';
<a name="l289"><span class="linenum"> 289</span></a>  
<a name="l290"><span class="linenum"> 290</span></a>      if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('forcelogin')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/forcelogin.html">forcelogin</a>) and empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('forceloginforprofiles')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/forceloginforprofiles.html">forceloginforprofiles</a>)) {
<a name="l291"><span class="linenum"> 291</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_WARNING')" href="../../_constants/REPORT_SECURITY_WARNING.html" onMouseOver="constPopup(event,'REPORT_SECURITY_WARNING')">REPORT_SECURITY_WARNING</a>;
<a name="l292"><span class="linenum"> 292</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_openprofiles_error', 'report_security');
<a name="l293"><span class="linenum"> 293</span></a>      } else {
<a name="l294"><span class="linenum"> 294</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_OK')" href="../../_constants/REPORT_SECURITY_OK.html" onMouseOver="constPopup(event,'REPORT_SECURITY_OK')">REPORT_SECURITY_OK</a>;
<a name="l295"><span class="linenum"> 295</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_openprofiles_ok', 'report_security');
<a name="l296"><span class="linenum"> 296</span></a>      }
<a name="l297"><span class="linenum"> 297</span></a>  
<a name="l298"><span class="linenum"> 298</span></a>      if (<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>) {
<a name="l299"><span class="linenum"> 299</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_openprofiles_details', 'report_security');
<a name="l300"><span class="linenum"> 300</span></a>      }
<a name="l301"><span class="linenum"> 301</span></a>  
<a name="l302"><span class="linenum"> 302</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l303"><span class="linenum"> 303</span></a>  }
<a name="l304"><span class="linenum"> 304</span></a>  
<a name="l305"><span class="linenum"> 305</span></a>  <span class="comment">/**</span>
<a name="l306"><span class="linenum"> 306</span></a>  <span class="comment"> * Verifies google access not combined with disabled guest access</span>
<a name="l307"><span class="linenum"> 307</span></a>  <span class="comment"> * because attackers might gain guest access by modifying browser signature.</span>
<a name="l308"><span class="linenum"> 308</span></a>  <span class="comment"> * @param bool $detailed</span>
<a name="l309"><span class="linenum"> 309</span></a>  <span class="comment"> * @return object result</span>
<a name="l310"><span class="linenum"> 310</span></a>  <span class="comment"> */</span>
<a name="l311"><span class="linenum"> 311</span></a>  function <a class="function" onClick="logFunction('report_security_check_google')" href="../../_functions/report_security_check_google.html" onMouseOver="funcPopup(event,'report_security_check_google')">report_security_check_google</a>(<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>=false) {
<a name="l312"><span class="linenum"> 312</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l313"><span class="linenum"> 313</span></a>  
<a name="l314"><span class="linenum"> 314</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = new stdClass();
<a name="l315"><span class="linenum"> 315</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('issue')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/issue.html">issue</a>   = 'report_security_check_google';
<a name="l316"><span class="linenum"> 316</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('name')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_google_name', 'report_security');
<a name="l317"><span class="linenum"> 317</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = null;
<a name="l318"><span class="linenum"> 318</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = null;
<a name="l319"><span class="linenum"> 319</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = null;
<a name="l320"><span class="linenum"> 320</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('link')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/link.html">link</a>    = &quot;&lt;a href=\&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>/<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('admin')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/admin.html">admin</a>/settings.php?section=sitepolicies\&quot;&gt;&quot;.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('sitepolicies', 'admin').'&lt;/a&gt;';
<a name="l321"><span class="linenum"> 321</span></a>  
<a name="l322"><span class="linenum"> 322</span></a>      if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('opentogoogle')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/opentogoogle.html">opentogoogle</a>)) {
<a name="l323"><span class="linenum"> 323</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_OK')" href="../../_constants/REPORT_SECURITY_OK.html" onMouseOver="constPopup(event,'REPORT_SECURITY_OK')">REPORT_SECURITY_OK</a>;
<a name="l324"><span class="linenum"> 324</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_google_ok', 'report_security');
<a name="l325"><span class="linenum"> 325</span></a>      } else if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('guestloginbutton')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/guestloginbutton.html">guestloginbutton</a>)) {
<a name="l326"><span class="linenum"> 326</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_INFO')" href="../../_constants/REPORT_SECURITY_INFO.html" onMouseOver="constPopup(event,'REPORT_SECURITY_INFO')">REPORT_SECURITY_INFO</a>;
<a name="l327"><span class="linenum"> 327</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_google_info', 'report_security');
<a name="l328"><span class="linenum"> 328</span></a>      } else {
<a name="l329"><span class="linenum"> 329</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_SERIOUS')" href="../../_constants/REPORT_SECURITY_SERIOUS.html" onMouseOver="constPopup(event,'REPORT_SECURITY_SERIOUS')">REPORT_SECURITY_SERIOUS</a>;
<a name="l330"><span class="linenum"> 330</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_google_error', 'report_security');
<a name="l331"><span class="linenum"> 331</span></a>      }
<a name="l332"><span class="linenum"> 332</span></a>  
<a name="l333"><span class="linenum"> 333</span></a>      if (<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>) {
<a name="l334"><span class="linenum"> 334</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_google_details', 'report_security');
<a name="l335"><span class="linenum"> 335</span></a>      }
<a name="l336"><span class="linenum"> 336</span></a>  
<a name="l337"><span class="linenum"> 337</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l338"><span class="linenum"> 338</span></a>  }
<a name="l339"><span class="linenum"> 339</span></a>  
<a name="l340"><span class="linenum"> 340</span></a>  <span class="comment">/**</span>
<a name="l341"><span class="linenum"> 341</span></a>  <span class="comment"> * Verifies email confirmation - spammers were changing mails very often</span>
<a name="l342"><span class="linenum"> 342</span></a>  <span class="comment"> * @param bool $detailed</span>
<a name="l343"><span class="linenum"> 343</span></a>  <span class="comment"> * @return object result</span>
<a name="l344"><span class="linenum"> 344</span></a>  <span class="comment"> */</span>
<a name="l345"><span class="linenum"> 345</span></a>  function <a class="function" onClick="logFunction('report_security_check_emailchangeconfirmation')" href="../../_functions/report_security_check_emailchangeconfirmation.html" onMouseOver="funcPopup(event,'report_security_check_emailchangeconfirmation')">report_security_check_emailchangeconfirmation</a>(<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>=false) {
<a name="l346"><span class="linenum"> 346</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l347"><span class="linenum"> 347</span></a>  
<a name="l348"><span class="linenum"> 348</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = new stdClass();
<a name="l349"><span class="linenum"> 349</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('issue')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/issue.html">issue</a>   = 'report_security_check_emailchangeconfirmation';
<a name="l350"><span class="linenum"> 350</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('name')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_emailchangeconfirmation_name', 'report_security');
<a name="l351"><span class="linenum"> 351</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = null;
<a name="l352"><span class="linenum"> 352</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = null;
<a name="l353"><span class="linenum"> 353</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = null;
<a name="l354"><span class="linenum"> 354</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('link')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/link.html">link</a>    = &quot;&lt;a href=\&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>/<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('admin')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/admin.html">admin</a>/settings.php?section=sitepolicies\&quot;&gt;&quot;.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('sitepolicies', 'admin').'&lt;/a&gt;';
<a name="l355"><span class="linenum"> 355</span></a>  
<a name="l356"><span class="linenum"> 356</span></a>      if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('emailchangeconfirmation')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/emailchangeconfirmation.html">emailchangeconfirmation</a>)) {
<a name="l357"><span class="linenum"> 357</span></a>          if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('allowemailaddresses')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/allowemailaddresses.html">allowemailaddresses</a>)) {
<a name="l358"><span class="linenum"> 358</span></a>              <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_WARNING')" href="../../_constants/REPORT_SECURITY_WARNING.html" onMouseOver="constPopup(event,'REPORT_SECURITY_WARNING')">REPORT_SECURITY_WARNING</a>;
<a name="l359"><span class="linenum"> 359</span></a>              <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_emailchangeconfirmation_error', 'report_security');
<a name="l360"><span class="linenum"> 360</span></a>          } else {
<a name="l361"><span class="linenum"> 361</span></a>              <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_INFO')" href="../../_constants/REPORT_SECURITY_INFO.html" onMouseOver="constPopup(event,'REPORT_SECURITY_INFO')">REPORT_SECURITY_INFO</a>;
<a name="l362"><span class="linenum"> 362</span></a>              <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_emailchangeconfirmation_info', 'report_security');
<a name="l363"><span class="linenum"> 363</span></a>          }
<a name="l364"><span class="linenum"> 364</span></a>      } else {
<a name="l365"><span class="linenum"> 365</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_OK')" href="../../_constants/REPORT_SECURITY_OK.html" onMouseOver="constPopup(event,'REPORT_SECURITY_OK')">REPORT_SECURITY_OK</a>;
<a name="l366"><span class="linenum"> 366</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_emailchangeconfirmation_ok', 'report_security');
<a name="l367"><span class="linenum"> 367</span></a>      }
<a name="l368"><span class="linenum"> 368</span></a>  
<a name="l369"><span class="linenum"> 369</span></a>      if (<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>) {
<a name="l370"><span class="linenum"> 370</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_emailchangeconfirmation_details', 'report_security');
<a name="l371"><span class="linenum"> 371</span></a>      }
<a name="l372"><span class="linenum"> 372</span></a>  
<a name="l373"><span class="linenum"> 373</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l374"><span class="linenum"> 374</span></a>  }
<a name="l375"><span class="linenum"> 375</span></a>  
<a name="l376"><span class="linenum"> 376</span></a>  <span class="comment">/**</span>
<a name="l377"><span class="linenum"> 377</span></a>  <span class="comment"> * Verifies if https enabled only secure cookies allowed,</span>
<a name="l378"><span class="linenum"> 378</span></a>  <span class="comment"> * this prevents redirections and sending of cookies to unsecure port.</span>
<a name="l379"><span class="linenum"> 379</span></a>  <span class="comment"> * @param bool $detailed</span>
<a name="l380"><span class="linenum"> 380</span></a>  <span class="comment"> * @return object result</span>
<a name="l381"><span class="linenum"> 381</span></a>  <span class="comment"> */</span>
<a name="l382"><span class="linenum"> 382</span></a>  function <a class="function" onClick="logFunction('report_security_check_cookiesecure')" href="../../_functions/report_security_check_cookiesecure.html" onMouseOver="funcPopup(event,'report_security_check_cookiesecure')">report_security_check_cookiesecure</a>(<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>=false) {
<a name="l383"><span class="linenum"> 383</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l384"><span class="linenum"> 384</span></a>  
<a name="l385"><span class="linenum"> 385</span></a>      if (!<a class="function" onClick="logFunction('is_https')" href="../../_functions/is_https.html" onMouseOver="funcPopup(event,'is_https')">is_https</a>()) {
<a name="l386"><span class="linenum"> 386</span></a>          return null;
<a name="l387"><span class="linenum"> 387</span></a>      }
<a name="l388"><span class="linenum"> 388</span></a>  
<a name="l389"><span class="linenum"> 389</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = new stdClass();
<a name="l390"><span class="linenum"> 390</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('issue')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/issue.html">issue</a>   = 'report_security_check_cookiesecure';
<a name="l391"><span class="linenum"> 391</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('name')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_cookiesecure_name', 'report_security');
<a name="l392"><span class="linenum"> 392</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = null;
<a name="l393"><span class="linenum"> 393</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = null;
<a name="l394"><span class="linenum"> 394</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = null;
<a name="l395"><span class="linenum"> 395</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('link')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/link.html">link</a>    = &quot;&lt;a href=\&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>/<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('admin')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/admin.html">admin</a>/settings.php?section=httpsecurity\&quot;&gt;&quot;.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('httpsecurity', 'admin').'&lt;/a&gt;';
<a name="l396"><span class="linenum"> 396</span></a>  
<a name="l397"><span class="linenum"> 397</span></a>      if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('cookiesecure')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/cookiesecure.html">cookiesecure</a>)) {
<a name="l398"><span class="linenum"> 398</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_SERIOUS')" href="../../_constants/REPORT_SECURITY_SERIOUS.html" onMouseOver="constPopup(event,'REPORT_SECURITY_SERIOUS')">REPORT_SECURITY_SERIOUS</a>;
<a name="l399"><span class="linenum"> 399</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_cookiesecure_error', 'report_security');
<a name="l400"><span class="linenum"> 400</span></a>      } else {
<a name="l401"><span class="linenum"> 401</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_OK')" href="../../_constants/REPORT_SECURITY_OK.html" onMouseOver="constPopup(event,'REPORT_SECURITY_OK')">REPORT_SECURITY_OK</a>;
<a name="l402"><span class="linenum"> 402</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_cookiesecure_ok', 'report_security');
<a name="l403"><span class="linenum"> 403</span></a>      }
<a name="l404"><span class="linenum"> 404</span></a>  
<a name="l405"><span class="linenum"> 405</span></a>      if (<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>) {
<a name="l406"><span class="linenum"> 406</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_cookiesecure_details', 'report_security');
<a name="l407"><span class="linenum"> 407</span></a>      }
<a name="l408"><span class="linenum"> 408</span></a>  
<a name="l409"><span class="linenum"> 409</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l410"><span class="linenum"> 410</span></a>  }
<a name="l411"><span class="linenum"> 411</span></a>  
<a name="l412"><span class="linenum"> 412</span></a>  <span class="comment">/**</span>
<a name="l413"><span class="linenum"> 413</span></a>  <span class="comment"> * Verifies config.php is not writable anymore after installation,</span>
<a name="l414"><span class="linenum"> 414</span></a>  <span class="comment"> * config files were changed on several outdated server.</span>
<a name="l415"><span class="linenum"> 415</span></a>  <span class="comment"> * @param bool $detailed</span>
<a name="l416"><span class="linenum"> 416</span></a>  <span class="comment"> * @return object result</span>
<a name="l417"><span class="linenum"> 417</span></a>  <span class="comment"> */</span>
<a name="l418"><span class="linenum"> 418</span></a>  function <a class="function" onClick="logFunction('report_security_check_configrw')" href="../../_functions/report_security_check_configrw.html" onMouseOver="funcPopup(event,'report_security_check_configrw')">report_security_check_configrw</a>(<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>=false) {
<a name="l419"><span class="linenum"> 419</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l420"><span class="linenum"> 420</span></a>  
<a name="l421"><span class="linenum"> 421</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = new stdClass();
<a name="l422"><span class="linenum"> 422</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('issue')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/issue.html">issue</a>   = 'report_security_check_configrw';
<a name="l423"><span class="linenum"> 423</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('name')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_configrw_name', 'report_security');
<a name="l424"><span class="linenum"> 424</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = null;
<a name="l425"><span class="linenum"> 425</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = null;
<a name="l426"><span class="linenum"> 426</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = null;
<a name="l427"><span class="linenum"> 427</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('link')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/link.html">link</a>    = null;
<a name="l428"><span class="linenum"> 428</span></a>  
<a name="l429"><span class="linenum"> 429</span></a>      if (<a class="phpfunction" onClick="logFunction('is_writable')" href="../../_functions/is_writable.html" onMouseOver="phpfuncPopup(event,'is_writable')">is_writable</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'/config.php')) {
<a name="l430"><span class="linenum"> 430</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_WARNING')" href="../../_constants/REPORT_SECURITY_WARNING.html" onMouseOver="constPopup(event,'REPORT_SECURITY_WARNING')">REPORT_SECURITY_WARNING</a>;
<a name="l431"><span class="linenum"> 431</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_configrw_warning', 'report_security');
<a name="l432"><span class="linenum"> 432</span></a>      } else {
<a name="l433"><span class="linenum"> 433</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_OK')" href="../../_constants/REPORT_SECURITY_OK.html" onMouseOver="constPopup(event,'REPORT_SECURITY_OK')">REPORT_SECURITY_OK</a>;
<a name="l434"><span class="linenum"> 434</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_configrw_ok', 'report_security');
<a name="l435"><span class="linenum"> 435</span></a>      }
<a name="l436"><span class="linenum"> 436</span></a>  
<a name="l437"><span class="linenum"> 437</span></a>      if (<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>) {
<a name="l438"><span class="linenum"> 438</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_configrw_details', 'report_security');
<a name="l439"><span class="linenum"> 439</span></a>      }
<a name="l440"><span class="linenum"> 440</span></a>  
<a name="l441"><span class="linenum"> 441</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l442"><span class="linenum"> 442</span></a>  }
<a name="l443"><span class="linenum"> 443</span></a>  
<a name="l444"><span class="linenum"> 444</span></a>  
<a name="l445"><span class="linenum"> 445</span></a>  <span class="comment">/**</span>
<a name="l446"><span class="linenum"> 446</span></a>  <span class="comment"> * Lists all users with XSS risk, it would be great to combine this with risk trusts in user table,</span>
<a name="l447"><span class="linenum"> 447</span></a>  <span class="comment"> * unfortunately nobody implemented user trust UI yet :-(</span>
<a name="l448"><span class="linenum"> 448</span></a>  <span class="comment"> * @param bool $detailed</span>
<a name="l449"><span class="linenum"> 449</span></a>  <span class="comment"> * @return object result</span>
<a name="l450"><span class="linenum"> 450</span></a>  <span class="comment"> */</span>
<a name="l451"><span class="linenum"> 451</span></a>  function <a class="function" onClick="logFunction('report_security_check_riskxss')" href="../../_functions/report_security_check_riskxss.html" onMouseOver="funcPopup(event,'report_security_check_riskxss')">report_security_check_riskxss</a>(<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>=false) {
<a name="l452"><span class="linenum"> 452</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l453"><span class="linenum"> 453</span></a>  
<a name="l454"><span class="linenum"> 454</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = new stdClass();
<a name="l455"><span class="linenum"> 455</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('issue')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/issue.html">issue</a>   = 'report_security_check_riskxss';
<a name="l456"><span class="linenum"> 456</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('name')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_riskxss_name', 'report_security');
<a name="l457"><span class="linenum"> 457</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = null;
<a name="l458"><span class="linenum"> 458</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = null;
<a name="l459"><span class="linenum"> 459</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = <a class="constant" onClick="logConstant('REPORT_SECURITY_WARNING')" href="../../_constants/REPORT_SECURITY_WARNING.html" onMouseOver="constPopup(event,'REPORT_SECURITY_WARNING')">REPORT_SECURITY_WARNING</a>;
<a name="l460"><span class="linenum"> 460</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('link')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/link.html">link</a>    = null;
<a name="l461"><span class="linenum"> 461</span></a>  
<a name="l462"><span class="linenum"> 462</span></a>      <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('capallow'=&gt;<a class="constant" onClick="logConstant('CAP_ALLOW')" href="../../_constants/CAP_ALLOW.html" onMouseOver="constPopup(event,'CAP_ALLOW')">CAP_ALLOW</a>);
<a name="l463"><span class="linenum"> 463</span></a>  
<a name="l464"><span class="linenum"> 464</span></a>      <a class="var it8015" onMouseOver="hilite(8015)" onMouseOut="lolite()" onClick="logVariable('sqlfrom')" href="../../_variables/sqlfrom.html">$sqlfrom</a> = &quot;<a class="function" onClick="logFunction('FROM')" href="../../_functions/from.html" onMouseOver="funcPopup(event,'from')">FROM</a> (SELECT rcx.*
<a name="l465"><span class="linenum"> 465</span></a>                         FROM {role_capabilities} rcx
<a name="l466"><span class="linenum"> 466</span></a>                         JOIN {capabilities} cap <a class="function" onClick="logFunction('ON')" href="../../_functions/on.html" onMouseOver="funcPopup(event,'on')">ON</a> (cap.name = rcx.capability AND &quot;.<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_bitand')" href="../../_functions/sql_bitand.html" onMouseOver="funcPopup(event,'sql_bitand')">sql_bitand</a>('cap.riskbitmask', <a class="constant" onClick="logConstant('RISK_XSS')" href="../../_constants/RISK_XSS.html" onMouseOver="constPopup(event,'RISK_XSS')">RISK_XSS</a>).&quot; &lt;&gt; 0)
<a name="l467"><span class="linenum"> 467</span></a>                         WHERE rcx.permission = :capallow) rc,
<a name="l468"><span class="linenum"> 468</span></a>                       {context} c,
<a name="l469"><span class="linenum"> 469</span></a>                       {context} sc,
<a name="l470"><span class="linenum"> 470</span></a>                       {role_assignments} ra,
<a name="l471"><span class="linenum"> 471</span></a>                       {user} u
<a name="l472"><span class="linenum"> 472</span></a>                 WHERE c.id = rc.contextid
<a name="l473"><span class="linenum"> 473</span></a>                       AND (sc.path = c.path OR sc.path LIKE &quot;.<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_concat')" href="../../_functions/sql_concat.html" onMouseOver="funcPopup(event,'sql_concat')">sql_concat</a>('c.path', &quot;'/%'&quot;).&quot; OR c.path LIKE &quot;.<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_concat')" href="../../_functions/sql_concat.html" onMouseOver="funcPopup(event,'sql_concat')">sql_concat</a>('sc.path', &quot;'/%'&quot;).&quot;)
<a name="l474"><span class="linenum"> 474</span></a>                       AND u.id = ra.userid AND u.deleted = 0
<a name="l475"><span class="linenum"> 475</span></a>                       AND ra.contextid = sc.id AND ra.roleid = rc.roleid&quot;;
<a name="l476"><span class="linenum"> 476</span></a>  
<a name="l477"><span class="linenum"> 477</span></a>      <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records_sql')" href="../../_functions/count_records_sql.html" onMouseOver="funcPopup(event,'count_records_sql')">count_records_sql</a>(&quot;SELECT <a class="phpfunction" onClick="logFunction('COUNT')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">COUNT</a>(DISTINCT u.id) <a class="var it8015" onMouseOver="hilite(8015)" onMouseOut="lolite()" onClick="logVariable('sqlfrom')" href="../../_variables/sqlfrom.html">$sqlfrom</a>&quot;, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l478"><span class="linenum"> 478</span></a>  
<a name="l479"><span class="linenum"> 479</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_riskxss_warning', 'report_security', <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a>);
<a name="l480"><span class="linenum"> 480</span></a>  
<a name="l481"><span class="linenum"> 481</span></a>      if (<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>) {
<a name="l482"><span class="linenum"> 482</span></a>          <a class="var it2982" onMouseOver="hilite(2982)" onMouseOut="lolite()" onClick="logVariable('userfields')" href="../../_variables/userfields.html">$userfields</a> = <a class="class" onClick="logClass('user_picture')" href="../../_classes/user_picture.html" onMouseOver="classPopup(event,'user_picture')">user_picture</a>::<a class="function" onClick="logFunction('fields')" href="../../_functions/fields.html" onMouseOver="funcPopup(event,'fields')">fields</a>('u');
<a name="l483"><span class="linenum"> 483</span></a>          <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(&quot;SELECT DISTINCT <a class="var it2982" onMouseOver="hilite(2982)" onMouseOut="lolite()" onClick="logVariable('userfields')" href="../../_variables/userfields.html">$userfields</a> <a class="var it8015" onMouseOver="hilite(8015)" onMouseOut="lolite()" onClick="logVariable('sqlfrom')" href="../../_variables/sqlfrom.html">$sqlfrom</a>&quot;, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l484"><span class="linenum"> 484</span></a>          foreach (<a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a> as <a class="var it9652" onMouseOver="hilite(9652)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../../_variables/uid.html">$uid</a>=&gt;<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>) {
<a name="l485"><span class="linenum"> 485</span></a>              <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>[<a class="var it9652" onMouseOver="hilite(9652)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../../_variables/uid.html">$uid</a>] = <a class="function" onClick="logFunction('fullname')" href="../../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>);
<a name="l486"><span class="linenum"> 486</span></a>          }
<a name="l487"><span class="linenum"> 487</span></a>          <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(', ', <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>);
<a name="l488"><span class="linenum"> 488</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_riskxss_details', 'report_security', <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>);
<a name="l489"><span class="linenum"> 489</span></a>      }
<a name="l490"><span class="linenum"> 490</span></a>  
<a name="l491"><span class="linenum"> 491</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l492"><span class="linenum"> 492</span></a>  }
<a name="l493"><span class="linenum"> 493</span></a>  
<a name="l494"><span class="linenum"> 494</span></a>  <span class="comment">/**</span>
<a name="l495"><span class="linenum"> 495</span></a>  <span class="comment"> * Verifies sanity of default user role.</span>
<a name="l496"><span class="linenum"> 496</span></a>  <span class="comment"> * @param bool $detailed</span>
<a name="l497"><span class="linenum"> 497</span></a>  <span class="comment"> * @return object result</span>
<a name="l498"><span class="linenum"> 498</span></a>  <span class="comment"> */</span>
<a name="l499"><span class="linenum"> 499</span></a>  function <a class="function" onClick="logFunction('report_security_check_defaultuserrole')" href="../../_functions/report_security_check_defaultuserrole.html" onMouseOver="funcPopup(event,'report_security_check_defaultuserrole')">report_security_check_defaultuserrole</a>(<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>=false) {
<a name="l500"><span class="linenum"> 500</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l501"><span class="linenum"> 501</span></a>  
<a name="l502"><span class="linenum"> 502</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = new stdClass();
<a name="l503"><span class="linenum"> 503</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('issue')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/issue.html">issue</a>   = 'report_security_check_defaultuserrole';
<a name="l504"><span class="linenum"> 504</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('name')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_defaultuserrole_name', 'report_security');
<a name="l505"><span class="linenum"> 505</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = null;
<a name="l506"><span class="linenum"> 506</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = null;
<a name="l507"><span class="linenum"> 507</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = null;
<a name="l508"><span class="linenum"> 508</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('link')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/link.html">link</a>    = &quot;&lt;a href=\&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>/<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('admin')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/admin.html">admin</a>/settings.php?section=userpolicies\&quot;&gt;&quot;.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('userpolicies', 'admin').'&lt;/a&gt;';
<a name="l509"><span class="linenum"> 509</span></a>  
<a name="l510"><span class="linenum"> 510</span></a>      if (!<a class="var it16421" onMouseOver="hilite(16421)" onMouseOut="lolite()" onClick="logVariable('default_role')" href="../../_variables/default_role.html">$default_role</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('role', array('id'=&gt;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('defaultuserroleid')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/defaultuserroleid.html">defaultuserroleid</a>))) {
<a name="l511"><span class="linenum"> 511</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = <a class="constant" onClick="logConstant('REPORT_SECURITY_WARNING')" href="../../_constants/REPORT_SECURITY_WARNING.html" onMouseOver="constPopup(event,'REPORT_SECURITY_WARNING')">REPORT_SECURITY_WARNING</a>;
<a name="l512"><span class="linenum"> 512</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_defaultuserrole_notset', 'report_security');
<a name="l513"><span class="linenum"> 513</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>;
<a name="l514"><span class="linenum"> 514</span></a>  
<a name="l515"><span class="linenum"> 515</span></a>          return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l516"><span class="linenum"> 516</span></a>      }
<a name="l517"><span class="linenum"> 517</span></a>  
<a name="l518"><span class="linenum"> 518</span></a>  <span class="comment">    // risky caps - usually very dangerous</span>
<a name="l519"><span class="linenum"> 519</span></a>      <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('capallow'=&gt;<a class="constant" onClick="logConstant('CAP_ALLOW')" href="../../_constants/CAP_ALLOW.html" onMouseOver="constPopup(event,'CAP_ALLOW')">CAP_ALLOW</a>, 'roleid'=&gt;<a class="var it16421" onMouseOver="hilite(16421)" onMouseOut="lolite()" onClick="logVariable('default_role')" href="../../_variables/default_role.html">$default_role</a>-&gt;<a onClick="logVariable('id')" class="var it39444" onMouseOver="hilite(39444)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l520"><span class="linenum"> 520</span></a>      <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT <a class="phpfunction" onClick="logFunction('COUNT')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">COUNT</a>(DISTINCT rc.contextid)
<a name="l521"><span class="linenum"> 521</span></a>                FROM {role_capabilities} rc
<a name="l522"><span class="linenum"> 522</span></a>                JOIN {capabilities} cap ON cap.name = rc.capability
<a name="l523"><span class="linenum"> 523</span></a>               WHERE &quot;.<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_bitand')" href="../../_functions/sql_bitand.html" onMouseOver="funcPopup(event,'sql_bitand')">sql_bitand</a>('cap.riskbitmask', (<a class="constant" onClick="logConstant('RISK_XSS')" href="../../_constants/RISK_XSS.html" onMouseOver="constPopup(event,'RISK_XSS')">RISK_XSS</a> | <a class="constant" onClick="logConstant('RISK_CONFIG')" href="../../_constants/RISK_CONFIG.html" onMouseOver="constPopup(event,'RISK_CONFIG')">RISK_CONFIG</a> | <a class="constant" onClick="logConstant('RISK_DATALOSS')" href="../../_constants/RISK_DATALOSS.html" onMouseOver="constPopup(event,'RISK_DATALOSS')">RISK_DATALOSS</a>)).&quot; &lt;&gt; 0
<a name="l524"><span class="linenum"> 524</span></a>                     AND rc.permission = :capallow
<a name="l525"><span class="linenum"> 525</span></a>                     AND rc.roleid = :roleid&quot;;
<a name="l526"><span class="linenum"> 526</span></a>  
<a name="l527"><span class="linenum"> 527</span></a>      <a class="var it16423" onMouseOver="hilite(16423)" onMouseOut="lolite()" onClick="logVariable('riskycount')" href="../../_variables/riskycount.html">$riskycount</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records_sql')" href="../../_functions/count_records_sql.html" onMouseOver="funcPopup(event,'count_records_sql')">count_records_sql</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l528"><span class="linenum"> 528</span></a>  
<a name="l529"><span class="linenum"> 529</span></a>  <span class="comment">    // it may have either none or 'user' archetype - nothing else, or else it would break during upgrades badly</span>
<a name="l530"><span class="linenum"> 530</span></a>      if (<a class="var it16421" onMouseOver="hilite(16421)" onMouseOut="lolite()" onClick="logVariable('default_role')" href="../../_variables/default_role.html">$default_role</a>-&gt;<a onClick="logVariable('archetype')" class="var it39444" onMouseOver="hilite(39444)" onMouseOut="lolite()" href="../../_variables/archetype.html">archetype</a> === '' or <a class="var it16421" onMouseOver="hilite(16421)" onMouseOut="lolite()" onClick="logVariable('default_role')" href="../../_variables/default_role.html">$default_role</a>-&gt;<a onClick="logVariable('archetype')" class="var it39444" onMouseOver="hilite(39444)" onMouseOut="lolite()" href="../../_variables/archetype.html">archetype</a> === 'user') {
<a name="l531"><span class="linenum"> 531</span></a>          <a class="var it16424" onMouseOver="hilite(16424)" onMouseOut="lolite()" onClick="logVariable('legacyok')" href="../../_variables/legacyok.html">$legacyok</a> = true;
<a name="l532"><span class="linenum"> 532</span></a>      } else {
<a name="l533"><span class="linenum"> 533</span></a>          <a class="var it16424" onMouseOver="hilite(16424)" onMouseOut="lolite()" onClick="logVariable('legacyok')" href="../../_variables/legacyok.html">$legacyok</a> = false;
<a name="l534"><span class="linenum"> 534</span></a>      }
<a name="l535"><span class="linenum"> 535</span></a>  
<a name="l536"><span class="linenum"> 536</span></a>      if (<a class="var it16423" onMouseOver="hilite(16423)" onMouseOut="lolite()" onClick="logVariable('riskycount')" href="../../_variables/riskycount.html">$riskycount</a> or !<a class="var it16424" onMouseOver="hilite(16424)" onMouseOut="lolite()" onClick="logVariable('legacyok')" href="../../_variables/legacyok.html">$legacyok</a>) {
<a name="l537"><span class="linenum"> 537</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = <a class="constant" onClick="logConstant('REPORT_SECURITY_CRITICAL')" href="../../_constants/REPORT_SECURITY_CRITICAL.html" onMouseOver="constPopup(event,'REPORT_SECURITY_CRITICAL')">REPORT_SECURITY_CRITICAL</a>;
<a name="l538"><span class="linenum"> 538</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_defaultuserrole_error', 'report_security', <a class="function" onClick="logFunction('role_get_name')" href="../../_functions/role_get_name.html" onMouseOver="funcPopup(event,'role_get_name')">role_get_name</a>(<a class="var it16421" onMouseOver="hilite(16421)" onMouseOut="lolite()" onClick="logVariable('default_role')" href="../../_variables/default_role.html">$default_role</a>));
<a name="l539"><span class="linenum"> 539</span></a>  
<a name="l540"><span class="linenum"> 540</span></a>      } else {
<a name="l541"><span class="linenum"> 541</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = <a class="constant" onClick="logConstant('REPORT_SECURITY_OK')" href="../../_constants/REPORT_SECURITY_OK.html" onMouseOver="constPopup(event,'REPORT_SECURITY_OK')">REPORT_SECURITY_OK</a>;
<a name="l542"><span class="linenum"> 542</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_defaultuserrole_ok', 'report_security');
<a name="l543"><span class="linenum"> 543</span></a>      }
<a name="l544"><span class="linenum"> 544</span></a>  
<a name="l545"><span class="linenum"> 545</span></a>      if (<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>) {
<a name="l546"><span class="linenum"> 546</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_defaultuserrole_details', 'report_security');
<a name="l547"><span class="linenum"> 547</span></a>      }
<a name="l548"><span class="linenum"> 548</span></a>  
<a name="l549"><span class="linenum"> 549</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l550"><span class="linenum"> 550</span></a>  }
<a name="l551"><span class="linenum"> 551</span></a>  
<a name="l552"><span class="linenum"> 552</span></a>  <span class="comment">/**</span>
<a name="l553"><span class="linenum"> 553</span></a>  <span class="comment"> * Verifies sanity of guest role</span>
<a name="l554"><span class="linenum"> 554</span></a>  <span class="comment"> * @param bool $detailed</span>
<a name="l555"><span class="linenum"> 555</span></a>  <span class="comment"> * @return object result</span>
<a name="l556"><span class="linenum"> 556</span></a>  <span class="comment"> */</span>
<a name="l557"><span class="linenum"> 557</span></a>  function <a class="function" onClick="logFunction('report_security_check_guestrole')" href="../../_functions/report_security_check_guestrole.html" onMouseOver="funcPopup(event,'report_security_check_guestrole')">report_security_check_guestrole</a>(<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>=false) {
<a name="l558"><span class="linenum"> 558</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l559"><span class="linenum"> 559</span></a>  
<a name="l560"><span class="linenum"> 560</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = new stdClass();
<a name="l561"><span class="linenum"> 561</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('issue')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/issue.html">issue</a>   = 'report_security_check_guestrole';
<a name="l562"><span class="linenum"> 562</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('name')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_guestrole_name', 'report_security');
<a name="l563"><span class="linenum"> 563</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = null;
<a name="l564"><span class="linenum"> 564</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = null;
<a name="l565"><span class="linenum"> 565</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = null;
<a name="l566"><span class="linenum"> 566</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('link')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/link.html">link</a>    = &quot;&lt;a href=\&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>/<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('admin')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/admin.html">admin</a>/settings.php?section=userpolicies\&quot;&gt;&quot;.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('userpolicies', 'admin').'&lt;/a&gt;';
<a name="l567"><span class="linenum"> 567</span></a>  
<a name="l568"><span class="linenum"> 568</span></a>      if (!<a class="var it16425" onMouseOver="hilite(16425)" onMouseOut="lolite()" onClick="logVariable('guest_role')" href="../../_variables/guest_role.html">$guest_role</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('role', array('id'=&gt;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('guestroleid')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/guestroleid.html">guestroleid</a>))) {
<a name="l569"><span class="linenum"> 569</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = <a class="constant" onClick="logConstant('REPORT_SECURITY_WARNING')" href="../../_constants/REPORT_SECURITY_WARNING.html" onMouseOver="constPopup(event,'REPORT_SECURITY_WARNING')">REPORT_SECURITY_WARNING</a>;
<a name="l570"><span class="linenum"> 570</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_guestrole_notset', 'report_security');
<a name="l571"><span class="linenum"> 571</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>;
<a name="l572"><span class="linenum"> 572</span></a>  
<a name="l573"><span class="linenum"> 573</span></a>          return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l574"><span class="linenum"> 574</span></a>      }
<a name="l575"><span class="linenum"> 575</span></a>  
<a name="l576"><span class="linenum"> 576</span></a>  <span class="comment">    // risky caps - usually very dangerous</span>
<a name="l577"><span class="linenum"> 577</span></a>      <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('capallow'=&gt;<a class="constant" onClick="logConstant('CAP_ALLOW')" href="../../_constants/CAP_ALLOW.html" onMouseOver="constPopup(event,'CAP_ALLOW')">CAP_ALLOW</a>, 'roleid'=&gt;<a class="var it16425" onMouseOver="hilite(16425)" onMouseOut="lolite()" onClick="logVariable('guest_role')" href="../../_variables/guest_role.html">$guest_role</a>-&gt;<a onClick="logVariable('id')" class="var it39445" onMouseOver="hilite(39445)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l578"><span class="linenum"> 578</span></a>      <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT <a class="phpfunction" onClick="logFunction('COUNT')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">COUNT</a>(DISTINCT rc.contextid)
<a name="l579"><span class="linenum"> 579</span></a>                FROM {role_capabilities} rc
<a name="l580"><span class="linenum"> 580</span></a>                JOIN {capabilities} cap ON cap.name = rc.capability
<a name="l581"><span class="linenum"> 581</span></a>               WHERE &quot;.<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_bitand')" href="../../_functions/sql_bitand.html" onMouseOver="funcPopup(event,'sql_bitand')">sql_bitand</a>('cap.riskbitmask', (<a class="constant" onClick="logConstant('RISK_XSS')" href="../../_constants/RISK_XSS.html" onMouseOver="constPopup(event,'RISK_XSS')">RISK_XSS</a> | <a class="constant" onClick="logConstant('RISK_CONFIG')" href="../../_constants/RISK_CONFIG.html" onMouseOver="constPopup(event,'RISK_CONFIG')">RISK_CONFIG</a> | <a class="constant" onClick="logConstant('RISK_DATALOSS')" href="../../_constants/RISK_DATALOSS.html" onMouseOver="constPopup(event,'RISK_DATALOSS')">RISK_DATALOSS</a>)).&quot; &lt;&gt; 0
<a name="l582"><span class="linenum"> 582</span></a>                     AND rc.permission = :capallow
<a name="l583"><span class="linenum"> 583</span></a>                     AND rc.roleid = :roleid&quot;;
<a name="l584"><span class="linenum"> 584</span></a>  
<a name="l585"><span class="linenum"> 585</span></a>      <a class="var it16423" onMouseOver="hilite(16423)" onMouseOut="lolite()" onClick="logVariable('riskycount')" href="../../_variables/riskycount.html">$riskycount</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records_sql')" href="../../_functions/count_records_sql.html" onMouseOver="funcPopup(event,'count_records_sql')">count_records_sql</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l586"><span class="linenum"> 586</span></a>  
<a name="l587"><span class="linenum"> 587</span></a>  <span class="comment">    // it may have either no or 'guest' archetype - nothing else, or else it would break during upgrades badly</span>
<a name="l588"><span class="linenum"> 588</span></a>      if (<a class="var it16425" onMouseOver="hilite(16425)" onMouseOut="lolite()" onClick="logVariable('guest_role')" href="../../_variables/guest_role.html">$guest_role</a>-&gt;<a onClick="logVariable('archetype')" class="var it39445" onMouseOver="hilite(39445)" onMouseOut="lolite()" href="../../_variables/archetype.html">archetype</a> === '' or <a class="var it16425" onMouseOver="hilite(16425)" onMouseOut="lolite()" onClick="logVariable('guest_role')" href="../../_variables/guest_role.html">$guest_role</a>-&gt;<a onClick="logVariable('archetype')" class="var it39445" onMouseOver="hilite(39445)" onMouseOut="lolite()" href="../../_variables/archetype.html">archetype</a> === 'guest') {
<a name="l589"><span class="linenum"> 589</span></a>          <a class="var it16424" onMouseOver="hilite(16424)" onMouseOut="lolite()" onClick="logVariable('legacyok')" href="../../_variables/legacyok.html">$legacyok</a> = true;
<a name="l590"><span class="linenum"> 590</span></a>      } else {
<a name="l591"><span class="linenum"> 591</span></a>          <a class="var it16424" onMouseOver="hilite(16424)" onMouseOut="lolite()" onClick="logVariable('legacyok')" href="../../_variables/legacyok.html">$legacyok</a> = false;
<a name="l592"><span class="linenum"> 592</span></a>      }
<a name="l593"><span class="linenum"> 593</span></a>  
<a name="l594"><span class="linenum"> 594</span></a>      if (<a class="var it16423" onMouseOver="hilite(16423)" onMouseOut="lolite()" onClick="logVariable('riskycount')" href="../../_variables/riskycount.html">$riskycount</a> or !<a class="var it16424" onMouseOver="hilite(16424)" onMouseOut="lolite()" onClick="logVariable('legacyok')" href="../../_variables/legacyok.html">$legacyok</a>) {
<a name="l595"><span class="linenum"> 595</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = <a class="constant" onClick="logConstant('REPORT_SECURITY_CRITICAL')" href="../../_constants/REPORT_SECURITY_CRITICAL.html" onMouseOver="constPopup(event,'REPORT_SECURITY_CRITICAL')">REPORT_SECURITY_CRITICAL</a>;
<a name="l596"><span class="linenum"> 596</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_guestrole_error', 'report_security', <a class="function" onClick="logFunction('format_string')" href="../../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it16425" onMouseOver="hilite(16425)" onMouseOut="lolite()" onClick="logVariable('guest_role')" href="../../_variables/guest_role.html">$guest_role</a>-&gt;<a onClick="logVariable('name')" class="var it39445" onMouseOver="hilite(39445)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>));
<a name="l597"><span class="linenum"> 597</span></a>  
<a name="l598"><span class="linenum"> 598</span></a>      } else {
<a name="l599"><span class="linenum"> 599</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = <a class="constant" onClick="logConstant('REPORT_SECURITY_OK')" href="../../_constants/REPORT_SECURITY_OK.html" onMouseOver="constPopup(event,'REPORT_SECURITY_OK')">REPORT_SECURITY_OK</a>;
<a name="l600"><span class="linenum"> 600</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_guestrole_ok', 'report_security');
<a name="l601"><span class="linenum"> 601</span></a>      }
<a name="l602"><span class="linenum"> 602</span></a>  
<a name="l603"><span class="linenum"> 603</span></a>      if (<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>) {
<a name="l604"><span class="linenum"> 604</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_guestrole_details', 'report_security');
<a name="l605"><span class="linenum"> 605</span></a>      }
<a name="l606"><span class="linenum"> 606</span></a>  
<a name="l607"><span class="linenum"> 607</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l608"><span class="linenum"> 608</span></a>  }
<a name="l609"><span class="linenum"> 609</span></a>  
<a name="l610"><span class="linenum"> 610</span></a>  <span class="comment">/**</span>
<a name="l611"><span class="linenum"> 611</span></a>  <span class="comment"> * Verifies sanity of frontpage role</span>
<a name="l612"><span class="linenum"> 612</span></a>  <span class="comment"> * @param bool $detailed</span>
<a name="l613"><span class="linenum"> 613</span></a>  <span class="comment"> * @return object result</span>
<a name="l614"><span class="linenum"> 614</span></a>  <span class="comment"> */</span>
<a name="l615"><span class="linenum"> 615</span></a>  function <a class="function" onClick="logFunction('report_security_check_frontpagerole')" href="../../_functions/report_security_check_frontpagerole.html" onMouseOver="funcPopup(event,'report_security_check_frontpagerole')">report_security_check_frontpagerole</a>(<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>=false) {
<a name="l616"><span class="linenum"> 616</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l617"><span class="linenum"> 617</span></a>  
<a name="l618"><span class="linenum"> 618</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = new stdClass();
<a name="l619"><span class="linenum"> 619</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('issue')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/issue.html">issue</a>   = 'report_security_check_frontpagerole';
<a name="l620"><span class="linenum"> 620</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('name')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_frontpagerole_name', 'report_security');
<a name="l621"><span class="linenum"> 621</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = null;
<a name="l622"><span class="linenum"> 622</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = null;
<a name="l623"><span class="linenum"> 623</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = null;
<a name="l624"><span class="linenum"> 624</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('link')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/link.html">link</a>    = &quot;&lt;a href=\&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>/<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('admin')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/admin.html">admin</a>/settings.php?section=frontpagesettings\&quot;&gt;&quot;.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('frontpagesettings','admin').'&lt;/a&gt;';
<a name="l625"><span class="linenum"> 625</span></a>  
<a name="l626"><span class="linenum"> 626</span></a>      if (!<a class="var it16426" onMouseOver="hilite(16426)" onMouseOut="lolite()" onClick="logVariable('frontpage_role')" href="../../_variables/frontpage_role.html">$frontpage_role</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('role', array('id'=&gt;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('defaultfrontpageroleid')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/defaultfrontpageroleid.html">defaultfrontpageroleid</a>))) {
<a name="l627"><span class="linenum"> 627</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = <a class="constant" onClick="logConstant('REPORT_SECURITY_INFO')" href="../../_constants/REPORT_SECURITY_INFO.html" onMouseOver="constPopup(event,'REPORT_SECURITY_INFO')">REPORT_SECURITY_INFO</a>;
<a name="l628"><span class="linenum"> 628</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_frontpagerole_notset', 'report_security');
<a name="l629"><span class="linenum"> 629</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_frontpagerole_details', 'report_security');
<a name="l630"><span class="linenum"> 630</span></a>  
<a name="l631"><span class="linenum"> 631</span></a>          return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l632"><span class="linenum"> 632</span></a>      }
<a name="l633"><span class="linenum"> 633</span></a>  
<a name="l634"><span class="linenum"> 634</span></a>  <span class="comment">    // risky caps - usually very dangerous</span>
<a name="l635"><span class="linenum"> 635</span></a>      <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('capallow'=&gt;<a class="constant" onClick="logConstant('CAP_ALLOW')" href="../../_constants/CAP_ALLOW.html" onMouseOver="constPopup(event,'CAP_ALLOW')">CAP_ALLOW</a>, 'roleid'=&gt;<a class="var it16426" onMouseOver="hilite(16426)" onMouseOut="lolite()" onClick="logVariable('frontpage_role')" href="../../_variables/frontpage_role.html">$frontpage_role</a>-&gt;<a onClick="logVariable('id')" class="var it39446" onMouseOver="hilite(39446)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l636"><span class="linenum"> 636</span></a>      <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT <a class="phpfunction" onClick="logFunction('COUNT')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">COUNT</a>(DISTINCT rc.contextid)
<a name="l637"><span class="linenum"> 637</span></a>                FROM {role_capabilities} rc
<a name="l638"><span class="linenum"> 638</span></a>                JOIN {capabilities} cap ON cap.name = rc.capability
<a name="l639"><span class="linenum"> 639</span></a>               WHERE &quot;.<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_bitand')" href="../../_functions/sql_bitand.html" onMouseOver="funcPopup(event,'sql_bitand')">sql_bitand</a>('cap.riskbitmask', (<a class="constant" onClick="logConstant('RISK_XSS')" href="../../_constants/RISK_XSS.html" onMouseOver="constPopup(event,'RISK_XSS')">RISK_XSS</a> | <a class="constant" onClick="logConstant('RISK_CONFIG')" href="../../_constants/RISK_CONFIG.html" onMouseOver="constPopup(event,'RISK_CONFIG')">RISK_CONFIG</a> | <a class="constant" onClick="logConstant('RISK_DATALOSS')" href="../../_constants/RISK_DATALOSS.html" onMouseOver="constPopup(event,'RISK_DATALOSS')">RISK_DATALOSS</a>)).&quot; &lt;&gt; 0
<a name="l640"><span class="linenum"> 640</span></a>                     AND rc.permission = :capallow
<a name="l641"><span class="linenum"> 641</span></a>                     AND rc.roleid = :roleid&quot;;
<a name="l642"><span class="linenum"> 642</span></a>  
<a name="l643"><span class="linenum"> 643</span></a>      <a class="var it16423" onMouseOver="hilite(16423)" onMouseOut="lolite()" onClick="logVariable('riskycount')" href="../../_variables/riskycount.html">$riskycount</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records_sql')" href="../../_functions/count_records_sql.html" onMouseOver="funcPopup(event,'count_records_sql')">count_records_sql</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l644"><span class="linenum"> 644</span></a>  
<a name="l645"><span class="linenum"> 645</span></a>  <span class="comment">    // there is no legacy role type for frontpage yet - anyway we can not allow teachers or admins there!</span>
<a name="l646"><span class="linenum"> 646</span></a>      if (<a class="var it16426" onMouseOver="hilite(16426)" onMouseOut="lolite()" onClick="logVariable('frontpage_role')" href="../../_variables/frontpage_role.html">$frontpage_role</a>-&gt;<a onClick="logVariable('archetype')" class="var it39446" onMouseOver="hilite(39446)" onMouseOut="lolite()" href="../../_variables/archetype.html">archetype</a> === 'teacher' or <a class="var it16426" onMouseOver="hilite(16426)" onMouseOut="lolite()" onClick="logVariable('frontpage_role')" href="../../_variables/frontpage_role.html">$frontpage_role</a>-&gt;<a onClick="logVariable('archetype')" class="var it39446" onMouseOver="hilite(39446)" onMouseOut="lolite()" href="../../_variables/archetype.html">archetype</a> === 'editingteacher'
<a name="l647"><span class="linenum"> 647</span></a>        or <a class="var it16426" onMouseOver="hilite(16426)" onMouseOut="lolite()" onClick="logVariable('frontpage_role')" href="../../_variables/frontpage_role.html">$frontpage_role</a>-&gt;<a onClick="logVariable('archetype')" class="var it39446" onMouseOver="hilite(39446)" onMouseOut="lolite()" href="../../_variables/archetype.html">archetype</a> === 'coursecreator' or <a class="var it16426" onMouseOver="hilite(16426)" onMouseOut="lolite()" onClick="logVariable('frontpage_role')" href="../../_variables/frontpage_role.html">$frontpage_role</a>-&gt;<a onClick="logVariable('archetype')" class="var it39446" onMouseOver="hilite(39446)" onMouseOut="lolite()" href="../../_variables/archetype.html">archetype</a> === 'manager') {
<a name="l648"><span class="linenum"> 648</span></a>          <a class="var it16424" onMouseOver="hilite(16424)" onMouseOut="lolite()" onClick="logVariable('legacyok')" href="../../_variables/legacyok.html">$legacyok</a> = false;
<a name="l649"><span class="linenum"> 649</span></a>      } else {
<a name="l650"><span class="linenum"> 650</span></a>          <a class="var it16424" onMouseOver="hilite(16424)" onMouseOut="lolite()" onClick="logVariable('legacyok')" href="../../_variables/legacyok.html">$legacyok</a> = true;
<a name="l651"><span class="linenum"> 651</span></a>      }
<a name="l652"><span class="linenum"> 652</span></a>  
<a name="l653"><span class="linenum"> 653</span></a>      if (<a class="var it16423" onMouseOver="hilite(16423)" onMouseOut="lolite()" onClick="logVariable('riskycount')" href="../../_variables/riskycount.html">$riskycount</a> or !<a class="var it16424" onMouseOver="hilite(16424)" onMouseOut="lolite()" onClick="logVariable('legacyok')" href="../../_variables/legacyok.html">$legacyok</a>) {
<a name="l654"><span class="linenum"> 654</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = <a class="constant" onClick="logConstant('REPORT_SECURITY_CRITICAL')" href="../../_constants/REPORT_SECURITY_CRITICAL.html" onMouseOver="constPopup(event,'REPORT_SECURITY_CRITICAL')">REPORT_SECURITY_CRITICAL</a>;
<a name="l655"><span class="linenum"> 655</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_frontpagerole_error', 'report_security', <a class="function" onClick="logFunction('format_string')" href="../../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it16426" onMouseOver="hilite(16426)" onMouseOut="lolite()" onClick="logVariable('frontpage_role')" href="../../_variables/frontpage_role.html">$frontpage_role</a>-&gt;<a onClick="logVariable('name')" class="var it39446" onMouseOver="hilite(39446)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>));
<a name="l656"><span class="linenum"> 656</span></a>  
<a name="l657"><span class="linenum"> 657</span></a>      } else {
<a name="l658"><span class="linenum"> 658</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = <a class="constant" onClick="logConstant('REPORT_SECURITY_OK')" href="../../_constants/REPORT_SECURITY_OK.html" onMouseOver="constPopup(event,'REPORT_SECURITY_OK')">REPORT_SECURITY_OK</a>;
<a name="l659"><span class="linenum"> 659</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_frontpagerole_ok', 'report_security');
<a name="l660"><span class="linenum"> 660</span></a>      }
<a name="l661"><span class="linenum"> 661</span></a>  
<a name="l662"><span class="linenum"> 662</span></a>      if (<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>) {
<a name="l663"><span class="linenum"> 663</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_frontpagerole_details', 'report_security');
<a name="l664"><span class="linenum"> 664</span></a>      }
<a name="l665"><span class="linenum"> 665</span></a>  
<a name="l666"><span class="linenum"> 666</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l667"><span class="linenum"> 667</span></a>  }
<a name="l668"><span class="linenum"> 668</span></a>  
<a name="l669"><span class="linenum"> 669</span></a>  <span class="comment">/**</span>
<a name="l670"><span class="linenum"> 670</span></a>  <span class="comment"> * Lists all admins.</span>
<a name="l671"><span class="linenum"> 671</span></a>  <span class="comment"> * @param bool $detailed</span>
<a name="l672"><span class="linenum"> 672</span></a>  <span class="comment"> * @return object result</span>
<a name="l673"><span class="linenum"> 673</span></a>  <span class="comment"> */</span>
<a name="l674"><span class="linenum"> 674</span></a>  function <a class="function" onClick="logFunction('report_security_check_riskadmin')" href="../../_functions/report_security_check_riskadmin.html" onMouseOver="funcPopup(event,'report_security_check_riskadmin')">report_security_check_riskadmin</a>(<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>=false) {
<a name="l675"><span class="linenum"> 675</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l676"><span class="linenum"> 676</span></a>  
<a name="l677"><span class="linenum"> 677</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = new stdClass();
<a name="l678"><span class="linenum"> 678</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('issue')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/issue.html">issue</a>   = 'report_security_check_riskadmin';
<a name="l679"><span class="linenum"> 679</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('name')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_riskadmin_name', 'report_security');
<a name="l680"><span class="linenum"> 680</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = null;
<a name="l681"><span class="linenum"> 681</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = null;
<a name="l682"><span class="linenum"> 682</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = null;
<a name="l683"><span class="linenum"> 683</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('link')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/link.html">link</a>    = null;
<a name="l684"><span class="linenum"> 684</span></a>  
<a name="l685"><span class="linenum"> 685</span></a>      <a class="var it2982" onMouseOver="hilite(2982)" onMouseOut="lolite()" onClick="logVariable('userfields')" href="../../_variables/userfields.html">$userfields</a> = <a class="class" onClick="logClass('user_picture')" href="../../_classes/user_picture.html" onMouseOver="classPopup(event,'user_picture')">user_picture</a>::<a class="function" onClick="logFunction('fields')" href="../../_functions/fields.html" onMouseOver="funcPopup(event,'fields')">fields</a>('u');
<a name="l686"><span class="linenum"> 686</span></a>      <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT <a class="var it2982" onMouseOver="hilite(2982)" onMouseOut="lolite()" onClick="logVariable('userfields')" href="../../_variables/userfields.html">$userfields</a>
<a name="l687"><span class="linenum"> 687</span></a>                FROM {user} u
<a name="l688"><span class="linenum"> 688</span></a>               WHERE u.id IN (<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('siteadmins')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/siteadmins.html">siteadmins</a>)&quot;;
<a name="l689"><span class="linenum"> 689</span></a>  
<a name="l690"><span class="linenum"> 690</span></a>      <a class="var it1847" onMouseOver="hilite(1847)" onMouseOut="lolite()" onClick="logVariable('admins')" href="../../_variables/admins.html">$admins</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>);
<a name="l691"><span class="linenum"> 691</span></a>      <a class="var it4162" onMouseOver="hilite(4162)" onMouseOut="lolite()" onClick="logVariable('admincount')" href="../../_variables/admincount.html">$admincount</a> = <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it1847" onMouseOver="hilite(1847)" onMouseOut="lolite()" onClick="logVariable('admins')" href="../../_variables/admins.html">$admins</a>);
<a name="l692"><span class="linenum"> 692</span></a>  
<a name="l693"><span class="linenum"> 693</span></a>      if (<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>) {
<a name="l694"><span class="linenum"> 694</span></a>          foreach (<a class="var it1847" onMouseOver="hilite(1847)" onMouseOut="lolite()" onClick="logVariable('admins')" href="../../_variables/admins.html">$admins</a> as <a class="var it9652" onMouseOver="hilite(9652)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../../_variables/uid.html">$uid</a>=&gt;<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>) {
<a name="l695"><span class="linenum"> 695</span></a>              <a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = &quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>/user/view.php?id=<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>&quot;;
<a name="l696"><span class="linenum"> 696</span></a>              <a class="var it1847" onMouseOver="hilite(1847)" onMouseOut="lolite()" onClick="logVariable('admins')" href="../../_variables/admins.html">$admins</a>[<a class="var it9652" onMouseOver="hilite(9652)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../../_variables/uid.html">$uid</a>] = '&lt;li&gt;&lt;a href=&quot;'.<a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>.'&quot;&gt;'.<a class="function" onClick="logFunction('fullname')" href="../../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>).' ('.<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('email')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../../_variables/email.html">email</a>.')&lt;/a&gt;&lt;/li&gt;';
<a name="l697"><span class="linenum"> 697</span></a>          }
<a name="l698"><span class="linenum"> 698</span></a>          <a class="var it1847" onMouseOver="hilite(1847)" onMouseOut="lolite()" onClick="logVariable('admins')" href="../../_variables/admins.html">$admins</a> = '&lt;ul&gt;'.<a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>('', <a class="var it1847" onMouseOver="hilite(1847)" onMouseOut="lolite()" onClick="logVariable('admins')" href="../../_variables/admins.html">$admins</a>).'&lt;/ul&gt;';
<a name="l699"><span class="linenum"> 699</span></a>      }
<a name="l700"><span class="linenum"> 700</span></a>  
<a name="l701"><span class="linenum"> 701</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = <a class="constant" onClick="logConstant('REPORT_SECURITY_OK')" href="../../_constants/REPORT_SECURITY_OK.html" onMouseOver="constPopup(event,'REPORT_SECURITY_OK')">REPORT_SECURITY_OK</a>;
<a name="l702"><span class="linenum"> 702</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_riskadmin_ok', 'report_security', <a class="var it4162" onMouseOver="hilite(4162)" onMouseOut="lolite()" onClick="logVariable('admincount')" href="../../_variables/admincount.html">$admincount</a>);
<a name="l703"><span class="linenum"> 703</span></a>  
<a name="l704"><span class="linenum"> 704</span></a>      if (<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>) {
<a name="l705"><span class="linenum"> 705</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_riskadmin_detailsok', 'report_security', <a class="var it1847" onMouseOver="hilite(1847)" onMouseOut="lolite()" onClick="logVariable('admins')" href="../../_variables/admins.html">$admins</a>);
<a name="l706"><span class="linenum"> 706</span></a>      }
<a name="l707"><span class="linenum"> 707</span></a>  
<a name="l708"><span class="linenum"> 708</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l709"><span class="linenum"> 709</span></a>  }
<a name="l710"><span class="linenum"> 710</span></a>  
<a name="l711"><span class="linenum"> 711</span></a>  <span class="comment">/**</span>
<a name="l712"><span class="linenum"> 712</span></a>  <span class="comment"> * Lists all roles that have the ability to backup user data, as well as users</span>
<a name="l713"><span class="linenum"> 713</span></a>  <span class="comment"> * @param bool $detailed</span>
<a name="l714"><span class="linenum"> 714</span></a>  <span class="comment"> * @return object result</span>
<a name="l715"><span class="linenum"> 715</span></a>  <span class="comment"> */</span>
<a name="l716"><span class="linenum"> 716</span></a>  function <a class="function" onClick="logFunction('report_security_check_riskbackup')" href="../../_functions/report_security_check_riskbackup.html" onMouseOver="funcPopup(event,'report_security_check_riskbackup')">report_security_check_riskbackup</a>(<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>=false) {
<a name="l717"><span class="linenum"> 717</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l718"><span class="linenum"> 718</span></a>  
<a name="l719"><span class="linenum"> 719</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = new stdClass();
<a name="l720"><span class="linenum"> 720</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('issue')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/issue.html">issue</a>   = 'report_security_check_riskbackup';
<a name="l721"><span class="linenum"> 721</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('name')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_riskbackup_name', 'report_security');
<a name="l722"><span class="linenum"> 722</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>    = null;
<a name="l723"><span class="linenum"> 723</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = null;
<a name="l724"><span class="linenum"> 724</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>  = null;
<a name="l725"><span class="linenum"> 725</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('link')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/link.html">link</a>    = null;
<a name="l726"><span class="linenum"> 726</span></a>  
<a name="l727"><span class="linenum"> 727</span></a>      <a class="var it1172" onMouseOver="hilite(1172)" onMouseOut="lolite()" onClick="logVariable('syscontext')" href="../../_variables/syscontext.html">$syscontext</a> = <a class="class" onClick="logClass('context_system')" href="../../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>();
<a name="l728"><span class="linenum"> 728</span></a>  
<a name="l729"><span class="linenum"> 729</span></a>      <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('capability'=&gt;'moodle/backup:userinfo', 'permission'=&gt;<a class="constant" onClick="logConstant('CAP_ALLOW')" href="../../_constants/CAP_ALLOW.html" onMouseOver="constPopup(event,'CAP_ALLOW')">CAP_ALLOW</a>, 'contextid'=&gt;<a class="var it1172" onMouseOver="hilite(1172)" onMouseOut="lolite()" onClick="logVariable('syscontext')" href="../../_variables/syscontext.html">$syscontext</a>-&gt;<a onClick="logVariable('id')" class="var it39448" onMouseOver="hilite(39448)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l730"><span class="linenum"> 730</span></a>      <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT DISTINCT r.id, r.name, r.shortname, r.sortorder, r.archetype
<a name="l731"><span class="linenum"> 731</span></a>                FROM {role} r
<a name="l732"><span class="linenum"> 732</span></a>                JOIN {role_capabilities} rc ON rc.roleid = r.id
<a name="l733"><span class="linenum"> 733</span></a>               WHERE rc.capability = :capability
<a name="l734"><span class="linenum"> 734</span></a>                 AND rc.contextid  = :contextid
<a name="l735"><span class="linenum"> 735</span></a>                 AND rc.permission = :permission&quot;;
<a name="l736"><span class="linenum"> 736</span></a>      <a class="var it16427" onMouseOver="hilite(16427)" onMouseOut="lolite()" onClick="logVariable('systemroles')" href="../../_variables/systemroles.html">$systemroles</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l737"><span class="linenum"> 737</span></a>  
<a name="l738"><span class="linenum"> 738</span></a>      <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('capability'=&gt;'moodle/backup:userinfo', 'permission'=&gt;<a class="constant" onClick="logConstant('CAP_ALLOW')" href="../../_constants/CAP_ALLOW.html" onMouseOver="constPopup(event,'CAP_ALLOW')">CAP_ALLOW</a>, 'contextid'=&gt;<a class="var it1172" onMouseOver="hilite(1172)" onMouseOut="lolite()" onClick="logVariable('syscontext')" href="../../_variables/syscontext.html">$syscontext</a>-&gt;<a onClick="logVariable('id')" class="var it39448" onMouseOver="hilite(39448)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l739"><span class="linenum"> 739</span></a>      <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT DISTINCT r.id, r.name, r.shortname, r.sortorder, r.archetype, rc.contextid
<a name="l740"><span class="linenum"> 740</span></a>                FROM {role} r
<a name="l741"><span class="linenum"> 741</span></a>                JOIN {role_capabilities} rc ON rc.roleid = r.id
<a name="l742"><span class="linenum"> 742</span></a>               WHERE rc.capability = :capability
<a name="l743"><span class="linenum"> 743</span></a>                 AND rc.contextid &lt;&gt; :contextid
<a name="l744"><span class="linenum"> 744</span></a>                 AND rc.permission = :permission&quot;;
<a name="l745"><span class="linenum"> 745</span></a>      <a class="var it16428" onMouseOver="hilite(16428)" onMouseOut="lolite()" onClick="logVariable('overriddenroles')" href="../../_variables/overriddenroles.html">$overriddenroles</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l746"><span class="linenum"> 746</span></a>  
<a name="l747"><span class="linenum"> 747</span></a>  <span class="comment">    // list of users that are able to backup personal info</span>
<a name="l748"><span class="linenum"> 748</span></a>  <span class="comment">    // note: &quot;sc&quot; is context where is role assigned,</span>
<a name="l749"><span class="linenum"> 749</span></a>  <span class="comment">    //       &quot;c&quot; is context where is role overridden or system context if in role definition</span>
<a name="l750"><span class="linenum"> 750</span></a>      <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('capability'=&gt;'moodle/backup:userinfo', 'permission'=&gt;<a class="constant" onClick="logConstant('CAP_ALLOW')" href="../../_constants/CAP_ALLOW.html" onMouseOver="constPopup(event,'CAP_ALLOW')">CAP_ALLOW</a>, 'context1'=&gt;<a class="constant" onClick="logConstant('CONTEXT_COURSE')" href="../../_constants/CONTEXT_COURSE.html" onMouseOver="constPopup(event,'CONTEXT_COURSE')">CONTEXT_COURSE</a>, 'context2'=&gt;<a class="constant" onClick="logConstant('CONTEXT_COURSE')" href="../../_constants/CONTEXT_COURSE.html" onMouseOver="constPopup(event,'CONTEXT_COURSE')">CONTEXT_COURSE</a>);
<a name="l751"><span class="linenum"> 751</span></a>  
<a name="l752"><span class="linenum"> 752</span></a>      <a class="var it16429" onMouseOver="hilite(16429)" onMouseOut="lolite()" onClick="logVariable('sqluserinfo')" href="../../_variables/sqluserinfo.html">$sqluserinfo</a> = &quot;
<a name="l753"><span class="linenum"> 753</span></a>          <a class="function" onClick="logFunction('FROM')" href="../../_functions/from.html" onMouseOver="funcPopup(event,'from')">FROM</a> (SELECT rcx.*
<a name="l754"><span class="linenum"> 754</span></a>                  FROM {role_capabilities} rcx
<a name="l755"><span class="linenum"> 755</span></a>                 WHERE rcx.permission = :permission AND rcx.capability = :capability) rc,
<a name="l756"><span class="linenum"> 756</span></a>               {context} c,
<a name="l757"><span class="linenum"> 757</span></a>               {context} sc,
<a name="l758"><span class="linenum"> 758</span></a>               {role_assignments} ra,
<a name="l759"><span class="linenum"> 759</span></a>               {user} u
<a name="l760"><span class="linenum"> 760</span></a>         WHERE c.id = rc.contextid
<a name="l761"><span class="linenum"> 761</span></a>               AND (sc.path = c.path OR sc.path LIKE &quot;.<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_concat')" href="../../_functions/sql_concat.html" onMouseOver="funcPopup(event,'sql_concat')">sql_concat</a>('c.path', &quot;'/%'&quot;).&quot; OR c.path LIKE &quot;.<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_concat')" href="../../_functions/sql_concat.html" onMouseOver="funcPopup(event,'sql_concat')">sql_concat</a>('sc.path', &quot;'/%'&quot;).&quot;)
<a name="l762"><span class="linenum"> 762</span></a>               AND u.id = ra.userid AND u.deleted = 0
<a name="l763"><span class="linenum"> 763</span></a>               AND ra.contextid = sc.id AND ra.roleid = rc.roleid
<a name="l764"><span class="linenum"> 764</span></a>               AND sc.contextlevel &lt;= :context1 AND c.contextlevel &lt;= :context2&quot;;
<a name="l765"><span class="linenum"> 765</span></a>  
<a name="l766"><span class="linenum"> 766</span></a>      <a class="var it4166" onMouseOver="hilite(4166)" onMouseOut="lolite()" onClick="logVariable('usercount')" href="../../_variables/usercount.html">$usercount</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records_sql')" href="../../_functions/count_records_sql.html" onMouseOver="funcPopup(event,'count_records_sql')">count_records_sql</a>(&quot;SELECT <a class="phpfunction" onClick="logFunction('COUNT')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">COUNT</a>('x') <a class="function" onClick="logFunction('FROM')" href="../../_functions/from.html" onMouseOver="funcPopup(event,'from')">FROM</a> (SELECT DISTINCT u.id <a class="var it16429" onMouseOver="hilite(16429)" onMouseOut="lolite()" onClick="logVariable('sqluserinfo')" href="../../_variables/sqluserinfo.html">$sqluserinfo</a>) userinfo&quot;, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l767"><span class="linenum"> 767</span></a>      <a class="var it16430" onMouseOver="hilite(16430)" onMouseOut="lolite()" onClick="logVariable('systemrolecount')" href="../../_variables/systemrolecount.html">$systemrolecount</a> = empty(<a class="var it16427" onMouseOver="hilite(16427)" onMouseOut="lolite()" onClick="logVariable('systemroles')" href="../../_variables/systemroles.html">$systemroles</a>) ? 0 : <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it16427" onMouseOver="hilite(16427)" onMouseOut="lolite()" onClick="logVariable('systemroles')" href="../../_variables/systemroles.html">$systemroles</a>);
<a name="l768"><span class="linenum"> 768</span></a>      <a class="var it16431" onMouseOver="hilite(16431)" onMouseOut="lolite()" onClick="logVariable('overriddenrolecount')" href="../../_variables/overriddenrolecount.html">$overriddenrolecount</a> = empty(<a class="var it16428" onMouseOver="hilite(16428)" onMouseOut="lolite()" onClick="logVariable('overriddenroles')" href="../../_variables/overriddenroles.html">$overriddenroles</a>) ? 0 : <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it16428" onMouseOver="hilite(16428)" onMouseOut="lolite()" onClick="logVariable('overriddenroles')" href="../../_variables/overriddenroles.html">$overriddenroles</a>);
<a name="l769"><span class="linenum"> 769</span></a>  
<a name="l770"><span class="linenum"> 770</span></a>      if (<a class="phpfunction" onClick="logFunction('max')" href="../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">max</a>(<a class="var it4166" onMouseOver="hilite(4166)" onMouseOut="lolite()" onClick="logVariable('usercount')" href="../../_variables/usercount.html">$usercount</a>, <a class="var it16430" onMouseOver="hilite(16430)" onMouseOut="lolite()" onClick="logVariable('systemrolecount')" href="../../_variables/systemrolecount.html">$systemrolecount</a>, <a class="var it16431" onMouseOver="hilite(16431)" onMouseOut="lolite()" onClick="logVariable('overriddenrolecount')" href="../../_variables/overriddenrolecount.html">$overriddenrolecount</a>) &gt; 0) {
<a name="l771"><span class="linenum"> 771</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_WARNING')" href="../../_constants/REPORT_SECURITY_WARNING.html" onMouseOver="constPopup(event,'REPORT_SECURITY_WARNING')">REPORT_SECURITY_WARNING</a>;
<a name="l772"><span class="linenum"> 772</span></a>      } else {
<a name="l773"><span class="linenum"> 773</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_OK')" href="../../_constants/REPORT_SECURITY_OK.html" onMouseOver="constPopup(event,'REPORT_SECURITY_OK')">REPORT_SECURITY_OK</a>;
<a name="l774"><span class="linenum"> 774</span></a>      }
<a name="l775"><span class="linenum"> 775</span></a>  
<a name="l776"><span class="linenum"> 776</span></a>      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a> = (object)array('rolecount'=&gt;<a class="var it16430" onMouseOver="hilite(16430)" onMouseOut="lolite()" onClick="logVariable('systemrolecount')" href="../../_variables/systemrolecount.html">$systemrolecount</a>,'overridecount'=&gt;<a class="var it16431" onMouseOver="hilite(16431)" onMouseOut="lolite()" onClick="logVariable('overriddenrolecount')" href="../../_variables/overriddenrolecount.html">$overriddenrolecount</a>,'usercount'=&gt;<a class="var it4166" onMouseOver="hilite(4166)" onMouseOut="lolite()" onClick="logVariable('usercount')" href="../../_variables/usercount.html">$usercount</a>);
<a name="l777"><span class="linenum"> 777</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_riskbackup_warning', 'report_security', <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>);
<a name="l778"><span class="linenum"> 778</span></a>  
<a name="l779"><span class="linenum"> 779</span></a>      if (<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>) {
<a name="l780"><span class="linenum"> 780</span></a>  
<a name="l781"><span class="linenum"> 781</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = '';  <span class="comment">// Will be added to later</span>
<a name="l782"><span class="linenum"> 782</span></a>  
<a name="l783"><span class="linenum"> 783</span></a>  <span class="comment">        // Make a list of roles</span>
<a name="l784"><span class="linenum"> 784</span></a>          if (<a class="var it16427" onMouseOver="hilite(16427)" onMouseOut="lolite()" onClick="logVariable('systemroles')" href="../../_variables/systemroles.html">$systemroles</a>) {
<a name="l785"><span class="linenum"> 785</span></a>              <a class="var it9363" onMouseOver="hilite(9363)" onMouseOut="lolite()" onClick="logVariable('links')" href="../../_variables/links.html">$links</a> = array();
<a name="l786"><span class="linenum"> 786</span></a>              foreach (<a class="var it16427" onMouseOver="hilite(16427)" onMouseOut="lolite()" onClick="logVariable('systemroles')" href="../../_variables/systemroles.html">$systemroles</a> as <a class="var it426" onMouseOver="hilite(426)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>) {
<a name="l787"><span class="linenum"> 787</span></a>                  <a class="var it426" onMouseOver="hilite(426)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>-&gt;<a onClick="logVariable('name')" class="var it39449" onMouseOver="hilite(39449)" onMouseOut="lolite()" href="../../_variables/name.html">name</a> = <a class="function" onClick="logFunction('role_get_name')" href="../../_functions/role_get_name.html" onMouseOver="funcPopup(event,'role_get_name')">role_get_name</a>(<a class="var it426" onMouseOver="hilite(426)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>);
<a name="l788"><span class="linenum"> 788</span></a>                  <a class="var it426" onMouseOver="hilite(426)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>-&gt;<a onClick="logVariable('url')" class="var it39449" onMouseOver="hilite(39449)" onMouseOut="lolite()" href="../../_variables/url.html">url</a> = &quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>/<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('admin')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/admin.html">admin</a>/roles/manage.php?action=edit&amp;amp;roleid=<a class="var it426" onMouseOver="hilite(426)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>-&gt;<a onClick="logVariable('id')" class="var it39449" onMouseOver="hilite(39449)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>&quot;;
<a name="l789"><span class="linenum"> 789</span></a>                  <a class="var it9363" onMouseOver="hilite(9363)" onMouseOut="lolite()" onClick="logVariable('links')" href="../../_variables/links.html">$links</a>[] = '&lt;li&gt;'.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_riskbackup_editrole', 'report_security', <a class="var it426" onMouseOver="hilite(426)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>).'&lt;/li&gt;';
<a name="l790"><span class="linenum"> 790</span></a>              }
<a name="l791"><span class="linenum"> 791</span></a>              <a class="var it9363" onMouseOver="hilite(9363)" onMouseOut="lolite()" onClick="logVariable('links')" href="../../_variables/links.html">$links</a> = '&lt;ul&gt;'.<a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(<a class="var it9363" onMouseOver="hilite(9363)" onMouseOut="lolite()" onClick="logVariable('links')" href="../../_variables/links.html">$links</a>).'&lt;/ul&gt;';
<a name="l792"><span class="linenum"> 792</span></a>              <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> .= <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_riskbackup_details_systemroles', 'report_security', <a class="var it9363" onMouseOver="hilite(9363)" onMouseOut="lolite()" onClick="logVariable('links')" href="../../_variables/links.html">$links</a>);
<a name="l793"><span class="linenum"> 793</span></a>          }
<a name="l794"><span class="linenum"> 794</span></a>  
<a name="l795"><span class="linenum"> 795</span></a>  <span class="comment">        // Make a list of overrides to roles</span>
<a name="l796"><span class="linenum"> 796</span></a>          <a class="var it16432" onMouseOver="hilite(16432)" onMouseOut="lolite()" onClick="logVariable('rolelinks2')" href="../../_variables/rolelinks2.html">$rolelinks2</a> = array();
<a name="l797"><span class="linenum"> 797</span></a>          if (<a class="var it16428" onMouseOver="hilite(16428)" onMouseOut="lolite()" onClick="logVariable('overriddenroles')" href="../../_variables/overriddenroles.html">$overriddenroles</a>) {
<a name="l798"><span class="linenum"> 798</span></a>              <a class="var it9363" onMouseOver="hilite(9363)" onMouseOut="lolite()" onClick="logVariable('links')" href="../../_variables/links.html">$links</a> = array();
<a name="l799"><span class="linenum"> 799</span></a>              foreach (<a class="var it16428" onMouseOver="hilite(16428)" onMouseOut="lolite()" onClick="logVariable('overriddenroles')" href="../../_variables/overriddenroles.html">$overriddenroles</a> as <a class="var it426" onMouseOver="hilite(426)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>) {
<a name="l800"><span class="linenum"> 800</span></a>                  <a class="var it426" onMouseOver="hilite(426)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>-&gt;<a onClick="logVariable('name')" class="var it39449" onMouseOver="hilite(39449)" onMouseOut="lolite()" href="../../_variables/name.html">name</a> = <a class="var it426" onMouseOver="hilite(426)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>-&gt;<a onClick="logVariable('localname')" class="var it39449" onMouseOver="hilite(39449)" onMouseOut="lolite()" href="../../_variables/localname.html">localname</a>;
<a name="l801"><span class="linenum"> 801</span></a>                  <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> = context::<a class="function" onClick="logFunction('instance_by_id')" href="../../_functions/instance_by_id.html" onMouseOver="funcPopup(event,'instance_by_id')">instance_by_id</a>(<a class="var it426" onMouseOver="hilite(426)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>-&gt;<a onClick="logVariable('contextid')" class="var it39449" onMouseOver="hilite(39449)" onMouseOut="lolite()" href="../../_variables/contextid.html">contextid</a>);
<a name="l802"><span class="linenum"> 802</span></a>                  <a class="var it426" onMouseOver="hilite(426)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>-&gt;<a onClick="logVariable('name')" class="var it39449" onMouseOver="hilite(39449)" onMouseOut="lolite()" href="../../_variables/name.html">name</a> = <a class="function" onClick="logFunction('role_get_name')" href="../../_functions/role_get_name.html" onMouseOver="funcPopup(event,'role_get_name')">role_get_name</a>(<a class="var it426" onMouseOver="hilite(426)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>, <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>, <a class="constant" onClick="logConstant('ROLENAME_BOTH')" href="../../_constants/ROLENAME_BOTH.html" onMouseOver="constPopup(event,'ROLENAME_BOTH')">ROLENAME_BOTH</a>);
<a name="l803"><span class="linenum"> 803</span></a>                  <a class="var it426" onMouseOver="hilite(426)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>-&gt;<a onClick="logVariable('contextname')" class="var it39449" onMouseOver="hilite(39449)" onMouseOut="lolite()" href="../../_variables/contextname.html">contextname</a> = <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a class="function" onClick="logFunction('get_context_name')" href="../../_functions/get_context_name.html" onMouseOver="funcPopup(event,'get_context_name')">get_context_name</a>();
<a name="l804"><span class="linenum"> 804</span></a>                  <a class="var it426" onMouseOver="hilite(426)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>-&gt;<a onClick="logVariable('url')" class="var it39449" onMouseOver="hilite(39449)" onMouseOut="lolite()" href="../../_variables/url.html">url</a> = &quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>/<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('admin')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/admin.html">admin</a>/roles/override.php?contextid=<a class="var it426" onMouseOver="hilite(426)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>-&gt;<a onClick="logVariable('contextid')" class="var it39449" onMouseOver="hilite(39449)" onMouseOut="lolite()" href="../../_variables/contextid.html">contextid</a>&amp;amp;roleid=<a class="var it426" onMouseOver="hilite(426)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>-&gt;<a onClick="logVariable('id')" class="var it39449" onMouseOver="hilite(39449)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>&quot;;
<a name="l805"><span class="linenum"> 805</span></a>                  <a class="var it9363" onMouseOver="hilite(9363)" onMouseOut="lolite()" onClick="logVariable('links')" href="../../_variables/links.html">$links</a>[] = '&lt;li&gt;'.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_riskbackup_editoverride', 'report_security', <a class="var it426" onMouseOver="hilite(426)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>).'&lt;/li&gt;';
<a name="l806"><span class="linenum"> 806</span></a>              }
<a name="l807"><span class="linenum"> 807</span></a>              <a class="var it9363" onMouseOver="hilite(9363)" onMouseOut="lolite()" onClick="logVariable('links')" href="../../_variables/links.html">$links</a> = '&lt;ul&gt;'.<a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>('', <a class="var it9363" onMouseOver="hilite(9363)" onMouseOut="lolite()" onClick="logVariable('links')" href="../../_variables/links.html">$links</a>).'&lt;/ul&gt;';
<a name="l808"><span class="linenum"> 808</span></a>              <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> .= <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_riskbackup_details_overriddenroles', 'report_security', <a class="var it9363" onMouseOver="hilite(9363)" onMouseOut="lolite()" onClick="logVariable('links')" href="../../_variables/links.html">$links</a>);
<a name="l809"><span class="linenum"> 809</span></a>          }
<a name="l810"><span class="linenum"> 810</span></a>  
<a name="l811"><span class="linenum"> 811</span></a>  <span class="comment">        // Get a list of affected users as well</span>
<a name="l812"><span class="linenum"> 812</span></a>          <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a> = array();
<a name="l813"><span class="linenum"> 813</span></a>  
<a name="l814"><span class="linenum"> 814</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it124" onMouseOver="hilite(124)" onMouseOut="lolite()" onClick="logVariable('sort')" href="../../_variables/sort.html">$sort</a>, <a class="var it533" onMouseOver="hilite(533)" onMouseOut="lolite()" onClick="logVariable('sortparams')" href="../../_variables/sortparams.html">$sortparams</a>) = <a class="function" onClick="logFunction('users_order_by_sql')" href="../../_functions/users_order_by_sql.html" onMouseOver="funcPopup(event,'users_order_by_sql')">users_order_by_sql</a>('u');
<a name="l815"><span class="linenum"> 815</span></a>          <a class="var it2982" onMouseOver="hilite(2982)" onMouseOut="lolite()" onClick="logVariable('userfields')" href="../../_variables/userfields.html">$userfields</a> = <a class="class" onClick="logClass('user_picture')" href="../../_classes/user_picture.html" onMouseOver="classPopup(event,'user_picture')">user_picture</a>::<a class="function" onClick="logFunction('fields')" href="../../_functions/fields.html" onMouseOver="funcPopup(event,'fields')">fields</a>('u');
<a name="l816"><span class="linenum"> 816</span></a>          <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../_variables/rs.html">$rs</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset_sql')" href="../../_functions/get_recordset_sql.html" onMouseOver="funcPopup(event,'get_recordset_sql')">get_recordset_sql</a>(&quot;SELECT DISTINCT <a class="var it2982" onMouseOver="hilite(2982)" onMouseOut="lolite()" onClick="logVariable('userfields')" href="../../_variables/userfields.html">$userfields</a>, ra.contextid, ra.roleid
<a name="l817"><span class="linenum"> 817</span></a>              <a class="var it16429" onMouseOver="hilite(16429)" onMouseOut="lolite()" onClick="logVariable('sqluserinfo')" href="../../_variables/sqluserinfo.html">$sqluserinfo</a> ORDER BY <a class="var it124" onMouseOver="hilite(124)" onMouseOut="lolite()" onClick="logVariable('sort')" href="../../_variables/sort.html">$sort</a>&quot;, <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it533" onMouseOver="hilite(533)" onMouseOut="lolite()" onClick="logVariable('sortparams')" href="../../_variables/sortparams.html">$sortparams</a>));
<a name="l818"><span class="linenum"> 818</span></a>  
<a name="l819"><span class="linenum"> 819</span></a>          foreach (<a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../_variables/rs.html">$rs</a> as <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>) {
<a name="l820"><span class="linenum"> 820</span></a>              <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> = context::<a class="function" onClick="logFunction('instance_by_id')" href="../../_functions/instance_by_id.html" onMouseOver="funcPopup(event,'instance_by_id')">instance_by_id</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('contextid')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../../_variables/contextid.html">contextid</a>);
<a name="l821"><span class="linenum"> 821</span></a>              <a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = &quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>/<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('admin')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/admin.html">admin</a>/roles/assign.php?contextid=<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('contextid')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../../_variables/contextid.html">contextid</a>&amp;amp;roleid=<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('roleid')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../../_variables/roleid.html">roleid</a>&quot;;
<a name="l822"><span class="linenum"> 822</span></a>              <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a> = (object)array('fullname'=&gt;<a class="function" onClick="logFunction('fullname')" href="../../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>), 'url'=&gt;<a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>, 'email'=&gt;<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('email')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../../_variables/email.html">email</a>,
<a name="l823"><span class="linenum"> 823</span></a>                                 'contextname'=&gt;<a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a class="function" onClick="logFunction('get_context_name')" href="../../_functions/get_context_name.html" onMouseOver="funcPopup(event,'get_context_name')">get_context_name</a>());
<a name="l824"><span class="linenum"> 824</span></a>              <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>[] = '&lt;li&gt;'.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_riskbackup_unassign', 'report_security', <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>).'&lt;/li&gt;';
<a name="l825"><span class="linenum"> 825</span></a>          }
<a name="l826"><span class="linenum"> 826</span></a>          if (!empty(<a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>)) {
<a name="l827"><span class="linenum"> 827</span></a>              <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a> = '&lt;ul&gt;'.<a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>('', <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>).'&lt;/ul&gt;';
<a name="l828"><span class="linenum"> 828</span></a>              <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> .= <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_riskbackup_details_users', 'report_security', <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>);
<a name="l829"><span class="linenum"> 829</span></a>          }
<a name="l830"><span class="linenum"> 830</span></a>      }
<a name="l831"><span class="linenum"> 831</span></a>  
<a name="l832"><span class="linenum"> 832</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l833"><span class="linenum"> 833</span></a>  }
<a name="l834"><span class="linenum"> 834</span></a>  
<a name="l835"><span class="linenum"> 835</span></a>  <span class="comment">/**</span>
<a name="l836"><span class="linenum"> 836</span></a>  <span class="comment"> * Verifies the status of web cron</span>
<a name="l837"><span class="linenum"> 837</span></a>  <span class="comment"> *</span>
<a name="l838"><span class="linenum"> 838</span></a>  <span class="comment"> * @param bool $detailed</span>
<a name="l839"><span class="linenum"> 839</span></a>  <span class="comment"> * @return object result</span>
<a name="l840"><span class="linenum"> 840</span></a>  <span class="comment"> */</span>
<a name="l841"><span class="linenum"> 841</span></a>  function <a class="function" onClick="logFunction('report_security_check_webcron')" href="../../_functions/report_security_check_webcron.html" onMouseOver="funcPopup(event,'report_security_check_webcron')">report_security_check_webcron</a>(<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a> = false) {
<a name="l842"><span class="linenum"> 842</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l843"><span class="linenum"> 843</span></a>  
<a name="l844"><span class="linenum"> 844</span></a>      <a class="var it16433" onMouseOver="hilite(16433)" onMouseOut="lolite()" onClick="logVariable('croncli')" href="../../_variables/croncli.html">$croncli</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('cronclionly')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/cronclionly.html">cronclionly</a>;
<a name="l845"><span class="linenum"> 845</span></a>      <a class="var it11222" onMouseOver="hilite(11222)" onMouseOut="lolite()" onClick="logVariable('cronremotepassword')" href="../../_variables/cronremotepassword.html">$cronremotepassword</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('cronremotepassword')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/cronremotepassword.html">cronremotepassword</a>;
<a name="l846"><span class="linenum"> 846</span></a>  
<a name="l847"><span class="linenum"> 847</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = new stdClass();
<a name="l848"><span class="linenum"> 848</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('issue')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/issue.html">issue</a>   = 'report_security_check_webcron';
<a name="l849"><span class="linenum"> 849</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('name')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_webcron_name', 'report_security');
<a name="l850"><span class="linenum"> 850</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = null;
<a name="l851"><span class="linenum"> 851</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('link')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/link.html">link</a>    = &quot;&lt;a href=\&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>/<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('admin')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/admin.html">admin</a>/settings.php?section=sitepolicies\&quot;&gt;&quot;
<a name="l852"><span class="linenum"> 852</span></a>              .<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('sitepolicies', 'admin').'&lt;/a&gt;';
<a name="l853"><span class="linenum"> 853</span></a>  
<a name="l854"><span class="linenum"> 854</span></a>      if (empty(<a class="var it16433" onMouseOver="hilite(16433)" onMouseOut="lolite()" onClick="logVariable('croncli')" href="../../_variables/croncli.html">$croncli</a>) &amp;&amp; empty(<a class="var it11222" onMouseOver="hilite(11222)" onMouseOut="lolite()" onClick="logVariable('cronremotepassword')" href="../../_variables/cronremotepassword.html">$cronremotepassword</a>)) {
<a name="l855"><span class="linenum"> 855</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_WARNING')" href="../../_constants/REPORT_SECURITY_WARNING.html" onMouseOver="constPopup(event,'REPORT_SECURITY_WARNING')">REPORT_SECURITY_WARNING</a>;
<a name="l856"><span class="linenum"> 856</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_webcron_warning', 'report_security');
<a name="l857"><span class="linenum"> 857</span></a>      } else {
<a name="l858"><span class="linenum"> 858</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('status')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('REPORT_SECURITY_OK')" href="../../_constants/REPORT_SECURITY_OK.html" onMouseOver="constPopup(event,'REPORT_SECURITY_OK')">REPORT_SECURITY_OK</a>;
<a name="l859"><span class="linenum"> 859</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/info.html">info</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_webcron_ok', 'report_security');
<a name="l860"><span class="linenum"> 860</span></a>      }
<a name="l861"><span class="linenum"> 861</span></a>  
<a name="l862"><span class="linenum"> 862</span></a>      if (<a class="var it16415" onMouseOver="hilite(16415)" onMouseOut="lolite()" onClick="logVariable('detailed')" href="../../_variables/detailed.html">$detailed</a>) {
<a name="l863"><span class="linenum"> 863</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('details')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../_variables/details.html">details</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('check_webcron_details', 'report_security');
<a name="l864"><span class="linenum"> 864</span></a>      }
<a name="l865"><span class="linenum"> 865</span></a>  
<a name="l866"><span class="linenum"> 866</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l867"><span class="linenum"> 867</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'report_security_check_google': ['report_security_check_google', 'Verifies google access not combined with disabled guest access because attackers might gain guest access by modifying browser signature. ', [['report/security','locallib.php',305]], 0],
'report_security_check_configrw': ['report_security_check_configrw', 'Verifies config.php is not writable anymore after installation, config files were changed on several outdated server. ', [['report/security','locallib.php',412]], 0],
'report_security_check_defaultuserrole': ['report_security_check_defaultuserrole', 'Verifies sanity of default user role. ', [['report/security','locallib.php',494]], 0],
'report_security_check_openprofiles': ['report_security_check_openprofiles', 'Verifies open profiles - originally open by default, not anymore because spammer abused it a lot ', [['report/security','locallib.php',274]], 0],
'is_https': ['is_https', 'Determines whether or not the Moodle site is being served over HTTPS. ', [['lib','weblib.php',226]], 20],
'on': ['on', '', [['lib/requirejs','require.js',506]], 3494],
'doc_link': ['doc_link', 'Returns document link for performance issue ', [['report/performance','locallib.php',94],['lib','outputrenderers.php',2050]], 18],
'list': ['list', '', [['mod/data/preset/imagegallery','jstemplate.js',9]], 1891],
'js_init_code': ['js_init_code', 'Add short static javascript code fragment to page footer. This is intended primarily for loading of js modules and initialising page layout. Ideally the JS code fragment should be stored in plugin renderer so that themes may override it. ', [['lib','outputrequirementslib.php',1074]], 7],
'format_string': ['format_string', 'Given a simple string, this function returns the string processed by enabled string filters if $CFG->filterall is enabled ', [['lib','weblib.php',1318]], 854],
'instance_by_id': ['instance_by_id', 'Get a context instance as an object, from a given context id. ', [['lib','accesslib.php',5383]], 174],
'addclass': ['addclass', '', [['lib/editor/atto/yui/build/moodle-editor_atto-rangy','moodle-editor_atto-rangy-debug.js',3262],['lib/editor/atto/yui/build/moodle-editor_atto-rangy','moodle-editor_atto-rangy.js',3262],['lib/editor/atto/yui/src/rangy/js','rangy-cssclassapplier.js',32]], 2443],
'instance': ['instance', 'Retrieve sole instance of the registry. ', [['lib/htmlpurifier/HTMLPurifier','URISchemeRegistry.php',9],['lib/classes/update','checker.php',62],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',29],['lib/classes','useragent.php',101],['backup/cc','validator.php',35],['lib/portfolio','exporter.php',251],['lib/tests','update_deployer_test.php',69],['lib/tests','string_manager_standard_test.php',124],['lib','modinfolib.php',373],['','mdeploy.php',96],['cache','disabledlib.php',171],['cache','disabledlib.php',296],['admin/tool/installaddon/classes','validator.php',85],['cache/classes','config.php',87],['course/format','lib.php',156],['lib','accesslib.php',6184],['lib','accesslib.php',6436],['lib','accesslib.php',6614],['lib','accesslib.php',6868],['lib','accesslib.php',7129],['lib','accesslib.php',7341],['cache','locallib.php',52],['lib/htmlpurifier','HTMLPurifier.php',251],['cache/classes','factory.php',114],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',53],['cache/classes','helper.php',76],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',31],['lib/classes','plugin_manager.php',83],['lib','filterlib.php',81],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',80],['lib/classes/update','deployer.php',54],['admin/tool/installaddon/classes','pluginfo_client.php',37],['admin/tool/installaddon/classes','installer.php',40],['backup/cc/cc_lib','cc_utils.php',387],['backup/cc/cc_lib','cc_utils.php',443]], 3942],
'report_security_check_riskadmin': ['report_security_check_riskadmin', 'Lists all admins. ', [['report/security','locallib.php',669]], 0],
'report_security_check_emailchangeconfirmation': ['report_security_check_emailchangeconfirmation', 'Verifies email confirmation - spammers were changing mails very often ', [['report/security','locallib.php',340]], 0],
'filter_get_globally_enabled': ['filter_get_globally_enabled', 'Return a list of all the filters that may be in use somewhere. ', [['lib','filterlib.php',678]], 2],
'sql_concat': ['sql_concat', '', [['lib/dml','pgsql_native_moodle_database.php',1315],['lib/dml','oci_native_moodle_database.php',1550],['lib/dml','sqlsrv_native_moodle_database.php',1257],['lib/dml','sqlite3_pdo_moodle_database.php',353],['lib/dml','mssql_native_moodle_database.php',1194],['lib/dml','mysqli_native_moodle_database.php',1531],['lib/dml/tests','dml_test.php',5433],['lib/dml','pdo_moodle_database.php',536]], 73],
'get_records_sql': ['get_records_sql', 'Get a number of records as an array of objects using a SQL statement. ', [['lib/dml','pgsql_native_moodle_database.php',732],['lib/dml','oci_native_moodle_database.php',1102],['lib/dml','sqlsrv_native_moodle_database.php',823],['lib/dml','mssql_native_moodle_database.php',741],['lib/dml','mysqli_native_moodle_database.php',1049],['lib/dml/tests','dml_test.php',5424],['lib/dml','pdo_moodle_database.php',308]], 678],
'get_record': ['get_record', 'Get a single database record as an object where all the given conditions met. ', [['lib/dml','moodle_database.php',1413]], 2960],
'report_security_check_embed': ['report_security_check_embed', 'Verifies sloppy embedding - this should have been removed long ago!! ', [['report/security','locallib.php',142]], 0],
'report_security_check_riskbackup': ['report_security_check_riskbackup', 'Lists all roles that have the ability to backup user data, as well as users ', [['report/security','locallib.php',711]], 0],
'report_security_check_mediafilterswf': ['report_security_check_mediafilterswf', 'Verifies sloppy swf embedding - this should have been removed long ago!! ', [['report/security','locallib.php',173]], 0],
'report_security_check_passwordpolicy': ['report_security_check_passwordpolicy', 'Verifies if password policy set ', [['report/security','locallib.php',111]], 0],
'report_security_check_frontpagerole': ['report_security_check_frontpagerole', 'Verifies sanity of frontpage role ', [['report/security','locallib.php',610]], 0],
'report_security_check_unsecuredataroot': ['report_security_check_unsecuredataroot', 'Verifies fatal misconfiguration of dataroot ', [['report/security','locallib.php',206]], 0],
'report_security_check_noauth': ['report_security_check_noauth', 'Verifies unsupported noauth setting ', [['report/security','locallib.php',79]], 0],
'report_security_check_displayerrors': ['report_security_check_displayerrors', 'Verifies displaying of errors - problem for lib files and 3rd party code because we can not disable debugging in these scripts (they do not include config.php) ', [['report/security','locallib.php',244]], 0],
'users_order_by_sql': ['users_order_by_sql', 'This function generates the standard ORDER BY clause for use when generating lists of users. If you don\'t have a reason to use a different order, then you should use this method to generate the order when displaying lists of users. ', [['lib','datalib.php',290]], 60],
'from': ['from', 'From clause ', [['lib/zend/Zend/Service/WindowsAzure/Storage','TableEntityQuery.php',84]], 226],
'report_security_check_guestrole': ['report_security_check_guestrole', 'Verifies sanity of guest role ', [['report/security','locallib.php',552]], 0],
'is_enabled_auth': ['is_enabled_auth', 'Checks if a given plugin is in the list of enabled authentication plugins. ', [['lib','moodlelib.php',3580]], 30],
'is_dataroot_insecure': ['is_dataroot_insecure', 'Try to verify that dataroot is not accessible from web. ', [['lib','adminlib.php',510]], 8],
'report_security_check_riskxss': ['report_security_check_riskxss', 'Lists all users with XSS risk, it would be great to combine this with risk trusts in user table, unfortunately nobody implemented user trust UI yet :-( ', [['report/security','locallib.php',445]], 0],
'report_security_check_webcron': ['report_security_check_webcron', 'Verifies the status of web cron ', [['report/security','locallib.php',835]], 0],
'get_context_name': ['get_context_name', 'Returns human readable context identifier. ', [['lib','accesslib.php',5588],['lib','accesslib.php',6138],['lib','accesslib.php',6380],['lib','accesslib.php',6567],['lib','accesslib.php',6799],['lib','accesslib.php',7021],['lib','accesslib.php',7263]], 53],
'role_get_name': ['role_get_name', 'Get localised role name or alias if exists and format the text. ', [['lib','accesslib.php',4497]], 46],
'report_security_hide_timearning': ['report_security_hide_timearning', '', [['report/security','locallib.php',35]], 2],
'fields': ['fields', 'Get the value of a field in the current row by column name. Will not work if ADODB_FETCH_MODE is set to ADODB_FETCH_NUM. ', [['lib/adodb','adodb.inc.php',3469],['lib/adodb','adodb.inc.php',4073],['lib/adodb/drivers','adodb-odbtp.inc.php',718],['lib/adodb/drivers','adodb-sqlite.inc.php',369],['lib/adodb/drivers','adodb-pdo.inc.php',611],['lib/adodb/drivers','adodb-mysqli.inc.php',963],['lib/adodb/drivers','adodb-mssql.inc.php',904],['mod/quiz/classes','admin_review_setting.php',65],['lib/adodb/drivers','adodb-postgres64.inc.php',951],['lib/adodb/drivers','adodb-oracle.inc.php',265],['lib/adodb/drivers','adodb-ado.inc.php',373],['lib','outputcomponents.php',235],['lib/adodb/drivers','adodb-ado5.inc.php',410],['lib/adodb/drivers','adodb-db2.inc.php',754],['lib/adodb/drivers','adodb-sqlite3.inc.php',399],['lib/adodb/drivers','adodb-mssqlnative.inc.php',888],['lib/adodb/drivers','adodb-ibase.inc.php',833],['lib/adodb/drivers','adodb-oci8po.inc.php',91],['lib/adodb/drivers','adodb-ads.inc.php',690],['lib/adodb/drivers','adodb-odbc.inc.php',642],['lib/adodb/drivers','adodb-mysql.inc.php',764],['lib/adodb/drivers','adodb-oci8.inc.php',1549]], 145],
'sql_bitand': ['sql_bitand', '', [['lib/dml','oci_native_moodle_database.php',1479],['lib/dml','moodle_database.php',1870]], 9],
'report_security_get_issue_list': ['report_security_get_issue_list', '', [['report/security','locallib.php',40]], 1],
'get_string': ['get_string', 'Return a core get_string() call ', [['lib/external','externallib.php',112],['lib','moodlelib.php',6538],['lib','moodlelib.php',9417],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38],['lib/classes','string_manager_install.php',95],['question/behaviour','behaviourbase.php',756]], 19235],
'report_security_check_cookiesecure': ['report_security_check_cookiesecure', 'Verifies if https enabled only secure cookies allowed, this prevents redirections and sending of cookies to unsecure port. ', [['report/security','locallib.php',376]], 0],
'fullname': ['fullname', 'Returns a persons full name ', [['lib','moodlelib.php',3234],['mod/assign','locallib.php',3440]], 532],
'count_records_sql': ['count_records_sql', 'Get the result of a SQL SELECT COUNT(...) query. ', [['lib/dml','moodle_database.php',1747]], 132],
'get_recordset_sql': ['get_recordset_sql', 'Get a number of records as a moodle_recordset using a SQL statement. ', [['lib/dml','pgsql_native_moodle_database.php',688],['lib/dml','oci_native_moodle_database.php',1065],['lib/dml','sqlsrv_native_moodle_database.php',761],['lib/dml','mssql_native_moodle_database.php',687],['lib/dml','mysqli_native_moodle_database.php',985],['lib/dml/tests','dml_test.php',5423],['lib/dml','pdo_moodle_database.php',251]], 279],
'report_security_doc_link': ['report_security_doc_link', '', [['report/security','locallib.php',64]], 1],
'count': ['count', '', [], 3984],
'is_writable': ['is_writable', '', [], 76],
'defined': ['defined', '', [], 4098],
'max': ['max', '', [], 1096],
'array_search': ['array_search', '', [], 188],
'define': ['define', '', [], 2170],
'implode': ['implode', '', [], 1259],
'array_merge': ['array_merge', '', [], 2320]};
CLASS_DATA={
'context_system': ['context_system', 'System context class ', [['lib','accesslib.php',6106]], 929],
'user_picture': ['user_picture', 'Data structure representing a user picture. ', [['lib','outputcomponents.php',142]], 135]};
CONST_DATA={
'REPORT_SECURITY_SERIOUS': ['REPORT_SECURITY_SERIOUS', '', [['report/security','locallib.php',32]], 5],
'REPORT_SECURITY_INFO': ['REPORT_SECURITY_INFO', '', [['report/security','locallib.php',30]], 5],
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',138],['','install.php',93],['lib','setup.php',386]], 3532],
'INSECURE_DATAROOT_ERROR': ['INSECURE_DATAROOT_ERROR', '', [['lib','adminlib.php',113]], 8],
'CAP_ALLOW': ['CAP_ALLOW', '', [['lib','accesslib.php',135]], 1292],
'CONTEXT_COURSE': ['CONTEXT_COURSE', '', [['lib','accesslib.php',148]], 422],
'INSECURE_DATAROOT_WARNING': ['INSECURE_DATAROOT_WARNING', '', [['lib','adminlib.php',112]], 6],
'ROLENAME_BOTH': ['ROLENAME_BOTH', '', [['lib','accesslib.php',176]], 27],
'RISK_DATALOSS': ['RISK_DATALOSS', '', [['lib','accesslib.php',169]], 22],
'RISK_CONFIG': ['RISK_CONFIG', '', [['lib','accesslib.php',161]], 25],
'REPORT_SECURITY_WARNING': ['REPORT_SECURITY_WARNING', '', [['report/security','locallib.php',31]], 12],
'REPORT_SECURITY_OK': ['REPORT_SECURITY_OK', '', [['report/security','locallib.php',29]], 19],
'RISK_XSS': ['RISK_XSS', '', [['lib','accesslib.php',163]], 138],
'WARN_DISPLAY_ERRORS_ENABLED': ['WARN_DISPLAY_ERRORS_ENABLED', '', [['lib','setup.php',649]], 3],
'REPORT_SECURITY_CRITICAL': ['REPORT_SECURITY_CRITICAL', '', [['report/security','locallib.php',33]], 9]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu May 28 19:17:31 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
