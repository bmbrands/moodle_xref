<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : Detail view of upgradelib.php</title>
    <link rel="stylesheet" href="../sample.css" type="text/css">
    <link rel="stylesheet" href="../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu May 28 19:17:31 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../';
subdir='lib';
filename='upgradelib.php.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="details-heading"><a href="./index.html">/lib/</a> -> <a href="upgradelib.php.source.html">upgradelib.php</a> (summary)</h2>
<div class="details-summary">
<p class="viewlinks">[<a href="upgradelib.php.source.html">Source view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="../_stats.html">Project Stats</a>]</p>
<p><b>Various upgrade/install related functions and classes.</b></p>
<table>
<tr><td align="right">Copyright: </td><td>1999 onwards Martin Dougiamas (http://dougiamas.com)</td></tr>
<tr><td align="right">License: </td><td><a href="http://www.gnu.org/copyleft/gpl.html" target="_blank">http://www.gnu.org/copyleft/gpl.html</a> GNU GPL v3 or later</td></tr>
<tr><td align="right">File Size: </td><td>2283 lines (89 kb)</td></tr>
<tr><td align="right">Included or required:</td><td>0 times</td></tr>
<tr><td align="right" valign="top">Referenced: </td><td>0 times</td></tr>
<tr><td align="right" valign="top">Includes or requires: </td><td>3 files<br>&nbsp;<a href="../lib/db/install.php.html">lib/db/install.php</a>
<br>&nbsp;<a href="../version.php.html">version.php</a>
<br>&nbsp;<a href="../lib/db/upgrade.php.html">lib/db/upgrade.php</a>
</td></tr>
</table>
<h3>Defines 5 classes</h3>
<div class="inset">
<p><b>upgrade_exception::</b> (1 method):<br>
&nbsp;&nbsp;<a href="#__construct">__construct</a>()<br>
</p>
<p><b>downgrade_exception::</b> (1 method):<br>
&nbsp;&nbsp;<a href="#__construct">__construct</a>()<br>
</p>
<p><b>upgrade_requires_exception::</b> (1 method):<br>
&nbsp;&nbsp;<a href="#__construct">__construct</a>()<br>
</p>
<p><b>plugin_defective_exception::</b> (1 method):<br>
&nbsp;&nbsp;<a href="#__construct">__construct</a>()<br>
</p>
<p><b>plugin_misplaced_exception::</b> (38 methods):<br>
&nbsp;&nbsp;<a href="#__construct">__construct</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_set_timeout">upgrade_set_timeout</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_main_savepoint">upgrade_main_savepoint</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_mod_savepoint">upgrade_mod_savepoint</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_block_savepoint">upgrade_block_savepoint</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_plugin_savepoint">upgrade_plugin_savepoint</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_stale_php_files_present">upgrade_stale_php_files_present</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_plugins">upgrade_plugins</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_plugins_modules">upgrade_plugins_modules</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_plugins_blocks">upgrade_plugins_blocks</a>()<br>
&nbsp;&nbsp;<a href="#log_update_descriptions">log_update_descriptions</a>()<br>
&nbsp;&nbsp;<a href="#external_update_descriptions">external_update_descriptions</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_handle_exception">upgrade_handle_exception</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_log">upgrade_log</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_started">upgrade_started</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_finished_handler">upgrade_finished_handler</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_finished">upgrade_finished</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_setup_debug">upgrade_setup_debug</a>()<br>
&nbsp;&nbsp;<a href="#print_upgrade_separator">print_upgrade_separator</a>()<br>
&nbsp;&nbsp;<a href="#print_upgrade_part_start">print_upgrade_part_start</a>()<br>
&nbsp;&nbsp;<a href="#print_upgrade_part_end">print_upgrade_part_end</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_init_javascript">upgrade_init_javascript</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_language_pack">upgrade_language_pack</a>()<br>
&nbsp;&nbsp;<a href="#install_core">install_core</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_core">upgrade_core</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_noncore">upgrade_noncore</a>()<br>
&nbsp;&nbsp;<a href="#core_tables_exist">core_tables_exist</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_plugin_mnet_functions">upgrade_plugin_mnet_functions</a>()<br>
&nbsp;&nbsp;<a href="#admin_mnet_method_profile">admin_mnet_method_profile</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_course_completion_remove_duplicates">upgrade_course_completion_remove_duplicates</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_save_orphaned_questions">upgrade_save_orphaned_questions</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_rename_old_backup_files_using_shortname">upgrade_rename_old_backup_files_using_shortname</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_grade_item_fix_sortorder">upgrade_grade_item_fix_sortorder</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_fix_missing_root_folders">upgrade_fix_missing_root_folders</a>()<br>
&nbsp;&nbsp;<a href="#upgrade_fix_missing_root_folders_draft">upgrade_fix_missing_root_folders_draft</a>()<br>
&nbsp;&nbsp;<a href="#check_database_storage_engine">check_database_storage_engine</a>()<br>
&nbsp;&nbsp;<a href="#check_slasharguments">check_slasharguments</a>()<br>
&nbsp;&nbsp;<a href="#check_database_tables_row_format">check_database_tables_row_format</a>()<br>
</p>
</div>
</div>
<br><div class="details-funclist">
<div class="details-classinfo">
<p class="details-classtitle">Class: <a name="upgrade_exception"><b>upgrade_exception</b></a>&nbsp;&nbsp;- <a href="../_classes/upgrade_exception.html"><small>X-Ref</small></a>
</p>
<b>Exception indicating unknown error during upgrade.<BR>
</b><br>
<div class="inset"><table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="__construct" onClick="logFunction('__construct', 'upgradelib.php.source.html#l45')" href="upgradelib.php.source.html#l45">__construct</a>(<a href="../_variables/plugin.html">$plugin</a>, <a href="../_variables/version.html">$version</a>, <a href="../_variables/debuginfo.html">$debuginfo</a>=NULL)&nbsp;&nbsp;
<a href="../_functions/__construct.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><i>No description</i></td></tr></table>

<br>
</div>
</div>
<div class="details-classinfo">
<p class="details-classtitle">Class: <a name="downgrade_exception"><b>downgrade_exception</b></a>&nbsp;&nbsp;- <a href="../_classes/downgrade_exception.html"><small>X-Ref</small></a>
</p>
<b>Exception indicating downgrade error during upgrade.<BR>
</b><br>
<div class="inset"><table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="__construct" onClick="logFunction('__construct', 'upgradelib.php.source.html#l61')" href="upgradelib.php.source.html#l61">__construct</a>(<a href="../_variables/plugin.html">$plugin</a>, <a href="../_variables/oldversion.html">$oldversion</a>, <a href="../_variables/newversion.html">$newversion</a>)&nbsp;&nbsp;
<a href="../_functions/__construct.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><i>No description</i></td></tr></table>

<br>
</div>
</div>
<div class="details-classinfo">
<p class="details-classtitle">Class: <a name="upgrade_requires_exception"><b>upgrade_requires_exception</b></a>&nbsp;&nbsp;- <a href="../_classes/upgrade_requires_exception.html"><small>X-Ref</small></a>
</p>
<b></b><br>
<div class="inset"><table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="__construct" onClick="logFunction('__construct', 'upgradelib.php.source.html#l76')" href="upgradelib.php.source.html#l76">__construct</a>(<a href="../_variables/plugin.html">$plugin</a>, <a href="../_variables/pluginversion.html">$pluginversion</a>, <a href="../_variables/currentmoodle.html">$currentmoodle</a>, <a href="../_variables/requiremoodle.html">$requiremoodle</a>)&nbsp;&nbsp;
<a href="../_functions/__construct.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><i>No description</i></td></tr></table>

<br>
</div>
</div>
<div class="details-classinfo">
<p class="details-classtitle">Class: <a name="plugin_defective_exception"><b>plugin_defective_exception</b></a>&nbsp;&nbsp;- <a href="../_classes/plugin_defective_exception.html"><small>X-Ref</small></a>
</p>
<b></b><br>
<div class="inset"><table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="__construct" onClick="logFunction('__construct', 'upgradelib.php.source.html#l94')" href="upgradelib.php.source.html#l94">__construct</a>(<a href="../_variables/plugin.html">$plugin</a>, <a href="../_variables/details.html">$details</a>)&nbsp;&nbsp;
<a href="../_functions/__construct.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><i>No description</i></td></tr></table>

<br>
</div>
</div>
<div class="details-classinfo">
<p class="details-classtitle">Class: <a name="plugin_misplaced_exception"><b>plugin_misplaced_exception</b></a>&nbsp;&nbsp;- <a href="../_classes/plugin_misplaced_exception.html"><small>X-Ref</small></a>
</p>
<b>Misplaced plugin exception.<BR>
</b><br>
Note: this should be used only from the upgrade/admin code.<BR>
<BR>
<div class="inset"><table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="__construct" onClick="logFunction('__construct', 'upgradelib.php.source.html#l111')" href="upgradelib.php.source.html#l111">__construct</a>(<a href="../_variables/component.html">$component</a>, <a href="../_variables/expected.html">$expected</a>, <a href="../_variables/current.html">$current</a>)&nbsp;&nbsp;
<a href="../_functions/__construct.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Constructor.<BR>
</b><BR><b>param:</b> string $component the component from version.php<br>
<b>param:</b> string $expected expected directory, null means calculate<br>
<b>param:</b> string $current plugin directory path<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_set_timeout" onClick="logFunction('upgrade_set_timeout', 'upgradelib.php.source.html#l140')" href="upgradelib.php.source.html#l140">upgrade_set_timeout</a>(<a href="../_variables/max_execution_time.html">$max_execution_time</a>=300)&nbsp;&nbsp;
<a href="../_functions/upgrade_set_timeout.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Sets maximum expected time needed for upgrade task.<BR>
Please always make sure that upgrade will not run longer!<BR>
</b><BR>The script may be automatically aborted if upgrade times out.<BR>
<BR>
<b>param:</b> int $max_execution_time in seconds (can not be less than 60 s)<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_main_savepoint" onClick="logFunction('upgrade_main_savepoint', 'upgradelib.php.source.html#l189')" href="upgradelib.php.source.html#l189">upgrade_main_savepoint</a>(<a href="../_variables/result.html">$result</a>, <a href="../_variables/version.html">$version</a>, <a href="../_variables/allowabort.html">$allowabort</a>=true)&nbsp;&nbsp;
<a href="../_functions/upgrade_main_savepoint.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Upgrade savepoint, marks end of each upgrade block.<BR>
It stores new main version, resets upgrade timeout<BR>
and abort upgrade if user cancels page loading.<BR>
</b><BR>Please do not make large upgrade blocks with lots of operations,<BR>
for example when adding tables keep only one table operation per block.<BR>
<BR>
<b>param:</b> bool $result false if upgrade step failed, true if completed<br>
<b>param:</b> string or float $version main version<br>
<b>param:</b> bool $allowabort allow user to abort script execution here<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_mod_savepoint" onClick="logFunction('upgrade_mod_savepoint', 'upgradelib.php.source.html#l233')" href="upgradelib.php.source.html#l233">upgrade_mod_savepoint</a>(<a href="../_variables/result.html">$result</a>, <a href="../_variables/version.html">$version</a>, <a href="../_variables/modname.html">$modname</a>, <a href="../_variables/allowabort.html">$allowabort</a>=true)&nbsp;&nbsp;
<a href="../_functions/upgrade_mod_savepoint.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Module upgrade savepoint, marks end of module upgrade blocks<BR>
It stores module version, resets upgrade timeout<BR>
and abort upgrade if user cancels page loading.<BR>
</b><BR><b>param:</b> bool $result false if upgrade step failed, true if completed<br>
<b>param:</b> string or float $version main version<br>
<b>param:</b> string $modname name of module<br>
<b>param:</b> bool $allowabort allow user to abort script execution here<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_block_savepoint" onClick="logFunction('upgrade_block_savepoint', 'upgradelib.php.source.html#l277')" href="upgradelib.php.source.html#l277">upgrade_block_savepoint</a>(<a href="../_variables/result.html">$result</a>, <a href="../_variables/version.html">$version</a>, <a href="../_variables/blockname.html">$blockname</a>, <a href="../_variables/allowabort.html">$allowabort</a>=true)&nbsp;&nbsp;
<a href="../_functions/upgrade_block_savepoint.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Blocks upgrade savepoint, marks end of blocks upgrade blocks<BR>
It stores block version, resets upgrade timeout<BR>
and abort upgrade if user cancels page loading.<BR>
</b><BR><b>param:</b> bool $result false if upgrade step failed, true if completed<br>
<b>param:</b> string or float $version main version<br>
<b>param:</b> string $blockname name of block<br>
<b>param:</b> bool $allowabort allow user to abort script execution here<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_plugin_savepoint" onClick="logFunction('upgrade_plugin_savepoint', 'upgradelib.php.source.html#l321')" href="upgradelib.php.source.html#l321">upgrade_plugin_savepoint</a>(<a href="../_variables/result.html">$result</a>, <a href="../_variables/version.html">$version</a>, <a href="../_variables/type.html">$type</a>, <a href="../_variables/plugin.html">$plugin</a>, <a href="../_variables/allowabort.html">$allowabort</a>=true)&nbsp;&nbsp;
<a href="../_functions/upgrade_plugin_savepoint.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Plugins upgrade savepoint, marks end of blocks upgrade blocks<BR>
It stores plugin version, resets upgrade timeout<BR>
and abort upgrade if user cancels page loading.<BR>
</b><BR><b>param:</b> bool $result false if upgrade step failed, true if completed<br>
<b>param:</b> string or float $version main version<br>
<b>param:</b> string $type name of plugin<br>
<b>param:</b> string $dir location of plugin<br>
<b>param:</b> bool $allowabort allow user to abort script execution here<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_stale_php_files_present" onClick="logFunction('upgrade_stale_php_files_present', 'upgradelib.php.source.html#l361')" href="upgradelib.php.source.html#l361">upgrade_stale_php_files_present</a>()&nbsp;&nbsp;
<a href="../_functions/upgrade_stale_php_files_present.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Detect if there are leftovers in PHP source files.<BR>
</b><BR>During main version upgrades administrators MUST move away<BR>
old PHP source files and start from scratch (or better<BR>
use git).<BR>
<BR>
<b>return:</b> bool true means borked upgrade, false means previous PHP files were properly removed<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_plugins" onClick="logFunction('upgrade_plugins', 'upgradelib.php.source.html#l414')" href="upgradelib.php.source.html#l414">upgrade_plugins</a>(<a href="../_variables/type.html">$type</a>, <a href="../_variables/startcallback.html">$startcallback</a>, <a href="../_variables/endcallback.html">$endcallback</a>, <a href="../_variables/verbose.html">$verbose</a>)&nbsp;&nbsp;
<a href="../_functions/upgrade_plugins.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Upgrade plugins<BR>
</b><BR><b>param:</b> string $type The type of plugins that should be updated (e.g. 'enrol', 'qtype')<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_plugins_modules" onClick="logFunction('upgrade_plugins_modules', 'upgradelib.php.source.html#l573')" href="upgradelib.php.source.html#l573">upgrade_plugins_modules</a>(<a href="../_variables/startcallback.html">$startcallback</a>, <a href="../_variables/endcallback.html">$endcallback</a>, <a href="../_variables/verbose.html">$verbose</a>)&nbsp;&nbsp;
<a href="../_functions/upgrade_plugins_modules.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Find and check all modules and load them up or upgrade them if necessary<BR>
</b><BR></td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_plugins_blocks" onClick="logFunction('upgrade_plugins_blocks', 'upgradelib.php.source.html#l742')" href="upgradelib.php.source.html#l742">upgrade_plugins_blocks</a>(<a href="../_variables/startcallback.html">$startcallback</a>, <a href="../_variables/endcallback.html">$endcallback</a>, <a href="../_variables/verbose.html">$verbose</a>)&nbsp;&nbsp;
<a href="../_functions/upgrade_plugins_blocks.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>This function finds all available blocks and install them<BR>
into blocks table or do all the upgrade process if newer.<BR>
</b><BR></td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="log_update_descriptions" onClick="logFunction('log_update_descriptions', 'upgradelib.php.source.html#l950')" href="upgradelib.php.source.html#l950">log_update_descriptions</a>(<a href="../_variables/component.html">$component</a>)&nbsp;&nbsp;
<a href="../_functions/log_update_descriptions.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Log_display description function used during install and upgrade.<BR>
</b><BR><b>param:</b> string $component name of component (moodle, mod_assignment, etc.)<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="external_update_descriptions" onClick="logFunction('external_update_descriptions', 'upgradelib.php.source.html#l1008')" href="upgradelib.php.source.html#l1008">external_update_descriptions</a>(<a href="../_variables/component.html">$component</a>)&nbsp;&nbsp;
<a href="../_functions/external_update_descriptions.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Web service discovery function used during install and upgrade.<BR>
</b><BR><b>param:</b> string $component name of component (moodle, mod_assignment, etc.)<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_handle_exception" onClick="logFunction('upgrade_handle_exception', 'upgradelib.php.source.html#l1183')" href="upgradelib.php.source.html#l1183">upgrade_handle_exception</a>(<a href="../_variables/ex.html">$ex</a>, <a href="../_variables/plugin.html">$plugin</a> = null)&nbsp;&nbsp;
<a href="../_functions/upgrade_handle_exception.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>upgrade logging functions<BR>
</b><BR></td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_log" onClick="logFunction('upgrade_log', 'upgradelib.php.source.html#l1203')" href="upgradelib.php.source.html#l1203">upgrade_log</a>(<a href="../_variables/type.html">$type</a>, <a href="../_variables/plugin.html">$plugin</a>, <a href="../_variables/info.html">$info</a>, <a href="../_variables/details.html">$details</a>=null, <a href="../_variables/backtrace.html">$backtrace</a>=null)&nbsp;&nbsp;
<a href="../_functions/upgrade_log.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Adds log entry into upgrade_log table<BR>
</b><BR><b>param:</b> int $type UPGRADE_LOG_NORMAL, UPGRADE_LOG_NOTICE or UPGRADE_LOG_ERROR<br>
<b>param:</b> string $plugin frankenstyle component name<br>
<b>param:</b> string $info short description text of log entry<br>
<b>param:</b> string $details long problem description<br>
<b>param:</b> string $backtrace string used for errors only<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_started" onClick="logFunction('upgrade_started', 'upgradelib.php.source.html#l1269')" href="upgradelib.php.source.html#l1269">upgrade_started</a>(<a href="../_variables/preinstall.html">$preinstall</a>=false)&nbsp;&nbsp;
<a href="../_functions/upgrade_started.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Marks start of upgrade, blocks any other access to site.<BR>
The upgrade is finished at the end of script or after timeout.<BR>
</b><BR></td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_finished_handler" onClick="logFunction('upgrade_finished_handler', 'upgradelib.php.source.html#l1309')" href="upgradelib.php.source.html#l1309">upgrade_finished_handler</a>()&nbsp;&nbsp;
<a href="../_functions/upgrade_finished_handler.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Internal function - executed if upgrade interrupted.<BR>
</b><BR></td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_finished" onClick="logFunction('upgrade_finished', 'upgradelib.php.source.html#l1316')" href="upgradelib.php.source.html#l1316">upgrade_finished</a>(<a href="../_variables/continueurl.html">$continueurl</a>=null)&nbsp;&nbsp;
<a href="../_functions/upgrade_finished.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Indicates upgrade is finished.<BR>
</b><BR>This function may be called repeatedly.<BR>
<BR>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_setup_debug" onClick="logFunction('upgrade_setup_debug', 'upgradelib.php.source.html#l1349')" href="upgradelib.php.source.html#l1349">upgrade_setup_debug</a>(<a href="../_variables/starting.html">$starting</a>)&nbsp;&nbsp;
<a href="../_functions/upgrade_setup_debug.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b></b><BR></td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="print_upgrade_separator" onClick="logFunction('print_upgrade_separator', 'upgradelib.php.source.html#l1366')" href="upgradelib.php.source.html#l1366">print_upgrade_separator</a>()&nbsp;&nbsp;
<a href="../_functions/print_upgrade_separator.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><i>No description</i></td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="print_upgrade_part_start" onClick="logFunction('print_upgrade_part_start', 'upgradelib.php.source.html#l1372')" href="upgradelib.php.source.html#l1372">print_upgrade_part_start</a>(<a href="../_variables/plugin.html">$plugin</a>, <a href="../_variables/installation.html">$installation</a>, <a href="../_variables/verbose.html">$verbose</a>)&nbsp;&nbsp;
<a href="../_functions/print_upgrade_part_start.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Default start upgrade callback<BR>
</b><BR><b>param:</b> string $plugin<br>
<b>param:</b> bool $installation true if installation, false means upgrade<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="print_upgrade_part_end" onClick="logFunction('print_upgrade_part_end', 'upgradelib.php.source.html#l1405')" href="upgradelib.php.source.html#l1405">print_upgrade_part_end</a>(<a href="../_variables/plugin.html">$plugin</a>, <a href="../_variables/installation.html">$installation</a>, <a href="../_variables/verbose.html">$verbose</a>)&nbsp;&nbsp;
<a href="../_functions/print_upgrade_part_end.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Default end upgrade callback<BR>
</b><BR><b>param:</b> string $plugin<br>
<b>param:</b> bool $installation true if installation, false means upgrade<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_init_javascript" onClick="logFunction('upgrade_init_javascript', 'upgradelib.php.source.html#l1432')" href="upgradelib.php.source.html#l1432">upgrade_init_javascript</a>()&nbsp;&nbsp;
<a href="../_functions/upgrade_init_javascript.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Sets up JS code required for all upgrade scripts.<BR>
</b><BR></td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_language_pack" onClick="logFunction('upgrade_language_pack', 'upgradelib.php.source.html#l1444')" href="upgradelib.php.source.html#l1444">upgrade_language_pack</a>(<a href="../_variables/lang.html">$lang</a> = null)&nbsp;&nbsp;
<a href="../_functions/upgrade_language_pack.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Try to upgrade the given language pack (or current language)<BR>
</b><BR><b>param:</b> string $lang the code of the language to update, defaults to the current language<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="install_core" onClick="logFunction('install_core', 'upgradelib.php.source.html#l1485')" href="upgradelib.php.source.html#l1485">install_core</a>(<a href="../_variables/version.html">$version</a>, <a href="../_variables/verbose.html">$verbose</a>)&nbsp;&nbsp;
<a href="../_functions/install_core.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Install core moodle tables and initialize<BR>
</b><BR><b>param:</b> float $version target version<br>
<b>param:</b> bool $verbose<br>
<b>return:</b> void, may throw exception<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_core" onClick="logFunction('upgrade_core', 'upgradelib.php.source.html#l1542')" href="upgradelib.php.source.html#l1542">upgrade_core</a>(<a href="../_variables/version.html">$version</a>, <a href="../_variables/verbose.html">$verbose</a>)&nbsp;&nbsp;
<a href="../_functions/upgrade_core.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Upgrade moodle core<BR>
</b><BR><b>param:</b> float $version target version<br>
<b>param:</b> bool $verbose<br>
<b>return:</b> void, may throw exception<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_noncore" onClick="logFunction('upgrade_noncore', 'upgradelib.php.source.html#l1612')" href="upgradelib.php.source.html#l1612">upgrade_noncore</a>(<a href="../_variables/verbose.html">$verbose</a>)&nbsp;&nbsp;
<a href="../_functions/upgrade_noncore.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Upgrade/install other parts of moodle<BR>
</b><BR><b>param:</b> bool $verbose<br>
<b>return:</b> void, may throw exception<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="core_tables_exist" onClick="logFunction('core_tables_exist', 'upgradelib.php.source.html#l1646')" href="upgradelib.php.source.html#l1646">core_tables_exist</a>()&nbsp;&nbsp;
<a href="../_functions/core_tables_exist.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Checks if the main tables have been installed yet or not.<BR>
</b><BR>Note: we can not use caches here because they might be stale,<BR>
use with care!<BR>
<BR>
<b>return:</b> bool<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_plugin_mnet_functions" onClick="logFunction('upgrade_plugin_mnet_functions', 'upgradelib.php.source.html#l1671')" href="upgradelib.php.source.html#l1671">upgrade_plugin_mnet_functions</a>(<a href="../_variables/component.html">$component</a>)&nbsp;&nbsp;
<a href="../_functions/upgrade_plugin_mnet_functions.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>upgrades the mnet rpc definitions for the given component.<BR>
this method doesn't return status, an exception will be thrown in the case of an error<BR>
</b><BR><b>param:</b> string $component the plugin to upgrade, eg auth_mnet<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="admin_mnet_method_profile" onClick="logFunction('admin_mnet_method_profile', 'upgradelib.php.source.html#l1859')" href="upgradelib.php.source.html#l1859">admin_mnet_method_profile</a>(Zend_Server_Reflection_Function_Abstract <a href="../_variables/function.html">$function</a>)&nbsp;&nbsp;
<a href="../_functions/admin_mnet_method_profile.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Given some sort of Zend Reflection function/method object, return a profile array, ready to be serialized and stored<BR>
</b><BR><b>param:</b> Zend_Server_Reflection_Function_Abstract $function can be any subclass of this object type<br>
<b>return:</b> array<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_course_completion_remove_duplicates" onClick="logFunction('upgrade_course_completion_remove_duplicates', 'upgradelib.php.source.html#l1888')" href="upgradelib.php.source.html#l1888">upgrade_course_completion_remove_duplicates</a>(<a href="../_variables/table.html">$table</a>, <a href="../_variables/uniques.html">$uniques</a>, <a href="../_variables/fieldstocheck.html">$fieldstocheck</a> = array()&nbsp;&nbsp;
<a href="../_functions/upgrade_course_completion_remove_duplicates.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>This function finds duplicate records (based on combinations of fields that should be unique)<BR>
and then progamatically generated a &quot;most correct&quot; version of the data, update and removing<BR>
records as appropriate<BR>
</b><BR>Thanks to Dan Marsden for help<BR>
<BR>
<b>param:</b> string&nbsp;&nbsp;$table&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Table name<br>
<b>param:</b> array&nbsp;&nbsp;&nbsp;$uniques&nbsp;&nbsp;&nbsp;&nbsp;Array of field names that should be unique<br>
<b>param:</b> array&nbsp;&nbsp;&nbsp;$fieldstocheck&nbsp;&nbsp;Array of fields to generate &quot;correct&quot; data from (optional)<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_save_orphaned_questions" onClick="logFunction('upgrade_save_orphaned_questions', 'upgradelib.php.source.html#l1962')" href="upgradelib.php.source.html#l1962">upgrade_save_orphaned_questions</a>()&nbsp;&nbsp;
<a href="../_functions/upgrade_save_orphaned_questions.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Find questions missing an existing category and associate them with<BR>
a category which purpose is to gather them.<BR>
</b><BR><b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_rename_old_backup_files_using_shortname" onClick="logFunction('upgrade_rename_old_backup_files_using_shortname', 'upgradelib.php.source.html#l2002')" href="upgradelib.php.source.html#l2002">upgrade_rename_old_backup_files_using_shortname</a>()&nbsp;&nbsp;
<a href="../_functions/upgrade_rename_old_backup_files_using_shortname.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Rename old backup files to current backup files.<BR>
</b><BR>When added the setting 'backup_shortname' (MDL-28657) the backup file names did not contain the id of the course.<BR>
Further we fixed that behaviour by forcing the id to be always present in the file name (MDL-33812).<BR>
This function will explore the backup directory and attempt to rename the previously created files to include<BR>
the id in the name. Doing this will put them back in the process of deleting the excess backups for each course.<BR>
<BR>
This function manually recreates the file name, instead of using<BR>
{@link backup_plan_dbops::get_default_backup_filename()}, use it carefully if you're using it outside of the<BR>
usual upgrade process.<BR>
<BR>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_grade_item_fix_sortorder" onClick="logFunction('upgrade_grade_item_fix_sortorder', 'upgradelib.php.source.html#l2103')" href="upgradelib.php.source.html#l2103">upgrade_grade_item_fix_sortorder</a>()&nbsp;&nbsp;
<a href="../_functions/upgrade_grade_item_fix_sortorder.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Detect duplicate grade item sortorders and resort the<BR>
items to remove them.<BR>
</b><BR></td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_fix_missing_root_folders" onClick="logFunction('upgrade_fix_missing_root_folders', 'upgradelib.php.source.html#l2150')" href="upgradelib.php.source.html#l2150">upgrade_fix_missing_root_folders</a>()&nbsp;&nbsp;
<a href="../_functions/upgrade_fix_missing_root_folders.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Detect file areas with missing root directory records and add them.<BR>
</b><BR></td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="upgrade_fix_missing_root_folders_draft" onClick="logFunction('upgrade_fix_missing_root_folders_draft', 'upgradelib.php.source.html#l2181')" href="upgradelib.php.source.html#l2181">upgrade_fix_missing_root_folders_draft</a>()&nbsp;&nbsp;
<a href="../_functions/upgrade_fix_missing_root_folders_draft.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Detect draft file areas with missing root directory records and add them.<BR>
</b><BR></td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="check_database_storage_engine" onClick="logFunction('check_database_storage_engine', 'upgradelib.php.source.html#l2211')" href="upgradelib.php.source.html#l2211">check_database_storage_engine</a>(environment_results <a href="../_variables/result.html">$result</a>)&nbsp;&nbsp;
<a href="../_functions/check_database_storage_engine.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>This function verifies that the database is not using an unsupported storage engine.<BR>
</b><BR><b>param:</b> environment_results $result object to update, if relevant<br>
<b>return:</b> environment_results|null updated results object, or null if the storage engine is supported<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="check_slasharguments" onClick="logFunction('check_slasharguments', 'upgradelib.php.source.html#l2235')" href="upgradelib.php.source.html#l2235">check_slasharguments</a>(environment_results <a href="../_variables/result.html">$result</a>)&nbsp;&nbsp;
<a href="../_functions/check_slasharguments.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Method used to check the usage of slasharguments config and display a warning message.<BR>
</b><BR><b>param:</b> environment_results $result object to update, if relevant.<br>
<b>return:</b> environment_results|null updated results or null if slasharguments is disabled.<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="check_database_tables_row_format" onClick="logFunction('check_database_tables_row_format', 'upgradelib.php.source.html#l2253')" href="upgradelib.php.source.html#l2253">check_database_tables_row_format</a>(environment_results <a href="../_variables/result.html">$result</a>)&nbsp;&nbsp;
<a href="../_functions/check_database_tables_row_format.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>This function verifies if the database has tables using innoDB Antelope row format.<BR>
</b><BR><b>param:</b> environment_results $result<br>
<b>return:</b> environment_results|null updated results object, or null if no Antelope table has been found.<br>
</td></tr></table>

<br>
</div>
</div>

</div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu May 28 19:17:31 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
