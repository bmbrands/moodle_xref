<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /lib/moodlelib.php source</title>
    <link rel="stylesheet" href="../sample.css" type="text/css">
    <link rel="stylesheet" href="../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu May 28 19:17:31 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../';
subdir='lib';
filename='moodlelib.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/lib/</a> -> <a href="moodlelib.php.html">moodlelib.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="moodlelib.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="moodlelib.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * moodlelib.php - Moodle main library</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * Main library file of miscellaneous general-purpose Moodle functions.</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * Other main libraries:</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> *  - weblib.php      - functions that produce web output</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> *  - datalib.php     - functions that access the database</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> *</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment"> * @package    core</span>
<a name="l26"><span class="linenum">  26</span></a>  <span class="comment"> * @subpackage lib</span>
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment"> * @copyright  1999 onwards Martin Dougiamas  http://dougiamas.com</span>
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment"> */</span>
<a name="l30"><span class="linenum">  30</span></a>  
<a name="l31"><span class="linenum">  31</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die();
<a name="l32"><span class="linenum">  32</span></a>  
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment">// CONSTANTS (Encased in phpdoc proper comments).</span>
<a name="l34"><span class="linenum">  34</span></a>  
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment">// Date and time constants.</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment">/**</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment"> * Time constant - the number of seconds in a year</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment"> */</span>
<a name="l39"><span class="linenum">  39</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('YEARSECS')" href="../_constants/YEARSECS.html" onMouseOver="constPopup(event,'YEARSECS')">YEARSECS</a>', 31536000);
<a name="l40"><span class="linenum">  40</span></a>  
<a name="l41"><span class="linenum">  41</span></a>  <span class="comment">/**</span>
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment"> * Time constant - the number of seconds in a week</span>
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment"> */</span>
<a name="l44"><span class="linenum">  44</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('WEEKSECS')" href="../_constants/WEEKSECS.html" onMouseOver="constPopup(event,'WEEKSECS')">WEEKSECS</a>', 604800);
<a name="l45"><span class="linenum">  45</span></a>  
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment">/**</span>
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment"> * Time constant - the number of seconds in a day</span>
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment"> */</span>
<a name="l49"><span class="linenum">  49</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('DAYSECS')" href="../_constants/DAYSECS.html" onMouseOver="constPopup(event,'DAYSECS')">DAYSECS</a>', 86400);
<a name="l50"><span class="linenum">  50</span></a>  
<a name="l51"><span class="linenum">  51</span></a>  <span class="comment">/**</span>
<a name="l52"><span class="linenum">  52</span></a>  <span class="comment"> * Time constant - the number of seconds in an hour</span>
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment"> */</span>
<a name="l54"><span class="linenum">  54</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('HOURSECS')" href="../_constants/HOURSECS.html" onMouseOver="constPopup(event,'HOURSECS')">HOURSECS</a>', 3600);
<a name="l55"><span class="linenum">  55</span></a>  
<a name="l56"><span class="linenum">  56</span></a>  <span class="comment">/**</span>
<a name="l57"><span class="linenum">  57</span></a>  <span class="comment"> * Time constant - the number of seconds in a minute</span>
<a name="l58"><span class="linenum">  58</span></a>  <span class="comment"> */</span>
<a name="l59"><span class="linenum">  59</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('MINSECS')" href="../_constants/MINSECS.html" onMouseOver="constPopup(event,'MINSECS')">MINSECS</a>', 60);
<a name="l60"><span class="linenum">  60</span></a>  
<a name="l61"><span class="linenum">  61</span></a>  <span class="comment">/**</span>
<a name="l62"><span class="linenum">  62</span></a>  <span class="comment"> * Time constant - the number of minutes in a day</span>
<a name="l63"><span class="linenum">  63</span></a>  <span class="comment"> */</span>
<a name="l64"><span class="linenum">  64</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('DAYMINS')" href="../_constants/DAYMINS.html" onMouseOver="constPopup(event,'DAYMINS')">DAYMINS</a>', 1440);
<a name="l65"><span class="linenum">  65</span></a>  
<a name="l66"><span class="linenum">  66</span></a>  <span class="comment">/**</span>
<a name="l67"><span class="linenum">  67</span></a>  <span class="comment"> * Time constant - the number of minutes in an hour</span>
<a name="l68"><span class="linenum">  68</span></a>  <span class="comment"> */</span>
<a name="l69"><span class="linenum">  69</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('HOURMINS')" href="../_constants/HOURMINS.html" onMouseOver="constPopup(event,'HOURMINS')">HOURMINS</a>', 60);
<a name="l70"><span class="linenum">  70</span></a>  
<a name="l71"><span class="linenum">  71</span></a>  <span class="comment">// Parameter constants - every call to optional_param(), required_param()</span>
<a name="l72"><span class="linenum">  72</span></a>  <span class="comment">// or clean_param() should have a specified type of parameter.</span>
<a name="l73"><span class="linenum">  73</span></a>  
<a name="l74"><span class="linenum">  74</span></a>  <span class="comment">/**</span>
<a name="l75"><span class="linenum">  75</span></a>  <span class="comment"> * PARAM_ALPHA - contains only english ascii letters a-zA-Z.</span>
<a name="l76"><span class="linenum">  76</span></a>  <span class="comment"> */</span>
<a name="l77"><span class="linenum">  77</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_ALPHA')" href="../_constants/PARAM_ALPHA.html" onMouseOver="constPopup(event,'PARAM_ALPHA')">PARAM_ALPHA</a>',    'alpha');
<a name="l78"><span class="linenum">  78</span></a>  
<a name="l79"><span class="linenum">  79</span></a>  <span class="comment">/**</span>
<a name="l80"><span class="linenum">  80</span></a>  <span class="comment"> * PARAM_ALPHAEXT the same contents as PARAM_ALPHA plus the chars in quotes: &quot;_-&quot; allowed</span>
<a name="l81"><span class="linenum">  81</span></a>  <span class="comment"> * NOTE: originally this allowed &quot;/&quot; too, please use PARAM_SAFEPATH if &quot;/&quot; needed</span>
<a name="l82"><span class="linenum">  82</span></a>  <span class="comment"> */</span>
<a name="l83"><span class="linenum">  83</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_ALPHAEXT')" href="../_constants/PARAM_ALPHAEXT.html" onMouseOver="constPopup(event,'PARAM_ALPHAEXT')">PARAM_ALPHAEXT</a>', 'alphaext');
<a name="l84"><span class="linenum">  84</span></a>  
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment">/**</span>
<a name="l86"><span class="linenum">  86</span></a>  <span class="comment"> * PARAM_ALPHANUM - expected numbers and letters only.</span>
<a name="l87"><span class="linenum">  87</span></a>  <span class="comment"> */</span>
<a name="l88"><span class="linenum">  88</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_ALPHANUM')" href="../_constants/PARAM_ALPHANUM.html" onMouseOver="constPopup(event,'PARAM_ALPHANUM')">PARAM_ALPHANUM</a>', 'alphanum');
<a name="l89"><span class="linenum">  89</span></a>  
<a name="l90"><span class="linenum">  90</span></a>  <span class="comment">/**</span>
<a name="l91"><span class="linenum">  91</span></a>  <span class="comment"> * PARAM_ALPHANUMEXT - expected numbers, letters only and _-.</span>
<a name="l92"><span class="linenum">  92</span></a>  <span class="comment"> */</span>
<a name="l93"><span class="linenum">  93</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_ALPHANUMEXT')" href="../_constants/PARAM_ALPHANUMEXT.html" onMouseOver="constPopup(event,'PARAM_ALPHANUMEXT')">PARAM_ALPHANUMEXT</a>', 'alphanumext');
<a name="l94"><span class="linenum">  94</span></a>  
<a name="l95"><span class="linenum">  95</span></a>  <span class="comment">/**</span>
<a name="l96"><span class="linenum">  96</span></a>  <span class="comment"> * PARAM_AUTH - actually checks to make sure the string is a valid auth plugin</span>
<a name="l97"><span class="linenum">  97</span></a>  <span class="comment"> */</span>
<a name="l98"><span class="linenum">  98</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_AUTH')" href="../_constants/PARAM_AUTH.html" onMouseOver="constPopup(event,'PARAM_AUTH')">PARAM_AUTH</a>',  'auth');
<a name="l99"><span class="linenum">  99</span></a>  
<a name="l100"><span class="linenum"> 100</span></a>  <span class="comment">/**</span>
<a name="l101"><span class="linenum"> 101</span></a>  <span class="comment"> * PARAM_BASE64 - Base 64 encoded format</span>
<a name="l102"><span class="linenum"> 102</span></a>  <span class="comment"> */</span>
<a name="l103"><span class="linenum"> 103</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_BASE64')" href="../_constants/PARAM_BASE64.html" onMouseOver="constPopup(event,'PARAM_BASE64')">PARAM_BASE64</a>',   'base64');
<a name="l104"><span class="linenum"> 104</span></a>  
<a name="l105"><span class="linenum"> 105</span></a>  <span class="comment">/**</span>
<a name="l106"><span class="linenum"> 106</span></a>  <span class="comment"> * PARAM_BOOL - converts input into 0 or 1, use for switches in forms and urls.</span>
<a name="l107"><span class="linenum"> 107</span></a>  <span class="comment"> */</span>
<a name="l108"><span class="linenum"> 108</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_BOOL')" href="../_constants/PARAM_BOOL.html" onMouseOver="constPopup(event,'PARAM_BOOL')">PARAM_BOOL</a>',     'bool');
<a name="l109"><span class="linenum"> 109</span></a>  
<a name="l110"><span class="linenum"> 110</span></a>  <span class="comment">/**</span>
<a name="l111"><span class="linenum"> 111</span></a>  <span class="comment"> * PARAM_CAPABILITY - A capability name, like 'moodle/role:manage'. Actually</span>
<a name="l112"><span class="linenum"> 112</span></a>  <span class="comment"> * checked against the list of capabilities in the database.</span>
<a name="l113"><span class="linenum"> 113</span></a>  <span class="comment"> */</span>
<a name="l114"><span class="linenum"> 114</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_CAPABILITY')" href="../_constants/PARAM_CAPABILITY.html" onMouseOver="constPopup(event,'PARAM_CAPABILITY')">PARAM_CAPABILITY</a>',   'capability');
<a name="l115"><span class="linenum"> 115</span></a>  
<a name="l116"><span class="linenum"> 116</span></a>  <span class="comment">/**</span>
<a name="l117"><span class="linenum"> 117</span></a>  <span class="comment"> * PARAM_CLEANHTML - cleans submitted HTML code. Note that you almost never want</span>
<a name="l118"><span class="linenum"> 118</span></a>  <span class="comment"> * to use this. The normal mode of operation is to use PARAM_RAW when recieving</span>
<a name="l119"><span class="linenum"> 119</span></a>  <span class="comment"> * the input (required/optional_param or formslib) and then sanitse the HTML</span>
<a name="l120"><span class="linenum"> 120</span></a>  <span class="comment"> * using format_text on output. This is for the rare cases when you want to</span>
<a name="l121"><span class="linenum"> 121</span></a>  <span class="comment"> * sanitise the HTML on input. This cleaning may also fix xhtml strictness.</span>
<a name="l122"><span class="linenum"> 122</span></a>  <span class="comment"> */</span>
<a name="l123"><span class="linenum"> 123</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_CLEANHTML')" href="../_constants/PARAM_CLEANHTML.html" onMouseOver="constPopup(event,'PARAM_CLEANHTML')">PARAM_CLEANHTML</a>', 'cleanhtml');
<a name="l124"><span class="linenum"> 124</span></a>  
<a name="l125"><span class="linenum"> 125</span></a>  <span class="comment">/**</span>
<a name="l126"><span class="linenum"> 126</span></a>  <span class="comment"> * PARAM_EMAIL - an email address following the RFC</span>
<a name="l127"><span class="linenum"> 127</span></a>  <span class="comment"> */</span>
<a name="l128"><span class="linenum"> 128</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_EMAIL')" href="../_constants/PARAM_EMAIL.html" onMouseOver="constPopup(event,'PARAM_EMAIL')">PARAM_EMAIL</a>',   'email');
<a name="l129"><span class="linenum"> 129</span></a>  
<a name="l130"><span class="linenum"> 130</span></a>  <span class="comment">/**</span>
<a name="l131"><span class="linenum"> 131</span></a>  <span class="comment"> * PARAM_FILE - safe file name, all dangerous chars are stripped, protects against XSS, SQL injections and directory traversals</span>
<a name="l132"><span class="linenum"> 132</span></a>  <span class="comment"> */</span>
<a name="l133"><span class="linenum"> 133</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_FILE')" href="../_constants/PARAM_FILE.html" onMouseOver="constPopup(event,'PARAM_FILE')">PARAM_FILE</a>',   'file');
<a name="l134"><span class="linenum"> 134</span></a>  
<a name="l135"><span class="linenum"> 135</span></a>  <span class="comment">/**</span>
<a name="l136"><span class="linenum"> 136</span></a>  <span class="comment"> * PARAM_FLOAT - a real/floating point number.</span>
<a name="l137"><span class="linenum"> 137</span></a>  <span class="comment"> *</span>
<a name="l138"><span class="linenum"> 138</span></a>  <span class="comment"> * Note that you should not use PARAM_FLOAT for numbers typed in by the user.</span>
<a name="l139"><span class="linenum"> 139</span></a>  <span class="comment"> * It does not work for languages that use , as a decimal separator.</span>
<a name="l140"><span class="linenum"> 140</span></a>  <span class="comment"> * Instead, do something like</span>
<a name="l141"><span class="linenum"> 141</span></a>  <span class="comment"> *     $rawvalue = required_param('name', PARAM_RAW);</span>
<a name="l142"><span class="linenum"> 142</span></a>  <span class="comment"> *     // ... other code including require_login, which sets current lang ...</span>
<a name="l143"><span class="linenum"> 143</span></a>  <span class="comment"> *     $realvalue = unformat_float($rawvalue);</span>
<a name="l144"><span class="linenum"> 144</span></a>  <span class="comment"> *     // ... then use $realvalue</span>
<a name="l145"><span class="linenum"> 145</span></a>  <span class="comment"> */</span>
<a name="l146"><span class="linenum"> 146</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_FLOAT')" href="../_constants/PARAM_FLOAT.html" onMouseOver="constPopup(event,'PARAM_FLOAT')">PARAM_FLOAT</a>',  'float');
<a name="l147"><span class="linenum"> 147</span></a>  
<a name="l148"><span class="linenum"> 148</span></a>  <span class="comment">/**</span>
<a name="l149"><span class="linenum"> 149</span></a>  <span class="comment"> * PARAM_HOST - expected fully qualified domain name (FQDN) or an IPv4 dotted quad (IP address)</span>
<a name="l150"><span class="linenum"> 150</span></a>  <span class="comment"> */</span>
<a name="l151"><span class="linenum"> 151</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_HOST')" href="../_constants/PARAM_HOST.html" onMouseOver="constPopup(event,'PARAM_HOST')">PARAM_HOST</a>',     'host');
<a name="l152"><span class="linenum"> 152</span></a>  
<a name="l153"><span class="linenum"> 153</span></a>  <span class="comment">/**</span>
<a name="l154"><span class="linenum"> 154</span></a>  <span class="comment"> * PARAM_INT - integers only, use when expecting only numbers.</span>
<a name="l155"><span class="linenum"> 155</span></a>  <span class="comment"> */</span>
<a name="l156"><span class="linenum"> 156</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>',      'int');
<a name="l157"><span class="linenum"> 157</span></a>  
<a name="l158"><span class="linenum"> 158</span></a>  <span class="comment">/**</span>
<a name="l159"><span class="linenum"> 159</span></a>  <span class="comment"> * PARAM_LANG - checks to see if the string is a valid installed language in the current site.</span>
<a name="l160"><span class="linenum"> 160</span></a>  <span class="comment"> */</span>
<a name="l161"><span class="linenum"> 161</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_LANG')" href="../_constants/PARAM_LANG.html" onMouseOver="constPopup(event,'PARAM_LANG')">PARAM_LANG</a>',  'lang');
<a name="l162"><span class="linenum"> 162</span></a>  
<a name="l163"><span class="linenum"> 163</span></a>  <span class="comment">/**</span>
<a name="l164"><span class="linenum"> 164</span></a>  <span class="comment"> * PARAM_LOCALURL - expected properly formatted URL as well as one that refers to the local server itself. (NOT orthogonal to the</span>
<a name="l165"><span class="linenum"> 165</span></a>  <span class="comment"> * others! Implies PARAM_URL!)</span>
<a name="l166"><span class="linenum"> 166</span></a>  <span class="comment"> */</span>
<a name="l167"><span class="linenum"> 167</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_LOCALURL')" href="../_constants/PARAM_LOCALURL.html" onMouseOver="constPopup(event,'PARAM_LOCALURL')">PARAM_LOCALURL</a>', 'localurl');
<a name="l168"><span class="linenum"> 168</span></a>  
<a name="l169"><span class="linenum"> 169</span></a>  <span class="comment">/**</span>
<a name="l170"><span class="linenum"> 170</span></a>  <span class="comment"> * PARAM_NOTAGS - all html tags are stripped from the text. Do not abuse this type.</span>
<a name="l171"><span class="linenum"> 171</span></a>  <span class="comment"> */</span>
<a name="l172"><span class="linenum"> 172</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_NOTAGS')" href="../_constants/PARAM_NOTAGS.html" onMouseOver="constPopup(event,'PARAM_NOTAGS')">PARAM_NOTAGS</a>',   'notags');
<a name="l173"><span class="linenum"> 173</span></a>  
<a name="l174"><span class="linenum"> 174</span></a>  <span class="comment">/**</span>
<a name="l175"><span class="linenum"> 175</span></a>  <span class="comment"> * PARAM_PATH - safe relative path name, all dangerous chars are stripped, protects against XSS, SQL injections and directory</span>
<a name="l176"><span class="linenum"> 176</span></a>  <span class="comment"> * traversals note: the leading slash is not removed, window drive letter is not allowed</span>
<a name="l177"><span class="linenum"> 177</span></a>  <span class="comment"> */</span>
<a name="l178"><span class="linenum"> 178</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_PATH')" href="../_constants/PARAM_PATH.html" onMouseOver="constPopup(event,'PARAM_PATH')">PARAM_PATH</a>',     'path');
<a name="l179"><span class="linenum"> 179</span></a>  
<a name="l180"><span class="linenum"> 180</span></a>  <span class="comment">/**</span>
<a name="l181"><span class="linenum"> 181</span></a>  <span class="comment"> * PARAM_PEM - Privacy Enhanced Mail format</span>
<a name="l182"><span class="linenum"> 182</span></a>  <span class="comment"> */</span>
<a name="l183"><span class="linenum"> 183</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_PEM')" href="../_constants/PARAM_PEM.html" onMouseOver="constPopup(event,'PARAM_PEM')">PARAM_PEM</a>',      'pem');
<a name="l184"><span class="linenum"> 184</span></a>  
<a name="l185"><span class="linenum"> 185</span></a>  <span class="comment">/**</span>
<a name="l186"><span class="linenum"> 186</span></a>  <span class="comment"> * PARAM_PERMISSION - A permission, one of CAP_INHERIT, CAP_ALLOW, CAP_PREVENT or CAP_PROHIBIT.</span>
<a name="l187"><span class="linenum"> 187</span></a>  <span class="comment"> */</span>
<a name="l188"><span class="linenum"> 188</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_PERMISSION')" href="../_constants/PARAM_PERMISSION.html" onMouseOver="constPopup(event,'PARAM_PERMISSION')">PARAM_PERMISSION</a>',   'permission');
<a name="l189"><span class="linenum"> 189</span></a>  
<a name="l190"><span class="linenum"> 190</span></a>  <span class="comment">/**</span>
<a name="l191"><span class="linenum"> 191</span></a>  <span class="comment"> * PARAM_RAW specifies a parameter that is not cleaned/processed in any way except the discarding of the invalid utf-8 characters</span>
<a name="l192"><span class="linenum"> 192</span></a>  <span class="comment"> */</span>
<a name="l193"><span class="linenum"> 193</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_RAW')" href="../_constants/PARAM_RAW.html" onMouseOver="constPopup(event,'PARAM_RAW')">PARAM_RAW</a>', 'raw');
<a name="l194"><span class="linenum"> 194</span></a>  
<a name="l195"><span class="linenum"> 195</span></a>  <span class="comment">/**</span>
<a name="l196"><span class="linenum"> 196</span></a>  <span class="comment"> * PARAM_RAW_TRIMMED like PARAM_RAW but leading and trailing whitespace is stripped.</span>
<a name="l197"><span class="linenum"> 197</span></a>  <span class="comment"> */</span>
<a name="l198"><span class="linenum"> 198</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_RAW_TRIMMED')" href="../_constants/PARAM_RAW_TRIMMED.html" onMouseOver="constPopup(event,'PARAM_RAW_TRIMMED')">PARAM_RAW_TRIMMED</a>', 'raw_trimmed');
<a name="l199"><span class="linenum"> 199</span></a>  
<a name="l200"><span class="linenum"> 200</span></a>  <span class="comment">/**</span>
<a name="l201"><span class="linenum"> 201</span></a>  <span class="comment"> * PARAM_SAFEDIR - safe directory name, suitable for include() and require()</span>
<a name="l202"><span class="linenum"> 202</span></a>  <span class="comment"> */</span>
<a name="l203"><span class="linenum"> 203</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_SAFEDIR')" href="../_constants/PARAM_SAFEDIR.html" onMouseOver="constPopup(event,'PARAM_SAFEDIR')">PARAM_SAFEDIR</a>',  'safedir');
<a name="l204"><span class="linenum"> 204</span></a>  
<a name="l205"><span class="linenum"> 205</span></a>  <span class="comment">/**</span>
<a name="l206"><span class="linenum"> 206</span></a>  <span class="comment"> * PARAM_SAFEPATH - several PARAM_SAFEDIR joined by &quot;/&quot;, suitable for include() and require(), plugin paths, etc.</span>
<a name="l207"><span class="linenum"> 207</span></a>  <span class="comment"> */</span>
<a name="l208"><span class="linenum"> 208</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_SAFEPATH')" href="../_constants/PARAM_SAFEPATH.html" onMouseOver="constPopup(event,'PARAM_SAFEPATH')">PARAM_SAFEPATH</a>',  'safepath');
<a name="l209"><span class="linenum"> 209</span></a>  
<a name="l210"><span class="linenum"> 210</span></a>  <span class="comment">/**</span>
<a name="l211"><span class="linenum"> 211</span></a>  <span class="comment"> * PARAM_SEQUENCE - expects a sequence of numbers like 8 to 1,5,6,4,6,8,9.  Numbers and comma only.</span>
<a name="l212"><span class="linenum"> 212</span></a>  <span class="comment"> */</span>
<a name="l213"><span class="linenum"> 213</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_SEQUENCE')" href="../_constants/PARAM_SEQUENCE.html" onMouseOver="constPopup(event,'PARAM_SEQUENCE')">PARAM_SEQUENCE</a>',  'sequence');
<a name="l214"><span class="linenum"> 214</span></a>  
<a name="l215"><span class="linenum"> 215</span></a>  <span class="comment">/**</span>
<a name="l216"><span class="linenum"> 216</span></a>  <span class="comment"> * PARAM_TAG - one tag (interests, blogs, etc.) - mostly international characters and space, &lt;&gt; not supported</span>
<a name="l217"><span class="linenum"> 217</span></a>  <span class="comment"> */</span>
<a name="l218"><span class="linenum"> 218</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_TAG')" href="../_constants/PARAM_TAG.html" onMouseOver="constPopup(event,'PARAM_TAG')">PARAM_TAG</a>',   'tag');
<a name="l219"><span class="linenum"> 219</span></a>  
<a name="l220"><span class="linenum"> 220</span></a>  <span class="comment">/**</span>
<a name="l221"><span class="linenum"> 221</span></a>  <span class="comment"> * PARAM_TAGLIST - list of tags separated by commas (interests, blogs, etc.)</span>
<a name="l222"><span class="linenum"> 222</span></a>  <span class="comment"> */</span>
<a name="l223"><span class="linenum"> 223</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_TAGLIST')" href="../_constants/PARAM_TAGLIST.html" onMouseOver="constPopup(event,'PARAM_TAGLIST')">PARAM_TAGLIST</a>',   'taglist');
<a name="l224"><span class="linenum"> 224</span></a>  
<a name="l225"><span class="linenum"> 225</span></a>  <span class="comment">/**</span>
<a name="l226"><span class="linenum"> 226</span></a>  <span class="comment"> * PARAM_TEXT - general plain text compatible with multilang filter, no other html tags. Please note '&lt;', or '&gt;' are allowed here.</span>
<a name="l227"><span class="linenum"> 227</span></a>  <span class="comment"> */</span>
<a name="l228"><span class="linenum"> 228</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_TEXT')" href="../_constants/PARAM_TEXT.html" onMouseOver="constPopup(event,'PARAM_TEXT')">PARAM_TEXT</a>',  'text');
<a name="l229"><span class="linenum"> 229</span></a>  
<a name="l230"><span class="linenum"> 230</span></a>  <span class="comment">/**</span>
<a name="l231"><span class="linenum"> 231</span></a>  <span class="comment"> * PARAM_THEME - Checks to see if the string is a valid theme name in the current site</span>
<a name="l232"><span class="linenum"> 232</span></a>  <span class="comment"> */</span>
<a name="l233"><span class="linenum"> 233</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_THEME')" href="../_constants/PARAM_THEME.html" onMouseOver="constPopup(event,'PARAM_THEME')">PARAM_THEME</a>',  'theme');
<a name="l234"><span class="linenum"> 234</span></a>  
<a name="l235"><span class="linenum"> 235</span></a>  <span class="comment">/**</span>
<a name="l236"><span class="linenum"> 236</span></a>  <span class="comment"> * PARAM_URL - expected properly formatted URL. Please note that domain part is required, http://localhost/ is not accepted but</span>
<a name="l237"><span class="linenum"> 237</span></a>  <span class="comment"> * http://localhost.localdomain/ is ok.</span>
<a name="l238"><span class="linenum"> 238</span></a>  <span class="comment"> */</span>
<a name="l239"><span class="linenum"> 239</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_URL')" href="../_constants/PARAM_URL.html" onMouseOver="constPopup(event,'PARAM_URL')">PARAM_URL</a>',      'url');
<a name="l240"><span class="linenum"> 240</span></a>  
<a name="l241"><span class="linenum"> 241</span></a>  <span class="comment">/**</span>
<a name="l242"><span class="linenum"> 242</span></a>  <span class="comment"> * PARAM_USERNAME - Clean username to only contains allowed characters. This is to be used ONLY when manually creating user</span>
<a name="l243"><span class="linenum"> 243</span></a>  <span class="comment"> * accounts, do NOT use when syncing with external systems!!</span>
<a name="l244"><span class="linenum"> 244</span></a>  <span class="comment"> */</span>
<a name="l245"><span class="linenum"> 245</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_USERNAME')" href="../_constants/PARAM_USERNAME.html" onMouseOver="constPopup(event,'PARAM_USERNAME')">PARAM_USERNAME</a>',    'username');
<a name="l246"><span class="linenum"> 246</span></a>  
<a name="l247"><span class="linenum"> 247</span></a>  <span class="comment">/**</span>
<a name="l248"><span class="linenum"> 248</span></a>  <span class="comment"> * PARAM_STRINGID - used to check if the given string is valid string identifier for get_string()</span>
<a name="l249"><span class="linenum"> 249</span></a>  <span class="comment"> */</span>
<a name="l250"><span class="linenum"> 250</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_STRINGID')" href="../_constants/PARAM_STRINGID.html" onMouseOver="constPopup(event,'PARAM_STRINGID')">PARAM_STRINGID</a>',    'stringid');
<a name="l251"><span class="linenum"> 251</span></a>  
<a name="l252"><span class="linenum"> 252</span></a>  <span class="comment">// DEPRECATED PARAM TYPES OR ALIASES - DO NOT USE FOR NEW CODE.</span>
<a name="l253"><span class="linenum"> 253</span></a>  <span class="comment">/**</span>
<a name="l254"><span class="linenum"> 254</span></a>  <span class="comment"> * PARAM_CLEAN - obsoleted, please use a more specific type of parameter.</span>
<a name="l255"><span class="linenum"> 255</span></a>  <span class="comment"> * It was one of the first types, that is why it is abused so much ;-)</span>
<a name="l256"><span class="linenum"> 256</span></a>  <span class="comment"> * @deprecated since 2.0</span>
<a name="l257"><span class="linenum"> 257</span></a>  <span class="comment"> */</span>
<a name="l258"><span class="linenum"> 258</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_CLEAN')" href="../_constants/PARAM_CLEAN.html" onMouseOver="constPopup(event,'PARAM_CLEAN')">PARAM_CLEAN</a>',    'clean');
<a name="l259"><span class="linenum"> 259</span></a>  
<a name="l260"><span class="linenum"> 260</span></a>  <span class="comment">/**</span>
<a name="l261"><span class="linenum"> 261</span></a>  <span class="comment"> * PARAM_INTEGER - deprecated alias for PARAM_INT</span>
<a name="l262"><span class="linenum"> 262</span></a>  <span class="comment"> * @deprecated since 2.0</span>
<a name="l263"><span class="linenum"> 263</span></a>  <span class="comment"> */</span>
<a name="l264"><span class="linenum"> 264</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_INTEGER')" href="../_constants/PARAM_INTEGER.html" onMouseOver="constPopup(event,'PARAM_INTEGER')">PARAM_INTEGER</a>',  'int');
<a name="l265"><span class="linenum"> 265</span></a>  
<a name="l266"><span class="linenum"> 266</span></a>  <span class="comment">/**</span>
<a name="l267"><span class="linenum"> 267</span></a>  <span class="comment"> * PARAM_NUMBER - deprecated alias of PARAM_FLOAT</span>
<a name="l268"><span class="linenum"> 268</span></a>  <span class="comment"> * @deprecated since 2.0</span>
<a name="l269"><span class="linenum"> 269</span></a>  <span class="comment"> */</span>
<a name="l270"><span class="linenum"> 270</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_NUMBER')" href="../_constants/PARAM_NUMBER.html" onMouseOver="constPopup(event,'PARAM_NUMBER')">PARAM_NUMBER</a>',  'float');
<a name="l271"><span class="linenum"> 271</span></a>  
<a name="l272"><span class="linenum"> 272</span></a>  <span class="comment">/**</span>
<a name="l273"><span class="linenum"> 273</span></a>  <span class="comment"> * PARAM_ACTION - deprecated alias for PARAM_ALPHANUMEXT, use for various actions in forms and urls</span>
<a name="l274"><span class="linenum"> 274</span></a>  <span class="comment"> * NOTE: originally alias for PARAM_APLHA</span>
<a name="l275"><span class="linenum"> 275</span></a>  <span class="comment"> * @deprecated since 2.0</span>
<a name="l276"><span class="linenum"> 276</span></a>  <span class="comment"> */</span>
<a name="l277"><span class="linenum"> 277</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_ACTION')" href="../_constants/PARAM_ACTION.html" onMouseOver="constPopup(event,'PARAM_ACTION')">PARAM_ACTION</a>',   'alphanumext');
<a name="l278"><span class="linenum"> 278</span></a>  
<a name="l279"><span class="linenum"> 279</span></a>  <span class="comment">/**</span>
<a name="l280"><span class="linenum"> 280</span></a>  <span class="comment"> * PARAM_FORMAT - deprecated alias for PARAM_ALPHANUMEXT, use for names of plugins, formats, etc.</span>
<a name="l281"><span class="linenum"> 281</span></a>  <span class="comment"> * NOTE: originally alias for PARAM_APLHA</span>
<a name="l282"><span class="linenum"> 282</span></a>  <span class="comment"> * @deprecated since 2.0</span>
<a name="l283"><span class="linenum"> 283</span></a>  <span class="comment"> */</span>
<a name="l284"><span class="linenum"> 284</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_FORMAT')" href="../_constants/PARAM_FORMAT.html" onMouseOver="constPopup(event,'PARAM_FORMAT')">PARAM_FORMAT</a>',   'alphanumext');
<a name="l285"><span class="linenum"> 285</span></a>  
<a name="l286"><span class="linenum"> 286</span></a>  <span class="comment">/**</span>
<a name="l287"><span class="linenum"> 287</span></a>  <span class="comment"> * PARAM_MULTILANG - deprecated alias of PARAM_TEXT.</span>
<a name="l288"><span class="linenum"> 288</span></a>  <span class="comment"> * @deprecated since 2.0</span>
<a name="l289"><span class="linenum"> 289</span></a>  <span class="comment"> */</span>
<a name="l290"><span class="linenum"> 290</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_MULTILANG')" href="../_constants/PARAM_MULTILANG.html" onMouseOver="constPopup(event,'PARAM_MULTILANG')">PARAM_MULTILANG</a>',  'text');
<a name="l291"><span class="linenum"> 291</span></a>  
<a name="l292"><span class="linenum"> 292</span></a>  <span class="comment">/**</span>
<a name="l293"><span class="linenum"> 293</span></a>  <span class="comment"> * PARAM_TIMEZONE - expected timezone. Timezone can be int +-(0-13) or float +-(0.5-12.5) or</span>
<a name="l294"><span class="linenum"> 294</span></a>  <span class="comment"> * string separated by '/' and can have '-' &amp;/ '_' (eg. America/North_Dakota/New_Salem</span>
<a name="l295"><span class="linenum"> 295</span></a>  <span class="comment"> * America/Port-au-Prince)</span>
<a name="l296"><span class="linenum"> 296</span></a>  <span class="comment"> */</span>
<a name="l297"><span class="linenum"> 297</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_TIMEZONE')" href="../_constants/PARAM_TIMEZONE.html" onMouseOver="constPopup(event,'PARAM_TIMEZONE')">PARAM_TIMEZONE</a>', 'timezone');
<a name="l298"><span class="linenum"> 298</span></a>  
<a name="l299"><span class="linenum"> 299</span></a>  <span class="comment">/**</span>
<a name="l300"><span class="linenum"> 300</span></a>  <span class="comment"> * PARAM_CLEANFILE - deprecated alias of PARAM_FILE; originally was removing regional chars too</span>
<a name="l301"><span class="linenum"> 301</span></a>  <span class="comment"> */</span>
<a name="l302"><span class="linenum"> 302</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_CLEANFILE')" href="../_constants/PARAM_CLEANFILE.html" onMouseOver="constPopup(event,'PARAM_CLEANFILE')">PARAM_CLEANFILE</a>', 'file');
<a name="l303"><span class="linenum"> 303</span></a>  
<a name="l304"><span class="linenum"> 304</span></a>  <span class="comment">/**</span>
<a name="l305"><span class="linenum"> 305</span></a>  <span class="comment"> * PARAM_COMPONENT is used for full component names (aka frankenstyle) such as 'mod_forum', 'core_rating', 'auth_ldap'.</span>
<a name="l306"><span class="linenum"> 306</span></a>  <span class="comment"> * Short legacy subsystem names and module names are accepted too ex: 'forum', 'rating', 'user'.</span>
<a name="l307"><span class="linenum"> 307</span></a>  <span class="comment"> * Only lowercase ascii letters, numbers and underscores are allowed, it has to start with a letter.</span>
<a name="l308"><span class="linenum"> 308</span></a>  <span class="comment"> * NOTE: numbers and underscores are strongly discouraged in plugin names!</span>
<a name="l309"><span class="linenum"> 309</span></a>  <span class="comment"> */</span>
<a name="l310"><span class="linenum"> 310</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_COMPONENT')" href="../_constants/PARAM_COMPONENT.html" onMouseOver="constPopup(event,'PARAM_COMPONENT')">PARAM_COMPONENT</a>', 'component');
<a name="l311"><span class="linenum"> 311</span></a>  
<a name="l312"><span class="linenum"> 312</span></a>  <span class="comment">/**</span>
<a name="l313"><span class="linenum"> 313</span></a>  <span class="comment"> * PARAM_AREA is a name of area used when addressing files, comments, ratings, etc.</span>
<a name="l314"><span class="linenum"> 314</span></a>  <span class="comment"> * It is usually used together with context id and component.</span>
<a name="l315"><span class="linenum"> 315</span></a>  <span class="comment"> * Only lowercase ascii letters, numbers and underscores are allowed, it has to start with a letter.</span>
<a name="l316"><span class="linenum"> 316</span></a>  <span class="comment"> */</span>
<a name="l317"><span class="linenum"> 317</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_AREA')" href="../_constants/PARAM_AREA.html" onMouseOver="constPopup(event,'PARAM_AREA')">PARAM_AREA</a>', 'area');
<a name="l318"><span class="linenum"> 318</span></a>  
<a name="l319"><span class="linenum"> 319</span></a>  <span class="comment">/**</span>
<a name="l320"><span class="linenum"> 320</span></a>  <span class="comment"> * PARAM_PLUGIN is used for plugin names such as 'forum', 'glossary', 'ldap', 'radius', 'paypal', 'completionstatus'.</span>
<a name="l321"><span class="linenum"> 321</span></a>  <span class="comment"> * Only lowercase ascii letters, numbers and underscores are allowed, it has to start with a letter.</span>
<a name="l322"><span class="linenum"> 322</span></a>  <span class="comment"> * NOTE: numbers and underscores are strongly discouraged in plugin names! Underscores are forbidden in module names.</span>
<a name="l323"><span class="linenum"> 323</span></a>  <span class="comment"> */</span>
<a name="l324"><span class="linenum"> 324</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PARAM_PLUGIN')" href="../_constants/PARAM_PLUGIN.html" onMouseOver="constPopup(event,'PARAM_PLUGIN')">PARAM_PLUGIN</a>', 'plugin');
<a name="l325"><span class="linenum"> 325</span></a>  
<a name="l326"><span class="linenum"> 326</span></a>  
<a name="l327"><span class="linenum"> 327</span></a>  <span class="comment">// Web Services.</span>
<a name="l328"><span class="linenum"> 328</span></a>  
<a name="l329"><span class="linenum"> 329</span></a>  <span class="comment">/**</span>
<a name="l330"><span class="linenum"> 330</span></a>  <span class="comment"> * VALUE_REQUIRED - if the parameter is not supplied, there is an error</span>
<a name="l331"><span class="linenum"> 331</span></a>  <span class="comment"> */</span>
<a name="l332"><span class="linenum"> 332</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('VALUE_REQUIRED')" href="../_constants/VALUE_REQUIRED.html" onMouseOver="constPopup(event,'VALUE_REQUIRED')">VALUE_REQUIRED</a>', 1);
<a name="l333"><span class="linenum"> 333</span></a>  
<a name="l334"><span class="linenum"> 334</span></a>  <span class="comment">/**</span>
<a name="l335"><span class="linenum"> 335</span></a>  <span class="comment"> * VALUE_OPTIONAL - if the parameter is not supplied, then the param has no value</span>
<a name="l336"><span class="linenum"> 336</span></a>  <span class="comment"> */</span>
<a name="l337"><span class="linenum"> 337</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>', 2);
<a name="l338"><span class="linenum"> 338</span></a>  
<a name="l339"><span class="linenum"> 339</span></a>  <span class="comment">/**</span>
<a name="l340"><span class="linenum"> 340</span></a>  <span class="comment"> * VALUE_DEFAULT - if the parameter is not supplied, then the default value is used</span>
<a name="l341"><span class="linenum"> 341</span></a>  <span class="comment"> */</span>
<a name="l342"><span class="linenum"> 342</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('VALUE_DEFAULT')" href="../_constants/VALUE_DEFAULT.html" onMouseOver="constPopup(event,'VALUE_DEFAULT')">VALUE_DEFAULT</a>', 0);
<a name="l343"><span class="linenum"> 343</span></a>  
<a name="l344"><span class="linenum"> 344</span></a>  <span class="comment">/**</span>
<a name="l345"><span class="linenum"> 345</span></a>  <span class="comment"> * NULL_NOT_ALLOWED - the parameter can not be set to null in the database</span>
<a name="l346"><span class="linenum"> 346</span></a>  <span class="comment"> */</span>
<a name="l347"><span class="linenum"> 347</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('NULL_NOT_ALLOWED')" href="../_constants/NULL_NOT_ALLOWED.html" onMouseOver="constPopup(event,'NULL_NOT_ALLOWED')">NULL_NOT_ALLOWED</a>', false);
<a name="l348"><span class="linenum"> 348</span></a>  
<a name="l349"><span class="linenum"> 349</span></a>  <span class="comment">/**</span>
<a name="l350"><span class="linenum"> 350</span></a>  <span class="comment"> * NULL_ALLOWED - the parameter can be set to null in the database</span>
<a name="l351"><span class="linenum"> 351</span></a>  <span class="comment"> */</span>
<a name="l352"><span class="linenum"> 352</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('NULL_ALLOWED')" href="../_constants/NULL_ALLOWED.html" onMouseOver="constPopup(event,'NULL_ALLOWED')">NULL_ALLOWED</a>', true);
<a name="l353"><span class="linenum"> 353</span></a>  
<a name="l354"><span class="linenum"> 354</span></a>  <span class="comment">// Page types.</span>
<a name="l355"><span class="linenum"> 355</span></a>  
<a name="l356"><span class="linenum"> 356</span></a>  <span class="comment">/**</span>
<a name="l357"><span class="linenum"> 357</span></a>  <span class="comment"> * PAGE_COURSE_VIEW is a definition of a page type. For more information on the page class see moodle/lib/pagelib.php.</span>
<a name="l358"><span class="linenum"> 358</span></a>  <span class="comment"> */</span>
<a name="l359"><span class="linenum"> 359</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PAGE_COURSE_VIEW')" href="../_constants/PAGE_COURSE_VIEW.html" onMouseOver="constPopup(event,'PAGE_COURSE_VIEW')">PAGE_COURSE_VIEW</a>', 'course-view');
<a name="l360"><span class="linenum"> 360</span></a>  
<a name="l361"><span class="linenum"> 361</span></a>  <span class="comment">/** Get remote addr constant */</span>
<a name="l362"><span class="linenum"> 362</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('GETREMOTEADDR_SKIP_HTTP_CLIENT_IP')" href="../_constants/GETREMOTEADDR_SKIP_HTTP_CLIENT_IP.html" onMouseOver="constPopup(event,'GETREMOTEADDR_SKIP_HTTP_CLIENT_IP')">GETREMOTEADDR_SKIP_HTTP_CLIENT_IP</a>', '1');
<a name="l363"><span class="linenum"> 363</span></a>  <span class="comment">/** Get remote addr constant */</span>
<a name="l364"><span class="linenum"> 364</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('GETREMOTEADDR_SKIP_HTTP_X_FORWARDED_FOR')" href="../_constants/GETREMOTEADDR_SKIP_HTTP_X_FORWARDED_FOR.html" onMouseOver="constPopup(event,'GETREMOTEADDR_SKIP_HTTP_X_FORWARDED_FOR')">GETREMOTEADDR_SKIP_HTTP_X_FORWARDED_FOR</a>', '2');
<a name="l365"><span class="linenum"> 365</span></a>  
<a name="l366"><span class="linenum"> 366</span></a>  <span class="comment">// Blog access level constant declaration.</span>
<a name="l367"><span class="linenum"> 367</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a> ('<a class="constant" onClick="logConstant('BLOG_USER_LEVEL')" href="../_constants/BLOG_USER_LEVEL.html" onMouseOver="constPopup(event,'BLOG_USER_LEVEL')">BLOG_USER_LEVEL</a>', 1);
<a name="l368"><span class="linenum"> 368</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a> ('<a class="constant" onClick="logConstant('BLOG_GROUP_LEVEL')" href="../_constants/BLOG_GROUP_LEVEL.html" onMouseOver="constPopup(event,'BLOG_GROUP_LEVEL')">BLOG_GROUP_LEVEL</a>', 2);
<a name="l369"><span class="linenum"> 369</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a> ('<a class="constant" onClick="logConstant('BLOG_COURSE_LEVEL')" href="../_constants/BLOG_COURSE_LEVEL.html" onMouseOver="constPopup(event,'BLOG_COURSE_LEVEL')">BLOG_COURSE_LEVEL</a>', 3);
<a name="l370"><span class="linenum"> 370</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a> ('<a class="constant" onClick="logConstant('BLOG_SITE_LEVEL')" href="../_constants/BLOG_SITE_LEVEL.html" onMouseOver="constPopup(event,'BLOG_SITE_LEVEL')">BLOG_SITE_LEVEL</a>', 4);
<a name="l371"><span class="linenum"> 371</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a> ('<a class="constant" onClick="logConstant('BLOG_GLOBAL_LEVEL')" href="../_constants/BLOG_GLOBAL_LEVEL.html" onMouseOver="constPopup(event,'BLOG_GLOBAL_LEVEL')">BLOG_GLOBAL_LEVEL</a>', 5);
<a name="l372"><span class="linenum"> 372</span></a>  
<a name="l373"><span class="linenum"> 373</span></a>  
<a name="l374"><span class="linenum"> 374</span></a>  <span class="comment">// Tag constants.</span>
<a name="l375"><span class="linenum"> 375</span></a>  <span class="comment">/**</span>
<a name="l376"><span class="linenum"> 376</span></a>  <span class="comment"> * To prevent problems with multibytes strings,Flag updating in nav not working on the review page. this should not exceed the</span>
<a name="l377"><span class="linenum"> 377</span></a>  <span class="comment"> * length of &quot;varchar(255) / 3 (bytes / utf-8 character) = 85&quot;.</span>
<a name="l378"><span class="linenum"> 378</span></a>  <span class="comment"> * TODO: this is not correct, varchar(255) are 255 unicode chars ;-)</span>
<a name="l379"><span class="linenum"> 379</span></a>  <span class="comment"> *</span>
<a name="l380"><span class="linenum"> 380</span></a>  <span class="comment"> * @todo define(TAG_MAX_LENGTH) this is not correct, varchar(255) are 255 unicode chars ;-)</span>
<a name="l381"><span class="linenum"> 381</span></a>  <span class="comment"> */</span>
<a name="l382"><span class="linenum"> 382</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('TAG_MAX_LENGTH')" href="../_constants/TAG_MAX_LENGTH.html" onMouseOver="constPopup(event,'TAG_MAX_LENGTH')">TAG_MAX_LENGTH</a>', 50);
<a name="l383"><span class="linenum"> 383</span></a>  
<a name="l384"><span class="linenum"> 384</span></a>  <span class="comment">// Password policy constants.</span>
<a name="l385"><span class="linenum"> 385</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a> ('<a class="constant" onClick="logConstant('PASSWORD_LOWER')" href="../_constants/PASSWORD_LOWER.html" onMouseOver="constPopup(event,'PASSWORD_LOWER')">PASSWORD_LOWER</a>', 'abcdefghijklmnopqrstuvwxyz');
<a name="l386"><span class="linenum"> 386</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a> ('<a class="constant" onClick="logConstant('PASSWORD_UPPER')" href="../_constants/PASSWORD_UPPER.html" onMouseOver="constPopup(event,'PASSWORD_UPPER')">PASSWORD_UPPER</a>', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ');
<a name="l387"><span class="linenum"> 387</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a> ('<a class="constant" onClick="logConstant('PASSWORD_DIGITS')" href="../_constants/PASSWORD_DIGITS.html" onMouseOver="constPopup(event,'PASSWORD_DIGITS')">PASSWORD_DIGITS</a>', '0123456789');
<a name="l388"><span class="linenum"> 388</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a> ('<a class="constant" onClick="logConstant('PASSWORD_NONALPHANUM')" href="../_constants/PASSWORD_NONALPHANUM.html" onMouseOver="constPopup(event,'PASSWORD_NONALPHANUM')">PASSWORD_NONALPHANUM</a>', '.,;:!?_-+<span class="comment">/*@#&amp;$');</span>
<a name="l389"><span class="linenum"> 389</span></a>  <span class="comment"></span>
<a name="l390"><span class="linenum"> 390</span></a>  <span class="comment">// Feature constants.</span>
<a name="l391"><span class="linenum"> 391</span></a>  <span class="comment">// Used for plugin_supports() to report features that are, or are not, supported by a module.</span>
<a name="l392"><span class="linenum"> 392</span></a>  <span class="comment"></span>
<a name="l393"><span class="linenum"> 393</span></a>  <span class="comment">/** True if module can provide a grade */</span>
<a name="l394"><span class="linenum"> 394</span></a>  <span class="comment">define('FEATURE_GRADE_HAS_GRADE', 'grade_has_grade');</span>
<a name="l395"><span class="linenum"> 395</span></a>  <span class="comment">/** True if module supports outcomes */</span>
<a name="l396"><span class="linenum"> 396</span></a>  <span class="comment">define('FEATURE_GRADE_OUTCOMES', 'outcomes');</span>
<a name="l397"><span class="linenum"> 397</span></a>  <span class="comment">/** True if module supports advanced grading methods */</span>
<a name="l398"><span class="linenum"> 398</span></a>  <span class="comment">define('FEATURE_ADVANCED_GRADING', 'grade_advanced_grading');</span>
<a name="l399"><span class="linenum"> 399</span></a>  <span class="comment">/** True if module controls the grade visibility over the gradebook */</span>
<a name="l400"><span class="linenum"> 400</span></a>  <span class="comment">define('FEATURE_CONTROLS_GRADE_VISIBILITY', 'controlsgradevisbility');</span>
<a name="l401"><span class="linenum"> 401</span></a>  <span class="comment">/** True if module supports plagiarism plugins */</span>
<a name="l402"><span class="linenum"> 402</span></a>  <span class="comment">define('FEATURE_PLAGIARISM', 'plagiarism');</span>
<a name="l403"><span class="linenum"> 403</span></a>  <span class="comment"></span>
<a name="l404"><span class="linenum"> 404</span></a>  <span class="comment">/** True if module has code to track whether somebody viewed it */</span>
<a name="l405"><span class="linenum"> 405</span></a>  <span class="comment">define('FEATURE_COMPLETION_TRACKS_VIEWS', 'completion_tracks_views');</span>
<a name="l406"><span class="linenum"> 406</span></a>  <span class="comment">/** True if module has custom completion rules */</span>
<a name="l407"><span class="linenum"> 407</span></a>  <span class="comment">define('FEATURE_COMPLETION_HAS_RULES', 'completion_has_rules');</span>
<a name="l408"><span class="linenum"> 408</span></a>  <span class="comment"></span>
<a name="l409"><span class="linenum"> 409</span></a>  <span class="comment">/** True if module has no 'view' page (like label) */</span>
<a name="l410"><span class="linenum"> 410</span></a>  <span class="comment">define('FEATURE_NO_VIEW_LINK', 'viewlink');</span>
<a name="l411"><span class="linenum"> 411</span></a>  <span class="comment">/** True (which is default) if the module wants support for setting the ID number for grade calculation purposes. */</span>
<a name="l412"><span class="linenum"> 412</span></a>  <span class="comment">define('FEATURE_IDNUMBER', 'idnumber');</span>
<a name="l413"><span class="linenum"> 413</span></a>  <span class="comment">/** True if module supports groups */</span>
<a name="l414"><span class="linenum"> 414</span></a>  <span class="comment">define('FEATURE_GROUPS', 'groups');</span>
<a name="l415"><span class="linenum"> 415</span></a>  <span class="comment">/** True if module supports groupings */</span>
<a name="l416"><span class="linenum"> 416</span></a>  <span class="comment">define('FEATURE_GROUPINGS', 'groupings');</span>
<a name="l417"><span class="linenum"> 417</span></a>  <span class="comment">/**</span>
<a name="l418"><span class="linenum"> 418</span></a>  <span class="comment"> * True if module supports groupmembersonly (which no longer exists)</span>
<a name="l419"><span class="linenum"> 419</span></a>  <span class="comment"> * @deprecated Since Moodle 2.8</span>
<a name="l420"><span class="linenum"> 420</span></a>  <span class="comment"> */</span>
<a name="l421"><span class="linenum"> 421</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('FEATURE_GROUPMEMBERSONLY')" href="../_constants/FEATURE_GROUPMEMBERSONLY.html" onMouseOver="constPopup(event,'FEATURE_GROUPMEMBERSONLY')">FEATURE_GROUPMEMBERSONLY</a>', 'groupmembersonly');
<a name="l422"><span class="linenum"> 422</span></a>  
<a name="l423"><span class="linenum"> 423</span></a>  <span class="comment">/** Type of module */</span>
<a name="l424"><span class="linenum"> 424</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('FEATURE_MOD_ARCHETYPE')" href="../_constants/FEATURE_MOD_ARCHETYPE.html" onMouseOver="constPopup(event,'FEATURE_MOD_ARCHETYPE')">FEATURE_MOD_ARCHETYPE</a>', 'mod_archetype');
<a name="l425"><span class="linenum"> 425</span></a>  <span class="comment">/** True if module supports intro editor */</span>
<a name="l426"><span class="linenum"> 426</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('FEATURE_MOD_INTRO')" href="../_constants/FEATURE_MOD_INTRO.html" onMouseOver="constPopup(event,'FEATURE_MOD_INTRO')">FEATURE_MOD_INTRO</a>', 'mod_intro');
<a name="l427"><span class="linenum"> 427</span></a>  <span class="comment">/** True if module has default completion */</span>
<a name="l428"><span class="linenum"> 428</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('FEATURE_MODEDIT_DEFAULT_COMPLETION')" href="../_constants/FEATURE_MODEDIT_DEFAULT_COMPLETION.html" onMouseOver="constPopup(event,'FEATURE_MODEDIT_DEFAULT_COMPLETION')">FEATURE_MODEDIT_DEFAULT_COMPLETION</a>', 'modedit_default_completion');
<a name="l429"><span class="linenum"> 429</span></a>  
<a name="l430"><span class="linenum"> 430</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('FEATURE_COMMENT')" href="../_constants/FEATURE_COMMENT.html" onMouseOver="constPopup(event,'FEATURE_COMMENT')">FEATURE_COMMENT</a>', 'comment');
<a name="l431"><span class="linenum"> 431</span></a>  
<a name="l432"><span class="linenum"> 432</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('FEATURE_RATE')" href="../_constants/FEATURE_RATE.html" onMouseOver="constPopup(event,'FEATURE_RATE')">FEATURE_RATE</a>', 'rate');
<a name="l433"><span class="linenum"> 433</span></a>  <span class="comment">/** True if module supports backup/restore of moodle2 format */</span>
<a name="l434"><span class="linenum"> 434</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('FEATURE_BACKUP_MOODLE2')" href="../_constants/FEATURE_BACKUP_MOODLE2.html" onMouseOver="constPopup(event,'FEATURE_BACKUP_MOODLE2')">FEATURE_BACKUP_MOODLE2</a>', 'backup_moodle2');
<a name="l435"><span class="linenum"> 435</span></a>  
<a name="l436"><span class="linenum"> 436</span></a>  <span class="comment">/** True if module can show description on course main page */</span>
<a name="l437"><span class="linenum"> 437</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('FEATURE_SHOW_DESCRIPTION')" href="../_constants/FEATURE_SHOW_DESCRIPTION.html" onMouseOver="constPopup(event,'FEATURE_SHOW_DESCRIPTION')">FEATURE_SHOW_DESCRIPTION</a>', 'showdescription');
<a name="l438"><span class="linenum"> 438</span></a>  
<a name="l439"><span class="linenum"> 439</span></a>  <span class="comment">/** True if module uses the question bank */</span>
<a name="l440"><span class="linenum"> 440</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('FEATURE_USES_QUESTIONS')" href="../_constants/FEATURE_USES_QUESTIONS.html" onMouseOver="constPopup(event,'FEATURE_USES_QUESTIONS')">FEATURE_USES_QUESTIONS</a>', 'usesquestions');
<a name="l441"><span class="linenum"> 441</span></a>  
<a name="l442"><span class="linenum"> 442</span></a>  <span class="comment">/** Unspecified module archetype */</span>
<a name="l443"><span class="linenum"> 443</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('MOD_ARCHETYPE_OTHER')" href="../_constants/MOD_ARCHETYPE_OTHER.html" onMouseOver="constPopup(event,'MOD_ARCHETYPE_OTHER')">MOD_ARCHETYPE_OTHER</a>', 0);
<a name="l444"><span class="linenum"> 444</span></a>  <span class="comment">/** Resource-like type module */</span>
<a name="l445"><span class="linenum"> 445</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('MOD_ARCHETYPE_RESOURCE')" href="../_constants/MOD_ARCHETYPE_RESOURCE.html" onMouseOver="constPopup(event,'MOD_ARCHETYPE_RESOURCE')">MOD_ARCHETYPE_RESOURCE</a>', 1);
<a name="l446"><span class="linenum"> 446</span></a>  <span class="comment">/** Assignment module archetype */</span>
<a name="l447"><span class="linenum"> 447</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('MOD_ARCHETYPE_ASSIGNMENT')" href="../_constants/MOD_ARCHETYPE_ASSIGNMENT.html" onMouseOver="constPopup(event,'MOD_ARCHETYPE_ASSIGNMENT')">MOD_ARCHETYPE_ASSIGNMENT</a>', 2);
<a name="l448"><span class="linenum"> 448</span></a>  <span class="comment">/** System (not user-addable) module archetype */</span>
<a name="l449"><span class="linenum"> 449</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('MOD_ARCHETYPE_SYSTEM')" href="../_constants/MOD_ARCHETYPE_SYSTEM.html" onMouseOver="constPopup(event,'MOD_ARCHETYPE_SYSTEM')">MOD_ARCHETYPE_SYSTEM</a>', 3);
<a name="l450"><span class="linenum"> 450</span></a>  
<a name="l451"><span class="linenum"> 451</span></a>  <span class="comment">/** Return this from modname_get_types callback to use default display in activity chooser */</span>
<a name="l452"><span class="linenum"> 452</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('MOD_SUBTYPE_NO_CHILDREN')" href="../_constants/MOD_SUBTYPE_NO_CHILDREN.html" onMouseOver="constPopup(event,'MOD_SUBTYPE_NO_CHILDREN')">MOD_SUBTYPE_NO_CHILDREN</a>', 'modsubtypenochildren');
<a name="l453"><span class="linenum"> 453</span></a>  
<a name="l454"><span class="linenum"> 454</span></a>  <span class="comment">/**</span>
<a name="l455"><span class="linenum"> 455</span></a>  <span class="comment"> * Security token used for allowing access</span>
<a name="l456"><span class="linenum"> 456</span></a>  <span class="comment"> * from external application such as web services.</span>
<a name="l457"><span class="linenum"> 457</span></a>  <span class="comment"> * Scripts do not use any session, performance is relatively</span>
<a name="l458"><span class="linenum"> 458</span></a>  <span class="comment"> * low because we need to load access info in each request.</span>
<a name="l459"><span class="linenum"> 459</span></a>  <span class="comment"> * Scripts are executed in parallel.</span>
<a name="l460"><span class="linenum"> 460</span></a>  <span class="comment"> */</span>
<a name="l461"><span class="linenum"> 461</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('EXTERNAL_TOKEN_PERMANENT')" href="../_constants/EXTERNAL_TOKEN_PERMANENT.html" onMouseOver="constPopup(event,'EXTERNAL_TOKEN_PERMANENT')">EXTERNAL_TOKEN_PERMANENT</a>', 0);
<a name="l462"><span class="linenum"> 462</span></a>  
<a name="l463"><span class="linenum"> 463</span></a>  <span class="comment">/**</span>
<a name="l464"><span class="linenum"> 464</span></a>  <span class="comment"> * Security token used for allowing access</span>
<a name="l465"><span class="linenum"> 465</span></a>  <span class="comment"> * of embedded applications, the code is executed in the</span>
<a name="l466"><span class="linenum"> 466</span></a>  <span class="comment"> * active user session. Token is invalidated after user logs out.</span>
<a name="l467"><span class="linenum"> 467</span></a>  <span class="comment"> * Scripts are executed serially - normal session locking is used.</span>
<a name="l468"><span class="linenum"> 468</span></a>  <span class="comment"> */</span>
<a name="l469"><span class="linenum"> 469</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('EXTERNAL_TOKEN_EMBEDDED')" href="../_constants/EXTERNAL_TOKEN_EMBEDDED.html" onMouseOver="constPopup(event,'EXTERNAL_TOKEN_EMBEDDED')">EXTERNAL_TOKEN_EMBEDDED</a>', 1);
<a name="l470"><span class="linenum"> 470</span></a>  
<a name="l471"><span class="linenum"> 471</span></a>  <span class="comment">/**</span>
<a name="l472"><span class="linenum"> 472</span></a>  <span class="comment"> * The home page should be the site home</span>
<a name="l473"><span class="linenum"> 473</span></a>  <span class="comment"> */</span>
<a name="l474"><span class="linenum"> 474</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('HOMEPAGE_SITE')" href="../_constants/HOMEPAGE_SITE.html" onMouseOver="constPopup(event,'HOMEPAGE_SITE')">HOMEPAGE_SITE</a>', 0);
<a name="l475"><span class="linenum"> 475</span></a>  <span class="comment">/**</span>
<a name="l476"><span class="linenum"> 476</span></a>  <span class="comment"> * The home page should be the users my page</span>
<a name="l477"><span class="linenum"> 477</span></a>  <span class="comment"> */</span>
<a name="l478"><span class="linenum"> 478</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('HOMEPAGE_MY')" href="../_constants/HOMEPAGE_MY.html" onMouseOver="constPopup(event,'HOMEPAGE_MY')">HOMEPAGE_MY</a>', 1);
<a name="l479"><span class="linenum"> 479</span></a>  <span class="comment">/**</span>
<a name="l480"><span class="linenum"> 480</span></a>  <span class="comment"> * The home page can be chosen by the user</span>
<a name="l481"><span class="linenum"> 481</span></a>  <span class="comment"> */</span>
<a name="l482"><span class="linenum"> 482</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('HOMEPAGE_USER')" href="../_constants/HOMEPAGE_USER.html" onMouseOver="constPopup(event,'HOMEPAGE_USER')">HOMEPAGE_USER</a>', 2);
<a name="l483"><span class="linenum"> 483</span></a>  
<a name="l484"><span class="linenum"> 484</span></a>  <span class="comment">/**</span>
<a name="l485"><span class="linenum"> 485</span></a>  <span class="comment"> * Hub directory url (should be moodle.org)</span>
<a name="l486"><span class="linenum"> 486</span></a>  <span class="comment"> */</span>
<a name="l487"><span class="linenum"> 487</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('HUB_HUBDIRECTORYURL')" href="../_constants/HUB_HUBDIRECTORYURL.html" onMouseOver="constPopup(event,'HUB_HUBDIRECTORYURL')">HUB_HUBDIRECTORYURL</a>', &quot;http://hubdirectory.moodle.org&quot;);
<a name="l488"><span class="linenum"> 488</span></a>  
<a name="l489"><span class="linenum"> 489</span></a>  
<a name="l490"><span class="linenum"> 490</span></a>  <span class="comment">/**</span>
<a name="l491"><span class="linenum"> 491</span></a>  <span class="comment"> * Moodle.org url (should be moodle.org)</span>
<a name="l492"><span class="linenum"> 492</span></a>  <span class="comment"> */</span>
<a name="l493"><span class="linenum"> 493</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('HUB_MOODLEORGHUBURL')" href="../_constants/HUB_MOODLEORGHUBURL.html" onMouseOver="constPopup(event,'HUB_MOODLEORGHUBURL')">HUB_MOODLEORGHUBURL</a>', &quot;http://hub.moodle.org&quot;);
<a name="l494"><span class="linenum"> 494</span></a>  
<a name="l495"><span class="linenum"> 495</span></a>  <span class="comment">/**</span>
<a name="l496"><span class="linenum"> 496</span></a>  <span class="comment"> * Moodle mobile app service name</span>
<a name="l497"><span class="linenum"> 497</span></a>  <span class="comment"> */</span>
<a name="l498"><span class="linenum"> 498</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('MOODLE_OFFICIAL_MOBILE_SERVICE')" href="../_constants/MOODLE_OFFICIAL_MOBILE_SERVICE.html" onMouseOver="constPopup(event,'MOODLE_OFFICIAL_MOBILE_SERVICE')">MOODLE_OFFICIAL_MOBILE_SERVICE</a>', 'moodle_mobile_app');
<a name="l499"><span class="linenum"> 499</span></a>  
<a name="l500"><span class="linenum"> 500</span></a>  <span class="comment">/**</span>
<a name="l501"><span class="linenum"> 501</span></a>  <span class="comment"> * Indicates the user has the capabilities required to ignore activity and course file size restrictions</span>
<a name="l502"><span class="linenum"> 502</span></a>  <span class="comment"> */</span>
<a name="l503"><span class="linenum"> 503</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('USER_CAN_IGNORE_FILE_SIZE_LIMITS')" href="../_constants/USER_CAN_IGNORE_FILE_SIZE_LIMITS.html" onMouseOver="constPopup(event,'USER_CAN_IGNORE_FILE_SIZE_LIMITS')">USER_CAN_IGNORE_FILE_SIZE_LIMITS</a>', -1);
<a name="l504"><span class="linenum"> 504</span></a>  
<a name="l505"><span class="linenum"> 505</span></a>  <span class="comment">/**</span>
<a name="l506"><span class="linenum"> 506</span></a>  <span class="comment"> * Course display settings: display all sections on one page.</span>
<a name="l507"><span class="linenum"> 507</span></a>  <span class="comment"> */</span>
<a name="l508"><span class="linenum"> 508</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('COURSE_DISPLAY_SINGLEPAGE')" href="../_constants/COURSE_DISPLAY_SINGLEPAGE.html" onMouseOver="constPopup(event,'COURSE_DISPLAY_SINGLEPAGE')">COURSE_DISPLAY_SINGLEPAGE</a>', 0);
<a name="l509"><span class="linenum"> 509</span></a>  <span class="comment">/**</span>
<a name="l510"><span class="linenum"> 510</span></a>  <span class="comment"> * Course display settings: split pages into a page per section.</span>
<a name="l511"><span class="linenum"> 511</span></a>  <span class="comment"> */</span>
<a name="l512"><span class="linenum"> 512</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('COURSE_DISPLAY_MULTIPAGE')" href="../_constants/COURSE_DISPLAY_MULTIPAGE.html" onMouseOver="constPopup(event,'COURSE_DISPLAY_MULTIPAGE')">COURSE_DISPLAY_MULTIPAGE</a>', 1);
<a name="l513"><span class="linenum"> 513</span></a>  
<a name="l514"><span class="linenum"> 514</span></a>  <span class="comment">/**</span>
<a name="l515"><span class="linenum"> 515</span></a>  <span class="comment"> * Authentication constant: String used in password field when password is not stored.</span>
<a name="l516"><span class="linenum"> 516</span></a>  <span class="comment"> */</span>
<a name="l517"><span class="linenum"> 517</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('AUTH_PASSWORD_NOT_CACHED')" href="../_constants/AUTH_PASSWORD_NOT_CACHED.html" onMouseOver="constPopup(event,'AUTH_PASSWORD_NOT_CACHED')">AUTH_PASSWORD_NOT_CACHED</a>', 'not cached');
<a name="l518"><span class="linenum"> 518</span></a>  
<a name="l519"><span class="linenum"> 519</span></a>  <span class="comment">// PARAMETER HANDLING.</span>
<a name="l520"><span class="linenum"> 520</span></a>  
<a name="l521"><span class="linenum"> 521</span></a>  <span class="comment">/**</span>
<a name="l522"><span class="linenum"> 522</span></a>  <span class="comment"> * Returns a particular value for the named variable, taken from</span>
<a name="l523"><span class="linenum"> 523</span></a>  <span class="comment"> * POST or GET.  If the parameter doesn't exist then an error is</span>
<a name="l524"><span class="linenum"> 524</span></a>  <span class="comment"> * thrown because we require this variable.</span>
<a name="l525"><span class="linenum"> 525</span></a>  <span class="comment"> *</span>
<a name="l526"><span class="linenum"> 526</span></a>  <span class="comment"> * This function should be used to initialise all required values</span>
<a name="l527"><span class="linenum"> 527</span></a>  <span class="comment"> * in a script that are based on parameters.  Usually it will be</span>
<a name="l528"><span class="linenum"> 528</span></a>  <span class="comment"> * used like this:</span>
<a name="l529"><span class="linenum"> 529</span></a>  <span class="comment"> *    $id = required_param('id', PARAM_INT);</span>
<a name="l530"><span class="linenum"> 530</span></a>  <span class="comment"> *</span>
<a name="l531"><span class="linenum"> 531</span></a>  <span class="comment"> * Please note the $type parameter is now required and the value can not be array.</span>
<a name="l532"><span class="linenum"> 532</span></a>  <span class="comment"> *</span>
<a name="l533"><span class="linenum"> 533</span></a>  <span class="comment"> * @param string $parname the name of the page parameter we want</span>
<a name="l534"><span class="linenum"> 534</span></a>  <span class="comment"> * @param string $type expected type of parameter</span>
<a name="l535"><span class="linenum"> 535</span></a>  <span class="comment"> * @return mixed</span>
<a name="l536"><span class="linenum"> 536</span></a>  <span class="comment"> * @throws coding_exception</span>
<a name="l537"><span class="linenum"> 537</span></a>  <span class="comment"> */</span>
<a name="l538"><span class="linenum"> 538</span></a>  function <a class="function" onClick="logFunction('required_param')" href="../_functions/required_param.html" onMouseOver="funcPopup(event,'required_param')">required_param</a>(<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>, <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>) {
<a name="l539"><span class="linenum"> 539</span></a>      if (<a class="phpfunction" onClick="logFunction('func_num_args')" href="../_functions/func_num_args.html" onMouseOver="phpfuncPopup(event,'func_num_args')">func_num_args</a>() != 2 or empty(<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>) or empty(<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>)) {
<a name="l540"><span class="linenum"> 540</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('<a class="function" onClick="logFunction('required_param')" href="../_functions/required_param.html" onMouseOver="funcPopup(event,'required_param')">required_param</a>() requires <a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a> and <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a> to be specified (parameter: '.<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>.')');
<a name="l541"><span class="linenum"> 541</span></a>      }
<a name="l542"><span class="linenum"> 542</span></a>  <span class="comment">    // POST has precedence.</span>
<a name="l543"><span class="linenum"> 543</span></a>      if (isset(<a class="var it2053" onMouseOver="hilite(2053)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>[<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>])) {
<a name="l544"><span class="linenum"> 544</span></a>          <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="var it2053" onMouseOver="hilite(2053)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>[<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>];
<a name="l545"><span class="linenum"> 545</span></a>      } else if (isset(<a class="var it76" onMouseOver="hilite(76)" onMouseOut="lolite()" onClick="logVariable('_GET')" href="../_variables/_GET.html">$_GET</a>[<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>])) {
<a name="l546"><span class="linenum"> 546</span></a>          <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="var it76" onMouseOver="hilite(76)" onMouseOut="lolite()" onClick="logVariable('_GET')" href="../_variables/_GET.html">$_GET</a>[<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>];
<a name="l547"><span class="linenum"> 547</span></a>      } else {
<a name="l548"><span class="linenum"> 548</span></a>          <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('missingparam', '', '', <a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>);
<a name="l549"><span class="linenum"> 549</span></a>      }
<a name="l550"><span class="linenum"> 550</span></a>  
<a name="l551"><span class="linenum"> 551</span></a>      if (<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l552"><span class="linenum"> 552</span></a>          <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Invalid array parameter detected in <a class="function" onClick="logFunction('required_param')" href="../_functions/required_param.html" onMouseOver="funcPopup(event,'required_param')">required_param</a>(): '.<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>);
<a name="l553"><span class="linenum"> 553</span></a>  <span class="comment">        // TODO: switch to fatal error in Moodle 2.3.</span>
<a name="l554"><span class="linenum"> 554</span></a>          return <a class="function" onClick="logFunction('required_param_array')" href="../_functions/required_param_array.html" onMouseOver="funcPopup(event,'required_param_array')">required_param_array</a>(<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>, <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>);
<a name="l555"><span class="linenum"> 555</span></a>      }
<a name="l556"><span class="linenum"> 556</span></a>  
<a name="l557"><span class="linenum"> 557</span></a>      return <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>);
<a name="l558"><span class="linenum"> 558</span></a>  }
<a name="l559"><span class="linenum"> 559</span></a>  
<a name="l560"><span class="linenum"> 560</span></a>  <span class="comment">/**</span>
<a name="l561"><span class="linenum"> 561</span></a>  <span class="comment"> * Returns a particular array value for the named variable, taken from</span>
<a name="l562"><span class="linenum"> 562</span></a>  <span class="comment"> * POST or GET.  If the parameter doesn't exist then an error is</span>
<a name="l563"><span class="linenum"> 563</span></a>  <span class="comment"> * thrown because we require this variable.</span>
<a name="l564"><span class="linenum"> 564</span></a>  <span class="comment"> *</span>
<a name="l565"><span class="linenum"> 565</span></a>  <span class="comment"> * This function should be used to initialise all required values</span>
<a name="l566"><span class="linenum"> 566</span></a>  <span class="comment"> * in a script that are based on parameters.  Usually it will be</span>
<a name="l567"><span class="linenum"> 567</span></a>  <span class="comment"> * used like this:</span>
<a name="l568"><span class="linenum"> 568</span></a>  <span class="comment"> *    $ids = required_param_array('ids', PARAM_INT);</span>
<a name="l569"><span class="linenum"> 569</span></a>  <span class="comment"> *</span>
<a name="l570"><span class="linenum"> 570</span></a>  <span class="comment"> *  Note: arrays of arrays are not supported, only alphanumeric keys with _ and - are supported</span>
<a name="l571"><span class="linenum"> 571</span></a>  <span class="comment"> *</span>
<a name="l572"><span class="linenum"> 572</span></a>  <span class="comment"> * @param string $parname the name of the page parameter we want</span>
<a name="l573"><span class="linenum"> 573</span></a>  <span class="comment"> * @param string $type expected type of parameter</span>
<a name="l574"><span class="linenum"> 574</span></a>  <span class="comment"> * @return array</span>
<a name="l575"><span class="linenum"> 575</span></a>  <span class="comment"> * @throws coding_exception</span>
<a name="l576"><span class="linenum"> 576</span></a>  <span class="comment"> */</span>
<a name="l577"><span class="linenum"> 577</span></a>  function <a class="function" onClick="logFunction('required_param_array')" href="../_functions/required_param_array.html" onMouseOver="funcPopup(event,'required_param_array')">required_param_array</a>(<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>, <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>) {
<a name="l578"><span class="linenum"> 578</span></a>      if (<a class="phpfunction" onClick="logFunction('func_num_args')" href="../_functions/func_num_args.html" onMouseOver="phpfuncPopup(event,'func_num_args')">func_num_args</a>() != 2 or empty(<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>) or empty(<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>)) {
<a name="l579"><span class="linenum"> 579</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('<a class="function" onClick="logFunction('required_param_array')" href="../_functions/required_param_array.html" onMouseOver="funcPopup(event,'required_param_array')">required_param_array</a>() requires <a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a> and <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a> to be specified (parameter: '.<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>.')');
<a name="l580"><span class="linenum"> 580</span></a>      }
<a name="l581"><span class="linenum"> 581</span></a>  <span class="comment">    // POST has precedence.</span>
<a name="l582"><span class="linenum"> 582</span></a>      if (isset(<a class="var it2053" onMouseOver="hilite(2053)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>[<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>])) {
<a name="l583"><span class="linenum"> 583</span></a>          <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="var it2053" onMouseOver="hilite(2053)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>[<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>];
<a name="l584"><span class="linenum"> 584</span></a>      } else if (isset(<a class="var it76" onMouseOver="hilite(76)" onMouseOut="lolite()" onClick="logVariable('_GET')" href="../_variables/_GET.html">$_GET</a>[<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>])) {
<a name="l585"><span class="linenum"> 585</span></a>          <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="var it76" onMouseOver="hilite(76)" onMouseOut="lolite()" onClick="logVariable('_GET')" href="../_variables/_GET.html">$_GET</a>[<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>];
<a name="l586"><span class="linenum"> 586</span></a>      } else {
<a name="l587"><span class="linenum"> 587</span></a>          <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('missingparam', '', '', <a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>);
<a name="l588"><span class="linenum"> 588</span></a>      }
<a name="l589"><span class="linenum"> 589</span></a>      if (!<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l590"><span class="linenum"> 590</span></a>          <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('missingparam', '', '', <a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>);
<a name="l591"><span class="linenum"> 591</span></a>      }
<a name="l592"><span class="linenum"> 592</span></a>  
<a name="l593"><span class="linenum"> 593</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = array();
<a name="l594"><span class="linenum"> 594</span></a>      foreach (<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) {
<a name="l595"><span class="linenum"> 595</span></a>          if (!<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^[a-z0-9_-]+$/i', <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>)) {
<a name="l596"><span class="linenum"> 596</span></a>              <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Invalid key name in <a class="function" onClick="logFunction('required_param_array')" href="../_functions/required_param_array.html" onMouseOver="funcPopup(event,'required_param_array')">required_param_array</a>() detected: '.<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>.', parameter: '.<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>);
<a name="l597"><span class="linenum"> 597</span></a>              continue;
<a name="l598"><span class="linenum"> 598</span></a>          }
<a name="l599"><span class="linenum"> 599</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>, <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>);
<a name="l600"><span class="linenum"> 600</span></a>      }
<a name="l601"><span class="linenum"> 601</span></a>  
<a name="l602"><span class="linenum"> 602</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>;
<a name="l603"><span class="linenum"> 603</span></a>  }
<a name="l604"><span class="linenum"> 604</span></a>  
<a name="l605"><span class="linenum"> 605</span></a>  <span class="comment">/**</span>
<a name="l606"><span class="linenum"> 606</span></a>  <span class="comment"> * Returns a particular value for the named variable, taken from</span>
<a name="l607"><span class="linenum"> 607</span></a>  <span class="comment"> * POST or GET, otherwise returning a given default.</span>
<a name="l608"><span class="linenum"> 608</span></a>  <span class="comment"> *</span>
<a name="l609"><span class="linenum"> 609</span></a>  <span class="comment"> * This function should be used to initialise all optional values</span>
<a name="l610"><span class="linenum"> 610</span></a>  <span class="comment"> * in a script that are based on parameters.  Usually it will be</span>
<a name="l611"><span class="linenum"> 611</span></a>  <span class="comment"> * used like this:</span>
<a name="l612"><span class="linenum"> 612</span></a>  <span class="comment"> *    $name = optional_param('name', 'Fred', PARAM_TEXT);</span>
<a name="l613"><span class="linenum"> 613</span></a>  <span class="comment"> *</span>
<a name="l614"><span class="linenum"> 614</span></a>  <span class="comment"> * Please note the $type parameter is now required and the value can not be array.</span>
<a name="l615"><span class="linenum"> 615</span></a>  <span class="comment"> *</span>
<a name="l616"><span class="linenum"> 616</span></a>  <span class="comment"> * @param string $parname the name of the page parameter we want</span>
<a name="l617"><span class="linenum"> 617</span></a>  <span class="comment"> * @param mixed  $default the default value to return if nothing is found</span>
<a name="l618"><span class="linenum"> 618</span></a>  <span class="comment"> * @param string $type expected type of parameter</span>
<a name="l619"><span class="linenum"> 619</span></a>  <span class="comment"> * @return mixed</span>
<a name="l620"><span class="linenum"> 620</span></a>  <span class="comment"> * @throws coding_exception</span>
<a name="l621"><span class="linenum"> 621</span></a>  <span class="comment"> */</span>
<a name="l622"><span class="linenum"> 622</span></a>  function <a class="function" onClick="logFunction('optional_param')" href="../_functions/optional_param.html" onMouseOver="funcPopup(event,'optional_param')">optional_param</a>(<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>, <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>, <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>) {
<a name="l623"><span class="linenum"> 623</span></a>      if (<a class="phpfunction" onClick="logFunction('func_num_args')" href="../_functions/func_num_args.html" onMouseOver="phpfuncPopup(event,'func_num_args')">func_num_args</a>() != 3 or empty(<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>) or empty(<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>)) {
<a name="l624"><span class="linenum"> 624</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('optional_param requires <a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>, <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a> + <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a> to be specified (parameter: '.<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>.')');
<a name="l625"><span class="linenum"> 625</span></a>      }
<a name="l626"><span class="linenum"> 626</span></a>      if (!isset(<a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>)) {
<a name="l627"><span class="linenum"> 627</span></a>          <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a> = null;
<a name="l628"><span class="linenum"> 628</span></a>      }
<a name="l629"><span class="linenum"> 629</span></a>  
<a name="l630"><span class="linenum"> 630</span></a>  <span class="comment">    // POST has precedence.</span>
<a name="l631"><span class="linenum"> 631</span></a>      if (isset(<a class="var it2053" onMouseOver="hilite(2053)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>[<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>])) {
<a name="l632"><span class="linenum"> 632</span></a>          <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="var it2053" onMouseOver="hilite(2053)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>[<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>];
<a name="l633"><span class="linenum"> 633</span></a>      } else if (isset(<a class="var it76" onMouseOver="hilite(76)" onMouseOut="lolite()" onClick="logVariable('_GET')" href="../_variables/_GET.html">$_GET</a>[<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>])) {
<a name="l634"><span class="linenum"> 634</span></a>          <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="var it76" onMouseOver="hilite(76)" onMouseOut="lolite()" onClick="logVariable('_GET')" href="../_variables/_GET.html">$_GET</a>[<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>];
<a name="l635"><span class="linenum"> 635</span></a>      } else {
<a name="l636"><span class="linenum"> 636</span></a>          return <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>;
<a name="l637"><span class="linenum"> 637</span></a>      }
<a name="l638"><span class="linenum"> 638</span></a>  
<a name="l639"><span class="linenum"> 639</span></a>      if (<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l640"><span class="linenum"> 640</span></a>          <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Invalid array parameter detected in <a class="function" onClick="logFunction('required_param')" href="../_functions/required_param.html" onMouseOver="funcPopup(event,'required_param')">required_param</a>(): '.<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>);
<a name="l641"><span class="linenum"> 641</span></a>  <span class="comment">        // TODO: switch to $default in Moodle 2.3.</span>
<a name="l642"><span class="linenum"> 642</span></a>          return <a class="function" onClick="logFunction('optional_param_array')" href="../_functions/optional_param_array.html" onMouseOver="funcPopup(event,'optional_param_array')">optional_param_array</a>(<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>, <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>, <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>);
<a name="l643"><span class="linenum"> 643</span></a>      }
<a name="l644"><span class="linenum"> 644</span></a>  
<a name="l645"><span class="linenum"> 645</span></a>      return <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>);
<a name="l646"><span class="linenum"> 646</span></a>  }
<a name="l647"><span class="linenum"> 647</span></a>  
<a name="l648"><span class="linenum"> 648</span></a>  <span class="comment">/**</span>
<a name="l649"><span class="linenum"> 649</span></a>  <span class="comment"> * Returns a particular array value for the named variable, taken from</span>
<a name="l650"><span class="linenum"> 650</span></a>  <span class="comment"> * POST or GET, otherwise returning a given default.</span>
<a name="l651"><span class="linenum"> 651</span></a>  <span class="comment"> *</span>
<a name="l652"><span class="linenum"> 652</span></a>  <span class="comment"> * This function should be used to initialise all optional values</span>
<a name="l653"><span class="linenum"> 653</span></a>  <span class="comment"> * in a script that are based on parameters.  Usually it will be</span>
<a name="l654"><span class="linenum"> 654</span></a>  <span class="comment"> * used like this:</span>
<a name="l655"><span class="linenum"> 655</span></a>  <span class="comment"> *    $ids = optional_param('id', array(), PARAM_INT);</span>
<a name="l656"><span class="linenum"> 656</span></a>  <span class="comment"> *</span>
<a name="l657"><span class="linenum"> 657</span></a>  <span class="comment"> * Note: arrays of arrays are not supported, only alphanumeric keys with _ and - are supported</span>
<a name="l658"><span class="linenum"> 658</span></a>  <span class="comment"> *</span>
<a name="l659"><span class="linenum"> 659</span></a>  <span class="comment"> * @param string $parname the name of the page parameter we want</span>
<a name="l660"><span class="linenum"> 660</span></a>  <span class="comment"> * @param mixed $default the default value to return if nothing is found</span>
<a name="l661"><span class="linenum"> 661</span></a>  <span class="comment"> * @param string $type expected type of parameter</span>
<a name="l662"><span class="linenum"> 662</span></a>  <span class="comment"> * @return array</span>
<a name="l663"><span class="linenum"> 663</span></a>  <span class="comment"> * @throws coding_exception</span>
<a name="l664"><span class="linenum"> 664</span></a>  <span class="comment"> */</span>
<a name="l665"><span class="linenum"> 665</span></a>  function <a class="function" onClick="logFunction('optional_param_array')" href="../_functions/optional_param_array.html" onMouseOver="funcPopup(event,'optional_param_array')">optional_param_array</a>(<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>, <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>, <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>) {
<a name="l666"><span class="linenum"> 666</span></a>      if (<a class="phpfunction" onClick="logFunction('func_num_args')" href="../_functions/func_num_args.html" onMouseOver="phpfuncPopup(event,'func_num_args')">func_num_args</a>() != 3 or empty(<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>) or empty(<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>)) {
<a name="l667"><span class="linenum"> 667</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('optional_param_array requires <a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>, <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a> + <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a> to be specified (parameter: '.<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>.')');
<a name="l668"><span class="linenum"> 668</span></a>      }
<a name="l669"><span class="linenum"> 669</span></a>  
<a name="l670"><span class="linenum"> 670</span></a>  <span class="comment">    // POST has precedence.</span>
<a name="l671"><span class="linenum"> 671</span></a>      if (isset(<a class="var it2053" onMouseOver="hilite(2053)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>[<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>])) {
<a name="l672"><span class="linenum"> 672</span></a>          <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="var it2053" onMouseOver="hilite(2053)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>[<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>];
<a name="l673"><span class="linenum"> 673</span></a>      } else if (isset(<a class="var it76" onMouseOver="hilite(76)" onMouseOut="lolite()" onClick="logVariable('_GET')" href="../_variables/_GET.html">$_GET</a>[<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>])) {
<a name="l674"><span class="linenum"> 674</span></a>          <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="var it76" onMouseOver="hilite(76)" onMouseOut="lolite()" onClick="logVariable('_GET')" href="../_variables/_GET.html">$_GET</a>[<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>];
<a name="l675"><span class="linenum"> 675</span></a>      } else {
<a name="l676"><span class="linenum"> 676</span></a>          return <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>;
<a name="l677"><span class="linenum"> 677</span></a>      }
<a name="l678"><span class="linenum"> 678</span></a>      if (!<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l679"><span class="linenum"> 679</span></a>          <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('<a class="function" onClick="logFunction('optional_param_array')" href="../_functions/optional_param_array.html" onMouseOver="funcPopup(event,'optional_param_array')">optional_param_array</a>() expects array parameters only: '.<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>);
<a name="l680"><span class="linenum"> 680</span></a>          return <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>;
<a name="l681"><span class="linenum"> 681</span></a>      }
<a name="l682"><span class="linenum"> 682</span></a>  
<a name="l683"><span class="linenum"> 683</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = array();
<a name="l684"><span class="linenum"> 684</span></a>      foreach (<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) {
<a name="l685"><span class="linenum"> 685</span></a>          if (!<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^[a-z0-9_-]+$/i', <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>)) {
<a name="l686"><span class="linenum"> 686</span></a>              <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Invalid key name in <a class="function" onClick="logFunction('optional_param_array')" href="../_functions/optional_param_array.html" onMouseOver="funcPopup(event,'optional_param_array')">optional_param_array</a>() detected: '.<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>.', parameter: '.<a class="var it12896" onMouseOver="hilite(12896)" onMouseOut="lolite()" onClick="logVariable('parname')" href="../_variables/parname.html">$parname</a>);
<a name="l687"><span class="linenum"> 687</span></a>              continue;
<a name="l688"><span class="linenum"> 688</span></a>          }
<a name="l689"><span class="linenum"> 689</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>, <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>);
<a name="l690"><span class="linenum"> 690</span></a>      }
<a name="l691"><span class="linenum"> 691</span></a>  
<a name="l692"><span class="linenum"> 692</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>;
<a name="l693"><span class="linenum"> 693</span></a>  }
<a name="l694"><span class="linenum"> 694</span></a>  
<a name="l695"><span class="linenum"> 695</span></a>  <span class="comment">/**</span>
<a name="l696"><span class="linenum"> 696</span></a>  <span class="comment"> * Strict validation of parameter values, the values are only converted</span>
<a name="l697"><span class="linenum"> 697</span></a>  <span class="comment"> * to requested PHP type. Internally it is using clean_param, the values</span>
<a name="l698"><span class="linenum"> 698</span></a>  <span class="comment"> * before and after cleaning must be equal - otherwise</span>
<a name="l699"><span class="linenum"> 699</span></a>  <span class="comment"> * an invalid_parameter_exception is thrown.</span>
<a name="l700"><span class="linenum"> 700</span></a>  <span class="comment"> * Objects and classes are not accepted.</span>
<a name="l701"><span class="linenum"> 701</span></a>  <span class="comment"> *</span>
<a name="l702"><span class="linenum"> 702</span></a>  <span class="comment"> * @param mixed $param</span>
<a name="l703"><span class="linenum"> 703</span></a>  <span class="comment"> * @param string $type PARAM_ constant</span>
<a name="l704"><span class="linenum"> 704</span></a>  <span class="comment"> * @param bool $allownull are nulls valid value?</span>
<a name="l705"><span class="linenum"> 705</span></a>  <span class="comment"> * @param string $debuginfo optional debug information</span>
<a name="l706"><span class="linenum"> 706</span></a>  <span class="comment"> * @return mixed the $param value converted to PHP type</span>
<a name="l707"><span class="linenum"> 707</span></a>  <span class="comment"> * @throws invalid_parameter_exception if $param is not of given type</span>
<a name="l708"><span class="linenum"> 708</span></a>  <span class="comment"> */</span>
<a name="l709"><span class="linenum"> 709</span></a>  function <a class="function" onClick="logFunction('validate_param')" href="../_functions/validate_param.html" onMouseOver="funcPopup(event,'validate_param')">validate_param</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>, <a class="var it12606" onMouseOver="hilite(12606)" onMouseOut="lolite()" onClick="logVariable('allownull')" href="../_variables/allownull.html">$allownull</a>=<a class="constant" onClick="logConstant('NULL_NOT_ALLOWED')" href="../_constants/NULL_NOT_ALLOWED.html" onMouseOver="constPopup(event,'NULL_NOT_ALLOWED')">NULL_NOT_ALLOWED</a>, <a class="var it545" onMouseOver="hilite(545)" onMouseOut="lolite()" onClick="logVariable('debuginfo')" href="../_variables/debuginfo.html">$debuginfo</a>='') {
<a name="l710"><span class="linenum"> 710</span></a>      if (<a class="phpfunction" onClick="logFunction('is_null')" href="../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l711"><span class="linenum"> 711</span></a>          if (<a class="var it12606" onMouseOver="hilite(12606)" onMouseOut="lolite()" onClick="logVariable('allownull')" href="../_variables/allownull.html">$allownull</a> == <a class="constant" onClick="logConstant('NULL_ALLOWED')" href="../_constants/NULL_ALLOWED.html" onMouseOver="constPopup(event,'NULL_ALLOWED')">NULL_ALLOWED</a>) {
<a name="l712"><span class="linenum"> 712</span></a>              return null;
<a name="l713"><span class="linenum"> 713</span></a>          } else {
<a name="l714"><span class="linenum"> 714</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('invalid_parameter_exception')" href="../_classes/invalid_parameter_exception.html" onMouseOver="classPopup(event,'invalid_parameter_exception')">invalid_parameter_exception</a>(<a class="var it545" onMouseOver="hilite(545)" onMouseOut="lolite()" onClick="logVariable('debuginfo')" href="../_variables/debuginfo.html">$debuginfo</a>);
<a name="l715"><span class="linenum"> 715</span></a>          }
<a name="l716"><span class="linenum"> 716</span></a>      }
<a name="l717"><span class="linenum"> 717</span></a>      if (<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>) or <a class="phpfunction" onClick="logFunction('is_object')" href="../_functions/is_object.html" onMouseOver="phpfuncPopup(event,'is_object')">is_object</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l718"><span class="linenum"> 718</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('invalid_parameter_exception')" href="../_classes/invalid_parameter_exception.html" onMouseOver="classPopup(event,'invalid_parameter_exception')">invalid_parameter_exception</a>(<a class="var it545" onMouseOver="hilite(545)" onMouseOut="lolite()" onClick="logVariable('debuginfo')" href="../_variables/debuginfo.html">$debuginfo</a>);
<a name="l719"><span class="linenum"> 719</span></a>      }
<a name="l720"><span class="linenum"> 720</span></a>  
<a name="l721"><span class="linenum"> 721</span></a>      <a class="var it43" onMouseOver="hilite(43)" onMouseOut="lolite()" onClick="logVariable('cleaned')" href="../_variables/cleaned.html">$cleaned</a> = <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>);
<a name="l722"><span class="linenum"> 722</span></a>  
<a name="l723"><span class="linenum"> 723</span></a>      if (<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a> == <a class="constant" onClick="logConstant('PARAM_FLOAT')" href="../_constants/PARAM_FLOAT.html" onMouseOver="constPopup(event,'PARAM_FLOAT')">PARAM_FLOAT</a>) {
<a name="l724"><span class="linenum"> 724</span></a>  <span class="comment">        // Do not detect precision loss here.</span>
<a name="l725"><span class="linenum"> 725</span></a>          if (<a class="phpfunction" onClick="logFunction('is_float')" href="../_functions/is_float.html" onMouseOver="phpfuncPopup(event,'is_float')">is_float</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>) or is_int(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l726"><span class="linenum"> 726</span></a>  <span class="comment">            // These always fit.</span>
<a name="l727"><span class="linenum"> 727</span></a>          } else if (!<a class="phpfunction" onClick="logFunction('is_numeric')" href="../_functions/is_numeric.html" onMouseOver="phpfuncPopup(event,'is_numeric')">is_numeric</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>) or !<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^[\+-]?[0-9]*\.?[0-9]*(e[-+]?[0-9]+)?$/i', (string)<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l728"><span class="linenum"> 728</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('invalid_parameter_exception')" href="../_classes/invalid_parameter_exception.html" onMouseOver="classPopup(event,'invalid_parameter_exception')">invalid_parameter_exception</a>(<a class="var it545" onMouseOver="hilite(545)" onMouseOut="lolite()" onClick="logVariable('debuginfo')" href="../_variables/debuginfo.html">$debuginfo</a>);
<a name="l729"><span class="linenum"> 729</span></a>          }
<a name="l730"><span class="linenum"> 730</span></a>      } else if ((string)<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> !== (string)<a class="var it43" onMouseOver="hilite(43)" onMouseOut="lolite()" onClick="logVariable('cleaned')" href="../_variables/cleaned.html">$cleaned</a>) {
<a name="l731"><span class="linenum"> 731</span></a>  <span class="comment">        // Conversion to string is usually lossless.</span>
<a name="l732"><span class="linenum"> 732</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('invalid_parameter_exception')" href="../_classes/invalid_parameter_exception.html" onMouseOver="classPopup(event,'invalid_parameter_exception')">invalid_parameter_exception</a>(<a class="var it545" onMouseOver="hilite(545)" onMouseOut="lolite()" onClick="logVariable('debuginfo')" href="../_variables/debuginfo.html">$debuginfo</a>);
<a name="l733"><span class="linenum"> 733</span></a>      }
<a name="l734"><span class="linenum"> 734</span></a>  
<a name="l735"><span class="linenum"> 735</span></a>      return <a class="var it43" onMouseOver="hilite(43)" onMouseOut="lolite()" onClick="logVariable('cleaned')" href="../_variables/cleaned.html">$cleaned</a>;
<a name="l736"><span class="linenum"> 736</span></a>  }
<a name="l737"><span class="linenum"> 737</span></a>  
<a name="l738"><span class="linenum"> 738</span></a>  <span class="comment">/**</span>
<a name="l739"><span class="linenum"> 739</span></a>  <span class="comment"> * Makes sure array contains only the allowed types, this function does not validate array key names!</span>
<a name="l740"><span class="linenum"> 740</span></a>  <span class="comment"> *</span>
<a name="l741"><span class="linenum"> 741</span></a>  <span class="comment"> * &lt;code&gt;</span>
<a name="l742"><span class="linenum"> 742</span></a>  <span class="comment"> * $options = clean_param($options, PARAM_INT);</span>
<a name="l743"><span class="linenum"> 743</span></a>  <span class="comment"> * &lt;/code&gt;</span>
<a name="l744"><span class="linenum"> 744</span></a>  <span class="comment"> *</span>
<a name="l745"><span class="linenum"> 745</span></a>  <span class="comment"> * @param array $param the variable array we are cleaning</span>
<a name="l746"><span class="linenum"> 746</span></a>  <span class="comment"> * @param string $type expected format of param after cleaning.</span>
<a name="l747"><span class="linenum"> 747</span></a>  <span class="comment"> * @param bool $recursive clean recursive arrays</span>
<a name="l748"><span class="linenum"> 748</span></a>  <span class="comment"> * @return array</span>
<a name="l749"><span class="linenum"> 749</span></a>  <span class="comment"> * @throws coding_exception</span>
<a name="l750"><span class="linenum"> 750</span></a>  <span class="comment"> */</span>
<a name="l751"><span class="linenum"> 751</span></a>  function <a class="function" onClick="logFunction('clean_param_array')" href="../_functions/clean_param_array.html" onMouseOver="funcPopup(event,'clean_param_array')">clean_param_array</a>(array <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = null, <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>, <a class="var it3455" onMouseOver="hilite(3455)" onMouseOut="lolite()" onClick="logVariable('recursive')" href="../_variables/recursive.html">$recursive</a> = false) {
<a name="l752"><span class="linenum"> 752</span></a>  <span class="comment">    // Convert null to empty array.</span>
<a name="l753"><span class="linenum"> 753</span></a>      <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = (array)<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l754"><span class="linenum"> 754</span></a>      foreach (<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) {
<a name="l755"><span class="linenum"> 755</span></a>          if (<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>)) {
<a name="l756"><span class="linenum"> 756</span></a>              if (<a class="var it3455" onMouseOver="hilite(3455)" onMouseOut="lolite()" onClick="logVariable('recursive')" href="../_variables/recursive.html">$recursive</a>) {
<a name="l757"><span class="linenum"> 757</span></a>                  <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = <a class="function" onClick="logFunction('clean_param_array')" href="../_functions/clean_param_array.html" onMouseOver="funcPopup(event,'clean_param_array')">clean_param_array</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>, <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>, true);
<a name="l758"><span class="linenum"> 758</span></a>              } else {
<a name="l759"><span class="linenum"> 759</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('clean_param_array can not process multidimensional arrays when <a class="var it3455" onMouseOver="hilite(3455)" onMouseOut="lolite()" onClick="logVariable('recursive')" href="../_variables/recursive.html">$recursive</a> is false.');
<a name="l760"><span class="linenum"> 760</span></a>              }
<a name="l761"><span class="linenum"> 761</span></a>          } else {
<a name="l762"><span class="linenum"> 762</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>, <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>);
<a name="l763"><span class="linenum"> 763</span></a>          }
<a name="l764"><span class="linenum"> 764</span></a>      }
<a name="l765"><span class="linenum"> 765</span></a>      return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l766"><span class="linenum"> 766</span></a>  }
<a name="l767"><span class="linenum"> 767</span></a>  
<a name="l768"><span class="linenum"> 768</span></a>  <span class="comment">/**</span>
<a name="l769"><span class="linenum"> 769</span></a>  <span class="comment"> * Used by {@link optional_param()} and {@link required_param()} to</span>
<a name="l770"><span class="linenum"> 770</span></a>  <span class="comment"> * clean the variables and/or cast to specific types, based on</span>
<a name="l771"><span class="linenum"> 771</span></a>  <span class="comment"> * an options field.</span>
<a name="l772"><span class="linenum"> 772</span></a>  <span class="comment"> * &lt;code&gt;</span>
<a name="l773"><span class="linenum"> 773</span></a>  <span class="comment"> * $course-&gt;format = clean_param($course-&gt;format, PARAM_ALPHA);</span>
<a name="l774"><span class="linenum"> 774</span></a>  <span class="comment"> * $selectedgradeitem = clean_param($selectedgradeitem, PARAM_INT);</span>
<a name="l775"><span class="linenum"> 775</span></a>  <span class="comment"> * &lt;/code&gt;</span>
<a name="l776"><span class="linenum"> 776</span></a>  <span class="comment"> *</span>
<a name="l777"><span class="linenum"> 777</span></a>  <span class="comment"> * @param mixed $param the variable we are cleaning</span>
<a name="l778"><span class="linenum"> 778</span></a>  <span class="comment"> * @param string $type expected format of param after cleaning.</span>
<a name="l779"><span class="linenum"> 779</span></a>  <span class="comment"> * @return mixed</span>
<a name="l780"><span class="linenum"> 780</span></a>  <span class="comment"> * @throws coding_exception</span>
<a name="l781"><span class="linenum"> 781</span></a>  <span class="comment"> */</span>
<a name="l782"><span class="linenum"> 782</span></a>  function <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>) {
<a name="l783"><span class="linenum"> 783</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l784"><span class="linenum"> 784</span></a>  
<a name="l785"><span class="linenum"> 785</span></a>      if (<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l786"><span class="linenum"> 786</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('<a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>() can not process arrays, please use <a class="function" onClick="logFunction('clean_param_array')" href="../_functions/clean_param_array.html" onMouseOver="funcPopup(event,'clean_param_array')">clean_param_array</a>() instead.');
<a name="l787"><span class="linenum"> 787</span></a>      } else if (<a class="phpfunction" onClick="logFunction('is_object')" href="../_functions/is_object.html" onMouseOver="phpfuncPopup(event,'is_object')">is_object</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l788"><span class="linenum"> 788</span></a>          if (<a class="phpfunction" onClick="logFunction('method_exists')" href="../_functions/method_exists.html" onMouseOver="phpfuncPopup(event,'method_exists')">method_exists</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, '__toString')) {
<a name="l789"><span class="linenum"> 789</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>-&gt;<a class="function" onClick="logFunction('__toString')" href="../_functions/__tostring.html" onMouseOver="funcPopup(event,'__tostring')">__toString</a>();
<a name="l790"><span class="linenum"> 790</span></a>          } else {
<a name="l791"><span class="linenum"> 791</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('<a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>() can not process objects, please use <a class="function" onClick="logFunction('clean_param_array')" href="../_functions/clean_param_array.html" onMouseOver="funcPopup(event,'clean_param_array')">clean_param_array</a>() instead.');
<a name="l792"><span class="linenum"> 792</span></a>          }
<a name="l793"><span class="linenum"> 793</span></a>      }
<a name="l794"><span class="linenum"> 794</span></a>  
<a name="l795"><span class="linenum"> 795</span></a>      switch (<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>) {
<a name="l796"><span class="linenum"> 796</span></a>          case <a class="constant" onClick="logConstant('PARAM_RAW')" href="../_constants/PARAM_RAW.html" onMouseOver="constPopup(event,'PARAM_RAW')">PARAM_RAW</a>:
<a name="l797"><span class="linenum"> 797</span></a>  <span class="comment">            // No cleaning at all.</span>
<a name="l798"><span class="linenum"> 798</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="function" onClick="logFunction('fix_utf8')" href="../_functions/fix_utf8.html" onMouseOver="funcPopup(event,'fix_utf8')">fix_utf8</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l799"><span class="linenum"> 799</span></a>              return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l800"><span class="linenum"> 800</span></a>  
<a name="l801"><span class="linenum"> 801</span></a>          case <a class="constant" onClick="logConstant('PARAM_RAW_TRIMMED')" href="../_constants/PARAM_RAW_TRIMMED.html" onMouseOver="constPopup(event,'PARAM_RAW_TRIMMED')">PARAM_RAW_TRIMMED</a>:
<a name="l802"><span class="linenum"> 802</span></a>  <span class="comment">            // No cleaning, but strip leading and trailing whitespace.</span>
<a name="l803"><span class="linenum"> 803</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="function" onClick="logFunction('fix_utf8')" href="../_functions/fix_utf8.html" onMouseOver="funcPopup(event,'fix_utf8')">fix_utf8</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l804"><span class="linenum"> 804</span></a>              return <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l805"><span class="linenum"> 805</span></a>  
<a name="l806"><span class="linenum"> 806</span></a>          case <a class="constant" onClick="logConstant('PARAM_CLEAN')" href="../_constants/PARAM_CLEAN.html" onMouseOver="constPopup(event,'PARAM_CLEAN')">PARAM_CLEAN</a>:
<a name="l807"><span class="linenum"> 807</span></a>  <span class="comment">            // General HTML cleaning, try to use more specific type if possible this is deprecated!</span>
<a name="l808"><span class="linenum"> 808</span></a>  <span class="comment">            // Please use more specific type instead.</span>
<a name="l809"><span class="linenum"> 809</span></a>              if (<a class="phpfunction" onClick="logFunction('is_numeric')" href="../_functions/is_numeric.html" onMouseOver="phpfuncPopup(event,'is_numeric')">is_numeric</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l810"><span class="linenum"> 810</span></a>                  return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l811"><span class="linenum"> 811</span></a>              }
<a name="l812"><span class="linenum"> 812</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="function" onClick="logFunction('fix_utf8')" href="../_functions/fix_utf8.html" onMouseOver="funcPopup(event,'fix_utf8')">fix_utf8</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l813"><span class="linenum"> 813</span></a>  <span class="comment">            // Sweep for scripts, etc.</span>
<a name="l814"><span class="linenum"> 814</span></a>              return <a class="function" onClick="logFunction('clean_text')" href="../_functions/clean_text.html" onMouseOver="funcPopup(event,'clean_text')">clean_text</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l815"><span class="linenum"> 815</span></a>  
<a name="l816"><span class="linenum"> 816</span></a>          case <a class="constant" onClick="logConstant('PARAM_CLEANHTML')" href="../_constants/PARAM_CLEANHTML.html" onMouseOver="constPopup(event,'PARAM_CLEANHTML')">PARAM_CLEANHTML</a>:
<a name="l817"><span class="linenum"> 817</span></a>  <span class="comment">            // Clean html fragment.</span>
<a name="l818"><span class="linenum"> 818</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="function" onClick="logFunction('fix_utf8')" href="../_functions/fix_utf8.html" onMouseOver="funcPopup(event,'fix_utf8')">fix_utf8</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l819"><span class="linenum"> 819</span></a>  <span class="comment">            // Sweep for scripts, etc.</span>
<a name="l820"><span class="linenum"> 820</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="function" onClick="logFunction('clean_text')" href="../_functions/clean_text.html" onMouseOver="funcPopup(event,'clean_text')">clean_text</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, <a class="constant" onClick="logConstant('FORMAT_HTML')" href="../_constants/FORMAT_HTML.html" onMouseOver="constPopup(event,'FORMAT_HTML')">FORMAT_HTML</a>);
<a name="l821"><span class="linenum"> 821</span></a>              return <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l822"><span class="linenum"> 822</span></a>  
<a name="l823"><span class="linenum"> 823</span></a>          case <a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>:
<a name="l824"><span class="linenum"> 824</span></a>  <span class="comment">            // Convert to integer.</span>
<a name="l825"><span class="linenum"> 825</span></a>              return (int)<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l826"><span class="linenum"> 826</span></a>  
<a name="l827"><span class="linenum"> 827</span></a>          case <a class="constant" onClick="logConstant('PARAM_FLOAT')" href="../_constants/PARAM_FLOAT.html" onMouseOver="constPopup(event,'PARAM_FLOAT')">PARAM_FLOAT</a>:
<a name="l828"><span class="linenum"> 828</span></a>  <span class="comment">            // Convert to float.</span>
<a name="l829"><span class="linenum"> 829</span></a>              return (float)<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l830"><span class="linenum"> 830</span></a>  
<a name="l831"><span class="linenum"> 831</span></a>          case <a class="constant" onClick="logConstant('PARAM_ALPHA')" href="../_constants/PARAM_ALPHA.html" onMouseOver="constPopup(event,'PARAM_ALPHA')">PARAM_ALPHA</a>:
<a name="l832"><span class="linenum"> 832</span></a>  <span class="comment">            // Remove everything not `a-z`.</span>
<a name="l833"><span class="linenum"> 833</span></a>              return <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/[^a-zA-Z]/i', '', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l834"><span class="linenum"> 834</span></a>  
<a name="l835"><span class="linenum"> 835</span></a>          case <a class="constant" onClick="logConstant('PARAM_ALPHAEXT')" href="../_constants/PARAM_ALPHAEXT.html" onMouseOver="constPopup(event,'PARAM_ALPHAEXT')">PARAM_ALPHAEXT</a>:
<a name="l836"><span class="linenum"> 836</span></a>  <span class="comment">            // Remove everything not `a-zA-Z_-` (originally allowed &quot;/&quot; too).</span>
<a name="l837"><span class="linenum"> 837</span></a>              return <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/[^a-zA-Z_-]/i', '', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l838"><span class="linenum"> 838</span></a>  
<a name="l839"><span class="linenum"> 839</span></a>          case <a class="constant" onClick="logConstant('PARAM_ALPHANUM')" href="../_constants/PARAM_ALPHANUM.html" onMouseOver="constPopup(event,'PARAM_ALPHANUM')">PARAM_ALPHANUM</a>:
<a name="l840"><span class="linenum"> 840</span></a>  <span class="comment">            // Remove everything not `a-zA-Z0-9`.</span>
<a name="l841"><span class="linenum"> 841</span></a>              return <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/[^A-Za-z0-9]/i', '', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l842"><span class="linenum"> 842</span></a>  
<a name="l843"><span class="linenum"> 843</span></a>          case <a class="constant" onClick="logConstant('PARAM_ALPHANUMEXT')" href="../_constants/PARAM_ALPHANUMEXT.html" onMouseOver="constPopup(event,'PARAM_ALPHANUMEXT')">PARAM_ALPHANUMEXT</a>:
<a name="l844"><span class="linenum"> 844</span></a>  <span class="comment">            // Remove everything not `a-zA-Z0-9_-`.</span>
<a name="l845"><span class="linenum"> 845</span></a>              return <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/[^A-Za-z0-9_-]/i', '', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l846"><span class="linenum"> 846</span></a>  
<a name="l847"><span class="linenum"> 847</span></a>          case <a class="constant" onClick="logConstant('PARAM_SEQUENCE')" href="../_constants/PARAM_SEQUENCE.html" onMouseOver="constPopup(event,'PARAM_SEQUENCE')">PARAM_SEQUENCE</a>:
<a name="l848"><span class="linenum"> 848</span></a>  <span class="comment">            // Remove everything not `0-9,`.</span>
<a name="l849"><span class="linenum"> 849</span></a>              return <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/[^0-9,]/i', '', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l850"><span class="linenum"> 850</span></a>  
<a name="l851"><span class="linenum"> 851</span></a>          case <a class="constant" onClick="logConstant('PARAM_BOOL')" href="../_constants/PARAM_BOOL.html" onMouseOver="constPopup(event,'PARAM_BOOL')">PARAM_BOOL</a>:
<a name="l852"><span class="linenum"> 852</span></a>  <span class="comment">            // Convert to 1 or 0.</span>
<a name="l853"><span class="linenum"> 853</span></a>              <a class="var it12897" onMouseOver="hilite(12897)" onMouseOut="lolite()" onClick="logVariable('tempstr')" href="../_variables/tempstr.html">$tempstr</a> = <a class="phpfunction" onClick="logFunction('strtolower')" href="../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l854"><span class="linenum"> 854</span></a>              if (<a class="var it12897" onMouseOver="hilite(12897)" onMouseOut="lolite()" onClick="logVariable('tempstr')" href="../_variables/tempstr.html">$tempstr</a> === 'on' or <a class="var it12897" onMouseOver="hilite(12897)" onMouseOut="lolite()" onClick="logVariable('tempstr')" href="../_variables/tempstr.html">$tempstr</a> === 'yes' or <a class="var it12897" onMouseOver="hilite(12897)" onMouseOut="lolite()" onClick="logVariable('tempstr')" href="../_variables/tempstr.html">$tempstr</a> === 'true') {
<a name="l855"><span class="linenum"> 855</span></a>                  <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = 1;
<a name="l856"><span class="linenum"> 856</span></a>              } else if (<a class="var it12897" onMouseOver="hilite(12897)" onMouseOut="lolite()" onClick="logVariable('tempstr')" href="../_variables/tempstr.html">$tempstr</a> === 'off' or <a class="var it12897" onMouseOver="hilite(12897)" onMouseOut="lolite()" onClick="logVariable('tempstr')" href="../_variables/tempstr.html">$tempstr</a> === 'no'  or <a class="var it12897" onMouseOver="hilite(12897)" onMouseOut="lolite()" onClick="logVariable('tempstr')" href="../_variables/tempstr.html">$tempstr</a> === 'false') {
<a name="l857"><span class="linenum"> 857</span></a>                  <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = 0;
<a name="l858"><span class="linenum"> 858</span></a>              } else {
<a name="l859"><span class="linenum"> 859</span></a>                  <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = empty(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>) ? 0 : 1;
<a name="l860"><span class="linenum"> 860</span></a>              }
<a name="l861"><span class="linenum"> 861</span></a>              return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l862"><span class="linenum"> 862</span></a>  
<a name="l863"><span class="linenum"> 863</span></a>          case <a class="constant" onClick="logConstant('PARAM_NOTAGS')" href="../_constants/PARAM_NOTAGS.html" onMouseOver="constPopup(event,'PARAM_NOTAGS')">PARAM_NOTAGS</a>:
<a name="l864"><span class="linenum"> 864</span></a>  <span class="comment">            // Strip all tags.</span>
<a name="l865"><span class="linenum"> 865</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="function" onClick="logFunction('fix_utf8')" href="../_functions/fix_utf8.html" onMouseOver="funcPopup(event,'fix_utf8')">fix_utf8</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l866"><span class="linenum"> 866</span></a>              return <a class="phpfunction" onClick="logFunction('strip_tags')" href="../_functions/strip_tags.html" onMouseOver="phpfuncPopup(event,'strip_tags')">strip_tags</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l867"><span class="linenum"> 867</span></a>  
<a name="l868"><span class="linenum"> 868</span></a>          case <a class="constant" onClick="logConstant('PARAM_TEXT')" href="../_constants/PARAM_TEXT.html" onMouseOver="constPopup(event,'PARAM_TEXT')">PARAM_TEXT</a>:
<a name="l869"><span class="linenum"> 869</span></a>  <span class="comment">            // Leave only tags needed for multilang.</span>
<a name="l870"><span class="linenum"> 870</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="function" onClick="logFunction('fix_utf8')" href="../_functions/fix_utf8.html" onMouseOver="funcPopup(event,'fix_utf8')">fix_utf8</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l871"><span class="linenum"> 871</span></a>  <span class="comment">            // If the multilang syntax is not correct we strip all tags because it would break xhtml strict which is required</span>
<a name="l872"><span class="linenum"> 872</span></a>  <span class="comment">            // for accessibility standards please note this cleaning does not strip unbalanced '&gt;' for BC compatibility reasons.</span>
<a name="l873"><span class="linenum"> 873</span></a>              do {
<a name="l874"><span class="linenum"> 874</span></a>                  if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, '&lt;/lang&gt;') !== false) {
<a name="l875"><span class="linenum"> 875</span></a>  <span class="comment">                    // Old and future mutilang syntax.</span>
<a name="l876"><span class="linenum"> 876</span></a>                      <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="phpfunction" onClick="logFunction('strip_tags')" href="../_functions/strip_tags.html" onMouseOver="phpfuncPopup(event,'strip_tags')">strip_tags</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, '&lt;lang&gt;');
<a name="l877"><span class="linenum"> 877</span></a>                      if (!<a class="phpfunction" onClick="logFunction('preg_match_all')" href="../_functions/preg_match_all.html" onMouseOver="phpfuncPopup(event,'preg_match_all')">preg_match_all</a>('/&lt;.*&gt;/suU', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>)) {
<a name="l878"><span class="linenum"> 878</span></a>                          break;
<a name="l879"><span class="linenum"> 879</span></a>                      }
<a name="l880"><span class="linenum"> 880</span></a>                      <a class="var it12898" onMouseOver="hilite(12898)" onMouseOut="lolite()" onClick="logVariable('open')" href="../_variables/open.html">$open</a> = false;
<a name="l881"><span class="linenum"> 881</span></a>                      foreach (<a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>[0] as <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a>) {
<a name="l882"><span class="linenum"> 882</span></a>                          if (<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a> === '&lt;/lang&gt;') {
<a name="l883"><span class="linenum"> 883</span></a>                              if (<a class="var it12898" onMouseOver="hilite(12898)" onMouseOut="lolite()" onClick="logVariable('open')" href="../_variables/open.html">$open</a>) {
<a name="l884"><span class="linenum"> 884</span></a>                                  <a class="var it12898" onMouseOver="hilite(12898)" onMouseOut="lolite()" onClick="logVariable('open')" href="../_variables/open.html">$open</a> = false;
<a name="l885"><span class="linenum"> 885</span></a>                                  continue;
<a name="l886"><span class="linenum"> 886</span></a>                              } else {
<a name="l887"><span class="linenum"> 887</span></a>                                  break 2;
<a name="l888"><span class="linenum"> 888</span></a>                              }
<a name="l889"><span class="linenum"> 889</span></a>                          }
<a name="l890"><span class="linenum"> 890</span></a>                          if (!<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^&lt;lang lang=&quot;[a-zA-Z0-9_-]+&quot;\s*&gt;$/u', <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a>)) {
<a name="l891"><span class="linenum"> 891</span></a>                              break 2;
<a name="l892"><span class="linenum"> 892</span></a>                          } else {
<a name="l893"><span class="linenum"> 893</span></a>                              <a class="var it12898" onMouseOver="hilite(12898)" onMouseOut="lolite()" onClick="logVariable('open')" href="../_variables/open.html">$open</a> = true;
<a name="l894"><span class="linenum"> 894</span></a>                          }
<a name="l895"><span class="linenum"> 895</span></a>                      }
<a name="l896"><span class="linenum"> 896</span></a>                      if (<a class="var it12898" onMouseOver="hilite(12898)" onMouseOut="lolite()" onClick="logVariable('open')" href="../_variables/open.html">$open</a>) {
<a name="l897"><span class="linenum"> 897</span></a>                          break;
<a name="l898"><span class="linenum"> 898</span></a>                      }
<a name="l899"><span class="linenum"> 899</span></a>                      return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l900"><span class="linenum"> 900</span></a>  
<a name="l901"><span class="linenum"> 901</span></a>                  } else if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, '&lt;/span&gt;') !== false) {
<a name="l902"><span class="linenum"> 902</span></a>  <span class="comment">                    // Current problematic multilang syntax.</span>
<a name="l903"><span class="linenum"> 903</span></a>                      <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="phpfunction" onClick="logFunction('strip_tags')" href="../_functions/strip_tags.html" onMouseOver="phpfuncPopup(event,'strip_tags')">strip_tags</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, '&lt;span&gt;');
<a name="l904"><span class="linenum"> 904</span></a>                      if (!<a class="phpfunction" onClick="logFunction('preg_match_all')" href="../_functions/preg_match_all.html" onMouseOver="phpfuncPopup(event,'preg_match_all')">preg_match_all</a>('/&lt;.*&gt;/suU', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>)) {
<a name="l905"><span class="linenum"> 905</span></a>                          break;
<a name="l906"><span class="linenum"> 906</span></a>                      }
<a name="l907"><span class="linenum"> 907</span></a>                      <a class="var it12898" onMouseOver="hilite(12898)" onMouseOut="lolite()" onClick="logVariable('open')" href="../_variables/open.html">$open</a> = false;
<a name="l908"><span class="linenum"> 908</span></a>                      foreach (<a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>[0] as <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a>) {
<a name="l909"><span class="linenum"> 909</span></a>                          if (<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a> === '&lt;/span&gt;') {
<a name="l910"><span class="linenum"> 910</span></a>                              if (<a class="var it12898" onMouseOver="hilite(12898)" onMouseOut="lolite()" onClick="logVariable('open')" href="../_variables/open.html">$open</a>) {
<a name="l911"><span class="linenum"> 911</span></a>                                  <a class="var it12898" onMouseOver="hilite(12898)" onMouseOut="lolite()" onClick="logVariable('open')" href="../_variables/open.html">$open</a> = false;
<a name="l912"><span class="linenum"> 912</span></a>                                  continue;
<a name="l913"><span class="linenum"> 913</span></a>                              } else {
<a name="l914"><span class="linenum"> 914</span></a>                                  break 2;
<a name="l915"><span class="linenum"> 915</span></a>                              }
<a name="l916"><span class="linenum"> 916</span></a>                          }
<a name="l917"><span class="linenum"> 917</span></a>                          if (!<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^&lt;<a class="function" onClick="logFunction('span')" href="../_functions/span.html" onMouseOver="funcPopup(event,'span')">span</a>(\s+lang=&quot;[a-zA-Z0-9_-]+&quot;|\s+class=&quot;multilang&quot;){2}\s*&gt;$/u', <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a>)) {
<a name="l918"><span class="linenum"> 918</span></a>                              break 2;
<a name="l919"><span class="linenum"> 919</span></a>                          } else {
<a name="l920"><span class="linenum"> 920</span></a>                              <a class="var it12898" onMouseOver="hilite(12898)" onMouseOut="lolite()" onClick="logVariable('open')" href="../_variables/open.html">$open</a> = true;
<a name="l921"><span class="linenum"> 921</span></a>                          }
<a name="l922"><span class="linenum"> 922</span></a>                      }
<a name="l923"><span class="linenum"> 923</span></a>                      if (<a class="var it12898" onMouseOver="hilite(12898)" onMouseOut="lolite()" onClick="logVariable('open')" href="../_variables/open.html">$open</a>) {
<a name="l924"><span class="linenum"> 924</span></a>                          break;
<a name="l925"><span class="linenum"> 925</span></a>                      }
<a name="l926"><span class="linenum"> 926</span></a>                      return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l927"><span class="linenum"> 927</span></a>                  }
<a name="l928"><span class="linenum"> 928</span></a>              } while (false);
<a name="l929"><span class="linenum"> 929</span></a>  <span class="comment">            // Easy, just strip all tags, if we ever want to fix orphaned '&amp;' we have to do that in format_string().</span>
<a name="l930"><span class="linenum"> 930</span></a>              return <a class="phpfunction" onClick="logFunction('strip_tags')" href="../_functions/strip_tags.html" onMouseOver="phpfuncPopup(event,'strip_tags')">strip_tags</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l931"><span class="linenum"> 931</span></a>  
<a name="l932"><span class="linenum"> 932</span></a>          case <a class="constant" onClick="logConstant('PARAM_COMPONENT')" href="../_constants/PARAM_COMPONENT.html" onMouseOver="constPopup(event,'PARAM_COMPONENT')">PARAM_COMPONENT</a>:
<a name="l933"><span class="linenum"> 933</span></a>  <span class="comment">            // We do not want any guessing here, either the name is correct or not</span>
<a name="l934"><span class="linenum"> 934</span></a>  <span class="comment">            // please note only normalised component names are accepted.</span>
<a name="l935"><span class="linenum"> 935</span></a>              if (!<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^[a-z]+(_[a-z][a-z0-9_]*)?[a-z0-9]+$/', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l936"><span class="linenum"> 936</span></a>                  return '';
<a name="l937"><span class="linenum"> 937</span></a>              }
<a name="l938"><span class="linenum"> 938</span></a>              if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, '__') !== false) {
<a name="l939"><span class="linenum"> 939</span></a>                  return '';
<a name="l940"><span class="linenum"> 940</span></a>              }
<a name="l941"><span class="linenum"> 941</span></a>              if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, 'mod_') === 0) {
<a name="l942"><span class="linenum"> 942</span></a>  <span class="comment">                // Module names must not contain underscores because we need to differentiate them from invalid plugin types.</span>
<a name="l943"><span class="linenum"> 943</span></a>                  if (<a class="phpfunction" onClick="logFunction('substr_count')" href="../_functions/substr_count.html" onMouseOver="phpfuncPopup(event,'substr_count')">substr_count</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, '_') != 1) {
<a name="l944"><span class="linenum"> 944</span></a>                      return '';
<a name="l945"><span class="linenum"> 945</span></a>                  }
<a name="l946"><span class="linenum"> 946</span></a>              }
<a name="l947"><span class="linenum"> 947</span></a>              return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l948"><span class="linenum"> 948</span></a>  
<a name="l949"><span class="linenum"> 949</span></a>          case <a class="constant" onClick="logConstant('PARAM_PLUGIN')" href="../_constants/PARAM_PLUGIN.html" onMouseOver="constPopup(event,'PARAM_PLUGIN')">PARAM_PLUGIN</a>:
<a name="l950"><span class="linenum"> 950</span></a>          case <a class="constant" onClick="logConstant('PARAM_AREA')" href="../_constants/PARAM_AREA.html" onMouseOver="constPopup(event,'PARAM_AREA')">PARAM_AREA</a>:
<a name="l951"><span class="linenum"> 951</span></a>  <span class="comment">            // We do not want any guessing here, either the name is correct or not.</span>
<a name="l952"><span class="linenum"> 952</span></a>              if (!<a class="function" onClick="logFunction('is_valid_plugin_name')" href="../_functions/is_valid_plugin_name.html" onMouseOver="funcPopup(event,'is_valid_plugin_name')">is_valid_plugin_name</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l953"><span class="linenum"> 953</span></a>                  return '';
<a name="l954"><span class="linenum"> 954</span></a>              }
<a name="l955"><span class="linenum"> 955</span></a>              return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l956"><span class="linenum"> 956</span></a>  
<a name="l957"><span class="linenum"> 957</span></a>          case <a class="constant" onClick="logConstant('PARAM_SAFEDIR')" href="../_constants/PARAM_SAFEDIR.html" onMouseOver="constPopup(event,'PARAM_SAFEDIR')">PARAM_SAFEDIR</a>:
<a name="l958"><span class="linenum"> 958</span></a>  <span class="comment">            // Remove everything not a-zA-Z0-9_- .</span>
<a name="l959"><span class="linenum"> 959</span></a>              return <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/[^a-zA-Z0-9_-]/i', '', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l960"><span class="linenum"> 960</span></a>  
<a name="l961"><span class="linenum"> 961</span></a>          case <a class="constant" onClick="logConstant('PARAM_SAFEPATH')" href="../_constants/PARAM_SAFEPATH.html" onMouseOver="constPopup(event,'PARAM_SAFEPATH')">PARAM_SAFEPATH</a>:
<a name="l962"><span class="linenum"> 962</span></a>  <span class="comment">            // Remove everything not a-zA-Z0-9/_- .</span>
<a name="l963"><span class="linenum"> 963</span></a>              return <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/[^a-zA-Z0-9\/_-]/i', '', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l964"><span class="linenum"> 964</span></a>  
<a name="l965"><span class="linenum"> 965</span></a>          case <a class="constant" onClick="logConstant('PARAM_FILE')" href="../_constants/PARAM_FILE.html" onMouseOver="constPopup(event,'PARAM_FILE')">PARAM_FILE</a>:
<a name="l966"><span class="linenum"> 966</span></a>  <span class="comment">            // Strip all suspicious characters from filename.</span>
<a name="l967"><span class="linenum"> 967</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="function" onClick="logFunction('fix_utf8')" href="../_functions/fix_utf8.html" onMouseOver="funcPopup(event,'fix_utf8')">fix_utf8</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l968"><span class="linenum"> 968</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('~[[:cntrl:]]|[&amp;&lt;&gt;&quot;`\|\':\\\\/]~u', '', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l969"><span class="linenum"> 969</span></a>              if (<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> === '.' || <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> === '..') {
<a name="l970"><span class="linenum"> 970</span></a>                  <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = '';
<a name="l971"><span class="linenum"> 971</span></a>              }
<a name="l972"><span class="linenum"> 972</span></a>              return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l973"><span class="linenum"> 973</span></a>  
<a name="l974"><span class="linenum"> 974</span></a>          case <a class="constant" onClick="logConstant('PARAM_PATH')" href="../_constants/PARAM_PATH.html" onMouseOver="constPopup(event,'PARAM_PATH')">PARAM_PATH</a>:
<a name="l975"><span class="linenum"> 975</span></a>  <span class="comment">            // Strip all suspicious characters from file path.</span>
<a name="l976"><span class="linenum"> 976</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="function" onClick="logFunction('fix_utf8')" href="../_functions/fix_utf8.html" onMouseOver="funcPopup(event,'fix_utf8')">fix_utf8</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l977"><span class="linenum"> 977</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('\\', '/', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l978"><span class="linenum"> 978</span></a>  
<a name="l979"><span class="linenum"> 979</span></a>  <span class="comment">            // Explode the path and clean each element using the PARAM_FILE rules.</span>
<a name="l980"><span class="linenum"> 980</span></a>              <a class="var it6142" onMouseOver="hilite(6142)" onMouseOut="lolite()" onClick="logVariable('breadcrumb')" href="../_variables/breadcrumb.html">$breadcrumb</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>('/', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l981"><span class="linenum"> 981</span></a>              foreach (<a class="var it6142" onMouseOver="hilite(6142)" onMouseOut="lolite()" onClick="logVariable('breadcrumb')" href="../_variables/breadcrumb.html">$breadcrumb</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it6145" onMouseOver="hilite(6145)" onMouseOut="lolite()" onClick="logVariable('crumb')" href="../_variables/crumb.html">$crumb</a>) {
<a name="l982"><span class="linenum"> 982</span></a>                  if (<a class="var it6145" onMouseOver="hilite(6145)" onMouseOut="lolite()" onClick="logVariable('crumb')" href="../_variables/crumb.html">$crumb</a> === '.' &amp;&amp; <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> === 0) {
<a name="l983"><span class="linenum"> 983</span></a>  <span class="comment">                    // Special condition to allow for relative current path such as ./currentdirfile.txt.</span>
<a name="l984"><span class="linenum"> 984</span></a>                  } else {
<a name="l985"><span class="linenum"> 985</span></a>                      <a class="var it6145" onMouseOver="hilite(6145)" onMouseOut="lolite()" onClick="logVariable('crumb')" href="../_variables/crumb.html">$crumb</a> = <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it6145" onMouseOver="hilite(6145)" onMouseOut="lolite()" onClick="logVariable('crumb')" href="../_variables/crumb.html">$crumb</a>, <a class="constant" onClick="logConstant('PARAM_FILE')" href="../_constants/PARAM_FILE.html" onMouseOver="constPopup(event,'PARAM_FILE')">PARAM_FILE</a>);
<a name="l986"><span class="linenum"> 986</span></a>                  }
<a name="l987"><span class="linenum"> 987</span></a>                  <a class="var it6142" onMouseOver="hilite(6142)" onMouseOut="lolite()" onClick="logVariable('breadcrumb')" href="../_variables/breadcrumb.html">$breadcrumb</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = <a class="var it6145" onMouseOver="hilite(6145)" onMouseOut="lolite()" onClick="logVariable('crumb')" href="../_variables/crumb.html">$crumb</a>;
<a name="l988"><span class="linenum"> 988</span></a>              }
<a name="l989"><span class="linenum"> 989</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>('/', <a class="var it6142" onMouseOver="hilite(6142)" onMouseOut="lolite()" onClick="logVariable('breadcrumb')" href="../_variables/breadcrumb.html">$breadcrumb</a>);
<a name="l990"><span class="linenum"> 990</span></a>  
<a name="l991"><span class="linenum"> 991</span></a>  <span class="comment">            // Remove multiple current path (./././) and multiple slashes (///).</span>
<a name="l992"><span class="linenum"> 992</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('~//+~', '/', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l993"><span class="linenum"> 993</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('~/(\./)+~', '/', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l994"><span class="linenum"> 994</span></a>              return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l995"><span class="linenum"> 995</span></a>  
<a name="l996"><span class="linenum"> 996</span></a>          case <a class="constant" onClick="logConstant('PARAM_HOST')" href="../_constants/PARAM_HOST.html" onMouseOver="constPopup(event,'PARAM_HOST')">PARAM_HOST</a>:
<a name="l997"><span class="linenum"> 997</span></a>  <span class="comment">            // Allow FQDN or IPv4 dotted quad.</span>
<a name="l998"><span class="linenum"> 998</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/[^\.\d\w-]/', '', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> );
<a name="l999"><span class="linenum"> 999</span></a>  <span class="comment">            // Match ipv4 dotted quad.</span>
<a name="l1000"><span class="linenum">1000</span></a>              if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})/', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a>)) {
<a name="l1001"><span class="linenum">1001</span></a>  <span class="comment">                // Confirm values are ok.</span>
<a name="l1002"><span class="linenum">1002</span></a>                  if ( <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a>[0] &gt; 255
<a name="l1003"><span class="linenum">1003</span></a>                       || <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a>[1] &gt; 255
<a name="l1004"><span class="linenum">1004</span></a>                       || <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a>[3] &gt; 255
<a name="l1005"><span class="linenum">1005</span></a>                       || <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a>[4] &gt; 255 ) {
<a name="l1006"><span class="linenum">1006</span></a>  <span class="comment">                    // Hmmm, what kind of dotted quad is this?</span>
<a name="l1007"><span class="linenum">1007</span></a>                      <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = '';
<a name="l1008"><span class="linenum">1008</span></a>                  }
<a name="l1009"><span class="linenum">1009</span></a>              } else if ( <a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^[\w\d\.-]+$/', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>) // Dots, hyphens, numbers.
<a name="l1010"><span class="linenum">1010</span></a>                         &amp;&amp; !<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^[\.-]/',  <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>) // No leading dots/hyphens.
<a name="l1011"><span class="linenum">1011</span></a>                         &amp;&amp; !<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/[\.-]$/',  <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>) // No trailing dots/hyphens.
<a name="l1012"><span class="linenum">1012</span></a>                         ) {
<a name="l1013"><span class="linenum">1013</span></a>  <span class="comment">                // All is ok - $param is respected.</span>
<a name="l1014"><span class="linenum">1014</span></a>              } else {
<a name="l1015"><span class="linenum">1015</span></a>  <span class="comment">                // All is not ok...</span>
<a name="l1016"><span class="linenum">1016</span></a>                  <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>='';
<a name="l1017"><span class="linenum">1017</span></a>              }
<a name="l1018"><span class="linenum">1018</span></a>              return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l1019"><span class="linenum">1019</span></a>  
<a name="l1020"><span class="linenum">1020</span></a>          case <a class="constant" onClick="logConstant('PARAM_URL')" href="../_constants/PARAM_URL.html" onMouseOver="constPopup(event,'PARAM_URL')">PARAM_URL</a>:          // Allow safe ftp, http, mailto urls.
<a name="l1021"><span class="linenum">1021</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="function" onClick="logFunction('fix_utf8')" href="../_functions/fix_utf8.html" onMouseOver="funcPopup(event,'fix_utf8')">fix_utf8</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l1022"><span class="linenum">1022</span></a>              include_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a> . '<a class="filename" href="../lib/validateurlsyntax.php.html">/lib/validateurlsyntax.php</a>');
<a name="l1023"><span class="linenum">1023</span></a>              if (!empty(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>) &amp;&amp; <a class="function" onClick="logFunction('validateUrlSyntax')" href="../_functions/validateurlsyntax.html" onMouseOver="funcPopup(event,'validateurlsyntax')">validateUrlSyntax</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, 's?H?S?F?E?u-P-a?I?p?f?q?r?')) {
<a name="l1024"><span class="linenum">1024</span></a>  <span class="comment">                // All is ok, param is respected.</span>
<a name="l1025"><span class="linenum">1025</span></a>              } else {
<a name="l1026"><span class="linenum">1026</span></a>  <span class="comment">                // Not really ok.</span>
<a name="l1027"><span class="linenum">1027</span></a>                  <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> ='';
<a name="l1028"><span class="linenum">1028</span></a>              }
<a name="l1029"><span class="linenum">1029</span></a>              return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l1030"><span class="linenum">1030</span></a>  
<a name="l1031"><span class="linenum">1031</span></a>          case <a class="constant" onClick="logConstant('PARAM_LOCALURL')" href="../_constants/PARAM_LOCALURL.html" onMouseOver="constPopup(event,'PARAM_LOCALURL')">PARAM_LOCALURL</a>:
<a name="l1032"><span class="linenum">1032</span></a>  <span class="comment">            // Allow http absolute, root relative and relative URLs within wwwroot.</span>
<a name="l1033"><span class="linenum">1033</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, <a class="constant" onClick="logConstant('PARAM_URL')" href="../_constants/PARAM_URL.html" onMouseOver="constPopup(event,'PARAM_URL')">PARAM_URL</a>);
<a name="l1034"><span class="linenum">1034</span></a>              if (!empty(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l1035"><span class="linenum">1035</span></a>  
<a name="l1036"><span class="linenum">1036</span></a>  <span class="comment">                // Simulate the HTTPS version of the site.</span>
<a name="l1037"><span class="linenum">1037</span></a>                  <a class="var it1126" onMouseOver="hilite(1126)" onMouseOut="lolite()" onClick="logVariable('httpswwwroot')" href="../_variables/httpswwwroot.html">$httpswwwroot</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('http://', 'https://', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>);
<a name="l1038"><span class="linenum">1038</span></a>  
<a name="l1039"><span class="linenum">1039</span></a>                  if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>(':^/:', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l1040"><span class="linenum">1040</span></a>  <span class="comment">                    // Root-relative, ok!</span>
<a name="l1041"><span class="linenum">1041</span></a>                  } else if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^' . <a class="phpfunction" onClick="logFunction('preg_quote')" href="../_functions/preg_quote.html" onMouseOver="phpfuncPopup(event,'preg_quote')">preg_quote</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>, '/') . '/i', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l1042"><span class="linenum">1042</span></a>  <span class="comment">                    // Absolute, and matches our wwwroot.</span>
<a name="l1043"><span class="linenum">1043</span></a>                  } else if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('loginhttps')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/loginhttps.html">loginhttps</a>) &amp;&amp; <a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^' . <a class="phpfunction" onClick="logFunction('preg_quote')" href="../_functions/preg_quote.html" onMouseOver="phpfuncPopup(event,'preg_quote')">preg_quote</a>(<a class="var it1126" onMouseOver="hilite(1126)" onMouseOut="lolite()" onClick="logVariable('httpswwwroot')" href="../_variables/httpswwwroot.html">$httpswwwroot</a>, '/') . '/i', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l1044"><span class="linenum">1044</span></a>  <span class="comment">                    // Absolute, and matches our httpswwwroot.</span>
<a name="l1045"><span class="linenum">1045</span></a>                  } else {
<a name="l1046"><span class="linenum">1046</span></a>  <span class="comment">                    // Relative - let's make sure there are no tricks.</span>
<a name="l1047"><span class="linenum">1047</span></a>                      if (<a class="function" onClick="logFunction('validateUrlSyntax')" href="../_functions/validateurlsyntax.html" onMouseOver="funcPopup(event,'validateurlsyntax')">validateUrlSyntax</a>('/' . <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, 's-u-P-a-p-f+q?r?')) {
<a name="l1048"><span class="linenum">1048</span></a>  <span class="comment">                        // Looks ok.</span>
<a name="l1049"><span class="linenum">1049</span></a>                      } else {
<a name="l1050"><span class="linenum">1050</span></a>                          <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = '';
<a name="l1051"><span class="linenum">1051</span></a>                      }
<a name="l1052"><span class="linenum">1052</span></a>                  }
<a name="l1053"><span class="linenum">1053</span></a>              }
<a name="l1054"><span class="linenum">1054</span></a>              return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l1055"><span class="linenum">1055</span></a>  
<a name="l1056"><span class="linenum">1056</span></a>          case <a class="constant" onClick="logConstant('PARAM_PEM')" href="../_constants/PARAM_PEM.html" onMouseOver="constPopup(event,'PARAM_PEM')">PARAM_PEM</a>:
<a name="l1057"><span class="linenum">1057</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l1058"><span class="linenum">1058</span></a>  <span class="comment">            // PEM formatted strings may contain letters/numbers and the symbols:</span>
<a name="l1059"><span class="linenum">1059</span></a>  <span class="comment">            //   forward slash: /</span>
<a name="l1060"><span class="linenum">1060</span></a>  <span class="comment">            //   plus sign:     +</span>
<a name="l1061"><span class="linenum">1061</span></a>  <span class="comment">            //   equal sign:    =</span>
<a name="l1062"><span class="linenum">1062</span></a>  <span class="comment">            //   , surrounded by BEGIN and END CERTIFICATE prefix and suffixes.</span>
<a name="l1063"><span class="linenum">1063</span></a>              if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^-----BEGIN CERTIFICATE-----([\s\w\/\+=]+)-----END CERTIFICATE-----$/', <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>), <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>)) {
<a name="l1064"><span class="linenum">1064</span></a>                  <a class="function" onClick="logFunction('list')" href="../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it12899" onMouseOver="hilite(12899)" onMouseOut="lolite()" onClick="logVariable('wholething')" href="../_variables/wholething.html">$wholething</a>, <a class="var it2792" onMouseOver="hilite(2792)" onMouseOut="lolite()" onClick="logVariable('body')" href="../_variables/body.html">$body</a>) = <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>;
<a name="l1065"><span class="linenum">1065</span></a>                  unset(<a class="var it12899" onMouseOver="hilite(12899)" onMouseOut="lolite()" onClick="logVariable('wholething')" href="../_variables/wholething.html">$wholething</a>, <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>);
<a name="l1066"><span class="linenum">1066</span></a>                  <a class="var it12900" onMouseOver="hilite(12900)" onMouseOut="lolite()" onClick="logVariable('b64')" href="../_variables/b64.html">$b64</a> = <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it2792" onMouseOver="hilite(2792)" onMouseOut="lolite()" onClick="logVariable('body')" href="../_variables/body.html">$body</a>, <a class="constant" onClick="logConstant('PARAM_BASE64')" href="../_constants/PARAM_BASE64.html" onMouseOver="constPopup(event,'PARAM_BASE64')">PARAM_BASE64</a>);
<a name="l1067"><span class="linenum">1067</span></a>                  if (!empty(<a class="var it12900" onMouseOver="hilite(12900)" onMouseOut="lolite()" onClick="logVariable('b64')" href="../_variables/b64.html">$b64</a>)) {
<a name="l1068"><span class="linenum">1068</span></a>                      return &quot;-----BEGIN CERTIFICATE-----\n<a class="var it12900" onMouseOver="hilite(12900)" onMouseOut="lolite()" onClick="logVariable('b64')" href="../_variables/b64.html">$b64</a>\n-----END CERTIFICATE-----\n&quot;;
<a name="l1069"><span class="linenum">1069</span></a>                  } else {
<a name="l1070"><span class="linenum">1070</span></a>                      return '';
<a name="l1071"><span class="linenum">1071</span></a>                  }
<a name="l1072"><span class="linenum">1072</span></a>              }
<a name="l1073"><span class="linenum">1073</span></a>              return '';
<a name="l1074"><span class="linenum">1074</span></a>  
<a name="l1075"><span class="linenum">1075</span></a>          case <a class="constant" onClick="logConstant('PARAM_BASE64')" href="../_constants/PARAM_BASE64.html" onMouseOver="constPopup(event,'PARAM_BASE64')">PARAM_BASE64</a>:
<a name="l1076"><span class="linenum">1076</span></a>              if (!empty(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l1077"><span class="linenum">1077</span></a>  <span class="comment">                // PEM formatted strings may contain letters/numbers and the symbols</span>
<a name="l1078"><span class="linenum">1078</span></a>  <span class="comment">                //   forward slash: /</span>
<a name="l1079"><span class="linenum">1079</span></a>  <span class="comment">                //   plus sign:     +</span>
<a name="l1080"><span class="linenum">1080</span></a>  <span class="comment">                //   equal sign:    =.</span>
<a name="l1081"><span class="linenum">1081</span></a>                  if (0 &gt;= <a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^([\s\w\/\+=]+)$/', <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>))) {
<a name="l1082"><span class="linenum">1082</span></a>                      return '';
<a name="l1083"><span class="linenum">1083</span></a>                  }
<a name="l1084"><span class="linenum">1084</span></a>                  <a class="var it4083" onMouseOver="hilite(4083)" onMouseOut="lolite()" onClick="logVariable('lines')" href="../_variables/lines.html">$lines</a> = <a class="phpfunction" onClick="logFunction('preg_split')" href="../_functions/preg_split.html" onMouseOver="phpfuncPopup(event,'preg_split')">preg_split</a>('/[\s]+/', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, -1, PREG_SPLIT_NO_EMPTY);
<a name="l1085"><span class="linenum">1085</span></a>  <span class="comment">                // Each line of base64 encoded data must be 64 characters in length, except for the last line which may be less</span>
<a name="l1086"><span class="linenum">1086</span></a>  <span class="comment">                // than (or equal to) 64 characters long.</span>
<a name="l1087"><span class="linenum">1087</span></a>                  for (<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>=0, <a class="var it84" onMouseOver="hilite(84)" onMouseOut="lolite()" onClick="logVariable('j')" href="../_variables/j.html">$j</a>=<a class="phpfunction" onClick="logFunction('count')" href="../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it4083" onMouseOver="hilite(4083)" onMouseOut="lolite()" onClick="logVariable('lines')" href="../_variables/lines.html">$lines</a>); <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> &lt; <a class="var it84" onMouseOver="hilite(84)" onMouseOut="lolite()" onClick="logVariable('j')" href="../_variables/j.html">$j</a>; <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>++) {
<a name="l1088"><span class="linenum">1088</span></a>                      if (<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> + 1 == <a class="var it84" onMouseOver="hilite(84)" onMouseOut="lolite()" onClick="logVariable('j')" href="../_variables/j.html">$j</a>) {
<a name="l1089"><span class="linenum">1089</span></a>                          if (64 &lt; <a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it4083" onMouseOver="hilite(4083)" onMouseOut="lolite()" onClick="logVariable('lines')" href="../_variables/lines.html">$lines</a>[<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>])) {
<a name="l1090"><span class="linenum">1090</span></a>                              return '';
<a name="l1091"><span class="linenum">1091</span></a>                          }
<a name="l1092"><span class="linenum">1092</span></a>                          continue;
<a name="l1093"><span class="linenum">1093</span></a>                      }
<a name="l1094"><span class="linenum">1094</span></a>  
<a name="l1095"><span class="linenum">1095</span></a>                      if (64 != <a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it4083" onMouseOver="hilite(4083)" onMouseOut="lolite()" onClick="logVariable('lines')" href="../_variables/lines.html">$lines</a>[<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>])) {
<a name="l1096"><span class="linenum">1096</span></a>                          return '';
<a name="l1097"><span class="linenum">1097</span></a>                      }
<a name="l1098"><span class="linenum">1098</span></a>                  }
<a name="l1099"><span class="linenum">1099</span></a>                  return <a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(&quot;\n&quot;, <a class="var it4083" onMouseOver="hilite(4083)" onMouseOut="lolite()" onClick="logVariable('lines')" href="../_variables/lines.html">$lines</a>);
<a name="l1100"><span class="linenum">1100</span></a>              } else {
<a name="l1101"><span class="linenum">1101</span></a>                  return '';
<a name="l1102"><span class="linenum">1102</span></a>              }
<a name="l1103"><span class="linenum">1103</span></a>  
<a name="l1104"><span class="linenum">1104</span></a>          case <a class="constant" onClick="logConstant('PARAM_TAG')" href="../_constants/PARAM_TAG.html" onMouseOver="constPopup(event,'PARAM_TAG')">PARAM_TAG</a>:
<a name="l1105"><span class="linenum">1105</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="function" onClick="logFunction('fix_utf8')" href="../_functions/fix_utf8.html" onMouseOver="funcPopup(event,'fix_utf8')">fix_utf8</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l1106"><span class="linenum">1106</span></a>  <span class="comment">            // Please note it is not safe to use the tag name directly anywhere,</span>
<a name="l1107"><span class="linenum">1107</span></a>  <span class="comment">            // it must be processed with s(), urlencode() before embedding anywhere.</span>
<a name="l1108"><span class="linenum">1108</span></a>  <span class="comment">            // Remove some nasties.</span>
<a name="l1109"><span class="linenum">1109</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('~[[:cntrl:]]|[&lt;&gt;`]~u', '', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l1110"><span class="linenum">1110</span></a>  <span class="comment">            // Convert many whitespace chars into one.</span>
<a name="l1111"><span class="linenum">1111</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/\s+/u', ' ', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l1112"><span class="linenum">1112</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>), 0, <a class="constant" onClick="logConstant('TAG_MAX_LENGTH')" href="../_constants/TAG_MAX_LENGTH.html" onMouseOver="constPopup(event,'TAG_MAX_LENGTH')">TAG_MAX_LENGTH</a>);
<a name="l1113"><span class="linenum">1113</span></a>              return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l1114"><span class="linenum">1114</span></a>  
<a name="l1115"><span class="linenum">1115</span></a>          case <a class="constant" onClick="logConstant('PARAM_TAGLIST')" href="../_constants/PARAM_TAGLIST.html" onMouseOver="constPopup(event,'PARAM_TAGLIST')">PARAM_TAGLIST</a>:
<a name="l1116"><span class="linenum">1116</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="function" onClick="logFunction('fix_utf8')" href="../_functions/fix_utf8.html" onMouseOver="funcPopup(event,'fix_utf8')">fix_utf8</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l1117"><span class="linenum">1117</span></a>              <a class="var it2944" onMouseOver="hilite(2944)" onMouseOut="lolite()" onClick="logVariable('tags')" href="../_variables/tags.html">$tags</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(',', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l1118"><span class="linenum">1118</span></a>              <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = array();
<a name="l1119"><span class="linenum">1119</span></a>              foreach (<a class="var it2944" onMouseOver="hilite(2944)" onMouseOut="lolite()" onClick="logVariable('tags')" href="../_variables/tags.html">$tags</a> as <a class="var it255" onMouseOver="hilite(255)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../_variables/tag.html">$tag</a>) {
<a name="l1120"><span class="linenum">1120</span></a>                  <a class="var it2733" onMouseOver="hilite(2733)" onMouseOut="lolite()" onClick="logVariable('res')" href="../_variables/res.html">$res</a> = <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it255" onMouseOver="hilite(255)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../_variables/tag.html">$tag</a>, <a class="constant" onClick="logConstant('PARAM_TAG')" href="../_constants/PARAM_TAG.html" onMouseOver="constPopup(event,'PARAM_TAG')">PARAM_TAG</a>);
<a name="l1121"><span class="linenum">1121</span></a>                  if (<a class="var it2733" onMouseOver="hilite(2733)" onMouseOut="lolite()" onClick="logVariable('res')" href="../_variables/res.html">$res</a> !== '') {
<a name="l1122"><span class="linenum">1122</span></a>                      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>[] = <a class="var it2733" onMouseOver="hilite(2733)" onMouseOut="lolite()" onClick="logVariable('res')" href="../_variables/res.html">$res</a>;
<a name="l1123"><span class="linenum">1123</span></a>                  }
<a name="l1124"><span class="linenum">1124</span></a>              }
<a name="l1125"><span class="linenum">1125</span></a>              if (<a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>) {
<a name="l1126"><span class="linenum">1126</span></a>                  return <a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(',', <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>);
<a name="l1127"><span class="linenum">1127</span></a>              } else {
<a name="l1128"><span class="linenum">1128</span></a>                  return '';
<a name="l1129"><span class="linenum">1129</span></a>              }
<a name="l1130"><span class="linenum">1130</span></a>  
<a name="l1131"><span class="linenum">1131</span></a>          case <a class="constant" onClick="logConstant('PARAM_CAPABILITY')" href="../_constants/PARAM_CAPABILITY.html" onMouseOver="constPopup(event,'PARAM_CAPABILITY')">PARAM_CAPABILITY</a>:
<a name="l1132"><span class="linenum">1132</span></a>              if (<a class="function" onClick="logFunction('get_capability_info')" href="../_functions/get_capability_info.html" onMouseOver="funcPopup(event,'get_capability_info')">get_capability_info</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l1133"><span class="linenum">1133</span></a>                  return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l1134"><span class="linenum">1134</span></a>              } else {
<a name="l1135"><span class="linenum">1135</span></a>                  return '';
<a name="l1136"><span class="linenum">1136</span></a>              }
<a name="l1137"><span class="linenum">1137</span></a>  
<a name="l1138"><span class="linenum">1138</span></a>          case <a class="constant" onClick="logConstant('PARAM_PERMISSION')" href="../_constants/PARAM_PERMISSION.html" onMouseOver="constPopup(event,'PARAM_PERMISSION')">PARAM_PERMISSION</a>:
<a name="l1139"><span class="linenum">1139</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = (int)<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l1140"><span class="linenum">1140</span></a>              if (<a class="phpfunction" onClick="logFunction('in_array')" href="../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, array(<a class="constant" onClick="logConstant('CAP_INHERIT')" href="../_constants/CAP_INHERIT.html" onMouseOver="constPopup(event,'CAP_INHERIT')">CAP_INHERIT</a>, <a class="constant" onClick="logConstant('CAP_ALLOW')" href="../_constants/CAP_ALLOW.html" onMouseOver="constPopup(event,'CAP_ALLOW')">CAP_ALLOW</a>, <a class="constant" onClick="logConstant('CAP_PREVENT')" href="../_constants/CAP_PREVENT.html" onMouseOver="constPopup(event,'CAP_PREVENT')">CAP_PREVENT</a>, <a class="constant" onClick="logConstant('CAP_PROHIBIT')" href="../_constants/CAP_PROHIBIT.html" onMouseOver="constPopup(event,'CAP_PROHIBIT')">CAP_PROHIBIT</a>))) {
<a name="l1141"><span class="linenum">1141</span></a>                  return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l1142"><span class="linenum">1142</span></a>              } else {
<a name="l1143"><span class="linenum">1143</span></a>                  return <a class="constant" onClick="logConstant('CAP_INHERIT')" href="../_constants/CAP_INHERIT.html" onMouseOver="constPopup(event,'CAP_INHERIT')">CAP_INHERIT</a>;
<a name="l1144"><span class="linenum">1144</span></a>              }
<a name="l1145"><span class="linenum">1145</span></a>  
<a name="l1146"><span class="linenum">1146</span></a>          case <a class="constant" onClick="logConstant('PARAM_AUTH')" href="../_constants/PARAM_AUTH.html" onMouseOver="constPopup(event,'PARAM_AUTH')">PARAM_AUTH</a>:
<a name="l1147"><span class="linenum">1147</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, <a class="constant" onClick="logConstant('PARAM_PLUGIN')" href="../_constants/PARAM_PLUGIN.html" onMouseOver="constPopup(event,'PARAM_PLUGIN')">PARAM_PLUGIN</a>);
<a name="l1148"><span class="linenum">1148</span></a>              if (empty(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l1149"><span class="linenum">1149</span></a>                  return '';
<a name="l1150"><span class="linenum">1150</span></a>              } else if (<a class="function" onClick="logFunction('exists_auth_plugin')" href="../_functions/exists_auth_plugin.html" onMouseOver="funcPopup(event,'exists_auth_plugin')">exists_auth_plugin</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l1151"><span class="linenum">1151</span></a>                  return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l1152"><span class="linenum">1152</span></a>              } else {
<a name="l1153"><span class="linenum">1153</span></a>                  return '';
<a name="l1154"><span class="linenum">1154</span></a>              }
<a name="l1155"><span class="linenum">1155</span></a>  
<a name="l1156"><span class="linenum">1156</span></a>          case <a class="constant" onClick="logConstant('PARAM_LANG')" href="../_constants/PARAM_LANG.html" onMouseOver="constPopup(event,'PARAM_LANG')">PARAM_LANG</a>:
<a name="l1157"><span class="linenum">1157</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, <a class="constant" onClick="logConstant('PARAM_SAFEDIR')" href="../_constants/PARAM_SAFEDIR.html" onMouseOver="constPopup(event,'PARAM_SAFEDIR')">PARAM_SAFEDIR</a>);
<a name="l1158"><span class="linenum">1158</span></a>              if (<a class="function" onClick="logFunction('get_string_manager')" href="../_functions/get_string_manager.html" onMouseOver="funcPopup(event,'get_string_manager')">get_string_manager</a>()-&gt;<a class="function" onClick="logFunction('translation_exists')" href="../_functions/translation_exists.html" onMouseOver="funcPopup(event,'translation_exists')">translation_exists</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l1159"><span class="linenum">1159</span></a>                  return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l1160"><span class="linenum">1160</span></a>              } else {
<a name="l1161"><span class="linenum">1161</span></a>  <span class="comment">                // Specified language is not installed or param malformed.</span>
<a name="l1162"><span class="linenum">1162</span></a>                  return '';
<a name="l1163"><span class="linenum">1163</span></a>              }
<a name="l1164"><span class="linenum">1164</span></a>  
<a name="l1165"><span class="linenum">1165</span></a>          case <a class="constant" onClick="logConstant('PARAM_THEME')" href="../_constants/PARAM_THEME.html" onMouseOver="constPopup(event,'PARAM_THEME')">PARAM_THEME</a>:
<a name="l1166"><span class="linenum">1166</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>, <a class="constant" onClick="logConstant('PARAM_PLUGIN')" href="../_constants/PARAM_PLUGIN.html" onMouseOver="constPopup(event,'PARAM_PLUGIN')">PARAM_PLUGIN</a>);
<a name="l1167"><span class="linenum">1167</span></a>              if (empty(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l1168"><span class="linenum">1168</span></a>                  return '';
<a name="l1169"><span class="linenum">1169</span></a>              } else if (<a class="phpfunction" onClick="logFunction('file_exists')" href="../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>/theme/<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>/config.php&quot;)) {
<a name="l1170"><span class="linenum">1170</span></a>                  return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l1171"><span class="linenum">1171</span></a>              } else if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('themedir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/themedir.html">themedir</a>) and <a class="phpfunction" onClick="logFunction('file_exists')" href="../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('themedir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/themedir.html">themedir</a>/<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>/config.php&quot;)) {
<a name="l1172"><span class="linenum">1172</span></a>                  return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l1173"><span class="linenum">1173</span></a>              } else {
<a name="l1174"><span class="linenum">1174</span></a>  <span class="comment">                // Specified theme is not installed.</span>
<a name="l1175"><span class="linenum">1175</span></a>                  return '';
<a name="l1176"><span class="linenum">1176</span></a>              }
<a name="l1177"><span class="linenum">1177</span></a>  
<a name="l1178"><span class="linenum">1178</span></a>          case <a class="constant" onClick="logConstant('PARAM_USERNAME')" href="../_constants/PARAM_USERNAME.html" onMouseOver="constPopup(event,'PARAM_USERNAME')">PARAM_USERNAME</a>:
<a name="l1179"><span class="linenum">1179</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="function" onClick="logFunction('fix_utf8')" href="../_functions/fix_utf8.html" onMouseOver="funcPopup(event,'fix_utf8')">fix_utf8</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l1180"><span class="linenum">1180</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l1181"><span class="linenum">1181</span></a>  <span class="comment">            // Convert uppercase to lowercase MDL-16919.</span>
<a name="l1182"><span class="linenum">1182</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l1183"><span class="linenum">1183</span></a>              if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('extendedusernamechars')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/extendedusernamechars.html">extendedusernamechars</a>)) {
<a name="l1184"><span class="linenum">1184</span></a>                  <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(&quot; &quot; , &quot;&quot;, <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l1185"><span class="linenum">1185</span></a>  <span class="comment">                // Regular expression, eliminate all chars EXCEPT:</span>
<a name="l1186"><span class="linenum">1186</span></a>  <span class="comment">                // alphanum, dash (-), underscore (_), at sign (@) and period (.) characters.</span>
<a name="l1187"><span class="linenum">1187</span></a>                  <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/[^-\.@_a-z0-9]/', '', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l1188"><span class="linenum">1188</span></a>              }
<a name="l1189"><span class="linenum">1189</span></a>              return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l1190"><span class="linenum">1190</span></a>  
<a name="l1191"><span class="linenum">1191</span></a>          case <a class="constant" onClick="logConstant('PARAM_EMAIL')" href="../_constants/PARAM_EMAIL.html" onMouseOver="constPopup(event,'PARAM_EMAIL')">PARAM_EMAIL</a>:
<a name="l1192"><span class="linenum">1192</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="function" onClick="logFunction('fix_utf8')" href="../_functions/fix_utf8.html" onMouseOver="funcPopup(event,'fix_utf8')">fix_utf8</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l1193"><span class="linenum">1193</span></a>              if (<a class="function" onClick="logFunction('validate_email')" href="../_functions/validate_email.html" onMouseOver="funcPopup(event,'validate_email')">validate_email</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l1194"><span class="linenum">1194</span></a>                  return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l1195"><span class="linenum">1195</span></a>              } else {
<a name="l1196"><span class="linenum">1196</span></a>                  return '';
<a name="l1197"><span class="linenum">1197</span></a>              }
<a name="l1198"><span class="linenum">1198</span></a>  
<a name="l1199"><span class="linenum">1199</span></a>          case <a class="constant" onClick="logConstant('PARAM_STRINGID')" href="../_constants/PARAM_STRINGID.html" onMouseOver="constPopup(event,'PARAM_STRINGID')">PARAM_STRINGID</a>:
<a name="l1200"><span class="linenum">1200</span></a>              if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('|^[a-zA-Z][a-zA-Z0-9\.:/_-]*$|', <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l1201"><span class="linenum">1201</span></a>                  return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l1202"><span class="linenum">1202</span></a>              } else {
<a name="l1203"><span class="linenum">1203</span></a>                  return '';
<a name="l1204"><span class="linenum">1204</span></a>              }
<a name="l1205"><span class="linenum">1205</span></a>  
<a name="l1206"><span class="linenum">1206</span></a>          case <a class="constant" onClick="logConstant('PARAM_TIMEZONE')" href="../_constants/PARAM_TIMEZONE.html" onMouseOver="constPopup(event,'PARAM_TIMEZONE')">PARAM_TIMEZONE</a>:
<a name="l1207"><span class="linenum">1207</span></a>  <span class="comment">            // Can be int, float(with .5 or .0) or string seperated by '/' and can have '-_'.</span>
<a name="l1208"><span class="linenum">1208</span></a>              <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a> = <a class="function" onClick="logFunction('fix_utf8')" href="../_functions/fix_utf8.html" onMouseOver="funcPopup(event,'fix_utf8')">fix_utf8</a>(<a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>);
<a name="l1209"><span class="linenum">1209</span></a>              <a class="var it12902" onMouseOver="hilite(12902)" onMouseOut="lolite()" onClick="logVariable('timezonepattern')" href="../_variables/timezonepattern.html">$timezonepattern</a> = '/^(([+-]?(0?[0-9](\.[5|0])?|1[0-3](\.0)?|1[0-2]\.5))|(99)|[[:alnum:]]+(\/?[[:alpha:]_-])+)$/';
<a name="l1210"><span class="linenum">1210</span></a>              if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>(<a class="var it12902" onMouseOver="hilite(12902)" onMouseOut="lolite()" onClick="logVariable('timezonepattern')" href="../_variables/timezonepattern.html">$timezonepattern</a>, <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>)) {
<a name="l1211"><span class="linenum">1211</span></a>                  return <a class="var it396" onMouseOver="hilite(396)" onMouseOut="lolite()" onClick="logVariable('param')" href="../_variables/param.html">$param</a>;
<a name="l1212"><span class="linenum">1212</span></a>              } else {
<a name="l1213"><span class="linenum">1213</span></a>                  return '';
<a name="l1214"><span class="linenum">1214</span></a>              }
<a name="l1215"><span class="linenum">1215</span></a>  
<a name="l1216"><span class="linenum">1216</span></a>          default:
<a name="l1217"><span class="linenum">1217</span></a>  <span class="comment">            // Doh! throw error, switched parameters in optional_param or another serious problem.</span>
<a name="l1218"><span class="linenum">1218</span></a>              <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>(&quot;unknownparamtype&quot;, '', '', <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>);
<a name="l1219"><span class="linenum">1219</span></a>      }
<a name="l1220"><span class="linenum">1220</span></a>  }
<a name="l1221"><span class="linenum">1221</span></a>  
<a name="l1222"><span class="linenum">1222</span></a>  <span class="comment">/**</span>
<a name="l1223"><span class="linenum">1223</span></a>  <span class="comment"> * Makes sure the data is using valid utf8, invalid characters are discarded.</span>
<a name="l1224"><span class="linenum">1224</span></a>  <span class="comment"> *</span>
<a name="l1225"><span class="linenum">1225</span></a>  <span class="comment"> * Note: this function is not intended for full objects with methods and private properties.</span>
<a name="l1226"><span class="linenum">1226</span></a>  <span class="comment"> *</span>
<a name="l1227"><span class="linenum">1227</span></a>  <span class="comment"> * @param mixed $value</span>
<a name="l1228"><span class="linenum">1228</span></a>  <span class="comment"> * @return mixed with proper utf-8 encoding</span>
<a name="l1229"><span class="linenum">1229</span></a>  <span class="comment"> */</span>
<a name="l1230"><span class="linenum">1230</span></a>  function <a class="function" onClick="logFunction('fix_utf8')" href="../_functions/fix_utf8.html" onMouseOver="funcPopup(event,'fix_utf8')">fix_utf8</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) {
<a name="l1231"><span class="linenum">1231</span></a>      if (<a class="phpfunction" onClick="logFunction('is_null')" href="../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) or <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> === '') {
<a name="l1232"><span class="linenum">1232</span></a>          return <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l1233"><span class="linenum">1233</span></a>  
<a name="l1234"><span class="linenum">1234</span></a>      } else if (<a class="phpfunction" onClick="logFunction('is_string')" href="../_functions/is_string.html" onMouseOver="phpfuncPopup(event,'is_string')">is_string</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>)) {
<a name="l1235"><span class="linenum">1235</span></a>          if ((string)(int)<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> === <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) {
<a name="l1236"><span class="linenum">1236</span></a>  <span class="comment">            // Shortcut.</span>
<a name="l1237"><span class="linenum">1237</span></a>              return <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l1238"><span class="linenum">1238</span></a>          }
<a name="l1239"><span class="linenum">1239</span></a>  <span class="comment">        // No null bytes expected in our data, so let's remove it.</span>
<a name="l1240"><span class="linenum">1240</span></a>          <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(&quot;\0&quot;, '', <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>);
<a name="l1241"><span class="linenum">1241</span></a>  
<a name="l1242"><span class="linenum">1242</span></a>  <span class="comment">        // Note: this duplicates min_fix_utf8() intentionally.</span>
<a name="l1243"><span class="linenum">1243</span></a>          static <a class="var it12903" onMouseOver="hilite(12903)" onMouseOut="lolite()" onClick="logVariable('buggyiconv')" href="../_variables/buggyiconv.html">$buggyiconv</a> = null;
<a name="l1244"><span class="linenum">1244</span></a>          if (<a class="var it12903" onMouseOver="hilite(12903)" onMouseOut="lolite()" onClick="logVariable('buggyiconv')" href="../_variables/buggyiconv.html">$buggyiconv</a> === null) {
<a name="l1245"><span class="linenum">1245</span></a>              <a class="var it12903" onMouseOver="hilite(12903)" onMouseOut="lolite()" onClick="logVariable('buggyiconv')" href="../_variables/buggyiconv.html">$buggyiconv</a> = (!<a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>('iconv') or @<a class="function" onClick="logFunction('iconv')" href="../_functions/iconv.html" onMouseOver="funcPopup(event,'iconv')">iconv</a>('UTF-8', 'UTF-8//IGNORE', '100'.<a class="phpfunction" onClick="logFunction('chr')" href="../_functions/chr.html" onMouseOver="phpfuncPopup(event,'chr')">chr</a>(130).'') !== '100');
<a name="l1246"><span class="linenum">1246</span></a>          }
<a name="l1247"><span class="linenum">1247</span></a>  
<a name="l1248"><span class="linenum">1248</span></a>          if (<a class="var it12903" onMouseOver="hilite(12903)" onMouseOut="lolite()" onClick="logVariable('buggyiconv')" href="../_variables/buggyiconv.html">$buggyiconv</a>) {
<a name="l1249"><span class="linenum">1249</span></a>              if (<a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>('mb_convert_encoding')) {
<a name="l1250"><span class="linenum">1250</span></a>                  <a class="var it6170" onMouseOver="hilite(6170)" onMouseOut="lolite()" onClick="logVariable('subst')" href="../_variables/subst.html">$subst</a> = <a class="phpfunction" onClick="logFunction('mb_substitute_character')" href="../_functions/mb_substitute_character.html" onMouseOver="phpfuncPopup(event,'mb_substitute_character')">mb_substitute_character</a>();
<a name="l1251"><span class="linenum">1251</span></a>                  <a class="phpfunction" onClick="logFunction('mb_substitute_character')" href="../_functions/mb_substitute_character.html" onMouseOver="phpfuncPopup(event,'mb_substitute_character')">mb_substitute_character</a>('');
<a name="l1252"><span class="linenum">1252</span></a>                  <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = <a class="phpfunction" onClick="logFunction('mb_convert_encoding')" href="../_functions/mb_convert_encoding.html" onMouseOver="phpfuncPopup(event,'mb_convert_encoding')">mb_convert_encoding</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>, 'utf-8', 'utf-8');
<a name="l1253"><span class="linenum">1253</span></a>                  <a class="phpfunction" onClick="logFunction('mb_substitute_character')" href="../_functions/mb_substitute_character.html" onMouseOver="phpfuncPopup(event,'mb_substitute_character')">mb_substitute_character</a>(<a class="var it6170" onMouseOver="hilite(6170)" onMouseOut="lolite()" onClick="logVariable('subst')" href="../_variables/subst.html">$subst</a>);
<a name="l1254"><span class="linenum">1254</span></a>  
<a name="l1255"><span class="linenum">1255</span></a>              } else {
<a name="l1256"><span class="linenum">1256</span></a>  <span class="comment">                // Warn admins on admin/index.php page.</span>
<a name="l1257"><span class="linenum">1257</span></a>                  <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l1258"><span class="linenum">1258</span></a>              }
<a name="l1259"><span class="linenum">1259</span></a>  
<a name="l1260"><span class="linenum">1260</span></a>          } else {
<a name="l1261"><span class="linenum">1261</span></a>              <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = @<a class="function" onClick="logFunction('iconv')" href="../_functions/iconv.html" onMouseOver="funcPopup(event,'iconv')">iconv</a>('UTF-8', 'UTF-8//IGNORE', <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>);
<a name="l1262"><span class="linenum">1262</span></a>          }
<a name="l1263"><span class="linenum">1263</span></a>  
<a name="l1264"><span class="linenum">1264</span></a>          return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>;
<a name="l1265"><span class="linenum">1265</span></a>  
<a name="l1266"><span class="linenum">1266</span></a>      } else if (<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>)) {
<a name="l1267"><span class="linenum">1267</span></a>          foreach (<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> as <a class="var it50" onMouseOver="hilite(50)" onMouseOut="lolite()" onClick="logVariable('k')" href="../_variables/k.html">$k</a> =&gt; <a class="var it44" onMouseOver="hilite(44)" onMouseOut="lolite()" onClick="logVariable('v')" href="../_variables/v.html">$v</a>) {
<a name="l1268"><span class="linenum">1268</span></a>              <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>[<a class="var it50" onMouseOver="hilite(50)" onMouseOut="lolite()" onClick="logVariable('k')" href="../_variables/k.html">$k</a>] = <a class="function" onClick="logFunction('fix_utf8')" href="../_functions/fix_utf8.html" onMouseOver="funcPopup(event,'fix_utf8')">fix_utf8</a>(<a class="var it44" onMouseOver="hilite(44)" onMouseOut="lolite()" onClick="logVariable('v')" href="../_variables/v.html">$v</a>);
<a name="l1269"><span class="linenum">1269</span></a>          }
<a name="l1270"><span class="linenum">1270</span></a>          return <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l1271"><span class="linenum">1271</span></a>  
<a name="l1272"><span class="linenum">1272</span></a>      } else if (<a class="phpfunction" onClick="logFunction('is_object')" href="../_functions/is_object.html" onMouseOver="phpfuncPopup(event,'is_object')">is_object</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>)) {
<a name="l1273"><span class="linenum">1273</span></a>  <span class="comment">        // Do not modify original.</span>
<a name="l1274"><span class="linenum">1274</span></a>          <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> = <a class="function" onClick="logFunction('clone')" href="../_functions/clone.html" onMouseOver="funcPopup(event,'clone')">clone</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>);
<a name="l1275"><span class="linenum">1275</span></a>          foreach (<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> as <a class="var it50" onMouseOver="hilite(50)" onMouseOut="lolite()" onClick="logVariable('k')" href="../_variables/k.html">$k</a> =&gt; <a class="var it44" onMouseOver="hilite(44)" onMouseOut="lolite()" onClick="logVariable('v')" href="../_variables/v.html">$v</a>) {
<a name="l1276"><span class="linenum">1276</span></a>              <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>-&gt;<a class="var it50" onMouseOver="hilite(50)" onMouseOut="lolite()" onClick="logVariable('k')" href="../_variables/k.html">$k</a> = <a class="function" onClick="logFunction('fix_utf8')" href="../_functions/fix_utf8.html" onMouseOver="funcPopup(event,'fix_utf8')">fix_utf8</a>(<a class="var it44" onMouseOver="hilite(44)" onMouseOut="lolite()" onClick="logVariable('v')" href="../_variables/v.html">$v</a>);
<a name="l1277"><span class="linenum">1277</span></a>          }
<a name="l1278"><span class="linenum">1278</span></a>          return <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l1279"><span class="linenum">1279</span></a>  
<a name="l1280"><span class="linenum">1280</span></a>      } else {
<a name="l1281"><span class="linenum">1281</span></a>  <span class="comment">        // This is some other type, no utf-8 here.</span>
<a name="l1282"><span class="linenum">1282</span></a>          return <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l1283"><span class="linenum">1283</span></a>      }
<a name="l1284"><span class="linenum">1284</span></a>  }
<a name="l1285"><span class="linenum">1285</span></a>  
<a name="l1286"><span class="linenum">1286</span></a>  <span class="comment">/**</span>
<a name="l1287"><span class="linenum">1287</span></a>  <span class="comment"> * Return true if given value is integer or string with integer value</span>
<a name="l1288"><span class="linenum">1288</span></a>  <span class="comment"> *</span>
<a name="l1289"><span class="linenum">1289</span></a>  <span class="comment"> * @param mixed $value String or Int</span>
<a name="l1290"><span class="linenum">1290</span></a>  <span class="comment"> * @return bool true if number, false if not</span>
<a name="l1291"><span class="linenum">1291</span></a>  <span class="comment"> */</span>
<a name="l1292"><span class="linenum">1292</span></a>  function <a class="function" onClick="logFunction('is_number')" href="../_functions/is_number.html" onMouseOver="funcPopup(event,'is_number')">is_number</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) {
<a name="l1293"><span class="linenum">1293</span></a>      if (is_int(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>)) {
<a name="l1294"><span class="linenum">1294</span></a>          return true;
<a name="l1295"><span class="linenum">1295</span></a>      } else if (<a class="phpfunction" onClick="logFunction('is_string')" href="../_functions/is_string.html" onMouseOver="phpfuncPopup(event,'is_string')">is_string</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>)) {
<a name="l1296"><span class="linenum">1296</span></a>          return ((string)(int)<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) === <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l1297"><span class="linenum">1297</span></a>      } else {
<a name="l1298"><span class="linenum">1298</span></a>          return false;
<a name="l1299"><span class="linenum">1299</span></a>      }
<a name="l1300"><span class="linenum">1300</span></a>  }
<a name="l1301"><span class="linenum">1301</span></a>  
<a name="l1302"><span class="linenum">1302</span></a>  <span class="comment">/**</span>
<a name="l1303"><span class="linenum">1303</span></a>  <span class="comment"> * Returns host part from url.</span>
<a name="l1304"><span class="linenum">1304</span></a>  <span class="comment"> *</span>
<a name="l1305"><span class="linenum">1305</span></a>  <span class="comment"> * @param string $url full url</span>
<a name="l1306"><span class="linenum">1306</span></a>  <span class="comment"> * @return string host, null if not found</span>
<a name="l1307"><span class="linenum">1307</span></a>  <span class="comment"> */</span>
<a name="l1308"><span class="linenum">1308</span></a>  function <a class="function" onClick="logFunction('get_host_from_url')" href="../_functions/get_host_from_url.html" onMouseOver="funcPopup(event,'get_host_from_url')">get_host_from_url</a>(<a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('url')" href="../_variables/url.html">$url</a>) {
<a name="l1309"><span class="linenum">1309</span></a>      <a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('|^[a-z]+://([a-zA-Z0-9-.]+)|i', <a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('url')" href="../_variables/url.html">$url</a>, <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>);
<a name="l1310"><span class="linenum">1310</span></a>      if (<a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>) {
<a name="l1311"><span class="linenum">1311</span></a>          return <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>[1];
<a name="l1312"><span class="linenum">1312</span></a>      }
<a name="l1313"><span class="linenum">1313</span></a>      return null;
<a name="l1314"><span class="linenum">1314</span></a>  }
<a name="l1315"><span class="linenum">1315</span></a>  
<a name="l1316"><span class="linenum">1316</span></a>  <span class="comment">/**</span>
<a name="l1317"><span class="linenum">1317</span></a>  <span class="comment"> * Tests whether anything was returned by text editor</span>
<a name="l1318"><span class="linenum">1318</span></a>  <span class="comment"> *</span>
<a name="l1319"><span class="linenum">1319</span></a>  <span class="comment"> * This function is useful for testing whether something you got back from</span>
<a name="l1320"><span class="linenum">1320</span></a>  <span class="comment"> * the HTML editor actually contains anything. Sometimes the HTML editor</span>
<a name="l1321"><span class="linenum">1321</span></a>  <span class="comment"> * appear to be empty, but actually you get back a &lt;br&gt; tag or something.</span>
<a name="l1322"><span class="linenum">1322</span></a>  <span class="comment"> *</span>
<a name="l1323"><span class="linenum">1323</span></a>  <span class="comment"> * @param string $string a string containing HTML.</span>
<a name="l1324"><span class="linenum">1324</span></a>  <span class="comment"> * @return boolean does the string contain any actual content - that is text,</span>
<a name="l1325"><span class="linenum">1325</span></a>  <span class="comment"> * images, objects, etc.</span>
<a name="l1326"><span class="linenum">1326</span></a>  <span class="comment"> */</span>
<a name="l1327"><span class="linenum">1327</span></a>  function <a class="function" onClick="logFunction('html_is_blank')" href="../_functions/html_is_blank.html" onMouseOver="funcPopup(event,'html_is_blank')">html_is_blank</a>(<a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>) {
<a name="l1328"><span class="linenum">1328</span></a>      return <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="phpfunction" onClick="logFunction('strip_tags')" href="../_functions/strip_tags.html" onMouseOver="phpfuncPopup(event,'strip_tags')">strip_tags</a>(<a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>, '&lt;img&gt;&lt;object&gt;&lt;applet&gt;&lt;input&gt;&lt;select&gt;&lt;textarea&gt;&lt;hr&gt;')) == '';
<a name="l1329"><span class="linenum">1329</span></a>  }
<a name="l1330"><span class="linenum">1330</span></a>  
<a name="l1331"><span class="linenum">1331</span></a>  <span class="comment">/**</span>
<a name="l1332"><span class="linenum">1332</span></a>  <span class="comment"> * Set a key in global configuration</span>
<a name="l1333"><span class="linenum">1333</span></a>  <span class="comment"> *</span>
<a name="l1334"><span class="linenum">1334</span></a>  <span class="comment"> * Set a key/value pair in both this session's {@link $CFG} global variable</span>
<a name="l1335"><span class="linenum">1335</span></a>  <span class="comment"> * and in the 'config' database table for future sessions.</span>
<a name="l1336"><span class="linenum">1336</span></a>  <span class="comment"> *</span>
<a name="l1337"><span class="linenum">1337</span></a>  <span class="comment"> * Can also be used to update keys for plugin-scoped configs in config_plugin table.</span>
<a name="l1338"><span class="linenum">1338</span></a>  <span class="comment"> * In that case it doesn't affect $CFG.</span>
<a name="l1339"><span class="linenum">1339</span></a>  <span class="comment"> *</span>
<a name="l1340"><span class="linenum">1340</span></a>  <span class="comment"> * A NULL value will delete the entry.</span>
<a name="l1341"><span class="linenum">1341</span></a>  <span class="comment"> *</span>
<a name="l1342"><span class="linenum">1342</span></a>  <span class="comment"> * NOTE: this function is called from lib/db/upgrade.php</span>
<a name="l1343"><span class="linenum">1343</span></a>  <span class="comment"> *</span>
<a name="l1344"><span class="linenum">1344</span></a>  <span class="comment"> * @param string $name the key to set</span>
<a name="l1345"><span class="linenum">1345</span></a>  <span class="comment"> * @param string $value the value to set (without magic quotes)</span>
<a name="l1346"><span class="linenum">1346</span></a>  <span class="comment"> * @param string $plugin (optional) the plugin scope, default null</span>
<a name="l1347"><span class="linenum">1347</span></a>  <span class="comment"> * @return bool true or exception</span>
<a name="l1348"><span class="linenum">1348</span></a>  <span class="comment"> */</span>
<a name="l1349"><span class="linenum">1349</span></a>  function <a class="function" onClick="logFunction('set_config')" href="../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>, <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>=null) {
<a name="l1350"><span class="linenum">1350</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l1351"><span class="linenum">1351</span></a>  
<a name="l1352"><span class="linenum">1352</span></a>      if (empty(<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>)) {
<a name="l1353"><span class="linenum">1353</span></a>          if (!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('config_php_settings')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/config_php_settings.html">config_php_settings</a>)) {
<a name="l1354"><span class="linenum">1354</span></a>  <span class="comment">            // So it's defined for this invocation at least.</span>
<a name="l1355"><span class="linenum">1355</span></a>              if (<a class="phpfunction" onClick="logFunction('is_null')" href="../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>)) {
<a name="l1356"><span class="linenum">1356</span></a>                  unset(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>);
<a name="l1357"><span class="linenum">1357</span></a>              } else {
<a name="l1358"><span class="linenum">1358</span></a>  <span class="comment">                // Settings from db are always strings.</span>
<a name="l1359"><span class="linenum">1359</span></a>                  <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a> = (string)<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l1360"><span class="linenum">1360</span></a>              }
<a name="l1361"><span class="linenum">1361</span></a>          }
<a name="l1362"><span class="linenum">1362</span></a>  
<a name="l1363"><span class="linenum">1363</span></a>          if (<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_field')" href="../_functions/get_field.html" onMouseOver="funcPopup(event,'get_field')">get_field</a>('config', 'name', array('name' =&gt; <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>))) {
<a name="l1364"><span class="linenum">1364</span></a>              if (<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> === null) {
<a name="l1365"><span class="linenum">1365</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('config', array('name' =&gt; <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>));
<a name="l1366"><span class="linenum">1366</span></a>              } else {
<a name="l1367"><span class="linenum">1367</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('config', 'value', <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>, array('name' =&gt; <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>));
<a name="l1368"><span class="linenum">1368</span></a>              }
<a name="l1369"><span class="linenum">1369</span></a>          } else {
<a name="l1370"><span class="linenum">1370</span></a>              if (<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> !== null) {
<a name="l1371"><span class="linenum">1371</span></a>                  <a class="var it1113" onMouseOver="hilite(1113)" onMouseOut="lolite()" onClick="logVariable('config')" href="../_variables/config.html">$config</a> = new stdClass();
<a name="l1372"><span class="linenum">1372</span></a>                  <a class="var it1113" onMouseOver="hilite(1113)" onMouseOut="lolite()" onClick="logVariable('config')" href="../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('name')" class="var it39457" onMouseOver="hilite(39457)" onMouseOut="lolite()" href="../_variables/name.html">name</a>  = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>;
<a name="l1373"><span class="linenum">1373</span></a>                  <a class="var it1113" onMouseOver="hilite(1113)" onMouseOut="lolite()" onClick="logVariable('config')" href="../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('value')" class="var it39457" onMouseOver="hilite(39457)" onMouseOut="lolite()" href="../_variables/value.html">value</a> = <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l1374"><span class="linenum">1374</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('config', <a class="var it1113" onMouseOver="hilite(1113)" onMouseOut="lolite()" onClick="logVariable('config')" href="../_variables/config.html">$config</a>, false);
<a name="l1375"><span class="linenum">1375</span></a>              }
<a name="l1376"><span class="linenum">1376</span></a>          }
<a name="l1377"><span class="linenum">1377</span></a>          if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a> === 'siteidentifier') {
<a name="l1378"><span class="linenum">1378</span></a>              <a class="class" onClick="logClass('cache_helper')" href="../_classes/cache_helper.html" onMouseOver="classPopup(event,'cache_helper')">cache_helper</a>::<a class="function" onClick="logFunction('update_site_identifier')" href="../_functions/update_site_identifier.html" onMouseOver="funcPopup(event,'update_site_identifier')">update_site_identifier</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>);
<a name="l1379"><span class="linenum">1379</span></a>          }
<a name="l1380"><span class="linenum">1380</span></a>          <a class="class" onClick="logClass('cache_helper')" href="../_classes/cache_helper.html" onMouseOver="classPopup(event,'cache_helper')">cache_helper</a>::<a class="function" onClick="logFunction('invalidate_by_definition')" href="../_functions/invalidate_by_definition.html" onMouseOver="funcPopup(event,'invalidate_by_definition')">invalidate_by_definition</a>('core', 'config', array(), 'core');
<a name="l1381"><span class="linenum">1381</span></a>      } else {
<a name="l1382"><span class="linenum">1382</span></a>  <span class="comment">        // Plugin scope.</span>
<a name="l1383"><span class="linenum">1383</span></a>          if (<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_field')" href="../_functions/get_field.html" onMouseOver="funcPopup(event,'get_field')">get_field</a>('config_plugins', 'id', array('name' =&gt; <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, 'plugin' =&gt; <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>))) {
<a name="l1384"><span class="linenum">1384</span></a>              if (<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>===null) {
<a name="l1385"><span class="linenum">1385</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('config_plugins', array('name' =&gt; <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, 'plugin' =&gt; <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>));
<a name="l1386"><span class="linenum">1386</span></a>              } else {
<a name="l1387"><span class="linenum">1387</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('config_plugins', 'value', <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>, array('id' =&gt; <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>));
<a name="l1388"><span class="linenum">1388</span></a>              }
<a name="l1389"><span class="linenum">1389</span></a>          } else {
<a name="l1390"><span class="linenum">1390</span></a>              if (<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> !== null) {
<a name="l1391"><span class="linenum">1391</span></a>                  <a class="var it1113" onMouseOver="hilite(1113)" onMouseOut="lolite()" onClick="logVariable('config')" href="../_variables/config.html">$config</a> = new stdClass();
<a name="l1392"><span class="linenum">1392</span></a>                  <a class="var it1113" onMouseOver="hilite(1113)" onMouseOut="lolite()" onClick="logVariable('config')" href="../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('plugin')" class="var it39457" onMouseOver="hilite(39457)" onMouseOut="lolite()" href="../_variables/plugin.html">plugin</a> = <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>;
<a name="l1393"><span class="linenum">1393</span></a>                  <a class="var it1113" onMouseOver="hilite(1113)" onMouseOut="lolite()" onClick="logVariable('config')" href="../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('name')" class="var it39457" onMouseOver="hilite(39457)" onMouseOut="lolite()" href="../_variables/name.html">name</a>   = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>;
<a name="l1394"><span class="linenum">1394</span></a>                  <a class="var it1113" onMouseOver="hilite(1113)" onMouseOut="lolite()" onClick="logVariable('config')" href="../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('value')" class="var it39457" onMouseOver="hilite(39457)" onMouseOut="lolite()" href="../_variables/value.html">value</a>  = <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l1395"><span class="linenum">1395</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('config_plugins', <a class="var it1113" onMouseOver="hilite(1113)" onMouseOut="lolite()" onClick="logVariable('config')" href="../_variables/config.html">$config</a>, false);
<a name="l1396"><span class="linenum">1396</span></a>              }
<a name="l1397"><span class="linenum">1397</span></a>          }
<a name="l1398"><span class="linenum">1398</span></a>          <a class="class" onClick="logClass('cache_helper')" href="../_classes/cache_helper.html" onMouseOver="classPopup(event,'cache_helper')">cache_helper</a>::<a class="function" onClick="logFunction('invalidate_by_definition')" href="../_functions/invalidate_by_definition.html" onMouseOver="funcPopup(event,'invalidate_by_definition')">invalidate_by_definition</a>('core', 'config', array(), <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>);
<a name="l1399"><span class="linenum">1399</span></a>      }
<a name="l1400"><span class="linenum">1400</span></a>  
<a name="l1401"><span class="linenum">1401</span></a>      return true;
<a name="l1402"><span class="linenum">1402</span></a>  }
<a name="l1403"><span class="linenum">1403</span></a>  
<a name="l1404"><span class="linenum">1404</span></a>  <span class="comment">/**</span>
<a name="l1405"><span class="linenum">1405</span></a>  <span class="comment"> * Get configuration values from the global config table</span>
<a name="l1406"><span class="linenum">1406</span></a>  <span class="comment"> * or the config_plugins table.</span>
<a name="l1407"><span class="linenum">1407</span></a>  <span class="comment"> *</span>
<a name="l1408"><span class="linenum">1408</span></a>  <span class="comment"> * If called with one parameter, it will load all the config</span>
<a name="l1409"><span class="linenum">1409</span></a>  <span class="comment"> * variables for one plugin, and return them as an object.</span>
<a name="l1410"><span class="linenum">1410</span></a>  <span class="comment"> *</span>
<a name="l1411"><span class="linenum">1411</span></a>  <span class="comment"> * If called with 2 parameters it will return a string single</span>
<a name="l1412"><span class="linenum">1412</span></a>  <span class="comment"> * value or false if the value is not found.</span>
<a name="l1413"><span class="linenum">1413</span></a>  <span class="comment"> *</span>
<a name="l1414"><span class="linenum">1414</span></a>  <span class="comment"> * NOTE: this function is called from lib/db/upgrade.php</span>
<a name="l1415"><span class="linenum">1415</span></a>  <span class="comment"> *</span>
<a name="l1416"><span class="linenum">1416</span></a>  <span class="comment"> * @static string|false $siteidentifier The site identifier is not cached. We use this static cache so</span>
<a name="l1417"><span class="linenum">1417</span></a>  <span class="comment"> *     that we need only fetch it once per request.</span>
<a name="l1418"><span class="linenum">1418</span></a>  <span class="comment"> * @param string $plugin full component name</span>
<a name="l1419"><span class="linenum">1419</span></a>  <span class="comment"> * @param string $name default null</span>
<a name="l1420"><span class="linenum">1420</span></a>  <span class="comment"> * @return mixed hash-like object or single value, return false no config found</span>
<a name="l1421"><span class="linenum">1421</span></a>  <span class="comment"> * @throws dml_exception</span>
<a name="l1422"><span class="linenum">1422</span></a>  <span class="comment"> */</span>
<a name="l1423"><span class="linenum">1423</span></a>  function <a class="function" onClick="logFunction('get_config')" href="../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>(<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a> = null) {
<a name="l1424"><span class="linenum">1424</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l1425"><span class="linenum">1425</span></a>  
<a name="l1426"><span class="linenum">1426</span></a>      static <a class="var it12904" onMouseOver="hilite(12904)" onMouseOut="lolite()" onClick="logVariable('siteidentifier')" href="../_variables/siteidentifier.html">$siteidentifier</a> = null;
<a name="l1427"><span class="linenum">1427</span></a>  
<a name="l1428"><span class="linenum">1428</span></a>      if (<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a> === 'moodle' || <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a> === 'core' || empty(<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>)) {
<a name="l1429"><span class="linenum">1429</span></a>          <a class="var it12905" onMouseOver="hilite(12905)" onMouseOut="lolite()" onClick="logVariable('forced')" href="../_variables/forced.html">$forced</a> =&amp; <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('config_php_settings')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/config_php_settings.html">config_php_settings</a>;
<a name="l1430"><span class="linenum">1430</span></a>          <a class="var it12906" onMouseOver="hilite(12906)" onMouseOut="lolite()" onClick="logVariable('iscore')" href="../_variables/iscore.html">$iscore</a> = true;
<a name="l1431"><span class="linenum">1431</span></a>          <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a> = 'core';
<a name="l1432"><span class="linenum">1432</span></a>      } else {
<a name="l1433"><span class="linenum">1433</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('forced_plugin_settings')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/forced_plugin_settings.html">forced_plugin_settings</a>)) {
<a name="l1434"><span class="linenum">1434</span></a>              <a class="var it12905" onMouseOver="hilite(12905)" onMouseOut="lolite()" onClick="logVariable('forced')" href="../_variables/forced.html">$forced</a> =&amp; <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('forced_plugin_settings')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/forced_plugin_settings.html">forced_plugin_settings</a>[<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>];
<a name="l1435"><span class="linenum">1435</span></a>          } else {
<a name="l1436"><span class="linenum">1436</span></a>              <a class="var it12905" onMouseOver="hilite(12905)" onMouseOut="lolite()" onClick="logVariable('forced')" href="../_variables/forced.html">$forced</a> = array();
<a name="l1437"><span class="linenum">1437</span></a>          }
<a name="l1438"><span class="linenum">1438</span></a>          <a class="var it12906" onMouseOver="hilite(12906)" onMouseOut="lolite()" onClick="logVariable('iscore')" href="../_variables/iscore.html">$iscore</a> = false;
<a name="l1439"><span class="linenum">1439</span></a>      }
<a name="l1440"><span class="linenum">1440</span></a>  
<a name="l1441"><span class="linenum">1441</span></a>      if (<a class="var it12904" onMouseOver="hilite(12904)" onMouseOut="lolite()" onClick="logVariable('siteidentifier')" href="../_variables/siteidentifier.html">$siteidentifier</a> === null) {
<a name="l1442"><span class="linenum">1442</span></a>          try {
<a name="l1443"><span class="linenum">1443</span></a>  <span class="comment">            // This may fail during installation.</span>
<a name="l1444"><span class="linenum">1444</span></a>  <span class="comment">            // If you have a look at {@link initialise_cfg()} you will see that this is how we detect the need to</span>
<a name="l1445"><span class="linenum">1445</span></a>  <span class="comment">            // install the database.</span>
<a name="l1446"><span class="linenum">1446</span></a>              <a class="var it12904" onMouseOver="hilite(12904)" onMouseOut="lolite()" onClick="logVariable('siteidentifier')" href="../_variables/siteidentifier.html">$siteidentifier</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_field')" href="../_functions/get_field.html" onMouseOver="funcPopup(event,'get_field')">get_field</a>('config', 'value', array('name' =&gt; 'siteidentifier'));
<a name="l1447"><span class="linenum">1447</span></a>          } catch (dml_exception <a class="var it2200" onMouseOver="hilite(2200)" onMouseOut="lolite()" onClick="logVariable('ex')" href="../_variables/ex.html">$ex</a>) {
<a name="l1448"><span class="linenum">1448</span></a>  <span class="comment">            // Set siteidentifier to false. We don't want to trip this continually.</span>
<a name="l1449"><span class="linenum">1449</span></a>              <a class="var it12904" onMouseOver="hilite(12904)" onMouseOut="lolite()" onClick="logVariable('siteidentifier')" href="../_variables/siteidentifier.html">$siteidentifier</a> = false;
<a name="l1450"><span class="linenum">1450</span></a>              throw <a class="var it2200" onMouseOver="hilite(2200)" onMouseOut="lolite()" onClick="logVariable('ex')" href="../_variables/ex.html">$ex</a>;
<a name="l1451"><span class="linenum">1451</span></a>          }
<a name="l1452"><span class="linenum">1452</span></a>      }
<a name="l1453"><span class="linenum">1453</span></a>  
<a name="l1454"><span class="linenum">1454</span></a>      if (!empty(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>)) {
<a name="l1455"><span class="linenum">1455</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, <a class="var it12905" onMouseOver="hilite(12905)" onMouseOut="lolite()" onClick="logVariable('forced')" href="../_variables/forced.html">$forced</a>)) {
<a name="l1456"><span class="linenum">1456</span></a>              return (string)<a class="var it12905" onMouseOver="hilite(12905)" onMouseOut="lolite()" onClick="logVariable('forced')" href="../_variables/forced.html">$forced</a>[<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>];
<a name="l1457"><span class="linenum">1457</span></a>          } else if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a> === 'siteidentifier' &amp;&amp; <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a> == 'core') {
<a name="l1458"><span class="linenum">1458</span></a>              return <a class="var it12904" onMouseOver="hilite(12904)" onMouseOut="lolite()" onClick="logVariable('siteidentifier')" href="../_variables/siteidentifier.html">$siteidentifier</a>;
<a name="l1459"><span class="linenum">1459</span></a>          }
<a name="l1460"><span class="linenum">1460</span></a>      }
<a name="l1461"><span class="linenum">1461</span></a>  
<a name="l1462"><span class="linenum">1462</span></a>      <a class="var it1081" onMouseOver="hilite(1081)" onMouseOut="lolite()" onClick="logVariable('cache')" href="../_variables/cache.html">$cache</a> = <a class="class" onClick="logClass('cache')" href="../_classes/cache.html" onMouseOver="classPopup(event,'cache')">cache</a>::<a class="function" onClick="logFunction('make')" href="../_functions/make.html" onMouseOver="funcPopup(event,'make')">make</a>('core', 'config');
<a name="l1463"><span class="linenum">1463</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = <a class="var it1081" onMouseOver="hilite(1081)" onMouseOut="lolite()" onClick="logVariable('cache')" href="../_variables/cache.html">$cache</a>-&gt;<a class="function" onClick="logFunction('get')" href="../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>(<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>);
<a name="l1464"><span class="linenum">1464</span></a>      if (<a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> === false) {
<a name="l1465"><span class="linenum">1465</span></a>  <span class="comment">        // The user is after a recordset.</span>
<a name="l1466"><span class="linenum">1466</span></a>          if (!<a class="var it12906" onMouseOver="hilite(12906)" onMouseOut="lolite()" onClick="logVariable('iscore')" href="../_variables/iscore.html">$iscore</a>) {
<a name="l1467"><span class="linenum">1467</span></a>              <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_menu')" href="../_functions/get_records_menu.html" onMouseOver="funcPopup(event,'get_records_menu')">get_records_menu</a>('config_plugins', array('plugin' =&gt; <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>), '', 'name,value');
<a name="l1468"><span class="linenum">1468</span></a>          } else {
<a name="l1469"><span class="linenum">1469</span></a>  <span class="comment">            // This part is not really used any more, but anyway...</span>
<a name="l1470"><span class="linenum">1470</span></a>              <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_menu')" href="../_functions/get_records_menu.html" onMouseOver="funcPopup(event,'get_records_menu')">get_records_menu</a>('config', array(), '', 'name,value');;
<a name="l1471"><span class="linenum">1471</span></a>          }
<a name="l1472"><span class="linenum">1472</span></a>          <a class="var it1081" onMouseOver="hilite(1081)" onMouseOut="lolite()" onClick="logVariable('cache')" href="../_variables/cache.html">$cache</a>-&gt;<a class="function" onClick="logFunction('set')" href="../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>(<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>, <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>);
<a name="l1473"><span class="linenum">1473</span></a>      }
<a name="l1474"><span class="linenum">1474</span></a>  
<a name="l1475"><span class="linenum">1475</span></a>      if (!empty(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>)) {
<a name="l1476"><span class="linenum">1476</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>)) {
<a name="l1477"><span class="linenum">1477</span></a>              return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>[<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>];
<a name="l1478"><span class="linenum">1478</span></a>          }
<a name="l1479"><span class="linenum">1479</span></a>          return false;
<a name="l1480"><span class="linenum">1480</span></a>      }
<a name="l1481"><span class="linenum">1481</span></a>  
<a name="l1482"><span class="linenum">1482</span></a>      if (<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a> === 'core') {
<a name="l1483"><span class="linenum">1483</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>['siteidentifier'] = <a class="var it12904" onMouseOver="hilite(12904)" onMouseOut="lolite()" onClick="logVariable('siteidentifier')" href="../_variables/siteidentifier.html">$siteidentifier</a>;
<a name="l1484"><span class="linenum">1484</span></a>      }
<a name="l1485"><span class="linenum">1485</span></a>  
<a name="l1486"><span class="linenum">1486</span></a>      foreach (<a class="var it12905" onMouseOver="hilite(12905)" onMouseOut="lolite()" onClick="logVariable('forced')" href="../_variables/forced.html">$forced</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) {
<a name="l1487"><span class="linenum">1487</span></a>          if (<a class="phpfunction" onClick="logFunction('is_null')" href="../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) or <a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) or <a class="phpfunction" onClick="logFunction('is_object')" href="../_functions/is_object.html" onMouseOver="phpfuncPopup(event,'is_object')">is_object</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>)) {
<a name="l1488"><span class="linenum">1488</span></a>  <span class="comment">            // We do not want any extra mess here, just real settings that could be saved in db.</span>
<a name="l1489"><span class="linenum">1489</span></a>              unset(<a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>]);
<a name="l1490"><span class="linenum">1490</span></a>          } else {
<a name="l1491"><span class="linenum">1491</span></a>  <span class="comment">            // Convert to string as if it went through the DB.</span>
<a name="l1492"><span class="linenum">1492</span></a>              <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = (string)<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l1493"><span class="linenum">1493</span></a>          }
<a name="l1494"><span class="linenum">1494</span></a>      }
<a name="l1495"><span class="linenum">1495</span></a>  
<a name="l1496"><span class="linenum">1496</span></a>      return (object)<a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>;
<a name="l1497"><span class="linenum">1497</span></a>  }
<a name="l1498"><span class="linenum">1498</span></a>  
<a name="l1499"><span class="linenum">1499</span></a>  <span class="comment">/**</span>
<a name="l1500"><span class="linenum">1500</span></a>  <span class="comment"> * Removes a key from global configuration.</span>
<a name="l1501"><span class="linenum">1501</span></a>  <span class="comment"> *</span>
<a name="l1502"><span class="linenum">1502</span></a>  <span class="comment"> * NOTE: this function is called from lib/db/upgrade.php</span>
<a name="l1503"><span class="linenum">1503</span></a>  <span class="comment"> *</span>
<a name="l1504"><span class="linenum">1504</span></a>  <span class="comment"> * @param string $name the key to set</span>
<a name="l1505"><span class="linenum">1505</span></a>  <span class="comment"> * @param string $plugin (optional) the plugin scope</span>
<a name="l1506"><span class="linenum">1506</span></a>  <span class="comment"> * @return boolean whether the operation succeeded.</span>
<a name="l1507"><span class="linenum">1507</span></a>  <span class="comment"> */</span>
<a name="l1508"><span class="linenum">1508</span></a>  function <a class="function" onClick="logFunction('unset_config')" href="../_functions/unset_config.html" onMouseOver="funcPopup(event,'unset_config')">unset_config</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>=null) {
<a name="l1509"><span class="linenum">1509</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l1510"><span class="linenum">1510</span></a>  
<a name="l1511"><span class="linenum">1511</span></a>      if (empty(<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>)) {
<a name="l1512"><span class="linenum">1512</span></a>          unset(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>);
<a name="l1513"><span class="linenum">1513</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('config', array('name' =&gt; <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>));
<a name="l1514"><span class="linenum">1514</span></a>          <a class="class" onClick="logClass('cache_helper')" href="../_classes/cache_helper.html" onMouseOver="classPopup(event,'cache_helper')">cache_helper</a>::<a class="function" onClick="logFunction('invalidate_by_definition')" href="../_functions/invalidate_by_definition.html" onMouseOver="funcPopup(event,'invalidate_by_definition')">invalidate_by_definition</a>('core', 'config', array(), 'core');
<a name="l1515"><span class="linenum">1515</span></a>      } else {
<a name="l1516"><span class="linenum">1516</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('config_plugins', array('name' =&gt; <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, 'plugin' =&gt; <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>));
<a name="l1517"><span class="linenum">1517</span></a>          <a class="class" onClick="logClass('cache_helper')" href="../_classes/cache_helper.html" onMouseOver="classPopup(event,'cache_helper')">cache_helper</a>::<a class="function" onClick="logFunction('invalidate_by_definition')" href="../_functions/invalidate_by_definition.html" onMouseOver="funcPopup(event,'invalidate_by_definition')">invalidate_by_definition</a>('core', 'config', array(), <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>);
<a name="l1518"><span class="linenum">1518</span></a>      }
<a name="l1519"><span class="linenum">1519</span></a>  
<a name="l1520"><span class="linenum">1520</span></a>      return true;
<a name="l1521"><span class="linenum">1521</span></a>  }
<a name="l1522"><span class="linenum">1522</span></a>  
<a name="l1523"><span class="linenum">1523</span></a>  <span class="comment">/**</span>
<a name="l1524"><span class="linenum">1524</span></a>  <span class="comment"> * Remove all the config variables for a given plugin.</span>
<a name="l1525"><span class="linenum">1525</span></a>  <span class="comment"> *</span>
<a name="l1526"><span class="linenum">1526</span></a>  <span class="comment"> * NOTE: this function is called from lib/db/upgrade.php</span>
<a name="l1527"><span class="linenum">1527</span></a>  <span class="comment"> *</span>
<a name="l1528"><span class="linenum">1528</span></a>  <span class="comment"> * @param string $plugin a plugin, for example 'quiz' or 'qtype_multichoice';</span>
<a name="l1529"><span class="linenum">1529</span></a>  <span class="comment"> * @return boolean whether the operation succeeded.</span>
<a name="l1530"><span class="linenum">1530</span></a>  <span class="comment"> */</span>
<a name="l1531"><span class="linenum">1531</span></a>  function <a class="function" onClick="logFunction('unset_all_config_for_plugin')" href="../_functions/unset_all_config_for_plugin.html" onMouseOver="funcPopup(event,'unset_all_config_for_plugin')">unset_all_config_for_plugin</a>(<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>) {
<a name="l1532"><span class="linenum">1532</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l1533"><span class="linenum">1533</span></a>  <span class="comment">    // Delete from the obvious config_plugins first.</span>
<a name="l1534"><span class="linenum">1534</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('config_plugins', array('plugin' =&gt; <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>));
<a name="l1535"><span class="linenum">1535</span></a>  <span class="comment">    // Next delete any suspect settings from config.</span>
<a name="l1536"><span class="linenum">1536</span></a>      <a class="var it4340" onMouseOver="hilite(4340)" onMouseOut="lolite()" onClick="logVariable('like')" href="../_variables/like.html">$like</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_like')" href="../_functions/sql_like.html" onMouseOver="funcPopup(event,'sql_like')">sql_like</a>('name', '?', true, true, false, '|');
<a name="l1537"><span class="linenum">1537</span></a>      <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array(<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_like_escape')" href="../_functions/sql_like_escape.html" onMouseOver="funcPopup(event,'sql_like_escape')">sql_like_escape</a>(<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>.'_', '|') . '%');
<a name="l1538"><span class="linenum">1538</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records_select')" href="../_functions/delete_records_select.html" onMouseOver="funcPopup(event,'delete_records_select')">delete_records_select</a>('config', <a class="var it4340" onMouseOver="hilite(4340)" onMouseOut="lolite()" onClick="logVariable('like')" href="../_variables/like.html">$like</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>);
<a name="l1539"><span class="linenum">1539</span></a>  <span class="comment">    // Finally clear both the plugin cache and the core cache (suspect settings now removed from core).</span>
<a name="l1540"><span class="linenum">1540</span></a>      <a class="class" onClick="logClass('cache_helper')" href="../_classes/cache_helper.html" onMouseOver="classPopup(event,'cache_helper')">cache_helper</a>::<a class="function" onClick="logFunction('invalidate_by_definition')" href="../_functions/invalidate_by_definition.html" onMouseOver="funcPopup(event,'invalidate_by_definition')">invalidate_by_definition</a>('core', 'config', array(), array('core', <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>));
<a name="l1541"><span class="linenum">1541</span></a>  
<a name="l1542"><span class="linenum">1542</span></a>      return true;
<a name="l1543"><span class="linenum">1543</span></a>  }
<a name="l1544"><span class="linenum">1544</span></a>  
<a name="l1545"><span class="linenum">1545</span></a>  <span class="comment">/**</span>
<a name="l1546"><span class="linenum">1546</span></a>  <span class="comment"> * Use this function to get a list of users from a config setting of type admin_setting_users_with_capability.</span>
<a name="l1547"><span class="linenum">1547</span></a>  <span class="comment"> *</span>
<a name="l1548"><span class="linenum">1548</span></a>  <span class="comment"> * All users are verified if they still have the necessary capability.</span>
<a name="l1549"><span class="linenum">1549</span></a>  <span class="comment"> *</span>
<a name="l1550"><span class="linenum">1550</span></a>  <span class="comment"> * @param string $value the value of the config setting.</span>
<a name="l1551"><span class="linenum">1551</span></a>  <span class="comment"> * @param string $capability the capability - must match the one passed to the admin_setting_users_with_capability constructor.</span>
<a name="l1552"><span class="linenum">1552</span></a>  <span class="comment"> * @param bool $includeadmins include administrators.</span>
<a name="l1553"><span class="linenum">1553</span></a>  <span class="comment"> * @return array of user objects.</span>
<a name="l1554"><span class="linenum">1554</span></a>  <span class="comment"> */</span>
<a name="l1555"><span class="linenum">1555</span></a>  function <a class="function" onClick="logFunction('get_users_from_config')" href="../_functions/get_users_from_config.html" onMouseOver="funcPopup(event,'get_users_from_config')">get_users_from_config</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>, <a class="var it2621" onMouseOver="hilite(2621)" onMouseOut="lolite()" onClick="logVariable('capability')" href="../_variables/capability.html">$capability</a>, <a class="var it12908" onMouseOver="hilite(12908)" onMouseOut="lolite()" onClick="logVariable('includeadmins')" href="../_variables/includeadmins.html">$includeadmins</a> = true) {
<a name="l1556"><span class="linenum">1556</span></a>      if (empty(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) or <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> === '$@NONE@$') {
<a name="l1557"><span class="linenum">1557</span></a>          return array();
<a name="l1558"><span class="linenum">1558</span></a>      }
<a name="l1559"><span class="linenum">1559</span></a>  
<a name="l1560"><span class="linenum">1560</span></a>  <span class="comment">    // We have to make sure that users still have the necessary capability,</span>
<a name="l1561"><span class="linenum">1561</span></a>  <span class="comment">    // it should be faster to fetch them all first and then test if they are present</span>
<a name="l1562"><span class="linenum">1562</span></a>  <span class="comment">    // instead of validating them one-by-one.</span>
<a name="l1563"><span class="linenum">1563</span></a>      <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../_variables/users.html">$users</a> = <a class="function" onClick="logFunction('get_users_by_capability')" href="../_functions/get_users_by_capability.html" onMouseOver="funcPopup(event,'get_users_by_capability')">get_users_by_capability</a>(<a class="class" onClick="logClass('context_system')" href="../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(), <a class="var it2621" onMouseOver="hilite(2621)" onMouseOut="lolite()" onClick="logVariable('capability')" href="../_variables/capability.html">$capability</a>);
<a name="l1564"><span class="linenum">1564</span></a>      if (<a class="var it12908" onMouseOver="hilite(12908)" onMouseOut="lolite()" onClick="logVariable('includeadmins')" href="../_variables/includeadmins.html">$includeadmins</a>) {
<a name="l1565"><span class="linenum">1565</span></a>          <a class="var it1847" onMouseOver="hilite(1847)" onMouseOut="lolite()" onClick="logVariable('admins')" href="../_variables/admins.html">$admins</a> = <a class="function" onClick="logFunction('get_admins')" href="../_functions/get_admins.html" onMouseOver="funcPopup(event,'get_admins')">get_admins</a>();
<a name="l1566"><span class="linenum">1566</span></a>          foreach (<a class="var it1847" onMouseOver="hilite(1847)" onMouseOut="lolite()" onClick="logVariable('admins')" href="../_variables/admins.html">$admins</a> as <a class="var it138" onMouseOver="hilite(138)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../_variables/admin.html">$admin</a>) {
<a name="l1567"><span class="linenum">1567</span></a>              <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../_variables/users.html">$users</a>[<a class="var it138" onMouseOver="hilite(138)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../_variables/admin.html">$admin</a>-&gt;<a onClick="logVariable('id')" class="var it39939" onMouseOver="hilite(39939)" onMouseOut="lolite()" href="../_variables/id.html">id</a>] = <a class="var it138" onMouseOver="hilite(138)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../_variables/admin.html">$admin</a>;
<a name="l1568"><span class="linenum">1568</span></a>          }
<a name="l1569"><span class="linenum">1569</span></a>      }
<a name="l1570"><span class="linenum">1570</span></a>  
<a name="l1571"><span class="linenum">1571</span></a>      if (<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> === '$@ALL@$') {
<a name="l1572"><span class="linenum">1572</span></a>          return <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../_variables/users.html">$users</a>;
<a name="l1573"><span class="linenum">1573</span></a>      }
<a name="l1574"><span class="linenum">1574</span></a>  
<a name="l1575"><span class="linenum">1575</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = array(); <span class="comment">// Result in correct order.</span>
<a name="l1576"><span class="linenum">1576</span></a>      <a class="var it2730" onMouseOver="hilite(2730)" onMouseOut="lolite()" onClick="logVariable('allowed')" href="../_variables/allowed.html">$allowed</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(',', <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>);
<a name="l1577"><span class="linenum">1577</span></a>      foreach (<a class="var it2730" onMouseOver="hilite(2730)" onMouseOut="lolite()" onClick="logVariable('allowed')" href="../_variables/allowed.html">$allowed</a> as <a class="var it9652" onMouseOver="hilite(9652)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>) {
<a name="l1578"><span class="linenum">1578</span></a>          if (isset(<a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../_variables/users.html">$users</a>[<a class="var it9652" onMouseOver="hilite(9652)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>])) {
<a name="l1579"><span class="linenum">1579</span></a>              <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../_variables/users.html">$users</a>[<a class="var it9652" onMouseOver="hilite(9652)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>];
<a name="l1580"><span class="linenum">1580</span></a>              <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>[<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>] = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>;
<a name="l1581"><span class="linenum">1581</span></a>          }
<a name="l1582"><span class="linenum">1582</span></a>      }
<a name="l1583"><span class="linenum">1583</span></a>  
<a name="l1584"><span class="linenum">1584</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>;
<a name="l1585"><span class="linenum">1585</span></a>  }
<a name="l1586"><span class="linenum">1586</span></a>  
<a name="l1587"><span class="linenum">1587</span></a>  
<a name="l1588"><span class="linenum">1588</span></a>  <span class="comment">/**</span>
<a name="l1589"><span class="linenum">1589</span></a>  <span class="comment"> * Invalidates browser caches and cached data in temp.</span>
<a name="l1590"><span class="linenum">1590</span></a>  <span class="comment"> *</span>
<a name="l1591"><span class="linenum">1591</span></a>  <span class="comment"> * IMPORTANT - If you are adding anything here to do with the cache directory you should also have a look at</span>
<a name="l1592"><span class="linenum">1592</span></a>  <span class="comment"> * {@link phpunit_util::reset_dataroot()}</span>
<a name="l1593"><span class="linenum">1593</span></a>  <span class="comment"> *</span>
<a name="l1594"><span class="linenum">1594</span></a>  <span class="comment"> * @return void</span>
<a name="l1595"><span class="linenum">1595</span></a>  <span class="comment"> */</span>
<a name="l1596"><span class="linenum">1596</span></a>  function <a class="function" onClick="logFunction('purge_all_caches')" href="../_functions/purge_all_caches.html" onMouseOver="funcPopup(event,'purge_all_caches')">purge_all_caches</a>() {
<a name="l1597"><span class="linenum">1597</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l1598"><span class="linenum">1598</span></a>  
<a name="l1599"><span class="linenum">1599</span></a>      <a class="function" onClick="logFunction('reset_text_filters_cache')" href="../_functions/reset_text_filters_cache.html" onMouseOver="funcPopup(event,'reset_text_filters_cache')">reset_text_filters_cache</a>();
<a name="l1600"><span class="linenum">1600</span></a>      <a class="function" onClick="logFunction('js_reset_all_caches')" href="../_functions/js_reset_all_caches.html" onMouseOver="funcPopup(event,'js_reset_all_caches')">js_reset_all_caches</a>();
<a name="l1601"><span class="linenum">1601</span></a>      <a class="function" onClick="logFunction('theme_reset_all_caches')" href="../_functions/theme_reset_all_caches.html" onMouseOver="funcPopup(event,'theme_reset_all_caches')">theme_reset_all_caches</a>();
<a name="l1602"><span class="linenum">1602</span></a>      <a class="function" onClick="logFunction('get_string_manager')" href="../_functions/get_string_manager.html" onMouseOver="funcPopup(event,'get_string_manager')">get_string_manager</a>()-&gt;<a class="function" onClick="logFunction('reset_caches')" href="../_functions/reset_caches.html" onMouseOver="funcPopup(event,'reset_caches')">reset_caches</a>();
<a name="l1603"><span class="linenum">1603</span></a>      <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('reset_caches')" href="../_functions/reset_caches.html" onMouseOver="funcPopup(event,'reset_caches')">reset_caches</a>();
<a name="l1604"><span class="linenum">1604</span></a>      if (<a class="phpfunction" onClick="logFunction('class_exists')" href="../_functions/class_exists.html" onMouseOver="phpfuncPopup(event,'class_exists')">class_exists</a>('core_plugin_manager')) {
<a name="l1605"><span class="linenum">1605</span></a>          <a class="class" onClick="logClass('core_plugin_manager')" href="../_classes/core_plugin_manager.html" onMouseOver="classPopup(event,'core_plugin_manager')">core_plugin_manager</a>::<a class="function" onClick="logFunction('reset_caches')" href="../_functions/reset_caches.html" onMouseOver="funcPopup(event,'reset_caches')">reset_caches</a>();
<a name="l1606"><span class="linenum">1606</span></a>      }
<a name="l1607"><span class="linenum">1607</span></a>  
<a name="l1608"><span class="linenum">1608</span></a>  <span class="comment">    // Bump up cacherev field for all courses.</span>
<a name="l1609"><span class="linenum">1609</span></a>      try {
<a name="l1610"><span class="linenum">1610</span></a>          <a class="function" onClick="logFunction('increment_revision_number')" href="../_functions/increment_revision_number.html" onMouseOver="funcPopup(event,'increment_revision_number')">increment_revision_number</a>('course', 'cacherev', '');
<a name="l1611"><span class="linenum">1611</span></a>      } catch (moodle_exception <a class="var it193" onMouseOver="hilite(193)" onMouseOut="lolite()" onClick="logVariable('e')" href="../_variables/e.html">$e</a>) {
<a name="l1612"><span class="linenum">1612</span></a>  <span class="comment">        // Ignore exception since this function is also called before upgrade script when field course.cacherev does not exist yet.</span>
<a name="l1613"><span class="linenum">1613</span></a>      }
<a name="l1614"><span class="linenum">1614</span></a>  
<a name="l1615"><span class="linenum">1615</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('reset_caches')" href="../_functions/reset_caches.html" onMouseOver="funcPopup(event,'reset_caches')">reset_caches</a>();
<a name="l1616"><span class="linenum">1616</span></a>      <a class="class" onClick="logClass('cache_helper')" href="../_classes/cache_helper.html" onMouseOver="classPopup(event,'cache_helper')">cache_helper</a>::<a class="function" onClick="logFunction('purge_all')" href="../_functions/purge_all.html" onMouseOver="funcPopup(event,'purge_all')">purge_all</a>();
<a name="l1617"><span class="linenum">1617</span></a>  
<a name="l1618"><span class="linenum">1618</span></a>  <span class="comment">    // Purge all other caches: rss, simplepie, etc.</span>
<a name="l1619"><span class="linenum">1619</span></a>      <a class="function" onClick="logFunction('remove_dir')" href="../_functions/remove_dir.html" onMouseOver="funcPopup(event,'remove_dir')">remove_dir</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('cachedir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/cachedir.html">cachedir</a>.'', true);
<a name="l1620"><span class="linenum">1620</span></a>  
<a name="l1621"><span class="linenum">1621</span></a>  <span class="comment">    // Make sure cache dir is writable, throws exception if not.</span>
<a name="l1622"><span class="linenum">1622</span></a>      <a class="function" onClick="logFunction('make_cache_directory')" href="../_functions/make_cache_directory.html" onMouseOver="funcPopup(event,'make_cache_directory')">make_cache_directory</a>('');
<a name="l1623"><span class="linenum">1623</span></a>  
<a name="l1624"><span class="linenum">1624</span></a>  <span class="comment">    // This is the only place where we purge local caches, we are only adding files there.</span>
<a name="l1625"><span class="linenum">1625</span></a>  <span class="comment">    // The $CFG-&gt;localcachedirpurged flag forces local directories to be purged on cluster nodes.</span>
<a name="l1626"><span class="linenum">1626</span></a>      <a class="function" onClick="logFunction('remove_dir')" href="../_functions/remove_dir.html" onMouseOver="funcPopup(event,'remove_dir')">remove_dir</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('localcachedir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/localcachedir.html">localcachedir</a>, true);
<a name="l1627"><span class="linenum">1627</span></a>      <a class="function" onClick="logFunction('set_config')" href="../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('localcachedirpurged', <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>());
<a name="l1628"><span class="linenum">1628</span></a>      <a class="function" onClick="logFunction('make_localcache_directory')" href="../_functions/make_localcache_directory.html" onMouseOver="funcPopup(event,'make_localcache_directory')">make_localcache_directory</a>('', true);
<a name="l1629"><span class="linenum">1629</span></a>      \core\task\<a class="class" onClick="logClass('manager')" href="../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('clear_static_caches')" href="../_functions/clear_static_caches.html" onMouseOver="funcPopup(event,'clear_static_caches')">clear_static_caches</a>();
<a name="l1630"><span class="linenum">1630</span></a>  }
<a name="l1631"><span class="linenum">1631</span></a>  
<a name="l1632"><span class="linenum">1632</span></a>  <span class="comment">/**</span>
<a name="l1633"><span class="linenum">1633</span></a>  <span class="comment"> * Get volatile flags</span>
<a name="l1634"><span class="linenum">1634</span></a>  <span class="comment"> *</span>
<a name="l1635"><span class="linenum">1635</span></a>  <span class="comment"> * @param string $type</span>
<a name="l1636"><span class="linenum">1636</span></a>  <span class="comment"> * @param int $changedsince default null</span>
<a name="l1637"><span class="linenum">1637</span></a>  <span class="comment"> * @return array records array</span>
<a name="l1638"><span class="linenum">1638</span></a>  <span class="comment"> */</span>
<a name="l1639"><span class="linenum">1639</span></a>  function <a class="function" onClick="logFunction('get_cache_flags')" href="../_functions/get_cache_flags.html" onMouseOver="funcPopup(event,'get_cache_flags')">get_cache_flags</a>(<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>, <a class="var it12909" onMouseOver="hilite(12909)" onMouseOut="lolite()" onClick="logVariable('changedsince')" href="../_variables/changedsince.html">$changedsince</a> = null) {
<a name="l1640"><span class="linenum">1640</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l1641"><span class="linenum">1641</span></a>  
<a name="l1642"><span class="linenum">1642</span></a>      <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array('type' =&gt; <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>, 'expiry' =&gt; <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>());
<a name="l1643"><span class="linenum">1643</span></a>      <a class="var it6271" onMouseOver="hilite(6271)" onMouseOut="lolite()" onClick="logVariable('sqlwhere')" href="../_variables/sqlwhere.html">$sqlwhere</a> = &quot;flagtype = :type AND expiry &gt;= :expiry&quot;;
<a name="l1644"><span class="linenum">1644</span></a>      if (<a class="var it12909" onMouseOver="hilite(12909)" onMouseOut="lolite()" onClick="logVariable('changedsince')" href="../_variables/changedsince.html">$changedsince</a> !== null) {
<a name="l1645"><span class="linenum">1645</span></a>          <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['changedsince'] = <a class="var it12909" onMouseOver="hilite(12909)" onMouseOut="lolite()" onClick="logVariable('changedsince')" href="../_variables/changedsince.html">$changedsince</a>;
<a name="l1646"><span class="linenum">1646</span></a>          <a class="var it6271" onMouseOver="hilite(6271)" onMouseOut="lolite()" onClick="logVariable('sqlwhere')" href="../_variables/sqlwhere.html">$sqlwhere</a> .= &quot; AND timemodified &gt; :changedsince&quot;;
<a name="l1647"><span class="linenum">1647</span></a>      }
<a name="l1648"><span class="linenum">1648</span></a>      <a class="var it12910" onMouseOver="hilite(12910)" onMouseOut="lolite()" onClick="logVariable('cf')" href="../_variables/cf.html">$cf</a> = array();
<a name="l1649"><span class="linenum">1649</span></a>      if (<a class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" onClick="logVariable('flags')" href="../_variables/flags.html">$flags</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_select')" href="../_functions/get_records_select.html" onMouseOver="funcPopup(event,'get_records_select')">get_records_select</a>('cache_flags', <a class="var it6271" onMouseOver="hilite(6271)" onMouseOut="lolite()" onClick="logVariable('sqlwhere')" href="../_variables/sqlwhere.html">$sqlwhere</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>, '', 'name,value')) {
<a name="l1650"><span class="linenum">1650</span></a>          foreach (<a class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" onClick="logVariable('flags')" href="../_variables/flags.html">$flags</a> as <a class="var it3085" onMouseOver="hilite(3085)" onMouseOut="lolite()" onClick="logVariable('flag')" href="../_variables/flag.html">$flag</a>) {
<a name="l1651"><span class="linenum">1651</span></a>              <a class="var it12910" onMouseOver="hilite(12910)" onMouseOut="lolite()" onClick="logVariable('cf')" href="../_variables/cf.html">$cf</a>[<a class="var it3085" onMouseOver="hilite(3085)" onMouseOut="lolite()" onClick="logVariable('flag')" href="../_variables/flag.html">$flag</a>-&gt;<a onClick="logVariable('name')" class="var it41064" onMouseOver="hilite(41064)" onMouseOut="lolite()" href="../_variables/name.html">name</a>] = <a class="var it3085" onMouseOver="hilite(3085)" onMouseOut="lolite()" onClick="logVariable('flag')" href="../_variables/flag.html">$flag</a>-&gt;<a onClick="logVariable('value')" class="var it41064" onMouseOver="hilite(41064)" onMouseOut="lolite()" href="../_variables/value.html">value</a>;
<a name="l1652"><span class="linenum">1652</span></a>          }
<a name="l1653"><span class="linenum">1653</span></a>      }
<a name="l1654"><span class="linenum">1654</span></a>      return <a class="var it12910" onMouseOver="hilite(12910)" onMouseOut="lolite()" onClick="logVariable('cf')" href="../_variables/cf.html">$cf</a>;
<a name="l1655"><span class="linenum">1655</span></a>  }
<a name="l1656"><span class="linenum">1656</span></a>  
<a name="l1657"><span class="linenum">1657</span></a>  <span class="comment">/**</span>
<a name="l1658"><span class="linenum">1658</span></a>  <span class="comment"> * Get volatile flags</span>
<a name="l1659"><span class="linenum">1659</span></a>  <span class="comment"> *</span>
<a name="l1660"><span class="linenum">1660</span></a>  <span class="comment"> * @param string $type</span>
<a name="l1661"><span class="linenum">1661</span></a>  <span class="comment"> * @param string $name</span>
<a name="l1662"><span class="linenum">1662</span></a>  <span class="comment"> * @param int $changedsince default null</span>
<a name="l1663"><span class="linenum">1663</span></a>  <span class="comment"> * @return string|false The cache flag value or false</span>
<a name="l1664"><span class="linenum">1664</span></a>  <span class="comment"> */</span>
<a name="l1665"><span class="linenum">1665</span></a>  function <a class="function" onClick="logFunction('get_cache_flag')" href="../_functions/get_cache_flag.html" onMouseOver="funcPopup(event,'get_cache_flag')">get_cache_flag</a>(<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, <a class="var it12909" onMouseOver="hilite(12909)" onMouseOut="lolite()" onClick="logVariable('changedsince')" href="../_variables/changedsince.html">$changedsince</a>=null) {
<a name="l1666"><span class="linenum">1666</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l1667"><span class="linenum">1667</span></a>  
<a name="l1668"><span class="linenum">1668</span></a>      <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array('type' =&gt; <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>, 'name' =&gt; <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, 'expiry' =&gt; <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>());
<a name="l1669"><span class="linenum">1669</span></a>  
<a name="l1670"><span class="linenum">1670</span></a>      <a class="var it6271" onMouseOver="hilite(6271)" onMouseOut="lolite()" onClick="logVariable('sqlwhere')" href="../_variables/sqlwhere.html">$sqlwhere</a> = &quot;flagtype = :type AND name = :name AND expiry &gt;= :expiry&quot;;
<a name="l1671"><span class="linenum">1671</span></a>      if (<a class="var it12909" onMouseOver="hilite(12909)" onMouseOut="lolite()" onClick="logVariable('changedsince')" href="../_variables/changedsince.html">$changedsince</a> !== null) {
<a name="l1672"><span class="linenum">1672</span></a>          <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['changedsince'] = <a class="var it12909" onMouseOver="hilite(12909)" onMouseOut="lolite()" onClick="logVariable('changedsince')" href="../_variables/changedsince.html">$changedsince</a>;
<a name="l1673"><span class="linenum">1673</span></a>          <a class="var it6271" onMouseOver="hilite(6271)" onMouseOut="lolite()" onClick="logVariable('sqlwhere')" href="../_variables/sqlwhere.html">$sqlwhere</a> .= &quot; AND timemodified &gt; :changedsince&quot;;
<a name="l1674"><span class="linenum">1674</span></a>      }
<a name="l1675"><span class="linenum">1675</span></a>  
<a name="l1676"><span class="linenum">1676</span></a>      return <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_field_select')" href="../_functions/get_field_select.html" onMouseOver="funcPopup(event,'get_field_select')">get_field_select</a>('cache_flags', 'value', <a class="var it6271" onMouseOver="hilite(6271)" onMouseOut="lolite()" onClick="logVariable('sqlwhere')" href="../_variables/sqlwhere.html">$sqlwhere</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>);
<a name="l1677"><span class="linenum">1677</span></a>  }
<a name="l1678"><span class="linenum">1678</span></a>  
<a name="l1679"><span class="linenum">1679</span></a>  <span class="comment">/**</span>
<a name="l1680"><span class="linenum">1680</span></a>  <span class="comment"> * Set a volatile flag</span>
<a name="l1681"><span class="linenum">1681</span></a>  <span class="comment"> *</span>
<a name="l1682"><span class="linenum">1682</span></a>  <span class="comment"> * @param string $type the &quot;type&quot; namespace for the key</span>
<a name="l1683"><span class="linenum">1683</span></a>  <span class="comment"> * @param string $name the key to set</span>
<a name="l1684"><span class="linenum">1684</span></a>  <span class="comment"> * @param string $value the value to set (without magic quotes) - null will remove the flag</span>
<a name="l1685"><span class="linenum">1685</span></a>  <span class="comment"> * @param int $expiry (optional) epoch indicating expiry - defaults to now()+ 24hs</span>
<a name="l1686"><span class="linenum">1686</span></a>  <span class="comment"> * @return bool Always returns true</span>
<a name="l1687"><span class="linenum">1687</span></a>  <span class="comment"> */</span>
<a name="l1688"><span class="linenum">1688</span></a>  function <a class="function" onClick="logFunction('set_cache_flag')" href="../_functions/set_cache_flag.html" onMouseOver="funcPopup(event,'set_cache_flag')">set_cache_flag</a>(<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>, <a class="var it3259" onMouseOver="hilite(3259)" onMouseOut="lolite()" onClick="logVariable('expiry')" href="../_variables/expiry.html">$expiry</a> = null) {
<a name="l1689"><span class="linenum">1689</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l1690"><span class="linenum">1690</span></a>  
<a name="l1691"><span class="linenum">1691</span></a>      <a class="var it91" onMouseOver="hilite(91)" onMouseOut="lolite()" onClick="logVariable('timemodified')" href="../_variables/timemodified.html">$timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l1692"><span class="linenum">1692</span></a>      if (<a class="var it3259" onMouseOver="hilite(3259)" onMouseOut="lolite()" onClick="logVariable('expiry')" href="../_variables/expiry.html">$expiry</a> === null || <a class="var it3259" onMouseOver="hilite(3259)" onMouseOut="lolite()" onClick="logVariable('expiry')" href="../_variables/expiry.html">$expiry</a> &lt; <a class="var it91" onMouseOver="hilite(91)" onMouseOut="lolite()" onClick="logVariable('timemodified')" href="../_variables/timemodified.html">$timemodified</a>) {
<a name="l1693"><span class="linenum">1693</span></a>          <a class="var it3259" onMouseOver="hilite(3259)" onMouseOut="lolite()" onClick="logVariable('expiry')" href="../_variables/expiry.html">$expiry</a> = <a class="var it91" onMouseOver="hilite(91)" onMouseOut="lolite()" onClick="logVariable('timemodified')" href="../_variables/timemodified.html">$timemodified</a> + 24 * 60 * 60;
<a name="l1694"><span class="linenum">1694</span></a>      } else {
<a name="l1695"><span class="linenum">1695</span></a>          <a class="var it3259" onMouseOver="hilite(3259)" onMouseOut="lolite()" onClick="logVariable('expiry')" href="../_variables/expiry.html">$expiry</a> = (int)<a class="var it3259" onMouseOver="hilite(3259)" onMouseOut="lolite()" onClick="logVariable('expiry')" href="../_variables/expiry.html">$expiry</a>;
<a name="l1696"><span class="linenum">1696</span></a>      }
<a name="l1697"><span class="linenum">1697</span></a>  
<a name="l1698"><span class="linenum">1698</span></a>      if (<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> === null) {
<a name="l1699"><span class="linenum">1699</span></a>          <a class="function" onClick="logFunction('unset_cache_flag')" href="../_functions/unset_cache_flag.html" onMouseOver="funcPopup(event,'unset_cache_flag')">unset_cache_flag</a>(<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>);
<a name="l1700"><span class="linenum">1700</span></a>          return true;
<a name="l1701"><span class="linenum">1701</span></a>      }
<a name="l1702"><span class="linenum">1702</span></a>  
<a name="l1703"><span class="linenum">1703</span></a>      if (<a class="var it2006" onMouseOver="hilite(2006)" onMouseOut="lolite()" onClick="logVariable('f')" href="../_variables/f.html">$f</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('cache_flags', array('name' =&gt; <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, 'flagtype' =&gt; <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>), '*', <a class="constant" onClick="logConstant('IGNORE_MULTIPLE')" href="../_constants/IGNORE_MULTIPLE.html" onMouseOver="constPopup(event,'IGNORE_MULTIPLE')">IGNORE_MULTIPLE</a>)) {
<a name="l1704"><span class="linenum">1704</span></a>  <span class="comment">        // This is a potential problem in DEBUG_DEVELOPER.</span>
<a name="l1705"><span class="linenum">1705</span></a>          if (<a class="var it2006" onMouseOver="hilite(2006)" onMouseOut="lolite()" onClick="logVariable('f')" href="../_variables/f.html">$f</a>-&gt;<a onClick="logVariable('value')" class="var it39911" onMouseOver="hilite(39911)" onMouseOut="lolite()" href="../_variables/value.html">value</a> == <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> and <a class="var it2006" onMouseOver="hilite(2006)" onMouseOut="lolite()" onClick="logVariable('f')" href="../_variables/f.html">$f</a>-&gt;<a onClick="logVariable('expiry')" class="var it39911" onMouseOver="hilite(39911)" onMouseOut="lolite()" href="../_variables/expiry.html">expiry</a> == <a class="var it3259" onMouseOver="hilite(3259)" onMouseOut="lolite()" onClick="logVariable('expiry')" href="../_variables/expiry.html">$expiry</a> and <a class="var it2006" onMouseOver="hilite(2006)" onMouseOut="lolite()" onClick="logVariable('f')" href="../_variables/f.html">$f</a>-&gt;<a onClick="logVariable('timemodified')" class="var it39911" onMouseOver="hilite(39911)" onMouseOut="lolite()" href="../_variables/timemodified.html">timemodified</a> == <a class="var it91" onMouseOver="hilite(91)" onMouseOut="lolite()" onClick="logVariable('timemodified')" href="../_variables/timemodified.html">$timemodified</a>) {
<a name="l1706"><span class="linenum">1706</span></a>              return true; <span class="comment">// No need to update.</span>
<a name="l1707"><span class="linenum">1707</span></a>          }
<a name="l1708"><span class="linenum">1708</span></a>          <a class="var it2006" onMouseOver="hilite(2006)" onMouseOut="lolite()" onClick="logVariable('f')" href="../_variables/f.html">$f</a>-&gt;<a onClick="logVariable('value')" class="var it39911" onMouseOver="hilite(39911)" onMouseOut="lolite()" href="../_variables/value.html">value</a>        = <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l1709"><span class="linenum">1709</span></a>          <a class="var it2006" onMouseOver="hilite(2006)" onMouseOut="lolite()" onClick="logVariable('f')" href="../_variables/f.html">$f</a>-&gt;<a onClick="logVariable('expiry')" class="var it39911" onMouseOver="hilite(39911)" onMouseOut="lolite()" href="../_variables/expiry.html">expiry</a>       = <a class="var it3259" onMouseOver="hilite(3259)" onMouseOut="lolite()" onClick="logVariable('expiry')" href="../_variables/expiry.html">$expiry</a>;
<a name="l1710"><span class="linenum">1710</span></a>          <a class="var it2006" onMouseOver="hilite(2006)" onMouseOut="lolite()" onClick="logVariable('f')" href="../_variables/f.html">$f</a>-&gt;<a onClick="logVariable('timemodified')" class="var it39911" onMouseOver="hilite(39911)" onMouseOut="lolite()" href="../_variables/timemodified.html">timemodified</a> = <a class="var it91" onMouseOver="hilite(91)" onMouseOut="lolite()" onClick="logVariable('timemodified')" href="../_variables/timemodified.html">$timemodified</a>;
<a name="l1711"><span class="linenum">1711</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('cache_flags', <a class="var it2006" onMouseOver="hilite(2006)" onMouseOut="lolite()" onClick="logVariable('f')" href="../_variables/f.html">$f</a>);
<a name="l1712"><span class="linenum">1712</span></a>      } else {
<a name="l1713"><span class="linenum">1713</span></a>          <a class="var it2006" onMouseOver="hilite(2006)" onMouseOut="lolite()" onClick="logVariable('f')" href="../_variables/f.html">$f</a> = new stdClass();
<a name="l1714"><span class="linenum">1714</span></a>          <a class="var it2006" onMouseOver="hilite(2006)" onMouseOut="lolite()" onClick="logVariable('f')" href="../_variables/f.html">$f</a>-&gt;<a onClick="logVariable('flagtype')" class="var it39911" onMouseOver="hilite(39911)" onMouseOut="lolite()" href="../_variables/flagtype.html">flagtype</a>     = <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>;
<a name="l1715"><span class="linenum">1715</span></a>          <a class="var it2006" onMouseOver="hilite(2006)" onMouseOut="lolite()" onClick="logVariable('f')" href="../_variables/f.html">$f</a>-&gt;<a onClick="logVariable('name')" class="var it39911" onMouseOver="hilite(39911)" onMouseOut="lolite()" href="../_variables/name.html">name</a>         = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>;
<a name="l1716"><span class="linenum">1716</span></a>          <a class="var it2006" onMouseOver="hilite(2006)" onMouseOut="lolite()" onClick="logVariable('f')" href="../_variables/f.html">$f</a>-&gt;<a onClick="logVariable('value')" class="var it39911" onMouseOver="hilite(39911)" onMouseOut="lolite()" href="../_variables/value.html">value</a>        = <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l1717"><span class="linenum">1717</span></a>          <a class="var it2006" onMouseOver="hilite(2006)" onMouseOut="lolite()" onClick="logVariable('f')" href="../_variables/f.html">$f</a>-&gt;<a onClick="logVariable('expiry')" class="var it39911" onMouseOver="hilite(39911)" onMouseOut="lolite()" href="../_variables/expiry.html">expiry</a>       = <a class="var it3259" onMouseOver="hilite(3259)" onMouseOut="lolite()" onClick="logVariable('expiry')" href="../_variables/expiry.html">$expiry</a>;
<a name="l1718"><span class="linenum">1718</span></a>          <a class="var it2006" onMouseOver="hilite(2006)" onMouseOut="lolite()" onClick="logVariable('f')" href="../_variables/f.html">$f</a>-&gt;<a onClick="logVariable('timemodified')" class="var it39911" onMouseOver="hilite(39911)" onMouseOut="lolite()" href="../_variables/timemodified.html">timemodified</a> = <a class="var it91" onMouseOver="hilite(91)" onMouseOut="lolite()" onClick="logVariable('timemodified')" href="../_variables/timemodified.html">$timemodified</a>;
<a name="l1719"><span class="linenum">1719</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('cache_flags', <a class="var it2006" onMouseOver="hilite(2006)" onMouseOut="lolite()" onClick="logVariable('f')" href="../_variables/f.html">$f</a>);
<a name="l1720"><span class="linenum">1720</span></a>      }
<a name="l1721"><span class="linenum">1721</span></a>      return true;
<a name="l1722"><span class="linenum">1722</span></a>  }
<a name="l1723"><span class="linenum">1723</span></a>  
<a name="l1724"><span class="linenum">1724</span></a>  <span class="comment">/**</span>
<a name="l1725"><span class="linenum">1725</span></a>  <span class="comment"> * Removes a single volatile flag</span>
<a name="l1726"><span class="linenum">1726</span></a>  <span class="comment"> *</span>
<a name="l1727"><span class="linenum">1727</span></a>  <span class="comment"> * @param string $type the &quot;type&quot; namespace for the key</span>
<a name="l1728"><span class="linenum">1728</span></a>  <span class="comment"> * @param string $name the key to set</span>
<a name="l1729"><span class="linenum">1729</span></a>  <span class="comment"> * @return bool</span>
<a name="l1730"><span class="linenum">1730</span></a>  <span class="comment"> */</span>
<a name="l1731"><span class="linenum">1731</span></a>  function <a class="function" onClick="logFunction('unset_cache_flag')" href="../_functions/unset_cache_flag.html" onMouseOver="funcPopup(event,'unset_cache_flag')">unset_cache_flag</a>(<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>) {
<a name="l1732"><span class="linenum">1732</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l1733"><span class="linenum">1733</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('cache_flags', array('name' =&gt; <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, 'flagtype' =&gt; <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>));
<a name="l1734"><span class="linenum">1734</span></a>      return true;
<a name="l1735"><span class="linenum">1735</span></a>  }
<a name="l1736"><span class="linenum">1736</span></a>  
<a name="l1737"><span class="linenum">1737</span></a>  <span class="comment">/**</span>
<a name="l1738"><span class="linenum">1738</span></a>  <span class="comment"> * Garbage-collect volatile flags</span>
<a name="l1739"><span class="linenum">1739</span></a>  <span class="comment"> *</span>
<a name="l1740"><span class="linenum">1740</span></a>  <span class="comment"> * @return bool Always returns true</span>
<a name="l1741"><span class="linenum">1741</span></a>  <span class="comment"> */</span>
<a name="l1742"><span class="linenum">1742</span></a>  function <a class="function" onClick="logFunction('gc_cache_flags')" href="../_functions/gc_cache_flags.html" onMouseOver="funcPopup(event,'gc_cache_flags')">gc_cache_flags</a>() {
<a name="l1743"><span class="linenum">1743</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l1744"><span class="linenum">1744</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records_select')" href="../_functions/delete_records_select.html" onMouseOver="funcPopup(event,'delete_records_select')">delete_records_select</a>('cache_flags', 'expiry &lt; ?', array(<a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>()));
<a name="l1745"><span class="linenum">1745</span></a>      return true;
<a name="l1746"><span class="linenum">1746</span></a>  }
<a name="l1747"><span class="linenum">1747</span></a>  
<a name="l1748"><span class="linenum">1748</span></a>  <span class="comment">// USER PREFERENCE API.</span>
<a name="l1749"><span class="linenum">1749</span></a>  
<a name="l1750"><span class="linenum">1750</span></a>  <span class="comment">/**</span>
<a name="l1751"><span class="linenum">1751</span></a>  <span class="comment"> * Refresh user preference cache. This is used most often for $USER</span>
<a name="l1752"><span class="linenum">1752</span></a>  <span class="comment"> * object that is stored in session, but it also helps with performance in cron script.</span>
<a name="l1753"><span class="linenum">1753</span></a>  <span class="comment"> *</span>
<a name="l1754"><span class="linenum">1754</span></a>  <span class="comment"> * Preferences for each user are loaded on first use on every page, then again after the timeout expires.</span>
<a name="l1755"><span class="linenum">1755</span></a>  <span class="comment"> *</span>
<a name="l1756"><span class="linenum">1756</span></a>  <span class="comment"> * @package  core</span>
<a name="l1757"><span class="linenum">1757</span></a>  <span class="comment"> * @category preference</span>
<a name="l1758"><span class="linenum">1758</span></a>  <span class="comment"> * @access   public</span>
<a name="l1759"><span class="linenum">1759</span></a>  <span class="comment"> * @param    stdClass         $user          User object. Preferences are preloaded into 'preference' property</span>
<a name="l1760"><span class="linenum">1760</span></a>  <span class="comment"> * @param    int              $cachelifetime Cache life time on the current page (in seconds)</span>
<a name="l1761"><span class="linenum">1761</span></a>  <span class="comment"> * @throws   coding_exception</span>
<a name="l1762"><span class="linenum">1762</span></a>  <span class="comment"> * @return   null</span>
<a name="l1763"><span class="linenum">1763</span></a>  <span class="comment"> */</span>
<a name="l1764"><span class="linenum">1764</span></a>  function <a class="function" onClick="logFunction('check_user_preferences_loaded')" href="../_functions/check_user_preferences_loaded.html" onMouseOver="funcPopup(event,'check_user_preferences_loaded')">check_user_preferences_loaded</a>(stdClass <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('cachelifetime')" href="../_variables/cachelifetime.html">$cachelifetime</a> = 120) {
<a name="l1765"><span class="linenum">1765</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l1766"><span class="linenum">1766</span></a>  <span class="comment">    // Static cache, we need to check on each page load, not only every 2 minutes.</span>
<a name="l1767"><span class="linenum">1767</span></a>      static <a class="var it12913" onMouseOver="hilite(12913)" onMouseOut="lolite()" onClick="logVariable('loadedusers')" href="../_variables/loadedusers.html">$loadedusers</a> = array();
<a name="l1768"><span class="linenum">1768</span></a>  
<a name="l1769"><span class="linenum">1769</span></a>      if (!isset(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)) {
<a name="l1770"><span class="linenum">1770</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Invalid <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> parameter in <a class="function" onClick="logFunction('check_user_preferences_loaded')" href="../_functions/check_user_preferences_loaded.html" onMouseOver="funcPopup(event,'check_user_preferences_loaded')">check_user_preferences_loaded</a>() call, missing id field');
<a name="l1771"><span class="linenum">1771</span></a>      }
<a name="l1772"><span class="linenum">1772</span></a>  
<a name="l1773"><span class="linenum">1773</span></a>      if (empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>) or <a class="function" onClick="logFunction('isguestuser')" href="../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)) {
<a name="l1774"><span class="linenum">1774</span></a>  <span class="comment">        // No permanent storage for not-logged-in users and guest.</span>
<a name="l1775"><span class="linenum">1775</span></a>          if (!isset(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('preference')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/preference.html">preference</a>)) {
<a name="l1776"><span class="linenum">1776</span></a>              <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('preference')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/preference.html">preference</a> = array();
<a name="l1777"><span class="linenum">1777</span></a>          }
<a name="l1778"><span class="linenum">1778</span></a>          return;
<a name="l1779"><span class="linenum">1779</span></a>      }
<a name="l1780"><span class="linenum">1780</span></a>  
<a name="l1781"><span class="linenum">1781</span></a>      <a class="var it2489" onMouseOver="hilite(2489)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../_variables/timenow.html">$timenow</a> = <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l1782"><span class="linenum">1782</span></a>  
<a name="l1783"><span class="linenum">1783</span></a>      if (isset(<a class="var it12913" onMouseOver="hilite(12913)" onMouseOut="lolite()" onClick="logVariable('loadedusers')" href="../_variables/loadedusers.html">$loadedusers</a>[<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>]) and isset(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('preference')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/preference.html">preference</a>) and isset(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('preference')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/preference.html">preference</a>['_lastloaded'])) {
<a name="l1784"><span class="linenum">1784</span></a>  <span class="comment">        // Already loaded at least once on this page. Are we up to date?</span>
<a name="l1785"><span class="linenum">1785</span></a>          if (<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('preference')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/preference.html">preference</a>['_lastloaded'] + <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('cachelifetime')" href="../_variables/cachelifetime.html">$cachelifetime</a> &gt; <a class="var it2489" onMouseOver="hilite(2489)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../_variables/timenow.html">$timenow</a>) {
<a name="l1786"><span class="linenum">1786</span></a>  <span class="comment">            // No need to reload - we are on the same page and we loaded prefs just a moment ago.</span>
<a name="l1787"><span class="linenum">1787</span></a>              return;
<a name="l1788"><span class="linenum">1788</span></a>  
<a name="l1789"><span class="linenum">1789</span></a>          } else if (!<a class="function" onClick="logFunction('get_cache_flag')" href="../_functions/get_cache_flag.html" onMouseOver="funcPopup(event,'get_cache_flag')">get_cache_flag</a>('userpreferenceschanged', <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('preference')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/preference.html">preference</a>['_lastloaded'])) {
<a name="l1790"><span class="linenum">1790</span></a>  <span class="comment">            // No change since the lastcheck on this page.</span>
<a name="l1791"><span class="linenum">1791</span></a>              <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('preference')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/preference.html">preference</a>['_lastloaded'] = <a class="var it2489" onMouseOver="hilite(2489)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../_variables/timenow.html">$timenow</a>;
<a name="l1792"><span class="linenum">1792</span></a>              return;
<a name="l1793"><span class="linenum">1793</span></a>          }
<a name="l1794"><span class="linenum">1794</span></a>      }
<a name="l1795"><span class="linenum">1795</span></a>  
<a name="l1796"><span class="linenum">1796</span></a>  <span class="comment">    // OK, so we have to reload all preferences.</span>
<a name="l1797"><span class="linenum">1797</span></a>      <a class="var it12913" onMouseOver="hilite(12913)" onMouseOut="lolite()" onClick="logVariable('loadedusers')" href="../_variables/loadedusers.html">$loadedusers</a>[<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>] = true;
<a name="l1798"><span class="linenum">1798</span></a>      <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('preference')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/preference.html">preference</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_menu')" href="../_functions/get_records_menu.html" onMouseOver="funcPopup(event,'get_records_menu')">get_records_menu</a>('user_preferences', array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>), '', 'name,value'); <span class="comment">// All values.</span>
<a name="l1799"><span class="linenum">1799</span></a>      <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('preference')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/preference.html">preference</a>['_lastloaded'] = <a class="var it2489" onMouseOver="hilite(2489)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../_variables/timenow.html">$timenow</a>;
<a name="l1800"><span class="linenum">1800</span></a>  }
<a name="l1801"><span class="linenum">1801</span></a>  
<a name="l1802"><span class="linenum">1802</span></a>  <span class="comment">/**</span>
<a name="l1803"><span class="linenum">1803</span></a>  <span class="comment"> * Called from set/unset_user_preferences, so that the prefs can be correctly reloaded in different sessions.</span>
<a name="l1804"><span class="linenum">1804</span></a>  <span class="comment"> *</span>
<a name="l1805"><span class="linenum">1805</span></a>  <span class="comment"> * NOTE: internal function, do not call from other code.</span>
<a name="l1806"><span class="linenum">1806</span></a>  <span class="comment"> *</span>
<a name="l1807"><span class="linenum">1807</span></a>  <span class="comment"> * @package core</span>
<a name="l1808"><span class="linenum">1808</span></a>  <span class="comment"> * @access private</span>
<a name="l1809"><span class="linenum">1809</span></a>  <span class="comment"> * @param integer $userid the user whose prefs were changed.</span>
<a name="l1810"><span class="linenum">1810</span></a>  <span class="comment"> */</span>
<a name="l1811"><span class="linenum">1811</span></a>  function <a class="function" onClick="logFunction('mark_user_preferences_changed')" href="../_functions/mark_user_preferences_changed.html" onMouseOver="funcPopup(event,'mark_user_preferences_changed')">mark_user_preferences_changed</a>(<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>) {
<a name="l1812"><span class="linenum">1812</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l1813"><span class="linenum">1813</span></a>  
<a name="l1814"><span class="linenum">1814</span></a>      if (empty(<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>) or <a class="function" onClick="logFunction('isguestuser')" href="../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>(<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>)) {
<a name="l1815"><span class="linenum">1815</span></a>  <span class="comment">        // No cache flags for guest and not-logged-in users.</span>
<a name="l1816"><span class="linenum">1816</span></a>          return;
<a name="l1817"><span class="linenum">1817</span></a>      }
<a name="l1818"><span class="linenum">1818</span></a>  
<a name="l1819"><span class="linenum">1819</span></a>      <a class="function" onClick="logFunction('set_cache_flag')" href="../_functions/set_cache_flag.html" onMouseOver="funcPopup(event,'set_cache_flag')">set_cache_flag</a>('userpreferenceschanged', <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>, 1, <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() + <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessiontimeout')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/sessiontimeout.html">sessiontimeout</a>);
<a name="l1820"><span class="linenum">1820</span></a>  }
<a name="l1821"><span class="linenum">1821</span></a>  
<a name="l1822"><span class="linenum">1822</span></a>  <span class="comment">/**</span>
<a name="l1823"><span class="linenum">1823</span></a>  <span class="comment"> * Sets a preference for the specified user.</span>
<a name="l1824"><span class="linenum">1824</span></a>  <span class="comment"> *</span>
<a name="l1825"><span class="linenum">1825</span></a>  <span class="comment"> * If a $user object is submitted it's 'preference' property is used for the preferences cache.</span>
<a name="l1826"><span class="linenum">1826</span></a>  <span class="comment"> *</span>
<a name="l1827"><span class="linenum">1827</span></a>  <span class="comment"> * @package  core</span>
<a name="l1828"><span class="linenum">1828</span></a>  <span class="comment"> * @category preference</span>
<a name="l1829"><span class="linenum">1829</span></a>  <span class="comment"> * @access   public</span>
<a name="l1830"><span class="linenum">1830</span></a>  <span class="comment"> * @param    string            $name  The key to set as preference for the specified user</span>
<a name="l1831"><span class="linenum">1831</span></a>  <span class="comment"> * @param    string            $value The value to set for the $name key in the specified user's</span>
<a name="l1832"><span class="linenum">1832</span></a>  <span class="comment"> *                                    record, null means delete current value.</span>
<a name="l1833"><span class="linenum">1833</span></a>  <span class="comment"> * @param    stdClass|int|null $user  A moodle user object or id, null means current user</span>
<a name="l1834"><span class="linenum">1834</span></a>  <span class="comment"> * @throws   coding_exception</span>
<a name="l1835"><span class="linenum">1835</span></a>  <span class="comment"> * @return   bool                     Always true or exception</span>
<a name="l1836"><span class="linenum">1836</span></a>  <span class="comment"> */</span>
<a name="l1837"><span class="linenum">1837</span></a>  function <a class="function" onClick="logFunction('set_user_preference')" href="../_functions/set_user_preference.html" onMouseOver="funcPopup(event,'set_user_preference')">set_user_preference</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = null) {
<a name="l1838"><span class="linenum">1838</span></a>      global <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l1839"><span class="linenum">1839</span></a>  
<a name="l1840"><span class="linenum">1840</span></a>      if (empty(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>) or <a class="phpfunction" onClick="logFunction('is_numeric')" href="../_functions/is_numeric.html" onMouseOver="phpfuncPopup(event,'is_numeric')">is_numeric</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>) or <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a> === '_lastloaded') {
<a name="l1841"><span class="linenum">1841</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Invalid preference name in <a class="function" onClick="logFunction('set_user_preference')" href="../_functions/set_user_preference.html" onMouseOver="funcPopup(event,'set_user_preference')">set_user_preference</a>() call');
<a name="l1842"><span class="linenum">1842</span></a>      }
<a name="l1843"><span class="linenum">1843</span></a>  
<a name="l1844"><span class="linenum">1844</span></a>      if (<a class="phpfunction" onClick="logFunction('is_null')" href="../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>)) {
<a name="l1845"><span class="linenum">1845</span></a>  <span class="comment">        // Null means delete current.</span>
<a name="l1846"><span class="linenum">1846</span></a>          return <a class="function" onClick="logFunction('unset_user_preference')" href="../_functions/unset_user_preference.html" onMouseOver="funcPopup(event,'unset_user_preference')">unset_user_preference</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l1847"><span class="linenum">1847</span></a>      } else if (<a class="phpfunction" onClick="logFunction('is_object')" href="../_functions/is_object.html" onMouseOver="phpfuncPopup(event,'is_object')">is_object</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>)) {
<a name="l1848"><span class="linenum">1848</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Invalid value in <a class="function" onClick="logFunction('set_user_preference')" href="../_functions/set_user_preference.html" onMouseOver="funcPopup(event,'set_user_preference')">set_user_preference</a>() call, objects are not allowed');
<a name="l1849"><span class="linenum">1849</span></a>      } else if (<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>)) {
<a name="l1850"><span class="linenum">1850</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Invalid value in <a class="function" onClick="logFunction('set_user_preference')" href="../_functions/set_user_preference.html" onMouseOver="funcPopup(event,'set_user_preference')">set_user_preference</a>() call, arrays are not allowed');
<a name="l1851"><span class="linenum">1851</span></a>      }
<a name="l1852"><span class="linenum">1852</span></a>  <span class="comment">    // Value column maximum length is 1333 characters.</span>
<a name="l1853"><span class="linenum">1853</span></a>      <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> = (string)<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l1854"><span class="linenum">1854</span></a>      if (<a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) &gt; 1333) {
<a name="l1855"><span class="linenum">1855</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Invalid value in <a class="function" onClick="logFunction('set_user_preference')" href="../_functions/set_user_preference.html" onMouseOver="funcPopup(event,'set_user_preference')">set_user_preference</a>() call, value is is too long for the value column');
<a name="l1856"><span class="linenum">1856</span></a>      }
<a name="l1857"><span class="linenum">1857</span></a>  
<a name="l1858"><span class="linenum">1858</span></a>      if (<a class="phpfunction" onClick="logFunction('is_null')" href="../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l1859"><span class="linenum">1859</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>;
<a name="l1860"><span class="linenum">1860</span></a>      } else if (isset(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)) {
<a name="l1861"><span class="linenum">1861</span></a>  <span class="comment">        // It is a valid object.</span>
<a name="l1862"><span class="linenum">1862</span></a>      } else if (<a class="phpfunction" onClick="logFunction('is_numeric')" href="../_functions/is_numeric.html" onMouseOver="phpfuncPopup(event,'is_numeric')">is_numeric</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l1863"><span class="linenum">1863</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = (object)array('id' =&gt; (int)<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l1864"><span class="linenum">1864</span></a>      } else {
<a name="l1865"><span class="linenum">1865</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Invalid <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> parameter in <a class="function" onClick="logFunction('set_user_preference')" href="../_functions/set_user_preference.html" onMouseOver="funcPopup(event,'set_user_preference')">set_user_preference</a>() call');
<a name="l1866"><span class="linenum">1866</span></a>      }
<a name="l1867"><span class="linenum">1867</span></a>  
<a name="l1868"><span class="linenum">1868</span></a>      <a class="function" onClick="logFunction('check_user_preferences_loaded')" href="../_functions/check_user_preferences_loaded.html" onMouseOver="funcPopup(event,'check_user_preferences_loaded')">check_user_preferences_loaded</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l1869"><span class="linenum">1869</span></a>  
<a name="l1870"><span class="linenum">1870</span></a>      if (empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>) or <a class="function" onClick="logFunction('isguestuser')" href="../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)) {
<a name="l1871"><span class="linenum">1871</span></a>  <span class="comment">        // No permanent storage for not-logged-in users and guest.</span>
<a name="l1872"><span class="linenum">1872</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('preference')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/preference.html">preference</a>[<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>] = <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l1873"><span class="linenum">1873</span></a>          return true;
<a name="l1874"><span class="linenum">1874</span></a>      }
<a name="l1875"><span class="linenum">1875</span></a>  
<a name="l1876"><span class="linenum">1876</span></a>      if (<a class="var it1027" onMouseOver="hilite(1027)" onMouseOut="lolite()" onClick="logVariable('preference')" href="../_variables/preference.html">$preference</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user_preferences', array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, 'name' =&gt; <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>))) {
<a name="l1877"><span class="linenum">1877</span></a>          if (<a class="var it1027" onMouseOver="hilite(1027)" onMouseOut="lolite()" onClick="logVariable('preference')" href="../_variables/preference.html">$preference</a>-&gt;<a onClick="logVariable('value')" class="var it41065" onMouseOver="hilite(41065)" onMouseOut="lolite()" href="../_variables/value.html">value</a> === <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> and isset(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('preference')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/preference.html">preference</a>[<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>]) and <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('preference')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/preference.html">preference</a>[<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>] === <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) {
<a name="l1878"><span class="linenum">1878</span></a>  <span class="comment">            // Preference already set to this value.</span>
<a name="l1879"><span class="linenum">1879</span></a>              return true;
<a name="l1880"><span class="linenum">1880</span></a>          }
<a name="l1881"><span class="linenum">1881</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('user_preferences', 'value', <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>, array('id' =&gt; <a class="var it1027" onMouseOver="hilite(1027)" onMouseOut="lolite()" onClick="logVariable('preference')" href="../_variables/preference.html">$preference</a>-&gt;<a onClick="logVariable('id')" class="var it41065" onMouseOver="hilite(41065)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l1882"><span class="linenum">1882</span></a>  
<a name="l1883"><span class="linenum">1883</span></a>      } else {
<a name="l1884"><span class="linenum">1884</span></a>          <a class="var it1027" onMouseOver="hilite(1027)" onMouseOut="lolite()" onClick="logVariable('preference')" href="../_variables/preference.html">$preference</a> = new stdClass();
<a name="l1885"><span class="linenum">1885</span></a>          <a class="var it1027" onMouseOver="hilite(1027)" onMouseOut="lolite()" onClick="logVariable('preference')" href="../_variables/preference.html">$preference</a>-&gt;<a onClick="logVariable('userid')" class="var it41065" onMouseOver="hilite(41065)" onMouseOut="lolite()" href="../_variables/userid.html">userid</a> = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>;
<a name="l1886"><span class="linenum">1886</span></a>          <a class="var it1027" onMouseOver="hilite(1027)" onMouseOut="lolite()" onClick="logVariable('preference')" href="../_variables/preference.html">$preference</a>-&gt;<a onClick="logVariable('name')" class="var it41065" onMouseOver="hilite(41065)" onMouseOut="lolite()" href="../_variables/name.html">name</a>   = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>;
<a name="l1887"><span class="linenum">1887</span></a>          <a class="var it1027" onMouseOver="hilite(1027)" onMouseOut="lolite()" onClick="logVariable('preference')" href="../_variables/preference.html">$preference</a>-&gt;<a onClick="logVariable('value')" class="var it41065" onMouseOver="hilite(41065)" onMouseOut="lolite()" href="../_variables/value.html">value</a>  = <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l1888"><span class="linenum">1888</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('user_preferences', <a class="var it1027" onMouseOver="hilite(1027)" onMouseOut="lolite()" onClick="logVariable('preference')" href="../_variables/preference.html">$preference</a>);
<a name="l1889"><span class="linenum">1889</span></a>      }
<a name="l1890"><span class="linenum">1890</span></a>  
<a name="l1891"><span class="linenum">1891</span></a>  <span class="comment">    // Update value in cache.</span>
<a name="l1892"><span class="linenum">1892</span></a>      <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('preference')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/preference.html">preference</a>[<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>] = <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l1893"><span class="linenum">1893</span></a>  
<a name="l1894"><span class="linenum">1894</span></a>  <span class="comment">    // Set reload flag for other sessions.</span>
<a name="l1895"><span class="linenum">1895</span></a>      <a class="function" onClick="logFunction('mark_user_preferences_changed')" href="../_functions/mark_user_preferences_changed.html" onMouseOver="funcPopup(event,'mark_user_preferences_changed')">mark_user_preferences_changed</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l1896"><span class="linenum">1896</span></a>  
<a name="l1897"><span class="linenum">1897</span></a>      return true;
<a name="l1898"><span class="linenum">1898</span></a>  }
<a name="l1899"><span class="linenum">1899</span></a>  
<a name="l1900"><span class="linenum">1900</span></a>  <span class="comment">/**</span>
<a name="l1901"><span class="linenum">1901</span></a>  <span class="comment"> * Sets a whole array of preferences for the current user</span>
<a name="l1902"><span class="linenum">1902</span></a>  <span class="comment"> *</span>
<a name="l1903"><span class="linenum">1903</span></a>  <span class="comment"> * If a $user object is submitted it's 'preference' property is used for the preferences cache.</span>
<a name="l1904"><span class="linenum">1904</span></a>  <span class="comment"> *</span>
<a name="l1905"><span class="linenum">1905</span></a>  <span class="comment"> * @package  core</span>
<a name="l1906"><span class="linenum">1906</span></a>  <span class="comment"> * @category preference</span>
<a name="l1907"><span class="linenum">1907</span></a>  <span class="comment"> * @access   public</span>
<a name="l1908"><span class="linenum">1908</span></a>  <span class="comment"> * @param    array             $prefarray An array of key/value pairs to be set</span>
<a name="l1909"><span class="linenum">1909</span></a>  <span class="comment"> * @param    stdClass|int|null $user      A moodle user object or id, null means current user</span>
<a name="l1910"><span class="linenum">1910</span></a>  <span class="comment"> * @return   bool                         Always true or exception</span>
<a name="l1911"><span class="linenum">1911</span></a>  <span class="comment"> */</span>
<a name="l1912"><span class="linenum">1912</span></a>  function <a class="function" onClick="logFunction('set_user_preferences')" href="../_functions/set_user_preferences.html" onMouseOver="funcPopup(event,'set_user_preferences')">set_user_preferences</a>(array <a class="var it12915" onMouseOver="hilite(12915)" onMouseOut="lolite()" onClick="logVariable('prefarray')" href="../_variables/prefarray.html">$prefarray</a>, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = null) {
<a name="l1913"><span class="linenum">1913</span></a>      foreach (<a class="var it12915" onMouseOver="hilite(12915)" onMouseOut="lolite()" onClick="logVariable('prefarray')" href="../_variables/prefarray.html">$prefarray</a> as <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a> =&gt; <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) {
<a name="l1914"><span class="linenum">1914</span></a>          <a class="function" onClick="logFunction('set_user_preference')" href="../_functions/set_user_preference.html" onMouseOver="funcPopup(event,'set_user_preference')">set_user_preference</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l1915"><span class="linenum">1915</span></a>      }
<a name="l1916"><span class="linenum">1916</span></a>      return true;
<a name="l1917"><span class="linenum">1917</span></a>  }
<a name="l1918"><span class="linenum">1918</span></a>  
<a name="l1919"><span class="linenum">1919</span></a>  <span class="comment">/**</span>
<a name="l1920"><span class="linenum">1920</span></a>  <span class="comment"> * Unsets a preference completely by deleting it from the database</span>
<a name="l1921"><span class="linenum">1921</span></a>  <span class="comment"> *</span>
<a name="l1922"><span class="linenum">1922</span></a>  <span class="comment"> * If a $user object is submitted it's 'preference' property is used for the preferences cache.</span>
<a name="l1923"><span class="linenum">1923</span></a>  <span class="comment"> *</span>
<a name="l1924"><span class="linenum">1924</span></a>  <span class="comment"> * @package  core</span>
<a name="l1925"><span class="linenum">1925</span></a>  <span class="comment"> * @category preference</span>
<a name="l1926"><span class="linenum">1926</span></a>  <span class="comment"> * @access   public</span>
<a name="l1927"><span class="linenum">1927</span></a>  <span class="comment"> * @param    string            $name The key to unset as preference for the specified user</span>
<a name="l1928"><span class="linenum">1928</span></a>  <span class="comment"> * @param    stdClass|int|null $user A moodle user object or id, null means current user</span>
<a name="l1929"><span class="linenum">1929</span></a>  <span class="comment"> * @throws   coding_exception</span>
<a name="l1930"><span class="linenum">1930</span></a>  <span class="comment"> * @return   bool                    Always true or exception</span>
<a name="l1931"><span class="linenum">1931</span></a>  <span class="comment"> */</span>
<a name="l1932"><span class="linenum">1932</span></a>  function <a class="function" onClick="logFunction('unset_user_preference')" href="../_functions/unset_user_preference.html" onMouseOver="funcPopup(event,'unset_user_preference')">unset_user_preference</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = null) {
<a name="l1933"><span class="linenum">1933</span></a>      global <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l1934"><span class="linenum">1934</span></a>  
<a name="l1935"><span class="linenum">1935</span></a>      if (empty(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>) or <a class="phpfunction" onClick="logFunction('is_numeric')" href="../_functions/is_numeric.html" onMouseOver="phpfuncPopup(event,'is_numeric')">is_numeric</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>) or <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a> === '_lastloaded') {
<a name="l1936"><span class="linenum">1936</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Invalid preference name in <a class="function" onClick="logFunction('unset_user_preference')" href="../_functions/unset_user_preference.html" onMouseOver="funcPopup(event,'unset_user_preference')">unset_user_preference</a>() call');
<a name="l1937"><span class="linenum">1937</span></a>      }
<a name="l1938"><span class="linenum">1938</span></a>  
<a name="l1939"><span class="linenum">1939</span></a>      if (<a class="phpfunction" onClick="logFunction('is_null')" href="../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l1940"><span class="linenum">1940</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>;
<a name="l1941"><span class="linenum">1941</span></a>      } else if (isset(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)) {
<a name="l1942"><span class="linenum">1942</span></a>  <span class="comment">        // It is a valid object.</span>
<a name="l1943"><span class="linenum">1943</span></a>      } else if (<a class="phpfunction" onClick="logFunction('is_numeric')" href="../_functions/is_numeric.html" onMouseOver="phpfuncPopup(event,'is_numeric')">is_numeric</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l1944"><span class="linenum">1944</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = (object)array('id' =&gt; (int)<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l1945"><span class="linenum">1945</span></a>      } else {
<a name="l1946"><span class="linenum">1946</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Invalid <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> parameter in <a class="function" onClick="logFunction('unset_user_preference')" href="../_functions/unset_user_preference.html" onMouseOver="funcPopup(event,'unset_user_preference')">unset_user_preference</a>() call');
<a name="l1947"><span class="linenum">1947</span></a>      }
<a name="l1948"><span class="linenum">1948</span></a>  
<a name="l1949"><span class="linenum">1949</span></a>      <a class="function" onClick="logFunction('check_user_preferences_loaded')" href="../_functions/check_user_preferences_loaded.html" onMouseOver="funcPopup(event,'check_user_preferences_loaded')">check_user_preferences_loaded</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l1950"><span class="linenum">1950</span></a>  
<a name="l1951"><span class="linenum">1951</span></a>      if (empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>) or <a class="function" onClick="logFunction('isguestuser')" href="../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)) {
<a name="l1952"><span class="linenum">1952</span></a>  <span class="comment">        // No permanent storage for not-logged-in user and guest.</span>
<a name="l1953"><span class="linenum">1953</span></a>          unset(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('preference')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/preference.html">preference</a>[<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>]);
<a name="l1954"><span class="linenum">1954</span></a>          return true;
<a name="l1955"><span class="linenum">1955</span></a>      }
<a name="l1956"><span class="linenum">1956</span></a>  
<a name="l1957"><span class="linenum">1957</span></a>  <span class="comment">    // Delete from DB.</span>
<a name="l1958"><span class="linenum">1958</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('user_preferences', array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, 'name' =&gt; <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>));
<a name="l1959"><span class="linenum">1959</span></a>  
<a name="l1960"><span class="linenum">1960</span></a>  <span class="comment">    // Delete the preference from cache.</span>
<a name="l1961"><span class="linenum">1961</span></a>      unset(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('preference')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/preference.html">preference</a>[<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>]);
<a name="l1962"><span class="linenum">1962</span></a>  
<a name="l1963"><span class="linenum">1963</span></a>  <span class="comment">    // Set reload flag for other sessions.</span>
<a name="l1964"><span class="linenum">1964</span></a>      <a class="function" onClick="logFunction('mark_user_preferences_changed')" href="../_functions/mark_user_preferences_changed.html" onMouseOver="funcPopup(event,'mark_user_preferences_changed')">mark_user_preferences_changed</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l1965"><span class="linenum">1965</span></a>  
<a name="l1966"><span class="linenum">1966</span></a>      return true;
<a name="l1967"><span class="linenum">1967</span></a>  }
<a name="l1968"><span class="linenum">1968</span></a>  
<a name="l1969"><span class="linenum">1969</span></a>  <span class="comment">/**</span>
<a name="l1970"><span class="linenum">1970</span></a>  <span class="comment"> * Used to fetch user preference(s)</span>
<a name="l1971"><span class="linenum">1971</span></a>  <span class="comment"> *</span>
<a name="l1972"><span class="linenum">1972</span></a>  <span class="comment"> * If no arguments are supplied this function will return</span>
<a name="l1973"><span class="linenum">1973</span></a>  <span class="comment"> * all of the current user preferences as an array.</span>
<a name="l1974"><span class="linenum">1974</span></a>  <span class="comment"> *</span>
<a name="l1975"><span class="linenum">1975</span></a>  <span class="comment"> * If a name is specified then this function</span>
<a name="l1976"><span class="linenum">1976</span></a>  <span class="comment"> * attempts to return that particular preference value.  If</span>
<a name="l1977"><span class="linenum">1977</span></a>  <span class="comment"> * none is found, then the optional value $default is returned,</span>
<a name="l1978"><span class="linenum">1978</span></a>  <span class="comment"> * otherwise null.</span>
<a name="l1979"><span class="linenum">1979</span></a>  <span class="comment"> *</span>
<a name="l1980"><span class="linenum">1980</span></a>  <span class="comment"> * If a $user object is submitted it's 'preference' property is used for the preferences cache.</span>
<a name="l1981"><span class="linenum">1981</span></a>  <span class="comment"> *</span>
<a name="l1982"><span class="linenum">1982</span></a>  <span class="comment"> * @package  core</span>
<a name="l1983"><span class="linenum">1983</span></a>  <span class="comment"> * @category preference</span>
<a name="l1984"><span class="linenum">1984</span></a>  <span class="comment"> * @access   public</span>
<a name="l1985"><span class="linenum">1985</span></a>  <span class="comment"> * @param    string            $name    Name of the key to use in finding a preference value</span>
<a name="l1986"><span class="linenum">1986</span></a>  <span class="comment"> * @param    mixed|null        $default Value to be returned if the $name key is not set in the user preferences</span>
<a name="l1987"><span class="linenum">1987</span></a>  <span class="comment"> * @param    stdClass|int|null $user    A moodle user object or id, null means current user</span>
<a name="l1988"><span class="linenum">1988</span></a>  <span class="comment"> * @throws   coding_exception</span>
<a name="l1989"><span class="linenum">1989</span></a>  <span class="comment"> * @return   string|mixed|null          A string containing the value of a single preference. An</span>
<a name="l1990"><span class="linenum">1990</span></a>  <span class="comment"> *                                      array with all of the preferences or null</span>
<a name="l1991"><span class="linenum">1991</span></a>  <span class="comment"> */</span>
<a name="l1992"><span class="linenum">1992</span></a>  function <a class="function" onClick="logFunction('get_user_preferences')" href="../_functions/get_user_preferences.html" onMouseOver="funcPopup(event,'get_user_preferences')">get_user_preferences</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a> = null, <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a> = null, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = null) {
<a name="l1993"><span class="linenum">1993</span></a>      global <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>;
<a name="l1994"><span class="linenum">1994</span></a>  
<a name="l1995"><span class="linenum">1995</span></a>      if (<a class="phpfunction" onClick="logFunction('is_null')" href="../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>)) {
<a name="l1996"><span class="linenum">1996</span></a>  <span class="comment">        // All prefs.</span>
<a name="l1997"><span class="linenum">1997</span></a>      } else if (<a class="phpfunction" onClick="logFunction('is_numeric')" href="../_functions/is_numeric.html" onMouseOver="phpfuncPopup(event,'is_numeric')">is_numeric</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>) or <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a> === '_lastloaded') {
<a name="l1998"><span class="linenum">1998</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Invalid preference name in <a class="function" onClick="logFunction('get_user_preferences')" href="../_functions/get_user_preferences.html" onMouseOver="funcPopup(event,'get_user_preferences')">get_user_preferences</a>() call');
<a name="l1999"><span class="linenum">1999</span></a>      }
<a name="l2000"><span class="linenum">2000</span></a>  
<a name="l2001"><span class="linenum">2001</span></a>      if (<a class="phpfunction" onClick="logFunction('is_null')" href="../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l2002"><span class="linenum">2002</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>;
<a name="l2003"><span class="linenum">2003</span></a>      } else if (isset(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)) {
<a name="l2004"><span class="linenum">2004</span></a>  <span class="comment">        // Is a valid object.</span>
<a name="l2005"><span class="linenum">2005</span></a>      } else if (<a class="phpfunction" onClick="logFunction('is_numeric')" href="../_functions/is_numeric.html" onMouseOver="phpfuncPopup(event,'is_numeric')">is_numeric</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l2006"><span class="linenum">2006</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = (object)array('id' =&gt; (int)<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l2007"><span class="linenum">2007</span></a>      } else {
<a name="l2008"><span class="linenum">2008</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Invalid <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> parameter in <a class="function" onClick="logFunction('get_user_preferences')" href="../_functions/get_user_preferences.html" onMouseOver="funcPopup(event,'get_user_preferences')">get_user_preferences</a>() call');
<a name="l2009"><span class="linenum">2009</span></a>      }
<a name="l2010"><span class="linenum">2010</span></a>  
<a name="l2011"><span class="linenum">2011</span></a>      <a class="function" onClick="logFunction('check_user_preferences_loaded')" href="../_functions/check_user_preferences_loaded.html" onMouseOver="funcPopup(event,'check_user_preferences_loaded')">check_user_preferences_loaded</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l2012"><span class="linenum">2012</span></a>  
<a name="l2013"><span class="linenum">2013</span></a>      if (empty(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>)) {
<a name="l2014"><span class="linenum">2014</span></a>  <span class="comment">        // All values.</span>
<a name="l2015"><span class="linenum">2015</span></a>          return <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('preference')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/preference.html">preference</a>;
<a name="l2016"><span class="linenum">2016</span></a>      } else if (isset(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('preference')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/preference.html">preference</a>[<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>])) {
<a name="l2017"><span class="linenum">2017</span></a>  <span class="comment">        // The single string value.</span>
<a name="l2018"><span class="linenum">2018</span></a>          return <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('preference')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/preference.html">preference</a>[<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>];
<a name="l2019"><span class="linenum">2019</span></a>      } else {
<a name="l2020"><span class="linenum">2020</span></a>  <span class="comment">        // Default value (null if not specified).</span>
<a name="l2021"><span class="linenum">2021</span></a>          return <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>;
<a name="l2022"><span class="linenum">2022</span></a>      }
<a name="l2023"><span class="linenum">2023</span></a>  }
<a name="l2024"><span class="linenum">2024</span></a>  
<a name="l2025"><span class="linenum">2025</span></a>  <span class="comment">// FUNCTIONS FOR HANDLING TIME.</span>
<a name="l2026"><span class="linenum">2026</span></a>  
<a name="l2027"><span class="linenum">2027</span></a>  <span class="comment">/**</span>
<a name="l2028"><span class="linenum">2028</span></a>  <span class="comment"> * Given date parts in user time produce a GMT timestamp.</span>
<a name="l2029"><span class="linenum">2029</span></a>  <span class="comment"> *</span>
<a name="l2030"><span class="linenum">2030</span></a>  <span class="comment"> * @package core</span>
<a name="l2031"><span class="linenum">2031</span></a>  <span class="comment"> * @category time</span>
<a name="l2032"><span class="linenum">2032</span></a>  <span class="comment"> * @param int $year The year part to create timestamp of</span>
<a name="l2033"><span class="linenum">2033</span></a>  <span class="comment"> * @param int $month The month part to create timestamp of</span>
<a name="l2034"><span class="linenum">2034</span></a>  <span class="comment"> * @param int $day The day part to create timestamp of</span>
<a name="l2035"><span class="linenum">2035</span></a>  <span class="comment"> * @param int $hour The hour part to create timestamp of</span>
<a name="l2036"><span class="linenum">2036</span></a>  <span class="comment"> * @param int $minute The minute part to create timestamp of</span>
<a name="l2037"><span class="linenum">2037</span></a>  <span class="comment"> * @param int $second The second part to create timestamp of</span>
<a name="l2038"><span class="linenum">2038</span></a>  <span class="comment"> * @param int|float|string $timezone Timezone modifier, used to calculate GMT time offset.</span>
<a name="l2039"><span class="linenum">2039</span></a>  <span class="comment"> *             if 99 then default user's timezone is used {@link http://docs.moodle.org/dev/Time_API#Timezone}</span>
<a name="l2040"><span class="linenum">2040</span></a>  <span class="comment"> * @param bool $applydst Toggle Daylight Saving Time, default true, will be</span>
<a name="l2041"><span class="linenum">2041</span></a>  <span class="comment"> *             applied only if timezone is 99 or string.</span>
<a name="l2042"><span class="linenum">2042</span></a>  <span class="comment"> * @return int GMT timestamp</span>
<a name="l2043"><span class="linenum">2043</span></a>  <span class="comment"> */</span>
<a name="l2044"><span class="linenum">2044</span></a>  function <a class="function" onClick="logFunction('make_timestamp')" href="../_functions/make_timestamp.html" onMouseOver="funcPopup(event,'make_timestamp')">make_timestamp</a>(<a class="var it437" onMouseOver="hilite(437)" onMouseOut="lolite()" onClick="logVariable('year')" href="../_variables/year.html">$year</a>, <a class="var it438" onMouseOver="hilite(438)" onMouseOut="lolite()" onClick="logVariable('month')" href="../_variables/month.html">$month</a>=1, <a class="var it434" onMouseOver="hilite(434)" onMouseOut="lolite()" onClick="logVariable('day')" href="../_variables/day.html">$day</a>=1, <a class="var it1278" onMouseOver="hilite(1278)" onMouseOut="lolite()" onClick="logVariable('hour')" href="../_variables/hour.html">$hour</a>=0, <a class="var it1279" onMouseOver="hilite(1279)" onMouseOut="lolite()" onClick="logVariable('minute')" href="../_variables/minute.html">$minute</a>=0, <a class="var it1280" onMouseOver="hilite(1280)" onMouseOut="lolite()" onClick="logVariable('second')" href="../_variables/second.html">$second</a>=0, <a class="var it1030" onMouseOver="hilite(1030)" onMouseOut="lolite()" onClick="logVariable('timezone')" href="../_variables/timezone.html">$timezone</a>=99, <a class="var it12916" onMouseOver="hilite(12916)" onMouseOut="lolite()" onClick="logVariable('applydst')" href="../_variables/applydst.html">$applydst</a>=true) {
<a name="l2045"><span class="linenum">2045</span></a>      <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('date')" href="../_variables/date.html">$date</a> = new DateTime('now', <a class="class" onClick="logClass('core_date')" href="../_classes/core_date.html" onMouseOver="classPopup(event,'core_date')">core_date</a>::<a class="function" onClick="logFunction('get_user_timezone_object')" href="../_functions/get_user_timezone_object.html" onMouseOver="funcPopup(event,'get_user_timezone_object')">get_user_timezone_object</a>(<a class="var it1030" onMouseOver="hilite(1030)" onMouseOut="lolite()" onClick="logVariable('timezone')" href="../_variables/timezone.html">$timezone</a>));
<a name="l2046"><span class="linenum">2046</span></a>      <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('date')" href="../_variables/date.html">$date</a>-&gt;<a class="function" onClick="logFunction('setDate')" href="../_functions/setdate.html" onMouseOver="funcPopup(event,'setdate')">setDate</a>((int)<a class="var it437" onMouseOver="hilite(437)" onMouseOut="lolite()" onClick="logVariable('year')" href="../_variables/year.html">$year</a>, (int)<a class="var it438" onMouseOver="hilite(438)" onMouseOut="lolite()" onClick="logVariable('month')" href="../_variables/month.html">$month</a>, (int)<a class="var it434" onMouseOver="hilite(434)" onMouseOut="lolite()" onClick="logVariable('day')" href="../_variables/day.html">$day</a>);
<a name="l2047"><span class="linenum">2047</span></a>      <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('date')" href="../_variables/date.html">$date</a>-&gt;<a class="function" onClick="logFunction('setTime')" href="../_functions/settime.html" onMouseOver="funcPopup(event,'settime')">setTime</a>((int)<a class="var it1278" onMouseOver="hilite(1278)" onMouseOut="lolite()" onClick="logVariable('hour')" href="../_variables/hour.html">$hour</a>, (int)<a class="var it1279" onMouseOver="hilite(1279)" onMouseOut="lolite()" onClick="logVariable('minute')" href="../_variables/minute.html">$minute</a>, (int)<a class="var it1280" onMouseOver="hilite(1280)" onMouseOut="lolite()" onClick="logVariable('second')" href="../_variables/second.html">$second</a>);
<a name="l2048"><span class="linenum">2048</span></a>  
<a name="l2049"><span class="linenum">2049</span></a>      <a class="var it25" onMouseOver="hilite(25)" onMouseOut="lolite()" onClick="logVariable('time')" href="../_variables/time.html">$time</a> = <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('date')" href="../_variables/date.html">$date</a>-&gt;<a class="function" onClick="logFunction('getTimestamp')" href="../_functions/gettimestamp.html" onMouseOver="funcPopup(event,'gettimestamp')">getTimestamp</a>();
<a name="l2050"><span class="linenum">2050</span></a>  
<a name="l2051"><span class="linenum">2051</span></a>  <span class="comment">    // Moodle BC DST stuff.</span>
<a name="l2052"><span class="linenum">2052</span></a>      if (!<a class="var it12916" onMouseOver="hilite(12916)" onMouseOut="lolite()" onClick="logVariable('applydst')" href="../_variables/applydst.html">$applydst</a>) {
<a name="l2053"><span class="linenum">2053</span></a>          <a class="var it25" onMouseOver="hilite(25)" onMouseOut="lolite()" onClick="logVariable('time')" href="../_variables/time.html">$time</a> += <a class="function" onClick="logFunction('dst_offset_on')" href="../_functions/dst_offset_on.html" onMouseOver="funcPopup(event,'dst_offset_on')">dst_offset_on</a>(<a class="var it25" onMouseOver="hilite(25)" onMouseOut="lolite()" onClick="logVariable('time')" href="../_variables/time.html">$time</a>, <a class="var it1030" onMouseOver="hilite(1030)" onMouseOut="lolite()" onClick="logVariable('timezone')" href="../_variables/timezone.html">$timezone</a>);
<a name="l2054"><span class="linenum">2054</span></a>      }
<a name="l2055"><span class="linenum">2055</span></a>  
<a name="l2056"><span class="linenum">2056</span></a>      return <a class="var it25" onMouseOver="hilite(25)" onMouseOut="lolite()" onClick="logVariable('time')" href="../_variables/time.html">$time</a>;
<a name="l2057"><span class="linenum">2057</span></a>  
<a name="l2058"><span class="linenum">2058</span></a>  }
<a name="l2059"><span class="linenum">2059</span></a>  
<a name="l2060"><span class="linenum">2060</span></a>  <span class="comment">/**</span>
<a name="l2061"><span class="linenum">2061</span></a>  <span class="comment"> * Format a date/time (seconds) as weeks, days, hours etc as needed</span>
<a name="l2062"><span class="linenum">2062</span></a>  <span class="comment"> *</span>
<a name="l2063"><span class="linenum">2063</span></a>  <span class="comment"> * Given an amount of time in seconds, returns string</span>
<a name="l2064"><span class="linenum">2064</span></a>  <span class="comment"> * formatted nicely as weeks, days, hours etc as needed</span>
<a name="l2065"><span class="linenum">2065</span></a>  <span class="comment"> *</span>
<a name="l2066"><span class="linenum">2066</span></a>  <span class="comment"> * @package core</span>
<a name="l2067"><span class="linenum">2067</span></a>  <span class="comment"> * @category time</span>
<a name="l2068"><span class="linenum">2068</span></a>  <span class="comment"> * @uses MINSECS</span>
<a name="l2069"><span class="linenum">2069</span></a>  <span class="comment"> * @uses HOURSECS</span>
<a name="l2070"><span class="linenum">2070</span></a>  <span class="comment"> * @uses DAYSECS</span>
<a name="l2071"><span class="linenum">2071</span></a>  <span class="comment"> * @uses YEARSECS</span>
<a name="l2072"><span class="linenum">2072</span></a>  <span class="comment"> * @param int $totalsecs Time in seconds</span>
<a name="l2073"><span class="linenum">2073</span></a>  <span class="comment"> * @param stdClass $str Should be a time object</span>
<a name="l2074"><span class="linenum">2074</span></a>  <span class="comment"> * @return string A nicely formatted date/time string</span>
<a name="l2075"><span class="linenum">2075</span></a>  <span class="comment"> */</span>
<a name="l2076"><span class="linenum">2076</span></a>  function <a class="function" onClick="logFunction('format_time')" href="../_functions/format_time.html" onMouseOver="funcPopup(event,'format_time')">format_time</a>(<a class="var it12917" onMouseOver="hilite(12917)" onMouseOut="lolite()" onClick="logVariable('totalsecs')" href="../_variables/totalsecs.html">$totalsecs</a>, <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a> = null) {
<a name="l2077"><span class="linenum">2077</span></a>  
<a name="l2078"><span class="linenum">2078</span></a>      <a class="var it12917" onMouseOver="hilite(12917)" onMouseOut="lolite()" onClick="logVariable('totalsecs')" href="../_variables/totalsecs.html">$totalsecs</a> = <a class="phpfunction" onClick="logFunction('abs')" href="../_functions/abs.html" onMouseOver="phpfuncPopup(event,'abs')">abs</a>(<a class="var it12917" onMouseOver="hilite(12917)" onMouseOut="lolite()" onClick="logVariable('totalsecs')" href="../_variables/totalsecs.html">$totalsecs</a>);
<a name="l2079"><span class="linenum">2079</span></a>  
<a name="l2080"><span class="linenum">2080</span></a>      if (!<a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>) {
<a name="l2081"><span class="linenum">2081</span></a>  <span class="comment">        // Create the str structure the slow way.</span>
<a name="l2082"><span class="linenum">2082</span></a>          <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a> = new stdClass();
<a name="l2083"><span class="linenum">2083</span></a>          <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>-&gt;<a onClick="logVariable('day')" class="var it40152" onMouseOver="hilite(40152)" onMouseOut="lolite()" href="../_variables/day.html">day</a>   = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('day');
<a name="l2084"><span class="linenum">2084</span></a>          <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>-&gt;<a onClick="logVariable('days')" class="var it40152" onMouseOver="hilite(40152)" onMouseOut="lolite()" href="../_variables/days.html">days</a>  = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('days');
<a name="l2085"><span class="linenum">2085</span></a>          <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>-&gt;<a onClick="logVariable('hour')" class="var it40152" onMouseOver="hilite(40152)" onMouseOut="lolite()" href="../_variables/hour.html">hour</a>  = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('hour');
<a name="l2086"><span class="linenum">2086</span></a>          <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>-&gt;<a onClick="logVariable('hours')" class="var it40152" onMouseOver="hilite(40152)" onMouseOut="lolite()" href="../_variables/hours.html">hours</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('hours');
<a name="l2087"><span class="linenum">2087</span></a>          <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>-&gt;<a onClick="logVariable('min')" class="var it40152" onMouseOver="hilite(40152)" onMouseOut="lolite()" href="../_variables/min.html">min</a>   = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('min');
<a name="l2088"><span class="linenum">2088</span></a>          <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>-&gt;<a onClick="logVariable('mins')" class="var it40152" onMouseOver="hilite(40152)" onMouseOut="lolite()" href="../_variables/mins.html">mins</a>  = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('mins');
<a name="l2089"><span class="linenum">2089</span></a>          <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>-&gt;<a onClick="logVariable('sec')" class="var it40152" onMouseOver="hilite(40152)" onMouseOut="lolite()" href="../_variables/sec.html">sec</a>   = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('sec');
<a name="l2090"><span class="linenum">2090</span></a>          <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>-&gt;<a onClick="logVariable('secs')" class="var it40152" onMouseOver="hilite(40152)" onMouseOut="lolite()" href="../_variables/secs.html">secs</a>  = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('secs');
<a name="l2091"><span class="linenum">2091</span></a>          <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>-&gt;<a onClick="logVariable('year')" class="var it40152" onMouseOver="hilite(40152)" onMouseOut="lolite()" href="../_variables/year.html">year</a>  = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('year');
<a name="l2092"><span class="linenum">2092</span></a>          <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>-&gt;<a onClick="logVariable('years')" class="var it40152" onMouseOver="hilite(40152)" onMouseOut="lolite()" href="../_variables/years.html">years</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('years');
<a name="l2093"><span class="linenum">2093</span></a>      }
<a name="l2094"><span class="linenum">2094</span></a>  
<a name="l2095"><span class="linenum">2095</span></a>      <a class="var it423" onMouseOver="hilite(423)" onMouseOut="lolite()" onClick="logVariable('years')" href="../_variables/years.html">$years</a>     = <a class="phpfunction" onClick="logFunction('floor')" href="../_functions/floor.html" onMouseOver="phpfuncPopup(event,'floor')">floor</a>(<a class="var it12917" onMouseOver="hilite(12917)" onMouseOut="lolite()" onClick="logVariable('totalsecs')" href="../_variables/totalsecs.html">$totalsecs</a>/<a class="constant" onClick="logConstant('YEARSECS')" href="../_constants/YEARSECS.html" onMouseOver="constPopup(event,'YEARSECS')">YEARSECS</a>);
<a name="l2096"><span class="linenum">2096</span></a>      <a class="var it12918" onMouseOver="hilite(12918)" onMouseOut="lolite()" onClick="logVariable('remainder')" href="../_variables/remainder.html">$remainder</a> = <a class="var it12917" onMouseOver="hilite(12917)" onMouseOut="lolite()" onClick="logVariable('totalsecs')" href="../_variables/totalsecs.html">$totalsecs</a> - (<a class="var it423" onMouseOver="hilite(423)" onMouseOut="lolite()" onClick="logVariable('years')" href="../_variables/years.html">$years</a>*<a class="constant" onClick="logConstant('YEARSECS')" href="../_constants/YEARSECS.html" onMouseOver="constPopup(event,'YEARSECS')">YEARSECS</a>);
<a name="l2097"><span class="linenum">2097</span></a>      <a class="var it363" onMouseOver="hilite(363)" onMouseOut="lolite()" onClick="logVariable('days')" href="../_variables/days.html">$days</a>      = <a class="phpfunction" onClick="logFunction('floor')" href="../_functions/floor.html" onMouseOver="phpfuncPopup(event,'floor')">floor</a>(<a class="var it12918" onMouseOver="hilite(12918)" onMouseOut="lolite()" onClick="logVariable('remainder')" href="../_variables/remainder.html">$remainder</a>/<a class="constant" onClick="logConstant('DAYSECS')" href="../_constants/DAYSECS.html" onMouseOver="constPopup(event,'DAYSECS')">DAYSECS</a>);
<a name="l2098"><span class="linenum">2098</span></a>      <a class="var it12918" onMouseOver="hilite(12918)" onMouseOut="lolite()" onClick="logVariable('remainder')" href="../_variables/remainder.html">$remainder</a> = <a class="var it12917" onMouseOver="hilite(12917)" onMouseOut="lolite()" onClick="logVariable('totalsecs')" href="../_variables/totalsecs.html">$totalsecs</a> - (<a class="var it363" onMouseOver="hilite(363)" onMouseOut="lolite()" onClick="logVariable('days')" href="../_variables/days.html">$days</a>*<a class="constant" onClick="logConstant('DAYSECS')" href="../_constants/DAYSECS.html" onMouseOver="constPopup(event,'DAYSECS')">DAYSECS</a>);
<a name="l2099"><span class="linenum">2099</span></a>      <a class="var it1307" onMouseOver="hilite(1307)" onMouseOut="lolite()" onClick="logVariable('hours')" href="../_variables/hours.html">$hours</a>     = <a class="phpfunction" onClick="logFunction('floor')" href="../_functions/floor.html" onMouseOver="phpfuncPopup(event,'floor')">floor</a>(<a class="var it12918" onMouseOver="hilite(12918)" onMouseOut="lolite()" onClick="logVariable('remainder')" href="../_variables/remainder.html">$remainder</a>/<a class="constant" onClick="logConstant('HOURSECS')" href="../_constants/HOURSECS.html" onMouseOver="constPopup(event,'HOURSECS')">HOURSECS</a>);
<a name="l2100"><span class="linenum">2100</span></a>      <a class="var it12918" onMouseOver="hilite(12918)" onMouseOut="lolite()" onClick="logVariable('remainder')" href="../_variables/remainder.html">$remainder</a> = <a class="var it12918" onMouseOver="hilite(12918)" onMouseOut="lolite()" onClick="logVariable('remainder')" href="../_variables/remainder.html">$remainder</a> - (<a class="var it1307" onMouseOver="hilite(1307)" onMouseOut="lolite()" onClick="logVariable('hours')" href="../_variables/hours.html">$hours</a>*<a class="constant" onClick="logConstant('HOURSECS')" href="../_constants/HOURSECS.html" onMouseOver="constPopup(event,'HOURSECS')">HOURSECS</a>);
<a name="l2101"><span class="linenum">2101</span></a>      <a class="var it6341" onMouseOver="hilite(6341)" onMouseOut="lolite()" onClick="logVariable('mins')" href="../_variables/mins.html">$mins</a>      = <a class="phpfunction" onClick="logFunction('floor')" href="../_functions/floor.html" onMouseOver="phpfuncPopup(event,'floor')">floor</a>(<a class="var it12918" onMouseOver="hilite(12918)" onMouseOut="lolite()" onClick="logVariable('remainder')" href="../_variables/remainder.html">$remainder</a>/<a class="constant" onClick="logConstant('MINSECS')" href="../_constants/MINSECS.html" onMouseOver="constPopup(event,'MINSECS')">MINSECS</a>);
<a name="l2102"><span class="linenum">2102</span></a>      <a class="var it6340" onMouseOver="hilite(6340)" onMouseOut="lolite()" onClick="logVariable('secs')" href="../_variables/secs.html">$secs</a>      = <a class="var it12918" onMouseOver="hilite(12918)" onMouseOut="lolite()" onClick="logVariable('remainder')" href="../_variables/remainder.html">$remainder</a> - (<a class="var it6341" onMouseOver="hilite(6341)" onMouseOut="lolite()" onClick="logVariable('mins')" href="../_variables/mins.html">$mins</a>*<a class="constant" onClick="logConstant('MINSECS')" href="../_constants/MINSECS.html" onMouseOver="constPopup(event,'MINSECS')">MINSECS</a>);
<a name="l2103"><span class="linenum">2103</span></a>  
<a name="l2104"><span class="linenum">2104</span></a>      <a class="var it6357" onMouseOver="hilite(6357)" onMouseOut="lolite()" onClick="logVariable('ss')" href="../_variables/ss.html">$ss</a> = (<a class="var it6340" onMouseOver="hilite(6340)" onMouseOut="lolite()" onClick="logVariable('secs')" href="../_variables/secs.html">$secs</a> == 1)  ? <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>-&gt;<a onClick="logVariable('sec')" class="var it40152" onMouseOver="hilite(40152)" onMouseOut="lolite()" href="../_variables/sec.html">sec</a>  : <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>-&gt;<a onClick="logVariable('secs')" class="var it40152" onMouseOver="hilite(40152)" onMouseOut="lolite()" href="../_variables/secs.html">secs</a>;
<a name="l2105"><span class="linenum">2105</span></a>      <a class="var it10801" onMouseOver="hilite(10801)" onMouseOut="lolite()" onClick="logVariable('sm')" href="../_variables/sm.html">$sm</a> = (<a class="var it6341" onMouseOver="hilite(6341)" onMouseOut="lolite()" onClick="logVariable('mins')" href="../_variables/mins.html">$mins</a> == 1)  ? <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>-&gt;<a onClick="logVariable('min')" class="var it40152" onMouseOver="hilite(40152)" onMouseOut="lolite()" href="../_variables/min.html">min</a>  : <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>-&gt;<a onClick="logVariable('mins')" class="var it40152" onMouseOver="hilite(40152)" onMouseOut="lolite()" href="../_variables/mins.html">mins</a>;
<a name="l2106"><span class="linenum">2106</span></a>      <a class="var it12919" onMouseOver="hilite(12919)" onMouseOut="lolite()" onClick="logVariable('sh')" href="../_variables/sh.html">$sh</a> = (<a class="var it1307" onMouseOver="hilite(1307)" onMouseOut="lolite()" onClick="logVariable('hours')" href="../_variables/hours.html">$hours</a> == 1) ? <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>-&gt;<a onClick="logVariable('hour')" class="var it40152" onMouseOver="hilite(40152)" onMouseOut="lolite()" href="../_variables/hour.html">hour</a> : <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>-&gt;<a onClick="logVariable('hours')" class="var it40152" onMouseOver="hilite(40152)" onMouseOut="lolite()" href="../_variables/hours.html">hours</a>;
<a name="l2107"><span class="linenum">2107</span></a>      <a class="var it12920" onMouseOver="hilite(12920)" onMouseOut="lolite()" onClick="logVariable('sd')" href="../_variables/sd.html">$sd</a> = (<a class="var it363" onMouseOver="hilite(363)" onMouseOut="lolite()" onClick="logVariable('days')" href="../_variables/days.html">$days</a> == 1)  ? <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>-&gt;<a onClick="logVariable('day')" class="var it40152" onMouseOver="hilite(40152)" onMouseOut="lolite()" href="../_variables/day.html">day</a>  : <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>-&gt;<a onClick="logVariable('days')" class="var it40152" onMouseOver="hilite(40152)" onMouseOut="lolite()" href="../_variables/days.html">days</a>;
<a name="l2108"><span class="linenum">2108</span></a>      <a class="var it12921" onMouseOver="hilite(12921)" onMouseOut="lolite()" onClick="logVariable('sy')" href="../_variables/sy.html">$sy</a> = (<a class="var it423" onMouseOver="hilite(423)" onMouseOut="lolite()" onClick="logVariable('years')" href="../_variables/years.html">$years</a> == 1)  ? <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>-&gt;<a onClick="logVariable('year')" class="var it40152" onMouseOver="hilite(40152)" onMouseOut="lolite()" href="../_variables/year.html">year</a>  : <a class="var it332" onMouseOver="hilite(332)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>-&gt;<a onClick="logVariable('years')" class="var it40152" onMouseOver="hilite(40152)" onMouseOut="lolite()" href="../_variables/years.html">years</a>;
<a name="l2109"><span class="linenum">2109</span></a>  
<a name="l2110"><span class="linenum">2110</span></a>      <a class="var it12922" onMouseOver="hilite(12922)" onMouseOut="lolite()" onClick="logVariable('oyears')" href="../_variables/oyears.html">$oyears</a> = '';
<a name="l2111"><span class="linenum">2111</span></a>      <a class="var it12923" onMouseOver="hilite(12923)" onMouseOut="lolite()" onClick="logVariable('odays')" href="../_variables/odays.html">$odays</a> = '';
<a name="l2112"><span class="linenum">2112</span></a>      <a class="var it12924" onMouseOver="hilite(12924)" onMouseOut="lolite()" onClick="logVariable('ohours')" href="../_variables/ohours.html">$ohours</a> = '';
<a name="l2113"><span class="linenum">2113</span></a>      <a class="var it12925" onMouseOver="hilite(12925)" onMouseOut="lolite()" onClick="logVariable('omins')" href="../_variables/omins.html">$omins</a> = '';
<a name="l2114"><span class="linenum">2114</span></a>      <a class="var it12926" onMouseOver="hilite(12926)" onMouseOut="lolite()" onClick="logVariable('osecs')" href="../_variables/osecs.html">$osecs</a> = '';
<a name="l2115"><span class="linenum">2115</span></a>  
<a name="l2116"><span class="linenum">2116</span></a>      if (<a class="var it423" onMouseOver="hilite(423)" onMouseOut="lolite()" onClick="logVariable('years')" href="../_variables/years.html">$years</a>) {
<a name="l2117"><span class="linenum">2117</span></a>          <a class="var it12922" onMouseOver="hilite(12922)" onMouseOut="lolite()" onClick="logVariable('oyears')" href="../_variables/oyears.html">$oyears</a>  = <a class="var it423" onMouseOver="hilite(423)" onMouseOut="lolite()" onClick="logVariable('years')" href="../_variables/years.html">$years</a> .' '. <a class="var it12921" onMouseOver="hilite(12921)" onMouseOut="lolite()" onClick="logVariable('sy')" href="../_variables/sy.html">$sy</a>;
<a name="l2118"><span class="linenum">2118</span></a>      }
<a name="l2119"><span class="linenum">2119</span></a>      if (<a class="var it363" onMouseOver="hilite(363)" onMouseOut="lolite()" onClick="logVariable('days')" href="../_variables/days.html">$days</a>) {
<a name="l2120"><span class="linenum">2120</span></a>          <a class="var it12923" onMouseOver="hilite(12923)" onMouseOut="lolite()" onClick="logVariable('odays')" href="../_variables/odays.html">$odays</a>  = <a class="var it363" onMouseOver="hilite(363)" onMouseOut="lolite()" onClick="logVariable('days')" href="../_variables/days.html">$days</a> .' '. <a class="var it12920" onMouseOver="hilite(12920)" onMouseOut="lolite()" onClick="logVariable('sd')" href="../_variables/sd.html">$sd</a>;
<a name="l2121"><span class="linenum">2121</span></a>      }
<a name="l2122"><span class="linenum">2122</span></a>      if (<a class="var it1307" onMouseOver="hilite(1307)" onMouseOut="lolite()" onClick="logVariable('hours')" href="../_variables/hours.html">$hours</a>) {
<a name="l2123"><span class="linenum">2123</span></a>          <a class="var it12924" onMouseOver="hilite(12924)" onMouseOut="lolite()" onClick="logVariable('ohours')" href="../_variables/ohours.html">$ohours</a> = <a class="var it1307" onMouseOver="hilite(1307)" onMouseOut="lolite()" onClick="logVariable('hours')" href="../_variables/hours.html">$hours</a> .' '. <a class="var it12919" onMouseOver="hilite(12919)" onMouseOut="lolite()" onClick="logVariable('sh')" href="../_variables/sh.html">$sh</a>;
<a name="l2124"><span class="linenum">2124</span></a>      }
<a name="l2125"><span class="linenum">2125</span></a>      if (<a class="var it6341" onMouseOver="hilite(6341)" onMouseOut="lolite()" onClick="logVariable('mins')" href="../_variables/mins.html">$mins</a>) {
<a name="l2126"><span class="linenum">2126</span></a>          <a class="var it12925" onMouseOver="hilite(12925)" onMouseOut="lolite()" onClick="logVariable('omins')" href="../_variables/omins.html">$omins</a>  = <a class="var it6341" onMouseOver="hilite(6341)" onMouseOut="lolite()" onClick="logVariable('mins')" href="../_variables/mins.html">$mins</a> .' '. <a class="var it10801" onMouseOver="hilite(10801)" onMouseOut="lolite()" onClick="logVariable('sm')" href="../_variables/sm.html">$sm</a>;
<a name="l2127"><span class="linenum">2127</span></a>      }
<a name="l2128"><span class="linenum">2128</span></a>      if (<a class="var it6340" onMouseOver="hilite(6340)" onMouseOut="lolite()" onClick="logVariable('secs')" href="../_variables/secs.html">$secs</a>) {
<a name="l2129"><span class="linenum">2129</span></a>          <a class="var it12926" onMouseOver="hilite(12926)" onMouseOut="lolite()" onClick="logVariable('osecs')" href="../_variables/osecs.html">$osecs</a>  = <a class="var it6340" onMouseOver="hilite(6340)" onMouseOut="lolite()" onClick="logVariable('secs')" href="../_variables/secs.html">$secs</a> .' '. <a class="var it6357" onMouseOver="hilite(6357)" onMouseOut="lolite()" onClick="logVariable('ss')" href="../_variables/ss.html">$ss</a>;
<a name="l2130"><span class="linenum">2130</span></a>      }
<a name="l2131"><span class="linenum">2131</span></a>  
<a name="l2132"><span class="linenum">2132</span></a>      if (<a class="var it423" onMouseOver="hilite(423)" onMouseOut="lolite()" onClick="logVariable('years')" href="../_variables/years.html">$years</a>) {
<a name="l2133"><span class="linenum">2133</span></a>          return <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it12922" onMouseOver="hilite(12922)" onMouseOut="lolite()" onClick="logVariable('oyears')" href="../_variables/oyears.html">$oyears</a> .' '. <a class="var it12923" onMouseOver="hilite(12923)" onMouseOut="lolite()" onClick="logVariable('odays')" href="../_variables/odays.html">$odays</a>);
<a name="l2134"><span class="linenum">2134</span></a>      }
<a name="l2135"><span class="linenum">2135</span></a>      if (<a class="var it363" onMouseOver="hilite(363)" onMouseOut="lolite()" onClick="logVariable('days')" href="../_variables/days.html">$days</a>) {
<a name="l2136"><span class="linenum">2136</span></a>          return <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it12923" onMouseOver="hilite(12923)" onMouseOut="lolite()" onClick="logVariable('odays')" href="../_variables/odays.html">$odays</a> .' '. <a class="var it12924" onMouseOver="hilite(12924)" onMouseOut="lolite()" onClick="logVariable('ohours')" href="../_variables/ohours.html">$ohours</a>);
<a name="l2137"><span class="linenum">2137</span></a>      }
<a name="l2138"><span class="linenum">2138</span></a>      if (<a class="var it1307" onMouseOver="hilite(1307)" onMouseOut="lolite()" onClick="logVariable('hours')" href="../_variables/hours.html">$hours</a>) {
<a name="l2139"><span class="linenum">2139</span></a>          return <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it12924" onMouseOver="hilite(12924)" onMouseOut="lolite()" onClick="logVariable('ohours')" href="../_variables/ohours.html">$ohours</a> .' '. <a class="var it12925" onMouseOver="hilite(12925)" onMouseOut="lolite()" onClick="logVariable('omins')" href="../_variables/omins.html">$omins</a>);
<a name="l2140"><span class="linenum">2140</span></a>      }
<a name="l2141"><span class="linenum">2141</span></a>      if (<a class="var it6341" onMouseOver="hilite(6341)" onMouseOut="lolite()" onClick="logVariable('mins')" href="../_variables/mins.html">$mins</a>) {
<a name="l2142"><span class="linenum">2142</span></a>          return <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it12925" onMouseOver="hilite(12925)" onMouseOut="lolite()" onClick="logVariable('omins')" href="../_variables/omins.html">$omins</a> .' '. <a class="var it12926" onMouseOver="hilite(12926)" onMouseOut="lolite()" onClick="logVariable('osecs')" href="../_variables/osecs.html">$osecs</a>);
<a name="l2143"><span class="linenum">2143</span></a>      }
<a name="l2144"><span class="linenum">2144</span></a>      if (<a class="var it6340" onMouseOver="hilite(6340)" onMouseOut="lolite()" onClick="logVariable('secs')" href="../_variables/secs.html">$secs</a>) {
<a name="l2145"><span class="linenum">2145</span></a>          return <a class="var it12926" onMouseOver="hilite(12926)" onMouseOut="lolite()" onClick="logVariable('osecs')" href="../_variables/osecs.html">$osecs</a>;
<a name="l2146"><span class="linenum">2146</span></a>      }
<a name="l2147"><span class="linenum">2147</span></a>      return <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('now');
<a name="l2148"><span class="linenum">2148</span></a>  }
<a name="l2149"><span class="linenum">2149</span></a>  
<a name="l2150"><span class="linenum">2150</span></a>  <span class="comment">/**</span>
<a name="l2151"><span class="linenum">2151</span></a>  <span class="comment"> * Returns a formatted string that represents a date in user time.</span>
<a name="l2152"><span class="linenum">2152</span></a>  <span class="comment"> *</span>
<a name="l2153"><span class="linenum">2153</span></a>  <span class="comment"> * @package core</span>
<a name="l2154"><span class="linenum">2154</span></a>  <span class="comment"> * @category time</span>
<a name="l2155"><span class="linenum">2155</span></a>  <span class="comment"> * @param int $date the timestamp in UTC, as obtained from the database.</span>
<a name="l2156"><span class="linenum">2156</span></a>  <span class="comment"> * @param string $format strftime format. You should probably get this using</span>
<a name="l2157"><span class="linenum">2157</span></a>  <span class="comment"> *        get_string('strftime...', 'langconfig');</span>
<a name="l2158"><span class="linenum">2158</span></a>  <span class="comment"> * @param int|float|string $timezone by default, uses the user's time zone. if numeric and</span>
<a name="l2159"><span class="linenum">2159</span></a>  <span class="comment"> *        not 99 then daylight saving will not be added.</span>
<a name="l2160"><span class="linenum">2160</span></a>  <span class="comment"> *        {@link http://docs.moodle.org/dev/Time_API#Timezone}</span>
<a name="l2161"><span class="linenum">2161</span></a>  <span class="comment"> * @param bool $fixday If true (default) then the leading zero from %d is removed.</span>
<a name="l2162"><span class="linenum">2162</span></a>  <span class="comment"> *        If false then the leading zero is maintained.</span>
<a name="l2163"><span class="linenum">2163</span></a>  <span class="comment"> * @param bool $fixhour If true (default) then the leading zero from %I is removed.</span>
<a name="l2164"><span class="linenum">2164</span></a>  <span class="comment"> * @return string the formatted date/time.</span>
<a name="l2165"><span class="linenum">2165</span></a>  <span class="comment"> */</span>
<a name="l2166"><span class="linenum">2166</span></a>  function <a class="function" onClick="logFunction('userdate')" href="../_functions/userdate.html" onMouseOver="funcPopup(event,'userdate')">userdate</a>(<a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('date')" href="../_variables/date.html">$date</a>, <a class="var it456" onMouseOver="hilite(456)" onMouseOut="lolite()" onClick="logVariable('format')" href="../_variables/format.html">$format</a> = '', <a class="var it1030" onMouseOver="hilite(1030)" onMouseOut="lolite()" onClick="logVariable('timezone')" href="../_variables/timezone.html">$timezone</a> = 99, <a class="var it12927" onMouseOver="hilite(12927)" onMouseOut="lolite()" onClick="logVariable('fixday')" href="../_variables/fixday.html">$fixday</a> = true, <a class="var it12928" onMouseOver="hilite(12928)" onMouseOut="lolite()" onClick="logVariable('fixhour')" href="../_variables/fixhour.html">$fixhour</a> = true) {
<a name="l2167"><span class="linenum">2167</span></a>      <a class="var it2951" onMouseOver="hilite(2951)" onMouseOut="lolite()" onClick="logVariable('calendartype')" href="../_variables/calendartype.html">$calendartype</a> = \core_calendar\<a class="class" onClick="logClass('type_factory')" href="../_classes/type_factory.html" onMouseOver="classPopup(event,'type_factory')">type_factory</a>::<a class="function" onClick="logFunction('get_calendar_instance')" href="../_functions/get_calendar_instance.html" onMouseOver="funcPopup(event,'get_calendar_instance')">get_calendar_instance</a>();
<a name="l2168"><span class="linenum">2168</span></a>      return <a class="var it2951" onMouseOver="hilite(2951)" onMouseOut="lolite()" onClick="logVariable('calendartype')" href="../_variables/calendartype.html">$calendartype</a>-&gt;<a class="function" onClick="logFunction('timestamp_to_date_string')" href="../_functions/timestamp_to_date_string.html" onMouseOver="funcPopup(event,'timestamp_to_date_string')">timestamp_to_date_string</a>(<a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('date')" href="../_variables/date.html">$date</a>, <a class="var it456" onMouseOver="hilite(456)" onMouseOut="lolite()" onClick="logVariable('format')" href="../_variables/format.html">$format</a>, <a class="var it1030" onMouseOver="hilite(1030)" onMouseOut="lolite()" onClick="logVariable('timezone')" href="../_variables/timezone.html">$timezone</a>, <a class="var it12927" onMouseOver="hilite(12927)" onMouseOut="lolite()" onClick="logVariable('fixday')" href="../_variables/fixday.html">$fixday</a>, <a class="var it12928" onMouseOver="hilite(12928)" onMouseOut="lolite()" onClick="logVariable('fixhour')" href="../_variables/fixhour.html">$fixhour</a>);
<a name="l2169"><span class="linenum">2169</span></a>  }
<a name="l2170"><span class="linenum">2170</span></a>  
<a name="l2171"><span class="linenum">2171</span></a>  <span class="comment">/**</span>
<a name="l2172"><span class="linenum">2172</span></a>  <span class="comment"> * Returns a formatted date ensuring it is UTF-8.</span>
<a name="l2173"><span class="linenum">2173</span></a>  <span class="comment"> *</span>
<a name="l2174"><span class="linenum">2174</span></a>  <span class="comment"> * If we are running under Windows convert to Windows encoding and then back to UTF-8</span>
<a name="l2175"><span class="linenum">2175</span></a>  <span class="comment"> * (because it's impossible to specify UTF-8 to fetch locale info in Win32).</span>
<a name="l2176"><span class="linenum">2176</span></a>  <span class="comment"> *</span>
<a name="l2177"><span class="linenum">2177</span></a>  <span class="comment"> * @param int $date the timestamp - since Moodle 2.9 this is a real UTC timestamp</span>
<a name="l2178"><span class="linenum">2178</span></a>  <span class="comment"> * @param string $format strftime format.</span>
<a name="l2179"><span class="linenum">2179</span></a>  <span class="comment"> * @param int|float|string $tz the user timezone</span>
<a name="l2180"><span class="linenum">2180</span></a>  <span class="comment"> * @return string the formatted date/time.</span>
<a name="l2181"><span class="linenum">2181</span></a>  <span class="comment"> * @since Moodle 2.3.3</span>
<a name="l2182"><span class="linenum">2182</span></a>  <span class="comment"> */</span>
<a name="l2183"><span class="linenum">2183</span></a>  function <a class="function" onClick="logFunction('date_format_string')" href="../_functions/date_format_string.html" onMouseOver="funcPopup(event,'date_format_string')">date_format_string</a>(<a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('date')" href="../_variables/date.html">$date</a>, <a class="var it456" onMouseOver="hilite(456)" onMouseOut="lolite()" onClick="logVariable('format')" href="../_variables/format.html">$format</a>, <a class="var it2538" onMouseOver="hilite(2538)" onMouseOut="lolite()" onClick="logVariable('tz')" href="../_variables/tz.html">$tz</a> = 99) {
<a name="l2184"><span class="linenum">2184</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l2185"><span class="linenum">2185</span></a>  
<a name="l2186"><span class="linenum">2186</span></a>      <a class="var it12929" onMouseOver="hilite(12929)" onMouseOut="lolite()" onClick="logVariable('localewincharset')" href="../_variables/localewincharset.html">$localewincharset</a> = null;
<a name="l2187"><span class="linenum">2187</span></a>  <span class="comment">    // Get the calendar type user is using.</span>
<a name="l2188"><span class="linenum">2188</span></a>      if (<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('ostype')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/ostype.html">ostype</a> == 'WINDOWS') {
<a name="l2189"><span class="linenum">2189</span></a>          <a class="var it2951" onMouseOver="hilite(2951)" onMouseOut="lolite()" onClick="logVariable('calendartype')" href="../_variables/calendartype.html">$calendartype</a> = \core_calendar\<a class="class" onClick="logClass('type_factory')" href="../_classes/type_factory.html" onMouseOver="classPopup(event,'type_factory')">type_factory</a>::<a class="function" onClick="logFunction('get_calendar_instance')" href="../_functions/get_calendar_instance.html" onMouseOver="funcPopup(event,'get_calendar_instance')">get_calendar_instance</a>();
<a name="l2190"><span class="linenum">2190</span></a>          <a class="var it12929" onMouseOver="hilite(12929)" onMouseOut="lolite()" onClick="logVariable('localewincharset')" href="../_variables/localewincharset.html">$localewincharset</a> = <a class="var it2951" onMouseOver="hilite(2951)" onMouseOut="lolite()" onClick="logVariable('calendartype')" href="../_variables/calendartype.html">$calendartype</a>-&gt;<a class="function" onClick="logFunction('locale_win_charset')" href="../_functions/locale_win_charset.html" onMouseOver="funcPopup(event,'locale_win_charset')">locale_win_charset</a>();
<a name="l2191"><span class="linenum">2191</span></a>      }
<a name="l2192"><span class="linenum">2192</span></a>  
<a name="l2193"><span class="linenum">2193</span></a>      if (<a class="var it12929" onMouseOver="hilite(12929)" onMouseOut="lolite()" onClick="logVariable('localewincharset')" href="../_variables/localewincharset.html">$localewincharset</a>) {
<a name="l2194"><span class="linenum">2194</span></a>          <a class="var it456" onMouseOver="hilite(456)" onMouseOut="lolite()" onClick="logVariable('format')" href="../_variables/format.html">$format</a> = <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it456" onMouseOver="hilite(456)" onMouseOut="lolite()" onClick="logVariable('format')" href="../_variables/format.html">$format</a>, 'utf-8', <a class="var it12929" onMouseOver="hilite(12929)" onMouseOut="lolite()" onClick="logVariable('localewincharset')" href="../_variables/localewincharset.html">$localewincharset</a>);
<a name="l2195"><span class="linenum">2195</span></a>      }
<a name="l2196"><span class="linenum">2196</span></a>  
<a name="l2197"><span class="linenum">2197</span></a>      date_default_timezone_set(<a class="class" onClick="logClass('core_date')" href="../_classes/core_date.html" onMouseOver="classPopup(event,'core_date')">core_date</a>::<a class="function" onClick="logFunction('get_user_timezone')" href="../_functions/get_user_timezone.html" onMouseOver="funcPopup(event,'get_user_timezone')">get_user_timezone</a>(<a class="var it2538" onMouseOver="hilite(2538)" onMouseOut="lolite()" onClick="logVariable('tz')" href="../_variables/tz.html">$tz</a>));
<a name="l2198"><span class="linenum">2198</span></a>      <a class="var it12930" onMouseOver="hilite(12930)" onMouseOut="lolite()" onClick="logVariable('datestring')" href="../_variables/datestring.html">$datestring</a> = <a class="phpfunction" onClick="logFunction('strftime')" href="../_functions/strftime.html" onMouseOver="phpfuncPopup(event,'strftime')">strftime</a>(<a class="var it456" onMouseOver="hilite(456)" onMouseOut="lolite()" onClick="logVariable('format')" href="../_variables/format.html">$format</a>, <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('date')" href="../_variables/date.html">$date</a>);
<a name="l2199"><span class="linenum">2199</span></a>      <a class="class" onClick="logClass('core_date')" href="../_classes/core_date.html" onMouseOver="classPopup(event,'core_date')">core_date</a>::<a class="function" onClick="logFunction('set_default_server_timezone')" href="../_functions/set_default_server_timezone.html" onMouseOver="funcPopup(event,'set_default_server_timezone')">set_default_server_timezone</a>();
<a name="l2200"><span class="linenum">2200</span></a>  
<a name="l2201"><span class="linenum">2201</span></a>      if (<a class="var it12929" onMouseOver="hilite(12929)" onMouseOut="lolite()" onClick="logVariable('localewincharset')" href="../_variables/localewincharset.html">$localewincharset</a>) {
<a name="l2202"><span class="linenum">2202</span></a>          <a class="var it12930" onMouseOver="hilite(12930)" onMouseOut="lolite()" onClick="logVariable('datestring')" href="../_variables/datestring.html">$datestring</a> = <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it12930" onMouseOver="hilite(12930)" onMouseOut="lolite()" onClick="logVariable('datestring')" href="../_variables/datestring.html">$datestring</a>, <a class="var it12929" onMouseOver="hilite(12929)" onMouseOut="lolite()" onClick="logVariable('localewincharset')" href="../_variables/localewincharset.html">$localewincharset</a>, 'utf-8');
<a name="l2203"><span class="linenum">2203</span></a>      }
<a name="l2204"><span class="linenum">2204</span></a>  
<a name="l2205"><span class="linenum">2205</span></a>      return <a class="var it12930" onMouseOver="hilite(12930)" onMouseOut="lolite()" onClick="logVariable('datestring')" href="../_variables/datestring.html">$datestring</a>;
<a name="l2206"><span class="linenum">2206</span></a>  }
<a name="l2207"><span class="linenum">2207</span></a>  
<a name="l2208"><span class="linenum">2208</span></a>  <span class="comment">/**</span>
<a name="l2209"><span class="linenum">2209</span></a>  <span class="comment"> * Given a $time timestamp in GMT (seconds since epoch),</span>
<a name="l2210"><span class="linenum">2210</span></a>  <span class="comment"> * returns an array that represents the date in user time</span>
<a name="l2211"><span class="linenum">2211</span></a>  <span class="comment"> *</span>
<a name="l2212"><span class="linenum">2212</span></a>  <span class="comment"> * @package core</span>
<a name="l2213"><span class="linenum">2213</span></a>  <span class="comment"> * @category time</span>
<a name="l2214"><span class="linenum">2214</span></a>  <span class="comment"> * @param int $time Timestamp in GMT</span>
<a name="l2215"><span class="linenum">2215</span></a>  <span class="comment"> * @param float|int|string $timezone user timezone</span>
<a name="l2216"><span class="linenum">2216</span></a>  <span class="comment"> * @return array An array that represents the date in user time</span>
<a name="l2217"><span class="linenum">2217</span></a>  <span class="comment"> */</span>
<a name="l2218"><span class="linenum">2218</span></a>  function <a class="function" onClick="logFunction('usergetdate')" href="../_functions/usergetdate.html" onMouseOver="funcPopup(event,'usergetdate')">usergetdate</a>(<a class="var it25" onMouseOver="hilite(25)" onMouseOut="lolite()" onClick="logVariable('time')" href="../_variables/time.html">$time</a>, <a class="var it1030" onMouseOver="hilite(1030)" onMouseOut="lolite()" onClick="logVariable('timezone')" href="../_variables/timezone.html">$timezone</a>=99) {
<a name="l2219"><span class="linenum">2219</span></a>      date_default_timezone_set(<a class="class" onClick="logClass('core_date')" href="../_classes/core_date.html" onMouseOver="classPopup(event,'core_date')">core_date</a>::<a class="function" onClick="logFunction('get_user_timezone')" href="../_functions/get_user_timezone.html" onMouseOver="funcPopup(event,'get_user_timezone')">get_user_timezone</a>(<a class="var it1030" onMouseOver="hilite(1030)" onMouseOut="lolite()" onClick="logVariable('timezone')" href="../_variables/timezone.html">$timezone</a>));
<a name="l2220"><span class="linenum">2220</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = <a class="phpfunction" onClick="logFunction('getdate')" href="../_functions/getdate.html" onMouseOver="phpfuncPopup(event,'getdate')">getdate</a>(<a class="var it25" onMouseOver="hilite(25)" onMouseOut="lolite()" onClick="logVariable('time')" href="../_variables/time.html">$time</a>);
<a name="l2221"><span class="linenum">2221</span></a>      <a class="class" onClick="logClass('core_date')" href="../_classes/core_date.html" onMouseOver="classPopup(event,'core_date')">core_date</a>::<a class="function" onClick="logFunction('set_default_server_timezone')" href="../_functions/set_default_server_timezone.html" onMouseOver="funcPopup(event,'set_default_server_timezone')">set_default_server_timezone</a>();
<a name="l2222"><span class="linenum">2222</span></a>  
<a name="l2223"><span class="linenum">2223</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>;
<a name="l2224"><span class="linenum">2224</span></a>  }
<a name="l2225"><span class="linenum">2225</span></a>  
<a name="l2226"><span class="linenum">2226</span></a>  <span class="comment">/**</span>
<a name="l2227"><span class="linenum">2227</span></a>  <span class="comment"> * Given a GMT timestamp (seconds since epoch), offsets it by</span>
<a name="l2228"><span class="linenum">2228</span></a>  <span class="comment"> * the timezone.  eg 3pm in India is 3pm GMT - 7 * 3600 seconds</span>
<a name="l2229"><span class="linenum">2229</span></a>  <span class="comment"> *</span>
<a name="l2230"><span class="linenum">2230</span></a>  <span class="comment"> * NOTE: this function does not include DST properly,</span>
<a name="l2231"><span class="linenum">2231</span></a>  <span class="comment"> *       you should use the PHP date stuff instead!</span>
<a name="l2232"><span class="linenum">2232</span></a>  <span class="comment"> *</span>
<a name="l2233"><span class="linenum">2233</span></a>  <span class="comment"> * @package core</span>
<a name="l2234"><span class="linenum">2234</span></a>  <span class="comment"> * @category time</span>
<a name="l2235"><span class="linenum">2235</span></a>  <span class="comment"> * @param int $date Timestamp in GMT</span>
<a name="l2236"><span class="linenum">2236</span></a>  <span class="comment"> * @param float|int|string $timezone user timezone</span>
<a name="l2237"><span class="linenum">2237</span></a>  <span class="comment"> * @return int</span>
<a name="l2238"><span class="linenum">2238</span></a>  <span class="comment"> */</span>
<a name="l2239"><span class="linenum">2239</span></a>  function <a class="function" onClick="logFunction('usertime')" href="../_functions/usertime.html" onMouseOver="funcPopup(event,'usertime')">usertime</a>(<a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('date')" href="../_variables/date.html">$date</a>, <a class="var it1030" onMouseOver="hilite(1030)" onMouseOut="lolite()" onClick="logVariable('timezone')" href="../_variables/timezone.html">$timezone</a>=99) {
<a name="l2240"><span class="linenum">2240</span></a>      <a class="var it7053" onMouseOver="hilite(7053)" onMouseOut="lolite()" onClick="logVariable('userdate')" href="../_variables/userdate.html">$userdate</a> = new DateTime('@' . <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('date')" href="../_variables/date.html">$date</a>);
<a name="l2241"><span class="linenum">2241</span></a>      <a class="var it7053" onMouseOver="hilite(7053)" onMouseOut="lolite()" onClick="logVariable('userdate')" href="../_variables/userdate.html">$userdate</a>-&gt;<a class="function" onClick="logFunction('setTimezone')" href="../_functions/settimezone.html" onMouseOver="funcPopup(event,'settimezone')">setTimezone</a>(<a class="class" onClick="logClass('core_date')" href="../_classes/core_date.html" onMouseOver="classPopup(event,'core_date')">core_date</a>::<a class="function" onClick="logFunction('get_user_timezone_object')" href="../_functions/get_user_timezone_object.html" onMouseOver="funcPopup(event,'get_user_timezone_object')">get_user_timezone_object</a>(<a class="var it1030" onMouseOver="hilite(1030)" onMouseOut="lolite()" onClick="logVariable('timezone')" href="../_variables/timezone.html">$timezone</a>));
<a name="l2242"><span class="linenum">2242</span></a>      <a class="var it1292" onMouseOver="hilite(1292)" onMouseOut="lolite()" onClick="logVariable('dst')" href="../_variables/dst.html">$dst</a> = <a class="function" onClick="logFunction('dst_offset_on')" href="../_functions/dst_offset_on.html" onMouseOver="funcPopup(event,'dst_offset_on')">dst_offset_on</a>(<a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('date')" href="../_variables/date.html">$date</a>, <a class="var it1030" onMouseOver="hilite(1030)" onMouseOut="lolite()" onClick="logVariable('timezone')" href="../_variables/timezone.html">$timezone</a>);
<a name="l2243"><span class="linenum">2243</span></a>  
<a name="l2244"><span class="linenum">2244</span></a>      return <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('date')" href="../_variables/date.html">$date</a> - <a class="var it7053" onMouseOver="hilite(7053)" onMouseOut="lolite()" onClick="logVariable('userdate')" href="../_variables/userdate.html">$userdate</a>-&gt;<a class="function" onClick="logFunction('getOffset')" href="../_functions/getoffset.html" onMouseOver="funcPopup(event,'getoffset')">getOffset</a>() + <a class="var it1292" onMouseOver="hilite(1292)" onMouseOut="lolite()" onClick="logVariable('dst')" href="../_variables/dst.html">$dst</a>;
<a name="l2245"><span class="linenum">2245</span></a>  }
<a name="l2246"><span class="linenum">2246</span></a>  
<a name="l2247"><span class="linenum">2247</span></a>  <span class="comment">/**</span>
<a name="l2248"><span class="linenum">2248</span></a>  <span class="comment"> * Given a time, return the GMT timestamp of the most recent midnight</span>
<a name="l2249"><span class="linenum">2249</span></a>  <span class="comment"> * for the current user.</span>
<a name="l2250"><span class="linenum">2250</span></a>  <span class="comment"> *</span>
<a name="l2251"><span class="linenum">2251</span></a>  <span class="comment"> * @package core</span>
<a name="l2252"><span class="linenum">2252</span></a>  <span class="comment"> * @category time</span>
<a name="l2253"><span class="linenum">2253</span></a>  <span class="comment"> * @param int $date Timestamp in GMT</span>
<a name="l2254"><span class="linenum">2254</span></a>  <span class="comment"> * @param float|int|string $timezone user timezone</span>
<a name="l2255"><span class="linenum">2255</span></a>  <span class="comment"> * @return int Returns a GMT timestamp</span>
<a name="l2256"><span class="linenum">2256</span></a>  <span class="comment"> */</span>
<a name="l2257"><span class="linenum">2257</span></a>  function <a class="function" onClick="logFunction('usergetmidnight')" href="../_functions/usergetmidnight.html" onMouseOver="funcPopup(event,'usergetmidnight')">usergetmidnight</a>(<a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('date')" href="../_variables/date.html">$date</a>, <a class="var it1030" onMouseOver="hilite(1030)" onMouseOut="lolite()" onClick="logVariable('timezone')" href="../_variables/timezone.html">$timezone</a>=99) {
<a name="l2258"><span class="linenum">2258</span></a>  
<a name="l2259"><span class="linenum">2259</span></a>      <a class="var it7053" onMouseOver="hilite(7053)" onMouseOut="lolite()" onClick="logVariable('userdate')" href="../_variables/userdate.html">$userdate</a> = <a class="function" onClick="logFunction('usergetdate')" href="../_functions/usergetdate.html" onMouseOver="funcPopup(event,'usergetdate')">usergetdate</a>(<a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('date')" href="../_variables/date.html">$date</a>, <a class="var it1030" onMouseOver="hilite(1030)" onMouseOut="lolite()" onClick="logVariable('timezone')" href="../_variables/timezone.html">$timezone</a>);
<a name="l2260"><span class="linenum">2260</span></a>  
<a name="l2261"><span class="linenum">2261</span></a>  <span class="comment">    // Time of midnight of this user's day, in GMT.</span>
<a name="l2262"><span class="linenum">2262</span></a>      return <a class="function" onClick="logFunction('make_timestamp')" href="../_functions/make_timestamp.html" onMouseOver="funcPopup(event,'make_timestamp')">make_timestamp</a>(<a class="var it7053" onMouseOver="hilite(7053)" onMouseOut="lolite()" onClick="logVariable('userdate')" href="../_variables/userdate.html">$userdate</a>['year'], <a class="var it7053" onMouseOver="hilite(7053)" onMouseOut="lolite()" onClick="logVariable('userdate')" href="../_variables/userdate.html">$userdate</a>['mon'], <a class="var it7053" onMouseOver="hilite(7053)" onMouseOut="lolite()" onClick="logVariable('userdate')" href="../_variables/userdate.html">$userdate</a>['mday'], 0, 0, 0, <a class="var it1030" onMouseOver="hilite(1030)" onMouseOut="lolite()" onClick="logVariable('timezone')" href="../_variables/timezone.html">$timezone</a>);
<a name="l2263"><span class="linenum">2263</span></a>  
<a name="l2264"><span class="linenum">2264</span></a>  }
<a name="l2265"><span class="linenum">2265</span></a>  
<a name="l2266"><span class="linenum">2266</span></a>  <span class="comment">/**</span>
<a name="l2267"><span class="linenum">2267</span></a>  <span class="comment"> * Returns a string that prints the user's timezone</span>
<a name="l2268"><span class="linenum">2268</span></a>  <span class="comment"> *</span>
<a name="l2269"><span class="linenum">2269</span></a>  <span class="comment"> * @package core</span>
<a name="l2270"><span class="linenum">2270</span></a>  <span class="comment"> * @category time</span>
<a name="l2271"><span class="linenum">2271</span></a>  <span class="comment"> * @param float|int|string $timezone user timezone</span>
<a name="l2272"><span class="linenum">2272</span></a>  <span class="comment"> * @return string</span>
<a name="l2273"><span class="linenum">2273</span></a>  <span class="comment"> */</span>
<a name="l2274"><span class="linenum">2274</span></a>  function <a class="function" onClick="logFunction('usertimezone')" href="../_functions/usertimezone.html" onMouseOver="funcPopup(event,'usertimezone')">usertimezone</a>(<a class="var it1030" onMouseOver="hilite(1030)" onMouseOut="lolite()" onClick="logVariable('timezone')" href="../_variables/timezone.html">$timezone</a>=99) {
<a name="l2275"><span class="linenum">2275</span></a>      <a class="var it2538" onMouseOver="hilite(2538)" onMouseOut="lolite()" onClick="logVariable('tz')" href="../_variables/tz.html">$tz</a> = <a class="class" onClick="logClass('core_date')" href="../_classes/core_date.html" onMouseOver="classPopup(event,'core_date')">core_date</a>::<a class="function" onClick="logFunction('get_user_timezone')" href="../_functions/get_user_timezone.html" onMouseOver="funcPopup(event,'get_user_timezone')">get_user_timezone</a>(<a class="var it1030" onMouseOver="hilite(1030)" onMouseOut="lolite()" onClick="logVariable('timezone')" href="../_variables/timezone.html">$timezone</a>);
<a name="l2276"><span class="linenum">2276</span></a>      return <a class="class" onClick="logClass('core_date')" href="../_classes/core_date.html" onMouseOver="classPopup(event,'core_date')">core_date</a>::<a class="function" onClick="logFunction('get_localised_timezone')" href="../_functions/get_localised_timezone.html" onMouseOver="funcPopup(event,'get_localised_timezone')">get_localised_timezone</a>(<a class="var it2538" onMouseOver="hilite(2538)" onMouseOut="lolite()" onClick="logVariable('tz')" href="../_variables/tz.html">$tz</a>);
<a name="l2277"><span class="linenum">2277</span></a>  }
<a name="l2278"><span class="linenum">2278</span></a>  
<a name="l2279"><span class="linenum">2279</span></a>  <span class="comment">/**</span>
<a name="l2280"><span class="linenum">2280</span></a>  <span class="comment"> * Returns a float or a string which denotes the user's timezone</span>
<a name="l2281"><span class="linenum">2281</span></a>  <span class="comment"> * A float value means that a simple offset from GMT is used, while a string (it will be the name of a timezone in the database)</span>
<a name="l2282"><span class="linenum">2282</span></a>  <span class="comment"> * means that for this timezone there are also DST rules to be taken into account</span>
<a name="l2283"><span class="linenum">2283</span></a>  <span class="comment"> * Checks various settings and picks the most dominant of those which have a value</span>
<a name="l2284"><span class="linenum">2284</span></a>  <span class="comment"> *</span>
<a name="l2285"><span class="linenum">2285</span></a>  <span class="comment"> * @package core</span>
<a name="l2286"><span class="linenum">2286</span></a>  <span class="comment"> * @category time</span>
<a name="l2287"><span class="linenum">2287</span></a>  <span class="comment"> * @param float|int|string $tz timezone to calculate GMT time offset before</span>
<a name="l2288"><span class="linenum">2288</span></a>  <span class="comment"> *        calculating user timezone, 99 is default user timezone</span>
<a name="l2289"><span class="linenum">2289</span></a>  <span class="comment"> *        {@link http://docs.moodle.org/dev/Time_API#Timezone}</span>
<a name="l2290"><span class="linenum">2290</span></a>  <span class="comment"> * @return float|string</span>
<a name="l2291"><span class="linenum">2291</span></a>  <span class="comment"> */</span>
<a name="l2292"><span class="linenum">2292</span></a>  function <a class="function" onClick="logFunction('get_user_timezone')" href="../_functions/get_user_timezone.html" onMouseOver="funcPopup(event,'get_user_timezone')">get_user_timezone</a>(<a class="var it2538" onMouseOver="hilite(2538)" onMouseOut="lolite()" onClick="logVariable('tz')" href="../_variables/tz.html">$tz</a> = 99) {
<a name="l2293"><span class="linenum">2293</span></a>      global <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l2294"><span class="linenum">2294</span></a>  
<a name="l2295"><span class="linenum">2295</span></a>      <a class="var it11321" onMouseOver="hilite(11321)" onMouseOut="lolite()" onClick="logVariable('timezones')" href="../_variables/timezones.html">$timezones</a> = array(
<a name="l2296"><span class="linenum">2296</span></a>          <a class="var it2538" onMouseOver="hilite(2538)" onMouseOut="lolite()" onClick="logVariable('tz')" href="../_variables/tz.html">$tz</a>,
<a name="l2297"><span class="linenum">2297</span></a>          isset(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('forcetimezone')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/forcetimezone.html">forcetimezone</a>) ? <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('forcetimezone')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/forcetimezone.html">forcetimezone</a> : 99,
<a name="l2298"><span class="linenum">2298</span></a>          isset(<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('timezone')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/timezone.html">timezone</a>) ? <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('timezone')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/timezone.html">timezone</a> : 99,
<a name="l2299"><span class="linenum">2299</span></a>          isset(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('timezone')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/timezone.html">timezone</a>) ? <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('timezone')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/timezone.html">timezone</a> : 99,
<a name="l2300"><span class="linenum">2300</span></a>          );
<a name="l2301"><span class="linenum">2301</span></a>  
<a name="l2302"><span class="linenum">2302</span></a>      <a class="var it2538" onMouseOver="hilite(2538)" onMouseOut="lolite()" onClick="logVariable('tz')" href="../_variables/tz.html">$tz</a> = 99;
<a name="l2303"><span class="linenum">2303</span></a>  
<a name="l2304"><span class="linenum">2304</span></a>  <span class="comment">    // Loop while $tz is, empty but not zero, or 99, and there is another timezone is the array.</span>
<a name="l2305"><span class="linenum">2305</span></a>      while (((empty(<a class="var it2538" onMouseOver="hilite(2538)" onMouseOut="lolite()" onClick="logVariable('tz')" href="../_variables/tz.html">$tz</a>) &amp;&amp; !<a class="phpfunction" onClick="logFunction('is_numeric')" href="../_functions/is_numeric.html" onMouseOver="phpfuncPopup(event,'is_numeric')">is_numeric</a>(<a class="var it2538" onMouseOver="hilite(2538)" onMouseOut="lolite()" onClick="logVariable('tz')" href="../_variables/tz.html">$tz</a>)) || <a class="var it2538" onMouseOver="hilite(2538)" onMouseOut="lolite()" onClick="logVariable('tz')" href="../_variables/tz.html">$tz</a> == 99) &amp;&amp; <a class="var it393" onMouseOver="hilite(393)" onMouseOut="lolite()" onClick="logVariable('next')" href="../_variables/next.html">$next</a> = <a class="phpfunction" onClick="logFunction('each')" href="../_functions/each.html" onMouseOver="phpfuncPopup(event,'each')">each</a>(<a class="var it11321" onMouseOver="hilite(11321)" onMouseOut="lolite()" onClick="logVariable('timezones')" href="../_variables/timezones.html">$timezones</a>)) {
<a name="l2306"><span class="linenum">2306</span></a>          <a class="var it2538" onMouseOver="hilite(2538)" onMouseOut="lolite()" onClick="logVariable('tz')" href="../_variables/tz.html">$tz</a> = <a class="var it393" onMouseOver="hilite(393)" onMouseOut="lolite()" onClick="logVariable('next')" href="../_variables/next.html">$next</a>['value'];
<a name="l2307"><span class="linenum">2307</span></a>      }
<a name="l2308"><span class="linenum">2308</span></a>      return <a class="phpfunction" onClick="logFunction('is_numeric')" href="../_functions/is_numeric.html" onMouseOver="phpfuncPopup(event,'is_numeric')">is_numeric</a>(<a class="var it2538" onMouseOver="hilite(2538)" onMouseOut="lolite()" onClick="logVariable('tz')" href="../_variables/tz.html">$tz</a>) ? (float) <a class="var it2538" onMouseOver="hilite(2538)" onMouseOut="lolite()" onClick="logVariable('tz')" href="../_variables/tz.html">$tz</a> : <a class="var it2538" onMouseOver="hilite(2538)" onMouseOut="lolite()" onClick="logVariable('tz')" href="../_variables/tz.html">$tz</a>;
<a name="l2309"><span class="linenum">2309</span></a>  }
<a name="l2310"><span class="linenum">2310</span></a>  
<a name="l2311"><span class="linenum">2311</span></a>  <span class="comment">/**</span>
<a name="l2312"><span class="linenum">2312</span></a>  <span class="comment"> * Calculates the Daylight Saving Offset for a given date/time (timestamp)</span>
<a name="l2313"><span class="linenum">2313</span></a>  <span class="comment"> * - Note: Daylight saving only works for string timezones and not for float.</span>
<a name="l2314"><span class="linenum">2314</span></a>  <span class="comment"> *</span>
<a name="l2315"><span class="linenum">2315</span></a>  <span class="comment"> * @package core</span>
<a name="l2316"><span class="linenum">2316</span></a>  <span class="comment"> * @category time</span>
<a name="l2317"><span class="linenum">2317</span></a>  <span class="comment"> * @param int $time must NOT be compensated at all, it has to be a pure timestamp</span>
<a name="l2318"><span class="linenum">2318</span></a>  <span class="comment"> * @param int|float|string $strtimezone user timezone</span>
<a name="l2319"><span class="linenum">2319</span></a>  <span class="comment"> * @return int</span>
<a name="l2320"><span class="linenum">2320</span></a>  <span class="comment"> */</span>
<a name="l2321"><span class="linenum">2321</span></a>  function <a class="function" onClick="logFunction('dst_offset_on')" href="../_functions/dst_offset_on.html" onMouseOver="funcPopup(event,'dst_offset_on')">dst_offset_on</a>(<a class="var it25" onMouseOver="hilite(25)" onMouseOut="lolite()" onClick="logVariable('time')" href="../_variables/time.html">$time</a>, <a class="var it12931" onMouseOver="hilite(12931)" onMouseOut="lolite()" onClick="logVariable('strtimezone')" href="../_variables/strtimezone.html">$strtimezone</a> = null) {
<a name="l2322"><span class="linenum">2322</span></a>      <a class="var it2538" onMouseOver="hilite(2538)" onMouseOut="lolite()" onClick="logVariable('tz')" href="../_variables/tz.html">$tz</a> = <a class="class" onClick="logClass('core_date')" href="../_classes/core_date.html" onMouseOver="classPopup(event,'core_date')">core_date</a>::<a class="function" onClick="logFunction('get_user_timezone')" href="../_functions/get_user_timezone.html" onMouseOver="funcPopup(event,'get_user_timezone')">get_user_timezone</a>(<a class="var it12931" onMouseOver="hilite(12931)" onMouseOut="lolite()" onClick="logVariable('strtimezone')" href="../_variables/strtimezone.html">$strtimezone</a>);
<a name="l2323"><span class="linenum">2323</span></a>      <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('date')" href="../_variables/date.html">$date</a> = new DateTime('@' . <a class="var it25" onMouseOver="hilite(25)" onMouseOut="lolite()" onClick="logVariable('time')" href="../_variables/time.html">$time</a>);
<a name="l2324"><span class="linenum">2324</span></a>      <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('date')" href="../_variables/date.html">$date</a>-&gt;<a class="function" onClick="logFunction('setTimezone')" href="../_functions/settimezone.html" onMouseOver="funcPopup(event,'settimezone')">setTimezone</a>(new DateTimeZone(<a class="var it2538" onMouseOver="hilite(2538)" onMouseOut="lolite()" onClick="logVariable('tz')" href="../_variables/tz.html">$tz</a>));
<a name="l2325"><span class="linenum">2325</span></a>      if (<a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('date')" href="../_variables/date.html">$date</a>-&gt;<a class="function" onClick="logFunction('format')" href="../_functions/format.html" onMouseOver="funcPopup(event,'format')">format</a>('I') == '1') {
<a name="l2326"><span class="linenum">2326</span></a>          if (<a class="var it2538" onMouseOver="hilite(2538)" onMouseOut="lolite()" onClick="logVariable('tz')" href="../_variables/tz.html">$tz</a> === 'Australia/Lord_Howe') {
<a name="l2327"><span class="linenum">2327</span></a>              return 1800;
<a name="l2328"><span class="linenum">2328</span></a>          }
<a name="l2329"><span class="linenum">2329</span></a>          return 3600;
<a name="l2330"><span class="linenum">2330</span></a>      }
<a name="l2331"><span class="linenum">2331</span></a>      return 0;
<a name="l2332"><span class="linenum">2332</span></a>  }
<a name="l2333"><span class="linenum">2333</span></a>  
<a name="l2334"><span class="linenum">2334</span></a>  <span class="comment">/**</span>
<a name="l2335"><span class="linenum">2335</span></a>  <span class="comment"> * Calculates when the day appears in specific month</span>
<a name="l2336"><span class="linenum">2336</span></a>  <span class="comment"> *</span>
<a name="l2337"><span class="linenum">2337</span></a>  <span class="comment"> * @package core</span>
<a name="l2338"><span class="linenum">2338</span></a>  <span class="comment"> * @category time</span>
<a name="l2339"><span class="linenum">2339</span></a>  <span class="comment"> * @param int $startday starting day of the month</span>
<a name="l2340"><span class="linenum">2340</span></a>  <span class="comment"> * @param int $weekday The day when week starts (normally taken from user preferences)</span>
<a name="l2341"><span class="linenum">2341</span></a>  <span class="comment"> * @param int $month The month whose day is sought</span>
<a name="l2342"><span class="linenum">2342</span></a>  <span class="comment"> * @param int $year The year of the month whose day is sought</span>
<a name="l2343"><span class="linenum">2343</span></a>  <span class="comment"> * @return int</span>
<a name="l2344"><span class="linenum">2344</span></a>  <span class="comment"> */</span>
<a name="l2345"><span class="linenum">2345</span></a>  function <a class="function" onClick="logFunction('find_day_in_month')" href="../_functions/find_day_in_month.html" onMouseOver="funcPopup(event,'find_day_in_month')">find_day_in_month</a>(<a class="var it390" onMouseOver="hilite(390)" onMouseOut="lolite()" onClick="logVariable('startday')" href="../_variables/startday.html">$startday</a>, <a class="var it7912" onMouseOver="hilite(7912)" onMouseOut="lolite()" onClick="logVariable('weekday')" href="../_variables/weekday.html">$weekday</a>, <a class="var it438" onMouseOver="hilite(438)" onMouseOut="lolite()" onClick="logVariable('month')" href="../_variables/month.html">$month</a>, <a class="var it437" onMouseOver="hilite(437)" onMouseOut="lolite()" onClick="logVariable('year')" href="../_variables/year.html">$year</a>) {
<a name="l2346"><span class="linenum">2346</span></a>      <a class="var it2951" onMouseOver="hilite(2951)" onMouseOut="lolite()" onClick="logVariable('calendartype')" href="../_variables/calendartype.html">$calendartype</a> = \core_calendar\<a class="class" onClick="logClass('type_factory')" href="../_classes/type_factory.html" onMouseOver="classPopup(event,'type_factory')">type_factory</a>::<a class="function" onClick="logFunction('get_calendar_instance')" href="../_functions/get_calendar_instance.html" onMouseOver="funcPopup(event,'get_calendar_instance')">get_calendar_instance</a>();
<a name="l2347"><span class="linenum">2347</span></a>  
<a name="l2348"><span class="linenum">2348</span></a>      <a class="var it440" onMouseOver="hilite(440)" onMouseOut="lolite()" onClick="logVariable('daysinmonth')" href="../_variables/daysinmonth.html">$daysinmonth</a> = <a class="function" onClick="logFunction('days_in_month')" href="../_functions/days_in_month.html" onMouseOver="funcPopup(event,'days_in_month')">days_in_month</a>(<a class="var it438" onMouseOver="hilite(438)" onMouseOut="lolite()" onClick="logVariable('month')" href="../_variables/month.html">$month</a>, <a class="var it437" onMouseOver="hilite(437)" onMouseOut="lolite()" onClick="logVariable('year')" href="../_variables/year.html">$year</a>);
<a name="l2349"><span class="linenum">2349</span></a>      <a class="var it12932" onMouseOver="hilite(12932)" onMouseOut="lolite()" onClick="logVariable('daysinweek')" href="../_variables/daysinweek.html">$daysinweek</a> = <a class="phpfunction" onClick="logFunction('count')" href="../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it2951" onMouseOver="hilite(2951)" onMouseOut="lolite()" onClick="logVariable('calendartype')" href="../_variables/calendartype.html">$calendartype</a>-&gt;<a class="function" onClick="logFunction('get_weekdays')" href="../_functions/get_weekdays.html" onMouseOver="funcPopup(event,'get_weekdays')">get_weekdays</a>());
<a name="l2350"><span class="linenum">2350</span></a>  
<a name="l2351"><span class="linenum">2351</span></a>      if (<a class="var it7912" onMouseOver="hilite(7912)" onMouseOut="lolite()" onClick="logVariable('weekday')" href="../_variables/weekday.html">$weekday</a> == -1) {
<a name="l2352"><span class="linenum">2352</span></a>  <span class="comment">        // Don't care about weekday, so return:</span>
<a name="l2353"><span class="linenum">2353</span></a>  <span class="comment">        //    abs($startday) if $startday != -1</span>
<a name="l2354"><span class="linenum">2354</span></a>  <span class="comment">        //    $daysinmonth otherwise.</span>
<a name="l2355"><span class="linenum">2355</span></a>          return (<a class="var it390" onMouseOver="hilite(390)" onMouseOut="lolite()" onClick="logVariable('startday')" href="../_variables/startday.html">$startday</a> == -1) ? <a class="var it440" onMouseOver="hilite(440)" onMouseOut="lolite()" onClick="logVariable('daysinmonth')" href="../_variables/daysinmonth.html">$daysinmonth</a> : <a class="phpfunction" onClick="logFunction('abs')" href="../_functions/abs.html" onMouseOver="phpfuncPopup(event,'abs')">abs</a>(<a class="var it390" onMouseOver="hilite(390)" onMouseOut="lolite()" onClick="logVariable('startday')" href="../_variables/startday.html">$startday</a>);
<a name="l2356"><span class="linenum">2356</span></a>      }
<a name="l2357"><span class="linenum">2357</span></a>  
<a name="l2358"><span class="linenum">2358</span></a>  <span class="comment">    // From now on we 're looking for a specific weekday.</span>
<a name="l2359"><span class="linenum">2359</span></a>  <span class="comment">    // Give &quot;end of month&quot; its actual value, since we know it.</span>
<a name="l2360"><span class="linenum">2360</span></a>      if (<a class="var it390" onMouseOver="hilite(390)" onMouseOut="lolite()" onClick="logVariable('startday')" href="../_variables/startday.html">$startday</a> == -1) {
<a name="l2361"><span class="linenum">2361</span></a>          <a class="var it390" onMouseOver="hilite(390)" onMouseOut="lolite()" onClick="logVariable('startday')" href="../_variables/startday.html">$startday</a> = -1 * <a class="var it440" onMouseOver="hilite(440)" onMouseOut="lolite()" onClick="logVariable('daysinmonth')" href="../_variables/daysinmonth.html">$daysinmonth</a>;
<a name="l2362"><span class="linenum">2362</span></a>      }
<a name="l2363"><span class="linenum">2363</span></a>  
<a name="l2364"><span class="linenum">2364</span></a>  <span class="comment">    // Starting from day $startday, the sign is the direction.</span>
<a name="l2365"><span class="linenum">2365</span></a>      if (<a class="var it390" onMouseOver="hilite(390)" onMouseOut="lolite()" onClick="logVariable('startday')" href="../_variables/startday.html">$startday</a> &lt; 1) {
<a name="l2366"><span class="linenum">2366</span></a>          <a class="var it390" onMouseOver="hilite(390)" onMouseOut="lolite()" onClick="logVariable('startday')" href="../_variables/startday.html">$startday</a> = <a class="phpfunction" onClick="logFunction('abs')" href="../_functions/abs.html" onMouseOver="phpfuncPopup(event,'abs')">abs</a>(<a class="var it390" onMouseOver="hilite(390)" onMouseOut="lolite()" onClick="logVariable('startday')" href="../_variables/startday.html">$startday</a>);
<a name="l2367"><span class="linenum">2367</span></a>          <a class="var it12933" onMouseOver="hilite(12933)" onMouseOut="lolite()" onClick="logVariable('lastmonthweekday')" href="../_variables/lastmonthweekday.html">$lastmonthweekday</a> = <a class="function" onClick="logFunction('dayofweek')" href="../_functions/dayofweek.html" onMouseOver="funcPopup(event,'dayofweek')">dayofweek</a>(<a class="var it440" onMouseOver="hilite(440)" onMouseOut="lolite()" onClick="logVariable('daysinmonth')" href="../_variables/daysinmonth.html">$daysinmonth</a>, <a class="var it438" onMouseOver="hilite(438)" onMouseOut="lolite()" onClick="logVariable('month')" href="../_variables/month.html">$month</a>, <a class="var it437" onMouseOver="hilite(437)" onMouseOut="lolite()" onClick="logVariable('year')" href="../_variables/year.html">$year</a>);
<a name="l2368"><span class="linenum">2368</span></a>  
<a name="l2369"><span class="linenum">2369</span></a>  <span class="comment">        // This is the last such weekday of the month.</span>
<a name="l2370"><span class="linenum">2370</span></a>          <a class="var it12934" onMouseOver="hilite(12934)" onMouseOut="lolite()" onClick="logVariable('lastinmonth')" href="../_variables/lastinmonth.html">$lastinmonth</a> = <a class="var it440" onMouseOver="hilite(440)" onMouseOut="lolite()" onClick="logVariable('daysinmonth')" href="../_variables/daysinmonth.html">$daysinmonth</a> + <a class="var it7912" onMouseOver="hilite(7912)" onMouseOut="lolite()" onClick="logVariable('weekday')" href="../_variables/weekday.html">$weekday</a> - <a class="var it12933" onMouseOver="hilite(12933)" onMouseOut="lolite()" onClick="logVariable('lastmonthweekday')" href="../_variables/lastmonthweekday.html">$lastmonthweekday</a>;
<a name="l2371"><span class="linenum">2371</span></a>          if (<a class="var it12934" onMouseOver="hilite(12934)" onMouseOut="lolite()" onClick="logVariable('lastinmonth')" href="../_variables/lastinmonth.html">$lastinmonth</a> &gt; <a class="var it440" onMouseOver="hilite(440)" onMouseOut="lolite()" onClick="logVariable('daysinmonth')" href="../_variables/daysinmonth.html">$daysinmonth</a>) {
<a name="l2372"><span class="linenum">2372</span></a>              <a class="var it12934" onMouseOver="hilite(12934)" onMouseOut="lolite()" onClick="logVariable('lastinmonth')" href="../_variables/lastinmonth.html">$lastinmonth</a> -= <a class="var it12932" onMouseOver="hilite(12932)" onMouseOut="lolite()" onClick="logVariable('daysinweek')" href="../_variables/daysinweek.html">$daysinweek</a>;
<a name="l2373"><span class="linenum">2373</span></a>          }
<a name="l2374"><span class="linenum">2374</span></a>  
<a name="l2375"><span class="linenum">2375</span></a>  <span class="comment">        // Find the first such weekday &lt;= $startday.</span>
<a name="l2376"><span class="linenum">2376</span></a>          while (<a class="var it12934" onMouseOver="hilite(12934)" onMouseOut="lolite()" onClick="logVariable('lastinmonth')" href="../_variables/lastinmonth.html">$lastinmonth</a> &gt; <a class="var it390" onMouseOver="hilite(390)" onMouseOut="lolite()" onClick="logVariable('startday')" href="../_variables/startday.html">$startday</a>) {
<a name="l2377"><span class="linenum">2377</span></a>              <a class="var it12934" onMouseOver="hilite(12934)" onMouseOut="lolite()" onClick="logVariable('lastinmonth')" href="../_variables/lastinmonth.html">$lastinmonth</a> -= <a class="var it12932" onMouseOver="hilite(12932)" onMouseOut="lolite()" onClick="logVariable('daysinweek')" href="../_variables/daysinweek.html">$daysinweek</a>;
<a name="l2378"><span class="linenum">2378</span></a>          }
<a name="l2379"><span class="linenum">2379</span></a>  
<a name="l2380"><span class="linenum">2380</span></a>          return <a class="var it12934" onMouseOver="hilite(12934)" onMouseOut="lolite()" onClick="logVariable('lastinmonth')" href="../_variables/lastinmonth.html">$lastinmonth</a>;
<a name="l2381"><span class="linenum">2381</span></a>      } else {
<a name="l2382"><span class="linenum">2382</span></a>          <a class="var it12935" onMouseOver="hilite(12935)" onMouseOut="lolite()" onClick="logVariable('indexweekday')" href="../_variables/indexweekday.html">$indexweekday</a> = <a class="function" onClick="logFunction('dayofweek')" href="../_functions/dayofweek.html" onMouseOver="funcPopup(event,'dayofweek')">dayofweek</a>(<a class="var it390" onMouseOver="hilite(390)" onMouseOut="lolite()" onClick="logVariable('startday')" href="../_variables/startday.html">$startday</a>, <a class="var it438" onMouseOver="hilite(438)" onMouseOut="lolite()" onClick="logVariable('month')" href="../_variables/month.html">$month</a>, <a class="var it437" onMouseOver="hilite(437)" onMouseOut="lolite()" onClick="logVariable('year')" href="../_variables/year.html">$year</a>);
<a name="l2383"><span class="linenum">2383</span></a>  
<a name="l2384"><span class="linenum">2384</span></a>          <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('diff')" href="../_variables/diff.html">$diff</a> = <a class="var it7912" onMouseOver="hilite(7912)" onMouseOut="lolite()" onClick="logVariable('weekday')" href="../_variables/weekday.html">$weekday</a> - <a class="var it12935" onMouseOver="hilite(12935)" onMouseOut="lolite()" onClick="logVariable('indexweekday')" href="../_variables/indexweekday.html">$indexweekday</a>;
<a name="l2385"><span class="linenum">2385</span></a>          if (<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('diff')" href="../_variables/diff.html">$diff</a> &lt; 0) {
<a name="l2386"><span class="linenum">2386</span></a>              <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('diff')" href="../_variables/diff.html">$diff</a> += <a class="var it12932" onMouseOver="hilite(12932)" onMouseOut="lolite()" onClick="logVariable('daysinweek')" href="../_variables/daysinweek.html">$daysinweek</a>;
<a name="l2387"><span class="linenum">2387</span></a>          }
<a name="l2388"><span class="linenum">2388</span></a>  
<a name="l2389"><span class="linenum">2389</span></a>  <span class="comment">        // This is the first such weekday of the month equal to or after $startday.</span>
<a name="l2390"><span class="linenum">2390</span></a>          <a class="var it12936" onMouseOver="hilite(12936)" onMouseOut="lolite()" onClick="logVariable('firstfromindex')" href="../_variables/firstfromindex.html">$firstfromindex</a> = <a class="var it390" onMouseOver="hilite(390)" onMouseOut="lolite()" onClick="logVariable('startday')" href="../_variables/startday.html">$startday</a> + <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('diff')" href="../_variables/diff.html">$diff</a>;
<a name="l2391"><span class="linenum">2391</span></a>  
<a name="l2392"><span class="linenum">2392</span></a>          return <a class="var it12936" onMouseOver="hilite(12936)" onMouseOut="lolite()" onClick="logVariable('firstfromindex')" href="../_variables/firstfromindex.html">$firstfromindex</a>;
<a name="l2393"><span class="linenum">2393</span></a>      }
<a name="l2394"><span class="linenum">2394</span></a>  }
<a name="l2395"><span class="linenum">2395</span></a>  
<a name="l2396"><span class="linenum">2396</span></a>  <span class="comment">/**</span>
<a name="l2397"><span class="linenum">2397</span></a>  <span class="comment"> * Calculate the number of days in a given month</span>
<a name="l2398"><span class="linenum">2398</span></a>  <span class="comment"> *</span>
<a name="l2399"><span class="linenum">2399</span></a>  <span class="comment"> * @package core</span>
<a name="l2400"><span class="linenum">2400</span></a>  <span class="comment"> * @category time</span>
<a name="l2401"><span class="linenum">2401</span></a>  <span class="comment"> * @param int $month The month whose day count is sought</span>
<a name="l2402"><span class="linenum">2402</span></a>  <span class="comment"> * @param int $year The year of the month whose day count is sought</span>
<a name="l2403"><span class="linenum">2403</span></a>  <span class="comment"> * @return int</span>
<a name="l2404"><span class="linenum">2404</span></a>  <span class="comment"> */</span>
<a name="l2405"><span class="linenum">2405</span></a>  function <a class="function" onClick="logFunction('days_in_month')" href="../_functions/days_in_month.html" onMouseOver="funcPopup(event,'days_in_month')">days_in_month</a>(<a class="var it438" onMouseOver="hilite(438)" onMouseOut="lolite()" onClick="logVariable('month')" href="../_variables/month.html">$month</a>, <a class="var it437" onMouseOver="hilite(437)" onMouseOut="lolite()" onClick="logVariable('year')" href="../_variables/year.html">$year</a>) {
<a name="l2406"><span class="linenum">2406</span></a>      <a class="var it2951" onMouseOver="hilite(2951)" onMouseOut="lolite()" onClick="logVariable('calendartype')" href="../_variables/calendartype.html">$calendartype</a> = \core_calendar\<a class="class" onClick="logClass('type_factory')" href="../_classes/type_factory.html" onMouseOver="classPopup(event,'type_factory')">type_factory</a>::<a class="function" onClick="logFunction('get_calendar_instance')" href="../_functions/get_calendar_instance.html" onMouseOver="funcPopup(event,'get_calendar_instance')">get_calendar_instance</a>();
<a name="l2407"><span class="linenum">2407</span></a>      return <a class="var it2951" onMouseOver="hilite(2951)" onMouseOut="lolite()" onClick="logVariable('calendartype')" href="../_variables/calendartype.html">$calendartype</a>-&gt;<a class="function" onClick="logFunction('get_num_days_in_month')" href="../_functions/get_num_days_in_month.html" onMouseOver="funcPopup(event,'get_num_days_in_month')">get_num_days_in_month</a>(<a class="var it437" onMouseOver="hilite(437)" onMouseOut="lolite()" onClick="logVariable('year')" href="../_variables/year.html">$year</a>, <a class="var it438" onMouseOver="hilite(438)" onMouseOut="lolite()" onClick="logVariable('month')" href="../_variables/month.html">$month</a>);
<a name="l2408"><span class="linenum">2408</span></a>  }
<a name="l2409"><span class="linenum">2409</span></a>  
<a name="l2410"><span class="linenum">2410</span></a>  <span class="comment">/**</span>
<a name="l2411"><span class="linenum">2411</span></a>  <span class="comment"> * Calculate the position in the week of a specific calendar day</span>
<a name="l2412"><span class="linenum">2412</span></a>  <span class="comment"> *</span>
<a name="l2413"><span class="linenum">2413</span></a>  <span class="comment"> * @package core</span>
<a name="l2414"><span class="linenum">2414</span></a>  <span class="comment"> * @category time</span>
<a name="l2415"><span class="linenum">2415</span></a>  <span class="comment"> * @param int $day The day of the date whose position in the week is sought</span>
<a name="l2416"><span class="linenum">2416</span></a>  <span class="comment"> * @param int $month The month of the date whose position in the week is sought</span>
<a name="l2417"><span class="linenum">2417</span></a>  <span class="comment"> * @param int $year The year of the date whose position in the week is sought</span>
<a name="l2418"><span class="linenum">2418</span></a>  <span class="comment"> * @return int</span>
<a name="l2419"><span class="linenum">2419</span></a>  <span class="comment"> */</span>
<a name="l2420"><span class="linenum">2420</span></a>  function <a class="function" onClick="logFunction('dayofweek')" href="../_functions/dayofweek.html" onMouseOver="funcPopup(event,'dayofweek')">dayofweek</a>(<a class="var it434" onMouseOver="hilite(434)" onMouseOut="lolite()" onClick="logVariable('day')" href="../_variables/day.html">$day</a>, <a class="var it438" onMouseOver="hilite(438)" onMouseOut="lolite()" onClick="logVariable('month')" href="../_variables/month.html">$month</a>, <a class="var it437" onMouseOver="hilite(437)" onMouseOut="lolite()" onClick="logVariable('year')" href="../_variables/year.html">$year</a>) {
<a name="l2421"><span class="linenum">2421</span></a>      <a class="var it2951" onMouseOver="hilite(2951)" onMouseOut="lolite()" onClick="logVariable('calendartype')" href="../_variables/calendartype.html">$calendartype</a> = \core_calendar\<a class="class" onClick="logClass('type_factory')" href="../_classes/type_factory.html" onMouseOver="classPopup(event,'type_factory')">type_factory</a>::<a class="function" onClick="logFunction('get_calendar_instance')" href="../_functions/get_calendar_instance.html" onMouseOver="funcPopup(event,'get_calendar_instance')">get_calendar_instance</a>();
<a name="l2422"><span class="linenum">2422</span></a>      return <a class="var it2951" onMouseOver="hilite(2951)" onMouseOut="lolite()" onClick="logVariable('calendartype')" href="../_variables/calendartype.html">$calendartype</a>-&gt;<a class="function" onClick="logFunction('get_weekday')" href="../_functions/get_weekday.html" onMouseOver="funcPopup(event,'get_weekday')">get_weekday</a>(<a class="var it437" onMouseOver="hilite(437)" onMouseOut="lolite()" onClick="logVariable('year')" href="../_variables/year.html">$year</a>, <a class="var it438" onMouseOver="hilite(438)" onMouseOut="lolite()" onClick="logVariable('month')" href="../_variables/month.html">$month</a>, <a class="var it434" onMouseOver="hilite(434)" onMouseOut="lolite()" onClick="logVariable('day')" href="../_variables/day.html">$day</a>);
<a name="l2423"><span class="linenum">2423</span></a>  }
<a name="l2424"><span class="linenum">2424</span></a>  
<a name="l2425"><span class="linenum">2425</span></a>  <span class="comment">// USER AUTHENTICATION AND LOGIN.</span>
<a name="l2426"><span class="linenum">2426</span></a>  
<a name="l2427"><span class="linenum">2427</span></a>  <span class="comment">/**</span>
<a name="l2428"><span class="linenum">2428</span></a>  <span class="comment"> * Returns full login url.</span>
<a name="l2429"><span class="linenum">2429</span></a>  <span class="comment"> *</span>
<a name="l2430"><span class="linenum">2430</span></a>  <span class="comment"> * @return string login url</span>
<a name="l2431"><span class="linenum">2431</span></a>  <span class="comment"> */</span>
<a name="l2432"><span class="linenum">2432</span></a>  function <a class="function" onClick="logFunction('get_login_url')" href="../_functions/get_login_url.html" onMouseOver="funcPopup(event,'get_login_url')">get_login_url</a>() {
<a name="l2433"><span class="linenum">2433</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l2434"><span class="linenum">2434</span></a>  
<a name="l2435"><span class="linenum">2435</span></a>      <a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('url')" href="../_variables/url.html">$url</a> = &quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>/login/index.php&quot;;
<a name="l2436"><span class="linenum">2436</span></a>  
<a name="l2437"><span class="linenum">2437</span></a>      if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('loginhttps')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/loginhttps.html">loginhttps</a>)) {
<a name="l2438"><span class="linenum">2438</span></a>          <a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('url')" href="../_variables/url.html">$url</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('http:', 'https:', <a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('url')" href="../_variables/url.html">$url</a>);
<a name="l2439"><span class="linenum">2439</span></a>      }
<a name="l2440"><span class="linenum">2440</span></a>  
<a name="l2441"><span class="linenum">2441</span></a>      return <a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('url')" href="../_variables/url.html">$url</a>;
<a name="l2442"><span class="linenum">2442</span></a>  }
<a name="l2443"><span class="linenum">2443</span></a>  
<a name="l2444"><span class="linenum">2444</span></a>  <span class="comment">/**</span>
<a name="l2445"><span class="linenum">2445</span></a>  <span class="comment"> * This function checks that the current user is logged in and has the</span>
<a name="l2446"><span class="linenum">2446</span></a>  <span class="comment"> * required privileges</span>
<a name="l2447"><span class="linenum">2447</span></a>  <span class="comment"> *</span>
<a name="l2448"><span class="linenum">2448</span></a>  <span class="comment"> * This function checks that the current user is logged in, and optionally</span>
<a name="l2449"><span class="linenum">2449</span></a>  <span class="comment"> * whether they are allowed to be in a particular course and view a particular</span>
<a name="l2450"><span class="linenum">2450</span></a>  <span class="comment"> * course module.</span>
<a name="l2451"><span class="linenum">2451</span></a>  <span class="comment"> * If they are not logged in, then it redirects them to the site login unless</span>
<a name="l2452"><span class="linenum">2452</span></a>  <span class="comment"> * $autologinguest is set and {@link $CFG}-&gt;autologinguests is set to 1 in which</span>
<a name="l2453"><span class="linenum">2453</span></a>  <span class="comment"> * case they are automatically logged in as guests.</span>
<a name="l2454"><span class="linenum">2454</span></a>  <span class="comment"> * If $courseid is given and the user is not enrolled in that course then the</span>
<a name="l2455"><span class="linenum">2455</span></a>  <span class="comment"> * user is redirected to the course enrolment page.</span>
<a name="l2456"><span class="linenum">2456</span></a>  <span class="comment"> * If $cm is given and the course module is hidden and the user is not a teacher</span>
<a name="l2457"><span class="linenum">2457</span></a>  <span class="comment"> * in the course then the user is redirected to the course home page.</span>
<a name="l2458"><span class="linenum">2458</span></a>  <span class="comment"> *</span>
<a name="l2459"><span class="linenum">2459</span></a>  <span class="comment"> * When $cm parameter specified, this function sets page layout to 'module'.</span>
<a name="l2460"><span class="linenum">2460</span></a>  <span class="comment"> * You need to change it manually later if some other layout needed.</span>
<a name="l2461"><span class="linenum">2461</span></a>  <span class="comment"> *</span>
<a name="l2462"><span class="linenum">2462</span></a>  <span class="comment"> * @package    core_access</span>
<a name="l2463"><span class="linenum">2463</span></a>  <span class="comment"> * @category   access</span>
<a name="l2464"><span class="linenum">2464</span></a>  <span class="comment"> *</span>
<a name="l2465"><span class="linenum">2465</span></a>  <span class="comment"> * @param mixed $courseorid id of the course or course object</span>
<a name="l2466"><span class="linenum">2466</span></a>  <span class="comment"> * @param bool $autologinguest default true</span>
<a name="l2467"><span class="linenum">2467</span></a>  <span class="comment"> * @param object $cm course module object</span>
<a name="l2468"><span class="linenum">2468</span></a>  <span class="comment"> * @param bool $setwantsurltome Define if we want to set $SESSION-&gt;wantsurl, defaults to</span>
<a name="l2469"><span class="linenum">2469</span></a>  <span class="comment"> *             true. Used to avoid (=false) some scripts (file.php...) to set that variable,</span>
<a name="l2470"><span class="linenum">2470</span></a>  <span class="comment"> *             in order to keep redirects working properly. MDL-14495</span>
<a name="l2471"><span class="linenum">2471</span></a>  <span class="comment"> * @param bool $preventredirect set to true in scripts that can not redirect (CLI, rss feeds, etc.), throws exceptions</span>
<a name="l2472"><span class="linenum">2472</span></a>  <span class="comment"> * @return mixed Void, exit, and die depending on path</span>
<a name="l2473"><span class="linenum">2473</span></a>  <span class="comment"> * @throws coding_exception</span>
<a name="l2474"><span class="linenum">2474</span></a>  <span class="comment"> * @throws require_login_exception</span>
<a name="l2475"><span class="linenum">2475</span></a>  <span class="comment"> */</span>
<a name="l2476"><span class="linenum">2476</span></a>  function <a class="function" onClick="logFunction('require_login')" href="../_functions/require_login.html" onMouseOver="funcPopup(event,'require_login')">require_login</a>(<a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a> = null, <a class="var it12937" onMouseOver="hilite(12937)" onMouseOut="lolite()" onClick="logVariable('autologinguest')" href="../_variables/autologinguest.html">$autologinguest</a> = true, <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a> = null, <a class="var it12938" onMouseOver="hilite(12938)" onMouseOut="lolite()" onClick="logVariable('setwantsurltome')" href="../_variables/setwantsurltome.html">$setwantsurltome</a> = true, <a class="var it12939" onMouseOver="hilite(12939)" onMouseOut="lolite()" onClick="logVariable('preventredirect')" href="../_variables/preventredirect.html">$preventredirect</a> = false) {
<a name="l2477"><span class="linenum">2477</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>, <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>, <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>, <a class="var it1063" onMouseOver="hilite(1063)" onMouseOut="lolite()" onClick="logVariable('SITE')" href="../_variables/SITE.html">$SITE</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>, <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>;
<a name="l2478"><span class="linenum">2478</span></a>  
<a name="l2479"><span class="linenum">2479</span></a>  <span class="comment">    // Must not redirect when byteserving already started.</span>
<a name="l2480"><span class="linenum">2480</span></a>      if (!empty(<a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['HTTP_RANGE'])) {
<a name="l2481"><span class="linenum">2481</span></a>          <a class="var it12939" onMouseOver="hilite(12939)" onMouseOut="lolite()" onClick="logVariable('preventredirect')" href="../_variables/preventredirect.html">$preventredirect</a> = true;
<a name="l2482"><span class="linenum">2482</span></a>      }
<a name="l2483"><span class="linenum">2483</span></a>  
<a name="l2484"><span class="linenum">2484</span></a>  <span class="comment">    // Setup global $COURSE, themes, language and locale.</span>
<a name="l2485"><span class="linenum">2485</span></a>      if (!empty(<a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>)) {
<a name="l2486"><span class="linenum">2486</span></a>          if (<a class="phpfunction" onClick="logFunction('is_object')" href="../_functions/is_object.html" onMouseOver="phpfuncPopup(event,'is_object')">is_object</a>(<a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>)) {
<a name="l2487"><span class="linenum">2487</span></a>              <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a> = <a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>;
<a name="l2488"><span class="linenum">2488</span></a>          } else if (<a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a> == <a class="constant" onClick="logConstant('SITEID')" href="../_constants/SITEID.html" onMouseOver="constPopup(event,'SITEID')">SITEID</a>) {
<a name="l2489"><span class="linenum">2489</span></a>              <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a> = <a class="function" onClick="logFunction('clone')" href="../_functions/clone.html" onMouseOver="funcPopup(event,'clone')">clone</a>(<a class="var it1063" onMouseOver="hilite(1063)" onMouseOut="lolite()" onClick="logVariable('SITE')" href="../_variables/SITE.html">$SITE</a>);
<a name="l2490"><span class="linenum">2490</span></a>          } else {
<a name="l2491"><span class="linenum">2491</span></a>              <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('course', array('id' =&gt; <a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>), '*', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l2492"><span class="linenum">2492</span></a>          }
<a name="l2493"><span class="linenum">2493</span></a>          if (<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>) {
<a name="l2494"><span class="linenum">2494</span></a>              if (<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('course')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../_variables/course.html">course</a> != <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>) {
<a name="l2495"><span class="linenum">2495</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('course and cm parameters in <a class="function" onClick="logFunction('require_login')" href="../_functions/require_login.html" onMouseOver="funcPopup(event,'require_login')">require_login</a>() call do not match!!');
<a name="l2496"><span class="linenum">2496</span></a>              }
<a name="l2497"><span class="linenum">2497</span></a>  <span class="comment">            // Make sure we have a $cm from get_fast_modinfo as this contains activity access details.</span>
<a name="l2498"><span class="linenum">2498</span></a>              if (!(<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a> instanceof cm_info)) {
<a name="l2499"><span class="linenum">2499</span></a>  <span class="comment">                // Note: nearly all pages call get_fast_modinfo anyway and it does not make any</span>
<a name="l2500"><span class="linenum">2500</span></a>  <span class="comment">                // db queries so this is not really a performance concern, however it is obviously</span>
<a name="l2501"><span class="linenum">2501</span></a>  <span class="comment">                // better if you use get_fast_modinfo to get the cm before calling this.</span>
<a name="l2502"><span class="linenum">2502</span></a>                  <a class="var it1702" onMouseOver="hilite(1702)" onMouseOut="lolite()" onClick="logVariable('modinfo')" href="../_variables/modinfo.html">$modinfo</a> = <a class="function" onClick="logFunction('get_fast_modinfo')" href="../_functions/get_fast_modinfo.html" onMouseOver="funcPopup(event,'get_fast_modinfo')">get_fast_modinfo</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>);
<a name="l2503"><span class="linenum">2503</span></a>                  <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a> = <a class="var it1702" onMouseOver="hilite(1702)" onMouseOut="lolite()" onClick="logVariable('modinfo')" href="../_variables/modinfo.html">$modinfo</a>-&gt;<a class="function" onClick="logFunction('get_cm')" href="../_functions/get_cm.html" onMouseOver="funcPopup(event,'get_cm')">get_cm</a>(<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l2504"><span class="linenum">2504</span></a>              }
<a name="l2505"><span class="linenum">2505</span></a>          }
<a name="l2506"><span class="linenum">2506</span></a>      } else {
<a name="l2507"><span class="linenum">2507</span></a>  <span class="comment">        // Do not touch global $COURSE via $PAGE-&gt;set_course(),</span>
<a name="l2508"><span class="linenum">2508</span></a>  <span class="comment">        // the reasons is we need to be able to call require_login() at any time!!</span>
<a name="l2509"><span class="linenum">2509</span></a>          <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a> = <a class="var it1063" onMouseOver="hilite(1063)" onMouseOut="lolite()" onClick="logVariable('SITE')" href="../_variables/SITE.html">$SITE</a>;
<a name="l2510"><span class="linenum">2510</span></a>          if (<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>) {
<a name="l2511"><span class="linenum">2511</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('cm parameter in <a class="function" onClick="logFunction('require_login')" href="../_functions/require_login.html" onMouseOver="funcPopup(event,'require_login')">require_login</a>() requires valid course parameter!');
<a name="l2512"><span class="linenum">2512</span></a>          }
<a name="l2513"><span class="linenum">2513</span></a>      }
<a name="l2514"><span class="linenum">2514</span></a>  
<a name="l2515"><span class="linenum">2515</span></a>  <span class="comment">    // If this is an AJAX request and $setwantsurltome is true then we need to override it and set it to false.</span>
<a name="l2516"><span class="linenum">2516</span></a>  <span class="comment">    // Otherwise the AJAX request URL will be set to $SESSION-&gt;wantsurl and events such as self enrolment in the future</span>
<a name="l2517"><span class="linenum">2517</span></a>  <span class="comment">    // risk leading the user back to the AJAX request URL.</span>
<a name="l2518"><span class="linenum">2518</span></a>      if (<a class="var it12938" onMouseOver="hilite(12938)" onMouseOut="lolite()" onClick="logVariable('setwantsurltome')" href="../_variables/setwantsurltome.html">$setwantsurltome</a> &amp;&amp; <a class="phpfunction" onClick="logFunction('defined')" href="../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('AJAX_SCRIPT')" href="../_constants/AJAX_SCRIPT.html" onMouseOver="constPopup(event,'AJAX_SCRIPT')">AJAX_SCRIPT</a>') &amp;&amp; <a class="constant" onClick="logConstant('AJAX_SCRIPT')" href="../_constants/AJAX_SCRIPT.html" onMouseOver="constPopup(event,'AJAX_SCRIPT')">AJAX_SCRIPT</a>) {
<a name="l2519"><span class="linenum">2519</span></a>          <a class="var it12938" onMouseOver="hilite(12938)" onMouseOut="lolite()" onClick="logVariable('setwantsurltome')" href="../_variables/setwantsurltome.html">$setwantsurltome</a> = false;
<a name="l2520"><span class="linenum">2520</span></a>      }
<a name="l2521"><span class="linenum">2521</span></a>  
<a name="l2522"><span class="linenum">2522</span></a>  <span class="comment">    // Redirect to the login page if session has expired, only with dbsessions enabled (MDL-35029) to maintain current behaviour.</span>
<a name="l2523"><span class="linenum">2523</span></a>      if ((!<a class="function" onClick="logFunction('isloggedin')" href="../_functions/isloggedin.html" onMouseOver="funcPopup(event,'isloggedin')">isloggedin</a>() or <a class="function" onClick="logFunction('isguestuser')" href="../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>()) &amp;&amp; !empty(<a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('has_timed_out')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/has_timed_out.html">has_timed_out</a>) &amp;&amp; !<a class="var it12939" onMouseOver="hilite(12939)" onMouseOut="lolite()" onClick="logVariable('preventredirect')" href="../_variables/preventredirect.html">$preventredirect</a> &amp;&amp; !empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dbsessions')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dbsessions.html">dbsessions</a>)) {
<a name="l2524"><span class="linenum">2524</span></a>          if (<a class="var it12938" onMouseOver="hilite(12938)" onMouseOut="lolite()" onClick="logVariable('setwantsurltome')" href="../_variables/setwantsurltome.html">$setwantsurltome</a>) {
<a name="l2525"><span class="linenum">2525</span></a>              <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/wantsurl.html">wantsurl</a> = <a class="function" onClick="logFunction('qualified_me')" href="../_functions/qualified_me.html" onMouseOver="funcPopup(event,'qualified_me')">qualified_me</a>();
<a name="l2526"><span class="linenum">2526</span></a>          }
<a name="l2527"><span class="linenum">2527</span></a>          <a class="function" onClick="logFunction('redirect')" href="../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<a class="function" onClick="logFunction('get_login_url')" href="../_functions/get_login_url.html" onMouseOver="funcPopup(event,'get_login_url')">get_login_url</a>());
<a name="l2528"><span class="linenum">2528</span></a>      }
<a name="l2529"><span class="linenum">2529</span></a>  
<a name="l2530"><span class="linenum">2530</span></a>  <span class="comment">    // If the user is not even logged in yet then make sure they are.</span>
<a name="l2531"><span class="linenum">2531</span></a>      if (!<a class="function" onClick="logFunction('isloggedin')" href="../_functions/isloggedin.html" onMouseOver="funcPopup(event,'isloggedin')">isloggedin</a>()) {
<a name="l2532"><span class="linenum">2532</span></a>          if (<a class="var it12937" onMouseOver="hilite(12937)" onMouseOut="lolite()" onClick="logVariable('autologinguest')" href="../_variables/autologinguest.html">$autologinguest</a> and !empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('guestloginbutton')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/guestloginbutton.html">guestloginbutton</a>) and !empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('autologinguests')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/autologinguests.html">autologinguests</a>)) {
<a name="l2533"><span class="linenum">2533</span></a>              if (!<a class="var it357" onMouseOver="hilite(357)" onMouseOut="lolite()" onClick="logVariable('guest')" href="../_variables/guest.html">$guest</a> = <a class="function" onClick="logFunction('get_complete_user_data')" href="../_functions/get_complete_user_data.html" onMouseOver="funcPopup(event,'get_complete_user_data')">get_complete_user_data</a>('id', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('siteguest')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/siteguest.html">siteguest</a>)) {
<a name="l2534"><span class="linenum">2534</span></a>  <span class="comment">                // Misconfigured site guest, just redirect to login page.</span>
<a name="l2535"><span class="linenum">2535</span></a>                  <a class="function" onClick="logFunction('redirect')" href="../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<a class="function" onClick="logFunction('get_login_url')" href="../_functions/get_login_url.html" onMouseOver="funcPopup(event,'get_login_url')">get_login_url</a>());
<a name="l2536"><span class="linenum">2536</span></a>                  exit; <span class="comment">// Never reached.</span>
<a name="l2537"><span class="linenum">2537</span></a>              }
<a name="l2538"><span class="linenum">2538</span></a>              <a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a> = isset(<a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('lang')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>) ? <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('lang')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a> : <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('lang')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>;
<a name="l2539"><span class="linenum">2539</span></a>              <a class="function" onClick="logFunction('complete_user_login')" href="../_functions/complete_user_login.html" onMouseOver="funcPopup(event,'complete_user_login')">complete_user_login</a>(<a class="var it357" onMouseOver="hilite(357)" onMouseOut="lolite()" onClick="logVariable('guest')" href="../_variables/guest.html">$guest</a>);
<a name="l2540"><span class="linenum">2540</span></a>              <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('autologinguest')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/autologinguest.html">autologinguest</a> = true;
<a name="l2541"><span class="linenum">2541</span></a>              <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('lang')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a> = <a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a>;
<a name="l2542"><span class="linenum">2542</span></a>          } else {
<a name="l2543"><span class="linenum">2543</span></a>  <span class="comment">            // NOTE: $USER-&gt;site check was obsoleted by session test cookie, $USER-&gt;confirmed test is in login/index.php.</span>
<a name="l2544"><span class="linenum">2544</span></a>              if (<a class="var it12939" onMouseOver="hilite(12939)" onMouseOut="lolite()" onClick="logVariable('preventredirect')" href="../_variables/preventredirect.html">$preventredirect</a>) {
<a name="l2545"><span class="linenum">2545</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('require_login_exception')" href="../_classes/require_login_exception.html" onMouseOver="classPopup(event,'require_login_exception')">require_login_exception</a>('You are not logged in');
<a name="l2546"><span class="linenum">2546</span></a>              }
<a name="l2547"><span class="linenum">2547</span></a>  
<a name="l2548"><span class="linenum">2548</span></a>              if (<a class="var it12938" onMouseOver="hilite(12938)" onMouseOut="lolite()" onClick="logVariable('setwantsurltome')" href="../_variables/setwantsurltome.html">$setwantsurltome</a>) {
<a name="l2549"><span class="linenum">2549</span></a>                  <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/wantsurl.html">wantsurl</a> = <a class="function" onClick="logFunction('qualified_me')" href="../_functions/qualified_me.html" onMouseOver="funcPopup(event,'qualified_me')">qualified_me</a>();
<a name="l2550"><span class="linenum">2550</span></a>              }
<a name="l2551"><span class="linenum">2551</span></a>              if (!empty(<a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['HTTP_REFERER'])) {
<a name="l2552"><span class="linenum">2552</span></a>                  <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('fromurl')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/fromurl.html">fromurl</a>  = <a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['HTTP_REFERER'];
<a name="l2553"><span class="linenum">2553</span></a>              }
<a name="l2554"><span class="linenum">2554</span></a>  
<a name="l2555"><span class="linenum">2555</span></a>  <span class="comment">            // Give auth plugins an opportunity to authenticate or redirect to an external login page</span>
<a name="l2556"><span class="linenum">2556</span></a>              <a class="var it4813" onMouseOver="hilite(4813)" onMouseOut="lolite()" onClick="logVariable('authsequence')" href="../_variables/authsequence.html">$authsequence</a> = <a class="function" onClick="logFunction('get_enabled_auth_plugins')" href="../_functions/get_enabled_auth_plugins.html" onMouseOver="funcPopup(event,'get_enabled_auth_plugins')">get_enabled_auth_plugins</a>(true); <span class="comment">// auths, in sequence</span>
<a name="l2557"><span class="linenum">2557</span></a>              foreach(<a class="var it4813" onMouseOver="hilite(4813)" onMouseOut="lolite()" onClick="logVariable('authsequence')" href="../_variables/authsequence.html">$authsequence</a> as <a class="var it4814" onMouseOver="hilite(4814)" onMouseOut="lolite()" onClick="logVariable('authname')" href="../_variables/authname.html">$authname</a>) {
<a name="l2558"><span class="linenum">2558</span></a>                  <a class="var it4020" onMouseOver="hilite(4020)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../_variables/authplugin.html">$authplugin</a> = <a class="function" onClick="logFunction('get_auth_plugin')" href="../_functions/get_auth_plugin.html" onMouseOver="funcPopup(event,'get_auth_plugin')">get_auth_plugin</a>(<a class="var it4814" onMouseOver="hilite(4814)" onMouseOut="lolite()" onClick="logVariable('authname')" href="../_variables/authname.html">$authname</a>);
<a name="l2559"><span class="linenum">2559</span></a>                  <a class="var it4020" onMouseOver="hilite(4020)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../_variables/authplugin.html">$authplugin</a>-&gt;<a class="function" onClick="logFunction('pre_loginpage_hook')" href="../_functions/pre_loginpage_hook.html" onMouseOver="funcPopup(event,'pre_loginpage_hook')">pre_loginpage_hook</a>();
<a name="l2560"><span class="linenum">2560</span></a>                  if (<a class="function" onClick="logFunction('isloggedin')" href="../_functions/isloggedin.html" onMouseOver="funcPopup(event,'isloggedin')">isloggedin</a>()) {
<a name="l2561"><span class="linenum">2561</span></a>                      break;
<a name="l2562"><span class="linenum">2562</span></a>                  }
<a name="l2563"><span class="linenum">2563</span></a>              }
<a name="l2564"><span class="linenum">2564</span></a>  
<a name="l2565"><span class="linenum">2565</span></a>  <span class="comment">            // If we're still not logged in then go to the login page</span>
<a name="l2566"><span class="linenum">2566</span></a>              if (!<a class="function" onClick="logFunction('isloggedin')" href="../_functions/isloggedin.html" onMouseOver="funcPopup(event,'isloggedin')">isloggedin</a>()) {
<a name="l2567"><span class="linenum">2567</span></a>                  <a class="function" onClick="logFunction('redirect')" href="../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<a class="function" onClick="logFunction('get_login_url')" href="../_functions/get_login_url.html" onMouseOver="funcPopup(event,'get_login_url')">get_login_url</a>());
<a name="l2568"><span class="linenum">2568</span></a>                  exit; <span class="comment">// Never reached.</span>
<a name="l2569"><span class="linenum">2569</span></a>              }
<a name="l2570"><span class="linenum">2570</span></a>          }
<a name="l2571"><span class="linenum">2571</span></a>      }
<a name="l2572"><span class="linenum">2572</span></a>  
<a name="l2573"><span class="linenum">2573</span></a>  <span class="comment">    // Loginas as redirection if needed.</span>
<a name="l2574"><span class="linenum">2574</span></a>      if (<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a> != <a class="constant" onClick="logConstant('SITEID')" href="../_constants/SITEID.html" onMouseOver="constPopup(event,'SITEID')">SITEID</a> and \core\session\<a class="class" onClick="logClass('manager')" href="../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('is_loggedinas')" href="../_functions/is_loggedinas.html" onMouseOver="funcPopup(event,'is_loggedinas')">is_loggedinas</a>()) {
<a name="l2575"><span class="linenum">2575</span></a>          if (<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('loginascontext')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/loginascontext.html">loginascontext</a>-&gt;contextlevel == <a class="constant" onClick="logConstant('CONTEXT_COURSE')" href="../_constants/CONTEXT_COURSE.html" onMouseOver="constPopup(event,'CONTEXT_COURSE')">CONTEXT_COURSE</a>) {
<a name="l2576"><span class="linenum">2576</span></a>              if (<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('loginascontext')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/loginascontext.html">loginascontext</a>-&gt;instanceid != <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>) {
<a name="l2577"><span class="linenum">2577</span></a>                  <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('loginasonecourse', '', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>.'/course/view.php?id='.<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('loginascontext')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/loginascontext.html">loginascontext</a>-&gt;instanceid);
<a name="l2578"><span class="linenum">2578</span></a>              }
<a name="l2579"><span class="linenum">2579</span></a>          }
<a name="l2580"><span class="linenum">2580</span></a>      }
<a name="l2581"><span class="linenum">2581</span></a>  
<a name="l2582"><span class="linenum">2582</span></a>  <span class="comment">    // Check whether the user should be changing password (but only if it is REALLY them).</span>
<a name="l2583"><span class="linenum">2583</span></a>      if (<a class="function" onClick="logFunction('get_user_preferences')" href="../_functions/get_user_preferences.html" onMouseOver="funcPopup(event,'get_user_preferences')">get_user_preferences</a>('auth_forcepasswordchange') &amp;&amp; !\core\session\<a class="class" onClick="logClass('manager')" href="../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('is_loggedinas')" href="../_functions/is_loggedinas.html" onMouseOver="funcPopup(event,'is_loggedinas')">is_loggedinas</a>()) {
<a name="l2584"><span class="linenum">2584</span></a>          <a class="var it4006" onMouseOver="hilite(4006)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a> = <a class="function" onClick="logFunction('get_auth_plugin')" href="../_functions/get_auth_plugin.html" onMouseOver="funcPopup(event,'get_auth_plugin')">get_auth_plugin</a>(<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('auth')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>);
<a name="l2585"><span class="linenum">2585</span></a>          if (<a class="var it4006" onMouseOver="hilite(4006)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a>-&gt;<a class="function" onClick="logFunction('can_change_password')" href="../_functions/can_change_password.html" onMouseOver="funcPopup(event,'can_change_password')">can_change_password</a>() and !<a class="var it12939" onMouseOver="hilite(12939)" onMouseOut="lolite()" onClick="logVariable('preventredirect')" href="../_variables/preventredirect.html">$preventredirect</a>) {
<a name="l2586"><span class="linenum">2586</span></a>              if (<a class="var it12938" onMouseOver="hilite(12938)" onMouseOut="lolite()" onClick="logVariable('setwantsurltome')" href="../_variables/setwantsurltome.html">$setwantsurltome</a>) {
<a name="l2587"><span class="linenum">2587</span></a>                  <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/wantsurl.html">wantsurl</a> = <a class="function" onClick="logFunction('qualified_me')" href="../_functions/qualified_me.html" onMouseOver="funcPopup(event,'qualified_me')">qualified_me</a>();
<a name="l2588"><span class="linenum">2588</span></a>              }
<a name="l2589"><span class="linenum">2589</span></a>              if (<a class="var it12943" onMouseOver="hilite(12943)" onMouseOut="lolite()" onClick="logVariable('changeurl')" href="../_variables/changeurl.html">$changeurl</a> = <a class="var it4006" onMouseOver="hilite(4006)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a>-&gt;<a class="function" onClick="logFunction('change_password_url')" href="../_functions/change_password_url.html" onMouseOver="funcPopup(event,'change_password_url')">change_password_url</a>()) {
<a name="l2590"><span class="linenum">2590</span></a>  <span class="comment">                // Use plugin custom url.</span>
<a name="l2591"><span class="linenum">2591</span></a>                  <a class="function" onClick="logFunction('redirect')" href="../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<a class="var it12943" onMouseOver="hilite(12943)" onMouseOut="lolite()" onClick="logVariable('changeurl')" href="../_variables/changeurl.html">$changeurl</a>);
<a name="l2592"><span class="linenum">2592</span></a>              } else {
<a name="l2593"><span class="linenum">2593</span></a>  <span class="comment">                // Use moodle internal method.</span>
<a name="l2594"><span class="linenum">2594</span></a>                  if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('loginhttps')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/loginhttps.html">loginhttps</a>)) {
<a name="l2595"><span class="linenum">2595</span></a>                      <a class="function" onClick="logFunction('redirect')" href="../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a> .'<a class="filename" href="../login/change_password.php.html">/login/change_password.php</a>');
<a name="l2596"><span class="linenum">2596</span></a>                  } else {
<a name="l2597"><span class="linenum">2597</span></a>                      <a class="var it67" onMouseOver="hilite(67)" onMouseOut="lolite()" onClick="logVariable('wwwroot')" href="../_variables/wwwroot.html">$wwwroot</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('http:', 'https:', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>);
<a name="l2598"><span class="linenum">2598</span></a>                      <a class="function" onClick="logFunction('redirect')" href="../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<a class="var it67" onMouseOver="hilite(67)" onMouseOut="lolite()" onClick="logVariable('wwwroot')" href="../_variables/wwwroot.html">$wwwroot</a> .'<a class="filename" href="../login/change_password.php.html">/login/change_password.php</a>');
<a name="l2599"><span class="linenum">2599</span></a>                  }
<a name="l2600"><span class="linenum">2600</span></a>              }
<a name="l2601"><span class="linenum">2601</span></a>          } else {
<a name="l2602"><span class="linenum">2602</span></a>              <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('nopasswordchangeforced', 'auth');
<a name="l2603"><span class="linenum">2603</span></a>          }
<a name="l2604"><span class="linenum">2604</span></a>      }
<a name="l2605"><span class="linenum">2605</span></a>  
<a name="l2606"><span class="linenum">2606</span></a>  <span class="comment">    // Check that the user account is properly set up.</span>
<a name="l2607"><span class="linenum">2607</span></a>      if (<a class="function" onClick="logFunction('user_not_fully_set_up')" href="../_functions/user_not_fully_set_up.html" onMouseOver="funcPopup(event,'user_not_fully_set_up')">user_not_fully_set_up</a>(<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>)) {
<a name="l2608"><span class="linenum">2608</span></a>          if (<a class="var it12939" onMouseOver="hilite(12939)" onMouseOut="lolite()" onClick="logVariable('preventredirect')" href="../_variables/preventredirect.html">$preventredirect</a>) {
<a name="l2609"><span class="linenum">2609</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('require_login_exception')" href="../_classes/require_login_exception.html" onMouseOver="classPopup(event,'require_login_exception')">require_login_exception</a>('User not fully set-up');
<a name="l2610"><span class="linenum">2610</span></a>          }
<a name="l2611"><span class="linenum">2611</span></a>          if (<a class="var it12938" onMouseOver="hilite(12938)" onMouseOut="lolite()" onClick="logVariable('setwantsurltome')" href="../_variables/setwantsurltome.html">$setwantsurltome</a>) {
<a name="l2612"><span class="linenum">2612</span></a>              <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/wantsurl.html">wantsurl</a> = <a class="function" onClick="logFunction('qualified_me')" href="../_functions/qualified_me.html" onMouseOver="funcPopup(event,'qualified_me')">qualified_me</a>();
<a name="l2613"><span class="linenum">2613</span></a>          }
<a name="l2614"><span class="linenum">2614</span></a>          <a class="function" onClick="logFunction('redirect')" href="../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a> .'/user/edit.php?id='. <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/id.html">id</a> .'&amp;amp;course='. <a class="constant" onClick="logConstant('SITEID')" href="../_constants/SITEID.html" onMouseOver="constPopup(event,'SITEID')">SITEID</a>);
<a name="l2615"><span class="linenum">2615</span></a>      }
<a name="l2616"><span class="linenum">2616</span></a>  
<a name="l2617"><span class="linenum">2617</span></a>  <span class="comment">    // Make sure the USER has a sesskey set up. Used for CSRF protection.</span>
<a name="l2618"><span class="linenum">2618</span></a>      <a class="function" onClick="logFunction('sesskey')" href="../_functions/sesskey.html" onMouseOver="funcPopup(event,'sesskey')">sesskey</a>();
<a name="l2619"><span class="linenum">2619</span></a>  
<a name="l2620"><span class="linenum">2620</span></a>  <span class="comment">    // Do not bother admins with any formalities.</span>
<a name="l2621"><span class="linenum">2621</span></a>      if (<a class="function" onClick="logFunction('is_siteadmin')" href="../_functions/is_siteadmin.html" onMouseOver="funcPopup(event,'is_siteadmin')">is_siteadmin</a>()) {
<a name="l2622"><span class="linenum">2622</span></a>  <span class="comment">        // Set the global $COURSE.</span>
<a name="l2623"><span class="linenum">2623</span></a>          if (<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>) {
<a name="l2624"><span class="linenum">2624</span></a>              <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('set_cm')" href="../_functions/set_cm.html" onMouseOver="funcPopup(event,'set_cm')">set_cm</a>(<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>, <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>);
<a name="l2625"><span class="linenum">2625</span></a>              <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('set_pagelayout')" href="../_functions/set_pagelayout.html" onMouseOver="funcPopup(event,'set_pagelayout')">set_pagelayout</a>('incourse');
<a name="l2626"><span class="linenum">2626</span></a>          } else if (!empty(<a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>)) {
<a name="l2627"><span class="linenum">2627</span></a>              <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('set_course')" href="../_functions/set_course.html" onMouseOver="funcPopup(event,'set_course')">set_course</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>);
<a name="l2628"><span class="linenum">2628</span></a>          }
<a name="l2629"><span class="linenum">2629</span></a>  <span class="comment">        // Set accesstime or the user will appear offline which messes up messaging.</span>
<a name="l2630"><span class="linenum">2630</span></a>          <a class="function" onClick="logFunction('user_accesstime_log')" href="../_functions/user_accesstime_log.html" onMouseOver="funcPopup(event,'user_accesstime_log')">user_accesstime_log</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l2631"><span class="linenum">2631</span></a>          return;
<a name="l2632"><span class="linenum">2632</span></a>      }
<a name="l2633"><span class="linenum">2633</span></a>  
<a name="l2634"><span class="linenum">2634</span></a>  <span class="comment">    // Check that the user has agreed to a site policy if there is one - do not test in case of admins.</span>
<a name="l2635"><span class="linenum">2635</span></a>      if (!<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('policyagreed')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/policyagreed.html">policyagreed</a> and !<a class="function" onClick="logFunction('is_siteadmin')" href="../_functions/is_siteadmin.html" onMouseOver="funcPopup(event,'is_siteadmin')">is_siteadmin</a>()) {
<a name="l2636"><span class="linenum">2636</span></a>          if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sitepolicy')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/sitepolicy.html">sitepolicy</a>) and !<a class="function" onClick="logFunction('isguestuser')" href="../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>()) {
<a name="l2637"><span class="linenum">2637</span></a>              if (<a class="var it12939" onMouseOver="hilite(12939)" onMouseOut="lolite()" onClick="logVariable('preventredirect')" href="../_variables/preventredirect.html">$preventredirect</a>) {
<a name="l2638"><span class="linenum">2638</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('require_login_exception')" href="../_classes/require_login_exception.html" onMouseOver="classPopup(event,'require_login_exception')">require_login_exception</a>('Policy not agreed');
<a name="l2639"><span class="linenum">2639</span></a>              }
<a name="l2640"><span class="linenum">2640</span></a>              if (<a class="var it12938" onMouseOver="hilite(12938)" onMouseOut="lolite()" onClick="logVariable('setwantsurltome')" href="../_variables/setwantsurltome.html">$setwantsurltome</a>) {
<a name="l2641"><span class="linenum">2641</span></a>                  <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/wantsurl.html">wantsurl</a> = <a class="function" onClick="logFunction('qualified_me')" href="../_functions/qualified_me.html" onMouseOver="funcPopup(event,'qualified_me')">qualified_me</a>();
<a name="l2642"><span class="linenum">2642</span></a>              }
<a name="l2643"><span class="linenum">2643</span></a>              <a class="function" onClick="logFunction('redirect')" href="../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a> .'<a class="filename" href="../user/policy.php.html">/user/policy.php</a>');
<a name="l2644"><span class="linenum">2644</span></a>          } else if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sitepolicyguest')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/sitepolicyguest.html">sitepolicyguest</a>) and <a class="function" onClick="logFunction('isguestuser')" href="../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>()) {
<a name="l2645"><span class="linenum">2645</span></a>              if (<a class="var it12939" onMouseOver="hilite(12939)" onMouseOut="lolite()" onClick="logVariable('preventredirect')" href="../_variables/preventredirect.html">$preventredirect</a>) {
<a name="l2646"><span class="linenum">2646</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('require_login_exception')" href="../_classes/require_login_exception.html" onMouseOver="classPopup(event,'require_login_exception')">require_login_exception</a>('Policy not agreed');
<a name="l2647"><span class="linenum">2647</span></a>              }
<a name="l2648"><span class="linenum">2648</span></a>              if (<a class="var it12938" onMouseOver="hilite(12938)" onMouseOut="lolite()" onClick="logVariable('setwantsurltome')" href="../_variables/setwantsurltome.html">$setwantsurltome</a>) {
<a name="l2649"><span class="linenum">2649</span></a>                  <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/wantsurl.html">wantsurl</a> = <a class="function" onClick="logFunction('qualified_me')" href="../_functions/qualified_me.html" onMouseOver="funcPopup(event,'qualified_me')">qualified_me</a>();
<a name="l2650"><span class="linenum">2650</span></a>              }
<a name="l2651"><span class="linenum">2651</span></a>              <a class="function" onClick="logFunction('redirect')" href="../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a> .'<a class="filename" href="../user/policy.php.html">/user/policy.php</a>');
<a name="l2652"><span class="linenum">2652</span></a>          }
<a name="l2653"><span class="linenum">2653</span></a>      }
<a name="l2654"><span class="linenum">2654</span></a>  
<a name="l2655"><span class="linenum">2655</span></a>  <span class="comment">    // Fetch the system context, the course context, and prefetch its child contexts.</span>
<a name="l2656"><span class="linenum">2656</span></a>      <a class="var it12946" onMouseOver="hilite(12946)" onMouseOut="lolite()" onClick="logVariable('sysctx')" href="../_variables/sysctx.html">$sysctx</a> = <a class="class" onClick="logClass('context_system')" href="../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>();
<a name="l2657"><span class="linenum">2657</span></a>      <a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a> = <a class="class" onClick="logClass('context_course')" href="../_classes/context_course.html" onMouseOver="classPopup(event,'context_course')">context_course</a>::<a class="function" onClick="logFunction('instance')" href="../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, <a class="constant" onClick="logConstant('MUST_EXIST')" href="../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l2658"><span class="linenum">2658</span></a>      if (<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>) {
<a name="l2659"><span class="linenum">2659</span></a>          <a class="var it6479" onMouseOver="hilite(6479)" onMouseOut="lolite()" onClick="logVariable('cmcontext')" href="../_variables/cmcontext.html">$cmcontext</a> = <a class="class" onClick="logClass('context_module')" href="../_classes/context_module.html" onMouseOver="classPopup(event,'context_module')">context_module</a>::<a class="function" onClick="logFunction('instance')" href="../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, <a class="constant" onClick="logConstant('MUST_EXIST')" href="../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l2660"><span class="linenum">2660</span></a>      } else {
<a name="l2661"><span class="linenum">2661</span></a>          <a class="var it6479" onMouseOver="hilite(6479)" onMouseOut="lolite()" onClick="logVariable('cmcontext')" href="../_variables/cmcontext.html">$cmcontext</a> = null;
<a name="l2662"><span class="linenum">2662</span></a>      }
<a name="l2663"><span class="linenum">2663</span></a>  
<a name="l2664"><span class="linenum">2664</span></a>  <span class="comment">    // If the site is currently under maintenance, then print a message.</span>
<a name="l2665"><span class="linenum">2665</span></a>      if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('maintenance_enabled')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/maintenance_enabled.html">maintenance_enabled</a>) and !<a class="function" onClick="logFunction('has_capability')" href="../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/site:config', <a class="var it12946" onMouseOver="hilite(12946)" onMouseOut="lolite()" onClick="logVariable('sysctx')" href="../_variables/sysctx.html">$sysctx</a>)) {
<a name="l2666"><span class="linenum">2666</span></a>          if (<a class="var it12939" onMouseOver="hilite(12939)" onMouseOut="lolite()" onClick="logVariable('preventredirect')" href="../_variables/preventredirect.html">$preventredirect</a>) {
<a name="l2667"><span class="linenum">2667</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('require_login_exception')" href="../_classes/require_login_exception.html" onMouseOver="classPopup(event,'require_login_exception')">require_login_exception</a>('Maintenance in progress');
<a name="l2668"><span class="linenum">2668</span></a>          }
<a name="l2669"><span class="linenum">2669</span></a>  
<a name="l2670"><span class="linenum">2670</span></a>          <a class="function" onClick="logFunction('print_maintenance_message')" href="../_functions/print_maintenance_message.html" onMouseOver="funcPopup(event,'print_maintenance_message')">print_maintenance_message</a>();
<a name="l2671"><span class="linenum">2671</span></a>      }
<a name="l2672"><span class="linenum">2672</span></a>  
<a name="l2673"><span class="linenum">2673</span></a>  <span class="comment">    // Make sure the course itself is not hidden.</span>
<a name="l2674"><span class="linenum">2674</span></a>      if (<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a> == <a class="constant" onClick="logConstant('SITEID')" href="../_constants/SITEID.html" onMouseOver="constPopup(event,'SITEID')">SITEID</a>) {
<a name="l2675"><span class="linenum">2675</span></a>  <span class="comment">        // Frontpage can not be hidden.</span>
<a name="l2676"><span class="linenum">2676</span></a>      } else {
<a name="l2677"><span class="linenum">2677</span></a>          if (<a class="function" onClick="logFunction('is_role_switched')" href="../_functions/is_role_switched.html" onMouseOver="funcPopup(event,'is_role_switched')">is_role_switched</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)) {
<a name="l2678"><span class="linenum">2678</span></a>  <span class="comment">            // When switching roles ignore the hidden flag - user had to be in course to do the switch.</span>
<a name="l2679"><span class="linenum">2679</span></a>          } else {
<a name="l2680"><span class="linenum">2680</span></a>              if (!<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('visible')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/visible.html">visible</a> and !<a class="function" onClick="logFunction('has_capability')" href="../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/course:viewhiddencourses', <a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a>)) {
<a name="l2681"><span class="linenum">2681</span></a>  <span class="comment">                // Originally there was also test of parent category visibility, BUT is was very slow in complex queries</span>
<a name="l2682"><span class="linenum">2682</span></a>  <span class="comment">                // involving &quot;my courses&quot; now it is also possible to simply hide all courses user is not enrolled in :-).</span>
<a name="l2683"><span class="linenum">2683</span></a>                  if (<a class="var it12939" onMouseOver="hilite(12939)" onMouseOut="lolite()" onClick="logVariable('preventredirect')" href="../_variables/preventredirect.html">$preventredirect</a>) {
<a name="l2684"><span class="linenum">2684</span></a>                      throw <span class="keyword">new </span><a class="class" onClick="logClass('require_login_exception')" href="../_classes/require_login_exception.html" onMouseOver="classPopup(event,'require_login_exception')">require_login_exception</a>('Course is hidden');
<a name="l2685"><span class="linenum">2685</span></a>                  }
<a name="l2686"><span class="linenum">2686</span></a>                  <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('set_context')" href="../_functions/set_context.html" onMouseOver="funcPopup(event,'set_context')">set_context</a>(null);
<a name="l2687"><span class="linenum">2687</span></a>  <span class="comment">                // We need to override the navigation URL as the course won't have been added to the navigation and thus</span>
<a name="l2688"><span class="linenum">2688</span></a>  <span class="comment">                // the navigation will mess up when trying to find it.</span>
<a name="l2689"><span class="linenum">2689</span></a>                  <a class="class" onClick="logClass('navigation_node')" href="../_classes/navigation_node.html" onMouseOver="classPopup(event,'navigation_node')">navigation_node</a>::<a class="function" onClick="logFunction('override_active_url')" href="../_functions/override_active_url.html" onMouseOver="funcPopup(event,'override_active_url')">override_active_url</a>(<span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('/'));
<a name="l2690"><span class="linenum">2690</span></a>                  <a class="function" onClick="logFunction('notice')" href="../_functions/notice.html" onMouseOver="funcPopup(event,'notice')">notice</a>(<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('coursehidden'), <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a> .'/');
<a name="l2691"><span class="linenum">2691</span></a>              }
<a name="l2692"><span class="linenum">2692</span></a>          }
<a name="l2693"><span class="linenum">2693</span></a>      }
<a name="l2694"><span class="linenum">2694</span></a>  
<a name="l2695"><span class="linenum">2695</span></a>  <span class="comment">    // Is the user enrolled?</span>
<a name="l2696"><span class="linenum">2696</span></a>      if (<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a> == <a class="constant" onClick="logConstant('SITEID')" href="../_constants/SITEID.html" onMouseOver="constPopup(event,'SITEID')">SITEID</a>) {
<a name="l2697"><span class="linenum">2697</span></a>  <span class="comment">        // Everybody is enrolled on the frontpage.</span>
<a name="l2698"><span class="linenum">2698</span></a>      } else {
<a name="l2699"><span class="linenum">2699</span></a>          if (\core\session\<a class="class" onClick="logClass('manager')" href="../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('is_loggedinas')" href="../_functions/is_loggedinas.html" onMouseOver="funcPopup(event,'is_loggedinas')">is_loggedinas</a>()) {
<a name="l2700"><span class="linenum">2700</span></a>  <span class="comment">            // Make sure the REAL person can access this course first.</span>
<a name="l2701"><span class="linenum">2701</span></a>              <a class="var it11663" onMouseOver="hilite(11663)" onMouseOut="lolite()" onClick="logVariable('realuser')" href="../_variables/realuser.html">$realuser</a> = \core\session\<a class="class" onClick="logClass('manager')" href="../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('get_realuser')" href="../_functions/get_realuser.html" onMouseOver="funcPopup(event,'get_realuser')">get_realuser</a>();
<a name="l2702"><span class="linenum">2702</span></a>              if (!<a class="function" onClick="logFunction('is_enrolled')" href="../_functions/is_enrolled.html" onMouseOver="funcPopup(event,'is_enrolled')">is_enrolled</a>(<a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a>, <a class="var it11663" onMouseOver="hilite(11663)" onMouseOut="lolite()" onClick="logVariable('realuser')" href="../_variables/realuser.html">$realuser</a>-&gt;<a onClick="logVariable('id')" class="var it39679" onMouseOver="hilite(39679)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, '', true) and
<a name="l2703"><span class="linenum">2703</span></a>                  !<a class="function" onClick="logFunction('is_viewing')" href="../_functions/is_viewing.html" onMouseOver="funcPopup(event,'is_viewing')">is_viewing</a>(<a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a>, <a class="var it11663" onMouseOver="hilite(11663)" onMouseOut="lolite()" onClick="logVariable('realuser')" href="../_variables/realuser.html">$realuser</a>-&gt;<a onClick="logVariable('id')" class="var it39679" onMouseOver="hilite(39679)" onMouseOut="lolite()" href="../_variables/id.html">id</a>) and !<a class="function" onClick="logFunction('is_siteadmin')" href="../_functions/is_siteadmin.html" onMouseOver="funcPopup(event,'is_siteadmin')">is_siteadmin</a>(<a class="var it11663" onMouseOver="hilite(11663)" onMouseOut="lolite()" onClick="logVariable('realuser')" href="../_variables/realuser.html">$realuser</a>-&gt;<a onClick="logVariable('id')" class="var it39679" onMouseOver="hilite(39679)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)) {
<a name="l2704"><span class="linenum">2704</span></a>                  if (<a class="var it12939" onMouseOver="hilite(12939)" onMouseOut="lolite()" onClick="logVariable('preventredirect')" href="../_variables/preventredirect.html">$preventredirect</a>) {
<a name="l2705"><span class="linenum">2705</span></a>                      throw <span class="keyword">new </span><a class="class" onClick="logClass('require_login_exception')" href="../_classes/require_login_exception.html" onMouseOver="classPopup(event,'require_login_exception')">require_login_exception</a>('Invalid course login-as access');
<a name="l2706"><span class="linenum">2706</span></a>                  }
<a name="l2707"><span class="linenum">2707</span></a>                  <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('set_context')" href="../_functions/set_context.html" onMouseOver="funcPopup(event,'set_context')">set_context</a>(null);
<a name="l2708"><span class="linenum">2708</span></a>                  echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="phpfunction" onClick="logFunction('header')" href="../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>();
<a name="l2709"><span class="linenum">2709</span></a>                  <a class="function" onClick="logFunction('notice')" href="../_functions/notice.html" onMouseOver="funcPopup(event,'notice')">notice</a>(<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('studentnotallowed', '', <a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>, true)), <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a> .'/');
<a name="l2710"><span class="linenum">2710</span></a>              }
<a name="l2711"><span class="linenum">2711</span></a>          }
<a name="l2712"><span class="linenum">2712</span></a>  
<a name="l2713"><span class="linenum">2713</span></a>          <a class="var it1026" onMouseOver="hilite(1026)" onMouseOut="lolite()" onClick="logVariable('access')" href="../_variables/access.html">$access</a> = false;
<a name="l2714"><span class="linenum">2714</span></a>  
<a name="l2715"><span class="linenum">2715</span></a>          if (<a class="function" onClick="logFunction('is_role_switched')" href="../_functions/is_role_switched.html" onMouseOver="funcPopup(event,'is_role_switched')">is_role_switched</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)) {
<a name="l2716"><span class="linenum">2716</span></a>  <span class="comment">            // Ok, user had to be inside this course before the switch.</span>
<a name="l2717"><span class="linenum">2717</span></a>              <a class="var it1026" onMouseOver="hilite(1026)" onMouseOut="lolite()" onClick="logVariable('access')" href="../_variables/access.html">$access</a> = true;
<a name="l2718"><span class="linenum">2718</span></a>  
<a name="l2719"><span class="linenum">2719</span></a>          } else if (<a class="function" onClick="logFunction('is_viewing')" href="../_functions/is_viewing.html" onMouseOver="funcPopup(event,'is_viewing')">is_viewing</a>(<a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a>, <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>)) {
<a name="l2720"><span class="linenum">2720</span></a>  <span class="comment">            // Ok, no need to mess with enrol.</span>
<a name="l2721"><span class="linenum">2721</span></a>              <a class="var it1026" onMouseOver="hilite(1026)" onMouseOut="lolite()" onClick="logVariable('access')" href="../_variables/access.html">$access</a> = true;
<a name="l2722"><span class="linenum">2722</span></a>  
<a name="l2723"><span class="linenum">2723</span></a>          } else {
<a name="l2724"><span class="linenum">2724</span></a>              if (isset(<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('enrol')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/enrol.html">enrol</a>['enrolled'][<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>])) {
<a name="l2725"><span class="linenum">2725</span></a>                  if (<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('enrol')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/enrol.html">enrol</a>['enrolled'][<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>] &gt; <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>()) {
<a name="l2726"><span class="linenum">2726</span></a>                      <a class="var it1026" onMouseOver="hilite(1026)" onMouseOut="lolite()" onClick="logVariable('access')" href="../_variables/access.html">$access</a> = true;
<a name="l2727"><span class="linenum">2727</span></a>                      if (isset(<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('enrol')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/enrol.html">enrol</a>['tempguest'][<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>])) {
<a name="l2728"><span class="linenum">2728</span></a>                          unset(<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('enrol')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/enrol.html">enrol</a>['tempguest'][<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>]);
<a name="l2729"><span class="linenum">2729</span></a>                          <a class="function" onClick="logFunction('remove_temp_course_roles')" href="../_functions/remove_temp_course_roles.html" onMouseOver="funcPopup(event,'remove_temp_course_roles')">remove_temp_course_roles</a>(<a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a>);
<a name="l2730"><span class="linenum">2730</span></a>                      }
<a name="l2731"><span class="linenum">2731</span></a>                  } else {
<a name="l2732"><span class="linenum">2732</span></a>  <span class="comment">                    // Expired.</span>
<a name="l2733"><span class="linenum">2733</span></a>                      unset(<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('enrol')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/enrol.html">enrol</a>['enrolled'][<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>]);
<a name="l2734"><span class="linenum">2734</span></a>                  }
<a name="l2735"><span class="linenum">2735</span></a>              }
<a name="l2736"><span class="linenum">2736</span></a>              if (isset(<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('enrol')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/enrol.html">enrol</a>['tempguest'][<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>])) {
<a name="l2737"><span class="linenum">2737</span></a>                  if (<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('enrol')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/enrol.html">enrol</a>['tempguest'][<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>] == 0) {
<a name="l2738"><span class="linenum">2738</span></a>                      <a class="var it1026" onMouseOver="hilite(1026)" onMouseOut="lolite()" onClick="logVariable('access')" href="../_variables/access.html">$access</a> = true;
<a name="l2739"><span class="linenum">2739</span></a>                  } else if (<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('enrol')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/enrol.html">enrol</a>['tempguest'][<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>] &gt; <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>()) {
<a name="l2740"><span class="linenum">2740</span></a>                      <a class="var it1026" onMouseOver="hilite(1026)" onMouseOut="lolite()" onClick="logVariable('access')" href="../_variables/access.html">$access</a> = true;
<a name="l2741"><span class="linenum">2741</span></a>                  } else {
<a name="l2742"><span class="linenum">2742</span></a>  <span class="comment">                    // Expired.</span>
<a name="l2743"><span class="linenum">2743</span></a>                      unset(<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('enrol')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/enrol.html">enrol</a>['tempguest'][<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>]);
<a name="l2744"><span class="linenum">2744</span></a>                      <a class="function" onClick="logFunction('remove_temp_course_roles')" href="../_functions/remove_temp_course_roles.html" onMouseOver="funcPopup(event,'remove_temp_course_roles')">remove_temp_course_roles</a>(<a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a>);
<a name="l2745"><span class="linenum">2745</span></a>                  }
<a name="l2746"><span class="linenum">2746</span></a>              }
<a name="l2747"><span class="linenum">2747</span></a>  
<a name="l2748"><span class="linenum">2748</span></a>              if (!<a class="var it1026" onMouseOver="hilite(1026)" onMouseOut="lolite()" onClick="logVariable('access')" href="../_variables/access.html">$access</a>) {
<a name="l2749"><span class="linenum">2749</span></a>  <span class="comment">                // Cache not ok.</span>
<a name="l2750"><span class="linenum">2750</span></a>                  <a class="var it12947" onMouseOver="hilite(12947)" onMouseOut="lolite()" onClick="logVariable('until')" href="../_variables/until.html">$until</a> = <a class="function" onClick="logFunction('enrol_get_enrolment_end')" href="../_functions/enrol_get_enrolment_end.html" onMouseOver="funcPopup(event,'enrol_get_enrolment_end')">enrol_get_enrolment_end</a>(<a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a>-&gt;<a onClick="logVariable('instanceid')" class="var it39493" onMouseOver="hilite(39493)" onMouseOut="lolite()" href="../_variables/instanceid.html">instanceid</a>, <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l2751"><span class="linenum">2751</span></a>                  if (<a class="var it12947" onMouseOver="hilite(12947)" onMouseOut="lolite()" onClick="logVariable('until')" href="../_variables/until.html">$until</a> !== false) {
<a name="l2752"><span class="linenum">2752</span></a>  <span class="comment">                    // Active participants may always access, a timestamp in the future, 0 (always) or false.</span>
<a name="l2753"><span class="linenum">2753</span></a>                      if (<a class="var it12947" onMouseOver="hilite(12947)" onMouseOut="lolite()" onClick="logVariable('until')" href="../_variables/until.html">$until</a> == 0) {
<a name="l2754"><span class="linenum">2754</span></a>                          <a class="var it12947" onMouseOver="hilite(12947)" onMouseOut="lolite()" onClick="logVariable('until')" href="../_variables/until.html">$until</a> = <a class="constant" onClick="logConstant('ENROL_MAX_TIMESTAMP')" href="../_constants/ENROL_MAX_TIMESTAMP.html" onMouseOver="constPopup(event,'ENROL_MAX_TIMESTAMP')">ENROL_MAX_TIMESTAMP</a>;
<a name="l2755"><span class="linenum">2755</span></a>                      }
<a name="l2756"><span class="linenum">2756</span></a>                      <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('enrol')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/enrol.html">enrol</a>['enrolled'][<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>] = <a class="var it12947" onMouseOver="hilite(12947)" onMouseOut="lolite()" onClick="logVariable('until')" href="../_variables/until.html">$until</a>;
<a name="l2757"><span class="linenum">2757</span></a>                      <a class="var it1026" onMouseOver="hilite(1026)" onMouseOut="lolite()" onClick="logVariable('access')" href="../_variables/access.html">$access</a> = true;
<a name="l2758"><span class="linenum">2758</span></a>  
<a name="l2759"><span class="linenum">2759</span></a>                  } else {
<a name="l2760"><span class="linenum">2760</span></a>                      <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array('courseid' =&gt; <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, 'status' =&gt; <a class="constant" onClick="logConstant('ENROL_INSTANCE_ENABLED')" href="../_constants/ENROL_INSTANCE_ENABLED.html" onMouseOver="constPopup(event,'ENROL_INSTANCE_ENABLED')">ENROL_INSTANCE_ENABLED</a>);
<a name="l2761"><span class="linenum">2761</span></a>                      <a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('instances')" href="../_variables/instances.html">$instances</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('enrol', <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>, 'sortorder, id ASC');
<a name="l2762"><span class="linenum">2762</span></a>                      <a class="var it3147" onMouseOver="hilite(3147)" onMouseOut="lolite()" onClick="logVariable('enrols')" href="../_variables/enrols.html">$enrols</a> = <a class="function" onClick="logFunction('enrol_get_plugins')" href="../_functions/enrol_get_plugins.html" onMouseOver="funcPopup(event,'enrol_get_plugins')">enrol_get_plugins</a>(true);
<a name="l2763"><span class="linenum">2763</span></a>  <span class="comment">                    // First ask all enabled enrol instances in course if they want to auto enrol user.</span>
<a name="l2764"><span class="linenum">2764</span></a>                      foreach (<a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('instances')" href="../_variables/instances.html">$instances</a> as <a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>) {
<a name="l2765"><span class="linenum">2765</span></a>                          if (!isset(<a class="var it3147" onMouseOver="hilite(3147)" onMouseOut="lolite()" onClick="logVariable('enrols')" href="../_variables/enrols.html">$enrols</a>[<a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('enrol')" class="var it39530" onMouseOver="hilite(39530)" onMouseOut="lolite()" href="../_variables/enrol.html">enrol</a>])) {
<a name="l2766"><span class="linenum">2766</span></a>                              continue;
<a name="l2767"><span class="linenum">2767</span></a>                          }
<a name="l2768"><span class="linenum">2768</span></a>  <span class="comment">                        // Get a duration for the enrolment, a timestamp in the future, 0 (always) or false.</span>
<a name="l2769"><span class="linenum">2769</span></a>                          <a class="var it12947" onMouseOver="hilite(12947)" onMouseOut="lolite()" onClick="logVariable('until')" href="../_variables/until.html">$until</a> = <a class="var it3147" onMouseOver="hilite(3147)" onMouseOut="lolite()" onClick="logVariable('enrols')" href="../_variables/enrols.html">$enrols</a>[<a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('enrol')" class="var it39530" onMouseOver="hilite(39530)" onMouseOut="lolite()" href="../_variables/enrol.html">enrol</a>]-&gt;<a class="function" onClick="logFunction('try_autoenrol')" href="../_functions/try_autoenrol.html" onMouseOver="funcPopup(event,'try_autoenrol')">try_autoenrol</a>(<a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>);
<a name="l2770"><span class="linenum">2770</span></a>                          if (<a class="var it12947" onMouseOver="hilite(12947)" onMouseOut="lolite()" onClick="logVariable('until')" href="../_variables/until.html">$until</a> !== false) {
<a name="l2771"><span class="linenum">2771</span></a>                              if (<a class="var it12947" onMouseOver="hilite(12947)" onMouseOut="lolite()" onClick="logVariable('until')" href="../_variables/until.html">$until</a> == 0) {
<a name="l2772"><span class="linenum">2772</span></a>                                  <a class="var it12947" onMouseOver="hilite(12947)" onMouseOut="lolite()" onClick="logVariable('until')" href="../_variables/until.html">$until</a> = <a class="constant" onClick="logConstant('ENROL_MAX_TIMESTAMP')" href="../_constants/ENROL_MAX_TIMESTAMP.html" onMouseOver="constPopup(event,'ENROL_MAX_TIMESTAMP')">ENROL_MAX_TIMESTAMP</a>;
<a name="l2773"><span class="linenum">2773</span></a>                              }
<a name="l2774"><span class="linenum">2774</span></a>                              <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('enrol')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/enrol.html">enrol</a>['enrolled'][<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>] = <a class="var it12947" onMouseOver="hilite(12947)" onMouseOut="lolite()" onClick="logVariable('until')" href="../_variables/until.html">$until</a>;
<a name="l2775"><span class="linenum">2775</span></a>                              <a class="var it1026" onMouseOver="hilite(1026)" onMouseOut="lolite()" onClick="logVariable('access')" href="../_variables/access.html">$access</a> = true;
<a name="l2776"><span class="linenum">2776</span></a>                              break;
<a name="l2777"><span class="linenum">2777</span></a>                          }
<a name="l2778"><span class="linenum">2778</span></a>                      }
<a name="l2779"><span class="linenum">2779</span></a>  <span class="comment">                    // If not enrolled yet try to gain temporary guest access.</span>
<a name="l2780"><span class="linenum">2780</span></a>                      if (!<a class="var it1026" onMouseOver="hilite(1026)" onMouseOut="lolite()" onClick="logVariable('access')" href="../_variables/access.html">$access</a>) {
<a name="l2781"><span class="linenum">2781</span></a>                          foreach (<a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('instances')" href="../_variables/instances.html">$instances</a> as <a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>) {
<a name="l2782"><span class="linenum">2782</span></a>                              if (!isset(<a class="var it3147" onMouseOver="hilite(3147)" onMouseOut="lolite()" onClick="logVariable('enrols')" href="../_variables/enrols.html">$enrols</a>[<a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('enrol')" class="var it39530" onMouseOver="hilite(39530)" onMouseOut="lolite()" href="../_variables/enrol.html">enrol</a>])) {
<a name="l2783"><span class="linenum">2783</span></a>                                  continue;
<a name="l2784"><span class="linenum">2784</span></a>                              }
<a name="l2785"><span class="linenum">2785</span></a>  <span class="comment">                            // Get a duration for the guest access, a timestamp in the future or false.</span>
<a name="l2786"><span class="linenum">2786</span></a>                              <a class="var it12947" onMouseOver="hilite(12947)" onMouseOut="lolite()" onClick="logVariable('until')" href="../_variables/until.html">$until</a> = <a class="var it3147" onMouseOver="hilite(3147)" onMouseOut="lolite()" onClick="logVariable('enrols')" href="../_variables/enrols.html">$enrols</a>[<a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('enrol')" class="var it39530" onMouseOver="hilite(39530)" onMouseOut="lolite()" href="../_variables/enrol.html">enrol</a>]-&gt;<a class="function" onClick="logFunction('try_guestaccess')" href="../_functions/try_guestaccess.html" onMouseOver="funcPopup(event,'try_guestaccess')">try_guestaccess</a>(<a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>);
<a name="l2787"><span class="linenum">2787</span></a>                              if (<a class="var it12947" onMouseOver="hilite(12947)" onMouseOut="lolite()" onClick="logVariable('until')" href="../_variables/until.html">$until</a> !== false and <a class="var it12947" onMouseOver="hilite(12947)" onMouseOut="lolite()" onClick="logVariable('until')" href="../_variables/until.html">$until</a> &gt; <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>()) {
<a name="l2788"><span class="linenum">2788</span></a>                                  <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('enrol')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/enrol.html">enrol</a>['tempguest'][<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>] = <a class="var it12947" onMouseOver="hilite(12947)" onMouseOut="lolite()" onClick="logVariable('until')" href="../_variables/until.html">$until</a>;
<a name="l2789"><span class="linenum">2789</span></a>                                  <a class="var it1026" onMouseOver="hilite(1026)" onMouseOut="lolite()" onClick="logVariable('access')" href="../_variables/access.html">$access</a> = true;
<a name="l2790"><span class="linenum">2790</span></a>                                  break;
<a name="l2791"><span class="linenum">2791</span></a>                              }
<a name="l2792"><span class="linenum">2792</span></a>                          }
<a name="l2793"><span class="linenum">2793</span></a>                      }
<a name="l2794"><span class="linenum">2794</span></a>                  }
<a name="l2795"><span class="linenum">2795</span></a>              }
<a name="l2796"><span class="linenum">2796</span></a>          }
<a name="l2797"><span class="linenum">2797</span></a>  
<a name="l2798"><span class="linenum">2798</span></a>          if (!<a class="var it1026" onMouseOver="hilite(1026)" onMouseOut="lolite()" onClick="logVariable('access')" href="../_variables/access.html">$access</a>) {
<a name="l2799"><span class="linenum">2799</span></a>              if (<a class="var it12939" onMouseOver="hilite(12939)" onMouseOut="lolite()" onClick="logVariable('preventredirect')" href="../_variables/preventredirect.html">$preventredirect</a>) {
<a name="l2800"><span class="linenum">2800</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('require_login_exception')" href="../_classes/require_login_exception.html" onMouseOver="classPopup(event,'require_login_exception')">require_login_exception</a>('Not enrolled');
<a name="l2801"><span class="linenum">2801</span></a>              }
<a name="l2802"><span class="linenum">2802</span></a>              if (<a class="var it12938" onMouseOver="hilite(12938)" onMouseOut="lolite()" onClick="logVariable('setwantsurltome')" href="../_variables/setwantsurltome.html">$setwantsurltome</a>) {
<a name="l2803"><span class="linenum">2803</span></a>                  <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/wantsurl.html">wantsurl</a> = <a class="function" onClick="logFunction('qualified_me')" href="../_functions/qualified_me.html" onMouseOver="funcPopup(event,'qualified_me')">qualified_me</a>();
<a name="l2804"><span class="linenum">2804</span></a>              }
<a name="l2805"><span class="linenum">2805</span></a>              <a class="function" onClick="logFunction('redirect')" href="../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a> .'/enrol/index.php?id='. <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l2806"><span class="linenum">2806</span></a>          }
<a name="l2807"><span class="linenum">2807</span></a>      }
<a name="l2808"><span class="linenum">2808</span></a>  
<a name="l2809"><span class="linenum">2809</span></a>  <span class="comment">    // Set the global $COURSE.</span>
<a name="l2810"><span class="linenum">2810</span></a>  <span class="comment">    // TODO MDL-49434: setting current course/cm should be after the check $cm-&gt;uservisible .</span>
<a name="l2811"><span class="linenum">2811</span></a>      if (<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>) {
<a name="l2812"><span class="linenum">2812</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('set_cm')" href="../_functions/set_cm.html" onMouseOver="funcPopup(event,'set_cm')">set_cm</a>(<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>, <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>);
<a name="l2813"><span class="linenum">2813</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('set_pagelayout')" href="../_functions/set_pagelayout.html" onMouseOver="funcPopup(event,'set_pagelayout')">set_pagelayout</a>('incourse');
<a name="l2814"><span class="linenum">2814</span></a>      } else if (!empty(<a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>)) {
<a name="l2815"><span class="linenum">2815</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('set_course')" href="../_functions/set_course.html" onMouseOver="funcPopup(event,'set_course')">set_course</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>);
<a name="l2816"><span class="linenum">2816</span></a>      }
<a name="l2817"><span class="linenum">2817</span></a>  
<a name="l2818"><span class="linenum">2818</span></a>  <span class="comment">    // Check visibility of activity to current user; includes visible flag, conditional availability, etc.</span>
<a name="l2819"><span class="linenum">2819</span></a>      if (<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a> &amp;&amp; !<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('uservisible')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../_variables/uservisible.html">uservisible</a>) {
<a name="l2820"><span class="linenum">2820</span></a>          if (<a class="var it12939" onMouseOver="hilite(12939)" onMouseOut="lolite()" onClick="logVariable('preventredirect')" href="../_variables/preventredirect.html">$preventredirect</a>) {
<a name="l2821"><span class="linenum">2821</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('require_login_exception')" href="../_classes/require_login_exception.html" onMouseOver="classPopup(event,'require_login_exception')">require_login_exception</a>('Activity is hidden');
<a name="l2822"><span class="linenum">2822</span></a>          }
<a name="l2823"><span class="linenum">2823</span></a>          if (<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a> != <a class="constant" onClick="logConstant('SITEID')" href="../_constants/SITEID.html" onMouseOver="constPopup(event,'SITEID')">SITEID</a>) {
<a name="l2824"><span class="linenum">2824</span></a>              <a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('url')" href="../_variables/url.html">$url</a> = <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../course/view.php.html">/course/view.php</a>', array('id' =&gt; <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l2825"><span class="linenum">2825</span></a>          } else {
<a name="l2826"><span class="linenum">2826</span></a>              <a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('url')" href="../_variables/url.html">$url</a> = <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('/');
<a name="l2827"><span class="linenum">2827</span></a>          }
<a name="l2828"><span class="linenum">2828</span></a>          <a class="function" onClick="logFunction('redirect')" href="../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('url')" href="../_variables/url.html">$url</a>, <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('activityiscurrentlyhidden'));
<a name="l2829"><span class="linenum">2829</span></a>      }
<a name="l2830"><span class="linenum">2830</span></a>  
<a name="l2831"><span class="linenum">2831</span></a>  <span class="comment">    // Finally access granted, update lastaccess times.</span>
<a name="l2832"><span class="linenum">2832</span></a>      <a class="function" onClick="logFunction('user_accesstime_log')" href="../_functions/user_accesstime_log.html" onMouseOver="funcPopup(event,'user_accesstime_log')">user_accesstime_log</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l2833"><span class="linenum">2833</span></a>  }
<a name="l2834"><span class="linenum">2834</span></a>  
<a name="l2835"><span class="linenum">2835</span></a>  
<a name="l2836"><span class="linenum">2836</span></a>  <span class="comment">/**</span>
<a name="l2837"><span class="linenum">2837</span></a>  <span class="comment"> * This function just makes sure a user is logged out.</span>
<a name="l2838"><span class="linenum">2838</span></a>  <span class="comment"> *</span>
<a name="l2839"><span class="linenum">2839</span></a>  <span class="comment"> * @package    core_access</span>
<a name="l2840"><span class="linenum">2840</span></a>  <span class="comment"> * @category   access</span>
<a name="l2841"><span class="linenum">2841</span></a>  <span class="comment"> */</span>
<a name="l2842"><span class="linenum">2842</span></a>  function <a class="function" onClick="logFunction('require_logout')" href="../_functions/require_logout.html" onMouseOver="funcPopup(event,'require_logout')">require_logout</a>() {
<a name="l2843"><span class="linenum">2843</span></a>      global <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l2844"><span class="linenum">2844</span></a>  
<a name="l2845"><span class="linenum">2845</span></a>      if (!<a class="function" onClick="logFunction('isloggedin')" href="../_functions/isloggedin.html" onMouseOver="funcPopup(event,'isloggedin')">isloggedin</a>()) {
<a name="l2846"><span class="linenum">2846</span></a>  <span class="comment">        // This should not happen often, no need for hooks or events here.</span>
<a name="l2847"><span class="linenum">2847</span></a>          \core\session\<a class="class" onClick="logClass('manager')" href="../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('terminate_current')" href="../_functions/terminate_current.html" onMouseOver="funcPopup(event,'terminate_current')">terminate_current</a>();
<a name="l2848"><span class="linenum">2848</span></a>          return;
<a name="l2849"><span class="linenum">2849</span></a>      }
<a name="l2850"><span class="linenum">2850</span></a>  
<a name="l2851"><span class="linenum">2851</span></a>  <span class="comment">    // Execute hooks before action.</span>
<a name="l2852"><span class="linenum">2852</span></a>      <a class="var it12948" onMouseOver="hilite(12948)" onMouseOut="lolite()" onClick="logVariable('authplugins')" href="../_variables/authplugins.html">$authplugins</a> = array();
<a name="l2853"><span class="linenum">2853</span></a>      <a class="var it4813" onMouseOver="hilite(4813)" onMouseOut="lolite()" onClick="logVariable('authsequence')" href="../_variables/authsequence.html">$authsequence</a> = <a class="function" onClick="logFunction('get_enabled_auth_plugins')" href="../_functions/get_enabled_auth_plugins.html" onMouseOver="funcPopup(event,'get_enabled_auth_plugins')">get_enabled_auth_plugins</a>();
<a name="l2854"><span class="linenum">2854</span></a>      foreach (<a class="var it4813" onMouseOver="hilite(4813)" onMouseOut="lolite()" onClick="logVariable('authsequence')" href="../_variables/authsequence.html">$authsequence</a> as <a class="var it4814" onMouseOver="hilite(4814)" onMouseOut="lolite()" onClick="logVariable('authname')" href="../_variables/authname.html">$authname</a>) {
<a name="l2855"><span class="linenum">2855</span></a>          <a class="var it12948" onMouseOver="hilite(12948)" onMouseOut="lolite()" onClick="logVariable('authplugins')" href="../_variables/authplugins.html">$authplugins</a>[<a class="var it4814" onMouseOver="hilite(4814)" onMouseOut="lolite()" onClick="logVariable('authname')" href="../_variables/authname.html">$authname</a>] = <a class="function" onClick="logFunction('get_auth_plugin')" href="../_functions/get_auth_plugin.html" onMouseOver="funcPopup(event,'get_auth_plugin')">get_auth_plugin</a>(<a class="var it4814" onMouseOver="hilite(4814)" onMouseOut="lolite()" onClick="logVariable('authname')" href="../_variables/authname.html">$authname</a>);
<a name="l2856"><span class="linenum">2856</span></a>          <a class="var it12948" onMouseOver="hilite(12948)" onMouseOut="lolite()" onClick="logVariable('authplugins')" href="../_variables/authplugins.html">$authplugins</a>[<a class="var it4814" onMouseOver="hilite(4814)" onMouseOut="lolite()" onClick="logVariable('authname')" href="../_variables/authname.html">$authname</a>]-&gt;<a class="function" onClick="logFunction('prelogout_hook')" href="../_functions/prelogout_hook.html" onMouseOver="funcPopup(event,'prelogout_hook')">prelogout_hook</a>();
<a name="l2857"><span class="linenum">2857</span></a>      }
<a name="l2858"><span class="linenum">2858</span></a>  
<a name="l2859"><span class="linenum">2859</span></a>  <span class="comment">    // Store info that gets removed during logout.</span>
<a name="l2860"><span class="linenum">2860</span></a>      <a class="var it3991" onMouseOver="hilite(3991)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../_variables/sid.html">$sid</a> = <a class="phpfunction" onClick="logFunction('session_id')" href="../_functions/session_id.html" onMouseOver="phpfuncPopup(event,'session_id')">session_id</a>();
<a name="l2861"><span class="linenum">2861</span></a>      <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a> = \core\event\<a class="class" onClick="logClass('user_loggedout')" href="../_classes/user_loggedout.html" onMouseOver="classPopup(event,'user_loggedout')">user_loggedout</a>::<a class="function" onClick="logFunction('create')" href="../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(
<a name="l2862"><span class="linenum">2862</span></a>          array(
<a name="l2863"><span class="linenum">2863</span></a>              'userid' =&gt; <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l2864"><span class="linenum">2864</span></a>              'objectid' =&gt; <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l2865"><span class="linenum">2865</span></a>              'other' =&gt; array('sessionid' =&gt; <a class="var it3991" onMouseOver="hilite(3991)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../_variables/sid.html">$sid</a>),
<a name="l2866"><span class="linenum">2866</span></a>          )
<a name="l2867"><span class="linenum">2867</span></a>      );
<a name="l2868"><span class="linenum">2868</span></a>      if (<a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('session')" href="../_variables/session.html">$session</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('sessions', array('sid'=&gt;<a class="var it3991" onMouseOver="hilite(3991)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../_variables/sid.html">$sid</a>))) {
<a name="l2869"><span class="linenum">2869</span></a>          <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('sessions', <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('session')" href="../_variables/session.html">$session</a>);
<a name="l2870"><span class="linenum">2870</span></a>      }
<a name="l2871"><span class="linenum">2871</span></a>  
<a name="l2872"><span class="linenum">2872</span></a>  <span class="comment">    // Clone of $USER object to be used by auth plugins.</span>
<a name="l2873"><span class="linenum">2873</span></a>      <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="function" onClick="logFunction('fullclone')" href="../_functions/fullclone.html" onMouseOver="funcPopup(event,'fullclone')">fullclone</a>(<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>);
<a name="l2874"><span class="linenum">2874</span></a>  
<a name="l2875"><span class="linenum">2875</span></a>  <span class="comment">    // Delete session record and drop $_SESSION content.</span>
<a name="l2876"><span class="linenum">2876</span></a>      \core\session\<a class="class" onClick="logClass('manager')" href="../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('terminate_current')" href="../_functions/terminate_current.html" onMouseOver="funcPopup(event,'terminate_current')">terminate_current</a>();
<a name="l2877"><span class="linenum">2877</span></a>  
<a name="l2878"><span class="linenum">2878</span></a>  <span class="comment">    // Trigger event AFTER action.</span>
<a name="l2879"><span class="linenum">2879</span></a>      <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l2880"><span class="linenum">2880</span></a>  
<a name="l2881"><span class="linenum">2881</span></a>  <span class="comment">    // Hook to execute auth plugins redirection after event trigger.</span>
<a name="l2882"><span class="linenum">2882</span></a>      foreach (<a class="var it12948" onMouseOver="hilite(12948)" onMouseOut="lolite()" onClick="logVariable('authplugins')" href="../_variables/authplugins.html">$authplugins</a> as <a class="var it4020" onMouseOver="hilite(4020)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../_variables/authplugin.html">$authplugin</a>) {
<a name="l2883"><span class="linenum">2883</span></a>          <a class="var it4020" onMouseOver="hilite(4020)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../_variables/authplugin.html">$authplugin</a>-&gt;<a class="function" onClick="logFunction('postlogout_hook')" href="../_functions/postlogout_hook.html" onMouseOver="funcPopup(event,'postlogout_hook')">postlogout_hook</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l2884"><span class="linenum">2884</span></a>      }
<a name="l2885"><span class="linenum">2885</span></a>  }
<a name="l2886"><span class="linenum">2886</span></a>  
<a name="l2887"><span class="linenum">2887</span></a>  <span class="comment">/**</span>
<a name="l2888"><span class="linenum">2888</span></a>  <span class="comment"> * Weaker version of require_login()</span>
<a name="l2889"><span class="linenum">2889</span></a>  <span class="comment"> *</span>
<a name="l2890"><span class="linenum">2890</span></a>  <span class="comment"> * This is a weaker version of {@link require_login()} which only requires login</span>
<a name="l2891"><span class="linenum">2891</span></a>  <span class="comment"> * when called from within a course rather than the site page, unless</span>
<a name="l2892"><span class="linenum">2892</span></a>  <span class="comment"> * the forcelogin option is turned on.</span>
<a name="l2893"><span class="linenum">2893</span></a>  <span class="comment"> * @see require_login()</span>
<a name="l2894"><span class="linenum">2894</span></a>  <span class="comment"> *</span>
<a name="l2895"><span class="linenum">2895</span></a>  <span class="comment"> * @package    core_access</span>
<a name="l2896"><span class="linenum">2896</span></a>  <span class="comment"> * @category   access</span>
<a name="l2897"><span class="linenum">2897</span></a>  <span class="comment"> *</span>
<a name="l2898"><span class="linenum">2898</span></a>  <span class="comment"> * @param mixed $courseorid The course object or id in question</span>
<a name="l2899"><span class="linenum">2899</span></a>  <span class="comment"> * @param bool $autologinguest Allow autologin guests if that is wanted</span>
<a name="l2900"><span class="linenum">2900</span></a>  <span class="comment"> * @param object $cm Course activity module if known</span>
<a name="l2901"><span class="linenum">2901</span></a>  <span class="comment"> * @param bool $setwantsurltome Define if we want to set $SESSION-&gt;wantsurl, defaults to</span>
<a name="l2902"><span class="linenum">2902</span></a>  <span class="comment"> *             true. Used to avoid (=false) some scripts (file.php...) to set that variable,</span>
<a name="l2903"><span class="linenum">2903</span></a>  <span class="comment"> *             in order to keep redirects working properly. MDL-14495</span>
<a name="l2904"><span class="linenum">2904</span></a>  <span class="comment"> * @param bool $preventredirect set to true in scripts that can not redirect (CLI, rss feeds, etc.), throws exceptions</span>
<a name="l2905"><span class="linenum">2905</span></a>  <span class="comment"> * @return void</span>
<a name="l2906"><span class="linenum">2906</span></a>  <span class="comment"> * @throws coding_exception</span>
<a name="l2907"><span class="linenum">2907</span></a>  <span class="comment"> */</span>
<a name="l2908"><span class="linenum">2908</span></a>  function <a class="function" onClick="logFunction('require_course_login')" href="../_functions/require_course_login.html" onMouseOver="funcPopup(event,'require_course_login')">require_course_login</a>(<a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>, <a class="var it12937" onMouseOver="hilite(12937)" onMouseOut="lolite()" onClick="logVariable('autologinguest')" href="../_variables/autologinguest.html">$autologinguest</a> = true, <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a> = null, <a class="var it12938" onMouseOver="hilite(12938)" onMouseOut="lolite()" onClick="logVariable('setwantsurltome')" href="../_variables/setwantsurltome.html">$setwantsurltome</a> = true, <a class="var it12939" onMouseOver="hilite(12939)" onMouseOut="lolite()" onClick="logVariable('preventredirect')" href="../_variables/preventredirect.html">$preventredirect</a> = false) {
<a name="l2909"><span class="linenum">2909</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>, <a class="var it1063" onMouseOver="hilite(1063)" onMouseOut="lolite()" onClick="logVariable('SITE')" href="../_variables/SITE.html">$SITE</a>;
<a name="l2910"><span class="linenum">2910</span></a>      <a class="var it12949" onMouseOver="hilite(12949)" onMouseOut="lolite()" onClick="logVariable('issite')" href="../_variables/issite.html">$issite</a> = ((<a class="phpfunction" onClick="logFunction('is_object')" href="../_functions/is_object.html" onMouseOver="phpfuncPopup(event,'is_object')">is_object</a>(<a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>) and <a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>-&gt;<a onClick="logVariable('id')" class="var it41059" onMouseOver="hilite(41059)" onMouseOut="lolite()" href="../_variables/id.html">id</a> == <a class="constant" onClick="logConstant('SITEID')" href="../_constants/SITEID.html" onMouseOver="constPopup(event,'SITEID')">SITEID</a>)
<a name="l2911"><span class="linenum">2911</span></a>            <a class="function" onClick="logFunction('or')" href="../_functions/or.html" onMouseOver="funcPopup(event,'or')">or</a> (!<a class="phpfunction" onClick="logFunction('is_object')" href="../_functions/is_object.html" onMouseOver="phpfuncPopup(event,'is_object')">is_object</a>(<a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>) and <a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a> == <a class="constant" onClick="logConstant('SITEID')" href="../_constants/SITEID.html" onMouseOver="constPopup(event,'SITEID')">SITEID</a>));
<a name="l2912"><span class="linenum">2912</span></a>      if (<a class="var it12949" onMouseOver="hilite(12949)" onMouseOut="lolite()" onClick="logVariable('issite')" href="../_variables/issite.html">$issite</a> &amp;&amp; !empty(<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>) &amp;&amp; !(<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a> instanceof cm_info)) {
<a name="l2913"><span class="linenum">2913</span></a>  <span class="comment">        // Note: nearly all pages call get_fast_modinfo anyway and it does not make any</span>
<a name="l2914"><span class="linenum">2914</span></a>  <span class="comment">        // db queries so this is not really a performance concern, however it is obviously</span>
<a name="l2915"><span class="linenum">2915</span></a>  <span class="comment">        // better if you use get_fast_modinfo to get the cm before calling this.</span>
<a name="l2916"><span class="linenum">2916</span></a>          if (<a class="phpfunction" onClick="logFunction('is_object')" href="../_functions/is_object.html" onMouseOver="phpfuncPopup(event,'is_object')">is_object</a>(<a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>)) {
<a name="l2917"><span class="linenum">2917</span></a>              <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a> = <a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>;
<a name="l2918"><span class="linenum">2918</span></a>          } else {
<a name="l2919"><span class="linenum">2919</span></a>              <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a> = <a class="function" onClick="logFunction('clone')" href="../_functions/clone.html" onMouseOver="funcPopup(event,'clone')">clone</a>(<a class="var it1063" onMouseOver="hilite(1063)" onMouseOut="lolite()" onClick="logVariable('SITE')" href="../_variables/SITE.html">$SITE</a>);
<a name="l2920"><span class="linenum">2920</span></a>          }
<a name="l2921"><span class="linenum">2921</span></a>          <a class="var it1702" onMouseOver="hilite(1702)" onMouseOut="lolite()" onClick="logVariable('modinfo')" href="../_variables/modinfo.html">$modinfo</a> = <a class="function" onClick="logFunction('get_fast_modinfo')" href="../_functions/get_fast_modinfo.html" onMouseOver="funcPopup(event,'get_fast_modinfo')">get_fast_modinfo</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>);
<a name="l2922"><span class="linenum">2922</span></a>          <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a> = <a class="var it1702" onMouseOver="hilite(1702)" onMouseOut="lolite()" onClick="logVariable('modinfo')" href="../_variables/modinfo.html">$modinfo</a>-&gt;<a class="function" onClick="logFunction('get_cm')" href="../_functions/get_cm.html" onMouseOver="funcPopup(event,'get_cm')">get_cm</a>(<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l2923"><span class="linenum">2923</span></a>      }
<a name="l2924"><span class="linenum">2924</span></a>      if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('forcelogin')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/forcelogin.html">forcelogin</a>)) {
<a name="l2925"><span class="linenum">2925</span></a>  <span class="comment">        // Login required for both SITE and courses.</span>
<a name="l2926"><span class="linenum">2926</span></a>          <a class="function" onClick="logFunction('require_login')" href="../_functions/require_login.html" onMouseOver="funcPopup(event,'require_login')">require_login</a>(<a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>, <a class="var it12937" onMouseOver="hilite(12937)" onMouseOut="lolite()" onClick="logVariable('autologinguest')" href="../_variables/autologinguest.html">$autologinguest</a>, <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>, <a class="var it12938" onMouseOver="hilite(12938)" onMouseOut="lolite()" onClick="logVariable('setwantsurltome')" href="../_variables/setwantsurltome.html">$setwantsurltome</a>, <a class="var it12939" onMouseOver="hilite(12939)" onMouseOut="lolite()" onClick="logVariable('preventredirect')" href="../_variables/preventredirect.html">$preventredirect</a>);
<a name="l2927"><span class="linenum">2927</span></a>  
<a name="l2928"><span class="linenum">2928</span></a>      } else if (<a class="var it12949" onMouseOver="hilite(12949)" onMouseOut="lolite()" onClick="logVariable('issite')" href="../_variables/issite.html">$issite</a> &amp;&amp; !empty(<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>) and !<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('uservisible')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../_variables/uservisible.html">uservisible</a>) {
<a name="l2929"><span class="linenum">2929</span></a>  <span class="comment">        // Always login for hidden activities.</span>
<a name="l2930"><span class="linenum">2930</span></a>          <a class="function" onClick="logFunction('require_login')" href="../_functions/require_login.html" onMouseOver="funcPopup(event,'require_login')">require_login</a>(<a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>, <a class="var it12937" onMouseOver="hilite(12937)" onMouseOut="lolite()" onClick="logVariable('autologinguest')" href="../_variables/autologinguest.html">$autologinguest</a>, <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>, <a class="var it12938" onMouseOver="hilite(12938)" onMouseOut="lolite()" onClick="logVariable('setwantsurltome')" href="../_variables/setwantsurltome.html">$setwantsurltome</a>, <a class="var it12939" onMouseOver="hilite(12939)" onMouseOut="lolite()" onClick="logVariable('preventredirect')" href="../_variables/preventredirect.html">$preventredirect</a>);
<a name="l2931"><span class="linenum">2931</span></a>  
<a name="l2932"><span class="linenum">2932</span></a>      } else if (<a class="var it12949" onMouseOver="hilite(12949)" onMouseOut="lolite()" onClick="logVariable('issite')" href="../_variables/issite.html">$issite</a>) {
<a name="l2933"><span class="linenum">2933</span></a>  <span class="comment">        // Login for SITE not required.</span>
<a name="l2934"><span class="linenum">2934</span></a>  <span class="comment">        // We still need to instatiate PAGE vars properly so that things that rely on it like navigation function correctly.</span>
<a name="l2935"><span class="linenum">2935</span></a>          if (!empty(<a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>)) {
<a name="l2936"><span class="linenum">2936</span></a>              if (<a class="phpfunction" onClick="logFunction('is_object')" href="../_functions/is_object.html" onMouseOver="phpfuncPopup(event,'is_object')">is_object</a>(<a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>)) {
<a name="l2937"><span class="linenum">2937</span></a>                  <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a> = <a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>;
<a name="l2938"><span class="linenum">2938</span></a>              } else {
<a name="l2939"><span class="linenum">2939</span></a>                  <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a> = clone <a class="var it1063" onMouseOver="hilite(1063)" onMouseOut="lolite()" onClick="logVariable('SITE')" href="../_variables/SITE.html">$SITE</a>;
<a name="l2940"><span class="linenum">2940</span></a>              }
<a name="l2941"><span class="linenum">2941</span></a>              if (<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>) {
<a name="l2942"><span class="linenum">2942</span></a>                  if (<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('course')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../_variables/course.html">course</a> != <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>) {
<a name="l2943"><span class="linenum">2943</span></a>                      throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('course and cm parameters in <a class="function" onClick="logFunction('require_course_login')" href="../_functions/require_course_login.html" onMouseOver="funcPopup(event,'require_course_login')">require_course_login</a>() call do not match!!');
<a name="l2944"><span class="linenum">2944</span></a>                  }
<a name="l2945"><span class="linenum">2945</span></a>                  <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('set_cm')" href="../_functions/set_cm.html" onMouseOver="funcPopup(event,'set_cm')">set_cm</a>(<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>, <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>);
<a name="l2946"><span class="linenum">2946</span></a>                  <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('set_pagelayout')" href="../_functions/set_pagelayout.html" onMouseOver="funcPopup(event,'set_pagelayout')">set_pagelayout</a>('incourse');
<a name="l2947"><span class="linenum">2947</span></a>              } else {
<a name="l2948"><span class="linenum">2948</span></a>                  <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('set_course')" href="../_functions/set_course.html" onMouseOver="funcPopup(event,'set_course')">set_course</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>);
<a name="l2949"><span class="linenum">2949</span></a>              }
<a name="l2950"><span class="linenum">2950</span></a>          } else {
<a name="l2951"><span class="linenum">2951</span></a>  <span class="comment">            // If $PAGE-&gt;course, and hence $PAGE-&gt;context, have not already been set up properly, set them up now.</span>
<a name="l2952"><span class="linenum">2952</span></a>              <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('set_course')" href="../_functions/set_course.html" onMouseOver="funcPopup(event,'set_course')">set_course</a>(<a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>-&gt;<a onClick="logVariable('course')" class="var it39443" onMouseOver="hilite(39443)" onMouseOut="lolite()" href="../_variables/course.html">course</a>);
<a name="l2953"><span class="linenum">2953</span></a>          }
<a name="l2954"><span class="linenum">2954</span></a>          <a class="function" onClick="logFunction('user_accesstime_log')" href="../_functions/user_accesstime_log.html" onMouseOver="funcPopup(event,'user_accesstime_log')">user_accesstime_log</a>(<a class="constant" onClick="logConstant('SITEID')" href="../_constants/SITEID.html" onMouseOver="constPopup(event,'SITEID')">SITEID</a>);
<a name="l2955"><span class="linenum">2955</span></a>          return;
<a name="l2956"><span class="linenum">2956</span></a>  
<a name="l2957"><span class="linenum">2957</span></a>      } else {
<a name="l2958"><span class="linenum">2958</span></a>  <span class="comment">        // Course login always required.</span>
<a name="l2959"><span class="linenum">2959</span></a>          <a class="function" onClick="logFunction('require_login')" href="../_functions/require_login.html" onMouseOver="funcPopup(event,'require_login')">require_login</a>(<a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>, <a class="var it12937" onMouseOver="hilite(12937)" onMouseOut="lolite()" onClick="logVariable('autologinguest')" href="../_variables/autologinguest.html">$autologinguest</a>, <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>, <a class="var it12938" onMouseOver="hilite(12938)" onMouseOut="lolite()" onClick="logVariable('setwantsurltome')" href="../_variables/setwantsurltome.html">$setwantsurltome</a>, <a class="var it12939" onMouseOver="hilite(12939)" onMouseOut="lolite()" onClick="logVariable('preventredirect')" href="../_variables/preventredirect.html">$preventredirect</a>);
<a name="l2960"><span class="linenum">2960</span></a>      }
<a name="l2961"><span class="linenum">2961</span></a>  }
<a name="l2962"><span class="linenum">2962</span></a>  
<a name="l2963"><span class="linenum">2963</span></a>  <span class="comment">/**</span>
<a name="l2964"><span class="linenum">2964</span></a>  <span class="comment"> * Require key login. Function terminates with error if key not found or incorrect.</span>
<a name="l2965"><span class="linenum">2965</span></a>  <span class="comment"> *</span>
<a name="l2966"><span class="linenum">2966</span></a>  <span class="comment"> * @uses NO_MOODLE_COOKIES</span>
<a name="l2967"><span class="linenum">2967</span></a>  <span class="comment"> * @uses PARAM_ALPHANUM</span>
<a name="l2968"><span class="linenum">2968</span></a>  <span class="comment"> * @param string $script unique script identifier</span>
<a name="l2969"><span class="linenum">2969</span></a>  <span class="comment"> * @param int $instance optional instance id</span>
<a name="l2970"><span class="linenum">2970</span></a>  <span class="comment"> * @return int Instance ID</span>
<a name="l2971"><span class="linenum">2971</span></a>  <span class="comment"> */</span>
<a name="l2972"><span class="linenum">2972</span></a>  function <a class="function" onClick="logFunction('require_user_key_login')" href="../_functions/require_user_key_login.html" onMouseOver="funcPopup(event,'require_user_key_login')">require_user_key_login</a>(<a class="var it1385" onMouseOver="hilite(1385)" onMouseOut="lolite()" onClick="logVariable('script')" href="../_variables/script.html">$script</a>, <a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>=null) {
<a name="l2973"><span class="linenum">2973</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l2974"><span class="linenum">2974</span></a>  
<a name="l2975"><span class="linenum">2975</span></a>      if (!<a class="constant" onClick="logConstant('NO_MOODLE_COOKIES')" href="../_constants/NO_MOODLE_COOKIES.html" onMouseOver="constPopup(event,'NO_MOODLE_COOKIES')">NO_MOODLE_COOKIES</a>) {
<a name="l2976"><span class="linenum">2976</span></a>          <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('sessioncookiesdisable');
<a name="l2977"><span class="linenum">2977</span></a>      }
<a name="l2978"><span class="linenum">2978</span></a>  
<a name="l2979"><span class="linenum">2979</span></a>  <span class="comment">    // Extra safety.</span>
<a name="l2980"><span class="linenum">2980</span></a>      \core\session\<a class="class" onClick="logClass('manager')" href="../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('write_close')" href="../_functions/write_close.html" onMouseOver="funcPopup(event,'write_close')">write_close</a>();
<a name="l2981"><span class="linenum">2981</span></a>  
<a name="l2982"><span class="linenum">2982</span></a>      <a class="var it12950" onMouseOver="hilite(12950)" onMouseOut="lolite()" onClick="logVariable('keyvalue')" href="../_variables/keyvalue.html">$keyvalue</a> = <a class="function" onClick="logFunction('required_param')" href="../_functions/required_param.html" onMouseOver="funcPopup(event,'required_param')">required_param</a>('key', <a class="constant" onClick="logConstant('PARAM_ALPHANUM')" href="../_constants/PARAM_ALPHANUM.html" onMouseOver="constPopup(event,'PARAM_ALPHANUM')">PARAM_ALPHANUM</a>);
<a name="l2983"><span class="linenum">2983</span></a>  
<a name="l2984"><span class="linenum">2984</span></a>      if (!<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user_private_key', array('script' =&gt; <a class="var it1385" onMouseOver="hilite(1385)" onMouseOut="lolite()" onClick="logVariable('script')" href="../_variables/script.html">$script</a>, 'value' =&gt; <a class="var it12950" onMouseOver="hilite(12950)" onMouseOut="lolite()" onClick="logVariable('keyvalue')" href="../_variables/keyvalue.html">$keyvalue</a>, 'instance' =&gt; <a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>))) {
<a name="l2985"><span class="linenum">2985</span></a>          <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('invalidkey');
<a name="l2986"><span class="linenum">2986</span></a>      }
<a name="l2987"><span class="linenum">2987</span></a>  
<a name="l2988"><span class="linenum">2988</span></a>      if (!empty(<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>-&gt;<a onClick="logVariable('validuntil')" class="var it39505" onMouseOver="hilite(39505)" onMouseOut="lolite()" href="../_variables/validuntil.html">validuntil</a>) and <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>-&gt;<a onClick="logVariable('validuntil')" class="var it39505" onMouseOver="hilite(39505)" onMouseOut="lolite()" href="../_variables/validuntil.html">validuntil</a> &lt; <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>()) {
<a name="l2989"><span class="linenum">2989</span></a>          <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('expiredkey');
<a name="l2990"><span class="linenum">2990</span></a>      }
<a name="l2991"><span class="linenum">2991</span></a>  
<a name="l2992"><span class="linenum">2992</span></a>      if (<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>-&gt;<a onClick="logVariable('iprestriction')" class="var it39505" onMouseOver="hilite(39505)" onMouseOut="lolite()" href="../_variables/iprestriction.html">iprestriction</a>) {
<a name="l2993"><span class="linenum">2993</span></a>          <a class="var it4680" onMouseOver="hilite(4680)" onMouseOut="lolite()" onClick="logVariable('remoteaddr')" href="../_variables/remoteaddr.html">$remoteaddr</a> = <a class="function" onClick="logFunction('getremoteaddr')" href="../_functions/getremoteaddr.html" onMouseOver="funcPopup(event,'getremoteaddr')">getremoteaddr</a>(null);
<a name="l2994"><span class="linenum">2994</span></a>          if (empty(<a class="var it4680" onMouseOver="hilite(4680)" onMouseOut="lolite()" onClick="logVariable('remoteaddr')" href="../_variables/remoteaddr.html">$remoteaddr</a>) or !<a class="function" onClick="logFunction('address_in_subnet')" href="../_functions/address_in_subnet.html" onMouseOver="funcPopup(event,'address_in_subnet')">address_in_subnet</a>(<a class="var it4680" onMouseOver="hilite(4680)" onMouseOut="lolite()" onClick="logVariable('remoteaddr')" href="../_variables/remoteaddr.html">$remoteaddr</a>, <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>-&gt;<a onClick="logVariable('iprestriction')" class="var it39505" onMouseOver="hilite(39505)" onMouseOut="lolite()" href="../_variables/iprestriction.html">iprestriction</a>)) {
<a name="l2995"><span class="linenum">2995</span></a>              <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('ipmismatch');
<a name="l2996"><span class="linenum">2996</span></a>          }
<a name="l2997"><span class="linenum">2997</span></a>      }
<a name="l2998"><span class="linenum">2998</span></a>  
<a name="l2999"><span class="linenum">2999</span></a>      if (!<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user', array('id' =&gt; <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>-&gt;<a onClick="logVariable('userid')" class="var it39505" onMouseOver="hilite(39505)" onMouseOut="lolite()" href="../_variables/userid.html">userid</a>))) {
<a name="l3000"><span class="linenum">3000</span></a>          <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('invaliduserid');
<a name="l3001"><span class="linenum">3001</span></a>      }
<a name="l3002"><span class="linenum">3002</span></a>  
<a name="l3003"><span class="linenum">3003</span></a>  <span class="comment">    // Emulate normal session.</span>
<a name="l3004"><span class="linenum">3004</span></a>      <a class="function" onClick="logFunction('enrol_check_plugins')" href="../_functions/enrol_check_plugins.html" onMouseOver="funcPopup(event,'enrol_check_plugins')">enrol_check_plugins</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l3005"><span class="linenum">3005</span></a>      \core\session\<a class="class" onClick="logClass('manager')" href="../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('set_user')" href="../_functions/set_user.html" onMouseOver="funcPopup(event,'set_user')">set_user</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l3006"><span class="linenum">3006</span></a>  
<a name="l3007"><span class="linenum">3007</span></a>  <span class="comment">    // Note we are not using normal login.</span>
<a name="l3008"><span class="linenum">3008</span></a>      if (!<a class="phpfunction" onClick="logFunction('defined')" href="../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('USER_KEY_LOGIN')" href="../_constants/USER_KEY_LOGIN.html" onMouseOver="constPopup(event,'USER_KEY_LOGIN')">USER_KEY_LOGIN</a>')) {
<a name="l3009"><span class="linenum">3009</span></a>          <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('USER_KEY_LOGIN')" href="../_constants/USER_KEY_LOGIN.html" onMouseOver="constPopup(event,'USER_KEY_LOGIN')">USER_KEY_LOGIN</a>', true);
<a name="l3010"><span class="linenum">3010</span></a>      }
<a name="l3011"><span class="linenum">3011</span></a>  
<a name="l3012"><span class="linenum">3012</span></a>  <span class="comment">    // Return instance id - it might be empty.</span>
<a name="l3013"><span class="linenum">3013</span></a>      return <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>-&gt;<a onClick="logVariable('instance')" class="var it39505" onMouseOver="hilite(39505)" onMouseOut="lolite()" href="../_variables/instance.html">instance</a>;
<a name="l3014"><span class="linenum">3014</span></a>  }
<a name="l3015"><span class="linenum">3015</span></a>  
<a name="l3016"><span class="linenum">3016</span></a>  <span class="comment">/**</span>
<a name="l3017"><span class="linenum">3017</span></a>  <span class="comment"> * Creates a new private user access key.</span>
<a name="l3018"><span class="linenum">3018</span></a>  <span class="comment"> *</span>
<a name="l3019"><span class="linenum">3019</span></a>  <span class="comment"> * @param string $script unique target identifier</span>
<a name="l3020"><span class="linenum">3020</span></a>  <span class="comment"> * @param int $userid</span>
<a name="l3021"><span class="linenum">3021</span></a>  <span class="comment"> * @param int $instance optional instance id</span>
<a name="l3022"><span class="linenum">3022</span></a>  <span class="comment"> * @param string $iprestriction optional ip restricted access</span>
<a name="l3023"><span class="linenum">3023</span></a>  <span class="comment"> * @param timestamp $validuntil key valid only until given data</span>
<a name="l3024"><span class="linenum">3024</span></a>  <span class="comment"> * @return string access key value</span>
<a name="l3025"><span class="linenum">3025</span></a>  <span class="comment"> */</span>
<a name="l3026"><span class="linenum">3026</span></a>  function <a class="function" onClick="logFunction('create_user_key')" href="../_functions/create_user_key.html" onMouseOver="funcPopup(event,'create_user_key')">create_user_key</a>(<a class="var it1385" onMouseOver="hilite(1385)" onMouseOut="lolite()" onClick="logVariable('script')" href="../_variables/script.html">$script</a>, <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>, <a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>=null, <a class="var it4627" onMouseOver="hilite(4627)" onMouseOut="lolite()" onClick="logVariable('iprestriction')" href="../_variables/iprestriction.html">$iprestriction</a>=null, <a class="var it4626" onMouseOver="hilite(4626)" onMouseOut="lolite()" onClick="logVariable('validuntil')" href="../_variables/validuntil.html">$validuntil</a>=null) {
<a name="l3027"><span class="linenum">3027</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l3028"><span class="linenum">3028</span></a>  
<a name="l3029"><span class="linenum">3029</span></a>      <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> = new stdClass();
<a name="l3030"><span class="linenum">3030</span></a>      <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>-&gt;<a onClick="logVariable('script')" class="var it39505" onMouseOver="hilite(39505)" onMouseOut="lolite()" href="../_variables/script.html">script</a>        = <a class="var it1385" onMouseOver="hilite(1385)" onMouseOut="lolite()" onClick="logVariable('script')" href="../_variables/script.html">$script</a>;
<a name="l3031"><span class="linenum">3031</span></a>      <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>-&gt;<a onClick="logVariable('userid')" class="var it39505" onMouseOver="hilite(39505)" onMouseOut="lolite()" href="../_variables/userid.html">userid</a>        = <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>;
<a name="l3032"><span class="linenum">3032</span></a>      <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>-&gt;<a onClick="logVariable('instance')" class="var it39505" onMouseOver="hilite(39505)" onMouseOut="lolite()" href="../_variables/instance.html">instance</a>      = <a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>;
<a name="l3033"><span class="linenum">3033</span></a>      <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>-&gt;<a onClick="logVariable('iprestriction')" class="var it39505" onMouseOver="hilite(39505)" onMouseOut="lolite()" href="../_variables/iprestriction.html">iprestriction</a> = <a class="var it4627" onMouseOver="hilite(4627)" onMouseOut="lolite()" onClick="logVariable('iprestriction')" href="../_variables/iprestriction.html">$iprestriction</a>;
<a name="l3034"><span class="linenum">3034</span></a>      <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>-&gt;<a onClick="logVariable('validuntil')" class="var it39505" onMouseOver="hilite(39505)" onMouseOut="lolite()" href="../_variables/validuntil.html">validuntil</a>    = <a class="var it4626" onMouseOver="hilite(4626)" onMouseOut="lolite()" onClick="logVariable('validuntil')" href="../_variables/validuntil.html">$validuntil</a>;
<a name="l3035"><span class="linenum">3035</span></a>      <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>-&gt;<a onClick="logVariable('timecreated')" class="var it39505" onMouseOver="hilite(39505)" onMouseOut="lolite()" href="../_variables/timecreated.html">timecreated</a>   = <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l3036"><span class="linenum">3036</span></a>  
<a name="l3037"><span class="linenum">3037</span></a>  <span class="comment">    // Something long and unique.</span>
<a name="l3038"><span class="linenum">3038</span></a>      <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>-&gt;<a onClick="logVariable('value')" class="var it39505" onMouseOver="hilite(39505)" onMouseOut="lolite()" href="../_variables/value.html">value</a>         = md5(<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>.'_'.<a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>().<a class="function" onClick="logFunction('random_string')" href="../_functions/random_string.html" onMouseOver="funcPopup(event,'random_string')">random_string</a>(40));
<a name="l3039"><span class="linenum">3039</span></a>      while (<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('record_exists')" href="../_functions/record_exists.html" onMouseOver="funcPopup(event,'record_exists')">record_exists</a>('user_private_key', array('value' =&gt; <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>-&gt;<a onClick="logVariable('value')" class="var it39505" onMouseOver="hilite(39505)" onMouseOut="lolite()" href="../_variables/value.html">value</a>))) {
<a name="l3040"><span class="linenum">3040</span></a>  <span class="comment">        // Must be unique.</span>
<a name="l3041"><span class="linenum">3041</span></a>          <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>-&gt;<a onClick="logVariable('value')" class="var it39505" onMouseOver="hilite(39505)" onMouseOut="lolite()" href="../_variables/value.html">value</a>     = md5(<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>.'_'.<a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>().<a class="function" onClick="logFunction('random_string')" href="../_functions/random_string.html" onMouseOver="funcPopup(event,'random_string')">random_string</a>(40));
<a name="l3042"><span class="linenum">3042</span></a>      }
<a name="l3043"><span class="linenum">3043</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('user_private_key', <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>);
<a name="l3044"><span class="linenum">3044</span></a>      return <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>-&gt;<a onClick="logVariable('value')" class="var it39505" onMouseOver="hilite(39505)" onMouseOut="lolite()" href="../_variables/value.html">value</a>;
<a name="l3045"><span class="linenum">3045</span></a>  }
<a name="l3046"><span class="linenum">3046</span></a>  
<a name="l3047"><span class="linenum">3047</span></a>  <span class="comment">/**</span>
<a name="l3048"><span class="linenum">3048</span></a>  <span class="comment"> * Delete the user's new private user access keys for a particular script.</span>
<a name="l3049"><span class="linenum">3049</span></a>  <span class="comment"> *</span>
<a name="l3050"><span class="linenum">3050</span></a>  <span class="comment"> * @param string $script unique target identifier</span>
<a name="l3051"><span class="linenum">3051</span></a>  <span class="comment"> * @param int $userid</span>
<a name="l3052"><span class="linenum">3052</span></a>  <span class="comment"> * @return void</span>
<a name="l3053"><span class="linenum">3053</span></a>  <span class="comment"> */</span>
<a name="l3054"><span class="linenum">3054</span></a>  function <a class="function" onClick="logFunction('delete_user_key')" href="../_functions/delete_user_key.html" onMouseOver="funcPopup(event,'delete_user_key')">delete_user_key</a>(<a class="var it1385" onMouseOver="hilite(1385)" onMouseOut="lolite()" onClick="logVariable('script')" href="../_variables/script.html">$script</a>, <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>) {
<a name="l3055"><span class="linenum">3055</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l3056"><span class="linenum">3056</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('user_private_key', array('script' =&gt; <a class="var it1385" onMouseOver="hilite(1385)" onMouseOut="lolite()" onClick="logVariable('script')" href="../_variables/script.html">$script</a>, 'userid' =&gt; <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>));
<a name="l3057"><span class="linenum">3057</span></a>  }
<a name="l3058"><span class="linenum">3058</span></a>  
<a name="l3059"><span class="linenum">3059</span></a>  <span class="comment">/**</span>
<a name="l3060"><span class="linenum">3060</span></a>  <span class="comment"> * Gets a private user access key (and creates one if one doesn't exist).</span>
<a name="l3061"><span class="linenum">3061</span></a>  <span class="comment"> *</span>
<a name="l3062"><span class="linenum">3062</span></a>  <span class="comment"> * @param string $script unique target identifier</span>
<a name="l3063"><span class="linenum">3063</span></a>  <span class="comment"> * @param int $userid</span>
<a name="l3064"><span class="linenum">3064</span></a>  <span class="comment"> * @param int $instance optional instance id</span>
<a name="l3065"><span class="linenum">3065</span></a>  <span class="comment"> * @param string $iprestriction optional ip restricted access</span>
<a name="l3066"><span class="linenum">3066</span></a>  <span class="comment"> * @param timestamp $validuntil key valid only until given data</span>
<a name="l3067"><span class="linenum">3067</span></a>  <span class="comment"> * @return string access key value</span>
<a name="l3068"><span class="linenum">3068</span></a>  <span class="comment"> */</span>
<a name="l3069"><span class="linenum">3069</span></a>  function <a class="function" onClick="logFunction('get_user_key')" href="../_functions/get_user_key.html" onMouseOver="funcPopup(event,'get_user_key')">get_user_key</a>(<a class="var it1385" onMouseOver="hilite(1385)" onMouseOut="lolite()" onClick="logVariable('script')" href="../_variables/script.html">$script</a>, <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>, <a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>=null, <a class="var it4627" onMouseOver="hilite(4627)" onMouseOut="lolite()" onClick="logVariable('iprestriction')" href="../_variables/iprestriction.html">$iprestriction</a>=null, <a class="var it4626" onMouseOver="hilite(4626)" onMouseOut="lolite()" onClick="logVariable('validuntil')" href="../_variables/validuntil.html">$validuntil</a>=null) {
<a name="l3070"><span class="linenum">3070</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l3071"><span class="linenum">3071</span></a>  
<a name="l3072"><span class="linenum">3072</span></a>      if (<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user_private_key', array('script' =&gt; <a class="var it1385" onMouseOver="hilite(1385)" onMouseOut="lolite()" onClick="logVariable('script')" href="../_variables/script.html">$script</a>, 'userid' =&gt; <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>,
<a name="l3073"><span class="linenum">3073</span></a>                                                           'instance' =&gt; <a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>, 'iprestriction' =&gt; <a class="var it4627" onMouseOver="hilite(4627)" onMouseOut="lolite()" onClick="logVariable('iprestriction')" href="../_variables/iprestriction.html">$iprestriction</a>,
<a name="l3074"><span class="linenum">3074</span></a>                                                           'validuntil' =&gt; <a class="var it4626" onMouseOver="hilite(4626)" onMouseOut="lolite()" onClick="logVariable('validuntil')" href="../_variables/validuntil.html">$validuntil</a>))) {
<a name="l3075"><span class="linenum">3075</span></a>          return <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>-&gt;<a onClick="logVariable('value')" class="var it39505" onMouseOver="hilite(39505)" onMouseOut="lolite()" href="../_variables/value.html">value</a>;
<a name="l3076"><span class="linenum">3076</span></a>      } else {
<a name="l3077"><span class="linenum">3077</span></a>          return <a class="function" onClick="logFunction('create_user_key')" href="../_functions/create_user_key.html" onMouseOver="funcPopup(event,'create_user_key')">create_user_key</a>(<a class="var it1385" onMouseOver="hilite(1385)" onMouseOut="lolite()" onClick="logVariable('script')" href="../_variables/script.html">$script</a>, <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>, <a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>, <a class="var it4627" onMouseOver="hilite(4627)" onMouseOut="lolite()" onClick="logVariable('iprestriction')" href="../_variables/iprestriction.html">$iprestriction</a>, <a class="var it4626" onMouseOver="hilite(4626)" onMouseOut="lolite()" onClick="logVariable('validuntil')" href="../_variables/validuntil.html">$validuntil</a>);
<a name="l3078"><span class="linenum">3078</span></a>      }
<a name="l3079"><span class="linenum">3079</span></a>  }
<a name="l3080"><span class="linenum">3080</span></a>  
<a name="l3081"><span class="linenum">3081</span></a>  
<a name="l3082"><span class="linenum">3082</span></a>  <span class="comment">/**</span>
<a name="l3083"><span class="linenum">3083</span></a>  <span class="comment"> * Modify the user table by setting the currently logged in user's last login to now.</span>
<a name="l3084"><span class="linenum">3084</span></a>  <span class="comment"> *</span>
<a name="l3085"><span class="linenum">3085</span></a>  <span class="comment"> * @return bool Always returns true</span>
<a name="l3086"><span class="linenum">3086</span></a>  <span class="comment"> */</span>
<a name="l3087"><span class="linenum">3087</span></a>  function <a class="function" onClick="logFunction('update_user_login_times')" href="../_functions/update_user_login_times.html" onMouseOver="funcPopup(event,'update_user_login_times')">update_user_login_times</a>() {
<a name="l3088"><span class="linenum">3088</span></a>      global <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l3089"><span class="linenum">3089</span></a>  
<a name="l3090"><span class="linenum">3090</span></a>      if (<a class="function" onClick="logFunction('isguestuser')" href="../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>()) {
<a name="l3091"><span class="linenum">3091</span></a>  <span class="comment">        // Do not update guest access times/ips for performance.</span>
<a name="l3092"><span class="linenum">3092</span></a>          return true;
<a name="l3093"><span class="linenum">3093</span></a>      }
<a name="l3094"><span class="linenum">3094</span></a>  
<a name="l3095"><span class="linenum">3095</span></a>      <a class="var it345" onMouseOver="hilite(345)" onMouseOut="lolite()" onClick="logVariable('now')" href="../_variables/now.html">$now</a> = <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l3096"><span class="linenum">3096</span></a>  
<a name="l3097"><span class="linenum">3097</span></a>      <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = new stdClass();
<a name="l3098"><span class="linenum">3098</span></a>      <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a> = <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/id.html">id</a>;
<a name="l3099"><span class="linenum">3099</span></a>  
<a name="l3100"><span class="linenum">3100</span></a>  <span class="comment">    // Make sure all users that logged in have some firstaccess.</span>
<a name="l3101"><span class="linenum">3101</span></a>      if (<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('firstaccess')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/firstaccess.html">firstaccess</a> == 0) {
<a name="l3102"><span class="linenum">3102</span></a>          <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('firstaccess')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/firstaccess.html">firstaccess</a> = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('firstaccess')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/firstaccess.html">firstaccess</a> = <a class="var it345" onMouseOver="hilite(345)" onMouseOut="lolite()" onClick="logVariable('now')" href="../_variables/now.html">$now</a>;
<a name="l3103"><span class="linenum">3103</span></a>      }
<a name="l3104"><span class="linenum">3104</span></a>  
<a name="l3105"><span class="linenum">3105</span></a>  <span class="comment">    // Store the previous current as lastlogin.</span>
<a name="l3106"><span class="linenum">3106</span></a>      <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('lastlogin')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/lastlogin.html">lastlogin</a> = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('lastlogin')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/lastlogin.html">lastlogin</a> = <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('currentlogin')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/currentlogin.html">currentlogin</a>;
<a name="l3107"><span class="linenum">3107</span></a>  
<a name="l3108"><span class="linenum">3108</span></a>      <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('currentlogin')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/currentlogin.html">currentlogin</a> = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('currentlogin')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/currentlogin.html">currentlogin</a> = <a class="var it345" onMouseOver="hilite(345)" onMouseOut="lolite()" onClick="logVariable('now')" href="../_variables/now.html">$now</a>;
<a name="l3109"><span class="linenum">3109</span></a>  
<a name="l3110"><span class="linenum">3110</span></a>  <span class="comment">    // Function user_accesstime_log() may not update immediately, better do it here.</span>
<a name="l3111"><span class="linenum">3111</span></a>      <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('lastaccess')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/lastaccess.html">lastaccess</a> = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('lastaccess')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/lastaccess.html">lastaccess</a> = <a class="var it345" onMouseOver="hilite(345)" onMouseOut="lolite()" onClick="logVariable('now')" href="../_variables/now.html">$now</a>;
<a name="l3112"><span class="linenum">3112</span></a>      <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('lastip')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/lastip.html">lastip</a> = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('lastip')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/lastip.html">lastip</a> = <a class="function" onClick="logFunction('getremoteaddr')" href="../_functions/getremoteaddr.html" onMouseOver="funcPopup(event,'getremoteaddr')">getremoteaddr</a>();
<a name="l3113"><span class="linenum">3113</span></a>  
<a name="l3114"><span class="linenum">3114</span></a>  <span class="comment">    // Note: do not call user_update_user() here because this is part of the login process,</span>
<a name="l3115"><span class="linenum">3115</span></a>  <span class="comment">    //       the login event means that these fields were updated.</span>
<a name="l3116"><span class="linenum">3116</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('user', <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l3117"><span class="linenum">3117</span></a>      return true;
<a name="l3118"><span class="linenum">3118</span></a>  }
<a name="l3119"><span class="linenum">3119</span></a>  
<a name="l3120"><span class="linenum">3120</span></a>  <span class="comment">/**</span>
<a name="l3121"><span class="linenum">3121</span></a>  <span class="comment"> * Determines if a user has completed setting up their account.</span>
<a name="l3122"><span class="linenum">3122</span></a>  <span class="comment"> *</span>
<a name="l3123"><span class="linenum">3123</span></a>  <span class="comment"> * @param stdClass $user A {@link $USER} object to test for the existence of a valid name and email</span>
<a name="l3124"><span class="linenum">3124</span></a>  <span class="comment"> * @return bool</span>
<a name="l3125"><span class="linenum">3125</span></a>  <span class="comment"> */</span>
<a name="l3126"><span class="linenum">3126</span></a>  function <a class="function" onClick="logFunction('user_not_fully_set_up')" href="../_functions/user_not_fully_set_up.html" onMouseOver="funcPopup(event,'user_not_fully_set_up')">user_not_fully_set_up</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>) {
<a name="l3127"><span class="linenum">3127</span></a>      if (<a class="function" onClick="logFunction('isguestuser')" href="../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l3128"><span class="linenum">3128</span></a>          return false;
<a name="l3129"><span class="linenum">3129</span></a>      }
<a name="l3130"><span class="linenum">3130</span></a>      return (empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('firstname')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/firstname.html">firstname</a>) or empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('lastname')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/lastname.html">lastname</a>) or empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('email')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/email.html">email</a>) or <a class="function" onClick="logFunction('over_bounce_threshold')" href="../_functions/over_bounce_threshold.html" onMouseOver="funcPopup(event,'over_bounce_threshold')">over_bounce_threshold</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>));
<a name="l3131"><span class="linenum">3131</span></a>  }
<a name="l3132"><span class="linenum">3132</span></a>  
<a name="l3133"><span class="linenum">3133</span></a>  <span class="comment">/**</span>
<a name="l3134"><span class="linenum">3134</span></a>  <span class="comment"> * Check whether the user has exceeded the bounce threshold</span>
<a name="l3135"><span class="linenum">3135</span></a>  <span class="comment"> *</span>
<a name="l3136"><span class="linenum">3136</span></a>  <span class="comment"> * @param stdClass $user A {@link $USER} object</span>
<a name="l3137"><span class="linenum">3137</span></a>  <span class="comment"> * @return bool true =&gt; User has exceeded bounce threshold</span>
<a name="l3138"><span class="linenum">3138</span></a>  <span class="comment"> */</span>
<a name="l3139"><span class="linenum">3139</span></a>  function <a class="function" onClick="logFunction('over_bounce_threshold')" href="../_functions/over_bounce_threshold.html" onMouseOver="funcPopup(event,'over_bounce_threshold')">over_bounce_threshold</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>) {
<a name="l3140"><span class="linenum">3140</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l3141"><span class="linenum">3141</span></a>  
<a name="l3142"><span class="linenum">3142</span></a>      if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('handlebounces')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/handlebounces.html">handlebounces</a>)) {
<a name="l3143"><span class="linenum">3143</span></a>          return false;
<a name="l3144"><span class="linenum">3144</span></a>      }
<a name="l3145"><span class="linenum">3145</span></a>  
<a name="l3146"><span class="linenum">3146</span></a>      if (empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)) {
<a name="l3147"><span class="linenum">3147</span></a>  <span class="comment">        // No real (DB) user, nothing to do here.</span>
<a name="l3148"><span class="linenum">3148</span></a>          return false;
<a name="l3149"><span class="linenum">3149</span></a>      }
<a name="l3150"><span class="linenum">3150</span></a>  
<a name="l3151"><span class="linenum">3151</span></a>  <span class="comment">    // Set sensible defaults.</span>
<a name="l3152"><span class="linenum">3152</span></a>      if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('minbounces')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/minbounces.html">minbounces</a>)) {
<a name="l3153"><span class="linenum">3153</span></a>          <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('minbounces')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/minbounces.html">minbounces</a> = 10;
<a name="l3154"><span class="linenum">3154</span></a>      }
<a name="l3155"><span class="linenum">3155</span></a>      if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('bounceratio')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/bounceratio.html">bounceratio</a>)) {
<a name="l3156"><span class="linenum">3156</span></a>          <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('bounceratio')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/bounceratio.html">bounceratio</a> = .20;
<a name="l3157"><span class="linenum">3157</span></a>      }
<a name="l3158"><span class="linenum">3158</span></a>      <a class="var it12956" onMouseOver="hilite(12956)" onMouseOut="lolite()" onClick="logVariable('bouncecount')" href="../_variables/bouncecount.html">$bouncecount</a> = 0;
<a name="l3159"><span class="linenum">3159</span></a>      <a class="var it12957" onMouseOver="hilite(12957)" onMouseOut="lolite()" onClick="logVariable('sendcount')" href="../_variables/sendcount.html">$sendcount</a> = 0;
<a name="l3160"><span class="linenum">3160</span></a>      if (<a class="var it12958" onMouseOver="hilite(12958)" onMouseOut="lolite()" onClick="logVariable('bounce')" href="../_variables/bounce.html">$bounce</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user_preferences', array ('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, 'name' =&gt; 'email_bounce_count'))) {
<a name="l3161"><span class="linenum">3161</span></a>          <a class="var it12956" onMouseOver="hilite(12956)" onMouseOut="lolite()" onClick="logVariable('bouncecount')" href="../_variables/bouncecount.html">$bouncecount</a> = <a class="var it12958" onMouseOver="hilite(12958)" onMouseOut="lolite()" onClick="logVariable('bounce')" href="../_variables/bounce.html">$bounce</a>-&gt;<a onClick="logVariable('value')" class="var it41066" onMouseOver="hilite(41066)" onMouseOut="lolite()" href="../_variables/value.html">value</a>;
<a name="l3162"><span class="linenum">3162</span></a>      }
<a name="l3163"><span class="linenum">3163</span></a>      if (<a class="var it12959" onMouseOver="hilite(12959)" onMouseOut="lolite()" onClick="logVariable('send')" href="../_variables/send.html">$send</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user_preferences', array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, 'name' =&gt; 'email_send_count'))) {
<a name="l3164"><span class="linenum">3164</span></a>          <a class="var it12957" onMouseOver="hilite(12957)" onMouseOut="lolite()" onClick="logVariable('sendcount')" href="../_variables/sendcount.html">$sendcount</a> = <a class="var it12959" onMouseOver="hilite(12959)" onMouseOut="lolite()" onClick="logVariable('send')" href="../_variables/send.html">$send</a>-&gt;<a onClick="logVariable('value')" class="var it41067" onMouseOver="hilite(41067)" onMouseOut="lolite()" href="../_variables/value.html">value</a>;
<a name="l3165"><span class="linenum">3165</span></a>      }
<a name="l3166"><span class="linenum">3166</span></a>      return (<a class="var it12956" onMouseOver="hilite(12956)" onMouseOut="lolite()" onClick="logVariable('bouncecount')" href="../_variables/bouncecount.html">$bouncecount</a> &gt;= <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('minbounces')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/minbounces.html">minbounces</a> &amp;&amp; <a class="var it12956" onMouseOver="hilite(12956)" onMouseOut="lolite()" onClick="logVariable('bouncecount')" href="../_variables/bouncecount.html">$bouncecount</a>/<a class="var it12957" onMouseOver="hilite(12957)" onMouseOut="lolite()" onClick="logVariable('sendcount')" href="../_variables/sendcount.html">$sendcount</a> &gt;= <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('bounceratio')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/bounceratio.html">bounceratio</a>);
<a name="l3167"><span class="linenum">3167</span></a>  }
<a name="l3168"><span class="linenum">3168</span></a>  
<a name="l3169"><span class="linenum">3169</span></a>  <span class="comment">/**</span>
<a name="l3170"><span class="linenum">3170</span></a>  <span class="comment"> * Used to increment or reset email sent count</span>
<a name="l3171"><span class="linenum">3171</span></a>  <span class="comment"> *</span>
<a name="l3172"><span class="linenum">3172</span></a>  <span class="comment"> * @param stdClass $user object containing an id</span>
<a name="l3173"><span class="linenum">3173</span></a>  <span class="comment"> * @param bool $reset will reset the count to 0</span>
<a name="l3174"><span class="linenum">3174</span></a>  <span class="comment"> * @return void</span>
<a name="l3175"><span class="linenum">3175</span></a>  <span class="comment"> */</span>
<a name="l3176"><span class="linenum">3176</span></a>  function <a class="function" onClick="logFunction('set_send_count')" href="../_functions/set_send_count.html" onMouseOver="funcPopup(event,'set_send_count')">set_send_count</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it1022" onMouseOver="hilite(1022)" onMouseOut="lolite()" onClick="logVariable('reset')" href="../_variables/reset.html">$reset</a>=false) {
<a name="l3177"><span class="linenum">3177</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l3178"><span class="linenum">3178</span></a>  
<a name="l3179"><span class="linenum">3179</span></a>      if (empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)) {
<a name="l3180"><span class="linenum">3180</span></a>  <span class="comment">        // No real (DB) user, nothing to do here.</span>
<a name="l3181"><span class="linenum">3181</span></a>          return;
<a name="l3182"><span class="linenum">3182</span></a>      }
<a name="l3183"><span class="linenum">3183</span></a>  
<a name="l3184"><span class="linenum">3184</span></a>      if (<a class="var it12960" onMouseOver="hilite(12960)" onMouseOut="lolite()" onClick="logVariable('pref')" href="../_variables/pref.html">$pref</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user_preferences', array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, 'name' =&gt; 'email_send_count'))) {
<a name="l3185"><span class="linenum">3185</span></a>          <a class="var it12960" onMouseOver="hilite(12960)" onMouseOut="lolite()" onClick="logVariable('pref')" href="../_variables/pref.html">$pref</a>-&gt;<a onClick="logVariable('value')" class="var it41068" onMouseOver="hilite(41068)" onMouseOut="lolite()" href="../_variables/value.html">value</a> = (!empty(<a class="var it1022" onMouseOver="hilite(1022)" onMouseOut="lolite()" onClick="logVariable('reset')" href="../_variables/reset.html">$reset</a>)) ? 0 : <a class="var it12960" onMouseOver="hilite(12960)" onMouseOut="lolite()" onClick="logVariable('pref')" href="../_variables/pref.html">$pref</a>-&gt;<a onClick="logVariable('value')" class="var it41068" onMouseOver="hilite(41068)" onMouseOut="lolite()" href="../_variables/value.html">value</a>+1;
<a name="l3186"><span class="linenum">3186</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('user_preferences', <a class="var it12960" onMouseOver="hilite(12960)" onMouseOut="lolite()" onClick="logVariable('pref')" href="../_variables/pref.html">$pref</a>);
<a name="l3187"><span class="linenum">3187</span></a>      } else if (!empty(<a class="var it1022" onMouseOver="hilite(1022)" onMouseOut="lolite()" onClick="logVariable('reset')" href="../_variables/reset.html">$reset</a>)) {
<a name="l3188"><span class="linenum">3188</span></a>  <span class="comment">        // If it's not there and we're resetting, don't bother. Make a new one.</span>
<a name="l3189"><span class="linenum">3189</span></a>          <a class="var it12960" onMouseOver="hilite(12960)" onMouseOut="lolite()" onClick="logVariable('pref')" href="../_variables/pref.html">$pref</a> = new stdClass();
<a name="l3190"><span class="linenum">3190</span></a>          <a class="var it12960" onMouseOver="hilite(12960)" onMouseOut="lolite()" onClick="logVariable('pref')" href="../_variables/pref.html">$pref</a>-&gt;<a onClick="logVariable('name')" class="var it41068" onMouseOver="hilite(41068)" onMouseOut="lolite()" href="../_variables/name.html">name</a>   = 'email_send_count';
<a name="l3191"><span class="linenum">3191</span></a>          <a class="var it12960" onMouseOver="hilite(12960)" onMouseOut="lolite()" onClick="logVariable('pref')" href="../_variables/pref.html">$pref</a>-&gt;<a onClick="logVariable('value')" class="var it41068" onMouseOver="hilite(41068)" onMouseOut="lolite()" href="../_variables/value.html">value</a>  = 1;
<a name="l3192"><span class="linenum">3192</span></a>          <a class="var it12960" onMouseOver="hilite(12960)" onMouseOut="lolite()" onClick="logVariable('pref')" href="../_variables/pref.html">$pref</a>-&gt;<a onClick="logVariable('userid')" class="var it41068" onMouseOver="hilite(41068)" onMouseOut="lolite()" href="../_variables/userid.html">userid</a> = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>;
<a name="l3193"><span class="linenum">3193</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('user_preferences', <a class="var it12960" onMouseOver="hilite(12960)" onMouseOut="lolite()" onClick="logVariable('pref')" href="../_variables/pref.html">$pref</a>, false);
<a name="l3194"><span class="linenum">3194</span></a>      }
<a name="l3195"><span class="linenum">3195</span></a>  }
<a name="l3196"><span class="linenum">3196</span></a>  
<a name="l3197"><span class="linenum">3197</span></a>  <span class="comment">/**</span>
<a name="l3198"><span class="linenum">3198</span></a>  <span class="comment"> * Increment or reset user's email bounce count</span>
<a name="l3199"><span class="linenum">3199</span></a>  <span class="comment"> *</span>
<a name="l3200"><span class="linenum">3200</span></a>  <span class="comment"> * @param stdClass $user object containing an id</span>
<a name="l3201"><span class="linenum">3201</span></a>  <span class="comment"> * @param bool $reset will reset the count to 0</span>
<a name="l3202"><span class="linenum">3202</span></a>  <span class="comment"> */</span>
<a name="l3203"><span class="linenum">3203</span></a>  function <a class="function" onClick="logFunction('set_bounce_count')" href="../_functions/set_bounce_count.html" onMouseOver="funcPopup(event,'set_bounce_count')">set_bounce_count</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it1022" onMouseOver="hilite(1022)" onMouseOut="lolite()" onClick="logVariable('reset')" href="../_variables/reset.html">$reset</a>=false) {
<a name="l3204"><span class="linenum">3204</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l3205"><span class="linenum">3205</span></a>  
<a name="l3206"><span class="linenum">3206</span></a>      if (<a class="var it12960" onMouseOver="hilite(12960)" onMouseOut="lolite()" onClick="logVariable('pref')" href="../_variables/pref.html">$pref</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user_preferences', array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, 'name' =&gt; 'email_bounce_count'))) {
<a name="l3207"><span class="linenum">3207</span></a>          <a class="var it12960" onMouseOver="hilite(12960)" onMouseOut="lolite()" onClick="logVariable('pref')" href="../_variables/pref.html">$pref</a>-&gt;<a onClick="logVariable('value')" class="var it41068" onMouseOver="hilite(41068)" onMouseOut="lolite()" href="../_variables/value.html">value</a> = (!empty(<a class="var it1022" onMouseOver="hilite(1022)" onMouseOut="lolite()" onClick="logVariable('reset')" href="../_variables/reset.html">$reset</a>)) ? 0 : <a class="var it12960" onMouseOver="hilite(12960)" onMouseOut="lolite()" onClick="logVariable('pref')" href="../_variables/pref.html">$pref</a>-&gt;<a onClick="logVariable('value')" class="var it41068" onMouseOver="hilite(41068)" onMouseOut="lolite()" href="../_variables/value.html">value</a>+1;
<a name="l3208"><span class="linenum">3208</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('user_preferences', <a class="var it12960" onMouseOver="hilite(12960)" onMouseOut="lolite()" onClick="logVariable('pref')" href="../_variables/pref.html">$pref</a>);
<a name="l3209"><span class="linenum">3209</span></a>      } else if (!empty(<a class="var it1022" onMouseOver="hilite(1022)" onMouseOut="lolite()" onClick="logVariable('reset')" href="../_variables/reset.html">$reset</a>)) {
<a name="l3210"><span class="linenum">3210</span></a>  <span class="comment">        // If it's not there and we're resetting, don't bother. Make a new one.</span>
<a name="l3211"><span class="linenum">3211</span></a>          <a class="var it12960" onMouseOver="hilite(12960)" onMouseOut="lolite()" onClick="logVariable('pref')" href="../_variables/pref.html">$pref</a> = new stdClass();
<a name="l3212"><span class="linenum">3212</span></a>          <a class="var it12960" onMouseOver="hilite(12960)" onMouseOut="lolite()" onClick="logVariable('pref')" href="../_variables/pref.html">$pref</a>-&gt;<a onClick="logVariable('name')" class="var it41068" onMouseOver="hilite(41068)" onMouseOut="lolite()" href="../_variables/name.html">name</a>   = 'email_bounce_count';
<a name="l3213"><span class="linenum">3213</span></a>          <a class="var it12960" onMouseOver="hilite(12960)" onMouseOut="lolite()" onClick="logVariable('pref')" href="../_variables/pref.html">$pref</a>-&gt;<a onClick="logVariable('value')" class="var it41068" onMouseOver="hilite(41068)" onMouseOut="lolite()" href="../_variables/value.html">value</a>  = 1;
<a name="l3214"><span class="linenum">3214</span></a>          <a class="var it12960" onMouseOver="hilite(12960)" onMouseOut="lolite()" onClick="logVariable('pref')" href="../_variables/pref.html">$pref</a>-&gt;<a onClick="logVariable('userid')" class="var it41068" onMouseOver="hilite(41068)" onMouseOut="lolite()" href="../_variables/userid.html">userid</a> = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>;
<a name="l3215"><span class="linenum">3215</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('user_preferences', <a class="var it12960" onMouseOver="hilite(12960)" onMouseOut="lolite()" onClick="logVariable('pref')" href="../_variables/pref.html">$pref</a>, false);
<a name="l3216"><span class="linenum">3216</span></a>      }
<a name="l3217"><span class="linenum">3217</span></a>  }
<a name="l3218"><span class="linenum">3218</span></a>  
<a name="l3219"><span class="linenum">3219</span></a>  <span class="comment">/**</span>
<a name="l3220"><span class="linenum">3220</span></a>  <span class="comment"> * Determines if the logged in user is currently moving an activity</span>
<a name="l3221"><span class="linenum">3221</span></a>  <span class="comment"> *</span>
<a name="l3222"><span class="linenum">3222</span></a>  <span class="comment"> * @param int $courseid The id of the course being tested</span>
<a name="l3223"><span class="linenum">3223</span></a>  <span class="comment"> * @return bool</span>
<a name="l3224"><span class="linenum">3224</span></a>  <span class="comment"> */</span>
<a name="l3225"><span class="linenum">3225</span></a>  function <a class="function" onClick="logFunction('ismoving')" href="../_functions/ismoving.html" onMouseOver="funcPopup(event,'ismoving')">ismoving</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>) {
<a name="l3226"><span class="linenum">3226</span></a>      global <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>;
<a name="l3227"><span class="linenum">3227</span></a>  
<a name="l3228"><span class="linenum">3228</span></a>      if (!empty(<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('activitycopy')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/activitycopy.html">activitycopy</a>)) {
<a name="l3229"><span class="linenum">3229</span></a>          return (<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('activitycopycourse')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/activitycopycourse.html">activitycopycourse</a> == <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>);
<a name="l3230"><span class="linenum">3230</span></a>      }
<a name="l3231"><span class="linenum">3231</span></a>      return false;
<a name="l3232"><span class="linenum">3232</span></a>  }
<a name="l3233"><span class="linenum">3233</span></a>  
<a name="l3234"><span class="linenum">3234</span></a>  <span class="comment">/**</span>
<a name="l3235"><span class="linenum">3235</span></a>  <span class="comment"> * Returns a persons full name</span>
<a name="l3236"><span class="linenum">3236</span></a>  <span class="comment"> *</span>
<a name="l3237"><span class="linenum">3237</span></a>  <span class="comment"> * Given an object containing all of the users name values, this function returns a string with the full name of the person.</span>
<a name="l3238"><span class="linenum">3238</span></a>  <span class="comment"> * The result may depend on system settings or language.  'override' will force both names to be used even if system settings</span>
<a name="l3239"><span class="linenum">3239</span></a>  <span class="comment"> * specify one.</span>
<a name="l3240"><span class="linenum">3240</span></a>  <span class="comment"> *</span>
<a name="l3241"><span class="linenum">3241</span></a>  <span class="comment"> * @param stdClass $user A {@link $USER} object to get full name of.</span>
<a name="l3242"><span class="linenum">3242</span></a>  <span class="comment"> * @param bool $override If true then the name will be firstname followed by lastname rather than adhering to fullnamedisplay.</span>
<a name="l3243"><span class="linenum">3243</span></a>  <span class="comment"> * @return string</span>
<a name="l3244"><span class="linenum">3244</span></a>  <span class="comment"> */</span>
<a name="l3245"><span class="linenum">3245</span></a>  function <a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it669" onMouseOver="hilite(669)" onMouseOut="lolite()" onClick="logVariable('override')" href="../_variables/override.html">$override</a>=false) {
<a name="l3246"><span class="linenum">3246</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>;
<a name="l3247"><span class="linenum">3247</span></a>  
<a name="l3248"><span class="linenum">3248</span></a>      if (!isset(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('firstname')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/firstname.html">firstname</a>) and !isset(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('lastname')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/lastname.html">lastname</a>)) {
<a name="l3249"><span class="linenum">3249</span></a>          return '';
<a name="l3250"><span class="linenum">3250</span></a>      }
<a name="l3251"><span class="linenum">3251</span></a>  
<a name="l3252"><span class="linenum">3252</span></a>  <span class="comment">    // Get all of the name fields.</span>
<a name="l3253"><span class="linenum">3253</span></a>      <a class="var it7865" onMouseOver="hilite(7865)" onMouseOut="lolite()" onClick="logVariable('allnames')" href="../_variables/allnames.html">$allnames</a> = <a class="function" onClick="logFunction('get_all_user_name_fields')" href="../_functions/get_all_user_name_fields.html" onMouseOver="funcPopup(event,'get_all_user_name_fields')">get_all_user_name_fields</a>();
<a name="l3254"><span class="linenum">3254</span></a>      if (<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('debugdeveloper')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/debugdeveloper.html">debugdeveloper</a>) {
<a name="l3255"><span class="linenum">3255</span></a>          foreach (<a class="var it7865" onMouseOver="hilite(7865)" onMouseOut="lolite()" onClick="logVariable('allnames')" href="../_variables/allnames.html">$allnames</a> as <a class="var it12881" onMouseOver="hilite(12881)" onMouseOut="lolite()" onClick="logVariable('allname')" href="../_variables/allname.html">$allname</a>) {
<a name="l3256"><span class="linenum">3256</span></a>              if (!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it12881" onMouseOver="hilite(12881)" onMouseOut="lolite()" onClick="logVariable('allname')" href="../_variables/allname.html">$allname</a>, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l3257"><span class="linenum">3257</span></a>  <span class="comment">                // If all the user name fields are not set in the user object, then notify the programmer that it needs to be fixed.</span>
<a name="l3258"><span class="linenum">3258</span></a>                  <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('You need to update your sql to include additional name fields in the user object.', <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l3259"><span class="linenum">3259</span></a>  <span class="comment">                // Message has been sent, no point in sending the message multiple times.</span>
<a name="l3260"><span class="linenum">3260</span></a>                  break;
<a name="l3261"><span class="linenum">3261</span></a>              }
<a name="l3262"><span class="linenum">3262</span></a>          }
<a name="l3263"><span class="linenum">3263</span></a>      }
<a name="l3264"><span class="linenum">3264</span></a>  
<a name="l3265"><span class="linenum">3265</span></a>      if (!<a class="var it669" onMouseOver="hilite(669)" onMouseOut="lolite()" onClick="logVariable('override')" href="../_variables/override.html">$override</a>) {
<a name="l3266"><span class="linenum">3266</span></a>          if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('forcefirstname')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/forcefirstname.html">forcefirstname</a>)) {
<a name="l3267"><span class="linenum">3267</span></a>              <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('firstname')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/firstname.html">firstname</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('forcefirstname')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/forcefirstname.html">forcefirstname</a>;
<a name="l3268"><span class="linenum">3268</span></a>          }
<a name="l3269"><span class="linenum">3269</span></a>          if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('forcelastname')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/forcelastname.html">forcelastname</a>)) {
<a name="l3270"><span class="linenum">3270</span></a>              <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('lastname')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/lastname.html">lastname</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('forcelastname')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/forcelastname.html">forcelastname</a>;
<a name="l3271"><span class="linenum">3271</span></a>          }
<a name="l3272"><span class="linenum">3272</span></a>      }
<a name="l3273"><span class="linenum">3273</span></a>  
<a name="l3274"><span class="linenum">3274</span></a>      if (!empty(<a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('fullnamedisplay')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/fullnamedisplay.html">fullnamedisplay</a>)) {
<a name="l3275"><span class="linenum">3275</span></a>          <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('fullnamedisplay')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/fullnamedisplay.html">fullnamedisplay</a> = <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('fullnamedisplay')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/fullnamedisplay.html">fullnamedisplay</a>;
<a name="l3276"><span class="linenum">3276</span></a>      }
<a name="l3277"><span class="linenum">3277</span></a>  
<a name="l3278"><span class="linenum">3278</span></a>      <a class="var it1055" onMouseOver="hilite(1055)" onMouseOut="lolite()" onClick="logVariable('template')" href="../_variables/template.html">$template</a> = null;
<a name="l3279"><span class="linenum">3279</span></a>  <span class="comment">    // If the fullnamedisplay setting is available, set the template to that.</span>
<a name="l3280"><span class="linenum">3280</span></a>      if (isset(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('fullnamedisplay')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/fullnamedisplay.html">fullnamedisplay</a>)) {
<a name="l3281"><span class="linenum">3281</span></a>          <a class="var it1055" onMouseOver="hilite(1055)" onMouseOut="lolite()" onClick="logVariable('template')" href="../_variables/template.html">$template</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('fullnamedisplay')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/fullnamedisplay.html">fullnamedisplay</a>;
<a name="l3282"><span class="linenum">3282</span></a>      }
<a name="l3283"><span class="linenum">3283</span></a>  <span class="comment">    // If the template is empty, or set to language, return the language string.</span>
<a name="l3284"><span class="linenum">3284</span></a>      if ((empty(<a class="var it1055" onMouseOver="hilite(1055)" onMouseOut="lolite()" onClick="logVariable('template')" href="../_variables/template.html">$template</a>) || <a class="var it1055" onMouseOver="hilite(1055)" onMouseOut="lolite()" onClick="logVariable('template')" href="../_variables/template.html">$template</a> == 'language') &amp;&amp; !<a class="var it669" onMouseOver="hilite(669)" onMouseOut="lolite()" onClick="logVariable('override')" href="../_variables/override.html">$override</a>) {
<a name="l3285"><span class="linenum">3285</span></a>          return <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('fullnamedisplay', null, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l3286"><span class="linenum">3286</span></a>      }
<a name="l3287"><span class="linenum">3287</span></a>  
<a name="l3288"><span class="linenum">3288</span></a>  <span class="comment">    // Check to see if we are displaying according to the alternative full name format.</span>
<a name="l3289"><span class="linenum">3289</span></a>      if (<a class="var it669" onMouseOver="hilite(669)" onMouseOut="lolite()" onClick="logVariable('override')" href="../_variables/override.html">$override</a>) {
<a name="l3290"><span class="linenum">3290</span></a>          if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('alternativefullnameformat')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/alternativefullnameformat.html">alternativefullnameformat</a>) || <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('alternativefullnameformat')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/alternativefullnameformat.html">alternativefullnameformat</a> == 'language') {
<a name="l3291"><span class="linenum">3291</span></a>  <span class="comment">            // Default to show just the user names according to the fullnamedisplay string.</span>
<a name="l3292"><span class="linenum">3292</span></a>              return <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('fullnamedisplay', null, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l3293"><span class="linenum">3293</span></a>          } else {
<a name="l3294"><span class="linenum">3294</span></a>  <span class="comment">            // If the override is true, then change the template to use the complete name.</span>
<a name="l3295"><span class="linenum">3295</span></a>              <a class="var it1055" onMouseOver="hilite(1055)" onMouseOut="lolite()" onClick="logVariable('template')" href="../_variables/template.html">$template</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('alternativefullnameformat')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/alternativefullnameformat.html">alternativefullnameformat</a>;
<a name="l3296"><span class="linenum">3296</span></a>          }
<a name="l3297"><span class="linenum">3297</span></a>      }
<a name="l3298"><span class="linenum">3298</span></a>  
<a name="l3299"><span class="linenum">3299</span></a>      <a class="var it12963" onMouseOver="hilite(12963)" onMouseOut="lolite()" onClick="logVariable('requirednames')" href="../_variables/requirednames.html">$requirednames</a> = array();
<a name="l3300"><span class="linenum">3300</span></a>  <span class="comment">    // With each name, see if it is in the display name template, and add it to the required names array if it is.</span>
<a name="l3301"><span class="linenum">3301</span></a>      foreach (<a class="var it7865" onMouseOver="hilite(7865)" onMouseOut="lolite()" onClick="logVariable('allnames')" href="../_variables/allnames.html">$allnames</a> as <a class="var it12881" onMouseOver="hilite(12881)" onMouseOut="lolite()" onClick="logVariable('allname')" href="../_variables/allname.html">$allname</a>) {
<a name="l3302"><span class="linenum">3302</span></a>          if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it1055" onMouseOver="hilite(1055)" onMouseOut="lolite()" onClick="logVariable('template')" href="../_variables/template.html">$template</a>, <a class="var it12881" onMouseOver="hilite(12881)" onMouseOut="lolite()" onClick="logVariable('allname')" href="../_variables/allname.html">$allname</a>) !== false) {
<a name="l3303"><span class="linenum">3303</span></a>              <a class="var it12963" onMouseOver="hilite(12963)" onMouseOut="lolite()" onClick="logVariable('requirednames')" href="../_variables/requirednames.html">$requirednames</a>[] = <a class="var it12881" onMouseOver="hilite(12881)" onMouseOut="lolite()" onClick="logVariable('allname')" href="../_variables/allname.html">$allname</a>;
<a name="l3304"><span class="linenum">3304</span></a>          }
<a name="l3305"><span class="linenum">3305</span></a>      }
<a name="l3306"><span class="linenum">3306</span></a>  
<a name="l3307"><span class="linenum">3307</span></a>      <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('displayname')" href="../_variables/displayname.html">$displayname</a> = <a class="var it1055" onMouseOver="hilite(1055)" onMouseOut="lolite()" onClick="logVariable('template')" href="../_variables/template.html">$template</a>;
<a name="l3308"><span class="linenum">3308</span></a>  <span class="comment">    // Switch in the actual data into the template.</span>
<a name="l3309"><span class="linenum">3309</span></a>      foreach (<a class="var it12963" onMouseOver="hilite(12963)" onMouseOut="lolite()" onClick="logVariable('requirednames')" href="../_variables/requirednames.html">$requirednames</a> as <a class="var it7312" onMouseOver="hilite(7312)" onMouseOut="lolite()" onClick="logVariable('altname')" href="../_variables/altname.html">$altname</a>) {
<a name="l3310"><span class="linenum">3310</span></a>          if (isset(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a class="var it7312" onMouseOver="hilite(7312)" onMouseOut="lolite()" onClick="logVariable('altname')" href="../_variables/altname.html">$altname</a>)) {
<a name="l3311"><span class="linenum">3311</span></a>  <span class="comment">            // Using empty() on the below if statement causes breakages.</span>
<a name="l3312"><span class="linenum">3312</span></a>              if ((string)<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a class="var it7312" onMouseOver="hilite(7312)" onMouseOut="lolite()" onClick="logVariable('altname')" href="../_variables/altname.html">$altname</a> == '') {
<a name="l3313"><span class="linenum">3313</span></a>                  <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('displayname')" href="../_variables/displayname.html">$displayname</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(<a class="var it7312" onMouseOver="hilite(7312)" onMouseOut="lolite()" onClick="logVariable('altname')" href="../_variables/altname.html">$altname</a>, 'EMPTY', <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('displayname')" href="../_variables/displayname.html">$displayname</a>);
<a name="l3314"><span class="linenum">3314</span></a>              } else {
<a name="l3315"><span class="linenum">3315</span></a>                  <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('displayname')" href="../_variables/displayname.html">$displayname</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(<a class="var it7312" onMouseOver="hilite(7312)" onMouseOut="lolite()" onClick="logVariable('altname')" href="../_variables/altname.html">$altname</a>, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a class="var it7312" onMouseOver="hilite(7312)" onMouseOut="lolite()" onClick="logVariable('altname')" href="../_variables/altname.html">$altname</a>, <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('displayname')" href="../_variables/displayname.html">$displayname</a>);
<a name="l3316"><span class="linenum">3316</span></a>              }
<a name="l3317"><span class="linenum">3317</span></a>          } else {
<a name="l3318"><span class="linenum">3318</span></a>              <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('displayname')" href="../_variables/displayname.html">$displayname</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(<a class="var it7312" onMouseOver="hilite(7312)" onMouseOut="lolite()" onClick="logVariable('altname')" href="../_variables/altname.html">$altname</a>, 'EMPTY', <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('displayname')" href="../_variables/displayname.html">$displayname</a>);
<a name="l3319"><span class="linenum">3319</span></a>          }
<a name="l3320"><span class="linenum">3320</span></a>      }
<a name="l3321"><span class="linenum">3321</span></a>  <span class="comment">    // Tidy up any misc. characters (Not perfect, but gets most characters).</span>
<a name="l3322"><span class="linenum">3322</span></a>  <span class="comment">    // Don't remove the &quot;u&quot; at the end of the first expression unless you want garbled characters when combining hiragana or</span>
<a name="l3323"><span class="linenum">3323</span></a>  <span class="comment">    // katakana and parenthesis.</span>
<a name="l3324"><span class="linenum">3324</span></a>      <a class="var it3772" onMouseOver="hilite(3772)" onMouseOut="lolite()" onClick="logVariable('patterns')" href="../_variables/patterns.html">$patterns</a> = array();
<a name="l3325"><span class="linenum">3325</span></a>  <span class="comment">    // This regular expression replacement is to fix problems such as 'James () Kirk' Where 'Tiberius' (middlename) has not been</span>
<a name="l3326"><span class="linenum">3326</span></a>  <span class="comment">    // filled in by a user.</span>
<a name="l3327"><span class="linenum">3327</span></a>  <span class="comment">    // The special characters are Japanese brackets that are common enough to make allowances for them (not covered by :punct:).</span>
<a name="l3328"><span class="linenum">3328</span></a>      <a class="var it3772" onMouseOver="hilite(3772)" onMouseOut="lolite()" onClick="logVariable('patterns')" href="../_variables/patterns.html">$patterns</a>[] = '/[[:punct:]]*EMPTY[[:punct:]]*/u';
<a name="l3329"><span class="linenum">3329</span></a>  <span class="comment">    // This regular expression is to remove any double spaces in the display name.</span>
<a name="l3330"><span class="linenum">3330</span></a>      <a class="var it3772" onMouseOver="hilite(3772)" onMouseOut="lolite()" onClick="logVariable('patterns')" href="../_variables/patterns.html">$patterns</a>[] = '/\s{2,}/u';
<a name="l3331"><span class="linenum">3331</span></a>      foreach (<a class="var it3772" onMouseOver="hilite(3772)" onMouseOut="lolite()" onClick="logVariable('patterns')" href="../_variables/patterns.html">$patterns</a> as <a class="var it1861" onMouseOver="hilite(1861)" onMouseOut="lolite()" onClick="logVariable('pattern')" href="../_variables/pattern.html">$pattern</a>) {
<a name="l3332"><span class="linenum">3332</span></a>          <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('displayname')" href="../_variables/displayname.html">$displayname</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>(<a class="var it1861" onMouseOver="hilite(1861)" onMouseOut="lolite()" onClick="logVariable('pattern')" href="../_variables/pattern.html">$pattern</a>, ' ', <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('displayname')" href="../_variables/displayname.html">$displayname</a>);
<a name="l3333"><span class="linenum">3333</span></a>      }
<a name="l3334"><span class="linenum">3334</span></a>  
<a name="l3335"><span class="linenum">3335</span></a>  <span class="comment">    // Trimming $displayname will help the next check to ensure that we don't have a display name with spaces.</span>
<a name="l3336"><span class="linenum">3336</span></a>      <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('displayname')" href="../_variables/displayname.html">$displayname</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('displayname')" href="../_variables/displayname.html">$displayname</a>);
<a name="l3337"><span class="linenum">3337</span></a>      if (empty(<a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('displayname')" href="../_variables/displayname.html">$displayname</a>)) {
<a name="l3338"><span class="linenum">3338</span></a>  <span class="comment">        // Going with just the first name if no alternate fields are filled out. May be changed later depending on what</span>
<a name="l3339"><span class="linenum">3339</span></a>  <span class="comment">        // people in general feel is a good setting to fall back on.</span>
<a name="l3340"><span class="linenum">3340</span></a>          <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('displayname')" href="../_variables/displayname.html">$displayname</a> = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('firstname')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/firstname.html">firstname</a>;
<a name="l3341"><span class="linenum">3341</span></a>      }
<a name="l3342"><span class="linenum">3342</span></a>      return <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('displayname')" href="../_variables/displayname.html">$displayname</a>;
<a name="l3343"><span class="linenum">3343</span></a>  }
<a name="l3344"><span class="linenum">3344</span></a>  
<a name="l3345"><span class="linenum">3345</span></a>  <span class="comment">/**</span>
<a name="l3346"><span class="linenum">3346</span></a>  <span class="comment"> * A centralised location for the all name fields. Returns an array / sql string snippet.</span>
<a name="l3347"><span class="linenum">3347</span></a>  <span class="comment"> *</span>
<a name="l3348"><span class="linenum">3348</span></a>  <span class="comment"> * @param bool $returnsql True for an sql select field snippet.</span>
<a name="l3349"><span class="linenum">3349</span></a>  <span class="comment"> * @param string $tableprefix table query prefix to use in front of each field.</span>
<a name="l3350"><span class="linenum">3350</span></a>  <span class="comment"> * @param string $prefix prefix added to the name fields e.g. authorfirstname.</span>
<a name="l3351"><span class="linenum">3351</span></a>  <span class="comment"> * @param string $fieldprefix sql field prefix e.g. id AS userid.</span>
<a name="l3352"><span class="linenum">3352</span></a>  <span class="comment"> * @param bool $order moves firstname and lastname to the top of the array / start of the string.</span>
<a name="l3353"><span class="linenum">3353</span></a>  <span class="comment"> * @return array|string All name fields.</span>
<a name="l3354"><span class="linenum">3354</span></a>  <span class="comment"> */</span>
<a name="l3355"><span class="linenum">3355</span></a>  function <a class="function" onClick="logFunction('get_all_user_name_fields')" href="../_functions/get_all_user_name_fields.html" onMouseOver="funcPopup(event,'get_all_user_name_fields')">get_all_user_name_fields</a>(<a class="var it12964" onMouseOver="hilite(12964)" onMouseOut="lolite()" onClick="logVariable('returnsql')" href="../_variables/returnsql.html">$returnsql</a> = false, <a class="var it7811" onMouseOver="hilite(7811)" onMouseOut="lolite()" onClick="logVariable('tableprefix')" href="../_variables/tableprefix.html">$tableprefix</a> = null, <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../_variables/prefix.html">$prefix</a> = null, <a class="var it2274" onMouseOver="hilite(2274)" onMouseOut="lolite()" onClick="logVariable('fieldprefix')" href="../_variables/fieldprefix.html">$fieldprefix</a> = null, <a class="var it2283" onMouseOver="hilite(2283)" onMouseOut="lolite()" onClick="logVariable('order')" href="../_variables/order.html">$order</a> = false) {
<a name="l3356"><span class="linenum">3356</span></a>  <span class="comment">    // This array is provided in this order because when called by fullname() (above) if firstname is before</span>
<a name="l3357"><span class="linenum">3357</span></a>  <span class="comment">    // firstnamephonetic str_replace() will change the wrong placeholder.</span>
<a name="l3358"><span class="linenum">3358</span></a>      <a class="var it12965" onMouseOver="hilite(12965)" onMouseOut="lolite()" onClick="logVariable('alternatenames')" href="../_variables/alternatenames.html">$alternatenames</a> = array('firstnamephonetic' =&gt; 'firstnamephonetic',
<a name="l3359"><span class="linenum">3359</span></a>                              'lastnamephonetic' =&gt; 'lastnamephonetic',
<a name="l3360"><span class="linenum">3360</span></a>                              'middlename' =&gt; 'middlename',
<a name="l3361"><span class="linenum">3361</span></a>                              'alternatename' =&gt; 'alternatename',
<a name="l3362"><span class="linenum">3362</span></a>                              'firstname' =&gt; 'firstname',
<a name="l3363"><span class="linenum">3363</span></a>                              'lastname' =&gt; 'lastname');
<a name="l3364"><span class="linenum">3364</span></a>  
<a name="l3365"><span class="linenum">3365</span></a>  <span class="comment">    // Let's add a prefix to the array of user name fields if provided.</span>
<a name="l3366"><span class="linenum">3366</span></a>      if (<a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../_variables/prefix.html">$prefix</a>) {
<a name="l3367"><span class="linenum">3367</span></a>          foreach (<a class="var it12965" onMouseOver="hilite(12965)" onMouseOut="lolite()" onClick="logVariable('alternatenames')" href="../_variables/alternatenames.html">$alternatenames</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it7312" onMouseOver="hilite(7312)" onMouseOut="lolite()" onClick="logVariable('altname')" href="../_variables/altname.html">$altname</a>) {
<a name="l3368"><span class="linenum">3368</span></a>              <a class="var it12965" onMouseOver="hilite(12965)" onMouseOut="lolite()" onClick="logVariable('alternatenames')" href="../_variables/alternatenames.html">$alternatenames</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../_variables/prefix.html">$prefix</a> . <a class="var it7312" onMouseOver="hilite(7312)" onMouseOut="lolite()" onClick="logVariable('altname')" href="../_variables/altname.html">$altname</a>;
<a name="l3369"><span class="linenum">3369</span></a>          }
<a name="l3370"><span class="linenum">3370</span></a>      }
<a name="l3371"><span class="linenum">3371</span></a>  
<a name="l3372"><span class="linenum">3372</span></a>  <span class="comment">    // If we want the end result to have firstname and lastname at the front / top of the result.</span>
<a name="l3373"><span class="linenum">3373</span></a>      if (<a class="var it2283" onMouseOver="hilite(2283)" onMouseOut="lolite()" onClick="logVariable('order')" href="../_variables/order.html">$order</a>) {
<a name="l3374"><span class="linenum">3374</span></a>  <span class="comment">        // Move the last two elements (firstname, lastname) off the array and put them at the top.</span>
<a name="l3375"><span class="linenum">3375</span></a>          for (<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> = 0; <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> &lt; 2; <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>++) {
<a name="l3376"><span class="linenum">3376</span></a>  <span class="comment">            // Get the last element.</span>
<a name="l3377"><span class="linenum">3377</span></a>              <a class="var it12966" onMouseOver="hilite(12966)" onMouseOut="lolite()" onClick="logVariable('lastelement')" href="../_variables/lastelement.html">$lastelement</a> = <a class="phpfunction" onClick="logFunction('end')" href="../_functions/end.html" onMouseOver="phpfuncPopup(event,'end')">end</a>(<a class="var it12965" onMouseOver="hilite(12965)" onMouseOut="lolite()" onClick="logVariable('alternatenames')" href="../_variables/alternatenames.html">$alternatenames</a>);
<a name="l3378"><span class="linenum">3378</span></a>  <span class="comment">            // Remove it from the array.</span>
<a name="l3379"><span class="linenum">3379</span></a>              unset(<a class="var it12965" onMouseOver="hilite(12965)" onMouseOut="lolite()" onClick="logVariable('alternatenames')" href="../_variables/alternatenames.html">$alternatenames</a>[<a class="var it12966" onMouseOver="hilite(12966)" onMouseOut="lolite()" onClick="logVariable('lastelement')" href="../_variables/lastelement.html">$lastelement</a>]);
<a name="l3380"><span class="linenum">3380</span></a>  <span class="comment">            // Put the element back on the top of the array.</span>
<a name="l3381"><span class="linenum">3381</span></a>              <a class="var it12965" onMouseOver="hilite(12965)" onMouseOut="lolite()" onClick="logVariable('alternatenames')" href="../_variables/alternatenames.html">$alternatenames</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(array(<a class="var it12966" onMouseOver="hilite(12966)" onMouseOut="lolite()" onClick="logVariable('lastelement')" href="../_variables/lastelement.html">$lastelement</a> =&gt; <a class="var it12966" onMouseOver="hilite(12966)" onMouseOut="lolite()" onClick="logVariable('lastelement')" href="../_variables/lastelement.html">$lastelement</a>), <a class="var it12965" onMouseOver="hilite(12965)" onMouseOut="lolite()" onClick="logVariable('alternatenames')" href="../_variables/alternatenames.html">$alternatenames</a>);
<a name="l3382"><span class="linenum">3382</span></a>          }
<a name="l3383"><span class="linenum">3383</span></a>      }
<a name="l3384"><span class="linenum">3384</span></a>  
<a name="l3385"><span class="linenum">3385</span></a>  <span class="comment">    // Create an sql field snippet if requested.</span>
<a name="l3386"><span class="linenum">3386</span></a>      if (<a class="var it12964" onMouseOver="hilite(12964)" onMouseOut="lolite()" onClick="logVariable('returnsql')" href="../_variables/returnsql.html">$returnsql</a>) {
<a name="l3387"><span class="linenum">3387</span></a>          if (<a class="var it7811" onMouseOver="hilite(7811)" onMouseOut="lolite()" onClick="logVariable('tableprefix')" href="../_variables/tableprefix.html">$tableprefix</a>) {
<a name="l3388"><span class="linenum">3388</span></a>              if (<a class="var it2274" onMouseOver="hilite(2274)" onMouseOut="lolite()" onClick="logVariable('fieldprefix')" href="../_variables/fieldprefix.html">$fieldprefix</a>) {
<a name="l3389"><span class="linenum">3389</span></a>                  foreach (<a class="var it12965" onMouseOver="hilite(12965)" onMouseOut="lolite()" onClick="logVariable('alternatenames')" href="../_variables/alternatenames.html">$alternatenames</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it7312" onMouseOver="hilite(7312)" onMouseOut="lolite()" onClick="logVariable('altname')" href="../_variables/altname.html">$altname</a>) {
<a name="l3390"><span class="linenum">3390</span></a>                      <a class="var it12965" onMouseOver="hilite(12965)" onMouseOut="lolite()" onClick="logVariable('alternatenames')" href="../_variables/alternatenames.html">$alternatenames</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = <a class="var it7811" onMouseOver="hilite(7811)" onMouseOut="lolite()" onClick="logVariable('tableprefix')" href="../_variables/tableprefix.html">$tableprefix</a> . '.' . <a class="var it7312" onMouseOver="hilite(7312)" onMouseOut="lolite()" onClick="logVariable('altname')" href="../_variables/altname.html">$altname</a> . ' AS ' . <a class="var it2274" onMouseOver="hilite(2274)" onMouseOut="lolite()" onClick="logVariable('fieldprefix')" href="../_variables/fieldprefix.html">$fieldprefix</a> . <a class="var it7312" onMouseOver="hilite(7312)" onMouseOut="lolite()" onClick="logVariable('altname')" href="../_variables/altname.html">$altname</a>;
<a name="l3391"><span class="linenum">3391</span></a>                  }
<a name="l3392"><span class="linenum">3392</span></a>              } else {
<a name="l3393"><span class="linenum">3393</span></a>                  foreach (<a class="var it12965" onMouseOver="hilite(12965)" onMouseOut="lolite()" onClick="logVariable('alternatenames')" href="../_variables/alternatenames.html">$alternatenames</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it7312" onMouseOver="hilite(7312)" onMouseOut="lolite()" onClick="logVariable('altname')" href="../_variables/altname.html">$altname</a>) {
<a name="l3394"><span class="linenum">3394</span></a>                      <a class="var it12965" onMouseOver="hilite(12965)" onMouseOut="lolite()" onClick="logVariable('alternatenames')" href="../_variables/alternatenames.html">$alternatenames</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = <a class="var it7811" onMouseOver="hilite(7811)" onMouseOut="lolite()" onClick="logVariable('tableprefix')" href="../_variables/tableprefix.html">$tableprefix</a> . '.' . <a class="var it7312" onMouseOver="hilite(7312)" onMouseOut="lolite()" onClick="logVariable('altname')" href="../_variables/altname.html">$altname</a>;
<a name="l3395"><span class="linenum">3395</span></a>                  }
<a name="l3396"><span class="linenum">3396</span></a>              }
<a name="l3397"><span class="linenum">3397</span></a>          }
<a name="l3398"><span class="linenum">3398</span></a>          <a class="var it12965" onMouseOver="hilite(12965)" onMouseOut="lolite()" onClick="logVariable('alternatenames')" href="../_variables/alternatenames.html">$alternatenames</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(',', <a class="var it12965" onMouseOver="hilite(12965)" onMouseOut="lolite()" onClick="logVariable('alternatenames')" href="../_variables/alternatenames.html">$alternatenames</a>);
<a name="l3399"><span class="linenum">3399</span></a>      }
<a name="l3400"><span class="linenum">3400</span></a>      return <a class="var it12965" onMouseOver="hilite(12965)" onMouseOut="lolite()" onClick="logVariable('alternatenames')" href="../_variables/alternatenames.html">$alternatenames</a>;
<a name="l3401"><span class="linenum">3401</span></a>  }
<a name="l3402"><span class="linenum">3402</span></a>  
<a name="l3403"><span class="linenum">3403</span></a>  <span class="comment">/**</span>
<a name="l3404"><span class="linenum">3404</span></a>  <span class="comment"> * Reduces lines of duplicated code for getting user name fields.</span>
<a name="l3405"><span class="linenum">3405</span></a>  <span class="comment"> *</span>
<a name="l3406"><span class="linenum">3406</span></a>  <span class="comment"> * See also {@link user_picture::unalias()}</span>
<a name="l3407"><span class="linenum">3407</span></a>  <span class="comment"> *</span>
<a name="l3408"><span class="linenum">3408</span></a>  <span class="comment"> * @param object $addtoobject Object to add user name fields to.</span>
<a name="l3409"><span class="linenum">3409</span></a>  <span class="comment"> * @param object $secondobject Object that contains user name field information.</span>
<a name="l3410"><span class="linenum">3410</span></a>  <span class="comment"> * @param string $prefix prefix to be added to all fields (including $additionalfields) e.g. authorfirstname.</span>
<a name="l3411"><span class="linenum">3411</span></a>  <span class="comment"> * @param array $additionalfields Additional fields to be matched with data in the second object.</span>
<a name="l3412"><span class="linenum">3412</span></a>  <span class="comment"> * The key can be set to the user table field name.</span>
<a name="l3413"><span class="linenum">3413</span></a>  <span class="comment"> * @return object User name fields.</span>
<a name="l3414"><span class="linenum">3414</span></a>  <span class="comment"> */</span>
<a name="l3415"><span class="linenum">3415</span></a>  function <a class="function" onClick="logFunction('username_load_fields_from_object')" href="../_functions/username_load_fields_from_object.html" onMouseOver="funcPopup(event,'username_load_fields_from_object')">username_load_fields_from_object</a>(<a class="var it12967" onMouseOver="hilite(12967)" onMouseOut="lolite()" onClick="logVariable('addtoobject')" href="../_variables/addtoobject.html">$addtoobject</a>, <a class="var it12968" onMouseOver="hilite(12968)" onMouseOut="lolite()" onClick="logVariable('secondobject')" href="../_variables/secondobject.html">$secondobject</a>, <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../_variables/prefix.html">$prefix</a> = null, <a class="var it2976" onMouseOver="hilite(2976)" onMouseOut="lolite()" onClick="logVariable('additionalfields')" href="../_variables/additionalfields.html">$additionalfields</a> = null) {
<a name="l3416"><span class="linenum">3416</span></a>      <a class="var it399" onMouseOver="hilite(399)" onMouseOut="lolite()" onClick="logVariable('fields')" href="../_variables/fields.html">$fields</a> = <a class="function" onClick="logFunction('get_all_user_name_fields')" href="../_functions/get_all_user_name_fields.html" onMouseOver="funcPopup(event,'get_all_user_name_fields')">get_all_user_name_fields</a>(false, null, <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../_variables/prefix.html">$prefix</a>);
<a name="l3417"><span class="linenum">3417</span></a>      if (<a class="var it2976" onMouseOver="hilite(2976)" onMouseOut="lolite()" onClick="logVariable('additionalfields')" href="../_variables/additionalfields.html">$additionalfields</a>) {
<a name="l3418"><span class="linenum">3418</span></a>  <span class="comment">        // Additional fields can specify their own 'alias' such as 'id' =&gt; 'userid'. This checks to see if</span>
<a name="l3419"><span class="linenum">3419</span></a>  <span class="comment">        // the key is a number and then sets the key to the array value.</span>
<a name="l3420"><span class="linenum">3420</span></a>          foreach (<a class="var it2976" onMouseOver="hilite(2976)" onMouseOut="lolite()" onClick="logVariable('additionalfields')" href="../_variables/additionalfields.html">$additionalfields</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) {
<a name="l3421"><span class="linenum">3421</span></a>              if (<a class="phpfunction" onClick="logFunction('is_numeric')" href="../_functions/is_numeric.html" onMouseOver="phpfuncPopup(event,'is_numeric')">is_numeric</a>(<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>)) {
<a name="l3422"><span class="linenum">3422</span></a>                  <a class="var it2976" onMouseOver="hilite(2976)" onMouseOut="lolite()" onClick="logVariable('additionalfields')" href="../_variables/additionalfields.html">$additionalfields</a>[<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>] = <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../_variables/prefix.html">$prefix</a> . <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l3423"><span class="linenum">3423</span></a>                  unset(<a class="var it2976" onMouseOver="hilite(2976)" onMouseOut="lolite()" onClick="logVariable('additionalfields')" href="../_variables/additionalfields.html">$additionalfields</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>]);
<a name="l3424"><span class="linenum">3424</span></a>              } else {
<a name="l3425"><span class="linenum">3425</span></a>                  <a class="var it2976" onMouseOver="hilite(2976)" onMouseOut="lolite()" onClick="logVariable('additionalfields')" href="../_variables/additionalfields.html">$additionalfields</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../_variables/prefix.html">$prefix</a> . <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l3426"><span class="linenum">3426</span></a>              }
<a name="l3427"><span class="linenum">3427</span></a>          }
<a name="l3428"><span class="linenum">3428</span></a>          <a class="var it399" onMouseOver="hilite(399)" onMouseOut="lolite()" onClick="logVariable('fields')" href="../_variables/fields.html">$fields</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it399" onMouseOver="hilite(399)" onMouseOut="lolite()" onClick="logVariable('fields')" href="../_variables/fields.html">$fields</a>, <a class="var it2976" onMouseOver="hilite(2976)" onMouseOut="lolite()" onClick="logVariable('additionalfields')" href="../_variables/additionalfields.html">$additionalfields</a>);
<a name="l3429"><span class="linenum">3429</span></a>      }
<a name="l3430"><span class="linenum">3430</span></a>      foreach (<a class="var it399" onMouseOver="hilite(399)" onMouseOut="lolite()" onClick="logVariable('fields')" href="../_variables/fields.html">$fields</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it1464" onMouseOver="hilite(1464)" onMouseOut="lolite()" onClick="logVariable('field')" href="../_variables/field.html">$field</a>) {
<a name="l3431"><span class="linenum">3431</span></a>  <span class="comment">        // Important that we have all of the user name fields present in the object that we are sending back.</span>
<a name="l3432"><span class="linenum">3432</span></a>          <a class="var it12967" onMouseOver="hilite(12967)" onMouseOut="lolite()" onClick="logVariable('addtoobject')" href="../_variables/addtoobject.html">$addtoobject</a>-&gt;<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> = '';
<a name="l3433"><span class="linenum">3433</span></a>          if (isset(<a class="var it12968" onMouseOver="hilite(12968)" onMouseOut="lolite()" onClick="logVariable('secondobject')" href="../_variables/secondobject.html">$secondobject</a>-&gt;<a class="var it1464" onMouseOver="hilite(1464)" onMouseOut="lolite()" onClick="logVariable('field')" href="../_variables/field.html">$field</a>)) {
<a name="l3434"><span class="linenum">3434</span></a>              <a class="var it12967" onMouseOver="hilite(12967)" onMouseOut="lolite()" onClick="logVariable('addtoobject')" href="../_variables/addtoobject.html">$addtoobject</a>-&gt;<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> = <a class="var it12968" onMouseOver="hilite(12968)" onMouseOut="lolite()" onClick="logVariable('secondobject')" href="../_variables/secondobject.html">$secondobject</a>-&gt;<a class="var it1464" onMouseOver="hilite(1464)" onMouseOut="lolite()" onClick="logVariable('field')" href="../_variables/field.html">$field</a>;
<a name="l3435"><span class="linenum">3435</span></a>          }
<a name="l3436"><span class="linenum">3436</span></a>      }
<a name="l3437"><span class="linenum">3437</span></a>      return <a class="var it12967" onMouseOver="hilite(12967)" onMouseOut="lolite()" onClick="logVariable('addtoobject')" href="../_variables/addtoobject.html">$addtoobject</a>;
<a name="l3438"><span class="linenum">3438</span></a>  }
<a name="l3439"><span class="linenum">3439</span></a>  
<a name="l3440"><span class="linenum">3440</span></a>  <span class="comment">/**</span>
<a name="l3441"><span class="linenum">3441</span></a>  <span class="comment"> * Returns an array of values in order of occurance in a provided string.</span>
<a name="l3442"><span class="linenum">3442</span></a>  <span class="comment"> * The key in the result is the character postion in the string.</span>
<a name="l3443"><span class="linenum">3443</span></a>  <span class="comment"> *</span>
<a name="l3444"><span class="linenum">3444</span></a>  <span class="comment"> * @param array $values Values to be found in the string format</span>
<a name="l3445"><span class="linenum">3445</span></a>  <span class="comment"> * @param string $stringformat The string which may contain values being searched for.</span>
<a name="l3446"><span class="linenum">3446</span></a>  <span class="comment"> * @return array An array of values in order according to placement in the string format.</span>
<a name="l3447"><span class="linenum">3447</span></a>  <span class="comment"> */</span>
<a name="l3448"><span class="linenum">3448</span></a>  function <a class="function" onClick="logFunction('order_in_string')" href="../_functions/order_in_string.html" onMouseOver="funcPopup(event,'order_in_string')">order_in_string</a>(<a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../_variables/values.html">$values</a>, <a class="var it12969" onMouseOver="hilite(12969)" onMouseOut="lolite()" onClick="logVariable('stringformat')" href="../_variables/stringformat.html">$stringformat</a>) {
<a name="l3449"><span class="linenum">3449</span></a>      <a class="var it5533" onMouseOver="hilite(5533)" onMouseOut="lolite()" onClick="logVariable('valuearray')" href="../_variables/valuearray.html">$valuearray</a> = array();
<a name="l3450"><span class="linenum">3450</span></a>      foreach (<a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../_variables/values.html">$values</a> as <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) {
<a name="l3451"><span class="linenum">3451</span></a>          <a class="var it1861" onMouseOver="hilite(1861)" onMouseOut="lolite()" onClick="logVariable('pattern')" href="../_variables/pattern.html">$pattern</a> = &quot;/<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>\b/&quot;;
<a name="l3452"><span class="linenum">3452</span></a>  <span class="comment">        // Using preg_match as strpos() may match values that are similar e.g. firstname and firstnamephonetic.</span>
<a name="l3453"><span class="linenum">3453</span></a>          if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>(<a class="var it1861" onMouseOver="hilite(1861)" onMouseOut="lolite()" onClick="logVariable('pattern')" href="../_variables/pattern.html">$pattern</a>, <a class="var it12969" onMouseOver="hilite(12969)" onMouseOut="lolite()" onClick="logVariable('stringformat')" href="../_variables/stringformat.html">$stringformat</a>)) {
<a name="l3454"><span class="linenum">3454</span></a>              <a class="var it81" onMouseOver="hilite(81)" onMouseOut="lolite()" onClick="logVariable('replacement')" href="../_variables/replacement.html">$replacement</a> = &quot;thing&quot;;
<a name="l3455"><span class="linenum">3455</span></a>  <span class="comment">            // Replace the value with something more unique to ensure we get the right position when using strpos().</span>
<a name="l3456"><span class="linenum">3456</span></a>              <a class="var it12970" onMouseOver="hilite(12970)" onMouseOut="lolite()" onClick="logVariable('newformat')" href="../_variables/newformat.html">$newformat</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>(<a class="var it1861" onMouseOver="hilite(1861)" onMouseOut="lolite()" onClick="logVariable('pattern')" href="../_variables/pattern.html">$pattern</a>, <a class="var it81" onMouseOver="hilite(81)" onMouseOut="lolite()" onClick="logVariable('replacement')" href="../_variables/replacement.html">$replacement</a>, <a class="var it12969" onMouseOver="hilite(12969)" onMouseOut="lolite()" onClick="logVariable('stringformat')" href="../_variables/stringformat.html">$stringformat</a>);
<a name="l3457"><span class="linenum">3457</span></a>              <a class="var it1047" onMouseOver="hilite(1047)" onMouseOut="lolite()" onClick="logVariable('position')" href="../_variables/position.html">$position</a> = <a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it12970" onMouseOver="hilite(12970)" onMouseOut="lolite()" onClick="logVariable('newformat')" href="../_variables/newformat.html">$newformat</a>, <a class="var it81" onMouseOver="hilite(81)" onMouseOut="lolite()" onClick="logVariable('replacement')" href="../_variables/replacement.html">$replacement</a>);
<a name="l3458"><span class="linenum">3458</span></a>              <a class="var it5533" onMouseOver="hilite(5533)" onMouseOut="lolite()" onClick="logVariable('valuearray')" href="../_variables/valuearray.html">$valuearray</a>[<a class="var it1047" onMouseOver="hilite(1047)" onMouseOut="lolite()" onClick="logVariable('position')" href="../_variables/position.html">$position</a>] = <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l3459"><span class="linenum">3459</span></a>          }
<a name="l3460"><span class="linenum">3460</span></a>      }
<a name="l3461"><span class="linenum">3461</span></a>      <a class="phpfunction" onClick="logFunction('ksort')" href="../_functions/ksort.html" onMouseOver="phpfuncPopup(event,'ksort')">ksort</a>(<a class="var it5533" onMouseOver="hilite(5533)" onMouseOut="lolite()" onClick="logVariable('valuearray')" href="../_variables/valuearray.html">$valuearray</a>);
<a name="l3462"><span class="linenum">3462</span></a>      return <a class="var it5533" onMouseOver="hilite(5533)" onMouseOut="lolite()" onClick="logVariable('valuearray')" href="../_variables/valuearray.html">$valuearray</a>;
<a name="l3463"><span class="linenum">3463</span></a>  }
<a name="l3464"><span class="linenum">3464</span></a>  
<a name="l3465"><span class="linenum">3465</span></a>  <span class="comment">/**</span>
<a name="l3466"><span class="linenum">3466</span></a>  <span class="comment"> * Checks if current user is shown any extra fields when listing users.</span>
<a name="l3467"><span class="linenum">3467</span></a>  <span class="comment"> *</span>
<a name="l3468"><span class="linenum">3468</span></a>  <span class="comment"> * @param object $context Context</span>
<a name="l3469"><span class="linenum">3469</span></a>  <span class="comment"> * @param array $already Array of fields that we're going to show anyway</span>
<a name="l3470"><span class="linenum">3470</span></a>  <span class="comment"> *   so don't bother listing them</span>
<a name="l3471"><span class="linenum">3471</span></a>  <span class="comment"> * @return array Array of field names from user table, not including anything</span>
<a name="l3472"><span class="linenum">3472</span></a>  <span class="comment"> *   listed in $already</span>
<a name="l3473"><span class="linenum">3473</span></a>  <span class="comment"> */</span>
<a name="l3474"><span class="linenum">3474</span></a>  function <a class="function" onClick="logFunction('get_extra_user_fields')" href="../_functions/get_extra_user_fields.html" onMouseOver="funcPopup(event,'get_extra_user_fields')">get_extra_user_fields</a>(<a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>, <a class="var it9337" onMouseOver="hilite(9337)" onMouseOut="lolite()" onClick="logVariable('already')" href="../_variables/already.html">$already</a> = array()) {
<a name="l3475"><span class="linenum">3475</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l3476"><span class="linenum">3476</span></a>  
<a name="l3477"><span class="linenum">3477</span></a>  <span class="comment">    // Only users with permission get the extra fields.</span>
<a name="l3478"><span class="linenum">3478</span></a>      if (!<a class="function" onClick="logFunction('has_capability')" href="../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/site:viewuseridentity', <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>)) {
<a name="l3479"><span class="linenum">3479</span></a>          return array();
<a name="l3480"><span class="linenum">3480</span></a>      }
<a name="l3481"><span class="linenum">3481</span></a>  
<a name="l3482"><span class="linenum">3482</span></a>  <span class="comment">    // Split showuseridentity on comma.</span>
<a name="l3483"><span class="linenum">3483</span></a>      if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('showuseridentity')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/showuseridentity.html">showuseridentity</a>)) {
<a name="l3484"><span class="linenum">3484</span></a>  <span class="comment">        // Explode gives wrong result with empty string.</span>
<a name="l3485"><span class="linenum">3485</span></a>          <a class="var it2018" onMouseOver="hilite(2018)" onMouseOut="lolite()" onClick="logVariable('extra')" href="../_variables/extra.html">$extra</a> = array();
<a name="l3486"><span class="linenum">3486</span></a>      } else {
<a name="l3487"><span class="linenum">3487</span></a>          <a class="var it2018" onMouseOver="hilite(2018)" onMouseOut="lolite()" onClick="logVariable('extra')" href="../_variables/extra.html">$extra</a> =  <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(',', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('showuseridentity')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/showuseridentity.html">showuseridentity</a>);
<a name="l3488"><span class="linenum">3488</span></a>      }
<a name="l3489"><span class="linenum">3489</span></a>      <a class="var it12971" onMouseOver="hilite(12971)" onMouseOut="lolite()" onClick="logVariable('renumber')" href="../_variables/renumber.html">$renumber</a> = false;
<a name="l3490"><span class="linenum">3490</span></a>      foreach (<a class="var it2018" onMouseOver="hilite(2018)" onMouseOut="lolite()" onClick="logVariable('extra')" href="../_variables/extra.html">$extra</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it1464" onMouseOver="hilite(1464)" onMouseOut="lolite()" onClick="logVariable('field')" href="../_variables/field.html">$field</a>) {
<a name="l3491"><span class="linenum">3491</span></a>          if (<a class="phpfunction" onClick="logFunction('in_array')" href="../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it1464" onMouseOver="hilite(1464)" onMouseOut="lolite()" onClick="logVariable('field')" href="../_variables/field.html">$field</a>, <a class="var it9337" onMouseOver="hilite(9337)" onMouseOut="lolite()" onClick="logVariable('already')" href="../_variables/already.html">$already</a>)) {
<a name="l3492"><span class="linenum">3492</span></a>              unset(<a class="var it2018" onMouseOver="hilite(2018)" onMouseOut="lolite()" onClick="logVariable('extra')" href="../_variables/extra.html">$extra</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>]);
<a name="l3493"><span class="linenum">3493</span></a>              <a class="var it12971" onMouseOver="hilite(12971)" onMouseOut="lolite()" onClick="logVariable('renumber')" href="../_variables/renumber.html">$renumber</a> = true;
<a name="l3494"><span class="linenum">3494</span></a>          }
<a name="l3495"><span class="linenum">3495</span></a>      }
<a name="l3496"><span class="linenum">3496</span></a>      if (<a class="var it12971" onMouseOver="hilite(12971)" onMouseOut="lolite()" onClick="logVariable('renumber')" href="../_variables/renumber.html">$renumber</a>) {
<a name="l3497"><span class="linenum">3497</span></a>  <span class="comment">        // For consistency, if entries are removed from array, renumber it</span>
<a name="l3498"><span class="linenum">3498</span></a>  <span class="comment">        // so they are numbered as you would expect.</span>
<a name="l3499"><span class="linenum">3499</span></a>          <a class="var it2018" onMouseOver="hilite(2018)" onMouseOut="lolite()" onClick="logVariable('extra')" href="../_variables/extra.html">$extra</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it2018" onMouseOver="hilite(2018)" onMouseOut="lolite()" onClick="logVariable('extra')" href="../_variables/extra.html">$extra</a>);
<a name="l3500"><span class="linenum">3500</span></a>      }
<a name="l3501"><span class="linenum">3501</span></a>      return <a class="var it2018" onMouseOver="hilite(2018)" onMouseOut="lolite()" onClick="logVariable('extra')" href="../_variables/extra.html">$extra</a>;
<a name="l3502"><span class="linenum">3502</span></a>  }
<a name="l3503"><span class="linenum">3503</span></a>  
<a name="l3504"><span class="linenum">3504</span></a>  <span class="comment">/**</span>
<a name="l3505"><span class="linenum">3505</span></a>  <span class="comment"> * If the current user is to be shown extra user fields when listing or</span>
<a name="l3506"><span class="linenum">3506</span></a>  <span class="comment"> * selecting users, returns a string suitable for including in an SQL select</span>
<a name="l3507"><span class="linenum">3507</span></a>  <span class="comment"> * clause to retrieve those fields.</span>
<a name="l3508"><span class="linenum">3508</span></a>  <span class="comment"> *</span>
<a name="l3509"><span class="linenum">3509</span></a>  <span class="comment"> * @param context $context Context</span>
<a name="l3510"><span class="linenum">3510</span></a>  <span class="comment"> * @param string $alias Alias of user table, e.g. 'u' (default none)</span>
<a name="l3511"><span class="linenum">3511</span></a>  <span class="comment"> * @param string $prefix Prefix for field names using AS, e.g. 'u_' (default none)</span>
<a name="l3512"><span class="linenum">3512</span></a>  <span class="comment"> * @param array $already Array of fields that we're going to include anyway so don't list them (default none)</span>
<a name="l3513"><span class="linenum">3513</span></a>  <span class="comment"> * @return string Partial SQL select clause, beginning with comma, for example ',u.idnumber,u.department' unless it is blank</span>
<a name="l3514"><span class="linenum">3514</span></a>  <span class="comment"> */</span>
<a name="l3515"><span class="linenum">3515</span></a>  function <a class="function" onClick="logFunction('get_extra_user_fields_sql')" href="../_functions/get_extra_user_fields_sql.html" onMouseOver="funcPopup(event,'get_extra_user_fields_sql')">get_extra_user_fields_sql</a>(<a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>, <a class="var it9120" onMouseOver="hilite(9120)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../_variables/alias.html">$alias</a>='', <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../_variables/prefix.html">$prefix</a>='', <a class="var it9337" onMouseOver="hilite(9337)" onMouseOut="lolite()" onClick="logVariable('already')" href="../_variables/already.html">$already</a> = array()) {
<a name="l3516"><span class="linenum">3516</span></a>      <a class="var it399" onMouseOver="hilite(399)" onMouseOut="lolite()" onClick="logVariable('fields')" href="../_variables/fields.html">$fields</a> = <a class="function" onClick="logFunction('get_extra_user_fields')" href="../_functions/get_extra_user_fields.html" onMouseOver="funcPopup(event,'get_extra_user_fields')">get_extra_user_fields</a>(<a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>, <a class="var it9337" onMouseOver="hilite(9337)" onMouseOut="lolite()" onClick="logVariable('already')" href="../_variables/already.html">$already</a>);
<a name="l3517"><span class="linenum">3517</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = '';
<a name="l3518"><span class="linenum">3518</span></a>  <span class="comment">    // Add punctuation for alias.</span>
<a name="l3519"><span class="linenum">3519</span></a>      if (<a class="var it9120" onMouseOver="hilite(9120)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../_variables/alias.html">$alias</a> !== '') {
<a name="l3520"><span class="linenum">3520</span></a>          <a class="var it9120" onMouseOver="hilite(9120)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../_variables/alias.html">$alias</a> .= '.';
<a name="l3521"><span class="linenum">3521</span></a>      }
<a name="l3522"><span class="linenum">3522</span></a>      foreach (<a class="var it399" onMouseOver="hilite(399)" onMouseOut="lolite()" onClick="logVariable('fields')" href="../_variables/fields.html">$fields</a> as <a class="var it1464" onMouseOver="hilite(1464)" onMouseOut="lolite()" onClick="logVariable('field')" href="../_variables/field.html">$field</a>) {
<a name="l3523"><span class="linenum">3523</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> .= ', ' . <a class="var it9120" onMouseOver="hilite(9120)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../_variables/alias.html">$alias</a> . <a class="var it1464" onMouseOver="hilite(1464)" onMouseOut="lolite()" onClick="logVariable('field')" href="../_variables/field.html">$field</a>;
<a name="l3524"><span class="linenum">3524</span></a>          if (<a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../_variables/prefix.html">$prefix</a>) {
<a name="l3525"><span class="linenum">3525</span></a>              <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> .= ' AS ' . <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../_variables/prefix.html">$prefix</a> . <a class="var it1464" onMouseOver="hilite(1464)" onMouseOut="lolite()" onClick="logVariable('field')" href="../_variables/field.html">$field</a>;
<a name="l3526"><span class="linenum">3526</span></a>          }
<a name="l3527"><span class="linenum">3527</span></a>      }
<a name="l3528"><span class="linenum">3528</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>;
<a name="l3529"><span class="linenum">3529</span></a>  }
<a name="l3530"><span class="linenum">3530</span></a>  
<a name="l3531"><span class="linenum">3531</span></a>  <span class="comment">/**</span>
<a name="l3532"><span class="linenum">3532</span></a>  <span class="comment"> * Returns the display name of a field in the user table. Works for most fields that are commonly displayed to users.</span>
<a name="l3533"><span class="linenum">3533</span></a>  <span class="comment"> * @param string $field Field name, e.g. 'phone1'</span>
<a name="l3534"><span class="linenum">3534</span></a>  <span class="comment"> * @return string Text description taken from language file, e.g. 'Phone number'</span>
<a name="l3535"><span class="linenum">3535</span></a>  <span class="comment"> */</span>
<a name="l3536"><span class="linenum">3536</span></a>  function <a class="function" onClick="logFunction('get_user_field_name')" href="../_functions/get_user_field_name.html" onMouseOver="funcPopup(event,'get_user_field_name')">get_user_field_name</a>(<a class="var it1464" onMouseOver="hilite(1464)" onMouseOut="lolite()" onClick="logVariable('field')" href="../_variables/field.html">$field</a>) {
<a name="l3537"><span class="linenum">3537</span></a>  <span class="comment">    // Some fields have language strings which are not the same as field name.</span>
<a name="l3538"><span class="linenum">3538</span></a>      switch (<a class="var it1464" onMouseOver="hilite(1464)" onMouseOut="lolite()" onClick="logVariable('field')" href="../_variables/field.html">$field</a>) {
<a name="l3539"><span class="linenum">3539</span></a>          case 'phone1' : {
<a name="l3540"><span class="linenum">3540</span></a>              return <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('phone');
<a name="l3541"><span class="linenum">3541</span></a>          }
<a name="l3542"><span class="linenum">3542</span></a>          case 'url' : {
<a name="l3543"><span class="linenum">3543</span></a>              return <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('webpage');
<a name="l3544"><span class="linenum">3544</span></a>          }
<a name="l3545"><span class="linenum">3545</span></a>          case 'icq' : {
<a name="l3546"><span class="linenum">3546</span></a>              return <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('icqnumber');
<a name="l3547"><span class="linenum">3547</span></a>          }
<a name="l3548"><span class="linenum">3548</span></a>          case 'skype' : {
<a name="l3549"><span class="linenum">3549</span></a>              return <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('skypeid');
<a name="l3550"><span class="linenum">3550</span></a>          }
<a name="l3551"><span class="linenum">3551</span></a>          case 'aim' : {
<a name="l3552"><span class="linenum">3552</span></a>              return <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('aimid');
<a name="l3553"><span class="linenum">3553</span></a>          }
<a name="l3554"><span class="linenum">3554</span></a>          case 'yahoo' : {
<a name="l3555"><span class="linenum">3555</span></a>              return <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('yahooid');
<a name="l3556"><span class="linenum">3556</span></a>          }
<a name="l3557"><span class="linenum">3557</span></a>          case 'msn' : {
<a name="l3558"><span class="linenum">3558</span></a>              return <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('msnid');
<a name="l3559"><span class="linenum">3559</span></a>          }
<a name="l3560"><span class="linenum">3560</span></a>      }
<a name="l3561"><span class="linenum">3561</span></a>  <span class="comment">    // Otherwise just use the same lang string.</span>
<a name="l3562"><span class="linenum">3562</span></a>      return <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(<a class="var it1464" onMouseOver="hilite(1464)" onMouseOut="lolite()" onClick="logVariable('field')" href="../_variables/field.html">$field</a>);
<a name="l3563"><span class="linenum">3563</span></a>  }
<a name="l3564"><span class="linenum">3564</span></a>  
<a name="l3565"><span class="linenum">3565</span></a>  <span class="comment">/**</span>
<a name="l3566"><span class="linenum">3566</span></a>  <span class="comment"> * Returns whether a given authentication plugin exists.</span>
<a name="l3567"><span class="linenum">3567</span></a>  <span class="comment"> *</span>
<a name="l3568"><span class="linenum">3568</span></a>  <span class="comment"> * @param string $auth Form of authentication to check for. Defaults to the global setting in {@link $CFG}.</span>
<a name="l3569"><span class="linenum">3569</span></a>  <span class="comment"> * @return boolean Whether the plugin is available.</span>
<a name="l3570"><span class="linenum">3570</span></a>  <span class="comment"> */</span>
<a name="l3571"><span class="linenum">3571</span></a>  function <a class="function" onClick="logFunction('exists_auth_plugin')" href="../_functions/exists_auth_plugin.html" onMouseOver="funcPopup(event,'exists_auth_plugin')">exists_auth_plugin</a>(<a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>) {
<a name="l3572"><span class="linenum">3572</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l3573"><span class="linenum">3573</span></a>  
<a name="l3574"><span class="linenum">3574</span></a>      if (<a class="phpfunction" onClick="logFunction('file_exists')" href="../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(&quot;{<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>}/auth/<a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>/auth.php&quot;)) {
<a name="l3575"><span class="linenum">3575</span></a>          return <a class="phpfunction" onClick="logFunction('is_readable')" href="../_functions/is_readable.html" onMouseOver="phpfuncPopup(event,'is_readable')">is_readable</a>(&quot;{<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>}/auth/<a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>/auth.php&quot;);
<a name="l3576"><span class="linenum">3576</span></a>      }
<a name="l3577"><span class="linenum">3577</span></a>      return false;
<a name="l3578"><span class="linenum">3578</span></a>  }
<a name="l3579"><span class="linenum">3579</span></a>  
<a name="l3580"><span class="linenum">3580</span></a>  <span class="comment">/**</span>
<a name="l3581"><span class="linenum">3581</span></a>  <span class="comment"> * Checks if a given plugin is in the list of enabled authentication plugins.</span>
<a name="l3582"><span class="linenum">3582</span></a>  <span class="comment"> *</span>
<a name="l3583"><span class="linenum">3583</span></a>  <span class="comment"> * @param string $auth Authentication plugin.</span>
<a name="l3584"><span class="linenum">3584</span></a>  <span class="comment"> * @return boolean Whether the plugin is enabled.</span>
<a name="l3585"><span class="linenum">3585</span></a>  <span class="comment"> */</span>
<a name="l3586"><span class="linenum">3586</span></a>  function <a class="function" onClick="logFunction('is_enabled_auth')" href="../_functions/is_enabled_auth.html" onMouseOver="funcPopup(event,'is_enabled_auth')">is_enabled_auth</a>(<a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>) {
<a name="l3587"><span class="linenum">3587</span></a>      if (empty(<a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>)) {
<a name="l3588"><span class="linenum">3588</span></a>          return false;
<a name="l3589"><span class="linenum">3589</span></a>      }
<a name="l3590"><span class="linenum">3590</span></a>  
<a name="l3591"><span class="linenum">3591</span></a>      <a class="var it1760" onMouseOver="hilite(1760)" onMouseOut="lolite()" onClick="logVariable('enabled')" href="../_variables/enabled.html">$enabled</a> = <a class="function" onClick="logFunction('get_enabled_auth_plugins')" href="../_functions/get_enabled_auth_plugins.html" onMouseOver="funcPopup(event,'get_enabled_auth_plugins')">get_enabled_auth_plugins</a>();
<a name="l3592"><span class="linenum">3592</span></a>  
<a name="l3593"><span class="linenum">3593</span></a>      return <a class="phpfunction" onClick="logFunction('in_array')" href="../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>, <a class="var it1760" onMouseOver="hilite(1760)" onMouseOut="lolite()" onClick="logVariable('enabled')" href="../_variables/enabled.html">$enabled</a>);
<a name="l3594"><span class="linenum">3594</span></a>  }
<a name="l3595"><span class="linenum">3595</span></a>  
<a name="l3596"><span class="linenum">3596</span></a>  <span class="comment">/**</span>
<a name="l3597"><span class="linenum">3597</span></a>  <span class="comment"> * Returns an authentication plugin instance.</span>
<a name="l3598"><span class="linenum">3598</span></a>  <span class="comment"> *</span>
<a name="l3599"><span class="linenum">3599</span></a>  <span class="comment"> * @param string $auth name of authentication plugin</span>
<a name="l3600"><span class="linenum">3600</span></a>  <span class="comment"> * @return auth_plugin_base An instance of the required authentication plugin.</span>
<a name="l3601"><span class="linenum">3601</span></a>  <span class="comment"> */</span>
<a name="l3602"><span class="linenum">3602</span></a>  function <a class="function" onClick="logFunction('get_auth_plugin')" href="../_functions/get_auth_plugin.html" onMouseOver="funcPopup(event,'get_auth_plugin')">get_auth_plugin</a>(<a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>) {
<a name="l3603"><span class="linenum">3603</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l3604"><span class="linenum">3604</span></a>  
<a name="l3605"><span class="linenum">3605</span></a>  <span class="comment">    // Check the plugin exists first.</span>
<a name="l3606"><span class="linenum">3606</span></a>      if (! <a class="function" onClick="logFunction('exists_auth_plugin')" href="../_functions/exists_auth_plugin.html" onMouseOver="funcPopup(event,'exists_auth_plugin')">exists_auth_plugin</a>(<a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>)) {
<a name="l3607"><span class="linenum">3607</span></a>          <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('authpluginnotfound', 'debug', '', <a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>);
<a name="l3608"><span class="linenum">3608</span></a>      }
<a name="l3609"><span class="linenum">3609</span></a>  
<a name="l3610"><span class="linenum">3610</span></a>  <span class="comment">    // Return auth plugin instance.</span>
<a name="l3611"><span class="linenum">3611</span></a>      require_once(&quot;{<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>}/auth/<a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>/auth.php&quot;);
<a name="l3612"><span class="linenum">3612</span></a>      <a class="var it318" onMouseOver="hilite(318)" onMouseOut="lolite()" onClick="logVariable('class')" href="../_variables/class.html">$class</a> = &quot;auth_plugin_<a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>&quot;;
<a name="l3613"><span class="linenum">3613</span></a>      return new <a class="var it318" onMouseOver="hilite(318)" onMouseOut="lolite()" onClick="logVariable('class')" href="../_variables/class.html">$class</a>;
<a name="l3614"><span class="linenum">3614</span></a>  }
<a name="l3615"><span class="linenum">3615</span></a>  
<a name="l3616"><span class="linenum">3616</span></a>  <span class="comment">/**</span>
<a name="l3617"><span class="linenum">3617</span></a>  <span class="comment"> * Returns array of active auth plugins.</span>
<a name="l3618"><span class="linenum">3618</span></a>  <span class="comment"> *</span>
<a name="l3619"><span class="linenum">3619</span></a>  <span class="comment"> * @param bool $fix fix $CFG-&gt;auth if needed</span>
<a name="l3620"><span class="linenum">3620</span></a>  <span class="comment"> * @return array</span>
<a name="l3621"><span class="linenum">3621</span></a>  <span class="comment"> */</span>
<a name="l3622"><span class="linenum">3622</span></a>  function <a class="function" onClick="logFunction('get_enabled_auth_plugins')" href="../_functions/get_enabled_auth_plugins.html" onMouseOver="funcPopup(event,'get_enabled_auth_plugins')">get_enabled_auth_plugins</a>(<a class="var it12972" onMouseOver="hilite(12972)" onMouseOut="lolite()" onClick="logVariable('fix')" href="../_variables/fix.html">$fix</a>=false) {
<a name="l3623"><span class="linenum">3623</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l3624"><span class="linenum">3624</span></a>  
<a name="l3625"><span class="linenum">3625</span></a>      <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a> = array('manual', 'nologin');
<a name="l3626"><span class="linenum">3626</span></a>  
<a name="l3627"><span class="linenum">3627</span></a>      if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('auth')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>)) {
<a name="l3628"><span class="linenum">3628</span></a>          <a class="var it12973" onMouseOver="hilite(12973)" onMouseOut="lolite()" onClick="logVariable('auths')" href="../_variables/auths.html">$auths</a> = array();
<a name="l3629"><span class="linenum">3629</span></a>      } else {
<a name="l3630"><span class="linenum">3630</span></a>          <a class="var it12973" onMouseOver="hilite(12973)" onMouseOut="lolite()" onClick="logVariable('auths')" href="../_variables/auths.html">$auths</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(',', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('auth')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>);
<a name="l3631"><span class="linenum">3631</span></a>      }
<a name="l3632"><span class="linenum">3632</span></a>  
<a name="l3633"><span class="linenum">3633</span></a>      if (<a class="var it12972" onMouseOver="hilite(12972)" onMouseOut="lolite()" onClick="logVariable('fix')" href="../_variables/fix.html">$fix</a>) {
<a name="l3634"><span class="linenum">3634</span></a>          <a class="var it12973" onMouseOver="hilite(12973)" onMouseOut="lolite()" onClick="logVariable('auths')" href="../_variables/auths.html">$auths</a> = <a class="phpfunction" onClick="logFunction('array_unique')" href="../_functions/array_unique.html" onMouseOver="phpfuncPopup(event,'array_unique')">array_unique</a>(<a class="var it12973" onMouseOver="hilite(12973)" onMouseOut="lolite()" onClick="logVariable('auths')" href="../_variables/auths.html">$auths</a>);
<a name="l3635"><span class="linenum">3635</span></a>          foreach (<a class="var it12973" onMouseOver="hilite(12973)" onMouseOut="lolite()" onClick="logVariable('auths')" href="../_variables/auths.html">$auths</a> as <a class="var it50" onMouseOver="hilite(50)" onMouseOut="lolite()" onClick="logVariable('k')" href="../_variables/k.html">$k</a> =&gt; <a class="var it4814" onMouseOver="hilite(4814)" onMouseOut="lolite()" onClick="logVariable('authname')" href="../_variables/authname.html">$authname</a>) {
<a name="l3636"><span class="linenum">3636</span></a>              if (!<a class="function" onClick="logFunction('exists_auth_plugin')" href="../_functions/exists_auth_plugin.html" onMouseOver="funcPopup(event,'exists_auth_plugin')">exists_auth_plugin</a>(<a class="var it4814" onMouseOver="hilite(4814)" onMouseOut="lolite()" onClick="logVariable('authname')" href="../_variables/authname.html">$authname</a>) or <a class="phpfunction" onClick="logFunction('in_array')" href="../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it4814" onMouseOver="hilite(4814)" onMouseOut="lolite()" onClick="logVariable('authname')" href="../_variables/authname.html">$authname</a>, <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>)) {
<a name="l3637"><span class="linenum">3637</span></a>                  unset(<a class="var it12973" onMouseOver="hilite(12973)" onMouseOut="lolite()" onClick="logVariable('auths')" href="../_variables/auths.html">$auths</a>[<a class="var it50" onMouseOver="hilite(50)" onMouseOut="lolite()" onClick="logVariable('k')" href="../_variables/k.html">$k</a>]);
<a name="l3638"><span class="linenum">3638</span></a>              }
<a name="l3639"><span class="linenum">3639</span></a>          }
<a name="l3640"><span class="linenum">3640</span></a>          <a class="var it12974" onMouseOver="hilite(12974)" onMouseOut="lolite()" onClick="logVariable('newconfig')" href="../_variables/newconfig.html">$newconfig</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(',', <a class="var it12973" onMouseOver="hilite(12973)" onMouseOut="lolite()" onClick="logVariable('auths')" href="../_variables/auths.html">$auths</a>);
<a name="l3641"><span class="linenum">3641</span></a>          if (!isset(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('auth')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>) or <a class="var it12974" onMouseOver="hilite(12974)" onMouseOut="lolite()" onClick="logVariable('newconfig')" href="../_variables/newconfig.html">$newconfig</a> != <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('auth')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>) {
<a name="l3642"><span class="linenum">3642</span></a>              <a class="function" onClick="logFunction('set_config')" href="../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('auth', <a class="var it12974" onMouseOver="hilite(12974)" onMouseOut="lolite()" onClick="logVariable('newconfig')" href="../_variables/newconfig.html">$newconfig</a>);
<a name="l3643"><span class="linenum">3643</span></a>          }
<a name="l3644"><span class="linenum">3644</span></a>      }
<a name="l3645"><span class="linenum">3645</span></a>  
<a name="l3646"><span class="linenum">3646</span></a>      return (<a class="phpfunction" onClick="logFunction('array_merge')" href="../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>, <a class="var it12973" onMouseOver="hilite(12973)" onMouseOut="lolite()" onClick="logVariable('auths')" href="../_variables/auths.html">$auths</a>));
<a name="l3647"><span class="linenum">3647</span></a>  }
<a name="l3648"><span class="linenum">3648</span></a>  
<a name="l3649"><span class="linenum">3649</span></a>  <span class="comment">/**</span>
<a name="l3650"><span class="linenum">3650</span></a>  <span class="comment"> * Returns true if an internal authentication method is being used.</span>
<a name="l3651"><span class="linenum">3651</span></a>  <span class="comment"> * if method not specified then, global default is assumed</span>
<a name="l3652"><span class="linenum">3652</span></a>  <span class="comment"> *</span>
<a name="l3653"><span class="linenum">3653</span></a>  <span class="comment"> * @param string $auth Form of authentication required</span>
<a name="l3654"><span class="linenum">3654</span></a>  <span class="comment"> * @return bool</span>
<a name="l3655"><span class="linenum">3655</span></a>  <span class="comment"> */</span>
<a name="l3656"><span class="linenum">3656</span></a>  function <a class="function" onClick="logFunction('is_internal_auth')" href="../_functions/is_internal_auth.html" onMouseOver="funcPopup(event,'is_internal_auth')">is_internal_auth</a>(<a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>) {
<a name="l3657"><span class="linenum">3657</span></a>  <span class="comment">    // Throws error if bad $auth.</span>
<a name="l3658"><span class="linenum">3658</span></a>      <a class="var it4020" onMouseOver="hilite(4020)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../_variables/authplugin.html">$authplugin</a> = <a class="function" onClick="logFunction('get_auth_plugin')" href="../_functions/get_auth_plugin.html" onMouseOver="funcPopup(event,'get_auth_plugin')">get_auth_plugin</a>(<a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>);
<a name="l3659"><span class="linenum">3659</span></a>      return <a class="var it4020" onMouseOver="hilite(4020)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../_variables/authplugin.html">$authplugin</a>-&gt;<a class="function" onClick="logFunction('is_internal')" href="../_functions/is_internal.html" onMouseOver="funcPopup(event,'is_internal')">is_internal</a>();
<a name="l3660"><span class="linenum">3660</span></a>  }
<a name="l3661"><span class="linenum">3661</span></a>  
<a name="l3662"><span class="linenum">3662</span></a>  <span class="comment">/**</span>
<a name="l3663"><span class="linenum">3663</span></a>  <span class="comment"> * Returns true if the user is a 'restored' one.</span>
<a name="l3664"><span class="linenum">3664</span></a>  <span class="comment"> *</span>
<a name="l3665"><span class="linenum">3665</span></a>  <span class="comment"> * Used in the login process to inform the user and allow him/her to reset the password</span>
<a name="l3666"><span class="linenum">3666</span></a>  <span class="comment"> *</span>
<a name="l3667"><span class="linenum">3667</span></a>  <span class="comment"> * @param string $username username to be checked</span>
<a name="l3668"><span class="linenum">3668</span></a>  <span class="comment"> * @return bool</span>
<a name="l3669"><span class="linenum">3669</span></a>  <span class="comment"> */</span>
<a name="l3670"><span class="linenum">3670</span></a>  function <a class="function" onClick="logFunction('is_restored_user')" href="../_functions/is_restored_user.html" onMouseOver="funcPopup(event,'is_restored_user')">is_restored_user</a>(<a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>) {
<a name="l3671"><span class="linenum">3671</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l3672"><span class="linenum">3672</span></a>  
<a name="l3673"><span class="linenum">3673</span></a>      return <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('record_exists')" href="../_functions/record_exists.html" onMouseOver="funcPopup(event,'record_exists')">record_exists</a>('user', array('username' =&gt; <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>, 'mnethostid' =&gt; <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/mnet_localhost_id.html">mnet_localhost_id</a>, 'password' =&gt; 'restored'));
<a name="l3674"><span class="linenum">3674</span></a>  }
<a name="l3675"><span class="linenum">3675</span></a>  
<a name="l3676"><span class="linenum">3676</span></a>  <span class="comment">/**</span>
<a name="l3677"><span class="linenum">3677</span></a>  <span class="comment"> * Returns an array of user fields</span>
<a name="l3678"><span class="linenum">3678</span></a>  <span class="comment"> *</span>
<a name="l3679"><span class="linenum">3679</span></a>  <span class="comment"> * @return array User field/column names</span>
<a name="l3680"><span class="linenum">3680</span></a>  <span class="comment"> */</span>
<a name="l3681"><span class="linenum">3681</span></a>  function <a class="function" onClick="logFunction('get_user_fieldnames')" href="../_functions/get_user_fieldnames.html" onMouseOver="funcPopup(event,'get_user_fieldnames')">get_user_fieldnames</a>() {
<a name="l3682"><span class="linenum">3682</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l3683"><span class="linenum">3683</span></a>  
<a name="l3684"><span class="linenum">3684</span></a>      <a class="var it12975" onMouseOver="hilite(12975)" onMouseOut="lolite()" onClick="logVariable('fieldarray')" href="../_variables/fieldarray.html">$fieldarray</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_columns')" href="../_functions/get_columns.html" onMouseOver="funcPopup(event,'get_columns')">get_columns</a>('user');
<a name="l3685"><span class="linenum">3685</span></a>      unset(<a class="var it12975" onMouseOver="hilite(12975)" onMouseOut="lolite()" onClick="logVariable('fieldarray')" href="../_variables/fieldarray.html">$fieldarray</a>['id']);
<a name="l3686"><span class="linenum">3686</span></a>      <a class="var it12975" onMouseOver="hilite(12975)" onMouseOut="lolite()" onClick="logVariable('fieldarray')" href="../_variables/fieldarray.html">$fieldarray</a> = <a class="phpfunction" onClick="logFunction('array_keys')" href="../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it12975" onMouseOver="hilite(12975)" onMouseOut="lolite()" onClick="logVariable('fieldarray')" href="../_variables/fieldarray.html">$fieldarray</a>);
<a name="l3687"><span class="linenum">3687</span></a>  
<a name="l3688"><span class="linenum">3688</span></a>      return <a class="var it12975" onMouseOver="hilite(12975)" onMouseOut="lolite()" onClick="logVariable('fieldarray')" href="../_variables/fieldarray.html">$fieldarray</a>;
<a name="l3689"><span class="linenum">3689</span></a>  }
<a name="l3690"><span class="linenum">3690</span></a>  
<a name="l3691"><span class="linenum">3691</span></a>  <span class="comment">/**</span>
<a name="l3692"><span class="linenum">3692</span></a>  <span class="comment"> * Creates a bare-bones user record</span>
<a name="l3693"><span class="linenum">3693</span></a>  <span class="comment"> *</span>
<a name="l3694"><span class="linenum">3694</span></a>  <span class="comment"> * @todo Outline auth types and provide code example</span>
<a name="l3695"><span class="linenum">3695</span></a>  <span class="comment"> *</span>
<a name="l3696"><span class="linenum">3696</span></a>  <span class="comment"> * @param string $username New user's username to add to record</span>
<a name="l3697"><span class="linenum">3697</span></a>  <span class="comment"> * @param string $password New user's password to add to record</span>
<a name="l3698"><span class="linenum">3698</span></a>  <span class="comment"> * @param string $auth Form of authentication required</span>
<a name="l3699"><span class="linenum">3699</span></a>  <span class="comment"> * @return stdClass A complete user object</span>
<a name="l3700"><span class="linenum">3700</span></a>  <span class="comment"> */</span>
<a name="l3701"><span class="linenum">3701</span></a>  function <a class="function" onClick="logFunction('create_user_record')" href="../_functions/create_user_record.html" onMouseOver="funcPopup(event,'create_user_record')">create_user_record</a>(<a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>, <a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>, <a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a> = 'manual') {
<a name="l3702"><span class="linenum">3702</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l3703"><span class="linenum">3703</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../user/profile/lib.php.html">/user/profile/lib.php</a>');
<a name="l3704"><span class="linenum">3704</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../user/lib.php.html">/user/lib.php</a>');
<a name="l3705"><span class="linenum">3705</span></a>  
<a name="l3706"><span class="linenum">3706</span></a>  <span class="comment">    // Just in case check text case.</span>
<a name="l3707"><span class="linenum">3707</span></a>      <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>));
<a name="l3708"><span class="linenum">3708</span></a>  
<a name="l3709"><span class="linenum">3709</span></a>      <a class="var it4020" onMouseOver="hilite(4020)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../_variables/authplugin.html">$authplugin</a> = <a class="function" onClick="logFunction('get_auth_plugin')" href="../_functions/get_auth_plugin.html" onMouseOver="funcPopup(event,'get_auth_plugin')">get_auth_plugin</a>(<a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>);
<a name="l3710"><span class="linenum">3710</span></a>      <a class="var it6067" onMouseOver="hilite(6067)" onMouseOut="lolite()" onClick="logVariable('customfields')" href="../_variables/customfields.html">$customfields</a> = <a class="var it4020" onMouseOver="hilite(4020)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../_variables/authplugin.html">$authplugin</a>-&gt;<a class="function" onClick="logFunction('get_custom_user_profile_fields')" href="../_functions/get_custom_user_profile_fields.html" onMouseOver="funcPopup(event,'get_custom_user_profile_fields')">get_custom_user_profile_fields</a>();
<a name="l3711"><span class="linenum">3711</span></a>      <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a> = new stdClass();
<a name="l3712"><span class="linenum">3712</span></a>      if (<a class="var it10999" onMouseOver="hilite(10999)" onMouseOut="lolite()" onClick="logVariable('newinfo')" href="../_variables/newinfo.html">$newinfo</a> = <a class="var it4020" onMouseOver="hilite(4020)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../_variables/authplugin.html">$authplugin</a>-&gt;<a class="function" onClick="logFunction('get_userinfo')" href="../_functions/get_userinfo.html" onMouseOver="funcPopup(event,'get_userinfo')">get_userinfo</a>(<a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>)) {
<a name="l3713"><span class="linenum">3713</span></a>          <a class="var it10999" onMouseOver="hilite(10999)" onMouseOut="lolite()" onClick="logVariable('newinfo')" href="../_variables/newinfo.html">$newinfo</a> = <a class="function" onClick="logFunction('truncate_userinfo')" href="../_functions/truncate_userinfo.html" onMouseOver="funcPopup(event,'truncate_userinfo')">truncate_userinfo</a>(<a class="var it10999" onMouseOver="hilite(10999)" onMouseOut="lolite()" onClick="logVariable('newinfo')" href="../_variables/newinfo.html">$newinfo</a>);
<a name="l3714"><span class="linenum">3714</span></a>          foreach (<a class="var it10999" onMouseOver="hilite(10999)" onMouseOut="lolite()" onClick="logVariable('newinfo')" href="../_variables/newinfo.html">$newinfo</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) {
<a name="l3715"><span class="linenum">3715</span></a>              if (<a class="phpfunction" onClick="logFunction('in_array')" href="../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>, <a class="var it4020" onMouseOver="hilite(4020)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../_variables/authplugin.html">$authplugin</a>-&gt;<a onClick="logVariable('userfields')" class="var it39656" onMouseOver="hilite(39656)" onMouseOut="lolite()" href="../_variables/userfields.html">userfields</a>) || (<a class="phpfunction" onClick="logFunction('in_array')" href="../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>, <a class="var it6067" onMouseOver="hilite(6067)" onMouseOut="lolite()" onClick="logVariable('customfields')" href="../_variables/customfields.html">$customfields</a>))) {
<a name="l3716"><span class="linenum">3716</span></a>                  <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> = <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l3717"><span class="linenum">3717</span></a>              }
<a name="l3718"><span class="linenum">3718</span></a>          }
<a name="l3719"><span class="linenum">3719</span></a>      }
<a name="l3720"><span class="linenum">3720</span></a>  
<a name="l3721"><span class="linenum">3721</span></a>      if (!empty(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('email')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/email.html">email</a>)) {
<a name="l3722"><span class="linenum">3722</span></a>          if (<a class="function" onClick="logFunction('email_is_not_allowed')" href="../_functions/email_is_not_allowed.html" onMouseOver="funcPopup(event,'email_is_not_allowed')">email_is_not_allowed</a>(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('email')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/email.html">email</a>)) {
<a name="l3723"><span class="linenum">3723</span></a>              unset(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('email')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/email.html">email</a>);
<a name="l3724"><span class="linenum">3724</span></a>          }
<a name="l3725"><span class="linenum">3725</span></a>      }
<a name="l3726"><span class="linenum">3726</span></a>  
<a name="l3727"><span class="linenum">3727</span></a>      if (!isset(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('city')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/city.html">city</a>)) {
<a name="l3728"><span class="linenum">3728</span></a>          <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('city')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/city.html">city</a> = '';
<a name="l3729"><span class="linenum">3729</span></a>      }
<a name="l3730"><span class="linenum">3730</span></a>  
<a name="l3731"><span class="linenum">3731</span></a>      <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('auth')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a> = <a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>;
<a name="l3732"><span class="linenum">3732</span></a>      <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('username')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/username.html">username</a> = <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>;
<a name="l3733"><span class="linenum">3733</span></a>  
<a name="l3734"><span class="linenum">3734</span></a>  <span class="comment">    // Fix for MDL-8480</span>
<a name="l3735"><span class="linenum">3735</span></a>  <span class="comment">    // user CFG lang for user if $newuser-&gt;lang is empty</span>
<a name="l3736"><span class="linenum">3736</span></a>  <span class="comment">    // or $user-&gt;lang is not an installed language.</span>
<a name="l3737"><span class="linenum">3737</span></a>      if (empty(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('lang')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>) || !<a class="function" onClick="logFunction('get_string_manager')" href="../_functions/get_string_manager.html" onMouseOver="funcPopup(event,'get_string_manager')">get_string_manager</a>()-&gt;<a class="function" onClick="logFunction('translation_exists')" href="../_functions/translation_exists.html" onMouseOver="funcPopup(event,'translation_exists')">translation_exists</a>(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('lang')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>)) {
<a name="l3738"><span class="linenum">3738</span></a>          <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('lang')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('lang')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>;
<a name="l3739"><span class="linenum">3739</span></a>      }
<a name="l3740"><span class="linenum">3740</span></a>      <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('confirmed')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/confirmed.html">confirmed</a> = 1;
<a name="l3741"><span class="linenum">3741</span></a>      <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('lastip')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/lastip.html">lastip</a> = <a class="function" onClick="logFunction('getremoteaddr')" href="../_functions/getremoteaddr.html" onMouseOver="funcPopup(event,'getremoteaddr')">getremoteaddr</a>();
<a name="l3742"><span class="linenum">3742</span></a>      <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('timecreated')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/timecreated.html">timecreated</a> = <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l3743"><span class="linenum">3743</span></a>      <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('timemodified')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/timemodified.html">timemodified</a> = <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('timecreated')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/timecreated.html">timecreated</a>;
<a name="l3744"><span class="linenum">3744</span></a>      <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/mnethostid.html">mnethostid</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/mnet_localhost_id.html">mnet_localhost_id</a>;
<a name="l3745"><span class="linenum">3745</span></a>  
<a name="l3746"><span class="linenum">3746</span></a>      <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('id')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/id.html">id</a> = <a class="function" onClick="logFunction('user_create_user')" href="../_functions/user_create_user.html" onMouseOver="funcPopup(event,'user_create_user')">user_create_user</a>(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>, false, false);
<a name="l3747"><span class="linenum">3747</span></a>  
<a name="l3748"><span class="linenum">3748</span></a>  <span class="comment">    // Save user profile data.</span>
<a name="l3749"><span class="linenum">3749</span></a>      <a class="function" onClick="logFunction('profile_save_data')" href="../_functions/profile_save_data.html" onMouseOver="funcPopup(event,'profile_save_data')">profile_save_data</a>(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>);
<a name="l3750"><span class="linenum">3750</span></a>  
<a name="l3751"><span class="linenum">3751</span></a>      <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="function" onClick="logFunction('get_complete_user_data')" href="../_functions/get_complete_user_data.html" onMouseOver="funcPopup(event,'get_complete_user_data')">get_complete_user_data</a>('id', <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('id')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l3752"><span class="linenum">3752</span></a>      if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;{'auth_'.<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('auth')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>.'_forcechangepassword'})) {
<a name="l3753"><span class="linenum">3753</span></a>          <a class="function" onClick="logFunction('set_user_preference')" href="../_functions/set_user_preference.html" onMouseOver="funcPopup(event,'set_user_preference')">set_user_preference</a>('auth_forcepasswordchange', 1, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l3754"><span class="linenum">3754</span></a>      }
<a name="l3755"><span class="linenum">3755</span></a>  <span class="comment">    // Set the password.</span>
<a name="l3756"><span class="linenum">3756</span></a>      <a class="function" onClick="logFunction('update_internal_user_password')" href="../_functions/update_internal_user_password.html" onMouseOver="funcPopup(event,'update_internal_user_password')">update_internal_user_password</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>);
<a name="l3757"><span class="linenum">3757</span></a>  
<a name="l3758"><span class="linenum">3758</span></a>  <span class="comment">    // Trigger event.</span>
<a name="l3759"><span class="linenum">3759</span></a>      \core\event\<a class="class" onClick="logClass('user_created')" href="../_classes/user_created.html" onMouseOver="classPopup(event,'user_created')">user_created</a>::<a class="function" onClick="logFunction('create_from_userid')" href="../_functions/create_from_userid.html" onMouseOver="funcPopup(event,'create_from_userid')">create_from_userid</a>(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('id')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)-&gt;<a class="function" onClick="logFunction('trigger')" href="../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l3760"><span class="linenum">3760</span></a>  
<a name="l3761"><span class="linenum">3761</span></a>      return <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>;
<a name="l3762"><span class="linenum">3762</span></a>  }
<a name="l3763"><span class="linenum">3763</span></a>  
<a name="l3764"><span class="linenum">3764</span></a>  <span class="comment">/**</span>
<a name="l3765"><span class="linenum">3765</span></a>  <span class="comment"> * Will update a local user record from an external source (MNET users can not be updated using this method!).</span>
<a name="l3766"><span class="linenum">3766</span></a>  <span class="comment"> *</span>
<a name="l3767"><span class="linenum">3767</span></a>  <span class="comment"> * @param string $username user's username to update the record</span>
<a name="l3768"><span class="linenum">3768</span></a>  <span class="comment"> * @return stdClass A complete user object</span>
<a name="l3769"><span class="linenum">3769</span></a>  <span class="comment"> */</span>
<a name="l3770"><span class="linenum">3770</span></a>  function <a class="function" onClick="logFunction('update_user_record')" href="../_functions/update_user_record.html" onMouseOver="funcPopup(event,'update_user_record')">update_user_record</a>(<a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>) {
<a name="l3771"><span class="linenum">3771</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l3772"><span class="linenum">3772</span></a>  <span class="comment">    // Just in case check text case.</span>
<a name="l3773"><span class="linenum">3773</span></a>      <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>));
<a name="l3774"><span class="linenum">3774</span></a>  
<a name="l3775"><span class="linenum">3775</span></a>      <a class="var it12976" onMouseOver="hilite(12976)" onMouseOut="lolite()" onClick="logVariable('oldinfo')" href="../_variables/oldinfo.html">$oldinfo</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user', array('username' =&gt; <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>, 'mnethostid' =&gt; <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/mnet_localhost_id.html">mnet_localhost_id</a>), '*', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l3776"><span class="linenum">3776</span></a>      return <a class="function" onClick="logFunction('update_user_record_by_id')" href="../_functions/update_user_record_by_id.html" onMouseOver="funcPopup(event,'update_user_record_by_id')">update_user_record_by_id</a>(<a class="var it12976" onMouseOver="hilite(12976)" onMouseOut="lolite()" onClick="logVariable('oldinfo')" href="../_variables/oldinfo.html">$oldinfo</a>-&gt;<a onClick="logVariable('id')" class="var it41069" onMouseOver="hilite(41069)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l3777"><span class="linenum">3777</span></a>  }
<a name="l3778"><span class="linenum">3778</span></a>  
<a name="l3779"><span class="linenum">3779</span></a>  <span class="comment">/**</span>
<a name="l3780"><span class="linenum">3780</span></a>  <span class="comment"> * Will update a local user record from an external source (MNET users can not be updated using this method!).</span>
<a name="l3781"><span class="linenum">3781</span></a>  <span class="comment"> *</span>
<a name="l3782"><span class="linenum">3782</span></a>  <span class="comment"> * @param int $id user id</span>
<a name="l3783"><span class="linenum">3783</span></a>  <span class="comment"> * @return stdClass A complete user object</span>
<a name="l3784"><span class="linenum">3784</span></a>  <span class="comment"> */</span>
<a name="l3785"><span class="linenum">3785</span></a>  function <a class="function" onClick="logFunction('update_user_record_by_id')" href="../_functions/update_user_record_by_id.html" onMouseOver="funcPopup(event,'update_user_record_by_id')">update_user_record_by_id</a>(<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>) {
<a name="l3786"><span class="linenum">3786</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l3787"><span class="linenum">3787</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>."<a class="filename" href="../user/profile/lib.php.html">/user/profile/lib.php</a>");
<a name="l3788"><span class="linenum">3788</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../user/lib.php.html">/user/lib.php</a>');
<a name="l3789"><span class="linenum">3789</span></a>  
<a name="l3790"><span class="linenum">3790</span></a>      <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array('mnethostid' =&gt; <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/mnet_localhost_id.html">mnet_localhost_id</a>, 'id' =&gt; <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>, 'deleted' =&gt; 0);
<a name="l3791"><span class="linenum">3791</span></a>      <a class="var it12976" onMouseOver="hilite(12976)" onMouseOut="lolite()" onClick="logVariable('oldinfo')" href="../_variables/oldinfo.html">$oldinfo</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user', <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>, '*', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l3792"><span class="linenum">3792</span></a>  
<a name="l3793"><span class="linenum">3793</span></a>      <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a> = array();
<a name="l3794"><span class="linenum">3794</span></a>      <a class="var it4006" onMouseOver="hilite(4006)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a> = <a class="function" onClick="logFunction('get_auth_plugin')" href="../_functions/get_auth_plugin.html" onMouseOver="funcPopup(event,'get_auth_plugin')">get_auth_plugin</a>(<a class="var it12976" onMouseOver="hilite(12976)" onMouseOut="lolite()" onClick="logVariable('oldinfo')" href="../_variables/oldinfo.html">$oldinfo</a>-&gt;<a onClick="logVariable('auth')" class="var it41069" onMouseOver="hilite(41069)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>);
<a name="l3795"><span class="linenum">3795</span></a>  
<a name="l3796"><span class="linenum">3796</span></a>      if (<a class="var it10999" onMouseOver="hilite(10999)" onMouseOut="lolite()" onClick="logVariable('newinfo')" href="../_variables/newinfo.html">$newinfo</a> = <a class="var it4006" onMouseOver="hilite(4006)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a>-&gt;<a class="function" onClick="logFunction('get_userinfo')" href="../_functions/get_userinfo.html" onMouseOver="funcPopup(event,'get_userinfo')">get_userinfo</a>(<a class="var it12976" onMouseOver="hilite(12976)" onMouseOut="lolite()" onClick="logVariable('oldinfo')" href="../_variables/oldinfo.html">$oldinfo</a>-&gt;<a onClick="logVariable('username')" class="var it41069" onMouseOver="hilite(41069)" onMouseOut="lolite()" href="../_variables/username.html">username</a>)) {
<a name="l3797"><span class="linenum">3797</span></a>          <a class="var it10999" onMouseOver="hilite(10999)" onMouseOut="lolite()" onClick="logVariable('newinfo')" href="../_variables/newinfo.html">$newinfo</a> = <a class="function" onClick="logFunction('truncate_userinfo')" href="../_functions/truncate_userinfo.html" onMouseOver="funcPopup(event,'truncate_userinfo')">truncate_userinfo</a>(<a class="var it10999" onMouseOver="hilite(10999)" onMouseOut="lolite()" onClick="logVariable('newinfo')" href="../_variables/newinfo.html">$newinfo</a>);
<a name="l3798"><span class="linenum">3798</span></a>          <a class="var it6067" onMouseOver="hilite(6067)" onMouseOut="lolite()" onClick="logVariable('customfields')" href="../_variables/customfields.html">$customfields</a> = <a class="var it4006" onMouseOver="hilite(4006)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a>-&gt;<a class="function" onClick="logFunction('get_custom_user_profile_fields')" href="../_functions/get_custom_user_profile_fields.html" onMouseOver="funcPopup(event,'get_custom_user_profile_fields')">get_custom_user_profile_fields</a>();
<a name="l3799"><span class="linenum">3799</span></a>  
<a name="l3800"><span class="linenum">3800</span></a>          foreach (<a class="var it10999" onMouseOver="hilite(10999)" onMouseOut="lolite()" onClick="logVariable('newinfo')" href="../_variables/newinfo.html">$newinfo</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) {
<a name="l3801"><span class="linenum">3801</span></a>              <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> = <a class="phpfunction" onClick="logFunction('strtolower')" href="../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>);
<a name="l3802"><span class="linenum">3802</span></a>              <a class="var it12977" onMouseOver="hilite(12977)" onMouseOut="lolite()" onClick="logVariable('iscustom')" href="../_variables/iscustom.html">$iscustom</a> = <a class="phpfunction" onClick="logFunction('in_array')" href="../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>, <a class="var it6067" onMouseOver="hilite(6067)" onMouseOut="lolite()" onClick="logVariable('customfields')" href="../_variables/customfields.html">$customfields</a>);
<a name="l3803"><span class="linenum">3803</span></a>              if ((!property_exists(<a class="var it12976" onMouseOver="hilite(12976)" onMouseOut="lolite()" onClick="logVariable('oldinfo')" href="../_variables/oldinfo.html">$oldinfo</a>, <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>) &amp;&amp; !<a class="var it12977" onMouseOver="hilite(12977)" onMouseOut="lolite()" onClick="logVariable('iscustom')" href="../_variables/iscustom.html">$iscustom</a>) or <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> === 'username' or <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> === 'id'
<a name="l3804"><span class="linenum">3804</span></a>                      or <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> === 'auth' or <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> === 'mnethostid' or <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> === 'deleted') {
<a name="l3805"><span class="linenum">3805</span></a>  <span class="comment">                // Unknown or must not be changed.</span>
<a name="l3806"><span class="linenum">3806</span></a>                  continue;
<a name="l3807"><span class="linenum">3807</span></a>              }
<a name="l3808"><span class="linenum">3808</span></a>              <a class="var it12978" onMouseOver="hilite(12978)" onMouseOut="lolite()" onClick="logVariable('confval')" href="../_variables/confval.html">$confval</a> = <a class="var it4006" onMouseOver="hilite(4006)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a>-&gt;<a onClick="logVariable('config')" class="var it41070" onMouseOver="hilite(41070)" onMouseOut="lolite()" href="../_variables/config.html">config</a>-&gt;{'field_updatelocal_' . <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>};
<a name="l3809"><span class="linenum">3809</span></a>              <a class="var it12979" onMouseOver="hilite(12979)" onMouseOut="lolite()" onClick="logVariable('lockval')" href="../_variables/lockval.html">$lockval</a> = <a class="var it4006" onMouseOver="hilite(4006)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a>-&gt;<a onClick="logVariable('config')" class="var it41070" onMouseOver="hilite(41070)" onMouseOut="lolite()" href="../_variables/config.html">config</a>-&gt;{'field_lock_' . <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>};
<a name="l3810"><span class="linenum">3810</span></a>              if (empty(<a class="var it12978" onMouseOver="hilite(12978)" onMouseOut="lolite()" onClick="logVariable('confval')" href="../_variables/confval.html">$confval</a>) || empty(<a class="var it12979" onMouseOver="hilite(12979)" onMouseOut="lolite()" onClick="logVariable('lockval')" href="../_variables/lockval.html">$lockval</a>)) {
<a name="l3811"><span class="linenum">3811</span></a>                  continue;
<a name="l3812"><span class="linenum">3812</span></a>              }
<a name="l3813"><span class="linenum">3813</span></a>              if (<a class="var it12978" onMouseOver="hilite(12978)" onMouseOut="lolite()" onClick="logVariable('confval')" href="../_variables/confval.html">$confval</a> === 'onlogin') {
<a name="l3814"><span class="linenum">3814</span></a>  <span class="comment">                // MDL-4207 Don't overwrite modified user profile values with</span>
<a name="l3815"><span class="linenum">3815</span></a>  <span class="comment">                // empty LDAP values when 'unlocked if empty' is set. The purpose</span>
<a name="l3816"><span class="linenum">3816</span></a>  <span class="comment">                // of the setting 'unlocked if empty' is to allow the user to fill</span>
<a name="l3817"><span class="linenum">3817</span></a>  <span class="comment">                // in a value for the selected field _if LDAP is giving</span>
<a name="l3818"><span class="linenum">3818</span></a>  <span class="comment">                // nothing_ for this field. Thus it makes sense to let this value</span>
<a name="l3819"><span class="linenum">3819</span></a>  <span class="comment">                // stand in until LDAP is giving a value for this field.</span>
<a name="l3820"><span class="linenum">3820</span></a>                  if (!(empty(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) &amp;&amp; <a class="var it12979" onMouseOver="hilite(12979)" onMouseOut="lolite()" onClick="logVariable('lockval')" href="../_variables/lockval.html">$lockval</a> === 'unlockedifempty')) {
<a name="l3821"><span class="linenum">3821</span></a>                      if (<a class="var it12977" onMouseOver="hilite(12977)" onMouseOut="lolite()" onClick="logVariable('iscustom')" href="../_variables/iscustom.html">$iscustom</a> || (<a class="phpfunction" onClick="logFunction('in_array')" href="../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>, <a class="var it4006" onMouseOver="hilite(4006)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a>-&gt;<a onClick="logVariable('userfields')" class="var it41070" onMouseOver="hilite(41070)" onMouseOut="lolite()" href="../_variables/userfields.html">userfields</a>) &amp;&amp;
<a name="l3822"><span class="linenum">3822</span></a>                              ((string)<a class="var it12976" onMouseOver="hilite(12976)" onMouseOut="lolite()" onClick="logVariable('oldinfo')" href="../_variables/oldinfo.html">$oldinfo</a>-&gt;<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> !== (string)<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>))) {
<a name="l3823"><span class="linenum">3823</span></a>                          <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = (string)<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l3824"><span class="linenum">3824</span></a>                      }
<a name="l3825"><span class="linenum">3825</span></a>                  }
<a name="l3826"><span class="linenum">3826</span></a>              }
<a name="l3827"><span class="linenum">3827</span></a>          }
<a name="l3828"><span class="linenum">3828</span></a>          if (<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>) {
<a name="l3829"><span class="linenum">3829</span></a>              <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>['id'] = <a class="var it12976" onMouseOver="hilite(12976)" onMouseOut="lolite()" onClick="logVariable('oldinfo')" href="../_variables/oldinfo.html">$oldinfo</a>-&gt;<a onClick="logVariable('id')" class="var it41069" onMouseOver="hilite(41069)" onMouseOut="lolite()" href="../_variables/id.html">id</a>;
<a name="l3830"><span class="linenum">3830</span></a>              <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>['timemodified'] = <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l3831"><span class="linenum">3831</span></a>              <a class="function" onClick="logFunction('user_update_user')" href="../_functions/user_update_user.html" onMouseOver="funcPopup(event,'user_update_user')">user_update_user</a>((object) <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>, false, false);
<a name="l3832"><span class="linenum">3832</span></a>  
<a name="l3833"><span class="linenum">3833</span></a>  <span class="comment">            // Save user profile data.</span>
<a name="l3834"><span class="linenum">3834</span></a>              <a class="function" onClick="logFunction('profile_save_data')" href="../_functions/profile_save_data.html" onMouseOver="funcPopup(event,'profile_save_data')">profile_save_data</a>((object) <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>);
<a name="l3835"><span class="linenum">3835</span></a>  
<a name="l3836"><span class="linenum">3836</span></a>  <span class="comment">            // Trigger event.</span>
<a name="l3837"><span class="linenum">3837</span></a>              \core\event\<a class="class" onClick="logClass('user_updated')" href="../_classes/user_updated.html" onMouseOver="classPopup(event,'user_updated')">user_updated</a>::<a class="function" onClick="logFunction('create_from_userid')" href="../_functions/create_from_userid.html" onMouseOver="funcPopup(event,'create_from_userid')">create_from_userid</a>(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>['id'])-&gt;<a class="function" onClick="logFunction('trigger')" href="../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l3838"><span class="linenum">3838</span></a>          }
<a name="l3839"><span class="linenum">3839</span></a>      }
<a name="l3840"><span class="linenum">3840</span></a>  
<a name="l3841"><span class="linenum">3841</span></a>      return <a class="function" onClick="logFunction('get_complete_user_data')" href="../_functions/get_complete_user_data.html" onMouseOver="funcPopup(event,'get_complete_user_data')">get_complete_user_data</a>('id', <a class="var it12976" onMouseOver="hilite(12976)" onMouseOut="lolite()" onClick="logVariable('oldinfo')" href="../_variables/oldinfo.html">$oldinfo</a>-&gt;<a onClick="logVariable('id')" class="var it41069" onMouseOver="hilite(41069)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l3842"><span class="linenum">3842</span></a>  }
<a name="l3843"><span class="linenum">3843</span></a>  
<a name="l3844"><span class="linenum">3844</span></a>  <span class="comment">/**</span>
<a name="l3845"><span class="linenum">3845</span></a>  <span class="comment"> * Will truncate userinfo as it comes from auth_get_userinfo (from external auth) which may have large fields.</span>
<a name="l3846"><span class="linenum">3846</span></a>  <span class="comment"> *</span>
<a name="l3847"><span class="linenum">3847</span></a>  <span class="comment"> * @param array $info Array of user properties to truncate if needed</span>
<a name="l3848"><span class="linenum">3848</span></a>  <span class="comment"> * @return array The now truncated information that was passed in</span>
<a name="l3849"><span class="linenum">3849</span></a>  <span class="comment"> */</span>
<a name="l3850"><span class="linenum">3850</span></a>  function <a class="function" onClick="logFunction('truncate_userinfo')" href="../_functions/truncate_userinfo.html" onMouseOver="funcPopup(event,'truncate_userinfo')">truncate_userinfo</a>(array <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>) {
<a name="l3851"><span class="linenum">3851</span></a>  <span class="comment">    // Define the limits.</span>
<a name="l3852"><span class="linenum">3852</span></a>      <a class="var it589" onMouseOver="hilite(589)" onMouseOut="lolite()" onClick="logVariable('limit')" href="../_variables/limit.html">$limit</a> = array(
<a name="l3853"><span class="linenum">3853</span></a>          'username'    =&gt; 100,
<a name="l3854"><span class="linenum">3854</span></a>          'idnumber'    =&gt; 255,
<a name="l3855"><span class="linenum">3855</span></a>          'firstname'   =&gt; 100,
<a name="l3856"><span class="linenum">3856</span></a>          'lastname'    =&gt; 100,
<a name="l3857"><span class="linenum">3857</span></a>          'email'       =&gt; 100,
<a name="l3858"><span class="linenum">3858</span></a>          'icq'         =&gt;  15,
<a name="l3859"><span class="linenum">3859</span></a>          'phone1'      =&gt;  20,
<a name="l3860"><span class="linenum">3860</span></a>          'phone2'      =&gt;  20,
<a name="l3861"><span class="linenum">3861</span></a>          'institution' =&gt; 255,
<a name="l3862"><span class="linenum">3862</span></a>          'department'  =&gt; 255,
<a name="l3863"><span class="linenum">3863</span></a>          'address'     =&gt; 255,
<a name="l3864"><span class="linenum">3864</span></a>          'city'        =&gt; 120,
<a name="l3865"><span class="linenum">3865</span></a>          'country'     =&gt;   2,
<a name="l3866"><span class="linenum">3866</span></a>          'url'         =&gt; 255,
<a name="l3867"><span class="linenum">3867</span></a>      );
<a name="l3868"><span class="linenum">3868</span></a>  
<a name="l3869"><span class="linenum">3869</span></a>  <span class="comment">    // Apply where needed.</span>
<a name="l3870"><span class="linenum">3870</span></a>      foreach (<a class="phpfunction" onClick="logFunction('array_keys')" href="../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>) as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>) {
<a name="l3871"><span class="linenum">3871</span></a>          if (!empty(<a class="var it589" onMouseOver="hilite(589)" onMouseOut="lolite()" onClick="logVariable('limit')" href="../_variables/limit.html">$limit</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>])) {
<a name="l3872"><span class="linenum">3872</span></a>              <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>], 0, <a class="var it589" onMouseOver="hilite(589)" onMouseOut="lolite()" onClick="logVariable('limit')" href="../_variables/limit.html">$limit</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>]));
<a name="l3873"><span class="linenum">3873</span></a>          }
<a name="l3874"><span class="linenum">3874</span></a>      }
<a name="l3875"><span class="linenum">3875</span></a>  
<a name="l3876"><span class="linenum">3876</span></a>      return <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>;
<a name="l3877"><span class="linenum">3877</span></a>  }
<a name="l3878"><span class="linenum">3878</span></a>  
<a name="l3879"><span class="linenum">3879</span></a>  <span class="comment">/**</span>
<a name="l3880"><span class="linenum">3880</span></a>  <span class="comment"> * Marks user deleted in internal user database and notifies the auth plugin.</span>
<a name="l3881"><span class="linenum">3881</span></a>  <span class="comment"> * Also unenrols user from all roles and does other cleanup.</span>
<a name="l3882"><span class="linenum">3882</span></a>  <span class="comment"> *</span>
<a name="l3883"><span class="linenum">3883</span></a>  <span class="comment"> * Any plugin that needs to purge user data should register the 'user_deleted' event.</span>
<a name="l3884"><span class="linenum">3884</span></a>  <span class="comment"> *</span>
<a name="l3885"><span class="linenum">3885</span></a>  <span class="comment"> * @param stdClass $user full user object before delete</span>
<a name="l3886"><span class="linenum">3886</span></a>  <span class="comment"> * @return boolean success</span>
<a name="l3887"><span class="linenum">3887</span></a>  <span class="comment"> * @throws coding_exception if invalid $user parameter detected</span>
<a name="l3888"><span class="linenum">3888</span></a>  <span class="comment"> */</span>
<a name="l3889"><span class="linenum">3889</span></a>  function <a class="function" onClick="logFunction('delete_user')" href="../_functions/delete_user.html" onMouseOver="funcPopup(event,'delete_user')">delete_user</a>(stdClass <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>) {
<a name="l3890"><span class="linenum">3890</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l3891"><span class="linenum">3891</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/libdir.html">libdir</a>.'/grouplib.php');
<a name="l3892"><span class="linenum">3892</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/libdir.html">libdir</a>.'/gradelib.php');
<a name="l3893"><span class="linenum">3893</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../message/lib.php.html">/message/lib.php</a>');
<a name="l3894"><span class="linenum">3894</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../tag/lib.php.html">/tag/lib.php</a>');
<a name="l3895"><span class="linenum">3895</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../user/lib.php.html">/user/lib.php</a>');
<a name="l3896"><span class="linenum">3896</span></a>  
<a name="l3897"><span class="linenum">3897</span></a>  <span class="comment">    // Make sure nobody sends bogus record type as parameter.</span>
<a name="l3898"><span class="linenum">3898</span></a>      if (!property_exists(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, 'id') or !property_exists(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, 'username')) {
<a name="l3899"><span class="linenum">3899</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Invalid <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> parameter in <a class="function" onClick="logFunction('delete_user')" href="../_functions/delete_user.html" onMouseOver="funcPopup(event,'delete_user')">delete_user</a>() detected');
<a name="l3900"><span class="linenum">3900</span></a>      }
<a name="l3901"><span class="linenum">3901</span></a>  
<a name="l3902"><span class="linenum">3902</span></a>  <span class="comment">    // Better not trust the parameter and fetch the latest info this will be very expensive anyway.</span>
<a name="l3903"><span class="linenum">3903</span></a>      if (!<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user', array('id' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>))) {
<a name="l3904"><span class="linenum">3904</span></a>          <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Attempt to delete unknown user account.');
<a name="l3905"><span class="linenum">3905</span></a>          return false;
<a name="l3906"><span class="linenum">3906</span></a>      }
<a name="l3907"><span class="linenum">3907</span></a>  
<a name="l3908"><span class="linenum">3908</span></a>  <span class="comment">    // There must be always exactly one guest record, originally the guest account was identified by username only,</span>
<a name="l3909"><span class="linenum">3909</span></a>  <span class="comment">    // now we use $CFG-&gt;siteguest for performance reasons.</span>
<a name="l3910"><span class="linenum">3910</span></a>      if (<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/username.html">username</a> === 'guest' or <a class="function" onClick="logFunction('isguestuser')" href="../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l3911"><span class="linenum">3911</span></a>          <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Guest user account can not be deleted.');
<a name="l3912"><span class="linenum">3912</span></a>          return false;
<a name="l3913"><span class="linenum">3913</span></a>      }
<a name="l3914"><span class="linenum">3914</span></a>  
<a name="l3915"><span class="linenum">3915</span></a>  <span class="comment">    // Admin can be theoretically from different auth plugin, but we want to prevent deletion of internal accoutns only,</span>
<a name="l3916"><span class="linenum">3916</span></a>  <span class="comment">    // if anything goes wrong ppl may force somebody to be admin via config.php setting $CFG-&gt;siteadmins.</span>
<a name="l3917"><span class="linenum">3917</span></a>      if (<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a> === 'manual' and <a class="function" onClick="logFunction('is_siteadmin')" href="../_functions/is_siteadmin.html" onMouseOver="funcPopup(event,'is_siteadmin')">is_siteadmin</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l3918"><span class="linenum">3918</span></a>          <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Local administrator accounts can not be deleted.');
<a name="l3919"><span class="linenum">3919</span></a>          return false;
<a name="l3920"><span class="linenum">3920</span></a>      }
<a name="l3921"><span class="linenum">3921</span></a>  
<a name="l3922"><span class="linenum">3922</span></a>  <span class="comment">    // Keep user record before updating it, as we have to pass this to user_deleted event.</span>
<a name="l3923"><span class="linenum">3923</span></a>      <a class="var it8634" onMouseOver="hilite(8634)" onMouseOut="lolite()" onClick="logVariable('olduser')" href="../_variables/olduser.html">$olduser</a> = clone <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>;
<a name="l3924"><span class="linenum">3924</span></a>  
<a name="l3925"><span class="linenum">3925</span></a>  <span class="comment">    // Keep a copy of user context, we need it for event.</span>
<a name="l3926"><span class="linenum">3926</span></a>      <a class="var it1419" onMouseOver="hilite(1419)" onMouseOut="lolite()" onClick="logVariable('usercontext')" href="../_variables/usercontext.html">$usercontext</a> = <a class="class" onClick="logClass('context_user')" href="../_classes/context_user.html" onMouseOver="classPopup(event,'context_user')">context_user</a>::<a class="function" onClick="logFunction('instance')" href="../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l3927"><span class="linenum">3927</span></a>  
<a name="l3928"><span class="linenum">3928</span></a>  <span class="comment">    // Delete all grades - backup is kept in grade_grades_history table.</span>
<a name="l3929"><span class="linenum">3929</span></a>      <a class="function" onClick="logFunction('grade_user_delete')" href="../_functions/grade_user_delete.html" onMouseOver="funcPopup(event,'grade_user_delete')">grade_user_delete</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l3930"><span class="linenum">3930</span></a>  
<a name="l3931"><span class="linenum">3931</span></a>  <span class="comment">    // Move unread messages from this user to read.</span>
<a name="l3932"><span class="linenum">3932</span></a>      <a class="function" onClick="logFunction('message_move_userfrom_unread2read')" href="../_functions/message_move_userfrom_unread2read.html" onMouseOver="funcPopup(event,'message_move_userfrom_unread2read')">message_move_userfrom_unread2read</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l3933"><span class="linenum">3933</span></a>  
<a name="l3934"><span class="linenum">3934</span></a>  <span class="comment">    // TODO: remove from cohorts using standard API here.</span>
<a name="l3935"><span class="linenum">3935</span></a>  
<a name="l3936"><span class="linenum">3936</span></a>  <span class="comment">    // Remove user tags.</span>
<a name="l3937"><span class="linenum">3937</span></a>      <a class="function" onClick="logFunction('tag_set')" href="../_functions/tag_set.html" onMouseOver="funcPopup(event,'tag_set')">tag_set</a>('user', <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, array(), 'core', <a class="var it1419" onMouseOver="hilite(1419)" onMouseOut="lolite()" onClick="logVariable('usercontext')" href="../_variables/usercontext.html">$usercontext</a>-&gt;<a onClick="logVariable('id')" class="var it39494" onMouseOver="hilite(39494)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l3938"><span class="linenum">3938</span></a>  
<a name="l3939"><span class="linenum">3939</span></a>  <span class="comment">    // Unconditionally unenrol from all courses.</span>
<a name="l3940"><span class="linenum">3940</span></a>      <a class="function" onClick="logFunction('enrol_user_delete')" href="../_functions/enrol_user_delete.html" onMouseOver="funcPopup(event,'enrol_user_delete')">enrol_user_delete</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l3941"><span class="linenum">3941</span></a>  
<a name="l3942"><span class="linenum">3942</span></a>  <span class="comment">    // Unenrol from all roles in all contexts.</span>
<a name="l3943"><span class="linenum">3943</span></a>  <span class="comment">    // This might be slow but it is really needed - modules might do some extra cleanup!</span>
<a name="l3944"><span class="linenum">3944</span></a>      <a class="function" onClick="logFunction('role_unassign_all')" href="../_functions/role_unassign_all.html" onMouseOver="funcPopup(event,'role_unassign_all')">role_unassign_all</a>(array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l3945"><span class="linenum">3945</span></a>  
<a name="l3946"><span class="linenum">3946</span></a>  <span class="comment">    // Now do a brute force cleanup.</span>
<a name="l3947"><span class="linenum">3947</span></a>  
<a name="l3948"><span class="linenum">3948</span></a>  <span class="comment">    // Remove from all cohorts.</span>
<a name="l3949"><span class="linenum">3949</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('cohort_members', array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l3950"><span class="linenum">3950</span></a>  
<a name="l3951"><span class="linenum">3951</span></a>  <span class="comment">    // Remove from all groups.</span>
<a name="l3952"><span class="linenum">3952</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('groups_members', array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l3953"><span class="linenum">3953</span></a>  
<a name="l3954"><span class="linenum">3954</span></a>  <span class="comment">    // Brute force unenrol from all courses.</span>
<a name="l3955"><span class="linenum">3955</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('user_enrolments', array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l3956"><span class="linenum">3956</span></a>  
<a name="l3957"><span class="linenum">3957</span></a>  <span class="comment">    // Purge user preferences.</span>
<a name="l3958"><span class="linenum">3958</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('user_preferences', array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l3959"><span class="linenum">3959</span></a>  
<a name="l3960"><span class="linenum">3960</span></a>  <span class="comment">    // Purge user extra profile info.</span>
<a name="l3961"><span class="linenum">3961</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('user_info_data', array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l3962"><span class="linenum">3962</span></a>  
<a name="l3963"><span class="linenum">3963</span></a>  <span class="comment">    // Purge log of previous password hashes.</span>
<a name="l3964"><span class="linenum">3964</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('user_password_history', array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l3965"><span class="linenum">3965</span></a>  
<a name="l3966"><span class="linenum">3966</span></a>  <span class="comment">    // Last course access not necessary either.</span>
<a name="l3967"><span class="linenum">3967</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('user_lastaccess', array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l3968"><span class="linenum">3968</span></a>  <span class="comment">    // Remove all user tokens.</span>
<a name="l3969"><span class="linenum">3969</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('external_tokens', array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l3970"><span class="linenum">3970</span></a>  
<a name="l3971"><span class="linenum">3971</span></a>  <span class="comment">    // Unauthorise the user for all services.</span>
<a name="l3972"><span class="linenum">3972</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('external_services_users', array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l3973"><span class="linenum">3973</span></a>  
<a name="l3974"><span class="linenum">3974</span></a>  <span class="comment">    // Remove users private keys.</span>
<a name="l3975"><span class="linenum">3975</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('user_private_key', array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l3976"><span class="linenum">3976</span></a>  
<a name="l3977"><span class="linenum">3977</span></a>  <span class="comment">    // Remove users customised pages.</span>
<a name="l3978"><span class="linenum">3978</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('my_pages', array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, 'private' =&gt; 1));
<a name="l3979"><span class="linenum">3979</span></a>  
<a name="l3980"><span class="linenum">3980</span></a>  <span class="comment">    // Force logout - may fail if file based sessions used, sorry.</span>
<a name="l3981"><span class="linenum">3981</span></a>      \core\session\<a class="class" onClick="logClass('manager')" href="../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('kill_user_sessions')" href="../_functions/kill_user_sessions.html" onMouseOver="funcPopup(event,'kill_user_sessions')">kill_user_sessions</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l3982"><span class="linenum">3982</span></a>  
<a name="l3983"><span class="linenum">3983</span></a>  <span class="comment">    // Workaround for bulk deletes of users with the same email address.</span>
<a name="l3984"><span class="linenum">3984</span></a>      <a class="var it3913" onMouseOver="hilite(3913)" onMouseOut="lolite()" onClick="logVariable('delname')" href="../_variables/delname.html">$delname</a> = <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('email')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/email.html">email</a> . &quot;.&quot; . <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>(), <a class="constant" onClick="logConstant('PARAM_USERNAME')" href="../_constants/PARAM_USERNAME.html" onMouseOver="constPopup(event,'PARAM_USERNAME')">PARAM_USERNAME</a>);
<a name="l3985"><span class="linenum">3985</span></a>      while (<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('record_exists')" href="../_functions/record_exists.html" onMouseOver="funcPopup(event,'record_exists')">record_exists</a>('user', array('username' =&gt; <a class="var it3913" onMouseOver="hilite(3913)" onMouseOut="lolite()" onClick="logVariable('delname')" href="../_variables/delname.html">$delname</a>))) { // No need to use mnethostid here.
<a name="l3986"><span class="linenum">3986</span></a>          <a class="var it3913" onMouseOver="hilite(3913)" onMouseOut="lolite()" onClick="logVariable('delname')" href="../_variables/delname.html">$delname</a>++;
<a name="l3987"><span class="linenum">3987</span></a>      }
<a name="l3988"><span class="linenum">3988</span></a>  
<a name="l3989"><span class="linenum">3989</span></a>  <span class="comment">    // Mark internal user record as &quot;deleted&quot;.</span>
<a name="l3990"><span class="linenum">3990</span></a>      <a class="var it10992" onMouseOver="hilite(10992)" onMouseOut="lolite()" onClick="logVariable('updateuser')" href="../_variables/updateuser.html">$updateuser</a> = new stdClass();
<a name="l3991"><span class="linenum">3991</span></a>      <a class="var it10992" onMouseOver="hilite(10992)" onMouseOut="lolite()" onClick="logVariable('updateuser')" href="../_variables/updateuser.html">$updateuser</a>-&gt;<a onClick="logVariable('id')" class="var it41071" onMouseOver="hilite(41071)" onMouseOut="lolite()" href="../_variables/id.html">id</a>           = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>;
<a name="l3992"><span class="linenum">3992</span></a>      <a class="var it10992" onMouseOver="hilite(10992)" onMouseOut="lolite()" onClick="logVariable('updateuser')" href="../_variables/updateuser.html">$updateuser</a>-&gt;<a onClick="logVariable('deleted')" class="var it41071" onMouseOver="hilite(41071)" onMouseOut="lolite()" href="../_variables/deleted.html">deleted</a>      = 1;
<a name="l3993"><span class="linenum">3993</span></a>      <a class="var it10992" onMouseOver="hilite(10992)" onMouseOut="lolite()" onClick="logVariable('updateuser')" href="../_variables/updateuser.html">$updateuser</a>-&gt;<a onClick="logVariable('username')" class="var it41071" onMouseOver="hilite(41071)" onMouseOut="lolite()" href="../_variables/username.html">username</a>     = <a class="var it3913" onMouseOver="hilite(3913)" onMouseOut="lolite()" onClick="logVariable('delname')" href="../_variables/delname.html">$delname</a>;            <span class="comment">// Remember it just in case.</span>
<a name="l3994"><span class="linenum">3994</span></a>      <a class="var it10992" onMouseOver="hilite(10992)" onMouseOut="lolite()" onClick="logVariable('updateuser')" href="../_variables/updateuser.html">$updateuser</a>-&gt;<a onClick="logVariable('email')" class="var it41071" onMouseOver="hilite(41071)" onMouseOut="lolite()" href="../_variables/email.html">email</a>        = md5(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/username.html">username</a>);<span class="comment">// Store hash of username, useful importing/restoring users.</span>
<a name="l3995"><span class="linenum">3995</span></a>      <a class="var it10992" onMouseOver="hilite(10992)" onMouseOut="lolite()" onClick="logVariable('updateuser')" href="../_variables/updateuser.html">$updateuser</a>-&gt;<a onClick="logVariable('idnumber')" class="var it41071" onMouseOver="hilite(41071)" onMouseOut="lolite()" href="../_variables/idnumber.html">idnumber</a>     = '';                  <span class="comment">// Clear this field to free it up.</span>
<a name="l3996"><span class="linenum">3996</span></a>      <a class="var it10992" onMouseOver="hilite(10992)" onMouseOut="lolite()" onClick="logVariable('updateuser')" href="../_variables/updateuser.html">$updateuser</a>-&gt;<a onClick="logVariable('picture')" class="var it41071" onMouseOver="hilite(41071)" onMouseOut="lolite()" href="../_variables/picture.html">picture</a>      = 0;
<a name="l3997"><span class="linenum">3997</span></a>      <a class="var it10992" onMouseOver="hilite(10992)" onMouseOut="lolite()" onClick="logVariable('updateuser')" href="../_variables/updateuser.html">$updateuser</a>-&gt;<a onClick="logVariable('timemodified')" class="var it41071" onMouseOver="hilite(41071)" onMouseOut="lolite()" href="../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l3998"><span class="linenum">3998</span></a>  
<a name="l3999"><span class="linenum">3999</span></a>  <span class="comment">    // Don't trigger update event, as user is being deleted.</span>
<a name="l4000"><span class="linenum">4000</span></a>      <a class="function" onClick="logFunction('user_update_user')" href="../_functions/user_update_user.html" onMouseOver="funcPopup(event,'user_update_user')">user_update_user</a>(<a class="var it10992" onMouseOver="hilite(10992)" onMouseOut="lolite()" onClick="logVariable('updateuser')" href="../_variables/updateuser.html">$updateuser</a>, false, false);
<a name="l4001"><span class="linenum">4001</span></a>  
<a name="l4002"><span class="linenum">4002</span></a>  <span class="comment">    // Now do a final accesslib cleanup - removes all role assignments in user context and context itself.</span>
<a name="l4003"><span class="linenum">4003</span></a>      <a class="class" onClick="logClass('context_helper')" href="../_classes/context_helper.html" onMouseOver="classPopup(event,'context_helper')">context_helper</a>::<a class="function" onClick="logFunction('delete_instance')" href="../_functions/delete_instance.html" onMouseOver="funcPopup(event,'delete_instance')">delete_instance</a>(<a class="constant" onClick="logConstant('CONTEXT_USER')" href="../_constants/CONTEXT_USER.html" onMouseOver="constPopup(event,'CONTEXT_USER')">CONTEXT_USER</a>, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l4004"><span class="linenum">4004</span></a>  
<a name="l4005"><span class="linenum">4005</span></a>  <span class="comment">    // Any plugin that needs to cleanup should register this event.</span>
<a name="l4006"><span class="linenum">4006</span></a>  <span class="comment">    // Trigger event.</span>
<a name="l4007"><span class="linenum">4007</span></a>      <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a> = \core\event\<a class="class" onClick="logClass('user_deleted')" href="../_classes/user_deleted.html" onMouseOver="classPopup(event,'user_deleted')">user_deleted</a>::<a class="function" onClick="logFunction('create')" href="../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(
<a name="l4008"><span class="linenum">4008</span></a>              array(
<a name="l4009"><span class="linenum">4009</span></a>                  'objectid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l4010"><span class="linenum">4010</span></a>                  'relateduserid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l4011"><span class="linenum">4011</span></a>                  'context' =&gt; <a class="var it1419" onMouseOver="hilite(1419)" onMouseOut="lolite()" onClick="logVariable('usercontext')" href="../_variables/usercontext.html">$usercontext</a>,
<a name="l4012"><span class="linenum">4012</span></a>                  'other' =&gt; array(
<a name="l4013"><span class="linenum">4013</span></a>                      'username' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/username.html">username</a>,
<a name="l4014"><span class="linenum">4014</span></a>                      'email' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('email')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/email.html">email</a>,
<a name="l4015"><span class="linenum">4015</span></a>                      'idnumber' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('idnumber')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/idnumber.html">idnumber</a>,
<a name="l4016"><span class="linenum">4016</span></a>                      'picture' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('picture')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/picture.html">picture</a>,
<a name="l4017"><span class="linenum">4017</span></a>                      'mnethostid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;mnethostid
<a name="l4018"><span class="linenum">4018</span></a>                      )
<a name="l4019"><span class="linenum">4019</span></a>                  )
<a name="l4020"><span class="linenum">4020</span></a>              );
<a name="l4021"><span class="linenum">4021</span></a>      <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('user', <a class="var it8634" onMouseOver="hilite(8634)" onMouseOut="lolite()" onClick="logVariable('olduser')" href="../_variables/olduser.html">$olduser</a>);
<a name="l4022"><span class="linenum">4022</span></a>      <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l4023"><span class="linenum">4023</span></a>  
<a name="l4024"><span class="linenum">4024</span></a>  <span class="comment">    // We will update the user's timemodified, as it will be passed to the user_deleted event, which</span>
<a name="l4025"><span class="linenum">4025</span></a>  <span class="comment">    // should know about this updated property persisted to the user's table.</span>
<a name="l4026"><span class="linenum">4026</span></a>      <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('timemodified')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/timemodified.html">timemodified</a> = <a class="var it10992" onMouseOver="hilite(10992)" onMouseOut="lolite()" onClick="logVariable('updateuser')" href="../_variables/updateuser.html">$updateuser</a>-&gt;<a onClick="logVariable('timemodified')" class="var it41071" onMouseOver="hilite(41071)" onMouseOut="lolite()" href="../_variables/timemodified.html">timemodified</a>;
<a name="l4027"><span class="linenum">4027</span></a>  
<a name="l4028"><span class="linenum">4028</span></a>  <span class="comment">    // Notify auth plugin - do not block the delete even when plugin fails.</span>
<a name="l4029"><span class="linenum">4029</span></a>      <a class="var it4020" onMouseOver="hilite(4020)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../_variables/authplugin.html">$authplugin</a> = <a class="function" onClick="logFunction('get_auth_plugin')" href="../_functions/get_auth_plugin.html" onMouseOver="funcPopup(event,'get_auth_plugin')">get_auth_plugin</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>);
<a name="l4030"><span class="linenum">4030</span></a>      <a class="var it4020" onMouseOver="hilite(4020)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../_variables/authplugin.html">$authplugin</a>-&gt;<a class="function" onClick="logFunction('user_delete')" href="../_functions/user_delete.html" onMouseOver="funcPopup(event,'user_delete')">user_delete</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l4031"><span class="linenum">4031</span></a>  
<a name="l4032"><span class="linenum">4032</span></a>      return true;
<a name="l4033"><span class="linenum">4033</span></a>  }
<a name="l4034"><span class="linenum">4034</span></a>  
<a name="l4035"><span class="linenum">4035</span></a>  <span class="comment">/**</span>
<a name="l4036"><span class="linenum">4036</span></a>  <span class="comment"> * Retrieve the guest user object.</span>
<a name="l4037"><span class="linenum">4037</span></a>  <span class="comment"> *</span>
<a name="l4038"><span class="linenum">4038</span></a>  <span class="comment"> * @return stdClass A {@link $USER} object</span>
<a name="l4039"><span class="linenum">4039</span></a>  <span class="comment"> */</span>
<a name="l4040"><span class="linenum">4040</span></a>  function <a class="function" onClick="logFunction('guest_user')" href="../_functions/guest_user.html" onMouseOver="funcPopup(event,'guest_user')">guest_user</a>() {
<a name="l4041"><span class="linenum">4041</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l4042"><span class="linenum">4042</span></a>  
<a name="l4043"><span class="linenum">4043</span></a>      if (<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user', array('id' =&gt; <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('siteguest')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/siteguest.html">siteguest</a>))) {
<a name="l4044"><span class="linenum">4044</span></a>          <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('confirmed')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/confirmed.html">confirmed</a> = 1;
<a name="l4045"><span class="linenum">4045</span></a>          <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('lang')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('lang')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>;
<a name="l4046"><span class="linenum">4046</span></a>          <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>-&gt;<a onClick="logVariable('lastip')" class="var it39669" onMouseOver="hilite(39669)" onMouseOut="lolite()" href="../_variables/lastip.html">lastip</a> = <a class="function" onClick="logFunction('getremoteaddr')" href="../_functions/getremoteaddr.html" onMouseOver="funcPopup(event,'getremoteaddr')">getremoteaddr</a>();
<a name="l4047"><span class="linenum">4047</span></a>      }
<a name="l4048"><span class="linenum">4048</span></a>  
<a name="l4049"><span class="linenum">4049</span></a>      return <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>;
<a name="l4050"><span class="linenum">4050</span></a>  }
<a name="l4051"><span class="linenum">4051</span></a>  
<a name="l4052"><span class="linenum">4052</span></a>  <span class="comment">/**</span>
<a name="l4053"><span class="linenum">4053</span></a>  <span class="comment"> * Authenticates a user against the chosen authentication mechanism</span>
<a name="l4054"><span class="linenum">4054</span></a>  <span class="comment"> *</span>
<a name="l4055"><span class="linenum">4055</span></a>  <span class="comment"> * Given a username and password, this function looks them</span>
<a name="l4056"><span class="linenum">4056</span></a>  <span class="comment"> * up using the currently selected authentication mechanism,</span>
<a name="l4057"><span class="linenum">4057</span></a>  <span class="comment"> * and if the authentication is successful, it returns a</span>
<a name="l4058"><span class="linenum">4058</span></a>  <span class="comment"> * valid $user object from the 'user' table.</span>
<a name="l4059"><span class="linenum">4059</span></a>  <span class="comment"> *</span>
<a name="l4060"><span class="linenum">4060</span></a>  <span class="comment"> * Uses auth_ functions from the currently active auth module</span>
<a name="l4061"><span class="linenum">4061</span></a>  <span class="comment"> *</span>
<a name="l4062"><span class="linenum">4062</span></a>  <span class="comment"> * After authenticate_user_login() returns success, you will need to</span>
<a name="l4063"><span class="linenum">4063</span></a>  <span class="comment"> * log that the user has logged in, and call complete_user_login() to set</span>
<a name="l4064"><span class="linenum">4064</span></a>  <span class="comment"> * the session up.</span>
<a name="l4065"><span class="linenum">4065</span></a>  <span class="comment"> *</span>
<a name="l4066"><span class="linenum">4066</span></a>  <span class="comment"> * Note: this function works only with non-mnet accounts!</span>
<a name="l4067"><span class="linenum">4067</span></a>  <span class="comment"> *</span>
<a name="l4068"><span class="linenum">4068</span></a>  <span class="comment"> * @param string $username  User's username (or also email if $CFG-&gt;authloginviaemail enabled)</span>
<a name="l4069"><span class="linenum">4069</span></a>  <span class="comment"> * @param string $password  User's password</span>
<a name="l4070"><span class="linenum">4070</span></a>  <span class="comment"> * @param bool $ignorelockout useful when guessing is prevented by other mechanism such as captcha or SSO</span>
<a name="l4071"><span class="linenum">4071</span></a>  <span class="comment"> * @param int $failurereason login failure reason, can be used in renderers (it may disclose if account exists)</span>
<a name="l4072"><span class="linenum">4072</span></a>  <span class="comment"> * @return stdClass|false A {@link $USER} object or false if error</span>
<a name="l4073"><span class="linenum">4073</span></a>  <span class="comment"> */</span>
<a name="l4074"><span class="linenum">4074</span></a>  function <a class="function" onClick="logFunction('authenticate_user_login')" href="../_functions/authenticate_user_login.html" onMouseOver="funcPopup(event,'authenticate_user_login')">authenticate_user_login</a>(<a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>, <a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>, <a class="var it12980" onMouseOver="hilite(12980)" onMouseOut="lolite()" onClick="logVariable('ignorelockout')" href="../_variables/ignorelockout.html">$ignorelockout</a>=false, &amp;<a class="var it12981" onMouseOver="hilite(12981)" onMouseOut="lolite()" onClick="logVariable('failurereason')" href="../_variables/failurereason.html">$failurereason</a>=null) {
<a name="l4075"><span class="linenum">4075</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l4076"><span class="linenum">4076</span></a>      require_once(&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/libdir.html">libdir</a>/authlib.php&quot;);
<a name="l4077"><span class="linenum">4077</span></a>  
<a name="l4078"><span class="linenum">4078</span></a>      if (<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="function" onClick="logFunction('get_complete_user_data')" href="../_functions/get_complete_user_data.html" onMouseOver="funcPopup(event,'get_complete_user_data')">get_complete_user_data</a>('username', <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/mnet_localhost_id.html">mnet_localhost_id</a>)) {
<a name="l4079"><span class="linenum">4079</span></a>  <span class="comment">        // we have found the user</span>
<a name="l4080"><span class="linenum">4080</span></a>  
<a name="l4081"><span class="linenum">4081</span></a>      } else if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('authloginviaemail')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/authloginviaemail.html">authloginviaemail</a>)) {
<a name="l4082"><span class="linenum">4082</span></a>          if (<a class="var it3362" onMouseOver="hilite(3362)" onMouseOut="lolite()" onClick="logVariable('email')" href="../_variables/email.html">$email</a> = <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>, <a class="constant" onClick="logConstant('PARAM_EMAIL')" href="../_constants/PARAM_EMAIL.html" onMouseOver="constPopup(event,'PARAM_EMAIL')">PARAM_EMAIL</a>)) {
<a name="l4083"><span class="linenum">4083</span></a>              <a class="var it2282" onMouseOver="hilite(2282)" onMouseOut="lolite()" onClick="logVariable('select')" href="../_variables/select.html">$select</a> = &quot;mnethostid = :mnethostid AND <a class="function" onClick="logFunction('LOWER')" href="../_functions/lower.html" onMouseOver="funcPopup(event,'lower')">LOWER</a>(email) = <a class="function" onClick="logFunction('LOWER')" href="../_functions/lower.html" onMouseOver="funcPopup(event,'lower')">LOWER</a>(:email) AND deleted = 0&quot;;
<a name="l4084"><span class="linenum">4084</span></a>              <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array('mnethostid' =&gt; <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/mnet_localhost_id.html">mnet_localhost_id</a>, 'email' =&gt; <a class="var it3362" onMouseOver="hilite(3362)" onMouseOut="lolite()" onClick="logVariable('email')" href="../_variables/email.html">$email</a>);
<a name="l4085"><span class="linenum">4085</span></a>              <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../_variables/users.html">$users</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_select')" href="../_functions/get_records_select.html" onMouseOver="funcPopup(event,'get_records_select')">get_records_select</a>('user', <a class="var it2282" onMouseOver="hilite(2282)" onMouseOut="lolite()" onClick="logVariable('select')" href="../_variables/select.html">$select</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>, 'id', 'id', 0, 2);
<a name="l4086"><span class="linenum">4086</span></a>              if (<a class="phpfunction" onClick="logFunction('count')" href="../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../_variables/users.html">$users</a>) === 1) {
<a name="l4087"><span class="linenum">4087</span></a>  <span class="comment">                // Use email for login only if unique.</span>
<a name="l4088"><span class="linenum">4088</span></a>                  <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../_variables/users.html">$users</a>);
<a name="l4089"><span class="linenum">4089</span></a>                  <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="function" onClick="logFunction('get_complete_user_data')" href="../_functions/get_complete_user_data.html" onMouseOver="funcPopup(event,'get_complete_user_data')">get_complete_user_data</a>('id', <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l4090"><span class="linenum">4090</span></a>                  <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a> = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/username.html">username</a>;
<a name="l4091"><span class="linenum">4091</span></a>              }
<a name="l4092"><span class="linenum">4092</span></a>              unset(<a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('users')" href="../_variables/users.html">$users</a>);
<a name="l4093"><span class="linenum">4093</span></a>          }
<a name="l4094"><span class="linenum">4094</span></a>      }
<a name="l4095"><span class="linenum">4095</span></a>  
<a name="l4096"><span class="linenum">4096</span></a>      <a class="var it12982" onMouseOver="hilite(12982)" onMouseOut="lolite()" onClick="logVariable('authsenabled')" href="../_variables/authsenabled.html">$authsenabled</a> = <a class="function" onClick="logFunction('get_enabled_auth_plugins')" href="../_functions/get_enabled_auth_plugins.html" onMouseOver="funcPopup(event,'get_enabled_auth_plugins')">get_enabled_auth_plugins</a>();
<a name="l4097"><span class="linenum">4097</span></a>  
<a name="l4098"><span class="linenum">4098</span></a>      if (<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>) {
<a name="l4099"><span class="linenum">4099</span></a>  <span class="comment">        // Use manual if auth not set.</span>
<a name="l4100"><span class="linenum">4100</span></a>          <a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a> = empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>) ? 'manual' : <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>;
<a name="l4101"><span class="linenum">4101</span></a>          if (!empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('suspended')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/suspended.html">suspended</a>)) {
<a name="l4102"><span class="linenum">4102</span></a>              <a class="var it12981" onMouseOver="hilite(12981)" onMouseOut="lolite()" onClick="logVariable('failurereason')" href="../_variables/failurereason.html">$failurereason</a> = <a class="constant" onClick="logConstant('AUTH_LOGIN_SUSPENDED')" href="../_constants/AUTH_LOGIN_SUSPENDED.html" onMouseOver="constPopup(event,'AUTH_LOGIN_SUSPENDED')">AUTH_LOGIN_SUSPENDED</a>;
<a name="l4103"><span class="linenum">4103</span></a>  
<a name="l4104"><span class="linenum">4104</span></a>  <span class="comment">            // Trigger login failed event.</span>
<a name="l4105"><span class="linenum">4105</span></a>              <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a> = \core\event\<a class="class" onClick="logClass('user_login_failed')" href="../_classes/user_login_failed.html" onMouseOver="classPopup(event,'user_login_failed')">user_login_failed</a>::<a class="function" onClick="logFunction('create')" href="../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l4106"><span class="linenum">4106</span></a>                      'other' =&gt; array('username' =&gt; <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>, 'reason' =&gt; <a class="var it12981" onMouseOver="hilite(12981)" onMouseOut="lolite()" onClick="logVariable('failurereason')" href="../_variables/failurereason.html">$failurereason</a>)));
<a name="l4107"><span class="linenum">4107</span></a>              <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l4108"><span class="linenum">4108</span></a>              <a class="phpfunction" onClick="logFunction('error_log')" href="../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>('[client '.<a class="function" onClick="logFunction('getremoteaddr')" href="../_functions/getremoteaddr.html" onMouseOver="funcPopup(event,'getremoteaddr')">getremoteaddr</a>().&quot;]  <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>  Suspended Login:  <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>  &quot;.<a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['HTTP_USER_AGENT']);
<a name="l4109"><span class="linenum">4109</span></a>              return false;
<a name="l4110"><span class="linenum">4110</span></a>          }
<a name="l4111"><span class="linenum">4111</span></a>          if (<a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>=='nologin' or !<a class="function" onClick="logFunction('is_enabled_auth')" href="../_functions/is_enabled_auth.html" onMouseOver="funcPopup(event,'is_enabled_auth')">is_enabled_auth</a>(<a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>)) {
<a name="l4112"><span class="linenum">4112</span></a>  <span class="comment">            // Legacy way to suspend user.</span>
<a name="l4113"><span class="linenum">4113</span></a>              <a class="var it12981" onMouseOver="hilite(12981)" onMouseOut="lolite()" onClick="logVariable('failurereason')" href="../_variables/failurereason.html">$failurereason</a> = <a class="constant" onClick="logConstant('AUTH_LOGIN_SUSPENDED')" href="../_constants/AUTH_LOGIN_SUSPENDED.html" onMouseOver="constPopup(event,'AUTH_LOGIN_SUSPENDED')">AUTH_LOGIN_SUSPENDED</a>;
<a name="l4114"><span class="linenum">4114</span></a>  
<a name="l4115"><span class="linenum">4115</span></a>  <span class="comment">            // Trigger login failed event.</span>
<a name="l4116"><span class="linenum">4116</span></a>              <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a> = \core\event\<a class="class" onClick="logClass('user_login_failed')" href="../_classes/user_login_failed.html" onMouseOver="classPopup(event,'user_login_failed')">user_login_failed</a>::<a class="function" onClick="logFunction('create')" href="../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l4117"><span class="linenum">4117</span></a>                      'other' =&gt; array('username' =&gt; <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>, 'reason' =&gt; <a class="var it12981" onMouseOver="hilite(12981)" onMouseOut="lolite()" onClick="logVariable('failurereason')" href="../_variables/failurereason.html">$failurereason</a>)));
<a name="l4118"><span class="linenum">4118</span></a>              <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l4119"><span class="linenum">4119</span></a>              <a class="phpfunction" onClick="logFunction('error_log')" href="../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>('[client '.<a class="function" onClick="logFunction('getremoteaddr')" href="../_functions/getremoteaddr.html" onMouseOver="funcPopup(event,'getremoteaddr')">getremoteaddr</a>().&quot;]  <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>  Disabled Login:  <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>  &quot;.<a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['HTTP_USER_AGENT']);
<a name="l4120"><span class="linenum">4120</span></a>              return false;
<a name="l4121"><span class="linenum">4121</span></a>          }
<a name="l4122"><span class="linenum">4122</span></a>          <a class="var it12973" onMouseOver="hilite(12973)" onMouseOut="lolite()" onClick="logVariable('auths')" href="../_variables/auths.html">$auths</a> = array(<a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>);
<a name="l4123"><span class="linenum">4123</span></a>  
<a name="l4124"><span class="linenum">4124</span></a>      } else {
<a name="l4125"><span class="linenum">4125</span></a>  <span class="comment">        // Check if there's a deleted record (cheaply), this should not happen because we mangle usernames in delete_user().</span>
<a name="l4126"><span class="linenum">4126</span></a>          if (<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_field')" href="../_functions/get_field.html" onMouseOver="funcPopup(event,'get_field')">get_field</a>('user', 'id', array('username' =&gt; <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>, 'mnethostid' =&gt; <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/mnet_localhost_id.html">mnet_localhost_id</a>,  'deleted' =&gt; 1))) {
<a name="l4127"><span class="linenum">4127</span></a>              <a class="var it12981" onMouseOver="hilite(12981)" onMouseOut="lolite()" onClick="logVariable('failurereason')" href="../_variables/failurereason.html">$failurereason</a> = <a class="constant" onClick="logConstant('AUTH_LOGIN_NOUSER')" href="../_constants/AUTH_LOGIN_NOUSER.html" onMouseOver="constPopup(event,'AUTH_LOGIN_NOUSER')">AUTH_LOGIN_NOUSER</a>;
<a name="l4128"><span class="linenum">4128</span></a>  
<a name="l4129"><span class="linenum">4129</span></a>  <span class="comment">            // Trigger login failed event.</span>
<a name="l4130"><span class="linenum">4130</span></a>              <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a> = \core\event\<a class="class" onClick="logClass('user_login_failed')" href="../_classes/user_login_failed.html" onMouseOver="classPopup(event,'user_login_failed')">user_login_failed</a>::<a class="function" onClick="logFunction('create')" href="../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(array('other' =&gt; array('username' =&gt; <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>,
<a name="l4131"><span class="linenum">4131</span></a>                      'reason' =&gt; <a class="var it12981" onMouseOver="hilite(12981)" onMouseOut="lolite()" onClick="logVariable('failurereason')" href="../_variables/failurereason.html">$failurereason</a>)));
<a name="l4132"><span class="linenum">4132</span></a>              <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l4133"><span class="linenum">4133</span></a>              <a class="phpfunction" onClick="logFunction('error_log')" href="../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>('[client '.<a class="function" onClick="logFunction('getremoteaddr')" href="../_functions/getremoteaddr.html" onMouseOver="funcPopup(event,'getremoteaddr')">getremoteaddr</a>().&quot;]  <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>  Deleted Login:  <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>  &quot;.<a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['HTTP_USER_AGENT']);
<a name="l4134"><span class="linenum">4134</span></a>              return false;
<a name="l4135"><span class="linenum">4135</span></a>          }
<a name="l4136"><span class="linenum">4136</span></a>  
<a name="l4137"><span class="linenum">4137</span></a>  <span class="comment">        // User does not exist.</span>
<a name="l4138"><span class="linenum">4138</span></a>          <a class="var it12973" onMouseOver="hilite(12973)" onMouseOut="lolite()" onClick="logVariable('auths')" href="../_variables/auths.html">$auths</a> = <a class="var it12982" onMouseOver="hilite(12982)" onMouseOut="lolite()" onClick="logVariable('authsenabled')" href="../_variables/authsenabled.html">$authsenabled</a>;
<a name="l4139"><span class="linenum">4139</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = new stdClass();
<a name="l4140"><span class="linenum">4140</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a> = 0;
<a name="l4141"><span class="linenum">4141</span></a>      }
<a name="l4142"><span class="linenum">4142</span></a>  
<a name="l4143"><span class="linenum">4143</span></a>      if (<a class="var it12980" onMouseOver="hilite(12980)" onMouseOut="lolite()" onClick="logVariable('ignorelockout')" href="../_variables/ignorelockout.html">$ignorelockout</a>) {
<a name="l4144"><span class="linenum">4144</span></a>  <span class="comment">        // Some other mechanism protects against brute force password guessing, for example login form might include reCAPTCHA</span>
<a name="l4145"><span class="linenum">4145</span></a>  <span class="comment">        // or this function is called from a SSO script.</span>
<a name="l4146"><span class="linenum">4146</span></a>      } else if (<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>) {
<a name="l4147"><span class="linenum">4147</span></a>  <span class="comment">        // Verify login lockout after other ways that may prevent user login.</span>
<a name="l4148"><span class="linenum">4148</span></a>          if (<a class="function" onClick="logFunction('login_is_lockedout')" href="../_functions/login_is_lockedout.html" onMouseOver="funcPopup(event,'login_is_lockedout')">login_is_lockedout</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l4149"><span class="linenum">4149</span></a>              <a class="var it12981" onMouseOver="hilite(12981)" onMouseOut="lolite()" onClick="logVariable('failurereason')" href="../_variables/failurereason.html">$failurereason</a> = <a class="constant" onClick="logConstant('AUTH_LOGIN_LOCKOUT')" href="../_constants/AUTH_LOGIN_LOCKOUT.html" onMouseOver="constPopup(event,'AUTH_LOGIN_LOCKOUT')">AUTH_LOGIN_LOCKOUT</a>;
<a name="l4150"><span class="linenum">4150</span></a>  
<a name="l4151"><span class="linenum">4151</span></a>  <span class="comment">            // Trigger login failed event.</span>
<a name="l4152"><span class="linenum">4152</span></a>              <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a> = \core\event\<a class="class" onClick="logClass('user_login_failed')" href="../_classes/user_login_failed.html" onMouseOver="classPopup(event,'user_login_failed')">user_login_failed</a>::<a class="function" onClick="logFunction('create')" href="../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l4153"><span class="linenum">4153</span></a>                      'other' =&gt; array('username' =&gt; <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>, 'reason' =&gt; <a class="var it12981" onMouseOver="hilite(12981)" onMouseOut="lolite()" onClick="logVariable('failurereason')" href="../_variables/failurereason.html">$failurereason</a>)));
<a name="l4154"><span class="linenum">4154</span></a>              <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l4155"><span class="linenum">4155</span></a>  
<a name="l4156"><span class="linenum">4156</span></a>              <a class="phpfunction" onClick="logFunction('error_log')" href="../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>('[client '.<a class="function" onClick="logFunction('getremoteaddr')" href="../_functions/getremoteaddr.html" onMouseOver="funcPopup(event,'getremoteaddr')">getremoteaddr</a>().&quot;]  <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>  Login lockout:  <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>  &quot;.<a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['HTTP_USER_AGENT']);
<a name="l4157"><span class="linenum">4157</span></a>              return false;
<a name="l4158"><span class="linenum">4158</span></a>          }
<a name="l4159"><span class="linenum">4159</span></a>      } else {
<a name="l4160"><span class="linenum">4160</span></a>  <span class="comment">        // We can not lockout non-existing accounts.</span>
<a name="l4161"><span class="linenum">4161</span></a>      }
<a name="l4162"><span class="linenum">4162</span></a>  
<a name="l4163"><span class="linenum">4163</span></a>      foreach (<a class="var it12973" onMouseOver="hilite(12973)" onMouseOut="lolite()" onClick="logVariable('auths')" href="../_variables/auths.html">$auths</a> as <a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>) {
<a name="l4164"><span class="linenum">4164</span></a>          <a class="var it4020" onMouseOver="hilite(4020)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../_variables/authplugin.html">$authplugin</a> = <a class="function" onClick="logFunction('get_auth_plugin')" href="../_functions/get_auth_plugin.html" onMouseOver="funcPopup(event,'get_auth_plugin')">get_auth_plugin</a>(<a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>);
<a name="l4165"><span class="linenum">4165</span></a>  
<a name="l4166"><span class="linenum">4166</span></a>  <span class="comment">        // On auth fail fall through to the next plugin.</span>
<a name="l4167"><span class="linenum">4167</span></a>          if (!<a class="var it4020" onMouseOver="hilite(4020)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../_variables/authplugin.html">$authplugin</a>-&gt;<a class="function" onClick="logFunction('user_login')" href="../_functions/user_login.html" onMouseOver="funcPopup(event,'user_login')">user_login</a>(<a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>, <a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>)) {
<a name="l4168"><span class="linenum">4168</span></a>              continue;
<a name="l4169"><span class="linenum">4169</span></a>          }
<a name="l4170"><span class="linenum">4170</span></a>  
<a name="l4171"><span class="linenum">4171</span></a>  <span class="comment">        // Successful authentication.</span>
<a name="l4172"><span class="linenum">4172</span></a>          if (<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>) {
<a name="l4173"><span class="linenum">4173</span></a>  <span class="comment">            // User already exists in database.</span>
<a name="l4174"><span class="linenum">4174</span></a>              if (empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>)) {
<a name="l4175"><span class="linenum">4175</span></a>  <span class="comment">                // For some reason auth isn't set yet.</span>
<a name="l4176"><span class="linenum">4176</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('user', 'auth', <a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>, array('id' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l4177"><span class="linenum">4177</span></a>                  <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a> = <a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>;
<a name="l4178"><span class="linenum">4178</span></a>              }
<a name="l4179"><span class="linenum">4179</span></a>  
<a name="l4180"><span class="linenum">4180</span></a>  <span class="comment">            // If the existing hash is using an out-of-date algorithm (or the legacy md5 algorithm), then we should update to</span>
<a name="l4181"><span class="linenum">4181</span></a>  <span class="comment">            // the current hash algorithm while we have access to the user's password.</span>
<a name="l4182"><span class="linenum">4182</span></a>              <a class="function" onClick="logFunction('update_internal_user_password')" href="../_functions/update_internal_user_password.html" onMouseOver="funcPopup(event,'update_internal_user_password')">update_internal_user_password</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>);
<a name="l4183"><span class="linenum">4183</span></a>  
<a name="l4184"><span class="linenum">4184</span></a>              if (<a class="var it4020" onMouseOver="hilite(4020)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../_variables/authplugin.html">$authplugin</a>-&gt;<a class="function" onClick="logFunction('is_synchronised_with_external')" href="../_functions/is_synchronised_with_external.html" onMouseOver="funcPopup(event,'is_synchronised_with_external')">is_synchronised_with_external</a>()) {
<a name="l4185"><span class="linenum">4185</span></a>  <span class="comment">                // Update user record from external DB.</span>
<a name="l4186"><span class="linenum">4186</span></a>                  <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="function" onClick="logFunction('update_user_record_by_id')" href="../_functions/update_user_record_by_id.html" onMouseOver="funcPopup(event,'update_user_record_by_id')">update_user_record_by_id</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l4187"><span class="linenum">4187</span></a>              }
<a name="l4188"><span class="linenum">4188</span></a>          } else {
<a name="l4189"><span class="linenum">4189</span></a>  <span class="comment">            // The user is authenticated but user creation may be disabled.</span>
<a name="l4190"><span class="linenum">4190</span></a>              if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('authpreventaccountcreation')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/authpreventaccountcreation.html">authpreventaccountcreation</a>)) {
<a name="l4191"><span class="linenum">4191</span></a>                  <a class="var it12981" onMouseOver="hilite(12981)" onMouseOut="lolite()" onClick="logVariable('failurereason')" href="../_variables/failurereason.html">$failurereason</a> = <a class="constant" onClick="logConstant('AUTH_LOGIN_UNAUTHORISED')" href="../_constants/AUTH_LOGIN_UNAUTHORISED.html" onMouseOver="constPopup(event,'AUTH_LOGIN_UNAUTHORISED')">AUTH_LOGIN_UNAUTHORISED</a>;
<a name="l4192"><span class="linenum">4192</span></a>  
<a name="l4193"><span class="linenum">4193</span></a>  <span class="comment">                // Trigger login failed event.</span>
<a name="l4194"><span class="linenum">4194</span></a>                  <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a> = \core\event\<a class="class" onClick="logClass('user_login_failed')" href="../_classes/user_login_failed.html" onMouseOver="classPopup(event,'user_login_failed')">user_login_failed</a>::<a class="function" onClick="logFunction('create')" href="../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(array('other' =&gt; array('username' =&gt; <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>,
<a name="l4195"><span class="linenum">4195</span></a>                          'reason' =&gt; <a class="var it12981" onMouseOver="hilite(12981)" onMouseOut="lolite()" onClick="logVariable('failurereason')" href="../_variables/failurereason.html">$failurereason</a>)));
<a name="l4196"><span class="linenum">4196</span></a>                  <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l4197"><span class="linenum">4197</span></a>  
<a name="l4198"><span class="linenum">4198</span></a>                  <a class="phpfunction" onClick="logFunction('error_log')" href="../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>('[client '.<a class="function" onClick="logFunction('getremoteaddr')" href="../_functions/getremoteaddr.html" onMouseOver="funcPopup(event,'getremoteaddr')">getremoteaddr</a>().&quot;]  <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>  Unknown user, can not create new accounts:  <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>  &quot;.
<a name="l4199"><span class="linenum">4199</span></a>                          <a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['HTTP_USER_AGENT']);
<a name="l4200"><span class="linenum">4200</span></a>                  return false;
<a name="l4201"><span class="linenum">4201</span></a>              } else {
<a name="l4202"><span class="linenum">4202</span></a>                  <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="function" onClick="logFunction('create_user_record')" href="../_functions/create_user_record.html" onMouseOver="funcPopup(event,'create_user_record')">create_user_record</a>(<a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>, <a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>, <a class="var it524" onMouseOver="hilite(524)" onMouseOut="lolite()" onClick="logVariable('auth')" href="../_variables/auth.html">$auth</a>);
<a name="l4203"><span class="linenum">4203</span></a>              }
<a name="l4204"><span class="linenum">4204</span></a>          }
<a name="l4205"><span class="linenum">4205</span></a>  
<a name="l4206"><span class="linenum">4206</span></a>          <a class="var it4020" onMouseOver="hilite(4020)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../_variables/authplugin.html">$authplugin</a>-&gt;<a class="function" onClick="logFunction('sync_roles')" href="../_functions/sync_roles.html" onMouseOver="funcPopup(event,'sync_roles')">sync_roles</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l4207"><span class="linenum">4207</span></a>  
<a name="l4208"><span class="linenum">4208</span></a>          foreach (<a class="var it12982" onMouseOver="hilite(12982)" onMouseOut="lolite()" onClick="logVariable('authsenabled')" href="../_variables/authsenabled.html">$authsenabled</a> as <a class="var it12984" onMouseOver="hilite(12984)" onMouseOut="lolite()" onClick="logVariable('hau')" href="../_variables/hau.html">$hau</a>) {
<a name="l4209"><span class="linenum">4209</span></a>              <a class="var it12985" onMouseOver="hilite(12985)" onMouseOut="lolite()" onClick="logVariable('hauth')" href="../_variables/hauth.html">$hauth</a> = <a class="function" onClick="logFunction('get_auth_plugin')" href="../_functions/get_auth_plugin.html" onMouseOver="funcPopup(event,'get_auth_plugin')">get_auth_plugin</a>(<a class="var it12984" onMouseOver="hilite(12984)" onMouseOut="lolite()" onClick="logVariable('hau')" href="../_variables/hau.html">$hau</a>);
<a name="l4210"><span class="linenum">4210</span></a>              <a class="var it12985" onMouseOver="hilite(12985)" onMouseOut="lolite()" onClick="logVariable('hauth')" href="../_variables/hauth.html">$hauth</a>-&gt;<a class="function" onClick="logFunction('user_authenticated_hook')" href="../_functions/user_authenticated_hook.html" onMouseOver="funcPopup(event,'user_authenticated_hook')">user_authenticated_hook</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>, <a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>);
<a name="l4211"><span class="linenum">4211</span></a>          }
<a name="l4212"><span class="linenum">4212</span></a>  
<a name="l4213"><span class="linenum">4213</span></a>          if (empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)) {
<a name="l4214"><span class="linenum">4214</span></a>              <a class="var it12981" onMouseOver="hilite(12981)" onMouseOut="lolite()" onClick="logVariable('failurereason')" href="../_variables/failurereason.html">$failurereason</a> = <a class="constant" onClick="logConstant('AUTH_LOGIN_NOUSER')" href="../_constants/AUTH_LOGIN_NOUSER.html" onMouseOver="constPopup(event,'AUTH_LOGIN_NOUSER')">AUTH_LOGIN_NOUSER</a>;
<a name="l4215"><span class="linenum">4215</span></a>  <span class="comment">            // Trigger login failed event.</span>
<a name="l4216"><span class="linenum">4216</span></a>              <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a> = \core\event\<a class="class" onClick="logClass('user_login_failed')" href="../_classes/user_login_failed.html" onMouseOver="classPopup(event,'user_login_failed')">user_login_failed</a>::<a class="function" onClick="logFunction('create')" href="../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(array('other' =&gt; array('username' =&gt; <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>,
<a name="l4217"><span class="linenum">4217</span></a>                      'reason' =&gt; <a class="var it12981" onMouseOver="hilite(12981)" onMouseOut="lolite()" onClick="logVariable('failurereason')" href="../_variables/failurereason.html">$failurereason</a>)));
<a name="l4218"><span class="linenum">4218</span></a>              <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l4219"><span class="linenum">4219</span></a>              return false;
<a name="l4220"><span class="linenum">4220</span></a>          }
<a name="l4221"><span class="linenum">4221</span></a>  
<a name="l4222"><span class="linenum">4222</span></a>          if (!empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('suspended')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/suspended.html">suspended</a>)) {
<a name="l4223"><span class="linenum">4223</span></a>  <span class="comment">            // Just in case some auth plugin suspended account.</span>
<a name="l4224"><span class="linenum">4224</span></a>              <a class="var it12981" onMouseOver="hilite(12981)" onMouseOut="lolite()" onClick="logVariable('failurereason')" href="../_variables/failurereason.html">$failurereason</a> = <a class="constant" onClick="logConstant('AUTH_LOGIN_SUSPENDED')" href="../_constants/AUTH_LOGIN_SUSPENDED.html" onMouseOver="constPopup(event,'AUTH_LOGIN_SUSPENDED')">AUTH_LOGIN_SUSPENDED</a>;
<a name="l4225"><span class="linenum">4225</span></a>  <span class="comment">            // Trigger login failed event.</span>
<a name="l4226"><span class="linenum">4226</span></a>              <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a> = \core\event\<a class="class" onClick="logClass('user_login_failed')" href="../_classes/user_login_failed.html" onMouseOver="classPopup(event,'user_login_failed')">user_login_failed</a>::<a class="function" onClick="logFunction('create')" href="../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l4227"><span class="linenum">4227</span></a>                      'other' =&gt; array('username' =&gt; <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>, 'reason' =&gt; <a class="var it12981" onMouseOver="hilite(12981)" onMouseOut="lolite()" onClick="logVariable('failurereason')" href="../_variables/failurereason.html">$failurereason</a>)));
<a name="l4228"><span class="linenum">4228</span></a>              <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l4229"><span class="linenum">4229</span></a>              <a class="phpfunction" onClick="logFunction('error_log')" href="../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>('[client '.<a class="function" onClick="logFunction('getremoteaddr')" href="../_functions/getremoteaddr.html" onMouseOver="funcPopup(event,'getremoteaddr')">getremoteaddr</a>().&quot;]  <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>  Suspended Login:  <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>  &quot;.<a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['HTTP_USER_AGENT']);
<a name="l4230"><span class="linenum">4230</span></a>              return false;
<a name="l4231"><span class="linenum">4231</span></a>          }
<a name="l4232"><span class="linenum">4232</span></a>  
<a name="l4233"><span class="linenum">4233</span></a>          <a class="function" onClick="logFunction('login_attempt_valid')" href="../_functions/login_attempt_valid.html" onMouseOver="funcPopup(event,'login_attempt_valid')">login_attempt_valid</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l4234"><span class="linenum">4234</span></a>          <a class="var it12981" onMouseOver="hilite(12981)" onMouseOut="lolite()" onClick="logVariable('failurereason')" href="../_variables/failurereason.html">$failurereason</a> = <a class="constant" onClick="logConstant('AUTH_LOGIN_OK')" href="../_constants/AUTH_LOGIN_OK.html" onMouseOver="constPopup(event,'AUTH_LOGIN_OK')">AUTH_LOGIN_OK</a>;
<a name="l4235"><span class="linenum">4235</span></a>          return <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>;
<a name="l4236"><span class="linenum">4236</span></a>      }
<a name="l4237"><span class="linenum">4237</span></a>  
<a name="l4238"><span class="linenum">4238</span></a>  <span class="comment">    // Failed if all the plugins have failed.</span>
<a name="l4239"><span class="linenum">4239</span></a>      if (<a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('', <a class="constant" onClick="logConstant('DEBUG_ALL')" href="../_constants/DEBUG_ALL.html" onMouseOver="constPopup(event,'DEBUG_ALL')">DEBUG_ALL</a>)) {
<a name="l4240"><span class="linenum">4240</span></a>          <a class="phpfunction" onClick="logFunction('error_log')" href="../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>('[client '.<a class="function" onClick="logFunction('getremoteaddr')" href="../_functions/getremoteaddr.html" onMouseOver="funcPopup(event,'getremoteaddr')">getremoteaddr</a>().&quot;]  <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>  Failed Login:  <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>  &quot;.<a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['HTTP_USER_AGENT']);
<a name="l4241"><span class="linenum">4241</span></a>      }
<a name="l4242"><span class="linenum">4242</span></a>  
<a name="l4243"><span class="linenum">4243</span></a>      if (<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>) {
<a name="l4244"><span class="linenum">4244</span></a>          <a class="function" onClick="logFunction('login_attempt_failed')" href="../_functions/login_attempt_failed.html" onMouseOver="funcPopup(event,'login_attempt_failed')">login_attempt_failed</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l4245"><span class="linenum">4245</span></a>          <a class="var it12981" onMouseOver="hilite(12981)" onMouseOut="lolite()" onClick="logVariable('failurereason')" href="../_variables/failurereason.html">$failurereason</a> = <a class="constant" onClick="logConstant('AUTH_LOGIN_FAILED')" href="../_constants/AUTH_LOGIN_FAILED.html" onMouseOver="constPopup(event,'AUTH_LOGIN_FAILED')">AUTH_LOGIN_FAILED</a>;
<a name="l4246"><span class="linenum">4246</span></a>  <span class="comment">        // Trigger login failed event.</span>
<a name="l4247"><span class="linenum">4247</span></a>          <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a> = \core\event\<a class="class" onClick="logClass('user_login_failed')" href="../_classes/user_login_failed.html" onMouseOver="classPopup(event,'user_login_failed')">user_login_failed</a>::<a class="function" onClick="logFunction('create')" href="../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l4248"><span class="linenum">4248</span></a>                  'other' =&gt; array('username' =&gt; <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>, 'reason' =&gt; <a class="var it12981" onMouseOver="hilite(12981)" onMouseOut="lolite()" onClick="logVariable('failurereason')" href="../_variables/failurereason.html">$failurereason</a>)));
<a name="l4249"><span class="linenum">4249</span></a>          <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l4250"><span class="linenum">4250</span></a>      } else {
<a name="l4251"><span class="linenum">4251</span></a>          <a class="var it12981" onMouseOver="hilite(12981)" onMouseOut="lolite()" onClick="logVariable('failurereason')" href="../_variables/failurereason.html">$failurereason</a> = <a class="constant" onClick="logConstant('AUTH_LOGIN_NOUSER')" href="../_constants/AUTH_LOGIN_NOUSER.html" onMouseOver="constPopup(event,'AUTH_LOGIN_NOUSER')">AUTH_LOGIN_NOUSER</a>;
<a name="l4252"><span class="linenum">4252</span></a>  <span class="comment">        // Trigger login failed event.</span>
<a name="l4253"><span class="linenum">4253</span></a>          <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a> = \core\event\<a class="class" onClick="logClass('user_login_failed')" href="../_classes/user_login_failed.html" onMouseOver="classPopup(event,'user_login_failed')">user_login_failed</a>::<a class="function" onClick="logFunction('create')" href="../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(array('other' =&gt; array('username' =&gt; <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>,
<a name="l4254"><span class="linenum">4254</span></a>                  'reason' =&gt; <a class="var it12981" onMouseOver="hilite(12981)" onMouseOut="lolite()" onClick="logVariable('failurereason')" href="../_variables/failurereason.html">$failurereason</a>)));
<a name="l4255"><span class="linenum">4255</span></a>          <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l4256"><span class="linenum">4256</span></a>      }
<a name="l4257"><span class="linenum">4257</span></a>  
<a name="l4258"><span class="linenum">4258</span></a>      return false;
<a name="l4259"><span class="linenum">4259</span></a>  }
<a name="l4260"><span class="linenum">4260</span></a>  
<a name="l4261"><span class="linenum">4261</span></a>  <span class="comment">/**</span>
<a name="l4262"><span class="linenum">4262</span></a>  <span class="comment"> * Call to complete the user login process after authenticate_user_login()</span>
<a name="l4263"><span class="linenum">4263</span></a>  <span class="comment"> * has succeeded. It will setup the $USER variable and other required bits</span>
<a name="l4264"><span class="linenum">4264</span></a>  <span class="comment"> * and pieces.</span>
<a name="l4265"><span class="linenum">4265</span></a>  <span class="comment"> *</span>
<a name="l4266"><span class="linenum">4266</span></a>  <span class="comment"> * NOTE:</span>
<a name="l4267"><span class="linenum">4267</span></a>  <span class="comment"> * - It will NOT log anything -- up to the caller to decide what to log.</span>
<a name="l4268"><span class="linenum">4268</span></a>  <span class="comment"> * - this function does not set any cookies any more!</span>
<a name="l4269"><span class="linenum">4269</span></a>  <span class="comment"> *</span>
<a name="l4270"><span class="linenum">4270</span></a>  <span class="comment"> * @param stdClass $user</span>
<a name="l4271"><span class="linenum">4271</span></a>  <span class="comment"> * @return stdClass A {@link $USER} object - BC only, do not use</span>
<a name="l4272"><span class="linenum">4272</span></a>  <span class="comment"> */</span>
<a name="l4273"><span class="linenum">4273</span></a>  function <a class="function" onClick="logFunction('complete_user_login')" href="../_functions/complete_user_login.html" onMouseOver="funcPopup(event,'complete_user_login')">complete_user_login</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>) {
<a name="l4274"><span class="linenum">4274</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>;
<a name="l4275"><span class="linenum">4275</span></a>  
<a name="l4276"><span class="linenum">4276</span></a>      \core\session\<a class="class" onClick="logClass('manager')" href="../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('login_user')" href="../_functions/login_user.html" onMouseOver="funcPopup(event,'login_user')">login_user</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l4277"><span class="linenum">4277</span></a>  
<a name="l4278"><span class="linenum">4278</span></a>  <span class="comment">    // Reload preferences from DB.</span>
<a name="l4279"><span class="linenum">4279</span></a>      unset(<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('preference')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/preference.html">preference</a>);
<a name="l4280"><span class="linenum">4280</span></a>      <a class="function" onClick="logFunction('check_user_preferences_loaded')" href="../_functions/check_user_preferences_loaded.html" onMouseOver="funcPopup(event,'check_user_preferences_loaded')">check_user_preferences_loaded</a>(<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>);
<a name="l4281"><span class="linenum">4281</span></a>  
<a name="l4282"><span class="linenum">4282</span></a>  <span class="comment">    // Update login times.</span>
<a name="l4283"><span class="linenum">4283</span></a>      <a class="function" onClick="logFunction('update_user_login_times')" href="../_functions/update_user_login_times.html" onMouseOver="funcPopup(event,'update_user_login_times')">update_user_login_times</a>();
<a name="l4284"><span class="linenum">4284</span></a>  
<a name="l4285"><span class="linenum">4285</span></a>  <span class="comment">    // Extra session prefs init.</span>
<a name="l4286"><span class="linenum">4286</span></a>      <a class="function" onClick="logFunction('set_login_session_preferences')" href="../_functions/set_login_session_preferences.html" onMouseOver="funcPopup(event,'set_login_session_preferences')">set_login_session_preferences</a>();
<a name="l4287"><span class="linenum">4287</span></a>  
<a name="l4288"><span class="linenum">4288</span></a>  <span class="comment">    // Trigger login event.</span>
<a name="l4289"><span class="linenum">4289</span></a>      <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a> = \core\event\<a class="class" onClick="logClass('user_loggedin')" href="../_classes/user_loggedin.html" onMouseOver="classPopup(event,'user_loggedin')">user_loggedin</a>::<a class="function" onClick="logFunction('create')" href="../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(
<a name="l4290"><span class="linenum">4290</span></a>          array(
<a name="l4291"><span class="linenum">4291</span></a>              'userid' =&gt; <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l4292"><span class="linenum">4292</span></a>              'objectid' =&gt; <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l4293"><span class="linenum">4293</span></a>              'other' =&gt; array('username' =&gt; <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('username')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/username.html">username</a>),
<a name="l4294"><span class="linenum">4294</span></a>          )
<a name="l4295"><span class="linenum">4295</span></a>      );
<a name="l4296"><span class="linenum">4296</span></a>      <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l4297"><span class="linenum">4297</span></a>  
<a name="l4298"><span class="linenum">4298</span></a>      if (<a class="function" onClick="logFunction('isguestuser')" href="../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>()) {
<a name="l4299"><span class="linenum">4299</span></a>  <span class="comment">        // No need to continue when user is THE guest.</span>
<a name="l4300"><span class="linenum">4300</span></a>          return <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>;
<a name="l4301"><span class="linenum">4301</span></a>      }
<a name="l4302"><span class="linenum">4302</span></a>  
<a name="l4303"><span class="linenum">4303</span></a>      if (<a class="constant" onClick="logConstant('CLI_SCRIPT')" href="../_constants/CLI_SCRIPT.html" onMouseOver="constPopup(event,'CLI_SCRIPT')">CLI_SCRIPT</a>) {
<a name="l4304"><span class="linenum">4304</span></a>  <span class="comment">        // We can redirect to password change URL only in browser.</span>
<a name="l4305"><span class="linenum">4305</span></a>          return <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>;
<a name="l4306"><span class="linenum">4306</span></a>      }
<a name="l4307"><span class="linenum">4307</span></a>  
<a name="l4308"><span class="linenum">4308</span></a>  <span class="comment">    // Select password change url.</span>
<a name="l4309"><span class="linenum">4309</span></a>      <a class="var it4006" onMouseOver="hilite(4006)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a> = <a class="function" onClick="logFunction('get_auth_plugin')" href="../_functions/get_auth_plugin.html" onMouseOver="funcPopup(event,'get_auth_plugin')">get_auth_plugin</a>(<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('auth')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>);
<a name="l4310"><span class="linenum">4310</span></a>  
<a name="l4311"><span class="linenum">4311</span></a>  <span class="comment">    // Check whether the user should be changing password.</span>
<a name="l4312"><span class="linenum">4312</span></a>      if (<a class="function" onClick="logFunction('get_user_preferences')" href="../_functions/get_user_preferences.html" onMouseOver="funcPopup(event,'get_user_preferences')">get_user_preferences</a>('auth_forcepasswordchange', false)) {
<a name="l4313"><span class="linenum">4313</span></a>          if (<a class="var it4006" onMouseOver="hilite(4006)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a>-&gt;<a class="function" onClick="logFunction('can_change_password')" href="../_functions/can_change_password.html" onMouseOver="funcPopup(event,'can_change_password')">can_change_password</a>()) {
<a name="l4314"><span class="linenum">4314</span></a>              if (<a class="var it12943" onMouseOver="hilite(12943)" onMouseOut="lolite()" onClick="logVariable('changeurl')" href="../_variables/changeurl.html">$changeurl</a> = <a class="var it4006" onMouseOver="hilite(4006)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a>-&gt;<a class="function" onClick="logFunction('change_password_url')" href="../_functions/change_password_url.html" onMouseOver="funcPopup(event,'change_password_url')">change_password_url</a>()) {
<a name="l4315"><span class="linenum">4315</span></a>                  <a class="function" onClick="logFunction('redirect')" href="../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<a class="var it12943" onMouseOver="hilite(12943)" onMouseOut="lolite()" onClick="logVariable('changeurl')" href="../_variables/changeurl.html">$changeurl</a>);
<a name="l4316"><span class="linenum">4316</span></a>              } else {
<a name="l4317"><span class="linenum">4317</span></a>                  <a class="function" onClick="logFunction('redirect')" href="../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('httpswwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/httpswwwroot.html">httpswwwroot</a>.'<a class="filename" href="../login/change_password.php.html">/login/change_password.php</a>');
<a name="l4318"><span class="linenum">4318</span></a>              }
<a name="l4319"><span class="linenum">4319</span></a>          } else {
<a name="l4320"><span class="linenum">4320</span></a>              <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('nopasswordchangeforced', 'auth');
<a name="l4321"><span class="linenum">4321</span></a>          }
<a name="l4322"><span class="linenum">4322</span></a>      }
<a name="l4323"><span class="linenum">4323</span></a>      return <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>;
<a name="l4324"><span class="linenum">4324</span></a>  }
<a name="l4325"><span class="linenum">4325</span></a>  
<a name="l4326"><span class="linenum">4326</span></a>  <span class="comment">/**</span>
<a name="l4327"><span class="linenum">4327</span></a>  <span class="comment"> * Check a password hash to see if it was hashed using the legacy hash algorithm (md5).</span>
<a name="l4328"><span class="linenum">4328</span></a>  <span class="comment"> *</span>
<a name="l4329"><span class="linenum">4329</span></a>  <span class="comment"> * @param string $password String to check.</span>
<a name="l4330"><span class="linenum">4330</span></a>  <span class="comment"> * @return boolean True if the $password matches the format of an md5 sum.</span>
<a name="l4331"><span class="linenum">4331</span></a>  <span class="comment"> */</span>
<a name="l4332"><span class="linenum">4332</span></a>  function <a class="function" onClick="logFunction('password_is_legacy_hash')" href="../_functions/password_is_legacy_hash.html" onMouseOver="funcPopup(event,'password_is_legacy_hash')">password_is_legacy_hash</a>(<a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>) {
<a name="l4333"><span class="linenum">4333</span></a>      return (bool) <a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^[0-9a-f]{32}$/', <a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>);
<a name="l4334"><span class="linenum">4334</span></a>  }
<a name="l4335"><span class="linenum">4335</span></a>  
<a name="l4336"><span class="linenum">4336</span></a>  <span class="comment">/**</span>
<a name="l4337"><span class="linenum">4337</span></a>  <span class="comment"> * Compare password against hash stored in user object to determine if it is valid.</span>
<a name="l4338"><span class="linenum">4338</span></a>  <span class="comment"> *</span>
<a name="l4339"><span class="linenum">4339</span></a>  <span class="comment"> * If necessary it also updates the stored hash to the current format.</span>
<a name="l4340"><span class="linenum">4340</span></a>  <span class="comment"> *</span>
<a name="l4341"><span class="linenum">4341</span></a>  <span class="comment"> * @param stdClass $user (Password property may be updated).</span>
<a name="l4342"><span class="linenum">4342</span></a>  <span class="comment"> * @param string $password Plain text password.</span>
<a name="l4343"><span class="linenum">4343</span></a>  <span class="comment"> * @return bool True if password is valid.</span>
<a name="l4344"><span class="linenum">4344</span></a>  <span class="comment"> */</span>
<a name="l4345"><span class="linenum">4345</span></a>  function <a class="function" onClick="logFunction('validate_internal_user_password')" href="../_functions/validate_internal_user_password.html" onMouseOver="funcPopup(event,'validate_internal_user_password')">validate_internal_user_password</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>) {
<a name="l4346"><span class="linenum">4346</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l4347"><span class="linenum">4347</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/libdir.html">libdir</a>.'/password_compat/lib/password.php');
<a name="l4348"><span class="linenum">4348</span></a>  
<a name="l4349"><span class="linenum">4349</span></a>      if (<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('password')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/password.html">password</a> === <a class="constant" onClick="logConstant('AUTH_PASSWORD_NOT_CACHED')" href="../_constants/AUTH_PASSWORD_NOT_CACHED.html" onMouseOver="constPopup(event,'AUTH_PASSWORD_NOT_CACHED')">AUTH_PASSWORD_NOT_CACHED</a>) {
<a name="l4350"><span class="linenum">4350</span></a>  <span class="comment">        // Internal password is not used at all, it can not validate.</span>
<a name="l4351"><span class="linenum">4351</span></a>          return false;
<a name="l4352"><span class="linenum">4352</span></a>      }
<a name="l4353"><span class="linenum">4353</span></a>  
<a name="l4354"><span class="linenum">4354</span></a>  <span class="comment">    // If hash isn't a legacy (md5) hash, validate using the library function.</span>
<a name="l4355"><span class="linenum">4355</span></a>      if (!<a class="function" onClick="logFunction('password_is_legacy_hash')" href="../_functions/password_is_legacy_hash.html" onMouseOver="funcPopup(event,'password_is_legacy_hash')">password_is_legacy_hash</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('password')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/password.html">password</a>)) {
<a name="l4356"><span class="linenum">4356</span></a>          return <a class="function" onClick="logFunction('password_verify')" href="../_functions/password_verify.html" onMouseOver="funcPopup(event,'password_verify')">password_verify</a>(<a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('password')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/password.html">password</a>);
<a name="l4357"><span class="linenum">4357</span></a>      }
<a name="l4358"><span class="linenum">4358</span></a>  
<a name="l4359"><span class="linenum">4359</span></a>  <span class="comment">    // Otherwise we need to check for a legacy (md5) hash instead. If the hash</span>
<a name="l4360"><span class="linenum">4360</span></a>  <span class="comment">    // is valid we can then update it to the new algorithm.</span>
<a name="l4361"><span class="linenum">4361</span></a>  
<a name="l4362"><span class="linenum">4362</span></a>      <a class="var it12986" onMouseOver="hilite(12986)" onMouseOut="lolite()" onClick="logVariable('sitesalt')" href="../_variables/sitesalt.html">$sitesalt</a> = isset(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('passwordsaltmain')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/passwordsaltmain.html">passwordsaltmain</a>) ? <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('passwordsaltmain')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/passwordsaltmain.html">passwordsaltmain</a> : '';
<a name="l4363"><span class="linenum">4363</span></a>      <a class="var it12988" onMouseOver="hilite(12988)" onMouseOut="lolite()" onClick="logVariable('validated')" href="../_variables/validated.html">$validated</a> = false;
<a name="l4364"><span class="linenum">4364</span></a>  
<a name="l4365"><span class="linenum">4365</span></a>      if (<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('password')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/password.html">password</a> === md5(<a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>.<a class="var it12986" onMouseOver="hilite(12986)" onMouseOut="lolite()" onClick="logVariable('sitesalt')" href="../_variables/sitesalt.html">$sitesalt</a>)
<a name="l4366"><span class="linenum">4366</span></a>              or <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('password')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/password.html">password</a> === md5(<a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>)
<a name="l4367"><span class="linenum">4367</span></a>              or <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('password')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/password.html">password</a> === md5(<a class="phpfunction" onClick="logFunction('addslashes')" href="../_functions/addslashes.html" onMouseOver="phpfuncPopup(event,'addslashes')">addslashes</a>(<a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>).<a class="var it12986" onMouseOver="hilite(12986)" onMouseOut="lolite()" onClick="logVariable('sitesalt')" href="../_variables/sitesalt.html">$sitesalt</a>)
<a name="l4368"><span class="linenum">4368</span></a>              or <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('password')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/password.html">password</a> === md5(<a class="phpfunction" onClick="logFunction('addslashes')" href="../_functions/addslashes.html" onMouseOver="phpfuncPopup(event,'addslashes')">addslashes</a>(<a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>))) {
<a name="l4369"><span class="linenum">4369</span></a>  <span class="comment">        // Note: we are intentionally using the addslashes() here because we</span>
<a name="l4370"><span class="linenum">4370</span></a>  <span class="comment">        //       need to accept old password hashes of passwords with magic quotes.</span>
<a name="l4371"><span class="linenum">4371</span></a>          <a class="var it12988" onMouseOver="hilite(12988)" onMouseOut="lolite()" onClick="logVariable('validated')" href="../_variables/validated.html">$validated</a> = true;
<a name="l4372"><span class="linenum">4372</span></a>  
<a name="l4373"><span class="linenum">4373</span></a>      } else {
<a name="l4374"><span class="linenum">4374</span></a>          for (<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>=1; <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>&lt;=20; <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>++) { // 20 alternative salts should be enough, right?
<a name="l4375"><span class="linenum">4375</span></a>              <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('alt')" href="../_variables/alt.html">$alt</a> = 'passwordsaltalt'.<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>;
<a name="l4376"><span class="linenum">4376</span></a>              if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('alt')" href="../_variables/alt.html">$alt</a>)) {
<a name="l4377"><span class="linenum">4377</span></a>                  if (<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('password')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/password.html">password</a> === md5(<a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>.<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('alt')" href="../_variables/alt.html">$alt</a>) or <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('password')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/password.html">password</a> === md5(<a class="phpfunction" onClick="logFunction('addslashes')" href="../_functions/addslashes.html" onMouseOver="phpfuncPopup(event,'addslashes')">addslashes</a>(<a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>).<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('alt')" href="../_variables/alt.html">$alt</a>)) {
<a name="l4378"><span class="linenum">4378</span></a>                      <a class="var it12988" onMouseOver="hilite(12988)" onMouseOut="lolite()" onClick="logVariable('validated')" href="../_variables/validated.html">$validated</a> = true;
<a name="l4379"><span class="linenum">4379</span></a>                      break;
<a name="l4380"><span class="linenum">4380</span></a>                  }
<a name="l4381"><span class="linenum">4381</span></a>              }
<a name="l4382"><span class="linenum">4382</span></a>          }
<a name="l4383"><span class="linenum">4383</span></a>      }
<a name="l4384"><span class="linenum">4384</span></a>  
<a name="l4385"><span class="linenum">4385</span></a>      if (<a class="var it12988" onMouseOver="hilite(12988)" onMouseOut="lolite()" onClick="logVariable('validated')" href="../_variables/validated.html">$validated</a>) {
<a name="l4386"><span class="linenum">4386</span></a>  <span class="comment">        // If the password matches the existing md5 hash, update to the</span>
<a name="l4387"><span class="linenum">4387</span></a>  <span class="comment">        // current hash algorithm while we have access to the user's password.</span>
<a name="l4388"><span class="linenum">4388</span></a>          <a class="function" onClick="logFunction('update_internal_user_password')" href="../_functions/update_internal_user_password.html" onMouseOver="funcPopup(event,'update_internal_user_password')">update_internal_user_password</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>);
<a name="l4389"><span class="linenum">4389</span></a>      }
<a name="l4390"><span class="linenum">4390</span></a>  
<a name="l4391"><span class="linenum">4391</span></a>      return <a class="var it12988" onMouseOver="hilite(12988)" onMouseOut="lolite()" onClick="logVariable('validated')" href="../_variables/validated.html">$validated</a>;
<a name="l4392"><span class="linenum">4392</span></a>  }
<a name="l4393"><span class="linenum">4393</span></a>  
<a name="l4394"><span class="linenum">4394</span></a>  <span class="comment">/**</span>
<a name="l4395"><span class="linenum">4395</span></a>  <span class="comment"> * Calculate hash for a plain text password.</span>
<a name="l4396"><span class="linenum">4396</span></a>  <span class="comment"> *</span>
<a name="l4397"><span class="linenum">4397</span></a>  <span class="comment"> * @param string $password Plain text password to be hashed.</span>
<a name="l4398"><span class="linenum">4398</span></a>  <span class="comment"> * @param bool $fasthash If true, use a low cost factor when generating the hash</span>
<a name="l4399"><span class="linenum">4399</span></a>  <span class="comment"> *                       This is much faster to generate but makes the hash</span>
<a name="l4400"><span class="linenum">4400</span></a>  <span class="comment"> *                       less secure. It is used when lots of hashes need to</span>
<a name="l4401"><span class="linenum">4401</span></a>  <span class="comment"> *                       be generated quickly.</span>
<a name="l4402"><span class="linenum">4402</span></a>  <span class="comment"> * @return string The hashed password.</span>
<a name="l4403"><span class="linenum">4403</span></a>  <span class="comment"> *</span>
<a name="l4404"><span class="linenum">4404</span></a>  <span class="comment"> * @throws moodle_exception If a problem occurs while generating the hash.</span>
<a name="l4405"><span class="linenum">4405</span></a>  <span class="comment"> */</span>
<a name="l4406"><span class="linenum">4406</span></a>  function <a class="function" onClick="logFunction('hash_internal_user_password')" href="../_functions/hash_internal_user_password.html" onMouseOver="funcPopup(event,'hash_internal_user_password')">hash_internal_user_password</a>(<a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>, <a class="var it10742" onMouseOver="hilite(10742)" onMouseOut="lolite()" onClick="logVariable('fasthash')" href="../_variables/fasthash.html">$fasthash</a> = false) {
<a name="l4407"><span class="linenum">4407</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l4408"><span class="linenum">4408</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/libdir.html">libdir</a>.'/password_compat/lib/password.php');
<a name="l4409"><span class="linenum">4409</span></a>  
<a name="l4410"><span class="linenum">4410</span></a>  <span class="comment">    // Set the cost factor to 4 for fast hashing, otherwise use default cost.</span>
<a name="l4411"><span class="linenum">4411</span></a>      <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../_variables/options.html">$options</a> = (<a class="var it10742" onMouseOver="hilite(10742)" onMouseOut="lolite()" onClick="logVariable('fasthash')" href="../_variables/fasthash.html">$fasthash</a>) ? array('cost' =&gt; 4) : array();
<a name="l4412"><span class="linenum">4412</span></a>  
<a name="l4413"><span class="linenum">4413</span></a>      <a class="var it12989" onMouseOver="hilite(12989)" onMouseOut="lolite()" onClick="logVariable('generatedhash')" href="../_variables/generatedhash.html">$generatedhash</a> = <a class="function" onClick="logFunction('password_hash')" href="../_functions/password_hash.html" onMouseOver="funcPopup(event,'password_hash')">password_hash</a>(<a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>, <a class="constant" onClick="logConstant('PASSWORD_DEFAULT')" href="../_constants/PASSWORD_DEFAULT.html" onMouseOver="constPopup(event,'PASSWORD_DEFAULT')">PASSWORD_DEFAULT</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../_variables/options.html">$options</a>);
<a name="l4414"><span class="linenum">4414</span></a>  
<a name="l4415"><span class="linenum">4415</span></a>      if (<a class="var it12989" onMouseOver="hilite(12989)" onMouseOut="lolite()" onClick="logVariable('generatedhash')" href="../_variables/generatedhash.html">$generatedhash</a> === false || <a class="var it12989" onMouseOver="hilite(12989)" onMouseOut="lolite()" onClick="logVariable('generatedhash')" href="../_variables/generatedhash.html">$generatedhash</a> === null) {
<a name="l4416"><span class="linenum">4416</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('Failed to generate password hash.');
<a name="l4417"><span class="linenum">4417</span></a>      }
<a name="l4418"><span class="linenum">4418</span></a>  
<a name="l4419"><span class="linenum">4419</span></a>      return <a class="var it12989" onMouseOver="hilite(12989)" onMouseOut="lolite()" onClick="logVariable('generatedhash')" href="../_variables/generatedhash.html">$generatedhash</a>;
<a name="l4420"><span class="linenum">4420</span></a>  }
<a name="l4421"><span class="linenum">4421</span></a>  
<a name="l4422"><span class="linenum">4422</span></a>  <span class="comment">/**</span>
<a name="l4423"><span class="linenum">4423</span></a>  <span class="comment"> * Update password hash in user object (if necessary).</span>
<a name="l4424"><span class="linenum">4424</span></a>  <span class="comment"> *</span>
<a name="l4425"><span class="linenum">4425</span></a>  <span class="comment"> * The password is updated if:</span>
<a name="l4426"><span class="linenum">4426</span></a>  <span class="comment"> * 1. The password has changed (the hash of $user-&gt;password is different</span>
<a name="l4427"><span class="linenum">4427</span></a>  <span class="comment"> *    to the hash of $password).</span>
<a name="l4428"><span class="linenum">4428</span></a>  <span class="comment"> * 2. The existing hash is using an out-of-date algorithm (or the legacy</span>
<a name="l4429"><span class="linenum">4429</span></a>  <span class="comment"> *    md5 algorithm).</span>
<a name="l4430"><span class="linenum">4430</span></a>  <span class="comment"> *</span>
<a name="l4431"><span class="linenum">4431</span></a>  <span class="comment"> * Updating the password will modify the $user object and the database</span>
<a name="l4432"><span class="linenum">4432</span></a>  <span class="comment"> * record to use the current hashing algorithm.</span>
<a name="l4433"><span class="linenum">4433</span></a>  <span class="comment"> *</span>
<a name="l4434"><span class="linenum">4434</span></a>  <span class="comment"> * @param stdClass $user User object (password property may be updated).</span>
<a name="l4435"><span class="linenum">4435</span></a>  <span class="comment"> * @param string $password Plain text password.</span>
<a name="l4436"><span class="linenum">4436</span></a>  <span class="comment"> * @param bool $fasthash If true, use a low cost factor when generating the hash</span>
<a name="l4437"><span class="linenum">4437</span></a>  <span class="comment"> *                       This is much faster to generate but makes the hash</span>
<a name="l4438"><span class="linenum">4438</span></a>  <span class="comment"> *                       less secure. It is used when lots of hashes need to</span>
<a name="l4439"><span class="linenum">4439</span></a>  <span class="comment"> *                       be generated quickly.</span>
<a name="l4440"><span class="linenum">4440</span></a>  <span class="comment"> * @return bool Always returns true.</span>
<a name="l4441"><span class="linenum">4441</span></a>  <span class="comment"> */</span>
<a name="l4442"><span class="linenum">4442</span></a>  function <a class="function" onClick="logFunction('update_internal_user_password')" href="../_functions/update_internal_user_password.html" onMouseOver="funcPopup(event,'update_internal_user_password')">update_internal_user_password</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>, <a class="var it10742" onMouseOver="hilite(10742)" onMouseOut="lolite()" onClick="logVariable('fasthash')" href="../_variables/fasthash.html">$fasthash</a> = false) {
<a name="l4443"><span class="linenum">4443</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l4444"><span class="linenum">4444</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/libdir.html">libdir</a>.'/password_compat/lib/password.php');
<a name="l4445"><span class="linenum">4445</span></a>  
<a name="l4446"><span class="linenum">4446</span></a>  <span class="comment">    // Figure out what the hashed password should be.</span>
<a name="l4447"><span class="linenum">4447</span></a>      if (!isset(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>)) {
<a name="l4448"><span class="linenum">4448</span></a>          <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('User record in <a class="function" onClick="logFunction('update_internal_user_password')" href="../_functions/update_internal_user_password.html" onMouseOver="funcPopup(event,'update_internal_user_password')">update_internal_user_password</a>() must include field auth',
<a name="l4449"><span class="linenum">4449</span></a>                  <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l4450"><span class="linenum">4450</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_field')" href="../_functions/get_field.html" onMouseOver="funcPopup(event,'get_field')">get_field</a>('user', 'auth', array('id' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l4451"><span class="linenum">4451</span></a>      }
<a name="l4452"><span class="linenum">4452</span></a>      <a class="var it4020" onMouseOver="hilite(4020)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../_variables/authplugin.html">$authplugin</a> = <a class="function" onClick="logFunction('get_auth_plugin')" href="../_functions/get_auth_plugin.html" onMouseOver="funcPopup(event,'get_auth_plugin')">get_auth_plugin</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>);
<a name="l4453"><span class="linenum">4453</span></a>      if (<a class="var it4020" onMouseOver="hilite(4020)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../_variables/authplugin.html">$authplugin</a>-&gt;<a class="function" onClick="logFunction('prevent_local_passwords')" href="../_functions/prevent_local_passwords.html" onMouseOver="funcPopup(event,'prevent_local_passwords')">prevent_local_passwords</a>()) {
<a name="l4454"><span class="linenum">4454</span></a>          <a class="var it12990" onMouseOver="hilite(12990)" onMouseOut="lolite()" onClick="logVariable('hashedpassword')" href="../_variables/hashedpassword.html">$hashedpassword</a> = <a class="constant" onClick="logConstant('AUTH_PASSWORD_NOT_CACHED')" href="../_constants/AUTH_PASSWORD_NOT_CACHED.html" onMouseOver="constPopup(event,'AUTH_PASSWORD_NOT_CACHED')">AUTH_PASSWORD_NOT_CACHED</a>;
<a name="l4455"><span class="linenum">4455</span></a>      } else {
<a name="l4456"><span class="linenum">4456</span></a>          <a class="var it12990" onMouseOver="hilite(12990)" onMouseOut="lolite()" onClick="logVariable('hashedpassword')" href="../_variables/hashedpassword.html">$hashedpassword</a> = <a class="function" onClick="logFunction('hash_internal_user_password')" href="../_functions/hash_internal_user_password.html" onMouseOver="funcPopup(event,'hash_internal_user_password')">hash_internal_user_password</a>(<a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>, <a class="var it10742" onMouseOver="hilite(10742)" onMouseOut="lolite()" onClick="logVariable('fasthash')" href="../_variables/fasthash.html">$fasthash</a>);
<a name="l4457"><span class="linenum">4457</span></a>      }
<a name="l4458"><span class="linenum">4458</span></a>  
<a name="l4459"><span class="linenum">4459</span></a>      <a class="var it12991" onMouseOver="hilite(12991)" onMouseOut="lolite()" onClick="logVariable('algorithmchanged')" href="../_variables/algorithmchanged.html">$algorithmchanged</a> = false;
<a name="l4460"><span class="linenum">4460</span></a>  
<a name="l4461"><span class="linenum">4461</span></a>      if (<a class="var it12990" onMouseOver="hilite(12990)" onMouseOut="lolite()" onClick="logVariable('hashedpassword')" href="../_variables/hashedpassword.html">$hashedpassword</a> === <a class="constant" onClick="logConstant('AUTH_PASSWORD_NOT_CACHED')" href="../_constants/AUTH_PASSWORD_NOT_CACHED.html" onMouseOver="constPopup(event,'AUTH_PASSWORD_NOT_CACHED')">AUTH_PASSWORD_NOT_CACHED</a>) {
<a name="l4462"><span class="linenum">4462</span></a>  <span class="comment">        // Password is not cached, update it if not set to AUTH_PASSWORD_NOT_CACHED.</span>
<a name="l4463"><span class="linenum">4463</span></a>          <a class="var it12992" onMouseOver="hilite(12992)" onMouseOut="lolite()" onClick="logVariable('passwordchanged')" href="../_variables/passwordchanged.html">$passwordchanged</a> = (<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('password')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/password.html">password</a> !== <a class="var it12990" onMouseOver="hilite(12990)" onMouseOut="lolite()" onClick="logVariable('hashedpassword')" href="../_variables/hashedpassword.html">$hashedpassword</a>);
<a name="l4464"><span class="linenum">4464</span></a>  
<a name="l4465"><span class="linenum">4465</span></a>      } else if (isset(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('password')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/password.html">password</a>)) {
<a name="l4466"><span class="linenum">4466</span></a>  <span class="comment">        // If verification fails then it means the password has changed.</span>
<a name="l4467"><span class="linenum">4467</span></a>          <a class="var it12992" onMouseOver="hilite(12992)" onMouseOut="lolite()" onClick="logVariable('passwordchanged')" href="../_variables/passwordchanged.html">$passwordchanged</a> = !<a class="function" onClick="logFunction('password_verify')" href="../_functions/password_verify.html" onMouseOver="funcPopup(event,'password_verify')">password_verify</a>(<a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('password')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/password.html">password</a>);
<a name="l4468"><span class="linenum">4468</span></a>          <a class="var it12991" onMouseOver="hilite(12991)" onMouseOut="lolite()" onClick="logVariable('algorithmchanged')" href="../_variables/algorithmchanged.html">$algorithmchanged</a> = <a class="function" onClick="logFunction('password_needs_rehash')" href="../_functions/password_needs_rehash.html" onMouseOver="funcPopup(event,'password_needs_rehash')">password_needs_rehash</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('password')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/password.html">password</a>, <a class="constant" onClick="logConstant('PASSWORD_DEFAULT')" href="../_constants/PASSWORD_DEFAULT.html" onMouseOver="constPopup(event,'PASSWORD_DEFAULT')">PASSWORD_DEFAULT</a>);
<a name="l4469"><span class="linenum">4469</span></a>      } else {
<a name="l4470"><span class="linenum">4470</span></a>  <span class="comment">        // While creating new user, password in unset in $user object, to avoid</span>
<a name="l4471"><span class="linenum">4471</span></a>  <span class="comment">        // saving it with user_create()</span>
<a name="l4472"><span class="linenum">4472</span></a>          <a class="var it12992" onMouseOver="hilite(12992)" onMouseOut="lolite()" onClick="logVariable('passwordchanged')" href="../_variables/passwordchanged.html">$passwordchanged</a> = true;
<a name="l4473"><span class="linenum">4473</span></a>      }
<a name="l4474"><span class="linenum">4474</span></a>  
<a name="l4475"><span class="linenum">4475</span></a>      if (<a class="var it12992" onMouseOver="hilite(12992)" onMouseOut="lolite()" onClick="logVariable('passwordchanged')" href="../_variables/passwordchanged.html">$passwordchanged</a> || <a class="var it12991" onMouseOver="hilite(12991)" onMouseOut="lolite()" onClick="logVariable('algorithmchanged')" href="../_variables/algorithmchanged.html">$algorithmchanged</a>) {
<a name="l4476"><span class="linenum">4476</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('user', 'password',  <a class="var it12990" onMouseOver="hilite(12990)" onMouseOut="lolite()" onClick="logVariable('hashedpassword')" href="../_variables/hashedpassword.html">$hashedpassword</a>, array('id' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l4477"><span class="linenum">4477</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('password')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/password.html">password</a> = <a class="var it12990" onMouseOver="hilite(12990)" onMouseOut="lolite()" onClick="logVariable('hashedpassword')" href="../_variables/hashedpassword.html">$hashedpassword</a>;
<a name="l4478"><span class="linenum">4478</span></a>  
<a name="l4479"><span class="linenum">4479</span></a>  <span class="comment">        // Trigger event.</span>
<a name="l4480"><span class="linenum">4480</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user', array('id' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l4481"><span class="linenum">4481</span></a>          \core\event\<a class="class" onClick="logClass('user_password_updated')" href="../_classes/user_password_updated.html" onMouseOver="classPopup(event,'user_password_updated')">user_password_updated</a>::<a class="function" onClick="logFunction('create_from_user')" href="../_functions/create_from_user.html" onMouseOver="funcPopup(event,'create_from_user')">create_from_user</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)-&gt;<a class="function" onClick="logFunction('trigger')" href="../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l4482"><span class="linenum">4482</span></a>      }
<a name="l4483"><span class="linenum">4483</span></a>  
<a name="l4484"><span class="linenum">4484</span></a>      return true;
<a name="l4485"><span class="linenum">4485</span></a>  }
<a name="l4486"><span class="linenum">4486</span></a>  
<a name="l4487"><span class="linenum">4487</span></a>  <span class="comment">/**</span>
<a name="l4488"><span class="linenum">4488</span></a>  <span class="comment"> * Get a complete user record, which includes all the info in the user record.</span>
<a name="l4489"><span class="linenum">4489</span></a>  <span class="comment"> *</span>
<a name="l4490"><span class="linenum">4490</span></a>  <span class="comment"> * Intended for setting as $USER session variable</span>
<a name="l4491"><span class="linenum">4491</span></a>  <span class="comment"> *</span>
<a name="l4492"><span class="linenum">4492</span></a>  <span class="comment"> * @param string $field The user field to be checked for a given value.</span>
<a name="l4493"><span class="linenum">4493</span></a>  <span class="comment"> * @param string $value The value to match for $field.</span>
<a name="l4494"><span class="linenum">4494</span></a>  <span class="comment"> * @param int $mnethostid</span>
<a name="l4495"><span class="linenum">4495</span></a>  <span class="comment"> * @return mixed False, or A {@link $USER} object.</span>
<a name="l4496"><span class="linenum">4496</span></a>  <span class="comment"> */</span>
<a name="l4497"><span class="linenum">4497</span></a>  function <a class="function" onClick="logFunction('get_complete_user_data')" href="../_functions/get_complete_user_data.html" onMouseOver="funcPopup(event,'get_complete_user_data')">get_complete_user_data</a>(<a class="var it1464" onMouseOver="hilite(1464)" onMouseOut="lolite()" onClick="logVariable('field')" href="../_variables/field.html">$field</a>, <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>, <a class="var it523" onMouseOver="hilite(523)" onMouseOut="lolite()" onClick="logVariable('mnethostid')" href="../_variables/mnethostid.html">$mnethostid</a> = null) {
<a name="l4498"><span class="linenum">4498</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l4499"><span class="linenum">4499</span></a>  
<a name="l4500"><span class="linenum">4500</span></a>      if (!<a class="var it1464" onMouseOver="hilite(1464)" onMouseOut="lolite()" onClick="logVariable('field')" href="../_variables/field.html">$field</a> || !<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) {
<a name="l4501"><span class="linenum">4501</span></a>          return false;
<a name="l4502"><span class="linenum">4502</span></a>      }
<a name="l4503"><span class="linenum">4503</span></a>  
<a name="l4504"><span class="linenum">4504</span></a>  <span class="comment">    // Build the WHERE clause for an SQL query.</span>
<a name="l4505"><span class="linenum">4505</span></a>      <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array('fieldval' =&gt; <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>);
<a name="l4506"><span class="linenum">4506</span></a>      <a class="var it10317" onMouseOver="hilite(10317)" onMouseOut="lolite()" onClick="logVariable('constraints')" href="../_variables/constraints.html">$constraints</a> = &quot;<a class="var it1464" onMouseOver="hilite(1464)" onMouseOut="lolite()" onClick="logVariable('field')" href="../_variables/field.html">$field</a> = :fieldval AND deleted &lt;&gt; 1&quot;;
<a name="l4507"><span class="linenum">4507</span></a>  
<a name="l4508"><span class="linenum">4508</span></a>  <span class="comment">    // If we are loading user data based on anything other than id,</span>
<a name="l4509"><span class="linenum">4509</span></a>  <span class="comment">    // we must also restrict our search based on mnet host.</span>
<a name="l4510"><span class="linenum">4510</span></a>      if (<a class="var it1464" onMouseOver="hilite(1464)" onMouseOut="lolite()" onClick="logVariable('field')" href="../_variables/field.html">$field</a> != 'id') {
<a name="l4511"><span class="linenum">4511</span></a>          if (empty(<a class="var it523" onMouseOver="hilite(523)" onMouseOut="lolite()" onClick="logVariable('mnethostid')" href="../_variables/mnethostid.html">$mnethostid</a>)) {
<a name="l4512"><span class="linenum">4512</span></a>  <span class="comment">            // If empty, we restrict to local users.</span>
<a name="l4513"><span class="linenum">4513</span></a>              <a class="var it523" onMouseOver="hilite(523)" onMouseOut="lolite()" onClick="logVariable('mnethostid')" href="../_variables/mnethostid.html">$mnethostid</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/mnet_localhost_id.html">mnet_localhost_id</a>;
<a name="l4514"><span class="linenum">4514</span></a>          }
<a name="l4515"><span class="linenum">4515</span></a>      }
<a name="l4516"><span class="linenum">4516</span></a>      if (!empty(<a class="var it523" onMouseOver="hilite(523)" onMouseOut="lolite()" onClick="logVariable('mnethostid')" href="../_variables/mnethostid.html">$mnethostid</a>)) {
<a name="l4517"><span class="linenum">4517</span></a>          <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['mnethostid'] = <a class="var it523" onMouseOver="hilite(523)" onMouseOut="lolite()" onClick="logVariable('mnethostid')" href="../_variables/mnethostid.html">$mnethostid</a>;
<a name="l4518"><span class="linenum">4518</span></a>          <a class="var it10317" onMouseOver="hilite(10317)" onMouseOut="lolite()" onClick="logVariable('constraints')" href="../_variables/constraints.html">$constraints</a> .= &quot; AND mnethostid = :mnethostid&quot;;
<a name="l4519"><span class="linenum">4519</span></a>      }
<a name="l4520"><span class="linenum">4520</span></a>  
<a name="l4521"><span class="linenum">4521</span></a>  <span class="comment">    // Get all the basic user data.</span>
<a name="l4522"><span class="linenum">4522</span></a>      if (! <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record_select')" href="../_functions/get_record_select.html" onMouseOver="funcPopup(event,'get_record_select')">get_record_select</a>('user', <a class="var it10317" onMouseOver="hilite(10317)" onMouseOut="lolite()" onClick="logVariable('constraints')" href="../_variables/constraints.html">$constraints</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>)) {
<a name="l4523"><span class="linenum">4523</span></a>          return false;
<a name="l4524"><span class="linenum">4524</span></a>      }
<a name="l4525"><span class="linenum">4525</span></a>  
<a name="l4526"><span class="linenum">4526</span></a>  <span class="comment">    // Get various settings and preferences.</span>
<a name="l4527"><span class="linenum">4527</span></a>  
<a name="l4528"><span class="linenum">4528</span></a>  <span class="comment">    // Preload preference cache.</span>
<a name="l4529"><span class="linenum">4529</span></a>      <a class="function" onClick="logFunction('check_user_preferences_loaded')" href="../_functions/check_user_preferences_loaded.html" onMouseOver="funcPopup(event,'check_user_preferences_loaded')">check_user_preferences_loaded</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l4530"><span class="linenum">4530</span></a>  
<a name="l4531"><span class="linenum">4531</span></a>  <span class="comment">    // Load course enrolment related stuff.</span>
<a name="l4532"><span class="linenum">4532</span></a>      <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('lastcourseaccess')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/lastcourseaccess.html">lastcourseaccess</a>    = array(); <span class="comment">// During last session.</span>
<a name="l4533"><span class="linenum">4533</span></a>      <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('currentcourseaccess')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/currentcourseaccess.html">currentcourseaccess</a> = array(); <span class="comment">// During current session.</span>
<a name="l4534"><span class="linenum">4534</span></a>      if (<a class="var it12994" onMouseOver="hilite(12994)" onMouseOut="lolite()" onClick="logVariable('lastaccesses')" href="../_variables/lastaccesses.html">$lastaccesses</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('user_lastaccess', array('userid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>))) {
<a name="l4535"><span class="linenum">4535</span></a>          foreach (<a class="var it12994" onMouseOver="hilite(12994)" onMouseOut="lolite()" onClick="logVariable('lastaccesses')" href="../_variables/lastaccesses.html">$lastaccesses</a> as <a class="var it7860" onMouseOver="hilite(7860)" onMouseOut="lolite()" onClick="logVariable('lastaccess')" href="../_variables/lastaccess.html">$lastaccess</a>) {
<a name="l4536"><span class="linenum">4536</span></a>              <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('lastcourseaccess')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/lastcourseaccess.html">lastcourseaccess</a>[<a class="var it7860" onMouseOver="hilite(7860)" onMouseOut="lolite()" onClick="logVariable('lastaccess')" href="../_variables/lastaccess.html">$lastaccess</a>-&gt;<a onClick="logVariable('courseid')" class="var it41072" onMouseOver="hilite(41072)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>] = <a class="var it7860" onMouseOver="hilite(7860)" onMouseOut="lolite()" onClick="logVariable('lastaccess')" href="../_variables/lastaccess.html">$lastaccess</a>-&gt;<a onClick="logVariable('timeaccess')" class="var it41072" onMouseOver="hilite(41072)" onMouseOut="lolite()" href="../_variables/timeaccess.html">timeaccess</a>;
<a name="l4537"><span class="linenum">4537</span></a>          }
<a name="l4538"><span class="linenum">4538</span></a>      }
<a name="l4539"><span class="linenum">4539</span></a>  
<a name="l4540"><span class="linenum">4540</span></a>      <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../_variables/sql.html">$sql</a> = &quot;SELECT g.id, g.courseid
<a name="l4541"><span class="linenum">4541</span></a>                FROM {groups} g, {groups_members} gm
<a name="l4542"><span class="linenum">4542</span></a>               WHERE gm.groupid=g.id AND gm.userid=?&quot;;
<a name="l4543"><span class="linenum">4543</span></a>  
<a name="l4544"><span class="linenum">4544</span></a>  <span class="comment">    // This is a special hack to speedup calendar display.</span>
<a name="l4545"><span class="linenum">4545</span></a>      <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('groupmember')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/groupmember.html">groupmember</a> = array();
<a name="l4546"><span class="linenum">4546</span></a>      if (!<a class="function" onClick="logFunction('isguestuser')" href="../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l4547"><span class="linenum">4547</span></a>          if (<a class="var it5191" onMouseOver="hilite(5191)" onMouseOut="lolite()" onClick="logVariable('groups')" href="../_variables/groups.html">$groups</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../_variables/sql.html">$sql</a>, array(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>))) {
<a name="l4548"><span class="linenum">4548</span></a>              foreach (<a class="var it5191" onMouseOver="hilite(5191)" onMouseOut="lolite()" onClick="logVariable('groups')" href="../_variables/groups.html">$groups</a> as <a class="var it4136" onMouseOver="hilite(4136)" onMouseOut="lolite()" onClick="logVariable('group')" href="../_variables/group.html">$group</a>) {
<a name="l4549"><span class="linenum">4549</span></a>                  if (!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it4136" onMouseOver="hilite(4136)" onMouseOut="lolite()" onClick="logVariable('group')" href="../_variables/group.html">$group</a>-&gt;<a onClick="logVariable('courseid')" class="var it39663" onMouseOver="hilite(39663)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('groupmember')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/groupmember.html">groupmember</a>)) {
<a name="l4550"><span class="linenum">4550</span></a>                      <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('groupmember')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/groupmember.html">groupmember</a>[<a class="var it4136" onMouseOver="hilite(4136)" onMouseOut="lolite()" onClick="logVariable('group')" href="../_variables/group.html">$group</a>-&gt;<a onClick="logVariable('courseid')" class="var it39663" onMouseOver="hilite(39663)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>] = array();
<a name="l4551"><span class="linenum">4551</span></a>                  }
<a name="l4552"><span class="linenum">4552</span></a>                  <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('groupmember')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/groupmember.html">groupmember</a>[<a class="var it4136" onMouseOver="hilite(4136)" onMouseOut="lolite()" onClick="logVariable('group')" href="../_variables/group.html">$group</a>-&gt;<a onClick="logVariable('courseid')" class="var it39663" onMouseOver="hilite(39663)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>][<a class="var it4136" onMouseOver="hilite(4136)" onMouseOut="lolite()" onClick="logVariable('group')" href="../_variables/group.html">$group</a>-&gt;<a onClick="logVariable('id')" class="var it39663" onMouseOver="hilite(39663)" onMouseOut="lolite()" href="../_variables/id.html">id</a>] = <a class="var it4136" onMouseOver="hilite(4136)" onMouseOut="lolite()" onClick="logVariable('group')" href="../_variables/group.html">$group</a>-&gt;<a onClick="logVariable('id')" class="var it39663" onMouseOver="hilite(39663)" onMouseOut="lolite()" href="../_variables/id.html">id</a>;
<a name="l4553"><span class="linenum">4553</span></a>              }
<a name="l4554"><span class="linenum">4554</span></a>          }
<a name="l4555"><span class="linenum">4555</span></a>      }
<a name="l4556"><span class="linenum">4556</span></a>  
<a name="l4557"><span class="linenum">4557</span></a>  <span class="comment">    // Add the custom profile fields to the user record.</span>
<a name="l4558"><span class="linenum">4558</span></a>      <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('profile')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/profile.html">profile</a> = array();
<a name="l4559"><span class="linenum">4559</span></a>      if (!<a class="function" onClick="logFunction('isguestuser')" href="../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l4560"><span class="linenum">4560</span></a>          require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../user/profile/lib.php.html">/user/profile/lib.php</a>');
<a name="l4561"><span class="linenum">4561</span></a>          <a class="function" onClick="logFunction('profile_load_custom_fields')" href="../_functions/profile_load_custom_fields.html" onMouseOver="funcPopup(event,'profile_load_custom_fields')">profile_load_custom_fields</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l4562"><span class="linenum">4562</span></a>      }
<a name="l4563"><span class="linenum">4563</span></a>  
<a name="l4564"><span class="linenum">4564</span></a>  <span class="comment">    // Rewrite some variables if necessary.</span>
<a name="l4565"><span class="linenum">4565</span></a>      if (!empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('description')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/description.html">description</a>)) {
<a name="l4566"><span class="linenum">4566</span></a>  <span class="comment">        // No need to cart all of it around.</span>
<a name="l4567"><span class="linenum">4567</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('description')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/description.html">description</a> = true;
<a name="l4568"><span class="linenum">4568</span></a>      }
<a name="l4569"><span class="linenum">4569</span></a>      if (<a class="function" onClick="logFunction('isguestuser')" href="../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l4570"><span class="linenum">4570</span></a>  <span class="comment">        // Guest language always same as site.</span>
<a name="l4571"><span class="linenum">4571</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('lang')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('lang')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>;
<a name="l4572"><span class="linenum">4572</span></a>  <span class="comment">        // Name always in current language.</span>
<a name="l4573"><span class="linenum">4573</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('firstname')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/firstname.html">firstname</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('guestuser');
<a name="l4574"><span class="linenum">4574</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('lastname')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/lastname.html">lastname</a> = ' ';
<a name="l4575"><span class="linenum">4575</span></a>      }
<a name="l4576"><span class="linenum">4576</span></a>  
<a name="l4577"><span class="linenum">4577</span></a>      return <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>;
<a name="l4578"><span class="linenum">4578</span></a>  }
<a name="l4579"><span class="linenum">4579</span></a>  
<a name="l4580"><span class="linenum">4580</span></a>  <span class="comment">/**</span>
<a name="l4581"><span class="linenum">4581</span></a>  <span class="comment"> * Validate a password against the configured password policy</span>
<a name="l4582"><span class="linenum">4582</span></a>  <span class="comment"> *</span>
<a name="l4583"><span class="linenum">4583</span></a>  <span class="comment"> * @param string $password the password to be checked against the password policy</span>
<a name="l4584"><span class="linenum">4584</span></a>  <span class="comment"> * @param string $errmsg the error message to display when the password doesn't comply with the policy.</span>
<a name="l4585"><span class="linenum">4585</span></a>  <span class="comment"> * @return bool true if the password is valid according to the policy. false otherwise.</span>
<a name="l4586"><span class="linenum">4586</span></a>  <span class="comment"> */</span>
<a name="l4587"><span class="linenum">4587</span></a>  function <a class="function" onClick="logFunction('check_password_policy')" href="../_functions/check_password_policy.html" onMouseOver="funcPopup(event,'check_password_policy')">check_password_policy</a>(<a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>, &amp;<a class="var it5000" onMouseOver="hilite(5000)" onMouseOut="lolite()" onClick="logVariable('errmsg')" href="../_variables/errmsg.html">$errmsg</a>) {
<a name="l4588"><span class="linenum">4588</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l4589"><span class="linenum">4589</span></a>  
<a name="l4590"><span class="linenum">4590</span></a>      if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('passwordpolicy')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/passwordpolicy.html">passwordpolicy</a>)) {
<a name="l4591"><span class="linenum">4591</span></a>          return true;
<a name="l4592"><span class="linenum">4592</span></a>      }
<a name="l4593"><span class="linenum">4593</span></a>  
<a name="l4594"><span class="linenum">4594</span></a>      <a class="var it5000" onMouseOver="hilite(5000)" onMouseOut="lolite()" onClick="logVariable('errmsg')" href="../_variables/errmsg.html">$errmsg</a> = '';
<a name="l4595"><span class="linenum">4595</span></a>      if (<a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>) &lt; <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('minpasswordlength')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/minpasswordlength.html">minpasswordlength</a>) {
<a name="l4596"><span class="linenum">4596</span></a>          <a class="var it5000" onMouseOver="hilite(5000)" onMouseOut="lolite()" onClick="logVariable('errmsg')" href="../_variables/errmsg.html">$errmsg</a> .= '&lt;div&gt;'. <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('errorminpasswordlength', 'auth', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('minpasswordlength')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/minpasswordlength.html">minpasswordlength</a>) .'&lt;/div&gt;';
<a name="l4597"><span class="linenum">4597</span></a>  
<a name="l4598"><span class="linenum">4598</span></a>      }
<a name="l4599"><span class="linenum">4599</span></a>      if (<a class="phpfunction" onClick="logFunction('preg_match_all')" href="../_functions/preg_match_all.html" onMouseOver="phpfuncPopup(event,'preg_match_all')">preg_match_all</a>('/[[:digit:]]/u', <a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>, <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>) &lt; <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('minpassworddigits')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/minpassworddigits.html">minpassworddigits</a>) {
<a name="l4600"><span class="linenum">4600</span></a>          <a class="var it5000" onMouseOver="hilite(5000)" onMouseOut="lolite()" onClick="logVariable('errmsg')" href="../_variables/errmsg.html">$errmsg</a> .= '&lt;div&gt;'. <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('errorminpassworddigits', 'auth', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('minpassworddigits')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/minpassworddigits.html">minpassworddigits</a>) .'&lt;/div&gt;';
<a name="l4601"><span class="linenum">4601</span></a>  
<a name="l4602"><span class="linenum">4602</span></a>      }
<a name="l4603"><span class="linenum">4603</span></a>      if (<a class="phpfunction" onClick="logFunction('preg_match_all')" href="../_functions/preg_match_all.html" onMouseOver="phpfuncPopup(event,'preg_match_all')">preg_match_all</a>('/[[:lower:]]/u', <a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>, <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>) &lt; <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('minpasswordlower')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/minpasswordlower.html">minpasswordlower</a>) {
<a name="l4604"><span class="linenum">4604</span></a>          <a class="var it5000" onMouseOver="hilite(5000)" onMouseOut="lolite()" onClick="logVariable('errmsg')" href="../_variables/errmsg.html">$errmsg</a> .= '&lt;div&gt;'. <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('errorminpasswordlower', 'auth', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('minpasswordlower')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/minpasswordlower.html">minpasswordlower</a>) .'&lt;/div&gt;';
<a name="l4605"><span class="linenum">4605</span></a>  
<a name="l4606"><span class="linenum">4606</span></a>      }
<a name="l4607"><span class="linenum">4607</span></a>      if (<a class="phpfunction" onClick="logFunction('preg_match_all')" href="../_functions/preg_match_all.html" onMouseOver="phpfuncPopup(event,'preg_match_all')">preg_match_all</a>('/[[:upper:]]/u', <a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>, <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>) &lt; <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('minpasswordupper')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/minpasswordupper.html">minpasswordupper</a>) {
<a name="l4608"><span class="linenum">4608</span></a>          <a class="var it5000" onMouseOver="hilite(5000)" onMouseOut="lolite()" onClick="logVariable('errmsg')" href="../_variables/errmsg.html">$errmsg</a> .= '&lt;div&gt;'. <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('errorminpasswordupper', 'auth', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('minpasswordupper')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/minpasswordupper.html">minpasswordupper</a>) .'&lt;/div&gt;';
<a name="l4609"><span class="linenum">4609</span></a>  
<a name="l4610"><span class="linenum">4610</span></a>      }
<a name="l4611"><span class="linenum">4611</span></a>      if (<a class="phpfunction" onClick="logFunction('preg_match_all')" href="../_functions/preg_match_all.html" onMouseOver="phpfuncPopup(event,'preg_match_all')">preg_match_all</a>('/[^[:upper:][:lower:][:digit:]]/u', <a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>, <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>) &lt; <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('minpasswordnonalphanum')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/minpasswordnonalphanum.html">minpasswordnonalphanum</a>) {
<a name="l4612"><span class="linenum">4612</span></a>          <a class="var it5000" onMouseOver="hilite(5000)" onMouseOut="lolite()" onClick="logVariable('errmsg')" href="../_variables/errmsg.html">$errmsg</a> .= '&lt;div&gt;'. <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('errorminpasswordnonalphanum', 'auth', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('minpasswordnonalphanum')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/minpasswordnonalphanum.html">minpasswordnonalphanum</a>) .'&lt;/div&gt;';
<a name="l4613"><span class="linenum">4613</span></a>      }
<a name="l4614"><span class="linenum">4614</span></a>      if (!<a class="function" onClick="logFunction('check_consecutive_identical_characters')" href="../_functions/check_consecutive_identical_characters.html" onMouseOver="funcPopup(event,'check_consecutive_identical_characters')">check_consecutive_identical_characters</a>(<a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('maxconsecutiveidentchars')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/maxconsecutiveidentchars.html">maxconsecutiveidentchars</a>)) {
<a name="l4615"><span class="linenum">4615</span></a>          <a class="var it5000" onMouseOver="hilite(5000)" onMouseOut="lolite()" onClick="logVariable('errmsg')" href="../_variables/errmsg.html">$errmsg</a> .= '&lt;div&gt;'. <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('errormaxconsecutiveidentchars', 'auth', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('maxconsecutiveidentchars')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/maxconsecutiveidentchars.html">maxconsecutiveidentchars</a>) .'&lt;/div&gt;';
<a name="l4616"><span class="linenum">4616</span></a>      }
<a name="l4617"><span class="linenum">4617</span></a>  
<a name="l4618"><span class="linenum">4618</span></a>      if (<a class="var it5000" onMouseOver="hilite(5000)" onMouseOut="lolite()" onClick="logVariable('errmsg')" href="../_variables/errmsg.html">$errmsg</a> == '') {
<a name="l4619"><span class="linenum">4619</span></a>          return true;
<a name="l4620"><span class="linenum">4620</span></a>      } else {
<a name="l4621"><span class="linenum">4621</span></a>          return false;
<a name="l4622"><span class="linenum">4622</span></a>      }
<a name="l4623"><span class="linenum">4623</span></a>  }
<a name="l4624"><span class="linenum">4624</span></a>  
<a name="l4625"><span class="linenum">4625</span></a>  
<a name="l4626"><span class="linenum">4626</span></a>  <span class="comment">/**</span>
<a name="l4627"><span class="linenum">4627</span></a>  <span class="comment"> * When logging in, this function is run to set certain preferences for the current SESSION.</span>
<a name="l4628"><span class="linenum">4628</span></a>  <span class="comment"> */</span>
<a name="l4629"><span class="linenum">4629</span></a>  function <a class="function" onClick="logFunction('set_login_session_preferences')" href="../_functions/set_login_session_preferences.html" onMouseOver="funcPopup(event,'set_login_session_preferences')">set_login_session_preferences</a>() {
<a name="l4630"><span class="linenum">4630</span></a>      global <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>;
<a name="l4631"><span class="linenum">4631</span></a>  
<a name="l4632"><span class="linenum">4632</span></a>      <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('justloggedin')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/justloggedin.html">justloggedin</a> = true;
<a name="l4633"><span class="linenum">4633</span></a>  
<a name="l4634"><span class="linenum">4634</span></a>      unset(<a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('lang')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>);
<a name="l4635"><span class="linenum">4635</span></a>      unset(<a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('forcelang')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/forcelang.html">forcelang</a>);
<a name="l4636"><span class="linenum">4636</span></a>      unset(<a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('load_navigation_admin')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/load_navigation_admin.html">load_navigation_admin</a>);
<a name="l4637"><span class="linenum">4637</span></a>  }
<a name="l4638"><span class="linenum">4638</span></a>  
<a name="l4639"><span class="linenum">4639</span></a>  
<a name="l4640"><span class="linenum">4640</span></a>  <span class="comment">/**</span>
<a name="l4641"><span class="linenum">4641</span></a>  <span class="comment"> * Delete a course, including all related data from the database, and any associated files.</span>
<a name="l4642"><span class="linenum">4642</span></a>  <span class="comment"> *</span>
<a name="l4643"><span class="linenum">4643</span></a>  <span class="comment"> * @param mixed $courseorid The id of the course or course object to delete.</span>
<a name="l4644"><span class="linenum">4644</span></a>  <span class="comment"> * @param bool $showfeedback Whether to display notifications of each action the function performs.</span>
<a name="l4645"><span class="linenum">4645</span></a>  <span class="comment"> * @return bool true if all the removals succeeded. false if there were any failures. If this</span>
<a name="l4646"><span class="linenum">4646</span></a>  <span class="comment"> *             method returns false, some of the removals will probably have succeeded, and others</span>
<a name="l4647"><span class="linenum">4647</span></a>  <span class="comment"> *             failed, but you have no way of knowing which.</span>
<a name="l4648"><span class="linenum">4648</span></a>  <span class="comment"> */</span>
<a name="l4649"><span class="linenum">4649</span></a>  function <a class="function" onClick="logFunction('delete_course')" href="../_functions/delete_course.html" onMouseOver="funcPopup(event,'delete_course')">delete_course</a>(<a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>, <a class="var it13004" onMouseOver="hilite(13004)" onMouseOut="lolite()" onClick="logVariable('showfeedback')" href="../_variables/showfeedback.html">$showfeedback</a> = true) {
<a name="l4650"><span class="linenum">4650</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l4651"><span class="linenum">4651</span></a>  
<a name="l4652"><span class="linenum">4652</span></a>      if (<a class="phpfunction" onClick="logFunction('is_object')" href="../_functions/is_object.html" onMouseOver="phpfuncPopup(event,'is_object')">is_object</a>(<a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>)) {
<a name="l4653"><span class="linenum">4653</span></a>          <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a> = <a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>-&gt;<a onClick="logVariable('id')" class="var it41059" onMouseOver="hilite(41059)" onMouseOut="lolite()" href="../_variables/id.html">id</a>;
<a name="l4654"><span class="linenum">4654</span></a>          <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>   = <a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>;
<a name="l4655"><span class="linenum">4655</span></a>      } else {
<a name="l4656"><span class="linenum">4656</span></a>          <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a> = <a class="var it10804" onMouseOver="hilite(10804)" onMouseOut="lolite()" onClick="logVariable('courseorid')" href="../_variables/courseorid.html">$courseorid</a>;
<a name="l4657"><span class="linenum">4657</span></a>          if (!<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('course', array('id' =&gt; <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>))) {
<a name="l4658"><span class="linenum">4658</span></a>              return false;
<a name="l4659"><span class="linenum">4659</span></a>          }
<a name="l4660"><span class="linenum">4660</span></a>      }
<a name="l4661"><span class="linenum">4661</span></a>      <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_course')" href="../_classes/context_course.html" onMouseOver="classPopup(event,'context_course')">context_course</a>::<a class="function" onClick="logFunction('instance')" href="../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>);
<a name="l4662"><span class="linenum">4662</span></a>  
<a name="l4663"><span class="linenum">4663</span></a>  <span class="comment">    // Frontpage course can not be deleted!!</span>
<a name="l4664"><span class="linenum">4664</span></a>      if (<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a> == <a class="constant" onClick="logConstant('SITEID')" href="../_constants/SITEID.html" onMouseOver="constPopup(event,'SITEID')">SITEID</a>) {
<a name="l4665"><span class="linenum">4665</span></a>          return false;
<a name="l4666"><span class="linenum">4666</span></a>      }
<a name="l4667"><span class="linenum">4667</span></a>  
<a name="l4668"><span class="linenum">4668</span></a>  <span class="comment">    // Make the course completely empty.</span>
<a name="l4669"><span class="linenum">4669</span></a>      <a class="function" onClick="logFunction('remove_course_contents')" href="../_functions/remove_course_contents.html" onMouseOver="funcPopup(event,'remove_course_contents')">remove_course_contents</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>, <a class="var it13004" onMouseOver="hilite(13004)" onMouseOut="lolite()" onClick="logVariable('showfeedback')" href="../_variables/showfeedback.html">$showfeedback</a>);
<a name="l4670"><span class="linenum">4670</span></a>  
<a name="l4671"><span class="linenum">4671</span></a>  <span class="comment">    // Delete the course and related context instance.</span>
<a name="l4672"><span class="linenum">4672</span></a>      <a class="class" onClick="logClass('context_helper')" href="../_classes/context_helper.html" onMouseOver="classPopup(event,'context_helper')">context_helper</a>::<a class="function" onClick="logFunction('delete_instance')" href="../_functions/delete_instance.html" onMouseOver="funcPopup(event,'delete_instance')">delete_instance</a>(<a class="constant" onClick="logConstant('CONTEXT_COURSE')" href="../_constants/CONTEXT_COURSE.html" onMouseOver="constPopup(event,'CONTEXT_COURSE')">CONTEXT_COURSE</a>, <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>);
<a name="l4673"><span class="linenum">4673</span></a>  
<a name="l4674"><span class="linenum">4674</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>(&quot;course&quot;, array(&quot;id&quot; =&gt; <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>));
<a name="l4675"><span class="linenum">4675</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>(&quot;course_format_options&quot;, array(&quot;courseid&quot; =&gt; <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>));
<a name="l4676"><span class="linenum">4676</span></a>  
<a name="l4677"><span class="linenum">4677</span></a>  <span class="comment">    // Reset all course related caches here.</span>
<a name="l4678"><span class="linenum">4678</span></a>      if (<a class="phpfunction" onClick="logFunction('class_exists')" href="../_functions/class_exists.html" onMouseOver="phpfuncPopup(event,'class_exists')">class_exists</a>('format_base', false)) {
<a name="l4679"><span class="linenum">4679</span></a>          format_base::<a class="function" onClick="logFunction('reset_course_cache')" href="../_functions/reset_course_cache.html" onMouseOver="funcPopup(event,'reset_course_cache')">reset_course_cache</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>);
<a name="l4680"><span class="linenum">4680</span></a>      }
<a name="l4681"><span class="linenum">4681</span></a>  
<a name="l4682"><span class="linenum">4682</span></a>  <span class="comment">    // Trigger a course deleted event.</span>
<a name="l4683"><span class="linenum">4683</span></a>      <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a> = \core\event\<a class="class" onClick="logClass('course_deleted')" href="../_classes/course_deleted.html" onMouseOver="classPopup(event,'course_deleted')">course_deleted</a>::<a class="function" onClick="logFunction('create')" href="../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(array(
<a name="l4684"><span class="linenum">4684</span></a>          'objectid' =&gt; <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l4685"><span class="linenum">4685</span></a>          'context' =&gt; <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>,
<a name="l4686"><span class="linenum">4686</span></a>          'other' =&gt; array(
<a name="l4687"><span class="linenum">4687</span></a>              'shortname' =&gt; <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('shortname')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/shortname.html">shortname</a>,
<a name="l4688"><span class="linenum">4688</span></a>              'fullname' =&gt; <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('fullname')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/fullname.html">fullname</a>,
<a name="l4689"><span class="linenum">4689</span></a>              'idnumber' =&gt; <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;idnumber
<a name="l4690"><span class="linenum">4690</span></a>              )
<a name="l4691"><span class="linenum">4691</span></a>      ));
<a name="l4692"><span class="linenum">4692</span></a>      <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('course', <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>);
<a name="l4693"><span class="linenum">4693</span></a>      <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l4694"><span class="linenum">4694</span></a>  
<a name="l4695"><span class="linenum">4695</span></a>      return true;
<a name="l4696"><span class="linenum">4696</span></a>  }
<a name="l4697"><span class="linenum">4697</span></a>  
<a name="l4698"><span class="linenum">4698</span></a>  <span class="comment">/**</span>
<a name="l4699"><span class="linenum">4699</span></a>  <span class="comment"> * Clear a course out completely, deleting all content but don't delete the course itself.</span>
<a name="l4700"><span class="linenum">4700</span></a>  <span class="comment"> *</span>
<a name="l4701"><span class="linenum">4701</span></a>  <span class="comment"> * This function does not verify any permissions.</span>
<a name="l4702"><span class="linenum">4702</span></a>  <span class="comment"> *</span>
<a name="l4703"><span class="linenum">4703</span></a>  <span class="comment"> * Please note this function also deletes all user enrolments,</span>
<a name="l4704"><span class="linenum">4704</span></a>  <span class="comment"> * enrolment instances and role assignments by default.</span>
<a name="l4705"><span class="linenum">4705</span></a>  <span class="comment"> *</span>
<a name="l4706"><span class="linenum">4706</span></a>  <span class="comment"> * $options:</span>
<a name="l4707"><span class="linenum">4707</span></a>  <span class="comment"> *  - 'keep_roles_and_enrolments' - false by default</span>
<a name="l4708"><span class="linenum">4708</span></a>  <span class="comment"> *  - 'keep_groups_and_groupings' - false by default</span>
<a name="l4709"><span class="linenum">4709</span></a>  <span class="comment"> *</span>
<a name="l4710"><span class="linenum">4710</span></a>  <span class="comment"> * @param int $courseid The id of the course that is being deleted</span>
<a name="l4711"><span class="linenum">4711</span></a>  <span class="comment"> * @param bool $showfeedback Whether to display notifications of each action the function performs.</span>
<a name="l4712"><span class="linenum">4712</span></a>  <span class="comment"> * @param array $options extra options</span>
<a name="l4713"><span class="linenum">4713</span></a>  <span class="comment"> * @return bool true if all the removals succeeded. false if there were any failures. If this</span>
<a name="l4714"><span class="linenum">4714</span></a>  <span class="comment"> *             method returns false, some of the removals will probably have succeeded, and others</span>
<a name="l4715"><span class="linenum">4715</span></a>  <span class="comment"> *             failed, but you have no way of knowing which.</span>
<a name="l4716"><span class="linenum">4716</span></a>  <span class="comment"> */</span>
<a name="l4717"><span class="linenum">4717</span></a>  function <a class="function" onClick="logFunction('remove_course_contents')" href="../_functions/remove_course_contents.html" onMouseOver="funcPopup(event,'remove_course_contents')">remove_course_contents</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>, <a class="var it13004" onMouseOver="hilite(13004)" onMouseOut="lolite()" onClick="logVariable('showfeedback')" href="../_variables/showfeedback.html">$showfeedback</a> = true, array <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../_variables/options.html">$options</a> = null) {
<a name="l4718"><span class="linenum">4718</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>, <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>;
<a name="l4719"><span class="linenum">4719</span></a>  
<a name="l4720"><span class="linenum">4720</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/libdir.html">libdir</a>.'/badgeslib.php');
<a name="l4721"><span class="linenum">4721</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/libdir.html">libdir</a>.'/completionlib.php');
<a name="l4722"><span class="linenum">4722</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/libdir.html">libdir</a>.'/questionlib.php');
<a name="l4723"><span class="linenum">4723</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/libdir.html">libdir</a>.'/gradelib.php');
<a name="l4724"><span class="linenum">4724</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../group/lib.php.html">/group/lib.php</a>');
<a name="l4725"><span class="linenum">4725</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../tag/coursetagslib.php.html">/tag/coursetagslib.php</a>');
<a name="l4726"><span class="linenum">4726</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../comment/lib.php.html">/comment/lib.php</a>');
<a name="l4727"><span class="linenum">4727</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../rating/lib.php.html">/rating/lib.php</a>');
<a name="l4728"><span class="linenum">4728</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../notes/lib.php.html">/notes/lib.php</a>');
<a name="l4729"><span class="linenum">4729</span></a>  
<a name="l4730"><span class="linenum">4730</span></a>  <span class="comment">    // Handle course badges.</span>
<a name="l4731"><span class="linenum">4731</span></a>      <a class="function" onClick="logFunction('badges_handle_course_deletion')" href="../_functions/badges_handle_course_deletion.html" onMouseOver="funcPopup(event,'badges_handle_course_deletion')">badges_handle_course_deletion</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>);
<a name="l4732"><span class="linenum">4732</span></a>  
<a name="l4733"><span class="linenum">4733</span></a>  <span class="comment">    // NOTE: these concatenated strings are suboptimal, but it is just extra info...</span>
<a name="l4734"><span class="linenum">4734</span></a>      <a class="var it13005" onMouseOver="hilite(13005)" onMouseOut="lolite()" onClick="logVariable('strdeleted')" href="../_variables/strdeleted.html">$strdeleted</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('deleted').' - ';
<a name="l4735"><span class="linenum">4735</span></a>  
<a name="l4736"><span class="linenum">4736</span></a>  <span class="comment">    // Some crazy wishlist of stuff we should skip during purging of course content.</span>
<a name="l4737"><span class="linenum">4737</span></a>      <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../_variables/options.html">$options</a> = (array)<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../_variables/options.html">$options</a>;
<a name="l4738"><span class="linenum">4738</span></a>  
<a name="l4739"><span class="linenum">4739</span></a>      <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('course', array('id' =&gt; <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>), '*', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l4740"><span class="linenum">4740</span></a>      <a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a> = <a class="class" onClick="logClass('context_course')" href="../_classes/context_course.html" onMouseOver="classPopup(event,'context_course')">context_course</a>::<a class="function" onClick="logFunction('instance')" href="../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>);
<a name="l4741"><span class="linenum">4741</span></a>      <a class="var it586" onMouseOver="hilite(586)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../_variables/fs.html">$fs</a> = <a class="function" onClick="logFunction('get_file_storage')" href="../_functions/get_file_storage.html" onMouseOver="funcPopup(event,'get_file_storage')">get_file_storage</a>();
<a name="l4742"><span class="linenum">4742</span></a>  
<a name="l4743"><span class="linenum">4743</span></a>  <span class="comment">    // Delete course completion information, this has to be done before grades and enrols.</span>
<a name="l4744"><span class="linenum">4744</span></a>      <a class="var it6097" onMouseOver="hilite(6097)" onMouseOut="lolite()" onClick="logVariable('cc')" href="../_variables/cc.html">$cc</a> = <span class="keyword">new </span><a class="class" onClick="logClass('completion_info')" href="../_classes/completion_info.html" onMouseOver="classPopup(event,'completion_info')">completion_info</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>);
<a name="l4745"><span class="linenum">4745</span></a>      <a class="var it6097" onMouseOver="hilite(6097)" onMouseOut="lolite()" onClick="logVariable('cc')" href="../_variables/cc.html">$cc</a>-&gt;<a class="function" onClick="logFunction('clear_criteria')" href="../_functions/clear_criteria.html" onMouseOver="funcPopup(event,'clear_criteria')">clear_criteria</a>();
<a name="l4746"><span class="linenum">4746</span></a>      if (<a class="var it13004" onMouseOver="hilite(13004)" onMouseOut="lolite()" onClick="logVariable('showfeedback')" href="../_variables/showfeedback.html">$showfeedback</a>) {
<a name="l4747"><span class="linenum">4747</span></a>          echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="var it13005" onMouseOver="hilite(13005)" onMouseOut="lolite()" onClick="logVariable('strdeleted')" href="../_variables/strdeleted.html">$strdeleted</a>.<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('completion', 'completion'), 'notifysuccess');
<a name="l4748"><span class="linenum">4748</span></a>      }
<a name="l4749"><span class="linenum">4749</span></a>  
<a name="l4750"><span class="linenum">4750</span></a>  <span class="comment">    // Remove all data from gradebook - this needs to be done before course modules</span>
<a name="l4751"><span class="linenum">4751</span></a>  <span class="comment">    // because while deleting this information, the system may need to reference</span>
<a name="l4752"><span class="linenum">4752</span></a>  <span class="comment">    // the course modules that own the grades.</span>
<a name="l4753"><span class="linenum">4753</span></a>      <a class="function" onClick="logFunction('remove_course_grades')" href="../_functions/remove_course_grades.html" onMouseOver="funcPopup(event,'remove_course_grades')">remove_course_grades</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>, <a class="var it13004" onMouseOver="hilite(13004)" onMouseOut="lolite()" onClick="logVariable('showfeedback')" href="../_variables/showfeedback.html">$showfeedback</a>);
<a name="l4754"><span class="linenum">4754</span></a>      <a class="function" onClick="logFunction('remove_grade_letters')" href="../_functions/remove_grade_letters.html" onMouseOver="funcPopup(event,'remove_grade_letters')">remove_grade_letters</a>(<a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a>, <a class="var it13004" onMouseOver="hilite(13004)" onMouseOut="lolite()" onClick="logVariable('showfeedback')" href="../_variables/showfeedback.html">$showfeedback</a>);
<a name="l4755"><span class="linenum">4755</span></a>  
<a name="l4756"><span class="linenum">4756</span></a>  <span class="comment">    // Delete course blocks in any all child contexts,</span>
<a name="l4757"><span class="linenum">4757</span></a>  <span class="comment">    // they may depend on modules so delete them first.</span>
<a name="l4758"><span class="linenum">4758</span></a>      <a class="var it13006" onMouseOver="hilite(13006)" onMouseOut="lolite()" onClick="logVariable('childcontexts')" href="../_variables/childcontexts.html">$childcontexts</a> = <a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a>-&gt;<a class="function" onClick="logFunction('get_child_contexts')" href="../_functions/get_child_contexts.html" onMouseOver="funcPopup(event,'get_child_contexts')">get_child_contexts</a>(); <span class="comment">// Returns all subcontexts since 2.2.</span>
<a name="l4759"><span class="linenum">4759</span></a>      foreach (<a class="var it13006" onMouseOver="hilite(13006)" onMouseOut="lolite()" onClick="logVariable('childcontexts')" href="../_variables/childcontexts.html">$childcontexts</a> as <a class="var it13007" onMouseOver="hilite(13007)" onMouseOut="lolite()" onClick="logVariable('childcontext')" href="../_variables/childcontext.html">$childcontext</a>) {
<a name="l4760"><span class="linenum">4760</span></a>          <a class="function" onClick="logFunction('blocks_delete_all_for_context')" href="../_functions/blocks_delete_all_for_context.html" onMouseOver="funcPopup(event,'blocks_delete_all_for_context')">blocks_delete_all_for_context</a>(<a class="var it13007" onMouseOver="hilite(13007)" onMouseOut="lolite()" onClick="logVariable('childcontext')" href="../_variables/childcontext.html">$childcontext</a>-&gt;<a onClick="logVariable('id')" class="var it41073" onMouseOver="hilite(41073)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l4761"><span class="linenum">4761</span></a>      }
<a name="l4762"><span class="linenum">4762</span></a>      unset(<a class="var it13006" onMouseOver="hilite(13006)" onMouseOut="lolite()" onClick="logVariable('childcontexts')" href="../_variables/childcontexts.html">$childcontexts</a>);
<a name="l4763"><span class="linenum">4763</span></a>      <a class="function" onClick="logFunction('blocks_delete_all_for_context')" href="../_functions/blocks_delete_all_for_context.html" onMouseOver="funcPopup(event,'blocks_delete_all_for_context')">blocks_delete_all_for_context</a>(<a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a>-&gt;<a onClick="logVariable('id')" class="var it39493" onMouseOver="hilite(39493)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l4764"><span class="linenum">4764</span></a>      if (<a class="var it13004" onMouseOver="hilite(13004)" onMouseOut="lolite()" onClick="logVariable('showfeedback')" href="../_variables/showfeedback.html">$showfeedback</a>) {
<a name="l4765"><span class="linenum">4765</span></a>          echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="var it13005" onMouseOver="hilite(13005)" onMouseOut="lolite()" onClick="logVariable('strdeleted')" href="../_variables/strdeleted.html">$strdeleted</a>.<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('type_block_plural', 'plugin'), 'notifysuccess');
<a name="l4766"><span class="linenum">4766</span></a>      }
<a name="l4767"><span class="linenum">4767</span></a>  
<a name="l4768"><span class="linenum">4768</span></a>  <span class="comment">    // Delete every instance of every module,</span>
<a name="l4769"><span class="linenum">4769</span></a>  <span class="comment">    // this has to be done before deleting of course level stuff.</span>
<a name="l4770"><span class="linenum">4770</span></a>      <a class="var it10651" onMouseOver="hilite(10651)" onMouseOut="lolite()" onClick="logVariable('locations')" href="../_variables/locations.html">$locations</a> = <a class="class" onClick="logClass('core_component')" href="../_classes/core_component.html" onMouseOver="classPopup(event,'core_component')">core_component</a>::<a class="function" onClick="logFunction('get_plugin_list')" href="../_functions/get_plugin_list.html" onMouseOver="funcPopup(event,'get_plugin_list')">get_plugin_list</a>('mod');
<a name="l4771"><span class="linenum">4771</span></a>      foreach (<a class="var it10651" onMouseOver="hilite(10651)" onMouseOut="lolite()" onClick="logVariable('locations')" href="../_variables/locations.html">$locations</a> as <a class="var it561" onMouseOver="hilite(561)" onMouseOut="lolite()" onClick="logVariable('modname')" href="../_variables/modname.html">$modname</a> =&gt; <a class="var it11548" onMouseOver="hilite(11548)" onMouseOut="lolite()" onClick="logVariable('moddir')" href="../_variables/moddir.html">$moddir</a>) {
<a name="l4772"><span class="linenum">4772</span></a>          if (<a class="var it561" onMouseOver="hilite(561)" onMouseOut="lolite()" onClick="logVariable('modname')" href="../_variables/modname.html">$modname</a> === 'NEWMODULE') {
<a name="l4773"><span class="linenum">4773</span></a>              continue;
<a name="l4774"><span class="linenum">4774</span></a>          }
<a name="l4775"><span class="linenum">4775</span></a>          if (<a class="var it611" onMouseOver="hilite(611)" onMouseOut="lolite()" onClick="logVariable('module')" href="../_variables/module.html">$module</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('modules', array('name' =&gt; <a class="var it561" onMouseOver="hilite(561)" onMouseOut="lolite()" onClick="logVariable('modname')" href="../_variables/modname.html">$modname</a>))) {
<a name="l4776"><span class="linenum">4776</span></a>              include_once(&quot;<a class="var it11548" onMouseOver="hilite(11548)" onMouseOut="lolite()" onClick="logVariable('moddir')" href="../_variables/moddir.html">$moddir</a>/lib.php&quot;);                 <span class="comment">// Shows php warning only if plugin defective.</span>
<a name="l4777"><span class="linenum">4777</span></a>              <a class="var it13008" onMouseOver="hilite(13008)" onMouseOut="lolite()" onClick="logVariable('moddelete')" href="../_variables/moddelete.html">$moddelete</a> = <a class="var it561" onMouseOver="hilite(561)" onMouseOut="lolite()" onClick="logVariable('modname')" href="../_variables/modname.html">$modname</a> .'_delete_instance';       <span class="comment">// Delete everything connected to an instance.</span>
<a name="l4778"><span class="linenum">4778</span></a>              <a class="var it13009" onMouseOver="hilite(13009)" onMouseOut="lolite()" onClick="logVariable('moddeletecourse')" href="../_variables/moddeletecourse.html">$moddeletecourse</a> = <a class="var it561" onMouseOver="hilite(561)" onMouseOut="lolite()" onClick="logVariable('modname')" href="../_variables/modname.html">$modname</a> .'_delete_course';   <span class="comment">// Delete other stray stuff (uncommon).</span>
<a name="l4779"><span class="linenum">4779</span></a>  
<a name="l4780"><span class="linenum">4780</span></a>              if (<a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('instances')" href="../_variables/instances.html">$instances</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>(<a class="var it561" onMouseOver="hilite(561)" onMouseOut="lolite()" onClick="logVariable('modname')" href="../_variables/modname.html">$modname</a>, array('course' =&gt; <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>))) {
<a name="l4781"><span class="linenum">4781</span></a>                  foreach (<a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('instances')" href="../_variables/instances.html">$instances</a> as <a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>) {
<a name="l4782"><span class="linenum">4782</span></a>                      if (<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a> = <a class="function" onClick="logFunction('get_coursemodule_from_instance')" href="../_functions/get_coursemodule_from_instance.html" onMouseOver="funcPopup(event,'get_coursemodule_from_instance')">get_coursemodule_from_instance</a>(<a class="var it561" onMouseOver="hilite(561)" onMouseOut="lolite()" onClick="logVariable('modname')" href="../_variables/modname.html">$modname</a>, <a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('id')" class="var it39530" onMouseOver="hilite(39530)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)) {
<a name="l4783"><span class="linenum">4783</span></a>  <span class="comment">                        // Delete activity context questions and question categories.</span>
<a name="l4784"><span class="linenum">4784</span></a>                          <a class="function" onClick="logFunction('question_delete_activity')" href="../_functions/question_delete_activity.html" onMouseOver="funcPopup(event,'question_delete_activity')">question_delete_activity</a>(<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>,  <a class="var it13004" onMouseOver="hilite(13004)" onMouseOut="lolite()" onClick="logVariable('showfeedback')" href="../_variables/showfeedback.html">$showfeedback</a>);
<a name="l4785"><span class="linenum">4785</span></a>                      }
<a name="l4786"><span class="linenum">4786</span></a>                      if (<a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>(<a class="var it13008" onMouseOver="hilite(13008)" onMouseOut="lolite()" onClick="logVariable('moddelete')" href="../_variables/moddelete.html">$moddelete</a>)) {
<a name="l4787"><span class="linenum">4787</span></a>  <span class="comment">                        // This purges all module data in related tables, extra user prefs, settings, etc.</span>
<a name="l4788"><span class="linenum">4788</span></a>                          <a class="var it13008" onMouseOver="hilite(13008)" onMouseOut="lolite()" onClick="logVariable('moddelete')" href="../_variables/moddelete.html">$moddelete</a>(<a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('id')" class="var it39530" onMouseOver="hilite(39530)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l4789"><span class="linenum">4789</span></a>                      } else {
<a name="l4790"><span class="linenum">4790</span></a>  <span class="comment">                        // NOTE: we should not allow installation of modules with missing delete support!</span>
<a name="l4791"><span class="linenum">4791</span></a>                          <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(&quot;Defective module '<a class="var it561" onMouseOver="hilite(561)" onMouseOut="lolite()" onClick="logVariable('modname')" href="../_variables/modname.html">$modname</a>' detected when deleting course contents: missing function <a class="var it13008" onMouseOver="hilite(13008)" onMouseOut="lolite()" onClick="logVariable('moddelete')" href="../_variables/moddelete.html">$moddelete</a>()!&quot;);
<a name="l4792"><span class="linenum">4792</span></a>                          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>(<a class="var it561" onMouseOver="hilite(561)" onMouseOut="lolite()" onClick="logVariable('modname')" href="../_variables/modname.html">$modname</a>, array('id' =&gt; <a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('id')" class="var it39530" onMouseOver="hilite(39530)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l4793"><span class="linenum">4793</span></a>                      }
<a name="l4794"><span class="linenum">4794</span></a>  
<a name="l4795"><span class="linenum">4795</span></a>                      if (<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>) {
<a name="l4796"><span class="linenum">4796</span></a>  <span class="comment">                        // Delete cm and its context - orphaned contexts are purged in cron in case of any race condition.</span>
<a name="l4797"><span class="linenum">4797</span></a>                          <a class="class" onClick="logClass('context_helper')" href="../_classes/context_helper.html" onMouseOver="classPopup(event,'context_helper')">context_helper</a>::<a class="function" onClick="logFunction('delete_instance')" href="../_functions/delete_instance.html" onMouseOver="funcPopup(event,'delete_instance')">delete_instance</a>(<a class="constant" onClick="logConstant('CONTEXT_MODULE')" href="../_constants/CONTEXT_MODULE.html" onMouseOver="constPopup(event,'CONTEXT_MODULE')">CONTEXT_MODULE</a>, <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l4798"><span class="linenum">4798</span></a>                          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('course_modules', array('id' =&gt; <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l4799"><span class="linenum">4799</span></a>                      }
<a name="l4800"><span class="linenum">4800</span></a>                  }
<a name="l4801"><span class="linenum">4801</span></a>              }
<a name="l4802"><span class="linenum">4802</span></a>              if (<a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>(<a class="var it13009" onMouseOver="hilite(13009)" onMouseOut="lolite()" onClick="logVariable('moddeletecourse')" href="../_variables/moddeletecourse.html">$moddeletecourse</a>)) {
<a name="l4803"><span class="linenum">4803</span></a>  <span class="comment">                // Execute ptional course cleanup callback.</span>
<a name="l4804"><span class="linenum">4804</span></a>                  <a class="var it13009" onMouseOver="hilite(13009)" onMouseOut="lolite()" onClick="logVariable('moddeletecourse')" href="../_variables/moddeletecourse.html">$moddeletecourse</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>, <a class="var it13004" onMouseOver="hilite(13004)" onMouseOut="lolite()" onClick="logVariable('showfeedback')" href="../_variables/showfeedback.html">$showfeedback</a>);
<a name="l4805"><span class="linenum">4805</span></a>              }
<a name="l4806"><span class="linenum">4806</span></a>              if (<a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('instances')" href="../_variables/instances.html">$instances</a> and <a class="var it13004" onMouseOver="hilite(13004)" onMouseOut="lolite()" onClick="logVariable('showfeedback')" href="../_variables/showfeedback.html">$showfeedback</a>) {
<a name="l4807"><span class="linenum">4807</span></a>                  echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="var it13005" onMouseOver="hilite(13005)" onMouseOut="lolite()" onClick="logVariable('strdeleted')" href="../_variables/strdeleted.html">$strdeleted</a>.<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('pluginname', <a class="var it561" onMouseOver="hilite(561)" onMouseOut="lolite()" onClick="logVariable('modname')" href="../_variables/modname.html">$modname</a>), 'notifysuccess');
<a name="l4808"><span class="linenum">4808</span></a>              }
<a name="l4809"><span class="linenum">4809</span></a>          } else {
<a name="l4810"><span class="linenum">4810</span></a>  <span class="comment">            // Ooops, this module is not properly installed, force-delete it in the next block.</span>
<a name="l4811"><span class="linenum">4811</span></a>          }
<a name="l4812"><span class="linenum">4812</span></a>      }
<a name="l4813"><span class="linenum">4813</span></a>  
<a name="l4814"><span class="linenum">4814</span></a>  <span class="comment">    // We have tried to delete everything the nice way - now let's force-delete any remaining module data.</span>
<a name="l4815"><span class="linenum">4815</span></a>  
<a name="l4816"><span class="linenum">4816</span></a>  <span class="comment">    // Remove all data from availability and completion tables that is associated</span>
<a name="l4817"><span class="linenum">4817</span></a>  <span class="comment">    // with course-modules belonging to this course. Note this is done even if the</span>
<a name="l4818"><span class="linenum">4818</span></a>  <span class="comment">    // features are not enabled now, in case they were enabled previously.</span>
<a name="l4819"><span class="linenum">4819</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records_select')" href="../_functions/delete_records_select.html" onMouseOver="funcPopup(event,'delete_records_select')">delete_records_select</a>('course_modules_completion',
<a name="l4820"><span class="linenum">4820</span></a>             'coursemoduleid IN (SELECT id from {course_modules} WHERE course=?)',
<a name="l4821"><span class="linenum">4821</span></a>             array(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>));
<a name="l4822"><span class="linenum">4822</span></a>  
<a name="l4823"><span class="linenum">4823</span></a>  <span class="comment">    // Remove course-module data.</span>
<a name="l4824"><span class="linenum">4824</span></a>      <a class="var it1704" onMouseOver="hilite(1704)" onMouseOut="lolite()" onClick="logVariable('cms')" href="../_variables/cms.html">$cms</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('course_modules', array('course' =&gt; <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l4825"><span class="linenum">4825</span></a>      foreach (<a class="var it1704" onMouseOver="hilite(1704)" onMouseOut="lolite()" onClick="logVariable('cms')" href="../_variables/cms.html">$cms</a> as <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>) {
<a name="l4826"><span class="linenum">4826</span></a>          if (<a class="var it611" onMouseOver="hilite(611)" onMouseOut="lolite()" onClick="logVariable('module')" href="../_variables/module.html">$module</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('modules', array('id' =&gt; <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('module')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../_variables/module.html">module</a>))) {
<a name="l4827"><span class="linenum">4827</span></a>              try {
<a name="l4828"><span class="linenum">4828</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>(<a class="var it611" onMouseOver="hilite(611)" onMouseOut="lolite()" onClick="logVariable('module')" href="../_variables/module.html">$module</a>-&gt;<a onClick="logVariable('name')" class="var it39455" onMouseOver="hilite(39455)" onMouseOut="lolite()" href="../_variables/name.html">name</a>, array('id' =&gt; <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('instance')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../_variables/instance.html">instance</a>));
<a name="l4829"><span class="linenum">4829</span></a>              } catch (Exception <a class="var it193" onMouseOver="hilite(193)" onMouseOut="lolite()" onClick="logVariable('e')" href="../_variables/e.html">$e</a>) {
<a name="l4830"><span class="linenum">4830</span></a>  <span class="comment">                // Ignore weird or missing table problems.</span>
<a name="l4831"><span class="linenum">4831</span></a>              }
<a name="l4832"><span class="linenum">4832</span></a>          }
<a name="l4833"><span class="linenum">4833</span></a>          <a class="class" onClick="logClass('context_helper')" href="../_classes/context_helper.html" onMouseOver="classPopup(event,'context_helper')">context_helper</a>::<a class="function" onClick="logFunction('delete_instance')" href="../_functions/delete_instance.html" onMouseOver="funcPopup(event,'delete_instance')">delete_instance</a>(<a class="constant" onClick="logConstant('CONTEXT_MODULE')" href="../_constants/CONTEXT_MODULE.html" onMouseOver="constPopup(event,'CONTEXT_MODULE')">CONTEXT_MODULE</a>, <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l4834"><span class="linenum">4834</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('course_modules', array('id' =&gt; <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l4835"><span class="linenum">4835</span></a>      }
<a name="l4836"><span class="linenum">4836</span></a>  
<a name="l4837"><span class="linenum">4837</span></a>      if (<a class="var it13004" onMouseOver="hilite(13004)" onMouseOut="lolite()" onClick="logVariable('showfeedback')" href="../_variables/showfeedback.html">$showfeedback</a>) {
<a name="l4838"><span class="linenum">4838</span></a>          echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="var it13005" onMouseOver="hilite(13005)" onMouseOut="lolite()" onClick="logVariable('strdeleted')" href="../_variables/strdeleted.html">$strdeleted</a>.<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('type_mod_plural', 'plugin'), 'notifysuccess');
<a name="l4839"><span class="linenum">4839</span></a>      }
<a name="l4840"><span class="linenum">4840</span></a>  
<a name="l4841"><span class="linenum">4841</span></a>  <span class="comment">    // Cleanup the rest of plugins.</span>
<a name="l4842"><span class="linenum">4842</span></a>      <a class="var it13010" onMouseOver="hilite(13010)" onMouseOut="lolite()" onClick="logVariable('cleanuplugintypes')" href="../_variables/cleanuplugintypes.html">$cleanuplugintypes</a> = array('report', 'coursereport', 'format');
<a name="l4843"><span class="linenum">4843</span></a>      foreach (<a class="var it13010" onMouseOver="hilite(13010)" onMouseOut="lolite()" onClick="logVariable('cleanuplugintypes')" href="../_variables/cleanuplugintypes.html">$cleanuplugintypes</a> as <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>) {
<a name="l4844"><span class="linenum">4844</span></a>          <a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('plugins')" href="../_variables/plugins.html">$plugins</a> = <a class="function" onClick="logFunction('get_plugin_list_with_function')" href="../_functions/get_plugin_list_with_function.html" onMouseOver="funcPopup(event,'get_plugin_list_with_function')">get_plugin_list_with_function</a>(<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>, 'delete_course', 'lib.php');
<a name="l4845"><span class="linenum">4845</span></a>          foreach (<a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('plugins')" href="../_variables/plugins.html">$plugins</a> as <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a> =&gt; <a class="var it13011" onMouseOver="hilite(13011)" onMouseOut="lolite()" onClick="logVariable('pluginfunction')" href="../_variables/pluginfunction.html">$pluginfunction</a>) {
<a name="l4846"><span class="linenum">4846</span></a>              <a class="var it13011" onMouseOver="hilite(13011)" onMouseOut="lolite()" onClick="logVariable('pluginfunction')" href="../_variables/pluginfunction.html">$pluginfunction</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, <a class="var it13004" onMouseOver="hilite(13004)" onMouseOut="lolite()" onClick="logVariable('showfeedback')" href="../_variables/showfeedback.html">$showfeedback</a>);
<a name="l4847"><span class="linenum">4847</span></a>          }
<a name="l4848"><span class="linenum">4848</span></a>          if (<a class="var it13004" onMouseOver="hilite(13004)" onMouseOut="lolite()" onClick="logVariable('showfeedback')" href="../_variables/showfeedback.html">$showfeedback</a>) {
<a name="l4849"><span class="linenum">4849</span></a>              echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="var it13005" onMouseOver="hilite(13005)" onMouseOut="lolite()" onClick="logVariable('strdeleted')" href="../_variables/strdeleted.html">$strdeleted</a>.<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('type_'.<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>.'_plural', 'plugin'), 'notifysuccess');
<a name="l4850"><span class="linenum">4850</span></a>          }
<a name="l4851"><span class="linenum">4851</span></a>      }
<a name="l4852"><span class="linenum">4852</span></a>  
<a name="l4853"><span class="linenum">4853</span></a>  <span class="comment">    // Delete questions and question categories.</span>
<a name="l4854"><span class="linenum">4854</span></a>      <a class="function" onClick="logFunction('question_delete_course')" href="../_functions/question_delete_course.html" onMouseOver="funcPopup(event,'question_delete_course')">question_delete_course</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>, <a class="var it13004" onMouseOver="hilite(13004)" onMouseOut="lolite()" onClick="logVariable('showfeedback')" href="../_variables/showfeedback.html">$showfeedback</a>);
<a name="l4855"><span class="linenum">4855</span></a>      if (<a class="var it13004" onMouseOver="hilite(13004)" onMouseOut="lolite()" onClick="logVariable('showfeedback')" href="../_variables/showfeedback.html">$showfeedback</a>) {
<a name="l4856"><span class="linenum">4856</span></a>          echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="var it13005" onMouseOver="hilite(13005)" onMouseOut="lolite()" onClick="logVariable('strdeleted')" href="../_variables/strdeleted.html">$strdeleted</a>.<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('questions', 'question'), 'notifysuccess');
<a name="l4857"><span class="linenum">4857</span></a>      }
<a name="l4858"><span class="linenum">4858</span></a>  
<a name="l4859"><span class="linenum">4859</span></a>  <span class="comment">    // Make sure there are no subcontexts left - all valid blocks and modules should be already gone.</span>
<a name="l4860"><span class="linenum">4860</span></a>      <a class="var it13006" onMouseOver="hilite(13006)" onMouseOut="lolite()" onClick="logVariable('childcontexts')" href="../_variables/childcontexts.html">$childcontexts</a> = <a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a>-&gt;<a class="function" onClick="logFunction('get_child_contexts')" href="../_functions/get_child_contexts.html" onMouseOver="funcPopup(event,'get_child_contexts')">get_child_contexts</a>(); <span class="comment">// Returns all subcontexts since 2.2.</span>
<a name="l4861"><span class="linenum">4861</span></a>      foreach (<a class="var it13006" onMouseOver="hilite(13006)" onMouseOut="lolite()" onClick="logVariable('childcontexts')" href="../_variables/childcontexts.html">$childcontexts</a> as <a class="var it13007" onMouseOver="hilite(13007)" onMouseOut="lolite()" onClick="logVariable('childcontext')" href="../_variables/childcontext.html">$childcontext</a>) {
<a name="l4862"><span class="linenum">4862</span></a>          <a class="var it13007" onMouseOver="hilite(13007)" onMouseOut="lolite()" onClick="logVariable('childcontext')" href="../_variables/childcontext.html">$childcontext</a>-&gt;<a class="function" onClick="logFunction('delete')" href="../_functions/delete.html" onMouseOver="funcPopup(event,'delete')">delete</a>();
<a name="l4863"><span class="linenum">4863</span></a>      }
<a name="l4864"><span class="linenum">4864</span></a>      unset(<a class="var it13006" onMouseOver="hilite(13006)" onMouseOut="lolite()" onClick="logVariable('childcontexts')" href="../_variables/childcontexts.html">$childcontexts</a>);
<a name="l4865"><span class="linenum">4865</span></a>  
<a name="l4866"><span class="linenum">4866</span></a>  <span class="comment">    // Remove all roles and enrolments by default.</span>
<a name="l4867"><span class="linenum">4867</span></a>      if (empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../_variables/options.html">$options</a>['keep_roles_and_enrolments'])) {
<a name="l4868"><span class="linenum">4868</span></a>  <span class="comment">        // This hack is used in restore when deleting contents of existing course.</span>
<a name="l4869"><span class="linenum">4869</span></a>          <a class="function" onClick="logFunction('role_unassign_all')" href="../_functions/role_unassign_all.html" onMouseOver="funcPopup(event,'role_unassign_all')">role_unassign_all</a>(array('contextid' =&gt; <a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a>-&gt;<a onClick="logVariable('id')" class="var it39493" onMouseOver="hilite(39493)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, 'component' =&gt; ''), true);
<a name="l4870"><span class="linenum">4870</span></a>          <a class="function" onClick="logFunction('enrol_course_delete')" href="../_functions/enrol_course_delete.html" onMouseOver="funcPopup(event,'enrol_course_delete')">enrol_course_delete</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>);
<a name="l4871"><span class="linenum">4871</span></a>          if (<a class="var it13004" onMouseOver="hilite(13004)" onMouseOut="lolite()" onClick="logVariable('showfeedback')" href="../_variables/showfeedback.html">$showfeedback</a>) {
<a name="l4872"><span class="linenum">4872</span></a>              echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="var it13005" onMouseOver="hilite(13005)" onMouseOut="lolite()" onClick="logVariable('strdeleted')" href="../_variables/strdeleted.html">$strdeleted</a>.<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('type_enrol_plural', 'plugin'), 'notifysuccess');
<a name="l4873"><span class="linenum">4873</span></a>          }
<a name="l4874"><span class="linenum">4874</span></a>      }
<a name="l4875"><span class="linenum">4875</span></a>  
<a name="l4876"><span class="linenum">4876</span></a>  <span class="comment">    // Delete any groups, removing members and grouping/course links first.</span>
<a name="l4877"><span class="linenum">4877</span></a>      if (empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../_variables/options.html">$options</a>['keep_groups_and_groupings'])) {
<a name="l4878"><span class="linenum">4878</span></a>          <a class="function" onClick="logFunction('groups_delete_groupings')" href="../_functions/groups_delete_groupings.html" onMouseOver="funcPopup(event,'groups_delete_groupings')">groups_delete_groupings</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, <a class="var it13004" onMouseOver="hilite(13004)" onMouseOut="lolite()" onClick="logVariable('showfeedback')" href="../_variables/showfeedback.html">$showfeedback</a>);
<a name="l4879"><span class="linenum">4879</span></a>          <a class="function" onClick="logFunction('groups_delete_groups')" href="../_functions/groups_delete_groups.html" onMouseOver="funcPopup(event,'groups_delete_groups')">groups_delete_groups</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, <a class="var it13004" onMouseOver="hilite(13004)" onMouseOut="lolite()" onClick="logVariable('showfeedback')" href="../_variables/showfeedback.html">$showfeedback</a>);
<a name="l4880"><span class="linenum">4880</span></a>      }
<a name="l4881"><span class="linenum">4881</span></a>  
<a name="l4882"><span class="linenum">4882</span></a>  <span class="comment">    // Filters be gone!</span>
<a name="l4883"><span class="linenum">4883</span></a>      <a class="function" onClick="logFunction('filter_delete_all_for_context')" href="../_functions/filter_delete_all_for_context.html" onMouseOver="funcPopup(event,'filter_delete_all_for_context')">filter_delete_all_for_context</a>(<a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a>-&gt;<a onClick="logVariable('id')" class="var it39493" onMouseOver="hilite(39493)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l4884"><span class="linenum">4884</span></a>  
<a name="l4885"><span class="linenum">4885</span></a>  <span class="comment">    // Notes, you shall not pass!</span>
<a name="l4886"><span class="linenum">4886</span></a>      <a class="function" onClick="logFunction('note_delete_all')" href="../_functions/note_delete_all.html" onMouseOver="funcPopup(event,'note_delete_all')">note_delete_all</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l4887"><span class="linenum">4887</span></a>  
<a name="l4888"><span class="linenum">4888</span></a>  <span class="comment">    // Die comments!</span>
<a name="l4889"><span class="linenum">4889</span></a>      <a class="class" onClick="logClass('comment')" href="../_classes/comment.html" onMouseOver="classPopup(event,'comment')">comment</a>::<a class="function" onClick="logFunction('delete_comments')" href="../_functions/delete_comments.html" onMouseOver="funcPopup(event,'delete_comments')">delete_comments</a>(<a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a>-&gt;<a onClick="logVariable('id')" class="var it39493" onMouseOver="hilite(39493)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l4890"><span class="linenum">4890</span></a>  
<a name="l4891"><span class="linenum">4891</span></a>  <span class="comment">    // Ratings are history too.</span>
<a name="l4892"><span class="linenum">4892</span></a>      <a class="var it13012" onMouseOver="hilite(13012)" onMouseOut="lolite()" onClick="logVariable('delopt')" href="../_variables/delopt.html">$delopt</a> = new stdclass();
<a name="l4893"><span class="linenum">4893</span></a>      <a class="var it13012" onMouseOver="hilite(13012)" onMouseOut="lolite()" onClick="logVariable('delopt')" href="../_variables/delopt.html">$delopt</a>-&gt;<a onClick="logVariable('contextid')" class="var it40708" onMouseOver="hilite(40708)" onMouseOut="lolite()" href="../_variables/contextid.html">contextid</a> = <a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a>-&gt;<a onClick="logVariable('id')" class="var it39493" onMouseOver="hilite(39493)" onMouseOut="lolite()" href="../_variables/id.html">id</a>;
<a name="l4894"><span class="linenum">4894</span></a>      <a class="var it6647" onMouseOver="hilite(6647)" onMouseOut="lolite()" onClick="logVariable('rm')" href="../_variables/rm.html">$rm</a> = <span class="keyword">new </span><a class="class" onClick="logClass('rating_manager')" href="../_classes/rating_manager.html" onMouseOver="classPopup(event,'rating_manager')">rating_manager</a>();
<a name="l4895"><span class="linenum">4895</span></a>      <a class="var it6647" onMouseOver="hilite(6647)" onMouseOut="lolite()" onClick="logVariable('rm')" href="../_variables/rm.html">$rm</a>-&gt;<a class="function" onClick="logFunction('delete_ratings')" href="../_functions/delete_ratings.html" onMouseOver="funcPopup(event,'delete_ratings')">delete_ratings</a>(<a class="var it13012" onMouseOver="hilite(13012)" onMouseOut="lolite()" onClick="logVariable('delopt')" href="../_variables/delopt.html">$delopt</a>);
<a name="l4896"><span class="linenum">4896</span></a>  
<a name="l4897"><span class="linenum">4897</span></a>  <span class="comment">    // Delete course tags.</span>
<a name="l4898"><span class="linenum">4898</span></a>      <a class="function" onClick="logFunction('coursetag_delete_course_tags')" href="../_functions/coursetag_delete_course_tags.html" onMouseOver="funcPopup(event,'coursetag_delete_course_tags')">coursetag_delete_course_tags</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, <a class="var it13004" onMouseOver="hilite(13004)" onMouseOut="lolite()" onClick="logVariable('showfeedback')" href="../_variables/showfeedback.html">$showfeedback</a>);
<a name="l4899"><span class="linenum">4899</span></a>  
<a name="l4900"><span class="linenum">4900</span></a>  <span class="comment">    // Delete calendar events.</span>
<a name="l4901"><span class="linenum">4901</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('event', array('courseid' =&gt; <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l4902"><span class="linenum">4902</span></a>      <a class="var it586" onMouseOver="hilite(586)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('delete_area_files')" href="../_functions/delete_area_files.html" onMouseOver="funcPopup(event,'delete_area_files')">delete_area_files</a>(<a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a>-&gt;<a onClick="logVariable('id')" class="var it39493" onMouseOver="hilite(39493)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, 'calendar');
<a name="l4903"><span class="linenum">4903</span></a>  
<a name="l4904"><span class="linenum">4904</span></a>  <span class="comment">    // Delete all related records in other core tables that may have a courseid</span>
<a name="l4905"><span class="linenum">4905</span></a>  <span class="comment">    // This array stores the tables that need to be cleared, as</span>
<a name="l4906"><span class="linenum">4906</span></a>  <span class="comment">    // table_name =&gt; column_name that contains the course id.</span>
<a name="l4907"><span class="linenum">4907</span></a>      <a class="var it13013" onMouseOver="hilite(13013)" onMouseOut="lolite()" onClick="logVariable('tablestoclear')" href="../_variables/tablestoclear.html">$tablestoclear</a> = array(
<a name="l4908"><span class="linenum">4908</span></a>          'backup_courses' =&gt; 'courseid',  // Scheduled backup stuff.
<a name="l4909"><span class="linenum">4909</span></a>          'user_lastaccess' =&gt; 'courseid', // User access info.
<a name="l4910"><span class="linenum">4910</span></a>      );
<a name="l4911"><span class="linenum">4911</span></a>      foreach (<a class="var it13013" onMouseOver="hilite(13013)" onMouseOut="lolite()" onClick="logVariable('tablestoclear')" href="../_variables/tablestoclear.html">$tablestoclear</a> as <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../_variables/table.html">$table</a> =&gt; <a class="var it2203" onMouseOver="hilite(2203)" onMouseOut="lolite()" onClick="logVariable('col')" href="../_variables/col.html">$col</a>) {
<a name="l4912"><span class="linenum">4912</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../_variables/table.html">$table</a>, array(<a class="var it2203" onMouseOver="hilite(2203)" onMouseOut="lolite()" onClick="logVariable('col')" href="../_variables/col.html">$col</a> =&gt; <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l4913"><span class="linenum">4913</span></a>      }
<a name="l4914"><span class="linenum">4914</span></a>  
<a name="l4915"><span class="linenum">4915</span></a>  <span class="comment">    // Delete all course backup files.</span>
<a name="l4916"><span class="linenum">4916</span></a>      <a class="var it586" onMouseOver="hilite(586)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('delete_area_files')" href="../_functions/delete_area_files.html" onMouseOver="funcPopup(event,'delete_area_files')">delete_area_files</a>(<a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a>-&gt;<a onClick="logVariable('id')" class="var it39493" onMouseOver="hilite(39493)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, 'backup');
<a name="l4917"><span class="linenum">4917</span></a>  
<a name="l4918"><span class="linenum">4918</span></a>  <span class="comment">    // Cleanup course record - remove links to deleted stuff.</span>
<a name="l4919"><span class="linenum">4919</span></a>      <a class="var it7931" onMouseOver="hilite(7931)" onMouseOut="lolite()" onClick="logVariable('oldcourse')" href="../_variables/oldcourse.html">$oldcourse</a> = new stdClass();
<a name="l4920"><span class="linenum">4920</span></a>      <a class="var it7931" onMouseOver="hilite(7931)" onMouseOut="lolite()" onClick="logVariable('oldcourse')" href="../_variables/oldcourse.html">$oldcourse</a>-&gt;<a onClick="logVariable('id')" class="var it41074" onMouseOver="hilite(41074)" onMouseOut="lolite()" href="../_variables/id.html">id</a>               = <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>;
<a name="l4921"><span class="linenum">4921</span></a>      <a class="var it7931" onMouseOver="hilite(7931)" onMouseOut="lolite()" onClick="logVariable('oldcourse')" href="../_variables/oldcourse.html">$oldcourse</a>-&gt;<a onClick="logVariable('summary')" class="var it41074" onMouseOver="hilite(41074)" onMouseOut="lolite()" href="../_variables/summary.html">summary</a>          = '';
<a name="l4922"><span class="linenum">4922</span></a>      <a class="var it7931" onMouseOver="hilite(7931)" onMouseOut="lolite()" onClick="logVariable('oldcourse')" href="../_variables/oldcourse.html">$oldcourse</a>-&gt;<a onClick="logVariable('cacherev')" class="var it41074" onMouseOver="hilite(41074)" onMouseOut="lolite()" href="../_variables/cacherev.html">cacherev</a>         = 0;
<a name="l4923"><span class="linenum">4923</span></a>      <a class="var it7931" onMouseOver="hilite(7931)" onMouseOut="lolite()" onClick="logVariable('oldcourse')" href="../_variables/oldcourse.html">$oldcourse</a>-&gt;<a onClick="logVariable('legacyfiles')" class="var it41074" onMouseOver="hilite(41074)" onMouseOut="lolite()" href="../_variables/legacyfiles.html">legacyfiles</a>      = 0;
<a name="l4924"><span class="linenum">4924</span></a>      <a class="var it7931" onMouseOver="hilite(7931)" onMouseOut="lolite()" onClick="logVariable('oldcourse')" href="../_variables/oldcourse.html">$oldcourse</a>-&gt;<a onClick="logVariable('enablecompletion')" class="var it41074" onMouseOver="hilite(41074)" onMouseOut="lolite()" href="../_variables/enablecompletion.html">enablecompletion</a> = 0;
<a name="l4925"><span class="linenum">4925</span></a>      if (!empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../_variables/options.html">$options</a>['keep_groups_and_groupings'])) {
<a name="l4926"><span class="linenum">4926</span></a>          <a class="var it7931" onMouseOver="hilite(7931)" onMouseOut="lolite()" onClick="logVariable('oldcourse')" href="../_variables/oldcourse.html">$oldcourse</a>-&gt;<a onClick="logVariable('defaultgroupingid')" class="var it41074" onMouseOver="hilite(41074)" onMouseOut="lolite()" href="../_variables/defaultgroupingid.html">defaultgroupingid</a> = 0;
<a name="l4927"><span class="linenum">4927</span></a>      }
<a name="l4928"><span class="linenum">4928</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('course', <a class="var it7931" onMouseOver="hilite(7931)" onMouseOut="lolite()" onClick="logVariable('oldcourse')" href="../_variables/oldcourse.html">$oldcourse</a>);
<a name="l4929"><span class="linenum">4929</span></a>  
<a name="l4930"><span class="linenum">4930</span></a>  <span class="comment">    // Delete course sections.</span>
<a name="l4931"><span class="linenum">4931</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('course_sections', array('course' =&gt; <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l4932"><span class="linenum">4932</span></a>  
<a name="l4933"><span class="linenum">4933</span></a>  <span class="comment">    // Delete legacy, section and any other course files.</span>
<a name="l4934"><span class="linenum">4934</span></a>      <a class="var it586" onMouseOver="hilite(586)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('delete_area_files')" href="../_functions/delete_area_files.html" onMouseOver="funcPopup(event,'delete_area_files')">delete_area_files</a>(<a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a>-&gt;<a onClick="logVariable('id')" class="var it39493" onMouseOver="hilite(39493)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, 'course'); <span class="comment">// Files from summary and section.</span>
<a name="l4935"><span class="linenum">4935</span></a>  
<a name="l4936"><span class="linenum">4936</span></a>  <span class="comment">    // Delete all remaining stuff linked to context such as files, comments, ratings, etc.</span>
<a name="l4937"><span class="linenum">4937</span></a>      if (empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../_variables/options.html">$options</a>['keep_roles_and_enrolments']) and empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../_variables/options.html">$options</a>['keep_groups_and_groupings'])) {
<a name="l4938"><span class="linenum">4938</span></a>  <span class="comment">        // Easy, do not delete the context itself...</span>
<a name="l4939"><span class="linenum">4939</span></a>          <a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a>-&gt;<a class="function" onClick="logFunction('delete_content')" href="../_functions/delete_content.html" onMouseOver="funcPopup(event,'delete_content')">delete_content</a>();
<a name="l4940"><span class="linenum">4940</span></a>      } else {
<a name="l4941"><span class="linenum">4941</span></a>  <span class="comment">        // Hack alert!!!!</span>
<a name="l4942"><span class="linenum">4942</span></a>  <span class="comment">        // We can not drop all context stuff because it would bork enrolments and roles,</span>
<a name="l4943"><span class="linenum">4943</span></a>  <span class="comment">        // there might be also files used by enrol plugins...</span>
<a name="l4944"><span class="linenum">4944</span></a>      }
<a name="l4945"><span class="linenum">4945</span></a>  
<a name="l4946"><span class="linenum">4946</span></a>  <span class="comment">    // Delete legacy files - just in case some files are still left there after conversion to new file api,</span>
<a name="l4947"><span class="linenum">4947</span></a>  <span class="comment">    // also some non-standard unsupported plugins may try to store something there.</span>
<a name="l4948"><span class="linenum">4948</span></a>      <a class="function" onClick="logFunction('fulldelete')" href="../_functions/fulldelete.html" onMouseOver="funcPopup(event,'fulldelete')">fulldelete</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dataroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dataroot.html">dataroot</a>.'/'.<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);
<a name="l4949"><span class="linenum">4949</span></a>  
<a name="l4950"><span class="linenum">4950</span></a>  <span class="comment">    // Delete from cache to reduce the cache size especially makes sense in case of bulk course deletion.</span>
<a name="l4951"><span class="linenum">4951</span></a>      <a class="var it13015" onMouseOver="hilite(13015)" onMouseOut="lolite()" onClick="logVariable('cachemodinfo')" href="../_variables/cachemodinfo.html">$cachemodinfo</a> = <a class="class" onClick="logClass('cache')" href="../_classes/cache.html" onMouseOver="classPopup(event,'cache')">cache</a>::<a class="function" onClick="logFunction('make')" href="../_functions/make.html" onMouseOver="funcPopup(event,'make')">make</a>('core', 'coursemodinfo');
<a name="l4952"><span class="linenum">4952</span></a>      <a class="var it13015" onMouseOver="hilite(13015)" onMouseOut="lolite()" onClick="logVariable('cachemodinfo')" href="../_variables/cachemodinfo.html">$cachemodinfo</a>-&gt;<a class="function" onClick="logFunction('delete')" href="../_functions/delete.html" onMouseOver="funcPopup(event,'delete')">delete</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>);
<a name="l4953"><span class="linenum">4953</span></a>  
<a name="l4954"><span class="linenum">4954</span></a>  <span class="comment">    // Trigger a course content deleted event.</span>
<a name="l4955"><span class="linenum">4955</span></a>      <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a> = \core\event\<a class="class" onClick="logClass('course_content_deleted')" href="../_classes/course_content_deleted.html" onMouseOver="classPopup(event,'course_content_deleted')">course_content_deleted</a>::<a class="function" onClick="logFunction('create')" href="../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(array(
<a name="l4956"><span class="linenum">4956</span></a>          'objectid' =&gt; <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l4957"><span class="linenum">4957</span></a>          'context' =&gt; <a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../_variables/coursecontext.html">$coursecontext</a>,
<a name="l4958"><span class="linenum">4958</span></a>          'other' =&gt; array('shortname' =&gt; <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('shortname')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/shortname.html">shortname</a>,
<a name="l4959"><span class="linenum">4959</span></a>                           'fullname' =&gt; <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('fullname')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/fullname.html">fullname</a>,
<a name="l4960"><span class="linenum">4960</span></a>                           'options' =&gt; <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../_variables/options.html">$options</a>) // Passing this for legacy reasons.
<a name="l4961"><span class="linenum">4961</span></a>      ));
<a name="l4962"><span class="linenum">4962</span></a>      <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('course', <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>);
<a name="l4963"><span class="linenum">4963</span></a>      <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l4964"><span class="linenum">4964</span></a>  
<a name="l4965"><span class="linenum">4965</span></a>      return true;
<a name="l4966"><span class="linenum">4966</span></a>  }
<a name="l4967"><span class="linenum">4967</span></a>  
<a name="l4968"><span class="linenum">4968</span></a>  <span class="comment">/**</span>
<a name="l4969"><span class="linenum">4969</span></a>  <span class="comment"> * Change dates in module - used from course reset.</span>
<a name="l4970"><span class="linenum">4970</span></a>  <span class="comment"> *</span>
<a name="l4971"><span class="linenum">4971</span></a>  <span class="comment"> * @param string $modname forum, assignment, etc</span>
<a name="l4972"><span class="linenum">4972</span></a>  <span class="comment"> * @param array $fields array of date fields from mod table</span>
<a name="l4973"><span class="linenum">4973</span></a>  <span class="comment"> * @param int $timeshift time difference</span>
<a name="l4974"><span class="linenum">4974</span></a>  <span class="comment"> * @param int $courseid</span>
<a name="l4975"><span class="linenum">4975</span></a>  <span class="comment"> * @param int $modid (Optional) passed if specific mod instance in course needs to be updated.</span>
<a name="l4976"><span class="linenum">4976</span></a>  <span class="comment"> * @return bool success</span>
<a name="l4977"><span class="linenum">4977</span></a>  <span class="comment"> */</span>
<a name="l4978"><span class="linenum">4978</span></a>  function <a class="function" onClick="logFunction('shift_course_mod_dates')" href="../_functions/shift_course_mod_dates.html" onMouseOver="funcPopup(event,'shift_course_mod_dates')">shift_course_mod_dates</a>(<a class="var it561" onMouseOver="hilite(561)" onMouseOut="lolite()" onClick="logVariable('modname')" href="../_variables/modname.html">$modname</a>, <a class="var it399" onMouseOver="hilite(399)" onMouseOut="lolite()" onClick="logVariable('fields')" href="../_variables/fields.html">$fields</a>, <a class="var it13016" onMouseOver="hilite(13016)" onMouseOut="lolite()" onClick="logVariable('timeshift')" href="../_variables/timeshift.html">$timeshift</a>, <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>, <a class="var it5866" onMouseOver="hilite(5866)" onMouseOut="lolite()" onClick="logVariable('modid')" href="../_variables/modid.html">$modid</a> = 0) {
<a name="l4979"><span class="linenum">4979</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l4980"><span class="linenum">4980</span></a>      include_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'/mod/'.<a class="var it561" onMouseOver="hilite(561)" onMouseOut="lolite()" onClick="logVariable('modname')" href="../_variables/modname.html">$modname</a>.'/lib.php');
<a name="l4981"><span class="linenum">4981</span></a>  
<a name="l4982"><span class="linenum">4982</span></a>      <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a> = true;
<a name="l4983"><span class="linenum">4983</span></a>      <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array(<a class="var it13016" onMouseOver="hilite(13016)" onMouseOut="lolite()" onClick="logVariable('timeshift')" href="../_variables/timeshift.html">$timeshift</a>, <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>);
<a name="l4984"><span class="linenum">4984</span></a>      foreach (<a class="var it399" onMouseOver="hilite(399)" onMouseOut="lolite()" onClick="logVariable('fields')" href="../_variables/fields.html">$fields</a> as <a class="var it1464" onMouseOver="hilite(1464)" onMouseOut="lolite()" onClick="logVariable('field')" href="../_variables/field.html">$field</a>) {
<a name="l4985"><span class="linenum">4985</span></a>          <a class="var it13017" onMouseOver="hilite(13017)" onMouseOut="lolite()" onClick="logVariable('updatesql')" href="../_variables/updatesql.html">$updatesql</a> = &quot;UPDATE {&quot;.<a class="var it561" onMouseOver="hilite(561)" onMouseOut="lolite()" onClick="logVariable('modname')" href="../_variables/modname.html">$modname</a>.&quot;}
<a name="l4986"><span class="linenum">4986</span></a>                            SET <a class="var it1464" onMouseOver="hilite(1464)" onMouseOut="lolite()" onClick="logVariable('field')" href="../_variables/field.html">$field</a> = <a class="var it1464" onMouseOver="hilite(1464)" onMouseOut="lolite()" onClick="logVariable('field')" href="../_variables/field.html">$field</a> + ?
<a name="l4987"><span class="linenum">4987</span></a>                          WHERE course=? AND <a class="var it1464" onMouseOver="hilite(1464)" onMouseOut="lolite()" onClick="logVariable('field')" href="../_variables/field.html">$field</a>&lt;&gt;0&quot;;
<a name="l4988"><span class="linenum">4988</span></a>          if (<a class="var it5866" onMouseOver="hilite(5866)" onMouseOut="lolite()" onClick="logVariable('modid')" href="../_variables/modid.html">$modid</a>) {
<a name="l4989"><span class="linenum">4989</span></a>              <a class="var it13017" onMouseOver="hilite(13017)" onMouseOut="lolite()" onClick="logVariable('updatesql')" href="../_variables/updatesql.html">$updatesql</a> .= ' AND id=?';
<a name="l4990"><span class="linenum">4990</span></a>              <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>[] = <a class="var it5866" onMouseOver="hilite(5866)" onMouseOut="lolite()" onClick="logVariable('modid')" href="../_variables/modid.html">$modid</a>;
<a name="l4991"><span class="linenum">4991</span></a>          }
<a name="l4992"><span class="linenum">4992</span></a>          <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>(<a class="var it13017" onMouseOver="hilite(13017)" onMouseOut="lolite()" onClick="logVariable('updatesql')" href="../_variables/updatesql.html">$updatesql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>) &amp;&amp; <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a>;
<a name="l4993"><span class="linenum">4993</span></a>      }
<a name="l4994"><span class="linenum">4994</span></a>  
<a name="l4995"><span class="linenum">4995</span></a>      <a class="var it13018" onMouseOver="hilite(13018)" onMouseOut="lolite()" onClick="logVariable('refreshfunction')" href="../_variables/refreshfunction.html">$refreshfunction</a> = <a class="var it561" onMouseOver="hilite(561)" onMouseOut="lolite()" onClick="logVariable('modname')" href="../_variables/modname.html">$modname</a>.'_refresh_events';
<a name="l4996"><span class="linenum">4996</span></a>      if (<a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>(<a class="var it13018" onMouseOver="hilite(13018)" onMouseOut="lolite()" onClick="logVariable('refreshfunction')" href="../_variables/refreshfunction.html">$refreshfunction</a>)) {
<a name="l4997"><span class="linenum">4997</span></a>          <a class="var it13018" onMouseOver="hilite(13018)" onMouseOut="lolite()" onClick="logVariable('refreshfunction')" href="../_variables/refreshfunction.html">$refreshfunction</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>);
<a name="l4998"><span class="linenum">4998</span></a>      }
<a name="l4999"><span class="linenum">4999</span></a>  
<a name="l5000"><span class="linenum">5000</span></a>      return <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a>;
<a name="l5001"><span class="linenum">5001</span></a>  }
<a name="l5002"><span class="linenum">5002</span></a>  
<a name="l5003"><span class="linenum">5003</span></a>  <span class="comment">/**</span>
<a name="l5004"><span class="linenum">5004</span></a>  <span class="comment"> * This function will empty a course of user data.</span>
<a name="l5005"><span class="linenum">5005</span></a>  <span class="comment"> * It will retain the activities and the structure of the course.</span>
<a name="l5006"><span class="linenum">5006</span></a>  <span class="comment"> *</span>
<a name="l5007"><span class="linenum">5007</span></a>  <span class="comment"> * @param object $data an object containing all the settings including courseid (without magic quotes)</span>
<a name="l5008"><span class="linenum">5008</span></a>  <span class="comment"> * @return array status array of array component, item, error</span>
<a name="l5009"><span class="linenum">5009</span></a>  <span class="comment"> */</span>
<a name="l5010"><span class="linenum">5010</span></a>  function <a class="function" onClick="logFunction('reset_course_userdata')" href="../_functions/reset_course_userdata.html" onMouseOver="funcPopup(event,'reset_course_userdata')">reset_course_userdata</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>) {
<a name="l5011"><span class="linenum">5011</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l5012"><span class="linenum">5012</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/libdir.html">libdir</a>.'/gradelib.php');
<a name="l5013"><span class="linenum">5013</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/libdir.html">libdir</a>.'/completionlib.php');
<a name="l5014"><span class="linenum">5014</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../group/lib.php.html">/group/lib.php</a>');
<a name="l5015"><span class="linenum">5015</span></a>  
<a name="l5016"><span class="linenum">5016</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a> = <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('id')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/id.html">id</a>;
<a name="l5017"><span class="linenum">5017</span></a>      <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_course')" href="../_classes/context_course.html" onMouseOver="classPopup(event,'context_course')">context_course</a>::<a class="function" onClick="logFunction('instance')" href="../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>);
<a name="l5018"><span class="linenum">5018</span></a>  
<a name="l5019"><span class="linenum">5019</span></a>      <a class="var it1765" onMouseOver="hilite(1765)" onMouseOut="lolite()" onClick="logVariable('eventparams')" href="../_variables/eventparams.html">$eventparams</a> = array(
<a name="l5020"><span class="linenum">5020</span></a>          'context' =&gt; <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>,
<a name="l5021"><span class="linenum">5021</span></a>          'courseid' =&gt; <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('id')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l5022"><span class="linenum">5022</span></a>          'other' =&gt; array(
<a name="l5023"><span class="linenum">5023</span></a>              'reset_options' =&gt; (array) <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>
<a name="l5024"><span class="linenum">5024</span></a>          )
<a name="l5025"><span class="linenum">5025</span></a>      );
<a name="l5026"><span class="linenum">5026</span></a>      <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a> = \core\event\<a class="class" onClick="logClass('course_reset_started')" href="../_classes/course_reset_started.html" onMouseOver="classPopup(event,'course_reset_started')">course_reset_started</a>::<a class="function" onClick="logFunction('create')" href="../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(<a class="var it1765" onMouseOver="hilite(1765)" onMouseOut="lolite()" onClick="logVariable('eventparams')" href="../_variables/eventparams.html">$eventparams</a>);
<a name="l5027"><span class="linenum">5027</span></a>      <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l5028"><span class="linenum">5028</span></a>  
<a name="l5029"><span class="linenum">5029</span></a>  <span class="comment">    // Calculate the time shift of dates.</span>
<a name="l5030"><span class="linenum">5030</span></a>      if (!empty(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('reset_start_date')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/reset_start_date.html">reset_start_date</a>)) {
<a name="l5031"><span class="linenum">5031</span></a>  <span class="comment">        // Time part of course startdate should be zero.</span>
<a name="l5032"><span class="linenum">5032</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('timeshift')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/timeshift.html">timeshift</a> = <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('reset_start_date')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/reset_start_date.html">reset_start_date</a> - <a class="function" onClick="logFunction('usergetmidnight')" href="../_functions/usergetmidnight.html" onMouseOver="funcPopup(event,'usergetmidnight')">usergetmidnight</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('reset_start_date_old')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/reset_start_date_old.html">reset_start_date_old</a>);
<a name="l5033"><span class="linenum">5033</span></a>      } else {
<a name="l5034"><span class="linenum">5034</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('timeshift')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/timeshift.html">timeshift</a> = 0;
<a name="l5035"><span class="linenum">5035</span></a>      }
<a name="l5036"><span class="linenum">5036</span></a>  
<a name="l5037"><span class="linenum">5037</span></a>  <span class="comment">    // Result array: component, item, error.</span>
<a name="l5038"><span class="linenum">5038</span></a>      <a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a> = array();
<a name="l5039"><span class="linenum">5039</span></a>  
<a name="l5040"><span class="linenum">5040</span></a>  <span class="comment">    // Start the resetting.</span>
<a name="l5041"><span class="linenum">5041</span></a>      <a class="var it13021" onMouseOver="hilite(13021)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../_variables/componentstr.html">$componentstr</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('general');
<a name="l5042"><span class="linenum">5042</span></a>  
<a name="l5043"><span class="linenum">5043</span></a>  <span class="comment">    // Move the course start time.</span>
<a name="l5044"><span class="linenum">5044</span></a>      if (!empty(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('reset_start_date')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/reset_start_date.html">reset_start_date</a>) and <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('timeshift')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/timeshift.html">timeshift</a>) {
<a name="l5045"><span class="linenum">5045</span></a>  <span class="comment">        // Change course start data.</span>
<a name="l5046"><span class="linenum">5046</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('course', 'startdate', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('reset_start_date')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/reset_start_date.html">reset_start_date</a>, array('id' =&gt; <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>));
<a name="l5047"><span class="linenum">5047</span></a>  <span class="comment">        // Update all course and group events - do not move activity events.</span>
<a name="l5048"><span class="linenum">5048</span></a>          <a class="var it13017" onMouseOver="hilite(13017)" onMouseOut="lolite()" onClick="logVariable('updatesql')" href="../_variables/updatesql.html">$updatesql</a> = &quot;UPDATE {event}
<a name="l5049"><span class="linenum">5049</span></a>                           SET timestart = timestart + ?
<a name="l5050"><span class="linenum">5050</span></a>                         WHERE courseid=? AND instance=0&quot;;
<a name="l5051"><span class="linenum">5051</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>(<a class="var it13017" onMouseOver="hilite(13017)" onMouseOut="lolite()" onClick="logVariable('updatesql')" href="../_variables/updatesql.html">$updatesql</a>, array(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('timeshift')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/timeshift.html">timeshift</a>, <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>));
<a name="l5052"><span class="linenum">5052</span></a>  
<a name="l5053"><span class="linenum">5053</span></a>          <a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a>[] = array('component' =&gt; <a class="var it13021" onMouseOver="hilite(13021)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../_variables/componentstr.html">$componentstr</a>, 'item' =&gt; <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('datechanged'), 'error' =&gt; false);
<a name="l5054"><span class="linenum">5054</span></a>      }
<a name="l5055"><span class="linenum">5055</span></a>  
<a name="l5056"><span class="linenum">5056</span></a>      if (!empty(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('reset_events')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/reset_events.html">reset_events</a>)) {
<a name="l5057"><span class="linenum">5057</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('event', array('courseid' =&gt; <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>));
<a name="l5058"><span class="linenum">5058</span></a>          <a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a>[] = array('component' =&gt; <a class="var it13021" onMouseOver="hilite(13021)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../_variables/componentstr.html">$componentstr</a>, 'item' =&gt; <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('deleteevents', 'calendar'), 'error' =&gt; false);
<a name="l5059"><span class="linenum">5059</span></a>      }
<a name="l5060"><span class="linenum">5060</span></a>  
<a name="l5061"><span class="linenum">5061</span></a>      if (!empty(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('reset_notes')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/reset_notes.html">reset_notes</a>)) {
<a name="l5062"><span class="linenum">5062</span></a>          require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../notes/lib.php.html">/notes/lib.php</a>');
<a name="l5063"><span class="linenum">5063</span></a>          <a class="function" onClick="logFunction('note_delete_all')" href="../_functions/note_delete_all.html" onMouseOver="funcPopup(event,'note_delete_all')">note_delete_all</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>);
<a name="l5064"><span class="linenum">5064</span></a>          <a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a>[] = array('component' =&gt; <a class="var it13021" onMouseOver="hilite(13021)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../_variables/componentstr.html">$componentstr</a>, 'item' =&gt; <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('deletenotes', 'notes'), 'error' =&gt; false);
<a name="l5065"><span class="linenum">5065</span></a>      }
<a name="l5066"><span class="linenum">5066</span></a>  
<a name="l5067"><span class="linenum">5067</span></a>      if (!empty(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('delete_blog_associations')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/delete_blog_associations.html">delete_blog_associations</a>)) {
<a name="l5068"><span class="linenum">5068</span></a>          require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../blog/lib.php.html">/blog/lib.php</a>');
<a name="l5069"><span class="linenum">5069</span></a>          <a class="function" onClick="logFunction('blog_remove_associations_for_course')" href="../_functions/blog_remove_associations_for_course.html" onMouseOver="funcPopup(event,'blog_remove_associations_for_course')">blog_remove_associations_for_course</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>);
<a name="l5070"><span class="linenum">5070</span></a>          <a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a>[] = array('component' =&gt; <a class="var it13021" onMouseOver="hilite(13021)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../_variables/componentstr.html">$componentstr</a>, 'item' =&gt; <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('deleteblogassociations', 'blog'), 'error' =&gt; false);
<a name="l5071"><span class="linenum">5071</span></a>      }
<a name="l5072"><span class="linenum">5072</span></a>  
<a name="l5073"><span class="linenum">5073</span></a>      if (!empty(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('reset_completion')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/reset_completion.html">reset_completion</a>)) {
<a name="l5074"><span class="linenum">5074</span></a>  <span class="comment">        // Delete course and activity completion information.</span>
<a name="l5075"><span class="linenum">5075</span></a>          <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('course', array('id' =&gt; <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>));
<a name="l5076"><span class="linenum">5076</span></a>          <a class="var it6097" onMouseOver="hilite(6097)" onMouseOut="lolite()" onClick="logVariable('cc')" href="../_variables/cc.html">$cc</a> = <span class="keyword">new </span><a class="class" onClick="logClass('completion_info')" href="../_classes/completion_info.html" onMouseOver="classPopup(event,'completion_info')">completion_info</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>);
<a name="l5077"><span class="linenum">5077</span></a>          <a class="var it6097" onMouseOver="hilite(6097)" onMouseOut="lolite()" onClick="logVariable('cc')" href="../_variables/cc.html">$cc</a>-&gt;<a class="function" onClick="logFunction('delete_all_completion_data')" href="../_functions/delete_all_completion_data.html" onMouseOver="funcPopup(event,'delete_all_completion_data')">delete_all_completion_data</a>();
<a name="l5078"><span class="linenum">5078</span></a>          <a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a>[] = array('component' =&gt; <a class="var it13021" onMouseOver="hilite(13021)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../_variables/componentstr.html">$componentstr</a>,
<a name="l5079"><span class="linenum">5079</span></a>                  'item' =&gt; <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('deletecompletiondata', 'completion'), 'error' =&gt; false);
<a name="l5080"><span class="linenum">5080</span></a>      }
<a name="l5081"><span class="linenum">5081</span></a>  
<a name="l5082"><span class="linenum">5082</span></a>      <a class="var it13021" onMouseOver="hilite(13021)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../_variables/componentstr.html">$componentstr</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('roles');
<a name="l5083"><span class="linenum">5083</span></a>  
<a name="l5084"><span class="linenum">5084</span></a>      if (!empty(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('reset_roles_overrides')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/reset_roles_overrides.html">reset_roles_overrides</a>)) {
<a name="l5085"><span class="linenum">5085</span></a>          <a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../_variables/children.html">$children</a> = <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>-&gt;<a class="function" onClick="logFunction('get_child_contexts')" href="../_functions/get_child_contexts.html" onMouseOver="funcPopup(event,'get_child_contexts')">get_child_contexts</a>();
<a name="l5086"><span class="linenum">5086</span></a>          foreach (<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../_variables/children.html">$children</a> as <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../_variables/child.html">$child</a>) {
<a name="l5087"><span class="linenum">5087</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('role_capabilities', array('contextid' =&gt; <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../_variables/child.html">$child</a>-&gt;<a onClick="logVariable('id')" class="var it39612" onMouseOver="hilite(39612)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l5088"><span class="linenum">5088</span></a>          }
<a name="l5089"><span class="linenum">5089</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('role_capabilities', array('contextid' =&gt; <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it39491" onMouseOver="hilite(39491)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l5090"><span class="linenum">5090</span></a>  <span class="comment">        // Force refresh for logged in users.</span>
<a name="l5091"><span class="linenum">5091</span></a>          <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>-&gt;<a class="function" onClick="logFunction('mark_dirty')" href="../_functions/mark_dirty.html" onMouseOver="funcPopup(event,'mark_dirty')">mark_dirty</a>();
<a name="l5092"><span class="linenum">5092</span></a>          <a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a>[] = array('component' =&gt; <a class="var it13021" onMouseOver="hilite(13021)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../_variables/componentstr.html">$componentstr</a>, 'item' =&gt; <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('deletecourseoverrides', 'role'), 'error' =&gt; false);
<a name="l5093"><span class="linenum">5093</span></a>      }
<a name="l5094"><span class="linenum">5094</span></a>  
<a name="l5095"><span class="linenum">5095</span></a>      if (!empty(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('reset_roles_local')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/reset_roles_local.html">reset_roles_local</a>)) {
<a name="l5096"><span class="linenum">5096</span></a>          <a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../_variables/children.html">$children</a> = <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>-&gt;<a class="function" onClick="logFunction('get_child_contexts')" href="../_functions/get_child_contexts.html" onMouseOver="funcPopup(event,'get_child_contexts')">get_child_contexts</a>();
<a name="l5097"><span class="linenum">5097</span></a>          foreach (<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../_variables/children.html">$children</a> as <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../_variables/child.html">$child</a>) {
<a name="l5098"><span class="linenum">5098</span></a>              <a class="function" onClick="logFunction('role_unassign_all')" href="../_functions/role_unassign_all.html" onMouseOver="funcPopup(event,'role_unassign_all')">role_unassign_all</a>(array('contextid' =&gt; <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../_variables/child.html">$child</a>-&gt;<a onClick="logVariable('id')" class="var it39612" onMouseOver="hilite(39612)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l5099"><span class="linenum">5099</span></a>          }
<a name="l5100"><span class="linenum">5100</span></a>  <span class="comment">        // Force refresh for logged in users.</span>
<a name="l5101"><span class="linenum">5101</span></a>          <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>-&gt;<a class="function" onClick="logFunction('mark_dirty')" href="../_functions/mark_dirty.html" onMouseOver="funcPopup(event,'mark_dirty')">mark_dirty</a>();
<a name="l5102"><span class="linenum">5102</span></a>          <a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a>[] = array('component' =&gt; <a class="var it13021" onMouseOver="hilite(13021)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../_variables/componentstr.html">$componentstr</a>, 'item' =&gt; <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('deletelocalroles', 'role'), 'error' =&gt; false);
<a name="l5103"><span class="linenum">5103</span></a>      }
<a name="l5104"><span class="linenum">5104</span></a>  
<a name="l5105"><span class="linenum">5105</span></a>  <span class="comment">    // First unenrol users - this cleans some of related user data too, such as forum subscriptions, tracking, etc.</span>
<a name="l5106"><span class="linenum">5106</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('unenrolled')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/unenrolled.html">unenrolled</a> = array();
<a name="l5107"><span class="linenum">5107</span></a>      if (!empty(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('unenrol_users')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/unenrol_users.html">unenrol_users</a>)) {
<a name="l5108"><span class="linenum">5108</span></a>          <a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('plugins')" href="../_variables/plugins.html">$plugins</a> = <a class="function" onClick="logFunction('enrol_get_plugins')" href="../_functions/enrol_get_plugins.html" onMouseOver="funcPopup(event,'enrol_get_plugins')">enrol_get_plugins</a>(true);
<a name="l5109"><span class="linenum">5109</span></a>          <a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('instances')" href="../_variables/instances.html">$instances</a> = <a class="function" onClick="logFunction('enrol_get_instances')" href="../_functions/enrol_get_instances.html" onMouseOver="funcPopup(event,'enrol_get_instances')">enrol_get_instances</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>, true);
<a name="l5110"><span class="linenum">5110</span></a>          foreach (<a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('instances')" href="../_variables/instances.html">$instances</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>) {
<a name="l5111"><span class="linenum">5111</span></a>              if (!isset(<a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('plugins')" href="../_variables/plugins.html">$plugins</a>[<a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('enrol')" class="var it39530" onMouseOver="hilite(39530)" onMouseOut="lolite()" href="../_variables/enrol.html">enrol</a>])) {
<a name="l5112"><span class="linenum">5112</span></a>                  unset(<a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('instances')" href="../_variables/instances.html">$instances</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>]);
<a name="l5113"><span class="linenum">5113</span></a>                  continue;
<a name="l5114"><span class="linenum">5114</span></a>              }
<a name="l5115"><span class="linenum">5115</span></a>          }
<a name="l5116"><span class="linenum">5116</span></a>  
<a name="l5117"><span class="linenum">5117</span></a>          foreach (<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('unenrol_users')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/unenrol_users.html">unenrol_users</a> as <a class="var it13030" onMouseOver="hilite(13030)" onMouseOut="lolite()" onClick="logVariable('withroleid')" href="../_variables/withroleid.html">$withroleid</a>) {
<a name="l5118"><span class="linenum">5118</span></a>              if (<a class="var it13030" onMouseOver="hilite(13030)" onMouseOut="lolite()" onClick="logVariable('withroleid')" href="../_variables/withroleid.html">$withroleid</a>) {
<a name="l5119"><span class="linenum">5119</span></a>                  <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../_variables/sql.html">$sql</a> = &quot;SELECT ue.*
<a name="l5120"><span class="linenum">5120</span></a>                            FROM {user_enrolments} ue
<a name="l5121"><span class="linenum">5121</span></a>                            JOIN {enrol} e <a class="function" onClick="logFunction('ON')" href="../_functions/on.html" onMouseOver="funcPopup(event,'on')">ON</a> (e.id = ue.enrolid AND e.courseid = :courseid)
<a name="l5122"><span class="linenum">5122</span></a>                            JOIN {context} c <a class="function" onClick="logFunction('ON')" href="../_functions/on.html" onMouseOver="funcPopup(event,'on')">ON</a> (c.contextlevel = :courselevel AND c.instanceid = e.courseid)
<a name="l5123"><span class="linenum">5123</span></a>                            JOIN {role_assignments} ra <a class="function" onClick="logFunction('ON')" href="../_functions/on.html" onMouseOver="funcPopup(event,'on')">ON</a> (ra.contextid = c.id AND ra.roleid = :roleid AND ra.userid = ue.userid)&quot;;
<a name="l5124"><span class="linenum">5124</span></a>                  <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array('courseid' =&gt; <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>, 'roleid' =&gt; <a class="var it13030" onMouseOver="hilite(13030)" onMouseOut="lolite()" onClick="logVariable('withroleid')" href="../_variables/withroleid.html">$withroleid</a>, 'courselevel' =&gt; <a class="constant" onClick="logConstant('CONTEXT_COURSE')" href="../_constants/CONTEXT_COURSE.html" onMouseOver="constPopup(event,'CONTEXT_COURSE')">CONTEXT_COURSE</a>);
<a name="l5125"><span class="linenum">5125</span></a>  
<a name="l5126"><span class="linenum">5126</span></a>              } else {
<a name="l5127"><span class="linenum">5127</span></a>  <span class="comment">                // Without any role assigned at course context.</span>
<a name="l5128"><span class="linenum">5128</span></a>                  <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../_variables/sql.html">$sql</a> = &quot;SELECT ue.*
<a name="l5129"><span class="linenum">5129</span></a>                            FROM {user_enrolments} ue
<a name="l5130"><span class="linenum">5130</span></a>                            JOIN {enrol} e <a class="function" onClick="logFunction('ON')" href="../_functions/on.html" onMouseOver="funcPopup(event,'on')">ON</a> (e.id = ue.enrolid AND e.courseid = :courseid)
<a name="l5131"><span class="linenum">5131</span></a>                            JOIN {context} c <a class="function" onClick="logFunction('ON')" href="../_functions/on.html" onMouseOver="funcPopup(event,'on')">ON</a> (c.contextlevel = :courselevel AND c.instanceid = e.courseid)
<a name="l5132"><span class="linenum">5132</span></a>                       LEFT JOIN {role_assignments} ra <a class="function" onClick="logFunction('ON')" href="../_functions/on.html" onMouseOver="funcPopup(event,'on')">ON</a> (ra.contextid = c.id AND ra.userid = ue.userid)
<a name="l5133"><span class="linenum">5133</span></a>                           WHERE ra.id IS null&quot;;
<a name="l5134"><span class="linenum">5134</span></a>                  <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array('courseid' =&gt; <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>, 'courselevel' =&gt; <a class="constant" onClick="logConstant('CONTEXT_COURSE')" href="../_constants/CONTEXT_COURSE.html" onMouseOver="constPopup(event,'CONTEXT_COURSE')">CONTEXT_COURSE</a>);
<a name="l5135"><span class="linenum">5135</span></a>              }
<a name="l5136"><span class="linenum">5136</span></a>  
<a name="l5137"><span class="linenum">5137</span></a>              <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../_variables/rs.html">$rs</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset_sql')" href="../_functions/get_recordset_sql.html" onMouseOver="funcPopup(event,'get_recordset_sql')">get_recordset_sql</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../_variables/sql.html">$sql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>);
<a name="l5138"><span class="linenum">5138</span></a>              foreach (<a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../_variables/rs.html">$rs</a> as <a class="var it3129" onMouseOver="hilite(3129)" onMouseOut="lolite()" onClick="logVariable('ue')" href="../_variables/ue.html">$ue</a>) {
<a name="l5139"><span class="linenum">5139</span></a>                  if (!isset(<a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('instances')" href="../_variables/instances.html">$instances</a>[<a class="var it3129" onMouseOver="hilite(3129)" onMouseOut="lolite()" onClick="logVariable('ue')" href="../_variables/ue.html">$ue</a>-&gt;<a onClick="logVariable('enrolid')" class="var it39591" onMouseOver="hilite(39591)" onMouseOut="lolite()" href="../_variables/enrolid.html">enrolid</a>])) {
<a name="l5140"><span class="linenum">5140</span></a>                      continue;
<a name="l5141"><span class="linenum">5141</span></a>                  }
<a name="l5142"><span class="linenum">5142</span></a>                  <a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a> = <a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('instances')" href="../_variables/instances.html">$instances</a>[<a class="var it3129" onMouseOver="hilite(3129)" onMouseOut="lolite()" onClick="logVariable('ue')" href="../_variables/ue.html">$ue</a>-&gt;<a onClick="logVariable('enrolid')" class="var it39591" onMouseOver="hilite(39591)" onMouseOut="lolite()" href="../_variables/enrolid.html">enrolid</a>];
<a name="l5143"><span class="linenum">5143</span></a>                  <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a> = <a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('plugins')" href="../_variables/plugins.html">$plugins</a>[<a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('enrol')" class="var it39530" onMouseOver="hilite(39530)" onMouseOut="lolite()" href="../_variables/enrol.html">enrol</a>];
<a name="l5144"><span class="linenum">5144</span></a>                  if (!<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>-&gt;<a class="function" onClick="logFunction('allow_unenrol')" href="../_functions/allow_unenrol.html" onMouseOver="funcPopup(event,'allow_unenrol')">allow_unenrol</a>(<a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>) and !<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>-&gt;<a class="function" onClick="logFunction('allow_unenrol_user')" href="../_functions/allow_unenrol_user.html" onMouseOver="funcPopup(event,'allow_unenrol_user')">allow_unenrol_user</a>(<a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>, <a class="var it3129" onMouseOver="hilite(3129)" onMouseOut="lolite()" onClick="logVariable('ue')" href="../_variables/ue.html">$ue</a>)) {
<a name="l5145"><span class="linenum">5145</span></a>                      continue;
<a name="l5146"><span class="linenum">5146</span></a>                  }
<a name="l5147"><span class="linenum">5147</span></a>  
<a name="l5148"><span class="linenum">5148</span></a>                  <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>-&gt;<a class="function" onClick="logFunction('unenrol_user')" href="../_functions/unenrol_user.html" onMouseOver="funcPopup(event,'unenrol_user')">unenrol_user</a>(<a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>, <a class="var it3129" onMouseOver="hilite(3129)" onMouseOut="lolite()" onClick="logVariable('ue')" href="../_variables/ue.html">$ue</a>-&gt;<a onClick="logVariable('userid')" class="var it39591" onMouseOver="hilite(39591)" onMouseOut="lolite()" href="../_variables/userid.html">userid</a>);
<a name="l5149"><span class="linenum">5149</span></a>                  <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('unenrolled')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/unenrolled.html">unenrolled</a>[<a class="var it3129" onMouseOver="hilite(3129)" onMouseOut="lolite()" onClick="logVariable('ue')" href="../_variables/ue.html">$ue</a>-&gt;<a onClick="logVariable('userid')" class="var it39591" onMouseOver="hilite(39591)" onMouseOut="lolite()" href="../_variables/userid.html">userid</a>] = <a class="var it3129" onMouseOver="hilite(3129)" onMouseOut="lolite()" onClick="logVariable('ue')" href="../_variables/ue.html">$ue</a>-&gt;<a onClick="logVariable('userid')" class="var it39591" onMouseOver="hilite(39591)" onMouseOut="lolite()" href="../_variables/userid.html">userid</a>;
<a name="l5150"><span class="linenum">5150</span></a>              }
<a name="l5151"><span class="linenum">5151</span></a>              <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../_variables/rs.html">$rs</a>-&gt;<a class="function" onClick="logFunction('close')" href="../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l5152"><span class="linenum">5152</span></a>          }
<a name="l5153"><span class="linenum">5153</span></a>      }
<a name="l5154"><span class="linenum">5154</span></a>      if (!empty(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('unenrolled')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/unenrolled.html">unenrolled</a>)) {
<a name="l5155"><span class="linenum">5155</span></a>          <a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a>[] = array(
<a name="l5156"><span class="linenum">5156</span></a>              'component' =&gt; <a class="var it13021" onMouseOver="hilite(13021)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../_variables/componentstr.html">$componentstr</a>,
<a name="l5157"><span class="linenum">5157</span></a>              'item' =&gt; <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('unenrol', 'enrol').' ('.<a class="phpfunction" onClick="logFunction('count')" href="../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('unenrolled')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/unenrolled.html">unenrolled</a>).')',
<a name="l5158"><span class="linenum">5158</span></a>              'error' =&gt; false
<a name="l5159"><span class="linenum">5159</span></a>          );
<a name="l5160"><span class="linenum">5160</span></a>      }
<a name="l5161"><span class="linenum">5161</span></a>  
<a name="l5162"><span class="linenum">5162</span></a>      <a class="var it13021" onMouseOver="hilite(13021)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../_variables/componentstr.html">$componentstr</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('groups');
<a name="l5163"><span class="linenum">5163</span></a>  
<a name="l5164"><span class="linenum">5164</span></a>  <span class="comment">    // Remove all group members.</span>
<a name="l5165"><span class="linenum">5165</span></a>      if (!empty(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('reset_groups_members')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/reset_groups_members.html">reset_groups_members</a>)) {
<a name="l5166"><span class="linenum">5166</span></a>          <a class="function" onClick="logFunction('groups_delete_group_members')" href="../_functions/groups_delete_group_members.html" onMouseOver="funcPopup(event,'groups_delete_group_members')">groups_delete_group_members</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>);
<a name="l5167"><span class="linenum">5167</span></a>          <a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a>[] = array('component' =&gt; <a class="var it13021" onMouseOver="hilite(13021)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../_variables/componentstr.html">$componentstr</a>, 'item' =&gt; <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('removegroupsmembers', 'group'), 'error' =&gt; false);
<a name="l5168"><span class="linenum">5168</span></a>      }
<a name="l5169"><span class="linenum">5169</span></a>  
<a name="l5170"><span class="linenum">5170</span></a>  <span class="comment">    // Remove all groups.</span>
<a name="l5171"><span class="linenum">5171</span></a>      if (!empty(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('reset_groups_remove')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/reset_groups_remove.html">reset_groups_remove</a>)) {
<a name="l5172"><span class="linenum">5172</span></a>          <a class="function" onClick="logFunction('groups_delete_groups')" href="../_functions/groups_delete_groups.html" onMouseOver="funcPopup(event,'groups_delete_groups')">groups_delete_groups</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>, false);
<a name="l5173"><span class="linenum">5173</span></a>          <a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a>[] = array('component' =&gt; <a class="var it13021" onMouseOver="hilite(13021)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../_variables/componentstr.html">$componentstr</a>, 'item' =&gt; <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('deleteallgroups', 'group'), 'error' =&gt; false);
<a name="l5174"><span class="linenum">5174</span></a>      }
<a name="l5175"><span class="linenum">5175</span></a>  
<a name="l5176"><span class="linenum">5176</span></a>  <span class="comment">    // Remove all grouping members.</span>
<a name="l5177"><span class="linenum">5177</span></a>      if (!empty(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('reset_groupings_members')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/reset_groupings_members.html">reset_groupings_members</a>)) {
<a name="l5178"><span class="linenum">5178</span></a>          <a class="function" onClick="logFunction('groups_delete_groupings_groups')" href="../_functions/groups_delete_groupings_groups.html" onMouseOver="funcPopup(event,'groups_delete_groupings_groups')">groups_delete_groupings_groups</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>, false);
<a name="l5179"><span class="linenum">5179</span></a>          <a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a>[] = array('component' =&gt; <a class="var it13021" onMouseOver="hilite(13021)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../_variables/componentstr.html">$componentstr</a>, 'item' =&gt; <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('removegroupingsmembers', 'group'), 'error' =&gt; false);
<a name="l5180"><span class="linenum">5180</span></a>      }
<a name="l5181"><span class="linenum">5181</span></a>  
<a name="l5182"><span class="linenum">5182</span></a>  <span class="comment">    // Remove all groupings.</span>
<a name="l5183"><span class="linenum">5183</span></a>      if (!empty(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('reset_groupings_remove')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/reset_groupings_remove.html">reset_groupings_remove</a>)) {
<a name="l5184"><span class="linenum">5184</span></a>          <a class="function" onClick="logFunction('groups_delete_groupings')" href="../_functions/groups_delete_groupings.html" onMouseOver="funcPopup(event,'groups_delete_groupings')">groups_delete_groupings</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>, false);
<a name="l5185"><span class="linenum">5185</span></a>          <a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a>[] = array('component' =&gt; <a class="var it13021" onMouseOver="hilite(13021)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../_variables/componentstr.html">$componentstr</a>, 'item' =&gt; <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('deleteallgroupings', 'group'), 'error' =&gt; false);
<a name="l5186"><span class="linenum">5186</span></a>      }
<a name="l5187"><span class="linenum">5187</span></a>  
<a name="l5188"><span class="linenum">5188</span></a>  <span class="comment">    // Look in every instance of every module for data to delete.</span>
<a name="l5189"><span class="linenum">5189</span></a>      <a class="var it13035" onMouseOver="hilite(13035)" onMouseOut="lolite()" onClick="logVariable('unsupportedmods')" href="../_variables/unsupportedmods.html">$unsupportedmods</a> = array();
<a name="l5190"><span class="linenum">5190</span></a>      if (<a class="var it10793" onMouseOver="hilite(10793)" onMouseOut="lolite()" onClick="logVariable('allmods')" href="../_variables/allmods.html">$allmods</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('modules') ) {
<a name="l5191"><span class="linenum">5191</span></a>          foreach (<a class="var it10793" onMouseOver="hilite(10793)" onMouseOut="lolite()" onClick="logVariable('allmods')" href="../_variables/allmods.html">$allmods</a> as <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('mod')" href="../_variables/mod.html">$mod</a>) {
<a name="l5192"><span class="linenum">5192</span></a>              <a class="var it561" onMouseOver="hilite(561)" onMouseOut="lolite()" onClick="logVariable('modname')" href="../_variables/modname.html">$modname</a> = <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('mod')" href="../_variables/mod.html">$mod</a>-&gt;<a onClick="logVariable('name')" class="var it40073" onMouseOver="hilite(40073)" onMouseOut="lolite()" href="../_variables/name.html">name</a>;
<a name="l5193"><span class="linenum">5193</span></a>              <a class="var it13036" onMouseOver="hilite(13036)" onMouseOut="lolite()" onClick="logVariable('modfile')" href="../_variables/modfile.html">$modfile</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'/mod/'. <a class="var it561" onMouseOver="hilite(561)" onMouseOut="lolite()" onClick="logVariable('modname')" href="../_variables/modname.html">$modname</a>.'/lib.php';
<a name="l5194"><span class="linenum">5194</span></a>              <a class="var it13037" onMouseOver="hilite(13037)" onMouseOut="lolite()" onClick="logVariable('moddeleteuserdata')" href="../_variables/moddeleteuserdata.html">$moddeleteuserdata</a> = <a class="var it561" onMouseOver="hilite(561)" onMouseOut="lolite()" onClick="logVariable('modname')" href="../_variables/modname.html">$modname</a>.'_reset_userdata';   <span class="comment">// Function to delete user data.</span>
<a name="l5195"><span class="linenum">5195</span></a>              if (<a class="phpfunction" onClick="logFunction('file_exists')" href="../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it13036" onMouseOver="hilite(13036)" onMouseOut="lolite()" onClick="logVariable('modfile')" href="../_variables/modfile.html">$modfile</a>)) {
<a name="l5196"><span class="linenum">5196</span></a>                  if (!<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records')" href="../_functions/count_records.html" onMouseOver="funcPopup(event,'count_records')">count_records</a>(<a class="var it561" onMouseOver="hilite(561)" onMouseOut="lolite()" onClick="logVariable('modname')" href="../_variables/modname.html">$modname</a>, array('course' =&gt; <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>))) {
<a name="l5197"><span class="linenum">5197</span></a>                      continue; <span class="comment">// Skip mods with no instances.</span>
<a name="l5198"><span class="linenum">5198</span></a>                  }
<a name="l5199"><span class="linenum">5199</span></a>                  include_once(<a class="var it13036" onMouseOver="hilite(13036)" onMouseOut="lolite()" onClick="logVariable('modfile')" href="../_variables/modfile.html">$modfile</a>);
<a name="l5200"><span class="linenum">5200</span></a>                  if (<a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>(<a class="var it13037" onMouseOver="hilite(13037)" onMouseOut="lolite()" onClick="logVariable('moddeleteuserdata')" href="../_variables/moddeleteuserdata.html">$moddeleteuserdata</a>)) {
<a name="l5201"><span class="linenum">5201</span></a>                      <a class="var it13038" onMouseOver="hilite(13038)" onMouseOut="lolite()" onClick="logVariable('modstatus')" href="../_variables/modstatus.html">$modstatus</a> = <a class="var it13037" onMouseOver="hilite(13037)" onMouseOut="lolite()" onClick="logVariable('moddeleteuserdata')" href="../_variables/moddeleteuserdata.html">$moddeleteuserdata</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>);
<a name="l5202"><span class="linenum">5202</span></a>                      if (<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it13038" onMouseOver="hilite(13038)" onMouseOut="lolite()" onClick="logVariable('modstatus')" href="../_variables/modstatus.html">$modstatus</a>)) {
<a name="l5203"><span class="linenum">5203</span></a>                          <a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a>, <a class="var it13038" onMouseOver="hilite(13038)" onMouseOut="lolite()" onClick="logVariable('modstatus')" href="../_variables/modstatus.html">$modstatus</a>);
<a name="l5204"><span class="linenum">5204</span></a>                      } else {
<a name="l5205"><span class="linenum">5205</span></a>                          <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Module '.<a class="var it561" onMouseOver="hilite(561)" onMouseOut="lolite()" onClick="logVariable('modname')" href="../_variables/modname.html">$modname</a>.' returned incorrect staus - must be an array!');
<a name="l5206"><span class="linenum">5206</span></a>                      }
<a name="l5207"><span class="linenum">5207</span></a>                  } else {
<a name="l5208"><span class="linenum">5208</span></a>                      <a class="var it13035" onMouseOver="hilite(13035)" onMouseOut="lolite()" onClick="logVariable('unsupportedmods')" href="../_variables/unsupportedmods.html">$unsupportedmods</a>[] = <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('mod')" href="../_variables/mod.html">$mod</a>;
<a name="l5209"><span class="linenum">5209</span></a>                  }
<a name="l5210"><span class="linenum">5210</span></a>              } else {
<a name="l5211"><span class="linenum">5211</span></a>                  <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Missing lib.php in '.<a class="var it561" onMouseOver="hilite(561)" onMouseOut="lolite()" onClick="logVariable('modname')" href="../_variables/modname.html">$modname</a>.' module!');
<a name="l5212"><span class="linenum">5212</span></a>              }
<a name="l5213"><span class="linenum">5213</span></a>          }
<a name="l5214"><span class="linenum">5214</span></a>      }
<a name="l5215"><span class="linenum">5215</span></a>  
<a name="l5216"><span class="linenum">5216</span></a>  <span class="comment">    // Mention unsupported mods.</span>
<a name="l5217"><span class="linenum">5217</span></a>      if (!empty(<a class="var it13035" onMouseOver="hilite(13035)" onMouseOut="lolite()" onClick="logVariable('unsupportedmods')" href="../_variables/unsupportedmods.html">$unsupportedmods</a>)) {
<a name="l5218"><span class="linenum">5218</span></a>          foreach (<a class="var it13035" onMouseOver="hilite(13035)" onMouseOut="lolite()" onClick="logVariable('unsupportedmods')" href="../_variables/unsupportedmods.html">$unsupportedmods</a> as <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('mod')" href="../_variables/mod.html">$mod</a>) {
<a name="l5219"><span class="linenum">5219</span></a>              <a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a>[] = array(
<a name="l5220"><span class="linenum">5220</span></a>                  'component' =&gt; <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('modulenameplural', <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('mod')" href="../_variables/mod.html">$mod</a>-&gt;<a onClick="logVariable('name')" class="var it40073" onMouseOver="hilite(40073)" onMouseOut="lolite()" href="../_variables/name.html">name</a>),
<a name="l5221"><span class="linenum">5221</span></a>                  'item' =&gt; '',
<a name="l5222"><span class="linenum">5222</span></a>                  'error' =&gt; <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('resetnotimplemented')
<a name="l5223"><span class="linenum">5223</span></a>              );
<a name="l5224"><span class="linenum">5224</span></a>          }
<a name="l5225"><span class="linenum">5225</span></a>      }
<a name="l5226"><span class="linenum">5226</span></a>  
<a name="l5227"><span class="linenum">5227</span></a>      <a class="var it13021" onMouseOver="hilite(13021)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../_variables/componentstr.html">$componentstr</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('gradebook', 'grades');
<a name="l5228"><span class="linenum">5228</span></a>  <span class="comment">    // Reset gradebook,.</span>
<a name="l5229"><span class="linenum">5229</span></a>      if (!empty(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('reset_gradebook_items')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/reset_gradebook_items.html">reset_gradebook_items</a>)) {
<a name="l5230"><span class="linenum">5230</span></a>          <a class="function" onClick="logFunction('remove_course_grades')" href="../_functions/remove_course_grades.html" onMouseOver="funcPopup(event,'remove_course_grades')">remove_course_grades</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>, false);
<a name="l5231"><span class="linenum">5231</span></a>          <a class="function" onClick="logFunction('grade_grab_course_grades')" href="../_functions/grade_grab_course_grades.html" onMouseOver="funcPopup(event,'grade_grab_course_grades')">grade_grab_course_grades</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>);
<a name="l5232"><span class="linenum">5232</span></a>          <a class="function" onClick="logFunction('grade_regrade_final_grades')" href="../_functions/grade_regrade_final_grades.html" onMouseOver="funcPopup(event,'grade_regrade_final_grades')">grade_regrade_final_grades</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>);
<a name="l5233"><span class="linenum">5233</span></a>          <a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a>[] = array('component' =&gt; <a class="var it13021" onMouseOver="hilite(13021)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../_variables/componentstr.html">$componentstr</a>, 'item' =&gt; <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('removeallcourseitems', 'grades'), 'error' =&gt; false);
<a name="l5234"><span class="linenum">5234</span></a>  
<a name="l5235"><span class="linenum">5235</span></a>      } else if (!empty(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('reset_gradebook_grades')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/reset_gradebook_grades.html">reset_gradebook_grades</a>)) {
<a name="l5236"><span class="linenum">5236</span></a>          <a class="function" onClick="logFunction('grade_course_reset')" href="../_functions/grade_course_reset.html" onMouseOver="funcPopup(event,'grade_course_reset')">grade_course_reset</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/courseid.html">courseid</a>);
<a name="l5237"><span class="linenum">5237</span></a>          <a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a>[] = array('component' =&gt; <a class="var it13021" onMouseOver="hilite(13021)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../_variables/componentstr.html">$componentstr</a>, 'item' =&gt; <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('removeallcoursegrades', 'grades'), 'error' =&gt; false);
<a name="l5238"><span class="linenum">5238</span></a>      }
<a name="l5239"><span class="linenum">5239</span></a>  <span class="comment">    // Reset comments.</span>
<a name="l5240"><span class="linenum">5240</span></a>      if (!empty(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('reset_comments')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/reset_comments.html">reset_comments</a>)) {
<a name="l5241"><span class="linenum">5241</span></a>          require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../comment/lib.php.html">/comment/lib.php</a>');
<a name="l5242"><span class="linenum">5242</span></a>          <a class="class" onClick="logClass('comment')" href="../_classes/comment.html" onMouseOver="classPopup(event,'comment')">comment</a>::<a class="function" onClick="logFunction('reset_course_page_comments')" href="../_functions/reset_course_page_comments.html" onMouseOver="funcPopup(event,'reset_course_page_comments')">reset_course_page_comments</a>(<a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>);
<a name="l5243"><span class="linenum">5243</span></a>      }
<a name="l5244"><span class="linenum">5244</span></a>  
<a name="l5245"><span class="linenum">5245</span></a>      <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a> = \core\event\<a class="class" onClick="logClass('course_reset_ended')" href="../_classes/course_reset_ended.html" onMouseOver="classPopup(event,'course_reset_ended')">course_reset_ended</a>::<a class="function" onClick="logFunction('create')" href="../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(<a class="var it1765" onMouseOver="hilite(1765)" onMouseOut="lolite()" onClick="logVariable('eventparams')" href="../_variables/eventparams.html">$eventparams</a>);
<a name="l5246"><span class="linenum">5246</span></a>      <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l5247"><span class="linenum">5247</span></a>  
<a name="l5248"><span class="linenum">5248</span></a>      return <a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a>;
<a name="l5249"><span class="linenum">5249</span></a>  }
<a name="l5250"><span class="linenum">5250</span></a>  
<a name="l5251"><span class="linenum">5251</span></a>  <span class="comment">/**</span>
<a name="l5252"><span class="linenum">5252</span></a>  <span class="comment"> * Generate an email processing address.</span>
<a name="l5253"><span class="linenum">5253</span></a>  <span class="comment"> *</span>
<a name="l5254"><span class="linenum">5254</span></a>  <span class="comment"> * @param int $modid</span>
<a name="l5255"><span class="linenum">5255</span></a>  <span class="comment"> * @param string $modargs</span>
<a name="l5256"><span class="linenum">5256</span></a>  <span class="comment"> * @return string Returns email processing address</span>
<a name="l5257"><span class="linenum">5257</span></a>  <span class="comment"> */</span>
<a name="l5258"><span class="linenum">5258</span></a>  function <a class="function" onClick="logFunction('generate_email_processing_address')" href="../_functions/generate_email_processing_address.html" onMouseOver="funcPopup(event,'generate_email_processing_address')">generate_email_processing_address</a>(<a class="var it5866" onMouseOver="hilite(5866)" onMouseOut="lolite()" onClick="logVariable('modid')" href="../_variables/modid.html">$modid</a>, <a class="var it13042" onMouseOver="hilite(13042)" onMouseOut="lolite()" onClick="logVariable('modargs')" href="../_variables/modargs.html">$modargs</a>) {
<a name="l5259"><span class="linenum">5259</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l5260"><span class="linenum">5260</span></a>  
<a name="l5261"><span class="linenum">5261</span></a>      <a class="var it295" onMouseOver="hilite(295)" onMouseOut="lolite()" onClick="logVariable('header')" href="../_variables/header.html">$header</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mailprefix')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/mailprefix.html">mailprefix</a> . <a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="phpfunction" onClick="logFunction('base64_encode')" href="../_functions/base64_encode.html" onMouseOver="phpfuncPopup(event,'base64_encode')">base64_encode</a>(<a class="phpfunction" onClick="logFunction('pack')" href="../_functions/pack.html" onMouseOver="phpfuncPopup(event,'pack')">pack</a>('C', <a class="var it5866" onMouseOver="hilite(5866)" onMouseOut="lolite()" onClick="logVariable('modid')" href="../_variables/modid.html">$modid</a>)), 0, 2).<a class="var it13042" onMouseOver="hilite(13042)" onMouseOut="lolite()" onClick="logVariable('modargs')" href="../_variables/modargs.html">$modargs</a>;
<a name="l5262"><span class="linenum">5262</span></a>      return <a class="var it295" onMouseOver="hilite(295)" onMouseOut="lolite()" onClick="logVariable('header')" href="../_variables/header.html">$header</a> . <a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(md5(<a class="var it295" onMouseOver="hilite(295)" onMouseOut="lolite()" onClick="logVariable('header')" href="../_variables/header.html">$header</a>.<a class="function" onClick="logFunction('get_site_identifier')" href="../_functions/get_site_identifier.html" onMouseOver="funcPopup(event,'get_site_identifier')">get_site_identifier</a>()), 0, 16).'@'.<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('maildomain')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/maildomain.html">maildomain</a>;
<a name="l5263"><span class="linenum">5263</span></a>  }
<a name="l5264"><span class="linenum">5264</span></a>  
<a name="l5265"><span class="linenum">5265</span></a>  <span class="comment">/**</span>
<a name="l5266"><span class="linenum">5266</span></a>  <span class="comment"> * ?</span>
<a name="l5267"><span class="linenum">5267</span></a>  <span class="comment"> *</span>
<a name="l5268"><span class="linenum">5268</span></a>  <span class="comment"> * @todo Finish documenting this function</span>
<a name="l5269"><span class="linenum">5269</span></a>  <span class="comment"> *</span>
<a name="l5270"><span class="linenum">5270</span></a>  <span class="comment"> * @param string $modargs</span>
<a name="l5271"><span class="linenum">5271</span></a>  <span class="comment"> * @param string $body Currently unused</span>
<a name="l5272"><span class="linenum">5272</span></a>  <span class="comment"> */</span>
<a name="l5273"><span class="linenum">5273</span></a>  function <a class="function" onClick="logFunction('moodle_process_email')" href="../_functions/moodle_process_email.html" onMouseOver="funcPopup(event,'moodle_process_email')">moodle_process_email</a>(<a class="var it13042" onMouseOver="hilite(13042)" onMouseOut="lolite()" onClick="logVariable('modargs')" href="../_variables/modargs.html">$modargs</a>, <a class="var it2792" onMouseOver="hilite(2792)" onMouseOut="lolite()" onClick="logVariable('body')" href="../_variables/body.html">$body</a>) {
<a name="l5274"><span class="linenum">5274</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l5275"><span class="linenum">5275</span></a>  
<a name="l5276"><span class="linenum">5276</span></a>  <span class="comment">    // The first char should be an unencoded letter. We'll take this as an action.</span>
<a name="l5277"><span class="linenum">5277</span></a>      switch (<a class="var it13042" onMouseOver="hilite(13042)" onMouseOut="lolite()" onClick="logVariable('modargs')" href="../_variables/modargs.html">$modargs</a>{0}) {
<a name="l5278"><span class="linenum">5278</span></a>          case 'B': { // Bounce.
<a name="l5279"><span class="linenum">5279</span></a>              <a class="function" onClick="logFunction('list')" href="../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(, <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>) = <a class="phpfunction" onClick="logFunction('unpack')" href="../_functions/unpack.html" onMouseOver="phpfuncPopup(event,'unpack')">unpack</a>('V', <a class="phpfunction" onClick="logFunction('base64_decode')" href="../_functions/base64_decode.html" onMouseOver="phpfuncPopup(event,'base64_decode')">base64_decode</a>(<a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it13042" onMouseOver="hilite(13042)" onMouseOut="lolite()" onClick="logVariable('modargs')" href="../_variables/modargs.html">$modargs</a>, 1, 8)));
<a name="l5280"><span class="linenum">5280</span></a>              if (<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>(&quot;user&quot;, array('id' =&gt; <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>), &quot;id,email&quot;)) {
<a name="l5281"><span class="linenum">5281</span></a>  <span class="comment">                // Check the half md5 of their email.</span>
<a name="l5282"><span class="linenum">5282</span></a>                  <a class="var it13045" onMouseOver="hilite(13045)" onMouseOut="lolite()" onClick="logVariable('md5check')" href="../_variables/md5check.html">$md5check</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(md5(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('email')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/email.html">email</a>), 0, 16);
<a name="l5283"><span class="linenum">5283</span></a>                  if (<a class="var it13045" onMouseOver="hilite(13045)" onMouseOut="lolite()" onClick="logVariable('md5check')" href="../_variables/md5check.html">$md5check</a> == <a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it13042" onMouseOver="hilite(13042)" onMouseOut="lolite()" onClick="logVariable('modargs')" href="../_variables/modargs.html">$modargs</a>, -16)) {
<a name="l5284"><span class="linenum">5284</span></a>                      <a class="function" onClick="logFunction('set_bounce_count')" href="../_functions/set_bounce_count.html" onMouseOver="funcPopup(event,'set_bounce_count')">set_bounce_count</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l5285"><span class="linenum">5285</span></a>                  }
<a name="l5286"><span class="linenum">5286</span></a>  <span class="comment">                // Else maybe they've already changed it?</span>
<a name="l5287"><span class="linenum">5287</span></a>              }
<a name="l5288"><span class="linenum">5288</span></a>          }
<a name="l5289"><span class="linenum">5289</span></a>          break;
<a name="l5290"><span class="linenum">5290</span></a>  <span class="comment">        // Maybe more later?</span>
<a name="l5291"><span class="linenum">5291</span></a>      }
<a name="l5292"><span class="linenum">5292</span></a>  }
<a name="l5293"><span class="linenum">5293</span></a>  
<a name="l5294"><span class="linenum">5294</span></a>  <span class="comment">// CORRESPONDENCE.</span>
<a name="l5295"><span class="linenum">5295</span></a>  
<a name="l5296"><span class="linenum">5296</span></a>  <span class="comment">/**</span>
<a name="l5297"><span class="linenum">5297</span></a>  <span class="comment"> * Get mailer instance, enable buffering, flush buffer or disable buffering.</span>
<a name="l5298"><span class="linenum">5298</span></a>  <span class="comment"> *</span>
<a name="l5299"><span class="linenum">5299</span></a>  <span class="comment"> * @param string $action 'get', 'buffer', 'close' or 'flush'</span>
<a name="l5300"><span class="linenum">5300</span></a>  <span class="comment"> * @return moodle_phpmailer|null mailer instance if 'get' used or nothing</span>
<a name="l5301"><span class="linenum">5301</span></a>  <span class="comment"> */</span>
<a name="l5302"><span class="linenum">5302</span></a>  function <a class="function" onClick="logFunction('get_mailer')" href="../_functions/get_mailer.html" onMouseOver="funcPopup(event,'get_mailer')">get_mailer</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a>='get') {
<a name="l5303"><span class="linenum">5303</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l5304"><span class="linenum">5304</span></a>  
<a name="l5305"><span class="linenum">5305</span></a>  <span class="comment">    /** @var moodle_phpmailer $mailer */</span>
<a name="l5306"><span class="linenum">5306</span></a>      static <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>  = null;
<a name="l5307"><span class="linenum">5307</span></a>      static <a class="var it3320" onMouseOver="hilite(3320)" onMouseOut="lolite()" onClick="logVariable('counter')" href="../_variables/counter.html">$counter</a> = 0;
<a name="l5308"><span class="linenum">5308</span></a>  
<a name="l5309"><span class="linenum">5309</span></a>      if (!isset(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('smtpmaxbulk')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/smtpmaxbulk.html">smtpmaxbulk</a>)) {
<a name="l5310"><span class="linenum">5310</span></a>          <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('smtpmaxbulk')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/smtpmaxbulk.html">smtpmaxbulk</a> = 1;
<a name="l5311"><span class="linenum">5311</span></a>      }
<a name="l5312"><span class="linenum">5312</span></a>  
<a name="l5313"><span class="linenum">5313</span></a>      if (<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a> == 'get') {
<a name="l5314"><span class="linenum">5314</span></a>          <a class="var it13048" onMouseOver="hilite(13048)" onMouseOut="lolite()" onClick="logVariable('prevkeepalive')" href="../_variables/prevkeepalive.html">$prevkeepalive</a> = false;
<a name="l5315"><span class="linenum">5315</span></a>  
<a name="l5316"><span class="linenum">5316</span></a>          if (isset(<a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>) and <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('Mailer')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/Mailer.html">Mailer</a> == 'smtp') {
<a name="l5317"><span class="linenum">5317</span></a>              if (<a class="var it3320" onMouseOver="hilite(3320)" onMouseOut="lolite()" onClick="logVariable('counter')" href="../_variables/counter.html">$counter</a> &lt; <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('smtpmaxbulk')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/smtpmaxbulk.html">smtpmaxbulk</a> and !<a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a class="function" onClick="logFunction('isError')" href="../_functions/iserror.html" onMouseOver="funcPopup(event,'iserror')">isError</a>()) {
<a name="l5318"><span class="linenum">5318</span></a>                  <a class="var it3320" onMouseOver="hilite(3320)" onMouseOut="lolite()" onClick="logVariable('counter')" href="../_variables/counter.html">$counter</a>++;
<a name="l5319"><span class="linenum">5319</span></a>  <span class="comment">                // Reset the mailer.</span>
<a name="l5320"><span class="linenum">5320</span></a>                  <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('Priority')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/Priority.html">Priority</a>         = 3;
<a name="l5321"><span class="linenum">5321</span></a>                  <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('CharSet')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/CharSet.html">CharSet</a>          = 'UTF-8'; <span class="comment">// Our default.</span>
<a name="l5322"><span class="linenum">5322</span></a>                  <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('ContentType')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/ContentType.html">ContentType</a>      = &quot;text/plain&quot;;
<a name="l5323"><span class="linenum">5323</span></a>                  <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('Encoding')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/Encoding.html">Encoding</a>         = &quot;8bit&quot;;
<a name="l5324"><span class="linenum">5324</span></a>                  <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('From')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/From.html">From</a>             = &quot;root@localhost&quot;;
<a name="l5325"><span class="linenum">5325</span></a>                  <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('FromName')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/FromName.html">FromName</a>         = &quot;Root User&quot;;
<a name="l5326"><span class="linenum">5326</span></a>                  <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('Sender')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/Sender.html">Sender</a>           = &quot;&quot;;
<a name="l5327"><span class="linenum">5327</span></a>                  <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('Subject')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/Subject.html">Subject</a>          = &quot;&quot;;
<a name="l5328"><span class="linenum">5328</span></a>                  <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('Body')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/Body.html">Body</a>             = &quot;&quot;;
<a name="l5329"><span class="linenum">5329</span></a>                  <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('AltBody')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/AltBody.html">AltBody</a>          = &quot;&quot;;
<a name="l5330"><span class="linenum">5330</span></a>                  <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('ConfirmReadingTo')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/ConfirmReadingTo.html">ConfirmReadingTo</a> = &quot;&quot;;
<a name="l5331"><span class="linenum">5331</span></a>  
<a name="l5332"><span class="linenum">5332</span></a>                  <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a class="function" onClick="logFunction('clearAllRecipients')" href="../_functions/clearallrecipients.html" onMouseOver="funcPopup(event,'clearallrecipients')">clearAllRecipients</a>();
<a name="l5333"><span class="linenum">5333</span></a>                  <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a class="function" onClick="logFunction('clearReplyTos')" href="../_functions/clearreplytos.html" onMouseOver="funcPopup(event,'clearreplytos')">clearReplyTos</a>();
<a name="l5334"><span class="linenum">5334</span></a>                  <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a class="function" onClick="logFunction('clearAttachments')" href="../_functions/clearattachments.html" onMouseOver="funcPopup(event,'clearattachments')">clearAttachments</a>();
<a name="l5335"><span class="linenum">5335</span></a>                  <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a class="function" onClick="logFunction('clearCustomHeaders')" href="../_functions/clearcustomheaders.html" onMouseOver="funcPopup(event,'clearcustomheaders')">clearCustomHeaders</a>();
<a name="l5336"><span class="linenum">5336</span></a>                  return <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>;
<a name="l5337"><span class="linenum">5337</span></a>              }
<a name="l5338"><span class="linenum">5338</span></a>  
<a name="l5339"><span class="linenum">5339</span></a>              <a class="var it13048" onMouseOver="hilite(13048)" onMouseOut="lolite()" onClick="logVariable('prevkeepalive')" href="../_variables/prevkeepalive.html">$prevkeepalive</a> = <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('SMTPKeepAlive')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/SMTPKeepAlive.html">SMTPKeepAlive</a>;
<a name="l5340"><span class="linenum">5340</span></a>              <a class="function" onClick="logFunction('get_mailer')" href="../_functions/get_mailer.html" onMouseOver="funcPopup(event,'get_mailer')">get_mailer</a>('flush');
<a name="l5341"><span class="linenum">5341</span></a>          }
<a name="l5342"><span class="linenum">5342</span></a>  
<a name="l5343"><span class="linenum">5343</span></a>          require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/libdir.html">libdir</a>.'/phpmailer/moodle_phpmailer.php');
<a name="l5344"><span class="linenum">5344</span></a>          <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a> = <span class="keyword">new </span><a class="class" onClick="logClass('moodle_phpmailer')" href="../_classes/moodle_phpmailer.html" onMouseOver="classPopup(event,'moodle_phpmailer')">moodle_phpmailer</a>();
<a name="l5345"><span class="linenum">5345</span></a>  
<a name="l5346"><span class="linenum">5346</span></a>          <a class="var it3320" onMouseOver="hilite(3320)" onMouseOut="lolite()" onClick="logVariable('counter')" href="../_variables/counter.html">$counter</a> = 1;
<a name="l5347"><span class="linenum">5347</span></a>  
<a name="l5348"><span class="linenum">5348</span></a>          if (<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('smtphosts')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/smtphosts.html">smtphosts</a> == 'qmail') {
<a name="l5349"><span class="linenum">5349</span></a>  <span class="comment">            // Use Qmail system.</span>
<a name="l5350"><span class="linenum">5350</span></a>              <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a class="function" onClick="logFunction('isQmail')" href="../_functions/isqmail.html" onMouseOver="funcPopup(event,'isqmail')">isQmail</a>();
<a name="l5351"><span class="linenum">5351</span></a>  
<a name="l5352"><span class="linenum">5352</span></a>          } else if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('smtphosts')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/smtphosts.html">smtphosts</a>)) {
<a name="l5353"><span class="linenum">5353</span></a>  <span class="comment">            // Use PHP mail() = sendmail.</span>
<a name="l5354"><span class="linenum">5354</span></a>              <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a class="function" onClick="logFunction('isMail')" href="../_functions/ismail.html" onMouseOver="funcPopup(event,'ismail')">isMail</a>();
<a name="l5355"><span class="linenum">5355</span></a>  
<a name="l5356"><span class="linenum">5356</span></a>          } else {
<a name="l5357"><span class="linenum">5357</span></a>  <span class="comment">            // Use SMTP directly.</span>
<a name="l5358"><span class="linenum">5358</span></a>              <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a class="function" onClick="logFunction('isSMTP')" href="../_functions/issmtp.html" onMouseOver="funcPopup(event,'issmtp')">isSMTP</a>();
<a name="l5359"><span class="linenum">5359</span></a>              if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('debugsmtp')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/debugsmtp.html">debugsmtp</a>)) {
<a name="l5360"><span class="linenum">5360</span></a>                  <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('SMTPDebug')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/SMTPDebug.html">SMTPDebug</a> = true;
<a name="l5361"><span class="linenum">5361</span></a>              }
<a name="l5362"><span class="linenum">5362</span></a>  <span class="comment">            // Specify main and backup servers.</span>
<a name="l5363"><span class="linenum">5363</span></a>              <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('Host')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/Host.html">Host</a>          = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('smtphosts')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/smtphosts.html">smtphosts</a>;
<a name="l5364"><span class="linenum">5364</span></a>  <span class="comment">            // Specify secure connection protocol.</span>
<a name="l5365"><span class="linenum">5365</span></a>              <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('SMTPSecure')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/SMTPSecure.html">SMTPSecure</a>    = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('smtpsecure')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/smtpsecure.html">smtpsecure</a>;
<a name="l5366"><span class="linenum">5366</span></a>  <span class="comment">            // Use previous keepalive.</span>
<a name="l5367"><span class="linenum">5367</span></a>              <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('SMTPKeepAlive')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/SMTPKeepAlive.html">SMTPKeepAlive</a> = <a class="var it13048" onMouseOver="hilite(13048)" onMouseOut="lolite()" onClick="logVariable('prevkeepalive')" href="../_variables/prevkeepalive.html">$prevkeepalive</a>;
<a name="l5368"><span class="linenum">5368</span></a>  
<a name="l5369"><span class="linenum">5369</span></a>              if (<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('smtpuser')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/smtpuser.html">smtpuser</a>) {
<a name="l5370"><span class="linenum">5370</span></a>  <span class="comment">                // Use SMTP authentication.</span>
<a name="l5371"><span class="linenum">5371</span></a>                  <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('SMTPAuth')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/SMTPAuth.html">SMTPAuth</a> = true;
<a name="l5372"><span class="linenum">5372</span></a>                  <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('Username')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/Username.html">Username</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('smtpuser')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/smtpuser.html">smtpuser</a>;
<a name="l5373"><span class="linenum">5373</span></a>                  <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('Password')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/Password.html">Password</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('smtppass')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/smtppass.html">smtppass</a>;
<a name="l5374"><span class="linenum">5374</span></a>              }
<a name="l5375"><span class="linenum">5375</span></a>          }
<a name="l5376"><span class="linenum">5376</span></a>  
<a name="l5377"><span class="linenum">5377</span></a>          return <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>;
<a name="l5378"><span class="linenum">5378</span></a>      }
<a name="l5379"><span class="linenum">5379</span></a>  
<a name="l5380"><span class="linenum">5380</span></a>      <a class="var it7148" onMouseOver="hilite(7148)" onMouseOut="lolite()" onClick="logVariable('nothing')" href="../_variables/nothing.html">$nothing</a> = null;
<a name="l5381"><span class="linenum">5381</span></a>  
<a name="l5382"><span class="linenum">5382</span></a>  <span class="comment">    // Keep smtp session open after sending.</span>
<a name="l5383"><span class="linenum">5383</span></a>      if (<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a> == 'buffer') {
<a name="l5384"><span class="linenum">5384</span></a>          if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('smtpmaxbulk')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/smtpmaxbulk.html">smtpmaxbulk</a>)) {
<a name="l5385"><span class="linenum">5385</span></a>              <a class="function" onClick="logFunction('get_mailer')" href="../_functions/get_mailer.html" onMouseOver="funcPopup(event,'get_mailer')">get_mailer</a>('flush');
<a name="l5386"><span class="linenum">5386</span></a>              <a class="var it1752" onMouseOver="hilite(1752)" onMouseOut="lolite()" onClick="logVariable('m')" href="../_variables/m.html">$m</a> = <a class="function" onClick="logFunction('get_mailer')" href="../_functions/get_mailer.html" onMouseOver="funcPopup(event,'get_mailer')">get_mailer</a>();
<a name="l5387"><span class="linenum">5387</span></a>              if (<a class="var it1752" onMouseOver="hilite(1752)" onMouseOut="lolite()" onClick="logVariable('m')" href="../_variables/m.html">$m</a>-&gt;<a onClick="logVariable('Mailer')" class="var it40071" onMouseOver="hilite(40071)" onMouseOut="lolite()" href="../_variables/Mailer.html">Mailer</a> == 'smtp') {
<a name="l5388"><span class="linenum">5388</span></a>                  <a class="var it1752" onMouseOver="hilite(1752)" onMouseOut="lolite()" onClick="logVariable('m')" href="../_variables/m.html">$m</a>-&gt;<a onClick="logVariable('SMTPKeepAlive')" class="var it40071" onMouseOver="hilite(40071)" onMouseOut="lolite()" href="../_variables/SMTPKeepAlive.html">SMTPKeepAlive</a> = true;
<a name="l5389"><span class="linenum">5389</span></a>              }
<a name="l5390"><span class="linenum">5390</span></a>          }
<a name="l5391"><span class="linenum">5391</span></a>          return <a class="var it7148" onMouseOver="hilite(7148)" onMouseOut="lolite()" onClick="logVariable('nothing')" href="../_variables/nothing.html">$nothing</a>;
<a name="l5392"><span class="linenum">5392</span></a>      }
<a name="l5393"><span class="linenum">5393</span></a>  
<a name="l5394"><span class="linenum">5394</span></a>  <span class="comment">    // Close smtp session, but continue buffering.</span>
<a name="l5395"><span class="linenum">5395</span></a>      if (<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a> == 'flush') {
<a name="l5396"><span class="linenum">5396</span></a>          if (isset(<a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>) and <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('Mailer')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/Mailer.html">Mailer</a> == 'smtp') {
<a name="l5397"><span class="linenum">5397</span></a>              if (!empty(<a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('SMTPDebug')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/SMTPDebug.html">SMTPDebug</a>)) {
<a name="l5398"><span class="linenum">5398</span></a>                  echo '&lt;pre&gt;'.&quot;\n&quot;;
<a name="l5399"><span class="linenum">5399</span></a>              }
<a name="l5400"><span class="linenum">5400</span></a>              <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a class="function" onClick="logFunction('SmtpClose')" href="../_functions/smtpclose.html" onMouseOver="funcPopup(event,'smtpclose')">SmtpClose</a>();
<a name="l5401"><span class="linenum">5401</span></a>              if (!empty(<a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('SMTPDebug')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/SMTPDebug.html">SMTPDebug</a>)) {
<a name="l5402"><span class="linenum">5402</span></a>                  echo '&lt;/pre&gt;';
<a name="l5403"><span class="linenum">5403</span></a>              }
<a name="l5404"><span class="linenum">5404</span></a>          }
<a name="l5405"><span class="linenum">5405</span></a>          return <a class="var it7148" onMouseOver="hilite(7148)" onMouseOut="lolite()" onClick="logVariable('nothing')" href="../_variables/nothing.html">$nothing</a>;
<a name="l5406"><span class="linenum">5406</span></a>      }
<a name="l5407"><span class="linenum">5407</span></a>  
<a name="l5408"><span class="linenum">5408</span></a>  <span class="comment">    // Close smtp session, do not buffer anymore.</span>
<a name="l5409"><span class="linenum">5409</span></a>      if (<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a> == 'close') {
<a name="l5410"><span class="linenum">5410</span></a>          if (isset(<a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>) and <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('Mailer')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/Mailer.html">Mailer</a> == 'smtp') {
<a name="l5411"><span class="linenum">5411</span></a>              <a class="function" onClick="logFunction('get_mailer')" href="../_functions/get_mailer.html" onMouseOver="funcPopup(event,'get_mailer')">get_mailer</a>('flush');
<a name="l5412"><span class="linenum">5412</span></a>              <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a>-&gt;<a onClick="logVariable('SMTPKeepAlive')" class="var it40038" onMouseOver="hilite(40038)" onMouseOut="lolite()" href="../_variables/SMTPKeepAlive.html">SMTPKeepAlive</a> = false;
<a name="l5413"><span class="linenum">5413</span></a>          }
<a name="l5414"><span class="linenum">5414</span></a>          <a class="var it13046" onMouseOver="hilite(13046)" onMouseOut="lolite()" onClick="logVariable('mailer')" href="../_variables/mailer.html">$mailer</a> = null; <span class="comment">// Better force new instance.</span>
<a name="l5415"><span class="linenum">5415</span></a>          return <a class="var it7148" onMouseOver="hilite(7148)" onMouseOut="lolite()" onClick="logVariable('nothing')" href="../_variables/nothing.html">$nothing</a>;
<a name="l5416"><span class="linenum">5416</span></a>      }
<a name="l5417"><span class="linenum">5417</span></a>  }
<a name="l5418"><span class="linenum">5418</span></a>  
<a name="l5419"><span class="linenum">5419</span></a>  <span class="comment">/**</span>
<a name="l5420"><span class="linenum">5420</span></a>  <span class="comment"> * Send an email to a specified user</span>
<a name="l5421"><span class="linenum">5421</span></a>  <span class="comment"> *</span>
<a name="l5422"><span class="linenum">5422</span></a>  <span class="comment"> * @param stdClass $user  A {@link $USER} object</span>
<a name="l5423"><span class="linenum">5423</span></a>  <span class="comment"> * @param stdClass $from A {@link $USER} object</span>
<a name="l5424"><span class="linenum">5424</span></a>  <span class="comment"> * @param string $subject plain text subject line of the email</span>
<a name="l5425"><span class="linenum">5425</span></a>  <span class="comment"> * @param string $messagetext plain text version of the message</span>
<a name="l5426"><span class="linenum">5426</span></a>  <span class="comment"> * @param string $messagehtml complete html version of the message (optional)</span>
<a name="l5427"><span class="linenum">5427</span></a>  <span class="comment"> * @param string $attachment a file on the filesystem, either relative to $CFG-&gt;dataroot or a full path to a file in $CFG-&gt;tempdir</span>
<a name="l5428"><span class="linenum">5428</span></a>  <span class="comment"> * @param string $attachname the name of the file (extension indicates MIME)</span>
<a name="l5429"><span class="linenum">5429</span></a>  <span class="comment"> * @param bool $usetrueaddress determines whether $from email address should</span>
<a name="l5430"><span class="linenum">5430</span></a>  <span class="comment"> *          be sent out. Will be overruled by user profile setting for maildisplay</span>
<a name="l5431"><span class="linenum">5431</span></a>  <span class="comment"> * @param string $replyto Email address to reply to</span>
<a name="l5432"><span class="linenum">5432</span></a>  <span class="comment"> * @param string $replytoname Name of reply to recipient</span>
<a name="l5433"><span class="linenum">5433</span></a>  <span class="comment"> * @param int $wordwrapwidth custom word wrap width, default 79</span>
<a name="l5434"><span class="linenum">5434</span></a>  <span class="comment"> * @return bool Returns true if mail was sent OK and false if there was an error.</span>
<a name="l5435"><span class="linenum">5435</span></a>  <span class="comment"> */</span>
<a name="l5436"><span class="linenum">5436</span></a>  function <a class="function" onClick="logFunction('email_to_user')" href="../_functions/email_to_user.html" onMouseOver="funcPopup(event,'email_to_user')">email_to_user</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it590" onMouseOver="hilite(590)" onMouseOut="lolite()" onClick="logVariable('from')" href="../_variables/from.html">$from</a>, <a class="var it1426" onMouseOver="hilite(1426)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../_variables/subject.html">$subject</a>, <a class="var it13073" onMouseOver="hilite(13073)" onMouseOut="lolite()" onClick="logVariable('messagetext')" href="../_variables/messagetext.html">$messagetext</a>, <a class="var it13074" onMouseOver="hilite(13074)" onMouseOut="lolite()" onClick="logVariable('messagehtml')" href="../_variables/messagehtml.html">$messagehtml</a> = '', <a class="var it1437" onMouseOver="hilite(1437)" onMouseOut="lolite()" onClick="logVariable('attachment')" href="../_variables/attachment.html">$attachment</a> = '', <a class="var it13075" onMouseOver="hilite(13075)" onMouseOut="lolite()" onClick="logVariable('attachname')" href="../_variables/attachname.html">$attachname</a> = '',
<a name="l5437"><span class="linenum">5437</span></a>                         <a class="var it13076" onMouseOver="hilite(13076)" onMouseOut="lolite()" onClick="logVariable('usetrueaddress')" href="../_variables/usetrueaddress.html">$usetrueaddress</a> = true, <a class="var it13077" onMouseOver="hilite(13077)" onMouseOut="lolite()" onClick="logVariable('replyto')" href="../_variables/replyto.html">$replyto</a> = '', <a class="var it13078" onMouseOver="hilite(13078)" onMouseOut="lolite()" onClick="logVariable('replytoname')" href="../_variables/replytoname.html">$replytoname</a> = '', <a class="var it13079" onMouseOver="hilite(13079)" onMouseOut="lolite()" onClick="logVariable('wordwrapwidth')" href="../_variables/wordwrapwidth.html">$wordwrapwidth</a> = 79) {
<a name="l5438"><span class="linenum">5438</span></a>  
<a name="l5439"><span class="linenum">5439</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l5440"><span class="linenum">5440</span></a>  
<a name="l5441"><span class="linenum">5441</span></a>      if (empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>) or empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)) {
<a name="l5442"><span class="linenum">5442</span></a>          <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Can not send email to null user', <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l5443"><span class="linenum">5443</span></a>          return false;
<a name="l5444"><span class="linenum">5444</span></a>      }
<a name="l5445"><span class="linenum">5445</span></a>  
<a name="l5446"><span class="linenum">5446</span></a>      if (empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('email')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/email.html">email</a>)) {
<a name="l5447"><span class="linenum">5447</span></a>          <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Can not send email to user without email: '.<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l5448"><span class="linenum">5448</span></a>          return false;
<a name="l5449"><span class="linenum">5449</span></a>      }
<a name="l5450"><span class="linenum">5450</span></a>  
<a name="l5451"><span class="linenum">5451</span></a>      if (!empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('deleted')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/deleted.html">deleted</a>)) {
<a name="l5452"><span class="linenum">5452</span></a>          <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Can not send email to deleted user: '.<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l5453"><span class="linenum">5453</span></a>          return false;
<a name="l5454"><span class="linenum">5454</span></a>      }
<a name="l5455"><span class="linenum">5455</span></a>  
<a name="l5456"><span class="linenum">5456</span></a>      if (<a class="phpfunction" onClick="logFunction('defined')" href="../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('BEHAT_SITE_RUNNING')" href="../_constants/BEHAT_SITE_RUNNING.html" onMouseOver="constPopup(event,'BEHAT_SITE_RUNNING')">BEHAT_SITE_RUNNING</a>')) {
<a name="l5457"><span class="linenum">5457</span></a>  <span class="comment">        // Fake email sending in behat.</span>
<a name="l5458"><span class="linenum">5458</span></a>          return true;
<a name="l5459"><span class="linenum">5459</span></a>      }
<a name="l5460"><span class="linenum">5460</span></a>  
<a name="l5461"><span class="linenum">5461</span></a>      if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('noemailever')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/noemailever.html">noemailever</a>)) {
<a name="l5462"><span class="linenum">5462</span></a>  <span class="comment">        // Hidden setting for development sites, set in config.php if needed.</span>
<a name="l5463"><span class="linenum">5463</span></a>          <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Not sending email due to <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('noemailever')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/noemailever.html">noemailever</a> config setting', <a class="constant" onClick="logConstant('DEBUG_NORMAL')" href="../_constants/DEBUG_NORMAL.html" onMouseOver="constPopup(event,'DEBUG_NORMAL')">DEBUG_NORMAL</a>);
<a name="l5464"><span class="linenum">5464</span></a>          return true;
<a name="l5465"><span class="linenum">5465</span></a>      }
<a name="l5466"><span class="linenum">5466</span></a>  
<a name="l5467"><span class="linenum">5467</span></a>      if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('divertallemailsto')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/divertallemailsto.html">divertallemailsto</a>)) {
<a name="l5468"><span class="linenum">5468</span></a>          <a class="var it1426" onMouseOver="hilite(1426)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../_variables/subject.html">$subject</a> = &quot;[DIVERTED {<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('email')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/email.html">email</a>}] <a class="var it1426" onMouseOver="hilite(1426)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../_variables/subject.html">$subject</a>&quot;;
<a name="l5469"><span class="linenum">5469</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="function" onClick="logFunction('clone')" href="../_functions/clone.html" onMouseOver="funcPopup(event,'clone')">clone</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l5470"><span class="linenum">5470</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('email')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/email.html">email</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('divertallemailsto')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/divertallemailsto.html">divertallemailsto</a>;
<a name="l5471"><span class="linenum">5471</span></a>      }
<a name="l5472"><span class="linenum">5472</span></a>  
<a name="l5473"><span class="linenum">5473</span></a>  <span class="comment">    // Skip mail to suspended users.</span>
<a name="l5474"><span class="linenum">5474</span></a>      if ((isset(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>) &amp;&amp; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>=='nologin') <a class="function" onClick="logFunction('or')" href="../_functions/or.html" onMouseOver="funcPopup(event,'or')">or</a> (isset(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('suspended')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/suspended.html">suspended</a>) &amp;&amp; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('suspended')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/suspended.html">suspended</a>)) {
<a name="l5475"><span class="linenum">5475</span></a>          return true;
<a name="l5476"><span class="linenum">5476</span></a>      }
<a name="l5477"><span class="linenum">5477</span></a>  
<a name="l5478"><span class="linenum">5478</span></a>      if (!<a class="function" onClick="logFunction('validate_email')" href="../_functions/validate_email.html" onMouseOver="funcPopup(event,'validate_email')">validate_email</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('email')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/email.html">email</a>)) {
<a name="l5479"><span class="linenum">5479</span></a>  <span class="comment">        // We can not send emails to invalid addresses - it might create security issue or confuse the mailer.</span>
<a name="l5480"><span class="linenum">5480</span></a>          <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(&quot;email_to_user: User <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a> (&quot;.<a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>).&quot;) email (<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('email')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/email.html">email</a>) is invalid! Not sending.&quot;);
<a name="l5481"><span class="linenum">5481</span></a>          return false;
<a name="l5482"><span class="linenum">5482</span></a>      }
<a name="l5483"><span class="linenum">5483</span></a>  
<a name="l5484"><span class="linenum">5484</span></a>      if (<a class="function" onClick="logFunction('over_bounce_threshold')" href="../_functions/over_bounce_threshold.html" onMouseOver="funcPopup(event,'over_bounce_threshold')">over_bounce_threshold</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l5485"><span class="linenum">5485</span></a>          <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(&quot;email_to_user: User <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a> (&quot;.<a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>).&quot;) is over bounce threshold! Not sending.&quot;);
<a name="l5486"><span class="linenum">5486</span></a>          return false;
<a name="l5487"><span class="linenum">5487</span></a>      }
<a name="l5488"><span class="linenum">5488</span></a>  
<a name="l5489"><span class="linenum">5489</span></a>  <span class="comment">    // TLD .invalid  is specifically reserved for invalid domain names.</span>
<a name="l5490"><span class="linenum">5490</span></a>  <span class="comment">    // For More information, see {@link http://tools.ietf.org/html/rfc2606#section-2}.</span>
<a name="l5491"><span class="linenum">5491</span></a>      if (<a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('email')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/email.html">email</a>, -8) == '.invalid') {
<a name="l5492"><span class="linenum">5492</span></a>          <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(&quot;email_to_user: User <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a> (&quot;.<a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>).&quot;) email domain (<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('email')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/email.html">email</a>) is invalid! Not sending.&quot;);
<a name="l5493"><span class="linenum">5493</span></a>          return true; <span class="comment">// This is not an error.</span>
<a name="l5494"><span class="linenum">5494</span></a>      }
<a name="l5495"><span class="linenum">5495</span></a>  
<a name="l5496"><span class="linenum">5496</span></a>  <span class="comment">    // If the user is a remote mnet user, parse the email text for URL to the</span>
<a name="l5497"><span class="linenum">5497</span></a>  <span class="comment">    // wwwroot and modify the url to direct the user's browser to login at their</span>
<a name="l5498"><span class="linenum">5498</span></a>  <span class="comment">    // home site (identity provider - idp) before hitting the link itself.</span>
<a name="l5499"><span class="linenum">5499</span></a>      if (<a class="function" onClick="logFunction('is_mnet_remote_user')" href="../_functions/is_mnet_remote_user.html" onMouseOver="funcPopup(event,'is_mnet_remote_user')">is_mnet_remote_user</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l5500"><span class="linenum">5500</span></a>          require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../mnet/lib.php.html">/mnet/lib.php</a>');
<a name="l5501"><span class="linenum">5501</span></a>  
<a name="l5502"><span class="linenum">5502</span></a>          <a class="var it13082" onMouseOver="hilite(13082)" onMouseOut="lolite()" onClick="logVariable('jumpurl')" href="../_variables/jumpurl.html">$jumpurl</a> = <a class="function" onClick="logFunction('mnet_get_idp_jump_url')" href="../_functions/mnet_get_idp_jump_url.html" onMouseOver="funcPopup(event,'mnet_get_idp_jump_url')">mnet_get_idp_jump_url</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l5503"><span class="linenum">5503</span></a>          <a class="var it1032" onMouseOver="hilite(1032)" onMouseOut="lolite()" onClick="logVariable('callback')" href="../_variables/callback.html">$callback</a> = <a class="function" onClick="logFunction('partial')" href="../_functions/partial.html" onMouseOver="funcPopup(event,'partial')">partial</a>('mnet_sso_apply_indirection', <a class="var it13082" onMouseOver="hilite(13082)" onMouseOut="lolite()" onClick="logVariable('jumpurl')" href="../_variables/jumpurl.html">$jumpurl</a>);
<a name="l5504"><span class="linenum">5504</span></a>  
<a name="l5505"><span class="linenum">5505</span></a>          <a class="var it13073" onMouseOver="hilite(13073)" onMouseOut="lolite()" onClick="logVariable('messagetext')" href="../_variables/messagetext.html">$messagetext</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>(&quot;%(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>[^[:space:]]*)%&quot;,
<a name="l5506"><span class="linenum">5506</span></a>                  <a class="var it1032" onMouseOver="hilite(1032)" onMouseOut="lolite()" onClick="logVariable('callback')" href="../_variables/callback.html">$callback</a>,
<a name="l5507"><span class="linenum">5507</span></a>                  <a class="var it13073" onMouseOver="hilite(13073)" onMouseOut="lolite()" onClick="logVariable('messagetext')" href="../_variables/messagetext.html">$messagetext</a>);
<a name="l5508"><span class="linenum">5508</span></a>          <a class="var it13074" onMouseOver="hilite(13074)" onMouseOut="lolite()" onClick="logVariable('messagehtml')" href="../_variables/messagehtml.html">$messagehtml</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>(&quot;%href=[\&quot;'`](<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>[\w_:\?=#&amp;@/;.~-]*)[\&quot;'`]%&quot;,
<a name="l5509"><span class="linenum">5509</span></a>                  <a class="var it1032" onMouseOver="hilite(1032)" onMouseOut="lolite()" onClick="logVariable('callback')" href="../_variables/callback.html">$callback</a>,
<a name="l5510"><span class="linenum">5510</span></a>                  <a class="var it13074" onMouseOver="hilite(13074)" onMouseOut="lolite()" onClick="logVariable('messagehtml')" href="../_variables/messagehtml.html">$messagehtml</a>);
<a name="l5511"><span class="linenum">5511</span></a>      }
<a name="l5512"><span class="linenum">5512</span></a>      <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a> = <a class="function" onClick="logFunction('get_mailer')" href="../_functions/get_mailer.html" onMouseOver="funcPopup(event,'get_mailer')">get_mailer</a>();
<a name="l5513"><span class="linenum">5513</span></a>  
<a name="l5514"><span class="linenum">5514</span></a>      if (!empty(<a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('SMTPDebug')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/SMTPDebug.html">SMTPDebug</a>)) {
<a name="l5515"><span class="linenum">5515</span></a>          echo '&lt;pre&gt;' . &quot;\n&quot;;
<a name="l5516"><span class="linenum">5516</span></a>      }
<a name="l5517"><span class="linenum">5517</span></a>  
<a name="l5518"><span class="linenum">5518</span></a>      <a class="var it13083" onMouseOver="hilite(13083)" onMouseOut="lolite()" onClick="logVariable('temprecipients')" href="../_variables/temprecipients.html">$temprecipients</a> = array();
<a name="l5519"><span class="linenum">5519</span></a>      <a class="var it13084" onMouseOver="hilite(13084)" onMouseOut="lolite()" onClick="logVariable('tempreplyto')" href="../_variables/tempreplyto.html">$tempreplyto</a> = array();
<a name="l5520"><span class="linenum">5520</span></a>  
<a name="l5521"><span class="linenum">5521</span></a>      <a class="var it4026" onMouseOver="hilite(4026)" onMouseOut="lolite()" onClick="logVariable('supportuser')" href="../_variables/supportuser.html">$supportuser</a> = <a class="class" onClick="logClass('core_user')" href="../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('get_support_user')" href="../_functions/get_support_user.html" onMouseOver="funcPopup(event,'get_support_user')">get_support_user</a>();
<a name="l5522"><span class="linenum">5522</span></a>  
<a name="l5523"><span class="linenum">5523</span></a>  <span class="comment">    // Make up an email address for handling bounces.</span>
<a name="l5524"><span class="linenum">5524</span></a>      if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('handlebounces')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/handlebounces.html">handlebounces</a>)) {
<a name="l5525"><span class="linenum">5525</span></a>          <a class="var it13042" onMouseOver="hilite(13042)" onMouseOut="lolite()" onClick="logVariable('modargs')" href="../_variables/modargs.html">$modargs</a> = 'B'.<a class="phpfunction" onClick="logFunction('base64_encode')" href="../_functions/base64_encode.html" onMouseOver="phpfuncPopup(event,'base64_encode')">base64_encode</a>(<a class="phpfunction" onClick="logFunction('pack')" href="../_functions/pack.html" onMouseOver="phpfuncPopup(event,'pack')">pack</a>('V', <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)).<a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(md5(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('email')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/email.html">email</a>), 0, 16);
<a name="l5526"><span class="linenum">5526</span></a>          <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('Sender')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/Sender.html">Sender</a> = <a class="function" onClick="logFunction('generate_email_processing_address')" href="../_functions/generate_email_processing_address.html" onMouseOver="funcPopup(event,'generate_email_processing_address')">generate_email_processing_address</a>(0, <a class="var it13042" onMouseOver="hilite(13042)" onMouseOut="lolite()" onClick="logVariable('modargs')" href="../_variables/modargs.html">$modargs</a>);
<a name="l5527"><span class="linenum">5527</span></a>      } else {
<a name="l5528"><span class="linenum">5528</span></a>          <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('Sender')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/Sender.html">Sender</a> = <a class="var it4026" onMouseOver="hilite(4026)" onMouseOut="lolite()" onClick="logVariable('supportuser')" href="../_variables/supportuser.html">$supportuser</a>-&gt;<a onClick="logVariable('email')" class="var it41076" onMouseOver="hilite(41076)" onMouseOut="lolite()" href="../_variables/email.html">email</a>;
<a name="l5529"><span class="linenum">5529</span></a>      }
<a name="l5530"><span class="linenum">5530</span></a>  
<a name="l5531"><span class="linenum">5531</span></a>      if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('emailonlyfromnoreplyaddress')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/emailonlyfromnoreplyaddress.html">emailonlyfromnoreplyaddress</a>)) {
<a name="l5532"><span class="linenum">5532</span></a>          <a class="var it13076" onMouseOver="hilite(13076)" onMouseOut="lolite()" onClick="logVariable('usetrueaddress')" href="../_variables/usetrueaddress.html">$usetrueaddress</a> = false;
<a name="l5533"><span class="linenum">5533</span></a>          if (empty(<a class="var it13077" onMouseOver="hilite(13077)" onMouseOut="lolite()" onClick="logVariable('replyto')" href="../_variables/replyto.html">$replyto</a>) &amp;&amp; <a class="var it590" onMouseOver="hilite(590)" onMouseOut="lolite()" onClick="logVariable('from')" href="../_variables/from.html">$from</a>-&gt;<a onClick="logVariable('maildisplay')" class="var it40265" onMouseOver="hilite(40265)" onMouseOut="lolite()" href="../_variables/maildisplay.html">maildisplay</a>) {
<a name="l5534"><span class="linenum">5534</span></a>              <a class="var it13077" onMouseOver="hilite(13077)" onMouseOut="lolite()" onClick="logVariable('replyto')" href="../_variables/replyto.html">$replyto</a> = <a class="var it590" onMouseOver="hilite(590)" onMouseOut="lolite()" onClick="logVariable('from')" href="../_variables/from.html">$from</a>-&gt;<a onClick="logVariable('email')" class="var it40265" onMouseOver="hilite(40265)" onMouseOut="lolite()" href="../_variables/email.html">email</a>;
<a name="l5535"><span class="linenum">5535</span></a>              <a class="var it13078" onMouseOver="hilite(13078)" onMouseOut="lolite()" onClick="logVariable('replytoname')" href="../_variables/replytoname.html">$replytoname</a> = <a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it590" onMouseOver="hilite(590)" onMouseOut="lolite()" onClick="logVariable('from')" href="../_variables/from.html">$from</a>);
<a name="l5536"><span class="linenum">5536</span></a>          }
<a name="l5537"><span class="linenum">5537</span></a>      }
<a name="l5538"><span class="linenum">5538</span></a>  
<a name="l5539"><span class="linenum">5539</span></a>      if (<a class="phpfunction" onClick="logFunction('is_string')" href="../_functions/is_string.html" onMouseOver="phpfuncPopup(event,'is_string')">is_string</a>(<a class="var it590" onMouseOver="hilite(590)" onMouseOut="lolite()" onClick="logVariable('from')" href="../_variables/from.html">$from</a>)) { // So we can pass whatever we want if there is need.
<a name="l5540"><span class="linenum">5540</span></a>          <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('From')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/From.html">From</a>     = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('noreplyaddress')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/noreplyaddress.html">noreplyaddress</a>;
<a name="l5541"><span class="linenum">5541</span></a>          <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('FromName')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/FromName.html">FromName</a> = <a class="var it590" onMouseOver="hilite(590)" onMouseOut="lolite()" onClick="logVariable('from')" href="../_variables/from.html">$from</a>;
<a name="l5542"><span class="linenum">5542</span></a>      } else if (<a class="var it13076" onMouseOver="hilite(13076)" onMouseOut="lolite()" onClick="logVariable('usetrueaddress')" href="../_variables/usetrueaddress.html">$usetrueaddress</a> and <a class="var it590" onMouseOver="hilite(590)" onMouseOut="lolite()" onClick="logVariable('from')" href="../_variables/from.html">$from</a>-&gt;<a onClick="logVariable('maildisplay')" class="var it40265" onMouseOver="hilite(40265)" onMouseOut="lolite()" href="../_variables/maildisplay.html">maildisplay</a>) {
<a name="l5543"><span class="linenum">5543</span></a>          <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('From')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/From.html">From</a>     = <a class="var it590" onMouseOver="hilite(590)" onMouseOut="lolite()" onClick="logVariable('from')" href="../_variables/from.html">$from</a>-&gt;<a onClick="logVariable('email')" class="var it40265" onMouseOver="hilite(40265)" onMouseOut="lolite()" href="../_variables/email.html">email</a>;
<a name="l5544"><span class="linenum">5544</span></a>          <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('FromName')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/FromName.html">FromName</a> = <a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it590" onMouseOver="hilite(590)" onMouseOut="lolite()" onClick="logVariable('from')" href="../_variables/from.html">$from</a>);
<a name="l5545"><span class="linenum">5545</span></a>      } else {
<a name="l5546"><span class="linenum">5546</span></a>          <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('From')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/From.html">From</a>     = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('noreplyaddress')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/noreplyaddress.html">noreplyaddress</a>;
<a name="l5547"><span class="linenum">5547</span></a>          <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('FromName')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/FromName.html">FromName</a> = <a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it590" onMouseOver="hilite(590)" onMouseOut="lolite()" onClick="logVariable('from')" href="../_variables/from.html">$from</a>);
<a name="l5548"><span class="linenum">5548</span></a>          if (empty(<a class="var it13077" onMouseOver="hilite(13077)" onMouseOut="lolite()" onClick="logVariable('replyto')" href="../_variables/replyto.html">$replyto</a>)) {
<a name="l5549"><span class="linenum">5549</span></a>              <a class="var it13084" onMouseOver="hilite(13084)" onMouseOut="lolite()" onClick="logVariable('tempreplyto')" href="../_variables/tempreplyto.html">$tempreplyto</a>[] = array(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('noreplyaddress')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/noreplyaddress.html">noreplyaddress</a>, <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('noreplyname'));
<a name="l5550"><span class="linenum">5550</span></a>          }
<a name="l5551"><span class="linenum">5551</span></a>      }
<a name="l5552"><span class="linenum">5552</span></a>  
<a name="l5553"><span class="linenum">5553</span></a>      if (!empty(<a class="var it13077" onMouseOver="hilite(13077)" onMouseOut="lolite()" onClick="logVariable('replyto')" href="../_variables/replyto.html">$replyto</a>)) {
<a name="l5554"><span class="linenum">5554</span></a>          <a class="var it13084" onMouseOver="hilite(13084)" onMouseOut="lolite()" onClick="logVariable('tempreplyto')" href="../_variables/tempreplyto.html">$tempreplyto</a>[] = array(<a class="var it13077" onMouseOver="hilite(13077)" onMouseOut="lolite()" onClick="logVariable('replyto')" href="../_variables/replyto.html">$replyto</a>, <a class="var it13078" onMouseOver="hilite(13078)" onMouseOut="lolite()" onClick="logVariable('replytoname')" href="../_variables/replytoname.html">$replytoname</a>);
<a name="l5555"><span class="linenum">5555</span></a>      }
<a name="l5556"><span class="linenum">5556</span></a>  
<a name="l5557"><span class="linenum">5557</span></a>      <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('Subject')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/Subject.html">Subject</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it1426" onMouseOver="hilite(1426)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../_variables/subject.html">$subject</a>, 0, 900);
<a name="l5558"><span class="linenum">5558</span></a>  
<a name="l5559"><span class="linenum">5559</span></a>      <a class="var it13083" onMouseOver="hilite(13083)" onMouseOut="lolite()" onClick="logVariable('temprecipients')" href="../_variables/temprecipients.html">$temprecipients</a>[] = array(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('email')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/email.html">email</a>, <a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>));
<a name="l5560"><span class="linenum">5560</span></a>  
<a name="l5561"><span class="linenum">5561</span></a>  <span class="comment">    // Set word wrap.</span>
<a name="l5562"><span class="linenum">5562</span></a>      <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('WordWrap')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/WordWrap.html">WordWrap</a> = <a class="var it13079" onMouseOver="hilite(13079)" onMouseOut="lolite()" onClick="logVariable('wordwrapwidth')" href="../_variables/wordwrapwidth.html">$wordwrapwidth</a>;
<a name="l5563"><span class="linenum">5563</span></a>  
<a name="l5564"><span class="linenum">5564</span></a>      if (!empty(<a class="var it590" onMouseOver="hilite(590)" onMouseOut="lolite()" onClick="logVariable('from')" href="../_variables/from.html">$from</a>-&gt;<a onClick="logVariable('customheaders')" class="var it40265" onMouseOver="hilite(40265)" onMouseOut="lolite()" href="../_variables/customheaders.html">customheaders</a>)) {
<a name="l5565"><span class="linenum">5565</span></a>  <span class="comment">        // Add custom headers.</span>
<a name="l5566"><span class="linenum">5566</span></a>          if (<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it590" onMouseOver="hilite(590)" onMouseOut="lolite()" onClick="logVariable('from')" href="../_variables/from.html">$from</a>-&gt;<a onClick="logVariable('customheaders')" class="var it40265" onMouseOver="hilite(40265)" onMouseOut="lolite()" href="../_variables/customheaders.html">customheaders</a>)) {
<a name="l5567"><span class="linenum">5567</span></a>              foreach (<a class="var it590" onMouseOver="hilite(590)" onMouseOut="lolite()" onClick="logVariable('from')" href="../_variables/from.html">$from</a>-&gt;<a onClick="logVariable('customheaders')" class="var it40265" onMouseOver="hilite(40265)" onMouseOut="lolite()" href="../_variables/customheaders.html">customheaders</a> as <a class="var it13089" onMouseOver="hilite(13089)" onMouseOut="lolite()" onClick="logVariable('customheader')" href="../_variables/customheader.html">$customheader</a>) {
<a name="l5568"><span class="linenum">5568</span></a>                  <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a class="function" onClick="logFunction('addCustomHeader')" href="../_functions/addcustomheader.html" onMouseOver="funcPopup(event,'addcustomheader')">addCustomHeader</a>(<a class="var it13089" onMouseOver="hilite(13089)" onMouseOut="lolite()" onClick="logVariable('customheader')" href="../_variables/customheader.html">$customheader</a>);
<a name="l5569"><span class="linenum">5569</span></a>              }
<a name="l5570"><span class="linenum">5570</span></a>          } else {
<a name="l5571"><span class="linenum">5571</span></a>              <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a class="function" onClick="logFunction('addCustomHeader')" href="../_functions/addcustomheader.html" onMouseOver="funcPopup(event,'addcustomheader')">addCustomHeader</a>(<a class="var it590" onMouseOver="hilite(590)" onMouseOut="lolite()" onClick="logVariable('from')" href="../_variables/from.html">$from</a>-&gt;<a onClick="logVariable('customheaders')" class="var it40265" onMouseOver="hilite(40265)" onMouseOut="lolite()" href="../_variables/customheaders.html">customheaders</a>);
<a name="l5572"><span class="linenum">5572</span></a>          }
<a name="l5573"><span class="linenum">5573</span></a>      }
<a name="l5574"><span class="linenum">5574</span></a>  
<a name="l5575"><span class="linenum">5575</span></a>      if (!empty(<a class="var it590" onMouseOver="hilite(590)" onMouseOut="lolite()" onClick="logVariable('from')" href="../_variables/from.html">$from</a>-&gt;<a onClick="logVariable('priority')" class="var it40265" onMouseOver="hilite(40265)" onMouseOut="lolite()" href="../_variables/priority.html">priority</a>)) {
<a name="l5576"><span class="linenum">5576</span></a>          <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('Priority')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/Priority.html">Priority</a> = <a class="var it590" onMouseOver="hilite(590)" onMouseOut="lolite()" onClick="logVariable('from')" href="../_variables/from.html">$from</a>-&gt;<a onClick="logVariable('priority')" class="var it40265" onMouseOver="hilite(40265)" onMouseOut="lolite()" href="../_variables/priority.html">priority</a>;
<a name="l5577"><span class="linenum">5577</span></a>      }
<a name="l5578"><span class="linenum">5578</span></a>  
<a name="l5579"><span class="linenum">5579</span></a>      if (<a class="var it13074" onMouseOver="hilite(13074)" onMouseOut="lolite()" onClick="logVariable('messagehtml')" href="../_variables/messagehtml.html">$messagehtml</a> &amp;&amp; !empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('mailformat')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/mailformat.html">mailformat</a>) &amp;&amp; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('mailformat')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/mailformat.html">mailformat</a> == 1) {
<a name="l5580"><span class="linenum">5580</span></a>  <span class="comment">        // Don't ever send HTML to users who don't want it.</span>
<a name="l5581"><span class="linenum">5581</span></a>          <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a class="function" onClick="logFunction('isHTML')" href="../_functions/ishtml.html" onMouseOver="funcPopup(event,'ishtml')">isHTML</a>(true);
<a name="l5582"><span class="linenum">5582</span></a>          <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('Encoding')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/Encoding.html">Encoding</a> = 'quoted-printable';
<a name="l5583"><span class="linenum">5583</span></a>          <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('Body')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/Body.html">Body</a>    =  <a class="var it13074" onMouseOver="hilite(13074)" onMouseOut="lolite()" onClick="logVariable('messagehtml')" href="../_variables/messagehtml.html">$messagehtml</a>;
<a name="l5584"><span class="linenum">5584</span></a>          <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('AltBody')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/AltBody.html">AltBody</a> =  &quot;\n<a class="var it13073" onMouseOver="hilite(13073)" onMouseOut="lolite()" onClick="logVariable('messagetext')" href="../_variables/messagetext.html">$messagetext</a>\n&quot;;
<a name="l5585"><span class="linenum">5585</span></a>      } else {
<a name="l5586"><span class="linenum">5586</span></a>          <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a class="function" onClick="logFunction('IsHTML')" href="../_functions/ishtml.html" onMouseOver="funcPopup(event,'ishtml')">IsHTML</a>(false);
<a name="l5587"><span class="linenum">5587</span></a>          <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('Body')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/Body.html">Body</a> =  &quot;\n<a class="var it13073" onMouseOver="hilite(13073)" onMouseOut="lolite()" onClick="logVariable('messagetext')" href="../_variables/messagetext.html">$messagetext</a>\n&quot;;
<a name="l5588"><span class="linenum">5588</span></a>      }
<a name="l5589"><span class="linenum">5589</span></a>  
<a name="l5590"><span class="linenum">5590</span></a>      if (<a class="var it1437" onMouseOver="hilite(1437)" onMouseOut="lolite()" onClick="logVariable('attachment')" href="../_variables/attachment.html">$attachment</a> &amp;&amp; <a class="var it13075" onMouseOver="hilite(13075)" onMouseOut="lolite()" onClick="logVariable('attachname')" href="../_variables/attachname.html">$attachname</a>) {
<a name="l5591"><span class="linenum">5591</span></a>          if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( &quot;~\\.\\.~&quot; , <a class="var it1437" onMouseOver="hilite(1437)" onMouseOut="lolite()" onClick="logVariable('attachment')" href="../_variables/attachment.html">$attachment</a> )) {
<a name="l5592"><span class="linenum">5592</span></a>  <span class="comment">            // Security check for &quot;..&quot; in dir path.</span>
<a name="l5593"><span class="linenum">5593</span></a>              <a class="var it13083" onMouseOver="hilite(13083)" onMouseOut="lolite()" onClick="logVariable('temprecipients')" href="../_variables/temprecipients.html">$temprecipients</a>[] = array(<a class="var it4026" onMouseOver="hilite(4026)" onMouseOut="lolite()" onClick="logVariable('supportuser')" href="../_variables/supportuser.html">$supportuser</a>-&gt;<a onClick="logVariable('email')" class="var it41076" onMouseOver="hilite(41076)" onMouseOut="lolite()" href="../_variables/email.html">email</a>, <a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it4026" onMouseOver="hilite(4026)" onMouseOut="lolite()" onClick="logVariable('supportuser')" href="../_variables/supportuser.html">$supportuser</a>, true));
<a name="l5594"><span class="linenum">5594</span></a>              <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a class="function" onClick="logFunction('addStringAttachment')" href="../_functions/addstringattachment.html" onMouseOver="funcPopup(event,'addstringattachment')">addStringAttachment</a>('Error in attachment.  User attempted to attach a filename with a unsafe name.', 'error.txt', '8bit', 'text/plain');
<a name="l5595"><span class="linenum">5595</span></a>          } else {
<a name="l5596"><span class="linenum">5596</span></a>              require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/libdir.html">libdir</a>.'/filelib.php');
<a name="l5597"><span class="linenum">5597</span></a>              <a class="var it2542" onMouseOver="hilite(2542)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../_variables/mimetype.html">$mimetype</a> = <a class="function" onClick="logFunction('mimeinfo')" href="../_functions/mimeinfo.html" onMouseOver="funcPopup(event,'mimeinfo')">mimeinfo</a>('type', <a class="var it13075" onMouseOver="hilite(13075)" onMouseOut="lolite()" onClick="logVariable('attachname')" href="../_variables/attachname.html">$attachname</a>);
<a name="l5598"><span class="linenum">5598</span></a>  
<a name="l5599"><span class="linenum">5599</span></a>              <a class="var it13090" onMouseOver="hilite(13090)" onMouseOut="lolite()" onClick="logVariable('attachmentpath')" href="../_variables/attachmentpath.html">$attachmentpath</a> = <a class="var it1437" onMouseOver="hilite(1437)" onMouseOut="lolite()" onClick="logVariable('attachment')" href="../_variables/attachment.html">$attachment</a>;
<a name="l5600"><span class="linenum">5600</span></a>  
<a name="l5601"><span class="linenum">5601</span></a>  <span class="comment">            // Before doing the comparison, make sure that the paths are correct (Windows uses slashes in the other direction).</span>
<a name="l5602"><span class="linenum">5602</span></a>              <a class="var it13091" onMouseOver="hilite(13091)" onMouseOut="lolite()" onClick="logVariable('attachpath')" href="../_variables/attachpath.html">$attachpath</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('\\', '/', <a class="var it13090" onMouseOver="hilite(13090)" onMouseOut="lolite()" onClick="logVariable('attachmentpath')" href="../_variables/attachmentpath.html">$attachmentpath</a>);
<a name="l5603"><span class="linenum">5603</span></a>  <span class="comment">            // Make sure both variables are normalised before comparing.</span>
<a name="l5604"><span class="linenum">5604</span></a>              <a class="var it13092" onMouseOver="hilite(13092)" onMouseOut="lolite()" onClick="logVariable('temppath')" href="../_variables/temppath.html">$temppath</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('\\', '/', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('tempdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/tempdir.html">tempdir</a>);
<a name="l5605"><span class="linenum">5605</span></a>  
<a name="l5606"><span class="linenum">5606</span></a>  <span class="comment">            // If the attachment is a full path to a file in the tempdir, use it as is,</span>
<a name="l5607"><span class="linenum">5607</span></a>  <span class="comment">            // otherwise assume it is a relative path from the dataroot (for backwards compatibility reasons).</span>
<a name="l5608"><span class="linenum">5608</span></a>              if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it13091" onMouseOver="hilite(13091)" onMouseOut="lolite()" onClick="logVariable('attachpath')" href="../_variables/attachpath.html">$attachpath</a>, <a class="phpfunction" onClick="logFunction('realpath')" href="../_functions/realpath.html" onMouseOver="phpfuncPopup(event,'realpath')">realpath</a>(<a class="var it13092" onMouseOver="hilite(13092)" onMouseOut="lolite()" onClick="logVariable('temppath')" href="../_variables/temppath.html">$temppath</a>)) !== 0) {
<a name="l5609"><span class="linenum">5609</span></a>                  <a class="var it13090" onMouseOver="hilite(13090)" onMouseOut="lolite()" onClick="logVariable('attachmentpath')" href="../_variables/attachmentpath.html">$attachmentpath</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dataroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dataroot.html">dataroot</a> . '/' . <a class="var it13090" onMouseOver="hilite(13090)" onMouseOut="lolite()" onClick="logVariable('attachmentpath')" href="../_variables/attachmentpath.html">$attachmentpath</a>;
<a name="l5610"><span class="linenum">5610</span></a>              }
<a name="l5611"><span class="linenum">5611</span></a>  
<a name="l5612"><span class="linenum">5612</span></a>              <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a class="function" onClick="logFunction('addAttachment')" href="../_functions/addattachment.html" onMouseOver="funcPopup(event,'addattachment')">addAttachment</a>(<a class="var it13090" onMouseOver="hilite(13090)" onMouseOut="lolite()" onClick="logVariable('attachmentpath')" href="../_variables/attachmentpath.html">$attachmentpath</a>, <a class="var it13075" onMouseOver="hilite(13075)" onMouseOut="lolite()" onClick="logVariable('attachname')" href="../_variables/attachname.html">$attachname</a>, 'base64', <a class="var it2542" onMouseOver="hilite(2542)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../_variables/mimetype.html">$mimetype</a>);
<a name="l5613"><span class="linenum">5613</span></a>          }
<a name="l5614"><span class="linenum">5614</span></a>      }
<a name="l5615"><span class="linenum">5615</span></a>  
<a name="l5616"><span class="linenum">5616</span></a>  <span class="comment">    // Check if the email should be sent in an other charset then the default UTF-8.</span>
<a name="l5617"><span class="linenum">5617</span></a>      if ((!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sitemailcharset')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/sitemailcharset.html">sitemailcharset</a>) || !empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('allowusermailcharset')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/allowusermailcharset.html">allowusermailcharset</a>))) {
<a name="l5618"><span class="linenum">5618</span></a>  
<a name="l5619"><span class="linenum">5619</span></a>  <span class="comment">        // Use the defined site mail charset or eventually the one preferred by the recipient.</span>
<a name="l5620"><span class="linenum">5620</span></a>          <a class="var it2646" onMouseOver="hilite(2646)" onMouseOut="lolite()" onClick="logVariable('charset')" href="../_variables/charset.html">$charset</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sitemailcharset')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/sitemailcharset.html">sitemailcharset</a>;
<a name="l5621"><span class="linenum">5621</span></a>          if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('allowusermailcharset')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/allowusermailcharset.html">allowusermailcharset</a>)) {
<a name="l5622"><span class="linenum">5622</span></a>              if (<a class="var it13095" onMouseOver="hilite(13095)" onMouseOut="lolite()" onClick="logVariable('useremailcharset')" href="../_variables/useremailcharset.html">$useremailcharset</a> = <a class="function" onClick="logFunction('get_user_preferences')" href="../_functions/get_user_preferences.html" onMouseOver="funcPopup(event,'get_user_preferences')">get_user_preferences</a>('mailcharset', '0', <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)) {
<a name="l5623"><span class="linenum">5623</span></a>                  <a class="var it2646" onMouseOver="hilite(2646)" onMouseOut="lolite()" onClick="logVariable('charset')" href="../_variables/charset.html">$charset</a> = <a class="var it13095" onMouseOver="hilite(13095)" onMouseOut="lolite()" onClick="logVariable('useremailcharset')" href="../_variables/useremailcharset.html">$useremailcharset</a>;
<a name="l5624"><span class="linenum">5624</span></a>              }
<a name="l5625"><span class="linenum">5625</span></a>          }
<a name="l5626"><span class="linenum">5626</span></a>  
<a name="l5627"><span class="linenum">5627</span></a>  <span class="comment">        // Convert all the necessary strings if the charset is supported.</span>
<a name="l5628"><span class="linenum">5628</span></a>          <a class="var it4138" onMouseOver="hilite(4138)" onMouseOut="lolite()" onClick="logVariable('charsets')" href="../_variables/charsets.html">$charsets</a> = <a class="function" onClick="logFunction('get_list_of_charsets')" href="../_functions/get_list_of_charsets.html" onMouseOver="funcPopup(event,'get_list_of_charsets')">get_list_of_charsets</a>();
<a name="l5629"><span class="linenum">5629</span></a>          unset(<a class="var it4138" onMouseOver="hilite(4138)" onMouseOut="lolite()" onClick="logVariable('charsets')" href="../_variables/charsets.html">$charsets</a>['UTF-8']);
<a name="l5630"><span class="linenum">5630</span></a>          if (<a class="phpfunction" onClick="logFunction('in_array')" href="../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it2646" onMouseOver="hilite(2646)" onMouseOut="lolite()" onClick="logVariable('charset')" href="../_variables/charset.html">$charset</a>, <a class="var it4138" onMouseOver="hilite(4138)" onMouseOut="lolite()" onClick="logVariable('charsets')" href="../_variables/charsets.html">$charsets</a>)) {
<a name="l5631"><span class="linenum">5631</span></a>              <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('CharSet')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/CharSet.html">CharSet</a>  = <a class="var it2646" onMouseOver="hilite(2646)" onMouseOut="lolite()" onClick="logVariable('charset')" href="../_variables/charset.html">$charset</a>;
<a name="l5632"><span class="linenum">5632</span></a>              <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('FromName')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/FromName.html">FromName</a> = <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('FromName')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/FromName.html">FromName</a>, 'utf-8', <a class="phpfunction" onClick="logFunction('strtolower')" href="../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it2646" onMouseOver="hilite(2646)" onMouseOut="lolite()" onClick="logVariable('charset')" href="../_variables/charset.html">$charset</a>));
<a name="l5633"><span class="linenum">5633</span></a>              <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('Subject')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/Subject.html">Subject</a>  = <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('Subject')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/Subject.html">Subject</a>, 'utf-8', <a class="phpfunction" onClick="logFunction('strtolower')" href="../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it2646" onMouseOver="hilite(2646)" onMouseOut="lolite()" onClick="logVariable('charset')" href="../_variables/charset.html">$charset</a>));
<a name="l5634"><span class="linenum">5634</span></a>              <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('Body')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/Body.html">Body</a>     = <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('Body')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/Body.html">Body</a>, 'utf-8', <a class="phpfunction" onClick="logFunction('strtolower')" href="../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it2646" onMouseOver="hilite(2646)" onMouseOut="lolite()" onClick="logVariable('charset')" href="../_variables/charset.html">$charset</a>));
<a name="l5635"><span class="linenum">5635</span></a>              <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('AltBody')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/AltBody.html">AltBody</a>  = <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('AltBody')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/AltBody.html">AltBody</a>, 'utf-8', <a class="phpfunction" onClick="logFunction('strtolower')" href="../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it2646" onMouseOver="hilite(2646)" onMouseOut="lolite()" onClick="logVariable('charset')" href="../_variables/charset.html">$charset</a>));
<a name="l5636"><span class="linenum">5636</span></a>  
<a name="l5637"><span class="linenum">5637</span></a>              foreach (<a class="var it13083" onMouseOver="hilite(13083)" onMouseOut="lolite()" onClick="logVariable('temprecipients')" href="../_variables/temprecipients.html">$temprecipients</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../_variables/values.html">$values</a>) {
<a name="l5638"><span class="linenum">5638</span></a>                  <a class="var it13083" onMouseOver="hilite(13083)" onMouseOut="lolite()" onClick="logVariable('temprecipients')" href="../_variables/temprecipients.html">$temprecipients</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>][1] = <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../_variables/values.html">$values</a>[1], 'utf-8', <a class="phpfunction" onClick="logFunction('strtolower')" href="../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it2646" onMouseOver="hilite(2646)" onMouseOut="lolite()" onClick="logVariable('charset')" href="../_variables/charset.html">$charset</a>));
<a name="l5639"><span class="linenum">5639</span></a>              }
<a name="l5640"><span class="linenum">5640</span></a>              foreach (<a class="var it13084" onMouseOver="hilite(13084)" onMouseOut="lolite()" onClick="logVariable('tempreplyto')" href="../_variables/tempreplyto.html">$tempreplyto</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../_variables/values.html">$values</a>) {
<a name="l5641"><span class="linenum">5641</span></a>                  <a class="var it13084" onMouseOver="hilite(13084)" onMouseOut="lolite()" onClick="logVariable('tempreplyto')" href="../_variables/tempreplyto.html">$tempreplyto</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>][1] = <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('convert')" href="../_functions/convert.html" onMouseOver="funcPopup(event,'convert')">convert</a>(<a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../_variables/values.html">$values</a>[1], 'utf-8', <a class="phpfunction" onClick="logFunction('strtolower')" href="../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it2646" onMouseOver="hilite(2646)" onMouseOut="lolite()" onClick="logVariable('charset')" href="../_variables/charset.html">$charset</a>));
<a name="l5642"><span class="linenum">5642</span></a>              }
<a name="l5643"><span class="linenum">5643</span></a>          }
<a name="l5644"><span class="linenum">5644</span></a>      }
<a name="l5645"><span class="linenum">5645</span></a>  
<a name="l5646"><span class="linenum">5646</span></a>      foreach (<a class="var it13083" onMouseOver="hilite(13083)" onMouseOut="lolite()" onClick="logVariable('temprecipients')" href="../_variables/temprecipients.html">$temprecipients</a> as <a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../_variables/values.html">$values</a>) {
<a name="l5647"><span class="linenum">5647</span></a>          <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a class="function" onClick="logFunction('addAddress')" href="../_functions/addaddress.html" onMouseOver="funcPopup(event,'addaddress')">addAddress</a>(<a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../_variables/values.html">$values</a>[0], <a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../_variables/values.html">$values</a>[1]);
<a name="l5648"><span class="linenum">5648</span></a>      }
<a name="l5649"><span class="linenum">5649</span></a>      foreach (<a class="var it13084" onMouseOver="hilite(13084)" onMouseOut="lolite()" onClick="logVariable('tempreplyto')" href="../_variables/tempreplyto.html">$tempreplyto</a> as <a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../_variables/values.html">$values</a>) {
<a name="l5650"><span class="linenum">5650</span></a>          <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a class="function" onClick="logFunction('addReplyTo')" href="../_functions/addreplyto.html" onMouseOver="funcPopup(event,'addreplyto')">addReplyTo</a>(<a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../_variables/values.html">$values</a>[0], <a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../_variables/values.html">$values</a>[1]);
<a name="l5651"><span class="linenum">5651</span></a>      }
<a name="l5652"><span class="linenum">5652</span></a>  
<a name="l5653"><span class="linenum">5653</span></a>      if (<a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a class="function" onClick="logFunction('send')" href="../_functions/send.html" onMouseOver="funcPopup(event,'send')">send</a>()) {
<a name="l5654"><span class="linenum">5654</span></a>          <a class="function" onClick="logFunction('set_send_count')" href="../_functions/set_send_count.html" onMouseOver="funcPopup(event,'set_send_count')">set_send_count</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l5655"><span class="linenum">5655</span></a>          if (!empty(<a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('SMTPDebug')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/SMTPDebug.html">SMTPDebug</a>)) {
<a name="l5656"><span class="linenum">5656</span></a>              echo '&lt;/pre&gt;';
<a name="l5657"><span class="linenum">5657</span></a>          }
<a name="l5658"><span class="linenum">5658</span></a>          return true;
<a name="l5659"><span class="linenum">5659</span></a>      } else {
<a name="l5660"><span class="linenum">5660</span></a>  <span class="comment">        // Trigger event for failing to send email.</span>
<a name="l5661"><span class="linenum">5661</span></a>          <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a> = \core\event\<a class="class" onClick="logClass('email_failed')" href="../_classes/email_failed.html" onMouseOver="classPopup(event,'email_failed')">email_failed</a>::<a class="function" onClick="logFunction('create')" href="../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(array(
<a name="l5662"><span class="linenum">5662</span></a>              'context' =&gt; <a class="class" onClick="logClass('context_system')" href="../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(),
<a name="l5663"><span class="linenum">5663</span></a>              'userid' =&gt; <a class="var it590" onMouseOver="hilite(590)" onMouseOut="lolite()" onClick="logVariable('from')" href="../_variables/from.html">$from</a>-&gt;<a onClick="logVariable('id')" class="var it40265" onMouseOver="hilite(40265)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l5664"><span class="linenum">5664</span></a>              'relateduserid' =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l5665"><span class="linenum">5665</span></a>              'other' =&gt; array(
<a name="l5666"><span class="linenum">5666</span></a>                  'subject' =&gt; <a class="var it1426" onMouseOver="hilite(1426)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../_variables/subject.html">$subject</a>,
<a name="l5667"><span class="linenum">5667</span></a>                  'message' =&gt; <a class="var it13073" onMouseOver="hilite(13073)" onMouseOut="lolite()" onClick="logVariable('messagetext')" href="../_variables/messagetext.html">$messagetext</a>,
<a name="l5668"><span class="linenum">5668</span></a>                  'errorinfo' =&gt; <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;ErrorInfo
<a name="l5669"><span class="linenum">5669</span></a>              )
<a name="l5670"><span class="linenum">5670</span></a>          ));
<a name="l5671"><span class="linenum">5671</span></a>          <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('event')" href="../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l5672"><span class="linenum">5672</span></a>          if (<a class="constant" onClick="logConstant('CLI_SCRIPT')" href="../_constants/CLI_SCRIPT.html" onMouseOver="constPopup(event,'CLI_SCRIPT')">CLI_SCRIPT</a>) {
<a name="l5673"><span class="linenum">5673</span></a>              <a class="function" onClick="logFunction('mtrace')" href="../_functions/mtrace.html" onMouseOver="funcPopup(event,'mtrace')">mtrace</a>('Error: lib/moodlelib.php <a class="function" onClick="logFunction('email_to_user')" href="../_functions/email_to_user.html" onMouseOver="funcPopup(event,'email_to_user')">email_to_user</a>(): '.<a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('ErrorInfo')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/ErrorInfo.html">ErrorInfo</a>);
<a name="l5674"><span class="linenum">5674</span></a>          }
<a name="l5675"><span class="linenum">5675</span></a>          if (!empty(<a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('mail')" href="../_variables/mail.html">$mail</a>-&gt;<a onClick="logVariable('SMTPDebug')" class="var it41075" onMouseOver="hilite(41075)" onMouseOut="lolite()" href="../_variables/SMTPDebug.html">SMTPDebug</a>)) {
<a name="l5676"><span class="linenum">5676</span></a>              echo '&lt;/pre&gt;';
<a name="l5677"><span class="linenum">5677</span></a>          }
<a name="l5678"><span class="linenum">5678</span></a>          return false;
<a name="l5679"><span class="linenum">5679</span></a>      }
<a name="l5680"><span class="linenum">5680</span></a>  }
<a name="l5681"><span class="linenum">5681</span></a>  
<a name="l5682"><span class="linenum">5682</span></a>  <span class="comment">/**</span>
<a name="l5683"><span class="linenum">5683</span></a>  <span class="comment"> * Generate a signoff for emails based on support settings</span>
<a name="l5684"><span class="linenum">5684</span></a>  <span class="comment"> *</span>
<a name="l5685"><span class="linenum">5685</span></a>  <span class="comment"> * @return string</span>
<a name="l5686"><span class="linenum">5686</span></a>  <span class="comment"> */</span>
<a name="l5687"><span class="linenum">5687</span></a>  function <a class="function" onClick="logFunction('generate_email_signoff')" href="../_functions/generate_email_signoff.html" onMouseOver="funcPopup(event,'generate_email_signoff')">generate_email_signoff</a>() {
<a name="l5688"><span class="linenum">5688</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l5689"><span class="linenum">5689</span></a>  
<a name="l5690"><span class="linenum">5690</span></a>      <a class="var it13097" onMouseOver="hilite(13097)" onMouseOut="lolite()" onClick="logVariable('signoff')" href="../_variables/signoff.html">$signoff</a> = &quot;\n&quot;;
<a name="l5691"><span class="linenum">5691</span></a>      if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('supportname')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/supportname.html">supportname</a>)) {
<a name="l5692"><span class="linenum">5692</span></a>          <a class="var it13097" onMouseOver="hilite(13097)" onMouseOut="lolite()" onClick="logVariable('signoff')" href="../_variables/signoff.html">$signoff</a> .= <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('supportname')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/supportname.html">supportname</a>.&quot;\n&quot;;
<a name="l5693"><span class="linenum">5693</span></a>      }
<a name="l5694"><span class="linenum">5694</span></a>      if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('supportemail')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/supportemail.html">supportemail</a>)) {
<a name="l5695"><span class="linenum">5695</span></a>          <a class="var it13097" onMouseOver="hilite(13097)" onMouseOut="lolite()" onClick="logVariable('signoff')" href="../_variables/signoff.html">$signoff</a> .= <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('supportemail')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/supportemail.html">supportemail</a>.&quot;\n&quot;;
<a name="l5696"><span class="linenum">5696</span></a>      }
<a name="l5697"><span class="linenum">5697</span></a>      if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('supportpage')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/supportpage.html">supportpage</a>)) {
<a name="l5698"><span class="linenum">5698</span></a>          <a class="var it13097" onMouseOver="hilite(13097)" onMouseOut="lolite()" onClick="logVariable('signoff')" href="../_variables/signoff.html">$signoff</a> .= <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('supportpage')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/supportpage.html">supportpage</a>.&quot;\n&quot;;
<a name="l5699"><span class="linenum">5699</span></a>      }
<a name="l5700"><span class="linenum">5700</span></a>      return <a class="var it13097" onMouseOver="hilite(13097)" onMouseOut="lolite()" onClick="logVariable('signoff')" href="../_variables/signoff.html">$signoff</a>;
<a name="l5701"><span class="linenum">5701</span></a>  }
<a name="l5702"><span class="linenum">5702</span></a>  
<a name="l5703"><span class="linenum">5703</span></a>  <span class="comment">/**</span>
<a name="l5704"><span class="linenum">5704</span></a>  <span class="comment"> * Sets specified user's password and send the new password to the user via email.</span>
<a name="l5705"><span class="linenum">5705</span></a>  <span class="comment"> *</span>
<a name="l5706"><span class="linenum">5706</span></a>  <span class="comment"> * @param stdClass $user A {@link $USER} object</span>
<a name="l5707"><span class="linenum">5707</span></a>  <span class="comment"> * @param bool $fasthash If true, use a low cost factor when generating the hash for speed.</span>
<a name="l5708"><span class="linenum">5708</span></a>  <span class="comment"> * @return bool|string Returns &quot;true&quot; if mail was sent OK and &quot;false&quot; if there was an error</span>
<a name="l5709"><span class="linenum">5709</span></a>  <span class="comment"> */</span>
<a name="l5710"><span class="linenum">5710</span></a>  function <a class="function" onClick="logFunction('setnew_password_and_mail')" href="../_functions/setnew_password_and_mail.html" onMouseOver="funcPopup(event,'setnew_password_and_mail')">setnew_password_and_mail</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it10742" onMouseOver="hilite(10742)" onMouseOut="lolite()" onClick="logVariable('fasthash')" href="../_variables/fasthash.html">$fasthash</a> = false) {
<a name="l5711"><span class="linenum">5711</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l5712"><span class="linenum">5712</span></a>  
<a name="l5713"><span class="linenum">5713</span></a>  <span class="comment">    // We try to send the mail in language the user understands,</span>
<a name="l5714"><span class="linenum">5714</span></a>  <span class="comment">    // unfortunately the filter_string() does not support alternative langs yet</span>
<a name="l5715"><span class="linenum">5715</span></a>  <span class="comment">    // so multilang will not work properly for site-&gt;fullname.</span>
<a name="l5716"><span class="linenum">5716</span></a>      <a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a> = empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('lang')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>) ? <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('lang')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a> : <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('lang')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>;
<a name="l5717"><span class="linenum">5717</span></a>  
<a name="l5718"><span class="linenum">5718</span></a>      <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('site')" href="../_variables/site.html">$site</a>  = <a class="function" onClick="logFunction('get_site')" href="../_functions/get_site.html" onMouseOver="funcPopup(event,'get_site')">get_site</a>();
<a name="l5719"><span class="linenum">5719</span></a>  
<a name="l5720"><span class="linenum">5720</span></a>      <a class="var it4026" onMouseOver="hilite(4026)" onMouseOut="lolite()" onClick="logVariable('supportuser')" href="../_variables/supportuser.html">$supportuser</a> = <a class="class" onClick="logClass('core_user')" href="../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('get_support_user')" href="../_functions/get_support_user.html" onMouseOver="funcPopup(event,'get_support_user')">get_support_user</a>();
<a name="l5721"><span class="linenum">5721</span></a>  
<a name="l5722"><span class="linenum">5722</span></a>      <a class="var it8633" onMouseOver="hilite(8633)" onMouseOut="lolite()" onClick="logVariable('newpassword')" href="../_variables/newpassword.html">$newpassword</a> = <a class="function" onClick="logFunction('generate_password')" href="../_functions/generate_password.html" onMouseOver="funcPopup(event,'generate_password')">generate_password</a>();
<a name="l5723"><span class="linenum">5723</span></a>  
<a name="l5724"><span class="linenum">5724</span></a>      <a class="function" onClick="logFunction('update_internal_user_password')" href="../_functions/update_internal_user_password.html" onMouseOver="funcPopup(event,'update_internal_user_password')">update_internal_user_password</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it8633" onMouseOver="hilite(8633)" onMouseOut="lolite()" onClick="logVariable('newpassword')" href="../_variables/newpassword.html">$newpassword</a>, <a class="var it10742" onMouseOver="hilite(10742)" onMouseOut="lolite()" onClick="logVariable('fasthash')" href="../_variables/fasthash.html">$fasthash</a>);
<a name="l5725"><span class="linenum">5725</span></a>  
<a name="l5726"><span class="linenum">5726</span></a>      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a> = new stdClass();
<a name="l5727"><span class="linenum">5727</span></a>      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('firstname')" class="var it39489" onMouseOver="hilite(39489)" onMouseOut="lolite()" href="../_variables/firstname.html">firstname</a>   = <a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, true);
<a name="l5728"><span class="linenum">5728</span></a>      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('sitename')" class="var it39489" onMouseOver="hilite(39489)" onMouseOut="lolite()" href="../_variables/sitename.html">sitename</a>    = <a class="function" onClick="logFunction('format_string')" href="../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('site')" href="../_variables/site.html">$site</a>-&gt;<a onClick="logVariable('fullname')" class="var it39527" onMouseOver="hilite(39527)" onMouseOut="lolite()" href="../_variables/fullname.html">fullname</a>);
<a name="l5729"><span class="linenum">5729</span></a>      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('username')" class="var it39489" onMouseOver="hilite(39489)" onMouseOut="lolite()" href="../_variables/username.html">username</a>    = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/username.html">username</a>;
<a name="l5730"><span class="linenum">5730</span></a>      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('newpassword')" class="var it39489" onMouseOver="hilite(39489)" onMouseOut="lolite()" href="../_variables/newpassword.html">newpassword</a> = <a class="var it8633" onMouseOver="hilite(8633)" onMouseOut="lolite()" onClick="logVariable('newpassword')" href="../_variables/newpassword.html">$newpassword</a>;
<a name="l5731"><span class="linenum">5731</span></a>      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('link')" class="var it39489" onMouseOver="hilite(39489)" onMouseOut="lolite()" href="../_variables/link.html">link</a>        = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a> .'/login/';
<a name="l5732"><span class="linenum">5732</span></a>      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('signoff')" class="var it39489" onMouseOver="hilite(39489)" onMouseOut="lolite()" href="../_variables/signoff.html">signoff</a>     = <a class="function" onClick="logFunction('generate_email_signoff')" href="../_functions/generate_email_signoff.html" onMouseOver="funcPopup(event,'generate_email_signoff')">generate_email_signoff</a>();
<a name="l5733"><span class="linenum">5733</span></a>  
<a name="l5734"><span class="linenum">5734</span></a>      <a class="var it643" onMouseOver="hilite(643)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a> = (string)<span class="keyword">new </span><a class="class" onClick="logClass('lang_string')" href="../_classes/lang_string.html" onMouseOver="classPopup(event,'lang_string')">lang_string</a>('newusernewpasswordtext', '', <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>, <a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a>);
<a name="l5735"><span class="linenum">5735</span></a>  
<a name="l5736"><span class="linenum">5736</span></a>      <a class="var it1426" onMouseOver="hilite(1426)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../_variables/subject.html">$subject</a> = <a class="function" onClick="logFunction('format_string')" href="../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('site')" href="../_variables/site.html">$site</a>-&gt;<a onClick="logVariable('fullname')" class="var it39527" onMouseOver="hilite(39527)" onMouseOut="lolite()" href="../_variables/fullname.html">fullname</a>) .': '. (string)<span class="keyword">new </span><a class="class" onClick="logClass('lang_string')" href="../_classes/lang_string.html" onMouseOver="classPopup(event,'lang_string')">lang_string</a>('newusernewpasswordsubj', '', <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>, <a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a>);
<a name="l5737"><span class="linenum">5737</span></a>  
<a name="l5738"><span class="linenum">5738</span></a>  <span class="comment">    // Directly email rather than using the messaging system to ensure its not routed to a popup or jabber.</span>
<a name="l5739"><span class="linenum">5739</span></a>      return <a class="function" onClick="logFunction('email_to_user')" href="../_functions/email_to_user.html" onMouseOver="funcPopup(event,'email_to_user')">email_to_user</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it4026" onMouseOver="hilite(4026)" onMouseOut="lolite()" onClick="logVariable('supportuser')" href="../_variables/supportuser.html">$supportuser</a>, <a class="var it1426" onMouseOver="hilite(1426)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../_variables/subject.html">$subject</a>, <a class="var it643" onMouseOver="hilite(643)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>);
<a name="l5740"><span class="linenum">5740</span></a>  
<a name="l5741"><span class="linenum">5741</span></a>  }
<a name="l5742"><span class="linenum">5742</span></a>  
<a name="l5743"><span class="linenum">5743</span></a>  <span class="comment">/**</span>
<a name="l5744"><span class="linenum">5744</span></a>  <span class="comment"> * Resets specified user's password and send the new password to the user via email.</span>
<a name="l5745"><span class="linenum">5745</span></a>  <span class="comment"> *</span>
<a name="l5746"><span class="linenum">5746</span></a>  <span class="comment"> * @param stdClass $user A {@link $USER} object</span>
<a name="l5747"><span class="linenum">5747</span></a>  <span class="comment"> * @return bool Returns true if mail was sent OK and false if there was an error.</span>
<a name="l5748"><span class="linenum">5748</span></a>  <span class="comment"> */</span>
<a name="l5749"><span class="linenum">5749</span></a>  function <a class="function" onClick="logFunction('reset_password_and_mail')" href="../_functions/reset_password_and_mail.html" onMouseOver="funcPopup(event,'reset_password_and_mail')">reset_password_and_mail</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>) {
<a name="l5750"><span class="linenum">5750</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l5751"><span class="linenum">5751</span></a>  
<a name="l5752"><span class="linenum">5752</span></a>      <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('site')" href="../_variables/site.html">$site</a>  = <a class="function" onClick="logFunction('get_site')" href="../_functions/get_site.html" onMouseOver="funcPopup(event,'get_site')">get_site</a>();
<a name="l5753"><span class="linenum">5753</span></a>      <a class="var it4026" onMouseOver="hilite(4026)" onMouseOut="lolite()" onClick="logVariable('supportuser')" href="../_variables/supportuser.html">$supportuser</a> = <a class="class" onClick="logClass('core_user')" href="../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('get_support_user')" href="../_functions/get_support_user.html" onMouseOver="funcPopup(event,'get_support_user')">get_support_user</a>();
<a name="l5754"><span class="linenum">5754</span></a>  
<a name="l5755"><span class="linenum">5755</span></a>      <a class="var it4006" onMouseOver="hilite(4006)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a> = <a class="function" onClick="logFunction('get_auth_plugin')" href="../_functions/get_auth_plugin.html" onMouseOver="funcPopup(event,'get_auth_plugin')">get_auth_plugin</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>);
<a name="l5756"><span class="linenum">5756</span></a>      if (!<a class="var it4006" onMouseOver="hilite(4006)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a>-&gt;<a class="function" onClick="logFunction('can_reset_password')" href="../_functions/can_reset_password.html" onMouseOver="funcPopup(event,'can_reset_password')">can_reset_password</a>() or !<a class="function" onClick="logFunction('is_enabled_auth')" href="../_functions/is_enabled_auth.html" onMouseOver="funcPopup(event,'is_enabled_auth')">is_enabled_auth</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>)) {
<a name="l5757"><span class="linenum">5757</span></a>          <a class="phpfunction" onClick="logFunction('trigger_error')" href="../_functions/trigger_error.html" onMouseOver="phpfuncPopup(event,'trigger_error')">trigger_error</a>(&quot;Attempt to reset user password for user <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/username.html">username</a> with Auth <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>.&quot;);
<a name="l5758"><span class="linenum">5758</span></a>          return false;
<a name="l5759"><span class="linenum">5759</span></a>      }
<a name="l5760"><span class="linenum">5760</span></a>  
<a name="l5761"><span class="linenum">5761</span></a>      <a class="var it8633" onMouseOver="hilite(8633)" onMouseOut="lolite()" onClick="logVariable('newpassword')" href="../_variables/newpassword.html">$newpassword</a> = <a class="function" onClick="logFunction('generate_password')" href="../_functions/generate_password.html" onMouseOver="funcPopup(event,'generate_password')">generate_password</a>();
<a name="l5762"><span class="linenum">5762</span></a>  
<a name="l5763"><span class="linenum">5763</span></a>      if (!<a class="var it4006" onMouseOver="hilite(4006)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a>-&gt;<a class="function" onClick="logFunction('user_update_password')" href="../_functions/user_update_password.html" onMouseOver="funcPopup(event,'user_update_password')">user_update_password</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it8633" onMouseOver="hilite(8633)" onMouseOut="lolite()" onClick="logVariable('newpassword')" href="../_variables/newpassword.html">$newpassword</a>)) {
<a name="l5764"><span class="linenum">5764</span></a>          <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>(&quot;cannotsetpassword&quot;);
<a name="l5765"><span class="linenum">5765</span></a>      }
<a name="l5766"><span class="linenum">5766</span></a>  
<a name="l5767"><span class="linenum">5767</span></a>      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a> = new stdClass();
<a name="l5768"><span class="linenum">5768</span></a>      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('firstname')" class="var it39489" onMouseOver="hilite(39489)" onMouseOut="lolite()" href="../_variables/firstname.html">firstname</a>   = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('firstname')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/firstname.html">firstname</a>;
<a name="l5769"><span class="linenum">5769</span></a>      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('lastname')" class="var it39489" onMouseOver="hilite(39489)" onMouseOut="lolite()" href="../_variables/lastname.html">lastname</a>    = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('lastname')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/lastname.html">lastname</a>;
<a name="l5770"><span class="linenum">5770</span></a>      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('sitename')" class="var it39489" onMouseOver="hilite(39489)" onMouseOut="lolite()" href="../_variables/sitename.html">sitename</a>    = <a class="function" onClick="logFunction('format_string')" href="../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('site')" href="../_variables/site.html">$site</a>-&gt;<a onClick="logVariable('fullname')" class="var it39527" onMouseOver="hilite(39527)" onMouseOut="lolite()" href="../_variables/fullname.html">fullname</a>);
<a name="l5771"><span class="linenum">5771</span></a>      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('username')" class="var it39489" onMouseOver="hilite(39489)" onMouseOut="lolite()" href="../_variables/username.html">username</a>    = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/username.html">username</a>;
<a name="l5772"><span class="linenum">5772</span></a>      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('newpassword')" class="var it39489" onMouseOver="hilite(39489)" onMouseOut="lolite()" href="../_variables/newpassword.html">newpassword</a> = <a class="var it8633" onMouseOver="hilite(8633)" onMouseOut="lolite()" onClick="logVariable('newpassword')" href="../_variables/newpassword.html">$newpassword</a>;
<a name="l5773"><span class="linenum">5773</span></a>      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('link')" class="var it39489" onMouseOver="hilite(39489)" onMouseOut="lolite()" href="../_variables/link.html">link</a>        = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('httpswwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/httpswwwroot.html">httpswwwroot</a> .'<a class="filename" href="../login/change_password.php.html">/login/change_password.php</a>';
<a name="l5774"><span class="linenum">5774</span></a>      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('signoff')" class="var it39489" onMouseOver="hilite(39489)" onMouseOut="lolite()" href="../_variables/signoff.html">signoff</a>     = <a class="function" onClick="logFunction('generate_email_signoff')" href="../_functions/generate_email_signoff.html" onMouseOver="funcPopup(event,'generate_email_signoff')">generate_email_signoff</a>();
<a name="l5775"><span class="linenum">5775</span></a>  
<a name="l5776"><span class="linenum">5776</span></a>      <a class="var it643" onMouseOver="hilite(643)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('newpasswordtext', '', <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>);
<a name="l5777"><span class="linenum">5777</span></a>  
<a name="l5778"><span class="linenum">5778</span></a>      <a class="var it1426" onMouseOver="hilite(1426)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../_variables/subject.html">$subject</a>  = <a class="function" onClick="logFunction('format_string')" href="../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('site')" href="../_variables/site.html">$site</a>-&gt;<a onClick="logVariable('fullname')" class="var it39527" onMouseOver="hilite(39527)" onMouseOut="lolite()" href="../_variables/fullname.html">fullname</a>) .': '. <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('changedpassword');
<a name="l5779"><span class="linenum">5779</span></a>  
<a name="l5780"><span class="linenum">5780</span></a>      <a class="function" onClick="logFunction('unset_user_preference')" href="../_functions/unset_user_preference.html" onMouseOver="funcPopup(event,'unset_user_preference')">unset_user_preference</a>('create_password', <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>); <span class="comment">// Prevent cron from generating the password.</span>
<a name="l5781"><span class="linenum">5781</span></a>  
<a name="l5782"><span class="linenum">5782</span></a>  <span class="comment">    // Directly email rather than using the messaging system to ensure its not routed to a popup or jabber.</span>
<a name="l5783"><span class="linenum">5783</span></a>      return <a class="function" onClick="logFunction('email_to_user')" href="../_functions/email_to_user.html" onMouseOver="funcPopup(event,'email_to_user')">email_to_user</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it4026" onMouseOver="hilite(4026)" onMouseOut="lolite()" onClick="logVariable('supportuser')" href="../_variables/supportuser.html">$supportuser</a>, <a class="var it1426" onMouseOver="hilite(1426)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../_variables/subject.html">$subject</a>, <a class="var it643" onMouseOver="hilite(643)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>);
<a name="l5784"><span class="linenum">5784</span></a>  }
<a name="l5785"><span class="linenum">5785</span></a>  
<a name="l5786"><span class="linenum">5786</span></a>  <span class="comment">/**</span>
<a name="l5787"><span class="linenum">5787</span></a>  <span class="comment"> * Send email to specified user with confirmation text and activation link.</span>
<a name="l5788"><span class="linenum">5788</span></a>  <span class="comment"> *</span>
<a name="l5789"><span class="linenum">5789</span></a>  <span class="comment"> * @param stdClass $user A {@link $USER} object</span>
<a name="l5790"><span class="linenum">5790</span></a>  <span class="comment"> * @return bool Returns true if mail was sent OK and false if there was an error.</span>
<a name="l5791"><span class="linenum">5791</span></a>  <span class="comment"> */</span>
<a name="l5792"><span class="linenum">5792</span></a>  function <a class="function" onClick="logFunction('send_confirmation_email')" href="../_functions/send_confirmation_email.html" onMouseOver="funcPopup(event,'send_confirmation_email')">send_confirmation_email</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>) {
<a name="l5793"><span class="linenum">5793</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l5794"><span class="linenum">5794</span></a>  
<a name="l5795"><span class="linenum">5795</span></a>      <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('site')" href="../_variables/site.html">$site</a> = <a class="function" onClick="logFunction('get_site')" href="../_functions/get_site.html" onMouseOver="funcPopup(event,'get_site')">get_site</a>();
<a name="l5796"><span class="linenum">5796</span></a>      <a class="var it4026" onMouseOver="hilite(4026)" onMouseOut="lolite()" onClick="logVariable('supportuser')" href="../_variables/supportuser.html">$supportuser</a> = <a class="class" onClick="logClass('core_user')" href="../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('get_support_user')" href="../_functions/get_support_user.html" onMouseOver="funcPopup(event,'get_support_user')">get_support_user</a>();
<a name="l5797"><span class="linenum">5797</span></a>  
<a name="l5798"><span class="linenum">5798</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a> = new stdClass();
<a name="l5799"><span class="linenum">5799</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('firstname')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/firstname.html">firstname</a> = <a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l5800"><span class="linenum">5800</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('sitename')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/sitename.html">sitename</a>  = <a class="function" onClick="logFunction('format_string')" href="../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('site')" href="../_variables/site.html">$site</a>-&gt;<a onClick="logVariable('fullname')" class="var it39527" onMouseOver="hilite(39527)" onMouseOut="lolite()" href="../_variables/fullname.html">fullname</a>);
<a name="l5801"><span class="linenum">5801</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('admin')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/admin.html">admin</a>     = <a class="function" onClick="logFunction('generate_email_signoff')" href="../_functions/generate_email_signoff.html" onMouseOver="funcPopup(event,'generate_email_signoff')">generate_email_signoff</a>();
<a name="l5802"><span class="linenum">5802</span></a>  
<a name="l5803"><span class="linenum">5803</span></a>      <a class="var it1426" onMouseOver="hilite(1426)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../_variables/subject.html">$subject</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailconfirmationsubject', '', <a class="function" onClick="logFunction('format_string')" href="../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('site')" href="../_variables/site.html">$site</a>-&gt;<a onClick="logVariable('fullname')" class="var it39527" onMouseOver="hilite(39527)" onMouseOut="lolite()" href="../_variables/fullname.html">fullname</a>));
<a name="l5804"><span class="linenum">5804</span></a>  
<a name="l5805"><span class="linenum">5805</span></a>      <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a> = <a class="phpfunction" onClick="logFunction('urlencode')" href="../_functions/urlencode.html" onMouseOver="phpfuncPopup(event,'urlencode')">urlencode</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/username.html">username</a>);
<a name="l5806"><span class="linenum">5806</span></a>      <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('.', '%2E', <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>); <span class="comment">// Prevent problems with trailing dots.</span>
<a name="l5807"><span class="linenum">5807</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('link')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/link.html">link</a>  = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a> .'/login/confirm.php?data='. <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('secret')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/secret.html">secret</a> .'/'. <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>;
<a name="l5808"><span class="linenum">5808</span></a>      <a class="var it643" onMouseOver="hilite(643)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>     = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailconfirmation', '', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>);
<a name="l5809"><span class="linenum">5809</span></a>      <a class="var it13074" onMouseOver="hilite(13074)" onMouseOut="lolite()" onClick="logVariable('messagehtml')" href="../_variables/messagehtml.html">$messagehtml</a> = <a class="function" onClick="logFunction('text_to_html')" href="../_functions/text_to_html.html" onMouseOver="funcPopup(event,'text_to_html')">text_to_html</a>(<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailconfirmation', '', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>), false, false, true);
<a name="l5810"><span class="linenum">5810</span></a>  
<a name="l5811"><span class="linenum">5811</span></a>      <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('mailformat')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/mailformat.html">mailformat</a> = 1;  <span class="comment">// Always send HTML version as well.</span>
<a name="l5812"><span class="linenum">5812</span></a>  
<a name="l5813"><span class="linenum">5813</span></a>  <span class="comment">    // Directly email rather than using the messaging system to ensure its not routed to a popup or jabber.</span>
<a name="l5814"><span class="linenum">5814</span></a>      return <a class="function" onClick="logFunction('email_to_user')" href="../_functions/email_to_user.html" onMouseOver="funcPopup(event,'email_to_user')">email_to_user</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it4026" onMouseOver="hilite(4026)" onMouseOut="lolite()" onClick="logVariable('supportuser')" href="../_variables/supportuser.html">$supportuser</a>, <a class="var it1426" onMouseOver="hilite(1426)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../_variables/subject.html">$subject</a>, <a class="var it643" onMouseOver="hilite(643)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>, <a class="var it13074" onMouseOver="hilite(13074)" onMouseOut="lolite()" onClick="logVariable('messagehtml')" href="../_variables/messagehtml.html">$messagehtml</a>);
<a name="l5815"><span class="linenum">5815</span></a>  }
<a name="l5816"><span class="linenum">5816</span></a>  
<a name="l5817"><span class="linenum">5817</span></a>  <span class="comment">/**</span>
<a name="l5818"><span class="linenum">5818</span></a>  <span class="comment"> * Sends a password change confirmation email.</span>
<a name="l5819"><span class="linenum">5819</span></a>  <span class="comment"> *</span>
<a name="l5820"><span class="linenum">5820</span></a>  <span class="comment"> * @param stdClass $user A {@link $USER} object</span>
<a name="l5821"><span class="linenum">5821</span></a>  <span class="comment"> * @param stdClass $resetrecord An object tracking metadata regarding password reset request</span>
<a name="l5822"><span class="linenum">5822</span></a>  <span class="comment"> * @return bool Returns true if mail was sent OK and false if there was an error.</span>
<a name="l5823"><span class="linenum">5823</span></a>  <span class="comment"> */</span>
<a name="l5824"><span class="linenum">5824</span></a>  function <a class="function" onClick="logFunction('send_password_change_confirmation_email')" href="../_functions/send_password_change_confirmation_email.html" onMouseOver="funcPopup(event,'send_password_change_confirmation_email')">send_password_change_confirmation_email</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it5877" onMouseOver="hilite(5877)" onMouseOut="lolite()" onClick="logVariable('resetrecord')" href="../_variables/resetrecord.html">$resetrecord</a>) {
<a name="l5825"><span class="linenum">5825</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l5826"><span class="linenum">5826</span></a>  
<a name="l5827"><span class="linenum">5827</span></a>      <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('site')" href="../_variables/site.html">$site</a> = <a class="function" onClick="logFunction('get_site')" href="../_functions/get_site.html" onMouseOver="funcPopup(event,'get_site')">get_site</a>();
<a name="l5828"><span class="linenum">5828</span></a>      <a class="var it4026" onMouseOver="hilite(4026)" onMouseOut="lolite()" onClick="logVariable('supportuser')" href="../_variables/supportuser.html">$supportuser</a> = <a class="class" onClick="logClass('core_user')" href="../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('get_support_user')" href="../_functions/get_support_user.html" onMouseOver="funcPopup(event,'get_support_user')">get_support_user</a>();
<a name="l5829"><span class="linenum">5829</span></a>      <a class="var it5889" onMouseOver="hilite(5889)" onMouseOut="lolite()" onClick="logVariable('pwresetmins')" href="../_variables/pwresetmins.html">$pwresetmins</a> = isset(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('pwresettime')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/pwresettime.html">pwresettime</a>) ? <a class="phpfunction" onClick="logFunction('floor')" href="../_functions/floor.html" onMouseOver="phpfuncPopup(event,'floor')">floor</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('pwresettime')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/pwresettime.html">pwresettime</a> / <a class="constant" onClick="logConstant('MINSECS')" href="../_constants/MINSECS.html" onMouseOver="constPopup(event,'MINSECS')">MINSECS</a>) : 30;
<a name="l5830"><span class="linenum">5830</span></a>  
<a name="l5831"><span class="linenum">5831</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a> = new stdClass();
<a name="l5832"><span class="linenum">5832</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('firstname')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/firstname.html">firstname</a> = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('firstname')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/firstname.html">firstname</a>;
<a name="l5833"><span class="linenum">5833</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('lastname')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/lastname.html">lastname</a>  = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('lastname')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/lastname.html">lastname</a>;
<a name="l5834"><span class="linenum">5834</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('username')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/username.html">username</a>  = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/username.html">username</a>;
<a name="l5835"><span class="linenum">5835</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('sitename')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/sitename.html">sitename</a>  = <a class="function" onClick="logFunction('format_string')" href="../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('site')" href="../_variables/site.html">$site</a>-&gt;<a onClick="logVariable('fullname')" class="var it39527" onMouseOver="hilite(39527)" onMouseOut="lolite()" href="../_variables/fullname.html">fullname</a>);
<a name="l5836"><span class="linenum">5836</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('link')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/link.html">link</a>      = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('httpswwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/httpswwwroot.html">httpswwwroot</a> .'/login/forgot_password.php?token='. <a class="var it5877" onMouseOver="hilite(5877)" onMouseOut="lolite()" onClick="logVariable('resetrecord')" href="../_variables/resetrecord.html">$resetrecord</a>-&gt;<a onClick="logVariable('token')" class="var it41077" onMouseOver="hilite(41077)" onMouseOut="lolite()" href="../_variables/token.html">token</a>;
<a name="l5837"><span class="linenum">5837</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('admin')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/admin.html">admin</a>     = <a class="function" onClick="logFunction('generate_email_signoff')" href="../_functions/generate_email_signoff.html" onMouseOver="funcPopup(event,'generate_email_signoff')">generate_email_signoff</a>();
<a name="l5838"><span class="linenum">5838</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('resetminutes')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/resetminutes.html">resetminutes</a> = <a class="var it5889" onMouseOver="hilite(5889)" onMouseOut="lolite()" onClick="logVariable('pwresetmins')" href="../_variables/pwresetmins.html">$pwresetmins</a>;
<a name="l5839"><span class="linenum">5839</span></a>  
<a name="l5840"><span class="linenum">5840</span></a>      <a class="var it643" onMouseOver="hilite(643)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailresetconfirmation', '', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>);
<a name="l5841"><span class="linenum">5841</span></a>      <a class="var it1426" onMouseOver="hilite(1426)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../_variables/subject.html">$subject</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailresetconfirmationsubject', '', <a class="function" onClick="logFunction('format_string')" href="../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('site')" href="../_variables/site.html">$site</a>-&gt;<a onClick="logVariable('fullname')" class="var it39527" onMouseOver="hilite(39527)" onMouseOut="lolite()" href="../_variables/fullname.html">fullname</a>));
<a name="l5842"><span class="linenum">5842</span></a>  
<a name="l5843"><span class="linenum">5843</span></a>  <span class="comment">    // Directly email rather than using the messaging system to ensure its not routed to a popup or jabber.</span>
<a name="l5844"><span class="linenum">5844</span></a>      return <a class="function" onClick="logFunction('email_to_user')" href="../_functions/email_to_user.html" onMouseOver="funcPopup(event,'email_to_user')">email_to_user</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it4026" onMouseOver="hilite(4026)" onMouseOut="lolite()" onClick="logVariable('supportuser')" href="../_variables/supportuser.html">$supportuser</a>, <a class="var it1426" onMouseOver="hilite(1426)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../_variables/subject.html">$subject</a>, <a class="var it643" onMouseOver="hilite(643)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>);
<a name="l5845"><span class="linenum">5845</span></a>  
<a name="l5846"><span class="linenum">5846</span></a>  }
<a name="l5847"><span class="linenum">5847</span></a>  
<a name="l5848"><span class="linenum">5848</span></a>  <span class="comment">/**</span>
<a name="l5849"><span class="linenum">5849</span></a>  <span class="comment"> * Sends an email containinginformation on how to change your password.</span>
<a name="l5850"><span class="linenum">5850</span></a>  <span class="comment"> *</span>
<a name="l5851"><span class="linenum">5851</span></a>  <span class="comment"> * @param stdClass $user A {@link $USER} object</span>
<a name="l5852"><span class="linenum">5852</span></a>  <span class="comment"> * @return bool Returns true if mail was sent OK and false if there was an error.</span>
<a name="l5853"><span class="linenum">5853</span></a>  <span class="comment"> */</span>
<a name="l5854"><span class="linenum">5854</span></a>  function <a class="function" onClick="logFunction('send_password_change_info')" href="../_functions/send_password_change_info.html" onMouseOver="funcPopup(event,'send_password_change_info')">send_password_change_info</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>) {
<a name="l5855"><span class="linenum">5855</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l5856"><span class="linenum">5856</span></a>  
<a name="l5857"><span class="linenum">5857</span></a>      <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('site')" href="../_variables/site.html">$site</a> = <a class="function" onClick="logFunction('get_site')" href="../_functions/get_site.html" onMouseOver="funcPopup(event,'get_site')">get_site</a>();
<a name="l5858"><span class="linenum">5858</span></a>      <a class="var it4026" onMouseOver="hilite(4026)" onMouseOut="lolite()" onClick="logVariable('supportuser')" href="../_variables/supportuser.html">$supportuser</a> = <a class="class" onClick="logClass('core_user')" href="../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('get_support_user')" href="../_functions/get_support_user.html" onMouseOver="funcPopup(event,'get_support_user')">get_support_user</a>();
<a name="l5859"><span class="linenum">5859</span></a>      <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('systemcontext')" href="../_variables/systemcontext.html">$systemcontext</a> = <a class="class" onClick="logClass('context_system')" href="../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>();
<a name="l5860"><span class="linenum">5860</span></a>  
<a name="l5861"><span class="linenum">5861</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a> = new stdClass();
<a name="l5862"><span class="linenum">5862</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('firstname')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/firstname.html">firstname</a> = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('firstname')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/firstname.html">firstname</a>;
<a name="l5863"><span class="linenum">5863</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('lastname')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/lastname.html">lastname</a>  = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('lastname')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/lastname.html">lastname</a>;
<a name="l5864"><span class="linenum">5864</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('sitename')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/sitename.html">sitename</a>  = <a class="function" onClick="logFunction('format_string')" href="../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('site')" href="../_variables/site.html">$site</a>-&gt;<a onClick="logVariable('fullname')" class="var it39527" onMouseOver="hilite(39527)" onMouseOut="lolite()" href="../_variables/fullname.html">fullname</a>);
<a name="l5865"><span class="linenum">5865</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('admin')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/admin.html">admin</a>     = <a class="function" onClick="logFunction('generate_email_signoff')" href="../_functions/generate_email_signoff.html" onMouseOver="funcPopup(event,'generate_email_signoff')">generate_email_signoff</a>();
<a name="l5866"><span class="linenum">5866</span></a>  
<a name="l5867"><span class="linenum">5867</span></a>      <a class="var it4006" onMouseOver="hilite(4006)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a> = <a class="function" onClick="logFunction('get_auth_plugin')" href="../_functions/get_auth_plugin.html" onMouseOver="funcPopup(event,'get_auth_plugin')">get_auth_plugin</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>);
<a name="l5868"><span class="linenum">5868</span></a>  
<a name="l5869"><span class="linenum">5869</span></a>      if (!<a class="function" onClick="logFunction('is_enabled_auth')" href="../_functions/is_enabled_auth.html" onMouseOver="funcPopup(event,'is_enabled_auth')">is_enabled_auth</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>) or <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a> == 'nologin') {
<a name="l5870"><span class="linenum">5870</span></a>          <a class="var it643" onMouseOver="hilite(643)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailpasswordchangeinfodisabled', '', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>);
<a name="l5871"><span class="linenum">5871</span></a>          <a class="var it1426" onMouseOver="hilite(1426)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../_variables/subject.html">$subject</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailpasswordchangeinfosubject', '', <a class="function" onClick="logFunction('format_string')" href="../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('site')" href="../_variables/site.html">$site</a>-&gt;<a onClick="logVariable('fullname')" class="var it39527" onMouseOver="hilite(39527)" onMouseOut="lolite()" href="../_variables/fullname.html">fullname</a>));
<a name="l5872"><span class="linenum">5872</span></a>  <span class="comment">        // Directly email rather than using the messaging system to ensure its not routed to a popup or jabber.</span>
<a name="l5873"><span class="linenum">5873</span></a>          return <a class="function" onClick="logFunction('email_to_user')" href="../_functions/email_to_user.html" onMouseOver="funcPopup(event,'email_to_user')">email_to_user</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it4026" onMouseOver="hilite(4026)" onMouseOut="lolite()" onClick="logVariable('supportuser')" href="../_variables/supportuser.html">$supportuser</a>, <a class="var it1426" onMouseOver="hilite(1426)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../_variables/subject.html">$subject</a>, <a class="var it643" onMouseOver="hilite(643)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>);
<a name="l5874"><span class="linenum">5874</span></a>      }
<a name="l5875"><span class="linenum">5875</span></a>  
<a name="l5876"><span class="linenum">5876</span></a>      if (<a class="var it4006" onMouseOver="hilite(4006)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a>-&gt;<a class="function" onClick="logFunction('can_change_password')" href="../_functions/can_change_password.html" onMouseOver="funcPopup(event,'can_change_password')">can_change_password</a>() and <a class="var it4006" onMouseOver="hilite(4006)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a>-&gt;<a class="function" onClick="logFunction('change_password_url')" href="../_functions/change_password_url.html" onMouseOver="funcPopup(event,'change_password_url')">change_password_url</a>()) {
<a name="l5877"><span class="linenum">5877</span></a>  <span class="comment">        // We have some external url for password changing.</span>
<a name="l5878"><span class="linenum">5878</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('link')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/link.html">link</a> .= <a class="var it4006" onMouseOver="hilite(4006)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a>-&gt;<a class="function" onClick="logFunction('change_password_url')" href="../_functions/change_password_url.html" onMouseOver="funcPopup(event,'change_password_url')">change_password_url</a>();
<a name="l5879"><span class="linenum">5879</span></a>  
<a name="l5880"><span class="linenum">5880</span></a>      } else {
<a name="l5881"><span class="linenum">5881</span></a>  <span class="comment">        // No way to change password, sorry.</span>
<a name="l5882"><span class="linenum">5882</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('link')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/link.html">link</a> = '';
<a name="l5883"><span class="linenum">5883</span></a>      }
<a name="l5884"><span class="linenum">5884</span></a>  
<a name="l5885"><span class="linenum">5885</span></a>      if (!empty(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('link')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../_variables/link.html">link</a>) and <a class="function" onClick="logFunction('has_capability')" href="../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/user:changeownpassword', <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('systemcontext')" href="../_variables/systemcontext.html">$systemcontext</a>, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)) {
<a name="l5886"><span class="linenum">5886</span></a>          <a class="var it643" onMouseOver="hilite(643)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailpasswordchangeinfo', '', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>);
<a name="l5887"><span class="linenum">5887</span></a>          <a class="var it1426" onMouseOver="hilite(1426)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../_variables/subject.html">$subject</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailpasswordchangeinfosubject', '', <a class="function" onClick="logFunction('format_string')" href="../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('site')" href="../_variables/site.html">$site</a>-&gt;<a onClick="logVariable('fullname')" class="var it39527" onMouseOver="hilite(39527)" onMouseOut="lolite()" href="../_variables/fullname.html">fullname</a>));
<a name="l5888"><span class="linenum">5888</span></a>      } else {
<a name="l5889"><span class="linenum">5889</span></a>          <a class="var it643" onMouseOver="hilite(643)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailpasswordchangeinfofail', '', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>);
<a name="l5890"><span class="linenum">5890</span></a>          <a class="var it1426" onMouseOver="hilite(1426)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../_variables/subject.html">$subject</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailpasswordchangeinfosubject', '', <a class="function" onClick="logFunction('format_string')" href="../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('site')" href="../_variables/site.html">$site</a>-&gt;<a onClick="logVariable('fullname')" class="var it39527" onMouseOver="hilite(39527)" onMouseOut="lolite()" href="../_variables/fullname.html">fullname</a>));
<a name="l5891"><span class="linenum">5891</span></a>      }
<a name="l5892"><span class="linenum">5892</span></a>  
<a name="l5893"><span class="linenum">5893</span></a>  <span class="comment">    // Directly email rather than using the messaging system to ensure its not routed to a popup or jabber.</span>
<a name="l5894"><span class="linenum">5894</span></a>      return <a class="function" onClick="logFunction('email_to_user')" href="../_functions/email_to_user.html" onMouseOver="funcPopup(event,'email_to_user')">email_to_user</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it4026" onMouseOver="hilite(4026)" onMouseOut="lolite()" onClick="logVariable('supportuser')" href="../_variables/supportuser.html">$supportuser</a>, <a class="var it1426" onMouseOver="hilite(1426)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../_variables/subject.html">$subject</a>, <a class="var it643" onMouseOver="hilite(643)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>);
<a name="l5895"><span class="linenum">5895</span></a>  
<a name="l5896"><span class="linenum">5896</span></a>  }
<a name="l5897"><span class="linenum">5897</span></a>  
<a name="l5898"><span class="linenum">5898</span></a>  <span class="comment">/**</span>
<a name="l5899"><span class="linenum">5899</span></a>  <span class="comment"> * Check that an email is allowed.  It returns an error message if there was a problem.</span>
<a name="l5900"><span class="linenum">5900</span></a>  <span class="comment"> *</span>
<a name="l5901"><span class="linenum">5901</span></a>  <span class="comment"> * @param string $email Content of email</span>
<a name="l5902"><span class="linenum">5902</span></a>  <span class="comment"> * @return string|false</span>
<a name="l5903"><span class="linenum">5903</span></a>  <span class="comment"> */</span>
<a name="l5904"><span class="linenum">5904</span></a>  function <a class="function" onClick="logFunction('email_is_not_allowed')" href="../_functions/email_is_not_allowed.html" onMouseOver="funcPopup(event,'email_is_not_allowed')">email_is_not_allowed</a>(<a class="var it3362" onMouseOver="hilite(3362)" onMouseOut="lolite()" onClick="logVariable('email')" href="../_variables/email.html">$email</a>) {
<a name="l5905"><span class="linenum">5905</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l5906"><span class="linenum">5906</span></a>  
<a name="l5907"><span class="linenum">5907</span></a>      if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('allowemailaddresses')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/allowemailaddresses.html">allowemailaddresses</a>)) {
<a name="l5908"><span class="linenum">5908</span></a>          <a class="var it2730" onMouseOver="hilite(2730)" onMouseOut="lolite()" onClick="logVariable('allowed')" href="../_variables/allowed.html">$allowed</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(' ', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('allowemailaddresses')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/allowemailaddresses.html">allowemailaddresses</a>);
<a name="l5909"><span class="linenum">5909</span></a>          foreach (<a class="var it2730" onMouseOver="hilite(2730)" onMouseOut="lolite()" onClick="logVariable('allowed')" href="../_variables/allowed.html">$allowed</a> as <a class="var it13103" onMouseOver="hilite(13103)" onMouseOut="lolite()" onClick="logVariable('allowedpattern')" href="../_variables/allowedpattern.html">$allowedpattern</a>) {
<a name="l5910"><span class="linenum">5910</span></a>              <a class="var it13103" onMouseOver="hilite(13103)" onMouseOut="lolite()" onClick="logVariable('allowedpattern')" href="../_variables/allowedpattern.html">$allowedpattern</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it13103" onMouseOver="hilite(13103)" onMouseOut="lolite()" onClick="logVariable('allowedpattern')" href="../_variables/allowedpattern.html">$allowedpattern</a>);
<a name="l5911"><span class="linenum">5911</span></a>              if (!<a class="var it13103" onMouseOver="hilite(13103)" onMouseOut="lolite()" onClick="logVariable('allowedpattern')" href="../_variables/allowedpattern.html">$allowedpattern</a>) {
<a name="l5912"><span class="linenum">5912</span></a>                  continue;
<a name="l5913"><span class="linenum">5913</span></a>              }
<a name="l5914"><span class="linenum">5914</span></a>              if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it13103" onMouseOver="hilite(13103)" onMouseOut="lolite()" onClick="logVariable('allowedpattern')" href="../_variables/allowedpattern.html">$allowedpattern</a>, '.') === 0) {
<a name="l5915"><span class="linenum">5915</span></a>                  if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="phpfunction" onClick="logFunction('strrev')" href="../_functions/strrev.html" onMouseOver="phpfuncPopup(event,'strrev')">strrev</a>(<a class="var it3362" onMouseOver="hilite(3362)" onMouseOut="lolite()" onClick="logVariable('email')" href="../_variables/email.html">$email</a>), <a class="phpfunction" onClick="logFunction('strrev')" href="../_functions/strrev.html" onMouseOver="phpfuncPopup(event,'strrev')">strrev</a>(<a class="var it13103" onMouseOver="hilite(13103)" onMouseOut="lolite()" onClick="logVariable('allowedpattern')" href="../_variables/allowedpattern.html">$allowedpattern</a>)) === 0) {
<a name="l5916"><span class="linenum">5916</span></a>  <span class="comment">                    // Subdomains are in a form &quot;.example.com&quot; - matches &quot;xxx@anything.example.com&quot;.</span>
<a name="l5917"><span class="linenum">5917</span></a>                      return false;
<a name="l5918"><span class="linenum">5918</span></a>                  }
<a name="l5919"><span class="linenum">5919</span></a>  
<a name="l5920"><span class="linenum">5920</span></a>              } else if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="phpfunction" onClick="logFunction('strrev')" href="../_functions/strrev.html" onMouseOver="phpfuncPopup(event,'strrev')">strrev</a>(<a class="var it3362" onMouseOver="hilite(3362)" onMouseOut="lolite()" onClick="logVariable('email')" href="../_variables/email.html">$email</a>), <a class="phpfunction" onClick="logFunction('strrev')" href="../_functions/strrev.html" onMouseOver="phpfuncPopup(event,'strrev')">strrev</a>('@'.<a class="var it13103" onMouseOver="hilite(13103)" onMouseOut="lolite()" onClick="logVariable('allowedpattern')" href="../_variables/allowedpattern.html">$allowedpattern</a>)) === 0) {
<a name="l5921"><span class="linenum">5921</span></a>                  return false;
<a name="l5922"><span class="linenum">5922</span></a>              }
<a name="l5923"><span class="linenum">5923</span></a>          }
<a name="l5924"><span class="linenum">5924</span></a>          return <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailonlyallowed', '', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('allowemailaddresses')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/allowemailaddresses.html">allowemailaddresses</a>);
<a name="l5925"><span class="linenum">5925</span></a>  
<a name="l5926"><span class="linenum">5926</span></a>      } else if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('denyemailaddresses')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/denyemailaddresses.html">denyemailaddresses</a>)) {
<a name="l5927"><span class="linenum">5927</span></a>          <a class="var it13105" onMouseOver="hilite(13105)" onMouseOut="lolite()" onClick="logVariable('denied')" href="../_variables/denied.html">$denied</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(' ', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('denyemailaddresses')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/denyemailaddresses.html">denyemailaddresses</a>);
<a name="l5928"><span class="linenum">5928</span></a>          foreach (<a class="var it13105" onMouseOver="hilite(13105)" onMouseOut="lolite()" onClick="logVariable('denied')" href="../_variables/denied.html">$denied</a> as <a class="var it13106" onMouseOver="hilite(13106)" onMouseOut="lolite()" onClick="logVariable('deniedpattern')" href="../_variables/deniedpattern.html">$deniedpattern</a>) {
<a name="l5929"><span class="linenum">5929</span></a>              <a class="var it13106" onMouseOver="hilite(13106)" onMouseOut="lolite()" onClick="logVariable('deniedpattern')" href="../_variables/deniedpattern.html">$deniedpattern</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it13106" onMouseOver="hilite(13106)" onMouseOut="lolite()" onClick="logVariable('deniedpattern')" href="../_variables/deniedpattern.html">$deniedpattern</a>);
<a name="l5930"><span class="linenum">5930</span></a>              if (!<a class="var it13106" onMouseOver="hilite(13106)" onMouseOut="lolite()" onClick="logVariable('deniedpattern')" href="../_variables/deniedpattern.html">$deniedpattern</a>) {
<a name="l5931"><span class="linenum">5931</span></a>                  continue;
<a name="l5932"><span class="linenum">5932</span></a>              }
<a name="l5933"><span class="linenum">5933</span></a>              if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it13106" onMouseOver="hilite(13106)" onMouseOut="lolite()" onClick="logVariable('deniedpattern')" href="../_variables/deniedpattern.html">$deniedpattern</a>, '.') === 0) {
<a name="l5934"><span class="linenum">5934</span></a>                  if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="phpfunction" onClick="logFunction('strrev')" href="../_functions/strrev.html" onMouseOver="phpfuncPopup(event,'strrev')">strrev</a>(<a class="var it3362" onMouseOver="hilite(3362)" onMouseOut="lolite()" onClick="logVariable('email')" href="../_variables/email.html">$email</a>), <a class="phpfunction" onClick="logFunction('strrev')" href="../_functions/strrev.html" onMouseOver="phpfuncPopup(event,'strrev')">strrev</a>(<a class="var it13106" onMouseOver="hilite(13106)" onMouseOut="lolite()" onClick="logVariable('deniedpattern')" href="../_variables/deniedpattern.html">$deniedpattern</a>)) === 0) {
<a name="l5935"><span class="linenum">5935</span></a>  <span class="comment">                    // Subdomains are in a form &quot;.example.com&quot; - matches &quot;xxx@anything.example.com&quot;.</span>
<a name="l5936"><span class="linenum">5936</span></a>                      return <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailnotallowed', '', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('denyemailaddresses')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/denyemailaddresses.html">denyemailaddresses</a>);
<a name="l5937"><span class="linenum">5937</span></a>                  }
<a name="l5938"><span class="linenum">5938</span></a>  
<a name="l5939"><span class="linenum">5939</span></a>              } else if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="phpfunction" onClick="logFunction('strrev')" href="../_functions/strrev.html" onMouseOver="phpfuncPopup(event,'strrev')">strrev</a>(<a class="var it3362" onMouseOver="hilite(3362)" onMouseOut="lolite()" onClick="logVariable('email')" href="../_variables/email.html">$email</a>), <a class="phpfunction" onClick="logFunction('strrev')" href="../_functions/strrev.html" onMouseOver="phpfuncPopup(event,'strrev')">strrev</a>('@'.<a class="var it13106" onMouseOver="hilite(13106)" onMouseOut="lolite()" onClick="logVariable('deniedpattern')" href="../_variables/deniedpattern.html">$deniedpattern</a>)) === 0) {
<a name="l5940"><span class="linenum">5940</span></a>                  return <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailnotallowed', '', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('denyemailaddresses')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/denyemailaddresses.html">denyemailaddresses</a>);
<a name="l5941"><span class="linenum">5941</span></a>              }
<a name="l5942"><span class="linenum">5942</span></a>          }
<a name="l5943"><span class="linenum">5943</span></a>      }
<a name="l5944"><span class="linenum">5944</span></a>  
<a name="l5945"><span class="linenum">5945</span></a>      return false;
<a name="l5946"><span class="linenum">5946</span></a>  }
<a name="l5947"><span class="linenum">5947</span></a>  
<a name="l5948"><span class="linenum">5948</span></a>  <span class="comment">// FILE HANDLING.</span>
<a name="l5949"><span class="linenum">5949</span></a>  
<a name="l5950"><span class="linenum">5950</span></a>  <span class="comment">/**</span>
<a name="l5951"><span class="linenum">5951</span></a>  <span class="comment"> * Returns local file storage instance</span>
<a name="l5952"><span class="linenum">5952</span></a>  <span class="comment"> *</span>
<a name="l5953"><span class="linenum">5953</span></a>  <span class="comment"> * @return file_storage</span>
<a name="l5954"><span class="linenum">5954</span></a>  <span class="comment"> */</span>
<a name="l5955"><span class="linenum">5955</span></a>  function <a class="function" onClick="logFunction('get_file_storage')" href="../_functions/get_file_storage.html" onMouseOver="funcPopup(event,'get_file_storage')">get_file_storage</a>() {
<a name="l5956"><span class="linenum">5956</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l5957"><span class="linenum">5957</span></a>  
<a name="l5958"><span class="linenum">5958</span></a>      static <a class="var it586" onMouseOver="hilite(586)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../_variables/fs.html">$fs</a> = null;
<a name="l5959"><span class="linenum">5959</span></a>  
<a name="l5960"><span class="linenum">5960</span></a>      if (<a class="var it586" onMouseOver="hilite(586)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../_variables/fs.html">$fs</a>) {
<a name="l5961"><span class="linenum">5961</span></a>          return <a class="var it586" onMouseOver="hilite(586)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../_variables/fs.html">$fs</a>;
<a name="l5962"><span class="linenum">5962</span></a>      }
<a name="l5963"><span class="linenum">5963</span></a>  
<a name="l5964"><span class="linenum">5964</span></a>      require_once(&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/libdir.html">libdir</a>/filelib.php&quot;);
<a name="l5965"><span class="linenum">5965</span></a>  
<a name="l5966"><span class="linenum">5966</span></a>      if (isset(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('filedir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/filedir.html">filedir</a>)) {
<a name="l5967"><span class="linenum">5967</span></a>          <a class="var it13107" onMouseOver="hilite(13107)" onMouseOut="lolite()" onClick="logVariable('filedir')" href="../_variables/filedir.html">$filedir</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('filedir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/filedir.html">filedir</a>;
<a name="l5968"><span class="linenum">5968</span></a>      } else {
<a name="l5969"><span class="linenum">5969</span></a>          <a class="var it13107" onMouseOver="hilite(13107)" onMouseOut="lolite()" onClick="logVariable('filedir')" href="../_variables/filedir.html">$filedir</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dataroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dataroot.html">dataroot</a>.'/filedir';
<a name="l5970"><span class="linenum">5970</span></a>      }
<a name="l5971"><span class="linenum">5971</span></a>  
<a name="l5972"><span class="linenum">5972</span></a>      if (isset(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('trashdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/trashdir.html">trashdir</a>)) {
<a name="l5973"><span class="linenum">5973</span></a>          <a class="var it13109" onMouseOver="hilite(13109)" onMouseOut="lolite()" onClick="logVariable('trashdirdir')" href="../_variables/trashdirdir.html">$trashdirdir</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('trashdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/trashdir.html">trashdir</a>;
<a name="l5974"><span class="linenum">5974</span></a>      } else {
<a name="l5975"><span class="linenum">5975</span></a>          <a class="var it13109" onMouseOver="hilite(13109)" onMouseOut="lolite()" onClick="logVariable('trashdirdir')" href="../_variables/trashdirdir.html">$trashdirdir</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dataroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dataroot.html">dataroot</a>.'/trashdir';
<a name="l5976"><span class="linenum">5976</span></a>      }
<a name="l5977"><span class="linenum">5977</span></a>  
<a name="l5978"><span class="linenum">5978</span></a>      <a class="var it586" onMouseOver="hilite(586)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../_variables/fs.html">$fs</a> = <span class="keyword">new </span><a class="class" onClick="logClass('file_storage')" href="../_classes/file_storage.html" onMouseOver="classPopup(event,'file_storage')">file_storage</a>(<a class="var it13107" onMouseOver="hilite(13107)" onMouseOut="lolite()" onClick="logVariable('filedir')" href="../_variables/filedir.html">$filedir</a>, <a class="var it13109" onMouseOver="hilite(13109)" onMouseOut="lolite()" onClick="logVariable('trashdirdir')" href="../_variables/trashdirdir.html">$trashdirdir</a>, &quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('tempdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/tempdir.html">tempdir</a>/filestorage&quot;, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('directorypermissions')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/directorypermissions.html">directorypermissions</a>, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('filepermissions')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/filepermissions.html">filepermissions</a>);
<a name="l5979"><span class="linenum">5979</span></a>  
<a name="l5980"><span class="linenum">5980</span></a>      return <a class="var it586" onMouseOver="hilite(586)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../_variables/fs.html">$fs</a>;
<a name="l5981"><span class="linenum">5981</span></a>  }
<a name="l5982"><span class="linenum">5982</span></a>  
<a name="l5983"><span class="linenum">5983</span></a>  <span class="comment">/**</span>
<a name="l5984"><span class="linenum">5984</span></a>  <span class="comment"> * Returns local file storage instance</span>
<a name="l5985"><span class="linenum">5985</span></a>  <span class="comment"> *</span>
<a name="l5986"><span class="linenum">5986</span></a>  <span class="comment"> * @return file_browser</span>
<a name="l5987"><span class="linenum">5987</span></a>  <span class="comment"> */</span>
<a name="l5988"><span class="linenum">5988</span></a>  function <a class="function" onClick="logFunction('get_file_browser')" href="../_functions/get_file_browser.html" onMouseOver="funcPopup(event,'get_file_browser')">get_file_browser</a>() {
<a name="l5989"><span class="linenum">5989</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l5990"><span class="linenum">5990</span></a>  
<a name="l5991"><span class="linenum">5991</span></a>      static <a class="var it587" onMouseOver="hilite(587)" onMouseOut="lolite()" onClick="logVariable('fb')" href="../_variables/fb.html">$fb</a> = null;
<a name="l5992"><span class="linenum">5992</span></a>  
<a name="l5993"><span class="linenum">5993</span></a>      if (<a class="var it587" onMouseOver="hilite(587)" onMouseOut="lolite()" onClick="logVariable('fb')" href="../_variables/fb.html">$fb</a>) {
<a name="l5994"><span class="linenum">5994</span></a>          return <a class="var it587" onMouseOver="hilite(587)" onMouseOut="lolite()" onClick="logVariable('fb')" href="../_variables/fb.html">$fb</a>;
<a name="l5995"><span class="linenum">5995</span></a>      }
<a name="l5996"><span class="linenum">5996</span></a>  
<a name="l5997"><span class="linenum">5997</span></a>      require_once(&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/libdir.html">libdir</a>/filelib.php&quot;);
<a name="l5998"><span class="linenum">5998</span></a>  
<a name="l5999"><span class="linenum">5999</span></a>      <a class="var it587" onMouseOver="hilite(587)" onMouseOut="lolite()" onClick="logVariable('fb')" href="../_variables/fb.html">$fb</a> = <span class="keyword">new </span><a class="class" onClick="logClass('file_browser')" href="../_classes/file_browser.html" onMouseOver="classPopup(event,'file_browser')">file_browser</a>();
<a name="l6000"><span class="linenum">6000</span></a>  
<a name="l6001"><span class="linenum">6001</span></a>      return <a class="var it587" onMouseOver="hilite(587)" onMouseOut="lolite()" onClick="logVariable('fb')" href="../_variables/fb.html">$fb</a>;
<a name="l6002"><span class="linenum">6002</span></a>  }
<a name="l6003"><span class="linenum">6003</span></a>  
<a name="l6004"><span class="linenum">6004</span></a>  <span class="comment">/**</span>
<a name="l6005"><span class="linenum">6005</span></a>  <span class="comment"> * Returns file packer</span>
<a name="l6006"><span class="linenum">6006</span></a>  <span class="comment"> *</span>
<a name="l6007"><span class="linenum">6007</span></a>  <span class="comment"> * @param string $mimetype default application/zip</span>
<a name="l6008"><span class="linenum">6008</span></a>  <span class="comment"> * @return file_packer</span>
<a name="l6009"><span class="linenum">6009</span></a>  <span class="comment"> */</span>
<a name="l6010"><span class="linenum">6010</span></a>  function <a class="function" onClick="logFunction('get_file_packer')" href="../_functions/get_file_packer.html" onMouseOver="funcPopup(event,'get_file_packer')">get_file_packer</a>(<a class="var it2542" onMouseOver="hilite(2542)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../_variables/mimetype.html">$mimetype</a>='application/zip') {
<a name="l6011"><span class="linenum">6011</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l6012"><span class="linenum">6012</span></a>  
<a name="l6013"><span class="linenum">6013</span></a>      static <a class="var it773" onMouseOver="hilite(773)" onMouseOut="lolite()" onClick="logVariable('fp')" href="../_variables/fp.html">$fp</a> = array();
<a name="l6014"><span class="linenum">6014</span></a>  
<a name="l6015"><span class="linenum">6015</span></a>      if (isset(<a class="var it773" onMouseOver="hilite(773)" onMouseOut="lolite()" onClick="logVariable('fp')" href="../_variables/fp.html">$fp</a>[<a class="var it2542" onMouseOver="hilite(2542)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../_variables/mimetype.html">$mimetype</a>])) {
<a name="l6016"><span class="linenum">6016</span></a>          return <a class="var it773" onMouseOver="hilite(773)" onMouseOut="lolite()" onClick="logVariable('fp')" href="../_variables/fp.html">$fp</a>[<a class="var it2542" onMouseOver="hilite(2542)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../_variables/mimetype.html">$mimetype</a>];
<a name="l6017"><span class="linenum">6017</span></a>      }
<a name="l6018"><span class="linenum">6018</span></a>  
<a name="l6019"><span class="linenum">6019</span></a>      switch (<a class="var it2542" onMouseOver="hilite(2542)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../_variables/mimetype.html">$mimetype</a>) {
<a name="l6020"><span class="linenum">6020</span></a>          case 'application/zip':
<a name="l6021"><span class="linenum">6021</span></a>          case 'application/vnd.moodle.profiling':
<a name="l6022"><span class="linenum">6022</span></a>              <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../_variables/classname.html">$classname</a> = 'zip_packer';
<a name="l6023"><span class="linenum">6023</span></a>              break;
<a name="l6024"><span class="linenum">6024</span></a>  
<a name="l6025"><span class="linenum">6025</span></a>          case 'application/x-gzip' :
<a name="l6026"><span class="linenum">6026</span></a>              <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../_variables/classname.html">$classname</a> = 'tgz_packer';
<a name="l6027"><span class="linenum">6027</span></a>              break;
<a name="l6028"><span class="linenum">6028</span></a>  
<a name="l6029"><span class="linenum">6029</span></a>          case 'application/vnd.moodle.backup':
<a name="l6030"><span class="linenum">6030</span></a>              <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../_variables/classname.html">$classname</a> = 'mbz_packer';
<a name="l6031"><span class="linenum">6031</span></a>              break;
<a name="l6032"><span class="linenum">6032</span></a>  
<a name="l6033"><span class="linenum">6033</span></a>          default:
<a name="l6034"><span class="linenum">6034</span></a>              return false;
<a name="l6035"><span class="linenum">6035</span></a>      }
<a name="l6036"><span class="linenum">6036</span></a>  
<a name="l6037"><span class="linenum">6037</span></a>      require_once(&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/libdir.html">libdir</a>/filestorage/<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../_variables/classname.html">$classname</a>.php&quot;);
<a name="l6038"><span class="linenum">6038</span></a>      <a class="var it773" onMouseOver="hilite(773)" onMouseOut="lolite()" onClick="logVariable('fp')" href="../_variables/fp.html">$fp</a>[<a class="var it2542" onMouseOver="hilite(2542)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../_variables/mimetype.html">$mimetype</a>] = new <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../_variables/classname.html">$classname</a>();
<a name="l6039"><span class="linenum">6039</span></a>  
<a name="l6040"><span class="linenum">6040</span></a>      return <a class="var it773" onMouseOver="hilite(773)" onMouseOut="lolite()" onClick="logVariable('fp')" href="../_variables/fp.html">$fp</a>[<a class="var it2542" onMouseOver="hilite(2542)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../_variables/mimetype.html">$mimetype</a>];
<a name="l6041"><span class="linenum">6041</span></a>  }
<a name="l6042"><span class="linenum">6042</span></a>  
<a name="l6043"><span class="linenum">6043</span></a>  <span class="comment">/**</span>
<a name="l6044"><span class="linenum">6044</span></a>  <span class="comment"> * Returns current name of file on disk if it exists.</span>
<a name="l6045"><span class="linenum">6045</span></a>  <span class="comment"> *</span>
<a name="l6046"><span class="linenum">6046</span></a>  <span class="comment"> * @param string $newfile File to be verified</span>
<a name="l6047"><span class="linenum">6047</span></a>  <span class="comment"> * @return string Current name of file on disk if true</span>
<a name="l6048"><span class="linenum">6048</span></a>  <span class="comment"> */</span>
<a name="l6049"><span class="linenum">6049</span></a>  function <a class="function" onClick="logFunction('valid_uploaded_file')" href="../_functions/valid_uploaded_file.html" onMouseOver="funcPopup(event,'valid_uploaded_file')">valid_uploaded_file</a>(<a class="var it1216" onMouseOver="hilite(1216)" onMouseOut="lolite()" onClick="logVariable('newfile')" href="../_variables/newfile.html">$newfile</a>) {
<a name="l6050"><span class="linenum">6050</span></a>      if (empty(<a class="var it1216" onMouseOver="hilite(1216)" onMouseOut="lolite()" onClick="logVariable('newfile')" href="../_variables/newfile.html">$newfile</a>)) {
<a name="l6051"><span class="linenum">6051</span></a>          return '';
<a name="l6052"><span class="linenum">6052</span></a>      }
<a name="l6053"><span class="linenum">6053</span></a>      if (<a class="phpfunction" onClick="logFunction('is_uploaded_file')" href="../_functions/is_uploaded_file.html" onMouseOver="phpfuncPopup(event,'is_uploaded_file')">is_uploaded_file</a>(<a class="var it1216" onMouseOver="hilite(1216)" onMouseOut="lolite()" onClick="logVariable('newfile')" href="../_variables/newfile.html">$newfile</a>['tmp_name']) and <a class="var it1216" onMouseOver="hilite(1216)" onMouseOut="lolite()" onClick="logVariable('newfile')" href="../_variables/newfile.html">$newfile</a>['size'] &gt; 0) {
<a name="l6054"><span class="linenum">6054</span></a>          return <a class="var it1216" onMouseOver="hilite(1216)" onMouseOut="lolite()" onClick="logVariable('newfile')" href="../_variables/newfile.html">$newfile</a>['tmp_name'];
<a name="l6055"><span class="linenum">6055</span></a>      } else {
<a name="l6056"><span class="linenum">6056</span></a>          return '';
<a name="l6057"><span class="linenum">6057</span></a>      }
<a name="l6058"><span class="linenum">6058</span></a>  }
<a name="l6059"><span class="linenum">6059</span></a>  
<a name="l6060"><span class="linenum">6060</span></a>  <span class="comment">/**</span>
<a name="l6061"><span class="linenum">6061</span></a>  <span class="comment"> * Returns the maximum size for uploading files.</span>
<a name="l6062"><span class="linenum">6062</span></a>  <span class="comment"> *</span>
<a name="l6063"><span class="linenum">6063</span></a>  <span class="comment"> * There are seven possible upload limits:</span>
<a name="l6064"><span class="linenum">6064</span></a>  <span class="comment"> * 1. in Apache using LimitRequestBody (no way of checking or changing this)</span>
<a name="l6065"><span class="linenum">6065</span></a>  <span class="comment"> * 2. in php.ini for 'upload_max_filesize' (can not be changed inside PHP)</span>
<a name="l6066"><span class="linenum">6066</span></a>  <span class="comment"> * 3. in .htaccess for 'upload_max_filesize' (can not be changed inside PHP)</span>
<a name="l6067"><span class="linenum">6067</span></a>  <span class="comment"> * 4. in php.ini for 'post_max_size' (can not be changed inside PHP)</span>
<a name="l6068"><span class="linenum">6068</span></a>  <span class="comment"> * 5. by the Moodle admin in $CFG-&gt;maxbytes</span>
<a name="l6069"><span class="linenum">6069</span></a>  <span class="comment"> * 6. by the teacher in the current course $course-&gt;maxbytes</span>
<a name="l6070"><span class="linenum">6070</span></a>  <span class="comment"> * 7. by the teacher for the current module, eg $assignment-&gt;maxbytes</span>
<a name="l6071"><span class="linenum">6071</span></a>  <span class="comment"> *</span>
<a name="l6072"><span class="linenum">6072</span></a>  <span class="comment"> * These last two are passed to this function as arguments (in bytes).</span>
<a name="l6073"><span class="linenum">6073</span></a>  <span class="comment"> * Anything defined as 0 is ignored.</span>
<a name="l6074"><span class="linenum">6074</span></a>  <span class="comment"> * The smallest of all the non-zero numbers is returned.</span>
<a name="l6075"><span class="linenum">6075</span></a>  <span class="comment"> *</span>
<a name="l6076"><span class="linenum">6076</span></a>  <span class="comment"> * @todo Finish documenting this function</span>
<a name="l6077"><span class="linenum">6077</span></a>  <span class="comment"> *</span>
<a name="l6078"><span class="linenum">6078</span></a>  <span class="comment"> * @param int $sitebytes Set maximum size</span>
<a name="l6079"><span class="linenum">6079</span></a>  <span class="comment"> * @param int $coursebytes Current course $course-&gt;maxbytes (in bytes)</span>
<a name="l6080"><span class="linenum">6080</span></a>  <span class="comment"> * @param int $modulebytes Current module -&gt;maxbytes (in bytes)</span>
<a name="l6081"><span class="linenum">6081</span></a>  <span class="comment"> * @return int The maximum size for uploading files.</span>
<a name="l6082"><span class="linenum">6082</span></a>  <span class="comment"> */</span>
<a name="l6083"><span class="linenum">6083</span></a>  function <a class="function" onClick="logFunction('get_max_upload_file_size')" href="../_functions/get_max_upload_file_size.html" onMouseOver="funcPopup(event,'get_max_upload_file_size')">get_max_upload_file_size</a>(<a class="var it13110" onMouseOver="hilite(13110)" onMouseOut="lolite()" onClick="logVariable('sitebytes')" href="../_variables/sitebytes.html">$sitebytes</a>=0, <a class="var it6429" onMouseOver="hilite(6429)" onMouseOut="lolite()" onClick="logVariable('coursebytes')" href="../_variables/coursebytes.html">$coursebytes</a>=0, <a class="var it13111" onMouseOver="hilite(13111)" onMouseOut="lolite()" onClick="logVariable('modulebytes')" href="../_variables/modulebytes.html">$modulebytes</a>=0) {
<a name="l6084"><span class="linenum">6084</span></a>  
<a name="l6085"><span class="linenum">6085</span></a>      if (! <a class="var it1215" onMouseOver="hilite(1215)" onMouseOut="lolite()" onClick="logVariable('filesize')" href="../_variables/filesize.html">$filesize</a> = <a class="phpfunction" onClick="logFunction('ini_get')" href="../_functions/ini_get.html" onMouseOver="phpfuncPopup(event,'ini_get')">ini_get</a>('upload_max_filesize')) {
<a name="l6086"><span class="linenum">6086</span></a>          <a class="var it1215" onMouseOver="hilite(1215)" onMouseOut="lolite()" onClick="logVariable('filesize')" href="../_variables/filesize.html">$filesize</a> = '5M';
<a name="l6087"><span class="linenum">6087</span></a>      }
<a name="l6088"><span class="linenum">6088</span></a>      <a class="var it13112" onMouseOver="hilite(13112)" onMouseOut="lolite()" onClick="logVariable('minimumsize')" href="../_variables/minimumsize.html">$minimumsize</a> = <a class="function" onClick="logFunction('get_real_size')" href="../_functions/get_real_size.html" onMouseOver="funcPopup(event,'get_real_size')">get_real_size</a>(<a class="var it1215" onMouseOver="hilite(1215)" onMouseOut="lolite()" onClick="logVariable('filesize')" href="../_variables/filesize.html">$filesize</a>);
<a name="l6089"><span class="linenum">6089</span></a>  
<a name="l6090"><span class="linenum">6090</span></a>      if (<a class="var it13113" onMouseOver="hilite(13113)" onMouseOut="lolite()" onClick="logVariable('postsize')" href="../_variables/postsize.html">$postsize</a> = <a class="phpfunction" onClick="logFunction('ini_get')" href="../_functions/ini_get.html" onMouseOver="phpfuncPopup(event,'ini_get')">ini_get</a>('post_max_size')) {
<a name="l6091"><span class="linenum">6091</span></a>          <a class="var it13113" onMouseOver="hilite(13113)" onMouseOut="lolite()" onClick="logVariable('postsize')" href="../_variables/postsize.html">$postsize</a> = <a class="function" onClick="logFunction('get_real_size')" href="../_functions/get_real_size.html" onMouseOver="funcPopup(event,'get_real_size')">get_real_size</a>(<a class="var it13113" onMouseOver="hilite(13113)" onMouseOut="lolite()" onClick="logVariable('postsize')" href="../_variables/postsize.html">$postsize</a>);
<a name="l6092"><span class="linenum">6092</span></a>          if (<a class="var it13113" onMouseOver="hilite(13113)" onMouseOut="lolite()" onClick="logVariable('postsize')" href="../_variables/postsize.html">$postsize</a> &lt; <a class="var it13112" onMouseOver="hilite(13112)" onMouseOut="lolite()" onClick="logVariable('minimumsize')" href="../_variables/minimumsize.html">$minimumsize</a>) {
<a name="l6093"><span class="linenum">6093</span></a>              <a class="var it13112" onMouseOver="hilite(13112)" onMouseOut="lolite()" onClick="logVariable('minimumsize')" href="../_variables/minimumsize.html">$minimumsize</a> = <a class="var it13113" onMouseOver="hilite(13113)" onMouseOut="lolite()" onClick="logVariable('postsize')" href="../_variables/postsize.html">$postsize</a>;
<a name="l6094"><span class="linenum">6094</span></a>          }
<a name="l6095"><span class="linenum">6095</span></a>      }
<a name="l6096"><span class="linenum">6096</span></a>  
<a name="l6097"><span class="linenum">6097</span></a>      if ((<a class="var it13110" onMouseOver="hilite(13110)" onMouseOut="lolite()" onClick="logVariable('sitebytes')" href="../_variables/sitebytes.html">$sitebytes</a> &gt; 0) and (<a class="var it13110" onMouseOver="hilite(13110)" onMouseOut="lolite()" onClick="logVariable('sitebytes')" href="../_variables/sitebytes.html">$sitebytes</a> &lt; <a class="var it13112" onMouseOver="hilite(13112)" onMouseOut="lolite()" onClick="logVariable('minimumsize')" href="../_variables/minimumsize.html">$minimumsize</a>)) {
<a name="l6098"><span class="linenum">6098</span></a>          <a class="var it13112" onMouseOver="hilite(13112)" onMouseOut="lolite()" onClick="logVariable('minimumsize')" href="../_variables/minimumsize.html">$minimumsize</a> = <a class="var it13110" onMouseOver="hilite(13110)" onMouseOut="lolite()" onClick="logVariable('sitebytes')" href="../_variables/sitebytes.html">$sitebytes</a>;
<a name="l6099"><span class="linenum">6099</span></a>      }
<a name="l6100"><span class="linenum">6100</span></a>  
<a name="l6101"><span class="linenum">6101</span></a>      if ((<a class="var it6429" onMouseOver="hilite(6429)" onMouseOut="lolite()" onClick="logVariable('coursebytes')" href="../_variables/coursebytes.html">$coursebytes</a> &gt; 0) and (<a class="var it6429" onMouseOver="hilite(6429)" onMouseOut="lolite()" onClick="logVariable('coursebytes')" href="../_variables/coursebytes.html">$coursebytes</a> &lt; <a class="var it13112" onMouseOver="hilite(13112)" onMouseOut="lolite()" onClick="logVariable('minimumsize')" href="../_variables/minimumsize.html">$minimumsize</a>)) {
<a name="l6102"><span class="linenum">6102</span></a>          <a class="var it13112" onMouseOver="hilite(13112)" onMouseOut="lolite()" onClick="logVariable('minimumsize')" href="../_variables/minimumsize.html">$minimumsize</a> = <a class="var it6429" onMouseOver="hilite(6429)" onMouseOut="lolite()" onClick="logVariable('coursebytes')" href="../_variables/coursebytes.html">$coursebytes</a>;
<a name="l6103"><span class="linenum">6103</span></a>      }
<a name="l6104"><span class="linenum">6104</span></a>  
<a name="l6105"><span class="linenum">6105</span></a>      if ((<a class="var it13111" onMouseOver="hilite(13111)" onMouseOut="lolite()" onClick="logVariable('modulebytes')" href="../_variables/modulebytes.html">$modulebytes</a> &gt; 0) and (<a class="var it13111" onMouseOver="hilite(13111)" onMouseOut="lolite()" onClick="logVariable('modulebytes')" href="../_variables/modulebytes.html">$modulebytes</a> &lt; <a class="var it13112" onMouseOver="hilite(13112)" onMouseOut="lolite()" onClick="logVariable('minimumsize')" href="../_variables/minimumsize.html">$minimumsize</a>)) {
<a name="l6106"><span class="linenum">6106</span></a>          <a class="var it13112" onMouseOver="hilite(13112)" onMouseOut="lolite()" onClick="logVariable('minimumsize')" href="../_variables/minimumsize.html">$minimumsize</a> = <a class="var it13111" onMouseOver="hilite(13111)" onMouseOut="lolite()" onClick="logVariable('modulebytes')" href="../_variables/modulebytes.html">$modulebytes</a>;
<a name="l6107"><span class="linenum">6107</span></a>      }
<a name="l6108"><span class="linenum">6108</span></a>  
<a name="l6109"><span class="linenum">6109</span></a>      return <a class="var it13112" onMouseOver="hilite(13112)" onMouseOut="lolite()" onClick="logVariable('minimumsize')" href="../_variables/minimumsize.html">$minimumsize</a>;
<a name="l6110"><span class="linenum">6110</span></a>  }
<a name="l6111"><span class="linenum">6111</span></a>  
<a name="l6112"><span class="linenum">6112</span></a>  <span class="comment">/**</span>
<a name="l6113"><span class="linenum">6113</span></a>  <span class="comment"> * Returns the maximum size for uploading files for the current user</span>
<a name="l6114"><span class="linenum">6114</span></a>  <span class="comment"> *</span>
<a name="l6115"><span class="linenum">6115</span></a>  <span class="comment"> * This function takes in account {@link get_max_upload_file_size()} the user's capabilities</span>
<a name="l6116"><span class="linenum">6116</span></a>  <span class="comment"> *</span>
<a name="l6117"><span class="linenum">6117</span></a>  <span class="comment"> * @param context $context The context in which to check user capabilities</span>
<a name="l6118"><span class="linenum">6118</span></a>  <span class="comment"> * @param int $sitebytes Set maximum size</span>
<a name="l6119"><span class="linenum">6119</span></a>  <span class="comment"> * @param int $coursebytes Current course $course-&gt;maxbytes (in bytes)</span>
<a name="l6120"><span class="linenum">6120</span></a>  <span class="comment"> * @param int $modulebytes Current module -&gt;maxbytes (in bytes)</span>
<a name="l6121"><span class="linenum">6121</span></a>  <span class="comment"> * @param stdClass $user The user</span>
<a name="l6122"><span class="linenum">6122</span></a>  <span class="comment"> * @return int The maximum size for uploading files.</span>
<a name="l6123"><span class="linenum">6123</span></a>  <span class="comment"> */</span>
<a name="l6124"><span class="linenum">6124</span></a>  function <a class="function" onClick="logFunction('get_user_max_upload_file_size')" href="../_functions/get_user_max_upload_file_size.html" onMouseOver="funcPopup(event,'get_user_max_upload_file_size')">get_user_max_upload_file_size</a>(<a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>, <a class="var it13110" onMouseOver="hilite(13110)" onMouseOut="lolite()" onClick="logVariable('sitebytes')" href="../_variables/sitebytes.html">$sitebytes</a> = 0, <a class="var it6429" onMouseOver="hilite(6429)" onMouseOut="lolite()" onClick="logVariable('coursebytes')" href="../_variables/coursebytes.html">$coursebytes</a> = 0, <a class="var it13111" onMouseOver="hilite(13111)" onMouseOut="lolite()" onClick="logVariable('modulebytes')" href="../_variables/modulebytes.html">$modulebytes</a> = 0, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = null) {
<a name="l6125"><span class="linenum">6125</span></a>      global <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>;
<a name="l6126"><span class="linenum">6126</span></a>  
<a name="l6127"><span class="linenum">6127</span></a>      if (empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l6128"><span class="linenum">6128</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>;
<a name="l6129"><span class="linenum">6129</span></a>      }
<a name="l6130"><span class="linenum">6130</span></a>  
<a name="l6131"><span class="linenum">6131</span></a>      if (<a class="function" onClick="logFunction('has_capability')" href="../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/course:ignorefilesizelimits', <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l6132"><span class="linenum">6132</span></a>          return <a class="constant" onClick="logConstant('USER_CAN_IGNORE_FILE_SIZE_LIMITS')" href="../_constants/USER_CAN_IGNORE_FILE_SIZE_LIMITS.html" onMouseOver="constPopup(event,'USER_CAN_IGNORE_FILE_SIZE_LIMITS')">USER_CAN_IGNORE_FILE_SIZE_LIMITS</a>;
<a name="l6133"><span class="linenum">6133</span></a>      }
<a name="l6134"><span class="linenum">6134</span></a>  
<a name="l6135"><span class="linenum">6135</span></a>      return <a class="function" onClick="logFunction('get_max_upload_file_size')" href="../_functions/get_max_upload_file_size.html" onMouseOver="funcPopup(event,'get_max_upload_file_size')">get_max_upload_file_size</a>(<a class="var it13110" onMouseOver="hilite(13110)" onMouseOut="lolite()" onClick="logVariable('sitebytes')" href="../_variables/sitebytes.html">$sitebytes</a>, <a class="var it6429" onMouseOver="hilite(6429)" onMouseOut="lolite()" onClick="logVariable('coursebytes')" href="../_variables/coursebytes.html">$coursebytes</a>, <a class="var it13111" onMouseOver="hilite(13111)" onMouseOut="lolite()" onClick="logVariable('modulebytes')" href="../_variables/modulebytes.html">$modulebytes</a>);
<a name="l6136"><span class="linenum">6136</span></a>  }
<a name="l6137"><span class="linenum">6137</span></a>  
<a name="l6138"><span class="linenum">6138</span></a>  <span class="comment">/**</span>
<a name="l6139"><span class="linenum">6139</span></a>  <span class="comment"> * Returns an array of possible sizes in local language</span>
<a name="l6140"><span class="linenum">6140</span></a>  <span class="comment"> *</span>
<a name="l6141"><span class="linenum">6141</span></a>  <span class="comment"> * Related to {@link get_max_upload_file_size()} - this function returns an</span>
<a name="l6142"><span class="linenum">6142</span></a>  <span class="comment"> * array of possible sizes in an array, translated to the</span>
<a name="l6143"><span class="linenum">6143</span></a>  <span class="comment"> * local language.</span>
<a name="l6144"><span class="linenum">6144</span></a>  <span class="comment"> *</span>
<a name="l6145"><span class="linenum">6145</span></a>  <span class="comment"> * The list of options will go up to the minimum of $sitebytes, $coursebytes or $modulebytes.</span>
<a name="l6146"><span class="linenum">6146</span></a>  <span class="comment"> *</span>
<a name="l6147"><span class="linenum">6147</span></a>  <span class="comment"> * If $coursebytes or $sitebytes is not 0, an option will be included for &quot;Course/Site upload limit (X)&quot;</span>
<a name="l6148"><span class="linenum">6148</span></a>  <span class="comment"> * with the value set to 0. This option will be the first in the list.</span>
<a name="l6149"><span class="linenum">6149</span></a>  <span class="comment"> *</span>
<a name="l6150"><span class="linenum">6150</span></a>  <span class="comment"> * @uses SORT_NUMERIC</span>
<a name="l6151"><span class="linenum">6151</span></a>  <span class="comment"> * @param int $sitebytes Set maximum size</span>
<a name="l6152"><span class="linenum">6152</span></a>  <span class="comment"> * @param int $coursebytes Current course $course-&gt;maxbytes (in bytes)</span>
<a name="l6153"><span class="linenum">6153</span></a>  <span class="comment"> * @param int $modulebytes Current module -&gt;maxbytes (in bytes)</span>
<a name="l6154"><span class="linenum">6154</span></a>  <span class="comment"> * @param int|array $custombytes custom upload size/s which will be added to list,</span>
<a name="l6155"><span class="linenum">6155</span></a>  <span class="comment"> *        Only value/s smaller then maxsize will be added to list.</span>
<a name="l6156"><span class="linenum">6156</span></a>  <span class="comment"> * @return array</span>
<a name="l6157"><span class="linenum">6157</span></a>  <span class="comment"> */</span>
<a name="l6158"><span class="linenum">6158</span></a>  function <a class="function" onClick="logFunction('get_max_upload_sizes')" href="../_functions/get_max_upload_sizes.html" onMouseOver="funcPopup(event,'get_max_upload_sizes')">get_max_upload_sizes</a>(<a class="var it13110" onMouseOver="hilite(13110)" onMouseOut="lolite()" onClick="logVariable('sitebytes')" href="../_variables/sitebytes.html">$sitebytes</a> = 0, <a class="var it6429" onMouseOver="hilite(6429)" onMouseOut="lolite()" onClick="logVariable('coursebytes')" href="../_variables/coursebytes.html">$coursebytes</a> = 0, <a class="var it13111" onMouseOver="hilite(13111)" onMouseOut="lolite()" onClick="logVariable('modulebytes')" href="../_variables/modulebytes.html">$modulebytes</a> = 0, <a class="var it13114" onMouseOver="hilite(13114)" onMouseOut="lolite()" onClick="logVariable('custombytes')" href="../_variables/custombytes.html">$custombytes</a> = null) {
<a name="l6159"><span class="linenum">6159</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l6160"><span class="linenum">6160</span></a>  
<a name="l6161"><span class="linenum">6161</span></a>      if (!<a class="var it6298" onMouseOver="hilite(6298)" onMouseOut="lolite()" onClick="logVariable('maxsize')" href="../_variables/maxsize.html">$maxsize</a> = <a class="function" onClick="logFunction('get_max_upload_file_size')" href="../_functions/get_max_upload_file_size.html" onMouseOver="funcPopup(event,'get_max_upload_file_size')">get_max_upload_file_size</a>(<a class="var it13110" onMouseOver="hilite(13110)" onMouseOut="lolite()" onClick="logVariable('sitebytes')" href="../_variables/sitebytes.html">$sitebytes</a>, <a class="var it6429" onMouseOver="hilite(6429)" onMouseOut="lolite()" onClick="logVariable('coursebytes')" href="../_variables/coursebytes.html">$coursebytes</a>, <a class="var it13111" onMouseOver="hilite(13111)" onMouseOut="lolite()" onClick="logVariable('modulebytes')" href="../_variables/modulebytes.html">$modulebytes</a>)) {
<a name="l6162"><span class="linenum">6162</span></a>          return array();
<a name="l6163"><span class="linenum">6163</span></a>      }
<a name="l6164"><span class="linenum">6164</span></a>  
<a name="l6165"><span class="linenum">6165</span></a>      if (<a class="var it13110" onMouseOver="hilite(13110)" onMouseOut="lolite()" onClick="logVariable('sitebytes')" href="../_variables/sitebytes.html">$sitebytes</a> == 0) {
<a name="l6166"><span class="linenum">6166</span></a>  <span class="comment">        // Will get the minimum of upload_max_filesize or post_max_size.</span>
<a name="l6167"><span class="linenum">6167</span></a>          <a class="var it13110" onMouseOver="hilite(13110)" onMouseOut="lolite()" onClick="logVariable('sitebytes')" href="../_variables/sitebytes.html">$sitebytes</a> = <a class="function" onClick="logFunction('get_max_upload_file_size')" href="../_functions/get_max_upload_file_size.html" onMouseOver="funcPopup(event,'get_max_upload_file_size')">get_max_upload_file_size</a>();
<a name="l6168"><span class="linenum">6168</span></a>      }
<a name="l6169"><span class="linenum">6169</span></a>  
<a name="l6170"><span class="linenum">6170</span></a>      <a class="var it1215" onMouseOver="hilite(1215)" onMouseOut="lolite()" onClick="logVariable('filesize')" href="../_variables/filesize.html">$filesize</a> = array();
<a name="l6171"><span class="linenum">6171</span></a>      <a class="var it13115" onMouseOver="hilite(13115)" onMouseOut="lolite()" onClick="logVariable('sizelist')" href="../_variables/sizelist.html">$sizelist</a> = array(10240, 51200, 102400, 512000, 1048576, 2097152,
<a name="l6172"><span class="linenum">6172</span></a>                        5242880, 10485760, 20971520, 52428800, 104857600);
<a name="l6173"><span class="linenum">6173</span></a>  
<a name="l6174"><span class="linenum">6174</span></a>  <span class="comment">    // If custombytes is given and is valid then add it to the list.</span>
<a name="l6175"><span class="linenum">6175</span></a>      if (<a class="function" onClick="logFunction('is_number')" href="../_functions/is_number.html" onMouseOver="funcPopup(event,'is_number')">is_number</a>(<a class="var it13114" onMouseOver="hilite(13114)" onMouseOut="lolite()" onClick="logVariable('custombytes')" href="../_variables/custombytes.html">$custombytes</a>) and <a class="var it13114" onMouseOver="hilite(13114)" onMouseOut="lolite()" onClick="logVariable('custombytes')" href="../_variables/custombytes.html">$custombytes</a> &gt; 0) {
<a name="l6176"><span class="linenum">6176</span></a>          <a class="var it13114" onMouseOver="hilite(13114)" onMouseOut="lolite()" onClick="logVariable('custombytes')" href="../_variables/custombytes.html">$custombytes</a> = (int)<a class="var it13114" onMouseOver="hilite(13114)" onMouseOut="lolite()" onClick="logVariable('custombytes')" href="../_variables/custombytes.html">$custombytes</a>;
<a name="l6177"><span class="linenum">6177</span></a>          if (!<a class="phpfunction" onClick="logFunction('in_array')" href="../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it13114" onMouseOver="hilite(13114)" onMouseOut="lolite()" onClick="logVariable('custombytes')" href="../_variables/custombytes.html">$custombytes</a>, <a class="var it13115" onMouseOver="hilite(13115)" onMouseOut="lolite()" onClick="logVariable('sizelist')" href="../_variables/sizelist.html">$sizelist</a>)) {
<a name="l6178"><span class="linenum">6178</span></a>              <a class="var it13115" onMouseOver="hilite(13115)" onMouseOut="lolite()" onClick="logVariable('sizelist')" href="../_variables/sizelist.html">$sizelist</a>[] = <a class="var it13114" onMouseOver="hilite(13114)" onMouseOut="lolite()" onClick="logVariable('custombytes')" href="../_variables/custombytes.html">$custombytes</a>;
<a name="l6179"><span class="linenum">6179</span></a>          }
<a name="l6180"><span class="linenum">6180</span></a>      } else if (<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it13114" onMouseOver="hilite(13114)" onMouseOut="lolite()" onClick="logVariable('custombytes')" href="../_variables/custombytes.html">$custombytes</a>)) {
<a name="l6181"><span class="linenum">6181</span></a>          <a class="var it13115" onMouseOver="hilite(13115)" onMouseOut="lolite()" onClick="logVariable('sizelist')" href="../_variables/sizelist.html">$sizelist</a> = <a class="phpfunction" onClick="logFunction('array_unique')" href="../_functions/array_unique.html" onMouseOver="phpfuncPopup(event,'array_unique')">array_unique</a>(<a class="phpfunction" onClick="logFunction('array_merge')" href="../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it13115" onMouseOver="hilite(13115)" onMouseOut="lolite()" onClick="logVariable('sizelist')" href="../_variables/sizelist.html">$sizelist</a>, <a class="var it13114" onMouseOver="hilite(13114)" onMouseOut="lolite()" onClick="logVariable('custombytes')" href="../_variables/custombytes.html">$custombytes</a>));
<a name="l6182"><span class="linenum">6182</span></a>      }
<a name="l6183"><span class="linenum">6183</span></a>  
<a name="l6184"><span class="linenum">6184</span></a>  <span class="comment">    // Allow maxbytes to be selected if it falls outside the above boundaries.</span>
<a name="l6185"><span class="linenum">6185</span></a>      if (isset(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('maxbytes')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/maxbytes.html">maxbytes</a>) &amp;&amp; !<a class="phpfunction" onClick="logFunction('in_array')" href="../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="function" onClick="logFunction('get_real_size')" href="../_functions/get_real_size.html" onMouseOver="funcPopup(event,'get_real_size')">get_real_size</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('maxbytes')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/maxbytes.html">maxbytes</a>), <a class="var it13115" onMouseOver="hilite(13115)" onMouseOut="lolite()" onClick="logVariable('sizelist')" href="../_variables/sizelist.html">$sizelist</a>)) {
<a name="l6186"><span class="linenum">6186</span></a>  <span class="comment">        // Note: get_real_size() is used in order to prevent problems with invalid values.</span>
<a name="l6187"><span class="linenum">6187</span></a>          <a class="var it13115" onMouseOver="hilite(13115)" onMouseOut="lolite()" onClick="logVariable('sizelist')" href="../_variables/sizelist.html">$sizelist</a>[] = <a class="function" onClick="logFunction('get_real_size')" href="../_functions/get_real_size.html" onMouseOver="funcPopup(event,'get_real_size')">get_real_size</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('maxbytes')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/maxbytes.html">maxbytes</a>);
<a name="l6188"><span class="linenum">6188</span></a>      }
<a name="l6189"><span class="linenum">6189</span></a>  
<a name="l6190"><span class="linenum">6190</span></a>      foreach (<a class="var it13115" onMouseOver="hilite(13115)" onMouseOut="lolite()" onClick="logVariable('sizelist')" href="../_variables/sizelist.html">$sizelist</a> as <a class="var it13116" onMouseOver="hilite(13116)" onMouseOut="lolite()" onClick="logVariable('sizebytes')" href="../_variables/sizebytes.html">$sizebytes</a>) {
<a name="l6191"><span class="linenum">6191</span></a>          if (<a class="var it13116" onMouseOver="hilite(13116)" onMouseOut="lolite()" onClick="logVariable('sizebytes')" href="../_variables/sizebytes.html">$sizebytes</a> &lt; <a class="var it6298" onMouseOver="hilite(6298)" onMouseOut="lolite()" onClick="logVariable('maxsize')" href="../_variables/maxsize.html">$maxsize</a> &amp;&amp; <a class="var it13116" onMouseOver="hilite(13116)" onMouseOut="lolite()" onClick="logVariable('sizebytes')" href="../_variables/sizebytes.html">$sizebytes</a> &gt; 0) {
<a name="l6192"><span class="linenum">6192</span></a>              <a class="var it1215" onMouseOver="hilite(1215)" onMouseOut="lolite()" onClick="logVariable('filesize')" href="../_variables/filesize.html">$filesize</a>[(string)<a class="phpfunction" onClick="logFunction('intval')" href="../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>(<a class="var it13116" onMouseOver="hilite(13116)" onMouseOut="lolite()" onClick="logVariable('sizebytes')" href="../_variables/sizebytes.html">$sizebytes</a>)] = <a class="function" onClick="logFunction('display_size')" href="../_functions/display_size.html" onMouseOver="funcPopup(event,'display_size')">display_size</a>(<a class="var it13116" onMouseOver="hilite(13116)" onMouseOut="lolite()" onClick="logVariable('sizebytes')" href="../_variables/sizebytes.html">$sizebytes</a>);
<a name="l6193"><span class="linenum">6193</span></a>          }
<a name="l6194"><span class="linenum">6194</span></a>      }
<a name="l6195"><span class="linenum">6195</span></a>  
<a name="l6196"><span class="linenum">6196</span></a>      <a class="var it13117" onMouseOver="hilite(13117)" onMouseOut="lolite()" onClick="logVariable('limitlevel')" href="../_variables/limitlevel.html">$limitlevel</a> = '';
<a name="l6197"><span class="linenum">6197</span></a>      <a class="var it13118" onMouseOver="hilite(13118)" onMouseOut="lolite()" onClick="logVariable('displaysize')" href="../_variables/displaysize.html">$displaysize</a> = '';
<a name="l6198"><span class="linenum">6198</span></a>      if (<a class="var it13111" onMouseOver="hilite(13111)" onMouseOut="lolite()" onClick="logVariable('modulebytes')" href="../_variables/modulebytes.html">$modulebytes</a> &amp;&amp;
<a name="l6199"><span class="linenum">6199</span></a>          ((<a class="var it13111" onMouseOver="hilite(13111)" onMouseOut="lolite()" onClick="logVariable('modulebytes')" href="../_variables/modulebytes.html">$modulebytes</a> &lt; <a class="var it6429" onMouseOver="hilite(6429)" onMouseOut="lolite()" onClick="logVariable('coursebytes')" href="../_variables/coursebytes.html">$coursebytes</a> || <a class="var it6429" onMouseOver="hilite(6429)" onMouseOut="lolite()" onClick="logVariable('coursebytes')" href="../_variables/coursebytes.html">$coursebytes</a> == 0) &amp;&amp;
<a name="l6200"><span class="linenum">6200</span></a>           (<a class="var it13111" onMouseOver="hilite(13111)" onMouseOut="lolite()" onClick="logVariable('modulebytes')" href="../_variables/modulebytes.html">$modulebytes</a> &lt; <a class="var it13110" onMouseOver="hilite(13110)" onMouseOut="lolite()" onClick="logVariable('sitebytes')" href="../_variables/sitebytes.html">$sitebytes</a> || <a class="var it13110" onMouseOver="hilite(13110)" onMouseOut="lolite()" onClick="logVariable('sitebytes')" href="../_variables/sitebytes.html">$sitebytes</a> == 0))) {
<a name="l6201"><span class="linenum">6201</span></a>          <a class="var it13117" onMouseOver="hilite(13117)" onMouseOut="lolite()" onClick="logVariable('limitlevel')" href="../_variables/limitlevel.html">$limitlevel</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('activity', 'core');
<a name="l6202"><span class="linenum">6202</span></a>          <a class="var it13118" onMouseOver="hilite(13118)" onMouseOut="lolite()" onClick="logVariable('displaysize')" href="../_variables/displaysize.html">$displaysize</a> = <a class="function" onClick="logFunction('display_size')" href="../_functions/display_size.html" onMouseOver="funcPopup(event,'display_size')">display_size</a>(<a class="var it13111" onMouseOver="hilite(13111)" onMouseOut="lolite()" onClick="logVariable('modulebytes')" href="../_variables/modulebytes.html">$modulebytes</a>);
<a name="l6203"><span class="linenum">6203</span></a>          <a class="var it1215" onMouseOver="hilite(1215)" onMouseOut="lolite()" onClick="logVariable('filesize')" href="../_variables/filesize.html">$filesize</a>[<a class="var it13111" onMouseOver="hilite(13111)" onMouseOut="lolite()" onClick="logVariable('modulebytes')" href="../_variables/modulebytes.html">$modulebytes</a>] = <a class="var it13118" onMouseOver="hilite(13118)" onMouseOut="lolite()" onClick="logVariable('displaysize')" href="../_variables/displaysize.html">$displaysize</a>; <span class="comment">// Make sure the limit is also included in the list.</span>
<a name="l6204"><span class="linenum">6204</span></a>  
<a name="l6205"><span class="linenum">6205</span></a>      } else if (<a class="var it6429" onMouseOver="hilite(6429)" onMouseOut="lolite()" onClick="logVariable('coursebytes')" href="../_variables/coursebytes.html">$coursebytes</a> &amp;&amp; (<a class="var it6429" onMouseOver="hilite(6429)" onMouseOut="lolite()" onClick="logVariable('coursebytes')" href="../_variables/coursebytes.html">$coursebytes</a> &lt; <a class="var it13110" onMouseOver="hilite(13110)" onMouseOut="lolite()" onClick="logVariable('sitebytes')" href="../_variables/sitebytes.html">$sitebytes</a> || <a class="var it13110" onMouseOver="hilite(13110)" onMouseOut="lolite()" onClick="logVariable('sitebytes')" href="../_variables/sitebytes.html">$sitebytes</a> == 0)) {
<a name="l6206"><span class="linenum">6206</span></a>          <a class="var it13117" onMouseOver="hilite(13117)" onMouseOut="lolite()" onClick="logVariable('limitlevel')" href="../_variables/limitlevel.html">$limitlevel</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('course', 'core');
<a name="l6207"><span class="linenum">6207</span></a>          <a class="var it13118" onMouseOver="hilite(13118)" onMouseOut="lolite()" onClick="logVariable('displaysize')" href="../_variables/displaysize.html">$displaysize</a> = <a class="function" onClick="logFunction('display_size')" href="../_functions/display_size.html" onMouseOver="funcPopup(event,'display_size')">display_size</a>(<a class="var it6429" onMouseOver="hilite(6429)" onMouseOut="lolite()" onClick="logVariable('coursebytes')" href="../_variables/coursebytes.html">$coursebytes</a>);
<a name="l6208"><span class="linenum">6208</span></a>          <a class="var it1215" onMouseOver="hilite(1215)" onMouseOut="lolite()" onClick="logVariable('filesize')" href="../_variables/filesize.html">$filesize</a>[<a class="var it6429" onMouseOver="hilite(6429)" onMouseOut="lolite()" onClick="logVariable('coursebytes')" href="../_variables/coursebytes.html">$coursebytes</a>] = <a class="var it13118" onMouseOver="hilite(13118)" onMouseOut="lolite()" onClick="logVariable('displaysize')" href="../_variables/displaysize.html">$displaysize</a>; <span class="comment">// Make sure the limit is also included in the list.</span>
<a name="l6209"><span class="linenum">6209</span></a>  
<a name="l6210"><span class="linenum">6210</span></a>      } else if (<a class="var it13110" onMouseOver="hilite(13110)" onMouseOut="lolite()" onClick="logVariable('sitebytes')" href="../_variables/sitebytes.html">$sitebytes</a>) {
<a name="l6211"><span class="linenum">6211</span></a>          <a class="var it13117" onMouseOver="hilite(13117)" onMouseOut="lolite()" onClick="logVariable('limitlevel')" href="../_variables/limitlevel.html">$limitlevel</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('site', 'core');
<a name="l6212"><span class="linenum">6212</span></a>          <a class="var it13118" onMouseOver="hilite(13118)" onMouseOut="lolite()" onClick="logVariable('displaysize')" href="../_variables/displaysize.html">$displaysize</a> = <a class="function" onClick="logFunction('display_size')" href="../_functions/display_size.html" onMouseOver="funcPopup(event,'display_size')">display_size</a>(<a class="var it13110" onMouseOver="hilite(13110)" onMouseOut="lolite()" onClick="logVariable('sitebytes')" href="../_variables/sitebytes.html">$sitebytes</a>);
<a name="l6213"><span class="linenum">6213</span></a>          <a class="var it1215" onMouseOver="hilite(1215)" onMouseOut="lolite()" onClick="logVariable('filesize')" href="../_variables/filesize.html">$filesize</a>[<a class="var it13110" onMouseOver="hilite(13110)" onMouseOut="lolite()" onClick="logVariable('sitebytes')" href="../_variables/sitebytes.html">$sitebytes</a>] = <a class="var it13118" onMouseOver="hilite(13118)" onMouseOut="lolite()" onClick="logVariable('displaysize')" href="../_variables/displaysize.html">$displaysize</a>; <span class="comment">// Make sure the limit is also included in the list.</span>
<a name="l6214"><span class="linenum">6214</span></a>      }
<a name="l6215"><span class="linenum">6215</span></a>  
<a name="l6216"><span class="linenum">6216</span></a>      <a class="phpfunction" onClick="logFunction('krsort')" href="../_functions/krsort.html" onMouseOver="phpfuncPopup(event,'krsort')">krsort</a>(<a class="var it1215" onMouseOver="hilite(1215)" onMouseOut="lolite()" onClick="logVariable('filesize')" href="../_variables/filesize.html">$filesize</a>, SORT_NUMERIC);
<a name="l6217"><span class="linenum">6217</span></a>      if (<a class="var it13117" onMouseOver="hilite(13117)" onMouseOut="lolite()" onClick="logVariable('limitlevel')" href="../_variables/limitlevel.html">$limitlevel</a>) {
<a name="l6218"><span class="linenum">6218</span></a>          <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = (object) array('contextname' =&gt; <a class="var it13117" onMouseOver="hilite(13117)" onMouseOut="lolite()" onClick="logVariable('limitlevel')" href="../_variables/limitlevel.html">$limitlevel</a>, 'displaysize' =&gt; <a class="var it13118" onMouseOver="hilite(13118)" onMouseOut="lolite()" onClick="logVariable('displaysize')" href="../_variables/displaysize.html">$displaysize</a>);
<a name="l6219"><span class="linenum">6219</span></a>          <a class="var it1215" onMouseOver="hilite(1215)" onMouseOut="lolite()" onClick="logVariable('filesize')" href="../_variables/filesize.html">$filesize</a>  = array('0' =&gt; <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('uploadlimitwithsize', 'core', <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>)) + <a class="var it1215" onMouseOver="hilite(1215)" onMouseOut="lolite()" onClick="logVariable('filesize')" href="../_variables/filesize.html">$filesize</a>;
<a name="l6220"><span class="linenum">6220</span></a>      }
<a name="l6221"><span class="linenum">6221</span></a>  
<a name="l6222"><span class="linenum">6222</span></a>      return <a class="var it1215" onMouseOver="hilite(1215)" onMouseOut="lolite()" onClick="logVariable('filesize')" href="../_variables/filesize.html">$filesize</a>;
<a name="l6223"><span class="linenum">6223</span></a>  }
<a name="l6224"><span class="linenum">6224</span></a>  
<a name="l6225"><span class="linenum">6225</span></a>  <span class="comment">/**</span>
<a name="l6226"><span class="linenum">6226</span></a>  <span class="comment"> * Returns an array with all the filenames in all subdirectories, relative to the given rootdir.</span>
<a name="l6227"><span class="linenum">6227</span></a>  <span class="comment"> *</span>
<a name="l6228"><span class="linenum">6228</span></a>  <span class="comment"> * If excludefiles is defined, then that file/directory is ignored</span>
<a name="l6229"><span class="linenum">6229</span></a>  <span class="comment"> * If getdirs is true, then (sub)directories are included in the output</span>
<a name="l6230"><span class="linenum">6230</span></a>  <span class="comment"> * If getfiles is true, then files are included in the output</span>
<a name="l6231"><span class="linenum">6231</span></a>  <span class="comment"> * (at least one of these must be true!)</span>
<a name="l6232"><span class="linenum">6232</span></a>  <span class="comment"> *</span>
<a name="l6233"><span class="linenum">6233</span></a>  <span class="comment"> * @todo Finish documenting this function. Add examples of $excludefile usage.</span>
<a name="l6234"><span class="linenum">6234</span></a>  <span class="comment"> *</span>
<a name="l6235"><span class="linenum">6235</span></a>  <span class="comment"> * @param string $rootdir A given root directory to start from</span>
<a name="l6236"><span class="linenum">6236</span></a>  <span class="comment"> * @param string|array $excludefiles If defined then the specified file/directory is ignored</span>
<a name="l6237"><span class="linenum">6237</span></a>  <span class="comment"> * @param bool $descend If true then subdirectories are recursed as well</span>
<a name="l6238"><span class="linenum">6238</span></a>  <span class="comment"> * @param bool $getdirs If true then (sub)directories are included in the output</span>
<a name="l6239"><span class="linenum">6239</span></a>  <span class="comment"> * @param bool $getfiles  If true then files are included in the output</span>
<a name="l6240"><span class="linenum">6240</span></a>  <span class="comment"> * @return array An array with all the filenames in all subdirectories, relative to the given rootdir</span>
<a name="l6241"><span class="linenum">6241</span></a>  <span class="comment"> */</span>
<a name="l6242"><span class="linenum">6242</span></a>  function <a class="function" onClick="logFunction('get_directory_list')" href="../_functions/get_directory_list.html" onMouseOver="funcPopup(event,'get_directory_list')">get_directory_list</a>(<a class="var it5907" onMouseOver="hilite(5907)" onMouseOut="lolite()" onClick="logVariable('rootdir')" href="../_variables/rootdir.html">$rootdir</a>, <a class="var it13119" onMouseOver="hilite(13119)" onMouseOut="lolite()" onClick="logVariable('excludefiles')" href="../_variables/excludefiles.html">$excludefiles</a>='', <a class="var it13120" onMouseOver="hilite(13120)" onMouseOut="lolite()" onClick="logVariable('descend')" href="../_variables/descend.html">$descend</a>=true, <a class="var it13121" onMouseOver="hilite(13121)" onMouseOut="lolite()" onClick="logVariable('getdirs')" href="../_variables/getdirs.html">$getdirs</a>=false, <a class="var it13122" onMouseOver="hilite(13122)" onMouseOut="lolite()" onClick="logVariable('getfiles')" href="../_variables/getfiles.html">$getfiles</a>=true) {
<a name="l6243"><span class="linenum">6243</span></a>  
<a name="l6244"><span class="linenum">6244</span></a>      <a class="var it3472" onMouseOver="hilite(3472)" onMouseOut="lolite()" onClick="logVariable('dirs')" href="../_variables/dirs.html">$dirs</a> = array();
<a name="l6245"><span class="linenum">6245</span></a>  
<a name="l6246"><span class="linenum">6246</span></a>      if (!<a class="var it13121" onMouseOver="hilite(13121)" onMouseOut="lolite()" onClick="logVariable('getdirs')" href="../_variables/getdirs.html">$getdirs</a> and !<a class="var it13122" onMouseOver="hilite(13122)" onMouseOut="lolite()" onClick="logVariable('getfiles')" href="../_variables/getfiles.html">$getfiles</a>) {   // Nothing to show.
<a name="l6247"><span class="linenum">6247</span></a>          return <a class="var it3472" onMouseOver="hilite(3472)" onMouseOut="lolite()" onClick="logVariable('dirs')" href="../_variables/dirs.html">$dirs</a>;
<a name="l6248"><span class="linenum">6248</span></a>      }
<a name="l6249"><span class="linenum">6249</span></a>  
<a name="l6250"><span class="linenum">6250</span></a>      if (!<a class="phpfunction" onClick="logFunction('is_dir')" href="../_functions/is_dir.html" onMouseOver="phpfuncPopup(event,'is_dir')">is_dir</a>(<a class="var it5907" onMouseOver="hilite(5907)" onMouseOut="lolite()" onClick="logVariable('rootdir')" href="../_variables/rootdir.html">$rootdir</a>)) {          // Must be a directory.
<a name="l6251"><span class="linenum">6251</span></a>          return <a class="var it3472" onMouseOver="hilite(3472)" onMouseOut="lolite()" onClick="logVariable('dirs')" href="../_variables/dirs.html">$dirs</a>;
<a name="l6252"><span class="linenum">6252</span></a>      }
<a name="l6253"><span class="linenum">6253</span></a>  
<a name="l6254"><span class="linenum">6254</span></a>      if (!<a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a> = <a class="phpfunction" onClick="logFunction('opendir')" href="../_functions/opendir.html" onMouseOver="phpfuncPopup(event,'opendir')">opendir</a>(<a class="var it5907" onMouseOver="hilite(5907)" onMouseOut="lolite()" onClick="logVariable('rootdir')" href="../_variables/rootdir.html">$rootdir</a>)) {  // Can't open it for some reason.
<a name="l6255"><span class="linenum">6255</span></a>          return <a class="var it3472" onMouseOver="hilite(3472)" onMouseOut="lolite()" onClick="logVariable('dirs')" href="../_variables/dirs.html">$dirs</a>;
<a name="l6256"><span class="linenum">6256</span></a>      }
<a name="l6257"><span class="linenum">6257</span></a>  
<a name="l6258"><span class="linenum">6258</span></a>      if (!<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it13119" onMouseOver="hilite(13119)" onMouseOut="lolite()" onClick="logVariable('excludefiles')" href="../_variables/excludefiles.html">$excludefiles</a>)) {
<a name="l6259"><span class="linenum">6259</span></a>          <a class="var it13119" onMouseOver="hilite(13119)" onMouseOut="lolite()" onClick="logVariable('excludefiles')" href="../_variables/excludefiles.html">$excludefiles</a> = array(<a class="var it13119" onMouseOver="hilite(13119)" onMouseOut="lolite()" onClick="logVariable('excludefiles')" href="../_variables/excludefiles.html">$excludefiles</a>);
<a name="l6260"><span class="linenum">6260</span></a>      }
<a name="l6261"><span class="linenum">6261</span></a>  
<a name="l6262"><span class="linenum">6262</span></a>      while (false !== (<a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a> = readdir(<a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a>))) {
<a name="l6263"><span class="linenum">6263</span></a>          <a class="var it13123" onMouseOver="hilite(13123)" onMouseOut="lolite()" onClick="logVariable('firstchar')" href="../_variables/firstchar.html">$firstchar</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a>, 0, 1);
<a name="l6264"><span class="linenum">6264</span></a>          if (<a class="var it13123" onMouseOver="hilite(13123)" onMouseOut="lolite()" onClick="logVariable('firstchar')" href="../_variables/firstchar.html">$firstchar</a> == '.' or <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a> == 'CVS' or <a class="phpfunction" onClick="logFunction('in_array')" href="../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a>, <a class="var it13119" onMouseOver="hilite(13119)" onMouseOut="lolite()" onClick="logVariable('excludefiles')" href="../_variables/excludefiles.html">$excludefiles</a>)) {
<a name="l6265"><span class="linenum">6265</span></a>              continue;
<a name="l6266"><span class="linenum">6266</span></a>          }
<a name="l6267"><span class="linenum">6267</span></a>          <a class="var it13124" onMouseOver="hilite(13124)" onMouseOut="lolite()" onClick="logVariable('fullfile')" href="../_variables/fullfile.html">$fullfile</a> = <a class="var it5907" onMouseOver="hilite(5907)" onMouseOut="lolite()" onClick="logVariable('rootdir')" href="../_variables/rootdir.html">$rootdir</a> .'/'. <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a>;
<a name="l6268"><span class="linenum">6268</span></a>          if (<a class="phpfunction" onClick="logFunction('filetype')" href="../_functions/filetype.html" onMouseOver="phpfuncPopup(event,'filetype')">filetype</a>(<a class="var it13124" onMouseOver="hilite(13124)" onMouseOut="lolite()" onClick="logVariable('fullfile')" href="../_variables/fullfile.html">$fullfile</a>) == 'dir') {
<a name="l6269"><span class="linenum">6269</span></a>              if (<a class="var it13121" onMouseOver="hilite(13121)" onMouseOut="lolite()" onClick="logVariable('getdirs')" href="../_variables/getdirs.html">$getdirs</a>) {
<a name="l6270"><span class="linenum">6270</span></a>                  <a class="var it3472" onMouseOver="hilite(3472)" onMouseOut="lolite()" onClick="logVariable('dirs')" href="../_variables/dirs.html">$dirs</a>[] = <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a>;
<a name="l6271"><span class="linenum">6271</span></a>              }
<a name="l6272"><span class="linenum">6272</span></a>              if (<a class="var it13120" onMouseOver="hilite(13120)" onMouseOut="lolite()" onClick="logVariable('descend')" href="../_variables/descend.html">$descend</a>) {
<a name="l6273"><span class="linenum">6273</span></a>                  <a class="var it3483" onMouseOver="hilite(3483)" onMouseOut="lolite()" onClick="logVariable('subdirs')" href="../_variables/subdirs.html">$subdirs</a> = <a class="function" onClick="logFunction('get_directory_list')" href="../_functions/get_directory_list.html" onMouseOver="funcPopup(event,'get_directory_list')">get_directory_list</a>(<a class="var it13124" onMouseOver="hilite(13124)" onMouseOut="lolite()" onClick="logVariable('fullfile')" href="../_variables/fullfile.html">$fullfile</a>, <a class="var it13119" onMouseOver="hilite(13119)" onMouseOut="lolite()" onClick="logVariable('excludefiles')" href="../_variables/excludefiles.html">$excludefiles</a>, <a class="var it13120" onMouseOver="hilite(13120)" onMouseOut="lolite()" onClick="logVariable('descend')" href="../_variables/descend.html">$descend</a>, <a class="var it13121" onMouseOver="hilite(13121)" onMouseOut="lolite()" onClick="logVariable('getdirs')" href="../_variables/getdirs.html">$getdirs</a>, <a class="var it13122" onMouseOver="hilite(13122)" onMouseOut="lolite()" onClick="logVariable('getfiles')" href="../_variables/getfiles.html">$getfiles</a>);
<a name="l6274"><span class="linenum">6274</span></a>                  foreach (<a class="var it3483" onMouseOver="hilite(3483)" onMouseOut="lolite()" onClick="logVariable('subdirs')" href="../_variables/subdirs.html">$subdirs</a> as <a class="var it1199" onMouseOver="hilite(1199)" onMouseOut="lolite()" onClick="logVariable('subdir')" href="../_variables/subdir.html">$subdir</a>) {
<a name="l6275"><span class="linenum">6275</span></a>                      <a class="var it3472" onMouseOver="hilite(3472)" onMouseOut="lolite()" onClick="logVariable('dirs')" href="../_variables/dirs.html">$dirs</a>[] = <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a> .'/'. <a class="var it1199" onMouseOver="hilite(1199)" onMouseOut="lolite()" onClick="logVariable('subdir')" href="../_variables/subdir.html">$subdir</a>;
<a name="l6276"><span class="linenum">6276</span></a>                  }
<a name="l6277"><span class="linenum">6277</span></a>              }
<a name="l6278"><span class="linenum">6278</span></a>          } else if (<a class="var it13122" onMouseOver="hilite(13122)" onMouseOut="lolite()" onClick="logVariable('getfiles')" href="../_variables/getfiles.html">$getfiles</a>) {
<a name="l6279"><span class="linenum">6279</span></a>              <a class="var it3472" onMouseOver="hilite(3472)" onMouseOut="lolite()" onClick="logVariable('dirs')" href="../_variables/dirs.html">$dirs</a>[] = <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a>;
<a name="l6280"><span class="linenum">6280</span></a>          }
<a name="l6281"><span class="linenum">6281</span></a>      }
<a name="l6282"><span class="linenum">6282</span></a>      <a class="phpfunction" onClick="logFunction('closedir')" href="../_functions/closedir.html" onMouseOver="phpfuncPopup(event,'closedir')">closedir</a>(<a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a>);
<a name="l6283"><span class="linenum">6283</span></a>  
<a name="l6284"><span class="linenum">6284</span></a>      <a class="phpfunction" onClick="logFunction('asort')" href="../_functions/asort.html" onMouseOver="phpfuncPopup(event,'asort')">asort</a>(<a class="var it3472" onMouseOver="hilite(3472)" onMouseOut="lolite()" onClick="logVariable('dirs')" href="../_variables/dirs.html">$dirs</a>);
<a name="l6285"><span class="linenum">6285</span></a>  
<a name="l6286"><span class="linenum">6286</span></a>      return <a class="var it3472" onMouseOver="hilite(3472)" onMouseOut="lolite()" onClick="logVariable('dirs')" href="../_variables/dirs.html">$dirs</a>;
<a name="l6287"><span class="linenum">6287</span></a>  }
<a name="l6288"><span class="linenum">6288</span></a>  
<a name="l6289"><span class="linenum">6289</span></a>  
<a name="l6290"><span class="linenum">6290</span></a>  <span class="comment">/**</span>
<a name="l6291"><span class="linenum">6291</span></a>  <span class="comment"> * Adds up all the files in a directory and works out the size.</span>
<a name="l6292"><span class="linenum">6292</span></a>  <span class="comment"> *</span>
<a name="l6293"><span class="linenum">6293</span></a>  <span class="comment"> * @param string $rootdir  The directory to start from</span>
<a name="l6294"><span class="linenum">6294</span></a>  <span class="comment"> * @param string $excludefile A file to exclude when summing directory size</span>
<a name="l6295"><span class="linenum">6295</span></a>  <span class="comment"> * @return int The summed size of all files and subfiles within the root directory</span>
<a name="l6296"><span class="linenum">6296</span></a>  <span class="comment"> */</span>
<a name="l6297"><span class="linenum">6297</span></a>  function <a class="function" onClick="logFunction('get_directory_size')" href="../_functions/get_directory_size.html" onMouseOver="funcPopup(event,'get_directory_size')">get_directory_size</a>(<a class="var it5907" onMouseOver="hilite(5907)" onMouseOut="lolite()" onClick="logVariable('rootdir')" href="../_variables/rootdir.html">$rootdir</a>, <a class="var it13125" onMouseOver="hilite(13125)" onMouseOut="lolite()" onClick="logVariable('excludefile')" href="../_variables/excludefile.html">$excludefile</a>='') {
<a name="l6298"><span class="linenum">6298</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l6299"><span class="linenum">6299</span></a>  
<a name="l6300"><span class="linenum">6300</span></a>  <span class="comment">    // Do it this way if we can, it's much faster.</span>
<a name="l6301"><span class="linenum">6301</span></a>      if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('pathtodu')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/pathtodu.html">pathtodu</a>) &amp;&amp; <a class="phpfunction" onClick="logFunction('is_executable')" href="../_functions/is_executable.html" onMouseOver="phpfuncPopup(event,'is_executable')">is_executable</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('pathtodu')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/pathtodu.html">pathtodu</a>))) {
<a name="l6302"><span class="linenum">6302</span></a>          <a class="var it2835" onMouseOver="hilite(2835)" onMouseOut="lolite()" onClick="logVariable('command')" href="../_variables/command.html">$command</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('pathtodu')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/pathtodu.html">pathtodu</a>).' -sk '.<a class="phpfunction" onClick="logFunction('escapeshellarg')" href="../_functions/escapeshellarg.html" onMouseOver="phpfuncPopup(event,'escapeshellarg')">escapeshellarg</a>(<a class="var it5907" onMouseOver="hilite(5907)" onMouseOut="lolite()" onClick="logVariable('rootdir')" href="../_variables/rootdir.html">$rootdir</a>);
<a name="l6303"><span class="linenum">6303</span></a>          <a class="var it71" onMouseOver="hilite(71)" onMouseOut="lolite()" onClick="logVariable('output')" href="../_variables/output.html">$output</a> = null;
<a name="l6304"><span class="linenum">6304</span></a>          <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a> = null;
<a name="l6305"><span class="linenum">6305</span></a>          <a class="phpfunction" onClick="logFunction('exec')" href="../_functions/exec.html" onMouseOver="phpfuncPopup(event,'exec')">exec</a>(<a class="var it2835" onMouseOver="hilite(2835)" onMouseOut="lolite()" onClick="logVariable('command')" href="../_variables/command.html">$command</a>, <a class="var it71" onMouseOver="hilite(71)" onMouseOut="lolite()" onClick="logVariable('output')" href="../_variables/output.html">$output</a>, <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a>);
<a name="l6306"><span class="linenum">6306</span></a>          if (<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it71" onMouseOver="hilite(71)" onMouseOut="lolite()" onClick="logVariable('output')" href="../_variables/output.html">$output</a>)) {
<a name="l6307"><span class="linenum">6307</span></a>  <span class="comment">            // We told it to return k.</span>
<a name="l6308"><span class="linenum">6308</span></a>              return <a class="function" onClick="logFunction('get_real_size')" href="../_functions/get_real_size.html" onMouseOver="funcPopup(event,'get_real_size')">get_real_size</a>(<a class="phpfunction" onClick="logFunction('intval')" href="../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>(<a class="var it71" onMouseOver="hilite(71)" onMouseOut="lolite()" onClick="logVariable('output')" href="../_variables/output.html">$output</a>[0]).'k');
<a name="l6309"><span class="linenum">6309</span></a>          }
<a name="l6310"><span class="linenum">6310</span></a>      }
<a name="l6311"><span class="linenum">6311</span></a>  
<a name="l6312"><span class="linenum">6312</span></a>      if (!<a class="phpfunction" onClick="logFunction('is_dir')" href="../_functions/is_dir.html" onMouseOver="phpfuncPopup(event,'is_dir')">is_dir</a>(<a class="var it5907" onMouseOver="hilite(5907)" onMouseOut="lolite()" onClick="logVariable('rootdir')" href="../_variables/rootdir.html">$rootdir</a>)) {
<a name="l6313"><span class="linenum">6313</span></a>  <span class="comment">        // Must be a directory.</span>
<a name="l6314"><span class="linenum">6314</span></a>          return 0;
<a name="l6315"><span class="linenum">6315</span></a>      }
<a name="l6316"><span class="linenum">6316</span></a>  
<a name="l6317"><span class="linenum">6317</span></a>      if (!<a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a> = @<a class="phpfunction" onClick="logFunction('opendir')" href="../_functions/opendir.html" onMouseOver="phpfuncPopup(event,'opendir')">opendir</a>(<a class="var it5907" onMouseOver="hilite(5907)" onMouseOut="lolite()" onClick="logVariable('rootdir')" href="../_variables/rootdir.html">$rootdir</a>)) {
<a name="l6318"><span class="linenum">6318</span></a>  <span class="comment">        // Can't open it for some reason.</span>
<a name="l6319"><span class="linenum">6319</span></a>          return 0;
<a name="l6320"><span class="linenum">6320</span></a>      }
<a name="l6321"><span class="linenum">6321</span></a>  
<a name="l6322"><span class="linenum">6322</span></a>      <a class="var it1225" onMouseOver="hilite(1225)" onMouseOut="lolite()" onClick="logVariable('size')" href="../_variables/size.html">$size</a> = 0;
<a name="l6323"><span class="linenum">6323</span></a>  
<a name="l6324"><span class="linenum">6324</span></a>      while (false !== (<a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a> = readdir(<a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a>))) {
<a name="l6325"><span class="linenum">6325</span></a>          <a class="var it13123" onMouseOver="hilite(13123)" onMouseOut="lolite()" onClick="logVariable('firstchar')" href="../_variables/firstchar.html">$firstchar</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a>, 0, 1);
<a name="l6326"><span class="linenum">6326</span></a>          if (<a class="var it13123" onMouseOver="hilite(13123)" onMouseOut="lolite()" onClick="logVariable('firstchar')" href="../_variables/firstchar.html">$firstchar</a> == '.' or <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a> == 'CVS' or <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a> == <a class="var it13125" onMouseOver="hilite(13125)" onMouseOut="lolite()" onClick="logVariable('excludefile')" href="../_variables/excludefile.html">$excludefile</a>) {
<a name="l6327"><span class="linenum">6327</span></a>              continue;
<a name="l6328"><span class="linenum">6328</span></a>          }
<a name="l6329"><span class="linenum">6329</span></a>          <a class="var it13124" onMouseOver="hilite(13124)" onMouseOut="lolite()" onClick="logVariable('fullfile')" href="../_variables/fullfile.html">$fullfile</a> = <a class="var it5907" onMouseOver="hilite(5907)" onMouseOut="lolite()" onClick="logVariable('rootdir')" href="../_variables/rootdir.html">$rootdir</a> .'/'. <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a>;
<a name="l6330"><span class="linenum">6330</span></a>          if (<a class="phpfunction" onClick="logFunction('filetype')" href="../_functions/filetype.html" onMouseOver="phpfuncPopup(event,'filetype')">filetype</a>(<a class="var it13124" onMouseOver="hilite(13124)" onMouseOut="lolite()" onClick="logVariable('fullfile')" href="../_variables/fullfile.html">$fullfile</a>) == 'dir') {
<a name="l6331"><span class="linenum">6331</span></a>              <a class="var it1225" onMouseOver="hilite(1225)" onMouseOut="lolite()" onClick="logVariable('size')" href="../_variables/size.html">$size</a> += <a class="function" onClick="logFunction('get_directory_size')" href="../_functions/get_directory_size.html" onMouseOver="funcPopup(event,'get_directory_size')">get_directory_size</a>(<a class="var it13124" onMouseOver="hilite(13124)" onMouseOut="lolite()" onClick="logVariable('fullfile')" href="../_variables/fullfile.html">$fullfile</a>, <a class="var it13125" onMouseOver="hilite(13125)" onMouseOut="lolite()" onClick="logVariable('excludefile')" href="../_variables/excludefile.html">$excludefile</a>);
<a name="l6332"><span class="linenum">6332</span></a>          } else {
<a name="l6333"><span class="linenum">6333</span></a>              <a class="var it1225" onMouseOver="hilite(1225)" onMouseOut="lolite()" onClick="logVariable('size')" href="../_variables/size.html">$size</a> += <a class="phpfunction" onClick="logFunction('filesize')" href="../_functions/filesize.html" onMouseOver="phpfuncPopup(event,'filesize')">filesize</a>(<a class="var it13124" onMouseOver="hilite(13124)" onMouseOut="lolite()" onClick="logVariable('fullfile')" href="../_variables/fullfile.html">$fullfile</a>);
<a name="l6334"><span class="linenum">6334</span></a>          }
<a name="l6335"><span class="linenum">6335</span></a>      }
<a name="l6336"><span class="linenum">6336</span></a>      <a class="phpfunction" onClick="logFunction('closedir')" href="../_functions/closedir.html" onMouseOver="phpfuncPopup(event,'closedir')">closedir</a>(<a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a>);
<a name="l6337"><span class="linenum">6337</span></a>  
<a name="l6338"><span class="linenum">6338</span></a>      return <a class="var it1225" onMouseOver="hilite(1225)" onMouseOut="lolite()" onClick="logVariable('size')" href="../_variables/size.html">$size</a>;
<a name="l6339"><span class="linenum">6339</span></a>  }
<a name="l6340"><span class="linenum">6340</span></a>  
<a name="l6341"><span class="linenum">6341</span></a>  <span class="comment">/**</span>
<a name="l6342"><span class="linenum">6342</span></a>  <span class="comment"> * Converts bytes into display form</span>
<a name="l6343"><span class="linenum">6343</span></a>  <span class="comment"> *</span>
<a name="l6344"><span class="linenum">6344</span></a>  <span class="comment"> * @static string $gb Localized string for size in gigabytes</span>
<a name="l6345"><span class="linenum">6345</span></a>  <span class="comment"> * @static string $mb Localized string for size in megabytes</span>
<a name="l6346"><span class="linenum">6346</span></a>  <span class="comment"> * @static string $kb Localized string for size in kilobytes</span>
<a name="l6347"><span class="linenum">6347</span></a>  <span class="comment"> * @static string $b Localized string for size in bytes</span>
<a name="l6348"><span class="linenum">6348</span></a>  <span class="comment"> * @param int $size  The size to convert to human readable form</span>
<a name="l6349"><span class="linenum">6349</span></a>  <span class="comment"> * @return string</span>
<a name="l6350"><span class="linenum">6350</span></a>  <span class="comment"> */</span>
<a name="l6351"><span class="linenum">6351</span></a>  function <a class="function" onClick="logFunction('display_size')" href="../_functions/display_size.html" onMouseOver="funcPopup(event,'display_size')">display_size</a>(<a class="var it1225" onMouseOver="hilite(1225)" onMouseOut="lolite()" onClick="logVariable('size')" href="../_variables/size.html">$size</a>) {
<a name="l6352"><span class="linenum">6352</span></a>  
<a name="l6353"><span class="linenum">6353</span></a>      static <a class="var it13127" onMouseOver="hilite(13127)" onMouseOut="lolite()" onClick="logVariable('gb')" href="../_variables/gb.html">$gb</a>, <a class="var it13128" onMouseOver="hilite(13128)" onMouseOut="lolite()" onClick="logVariable('mb')" href="../_variables/mb.html">$mb</a>, <a class="var it13129" onMouseOver="hilite(13129)" onMouseOut="lolite()" onClick="logVariable('kb')" href="../_variables/kb.html">$kb</a>, <a class="var it444" onMouseOver="hilite(444)" onMouseOut="lolite()" onClick="logVariable('b')" href="../_variables/b.html">$b</a>;
<a name="l6354"><span class="linenum">6354</span></a>  
<a name="l6355"><span class="linenum">6355</span></a>      if (<a class="var it1225" onMouseOver="hilite(1225)" onMouseOut="lolite()" onClick="logVariable('size')" href="../_variables/size.html">$size</a> === <a class="constant" onClick="logConstant('USER_CAN_IGNORE_FILE_SIZE_LIMITS')" href="../_constants/USER_CAN_IGNORE_FILE_SIZE_LIMITS.html" onMouseOver="constPopup(event,'USER_CAN_IGNORE_FILE_SIZE_LIMITS')">USER_CAN_IGNORE_FILE_SIZE_LIMITS</a>) {
<a name="l6356"><span class="linenum">6356</span></a>          return <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('unlimited');
<a name="l6357"><span class="linenum">6357</span></a>      }
<a name="l6358"><span class="linenum">6358</span></a>  
<a name="l6359"><span class="linenum">6359</span></a>      if (empty(<a class="var it13127" onMouseOver="hilite(13127)" onMouseOut="lolite()" onClick="logVariable('gb')" href="../_variables/gb.html">$gb</a>)) {
<a name="l6360"><span class="linenum">6360</span></a>          <a class="var it13127" onMouseOver="hilite(13127)" onMouseOut="lolite()" onClick="logVariable('gb')" href="../_variables/gb.html">$gb</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('sizegb');
<a name="l6361"><span class="linenum">6361</span></a>          <a class="var it13128" onMouseOver="hilite(13128)" onMouseOut="lolite()" onClick="logVariable('mb')" href="../_variables/mb.html">$mb</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('sizemb');
<a name="l6362"><span class="linenum">6362</span></a>          <a class="var it13129" onMouseOver="hilite(13129)" onMouseOut="lolite()" onClick="logVariable('kb')" href="../_variables/kb.html">$kb</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('sizekb');
<a name="l6363"><span class="linenum">6363</span></a>          <a class="var it444" onMouseOver="hilite(444)" onMouseOut="lolite()" onClick="logVariable('b')" href="../_variables/b.html">$b</a>  = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('sizeb');
<a name="l6364"><span class="linenum">6364</span></a>      }
<a name="l6365"><span class="linenum">6365</span></a>  
<a name="l6366"><span class="linenum">6366</span></a>      if (<a class="var it1225" onMouseOver="hilite(1225)" onMouseOut="lolite()" onClick="logVariable('size')" href="../_variables/size.html">$size</a> &gt;= 1073741824) {
<a name="l6367"><span class="linenum">6367</span></a>          <a class="var it1225" onMouseOver="hilite(1225)" onMouseOut="lolite()" onClick="logVariable('size')" href="../_variables/size.html">$size</a> = <a class="phpfunction" onClick="logFunction('round')" href="../_functions/round.html" onMouseOver="phpfuncPopup(event,'round')">round</a>(<a class="var it1225" onMouseOver="hilite(1225)" onMouseOut="lolite()" onClick="logVariable('size')" href="../_variables/size.html">$size</a> / 1073741824 * 10) / 10 . <a class="var it13127" onMouseOver="hilite(13127)" onMouseOut="lolite()" onClick="logVariable('gb')" href="../_variables/gb.html">$gb</a>;
<a name="l6368"><span class="linenum">6368</span></a>      } else if (<a class="var it1225" onMouseOver="hilite(1225)" onMouseOut="lolite()" onClick="logVariable('size')" href="../_variables/size.html">$size</a> &gt;= 1048576) {
<a name="l6369"><span class="linenum">6369</span></a>          <a class="var it1225" onMouseOver="hilite(1225)" onMouseOut="lolite()" onClick="logVariable('size')" href="../_variables/size.html">$size</a> = <a class="phpfunction" onClick="logFunction('round')" href="../_functions/round.html" onMouseOver="phpfuncPopup(event,'round')">round</a>(<a class="var it1225" onMouseOver="hilite(1225)" onMouseOut="lolite()" onClick="logVariable('size')" href="../_variables/size.html">$size</a> / 1048576 * 10) / 10 . <a class="var it13128" onMouseOver="hilite(13128)" onMouseOut="lolite()" onClick="logVariable('mb')" href="../_variables/mb.html">$mb</a>;
<a name="l6370"><span class="linenum">6370</span></a>      } else if (<a class="var it1225" onMouseOver="hilite(1225)" onMouseOut="lolite()" onClick="logVariable('size')" href="../_variables/size.html">$size</a> &gt;= 1024) {
<a name="l6371"><span class="linenum">6371</span></a>          <a class="var it1225" onMouseOver="hilite(1225)" onMouseOut="lolite()" onClick="logVariable('size')" href="../_variables/size.html">$size</a> = <a class="phpfunction" onClick="logFunction('round')" href="../_functions/round.html" onMouseOver="phpfuncPopup(event,'round')">round</a>(<a class="var it1225" onMouseOver="hilite(1225)" onMouseOut="lolite()" onClick="logVariable('size')" href="../_variables/size.html">$size</a> / 1024 * 10) / 10 . <a class="var it13129" onMouseOver="hilite(13129)" onMouseOut="lolite()" onClick="logVariable('kb')" href="../_variables/kb.html">$kb</a>;
<a name="l6372"><span class="linenum">6372</span></a>      } else {
<a name="l6373"><span class="linenum">6373</span></a>          <a class="var it1225" onMouseOver="hilite(1225)" onMouseOut="lolite()" onClick="logVariable('size')" href="../_variables/size.html">$size</a> = <a class="phpfunction" onClick="logFunction('intval')" href="../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>(<a class="var it1225" onMouseOver="hilite(1225)" onMouseOut="lolite()" onClick="logVariable('size')" href="../_variables/size.html">$size</a>) .' '. <a class="var it444" onMouseOver="hilite(444)" onMouseOut="lolite()" onClick="logVariable('b')" href="../_variables/b.html">$b</a>; <span class="comment">// File sizes over 2GB can not work in 32bit PHP anyway.</span>
<a name="l6374"><span class="linenum">6374</span></a>      }
<a name="l6375"><span class="linenum">6375</span></a>      return <a class="var it1225" onMouseOver="hilite(1225)" onMouseOut="lolite()" onClick="logVariable('size')" href="../_variables/size.html">$size</a>;
<a name="l6376"><span class="linenum">6376</span></a>  }
<a name="l6377"><span class="linenum">6377</span></a>  
<a name="l6378"><span class="linenum">6378</span></a>  <span class="comment">/**</span>
<a name="l6379"><span class="linenum">6379</span></a>  <span class="comment"> * Cleans a given filename by removing suspicious or troublesome characters</span>
<a name="l6380"><span class="linenum">6380</span></a>  <span class="comment"> *</span>
<a name="l6381"><span class="linenum">6381</span></a>  <span class="comment"> * @see clean_param()</span>
<a name="l6382"><span class="linenum">6382</span></a>  <span class="comment"> * @param string $string file name</span>
<a name="l6383"><span class="linenum">6383</span></a>  <span class="comment"> * @return string cleaned file name</span>
<a name="l6384"><span class="linenum">6384</span></a>  <span class="comment"> */</span>
<a name="l6385"><span class="linenum">6385</span></a>  function <a class="function" onClick="logFunction('clean_filename')" href="../_functions/clean_filename.html" onMouseOver="funcPopup(event,'clean_filename')">clean_filename</a>(<a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>) {
<a name="l6386"><span class="linenum">6386</span></a>      return <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>, <a class="constant" onClick="logConstant('PARAM_FILE')" href="../_constants/PARAM_FILE.html" onMouseOver="constPopup(event,'PARAM_FILE')">PARAM_FILE</a>);
<a name="l6387"><span class="linenum">6387</span></a>  }
<a name="l6388"><span class="linenum">6388</span></a>  
<a name="l6389"><span class="linenum">6389</span></a>  
<a name="l6390"><span class="linenum">6390</span></a>  <span class="comment">// STRING TRANSLATION.</span>
<a name="l6391"><span class="linenum">6391</span></a>  
<a name="l6392"><span class="linenum">6392</span></a>  <span class="comment">/**</span>
<a name="l6393"><span class="linenum">6393</span></a>  <span class="comment"> * Returns the code for the current language</span>
<a name="l6394"><span class="linenum">6394</span></a>  <span class="comment"> *</span>
<a name="l6395"><span class="linenum">6395</span></a>  <span class="comment"> * @category string</span>
<a name="l6396"><span class="linenum">6396</span></a>  <span class="comment"> * @return string</span>
<a name="l6397"><span class="linenum">6397</span></a>  <span class="comment"> */</span>
<a name="l6398"><span class="linenum">6398</span></a>  function <a class="function" onClick="logFunction('current_language')" href="../_functions/current_language.html" onMouseOver="funcPopup(event,'current_language')">current_language</a>() {
<a name="l6399"><span class="linenum">6399</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>, <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>, <a class="var it2554" onMouseOver="hilite(2554)" onMouseOut="lolite()" onClick="logVariable('COURSE')" href="../_variables/COURSE.html">$COURSE</a>;
<a name="l6400"><span class="linenum">6400</span></a>  
<a name="l6401"><span class="linenum">6401</span></a>      if (!empty(<a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('forcelang')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/forcelang.html">forcelang</a>)) {
<a name="l6402"><span class="linenum">6402</span></a>  <span class="comment">        // Allows overriding course-forced language (useful for admins to check</span>
<a name="l6403"><span class="linenum">6403</span></a>  <span class="comment">        // issues in courses whose language they don't understand).</span>
<a name="l6404"><span class="linenum">6404</span></a>  <span class="comment">        // Also used by some code to temporarily get language-related information in a</span>
<a name="l6405"><span class="linenum">6405</span></a>  <span class="comment">        // specific language (see force_current_language()).</span>
<a name="l6406"><span class="linenum">6406</span></a>          <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a> = <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('forcelang')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/forcelang.html">forcelang</a>;
<a name="l6407"><span class="linenum">6407</span></a>  
<a name="l6408"><span class="linenum">6408</span></a>      } else if (!empty(<a class="var it2554" onMouseOver="hilite(2554)" onMouseOut="lolite()" onClick="logVariable('COURSE')" href="../_variables/COURSE.html">$COURSE</a>-&gt;<a onClick="logVariable('id')" class="var it39504" onMouseOver="hilite(39504)" onMouseOut="lolite()" href="../_variables/id.html">id</a>) and <a class="var it2554" onMouseOver="hilite(2554)" onMouseOut="lolite()" onClick="logVariable('COURSE')" href="../_variables/COURSE.html">$COURSE</a>-&gt;<a onClick="logVariable('id')" class="var it39504" onMouseOver="hilite(39504)" onMouseOut="lolite()" href="../_variables/id.html">id</a> != <a class="constant" onClick="logConstant('SITEID')" href="../_constants/SITEID.html" onMouseOver="constPopup(event,'SITEID')">SITEID</a> and !empty(<a class="var it2554" onMouseOver="hilite(2554)" onMouseOut="lolite()" onClick="logVariable('COURSE')" href="../_variables/COURSE.html">$COURSE</a>-&gt;<a onClick="logVariable('lang')" class="var it39504" onMouseOver="hilite(39504)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>)) {
<a name="l6409"><span class="linenum">6409</span></a>  <span class="comment">        // Course language can override all other settings for this page.</span>
<a name="l6410"><span class="linenum">6410</span></a>          <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a> = <a class="var it2554" onMouseOver="hilite(2554)" onMouseOut="lolite()" onClick="logVariable('COURSE')" href="../_variables/COURSE.html">$COURSE</a>-&gt;<a onClick="logVariable('lang')" class="var it39504" onMouseOver="hilite(39504)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>;
<a name="l6411"><span class="linenum">6411</span></a>  
<a name="l6412"><span class="linenum">6412</span></a>      } else if (!empty(<a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('lang')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>)) {
<a name="l6413"><span class="linenum">6413</span></a>  <span class="comment">        // Session language can override other settings.</span>
<a name="l6414"><span class="linenum">6414</span></a>          <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a> = <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('lang')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>;
<a name="l6415"><span class="linenum">6415</span></a>  
<a name="l6416"><span class="linenum">6416</span></a>      } else if (!empty(<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('lang')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>)) {
<a name="l6417"><span class="linenum">6417</span></a>          <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a> = <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('lang')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>;
<a name="l6418"><span class="linenum">6418</span></a>  
<a name="l6419"><span class="linenum">6419</span></a>      } else if (isset(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('lang')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>)) {
<a name="l6420"><span class="linenum">6420</span></a>          <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('lang')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>;
<a name="l6421"><span class="linenum">6421</span></a>  
<a name="l6422"><span class="linenum">6422</span></a>      } else {
<a name="l6423"><span class="linenum">6423</span></a>          <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a> = 'en';
<a name="l6424"><span class="linenum">6424</span></a>      }
<a name="l6425"><span class="linenum">6425</span></a>  
<a name="l6426"><span class="linenum">6426</span></a>  <span class="comment">    // Just in case this slipped in from somewhere by accident.</span>
<a name="l6427"><span class="linenum">6427</span></a>      <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('_utf8', '', <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a>);
<a name="l6428"><span class="linenum">6428</span></a>  
<a name="l6429"><span class="linenum">6429</span></a>      return <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a>;
<a name="l6430"><span class="linenum">6430</span></a>  }
<a name="l6431"><span class="linenum">6431</span></a>  
<a name="l6432"><span class="linenum">6432</span></a>  <span class="comment">/**</span>
<a name="l6433"><span class="linenum">6433</span></a>  <span class="comment"> * Returns parent language of current active language if defined</span>
<a name="l6434"><span class="linenum">6434</span></a>  <span class="comment"> *</span>
<a name="l6435"><span class="linenum">6435</span></a>  <span class="comment"> * @category string</span>
<a name="l6436"><span class="linenum">6436</span></a>  <span class="comment"> * @param string $lang null means current language</span>
<a name="l6437"><span class="linenum">6437</span></a>  <span class="comment"> * @return string</span>
<a name="l6438"><span class="linenum">6438</span></a>  <span class="comment"> */</span>
<a name="l6439"><span class="linenum">6439</span></a>  function <a class="function" onClick="logFunction('get_parent_language')" href="../_functions/get_parent_language.html" onMouseOver="funcPopup(event,'get_parent_language')">get_parent_language</a>(<a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a>=null) {
<a name="l6440"><span class="linenum">6440</span></a>  
<a name="l6441"><span class="linenum">6441</span></a>  <span class="comment">    // Let's hack around the current language.</span>
<a name="l6442"><span class="linenum">6442</span></a>      if (!empty(<a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a>)) {
<a name="l6443"><span class="linenum">6443</span></a>          <a class="var it8645" onMouseOver="hilite(8645)" onMouseOut="lolite()" onClick="logVariable('oldforcelang')" href="../_variables/oldforcelang.html">$oldforcelang</a> = <a class="function" onClick="logFunction('force_current_language')" href="../_functions/force_current_language.html" onMouseOver="funcPopup(event,'force_current_language')">force_current_language</a>(<a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a>);
<a name="l6444"><span class="linenum">6444</span></a>      }
<a name="l6445"><span class="linenum">6445</span></a>  
<a name="l6446"><span class="linenum">6446</span></a>      <a class="var it13130" onMouseOver="hilite(13130)" onMouseOut="lolite()" onClick="logVariable('parentlang')" href="../_variables/parentlang.html">$parentlang</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('parentlanguage', 'langconfig');
<a name="l6447"><span class="linenum">6447</span></a>      if (<a class="var it13130" onMouseOver="hilite(13130)" onMouseOut="lolite()" onClick="logVariable('parentlang')" href="../_variables/parentlang.html">$parentlang</a> === 'en') {
<a name="l6448"><span class="linenum">6448</span></a>          <a class="var it13130" onMouseOver="hilite(13130)" onMouseOut="lolite()" onClick="logVariable('parentlang')" href="../_variables/parentlang.html">$parentlang</a> = '';
<a name="l6449"><span class="linenum">6449</span></a>      }
<a name="l6450"><span class="linenum">6450</span></a>  
<a name="l6451"><span class="linenum">6451</span></a>  <span class="comment">    // Let's hack around the current language.</span>
<a name="l6452"><span class="linenum">6452</span></a>      if (!empty(<a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a>)) {
<a name="l6453"><span class="linenum">6453</span></a>          <a class="function" onClick="logFunction('force_current_language')" href="../_functions/force_current_language.html" onMouseOver="funcPopup(event,'force_current_language')">force_current_language</a>(<a class="var it8645" onMouseOver="hilite(8645)" onMouseOut="lolite()" onClick="logVariable('oldforcelang')" href="../_variables/oldforcelang.html">$oldforcelang</a>);
<a name="l6454"><span class="linenum">6454</span></a>      }
<a name="l6455"><span class="linenum">6455</span></a>  
<a name="l6456"><span class="linenum">6456</span></a>      return <a class="var it13130" onMouseOver="hilite(13130)" onMouseOut="lolite()" onClick="logVariable('parentlang')" href="../_variables/parentlang.html">$parentlang</a>;
<a name="l6457"><span class="linenum">6457</span></a>  }
<a name="l6458"><span class="linenum">6458</span></a>  
<a name="l6459"><span class="linenum">6459</span></a>  <span class="comment">/**</span>
<a name="l6460"><span class="linenum">6460</span></a>  <span class="comment"> * Force the current language to get strings and dates localised in the given language.</span>
<a name="l6461"><span class="linenum">6461</span></a>  <span class="comment"> *</span>
<a name="l6462"><span class="linenum">6462</span></a>  <span class="comment"> * After calling this function, all strings will be provided in the given language</span>
<a name="l6463"><span class="linenum">6463</span></a>  <span class="comment"> * until this function is called again, or equivalent code is run.</span>
<a name="l6464"><span class="linenum">6464</span></a>  <span class="comment"> *</span>
<a name="l6465"><span class="linenum">6465</span></a>  <span class="comment"> * @param string $language</span>
<a name="l6466"><span class="linenum">6466</span></a>  <span class="comment"> * @return string previous $SESSION-&gt;forcelang value</span>
<a name="l6467"><span class="linenum">6467</span></a>  <span class="comment"> */</span>
<a name="l6468"><span class="linenum">6468</span></a>  function <a class="function" onClick="logFunction('force_current_language')" href="../_functions/force_current_language.html" onMouseOver="funcPopup(event,'force_current_language')">force_current_language</a>(<a class="var it2096" onMouseOver="hilite(2096)" onMouseOut="lolite()" onClick="logVariable('language')" href="../_variables/language.html">$language</a>) {
<a name="l6469"><span class="linenum">6469</span></a>      global <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>;
<a name="l6470"><span class="linenum">6470</span></a>      <a class="var it13131" onMouseOver="hilite(13131)" onMouseOut="lolite()" onClick="logVariable('sessionforcelang')" href="../_variables/sessionforcelang.html">$sessionforcelang</a> = isset(<a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('forcelang')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/forcelang.html">forcelang</a>) ? <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('forcelang')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/forcelang.html">forcelang</a> : '';
<a name="l6471"><span class="linenum">6471</span></a>      if (<a class="var it2096" onMouseOver="hilite(2096)" onMouseOut="lolite()" onClick="logVariable('language')" href="../_variables/language.html">$language</a> !== <a class="var it13131" onMouseOver="hilite(13131)" onMouseOut="lolite()" onClick="logVariable('sessionforcelang')" href="../_variables/sessionforcelang.html">$sessionforcelang</a>) {
<a name="l6472"><span class="linenum">6472</span></a>  <span class="comment">        // Seting forcelang to null or an empty string disables it's effect.</span>
<a name="l6473"><span class="linenum">6473</span></a>          if (empty(<a class="var it2096" onMouseOver="hilite(2096)" onMouseOut="lolite()" onClick="logVariable('language')" href="../_variables/language.html">$language</a>) || <a class="function" onClick="logFunction('get_string_manager')" href="../_functions/get_string_manager.html" onMouseOver="funcPopup(event,'get_string_manager')">get_string_manager</a>()-&gt;<a class="function" onClick="logFunction('translation_exists')" href="../_functions/translation_exists.html" onMouseOver="funcPopup(event,'translation_exists')">translation_exists</a>(<a class="var it2096" onMouseOver="hilite(2096)" onMouseOut="lolite()" onClick="logVariable('language')" href="../_variables/language.html">$language</a>, false)) {
<a name="l6474"><span class="linenum">6474</span></a>              <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('forcelang')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/forcelang.html">forcelang</a> = <a class="var it2096" onMouseOver="hilite(2096)" onMouseOut="lolite()" onClick="logVariable('language')" href="../_variables/language.html">$language</a>;
<a name="l6475"><span class="linenum">6475</span></a>              <a class="function" onClick="logFunction('moodle_setlocale')" href="../_functions/moodle_setlocale.html" onMouseOver="funcPopup(event,'moodle_setlocale')">moodle_setlocale</a>();
<a name="l6476"><span class="linenum">6476</span></a>          }
<a name="l6477"><span class="linenum">6477</span></a>      }
<a name="l6478"><span class="linenum">6478</span></a>      return <a class="var it13131" onMouseOver="hilite(13131)" onMouseOut="lolite()" onClick="logVariable('sessionforcelang')" href="../_variables/sessionforcelang.html">$sessionforcelang</a>;
<a name="l6479"><span class="linenum">6479</span></a>  }
<a name="l6480"><span class="linenum">6480</span></a>  
<a name="l6481"><span class="linenum">6481</span></a>  <span class="comment">/**</span>
<a name="l6482"><span class="linenum">6482</span></a>  <span class="comment"> * Returns current string_manager instance.</span>
<a name="l6483"><span class="linenum">6483</span></a>  <span class="comment"> *</span>
<a name="l6484"><span class="linenum">6484</span></a>  <span class="comment"> * The param $forcereload is needed for CLI installer only where the string_manager instance</span>
<a name="l6485"><span class="linenum">6485</span></a>  <span class="comment"> * must be replaced during the install.php script life time.</span>
<a name="l6486"><span class="linenum">6486</span></a>  <span class="comment"> *</span>
<a name="l6487"><span class="linenum">6487</span></a>  <span class="comment"> * @category string</span>
<a name="l6488"><span class="linenum">6488</span></a>  <span class="comment"> * @param bool $forcereload shall the singleton be released and new instance created instead?</span>
<a name="l6489"><span class="linenum">6489</span></a>  <span class="comment"> * @return core_string_manager</span>
<a name="l6490"><span class="linenum">6490</span></a>  <span class="comment"> */</span>
<a name="l6491"><span class="linenum">6491</span></a>  function <a class="function" onClick="logFunction('get_string_manager')" href="../_functions/get_string_manager.html" onMouseOver="funcPopup(event,'get_string_manager')">get_string_manager</a>(<a class="var it1820" onMouseOver="hilite(1820)" onMouseOut="lolite()" onClick="logVariable('forcereload')" href="../_variables/forcereload.html">$forcereload</a>=false) {
<a name="l6492"><span class="linenum">6492</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l6493"><span class="linenum">6493</span></a>  
<a name="l6494"><span class="linenum">6494</span></a>      static <a class="var it7858" onMouseOver="hilite(7858)" onMouseOut="lolite()" onClick="logVariable('singleton')" href="../_variables/singleton.html">$singleton</a> = null;
<a name="l6495"><span class="linenum">6495</span></a>  
<a name="l6496"><span class="linenum">6496</span></a>      if (<a class="var it1820" onMouseOver="hilite(1820)" onMouseOut="lolite()" onClick="logVariable('forcereload')" href="../_variables/forcereload.html">$forcereload</a>) {
<a name="l6497"><span class="linenum">6497</span></a>          <a class="var it7858" onMouseOver="hilite(7858)" onMouseOut="lolite()" onClick="logVariable('singleton')" href="../_variables/singleton.html">$singleton</a> = null;
<a name="l6498"><span class="linenum">6498</span></a>      }
<a name="l6499"><span class="linenum">6499</span></a>      if (<a class="var it7858" onMouseOver="hilite(7858)" onMouseOut="lolite()" onClick="logVariable('singleton')" href="../_variables/singleton.html">$singleton</a> === null) {
<a name="l6500"><span class="linenum">6500</span></a>          if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('early_install_lang')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/early_install_lang.html">early_install_lang</a>)) {
<a name="l6501"><span class="linenum">6501</span></a>  
<a name="l6502"><span class="linenum">6502</span></a>              if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('langlist')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/langlist.html">langlist</a>)) {
<a name="l6503"><span class="linenum">6503</span></a>                   <a class="var it13132" onMouseOver="hilite(13132)" onMouseOut="lolite()" onClick="logVariable('translist')" href="../_variables/translist.html">$translist</a> = array();
<a name="l6504"><span class="linenum">6504</span></a>              } else {
<a name="l6505"><span class="linenum">6505</span></a>                  <a class="var it13132" onMouseOver="hilite(13132)" onMouseOut="lolite()" onClick="logVariable('translist')" href="../_variables/translist.html">$translist</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(',', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('langlist')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/langlist.html">langlist</a>);
<a name="l6506"><span class="linenum">6506</span></a>              }
<a name="l6507"><span class="linenum">6507</span></a>  
<a name="l6508"><span class="linenum">6508</span></a>              if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('config_php_settings')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/config_php_settings.html">config_php_settings</a>['customstringmanager'])) {
<a name="l6509"><span class="linenum">6509</span></a>                  <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../_variables/classname.html">$classname</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('config_php_settings')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/config_php_settings.html">config_php_settings</a>['customstringmanager'];
<a name="l6510"><span class="linenum">6510</span></a>  
<a name="l6511"><span class="linenum">6511</span></a>                  if (<a class="phpfunction" onClick="logFunction('class_exists')" href="../_functions/class_exists.html" onMouseOver="phpfuncPopup(event,'class_exists')">class_exists</a>(<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../_variables/classname.html">$classname</a>)) {
<a name="l6512"><span class="linenum">6512</span></a>                      <a class="var it13133" onMouseOver="hilite(13133)" onMouseOut="lolite()" onClick="logVariable('implements')" href="../_variables/implements.html">$implements</a> = <a class="phpfunction" onClick="logFunction('class_implements')" href="../_functions/class_implements.html" onMouseOver="phpfuncPopup(event,'class_implements')">class_implements</a>(<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../_variables/classname.html">$classname</a>);
<a name="l6513"><span class="linenum">6513</span></a>  
<a name="l6514"><span class="linenum">6514</span></a>                      if (isset(<a class="var it13133" onMouseOver="hilite(13133)" onMouseOut="lolite()" onClick="logVariable('implements')" href="../_variables/implements.html">$implements</a>['core_string_manager'])) {
<a name="l6515"><span class="linenum">6515</span></a>                          <a class="var it7858" onMouseOver="hilite(7858)" onMouseOut="lolite()" onClick="logVariable('singleton')" href="../_variables/singleton.html">$singleton</a> = new <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../_variables/classname.html">$classname</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('langotherroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/langotherroot.html">langotherroot</a>, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('langlocalroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/langlocalroot.html">langlocalroot</a>, <a class="var it13132" onMouseOver="hilite(13132)" onMouseOut="lolite()" onClick="logVariable('translist')" href="../_variables/translist.html">$translist</a>);
<a name="l6516"><span class="linenum">6516</span></a>                          return <a class="var it7858" onMouseOver="hilite(7858)" onMouseOut="lolite()" onClick="logVariable('singleton')" href="../_variables/singleton.html">$singleton</a>;
<a name="l6517"><span class="linenum">6517</span></a>  
<a name="l6518"><span class="linenum">6518</span></a>                      } else {
<a name="l6519"><span class="linenum">6519</span></a>                          <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Unable to instantiate custom string manager: class '.<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../_variables/classname.html">$classname</a>.
<a name="l6520"><span class="linenum">6520</span></a>                              ' does not implement the core_string_manager interface.');
<a name="l6521"><span class="linenum">6521</span></a>                      }
<a name="l6522"><span class="linenum">6522</span></a>  
<a name="l6523"><span class="linenum">6523</span></a>                  } else {
<a name="l6524"><span class="linenum">6524</span></a>                      <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Unable to instantiate custom string manager: class '.<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../_variables/classname.html">$classname</a>.' can not be found.');
<a name="l6525"><span class="linenum">6525</span></a>                  }
<a name="l6526"><span class="linenum">6526</span></a>              }
<a name="l6527"><span class="linenum">6527</span></a>  
<a name="l6528"><span class="linenum">6528</span></a>              <a class="var it7858" onMouseOver="hilite(7858)" onMouseOut="lolite()" onClick="logVariable('singleton')" href="../_variables/singleton.html">$singleton</a> = <span class="keyword">new </span><a class="class" onClick="logClass('core_string_manager_standard')" href="../_classes/core_string_manager_standard.html" onMouseOver="classPopup(event,'core_string_manager_standard')">core_string_manager_standard</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('langotherroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/langotherroot.html">langotherroot</a>, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('langlocalroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/langlocalroot.html">langlocalroot</a>, <a class="var it13132" onMouseOver="hilite(13132)" onMouseOut="lolite()" onClick="logVariable('translist')" href="../_variables/translist.html">$translist</a>);
<a name="l6529"><span class="linenum">6529</span></a>  
<a name="l6530"><span class="linenum">6530</span></a>          } else {
<a name="l6531"><span class="linenum">6531</span></a>              <a class="var it7858" onMouseOver="hilite(7858)" onMouseOut="lolite()" onClick="logVariable('singleton')" href="../_variables/singleton.html">$singleton</a> = <span class="keyword">new </span><a class="class" onClick="logClass('core_string_manager_install')" href="../_classes/core_string_manager_install.html" onMouseOver="classPopup(event,'core_string_manager_install')">core_string_manager_install</a>();
<a name="l6532"><span class="linenum">6532</span></a>          }
<a name="l6533"><span class="linenum">6533</span></a>      }
<a name="l6534"><span class="linenum">6534</span></a>  
<a name="l6535"><span class="linenum">6535</span></a>      return <a class="var it7858" onMouseOver="hilite(7858)" onMouseOut="lolite()" onClick="logVariable('singleton')" href="../_variables/singleton.html">$singleton</a>;
<a name="l6536"><span class="linenum">6536</span></a>  }
<a name="l6537"><span class="linenum">6537</span></a>  
<a name="l6538"><span class="linenum">6538</span></a>  <span class="comment">/**</span>
<a name="l6539"><span class="linenum">6539</span></a>  <span class="comment"> * Returns a localized string.</span>
<a name="l6540"><span class="linenum">6540</span></a>  <span class="comment"> *</span>
<a name="l6541"><span class="linenum">6541</span></a>  <span class="comment"> * Returns the translated string specified by $identifier as</span>
<a name="l6542"><span class="linenum">6542</span></a>  <span class="comment"> * for $module.  Uses the same format files as STphp.</span>
<a name="l6543"><span class="linenum">6543</span></a>  <span class="comment"> * $a is an object, string or number that can be used</span>
<a name="l6544"><span class="linenum">6544</span></a>  <span class="comment"> * within translation strings</span>
<a name="l6545"><span class="linenum">6545</span></a>  <span class="comment"> *</span>
<a name="l6546"><span class="linenum">6546</span></a>  <span class="comment"> * eg 'hello {$a-&gt;firstname} {$a-&gt;lastname}'</span>
<a name="l6547"><span class="linenum">6547</span></a>  <span class="comment"> * or 'hello {$a}'</span>
<a name="l6548"><span class="linenum">6548</span></a>  <span class="comment"> *</span>
<a name="l6549"><span class="linenum">6549</span></a>  <span class="comment"> * If you would like to directly echo the localized string use</span>
<a name="l6550"><span class="linenum">6550</span></a>  <span class="comment"> * the function {@link print_string()}</span>
<a name="l6551"><span class="linenum">6551</span></a>  <span class="comment"> *</span>
<a name="l6552"><span class="linenum">6552</span></a>  <span class="comment"> * Example usage of this function involves finding the string you would</span>
<a name="l6553"><span class="linenum">6553</span></a>  <span class="comment"> * like a local equivalent of and using its identifier and module information</span>
<a name="l6554"><span class="linenum">6554</span></a>  <span class="comment"> * to retrieve it.&lt;br/&gt;</span>
<a name="l6555"><span class="linenum">6555</span></a>  <span class="comment"> * If you open moodle/lang/en/moodle.php and look near line 278</span>
<a name="l6556"><span class="linenum">6556</span></a>  <span class="comment"> * you will find a string to prompt a user for their word for 'course'</span>
<a name="l6557"><span class="linenum">6557</span></a>  <span class="comment"> * &lt;code&gt;</span>
<a name="l6558"><span class="linenum">6558</span></a>  <span class="comment"> * $string['course'] = 'Course';</span>
<a name="l6559"><span class="linenum">6559</span></a>  <span class="comment"> * &lt;/code&gt;</span>
<a name="l6560"><span class="linenum">6560</span></a>  <span class="comment"> * So if you want to display the string 'Course'</span>
<a name="l6561"><span class="linenum">6561</span></a>  <span class="comment"> * in any language that supports it on your site</span>
<a name="l6562"><span class="linenum">6562</span></a>  <span class="comment"> * you just need to use the identifier 'course'</span>
<a name="l6563"><span class="linenum">6563</span></a>  <span class="comment"> * &lt;code&gt;</span>
<a name="l6564"><span class="linenum">6564</span></a>  <span class="comment"> * $mystring = '&lt;strong&gt;'. get_string('course') .'&lt;/strong&gt;';</span>
<a name="l6565"><span class="linenum">6565</span></a>  <span class="comment"> * or</span>
<a name="l6566"><span class="linenum">6566</span></a>  <span class="comment"> * &lt;/code&gt;</span>
<a name="l6567"><span class="linenum">6567</span></a>  <span class="comment"> * If the string you want is in another file you'd take a slightly</span>
<a name="l6568"><span class="linenum">6568</span></a>  <span class="comment"> * different approach. Looking in moodle/lang/en/calendar.php you find</span>
<a name="l6569"><span class="linenum">6569</span></a>  <span class="comment"> * around line 75:</span>
<a name="l6570"><span class="linenum">6570</span></a>  <span class="comment"> * &lt;code&gt;</span>
<a name="l6571"><span class="linenum">6571</span></a>  <span class="comment"> * $string['typecourse'] = 'Course event';</span>
<a name="l6572"><span class="linenum">6572</span></a>  <span class="comment"> * &lt;/code&gt;</span>
<a name="l6573"><span class="linenum">6573</span></a>  <span class="comment"> * If you want to display the string &quot;Course event&quot; in any language</span>
<a name="l6574"><span class="linenum">6574</span></a>  <span class="comment"> * supported you would use the identifier 'typecourse' and the module 'calendar'</span>
<a name="l6575"><span class="linenum">6575</span></a>  <span class="comment"> * (because it is in the file calendar.php):</span>
<a name="l6576"><span class="linenum">6576</span></a>  <span class="comment"> * &lt;code&gt;</span>
<a name="l6577"><span class="linenum">6577</span></a>  <span class="comment"> * $mystring = '&lt;h1&gt;'. get_string('typecourse', 'calendar') .'&lt;/h1&gt;';</span>
<a name="l6578"><span class="linenum">6578</span></a>  <span class="comment"> * &lt;/code&gt;</span>
<a name="l6579"><span class="linenum">6579</span></a>  <span class="comment"> *</span>
<a name="l6580"><span class="linenum">6580</span></a>  <span class="comment"> * As a last resort, should the identifier fail to map to a string</span>
<a name="l6581"><span class="linenum">6581</span></a>  <span class="comment"> * the returned string will be [[ $identifier ]]</span>
<a name="l6582"><span class="linenum">6582</span></a>  <span class="comment"> *</span>
<a name="l6583"><span class="linenum">6583</span></a>  <span class="comment"> * In Moodle 2.3 there is a new argument to this function $lazyload.</span>
<a name="l6584"><span class="linenum">6584</span></a>  <span class="comment"> * Setting $lazyload to true causes get_string to return a lang_string object</span>
<a name="l6585"><span class="linenum">6585</span></a>  <span class="comment"> * rather than the string itself. The fetching of the string is then put off until</span>
<a name="l6586"><span class="linenum">6586</span></a>  <span class="comment"> * the string object is first used. The object can be used by calling it's out</span>
<a name="l6587"><span class="linenum">6587</span></a>  <span class="comment"> * method or by casting the object to a string, either directly e.g.</span>
<a name="l6588"><span class="linenum">6588</span></a>  <span class="comment"> *     (string)$stringobject</span>
<a name="l6589"><span class="linenum">6589</span></a>  <span class="comment"> * or indirectly by using the string within another string or echoing it out e.g.</span>
<a name="l6590"><span class="linenum">6590</span></a>  <span class="comment"> *     echo $stringobject</span>
<a name="l6591"><span class="linenum">6591</span></a>  <span class="comment"> *     return &quot;&lt;p&gt;{$stringobject}&lt;/p&gt;&quot;;</span>
<a name="l6592"><span class="linenum">6592</span></a>  <span class="comment"> * It is worth noting that using $lazyload and attempting to use the string as an</span>
<a name="l6593"><span class="linenum">6593</span></a>  <span class="comment"> * array key will cause a fatal error as objects cannot be used as array keys.</span>
<a name="l6594"><span class="linenum">6594</span></a>  <span class="comment"> * But you should never do that anyway!</span>
<a name="l6595"><span class="linenum">6595</span></a>  <span class="comment"> * For more information {@link lang_string}</span>
<a name="l6596"><span class="linenum">6596</span></a>  <span class="comment"> *</span>
<a name="l6597"><span class="linenum">6597</span></a>  <span class="comment"> * @category string</span>
<a name="l6598"><span class="linenum">6598</span></a>  <span class="comment"> * @param string $identifier The key identifier for the localized string</span>
<a name="l6599"><span class="linenum">6599</span></a>  <span class="comment"> * @param string $component The module where the key identifier is stored,</span>
<a name="l6600"><span class="linenum">6600</span></a>  <span class="comment"> *      usually expressed as the filename in the language pack without the</span>
<a name="l6601"><span class="linenum">6601</span></a>  <span class="comment"> *      .php on the end but can also be written as mod/forum or grade/export/xls.</span>
<a name="l6602"><span class="linenum">6602</span></a>  <span class="comment"> *      If none is specified then moodle.php is used.</span>
<a name="l6603"><span class="linenum">6603</span></a>  <span class="comment"> * @param string|object|array $a An object, string or number that can be used</span>
<a name="l6604"><span class="linenum">6604</span></a>  <span class="comment"> *      within translation strings</span>
<a name="l6605"><span class="linenum">6605</span></a>  <span class="comment"> * @param bool $lazyload If set to true a string object is returned instead of</span>
<a name="l6606"><span class="linenum">6606</span></a>  <span class="comment"> *      the string itself. The string then isn't calculated until it is first used.</span>
<a name="l6607"><span class="linenum">6607</span></a>  <span class="comment"> * @return string The localized string.</span>
<a name="l6608"><span class="linenum">6608</span></a>  <span class="comment"> * @throws coding_exception</span>
<a name="l6609"><span class="linenum">6609</span></a>  <span class="comment"> */</span>
<a name="l6610"><span class="linenum">6610</span></a>  function <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(<a class="var it1139" onMouseOver="hilite(1139)" onMouseOut="lolite()" onClick="logVariable('identifier')" href="../_variables/identifier.html">$identifier</a>, <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a> = '', <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a> = null, <a class="var it9122" onMouseOver="hilite(9122)" onMouseOut="lolite()" onClick="logVariable('lazyload')" href="../_variables/lazyload.html">$lazyload</a> = false) {
<a name="l6611"><span class="linenum">6611</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l6612"><span class="linenum">6612</span></a>  
<a name="l6613"><span class="linenum">6613</span></a>  <span class="comment">    // If the lazy load argument has been supplied return a lang_string object</span>
<a name="l6614"><span class="linenum">6614</span></a>  <span class="comment">    // instead.</span>
<a name="l6615"><span class="linenum">6615</span></a>  <span class="comment">    // We need to make sure it is true (and a bool) as you will see below there</span>
<a name="l6616"><span class="linenum">6616</span></a>  <span class="comment">    // used to be a forth argument at one point.</span>
<a name="l6617"><span class="linenum">6617</span></a>      if (<a class="var it9122" onMouseOver="hilite(9122)" onMouseOut="lolite()" onClick="logVariable('lazyload')" href="../_variables/lazyload.html">$lazyload</a> === true) {
<a name="l6618"><span class="linenum">6618</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('lang_string')" href="../_classes/lang_string.html" onMouseOver="classPopup(event,'lang_string')">lang_string</a>(<a class="var it1139" onMouseOver="hilite(1139)" onMouseOut="lolite()" onClick="logVariable('identifier')" href="../_variables/identifier.html">$identifier</a>, <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a>, <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>);
<a name="l6619"><span class="linenum">6619</span></a>      }
<a name="l6620"><span class="linenum">6620</span></a>  
<a name="l6621"><span class="linenum">6621</span></a>      if (<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('debugdeveloper')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/debugdeveloper.html">debugdeveloper</a> &amp;&amp; <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it1139" onMouseOver="hilite(1139)" onMouseOut="lolite()" onClick="logVariable('identifier')" href="../_variables/identifier.html">$identifier</a>, <a class="constant" onClick="logConstant('PARAM_STRINGID')" href="../_constants/PARAM_STRINGID.html" onMouseOver="constPopup(event,'PARAM_STRINGID')">PARAM_STRINGID</a>) === '') {
<a name="l6622"><span class="linenum">6622</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Invalid string identifier. The identifier cannot be empty. Please fix your <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>() call.', <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l6623"><span class="linenum">6623</span></a>      }
<a name="l6624"><span class="linenum">6624</span></a>  
<a name="l6625"><span class="linenum">6625</span></a>  <span class="comment">    // There is now a forth argument again, this time it is a boolean however so</span>
<a name="l6626"><span class="linenum">6626</span></a>  <span class="comment">    // we can still check for the old extralocations parameter.</span>
<a name="l6627"><span class="linenum">6627</span></a>      if (!<a class="phpfunction" onClick="logFunction('is_bool')" href="../_functions/is_bool.html" onMouseOver="phpfuncPopup(event,'is_bool')">is_bool</a>(<a class="var it9122" onMouseOver="hilite(9122)" onMouseOut="lolite()" onClick="logVariable('lazyload')" href="../_variables/lazyload.html">$lazyload</a>) &amp;&amp; !empty(<a class="var it9122" onMouseOver="hilite(9122)" onMouseOut="lolite()" onClick="logVariable('lazyload')" href="../_variables/lazyload.html">$lazyload</a>)) {
<a name="l6628"><span class="linenum">6628</span></a>          <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('extralocations parameter in <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>() is not supported any more, please use standard lang locations only.');
<a name="l6629"><span class="linenum">6629</span></a>      }
<a name="l6630"><span class="linenum">6630</span></a>  
<a name="l6631"><span class="linenum">6631</span></a>      if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a>, '/') !== false) {
<a name="l6632"><span class="linenum">6632</span></a>          <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('The module name you passed to get_string is the deprecated format ' .
<a name="l6633"><span class="linenum">6633</span></a>                  'like mod/mymod or block/myblock. The correct form looks like mymod, or block_myblock.' , <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l6634"><span class="linenum">6634</span></a>          <a class="var it13134" onMouseOver="hilite(13134)" onMouseOut="lolite()" onClick="logVariable('componentpath')" href="../_variables/componentpath.html">$componentpath</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>('/', <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a>);
<a name="l6635"><span class="linenum">6635</span></a>  
<a name="l6636"><span class="linenum">6636</span></a>          switch (<a class="var it13134" onMouseOver="hilite(13134)" onMouseOut="lolite()" onClick="logVariable('componentpath')" href="../_variables/componentpath.html">$componentpath</a>[0]) {
<a name="l6637"><span class="linenum">6637</span></a>              case 'mod':
<a name="l6638"><span class="linenum">6638</span></a>                  <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a> = <a class="var it13134" onMouseOver="hilite(13134)" onMouseOut="lolite()" onClick="logVariable('componentpath')" href="../_variables/componentpath.html">$componentpath</a>[1];
<a name="l6639"><span class="linenum">6639</span></a>                  break;
<a name="l6640"><span class="linenum">6640</span></a>              case 'blocks':
<a name="l6641"><span class="linenum">6641</span></a>              case 'block':
<a name="l6642"><span class="linenum">6642</span></a>                  <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a> = 'block_'.<a class="var it13134" onMouseOver="hilite(13134)" onMouseOut="lolite()" onClick="logVariable('componentpath')" href="../_variables/componentpath.html">$componentpath</a>[1];
<a name="l6643"><span class="linenum">6643</span></a>                  break;
<a name="l6644"><span class="linenum">6644</span></a>              case 'enrol':
<a name="l6645"><span class="linenum">6645</span></a>                  <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a> = 'enrol_'.<a class="var it13134" onMouseOver="hilite(13134)" onMouseOut="lolite()" onClick="logVariable('componentpath')" href="../_variables/componentpath.html">$componentpath</a>[1];
<a name="l6646"><span class="linenum">6646</span></a>                  break;
<a name="l6647"><span class="linenum">6647</span></a>              case 'format':
<a name="l6648"><span class="linenum">6648</span></a>                  <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a> = 'format_'.<a class="var it13134" onMouseOver="hilite(13134)" onMouseOut="lolite()" onClick="logVariable('componentpath')" href="../_variables/componentpath.html">$componentpath</a>[1];
<a name="l6649"><span class="linenum">6649</span></a>                  break;
<a name="l6650"><span class="linenum">6650</span></a>              case 'grade':
<a name="l6651"><span class="linenum">6651</span></a>                  <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a> = 'grade'.<a class="var it13134" onMouseOver="hilite(13134)" onMouseOut="lolite()" onClick="logVariable('componentpath')" href="../_variables/componentpath.html">$componentpath</a>[1].'_'.<a class="var it13134" onMouseOver="hilite(13134)" onMouseOut="lolite()" onClick="logVariable('componentpath')" href="../_variables/componentpath.html">$componentpath</a>[2];
<a name="l6652"><span class="linenum">6652</span></a>                  break;
<a name="l6653"><span class="linenum">6653</span></a>          }
<a name="l6654"><span class="linenum">6654</span></a>      }
<a name="l6655"><span class="linenum">6655</span></a>  
<a name="l6656"><span class="linenum">6656</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = <a class="function" onClick="logFunction('get_string_manager')" href="../_functions/get_string_manager.html" onMouseOver="funcPopup(event,'get_string_manager')">get_string_manager</a>()-&gt;<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(<a class="var it1139" onMouseOver="hilite(1139)" onMouseOut="lolite()" onClick="logVariable('identifier')" href="../_variables/identifier.html">$identifier</a>, <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a>, <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>);
<a name="l6657"><span class="linenum">6657</span></a>  
<a name="l6658"><span class="linenum">6658</span></a>  <span class="comment">    // Debugging feature lets you display string identifier and component.</span>
<a name="l6659"><span class="linenum">6659</span></a>      if (isset(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('debugstringids')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/debugstringids.html">debugstringids</a>) &amp;&amp; <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('debugstringids')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/debugstringids.html">debugstringids</a> &amp;&amp; <a class="function" onClick="logFunction('optional_param')" href="../_functions/optional_param.html" onMouseOver="funcPopup(event,'optional_param')">optional_param</a>('strings', 0, <a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>)) {
<a name="l6660"><span class="linenum">6660</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> .= ' {' . <a class="var it1139" onMouseOver="hilite(1139)" onMouseOut="lolite()" onClick="logVariable('identifier')" href="../_variables/identifier.html">$identifier</a> . '/' . <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a> . '}';
<a name="l6661"><span class="linenum">6661</span></a>      }
<a name="l6662"><span class="linenum">6662</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>;
<a name="l6663"><span class="linenum">6663</span></a>  }
<a name="l6664"><span class="linenum">6664</span></a>  
<a name="l6665"><span class="linenum">6665</span></a>  <span class="comment">/**</span>
<a name="l6666"><span class="linenum">6666</span></a>  <span class="comment"> * Converts an array of strings to their localized value.</span>
<a name="l6667"><span class="linenum">6667</span></a>  <span class="comment"> *</span>
<a name="l6668"><span class="linenum">6668</span></a>  <span class="comment"> * @param array $array An array of strings</span>
<a name="l6669"><span class="linenum">6669</span></a>  <span class="comment"> * @param string $component The language module that these strings can be found in.</span>
<a name="l6670"><span class="linenum">6670</span></a>  <span class="comment"> * @return stdClass translated strings.</span>
<a name="l6671"><span class="linenum">6671</span></a>  <span class="comment"> */</span>
<a name="l6672"><span class="linenum">6672</span></a>  function <a class="function" onClick="logFunction('get_strings')" href="../_functions/get_strings.html" onMouseOver="funcPopup(event,'get_strings')">get_strings</a>(<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a>, <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a> = '') {
<a name="l6673"><span class="linenum">6673</span></a>      <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a> = new stdClass;
<a name="l6674"><span class="linenum">6674</span></a>      foreach (<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a> as <a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../_variables/item.html">$item</a>) {
<a name="l6675"><span class="linenum">6675</span></a>          <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>-&gt;<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../_variables/item.html">$item</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../_variables/item.html">$item</a>, <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a>);
<a name="l6676"><span class="linenum">6676</span></a>      }
<a name="l6677"><span class="linenum">6677</span></a>      return <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>;
<a name="l6678"><span class="linenum">6678</span></a>  }
<a name="l6679"><span class="linenum">6679</span></a>  
<a name="l6680"><span class="linenum">6680</span></a>  <span class="comment">/**</span>
<a name="l6681"><span class="linenum">6681</span></a>  <span class="comment"> * Prints out a translated string.</span>
<a name="l6682"><span class="linenum">6682</span></a>  <span class="comment"> *</span>
<a name="l6683"><span class="linenum">6683</span></a>  <span class="comment"> * Prints out a translated string using the return value from the {@link get_string()} function.</span>
<a name="l6684"><span class="linenum">6684</span></a>  <span class="comment"> *</span>
<a name="l6685"><span class="linenum">6685</span></a>  <span class="comment"> * Example usage of this function when the string is in the moodle.php file:&lt;br/&gt;</span>
<a name="l6686"><span class="linenum">6686</span></a>  <span class="comment"> * &lt;code&gt;</span>
<a name="l6687"><span class="linenum">6687</span></a>  <span class="comment"> * echo '&lt;strong&gt;';</span>
<a name="l6688"><span class="linenum">6688</span></a>  <span class="comment"> * print_string('course');</span>
<a name="l6689"><span class="linenum">6689</span></a>  <span class="comment"> * echo '&lt;/strong&gt;';</span>
<a name="l6690"><span class="linenum">6690</span></a>  <span class="comment"> * &lt;/code&gt;</span>
<a name="l6691"><span class="linenum">6691</span></a>  <span class="comment"> *</span>
<a name="l6692"><span class="linenum">6692</span></a>  <span class="comment"> * Example usage of this function when the string is not in the moodle.php file:&lt;br/&gt;</span>
<a name="l6693"><span class="linenum">6693</span></a>  <span class="comment"> * &lt;code&gt;</span>
<a name="l6694"><span class="linenum">6694</span></a>  <span class="comment"> * echo '&lt;h1&gt;';</span>
<a name="l6695"><span class="linenum">6695</span></a>  <span class="comment"> * print_string('typecourse', 'calendar');</span>
<a name="l6696"><span class="linenum">6696</span></a>  <span class="comment"> * echo '&lt;/h1&gt;';</span>
<a name="l6697"><span class="linenum">6697</span></a>  <span class="comment"> * &lt;/code&gt;</span>
<a name="l6698"><span class="linenum">6698</span></a>  <span class="comment"> *</span>
<a name="l6699"><span class="linenum">6699</span></a>  <span class="comment"> * @category string</span>
<a name="l6700"><span class="linenum">6700</span></a>  <span class="comment"> * @param string $identifier The key identifier for the localized string</span>
<a name="l6701"><span class="linenum">6701</span></a>  <span class="comment"> * @param string $component The module where the key identifier is stored. If none is specified then moodle.php is used.</span>
<a name="l6702"><span class="linenum">6702</span></a>  <span class="comment"> * @param string|object|array $a An object, string or number that can be used within translation strings</span>
<a name="l6703"><span class="linenum">6703</span></a>  <span class="comment"> */</span>
<a name="l6704"><span class="linenum">6704</span></a>  function <a class="function" onClick="logFunction('print_string')" href="../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>(<a class="var it1139" onMouseOver="hilite(1139)" onMouseOut="lolite()" onClick="logVariable('identifier')" href="../_variables/identifier.html">$identifier</a>, <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a> = '', <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a> = null) {
<a name="l6705"><span class="linenum">6705</span></a>      echo <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(<a class="var it1139" onMouseOver="hilite(1139)" onMouseOut="lolite()" onClick="logVariable('identifier')" href="../_variables/identifier.html">$identifier</a>, <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a>, <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>);
<a name="l6706"><span class="linenum">6706</span></a>  }
<a name="l6707"><span class="linenum">6707</span></a>  
<a name="l6708"><span class="linenum">6708</span></a>  <span class="comment">/**</span>
<a name="l6709"><span class="linenum">6709</span></a>  <span class="comment"> * Returns a list of charset codes</span>
<a name="l6710"><span class="linenum">6710</span></a>  <span class="comment"> *</span>
<a name="l6711"><span class="linenum">6711</span></a>  <span class="comment"> * Returns a list of charset codes. It's hardcoded, so they should be added manually</span>
<a name="l6712"><span class="linenum">6712</span></a>  <span class="comment"> * (checking that such charset is supported by the texlib library!)</span>
<a name="l6713"><span class="linenum">6713</span></a>  <span class="comment"> *</span>
<a name="l6714"><span class="linenum">6714</span></a>  <span class="comment"> * @return array And associative array with contents in the form of charset =&gt; charset</span>
<a name="l6715"><span class="linenum">6715</span></a>  <span class="comment"> */</span>
<a name="l6716"><span class="linenum">6716</span></a>  function <a class="function" onClick="logFunction('get_list_of_charsets')" href="../_functions/get_list_of_charsets.html" onMouseOver="funcPopup(event,'get_list_of_charsets')">get_list_of_charsets</a>() {
<a name="l6717"><span class="linenum">6717</span></a>  
<a name="l6718"><span class="linenum">6718</span></a>      <a class="var it4138" onMouseOver="hilite(4138)" onMouseOut="lolite()" onClick="logVariable('charsets')" href="../_variables/charsets.html">$charsets</a> = array(
<a name="l6719"><span class="linenum">6719</span></a>          'EUC-JP'     =&gt; 'EUC-JP',
<a name="l6720"><span class="linenum">6720</span></a>          'ISO-2022-JP'=&gt; 'ISO-2022-JP',
<a name="l6721"><span class="linenum">6721</span></a>          'ISO-8859-1' =&gt; 'ISO-8859-1',
<a name="l6722"><span class="linenum">6722</span></a>          'SHIFT-JIS'  =&gt; 'SHIFT-JIS',
<a name="l6723"><span class="linenum">6723</span></a>          'GB2312'     =&gt; 'GB2312',
<a name="l6724"><span class="linenum">6724</span></a>          'GB18030'    =&gt; 'GB18030', // GB18030 not supported by typo and mbstring.
<a name="l6725"><span class="linenum">6725</span></a>          'UTF-8'      =&gt; 'UTF-8');
<a name="l6726"><span class="linenum">6726</span></a>  
<a name="l6727"><span class="linenum">6727</span></a>      <a class="phpfunction" onClick="logFunction('asort')" href="../_functions/asort.html" onMouseOver="phpfuncPopup(event,'asort')">asort</a>(<a class="var it4138" onMouseOver="hilite(4138)" onMouseOut="lolite()" onClick="logVariable('charsets')" href="../_variables/charsets.html">$charsets</a>);
<a name="l6728"><span class="linenum">6728</span></a>  
<a name="l6729"><span class="linenum">6729</span></a>      return <a class="var it4138" onMouseOver="hilite(4138)" onMouseOut="lolite()" onClick="logVariable('charsets')" href="../_variables/charsets.html">$charsets</a>;
<a name="l6730"><span class="linenum">6730</span></a>  }
<a name="l6731"><span class="linenum">6731</span></a>  
<a name="l6732"><span class="linenum">6732</span></a>  <span class="comment">/**</span>
<a name="l6733"><span class="linenum">6733</span></a>  <span class="comment"> * Returns a list of valid and compatible themes</span>
<a name="l6734"><span class="linenum">6734</span></a>  <span class="comment"> *</span>
<a name="l6735"><span class="linenum">6735</span></a>  <span class="comment"> * @return array</span>
<a name="l6736"><span class="linenum">6736</span></a>  <span class="comment"> */</span>
<a name="l6737"><span class="linenum">6737</span></a>  function <a class="function" onClick="logFunction('get_list_of_themes')" href="../_functions/get_list_of_themes.html" onMouseOver="funcPopup(event,'get_list_of_themes')">get_list_of_themes</a>() {
<a name="l6738"><span class="linenum">6738</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l6739"><span class="linenum">6739</span></a>  
<a name="l6740"><span class="linenum">6740</span></a>      <a class="var it1187" onMouseOver="hilite(1187)" onMouseOut="lolite()" onClick="logVariable('themes')" href="../_variables/themes.html">$themes</a> = array();
<a name="l6741"><span class="linenum">6741</span></a>  
<a name="l6742"><span class="linenum">6742</span></a>      if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('themelist')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/themelist.html">themelist</a>)) {       // Use admin's list of themes.
<a name="l6743"><span class="linenum">6743</span></a>          <a class="var it13136" onMouseOver="hilite(13136)" onMouseOut="lolite()" onClick="logVariable('themelist')" href="../_variables/themelist.html">$themelist</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(',', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('themelist')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/themelist.html">themelist</a>);
<a name="l6744"><span class="linenum">6744</span></a>      } else {
<a name="l6745"><span class="linenum">6745</span></a>          <a class="var it13136" onMouseOver="hilite(13136)" onMouseOut="lolite()" onClick="logVariable('themelist')" href="../_variables/themelist.html">$themelist</a> = <a class="phpfunction" onClick="logFunction('array_keys')" href="../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="class" onClick="logClass('core_component')" href="../_classes/core_component.html" onMouseOver="classPopup(event,'core_component')">core_component</a>::<a class="function" onClick="logFunction('get_plugin_list')" href="../_functions/get_plugin_list.html" onMouseOver="funcPopup(event,'get_plugin_list')">get_plugin_list</a>(&quot;theme&quot;));
<a name="l6746"><span class="linenum">6746</span></a>      }
<a name="l6747"><span class="linenum">6747</span></a>  
<a name="l6748"><span class="linenum">6748</span></a>      foreach (<a class="var it13136" onMouseOver="hilite(13136)" onMouseOut="lolite()" onClick="logVariable('themelist')" href="../_variables/themelist.html">$themelist</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it1112" onMouseOver="hilite(1112)" onMouseOut="lolite()" onClick="logVariable('themename')" href="../_variables/themename.html">$themename</a>) {
<a name="l6749"><span class="linenum">6749</span></a>          <a class="var it1114" onMouseOver="hilite(1114)" onMouseOut="lolite()" onClick="logVariable('theme')" href="../_variables/theme.html">$theme</a> = <a class="class" onClick="logClass('theme_config')" href="../_classes/theme_config.html" onMouseOver="classPopup(event,'theme_config')">theme_config</a>::<a class="function" onClick="logFunction('load')" href="../_functions/load.html" onMouseOver="funcPopup(event,'load')">load</a>(<a class="var it1112" onMouseOver="hilite(1112)" onMouseOut="lolite()" onClick="logVariable('themename')" href="../_variables/themename.html">$themename</a>);
<a name="l6750"><span class="linenum">6750</span></a>          <a class="var it1187" onMouseOver="hilite(1187)" onMouseOut="lolite()" onClick="logVariable('themes')" href="../_variables/themes.html">$themes</a>[<a class="var it1112" onMouseOver="hilite(1112)" onMouseOut="lolite()" onClick="logVariable('themename')" href="../_variables/themename.html">$themename</a>] = <a class="var it1114" onMouseOver="hilite(1114)" onMouseOut="lolite()" onClick="logVariable('theme')" href="../_variables/theme.html">$theme</a>;
<a name="l6751"><span class="linenum">6751</span></a>      }
<a name="l6752"><span class="linenum">6752</span></a>  
<a name="l6753"><span class="linenum">6753</span></a>      <a class="class" onClick="logClass('core_collator')" href="../_classes/core_collator.html" onMouseOver="classPopup(event,'core_collator')">core_collator</a>::<a class="function" onClick="logFunction('asort_objects_by_method')" href="../_functions/asort_objects_by_method.html" onMouseOver="funcPopup(event,'asort_objects_by_method')">asort_objects_by_method</a>(<a class="var it1187" onMouseOver="hilite(1187)" onMouseOut="lolite()" onClick="logVariable('themes')" href="../_variables/themes.html">$themes</a>, 'get_theme_name');
<a name="l6754"><span class="linenum">6754</span></a>  
<a name="l6755"><span class="linenum">6755</span></a>      return <a class="var it1187" onMouseOver="hilite(1187)" onMouseOut="lolite()" onClick="logVariable('themes')" href="../_variables/themes.html">$themes</a>;
<a name="l6756"><span class="linenum">6756</span></a>  }
<a name="l6757"><span class="linenum">6757</span></a>  
<a name="l6758"><span class="linenum">6758</span></a>  <span class="comment">/**</span>
<a name="l6759"><span class="linenum">6759</span></a>  <span class="comment"> * Factory function for emoticon_manager</span>
<a name="l6760"><span class="linenum">6760</span></a>  <span class="comment"> *</span>
<a name="l6761"><span class="linenum">6761</span></a>  <span class="comment"> * @return emoticon_manager singleton</span>
<a name="l6762"><span class="linenum">6762</span></a>  <span class="comment"> */</span>
<a name="l6763"><span class="linenum">6763</span></a>  function <a class="function" onClick="logFunction('get_emoticon_manager')" href="../_functions/get_emoticon_manager.html" onMouseOver="funcPopup(event,'get_emoticon_manager')">get_emoticon_manager</a>() {
<a name="l6764"><span class="linenum">6764</span></a>      static <a class="var it7858" onMouseOver="hilite(7858)" onMouseOut="lolite()" onClick="logVariable('singleton')" href="../_variables/singleton.html">$singleton</a> = null;
<a name="l6765"><span class="linenum">6765</span></a>  
<a name="l6766"><span class="linenum">6766</span></a>      if (<a class="phpfunction" onClick="logFunction('is_null')" href="../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it7858" onMouseOver="hilite(7858)" onMouseOut="lolite()" onClick="logVariable('singleton')" href="../_variables/singleton.html">$singleton</a>)) {
<a name="l6767"><span class="linenum">6767</span></a>          <a class="var it7858" onMouseOver="hilite(7858)" onMouseOut="lolite()" onClick="logVariable('singleton')" href="../_variables/singleton.html">$singleton</a> = <span class="keyword">new </span><a class="class" onClick="logClass('emoticon_manager')" href="../_classes/emoticon_manager.html" onMouseOver="classPopup(event,'emoticon_manager')">emoticon_manager</a>();
<a name="l6768"><span class="linenum">6768</span></a>      }
<a name="l6769"><span class="linenum">6769</span></a>  
<a name="l6770"><span class="linenum">6770</span></a>      return <a class="var it7858" onMouseOver="hilite(7858)" onMouseOut="lolite()" onClick="logVariable('singleton')" href="../_variables/singleton.html">$singleton</a>;
<a name="l6771"><span class="linenum">6771</span></a>  }
<a name="l6772"><span class="linenum">6772</span></a>  
<a name="l6773"><span class="linenum">6773</span></a>  <span class="comment">/**</span>
<a name="l6774"><span class="linenum">6774</span></a>  <span class="comment"> * Provides core support for plugins that have to deal with emoticons (like HTML editor or emoticon filter).</span>
<a name="l6775"><span class="linenum">6775</span></a>  <span class="comment"> *</span>
<a name="l6776"><span class="linenum">6776</span></a>  <span class="comment"> * Whenever this manager mentiones 'emoticon object', the following data</span>
<a name="l6777"><span class="linenum">6777</span></a>  <span class="comment"> * structure is expected: stdClass with properties text, imagename, imagecomponent,</span>
<a name="l6778"><span class="linenum">6778</span></a>  <span class="comment"> * altidentifier and altcomponent</span>
<a name="l6779"><span class="linenum">6779</span></a>  <span class="comment"> *</span>
<a name="l6780"><span class="linenum">6780</span></a>  <span class="comment"> * @see admin_setting_emoticons</span>
<a name="l6781"><span class="linenum">6781</span></a>  <span class="comment"> *</span>
<a name="l6782"><span class="linenum">6782</span></a>  <span class="comment"> * @copyright 2010 David Mudrak</span>
<a name="l6783"><span class="linenum">6783</span></a>  <span class="comment"> * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l6784"><span class="linenum">6784</span></a>  <span class="comment"> */</span>
<a name="l6785"><span class="linenum">6785</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('emoticon_manager')" href="../_classes/emoticon_manager.html" onMouseOver="classPopup(event,'emoticon_manager')">emoticon_manager</a> {
<a name="l6786"><span class="linenum">6786</span></a>  
<a name="l6787"><span class="linenum">6787</span></a>      <span class="comment">/**</span>
<a name="l6788"><span class="linenum">6788</span></a>  <span class="comment">     * Returns the currently enabled emoticons</span>
<a name="l6789"><span class="linenum">6789</span></a>  <span class="comment">     *</span>
<a name="l6790"><span class="linenum">6790</span></a>  <span class="comment">     * @return array of emoticon objects</span>
<a name="l6791"><span class="linenum">6791</span></a>  <span class="comment">     */</span>
<a name="l6792"><span class="linenum">6792</span></a>      public function <a class="function" onClick="logFunction('get_emoticons')" href="../_functions/get_emoticons.html" onMouseOver="funcPopup(event,'get_emoticons')">get_emoticons</a>() {
<a name="l6793"><span class="linenum">6793</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l6794"><span class="linenum">6794</span></a>  
<a name="l6795"><span class="linenum">6795</span></a>          if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('emoticons')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/emoticons.html">emoticons</a>)) {
<a name="l6796"><span class="linenum">6796</span></a>              return array();
<a name="l6797"><span class="linenum">6797</span></a>          }
<a name="l6798"><span class="linenum">6798</span></a>  
<a name="l6799"><span class="linenum">6799</span></a>          <a class="var it13137" onMouseOver="hilite(13137)" onMouseOut="lolite()" onClick="logVariable('emoticons')" href="../_variables/emoticons.html">$emoticons</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('decode_stored_config')" href="../_functions/decode_stored_config.html" onMouseOver="funcPopup(event,'decode_stored_config')">decode_stored_config</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('emoticons')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/emoticons.html">emoticons</a>);
<a name="l6800"><span class="linenum">6800</span></a>  
<a name="l6801"><span class="linenum">6801</span></a>          if (!<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it13137" onMouseOver="hilite(13137)" onMouseOut="lolite()" onClick="logVariable('emoticons')" href="../_variables/emoticons.html">$emoticons</a>)) {
<a name="l6802"><span class="linenum">6802</span></a>  <span class="comment">            // Something is wrong with the format of stored setting.</span>
<a name="l6803"><span class="linenum">6803</span></a>              <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Invalid format of emoticons setting, please resave the emoticons settings form', <a class="constant" onClick="logConstant('DEBUG_NORMAL')" href="../_constants/DEBUG_NORMAL.html" onMouseOver="constPopup(event,'DEBUG_NORMAL')">DEBUG_NORMAL</a>);
<a name="l6804"><span class="linenum">6804</span></a>              return array();
<a name="l6805"><span class="linenum">6805</span></a>          }
<a name="l6806"><span class="linenum">6806</span></a>  
<a name="l6807"><span class="linenum">6807</span></a>          return <a class="var it13137" onMouseOver="hilite(13137)" onMouseOut="lolite()" onClick="logVariable('emoticons')" href="../_variables/emoticons.html">$emoticons</a>;
<a name="l6808"><span class="linenum">6808</span></a>      }
<a name="l6809"><span class="linenum">6809</span></a>  
<a name="l6810"><span class="linenum">6810</span></a>      <span class="comment">/**</span>
<a name="l6811"><span class="linenum">6811</span></a>  <span class="comment">     * Converts emoticon object into renderable pix_emoticon object</span>
<a name="l6812"><span class="linenum">6812</span></a>  <span class="comment">     *</span>
<a name="l6813"><span class="linenum">6813</span></a>  <span class="comment">     * @param stdClass $emoticon emoticon object</span>
<a name="l6814"><span class="linenum">6814</span></a>  <span class="comment">     * @param array $attributes explicit HTML attributes to set</span>
<a name="l6815"><span class="linenum">6815</span></a>  <span class="comment">     * @return pix_emoticon</span>
<a name="l6816"><span class="linenum">6816</span></a>  <span class="comment">     */</span>
<a name="l6817"><span class="linenum">6817</span></a>      public function <a class="function" onClick="logFunction('prepare_renderable_emoticon')" href="../_functions/prepare_renderable_emoticon.html" onMouseOver="funcPopup(event,'prepare_renderable_emoticon')">prepare_renderable_emoticon</a>(stdClass <a class="var it13138" onMouseOver="hilite(13138)" onMouseOut="lolite()" onClick="logVariable('emoticon')" href="../_variables/emoticon.html">$emoticon</a>, array <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('attributes')" href="../_variables/attributes.html">$attributes</a> = array()) {
<a name="l6818"><span class="linenum">6818</span></a>          <a class="var it2233" onMouseOver="hilite(2233)" onMouseOut="lolite()" onClick="logVariable('stringmanager')" href="../_variables/stringmanager.html">$stringmanager</a> = <a class="function" onClick="logFunction('get_string_manager')" href="../_functions/get_string_manager.html" onMouseOver="funcPopup(event,'get_string_manager')">get_string_manager</a>();
<a name="l6819"><span class="linenum">6819</span></a>          if (<a class="var it2233" onMouseOver="hilite(2233)" onMouseOut="lolite()" onClick="logVariable('stringmanager')" href="../_variables/stringmanager.html">$stringmanager</a>-&gt;<a class="function" onClick="logFunction('string_exists')" href="../_functions/string_exists.html" onMouseOver="funcPopup(event,'string_exists')">string_exists</a>(<a class="var it13138" onMouseOver="hilite(13138)" onMouseOut="lolite()" onClick="logVariable('emoticon')" href="../_variables/emoticon.html">$emoticon</a>-&gt;<a onClick="logVariable('altidentifier')" class="var it40994" onMouseOver="hilite(40994)" onMouseOut="lolite()" href="../_variables/altidentifier.html">altidentifier</a>, <a class="var it13138" onMouseOver="hilite(13138)" onMouseOut="lolite()" onClick="logVariable('emoticon')" href="../_variables/emoticon.html">$emoticon</a>-&gt;<a onClick="logVariable('altcomponent')" class="var it40994" onMouseOver="hilite(40994)" onMouseOut="lolite()" href="../_variables/altcomponent.html">altcomponent</a>)) {
<a name="l6820"><span class="linenum">6820</span></a>              <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('alt')" href="../_variables/alt.html">$alt</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(<a class="var it13138" onMouseOver="hilite(13138)" onMouseOut="lolite()" onClick="logVariable('emoticon')" href="../_variables/emoticon.html">$emoticon</a>-&gt;<a onClick="logVariable('altidentifier')" class="var it40994" onMouseOver="hilite(40994)" onMouseOut="lolite()" href="../_variables/altidentifier.html">altidentifier</a>, <a class="var it13138" onMouseOver="hilite(13138)" onMouseOut="lolite()" onClick="logVariable('emoticon')" href="../_variables/emoticon.html">$emoticon</a>-&gt;<a onClick="logVariable('altcomponent')" class="var it40994" onMouseOver="hilite(40994)" onMouseOut="lolite()" href="../_variables/altcomponent.html">altcomponent</a>);
<a name="l6821"><span class="linenum">6821</span></a>          } else {
<a name="l6822"><span class="linenum">6822</span></a>              <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('alt')" href="../_variables/alt.html">$alt</a> = <a class="function" onClick="logFunction('s')" href="../_functions/s.html" onMouseOver="funcPopup(event,'s')">s</a>(<a class="var it13138" onMouseOver="hilite(13138)" onMouseOut="lolite()" onClick="logVariable('emoticon')" href="../_variables/emoticon.html">$emoticon</a>-&gt;<a onClick="logVariable('text')" class="var it40994" onMouseOver="hilite(40994)" onMouseOut="lolite()" href="../_variables/text.html">text</a>);
<a name="l6823"><span class="linenum">6823</span></a>          }
<a name="l6824"><span class="linenum">6824</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('pix_emoticon')" href="../_classes/pix_emoticon.html" onMouseOver="classPopup(event,'pix_emoticon')">pix_emoticon</a>(<a class="var it13138" onMouseOver="hilite(13138)" onMouseOut="lolite()" onClick="logVariable('emoticon')" href="../_variables/emoticon.html">$emoticon</a>-&gt;<a onClick="logVariable('imagename')" class="var it40994" onMouseOver="hilite(40994)" onMouseOut="lolite()" href="../_variables/imagename.html">imagename</a>, <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('alt')" href="../_variables/alt.html">$alt</a>, <a class="var it13138" onMouseOver="hilite(13138)" onMouseOut="lolite()" onClick="logVariable('emoticon')" href="../_variables/emoticon.html">$emoticon</a>-&gt;<a onClick="logVariable('imagecomponent')" class="var it40994" onMouseOver="hilite(40994)" onMouseOut="lolite()" href="../_variables/imagecomponent.html">imagecomponent</a>, <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('attributes')" href="../_variables/attributes.html">$attributes</a>);
<a name="l6825"><span class="linenum">6825</span></a>      }
<a name="l6826"><span class="linenum">6826</span></a>  
<a name="l6827"><span class="linenum">6827</span></a>      <span class="comment">/**</span>
<a name="l6828"><span class="linenum">6828</span></a>  <span class="comment">     * Encodes the array of emoticon objects into a string storable in config table</span>
<a name="l6829"><span class="linenum">6829</span></a>  <span class="comment">     *</span>
<a name="l6830"><span class="linenum">6830</span></a>  <span class="comment">     * @see self::decode_stored_config()</span>
<a name="l6831"><span class="linenum">6831</span></a>  <span class="comment">     * @param array $emoticons array of emtocion objects</span>
<a name="l6832"><span class="linenum">6832</span></a>  <span class="comment">     * @return string</span>
<a name="l6833"><span class="linenum">6833</span></a>  <span class="comment">     */</span>
<a name="l6834"><span class="linenum">6834</span></a>      public function <a class="function" onClick="logFunction('encode_stored_config')" href="../_functions/encode_stored_config.html" onMouseOver="funcPopup(event,'encode_stored_config')">encode_stored_config</a>(array <a class="var it13137" onMouseOver="hilite(13137)" onMouseOut="lolite()" onClick="logVariable('emoticons')" href="../_variables/emoticons.html">$emoticons</a>) {
<a name="l6835"><span class="linenum">6835</span></a>          return <a class="function" onClick="logFunction('json_encode')" href="../_functions/json_encode.html" onMouseOver="funcPopup(event,'json_encode')">json_encode</a>(<a class="var it13137" onMouseOver="hilite(13137)" onMouseOut="lolite()" onClick="logVariable('emoticons')" href="../_variables/emoticons.html">$emoticons</a>);
<a name="l6836"><span class="linenum">6836</span></a>      }
<a name="l6837"><span class="linenum">6837</span></a>  
<a name="l6838"><span class="linenum">6838</span></a>      <span class="comment">/**</span>
<a name="l6839"><span class="linenum">6839</span></a>  <span class="comment">     * Decodes the string into an array of emoticon objects</span>
<a name="l6840"><span class="linenum">6840</span></a>  <span class="comment">     *</span>
<a name="l6841"><span class="linenum">6841</span></a>  <span class="comment">     * @see self::encode_stored_config()</span>
<a name="l6842"><span class="linenum">6842</span></a>  <span class="comment">     * @param string $encoded</span>
<a name="l6843"><span class="linenum">6843</span></a>  <span class="comment">     * @return string|null</span>
<a name="l6844"><span class="linenum">6844</span></a>  <span class="comment">     */</span>
<a name="l6845"><span class="linenum">6845</span></a>      public function <a class="function" onClick="logFunction('decode_stored_config')" href="../_functions/decode_stored_config.html" onMouseOver="funcPopup(event,'decode_stored_config')">decode_stored_config</a>(<a class="var it1124" onMouseOver="hilite(1124)" onMouseOut="lolite()" onClick="logVariable('encoded')" href="../_variables/encoded.html">$encoded</a>) {
<a name="l6846"><span class="linenum">6846</span></a>          <a class="var it7405" onMouseOver="hilite(7405)" onMouseOut="lolite()" onClick="logVariable('decoded')" href="../_variables/decoded.html">$decoded</a> = json_decode(<a class="var it1124" onMouseOver="hilite(1124)" onMouseOut="lolite()" onClick="logVariable('encoded')" href="../_variables/encoded.html">$encoded</a>);
<a name="l6847"><span class="linenum">6847</span></a>          if (!<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it7405" onMouseOver="hilite(7405)" onMouseOut="lolite()" onClick="logVariable('decoded')" href="../_variables/decoded.html">$decoded</a>)) {
<a name="l6848"><span class="linenum">6848</span></a>              return null;
<a name="l6849"><span class="linenum">6849</span></a>          }
<a name="l6850"><span class="linenum">6850</span></a>          return <a class="var it7405" onMouseOver="hilite(7405)" onMouseOut="lolite()" onClick="logVariable('decoded')" href="../_variables/decoded.html">$decoded</a>;
<a name="l6851"><span class="linenum">6851</span></a>      }
<a name="l6852"><span class="linenum">6852</span></a>  
<a name="l6853"><span class="linenum">6853</span></a>      <span class="comment">/**</span>
<a name="l6854"><span class="linenum">6854</span></a>  <span class="comment">     * Returns default set of emoticons supported by Moodle</span>
<a name="l6855"><span class="linenum">6855</span></a>  <span class="comment">     *</span>
<a name="l6856"><span class="linenum">6856</span></a>  <span class="comment">     * @return array of sdtClasses</span>
<a name="l6857"><span class="linenum">6857</span></a>  <span class="comment">     */</span>
<a name="l6858"><span class="linenum">6858</span></a>      public function <a class="function" onClick="logFunction('default_emoticons')" href="../_functions/default_emoticons.html" onMouseOver="funcPopup(event,'default_emoticons')">default_emoticons</a>() {
<a name="l6859"><span class="linenum">6859</span></a>          return array(
<a name="l6860"><span class="linenum">6860</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;:-)&quot;, 's/smiley', 'smiley'),
<a name="l6861"><span class="linenum">6861</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;:)&quot;, 's/smiley', 'smiley'),
<a name="l6862"><span class="linenum">6862</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;:-D&quot;, 's/biggrin', 'biggrin'),
<a name="l6863"><span class="linenum">6863</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;;-)&quot;, 's/wink', 'wink'),
<a name="l6864"><span class="linenum">6864</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;:-/&quot;, 's/mixed', 'mixed'),
<a name="l6865"><span class="linenum">6865</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;V-.&quot;, 's/thoughtful', 'thoughtful'),
<a name="l6866"><span class="linenum">6866</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;:-P&quot;, 's/tongueout', 'tongueout'),
<a name="l6867"><span class="linenum">6867</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;:-p&quot;, 's/tongueout', 'tongueout'),
<a name="l6868"><span class="linenum">6868</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;B-)&quot;, 's/cool', 'cool'),
<a name="l6869"><span class="linenum">6869</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;^-)&quot;, 's/approve', 'approve'),
<a name="l6870"><span class="linenum">6870</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;8-)&quot;, 's/wideeyes', 'wideeyes'),
<a name="l6871"><span class="linenum">6871</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;:o)&quot;, 's/clown', 'clown'),
<a name="l6872"><span class="linenum">6872</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;:-(&quot;, 's/sad', 'sad'),
<a name="l6873"><span class="linenum">6873</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;:(&quot;, 's/sad', 'sad'),
<a name="l6874"><span class="linenum">6874</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;8-.&quot;, 's/shy', 'shy'),
<a name="l6875"><span class="linenum">6875</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;:-I&quot;, 's/blush', 'blush'),
<a name="l6876"><span class="linenum">6876</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;:-X&quot;, 's/kiss', 'kiss'),
<a name="l6877"><span class="linenum">6877</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;8-o&quot;, 's/surprise', 'surprise'),
<a name="l6878"><span class="linenum">6878</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;P-|&quot;, 's/blackeye', 'blackeye'),
<a name="l6879"><span class="linenum">6879</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;8-[&quot;, 's/angry', 'angry'),
<a name="l6880"><span class="linenum">6880</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;(grr)&quot;, 's/angry', 'angry'),
<a name="l6881"><span class="linenum">6881</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;xx-P&quot;, 's/dead', 'dead'),
<a name="l6882"><span class="linenum">6882</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;|-.&quot;, 's/sleepy', 'sleepy'),
<a name="l6883"><span class="linenum">6883</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;}-]&quot;, 's/evil', 'evil'),
<a name="l6884"><span class="linenum">6884</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;(h)&quot;, 's/heart', 'heart'),
<a name="l6885"><span class="linenum">6885</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;(heart)&quot;, 's/heart', 'heart'),
<a name="l6886"><span class="linenum">6886</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;(y)&quot;, 's/yes', 'yes', 'core'),
<a name="l6887"><span class="linenum">6887</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;(n)&quot;, 's/no', 'no', 'core'),
<a name="l6888"><span class="linenum">6888</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;(martin)&quot;, 's/martin', 'martin'),
<a name="l6889"><span class="linenum">6889</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(&quot;( )&quot;, 's/egg', 'egg'),
<a name="l6890"><span class="linenum">6890</span></a>          );
<a name="l6891"><span class="linenum">6891</span></a>      }
<a name="l6892"><span class="linenum">6892</span></a>  
<a name="l6893"><span class="linenum">6893</span></a>      <span class="comment">/**</span>
<a name="l6894"><span class="linenum">6894</span></a>  <span class="comment">     * Helper method preparing the stdClass with the emoticon properties</span>
<a name="l6895"><span class="linenum">6895</span></a>  <span class="comment">     *</span>
<a name="l6896"><span class="linenum">6896</span></a>  <span class="comment">     * @param string|array $text or array of strings</span>
<a name="l6897"><span class="linenum">6897</span></a>  <span class="comment">     * @param string $imagename to be used by {@link pix_emoticon}</span>
<a name="l6898"><span class="linenum">6898</span></a>  <span class="comment">     * @param string $altidentifier alternative string identifier, null for no alt</span>
<a name="l6899"><span class="linenum">6899</span></a>  <span class="comment">     * @param string $altcomponent where the alternative string is defined</span>
<a name="l6900"><span class="linenum">6900</span></a>  <span class="comment">     * @param string $imagecomponent to be used by {@link pix_emoticon}</span>
<a name="l6901"><span class="linenum">6901</span></a>  <span class="comment">     * @return stdClass</span>
<a name="l6902"><span class="linenum">6902</span></a>  <span class="comment">     */</span>
<a name="l6903"><span class="linenum">6903</span></a>      protected function <a class="function" onClick="logFunction('prepare_emoticon_object')" href="../_functions/prepare_emoticon_object.html" onMouseOver="funcPopup(event,'prepare_emoticon_object')">prepare_emoticon_object</a>(<a class="var it72" onMouseOver="hilite(72)" onMouseOut="lolite()" onClick="logVariable('text')" href="../_variables/text.html">$text</a>, <a class="var it1167" onMouseOver="hilite(1167)" onMouseOut="lolite()" onClick="logVariable('imagename')" href="../_variables/imagename.html">$imagename</a>, <a class="var it9970" onMouseOver="hilite(9970)" onMouseOut="lolite()" onClick="logVariable('altidentifier')" href="../_variables/altidentifier.html">$altidentifier</a> = null,
<a name="l6904"><span class="linenum">6904</span></a>                                                 <a class="var it9971" onMouseOver="hilite(9971)" onMouseOut="lolite()" onClick="logVariable('altcomponent')" href="../_variables/altcomponent.html">$altcomponent</a> = 'core_pix', <a class="var it13139" onMouseOver="hilite(13139)" onMouseOut="lolite()" onClick="logVariable('imagecomponent')" href="../_variables/imagecomponent.html">$imagecomponent</a> = 'core') {
<a name="l6905"><span class="linenum">6905</span></a>          return (object)array(
<a name="l6906"><span class="linenum">6906</span></a>              'text'           =&gt; <a class="var it72" onMouseOver="hilite(72)" onMouseOut="lolite()" onClick="logVariable('text')" href="../_variables/text.html">$text</a>,
<a name="l6907"><span class="linenum">6907</span></a>              'imagename'      =&gt; <a class="var it1167" onMouseOver="hilite(1167)" onMouseOut="lolite()" onClick="logVariable('imagename')" href="../_variables/imagename.html">$imagename</a>,
<a name="l6908"><span class="linenum">6908</span></a>              'imagecomponent' =&gt; <a class="var it13139" onMouseOver="hilite(13139)" onMouseOut="lolite()" onClick="logVariable('imagecomponent')" href="../_variables/imagecomponent.html">$imagecomponent</a>,
<a name="l6909"><span class="linenum">6909</span></a>              'altidentifier'  =&gt; <a class="var it9970" onMouseOver="hilite(9970)" onMouseOut="lolite()" onClick="logVariable('altidentifier')" href="../_variables/altidentifier.html">$altidentifier</a>,
<a name="l6910"><span class="linenum">6910</span></a>              'altcomponent'   =&gt; <a class="var it9971" onMouseOver="hilite(9971)" onMouseOut="lolite()" onClick="logVariable('altcomponent')" href="../_variables/altcomponent.html">$altcomponent</a>,
<a name="l6911"><span class="linenum">6911</span></a>          );
<a name="l6912"><span class="linenum">6912</span></a>      }
<a name="l6913"><span class="linenum">6913</span></a>  }
<a name="l6914"><span class="linenum">6914</span></a>  
<a name="l6915"><span class="linenum">6915</span></a>  <span class="comment">// ENCRYPTION.</span>
<a name="l6916"><span class="linenum">6916</span></a>  
<a name="l6917"><span class="linenum">6917</span></a>  <span class="comment">/**</span>
<a name="l6918"><span class="linenum">6918</span></a>  <span class="comment"> * rc4encrypt</span>
<a name="l6919"><span class="linenum">6919</span></a>  <span class="comment"> *</span>
<a name="l6920"><span class="linenum">6920</span></a>  <span class="comment"> * @param string $data        Data to encrypt.</span>
<a name="l6921"><span class="linenum">6921</span></a>  <span class="comment"> * @return string             The now encrypted data.</span>
<a name="l6922"><span class="linenum">6922</span></a>  <span class="comment"> */</span>
<a name="l6923"><span class="linenum">6923</span></a>  function <a class="function" onClick="logFunction('rc4encrypt')" href="../_functions/rc4encrypt.html" onMouseOver="funcPopup(event,'rc4encrypt')">rc4encrypt</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>) {
<a name="l6924"><span class="linenum">6924</span></a>      return <a class="function" onClick="logFunction('endecrypt')" href="../_functions/endecrypt.html" onMouseOver="funcPopup(event,'endecrypt')">endecrypt</a>(<a class="function" onClick="logFunction('get_site_identifier')" href="../_functions/get_site_identifier.html" onMouseOver="funcPopup(event,'get_site_identifier')">get_site_identifier</a>(), <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>, '');
<a name="l6925"><span class="linenum">6925</span></a>  }
<a name="l6926"><span class="linenum">6926</span></a>  
<a name="l6927"><span class="linenum">6927</span></a>  <span class="comment">/**</span>
<a name="l6928"><span class="linenum">6928</span></a>  <span class="comment"> * rc4decrypt</span>
<a name="l6929"><span class="linenum">6929</span></a>  <span class="comment"> *</span>
<a name="l6930"><span class="linenum">6930</span></a>  <span class="comment"> * @param string $data        Data to decrypt.</span>
<a name="l6931"><span class="linenum">6931</span></a>  <span class="comment"> * @return string             The now decrypted data.</span>
<a name="l6932"><span class="linenum">6932</span></a>  <span class="comment"> */</span>
<a name="l6933"><span class="linenum">6933</span></a>  function <a class="function" onClick="logFunction('rc4decrypt')" href="../_functions/rc4decrypt.html" onMouseOver="funcPopup(event,'rc4decrypt')">rc4decrypt</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>) {
<a name="l6934"><span class="linenum">6934</span></a>      return <a class="function" onClick="logFunction('endecrypt')" href="../_functions/endecrypt.html" onMouseOver="funcPopup(event,'endecrypt')">endecrypt</a>(<a class="function" onClick="logFunction('get_site_identifier')" href="../_functions/get_site_identifier.html" onMouseOver="funcPopup(event,'get_site_identifier')">get_site_identifier</a>(), <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>, 'de');
<a name="l6935"><span class="linenum">6935</span></a>  }
<a name="l6936"><span class="linenum">6936</span></a>  
<a name="l6937"><span class="linenum">6937</span></a>  <span class="comment">/**</span>
<a name="l6938"><span class="linenum">6938</span></a>  <span class="comment"> * Based on a class by Mukul Sabharwal [mukulsabharwal @ yahoo.com]</span>
<a name="l6939"><span class="linenum">6939</span></a>  <span class="comment"> *</span>
<a name="l6940"><span class="linenum">6940</span></a>  <span class="comment"> * @todo Finish documenting this function</span>
<a name="l6941"><span class="linenum">6941</span></a>  <span class="comment"> *</span>
<a name="l6942"><span class="linenum">6942</span></a>  <span class="comment"> * @param string $pwd The password to use when encrypting or decrypting</span>
<a name="l6943"><span class="linenum">6943</span></a>  <span class="comment"> * @param string $data The data to be decrypted/encrypted</span>
<a name="l6944"><span class="linenum">6944</span></a>  <span class="comment"> * @param string $case Either 'de' for decrypt or '' for encrypt</span>
<a name="l6945"><span class="linenum">6945</span></a>  <span class="comment"> * @return string</span>
<a name="l6946"><span class="linenum">6946</span></a>  <span class="comment"> */</span>
<a name="l6947"><span class="linenum">6947</span></a>  function <a class="function" onClick="logFunction('endecrypt')" href="../_functions/endecrypt.html" onMouseOver="funcPopup(event,'endecrypt')">endecrypt</a> (<a class="var it13140" onMouseOver="hilite(13140)" onMouseOut="lolite()" onClick="logVariable('pwd')" href="../_variables/pwd.html">$pwd</a>, <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>, <a class="var it4228" onMouseOver="hilite(4228)" onMouseOut="lolite()" onClick="logVariable('case')" href="../_variables/case.html">$case</a>) {
<a name="l6948"><span class="linenum">6948</span></a>  
<a name="l6949"><span class="linenum">6949</span></a>      if (<a class="var it4228" onMouseOver="hilite(4228)" onMouseOut="lolite()" onClick="logVariable('case')" href="../_variables/case.html">$case</a> == 'de') {
<a name="l6950"><span class="linenum">6950</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a> = <a class="phpfunction" onClick="logFunction('urldecode')" href="../_functions/urldecode.html" onMouseOver="phpfuncPopup(event,'urldecode')">urldecode</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>);
<a name="l6951"><span class="linenum">6951</span></a>      }
<a name="l6952"><span class="linenum">6952</span></a>  
<a name="l6953"><span class="linenum">6953</span></a>      <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>[] = '';
<a name="l6954"><span class="linenum">6954</span></a>      <a class="var it11231" onMouseOver="hilite(11231)" onMouseOut="lolite()" onClick="logVariable('box')" href="../_variables/box.html">$box</a>[] = '';
<a name="l6955"><span class="linenum">6955</span></a>      <a class="var it13141" onMouseOver="hilite(13141)" onMouseOut="lolite()" onClick="logVariable('pwdlength')" href="../_variables/pwdlength.html">$pwdlength</a> = <a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it13140" onMouseOver="hilite(13140)" onMouseOut="lolite()" onClick="logVariable('pwd')" href="../_variables/pwd.html">$pwd</a>);
<a name="l6956"><span class="linenum">6956</span></a>  
<a name="l6957"><span class="linenum">6957</span></a>      for (<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> = 0; <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> &lt;= 255; <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>++) {
<a name="l6958"><span class="linenum">6958</span></a>          <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>[<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>] = <a class="phpfunction" onClick="logFunction('ord')" href="../_functions/ord.html" onMouseOver="phpfuncPopup(event,'ord')">ord</a>(<a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it13140" onMouseOver="hilite(13140)" onMouseOut="lolite()" onClick="logVariable('pwd')" href="../_variables/pwd.html">$pwd</a>, (<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> % <a class="var it13141" onMouseOver="hilite(13141)" onMouseOut="lolite()" onClick="logVariable('pwdlength')" href="../_variables/pwdlength.html">$pwdlength</a>), 1));
<a name="l6959"><span class="linenum">6959</span></a>          <a class="var it11231" onMouseOver="hilite(11231)" onMouseOut="lolite()" onClick="logVariable('box')" href="../_variables/box.html">$box</a>[<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>] = <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>;
<a name="l6960"><span class="linenum">6960</span></a>      }
<a name="l6961"><span class="linenum">6961</span></a>  
<a name="l6962"><span class="linenum">6962</span></a>      <a class="var it458" onMouseOver="hilite(458)" onMouseOut="lolite()" onClick="logVariable('x')" href="../_variables/x.html">$x</a> = 0;
<a name="l6963"><span class="linenum">6963</span></a>  
<a name="l6964"><span class="linenum">6964</span></a>      for (<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> = 0; <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> &lt;= 255; <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>++) {
<a name="l6965"><span class="linenum">6965</span></a>          <a class="var it458" onMouseOver="hilite(458)" onMouseOut="lolite()" onClick="logVariable('x')" href="../_variables/x.html">$x</a> = (<a class="var it458" onMouseOver="hilite(458)" onMouseOut="lolite()" onClick="logVariable('x')" href="../_variables/x.html">$x</a> + <a class="var it11231" onMouseOver="hilite(11231)" onMouseOut="lolite()" onClick="logVariable('box')" href="../_variables/box.html">$box</a>[<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>] + <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>[<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>]) % 256;
<a name="l6966"><span class="linenum">6966</span></a>          <a class="var it13142" onMouseOver="hilite(13142)" onMouseOut="lolite()" onClick="logVariable('tempswap')" href="../_variables/tempswap.html">$tempswap</a> = <a class="var it11231" onMouseOver="hilite(11231)" onMouseOut="lolite()" onClick="logVariable('box')" href="../_variables/box.html">$box</a>[<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>];
<a name="l6967"><span class="linenum">6967</span></a>          <a class="var it11231" onMouseOver="hilite(11231)" onMouseOut="lolite()" onClick="logVariable('box')" href="../_variables/box.html">$box</a>[<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>] = <a class="var it11231" onMouseOver="hilite(11231)" onMouseOut="lolite()" onClick="logVariable('box')" href="../_variables/box.html">$box</a>[<a class="var it458" onMouseOver="hilite(458)" onMouseOut="lolite()" onClick="logVariable('x')" href="../_variables/x.html">$x</a>];
<a name="l6968"><span class="linenum">6968</span></a>          <a class="var it11231" onMouseOver="hilite(11231)" onMouseOut="lolite()" onClick="logVariable('box')" href="../_variables/box.html">$box</a>[<a class="var it458" onMouseOver="hilite(458)" onMouseOut="lolite()" onClick="logVariable('x')" href="../_variables/x.html">$x</a>] = <a class="var it13142" onMouseOver="hilite(13142)" onMouseOut="lolite()" onClick="logVariable('tempswap')" href="../_variables/tempswap.html">$tempswap</a>;
<a name="l6969"><span class="linenum">6969</span></a>      }
<a name="l6970"><span class="linenum">6970</span></a>  
<a name="l6971"><span class="linenum">6971</span></a>      <a class="var it1755" onMouseOver="hilite(1755)" onMouseOut="lolite()" onClick="logVariable('cipher')" href="../_variables/cipher.html">$cipher</a> = '';
<a name="l6972"><span class="linenum">6972</span></a>  
<a name="l6973"><span class="linenum">6973</span></a>      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a> = 0;
<a name="l6974"><span class="linenum">6974</span></a>      <a class="var it84" onMouseOver="hilite(84)" onMouseOut="lolite()" onClick="logVariable('j')" href="../_variables/j.html">$j</a> = 0;
<a name="l6975"><span class="linenum">6975</span></a>  
<a name="l6976"><span class="linenum">6976</span></a>      for (<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> = 0; <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> &lt; <a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>); <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>++) {
<a name="l6977"><span class="linenum">6977</span></a>          <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a> = (<a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a> + 1) % 256;
<a name="l6978"><span class="linenum">6978</span></a>          <a class="var it84" onMouseOver="hilite(84)" onMouseOut="lolite()" onClick="logVariable('j')" href="../_variables/j.html">$j</a> = (<a class="var it84" onMouseOver="hilite(84)" onMouseOut="lolite()" onClick="logVariable('j')" href="../_variables/j.html">$j</a> + <a class="var it11231" onMouseOver="hilite(11231)" onMouseOut="lolite()" onClick="logVariable('box')" href="../_variables/box.html">$box</a>[<a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>]) % 256;
<a name="l6979"><span class="linenum">6979</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('temp')" href="../_variables/temp.html">$temp</a> = <a class="var it11231" onMouseOver="hilite(11231)" onMouseOut="lolite()" onClick="logVariable('box')" href="../_variables/box.html">$box</a>[<a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>];
<a name="l6980"><span class="linenum">6980</span></a>          <a class="var it11231" onMouseOver="hilite(11231)" onMouseOut="lolite()" onClick="logVariable('box')" href="../_variables/box.html">$box</a>[<a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>] = <a class="var it11231" onMouseOver="hilite(11231)" onMouseOut="lolite()" onClick="logVariable('box')" href="../_variables/box.html">$box</a>[<a class="var it84" onMouseOver="hilite(84)" onMouseOut="lolite()" onClick="logVariable('j')" href="../_variables/j.html">$j</a>];
<a name="l6981"><span class="linenum">6981</span></a>          <a class="var it11231" onMouseOver="hilite(11231)" onMouseOut="lolite()" onClick="logVariable('box')" href="../_variables/box.html">$box</a>[<a class="var it84" onMouseOver="hilite(84)" onMouseOut="lolite()" onClick="logVariable('j')" href="../_variables/j.html">$j</a>] = <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('temp')" href="../_variables/temp.html">$temp</a>;
<a name="l6982"><span class="linenum">6982</span></a>          <a class="var it50" onMouseOver="hilite(50)" onMouseOut="lolite()" onClick="logVariable('k')" href="../_variables/k.html">$k</a> = <a class="var it11231" onMouseOver="hilite(11231)" onMouseOut="lolite()" onClick="logVariable('box')" href="../_variables/box.html">$box</a>[((<a class="var it11231" onMouseOver="hilite(11231)" onMouseOut="lolite()" onClick="logVariable('box')" href="../_variables/box.html">$box</a>[<a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>] + <a class="var it11231" onMouseOver="hilite(11231)" onMouseOut="lolite()" onClick="logVariable('box')" href="../_variables/box.html">$box</a>[<a class="var it84" onMouseOver="hilite(84)" onMouseOut="lolite()" onClick="logVariable('j')" href="../_variables/j.html">$j</a>]) % 256)];
<a name="l6983"><span class="linenum">6983</span></a>          <a class="var it13143" onMouseOver="hilite(13143)" onMouseOut="lolite()" onClick="logVariable('cipherby')" href="../_variables/cipherby.html">$cipherby</a> = <a class="phpfunction" onClick="logFunction('ord')" href="../_functions/ord.html" onMouseOver="phpfuncPopup(event,'ord')">ord</a>(<a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>, <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>, 1)) ^ <a class="var it50" onMouseOver="hilite(50)" onMouseOut="lolite()" onClick="logVariable('k')" href="../_variables/k.html">$k</a>;
<a name="l6984"><span class="linenum">6984</span></a>          <a class="var it1755" onMouseOver="hilite(1755)" onMouseOut="lolite()" onClick="logVariable('cipher')" href="../_variables/cipher.html">$cipher</a> .= <a class="phpfunction" onClick="logFunction('chr')" href="../_functions/chr.html" onMouseOver="phpfuncPopup(event,'chr')">chr</a>(<a class="var it13143" onMouseOver="hilite(13143)" onMouseOut="lolite()" onClick="logVariable('cipherby')" href="../_variables/cipherby.html">$cipherby</a>);
<a name="l6985"><span class="linenum">6985</span></a>      }
<a name="l6986"><span class="linenum">6986</span></a>  
<a name="l6987"><span class="linenum">6987</span></a>      if (<a class="var it4228" onMouseOver="hilite(4228)" onMouseOut="lolite()" onClick="logVariable('case')" href="../_variables/case.html">$case</a> == 'de') {
<a name="l6988"><span class="linenum">6988</span></a>          <a class="var it1755" onMouseOver="hilite(1755)" onMouseOut="lolite()" onClick="logVariable('cipher')" href="../_variables/cipher.html">$cipher</a> = <a class="phpfunction" onClick="logFunction('urldecode')" href="../_functions/urldecode.html" onMouseOver="phpfuncPopup(event,'urldecode')">urldecode</a>(<a class="phpfunction" onClick="logFunction('urlencode')" href="../_functions/urlencode.html" onMouseOver="phpfuncPopup(event,'urlencode')">urlencode</a>(<a class="var it1755" onMouseOver="hilite(1755)" onMouseOut="lolite()" onClick="logVariable('cipher')" href="../_variables/cipher.html">$cipher</a>));
<a name="l6989"><span class="linenum">6989</span></a>      } else {
<a name="l6990"><span class="linenum">6990</span></a>          <a class="var it1755" onMouseOver="hilite(1755)" onMouseOut="lolite()" onClick="logVariable('cipher')" href="../_variables/cipher.html">$cipher</a> = <a class="phpfunction" onClick="logFunction('urlencode')" href="../_functions/urlencode.html" onMouseOver="phpfuncPopup(event,'urlencode')">urlencode</a>(<a class="var it1755" onMouseOver="hilite(1755)" onMouseOut="lolite()" onClick="logVariable('cipher')" href="../_variables/cipher.html">$cipher</a>);
<a name="l6991"><span class="linenum">6991</span></a>      }
<a name="l6992"><span class="linenum">6992</span></a>  
<a name="l6993"><span class="linenum">6993</span></a>      return <a class="var it1755" onMouseOver="hilite(1755)" onMouseOut="lolite()" onClick="logVariable('cipher')" href="../_variables/cipher.html">$cipher</a>;
<a name="l6994"><span class="linenum">6994</span></a>  }
<a name="l6995"><span class="linenum">6995</span></a>  
<a name="l6996"><span class="linenum">6996</span></a>  <span class="comment">// ENVIRONMENT CHECKING.</span>
<a name="l6997"><span class="linenum">6997</span></a>  
<a name="l6998"><span class="linenum">6998</span></a>  <span class="comment">/**</span>
<a name="l6999"><span class="linenum">6999</span></a>  <span class="comment"> * This method validates a plug name. It is much faster than calling clean_param.</span>
<a name="l7000"><span class="linenum">7000</span></a>  <span class="comment"> *</span>
<a name="l7001"><span class="linenum">7001</span></a>  <span class="comment"> * @param string $name a string that might be a plugin name.</span>
<a name="l7002"><span class="linenum">7002</span></a>  <span class="comment"> * @return bool if this string is a valid plugin name.</span>
<a name="l7003"><span class="linenum">7003</span></a>  <span class="comment"> */</span>
<a name="l7004"><span class="linenum">7004</span></a>  function <a class="function" onClick="logFunction('is_valid_plugin_name')" href="../_functions/is_valid_plugin_name.html" onMouseOver="funcPopup(event,'is_valid_plugin_name')">is_valid_plugin_name</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>) {
<a name="l7005"><span class="linenum">7005</span></a>  <span class="comment">    // This does not work for 'mod', bad luck, use any other type.</span>
<a name="l7006"><span class="linenum">7006</span></a>      return <a class="class" onClick="logClass('core_component')" href="../_classes/core_component.html" onMouseOver="classPopup(event,'core_component')">core_component</a>::<a class="function" onClick="logFunction('is_valid_plugin_name')" href="../_functions/is_valid_plugin_name.html" onMouseOver="funcPopup(event,'is_valid_plugin_name')">is_valid_plugin_name</a>('tool', <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>);
<a name="l7007"><span class="linenum">7007</span></a>  }
<a name="l7008"><span class="linenum">7008</span></a>  
<a name="l7009"><span class="linenum">7009</span></a>  <span class="comment">/**</span>
<a name="l7010"><span class="linenum">7010</span></a>  <span class="comment"> * Get a list of all the plugins of a given type that define a certain API function</span>
<a name="l7011"><span class="linenum">7011</span></a>  <span class="comment"> * in a certain file. The plugin component names and function names are returned.</span>
<a name="l7012"><span class="linenum">7012</span></a>  <span class="comment"> *</span>
<a name="l7013"><span class="linenum">7013</span></a>  <span class="comment"> * @param string $plugintype the type of plugin, e.g. 'mod' or 'report'.</span>
<a name="l7014"><span class="linenum">7014</span></a>  <span class="comment"> * @param string $function the part of the name of the function after the</span>
<a name="l7015"><span class="linenum">7015</span></a>  <span class="comment"> *      frankenstyle prefix. e.g 'hook' if you are looking for functions with</span>
<a name="l7016"><span class="linenum">7016</span></a>  <span class="comment"> *      names like report_courselist_hook.</span>
<a name="l7017"><span class="linenum">7017</span></a>  <span class="comment"> * @param string $file the name of file within the plugin that defines the</span>
<a name="l7018"><span class="linenum">7018</span></a>  <span class="comment"> *      function. Defaults to lib.php.</span>
<a name="l7019"><span class="linenum">7019</span></a>  <span class="comment"> * @return array with frankenstyle plugin names as keys (e.g. 'report_courselist', 'mod_forum')</span>
<a name="l7020"><span class="linenum">7020</span></a>  <span class="comment"> *      and the function names as values (e.g. 'report_courselist_hook', 'forum_hook').</span>
<a name="l7021"><span class="linenum">7021</span></a>  <span class="comment"> */</span>
<a name="l7022"><span class="linenum">7022</span></a>  function <a class="function" onClick="logFunction('get_plugin_list_with_function')" href="../_functions/get_plugin_list_with_function.html" onMouseOver="funcPopup(event,'get_plugin_list_with_function')">get_plugin_list_with_function</a>(<a class="var it1843" onMouseOver="hilite(1843)" onMouseOut="lolite()" onClick="logVariable('plugintype')" href="../_variables/plugintype.html">$plugintype</a>, <a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a>, <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a> = 'lib.php') {
<a name="l7023"><span class="linenum">7023</span></a>      <a class="var it13144" onMouseOver="hilite(13144)" onMouseOut="lolite()" onClick="logVariable('pluginfunctions')" href="../_variables/pluginfunctions.html">$pluginfunctions</a> = array();
<a name="l7024"><span class="linenum">7024</span></a>      <a class="var it13145" onMouseOver="hilite(13145)" onMouseOut="lolite()" onClick="logVariable('pluginswithfile')" href="../_variables/pluginswithfile.html">$pluginswithfile</a> = <a class="class" onClick="logClass('core_component')" href="../_classes/core_component.html" onMouseOver="classPopup(event,'core_component')">core_component</a>::<a class="function" onClick="logFunction('get_plugin_list_with_file')" href="../_functions/get_plugin_list_with_file.html" onMouseOver="funcPopup(event,'get_plugin_list_with_file')">get_plugin_list_with_file</a>(<a class="var it1843" onMouseOver="hilite(1843)" onMouseOut="lolite()" onClick="logVariable('plugintype')" href="../_variables/plugintype.html">$plugintype</a>, <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a>, true);
<a name="l7025"><span class="linenum">7025</span></a>      foreach (<a class="var it13145" onMouseOver="hilite(13145)" onMouseOut="lolite()" onClick="logVariable('pluginswithfile')" href="../_variables/pluginswithfile.html">$pluginswithfile</a> as <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a> =&gt; <a class="var it2596" onMouseOver="hilite(2596)" onMouseOut="lolite()" onClick="logVariable('notused')" href="../_variables/notused.html">$notused</a>) {
<a name="l7026"><span class="linenum">7026</span></a>          <a class="var it13146" onMouseOver="hilite(13146)" onMouseOut="lolite()" onClick="logVariable('fullfunction')" href="../_variables/fullfunction.html">$fullfunction</a> = <a class="var it1843" onMouseOver="hilite(1843)" onMouseOut="lolite()" onClick="logVariable('plugintype')" href="../_variables/plugintype.html">$plugintype</a> . '_' . <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a> . '_' . <a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a>;
<a name="l7027"><span class="linenum">7027</span></a>  
<a name="l7028"><span class="linenum">7028</span></a>          if (<a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>(<a class="var it13146" onMouseOver="hilite(13146)" onMouseOut="lolite()" onClick="logVariable('fullfunction')" href="../_variables/fullfunction.html">$fullfunction</a>)) {
<a name="l7029"><span class="linenum">7029</span></a>  <span class="comment">            // Function exists with standard name. Store, indexed by frankenstyle name of plugin.</span>
<a name="l7030"><span class="linenum">7030</span></a>              <a class="var it13144" onMouseOver="hilite(13144)" onMouseOut="lolite()" onClick="logVariable('pluginfunctions')" href="../_variables/pluginfunctions.html">$pluginfunctions</a>[<a class="var it1843" onMouseOver="hilite(1843)" onMouseOut="lolite()" onClick="logVariable('plugintype')" href="../_variables/plugintype.html">$plugintype</a> . '_' . <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>] = <a class="var it13146" onMouseOver="hilite(13146)" onMouseOut="lolite()" onClick="logVariable('fullfunction')" href="../_variables/fullfunction.html">$fullfunction</a>;
<a name="l7031"><span class="linenum">7031</span></a>  
<a name="l7032"><span class="linenum">7032</span></a>          } else if (<a class="var it1843" onMouseOver="hilite(1843)" onMouseOut="lolite()" onClick="logVariable('plugintype')" href="../_variables/plugintype.html">$plugintype</a> === 'mod') {
<a name="l7033"><span class="linenum">7033</span></a>  <span class="comment">            // For modules, we also allow plugin without full frankenstyle but just starting with the module name.</span>
<a name="l7034"><span class="linenum">7034</span></a>              <a class="var it13147" onMouseOver="hilite(13147)" onMouseOut="lolite()" onClick="logVariable('shortfunction')" href="../_variables/shortfunction.html">$shortfunction</a> = <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a> . '_' . <a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a>;
<a name="l7035"><span class="linenum">7035</span></a>              if (<a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>(<a class="var it13147" onMouseOver="hilite(13147)" onMouseOut="lolite()" onClick="logVariable('shortfunction')" href="../_variables/shortfunction.html">$shortfunction</a>)) {
<a name="l7036"><span class="linenum">7036</span></a>                  <a class="var it13144" onMouseOver="hilite(13144)" onMouseOut="lolite()" onClick="logVariable('pluginfunctions')" href="../_variables/pluginfunctions.html">$pluginfunctions</a>[<a class="var it1843" onMouseOver="hilite(1843)" onMouseOut="lolite()" onClick="logVariable('plugintype')" href="../_variables/plugintype.html">$plugintype</a> . '_' . <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../_variables/plugin.html">$plugin</a>] = <a class="var it13147" onMouseOver="hilite(13147)" onMouseOut="lolite()" onClick="logVariable('shortfunction')" href="../_variables/shortfunction.html">$shortfunction</a>;
<a name="l7037"><span class="linenum">7037</span></a>              }
<a name="l7038"><span class="linenum">7038</span></a>          }
<a name="l7039"><span class="linenum">7039</span></a>      }
<a name="l7040"><span class="linenum">7040</span></a>      return <a class="var it13144" onMouseOver="hilite(13144)" onMouseOut="lolite()" onClick="logVariable('pluginfunctions')" href="../_variables/pluginfunctions.html">$pluginfunctions</a>;
<a name="l7041"><span class="linenum">7041</span></a>  }
<a name="l7042"><span class="linenum">7042</span></a>  
<a name="l7043"><span class="linenum">7043</span></a>  <span class="comment">/**</span>
<a name="l7044"><span class="linenum">7044</span></a>  <span class="comment"> * Lists plugin-like directories within specified directory</span>
<a name="l7045"><span class="linenum">7045</span></a>  <span class="comment"> *</span>
<a name="l7046"><span class="linenum">7046</span></a>  <span class="comment"> * This function was originally used for standard Moodle plugins, please use</span>
<a name="l7047"><span class="linenum">7047</span></a>  <span class="comment"> * new core_component::get_plugin_list() now.</span>
<a name="l7048"><span class="linenum">7048</span></a>  <span class="comment"> *</span>
<a name="l7049"><span class="linenum">7049</span></a>  <span class="comment"> * This function is used for general directory listing and backwards compatility.</span>
<a name="l7050"><span class="linenum">7050</span></a>  <span class="comment"> *</span>
<a name="l7051"><span class="linenum">7051</span></a>  <span class="comment"> * @param string $directory relative directory from root</span>
<a name="l7052"><span class="linenum">7052</span></a>  <span class="comment"> * @param string $exclude dir name to exclude from the list (defaults to none)</span>
<a name="l7053"><span class="linenum">7053</span></a>  <span class="comment"> * @param string $basedir full path to the base dir where $plugin resides (defaults to $CFG-&gt;dirroot)</span>
<a name="l7054"><span class="linenum">7054</span></a>  <span class="comment"> * @return array Sorted array of directory names found under the requested parameters</span>
<a name="l7055"><span class="linenum">7055</span></a>  <span class="comment"> */</span>
<a name="l7056"><span class="linenum">7056</span></a>  function <a class="function" onClick="logFunction('get_list_of_plugins')" href="../_functions/get_list_of_plugins.html" onMouseOver="funcPopup(event,'get_list_of_plugins')">get_list_of_plugins</a>(<a class="var it3461" onMouseOver="hilite(3461)" onMouseOut="lolite()" onClick="logVariable('directory')" href="../_variables/directory.html">$directory</a>='mod', <a class="var it1034" onMouseOver="hilite(1034)" onMouseOut="lolite()" onClick="logVariable('exclude')" href="../_variables/exclude.html">$exclude</a>='', <a class="var it13148" onMouseOver="hilite(13148)" onMouseOut="lolite()" onClick="logVariable('basedir')" href="../_variables/basedir.html">$basedir</a>='') {
<a name="l7057"><span class="linenum">7057</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l7058"><span class="linenum">7058</span></a>  
<a name="l7059"><span class="linenum">7059</span></a>      <a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('plugins')" href="../_variables/plugins.html">$plugins</a> = array();
<a name="l7060"><span class="linenum">7060</span></a>  
<a name="l7061"><span class="linenum">7061</span></a>      if (empty(<a class="var it13148" onMouseOver="hilite(13148)" onMouseOut="lolite()" onClick="logVariable('basedir')" href="../_variables/basedir.html">$basedir</a>)) {
<a name="l7062"><span class="linenum">7062</span></a>          <a class="var it13148" onMouseOver="hilite(13148)" onMouseOut="lolite()" onClick="logVariable('basedir')" href="../_variables/basedir.html">$basedir</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a> .'/'. <a class="var it3461" onMouseOver="hilite(3461)" onMouseOut="lolite()" onClick="logVariable('directory')" href="../_variables/directory.html">$directory</a>;
<a name="l7063"><span class="linenum">7063</span></a>  
<a name="l7064"><span class="linenum">7064</span></a>      } else {
<a name="l7065"><span class="linenum">7065</span></a>          <a class="var it13148" onMouseOver="hilite(13148)" onMouseOut="lolite()" onClick="logVariable('basedir')" href="../_variables/basedir.html">$basedir</a> = <a class="var it13148" onMouseOver="hilite(13148)" onMouseOut="lolite()" onClick="logVariable('basedir')" href="../_variables/basedir.html">$basedir</a> .'/'. <a class="var it3461" onMouseOver="hilite(3461)" onMouseOut="lolite()" onClick="logVariable('directory')" href="../_variables/directory.html">$directory</a>;
<a name="l7066"><span class="linenum">7066</span></a>      }
<a name="l7067"><span class="linenum">7067</span></a>  
<a name="l7068"><span class="linenum">7068</span></a>      if (<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('debugdeveloper')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/debugdeveloper.html">debugdeveloper</a> and empty(<a class="var it1034" onMouseOver="hilite(1034)" onMouseOut="lolite()" onClick="logVariable('exclude')" href="../_variables/exclude.html">$exclude</a>)) {
<a name="l7069"><span class="linenum">7069</span></a>  <span class="comment">        // Make sure devs do not use this to list normal plugins,</span>
<a name="l7070"><span class="linenum">7070</span></a>  <span class="comment">        // this is intended for general directories that are not plugins!</span>
<a name="l7071"><span class="linenum">7071</span></a>  
<a name="l7072"><span class="linenum">7072</span></a>          <a class="var it7290" onMouseOver="hilite(7290)" onMouseOut="lolite()" onClick="logVariable('subtypes')" href="../_variables/subtypes.html">$subtypes</a> = <a class="class" onClick="logClass('core_component')" href="../_classes/core_component.html" onMouseOver="classPopup(event,'core_component')">core_component</a>::<a class="function" onClick="logFunction('get_plugin_types')" href="../_functions/get_plugin_types.html" onMouseOver="funcPopup(event,'get_plugin_types')">get_plugin_types</a>();
<a name="l7073"><span class="linenum">7073</span></a>          if (<a class="phpfunction" onClick="logFunction('in_array')" href="../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it13148" onMouseOver="hilite(13148)" onMouseOut="lolite()" onClick="logVariable('basedir')" href="../_variables/basedir.html">$basedir</a>, <a class="var it7290" onMouseOver="hilite(7290)" onMouseOut="lolite()" onClick="logVariable('subtypes')" href="../_variables/subtypes.html">$subtypes</a>)) {
<a name="l7074"><span class="linenum">7074</span></a>              <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('<a class="function" onClick="logFunction('get_list_of_plugins')" href="../_functions/get_list_of_plugins.html" onMouseOver="funcPopup(event,'get_list_of_plugins')">get_list_of_plugins</a>() should not be used to list real plugins, use <a class="class" onClick="logClass('core_component')" href="../_classes/core_component.html" onMouseOver="classPopup(event,'core_component')">core_component</a>::<a class="function" onClick="logFunction('get_plugin_list')" href="../_functions/get_plugin_list.html" onMouseOver="funcPopup(event,'get_plugin_list')">get_plugin_list</a>() instead!', <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l7075"><span class="linenum">7075</span></a>          }
<a name="l7076"><span class="linenum">7076</span></a>          unset(<a class="var it7290" onMouseOver="hilite(7290)" onMouseOut="lolite()" onClick="logVariable('subtypes')" href="../_variables/subtypes.html">$subtypes</a>);
<a name="l7077"><span class="linenum">7077</span></a>      }
<a name="l7078"><span class="linenum">7078</span></a>  
<a name="l7079"><span class="linenum">7079</span></a>      if (<a class="phpfunction" onClick="logFunction('file_exists')" href="../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it13148" onMouseOver="hilite(13148)" onMouseOut="lolite()" onClick="logVariable('basedir')" href="../_variables/basedir.html">$basedir</a>) &amp;&amp; <a class="phpfunction" onClick="logFunction('filetype')" href="../_functions/filetype.html" onMouseOver="phpfuncPopup(event,'filetype')">filetype</a>(<a class="var it13148" onMouseOver="hilite(13148)" onMouseOut="lolite()" onClick="logVariable('basedir')" href="../_variables/basedir.html">$basedir</a>) == 'dir') {
<a name="l7080"><span class="linenum">7080</span></a>          if (!<a class="var it13149" onMouseOver="hilite(13149)" onMouseOut="lolite()" onClick="logVariable('dirhandle')" href="../_variables/dirhandle.html">$dirhandle</a> = <a class="phpfunction" onClick="logFunction('opendir')" href="../_functions/opendir.html" onMouseOver="phpfuncPopup(event,'opendir')">opendir</a>(<a class="var it13148" onMouseOver="hilite(13148)" onMouseOut="lolite()" onClick="logVariable('basedir')" href="../_variables/basedir.html">$basedir</a>)) {
<a name="l7081"><span class="linenum">7081</span></a>              <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(&quot;Directory permission error for <a class="function" onClick="logFunction('plugin')" href="../_functions/plugin.html" onMouseOver="funcPopup(event,'plugin')">plugin</a> ({<a class="var it3461" onMouseOver="hilite(3461)" onMouseOut="lolite()" onClick="logVariable('directory')" href="../_variables/directory.html">$directory</a>}). Directory exists but cannot be read.&quot;, <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l7082"><span class="linenum">7082</span></a>              return array();
<a name="l7083"><span class="linenum">7083</span></a>          }
<a name="l7084"><span class="linenum">7084</span></a>          while (false !== (<a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a> = readdir(<a class="var it13149" onMouseOver="hilite(13149)" onMouseOut="lolite()" onClick="logVariable('dirhandle')" href="../_variables/dirhandle.html">$dirhandle</a>))) {
<a name="l7085"><span class="linenum">7085</span></a>  <span class="comment">            // Func: strpos is marginally but reliably faster than substr($dir, 0, 1).</span>
<a name="l7086"><span class="linenum">7086</span></a>              if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a>, '.') === 0 or <a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a> === 'CVS' or <a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a> === '_vti_cnf' or <a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a> === 'simpletest' or <a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a> === 'yui' or
<a name="l7087"><span class="linenum">7087</span></a>                  <a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a> === 'tests' or <a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a> === 'classes' or <a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a> === <a class="var it1034" onMouseOver="hilite(1034)" onMouseOut="lolite()" onClick="logVariable('exclude')" href="../_variables/exclude.html">$exclude</a>) {
<a name="l7088"><span class="linenum">7088</span></a>                  continue;
<a name="l7089"><span class="linenum">7089</span></a>              }
<a name="l7090"><span class="linenum">7090</span></a>              if (<a class="phpfunction" onClick="logFunction('filetype')" href="../_functions/filetype.html" onMouseOver="phpfuncPopup(event,'filetype')">filetype</a>(<a class="var it13148" onMouseOver="hilite(13148)" onMouseOut="lolite()" onClick="logVariable('basedir')" href="../_variables/basedir.html">$basedir</a> .'/'. <a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a>) != 'dir') {
<a name="l7091"><span class="linenum">7091</span></a>                  continue;
<a name="l7092"><span class="linenum">7092</span></a>              }
<a name="l7093"><span class="linenum">7093</span></a>              <a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('plugins')" href="../_variables/plugins.html">$plugins</a>[] = <a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a>;
<a name="l7094"><span class="linenum">7094</span></a>          }
<a name="l7095"><span class="linenum">7095</span></a>          <a class="phpfunction" onClick="logFunction('closedir')" href="../_functions/closedir.html" onMouseOver="phpfuncPopup(event,'closedir')">closedir</a>(<a class="var it13149" onMouseOver="hilite(13149)" onMouseOut="lolite()" onClick="logVariable('dirhandle')" href="../_variables/dirhandle.html">$dirhandle</a>);
<a name="l7096"><span class="linenum">7096</span></a>      }
<a name="l7097"><span class="linenum">7097</span></a>      if (<a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('plugins')" href="../_variables/plugins.html">$plugins</a>) {
<a name="l7098"><span class="linenum">7098</span></a>          <a class="phpfunction" onClick="logFunction('asort')" href="../_functions/asort.html" onMouseOver="phpfuncPopup(event,'asort')">asort</a>(<a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('plugins')" href="../_variables/plugins.html">$plugins</a>);
<a name="l7099"><span class="linenum">7099</span></a>      }
<a name="l7100"><span class="linenum">7100</span></a>      return <a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('plugins')" href="../_variables/plugins.html">$plugins</a>;
<a name="l7101"><span class="linenum">7101</span></a>  }
<a name="l7102"><span class="linenum">7102</span></a>  
<a name="l7103"><span class="linenum">7103</span></a>  <span class="comment">/**</span>
<a name="l7104"><span class="linenum">7104</span></a>  <span class="comment"> * Invoke plugin's callback functions</span>
<a name="l7105"><span class="linenum">7105</span></a>  <span class="comment"> *</span>
<a name="l7106"><span class="linenum">7106</span></a>  <span class="comment"> * @param string $type plugin type e.g. 'mod'</span>
<a name="l7107"><span class="linenum">7107</span></a>  <span class="comment"> * @param string $name plugin name</span>
<a name="l7108"><span class="linenum">7108</span></a>  <span class="comment"> * @param string $feature feature name</span>
<a name="l7109"><span class="linenum">7109</span></a>  <span class="comment"> * @param string $action feature's action</span>
<a name="l7110"><span class="linenum">7110</span></a>  <span class="comment"> * @param array $params parameters of callback function, should be an array</span>
<a name="l7111"><span class="linenum">7111</span></a>  <span class="comment"> * @param mixed $default default value if callback function hasn't been defined, or if it retursn null.</span>
<a name="l7112"><span class="linenum">7112</span></a>  <span class="comment"> * @return mixed</span>
<a name="l7113"><span class="linenum">7113</span></a>  <span class="comment"> *</span>
<a name="l7114"><span class="linenum">7114</span></a>  <span class="comment"> * @todo Decide about to deprecate and drop plugin_callback() - MDL-30743</span>
<a name="l7115"><span class="linenum">7115</span></a>  <span class="comment"> */</span>
<a name="l7116"><span class="linenum">7116</span></a>  function <a class="function" onClick="logFunction('plugin_callback')" href="../_functions/plugin_callback.html" onMouseOver="funcPopup(event,'plugin_callback')">plugin_callback</a>(<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, <a class="var it2238" onMouseOver="hilite(2238)" onMouseOut="lolite()" onClick="logVariable('feature')" href="../_variables/feature.html">$feature</a>, <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = null, <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a> = null) {
<a name="l7117"><span class="linenum">7117</span></a>      return <a class="function" onClick="logFunction('component_callback')" href="../_functions/component_callback.html" onMouseOver="funcPopup(event,'component_callback')">component_callback</a>(<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a> . '_' . <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, <a class="var it2238" onMouseOver="hilite(2238)" onMouseOut="lolite()" onClick="logVariable('feature')" href="../_variables/feature.html">$feature</a> . '_' . <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a>, (array) <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>, <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>);
<a name="l7118"><span class="linenum">7118</span></a>  }
<a name="l7119"><span class="linenum">7119</span></a>  
<a name="l7120"><span class="linenum">7120</span></a>  <span class="comment">/**</span>
<a name="l7121"><span class="linenum">7121</span></a>  <span class="comment"> * Invoke component's callback functions</span>
<a name="l7122"><span class="linenum">7122</span></a>  <span class="comment"> *</span>
<a name="l7123"><span class="linenum">7123</span></a>  <span class="comment"> * @param string $component frankenstyle component name, e.g. 'mod_quiz'</span>
<a name="l7124"><span class="linenum">7124</span></a>  <span class="comment"> * @param string $function the rest of the function name, e.g. 'cron' will end up calling 'mod_quiz_cron'</span>
<a name="l7125"><span class="linenum">7125</span></a>  <span class="comment"> * @param array $params parameters of callback function</span>
<a name="l7126"><span class="linenum">7126</span></a>  <span class="comment"> * @param mixed $default default value if callback function hasn't been defined, or if it retursn null.</span>
<a name="l7127"><span class="linenum">7127</span></a>  <span class="comment"> * @return mixed</span>
<a name="l7128"><span class="linenum">7128</span></a>  <span class="comment"> */</span>
<a name="l7129"><span class="linenum">7129</span></a>  function <a class="function" onClick="logFunction('component_callback')" href="../_functions/component_callback.html" onMouseOver="funcPopup(event,'component_callback')">component_callback</a>(<a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a>, <a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a>, array <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array(), <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a> = null) {
<a name="l7130"><span class="linenum">7130</span></a>  
<a name="l7131"><span class="linenum">7131</span></a>      <a class="var it3922" onMouseOver="hilite(3922)" onMouseOut="lolite()" onClick="logVariable('functionname')" href="../_variables/functionname.html">$functionname</a> = <a class="function" onClick="logFunction('component_callback_exists')" href="../_functions/component_callback_exists.html" onMouseOver="funcPopup(event,'component_callback_exists')">component_callback_exists</a>(<a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a>, <a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a>);
<a name="l7132"><span class="linenum">7132</span></a>  
<a name="l7133"><span class="linenum">7133</span></a>      if (<a class="var it3922" onMouseOver="hilite(3922)" onMouseOut="lolite()" onClick="logVariable('functionname')" href="../_variables/functionname.html">$functionname</a>) {
<a name="l7134"><span class="linenum">7134</span></a>  <span class="comment">        // Function exists, so just return function result.</span>
<a name="l7135"><span class="linenum">7135</span></a>          <a class="var it575" onMouseOver="hilite(575)" onMouseOut="lolite()" onClick="logVariable('ret')" href="../_variables/ret.html">$ret</a> = <a class="phpfunction" onClick="logFunction('call_user_func_array')" href="../_functions/call_user_func_array.html" onMouseOver="phpfuncPopup(event,'call_user_func_array')">call_user_func_array</a>(<a class="var it3922" onMouseOver="hilite(3922)" onMouseOut="lolite()" onClick="logVariable('functionname')" href="../_variables/functionname.html">$functionname</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>);
<a name="l7136"><span class="linenum">7136</span></a>          if (<a class="phpfunction" onClick="logFunction('is_null')" href="../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it575" onMouseOver="hilite(575)" onMouseOut="lolite()" onClick="logVariable('ret')" href="../_variables/ret.html">$ret</a>)) {
<a name="l7137"><span class="linenum">7137</span></a>              return <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>;
<a name="l7138"><span class="linenum">7138</span></a>          } else {
<a name="l7139"><span class="linenum">7139</span></a>              return <a class="var it575" onMouseOver="hilite(575)" onMouseOut="lolite()" onClick="logVariable('ret')" href="../_variables/ret.html">$ret</a>;
<a name="l7140"><span class="linenum">7140</span></a>          }
<a name="l7141"><span class="linenum">7141</span></a>      }
<a name="l7142"><span class="linenum">7142</span></a>      return <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>;
<a name="l7143"><span class="linenum">7143</span></a>  }
<a name="l7144"><span class="linenum">7144</span></a>  
<a name="l7145"><span class="linenum">7145</span></a>  <span class="comment">/**</span>
<a name="l7146"><span class="linenum">7146</span></a>  <span class="comment"> * Determine if a component callback exists and return the function name to call. Note that this</span>
<a name="l7147"><span class="linenum">7147</span></a>  <span class="comment"> * function will include the required library files so that the functioname returned can be</span>
<a name="l7148"><span class="linenum">7148</span></a>  <span class="comment"> * called directly.</span>
<a name="l7149"><span class="linenum">7149</span></a>  <span class="comment"> *</span>
<a name="l7150"><span class="linenum">7150</span></a>  <span class="comment"> * @param string $component frankenstyle component name, e.g. 'mod_quiz'</span>
<a name="l7151"><span class="linenum">7151</span></a>  <span class="comment"> * @param string $function the rest of the function name, e.g. 'cron' will end up calling 'mod_quiz_cron'</span>
<a name="l7152"><span class="linenum">7152</span></a>  <span class="comment"> * @return mixed Complete function name to call if the callback exists or false if it doesn't.</span>
<a name="l7153"><span class="linenum">7153</span></a>  <span class="comment"> * @throws coding_exception if invalid component specfied</span>
<a name="l7154"><span class="linenum">7154</span></a>  <span class="comment"> */</span>
<a name="l7155"><span class="linenum">7155</span></a>  function <a class="function" onClick="logFunction('component_callback_exists')" href="../_functions/component_callback_exists.html" onMouseOver="funcPopup(event,'component_callback_exists')">component_callback_exists</a>(<a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a>, <a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a>) {
<a name="l7156"><span class="linenum">7156</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>; <span class="comment">// This is needed for the inclusions.</span>
<a name="l7157"><span class="linenum">7157</span></a>  
<a name="l7158"><span class="linenum">7158</span></a>      <a class="var it3898" onMouseOver="hilite(3898)" onMouseOut="lolite()" onClick="logVariable('cleancomponent')" href="../_variables/cleancomponent.html">$cleancomponent</a> = <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a>, <a class="constant" onClick="logConstant('PARAM_COMPONENT')" href="../_constants/PARAM_COMPONENT.html" onMouseOver="constPopup(event,'PARAM_COMPONENT')">PARAM_COMPONENT</a>);
<a name="l7159"><span class="linenum">7159</span></a>      if (empty(<a class="var it3898" onMouseOver="hilite(3898)" onMouseOut="lolite()" onClick="logVariable('cleancomponent')" href="../_variables/cleancomponent.html">$cleancomponent</a>)) {
<a name="l7160"><span class="linenum">7160</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Invalid component used in plugin/<a class="function" onClick="logFunction('component_callback')" href="../_functions/component_callback.html" onMouseOver="funcPopup(event,'component_callback')">component_callback</a>():' . <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a>);
<a name="l7161"><span class="linenum">7161</span></a>      }
<a name="l7162"><span class="linenum">7162</span></a>      <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a> = <a class="var it3898" onMouseOver="hilite(3898)" onMouseOut="lolite()" onClick="logVariable('cleancomponent')" href="../_variables/cleancomponent.html">$cleancomponent</a>;
<a name="l7163"><span class="linenum">7163</span></a>  
<a name="l7164"><span class="linenum">7164</span></a>      <a class="function" onClick="logFunction('list')" href="../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>) = <a class="class" onClick="logClass('core_component')" href="../_classes/core_component.html" onMouseOver="classPopup(event,'core_component')">core_component</a>::<a class="function" onClick="logFunction('normalize_component')" href="../_functions/normalize_component.html" onMouseOver="funcPopup(event,'normalize_component')">normalize_component</a>(<a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a>);
<a name="l7165"><span class="linenum">7165</span></a>      <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a> = <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a> . '_' . <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>;
<a name="l7166"><span class="linenum">7166</span></a>  
<a name="l7167"><span class="linenum">7167</span></a>      <a class="var it13150" onMouseOver="hilite(13150)" onMouseOut="lolite()" onClick="logVariable('oldfunction')" href="../_variables/oldfunction.html">$oldfunction</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>.'_'.<a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a>;
<a name="l7168"><span class="linenum">7168</span></a>      <a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a> = <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a>.'_'.<a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a>;
<a name="l7169"><span class="linenum">7169</span></a>  
<a name="l7170"><span class="linenum">7170</span></a>      <a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a> = <a class="class" onClick="logClass('core_component')" href="../_classes/core_component.html" onMouseOver="classPopup(event,'core_component')">core_component</a>::<a class="function" onClick="logFunction('get_component_directory')" href="../_functions/get_component_directory.html" onMouseOver="funcPopup(event,'get_component_directory')">get_component_directory</a>(<a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a>);
<a name="l7171"><span class="linenum">7171</span></a>      if (empty(<a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a>)) {
<a name="l7172"><span class="linenum">7172</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Invalid component used in plugin/<a class="function" onClick="logFunction('component_callback')" href="../_functions/component_callback.html" onMouseOver="funcPopup(event,'component_callback')">component_callback</a>():' . <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a>);
<a name="l7173"><span class="linenum">7173</span></a>      }
<a name="l7174"><span class="linenum">7174</span></a>  
<a name="l7175"><span class="linenum">7175</span></a>  <span class="comment">    // Load library and look for function.</span>
<a name="l7176"><span class="linenum">7176</span></a>      if (<a class="phpfunction" onClick="logFunction('file_exists')" href="../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a>.'/lib.php')) {
<a name="l7177"><span class="linenum">7177</span></a>          require_once(<a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a>.'/lib.php');
<a name="l7178"><span class="linenum">7178</span></a>      }
<a name="l7179"><span class="linenum">7179</span></a>  
<a name="l7180"><span class="linenum">7180</span></a>      if (!<a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>(<a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a>) and <a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>(<a class="var it13150" onMouseOver="hilite(13150)" onMouseOut="lolite()" onClick="logVariable('oldfunction')" href="../_variables/oldfunction.html">$oldfunction</a>)) {
<a name="l7181"><span class="linenum">7181</span></a>          if (<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a> !== 'mod' and <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a> !== 'core') {
<a name="l7182"><span class="linenum">7182</span></a>              <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(&quot;Please use new function name <a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a> instead of legacy <a class="var it13150" onMouseOver="hilite(13150)" onMouseOut="lolite()" onClick="logVariable('oldfunction')" href="../_variables/oldfunction.html">$oldfunction</a>&quot;, <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l7183"><span class="linenum">7183</span></a>          }
<a name="l7184"><span class="linenum">7184</span></a>          <a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a> = <a class="var it13150" onMouseOver="hilite(13150)" onMouseOut="lolite()" onClick="logVariable('oldfunction')" href="../_variables/oldfunction.html">$oldfunction</a>;
<a name="l7185"><span class="linenum">7185</span></a>      }
<a name="l7186"><span class="linenum">7186</span></a>  
<a name="l7187"><span class="linenum">7187</span></a>      if (<a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>(<a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a>)) {
<a name="l7188"><span class="linenum">7188</span></a>          return <a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a>;
<a name="l7189"><span class="linenum">7189</span></a>      }
<a name="l7190"><span class="linenum">7190</span></a>      return false;
<a name="l7191"><span class="linenum">7191</span></a>  }
<a name="l7192"><span class="linenum">7192</span></a>  
<a name="l7193"><span class="linenum">7193</span></a>  <span class="comment">/**</span>
<a name="l7194"><span class="linenum">7194</span></a>  <span class="comment"> * Checks whether a plugin supports a specified feature.</span>
<a name="l7195"><span class="linenum">7195</span></a>  <span class="comment"> *</span>
<a name="l7196"><span class="linenum">7196</span></a>  <span class="comment"> * @param string $type Plugin type e.g. 'mod'</span>
<a name="l7197"><span class="linenum">7197</span></a>  <span class="comment"> * @param string $name Plugin name e.g. 'forum'</span>
<a name="l7198"><span class="linenum">7198</span></a>  <span class="comment"> * @param string $feature Feature code (FEATURE_xx constant)</span>
<a name="l7199"><span class="linenum">7199</span></a>  <span class="comment"> * @param mixed $default default value if feature support unknown</span>
<a name="l7200"><span class="linenum">7200</span></a>  <span class="comment"> * @return mixed Feature result (false if not supported, null if feature is unknown,</span>
<a name="l7201"><span class="linenum">7201</span></a>  <span class="comment"> *         otherwise usually true but may have other feature-specific value such as array)</span>
<a name="l7202"><span class="linenum">7202</span></a>  <span class="comment"> * @throws coding_exception</span>
<a name="l7203"><span class="linenum">7203</span></a>  <span class="comment"> */</span>
<a name="l7204"><span class="linenum">7204</span></a>  function <a class="function" onClick="logFunction('plugin_supports')" href="../_functions/plugin_supports.html" onMouseOver="funcPopup(event,'plugin_supports')">plugin_supports</a>(<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, <a class="var it2238" onMouseOver="hilite(2238)" onMouseOut="lolite()" onClick="logVariable('feature')" href="../_variables/feature.html">$feature</a>, <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a> = null) {
<a name="l7205"><span class="linenum">7205</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l7206"><span class="linenum">7206</span></a>  
<a name="l7207"><span class="linenum">7207</span></a>      if (<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a> === 'mod' and <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a> === 'NEWMODULE') {
<a name="l7208"><span class="linenum">7208</span></a>  <span class="comment">        // Somebody forgot to rename the module template.</span>
<a name="l7209"><span class="linenum">7209</span></a>          return false;
<a name="l7210"><span class="linenum">7210</span></a>      }
<a name="l7211"><span class="linenum">7211</span></a>  
<a name="l7212"><span class="linenum">7212</span></a>      <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a> = <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a> . '_' . <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, <a class="constant" onClick="logConstant('PARAM_COMPONENT')" href="../_constants/PARAM_COMPONENT.html" onMouseOver="constPopup(event,'PARAM_COMPONENT')">PARAM_COMPONENT</a>);
<a name="l7213"><span class="linenum">7213</span></a>      if (empty(<a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a>)) {
<a name="l7214"><span class="linenum">7214</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Invalid component used in <a class="function" onClick="logFunction('plugin_supports')" href="../_functions/plugin_supports.html" onMouseOver="funcPopup(event,'plugin_supports')">plugin_supports</a>():' . <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a> . '_' . <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>);
<a name="l7215"><span class="linenum">7215</span></a>      }
<a name="l7216"><span class="linenum">7216</span></a>  
<a name="l7217"><span class="linenum">7217</span></a>      <a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a> = null;
<a name="l7218"><span class="linenum">7218</span></a>  
<a name="l7219"><span class="linenum">7219</span></a>      if (<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a> === 'mod') {
<a name="l7220"><span class="linenum">7220</span></a>  <span class="comment">        // We need this special case because we support subplugins in modules,</span>
<a name="l7221"><span class="linenum">7221</span></a>  <span class="comment">        // otherwise it would end up in infinite loop.</span>
<a name="l7222"><span class="linenum">7222</span></a>          if (<a class="phpfunction" onClick="logFunction('file_exists')" href="../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>/mod/<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>/lib.php&quot;)) {
<a name="l7223"><span class="linenum">7223</span></a>              include_once(&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>/mod/<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>/lib.php&quot;);
<a name="l7224"><span class="linenum">7224</span></a>              <a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a> = <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a>.'_supports';
<a name="l7225"><span class="linenum">7225</span></a>              if (!<a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>(<a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a>)) {
<a name="l7226"><span class="linenum">7226</span></a>  <span class="comment">                // Legacy non-frankenstyle function name.</span>
<a name="l7227"><span class="linenum">7227</span></a>                  <a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>.'_supports';
<a name="l7228"><span class="linenum">7228</span></a>              }
<a name="l7229"><span class="linenum">7229</span></a>          }
<a name="l7230"><span class="linenum">7230</span></a>  
<a name="l7231"><span class="linenum">7231</span></a>      } else {
<a name="l7232"><span class="linenum">7232</span></a>          if (!<a class="var it154" onMouseOver="hilite(154)" onMouseOut="lolite()" onClick="logVariable('path')" href="../_variables/path.html">$path</a> = <a class="class" onClick="logClass('core_component')" href="../_classes/core_component.html" onMouseOver="classPopup(event,'core_component')">core_component</a>::<a class="function" onClick="logFunction('get_plugin_directory')" href="../_functions/get_plugin_directory.html" onMouseOver="funcPopup(event,'get_plugin_directory')">get_plugin_directory</a>(<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>)) {
<a name="l7233"><span class="linenum">7233</span></a>  <span class="comment">            // Non existent plugin type.</span>
<a name="l7234"><span class="linenum">7234</span></a>              return false;
<a name="l7235"><span class="linenum">7235</span></a>          }
<a name="l7236"><span class="linenum">7236</span></a>          if (<a class="phpfunction" onClick="logFunction('file_exists')" href="../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(&quot;<a class="var it154" onMouseOver="hilite(154)" onMouseOut="lolite()" onClick="logVariable('path')" href="../_variables/path.html">$path</a>/lib.php&quot;)) {
<a name="l7237"><span class="linenum">7237</span></a>              include_once(&quot;<a class="var it154" onMouseOver="hilite(154)" onMouseOut="lolite()" onClick="logVariable('path')" href="../_variables/path.html">$path</a>/lib.php&quot;);
<a name="l7238"><span class="linenum">7238</span></a>              <a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a> = <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a>.'_supports';
<a name="l7239"><span class="linenum">7239</span></a>          }
<a name="l7240"><span class="linenum">7240</span></a>      }
<a name="l7241"><span class="linenum">7241</span></a>  
<a name="l7242"><span class="linenum">7242</span></a>      if (<a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a> and <a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>(<a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a>)) {
<a name="l7243"><span class="linenum">7243</span></a>          <a class="var it13151" onMouseOver="hilite(13151)" onMouseOut="lolite()" onClick="logVariable('supports')" href="../_variables/supports.html">$supports</a> = <a class="var it412" onMouseOver="hilite(412)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a>(<a class="var it2238" onMouseOver="hilite(2238)" onMouseOut="lolite()" onClick="logVariable('feature')" href="../_variables/feature.html">$feature</a>);
<a name="l7244"><span class="linenum">7244</span></a>          if (<a class="phpfunction" onClick="logFunction('is_null')" href="../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it13151" onMouseOver="hilite(13151)" onMouseOut="lolite()" onClick="logVariable('supports')" href="../_variables/supports.html">$supports</a>)) {
<a name="l7245"><span class="linenum">7245</span></a>  <span class="comment">            // Plugin does not know - use default.</span>
<a name="l7246"><span class="linenum">7246</span></a>              return <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>;
<a name="l7247"><span class="linenum">7247</span></a>          } else {
<a name="l7248"><span class="linenum">7248</span></a>              return <a class="var it13151" onMouseOver="hilite(13151)" onMouseOut="lolite()" onClick="logVariable('supports')" href="../_variables/supports.html">$supports</a>;
<a name="l7249"><span class="linenum">7249</span></a>          }
<a name="l7250"><span class="linenum">7250</span></a>      }
<a name="l7251"><span class="linenum">7251</span></a>  
<a name="l7252"><span class="linenum">7252</span></a>  <span class="comment">    // Plugin does not care, so use default.</span>
<a name="l7253"><span class="linenum">7253</span></a>      return <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>;
<a name="l7254"><span class="linenum">7254</span></a>  }
<a name="l7255"><span class="linenum">7255</span></a>  
<a name="l7256"><span class="linenum">7256</span></a>  <span class="comment">/**</span>
<a name="l7257"><span class="linenum">7257</span></a>  <span class="comment"> * Returns true if the current version of PHP is greater that the specified one.</span>
<a name="l7258"><span class="linenum">7258</span></a>  <span class="comment"> *</span>
<a name="l7259"><span class="linenum">7259</span></a>  <span class="comment"> * @todo Check PHP version being required here is it too low?</span>
<a name="l7260"><span class="linenum">7260</span></a>  <span class="comment"> *</span>
<a name="l7261"><span class="linenum">7261</span></a>  <span class="comment"> * @param string $version The version of php being tested.</span>
<a name="l7262"><span class="linenum">7262</span></a>  <span class="comment"> * @return bool</span>
<a name="l7263"><span class="linenum">7263</span></a>  <span class="comment"> */</span>
<a name="l7264"><span class="linenum">7264</span></a>  function <a class="function" onClick="logFunction('check_php_version')" href="../_functions/check_php_version.html" onMouseOver="funcPopup(event,'check_php_version')">check_php_version</a>(<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('version')" href="../_variables/version.html">$version</a>='5.2.4') {
<a name="l7265"><span class="linenum">7265</span></a>      return (<a class="phpfunction" onClick="logFunction('version_compare')" href="../_functions/version_compare.html" onMouseOver="phpfuncPopup(event,'version_compare')">version_compare</a>(<a class="phpfunction" onClick="logFunction('phpversion')" href="../_functions/phpversion.html" onMouseOver="phpfuncPopup(event,'phpversion')">phpversion</a>(), <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('version')" href="../_variables/version.html">$version</a>) &gt;= 0);
<a name="l7266"><span class="linenum">7266</span></a>  }
<a name="l7267"><span class="linenum">7267</span></a>  
<a name="l7268"><span class="linenum">7268</span></a>  <span class="comment">/**</span>
<a name="l7269"><span class="linenum">7269</span></a>  <span class="comment"> * Determine if moodle installation requires update.</span>
<a name="l7270"><span class="linenum">7270</span></a>  <span class="comment"> *</span>
<a name="l7271"><span class="linenum">7271</span></a>  <span class="comment"> * Checks version numbers of main code and all plugins to see</span>
<a name="l7272"><span class="linenum">7272</span></a>  <span class="comment"> * if there are any mismatches.</span>
<a name="l7273"><span class="linenum">7273</span></a>  <span class="comment"> *</span>
<a name="l7274"><span class="linenum">7274</span></a>  <span class="comment"> * @return bool</span>
<a name="l7275"><span class="linenum">7275</span></a>  <span class="comment"> */</span>
<a name="l7276"><span class="linenum">7276</span></a>  function <a class="function" onClick="logFunction('moodle_needs_upgrading')" href="../_functions/moodle_needs_upgrading.html" onMouseOver="funcPopup(event,'moodle_needs_upgrading')">moodle_needs_upgrading</a>() {
<a name="l7277"><span class="linenum">7277</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l7278"><span class="linenum">7278</span></a>  
<a name="l7279"><span class="linenum">7279</span></a>      if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('version')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/version.html">version</a>)) {
<a name="l7280"><span class="linenum">7280</span></a>          return true;
<a name="l7281"><span class="linenum">7281</span></a>      }
<a name="l7282"><span class="linenum">7282</span></a>  
<a name="l7283"><span class="linenum">7283</span></a>  <span class="comment">    // There is no need to purge plugininfo caches here because</span>
<a name="l7284"><span class="linenum">7284</span></a>  <span class="comment">    // these caches are not used during upgrade and they are purged after</span>
<a name="l7285"><span class="linenum">7285</span></a>  <span class="comment">    // every upgrade.</span>
<a name="l7286"><span class="linenum">7286</span></a>  
<a name="l7287"><span class="linenum">7287</span></a>      if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('allversionshash')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/allversionshash.html">allversionshash</a>)) {
<a name="l7288"><span class="linenum">7288</span></a>          return true;
<a name="l7289"><span class="linenum">7289</span></a>      }
<a name="l7290"><span class="linenum">7290</span></a>  
<a name="l7291"><span class="linenum">7291</span></a>      <a class="var it6788" onMouseOver="hilite(6788)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../_variables/hash.html">$hash</a> = <a class="class" onClick="logClass('core_component')" href="../_classes/core_component.html" onMouseOver="classPopup(event,'core_component')">core_component</a>::<a class="function" onClick="logFunction('get_all_versions_hash')" href="../_functions/get_all_versions_hash.html" onMouseOver="funcPopup(event,'get_all_versions_hash')">get_all_versions_hash</a>();
<a name="l7292"><span class="linenum">7292</span></a>  
<a name="l7293"><span class="linenum">7293</span></a>      return (<a class="var it6788" onMouseOver="hilite(6788)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../_variables/hash.html">$hash</a> !== <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('allversionshash')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/allversionshash.html">allversionshash</a>);
<a name="l7294"><span class="linenum">7294</span></a>  }
<a name="l7295"><span class="linenum">7295</span></a>  
<a name="l7296"><span class="linenum">7296</span></a>  <span class="comment">/**</span>
<a name="l7297"><span class="linenum">7297</span></a>  <span class="comment"> * Returns the major version of this site</span>
<a name="l7298"><span class="linenum">7298</span></a>  <span class="comment"> *</span>
<a name="l7299"><span class="linenum">7299</span></a>  <span class="comment"> * Moodle version numbers consist of three numbers separated by a dot, for</span>
<a name="l7300"><span class="linenum">7300</span></a>  <span class="comment"> * example 1.9.11 or 2.0.2. The first two numbers, like 1.9 or 2.0, represent so</span>
<a name="l7301"><span class="linenum">7301</span></a>  <span class="comment"> * called major version. This function extracts the major version from either</span>
<a name="l7302"><span class="linenum">7302</span></a>  <span class="comment"> * $CFG-&gt;release (default) or eventually from the $release variable defined in</span>
<a name="l7303"><span class="linenum">7303</span></a>  <span class="comment"> * the main version.php.</span>
<a name="l7304"><span class="linenum">7304</span></a>  <span class="comment"> *</span>
<a name="l7305"><span class="linenum">7305</span></a>  <span class="comment"> * @param bool $fromdisk should the version if source code files be used</span>
<a name="l7306"><span class="linenum">7306</span></a>  <span class="comment"> * @return string|false the major version like '2.3', false if could not be determined</span>
<a name="l7307"><span class="linenum">7307</span></a>  <span class="comment"> */</span>
<a name="l7308"><span class="linenum">7308</span></a>  function <a class="function" onClick="logFunction('moodle_major_version')" href="../_functions/moodle_major_version.html" onMouseOver="funcPopup(event,'moodle_major_version')">moodle_major_version</a>(<a class="var it13153" onMouseOver="hilite(13153)" onMouseOut="lolite()" onClick="logVariable('fromdisk')" href="../_variables/fromdisk.html">$fromdisk</a> = false) {
<a name="l7309"><span class="linenum">7309</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l7310"><span class="linenum">7310</span></a>  
<a name="l7311"><span class="linenum">7311</span></a>      if (<a class="var it13153" onMouseOver="hilite(13153)" onMouseOut="lolite()" onClick="logVariable('fromdisk')" href="../_variables/fromdisk.html">$fromdisk</a>) {
<a name="l7312"><span class="linenum">7312</span></a>          <a class="var it1816" onMouseOver="hilite(1816)" onMouseOut="lolite()" onClick="logVariable('release')" href="../_variables/release.html">$release</a> = null;
<a name="l7313"><span class="linenum">7313</span></a>          <a class="function" onClick="logFunction('require')" href="../_functions/require.html" onMouseOver="funcPopup(event,'require')">require</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../version.php.html">/version.php</a>');
<a name="l7314"><span class="linenum">7314</span></a>          if (empty(<a class="var it1816" onMouseOver="hilite(1816)" onMouseOut="lolite()" onClick="logVariable('release')" href="../_variables/release.html">$release</a>)) {
<a name="l7315"><span class="linenum">7315</span></a>              return false;
<a name="l7316"><span class="linenum">7316</span></a>          }
<a name="l7317"><span class="linenum">7317</span></a>  
<a name="l7318"><span class="linenum">7318</span></a>      } else {
<a name="l7319"><span class="linenum">7319</span></a>          if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('release')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/release.html">release</a>)) {
<a name="l7320"><span class="linenum">7320</span></a>              return false;
<a name="l7321"><span class="linenum">7321</span></a>          }
<a name="l7322"><span class="linenum">7322</span></a>          <a class="var it1816" onMouseOver="hilite(1816)" onMouseOut="lolite()" onClick="logVariable('release')" href="../_variables/release.html">$release</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('release')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/release.html">release</a>;
<a name="l7323"><span class="linenum">7323</span></a>      }
<a name="l7324"><span class="linenum">7324</span></a>  
<a name="l7325"><span class="linenum">7325</span></a>      if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^[0-9]+\.[0-9]+/', <a class="var it1816" onMouseOver="hilite(1816)" onMouseOut="lolite()" onClick="logVariable('release')" href="../_variables/release.html">$release</a>, <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>)) {
<a name="l7326"><span class="linenum">7326</span></a>          return <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>[0];
<a name="l7327"><span class="linenum">7327</span></a>      } else {
<a name="l7328"><span class="linenum">7328</span></a>          return false;
<a name="l7329"><span class="linenum">7329</span></a>      }
<a name="l7330"><span class="linenum">7330</span></a>  }
<a name="l7331"><span class="linenum">7331</span></a>  
<a name="l7332"><span class="linenum">7332</span></a>  <span class="comment">// MISCELLANEOUS.</span>
<a name="l7333"><span class="linenum">7333</span></a>  
<a name="l7334"><span class="linenum">7334</span></a>  <span class="comment">/**</span>
<a name="l7335"><span class="linenum">7335</span></a>  <span class="comment"> * Sets the system locale</span>
<a name="l7336"><span class="linenum">7336</span></a>  <span class="comment"> *</span>
<a name="l7337"><span class="linenum">7337</span></a>  <span class="comment"> * @category string</span>
<a name="l7338"><span class="linenum">7338</span></a>  <span class="comment"> * @param string $locale Can be used to force a locale</span>
<a name="l7339"><span class="linenum">7339</span></a>  <span class="comment"> */</span>
<a name="l7340"><span class="linenum">7340</span></a>  function <a class="function" onClick="logFunction('moodle_setlocale')" href="../_functions/moodle_setlocale.html" onMouseOver="funcPopup(event,'moodle_setlocale')">moodle_setlocale</a>(<a class="var it454" onMouseOver="hilite(454)" onMouseOut="lolite()" onClick="logVariable('locale')" href="../_variables/locale.html">$locale</a>='') {
<a name="l7341"><span class="linenum">7341</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l7342"><span class="linenum">7342</span></a>  
<a name="l7343"><span class="linenum">7343</span></a>      static <a class="var it13154" onMouseOver="hilite(13154)" onMouseOut="lolite()" onClick="logVariable('currentlocale')" href="../_variables/currentlocale.html">$currentlocale</a> = ''; <span class="comment">// Last locale caching.</span>
<a name="l7344"><span class="linenum">7344</span></a>  
<a name="l7345"><span class="linenum">7345</span></a>      <a class="var it13155" onMouseOver="hilite(13155)" onMouseOut="lolite()" onClick="logVariable('oldlocale')" href="../_variables/oldlocale.html">$oldlocale</a> = <a class="var it13154" onMouseOver="hilite(13154)" onMouseOut="lolite()" onClick="logVariable('currentlocale')" href="../_variables/currentlocale.html">$currentlocale</a>;
<a name="l7346"><span class="linenum">7346</span></a>  
<a name="l7347"><span class="linenum">7347</span></a>  <span class="comment">    // Fetch the correct locale based on ostype.</span>
<a name="l7348"><span class="linenum">7348</span></a>      if (<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('ostype')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/ostype.html">ostype</a> == 'WINDOWS') {
<a name="l7349"><span class="linenum">7349</span></a>          <a class="var it13156" onMouseOver="hilite(13156)" onMouseOut="lolite()" onClick="logVariable('stringtofetch')" href="../_variables/stringtofetch.html">$stringtofetch</a> = 'localewin';
<a name="l7350"><span class="linenum">7350</span></a>      } else {
<a name="l7351"><span class="linenum">7351</span></a>          <a class="var it13156" onMouseOver="hilite(13156)" onMouseOut="lolite()" onClick="logVariable('stringtofetch')" href="../_variables/stringtofetch.html">$stringtofetch</a> = 'locale';
<a name="l7352"><span class="linenum">7352</span></a>      }
<a name="l7353"><span class="linenum">7353</span></a>  
<a name="l7354"><span class="linenum">7354</span></a>  <span class="comment">    // The priority is the same as in get_string() - parameter, config, course, session, user, global language.</span>
<a name="l7355"><span class="linenum">7355</span></a>      if (!empty(<a class="var it454" onMouseOver="hilite(454)" onMouseOut="lolite()" onClick="logVariable('locale')" href="../_variables/locale.html">$locale</a>)) {
<a name="l7356"><span class="linenum">7356</span></a>          <a class="var it13154" onMouseOver="hilite(13154)" onMouseOut="lolite()" onClick="logVariable('currentlocale')" href="../_variables/currentlocale.html">$currentlocale</a> = <a class="var it454" onMouseOver="hilite(454)" onMouseOut="lolite()" onClick="logVariable('locale')" href="../_variables/locale.html">$locale</a>;
<a name="l7357"><span class="linenum">7357</span></a>      } else if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('locale')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/locale.html">locale</a>)) { // Override locale for all language packs.
<a name="l7358"><span class="linenum">7358</span></a>          <a class="var it13154" onMouseOver="hilite(13154)" onMouseOut="lolite()" onClick="logVariable('currentlocale')" href="../_variables/currentlocale.html">$currentlocale</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('locale')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/locale.html">locale</a>;
<a name="l7359"><span class="linenum">7359</span></a>      } else {
<a name="l7360"><span class="linenum">7360</span></a>          <a class="var it13154" onMouseOver="hilite(13154)" onMouseOut="lolite()" onClick="logVariable('currentlocale')" href="../_variables/currentlocale.html">$currentlocale</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(<a class="var it13156" onMouseOver="hilite(13156)" onMouseOut="lolite()" onClick="logVariable('stringtofetch')" href="../_variables/stringtofetch.html">$stringtofetch</a>, 'langconfig');
<a name="l7361"><span class="linenum">7361</span></a>      }
<a name="l7362"><span class="linenum">7362</span></a>  
<a name="l7363"><span class="linenum">7363</span></a>  <span class="comment">    // Do nothing if locale already set up.</span>
<a name="l7364"><span class="linenum">7364</span></a>      if (<a class="var it13155" onMouseOver="hilite(13155)" onMouseOut="lolite()" onClick="logVariable('oldlocale')" href="../_variables/oldlocale.html">$oldlocale</a> == <a class="var it13154" onMouseOver="hilite(13154)" onMouseOut="lolite()" onClick="logVariable('currentlocale')" href="../_variables/currentlocale.html">$currentlocale</a>) {
<a name="l7365"><span class="linenum">7365</span></a>          return;
<a name="l7366"><span class="linenum">7366</span></a>      }
<a name="l7367"><span class="linenum">7367</span></a>  
<a name="l7368"><span class="linenum">7368</span></a>  <span class="comment">    // Due to some strange BUG we cannot set the LC_TIME directly, so we fetch current values,</span>
<a name="l7369"><span class="linenum">7369</span></a>  <span class="comment">    // set LC_ALL and then set values again. Just wondering why we cannot set LC_ALL only??? - stronk7</span>
<a name="l7370"><span class="linenum">7370</span></a>  <span class="comment">    // Some day, numeric, monetary and other categories should be set too, I think. :-/.</span>
<a name="l7371"><span class="linenum">7371</span></a>  
<a name="l7372"><span class="linenum">7372</span></a>  <span class="comment">    // Get current values.</span>
<a name="l7373"><span class="linenum">7373</span></a>      <a class="var it13157" onMouseOver="hilite(13157)" onMouseOut="lolite()" onClick="logVariable('monetary')" href="../_variables/monetary.html">$monetary</a>= <a class="phpfunction" onClick="logFunction('setlocale')" href="../_functions/setlocale.html" onMouseOver="phpfuncPopup(event,'setlocale')">setlocale</a> (LC_MONETARY, 0);
<a name="l7374"><span class="linenum">7374</span></a>      <a class="var it13158" onMouseOver="hilite(13158)" onMouseOut="lolite()" onClick="logVariable('numeric')" href="../_variables/numeric.html">$numeric</a> = <a class="phpfunction" onClick="logFunction('setlocale')" href="../_functions/setlocale.html" onMouseOver="phpfuncPopup(event,'setlocale')">setlocale</a> (LC_NUMERIC, 0);
<a name="l7375"><span class="linenum">7375</span></a>      <a class="var it7974" onMouseOver="hilite(7974)" onMouseOut="lolite()" onClick="logVariable('ctype')" href="../_variables/ctype.html">$ctype</a>   = <a class="phpfunction" onClick="logFunction('setlocale')" href="../_functions/setlocale.html" onMouseOver="phpfuncPopup(event,'setlocale')">setlocale</a> (LC_CTYPE, 0);
<a name="l7376"><span class="linenum">7376</span></a>      if (<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('ostype')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/ostype.html">ostype</a> != 'WINDOWS') {
<a name="l7377"><span class="linenum">7377</span></a>          <a class="var it1262" onMouseOver="hilite(1262)" onMouseOut="lolite()" onClick="logVariable('messages')" href="../_variables/messages.html">$messages</a>= <a class="phpfunction" onClick="logFunction('setlocale')" href="../_functions/setlocale.html" onMouseOver="phpfuncPopup(event,'setlocale')">setlocale</a> (LC_MESSAGES, 0);
<a name="l7378"><span class="linenum">7378</span></a>      }
<a name="l7379"><span class="linenum">7379</span></a>  <span class="comment">    // Set locale to all.</span>
<a name="l7380"><span class="linenum">7380</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = <a class="phpfunction" onClick="logFunction('setlocale')" href="../_functions/setlocale.html" onMouseOver="phpfuncPopup(event,'setlocale')">setlocale</a> (LC_ALL, <a class="var it13154" onMouseOver="hilite(13154)" onMouseOut="lolite()" onClick="logVariable('currentlocale')" href="../_variables/currentlocale.html">$currentlocale</a>);
<a name="l7381"><span class="linenum">7381</span></a>  <span class="comment">    // If setting of locale fails try the other utf8 or utf-8 variant,</span>
<a name="l7382"><span class="linenum">7382</span></a>  <span class="comment">    // some operating systems support both (Debian), others just one (OSX).</span>
<a name="l7383"><span class="linenum">7383</span></a>      if (<a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> === false) {
<a name="l7384"><span class="linenum">7384</span></a>          if (<a class="phpfunction" onClick="logFunction('stripos')" href="../_functions/stripos.html" onMouseOver="phpfuncPopup(event,'stripos')">stripos</a>(<a class="var it13154" onMouseOver="hilite(13154)" onMouseOut="lolite()" onClick="logVariable('currentlocale')" href="../_variables/currentlocale.html">$currentlocale</a>, '.UTF-8') !== false) {
<a name="l7385"><span class="linenum">7385</span></a>              <a class="var it13159" onMouseOver="hilite(13159)" onMouseOut="lolite()" onClick="logVariable('newlocale')" href="../_variables/newlocale.html">$newlocale</a> = <a class="phpfunction" onClick="logFunction('str_ireplace')" href="../_functions/str_ireplace.html" onMouseOver="phpfuncPopup(event,'str_ireplace')">str_ireplace</a>('.UTF-8', '.UTF8', <a class="var it13154" onMouseOver="hilite(13154)" onMouseOut="lolite()" onClick="logVariable('currentlocale')" href="../_variables/currentlocale.html">$currentlocale</a>);
<a name="l7386"><span class="linenum">7386</span></a>              <a class="phpfunction" onClick="logFunction('setlocale')" href="../_functions/setlocale.html" onMouseOver="phpfuncPopup(event,'setlocale')">setlocale</a> (LC_ALL, <a class="var it13159" onMouseOver="hilite(13159)" onMouseOut="lolite()" onClick="logVariable('newlocale')" href="../_variables/newlocale.html">$newlocale</a>);
<a name="l7387"><span class="linenum">7387</span></a>          } else if (<a class="phpfunction" onClick="logFunction('stripos')" href="../_functions/stripos.html" onMouseOver="phpfuncPopup(event,'stripos')">stripos</a>(<a class="var it13154" onMouseOver="hilite(13154)" onMouseOut="lolite()" onClick="logVariable('currentlocale')" href="../_variables/currentlocale.html">$currentlocale</a>, '.UTF8') !== false) {
<a name="l7388"><span class="linenum">7388</span></a>              <a class="var it13159" onMouseOver="hilite(13159)" onMouseOut="lolite()" onClick="logVariable('newlocale')" href="../_variables/newlocale.html">$newlocale</a> = <a class="phpfunction" onClick="logFunction('str_ireplace')" href="../_functions/str_ireplace.html" onMouseOver="phpfuncPopup(event,'str_ireplace')">str_ireplace</a>('.UTF8', '.UTF-8', <a class="var it13154" onMouseOver="hilite(13154)" onMouseOut="lolite()" onClick="logVariable('currentlocale')" href="../_variables/currentlocale.html">$currentlocale</a>);
<a name="l7389"><span class="linenum">7389</span></a>              <a class="phpfunction" onClick="logFunction('setlocale')" href="../_functions/setlocale.html" onMouseOver="phpfuncPopup(event,'setlocale')">setlocale</a> (LC_ALL, <a class="var it13159" onMouseOver="hilite(13159)" onMouseOut="lolite()" onClick="logVariable('newlocale')" href="../_variables/newlocale.html">$newlocale</a>);
<a name="l7390"><span class="linenum">7390</span></a>          }
<a name="l7391"><span class="linenum">7391</span></a>      }
<a name="l7392"><span class="linenum">7392</span></a>  <span class="comment">    // Set old values.</span>
<a name="l7393"><span class="linenum">7393</span></a>      <a class="phpfunction" onClick="logFunction('setlocale')" href="../_functions/setlocale.html" onMouseOver="phpfuncPopup(event,'setlocale')">setlocale</a> (LC_MONETARY, <a class="var it13157" onMouseOver="hilite(13157)" onMouseOut="lolite()" onClick="logVariable('monetary')" href="../_variables/monetary.html">$monetary</a>);
<a name="l7394"><span class="linenum">7394</span></a>      <a class="phpfunction" onClick="logFunction('setlocale')" href="../_functions/setlocale.html" onMouseOver="phpfuncPopup(event,'setlocale')">setlocale</a> (LC_NUMERIC, <a class="var it13158" onMouseOver="hilite(13158)" onMouseOut="lolite()" onClick="logVariable('numeric')" href="../_variables/numeric.html">$numeric</a>);
<a name="l7395"><span class="linenum">7395</span></a>      if (<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('ostype')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/ostype.html">ostype</a> != 'WINDOWS') {
<a name="l7396"><span class="linenum">7396</span></a>          <a class="phpfunction" onClick="logFunction('setlocale')" href="../_functions/setlocale.html" onMouseOver="phpfuncPopup(event,'setlocale')">setlocale</a> (LC_MESSAGES, <a class="var it1262" onMouseOver="hilite(1262)" onMouseOut="lolite()" onClick="logVariable('messages')" href="../_variables/messages.html">$messages</a>);
<a name="l7397"><span class="linenum">7397</span></a>      }
<a name="l7398"><span class="linenum">7398</span></a>      if (<a class="var it13154" onMouseOver="hilite(13154)" onMouseOut="lolite()" onClick="logVariable('currentlocale')" href="../_variables/currentlocale.html">$currentlocale</a> == 'tr_TR' or <a class="var it13154" onMouseOver="hilite(13154)" onMouseOut="lolite()" onClick="logVariable('currentlocale')" href="../_variables/currentlocale.html">$currentlocale</a> == 'tr_TR.UTF-8') {
<a name="l7399"><span class="linenum">7399</span></a>  <span class="comment">        // To workaround a well-known PHP problem with Turkish letter Ii.</span>
<a name="l7400"><span class="linenum">7400</span></a>          <a class="phpfunction" onClick="logFunction('setlocale')" href="../_functions/setlocale.html" onMouseOver="phpfuncPopup(event,'setlocale')">setlocale</a> (LC_CTYPE, <a class="var it7974" onMouseOver="hilite(7974)" onMouseOut="lolite()" onClick="logVariable('ctype')" href="../_variables/ctype.html">$ctype</a>);
<a name="l7401"><span class="linenum">7401</span></a>      }
<a name="l7402"><span class="linenum">7402</span></a>  }
<a name="l7403"><span class="linenum">7403</span></a>  
<a name="l7404"><span class="linenum">7404</span></a>  <span class="comment">/**</span>
<a name="l7405"><span class="linenum">7405</span></a>  <span class="comment"> * Count words in a string.</span>
<a name="l7406"><span class="linenum">7406</span></a>  <span class="comment"> *</span>
<a name="l7407"><span class="linenum">7407</span></a>  <span class="comment"> * Words are defined as things between whitespace.</span>
<a name="l7408"><span class="linenum">7408</span></a>  <span class="comment"> *</span>
<a name="l7409"><span class="linenum">7409</span></a>  <span class="comment"> * @category string</span>
<a name="l7410"><span class="linenum">7410</span></a>  <span class="comment"> * @param string $string The text to be searched for words.</span>
<a name="l7411"><span class="linenum">7411</span></a>  <span class="comment"> * @return int The count of words in the specified string</span>
<a name="l7412"><span class="linenum">7412</span></a>  <span class="comment"> */</span>
<a name="l7413"><span class="linenum">7413</span></a>  function <a class="function" onClick="logFunction('count_words')" href="../_functions/count_words.html" onMouseOver="funcPopup(event,'count_words')">count_words</a>(<a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>) {
<a name="l7414"><span class="linenum">7414</span></a>      <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a> = <a class="phpfunction" onClick="logFunction('strip_tags')" href="../_functions/strip_tags.html" onMouseOver="phpfuncPopup(event,'strip_tags')">strip_tags</a>(<a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>);
<a name="l7415"><span class="linenum">7415</span></a>  <span class="comment">    // Decode HTML entities.</span>
<a name="l7416"><span class="linenum">7416</span></a>      <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a> = <a class="phpfunction" onClick="logFunction('html_entity_decode')" href="../_functions/html_entity_decode.html" onMouseOver="phpfuncPopup(event,'html_entity_decode')">html_entity_decode</a>(<a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>);
<a name="l7417"><span class="linenum">7417</span></a>  <span class="comment">    // Replace underscores (which are classed as word characters) with spaces.</span>
<a name="l7418"><span class="linenum">7418</span></a>      <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/_/u', ' ', <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>);
<a name="l7419"><span class="linenum">7419</span></a>  <span class="comment">    // Remove any characters that shouldn't be treated as word boundaries.</span>
<a name="l7420"><span class="linenum">7420</span></a>      <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/[\'-]/u', '', <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>);
<a name="l7421"><span class="linenum">7421</span></a>  <span class="comment">    // Remove dots and commas from within numbers only.</span>
<a name="l7422"><span class="linenum">7422</span></a>      <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/([0-9])[.,]([0-9])/u', '<a class="var it229" onMouseOver="hilite(229)" onMouseOut="lolite()" onClick="logVariable('1')" href="../_variables/1.html">$1</a><a class="var it230" onMouseOver="hilite(230)" onMouseOut="lolite()" onClick="logVariable('2')" href="../_variables/2.html">$2</a>', <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>);
<a name="l7423"><span class="linenum">7423</span></a>  
<a name="l7424"><span class="linenum">7424</span></a>      return <a class="phpfunction" onClick="logFunction('count')" href="../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="phpfunction" onClick="logFunction('preg_split')" href="../_functions/preg_split.html" onMouseOver="phpfuncPopup(event,'preg_split')">preg_split</a>('/\w\b/u', <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>)) - 1;
<a name="l7425"><span class="linenum">7425</span></a>  }
<a name="l7426"><span class="linenum">7426</span></a>  
<a name="l7427"><span class="linenum">7427</span></a>  <span class="comment">/**</span>
<a name="l7428"><span class="linenum">7428</span></a>  <span class="comment"> * Count letters in a string.</span>
<a name="l7429"><span class="linenum">7429</span></a>  <span class="comment"> *</span>
<a name="l7430"><span class="linenum">7430</span></a>  <span class="comment"> * Letters are defined as chars not in tags and different from whitespace.</span>
<a name="l7431"><span class="linenum">7431</span></a>  <span class="comment"> *</span>
<a name="l7432"><span class="linenum">7432</span></a>  <span class="comment"> * @category string</span>
<a name="l7433"><span class="linenum">7433</span></a>  <span class="comment"> * @param string $string The text to be searched for letters.</span>
<a name="l7434"><span class="linenum">7434</span></a>  <span class="comment"> * @return int The count of letters in the specified text.</span>
<a name="l7435"><span class="linenum">7435</span></a>  <span class="comment"> */</span>
<a name="l7436"><span class="linenum">7436</span></a>  function <a class="function" onClick="logFunction('count_letters')" href="../_functions/count_letters.html" onMouseOver="funcPopup(event,'count_letters')">count_letters</a>(<a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>) {
<a name="l7437"><span class="linenum">7437</span></a>      <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a> = <a class="phpfunction" onClick="logFunction('strip_tags')" href="../_functions/strip_tags.html" onMouseOver="phpfuncPopup(event,'strip_tags')">strip_tags</a>(<a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>); <span class="comment">// Tags are out now.</span>
<a name="l7438"><span class="linenum">7438</span></a>      <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/[[:space:]]*/', '', <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>); <span class="comment">// Whitespace are out now.</span>
<a name="l7439"><span class="linenum">7439</span></a>  
<a name="l7440"><span class="linenum">7440</span></a>      return <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>);
<a name="l7441"><span class="linenum">7441</span></a>  }
<a name="l7442"><span class="linenum">7442</span></a>  
<a name="l7443"><span class="linenum">7443</span></a>  <span class="comment">/**</span>
<a name="l7444"><span class="linenum">7444</span></a>  <span class="comment"> * Generate and return a random string of the specified length.</span>
<a name="l7445"><span class="linenum">7445</span></a>  <span class="comment"> *</span>
<a name="l7446"><span class="linenum">7446</span></a>  <span class="comment"> * @param int $length The length of the string to be created.</span>
<a name="l7447"><span class="linenum">7447</span></a>  <span class="comment"> * @return string</span>
<a name="l7448"><span class="linenum">7448</span></a>  <span class="comment"> */</span>
<a name="l7449"><span class="linenum">7449</span></a>  function <a class="function" onClick="logFunction('random_string')" href="../_functions/random_string.html" onMouseOver="funcPopup(event,'random_string')">random_string</a> (<a class="var it1293" onMouseOver="hilite(1293)" onMouseOut="lolite()" onClick="logVariable('length')" href="../_variables/length.html">$length</a>=15) {
<a name="l7450"><span class="linenum">7450</span></a>      <a class="var it13160" onMouseOver="hilite(13160)" onMouseOut="lolite()" onClick="logVariable('pool')" href="../_variables/pool.html">$pool</a>  = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
<a name="l7451"><span class="linenum">7451</span></a>      <a class="var it13160" onMouseOver="hilite(13160)" onMouseOut="lolite()" onClick="logVariable('pool')" href="../_variables/pool.html">$pool</a> .= 'abcdefghijklmnopqrstuvwxyz';
<a name="l7452"><span class="linenum">7452</span></a>      <a class="var it13160" onMouseOver="hilite(13160)" onMouseOut="lolite()" onClick="logVariable('pool')" href="../_variables/pool.html">$pool</a> .= '0123456789';
<a name="l7453"><span class="linenum">7453</span></a>      <a class="var it13161" onMouseOver="hilite(13161)" onMouseOut="lolite()" onClick="logVariable('poollen')" href="../_variables/poollen.html">$poollen</a> = <a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it13160" onMouseOver="hilite(13160)" onMouseOut="lolite()" onClick="logVariable('pool')" href="../_variables/pool.html">$pool</a>);
<a name="l7454"><span class="linenum">7454</span></a>      <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a> = '';
<a name="l7455"><span class="linenum">7455</span></a>      for (<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> = 0; <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> &lt; <a class="var it1293" onMouseOver="hilite(1293)" onMouseOut="lolite()" onClick="logVariable('length')" href="../_variables/length.html">$length</a>; <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>++) {
<a name="l7456"><span class="linenum">7456</span></a>          <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a> .= <a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it13160" onMouseOver="hilite(13160)" onMouseOut="lolite()" onClick="logVariable('pool')" href="../_variables/pool.html">$pool</a>, (<a class="phpfunction" onClick="logFunction('mt_rand')" href="../_functions/mt_rand.html" onMouseOver="phpfuncPopup(event,'mt_rand')">mt_rand</a>()%(<a class="var it13161" onMouseOver="hilite(13161)" onMouseOut="lolite()" onClick="logVariable('poollen')" href="../_variables/poollen.html">$poollen</a>)), 1);
<a name="l7457"><span class="linenum">7457</span></a>      }
<a name="l7458"><span class="linenum">7458</span></a>      return <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>;
<a name="l7459"><span class="linenum">7459</span></a>  }
<a name="l7460"><span class="linenum">7460</span></a>  
<a name="l7461"><span class="linenum">7461</span></a>  <span class="comment">/**</span>
<a name="l7462"><span class="linenum">7462</span></a>  <span class="comment"> * Generate a complex random string (useful for md5 salts)</span>
<a name="l7463"><span class="linenum">7463</span></a>  <span class="comment"> *</span>
<a name="l7464"><span class="linenum">7464</span></a>  <span class="comment"> * This function is based on the above {@link random_string()} however it uses a</span>
<a name="l7465"><span class="linenum">7465</span></a>  <span class="comment"> * larger pool of characters and generates a string between 24 and 32 characters</span>
<a name="l7466"><span class="linenum">7466</span></a>  <span class="comment"> *</span>
<a name="l7467"><span class="linenum">7467</span></a>  <span class="comment"> * @param int $length Optional if set generates a string to exactly this length</span>
<a name="l7468"><span class="linenum">7468</span></a>  <span class="comment"> * @return string</span>
<a name="l7469"><span class="linenum">7469</span></a>  <span class="comment"> */</span>
<a name="l7470"><span class="linenum">7470</span></a>  function <a class="function" onClick="logFunction('complex_random_string')" href="../_functions/complex_random_string.html" onMouseOver="funcPopup(event,'complex_random_string')">complex_random_string</a>(<a class="var it1293" onMouseOver="hilite(1293)" onMouseOut="lolite()" onClick="logVariable('length')" href="../_variables/length.html">$length</a>=null) {
<a name="l7471"><span class="linenum">7471</span></a>      <a class="var it13160" onMouseOver="hilite(13160)" onMouseOut="lolite()" onClick="logVariable('pool')" href="../_variables/pool.html">$pool</a>  = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
<a name="l7472"><span class="linenum">7472</span></a>      <a class="var it13160" onMouseOver="hilite(13160)" onMouseOut="lolite()" onClick="logVariable('pool')" href="../_variables/pool.html">$pool</a> .= '`~!@#%^&amp;*()_+-=[];,./&lt;&gt;?:{} ';
<a name="l7473"><span class="linenum">7473</span></a>      <a class="var it13161" onMouseOver="hilite(13161)" onMouseOut="lolite()" onClick="logVariable('poollen')" href="../_variables/poollen.html">$poollen</a> = <a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it13160" onMouseOver="hilite(13160)" onMouseOut="lolite()" onClick="logVariable('pool')" href="../_variables/pool.html">$pool</a>);
<a name="l7474"><span class="linenum">7474</span></a>      if (<a class="var it1293" onMouseOver="hilite(1293)" onMouseOut="lolite()" onClick="logVariable('length')" href="../_variables/length.html">$length</a>===null) {
<a name="l7475"><span class="linenum">7475</span></a>          <a class="var it1293" onMouseOver="hilite(1293)" onMouseOut="lolite()" onClick="logVariable('length')" href="../_variables/length.html">$length</a> = <a class="phpfunction" onClick="logFunction('floor')" href="../_functions/floor.html" onMouseOver="phpfuncPopup(event,'floor')">floor</a>(<a class="phpfunction" onClick="logFunction('rand')" href="../_functions/rand.html" onMouseOver="phpfuncPopup(event,'rand')">rand</a>(24, 32));
<a name="l7476"><span class="linenum">7476</span></a>      }
<a name="l7477"><span class="linenum">7477</span></a>      <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a> = '';
<a name="l7478"><span class="linenum">7478</span></a>      for (<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> = 0; <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> &lt; <a class="var it1293" onMouseOver="hilite(1293)" onMouseOut="lolite()" onClick="logVariable('length')" href="../_variables/length.html">$length</a>; <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>++) {
<a name="l7479"><span class="linenum">7479</span></a>          <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a> .= <a class="var it13160" onMouseOver="hilite(13160)" onMouseOut="lolite()" onClick="logVariable('pool')" href="../_variables/pool.html">$pool</a>[(<a class="phpfunction" onClick="logFunction('mt_rand')" href="../_functions/mt_rand.html" onMouseOver="phpfuncPopup(event,'mt_rand')">mt_rand</a>()%<a class="var it13161" onMouseOver="hilite(13161)" onMouseOut="lolite()" onClick="logVariable('poollen')" href="../_variables/poollen.html">$poollen</a>)];
<a name="l7480"><span class="linenum">7480</span></a>      }
<a name="l7481"><span class="linenum">7481</span></a>      return <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>;
<a name="l7482"><span class="linenum">7482</span></a>  }
<a name="l7483"><span class="linenum">7483</span></a>  
<a name="l7484"><span class="linenum">7484</span></a>  <span class="comment">/**</span>
<a name="l7485"><span class="linenum">7485</span></a>  <span class="comment"> * Given some text (which may contain HTML) and an ideal length,</span>
<a name="l7486"><span class="linenum">7486</span></a>  <span class="comment"> * this function truncates the text neatly on a word boundary if possible</span>
<a name="l7487"><span class="linenum">7487</span></a>  <span class="comment"> *</span>
<a name="l7488"><span class="linenum">7488</span></a>  <span class="comment"> * @category string</span>
<a name="l7489"><span class="linenum">7489</span></a>  <span class="comment"> * @param string $text text to be shortened</span>
<a name="l7490"><span class="linenum">7490</span></a>  <span class="comment"> * @param int $ideal ideal string length</span>
<a name="l7491"><span class="linenum">7491</span></a>  <span class="comment"> * @param boolean $exact if false, $text will not be cut mid-word</span>
<a name="l7492"><span class="linenum">7492</span></a>  <span class="comment"> * @param string $ending The string to append if the passed string is truncated</span>
<a name="l7493"><span class="linenum">7493</span></a>  <span class="comment"> * @return string $truncate shortened string</span>
<a name="l7494"><span class="linenum">7494</span></a>  <span class="comment"> */</span>
<a name="l7495"><span class="linenum">7495</span></a>  function <a class="function" onClick="logFunction('shorten_text')" href="../_functions/shorten_text.html" onMouseOver="funcPopup(event,'shorten_text')">shorten_text</a>(<a class="var it72" onMouseOver="hilite(72)" onMouseOut="lolite()" onClick="logVariable('text')" href="../_variables/text.html">$text</a>, <a class="var it13162" onMouseOver="hilite(13162)" onMouseOut="lolite()" onClick="logVariable('ideal')" href="../_variables/ideal.html">$ideal</a>=30, <a class="var it13163" onMouseOver="hilite(13163)" onMouseOut="lolite()" onClick="logVariable('exact')" href="../_variables/exact.html">$exact</a> = false, <a class="var it13164" onMouseOver="hilite(13164)" onMouseOut="lolite()" onClick="logVariable('ending')" href="../_variables/ending.html">$ending</a>='...') {
<a name="l7496"><span class="linenum">7496</span></a>  <span class="comment">    // If the plain text is shorter than the maximum length, return the whole text.</span>
<a name="l7497"><span class="linenum">7497</span></a>      if (<a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/&lt;.*?&gt;/', '', <a class="var it72" onMouseOver="hilite(72)" onMouseOut="lolite()" onClick="logVariable('text')" href="../_variables/text.html">$text</a>)) &lt;= <a class="var it13162" onMouseOver="hilite(13162)" onMouseOut="lolite()" onClick="logVariable('ideal')" href="../_variables/ideal.html">$ideal</a>) {
<a name="l7498"><span class="linenum">7498</span></a>          return <a class="var it72" onMouseOver="hilite(72)" onMouseOut="lolite()" onClick="logVariable('text')" href="../_variables/text.html">$text</a>;
<a name="l7499"><span class="linenum">7499</span></a>      }
<a name="l7500"><span class="linenum">7500</span></a>  
<a name="l7501"><span class="linenum">7501</span></a>  <span class="comment">    // Splits on HTML tags. Each open/close/empty tag will be the first thing</span>
<a name="l7502"><span class="linenum">7502</span></a>  <span class="comment">    // and only tag in its 'line'.</span>
<a name="l7503"><span class="linenum">7503</span></a>      <a class="phpfunction" onClick="logFunction('preg_match_all')" href="../_functions/preg_match_all.html" onMouseOver="phpfuncPopup(event,'preg_match_all')">preg_match_all</a>('/(&lt;.+?&gt;)?([^&lt;&gt;]*)/s', <a class="var it72" onMouseOver="hilite(72)" onMouseOut="lolite()" onClick="logVariable('text')" href="../_variables/text.html">$text</a>, <a class="var it4083" onMouseOver="hilite(4083)" onMouseOut="lolite()" onClick="logVariable('lines')" href="../_variables/lines.html">$lines</a>, PREG_SET_ORDER);
<a name="l7504"><span class="linenum">7504</span></a>  
<a name="l7505"><span class="linenum">7505</span></a>      <a class="var it13165" onMouseOver="hilite(13165)" onMouseOut="lolite()" onClick="logVariable('totallength')" href="../_variables/totallength.html">$totallength</a> = <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it13164" onMouseOver="hilite(13164)" onMouseOut="lolite()" onClick="logVariable('ending')" href="../_variables/ending.html">$ending</a>);
<a name="l7506"><span class="linenum">7506</span></a>      <a class="var it13166" onMouseOver="hilite(13166)" onMouseOut="lolite()" onClick="logVariable('truncate')" href="../_variables/truncate.html">$truncate</a> = '';
<a name="l7507"><span class="linenum">7507</span></a>  
<a name="l7508"><span class="linenum">7508</span></a>  <span class="comment">    // This array stores information about open and close tags and their position</span>
<a name="l7509"><span class="linenum">7509</span></a>  <span class="comment">    // in the truncated string. Each item in the array is an object with fields</span>
<a name="l7510"><span class="linenum">7510</span></a>  <span class="comment">    // -&gt;open (true if open), -&gt;tag (tag name in lower case), and -&gt;pos</span>
<a name="l7511"><span class="linenum">7511</span></a>  <span class="comment">    // (byte position in truncated text).</span>
<a name="l7512"><span class="linenum">7512</span></a>      <a class="var it13167" onMouseOver="hilite(13167)" onMouseOut="lolite()" onClick="logVariable('tagdetails')" href="../_variables/tagdetails.html">$tagdetails</a> = array();
<a name="l7513"><span class="linenum">7513</span></a>  
<a name="l7514"><span class="linenum">7514</span></a>      foreach (<a class="var it4083" onMouseOver="hilite(4083)" onMouseOut="lolite()" onClick="logVariable('lines')" href="../_variables/lines.html">$lines</a> as <a class="var it13168" onMouseOver="hilite(13168)" onMouseOut="lolite()" onClick="logVariable('linematchings')" href="../_variables/linematchings.html">$linematchings</a>) {
<a name="l7515"><span class="linenum">7515</span></a>  <span class="comment">        // If there is any html-tag in this line, handle it and add it (uncounted) to the output.</span>
<a name="l7516"><span class="linenum">7516</span></a>          if (!empty(<a class="var it13168" onMouseOver="hilite(13168)" onMouseOut="lolite()" onClick="logVariable('linematchings')" href="../_variables/linematchings.html">$linematchings</a>[1])) {
<a name="l7517"><span class="linenum">7517</span></a>  <span class="comment">            // If it's an &quot;empty element&quot; with or without xhtml-conform closing slash (f.e. &lt;br/&gt;).</span>
<a name="l7518"><span class="linenum">7518</span></a>              if (!<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^&lt;(\s*.+?\/\s*|\s*(img|br|input|hr|area|base|basefont|col|frame|isindex|link|meta|param)(\s.+?)?)&gt;$/is', <a class="var it13168" onMouseOver="hilite(13168)" onMouseOut="lolite()" onClick="logVariable('linematchings')" href="../_variables/linematchings.html">$linematchings</a>[1])) {
<a name="l7519"><span class="linenum">7519</span></a>                  if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^&lt;\s*\/([^\s]+?)\s*&gt;$/s', <a class="var it13168" onMouseOver="hilite(13168)" onMouseOut="lolite()" onClick="logVariable('linematchings')" href="../_variables/linematchings.html">$linematchings</a>[1], <a class="var it13169" onMouseOver="hilite(13169)" onMouseOut="lolite()" onClick="logVariable('tagmatchings')" href="../_variables/tagmatchings.html">$tagmatchings</a>)) {
<a name="l7520"><span class="linenum">7520</span></a>  <span class="comment">                    // Record closing tag.</span>
<a name="l7521"><span class="linenum">7521</span></a>                      <a class="var it13167" onMouseOver="hilite(13167)" onMouseOut="lolite()" onClick="logVariable('tagdetails')" href="../_variables/tagdetails.html">$tagdetails</a>[] = (object) array(
<a name="l7522"><span class="linenum">7522</span></a>                              'open' =&gt; false,
<a name="l7523"><span class="linenum">7523</span></a>                              'tag'  =&gt; <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it13169" onMouseOver="hilite(13169)" onMouseOut="lolite()" onClick="logVariable('tagmatchings')" href="../_variables/tagmatchings.html">$tagmatchings</a>[1]),
<a name="l7524"><span class="linenum">7524</span></a>                              'pos'  =&gt; <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it13166" onMouseOver="hilite(13166)" onMouseOut="lolite()" onClick="logVariable('truncate')" href="../_variables/truncate.html">$truncate</a>),
<a name="l7525"><span class="linenum">7525</span></a>                          );
<a name="l7526"><span class="linenum">7526</span></a>  
<a name="l7527"><span class="linenum">7527</span></a>                  } else if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^&lt;\s*([^\s&gt;!]+).*?&gt;$/s', <a class="var it13168" onMouseOver="hilite(13168)" onMouseOut="lolite()" onClick="logVariable('linematchings')" href="../_variables/linematchings.html">$linematchings</a>[1], <a class="var it13169" onMouseOver="hilite(13169)" onMouseOut="lolite()" onClick="logVariable('tagmatchings')" href="../_variables/tagmatchings.html">$tagmatchings</a>)) {
<a name="l7528"><span class="linenum">7528</span></a>  <span class="comment">                    // Record opening tag.</span>
<a name="l7529"><span class="linenum">7529</span></a>                      <a class="var it13167" onMouseOver="hilite(13167)" onMouseOut="lolite()" onClick="logVariable('tagdetails')" href="../_variables/tagdetails.html">$tagdetails</a>[] = (object) array(
<a name="l7530"><span class="linenum">7530</span></a>                              'open' =&gt; true,
<a name="l7531"><span class="linenum">7531</span></a>                              'tag'  =&gt; <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it13169" onMouseOver="hilite(13169)" onMouseOut="lolite()" onClick="logVariable('tagmatchings')" href="../_variables/tagmatchings.html">$tagmatchings</a>[1]),
<a name="l7532"><span class="linenum">7532</span></a>                              'pos'  =&gt; <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it13166" onMouseOver="hilite(13166)" onMouseOut="lolite()" onClick="logVariable('truncate')" href="../_variables/truncate.html">$truncate</a>),
<a name="l7533"><span class="linenum">7533</span></a>                          );
<a name="l7534"><span class="linenum">7534</span></a>                  }
<a name="l7535"><span class="linenum">7535</span></a>              }
<a name="l7536"><span class="linenum">7536</span></a>  <span class="comment">            // Add html-tag to $truncate'd text.</span>
<a name="l7537"><span class="linenum">7537</span></a>              <a class="var it13166" onMouseOver="hilite(13166)" onMouseOut="lolite()" onClick="logVariable('truncate')" href="../_variables/truncate.html">$truncate</a> .= <a class="var it13168" onMouseOver="hilite(13168)" onMouseOut="lolite()" onClick="logVariable('linematchings')" href="../_variables/linematchings.html">$linematchings</a>[1];
<a name="l7538"><span class="linenum">7538</span></a>          }
<a name="l7539"><span class="linenum">7539</span></a>  
<a name="l7540"><span class="linenum">7540</span></a>  <span class="comment">        // Calculate the length of the plain text part of the line; handle entities as one character.</span>
<a name="l7541"><span class="linenum">7541</span></a>          <a class="var it13170" onMouseOver="hilite(13170)" onMouseOut="lolite()" onClick="logVariable('contentlength')" href="../_variables/contentlength.html">$contentlength</a> = <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/&amp;[0-9a-z]{2,8};|&amp;#[0-9]{1,7};|&amp;#x[0-9a-f]{1,6};/i', ' ', <a class="var it13168" onMouseOver="hilite(13168)" onMouseOut="lolite()" onClick="logVariable('linematchings')" href="../_variables/linematchings.html">$linematchings</a>[2]));
<a name="l7542"><span class="linenum">7542</span></a>          if (<a class="var it13165" onMouseOver="hilite(13165)" onMouseOut="lolite()" onClick="logVariable('totallength')" href="../_variables/totallength.html">$totallength</a> + <a class="var it13170" onMouseOver="hilite(13170)" onMouseOut="lolite()" onClick="logVariable('contentlength')" href="../_variables/contentlength.html">$contentlength</a> &gt; <a class="var it13162" onMouseOver="hilite(13162)" onMouseOut="lolite()" onClick="logVariable('ideal')" href="../_variables/ideal.html">$ideal</a>) {
<a name="l7543"><span class="linenum">7543</span></a>  <span class="comment">            // The number of characters which are left.</span>
<a name="l7544"><span class="linenum">7544</span></a>              <a class="var it1347" onMouseOver="hilite(1347)" onMouseOut="lolite()" onClick="logVariable('left')" href="../_variables/left.html">$left</a> = <a class="var it13162" onMouseOver="hilite(13162)" onMouseOut="lolite()" onClick="logVariable('ideal')" href="../_variables/ideal.html">$ideal</a> - <a class="var it13165" onMouseOver="hilite(13165)" onMouseOut="lolite()" onClick="logVariable('totallength')" href="../_variables/totallength.html">$totallength</a>;
<a name="l7545"><span class="linenum">7545</span></a>              <a class="var it13171" onMouseOver="hilite(13171)" onMouseOut="lolite()" onClick="logVariable('entitieslength')" href="../_variables/entitieslength.html">$entitieslength</a> = 0;
<a name="l7546"><span class="linenum">7546</span></a>  <span class="comment">            // Search for html entities.</span>
<a name="l7547"><span class="linenum">7547</span></a>              if (<a class="phpfunction" onClick="logFunction('preg_match_all')" href="../_functions/preg_match_all.html" onMouseOver="phpfuncPopup(event,'preg_match_all')">preg_match_all</a>('/&amp;[0-9a-z]{2,8};|&amp;#[0-9]{1,7};|&amp;#x[0-9a-f]{1,6};/i', <a class="var it13168" onMouseOver="hilite(13168)" onMouseOut="lolite()" onClick="logVariable('linematchings')" href="../_variables/linematchings.html">$linematchings</a>[2], <a class="var it5159" onMouseOver="hilite(5159)" onMouseOut="lolite()" onClick="logVariable('entities')" href="../_variables/entities.html">$entities</a>, PREG_OFFSET_CAPTURE)) {
<a name="l7548"><span class="linenum">7548</span></a>  <span class="comment">                // Calculate the real length of all entities in the legal range.</span>
<a name="l7549"><span class="linenum">7549</span></a>                  foreach (<a class="var it5159" onMouseOver="hilite(5159)" onMouseOut="lolite()" onClick="logVariable('entities')" href="../_variables/entities.html">$entities</a>[0] as <a class="var it9193" onMouseOver="hilite(9193)" onMouseOut="lolite()" onClick="logVariable('entity')" href="../_variables/entity.html">$entity</a>) {
<a name="l7550"><span class="linenum">7550</span></a>                      if (<a class="var it9193" onMouseOver="hilite(9193)" onMouseOut="lolite()" onClick="logVariable('entity')" href="../_variables/entity.html">$entity</a>[1]+1-<a class="var it13171" onMouseOver="hilite(13171)" onMouseOut="lolite()" onClick="logVariable('entitieslength')" href="../_variables/entitieslength.html">$entitieslength</a> &lt;= <a class="var it1347" onMouseOver="hilite(1347)" onMouseOut="lolite()" onClick="logVariable('left')" href="../_variables/left.html">$left</a>) {
<a name="l7551"><span class="linenum">7551</span></a>                          <a class="var it1347" onMouseOver="hilite(1347)" onMouseOut="lolite()" onClick="logVariable('left')" href="../_variables/left.html">$left</a>--;
<a name="l7552"><span class="linenum">7552</span></a>                          <a class="var it13171" onMouseOver="hilite(13171)" onMouseOut="lolite()" onClick="logVariable('entitieslength')" href="../_variables/entitieslength.html">$entitieslength</a> += <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it9193" onMouseOver="hilite(9193)" onMouseOut="lolite()" onClick="logVariable('entity')" href="../_variables/entity.html">$entity</a>[0]);
<a name="l7553"><span class="linenum">7553</span></a>                      } else {
<a name="l7554"><span class="linenum">7554</span></a>  <span class="comment">                        // No more characters left.</span>
<a name="l7555"><span class="linenum">7555</span></a>                          break;
<a name="l7556"><span class="linenum">7556</span></a>                      }
<a name="l7557"><span class="linenum">7557</span></a>                  }
<a name="l7558"><span class="linenum">7558</span></a>              }
<a name="l7559"><span class="linenum">7559</span></a>              <a class="var it13172" onMouseOver="hilite(13172)" onMouseOut="lolite()" onClick="logVariable('breakpos')" href="../_variables/breakpos.html">$breakpos</a> = <a class="var it1347" onMouseOver="hilite(1347)" onMouseOut="lolite()" onClick="logVariable('left')" href="../_variables/left.html">$left</a> + <a class="var it13171" onMouseOver="hilite(13171)" onMouseOut="lolite()" onClick="logVariable('entitieslength')" href="../_variables/entitieslength.html">$entitieslength</a>;
<a name="l7560"><span class="linenum">7560</span></a>  
<a name="l7561"><span class="linenum">7561</span></a>  <span class="comment">            // If the words shouldn't be cut in the middle...</span>
<a name="l7562"><span class="linenum">7562</span></a>              if (!<a class="var it13163" onMouseOver="hilite(13163)" onMouseOut="lolite()" onClick="logVariable('exact')" href="../_variables/exact.html">$exact</a>) {
<a name="l7563"><span class="linenum">7563</span></a>  <span class="comment">                // Search the last occurence of a space.</span>
<a name="l7564"><span class="linenum">7564</span></a>                  for (; <a class="var it13172" onMouseOver="hilite(13172)" onMouseOut="lolite()" onClick="logVariable('breakpos')" href="../_variables/breakpos.html">$breakpos</a> &gt; 0; <a class="var it13172" onMouseOver="hilite(13172)" onMouseOut="lolite()" onClick="logVariable('breakpos')" href="../_variables/breakpos.html">$breakpos</a>--) {
<a name="l7565"><span class="linenum">7565</span></a>                      if (<a class="var it2425" onMouseOver="hilite(2425)" onMouseOut="lolite()" onClick="logVariable('char')" href="../_variables/char.html">$char</a> = <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it13168" onMouseOver="hilite(13168)" onMouseOut="lolite()" onClick="logVariable('linematchings')" href="../_variables/linematchings.html">$linematchings</a>[2], <a class="var it13172" onMouseOver="hilite(13172)" onMouseOut="lolite()" onClick="logVariable('breakpos')" href="../_variables/breakpos.html">$breakpos</a>, 1)) {
<a name="l7566"><span class="linenum">7566</span></a>                          if (<a class="var it2425" onMouseOver="hilite(2425)" onMouseOut="lolite()" onClick="logVariable('char')" href="../_variables/char.html">$char</a> === '.' or <a class="var it2425" onMouseOver="hilite(2425)" onMouseOut="lolite()" onClick="logVariable('char')" href="../_variables/char.html">$char</a> === ' ') {
<a name="l7567"><span class="linenum">7567</span></a>                              <a class="var it13172" onMouseOver="hilite(13172)" onMouseOut="lolite()" onClick="logVariable('breakpos')" href="../_variables/breakpos.html">$breakpos</a> += 1;
<a name="l7568"><span class="linenum">7568</span></a>                              break;
<a name="l7569"><span class="linenum">7569</span></a>                          } else if (<a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it2425" onMouseOver="hilite(2425)" onMouseOut="lolite()" onClick="logVariable('char')" href="../_variables/char.html">$char</a>) &gt; 2) {
<a name="l7570"><span class="linenum">7570</span></a>  <span class="comment">                            // Chinese/Japanese/Korean text can be truncated at any UTF-8 character boundary.</span>
<a name="l7571"><span class="linenum">7571</span></a>                              <a class="var it13172" onMouseOver="hilite(13172)" onMouseOut="lolite()" onClick="logVariable('breakpos')" href="../_variables/breakpos.html">$breakpos</a> += 1;
<a name="l7572"><span class="linenum">7572</span></a>                              break;
<a name="l7573"><span class="linenum">7573</span></a>                          }
<a name="l7574"><span class="linenum">7574</span></a>                      }
<a name="l7575"><span class="linenum">7575</span></a>                  }
<a name="l7576"><span class="linenum">7576</span></a>              }
<a name="l7577"><span class="linenum">7577</span></a>              if (<a class="var it13172" onMouseOver="hilite(13172)" onMouseOut="lolite()" onClick="logVariable('breakpos')" href="../_variables/breakpos.html">$breakpos</a> == 0) {
<a name="l7578"><span class="linenum">7578</span></a>  <span class="comment">                // This deals with the test_shorten_text_no_spaces case.</span>
<a name="l7579"><span class="linenum">7579</span></a>                  <a class="var it13172" onMouseOver="hilite(13172)" onMouseOut="lolite()" onClick="logVariable('breakpos')" href="../_variables/breakpos.html">$breakpos</a> = <a class="var it1347" onMouseOver="hilite(1347)" onMouseOut="lolite()" onClick="logVariable('left')" href="../_variables/left.html">$left</a> + <a class="var it13171" onMouseOver="hilite(13171)" onMouseOut="lolite()" onClick="logVariable('entitieslength')" href="../_variables/entitieslength.html">$entitieslength</a>;
<a name="l7580"><span class="linenum">7580</span></a>              } else if (<a class="var it13172" onMouseOver="hilite(13172)" onMouseOut="lolite()" onClick="logVariable('breakpos')" href="../_variables/breakpos.html">$breakpos</a> &gt; <a class="var it1347" onMouseOver="hilite(1347)" onMouseOut="lolite()" onClick="logVariable('left')" href="../_variables/left.html">$left</a> + <a class="var it13171" onMouseOver="hilite(13171)" onMouseOut="lolite()" onClick="logVariable('entitieslength')" href="../_variables/entitieslength.html">$entitieslength</a>) {
<a name="l7581"><span class="linenum">7581</span></a>  <span class="comment">                // This deals with the previous for loop breaking on the first char.</span>
<a name="l7582"><span class="linenum">7582</span></a>                  <a class="var it13172" onMouseOver="hilite(13172)" onMouseOut="lolite()" onClick="logVariable('breakpos')" href="../_variables/breakpos.html">$breakpos</a> = <a class="var it1347" onMouseOver="hilite(1347)" onMouseOut="lolite()" onClick="logVariable('left')" href="../_variables/left.html">$left</a> + <a class="var it13171" onMouseOver="hilite(13171)" onMouseOut="lolite()" onClick="logVariable('entitieslength')" href="../_variables/entitieslength.html">$entitieslength</a>;
<a name="l7583"><span class="linenum">7583</span></a>              }
<a name="l7584"><span class="linenum">7584</span></a>  
<a name="l7585"><span class="linenum">7585</span></a>              <a class="var it13166" onMouseOver="hilite(13166)" onMouseOut="lolite()" onClick="logVariable('truncate')" href="../_variables/truncate.html">$truncate</a> .= <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it13168" onMouseOver="hilite(13168)" onMouseOut="lolite()" onClick="logVariable('linematchings')" href="../_variables/linematchings.html">$linematchings</a>[2], 0, <a class="var it13172" onMouseOver="hilite(13172)" onMouseOut="lolite()" onClick="logVariable('breakpos')" href="../_variables/breakpos.html">$breakpos</a>);
<a name="l7586"><span class="linenum">7586</span></a>  <span class="comment">            // Maximum length is reached, so get off the loop.</span>
<a name="l7587"><span class="linenum">7587</span></a>              break;
<a name="l7588"><span class="linenum">7588</span></a>          } else {
<a name="l7589"><span class="linenum">7589</span></a>              <a class="var it13166" onMouseOver="hilite(13166)" onMouseOut="lolite()" onClick="logVariable('truncate')" href="../_variables/truncate.html">$truncate</a> .= <a class="var it13168" onMouseOver="hilite(13168)" onMouseOut="lolite()" onClick="logVariable('linematchings')" href="../_variables/linematchings.html">$linematchings</a>[2];
<a name="l7590"><span class="linenum">7590</span></a>              <a class="var it13165" onMouseOver="hilite(13165)" onMouseOut="lolite()" onClick="logVariable('totallength')" href="../_variables/totallength.html">$totallength</a> += <a class="var it13170" onMouseOver="hilite(13170)" onMouseOut="lolite()" onClick="logVariable('contentlength')" href="../_variables/contentlength.html">$contentlength</a>;
<a name="l7591"><span class="linenum">7591</span></a>          }
<a name="l7592"><span class="linenum">7592</span></a>  
<a name="l7593"><span class="linenum">7593</span></a>  <span class="comment">        // If the maximum length is reached, get off the loop.</span>
<a name="l7594"><span class="linenum">7594</span></a>          if (<a class="var it13165" onMouseOver="hilite(13165)" onMouseOut="lolite()" onClick="logVariable('totallength')" href="../_variables/totallength.html">$totallength</a> &gt;= <a class="var it13162" onMouseOver="hilite(13162)" onMouseOut="lolite()" onClick="logVariable('ideal')" href="../_variables/ideal.html">$ideal</a>) {
<a name="l7595"><span class="linenum">7595</span></a>              break;
<a name="l7596"><span class="linenum">7596</span></a>          }
<a name="l7597"><span class="linenum">7597</span></a>      }
<a name="l7598"><span class="linenum">7598</span></a>  
<a name="l7599"><span class="linenum">7599</span></a>  <span class="comment">    // Add the defined ending to the text.</span>
<a name="l7600"><span class="linenum">7600</span></a>      <a class="var it13166" onMouseOver="hilite(13166)" onMouseOut="lolite()" onClick="logVariable('truncate')" href="../_variables/truncate.html">$truncate</a> .= <a class="var it13164" onMouseOver="hilite(13164)" onMouseOut="lolite()" onClick="logVariable('ending')" href="../_variables/ending.html">$ending</a>;
<a name="l7601"><span class="linenum">7601</span></a>  
<a name="l7602"><span class="linenum">7602</span></a>  <span class="comment">    // Now calculate the list of open html tags based on the truncate position.</span>
<a name="l7603"><span class="linenum">7603</span></a>      <a class="var it13173" onMouseOver="hilite(13173)" onMouseOut="lolite()" onClick="logVariable('opentags')" href="../_variables/opentags.html">$opentags</a> = array();
<a name="l7604"><span class="linenum">7604</span></a>      foreach (<a class="var it13167" onMouseOver="hilite(13167)" onMouseOut="lolite()" onClick="logVariable('tagdetails')" href="../_variables/tagdetails.html">$tagdetails</a> as <a class="var it13174" onMouseOver="hilite(13174)" onMouseOut="lolite()" onClick="logVariable('taginfo')" href="../_variables/taginfo.html">$taginfo</a>) {
<a name="l7605"><span class="linenum">7605</span></a>          if (<a class="var it13174" onMouseOver="hilite(13174)" onMouseOut="lolite()" onClick="logVariable('taginfo')" href="../_variables/taginfo.html">$taginfo</a>-&gt;<a onClick="logVariable('open')" class="var it41078" onMouseOver="hilite(41078)" onMouseOut="lolite()" href="../_variables/open.html">open</a>) {
<a name="l7606"><span class="linenum">7606</span></a>  <span class="comment">            // Add tag to the beginning of $opentags list.</span>
<a name="l7607"><span class="linenum">7607</span></a>              <a class="phpfunction" onClick="logFunction('array_unshift')" href="../_functions/array_unshift.html" onMouseOver="phpfuncPopup(event,'array_unshift')">array_unshift</a>(<a class="var it13173" onMouseOver="hilite(13173)" onMouseOut="lolite()" onClick="logVariable('opentags')" href="../_variables/opentags.html">$opentags</a>, <a class="var it13174" onMouseOver="hilite(13174)" onMouseOut="lolite()" onClick="logVariable('taginfo')" href="../_variables/taginfo.html">$taginfo</a>-&gt;<a onClick="logVariable('tag')" class="var it41078" onMouseOver="hilite(41078)" onMouseOut="lolite()" href="../_variables/tag.html">tag</a>);
<a name="l7608"><span class="linenum">7608</span></a>          } else {
<a name="l7609"><span class="linenum">7609</span></a>  <span class="comment">            // Can have multiple exact same open tags, close the last one.</span>
<a name="l7610"><span class="linenum">7610</span></a>              <a class="var it3230" onMouseOver="hilite(3230)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../_variables/pos.html">$pos</a> = <a class="phpfunction" onClick="logFunction('array_search')" href="../_functions/array_search.html" onMouseOver="phpfuncPopup(event,'array_search')">array_search</a>(<a class="var it13174" onMouseOver="hilite(13174)" onMouseOut="lolite()" onClick="logVariable('taginfo')" href="../_variables/taginfo.html">$taginfo</a>-&gt;<a onClick="logVariable('tag')" class="var it41078" onMouseOver="hilite(41078)" onMouseOut="lolite()" href="../_variables/tag.html">tag</a>, <a class="phpfunction" onClick="logFunction('array_reverse')" href="../_functions/array_reverse.html" onMouseOver="phpfuncPopup(event,'array_reverse')">array_reverse</a>(<a class="var it13173" onMouseOver="hilite(13173)" onMouseOut="lolite()" onClick="logVariable('opentags')" href="../_variables/opentags.html">$opentags</a>, true));
<a name="l7611"><span class="linenum">7611</span></a>              if (<a class="var it3230" onMouseOver="hilite(3230)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../_variables/pos.html">$pos</a> !== false) {
<a name="l7612"><span class="linenum">7612</span></a>                  unset(<a class="var it13173" onMouseOver="hilite(13173)" onMouseOut="lolite()" onClick="logVariable('opentags')" href="../_variables/opentags.html">$opentags</a>[<a class="var it3230" onMouseOver="hilite(3230)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../_variables/pos.html">$pos</a>]);
<a name="l7613"><span class="linenum">7613</span></a>              }
<a name="l7614"><span class="linenum">7614</span></a>          }
<a name="l7615"><span class="linenum">7615</span></a>      }
<a name="l7616"><span class="linenum">7616</span></a>  
<a name="l7617"><span class="linenum">7617</span></a>  <span class="comment">    // Close all unclosed html-tags.</span>
<a name="l7618"><span class="linenum">7618</span></a>      foreach (<a class="var it13173" onMouseOver="hilite(13173)" onMouseOut="lolite()" onClick="logVariable('opentags')" href="../_variables/opentags.html">$opentags</a> as <a class="var it255" onMouseOver="hilite(255)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../_variables/tag.html">$tag</a>) {
<a name="l7619"><span class="linenum">7619</span></a>          <a class="var it13166" onMouseOver="hilite(13166)" onMouseOut="lolite()" onClick="logVariable('truncate')" href="../_variables/truncate.html">$truncate</a> .= '&lt;/' . <a class="var it255" onMouseOver="hilite(255)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../_variables/tag.html">$tag</a> . '&gt;';
<a name="l7620"><span class="linenum">7620</span></a>      }
<a name="l7621"><span class="linenum">7621</span></a>  
<a name="l7622"><span class="linenum">7622</span></a>      return <a class="var it13166" onMouseOver="hilite(13166)" onMouseOut="lolite()" onClick="logVariable('truncate')" href="../_variables/truncate.html">$truncate</a>;
<a name="l7623"><span class="linenum">7623</span></a>  }
<a name="l7624"><span class="linenum">7624</span></a>  
<a name="l7625"><span class="linenum">7625</span></a>  
<a name="l7626"><span class="linenum">7626</span></a>  <span class="comment">/**</span>
<a name="l7627"><span class="linenum">7627</span></a>  <span class="comment"> * Given dates in seconds, how many weeks is the date from startdate</span>
<a name="l7628"><span class="linenum">7628</span></a>  <span class="comment"> * The first week is 1, the second 2 etc ...</span>
<a name="l7629"><span class="linenum">7629</span></a>  <span class="comment"> *</span>
<a name="l7630"><span class="linenum">7630</span></a>  <span class="comment"> * @param int $startdate Timestamp for the start date</span>
<a name="l7631"><span class="linenum">7631</span></a>  <span class="comment"> * @param int $thedate Timestamp for the end date</span>
<a name="l7632"><span class="linenum">7632</span></a>  <span class="comment"> * @return string</span>
<a name="l7633"><span class="linenum">7633</span></a>  <span class="comment"> */</span>
<a name="l7634"><span class="linenum">7634</span></a>  function <a class="function" onClick="logFunction('getweek')" href="../_functions/getweek.html" onMouseOver="funcPopup(event,'getweek')">getweek</a> (<a class="var it6078" onMouseOver="hilite(6078)" onMouseOut="lolite()" onClick="logVariable('startdate')" href="../_variables/startdate.html">$startdate</a>, <a class="var it13175" onMouseOver="hilite(13175)" onMouseOut="lolite()" onClick="logVariable('thedate')" href="../_variables/thedate.html">$thedate</a>) {
<a name="l7635"><span class="linenum">7635</span></a>      if (<a class="var it13175" onMouseOver="hilite(13175)" onMouseOut="lolite()" onClick="logVariable('thedate')" href="../_variables/thedate.html">$thedate</a> &lt; <a class="var it6078" onMouseOver="hilite(6078)" onMouseOut="lolite()" onClick="logVariable('startdate')" href="../_variables/startdate.html">$startdate</a>) {
<a name="l7636"><span class="linenum">7636</span></a>          return 0;
<a name="l7637"><span class="linenum">7637</span></a>      }
<a name="l7638"><span class="linenum">7638</span></a>  
<a name="l7639"><span class="linenum">7639</span></a>      return <a class="phpfunction" onClick="logFunction('floor')" href="../_functions/floor.html" onMouseOver="phpfuncPopup(event,'floor')">floor</a>((<a class="var it13175" onMouseOver="hilite(13175)" onMouseOut="lolite()" onClick="logVariable('thedate')" href="../_variables/thedate.html">$thedate</a> - <a class="var it6078" onMouseOver="hilite(6078)" onMouseOut="lolite()" onClick="logVariable('startdate')" href="../_variables/startdate.html">$startdate</a>) / <a class="constant" onClick="logConstant('WEEKSECS')" href="../_constants/WEEKSECS.html" onMouseOver="constPopup(event,'WEEKSECS')">WEEKSECS</a>) + 1;
<a name="l7640"><span class="linenum">7640</span></a>  }
<a name="l7641"><span class="linenum">7641</span></a>  
<a name="l7642"><span class="linenum">7642</span></a>  <span class="comment">/**</span>
<a name="l7643"><span class="linenum">7643</span></a>  <span class="comment"> * Returns a randomly generated password of length $maxlen.  inspired by</span>
<a name="l7644"><span class="linenum">7644</span></a>  <span class="comment"> *</span>
<a name="l7645"><span class="linenum">7645</span></a>  <span class="comment"> * {@link http://www.phpbuilder.com/columns/jesus19990502.php3} and</span>
<a name="l7646"><span class="linenum">7646</span></a>  <span class="comment"> * {@link http://es2.php.net/manual/en/function.str-shuffle.php#73254}</span>
<a name="l7647"><span class="linenum">7647</span></a>  <span class="comment"> *</span>
<a name="l7648"><span class="linenum">7648</span></a>  <span class="comment"> * @param int $maxlen  The maximum size of the password being generated.</span>
<a name="l7649"><span class="linenum">7649</span></a>  <span class="comment"> * @return string</span>
<a name="l7650"><span class="linenum">7650</span></a>  <span class="comment"> */</span>
<a name="l7651"><span class="linenum">7651</span></a>  function <a class="function" onClick="logFunction('generate_password')" href="../_functions/generate_password.html" onMouseOver="funcPopup(event,'generate_password')">generate_password</a>(<a class="var it3615" onMouseOver="hilite(3615)" onMouseOut="lolite()" onClick="logVariable('maxlen')" href="../_variables/maxlen.html">$maxlen</a>=10) {
<a name="l7652"><span class="linenum">7652</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l7653"><span class="linenum">7653</span></a>  
<a name="l7654"><span class="linenum">7654</span></a>      if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('passwordpolicy')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/passwordpolicy.html">passwordpolicy</a>)) {
<a name="l7655"><span class="linenum">7655</span></a>          <a class="var it13176" onMouseOver="hilite(13176)" onMouseOut="lolite()" onClick="logVariable('fillers')" href="../_variables/fillers.html">$fillers</a> = <a class="constant" onClick="logConstant('PASSWORD_DIGITS')" href="../_constants/PASSWORD_DIGITS.html" onMouseOver="constPopup(event,'PASSWORD_DIGITS')">PASSWORD_DIGITS</a>;
<a name="l7656"><span class="linenum">7656</span></a>          <a class="var it13177" onMouseOver="hilite(13177)" onMouseOut="lolite()" onClick="logVariable('wordlist')" href="../_variables/wordlist.html">$wordlist</a> = <a class="phpfunction" onClick="logFunction('file')" href="../_functions/file.html" onMouseOver="phpfuncPopup(event,'file')">file</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wordlist')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wordlist.html">wordlist</a>);
<a name="l7657"><span class="linenum">7657</span></a>          <a class="var it13178" onMouseOver="hilite(13178)" onMouseOut="lolite()" onClick="logVariable('word1')" href="../_variables/word1.html">$word1</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it13177" onMouseOver="hilite(13177)" onMouseOut="lolite()" onClick="logVariable('wordlist')" href="../_variables/wordlist.html">$wordlist</a>[<a class="phpfunction" onClick="logFunction('rand')" href="../_functions/rand.html" onMouseOver="phpfuncPopup(event,'rand')">rand</a>(0, <a class="phpfunction" onClick="logFunction('count')" href="../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it13177" onMouseOver="hilite(13177)" onMouseOut="lolite()" onClick="logVariable('wordlist')" href="../_variables/wordlist.html">$wordlist</a>) - 1)]);
<a name="l7658"><span class="linenum">7658</span></a>          <a class="var it13179" onMouseOver="hilite(13179)" onMouseOut="lolite()" onClick="logVariable('word2')" href="../_variables/word2.html">$word2</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it13177" onMouseOver="hilite(13177)" onMouseOut="lolite()" onClick="logVariable('wordlist')" href="../_variables/wordlist.html">$wordlist</a>[<a class="phpfunction" onClick="logFunction('rand')" href="../_functions/rand.html" onMouseOver="phpfuncPopup(event,'rand')">rand</a>(0, <a class="phpfunction" onClick="logFunction('count')" href="../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it13177" onMouseOver="hilite(13177)" onMouseOut="lolite()" onClick="logVariable('wordlist')" href="../_variables/wordlist.html">$wordlist</a>) - 1)]);
<a name="l7659"><span class="linenum">7659</span></a>          <a class="var it13180" onMouseOver="hilite(13180)" onMouseOut="lolite()" onClick="logVariable('filler1')" href="../_variables/filler1.html">$filler1</a> = <a class="var it13176" onMouseOver="hilite(13176)" onMouseOut="lolite()" onClick="logVariable('fillers')" href="../_variables/fillers.html">$fillers</a>[<a class="phpfunction" onClick="logFunction('rand')" href="../_functions/rand.html" onMouseOver="phpfuncPopup(event,'rand')">rand</a>(0, <a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it13176" onMouseOver="hilite(13176)" onMouseOut="lolite()" onClick="logVariable('fillers')" href="../_variables/fillers.html">$fillers</a>) - 1)];
<a name="l7660"><span class="linenum">7660</span></a>          <a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a> = <a class="var it13178" onMouseOver="hilite(13178)" onMouseOut="lolite()" onClick="logVariable('word1')" href="../_variables/word1.html">$word1</a> . <a class="var it13180" onMouseOver="hilite(13180)" onMouseOut="lolite()" onClick="logVariable('filler1')" href="../_variables/filler1.html">$filler1</a> . <a class="var it13179" onMouseOver="hilite(13179)" onMouseOut="lolite()" onClick="logVariable('word2')" href="../_variables/word2.html">$word2</a>;
<a name="l7661"><span class="linenum">7661</span></a>      } else {
<a name="l7662"><span class="linenum">7662</span></a>          <a class="var it13181" onMouseOver="hilite(13181)" onMouseOut="lolite()" onClick="logVariable('minlen')" href="../_variables/minlen.html">$minlen</a> = !empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('minpasswordlength')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/minpasswordlength.html">minpasswordlength</a>) ? <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('minpasswordlength')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/minpasswordlength.html">minpasswordlength</a> : 0;
<a name="l7663"><span class="linenum">7663</span></a>          <a class="var it4408" onMouseOver="hilite(4408)" onMouseOut="lolite()" onClick="logVariable('digits')" href="../_variables/digits.html">$digits</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('minpassworddigits')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/minpassworddigits.html">minpassworddigits</a>;
<a name="l7664"><span class="linenum">7664</span></a>          <a class="var it13182" onMouseOver="hilite(13182)" onMouseOut="lolite()" onClick="logVariable('lower')" href="../_variables/lower.html">$lower</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('minpasswordlower')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/minpasswordlower.html">minpasswordlower</a>;
<a name="l7665"><span class="linenum">7665</span></a>          <a class="var it4066" onMouseOver="hilite(4066)" onMouseOut="lolite()" onClick="logVariable('upper')" href="../_variables/upper.html">$upper</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('minpasswordupper')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/minpasswordupper.html">minpasswordupper</a>;
<a name="l7666"><span class="linenum">7666</span></a>          <a class="var it13183" onMouseOver="hilite(13183)" onMouseOut="lolite()" onClick="logVariable('nonalphanum')" href="../_variables/nonalphanum.html">$nonalphanum</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('minpasswordnonalphanum')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/minpasswordnonalphanum.html">minpasswordnonalphanum</a>;
<a name="l7667"><span class="linenum">7667</span></a>          <a class="var it364" onMouseOver="hilite(364)" onMouseOut="lolite()" onClick="logVariable('total')" href="../_variables/total.html">$total</a> = <a class="var it13182" onMouseOver="hilite(13182)" onMouseOut="lolite()" onClick="logVariable('lower')" href="../_variables/lower.html">$lower</a> + <a class="var it4066" onMouseOver="hilite(4066)" onMouseOut="lolite()" onClick="logVariable('upper')" href="../_variables/upper.html">$upper</a> + <a class="var it4408" onMouseOver="hilite(4408)" onMouseOut="lolite()" onClick="logVariable('digits')" href="../_variables/digits.html">$digits</a> + <a class="var it13183" onMouseOver="hilite(13183)" onMouseOut="lolite()" onClick="logVariable('nonalphanum')" href="../_variables/nonalphanum.html">$nonalphanum</a>;
<a name="l7668"><span class="linenum">7668</span></a>  <span class="comment">        // Var minlength should be the greater one of the two ( $minlen and $total ).</span>
<a name="l7669"><span class="linenum">7669</span></a>          <a class="var it13181" onMouseOver="hilite(13181)" onMouseOut="lolite()" onClick="logVariable('minlen')" href="../_variables/minlen.html">$minlen</a> = <a class="var it13181" onMouseOver="hilite(13181)" onMouseOut="lolite()" onClick="logVariable('minlen')" href="../_variables/minlen.html">$minlen</a> &lt; <a class="var it364" onMouseOver="hilite(364)" onMouseOut="lolite()" onClick="logVariable('total')" href="../_variables/total.html">$total</a> ? <a class="var it364" onMouseOver="hilite(364)" onMouseOut="lolite()" onClick="logVariable('total')" href="../_variables/total.html">$total</a> : <a class="var it13181" onMouseOver="hilite(13181)" onMouseOut="lolite()" onClick="logVariable('minlen')" href="../_variables/minlen.html">$minlen</a>;
<a name="l7670"><span class="linenum">7670</span></a>  <span class="comment">        // Var maxlen can never be smaller than minlen.</span>
<a name="l7671"><span class="linenum">7671</span></a>          <a class="var it3615" onMouseOver="hilite(3615)" onMouseOut="lolite()" onClick="logVariable('maxlen')" href="../_variables/maxlen.html">$maxlen</a> = <a class="var it13181" onMouseOver="hilite(13181)" onMouseOut="lolite()" onClick="logVariable('minlen')" href="../_variables/minlen.html">$minlen</a> &gt; <a class="var it3615" onMouseOver="hilite(3615)" onMouseOut="lolite()" onClick="logVariable('maxlen')" href="../_variables/maxlen.html">$maxlen</a> ? <a class="var it13181" onMouseOver="hilite(13181)" onMouseOut="lolite()" onClick="logVariable('minlen')" href="../_variables/minlen.html">$minlen</a> : <a class="var it3615" onMouseOver="hilite(3615)" onMouseOut="lolite()" onClick="logVariable('maxlen')" href="../_variables/maxlen.html">$maxlen</a>;
<a name="l7672"><span class="linenum">7672</span></a>          <a class="var it1425" onMouseOver="hilite(1425)" onMouseOut="lolite()" onClick="logVariable('additional')" href="../_variables/additional.html">$additional</a> = <a class="var it3615" onMouseOver="hilite(3615)" onMouseOut="lolite()" onClick="logVariable('maxlen')" href="../_variables/maxlen.html">$maxlen</a> - <a class="var it364" onMouseOver="hilite(364)" onMouseOut="lolite()" onClick="logVariable('total')" href="../_variables/total.html">$total</a>;
<a name="l7673"><span class="linenum">7673</span></a>  
<a name="l7674"><span class="linenum">7674</span></a>  <span class="comment">        // Make sure we have enough characters to fulfill</span>
<a name="l7675"><span class="linenum">7675</span></a>  <span class="comment">        // complexity requirements.</span>
<a name="l7676"><span class="linenum">7676</span></a>          <a class="var it13184" onMouseOver="hilite(13184)" onMouseOut="lolite()" onClick="logVariable('passworddigits')" href="../_variables/passworddigits.html">$passworddigits</a> = <a class="constant" onClick="logConstant('PASSWORD_DIGITS')" href="../_constants/PASSWORD_DIGITS.html" onMouseOver="constPopup(event,'PASSWORD_DIGITS')">PASSWORD_DIGITS</a>;
<a name="l7677"><span class="linenum">7677</span></a>          while (<a class="var it4408" onMouseOver="hilite(4408)" onMouseOut="lolite()" onClick="logVariable('digits')" href="../_variables/digits.html">$digits</a> &gt; <a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it13184" onMouseOver="hilite(13184)" onMouseOut="lolite()" onClick="logVariable('passworddigits')" href="../_variables/passworddigits.html">$passworddigits</a>)) {
<a name="l7678"><span class="linenum">7678</span></a>              <a class="var it13184" onMouseOver="hilite(13184)" onMouseOut="lolite()" onClick="logVariable('passworddigits')" href="../_variables/passworddigits.html">$passworddigits</a> .= <a class="constant" onClick="logConstant('PASSWORD_DIGITS')" href="../_constants/PASSWORD_DIGITS.html" onMouseOver="constPopup(event,'PASSWORD_DIGITS')">PASSWORD_DIGITS</a>;
<a name="l7679"><span class="linenum">7679</span></a>          }
<a name="l7680"><span class="linenum">7680</span></a>          <a class="var it13185" onMouseOver="hilite(13185)" onMouseOut="lolite()" onClick="logVariable('passwordlower')" href="../_variables/passwordlower.html">$passwordlower</a> = <a class="constant" onClick="logConstant('PASSWORD_LOWER')" href="../_constants/PASSWORD_LOWER.html" onMouseOver="constPopup(event,'PASSWORD_LOWER')">PASSWORD_LOWER</a>;
<a name="l7681"><span class="linenum">7681</span></a>          while (<a class="var it13182" onMouseOver="hilite(13182)" onMouseOut="lolite()" onClick="logVariable('lower')" href="../_variables/lower.html">$lower</a> &gt; <a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it13185" onMouseOver="hilite(13185)" onMouseOut="lolite()" onClick="logVariable('passwordlower')" href="../_variables/passwordlower.html">$passwordlower</a>)) {
<a name="l7682"><span class="linenum">7682</span></a>              <a class="var it13185" onMouseOver="hilite(13185)" onMouseOut="lolite()" onClick="logVariable('passwordlower')" href="../_variables/passwordlower.html">$passwordlower</a> .= <a class="constant" onClick="logConstant('PASSWORD_LOWER')" href="../_constants/PASSWORD_LOWER.html" onMouseOver="constPopup(event,'PASSWORD_LOWER')">PASSWORD_LOWER</a>;
<a name="l7683"><span class="linenum">7683</span></a>          }
<a name="l7684"><span class="linenum">7684</span></a>          <a class="var it13186" onMouseOver="hilite(13186)" onMouseOut="lolite()" onClick="logVariable('passwordupper')" href="../_variables/passwordupper.html">$passwordupper</a> = <a class="constant" onClick="logConstant('PASSWORD_UPPER')" href="../_constants/PASSWORD_UPPER.html" onMouseOver="constPopup(event,'PASSWORD_UPPER')">PASSWORD_UPPER</a>;
<a name="l7685"><span class="linenum">7685</span></a>          while (<a class="var it4066" onMouseOver="hilite(4066)" onMouseOut="lolite()" onClick="logVariable('upper')" href="../_variables/upper.html">$upper</a> &gt; <a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it13186" onMouseOver="hilite(13186)" onMouseOut="lolite()" onClick="logVariable('passwordupper')" href="../_variables/passwordupper.html">$passwordupper</a>)) {
<a name="l7686"><span class="linenum">7686</span></a>              <a class="var it13186" onMouseOver="hilite(13186)" onMouseOut="lolite()" onClick="logVariable('passwordupper')" href="../_variables/passwordupper.html">$passwordupper</a> .= <a class="constant" onClick="logConstant('PASSWORD_UPPER')" href="../_constants/PASSWORD_UPPER.html" onMouseOver="constPopup(event,'PASSWORD_UPPER')">PASSWORD_UPPER</a>;
<a name="l7687"><span class="linenum">7687</span></a>          }
<a name="l7688"><span class="linenum">7688</span></a>          <a class="var it13187" onMouseOver="hilite(13187)" onMouseOut="lolite()" onClick="logVariable('passwordnonalphanum')" href="../_variables/passwordnonalphanum.html">$passwordnonalphanum</a> = <a class="constant" onClick="logConstant('PASSWORD_NONALPHANUM')" href="../_constants/PASSWORD_NONALPHANUM.html" onMouseOver="constPopup(event,'PASSWORD_NONALPHANUM')">PASSWORD_NONALPHANUM</a>;
<a name="l7689"><span class="linenum">7689</span></a>          while (<a class="var it13183" onMouseOver="hilite(13183)" onMouseOut="lolite()" onClick="logVariable('nonalphanum')" href="../_variables/nonalphanum.html">$nonalphanum</a> &gt; <a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it13187" onMouseOver="hilite(13187)" onMouseOut="lolite()" onClick="logVariable('passwordnonalphanum')" href="../_variables/passwordnonalphanum.html">$passwordnonalphanum</a>)) {
<a name="l7690"><span class="linenum">7690</span></a>              <a class="var it13187" onMouseOver="hilite(13187)" onMouseOut="lolite()" onClick="logVariable('passwordnonalphanum')" href="../_variables/passwordnonalphanum.html">$passwordnonalphanum</a> .= <a class="constant" onClick="logConstant('PASSWORD_NONALPHANUM')" href="../_constants/PASSWORD_NONALPHANUM.html" onMouseOver="constPopup(event,'PASSWORD_NONALPHANUM')">PASSWORD_NONALPHANUM</a>;
<a name="l7691"><span class="linenum">7691</span></a>          }
<a name="l7692"><span class="linenum">7692</span></a>  
<a name="l7693"><span class="linenum">7693</span></a>  <span class="comment">        // Now mix and shuffle it all.</span>
<a name="l7694"><span class="linenum">7694</span></a>          <a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a> = <a class="phpfunction" onClick="logFunction('str_shuffle')" href="../_functions/str_shuffle.html" onMouseOver="phpfuncPopup(event,'str_shuffle')">str_shuffle</a> (<a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="phpfunction" onClick="logFunction('str_shuffle')" href="../_functions/str_shuffle.html" onMouseOver="phpfuncPopup(event,'str_shuffle')">str_shuffle</a> (<a class="var it13185" onMouseOver="hilite(13185)" onMouseOut="lolite()" onClick="logVariable('passwordlower')" href="../_variables/passwordlower.html">$passwordlower</a>), 0, <a class="var it13182" onMouseOver="hilite(13182)" onMouseOut="lolite()" onClick="logVariable('lower')" href="../_variables/lower.html">$lower</a>) .
<a name="l7695"><span class="linenum">7695</span></a>                                   <a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="phpfunction" onClick="logFunction('str_shuffle')" href="../_functions/str_shuffle.html" onMouseOver="phpfuncPopup(event,'str_shuffle')">str_shuffle</a> (<a class="var it13186" onMouseOver="hilite(13186)" onMouseOut="lolite()" onClick="logVariable('passwordupper')" href="../_variables/passwordupper.html">$passwordupper</a>), 0, <a class="var it4066" onMouseOver="hilite(4066)" onMouseOut="lolite()" onClick="logVariable('upper')" href="../_variables/upper.html">$upper</a>) .
<a name="l7696"><span class="linenum">7696</span></a>                                   <a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="phpfunction" onClick="logFunction('str_shuffle')" href="../_functions/str_shuffle.html" onMouseOver="phpfuncPopup(event,'str_shuffle')">str_shuffle</a> (<a class="var it13184" onMouseOver="hilite(13184)" onMouseOut="lolite()" onClick="logVariable('passworddigits')" href="../_variables/passworddigits.html">$passworddigits</a>), 0, <a class="var it4408" onMouseOver="hilite(4408)" onMouseOut="lolite()" onClick="logVariable('digits')" href="../_variables/digits.html">$digits</a>) .
<a name="l7697"><span class="linenum">7697</span></a>                                   <a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="phpfunction" onClick="logFunction('str_shuffle')" href="../_functions/str_shuffle.html" onMouseOver="phpfuncPopup(event,'str_shuffle')">str_shuffle</a> (<a class="var it13187" onMouseOver="hilite(13187)" onMouseOut="lolite()" onClick="logVariable('passwordnonalphanum')" href="../_variables/passwordnonalphanum.html">$passwordnonalphanum</a>), 0 , <a class="var it13183" onMouseOver="hilite(13183)" onMouseOut="lolite()" onClick="logVariable('nonalphanum')" href="../_variables/nonalphanum.html">$nonalphanum</a>) .
<a name="l7698"><span class="linenum">7698</span></a>                                   <a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="phpfunction" onClick="logFunction('str_shuffle')" href="../_functions/str_shuffle.html" onMouseOver="phpfuncPopup(event,'str_shuffle')">str_shuffle</a> (<a class="var it13185" onMouseOver="hilite(13185)" onMouseOut="lolite()" onClick="logVariable('passwordlower')" href="../_variables/passwordlower.html">$passwordlower</a> .
<a name="l7699"><span class="linenum">7699</span></a>                                                       <a class="var it13186" onMouseOver="hilite(13186)" onMouseOut="lolite()" onClick="logVariable('passwordupper')" href="../_variables/passwordupper.html">$passwordupper</a> .
<a name="l7700"><span class="linenum">7700</span></a>                                                       <a class="var it13184" onMouseOver="hilite(13184)" onMouseOut="lolite()" onClick="logVariable('passworddigits')" href="../_variables/passworddigits.html">$passworddigits</a> .
<a name="l7701"><span class="linenum">7701</span></a>                                                       <a class="var it13187" onMouseOver="hilite(13187)" onMouseOut="lolite()" onClick="logVariable('passwordnonalphanum')" href="../_variables/passwordnonalphanum.html">$passwordnonalphanum</a>), 0 , <a class="var it1425" onMouseOver="hilite(1425)" onMouseOut="lolite()" onClick="logVariable('additional')" href="../_variables/additional.html">$additional</a>));
<a name="l7702"><span class="linenum">7702</span></a>      }
<a name="l7703"><span class="linenum">7703</span></a>  
<a name="l7704"><span class="linenum">7704</span></a>      return <a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a> (<a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>, 0, <a class="var it3615" onMouseOver="hilite(3615)" onMouseOut="lolite()" onClick="logVariable('maxlen')" href="../_variables/maxlen.html">$maxlen</a>);
<a name="l7705"><span class="linenum">7705</span></a>  }
<a name="l7706"><span class="linenum">7706</span></a>  
<a name="l7707"><span class="linenum">7707</span></a>  <span class="comment">/**</span>
<a name="l7708"><span class="linenum">7708</span></a>  <span class="comment"> * Given a float, prints it nicely.</span>
<a name="l7709"><span class="linenum">7709</span></a>  <span class="comment"> * Localized floats must not be used in calculations!</span>
<a name="l7710"><span class="linenum">7710</span></a>  <span class="comment"> *</span>
<a name="l7711"><span class="linenum">7711</span></a>  <span class="comment"> * The stripzeros feature is intended for making numbers look nicer in small</span>
<a name="l7712"><span class="linenum">7712</span></a>  <span class="comment"> * areas where it is not necessary to indicate the degree of accuracy by showing</span>
<a name="l7713"><span class="linenum">7713</span></a>  <span class="comment"> * ending zeros. If you turn it on with $decimalpoints set to 3, for example,</span>
<a name="l7714"><span class="linenum">7714</span></a>  <span class="comment"> * then it will display '5.4' instead of '5.400' or '5' instead of '5.000'.</span>
<a name="l7715"><span class="linenum">7715</span></a>  <span class="comment"> *</span>
<a name="l7716"><span class="linenum">7716</span></a>  <span class="comment"> * @param float $float The float to print</span>
<a name="l7717"><span class="linenum">7717</span></a>  <span class="comment"> * @param int $decimalpoints The number of decimal places to print.</span>
<a name="l7718"><span class="linenum">7718</span></a>  <span class="comment"> * @param bool $localized use localized decimal separator</span>
<a name="l7719"><span class="linenum">7719</span></a>  <span class="comment"> * @param bool $stripzeros If true, removes final zeros after decimal point</span>
<a name="l7720"><span class="linenum">7720</span></a>  <span class="comment"> * @return string locale float</span>
<a name="l7721"><span class="linenum">7721</span></a>  <span class="comment"> */</span>
<a name="l7722"><span class="linenum">7722</span></a>  function <a class="function" onClick="logFunction('format_float')" href="../_functions/format_float.html" onMouseOver="funcPopup(event,'format_float')">format_float</a>(<a class="var it13188" onMouseOver="hilite(13188)" onMouseOut="lolite()" onClick="logVariable('float')" href="../_variables/float.html">$float</a>, <a class="var it10042" onMouseOver="hilite(10042)" onMouseOut="lolite()" onClick="logVariable('decimalpoints')" href="../_variables/decimalpoints.html">$decimalpoints</a>=1, <a class="var it13189" onMouseOver="hilite(13189)" onMouseOut="lolite()" onClick="logVariable('localized')" href="../_variables/localized.html">$localized</a>=true, <a class="var it13190" onMouseOver="hilite(13190)" onMouseOut="lolite()" onClick="logVariable('stripzeros')" href="../_variables/stripzeros.html">$stripzeros</a>=false) {
<a name="l7723"><span class="linenum">7723</span></a>      if (<a class="phpfunction" onClick="logFunction('is_null')" href="../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it13188" onMouseOver="hilite(13188)" onMouseOut="lolite()" onClick="logVariable('float')" href="../_variables/float.html">$float</a>)) {
<a name="l7724"><span class="linenum">7724</span></a>          return '';
<a name="l7725"><span class="linenum">7725</span></a>      }
<a name="l7726"><span class="linenum">7726</span></a>      if (<a class="var it13189" onMouseOver="hilite(13189)" onMouseOut="lolite()" onClick="logVariable('localized')" href="../_variables/localized.html">$localized</a>) {
<a name="l7727"><span class="linenum">7727</span></a>          <a class="var it3496" onMouseOver="hilite(3496)" onMouseOut="lolite()" onClick="logVariable('separator')" href="../_variables/separator.html">$separator</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('decsep', 'langconfig');
<a name="l7728"><span class="linenum">7728</span></a>      } else {
<a name="l7729"><span class="linenum">7729</span></a>          <a class="var it3496" onMouseOver="hilite(3496)" onMouseOut="lolite()" onClick="logVariable('separator')" href="../_variables/separator.html">$separator</a> = '.';
<a name="l7730"><span class="linenum">7730</span></a>      }
<a name="l7731"><span class="linenum">7731</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = <a class="phpfunction" onClick="logFunction('number_format')" href="../_functions/number_format.html" onMouseOver="phpfuncPopup(event,'number_format')">number_format</a>(<a class="var it13188" onMouseOver="hilite(13188)" onMouseOut="lolite()" onClick="logVariable('float')" href="../_variables/float.html">$float</a>, <a class="var it10042" onMouseOver="hilite(10042)" onMouseOut="lolite()" onClick="logVariable('decimalpoints')" href="../_variables/decimalpoints.html">$decimalpoints</a>, <a class="var it3496" onMouseOver="hilite(3496)" onMouseOut="lolite()" onClick="logVariable('separator')" href="../_variables/separator.html">$separator</a>, '');
<a name="l7732"><span class="linenum">7732</span></a>      if (<a class="var it13190" onMouseOver="hilite(13190)" onMouseOut="lolite()" onClick="logVariable('stripzeros')" href="../_variables/stripzeros.html">$stripzeros</a>) {
<a name="l7733"><span class="linenum">7733</span></a>  <span class="comment">        // Remove zeros and final dot if not needed.</span>
<a name="l7734"><span class="linenum">7734</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('~(' . <a class="phpfunction" onClick="logFunction('preg_quote')" href="../_functions/preg_quote.html" onMouseOver="phpfuncPopup(event,'preg_quote')">preg_quote</a>(<a class="var it3496" onMouseOver="hilite(3496)" onMouseOut="lolite()" onClick="logVariable('separator')" href="../_variables/separator.html">$separator</a>) . ')?0+$~', '', <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>);
<a name="l7735"><span class="linenum">7735</span></a>      }
<a name="l7736"><span class="linenum">7736</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>;
<a name="l7737"><span class="linenum">7737</span></a>  }
<a name="l7738"><span class="linenum">7738</span></a>  
<a name="l7739"><span class="linenum">7739</span></a>  <span class="comment">/**</span>
<a name="l7740"><span class="linenum">7740</span></a>  <span class="comment"> * Converts locale specific floating point/comma number back to standard PHP float value</span>
<a name="l7741"><span class="linenum">7741</span></a>  <span class="comment"> * Do NOT try to do any math operations before this conversion on any user submitted floats!</span>
<a name="l7742"><span class="linenum">7742</span></a>  <span class="comment"> *</span>
<a name="l7743"><span class="linenum">7743</span></a>  <span class="comment"> * @param string $localefloat locale aware float representation</span>
<a name="l7744"><span class="linenum">7744</span></a>  <span class="comment"> * @param bool $strict If true, then check the input and return false if it is not a valid number.</span>
<a name="l7745"><span class="linenum">7745</span></a>  <span class="comment"> * @return mixed float|bool - false or the parsed float.</span>
<a name="l7746"><span class="linenum">7746</span></a>  <span class="comment"> */</span>
<a name="l7747"><span class="linenum">7747</span></a>  function <a class="function" onClick="logFunction('unformat_float')" href="../_functions/unformat_float.html" onMouseOver="funcPopup(event,'unformat_float')">unformat_float</a>(<a class="var it13191" onMouseOver="hilite(13191)" onMouseOut="lolite()" onClick="logVariable('localefloat')" href="../_variables/localefloat.html">$localefloat</a>, <a class="var it13192" onMouseOver="hilite(13192)" onMouseOut="lolite()" onClick="logVariable('strict')" href="../_variables/strict.html">$strict</a> = false) {
<a name="l7748"><span class="linenum">7748</span></a>      <a class="var it13191" onMouseOver="hilite(13191)" onMouseOut="lolite()" onClick="logVariable('localefloat')" href="../_variables/localefloat.html">$localefloat</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it13191" onMouseOver="hilite(13191)" onMouseOut="lolite()" onClick="logVariable('localefloat')" href="../_variables/localefloat.html">$localefloat</a>);
<a name="l7749"><span class="linenum">7749</span></a>  
<a name="l7750"><span class="linenum">7750</span></a>      if (<a class="var it13191" onMouseOver="hilite(13191)" onMouseOut="lolite()" onClick="logVariable('localefloat')" href="../_variables/localefloat.html">$localefloat</a> == '') {
<a name="l7751"><span class="linenum">7751</span></a>          return null;
<a name="l7752"><span class="linenum">7752</span></a>      }
<a name="l7753"><span class="linenum">7753</span></a>  
<a name="l7754"><span class="linenum">7754</span></a>      <a class="var it13191" onMouseOver="hilite(13191)" onMouseOut="lolite()" onClick="logVariable('localefloat')" href="../_variables/localefloat.html">$localefloat</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(' ', '', <a class="var it13191" onMouseOver="hilite(13191)" onMouseOut="lolite()" onClick="logVariable('localefloat')" href="../_variables/localefloat.html">$localefloat</a>); <span class="comment">// No spaces - those might be used as thousand separators.</span>
<a name="l7755"><span class="linenum">7755</span></a>      <a class="var it13191" onMouseOver="hilite(13191)" onMouseOut="lolite()" onClick="logVariable('localefloat')" href="../_variables/localefloat.html">$localefloat</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('decsep', 'langconfig'), '.', <a class="var it13191" onMouseOver="hilite(13191)" onMouseOut="lolite()" onClick="logVariable('localefloat')" href="../_variables/localefloat.html">$localefloat</a>);
<a name="l7756"><span class="linenum">7756</span></a>  
<a name="l7757"><span class="linenum">7757</span></a>      if (<a class="var it13192" onMouseOver="hilite(13192)" onMouseOut="lolite()" onClick="logVariable('strict')" href="../_variables/strict.html">$strict</a> &amp;&amp; !<a class="phpfunction" onClick="logFunction('is_numeric')" href="../_functions/is_numeric.html" onMouseOver="phpfuncPopup(event,'is_numeric')">is_numeric</a>(<a class="var it13191" onMouseOver="hilite(13191)" onMouseOut="lolite()" onClick="logVariable('localefloat')" href="../_variables/localefloat.html">$localefloat</a>)) {
<a name="l7758"><span class="linenum">7758</span></a>          return false;
<a name="l7759"><span class="linenum">7759</span></a>      }
<a name="l7760"><span class="linenum">7760</span></a>  
<a name="l7761"><span class="linenum">7761</span></a>      return (float)<a class="var it13191" onMouseOver="hilite(13191)" onMouseOut="lolite()" onClick="logVariable('localefloat')" href="../_variables/localefloat.html">$localefloat</a>;
<a name="l7762"><span class="linenum">7762</span></a>  }
<a name="l7763"><span class="linenum">7763</span></a>  
<a name="l7764"><span class="linenum">7764</span></a>  <span class="comment">/**</span>
<a name="l7765"><span class="linenum">7765</span></a>  <span class="comment"> * Given a simple array, this shuffles it up just like shuffle()</span>
<a name="l7766"><span class="linenum">7766</span></a>  <span class="comment"> * Unlike PHP's shuffle() this function works on any machine.</span>
<a name="l7767"><span class="linenum">7767</span></a>  <span class="comment"> *</span>
<a name="l7768"><span class="linenum">7768</span></a>  <span class="comment"> * @param array $array The array to be rearranged</span>
<a name="l7769"><span class="linenum">7769</span></a>  <span class="comment"> * @return array</span>
<a name="l7770"><span class="linenum">7770</span></a>  <span class="comment"> */</span>
<a name="l7771"><span class="linenum">7771</span></a>  function <a class="function" onClick="logFunction('swapshuffle')" href="../_functions/swapshuffle.html" onMouseOver="funcPopup(event,'swapshuffle')">swapshuffle</a>(<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a>) {
<a name="l7772"><span class="linenum">7772</span></a>  
<a name="l7773"><span class="linenum">7773</span></a>      <a class="var it893" onMouseOver="hilite(893)" onMouseOut="lolite()" onClick="logVariable('last')" href="../_variables/last.html">$last</a> = <a class="phpfunction" onClick="logFunction('count')" href="../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a>) - 1;
<a name="l7774"><span class="linenum">7774</span></a>      for (<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> = 0; <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> &lt;= <a class="var it893" onMouseOver="hilite(893)" onMouseOut="lolite()" onClick="logVariable('last')" href="../_variables/last.html">$last</a>; <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>++) {
<a name="l7775"><span class="linenum">7775</span></a>          <a class="var it590" onMouseOver="hilite(590)" onMouseOut="lolite()" onClick="logVariable('from')" href="../_variables/from.html">$from</a> = <a class="phpfunction" onClick="logFunction('rand')" href="../_functions/rand.html" onMouseOver="phpfuncPopup(event,'rand')">rand</a>(0, <a class="var it893" onMouseOver="hilite(893)" onMouseOut="lolite()" onClick="logVariable('last')" href="../_variables/last.html">$last</a>);
<a name="l7776"><span class="linenum">7776</span></a>          <a class="var it9213" onMouseOver="hilite(9213)" onMouseOut="lolite()" onClick="logVariable('curr')" href="../_variables/curr.html">$curr</a> = <a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a>[<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>];
<a name="l7777"><span class="linenum">7777</span></a>          <a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a>[<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>] = <a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a>[<a class="var it590" onMouseOver="hilite(590)" onMouseOut="lolite()" onClick="logVariable('from')" href="../_variables/from.html">$from</a>];
<a name="l7778"><span class="linenum">7778</span></a>          <a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a>[<a class="var it590" onMouseOver="hilite(590)" onMouseOut="lolite()" onClick="logVariable('from')" href="../_variables/from.html">$from</a>] = <a class="var it9213" onMouseOver="hilite(9213)" onMouseOut="lolite()" onClick="logVariable('curr')" href="../_variables/curr.html">$curr</a>;
<a name="l7779"><span class="linenum">7779</span></a>      }
<a name="l7780"><span class="linenum">7780</span></a>      return <a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a>;
<a name="l7781"><span class="linenum">7781</span></a>  }
<a name="l7782"><span class="linenum">7782</span></a>  
<a name="l7783"><span class="linenum">7783</span></a>  <span class="comment">/**</span>
<a name="l7784"><span class="linenum">7784</span></a>  <span class="comment"> * Like {@link swapshuffle()}, but works on associative arrays</span>
<a name="l7785"><span class="linenum">7785</span></a>  <span class="comment"> *</span>
<a name="l7786"><span class="linenum">7786</span></a>  <span class="comment"> * @param array $array The associative array to be rearranged</span>
<a name="l7787"><span class="linenum">7787</span></a>  <span class="comment"> * @return array</span>
<a name="l7788"><span class="linenum">7788</span></a>  <span class="comment"> */</span>
<a name="l7789"><span class="linenum">7789</span></a>  function <a class="function" onClick="logFunction('swapshuffle_assoc')" href="../_functions/swapshuffle_assoc.html" onMouseOver="funcPopup(event,'swapshuffle_assoc')">swapshuffle_assoc</a>(<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a>) {
<a name="l7790"><span class="linenum">7790</span></a>  
<a name="l7791"><span class="linenum">7791</span></a>      <a class="var it13193" onMouseOver="hilite(13193)" onMouseOut="lolite()" onClick="logVariable('newarray')" href="../_variables/newarray.html">$newarray</a> = array();
<a name="l7792"><span class="linenum">7792</span></a>      <a class="var it13194" onMouseOver="hilite(13194)" onMouseOut="lolite()" onClick="logVariable('newkeys')" href="../_variables/newkeys.html">$newkeys</a> = <a class="function" onClick="logFunction('swapshuffle')" href="../_functions/swapshuffle.html" onMouseOver="funcPopup(event,'swapshuffle')">swapshuffle</a>(<a class="phpfunction" onClick="logFunction('array_keys')" href="../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a>));
<a name="l7793"><span class="linenum">7793</span></a>  
<a name="l7794"><span class="linenum">7794</span></a>      foreach (<a class="var it13194" onMouseOver="hilite(13194)" onMouseOut="lolite()" onClick="logVariable('newkeys')" href="../_variables/newkeys.html">$newkeys</a> as <a class="var it3723" onMouseOver="hilite(3723)" onMouseOut="lolite()" onClick="logVariable('newkey')" href="../_variables/newkey.html">$newkey</a>) {
<a name="l7795"><span class="linenum">7795</span></a>          <a class="var it13193" onMouseOver="hilite(13193)" onMouseOut="lolite()" onClick="logVariable('newarray')" href="../_variables/newarray.html">$newarray</a>[<a class="var it3723" onMouseOver="hilite(3723)" onMouseOut="lolite()" onClick="logVariable('newkey')" href="../_variables/newkey.html">$newkey</a>] = <a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a>[<a class="var it3723" onMouseOver="hilite(3723)" onMouseOut="lolite()" onClick="logVariable('newkey')" href="../_variables/newkey.html">$newkey</a>];
<a name="l7796"><span class="linenum">7796</span></a>      }
<a name="l7797"><span class="linenum">7797</span></a>      return <a class="var it13193" onMouseOver="hilite(13193)" onMouseOut="lolite()" onClick="logVariable('newarray')" href="../_variables/newarray.html">$newarray</a>;
<a name="l7798"><span class="linenum">7798</span></a>  }
<a name="l7799"><span class="linenum">7799</span></a>  
<a name="l7800"><span class="linenum">7800</span></a>  <span class="comment">/**</span>
<a name="l7801"><span class="linenum">7801</span></a>  <span class="comment"> * Given an arbitrary array, and a number of draws,</span>
<a name="l7802"><span class="linenum">7802</span></a>  <span class="comment"> * this function returns an array with that amount</span>
<a name="l7803"><span class="linenum">7803</span></a>  <span class="comment"> * of items.  The indexes are retained.</span>
<a name="l7804"><span class="linenum">7804</span></a>  <span class="comment"> *</span>
<a name="l7805"><span class="linenum">7805</span></a>  <span class="comment"> * @todo Finish documenting this function</span>
<a name="l7806"><span class="linenum">7806</span></a>  <span class="comment"> *</span>
<a name="l7807"><span class="linenum">7807</span></a>  <span class="comment"> * @param array $array</span>
<a name="l7808"><span class="linenum">7808</span></a>  <span class="comment"> * @param int $draws</span>
<a name="l7809"><span class="linenum">7809</span></a>  <span class="comment"> * @return array</span>
<a name="l7810"><span class="linenum">7810</span></a>  <span class="comment"> */</span>
<a name="l7811"><span class="linenum">7811</span></a>  function <a class="function" onClick="logFunction('draw_rand_array')" href="../_functions/draw_rand_array.html" onMouseOver="funcPopup(event,'draw_rand_array')">draw_rand_array</a>(<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a>, <a class="var it13195" onMouseOver="hilite(13195)" onMouseOut="lolite()" onClick="logVariable('draws')" href="../_variables/draws.html">$draws</a>) {
<a name="l7812"><span class="linenum">7812</span></a>  
<a name="l7813"><span class="linenum">7813</span></a>      <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a> = array();
<a name="l7814"><span class="linenum">7814</span></a>  
<a name="l7815"><span class="linenum">7815</span></a>      <a class="var it893" onMouseOver="hilite(893)" onMouseOut="lolite()" onClick="logVariable('last')" href="../_variables/last.html">$last</a> = <a class="phpfunction" onClick="logFunction('count')" href="../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a>);
<a name="l7816"><span class="linenum">7816</span></a>  
<a name="l7817"><span class="linenum">7817</span></a>      if (<a class="var it13195" onMouseOver="hilite(13195)" onMouseOut="lolite()" onClick="logVariable('draws')" href="../_variables/draws.html">$draws</a> &gt; <a class="var it893" onMouseOver="hilite(893)" onMouseOut="lolite()" onClick="logVariable('last')" href="../_variables/last.html">$last</a>) {
<a name="l7818"><span class="linenum">7818</span></a>          <a class="var it13195" onMouseOver="hilite(13195)" onMouseOut="lolite()" onClick="logVariable('draws')" href="../_variables/draws.html">$draws</a> = <a class="var it893" onMouseOver="hilite(893)" onMouseOut="lolite()" onClick="logVariable('last')" href="../_variables/last.html">$last</a>;
<a name="l7819"><span class="linenum">7819</span></a>      }
<a name="l7820"><span class="linenum">7820</span></a>  
<a name="l7821"><span class="linenum">7821</span></a>      while (<a class="var it13195" onMouseOver="hilite(13195)" onMouseOut="lolite()" onClick="logVariable('draws')" href="../_variables/draws.html">$draws</a> &gt; 0) {
<a name="l7822"><span class="linenum">7822</span></a>          <a class="var it893" onMouseOver="hilite(893)" onMouseOut="lolite()" onClick="logVariable('last')" href="../_variables/last.html">$last</a>--;
<a name="l7823"><span class="linenum">7823</span></a>  
<a name="l7824"><span class="linenum">7824</span></a>          <a class="var it1933" onMouseOver="hilite(1933)" onMouseOut="lolite()" onClick="logVariable('keys')" href="../_variables/keys.html">$keys</a> = <a class="phpfunction" onClick="logFunction('array_keys')" href="../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a>);
<a name="l7825"><span class="linenum">7825</span></a>          <a class="var it13196" onMouseOver="hilite(13196)" onMouseOut="lolite()" onClick="logVariable('rand')" href="../_variables/rand.html">$rand</a> = <a class="phpfunction" onClick="logFunction('rand')" href="../_functions/rand.html" onMouseOver="phpfuncPopup(event,'rand')">rand</a>(0, <a class="var it893" onMouseOver="hilite(893)" onMouseOut="lolite()" onClick="logVariable('last')" href="../_variables/last.html">$last</a>);
<a name="l7826"><span class="linenum">7826</span></a>  
<a name="l7827"><span class="linenum">7827</span></a>          <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a>[<a class="var it1933" onMouseOver="hilite(1933)" onMouseOut="lolite()" onClick="logVariable('keys')" href="../_variables/keys.html">$keys</a>[<a class="var it13196" onMouseOver="hilite(13196)" onMouseOut="lolite()" onClick="logVariable('rand')" href="../_variables/rand.html">$rand</a>]] = <a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a>[<a class="var it1933" onMouseOver="hilite(1933)" onMouseOut="lolite()" onClick="logVariable('keys')" href="../_variables/keys.html">$keys</a>[<a class="var it13196" onMouseOver="hilite(13196)" onMouseOut="lolite()" onClick="logVariable('rand')" href="../_variables/rand.html">$rand</a>]];
<a name="l7828"><span class="linenum">7828</span></a>          unset(<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a>[<a class="var it1933" onMouseOver="hilite(1933)" onMouseOut="lolite()" onClick="logVariable('keys')" href="../_variables/keys.html">$keys</a>[<a class="var it13196" onMouseOver="hilite(13196)" onMouseOut="lolite()" onClick="logVariable('rand')" href="../_variables/rand.html">$rand</a>]]);
<a name="l7829"><span class="linenum">7829</span></a>  
<a name="l7830"><span class="linenum">7830</span></a>          <a class="var it13195" onMouseOver="hilite(13195)" onMouseOut="lolite()" onClick="logVariable('draws')" href="../_variables/draws.html">$draws</a>--;
<a name="l7831"><span class="linenum">7831</span></a>      }
<a name="l7832"><span class="linenum">7832</span></a>  
<a name="l7833"><span class="linenum">7833</span></a>      return <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a>;
<a name="l7834"><span class="linenum">7834</span></a>  }
<a name="l7835"><span class="linenum">7835</span></a>  
<a name="l7836"><span class="linenum">7836</span></a>  <span class="comment">/**</span>
<a name="l7837"><span class="linenum">7837</span></a>  <span class="comment"> * Calculate the difference between two microtimes</span>
<a name="l7838"><span class="linenum">7838</span></a>  <span class="comment"> *</span>
<a name="l7839"><span class="linenum">7839</span></a>  <span class="comment"> * @param string $a The first Microtime</span>
<a name="l7840"><span class="linenum">7840</span></a>  <span class="comment"> * @param string $b The second Microtime</span>
<a name="l7841"><span class="linenum">7841</span></a>  <span class="comment"> * @return string</span>
<a name="l7842"><span class="linenum">7842</span></a>  <span class="comment"> */</span>
<a name="l7843"><span class="linenum">7843</span></a>  function <a class="function" onClick="logFunction('microtime_diff')" href="../_functions/microtime_diff.html" onMouseOver="funcPopup(event,'microtime_diff')">microtime_diff</a>(<a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>, <a class="var it444" onMouseOver="hilite(444)" onMouseOut="lolite()" onClick="logVariable('b')" href="../_variables/b.html">$b</a>) {
<a name="l7844"><span class="linenum">7844</span></a>      <a class="function" onClick="logFunction('list')" href="../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it13197" onMouseOver="hilite(13197)" onMouseOut="lolite()" onClick="logVariable('adec')" href="../_variables/adec.html">$adec</a>, <a class="var it13198" onMouseOver="hilite(13198)" onMouseOut="lolite()" onClick="logVariable('asec')" href="../_variables/asec.html">$asec</a>) = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(' ', <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>);
<a name="l7845"><span class="linenum">7845</span></a>      <a class="function" onClick="logFunction('list')" href="../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it13199" onMouseOver="hilite(13199)" onMouseOut="lolite()" onClick="logVariable('bdec')" href="../_variables/bdec.html">$bdec</a>, <a class="var it13200" onMouseOver="hilite(13200)" onMouseOut="lolite()" onClick="logVariable('bsec')" href="../_variables/bsec.html">$bsec</a>) = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(' ', <a class="var it444" onMouseOver="hilite(444)" onMouseOut="lolite()" onClick="logVariable('b')" href="../_variables/b.html">$b</a>);
<a name="l7846"><span class="linenum">7846</span></a>      return <a class="var it13200" onMouseOver="hilite(13200)" onMouseOut="lolite()" onClick="logVariable('bsec')" href="../_variables/bsec.html">$bsec</a> - <a class="var it13198" onMouseOver="hilite(13198)" onMouseOut="lolite()" onClick="logVariable('asec')" href="../_variables/asec.html">$asec</a> + <a class="var it13199" onMouseOver="hilite(13199)" onMouseOut="lolite()" onClick="logVariable('bdec')" href="../_variables/bdec.html">$bdec</a> - <a class="var it13197" onMouseOver="hilite(13197)" onMouseOut="lolite()" onClick="logVariable('adec')" href="../_variables/adec.html">$adec</a>;
<a name="l7847"><span class="linenum">7847</span></a>  }
<a name="l7848"><span class="linenum">7848</span></a>  
<a name="l7849"><span class="linenum">7849</span></a>  <span class="comment">/**</span>
<a name="l7850"><span class="linenum">7850</span></a>  <span class="comment"> * Given a list (eg a,b,c,d,e) this function returns</span>
<a name="l7851"><span class="linenum">7851</span></a>  <span class="comment"> * an array of 1-&gt;a, 2-&gt;b, 3-&gt;c etc</span>
<a name="l7852"><span class="linenum">7852</span></a>  <span class="comment"> *</span>
<a name="l7853"><span class="linenum">7853</span></a>  <span class="comment"> * @param string $list The string to explode into array bits</span>
<a name="l7854"><span class="linenum">7854</span></a>  <span class="comment"> * @param string $separator The separator used within the list string</span>
<a name="l7855"><span class="linenum">7855</span></a>  <span class="comment"> * @return array The now assembled array</span>
<a name="l7856"><span class="linenum">7856</span></a>  <span class="comment"> */</span>
<a name="l7857"><span class="linenum">7857</span></a>  function <a class="function" onClick="logFunction('make_menu_from_list')" href="../_functions/make_menu_from_list.html" onMouseOver="funcPopup(event,'make_menu_from_list')">make_menu_from_list</a>(<a class="var it301" onMouseOver="hilite(301)" onMouseOut="lolite()" onClick="logVariable('list')" href="../_variables/list.html">$list</a>, <a class="var it3496" onMouseOver="hilite(3496)" onMouseOut="lolite()" onClick="logVariable('separator')" href="../_variables/separator.html">$separator</a>=',') {
<a name="l7858"><span class="linenum">7858</span></a>  
<a name="l7859"><span class="linenum">7859</span></a>      <a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a> = <a class="phpfunction" onClick="logFunction('array_reverse')" href="../_functions/array_reverse.html" onMouseOver="phpfuncPopup(event,'array_reverse')">array_reverse</a>(<a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(<a class="var it3496" onMouseOver="hilite(3496)" onMouseOut="lolite()" onClick="logVariable('separator')" href="../_variables/separator.html">$separator</a>, <a class="var it301" onMouseOver="hilite(301)" onMouseOut="lolite()" onClick="logVariable('list')" href="../_variables/list.html">$list</a>), true);
<a name="l7860"><span class="linenum">7860</span></a>      foreach (<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../_variables/item.html">$item</a>) {
<a name="l7861"><span class="linenum">7861</span></a>          <a class="var it13201" onMouseOver="hilite(13201)" onMouseOut="lolite()" onClick="logVariable('outarray')" href="../_variables/outarray.html">$outarray</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>+1] = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../_variables/item.html">$item</a>);
<a name="l7862"><span class="linenum">7862</span></a>      }
<a name="l7863"><span class="linenum">7863</span></a>      return <a class="var it13201" onMouseOver="hilite(13201)" onMouseOut="lolite()" onClick="logVariable('outarray')" href="../_variables/outarray.html">$outarray</a>;
<a name="l7864"><span class="linenum">7864</span></a>  }
<a name="l7865"><span class="linenum">7865</span></a>  
<a name="l7866"><span class="linenum">7866</span></a>  <span class="comment">/**</span>
<a name="l7867"><span class="linenum">7867</span></a>  <span class="comment"> * Creates an array that represents all the current grades that</span>
<a name="l7868"><span class="linenum">7868</span></a>  <span class="comment"> * can be chosen using the given grading type.</span>
<a name="l7869"><span class="linenum">7869</span></a>  <span class="comment"> *</span>
<a name="l7870"><span class="linenum">7870</span></a>  <span class="comment"> * Negative numbers</span>
<a name="l7871"><span class="linenum">7871</span></a>  <span class="comment"> * are scales, zero is no grade, and positive numbers are maximum</span>
<a name="l7872"><span class="linenum">7872</span></a>  <span class="comment"> * grades.</span>
<a name="l7873"><span class="linenum">7873</span></a>  <span class="comment"> *</span>
<a name="l7874"><span class="linenum">7874</span></a>  <span class="comment"> * @todo Finish documenting this function or better deprecated this completely!</span>
<a name="l7875"><span class="linenum">7875</span></a>  <span class="comment"> *</span>
<a name="l7876"><span class="linenum">7876</span></a>  <span class="comment"> * @param int $gradingtype</span>
<a name="l7877"><span class="linenum">7877</span></a>  <span class="comment"> * @return array</span>
<a name="l7878"><span class="linenum">7878</span></a>  <span class="comment"> */</span>
<a name="l7879"><span class="linenum">7879</span></a>  function <a class="function" onClick="logFunction('make_grades_menu')" href="../_functions/make_grades_menu.html" onMouseOver="funcPopup(event,'make_grades_menu')">make_grades_menu</a>(<a class="var it13202" onMouseOver="hilite(13202)" onMouseOut="lolite()" onClick="logVariable('gradingtype')" href="../_variables/gradingtype.html">$gradingtype</a>) {
<a name="l7880"><span class="linenum">7880</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l7881"><span class="linenum">7881</span></a>  
<a name="l7882"><span class="linenum">7882</span></a>      <a class="var it663" onMouseOver="hilite(663)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../_variables/grades.html">$grades</a> = array();
<a name="l7883"><span class="linenum">7883</span></a>      if (<a class="var it13202" onMouseOver="hilite(13202)" onMouseOut="lolite()" onClick="logVariable('gradingtype')" href="../_variables/gradingtype.html">$gradingtype</a> &lt; 0) {
<a name="l7884"><span class="linenum">7884</span></a>          if (<a class="var it1939" onMouseOver="hilite(1939)" onMouseOut="lolite()" onClick="logVariable('scale')" href="../_variables/scale.html">$scale</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('scale', array('id'=&gt; (-<a class="var it13202" onMouseOver="hilite(13202)" onMouseOut="lolite()" onClick="logVariable('gradingtype')" href="../_variables/gradingtype.html">$gradingtype</a>)))) {
<a name="l7885"><span class="linenum">7885</span></a>              return <a class="function" onClick="logFunction('make_menu_from_list')" href="../_functions/make_menu_from_list.html" onMouseOver="funcPopup(event,'make_menu_from_list')">make_menu_from_list</a>(<a class="var it1939" onMouseOver="hilite(1939)" onMouseOut="lolite()" onClick="logVariable('scale')" href="../_variables/scale.html">$scale</a>-&gt;<a onClick="logVariable('scale')" class="var it39533" onMouseOver="hilite(39533)" onMouseOut="lolite()" href="../_variables/scale.html">scale</a>);
<a name="l7886"><span class="linenum">7886</span></a>          }
<a name="l7887"><span class="linenum">7887</span></a>      } else if (<a class="var it13202" onMouseOver="hilite(13202)" onMouseOut="lolite()" onClick="logVariable('gradingtype')" href="../_variables/gradingtype.html">$gradingtype</a> &gt; 0) {
<a name="l7888"><span class="linenum">7888</span></a>          for (<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>=<a class="var it13202" onMouseOver="hilite(13202)" onMouseOut="lolite()" onClick="logVariable('gradingtype')" href="../_variables/gradingtype.html">$gradingtype</a>; <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>&gt;=0; <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>--) {
<a name="l7889"><span class="linenum">7889</span></a>              <a class="var it663" onMouseOver="hilite(663)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../_variables/grades.html">$grades</a>[<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>] = <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> .' / '. <a class="var it13202" onMouseOver="hilite(13202)" onMouseOut="lolite()" onClick="logVariable('gradingtype')" href="../_variables/gradingtype.html">$gradingtype</a>;
<a name="l7890"><span class="linenum">7890</span></a>          }
<a name="l7891"><span class="linenum">7891</span></a>          return <a class="var it663" onMouseOver="hilite(663)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../_variables/grades.html">$grades</a>;
<a name="l7892"><span class="linenum">7892</span></a>      }
<a name="l7893"><span class="linenum">7893</span></a>      return <a class="var it663" onMouseOver="hilite(663)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../_variables/grades.html">$grades</a>;
<a name="l7894"><span class="linenum">7894</span></a>  }
<a name="l7895"><span class="linenum">7895</span></a>  
<a name="l7896"><span class="linenum">7896</span></a>  <span class="comment">/**</span>
<a name="l7897"><span class="linenum">7897</span></a>  <span class="comment"> * This function returns the number of activities using the given scale in the given course.</span>
<a name="l7898"><span class="linenum">7898</span></a>  <span class="comment"> *</span>
<a name="l7899"><span class="linenum">7899</span></a>  <span class="comment"> * @param int $courseid The course ID to check.</span>
<a name="l7900"><span class="linenum">7900</span></a>  <span class="comment"> * @param int $scaleid The scale ID to check</span>
<a name="l7901"><span class="linenum">7901</span></a>  <span class="comment"> * @return int</span>
<a name="l7902"><span class="linenum">7902</span></a>  <span class="comment"> */</span>
<a name="l7903"><span class="linenum">7903</span></a>  function <a class="function" onClick="logFunction('course_scale_used')" href="../_functions/course_scale_used.html" onMouseOver="funcPopup(event,'course_scale_used')">course_scale_used</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>, <a class="var it3927" onMouseOver="hilite(3927)" onMouseOut="lolite()" onClick="logVariable('scaleid')" href="../_variables/scaleid.html">$scaleid</a>) {
<a name="l7904"><span class="linenum">7904</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l7905"><span class="linenum">7905</span></a>  
<a name="l7906"><span class="linenum">7906</span></a>      <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a> = 0;
<a name="l7907"><span class="linenum">7907</span></a>  
<a name="l7908"><span class="linenum">7908</span></a>      if (!empty(<a class="var it3927" onMouseOver="hilite(3927)" onMouseOut="lolite()" onClick="logVariable('scaleid')" href="../_variables/scaleid.html">$scaleid</a>)) {
<a name="l7909"><span class="linenum">7909</span></a>          if (<a class="var it1704" onMouseOver="hilite(1704)" onMouseOut="lolite()" onClick="logVariable('cms')" href="../_variables/cms.html">$cms</a> = <a class="function" onClick="logFunction('get_course_mods')" href="../_functions/get_course_mods.html" onMouseOver="funcPopup(event,'get_course_mods')">get_course_mods</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>)) {
<a name="l7910"><span class="linenum">7910</span></a>              foreach (<a class="var it1704" onMouseOver="hilite(1704)" onMouseOut="lolite()" onClick="logVariable('cms')" href="../_variables/cms.html">$cms</a> as <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>) {
<a name="l7911"><span class="linenum">7911</span></a>  <span class="comment">                // Check cm-&gt;name/lib.php exists.</span>
<a name="l7912"><span class="linenum">7912</span></a>                  if (<a class="phpfunction" onClick="logFunction('file_exists')" href="../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'/mod/'.<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('modname')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../_variables/modname.html">modname</a>.'/lib.php')) {
<a name="l7913"><span class="linenum">7913</span></a>                      include_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'/mod/'.<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('modname')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../_variables/modname.html">modname</a>.'/lib.php');
<a name="l7914"><span class="linenum">7914</span></a>                      <a class="var it3922" onMouseOver="hilite(3922)" onMouseOut="lolite()" onClick="logVariable('functionname')" href="../_variables/functionname.html">$functionname</a> = <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('modname')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../_variables/modname.html">modname</a>.'_scale_used';
<a name="l7915"><span class="linenum">7915</span></a>                      if (<a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>(<a class="var it3922" onMouseOver="hilite(3922)" onMouseOut="lolite()" onClick="logVariable('functionname')" href="../_variables/functionname.html">$functionname</a>)) {
<a name="l7916"><span class="linenum">7916</span></a>                          if (<a class="var it3922" onMouseOver="hilite(3922)" onMouseOut="lolite()" onClick="logVariable('functionname')" href="../_variables/functionname.html">$functionname</a>(<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('instance')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../_variables/instance.html">instance</a>, <a class="var it3927" onMouseOver="hilite(3927)" onMouseOut="lolite()" onClick="logVariable('scaleid')" href="../_variables/scaleid.html">$scaleid</a>)) {
<a name="l7917"><span class="linenum">7917</span></a>                              <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a>++;
<a name="l7918"><span class="linenum">7918</span></a>                          }
<a name="l7919"><span class="linenum">7919</span></a>                      }
<a name="l7920"><span class="linenum">7920</span></a>                  }
<a name="l7921"><span class="linenum">7921</span></a>              }
<a name="l7922"><span class="linenum">7922</span></a>          }
<a name="l7923"><span class="linenum">7923</span></a>  
<a name="l7924"><span class="linenum">7924</span></a>  <span class="comment">        // Check if any course grade item makes use of the scale.</span>
<a name="l7925"><span class="linenum">7925</span></a>          <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a> += <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records')" href="../_functions/count_records.html" onMouseOver="funcPopup(event,'count_records')">count_records</a>('grade_items', array('courseid' =&gt; <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>, 'scaleid' =&gt; <a class="var it3927" onMouseOver="hilite(3927)" onMouseOut="lolite()" onClick="logVariable('scaleid')" href="../_variables/scaleid.html">$scaleid</a>));
<a name="l7926"><span class="linenum">7926</span></a>  
<a name="l7927"><span class="linenum">7927</span></a>  <span class="comment">        // Check if any outcome in the course makes use of the scale.</span>
<a name="l7928"><span class="linenum">7928</span></a>          <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a> += <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records_sql')" href="../_functions/count_records_sql.html" onMouseOver="funcPopup(event,'count_records_sql')">count_records_sql</a>(&quot;SELECT <a class="phpfunction" onClick="logFunction('COUNT')" href="../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">COUNT</a>('x')
<a name="l7929"><span class="linenum">7929</span></a>                                               FROM {grade_outcomes_courses} goc,
<a name="l7930"><span class="linenum">7930</span></a>                                                    {grade_outcomes} go
<a name="l7931"><span class="linenum">7931</span></a>                                              WHERE go.id = goc.outcomeid
<a name="l7932"><span class="linenum">7932</span></a>                                                    AND go.scaleid = ? AND goc.courseid = ?&quot;,
<a name="l7933"><span class="linenum">7933</span></a>                                            array(<a class="var it3927" onMouseOver="hilite(3927)" onMouseOut="lolite()" onClick="logVariable('scaleid')" href="../_variables/scaleid.html">$scaleid</a>, <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../_variables/courseid.html">$courseid</a>));
<a name="l7934"><span class="linenum">7934</span></a>      }
<a name="l7935"><span class="linenum">7935</span></a>      return <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a>;
<a name="l7936"><span class="linenum">7936</span></a>  }
<a name="l7937"><span class="linenum">7937</span></a>  
<a name="l7938"><span class="linenum">7938</span></a>  <span class="comment">/**</span>
<a name="l7939"><span class="linenum">7939</span></a>  <span class="comment"> * This function returns the number of activities using scaleid in the entire site</span>
<a name="l7940"><span class="linenum">7940</span></a>  <span class="comment"> *</span>
<a name="l7941"><span class="linenum">7941</span></a>  <span class="comment"> * @param int $scaleid</span>
<a name="l7942"><span class="linenum">7942</span></a>  <span class="comment"> * @param array $courses</span>
<a name="l7943"><span class="linenum">7943</span></a>  <span class="comment"> * @return int</span>
<a name="l7944"><span class="linenum">7944</span></a>  <span class="comment"> */</span>
<a name="l7945"><span class="linenum">7945</span></a>  function <a class="function" onClick="logFunction('site_scale_used')" href="../_functions/site_scale_used.html" onMouseOver="funcPopup(event,'site_scale_used')">site_scale_used</a>(<a class="var it3927" onMouseOver="hilite(3927)" onMouseOut="lolite()" onClick="logVariable('scaleid')" href="../_variables/scaleid.html">$scaleid</a>, &amp;<a class="var it520" onMouseOver="hilite(520)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../_variables/courses.html">$courses</a>) {
<a name="l7946"><span class="linenum">7946</span></a>      <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a> = 0;
<a name="l7947"><span class="linenum">7947</span></a>  
<a name="l7948"><span class="linenum">7948</span></a>      if (!<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it520" onMouseOver="hilite(520)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../_variables/courses.html">$courses</a>) || <a class="phpfunction" onClick="logFunction('count')" href="../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it520" onMouseOver="hilite(520)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../_variables/courses.html">$courses</a>) == 0) {
<a name="l7949"><span class="linenum">7949</span></a>          <a class="var it520" onMouseOver="hilite(520)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../_variables/courses.html">$courses</a> = <a class="function" onClick="logFunction('get_courses')" href="../_functions/get_courses.html" onMouseOver="funcPopup(event,'get_courses')">get_courses</a>(&quot;all&quot;, false, &quot;c.id, c.shortname&quot;);
<a name="l7950"><span class="linenum">7950</span></a>      }
<a name="l7951"><span class="linenum">7951</span></a>  
<a name="l7952"><span class="linenum">7952</span></a>      if (!empty(<a class="var it3927" onMouseOver="hilite(3927)" onMouseOut="lolite()" onClick="logVariable('scaleid')" href="../_variables/scaleid.html">$scaleid</a>)) {
<a name="l7953"><span class="linenum">7953</span></a>          if (<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it520" onMouseOver="hilite(520)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../_variables/courses.html">$courses</a>) &amp;&amp; <a class="phpfunction" onClick="logFunction('count')" href="../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it520" onMouseOver="hilite(520)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../_variables/courses.html">$courses</a>) &gt; 0) {
<a name="l7954"><span class="linenum">7954</span></a>              foreach (<a class="var it520" onMouseOver="hilite(520)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../_variables/courses.html">$courses</a> as <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>) {
<a name="l7955"><span class="linenum">7955</span></a>                  <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a> += <a class="function" onClick="logFunction('course_scale_used')" href="../_functions/course_scale_used.html" onMouseOver="funcPopup(event,'course_scale_used')">course_scale_used</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, <a class="var it3927" onMouseOver="hilite(3927)" onMouseOut="lolite()" onClick="logVariable('scaleid')" href="../_variables/scaleid.html">$scaleid</a>);
<a name="l7956"><span class="linenum">7956</span></a>              }
<a name="l7957"><span class="linenum">7957</span></a>          }
<a name="l7958"><span class="linenum">7958</span></a>      }
<a name="l7959"><span class="linenum">7959</span></a>      return <a class="var it49" onMouseOver="hilite(49)" onMouseOut="lolite()" onClick="logVariable('return')" href="../_variables/return.html">$return</a>;
<a name="l7960"><span class="linenum">7960</span></a>  }
<a name="l7961"><span class="linenum">7961</span></a>  
<a name="l7962"><span class="linenum">7962</span></a>  <span class="comment">/**</span>
<a name="l7963"><span class="linenum">7963</span></a>  <span class="comment"> * make_unique_id_code</span>
<a name="l7964"><span class="linenum">7964</span></a>  <span class="comment"> *</span>
<a name="l7965"><span class="linenum">7965</span></a>  <span class="comment"> * @todo Finish documenting this function</span>
<a name="l7966"><span class="linenum">7966</span></a>  <span class="comment"> *</span>
<a name="l7967"><span class="linenum">7967</span></a>  <span class="comment"> * @uses $_SERVER</span>
<a name="l7968"><span class="linenum">7968</span></a>  <span class="comment"> * @param string $extra Extra string to append to the end of the code</span>
<a name="l7969"><span class="linenum">7969</span></a>  <span class="comment"> * @return string</span>
<a name="l7970"><span class="linenum">7970</span></a>  <span class="comment"> */</span>
<a name="l7971"><span class="linenum">7971</span></a>  function <a class="function" onClick="logFunction('make_unique_id_code')" href="../_functions/make_unique_id_code.html" onMouseOver="funcPopup(event,'make_unique_id_code')">make_unique_id_code</a>(<a class="var it2018" onMouseOver="hilite(2018)" onMouseOut="lolite()" onClick="logVariable('extra')" href="../_variables/extra.html">$extra</a> = '') {
<a name="l7972"><span class="linenum">7972</span></a>  
<a name="l7973"><span class="linenum">7973</span></a>      <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('hostname')" href="../_variables/hostname.html">$hostname</a> = 'unknownhost';
<a name="l7974"><span class="linenum">7974</span></a>      if (!empty(<a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['HTTP_HOST'])) {
<a name="l7975"><span class="linenum">7975</span></a>          <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('hostname')" href="../_variables/hostname.html">$hostname</a> = <a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['HTTP_HOST'];
<a name="l7976"><span class="linenum">7976</span></a>      } else if (!empty(<a class="var it13203" onMouseOver="hilite(13203)" onMouseOut="lolite()" onClick="logVariable('_ENV')" href="../_variables/_ENV.html">$_ENV</a>['HTTP_HOST'])) {
<a name="l7977"><span class="linenum">7977</span></a>          <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('hostname')" href="../_variables/hostname.html">$hostname</a> = <a class="var it13203" onMouseOver="hilite(13203)" onMouseOut="lolite()" onClick="logVariable('_ENV')" href="../_variables/_ENV.html">$_ENV</a>['HTTP_HOST'];
<a name="l7978"><span class="linenum">7978</span></a>      } else if (!empty(<a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['SERVER_NAME'])) {
<a name="l7979"><span class="linenum">7979</span></a>          <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('hostname')" href="../_variables/hostname.html">$hostname</a> = <a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['SERVER_NAME'];
<a name="l7980"><span class="linenum">7980</span></a>      } else if (!empty(<a class="var it13203" onMouseOver="hilite(13203)" onMouseOut="lolite()" onClick="logVariable('_ENV')" href="../_variables/_ENV.html">$_ENV</a>['SERVER_NAME'])) {
<a name="l7981"><span class="linenum">7981</span></a>          <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('hostname')" href="../_variables/hostname.html">$hostname</a> = <a class="var it13203" onMouseOver="hilite(13203)" onMouseOut="lolite()" onClick="logVariable('_ENV')" href="../_variables/_ENV.html">$_ENV</a>['SERVER_NAME'];
<a name="l7982"><span class="linenum">7982</span></a>      }
<a name="l7983"><span class="linenum">7983</span></a>  
<a name="l7984"><span class="linenum">7984</span></a>      <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('date')" href="../_variables/date.html">$date</a> = <a class="phpfunction" onClick="logFunction('gmdate')" href="../_functions/gmdate.html" onMouseOver="phpfuncPopup(event,'gmdate')">gmdate</a>(&quot;ymdHis&quot;);
<a name="l7985"><span class="linenum">7985</span></a>  
<a name="l7986"><span class="linenum">7986</span></a>      <a class="var it1911" onMouseOver="hilite(1911)" onMouseOut="lolite()" onClick="logVariable('random')" href="../_variables/random.html">$random</a> =  <a class="function" onClick="logFunction('random_string')" href="../_functions/random_string.html" onMouseOver="funcPopup(event,'random_string')">random_string</a>(6);
<a name="l7987"><span class="linenum">7987</span></a>  
<a name="l7988"><span class="linenum">7988</span></a>      if (<a class="var it2018" onMouseOver="hilite(2018)" onMouseOut="lolite()" onClick="logVariable('extra')" href="../_variables/extra.html">$extra</a>) {
<a name="l7989"><span class="linenum">7989</span></a>          return <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('hostname')" href="../_variables/hostname.html">$hostname</a> .'+'. <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('date')" href="../_variables/date.html">$date</a> .'+'. <a class="var it1911" onMouseOver="hilite(1911)" onMouseOut="lolite()" onClick="logVariable('random')" href="../_variables/random.html">$random</a> .'+'. <a class="var it2018" onMouseOver="hilite(2018)" onMouseOut="lolite()" onClick="logVariable('extra')" href="../_variables/extra.html">$extra</a>;
<a name="l7990"><span class="linenum">7990</span></a>      } else {
<a name="l7991"><span class="linenum">7991</span></a>          return <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('hostname')" href="../_variables/hostname.html">$hostname</a> .'+'. <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('date')" href="../_variables/date.html">$date</a> .'+'. <a class="var it1911" onMouseOver="hilite(1911)" onMouseOut="lolite()" onClick="logVariable('random')" href="../_variables/random.html">$random</a>;
<a name="l7992"><span class="linenum">7992</span></a>      }
<a name="l7993"><span class="linenum">7993</span></a>  }
<a name="l7994"><span class="linenum">7994</span></a>  
<a name="l7995"><span class="linenum">7995</span></a>  
<a name="l7996"><span class="linenum">7996</span></a>  <span class="comment">/**</span>
<a name="l7997"><span class="linenum">7997</span></a>  <span class="comment"> * Function to check the passed address is within the passed subnet</span>
<a name="l7998"><span class="linenum">7998</span></a>  <span class="comment"> *</span>
<a name="l7999"><span class="linenum">7999</span></a>  <span class="comment"> * The parameter is a comma separated string of subnet definitions.</span>
<a name="l8000"><span class="linenum">8000</span></a>  <span class="comment"> * Subnet strings can be in one of three formats:</span>
<a name="l8001"><span class="linenum">8001</span></a>  <span class="comment"> *   1: xxx.xxx.xxx.xxx/nn or xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx/nnn          (number of bits in net mask)</span>
<a name="l8002"><span class="linenum">8002</span></a>  <span class="comment"> *   2: xxx.xxx.xxx.xxx-yyy or  xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx::xxxx-yyyy (a range of IP addresses in the last group)</span>
<a name="l8003"><span class="linenum">8003</span></a>  <span class="comment"> *   3: xxx.xxx or xxx.xxx. or xxx:xxx:xxxx or xxx:xxx:xxxx.                  (incomplete address, a bit non-technical ;-)</span>
<a name="l8004"><span class="linenum">8004</span></a>  <span class="comment"> * Code for type 1 modified from user posted comments by mediator at</span>
<a name="l8005"><span class="linenum">8005</span></a>  <span class="comment"> * {@link http://au.php.net/manual/en/function.ip2long.php}</span>
<a name="l8006"><span class="linenum">8006</span></a>  <span class="comment"> *</span>
<a name="l8007"><span class="linenum">8007</span></a>  <span class="comment"> * @param string $addr    The address you are checking</span>
<a name="l8008"><span class="linenum">8008</span></a>  <span class="comment"> * @param string $subnetstr    The string of subnet addresses</span>
<a name="l8009"><span class="linenum">8009</span></a>  <span class="comment"> * @return bool</span>
<a name="l8010"><span class="linenum">8010</span></a>  <span class="comment"> */</span>
<a name="l8011"><span class="linenum">8011</span></a>  function <a class="function" onClick="logFunction('address_in_subnet')" href="../_functions/address_in_subnet.html" onMouseOver="funcPopup(event,'address_in_subnet')">address_in_subnet</a>(<a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>, <a class="var it13205" onMouseOver="hilite(13205)" onMouseOut="lolite()" onClick="logVariable('subnetstr')" href="../_variables/subnetstr.html">$subnetstr</a>) {
<a name="l8012"><span class="linenum">8012</span></a>  
<a name="l8013"><span class="linenum">8013</span></a>      if (<a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a> == '0.0.0.0') {
<a name="l8014"><span class="linenum">8014</span></a>          return false;
<a name="l8015"><span class="linenum">8015</span></a>      }
<a name="l8016"><span class="linenum">8016</span></a>      <a class="var it13206" onMouseOver="hilite(13206)" onMouseOut="lolite()" onClick="logVariable('subnets')" href="../_variables/subnets.html">$subnets</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(',', <a class="var it13205" onMouseOver="hilite(13205)" onMouseOut="lolite()" onClick="logVariable('subnetstr')" href="../_variables/subnetstr.html">$subnetstr</a>);
<a name="l8017"><span class="linenum">8017</span></a>      <a class="var it1608" onMouseOver="hilite(1608)" onMouseOut="lolite()" onClick="logVariable('found')" href="../_variables/found.html">$found</a> = false;
<a name="l8018"><span class="linenum">8018</span></a>      <a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>);
<a name="l8019"><span class="linenum">8019</span></a>      <a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a> = <a class="function" onClick="logFunction('cleanremoteaddr')" href="../_functions/cleanremoteaddr.html" onMouseOver="funcPopup(event,'cleanremoteaddr')">cleanremoteaddr</a>(<a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>, false); <span class="comment">// Normalise.</span>
<a name="l8020"><span class="linenum">8020</span></a>      if (<a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a> === null) {
<a name="l8021"><span class="linenum">8021</span></a>          return false;
<a name="l8022"><span class="linenum">8022</span></a>      }
<a name="l8023"><span class="linenum">8023</span></a>      <a class="var it13207" onMouseOver="hilite(13207)" onMouseOut="lolite()" onClick="logVariable('addrparts')" href="../_variables/addrparts.html">$addrparts</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(':', <a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>);
<a name="l8024"><span class="linenum">8024</span></a>  
<a name="l8025"><span class="linenum">8025</span></a>      <a class="var it3974" onMouseOver="hilite(3974)" onMouseOut="lolite()" onClick="logVariable('ipv6')" href="../_variables/ipv6.html">$ipv6</a> = <a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>, ':');
<a name="l8026"><span class="linenum">8026</span></a>  
<a name="l8027"><span class="linenum">8027</span></a>      foreach (<a class="var it13206" onMouseOver="hilite(13206)" onMouseOut="lolite()" onClick="logVariable('subnets')" href="../_variables/subnets.html">$subnets</a> as <a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a>) {
<a name="l8028"><span class="linenum">8028</span></a>          <a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a>);
<a name="l8029"><span class="linenum">8029</span></a>          if (<a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a> === '') {
<a name="l8030"><span class="linenum">8030</span></a>              continue;
<a name="l8031"><span class="linenum">8031</span></a>          }
<a name="l8032"><span class="linenum">8032</span></a>  
<a name="l8033"><span class="linenum">8033</span></a>          if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a>, '/') !== false) {
<a name="l8034"><span class="linenum">8034</span></a>  <span class="comment">            // 1: xxx.xxx.xxx.xxx/nn or xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx/nnn.</span>
<a name="l8035"><span class="linenum">8035</span></a>              <a class="function" onClick="logFunction('list')" href="../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it1879" onMouseOver="hilite(1879)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../_variables/ip.html">$ip</a>, <a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a>) = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>('/', <a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a>);
<a name="l8036"><span class="linenum">8036</span></a>              <a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a>);
<a name="l8037"><span class="linenum">8037</span></a>              if (!<a class="function" onClick="logFunction('is_number')" href="../_functions/is_number.html" onMouseOver="funcPopup(event,'is_number')">is_number</a>(<a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a>)) {
<a name="l8038"><span class="linenum">8038</span></a>                  continue; <span class="comment">// Incorect mask number, eh?</span>
<a name="l8039"><span class="linenum">8039</span></a>              }
<a name="l8040"><span class="linenum">8040</span></a>              <a class="var it1879" onMouseOver="hilite(1879)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../_variables/ip.html">$ip</a> = <a class="function" onClick="logFunction('cleanremoteaddr')" href="../_functions/cleanremoteaddr.html" onMouseOver="funcPopup(event,'cleanremoteaddr')">cleanremoteaddr</a>(<a class="var it1879" onMouseOver="hilite(1879)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../_variables/ip.html">$ip</a>, false); <span class="comment">// Normalise.</span>
<a name="l8041"><span class="linenum">8041</span></a>              if (<a class="var it1879" onMouseOver="hilite(1879)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../_variables/ip.html">$ip</a> === null) {
<a name="l8042"><span class="linenum">8042</span></a>                  continue;
<a name="l8043"><span class="linenum">8043</span></a>              }
<a name="l8044"><span class="linenum">8044</span></a>              if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it1879" onMouseOver="hilite(1879)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../_variables/ip.html">$ip</a>, ':') !== false) {
<a name="l8045"><span class="linenum">8045</span></a>  <span class="comment">                // IPv6.</span>
<a name="l8046"><span class="linenum">8046</span></a>                  if (!<a class="var it3974" onMouseOver="hilite(3974)" onMouseOut="lolite()" onClick="logVariable('ipv6')" href="../_variables/ipv6.html">$ipv6</a>) {
<a name="l8047"><span class="linenum">8047</span></a>                      continue;
<a name="l8048"><span class="linenum">8048</span></a>                  }
<a name="l8049"><span class="linenum">8049</span></a>                  if (<a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a> &gt; 128 or <a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a> &lt; 0) {
<a name="l8050"><span class="linenum">8050</span></a>                      continue; <span class="comment">// Nonsense.</span>
<a name="l8051"><span class="linenum">8051</span></a>                  }
<a name="l8052"><span class="linenum">8052</span></a>                  if (<a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a> == 0) {
<a name="l8053"><span class="linenum">8053</span></a>                      return true; <span class="comment">// Any address.</span>
<a name="l8054"><span class="linenum">8054</span></a>                  }
<a name="l8055"><span class="linenum">8055</span></a>                  if (<a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a> == 128) {
<a name="l8056"><span class="linenum">8056</span></a>                      if (<a class="var it1879" onMouseOver="hilite(1879)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../_variables/ip.html">$ip</a> === <a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>) {
<a name="l8057"><span class="linenum">8057</span></a>                          return true;
<a name="l8058"><span class="linenum">8058</span></a>                      }
<a name="l8059"><span class="linenum">8059</span></a>                      continue;
<a name="l8060"><span class="linenum">8060</span></a>                  }
<a name="l8061"><span class="linenum">8061</span></a>                  <a class="var it13209" onMouseOver="hilite(13209)" onMouseOut="lolite()" onClick="logVariable('ipparts')" href="../_variables/ipparts.html">$ipparts</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(':', <a class="var it1879" onMouseOver="hilite(1879)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../_variables/ip.html">$ip</a>);
<a name="l8062"><span class="linenum">8062</span></a>                  <a class="var it13210" onMouseOver="hilite(13210)" onMouseOut="lolite()" onClick="logVariable('modulo')" href="../_variables/modulo.html">$modulo</a>  = <a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a> % 16;
<a name="l8063"><span class="linenum">8063</span></a>                  <a class="var it13211" onMouseOver="hilite(13211)" onMouseOut="lolite()" onClick="logVariable('ipnet')" href="../_variables/ipnet.html">$ipnet</a>   = <a class="phpfunction" onClick="logFunction('array_slice')" href="../_functions/array_slice.html" onMouseOver="phpfuncPopup(event,'array_slice')">array_slice</a>(<a class="var it13209" onMouseOver="hilite(13209)" onMouseOut="lolite()" onClick="logVariable('ipparts')" href="../_variables/ipparts.html">$ipparts</a>, 0, (<a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a>-<a class="var it13210" onMouseOver="hilite(13210)" onMouseOut="lolite()" onClick="logVariable('modulo')" href="../_variables/modulo.html">$modulo</a>)/16);
<a name="l8064"><span class="linenum">8064</span></a>                  <a class="var it13212" onMouseOver="hilite(13212)" onMouseOut="lolite()" onClick="logVariable('addrnet')" href="../_variables/addrnet.html">$addrnet</a> = <a class="phpfunction" onClick="logFunction('array_slice')" href="../_functions/array_slice.html" onMouseOver="phpfuncPopup(event,'array_slice')">array_slice</a>(<a class="var it13207" onMouseOver="hilite(13207)" onMouseOut="lolite()" onClick="logVariable('addrparts')" href="../_variables/addrparts.html">$addrparts</a>, 0, (<a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a>-<a class="var it13210" onMouseOver="hilite(13210)" onMouseOut="lolite()" onClick="logVariable('modulo')" href="../_variables/modulo.html">$modulo</a>)/16);
<a name="l8065"><span class="linenum">8065</span></a>                  if (<a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(':', <a class="var it13211" onMouseOver="hilite(13211)" onMouseOut="lolite()" onClick="logVariable('ipnet')" href="../_variables/ipnet.html">$ipnet</a>) === <a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(':', <a class="var it13212" onMouseOver="hilite(13212)" onMouseOut="lolite()" onClick="logVariable('addrnet')" href="../_variables/addrnet.html">$addrnet</a>)) {
<a name="l8066"><span class="linenum">8066</span></a>                      if (<a class="var it13210" onMouseOver="hilite(13210)" onMouseOut="lolite()" onClick="logVariable('modulo')" href="../_variables/modulo.html">$modulo</a> == 0) {
<a name="l8067"><span class="linenum">8067</span></a>                          return true;
<a name="l8068"><span class="linenum">8068</span></a>                      }
<a name="l8069"><span class="linenum">8069</span></a>                      <a class="var it3230" onMouseOver="hilite(3230)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../_variables/pos.html">$pos</a>     = (<a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a>-<a class="var it13210" onMouseOver="hilite(13210)" onMouseOut="lolite()" onClick="logVariable('modulo')" href="../_variables/modulo.html">$modulo</a>)/16;
<a name="l8070"><span class="linenum">8070</span></a>                      <a class="var it13211" onMouseOver="hilite(13211)" onMouseOut="lolite()" onClick="logVariable('ipnet')" href="../_variables/ipnet.html">$ipnet</a>   = <a class="phpfunction" onClick="logFunction('hexdec')" href="../_functions/hexdec.html" onMouseOver="phpfuncPopup(event,'hexdec')">hexdec</a>(<a class="var it13209" onMouseOver="hilite(13209)" onMouseOut="lolite()" onClick="logVariable('ipparts')" href="../_variables/ipparts.html">$ipparts</a>[<a class="var it3230" onMouseOver="hilite(3230)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../_variables/pos.html">$pos</a>]);
<a name="l8071"><span class="linenum">8071</span></a>                      <a class="var it13212" onMouseOver="hilite(13212)" onMouseOut="lolite()" onClick="logVariable('addrnet')" href="../_variables/addrnet.html">$addrnet</a> = <a class="phpfunction" onClick="logFunction('hexdec')" href="../_functions/hexdec.html" onMouseOver="phpfuncPopup(event,'hexdec')">hexdec</a>(<a class="var it13207" onMouseOver="hilite(13207)" onMouseOut="lolite()" onClick="logVariable('addrparts')" href="../_variables/addrparts.html">$addrparts</a>[<a class="var it3230" onMouseOver="hilite(3230)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../_variables/pos.html">$pos</a>]);
<a name="l8072"><span class="linenum">8072</span></a>                      <a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a>    = 0xffff &lt;&lt; (16 - <a class="var it13210" onMouseOver="hilite(13210)" onMouseOut="lolite()" onClick="logVariable('modulo')" href="../_variables/modulo.html">$modulo</a>);
<a name="l8073"><span class="linenum">8073</span></a>                      if ((<a class="var it13212" onMouseOver="hilite(13212)" onMouseOut="lolite()" onClick="logVariable('addrnet')" href="../_variables/addrnet.html">$addrnet</a> &amp; <a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a>) == (<a class="var it13211" onMouseOver="hilite(13211)" onMouseOut="lolite()" onClick="logVariable('ipnet')" href="../_variables/ipnet.html">$ipnet</a> &amp; <a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a>)) {
<a name="l8074"><span class="linenum">8074</span></a>                          return true;
<a name="l8075"><span class="linenum">8075</span></a>                      }
<a name="l8076"><span class="linenum">8076</span></a>                  }
<a name="l8077"><span class="linenum">8077</span></a>  
<a name="l8078"><span class="linenum">8078</span></a>              } else {
<a name="l8079"><span class="linenum">8079</span></a>  <span class="comment">                // IPv4.</span>
<a name="l8080"><span class="linenum">8080</span></a>                  if (<a class="var it3974" onMouseOver="hilite(3974)" onMouseOut="lolite()" onClick="logVariable('ipv6')" href="../_variables/ipv6.html">$ipv6</a>) {
<a name="l8081"><span class="linenum">8081</span></a>                      continue;
<a name="l8082"><span class="linenum">8082</span></a>                  }
<a name="l8083"><span class="linenum">8083</span></a>                  if (<a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a> &gt; 32 or <a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a> &lt; 0) {
<a name="l8084"><span class="linenum">8084</span></a>                      continue; <span class="comment">// Nonsense.</span>
<a name="l8085"><span class="linenum">8085</span></a>                  }
<a name="l8086"><span class="linenum">8086</span></a>                  if (<a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a> == 0) {
<a name="l8087"><span class="linenum">8087</span></a>                      return true;
<a name="l8088"><span class="linenum">8088</span></a>                  }
<a name="l8089"><span class="linenum">8089</span></a>                  if (<a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a> == 32) {
<a name="l8090"><span class="linenum">8090</span></a>                      if (<a class="var it1879" onMouseOver="hilite(1879)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../_variables/ip.html">$ip</a> === <a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>) {
<a name="l8091"><span class="linenum">8091</span></a>                          return true;
<a name="l8092"><span class="linenum">8092</span></a>                      }
<a name="l8093"><span class="linenum">8093</span></a>                      continue;
<a name="l8094"><span class="linenum">8094</span></a>                  }
<a name="l8095"><span class="linenum">8095</span></a>                  <a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a> = 0xffffffff &lt;&lt; (32 - <a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a>);
<a name="l8096"><span class="linenum">8096</span></a>                  if (((<a class="phpfunction" onClick="logFunction('ip2long')" href="../_functions/ip2long.html" onMouseOver="phpfuncPopup(event,'ip2long')">ip2long</a>(<a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>) &amp; <a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a>) == (<a class="phpfunction" onClick="logFunction('ip2long')" href="../_functions/ip2long.html" onMouseOver="phpfuncPopup(event,'ip2long')">ip2long</a>(<a class="var it1879" onMouseOver="hilite(1879)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../_variables/ip.html">$ip</a>) &amp; <a class="var it1925" onMouseOver="hilite(1925)" onMouseOut="lolite()" onClick="logVariable('mask')" href="../_variables/mask.html">$mask</a>))) {
<a name="l8097"><span class="linenum">8097</span></a>                      return true;
<a name="l8098"><span class="linenum">8098</span></a>                  }
<a name="l8099"><span class="linenum">8099</span></a>              }
<a name="l8100"><span class="linenum">8100</span></a>  
<a name="l8101"><span class="linenum">8101</span></a>          } else if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a>, '-') !== false) {
<a name="l8102"><span class="linenum">8102</span></a>  <span class="comment">            // 2: xxx.xxx.xxx.xxx-yyy or  xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx::xxxx-yyyy. A range of IP addresses in the last group.</span>
<a name="l8103"><span class="linenum">8103</span></a>              <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>('-', <a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a>);
<a name="l8104"><span class="linenum">8104</span></a>              if (<a class="phpfunction" onClick="logFunction('count')" href="../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>) != 2) {
<a name="l8105"><span class="linenum">8105</span></a>                  continue;
<a name="l8106"><span class="linenum">8106</span></a>              }
<a name="l8107"><span class="linenum">8107</span></a>  
<a name="l8108"><span class="linenum">8108</span></a>              if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a>, ':') !== false) {
<a name="l8109"><span class="linenum">8109</span></a>  <span class="comment">                // IPv6.</span>
<a name="l8110"><span class="linenum">8110</span></a>                  if (!<a class="var it3974" onMouseOver="hilite(3974)" onMouseOut="lolite()" onClick="logVariable('ipv6')" href="../_variables/ipv6.html">$ipv6</a>) {
<a name="l8111"><span class="linenum">8111</span></a>                      continue;
<a name="l8112"><span class="linenum">8112</span></a>                  }
<a name="l8113"><span class="linenum">8113</span></a>                  <a class="var it13213" onMouseOver="hilite(13213)" onMouseOut="lolite()" onClick="logVariable('ipstart')" href="../_variables/ipstart.html">$ipstart</a> = <a class="function" onClick="logFunction('cleanremoteaddr')" href="../_functions/cleanremoteaddr.html" onMouseOver="funcPopup(event,'cleanremoteaddr')">cleanremoteaddr</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>[0]), false); <span class="comment">// Normalise.</span>
<a name="l8114"><span class="linenum">8114</span></a>                  if (<a class="var it13213" onMouseOver="hilite(13213)" onMouseOut="lolite()" onClick="logVariable('ipstart')" href="../_variables/ipstart.html">$ipstart</a> === null) {
<a name="l8115"><span class="linenum">8115</span></a>                      continue;
<a name="l8116"><span class="linenum">8116</span></a>                  }
<a name="l8117"><span class="linenum">8117</span></a>                  <a class="var it13209" onMouseOver="hilite(13209)" onMouseOut="lolite()" onClick="logVariable('ipparts')" href="../_variables/ipparts.html">$ipparts</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(':', <a class="var it13213" onMouseOver="hilite(13213)" onMouseOut="lolite()" onClick="logVariable('ipstart')" href="../_variables/ipstart.html">$ipstart</a>);
<a name="l8118"><span class="linenum">8118</span></a>                  <a class="var it340" onMouseOver="hilite(340)" onMouseOut="lolite()" onClick="logVariable('start')" href="../_variables/start.html">$start</a> = <a class="phpfunction" onClick="logFunction('hexdec')" href="../_functions/hexdec.html" onMouseOver="phpfuncPopup(event,'hexdec')">hexdec</a>(<a class="phpfunction" onClick="logFunction('array_pop')" href="../_functions/array_pop.html" onMouseOver="phpfuncPopup(event,'array_pop')">array_pop</a>(<a class="var it13209" onMouseOver="hilite(13209)" onMouseOut="lolite()" onClick="logVariable('ipparts')" href="../_variables/ipparts.html">$ipparts</a>));
<a name="l8119"><span class="linenum">8119</span></a>                  <a class="var it13209" onMouseOver="hilite(13209)" onMouseOut="lolite()" onClick="logVariable('ipparts')" href="../_variables/ipparts.html">$ipparts</a>[] = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>[1]);
<a name="l8120"><span class="linenum">8120</span></a>                  <a class="var it13214" onMouseOver="hilite(13214)" onMouseOut="lolite()" onClick="logVariable('ipend')" href="../_variables/ipend.html">$ipend</a> = <a class="function" onClick="logFunction('cleanremoteaddr')" href="../_functions/cleanremoteaddr.html" onMouseOver="funcPopup(event,'cleanremoteaddr')">cleanremoteaddr</a>(<a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(':', <a class="var it13209" onMouseOver="hilite(13209)" onMouseOut="lolite()" onClick="logVariable('ipparts')" href="../_variables/ipparts.html">$ipparts</a>), false); <span class="comment">// Normalise.</span>
<a name="l8121"><span class="linenum">8121</span></a>                  if (<a class="var it13214" onMouseOver="hilite(13214)" onMouseOut="lolite()" onClick="logVariable('ipend')" href="../_variables/ipend.html">$ipend</a> === null) {
<a name="l8122"><span class="linenum">8122</span></a>                      continue;
<a name="l8123"><span class="linenum">8123</span></a>                  }
<a name="l8124"><span class="linenum">8124</span></a>                  <a class="var it13209" onMouseOver="hilite(13209)" onMouseOut="lolite()" onClick="logVariable('ipparts')" href="../_variables/ipparts.html">$ipparts</a>[7] = '';
<a name="l8125"><span class="linenum">8125</span></a>                  <a class="var it13211" onMouseOver="hilite(13211)" onMouseOut="lolite()" onClick="logVariable('ipnet')" href="../_variables/ipnet.html">$ipnet</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(':', <a class="var it13209" onMouseOver="hilite(13209)" onMouseOut="lolite()" onClick="logVariable('ipparts')" href="../_variables/ipparts.html">$ipparts</a>);
<a name="l8126"><span class="linenum">8126</span></a>                  if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>, <a class="var it13211" onMouseOver="hilite(13211)" onMouseOut="lolite()" onClick="logVariable('ipnet')" href="../_variables/ipnet.html">$ipnet</a>) !== 0) {
<a name="l8127"><span class="linenum">8127</span></a>                      continue;
<a name="l8128"><span class="linenum">8128</span></a>                  }
<a name="l8129"><span class="linenum">8129</span></a>                  <a class="var it13209" onMouseOver="hilite(13209)" onMouseOut="lolite()" onClick="logVariable('ipparts')" href="../_variables/ipparts.html">$ipparts</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(':', <a class="var it13214" onMouseOver="hilite(13214)" onMouseOut="lolite()" onClick="logVariable('ipend')" href="../_variables/ipend.html">$ipend</a>);
<a name="l8130"><span class="linenum">8130</span></a>                  <a class="var it1658" onMouseOver="hilite(1658)" onMouseOut="lolite()" onClick="logVariable('end')" href="../_variables/end.html">$end</a> = <a class="phpfunction" onClick="logFunction('hexdec')" href="../_functions/hexdec.html" onMouseOver="phpfuncPopup(event,'hexdec')">hexdec</a>(<a class="var it13209" onMouseOver="hilite(13209)" onMouseOut="lolite()" onClick="logVariable('ipparts')" href="../_variables/ipparts.html">$ipparts</a>[7]);
<a name="l8131"><span class="linenum">8131</span></a>  
<a name="l8132"><span class="linenum">8132</span></a>                  <a class="var it13215" onMouseOver="hilite(13215)" onMouseOut="lolite()" onClick="logVariable('addrend')" href="../_variables/addrend.html">$addrend</a> = <a class="phpfunction" onClick="logFunction('hexdec')" href="../_functions/hexdec.html" onMouseOver="phpfuncPopup(event,'hexdec')">hexdec</a>(<a class="var it13207" onMouseOver="hilite(13207)" onMouseOut="lolite()" onClick="logVariable('addrparts')" href="../_variables/addrparts.html">$addrparts</a>[7]);
<a name="l8133"><span class="linenum">8133</span></a>  
<a name="l8134"><span class="linenum">8134</span></a>                  if ((<a class="var it13215" onMouseOver="hilite(13215)" onMouseOut="lolite()" onClick="logVariable('addrend')" href="../_variables/addrend.html">$addrend</a> &gt;= <a class="var it340" onMouseOver="hilite(340)" onMouseOut="lolite()" onClick="logVariable('start')" href="../_variables/start.html">$start</a>) and (<a class="var it13215" onMouseOver="hilite(13215)" onMouseOut="lolite()" onClick="logVariable('addrend')" href="../_variables/addrend.html">$addrend</a> &lt;= <a class="var it1658" onMouseOver="hilite(1658)" onMouseOut="lolite()" onClick="logVariable('end')" href="../_variables/end.html">$end</a>)) {
<a name="l8135"><span class="linenum">8135</span></a>                      return true;
<a name="l8136"><span class="linenum">8136</span></a>                  }
<a name="l8137"><span class="linenum">8137</span></a>  
<a name="l8138"><span class="linenum">8138</span></a>              } else {
<a name="l8139"><span class="linenum">8139</span></a>  <span class="comment">                // IPv4.</span>
<a name="l8140"><span class="linenum">8140</span></a>                  if (<a class="var it3974" onMouseOver="hilite(3974)" onMouseOut="lolite()" onClick="logVariable('ipv6')" href="../_variables/ipv6.html">$ipv6</a>) {
<a name="l8141"><span class="linenum">8141</span></a>                      continue;
<a name="l8142"><span class="linenum">8142</span></a>                  }
<a name="l8143"><span class="linenum">8143</span></a>                  <a class="var it13213" onMouseOver="hilite(13213)" onMouseOut="lolite()" onClick="logVariable('ipstart')" href="../_variables/ipstart.html">$ipstart</a> = <a class="function" onClick="logFunction('cleanremoteaddr')" href="../_functions/cleanremoteaddr.html" onMouseOver="funcPopup(event,'cleanremoteaddr')">cleanremoteaddr</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>[0]), false); <span class="comment">// Normalise.</span>
<a name="l8144"><span class="linenum">8144</span></a>                  if (<a class="var it13213" onMouseOver="hilite(13213)" onMouseOut="lolite()" onClick="logVariable('ipstart')" href="../_variables/ipstart.html">$ipstart</a> === null) {
<a name="l8145"><span class="linenum">8145</span></a>                      continue;
<a name="l8146"><span class="linenum">8146</span></a>                  }
<a name="l8147"><span class="linenum">8147</span></a>                  <a class="var it13209" onMouseOver="hilite(13209)" onMouseOut="lolite()" onClick="logVariable('ipparts')" href="../_variables/ipparts.html">$ipparts</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>('.', <a class="var it13213" onMouseOver="hilite(13213)" onMouseOut="lolite()" onClick="logVariable('ipstart')" href="../_variables/ipstart.html">$ipstart</a>);
<a name="l8148"><span class="linenum">8148</span></a>                  <a class="var it13209" onMouseOver="hilite(13209)" onMouseOut="lolite()" onClick="logVariable('ipparts')" href="../_variables/ipparts.html">$ipparts</a>[3] = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>[1]);
<a name="l8149"><span class="linenum">8149</span></a>                  <a class="var it13214" onMouseOver="hilite(13214)" onMouseOut="lolite()" onClick="logVariable('ipend')" href="../_variables/ipend.html">$ipend</a> = <a class="function" onClick="logFunction('cleanremoteaddr')" href="../_functions/cleanremoteaddr.html" onMouseOver="funcPopup(event,'cleanremoteaddr')">cleanremoteaddr</a>(<a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>('.', <a class="var it13209" onMouseOver="hilite(13209)" onMouseOut="lolite()" onClick="logVariable('ipparts')" href="../_variables/ipparts.html">$ipparts</a>), false); <span class="comment">// Normalise.</span>
<a name="l8150"><span class="linenum">8150</span></a>                  if (<a class="var it13214" onMouseOver="hilite(13214)" onMouseOut="lolite()" onClick="logVariable('ipend')" href="../_variables/ipend.html">$ipend</a> === null) {
<a name="l8151"><span class="linenum">8151</span></a>                      continue;
<a name="l8152"><span class="linenum">8152</span></a>                  }
<a name="l8153"><span class="linenum">8153</span></a>  
<a name="l8154"><span class="linenum">8154</span></a>                  if ((<a class="phpfunction" onClick="logFunction('ip2long')" href="../_functions/ip2long.html" onMouseOver="phpfuncPopup(event,'ip2long')">ip2long</a>(<a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>) &gt;= <a class="phpfunction" onClick="logFunction('ip2long')" href="../_functions/ip2long.html" onMouseOver="phpfuncPopup(event,'ip2long')">ip2long</a>(<a class="var it13213" onMouseOver="hilite(13213)" onMouseOut="lolite()" onClick="logVariable('ipstart')" href="../_variables/ipstart.html">$ipstart</a>)) and (<a class="phpfunction" onClick="logFunction('ip2long')" href="../_functions/ip2long.html" onMouseOver="phpfuncPopup(event,'ip2long')">ip2long</a>(<a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>) &lt;= <a class="phpfunction" onClick="logFunction('ip2long')" href="../_functions/ip2long.html" onMouseOver="phpfuncPopup(event,'ip2long')">ip2long</a>(<a class="var it13214" onMouseOver="hilite(13214)" onMouseOut="lolite()" onClick="logVariable('ipend')" href="../_variables/ipend.html">$ipend</a>))) {
<a name="l8155"><span class="linenum">8155</span></a>                      return true;
<a name="l8156"><span class="linenum">8156</span></a>                  }
<a name="l8157"><span class="linenum">8157</span></a>              }
<a name="l8158"><span class="linenum">8158</span></a>  
<a name="l8159"><span class="linenum">8159</span></a>          } else {
<a name="l8160"><span class="linenum">8160</span></a>  <span class="comment">            // 3: xxx.xxx or xxx.xxx. or xxx:xxx:xxxx or xxx:xxx:xxxx.</span>
<a name="l8161"><span class="linenum">8161</span></a>              if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a>, ':') !== false) {
<a name="l8162"><span class="linenum">8162</span></a>  <span class="comment">                // IPv6.</span>
<a name="l8163"><span class="linenum">8163</span></a>                  if (!<a class="var it3974" onMouseOver="hilite(3974)" onMouseOut="lolite()" onClick="logVariable('ipv6')" href="../_variables/ipv6.html">$ipv6</a>) {
<a name="l8164"><span class="linenum">8164</span></a>                      continue;
<a name="l8165"><span class="linenum">8165</span></a>                  }
<a name="l8166"><span class="linenum">8166</span></a>                  <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(':', <a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a>);
<a name="l8167"><span class="linenum">8167</span></a>                  <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a> = <a class="phpfunction" onClick="logFunction('count')" href="../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>);
<a name="l8168"><span class="linenum">8168</span></a>                  if (<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>[<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a>-1] === '') {
<a name="l8169"><span class="linenum">8169</span></a>                      unset(<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>[<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a>-1]); <span class="comment">// Trim trailing :'s.</span>
<a name="l8170"><span class="linenum">8170</span></a>                      <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a>--;
<a name="l8171"><span class="linenum">8171</span></a>                      <a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>('.', <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>);
<a name="l8172"><span class="linenum">8172</span></a>                  }
<a name="l8173"><span class="linenum">8173</span></a>                  <a class="var it13216" onMouseOver="hilite(13216)" onMouseOut="lolite()" onClick="logVariable('isip')" href="../_variables/isip.html">$isip</a> = <a class="function" onClick="logFunction('cleanremoteaddr')" href="../_functions/cleanremoteaddr.html" onMouseOver="funcPopup(event,'cleanremoteaddr')">cleanremoteaddr</a>(<a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a>, false); <span class="comment">// Normalise.</span>
<a name="l8174"><span class="linenum">8174</span></a>                  if (<a class="var it13216" onMouseOver="hilite(13216)" onMouseOut="lolite()" onClick="logVariable('isip')" href="../_variables/isip.html">$isip</a> !== null) {
<a name="l8175"><span class="linenum">8175</span></a>                      if (<a class="var it13216" onMouseOver="hilite(13216)" onMouseOut="lolite()" onClick="logVariable('isip')" href="../_variables/isip.html">$isip</a> === <a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>) {
<a name="l8176"><span class="linenum">8176</span></a>                          return true;
<a name="l8177"><span class="linenum">8177</span></a>                      }
<a name="l8178"><span class="linenum">8178</span></a>                      continue;
<a name="l8179"><span class="linenum">8179</span></a>                  } else if (<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a> &gt; 8) {
<a name="l8180"><span class="linenum">8180</span></a>                      continue;
<a name="l8181"><span class="linenum">8181</span></a>                  }
<a name="l8182"><span class="linenum">8182</span></a>                  <a class="var it13217" onMouseOver="hilite(13217)" onMouseOut="lolite()" onClick="logVariable('zeros')" href="../_variables/zeros.html">$zeros</a> = <a class="phpfunction" onClick="logFunction('array_fill')" href="../_functions/array_fill.html" onMouseOver="phpfuncPopup(event,'array_fill')">array_fill</a>(0, 8-<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a>, '0');
<a name="l8183"><span class="linenum">8183</span></a>                  <a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a> = <a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a>.':'.<a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(':', <a class="var it13217" onMouseOver="hilite(13217)" onMouseOut="lolite()" onClick="logVariable('zeros')" href="../_variables/zeros.html">$zeros</a>).'/'.(<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a>*16);
<a name="l8184"><span class="linenum">8184</span></a>                  if (<a class="function" onClick="logFunction('address_in_subnet')" href="../_functions/address_in_subnet.html" onMouseOver="funcPopup(event,'address_in_subnet')">address_in_subnet</a>(<a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>, <a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a>)) {
<a name="l8185"><span class="linenum">8185</span></a>                      return true;
<a name="l8186"><span class="linenum">8186</span></a>                  }
<a name="l8187"><span class="linenum">8187</span></a>  
<a name="l8188"><span class="linenum">8188</span></a>              } else {
<a name="l8189"><span class="linenum">8189</span></a>  <span class="comment">                // IPv4.</span>
<a name="l8190"><span class="linenum">8190</span></a>                  if (<a class="var it3974" onMouseOver="hilite(3974)" onMouseOut="lolite()" onClick="logVariable('ipv6')" href="../_variables/ipv6.html">$ipv6</a>) {
<a name="l8191"><span class="linenum">8191</span></a>                      continue;
<a name="l8192"><span class="linenum">8192</span></a>                  }
<a name="l8193"><span class="linenum">8193</span></a>                  <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>('.', <a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a>);
<a name="l8194"><span class="linenum">8194</span></a>                  <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a> = <a class="phpfunction" onClick="logFunction('count')" href="../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>);
<a name="l8195"><span class="linenum">8195</span></a>                  if (<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>[<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a>-1] === '') {
<a name="l8196"><span class="linenum">8196</span></a>                      unset(<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>[<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a>-1]); <span class="comment">// Trim trailing .</span>
<a name="l8197"><span class="linenum">8197</span></a>                      <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a>--;
<a name="l8198"><span class="linenum">8198</span></a>                      <a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>('.', <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>);
<a name="l8199"><span class="linenum">8199</span></a>                  }
<a name="l8200"><span class="linenum">8200</span></a>                  if (<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a> == 4) {
<a name="l8201"><span class="linenum">8201</span></a>                      <a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a> = <a class="function" onClick="logFunction('cleanremoteaddr')" href="../_functions/cleanremoteaddr.html" onMouseOver="funcPopup(event,'cleanremoteaddr')">cleanremoteaddr</a>(<a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a>, false); <span class="comment">// Normalise.</span>
<a name="l8202"><span class="linenum">8202</span></a>                      if (<a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a> === <a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>) {
<a name="l8203"><span class="linenum">8203</span></a>                          return true;
<a name="l8204"><span class="linenum">8204</span></a>                      }
<a name="l8205"><span class="linenum">8205</span></a>                      continue;
<a name="l8206"><span class="linenum">8206</span></a>                  } else if (<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a> &gt; 4) {
<a name="l8207"><span class="linenum">8207</span></a>                      continue;
<a name="l8208"><span class="linenum">8208</span></a>                  }
<a name="l8209"><span class="linenum">8209</span></a>                  <a class="var it13217" onMouseOver="hilite(13217)" onMouseOut="lolite()" onClick="logVariable('zeros')" href="../_variables/zeros.html">$zeros</a> = <a class="phpfunction" onClick="logFunction('array_fill')" href="../_functions/array_fill.html" onMouseOver="phpfuncPopup(event,'array_fill')">array_fill</a>(0, 4-<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a>, '0');
<a name="l8210"><span class="linenum">8210</span></a>                  <a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a> = <a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a>.'.'.<a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>('.', <a class="var it13217" onMouseOver="hilite(13217)" onMouseOut="lolite()" onClick="logVariable('zeros')" href="../_variables/zeros.html">$zeros</a>).'/'.(<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a>*8);
<a name="l8211"><span class="linenum">8211</span></a>                  if (<a class="function" onClick="logFunction('address_in_subnet')" href="../_functions/address_in_subnet.html" onMouseOver="funcPopup(event,'address_in_subnet')">address_in_subnet</a>(<a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>, <a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a>)) {
<a name="l8212"><span class="linenum">8212</span></a>                      return true;
<a name="l8213"><span class="linenum">8213</span></a>                  }
<a name="l8214"><span class="linenum">8214</span></a>              }
<a name="l8215"><span class="linenum">8215</span></a>          }
<a name="l8216"><span class="linenum">8216</span></a>      }
<a name="l8217"><span class="linenum">8217</span></a>  
<a name="l8218"><span class="linenum">8218</span></a>      return false;
<a name="l8219"><span class="linenum">8219</span></a>  }
<a name="l8220"><span class="linenum">8220</span></a>  
<a name="l8221"><span class="linenum">8221</span></a>  <span class="comment">/**</span>
<a name="l8222"><span class="linenum">8222</span></a>  <span class="comment"> * For outputting debugging info</span>
<a name="l8223"><span class="linenum">8223</span></a>  <span class="comment"> *</span>
<a name="l8224"><span class="linenum">8224</span></a>  <span class="comment"> * @param string $string The string to write</span>
<a name="l8225"><span class="linenum">8225</span></a>  <span class="comment"> * @param string $eol The end of line char(s) to use</span>
<a name="l8226"><span class="linenum">8226</span></a>  <span class="comment"> * @param string $sleep Period to make the application sleep</span>
<a name="l8227"><span class="linenum">8227</span></a>  <span class="comment"> *                      This ensures any messages have time to display before redirect</span>
<a name="l8228"><span class="linenum">8228</span></a>  <span class="comment"> */</span>
<a name="l8229"><span class="linenum">8229</span></a>  function <a class="function" onClick="logFunction('mtrace')" href="../_functions/mtrace.html" onMouseOver="funcPopup(event,'mtrace')">mtrace</a>(<a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>, <a class="var it1831" onMouseOver="hilite(1831)" onMouseOut="lolite()" onClick="logVariable('eol')" href="../_variables/eol.html">$eol</a>=&quot;\n&quot;, <a class="var it13218" onMouseOver="hilite(13218)" onMouseOut="lolite()" onClick="logVariable('sleep')" href="../_variables/sleep.html">$sleep</a>=0) {
<a name="l8230"><span class="linenum">8230</span></a>  
<a name="l8231"><span class="linenum">8231</span></a>      if (<a class="phpfunction" onClick="logFunction('defined')" href="../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('STDOUT') and !<a class="constant" onClick="logConstant('PHPUNIT_TEST')" href="../_constants/PHPUNIT_TEST.html" onMouseOver="constPopup(event,'PHPUNIT_TEST')">PHPUNIT_TEST</a>) {
<a name="l8232"><span class="linenum">8232</span></a>          <a class="phpfunction" onClick="logFunction('fwrite')" href="../_functions/fwrite.html" onMouseOver="phpfuncPopup(event,'fwrite')">fwrite</a>(STDOUT, <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a>.<a class="var it1831" onMouseOver="hilite(1831)" onMouseOut="lolite()" onClick="logVariable('eol')" href="../_variables/eol.html">$eol</a>);
<a name="l8233"><span class="linenum">8233</span></a>      } else {
<a name="l8234"><span class="linenum">8234</span></a>          echo <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a> . <a class="var it1831" onMouseOver="hilite(1831)" onMouseOut="lolite()" onClick="logVariable('eol')" href="../_variables/eol.html">$eol</a>;
<a name="l8235"><span class="linenum">8235</span></a>      }
<a name="l8236"><span class="linenum">8236</span></a>  
<a name="l8237"><span class="linenum">8237</span></a>      <a class="phpfunction" onClick="logFunction('flush')" href="../_functions/flush.html" onMouseOver="phpfuncPopup(event,'flush')">flush</a>();
<a name="l8238"><span class="linenum">8238</span></a>  
<a name="l8239"><span class="linenum">8239</span></a>  <span class="comment">    // Delay to keep message on user's screen in case of subsequent redirect.</span>
<a name="l8240"><span class="linenum">8240</span></a>      if (<a class="var it13218" onMouseOver="hilite(13218)" onMouseOut="lolite()" onClick="logVariable('sleep')" href="../_variables/sleep.html">$sleep</a>) {
<a name="l8241"><span class="linenum">8241</span></a>          <a class="phpfunction" onClick="logFunction('sleep')" href="../_functions/sleep.html" onMouseOver="phpfuncPopup(event,'sleep')">sleep</a>(<a class="var it13218" onMouseOver="hilite(13218)" onMouseOut="lolite()" onClick="logVariable('sleep')" href="../_variables/sleep.html">$sleep</a>);
<a name="l8242"><span class="linenum">8242</span></a>      }
<a name="l8243"><span class="linenum">8243</span></a>  }
<a name="l8244"><span class="linenum">8244</span></a>  
<a name="l8245"><span class="linenum">8245</span></a>  <span class="comment">/**</span>
<a name="l8246"><span class="linenum">8246</span></a>  <span class="comment"> * Replace 1 or more slashes or backslashes to 1 slash</span>
<a name="l8247"><span class="linenum">8247</span></a>  <span class="comment"> *</span>
<a name="l8248"><span class="linenum">8248</span></a>  <span class="comment"> * @param string $path The path to strip</span>
<a name="l8249"><span class="linenum">8249</span></a>  <span class="comment"> * @return string the path with double slashes removed</span>
<a name="l8250"><span class="linenum">8250</span></a>  <span class="comment"> */</span>
<a name="l8251"><span class="linenum">8251</span></a>  function <a class="function" onClick="logFunction('cleardoubleslashes')" href="../_functions/cleardoubleslashes.html" onMouseOver="funcPopup(event,'cleardoubleslashes')">cleardoubleslashes</a> (<a class="var it154" onMouseOver="hilite(154)" onMouseOut="lolite()" onClick="logVariable('path')" href="../_variables/path.html">$path</a>) {
<a name="l8252"><span class="linenum">8252</span></a>      return <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/(\/|\\\){1,}/', '/', <a class="var it154" onMouseOver="hilite(154)" onMouseOut="lolite()" onClick="logVariable('path')" href="../_variables/path.html">$path</a>);
<a name="l8253"><span class="linenum">8253</span></a>  }
<a name="l8254"><span class="linenum">8254</span></a>  
<a name="l8255"><span class="linenum">8255</span></a>  <span class="comment">/**</span>
<a name="l8256"><span class="linenum">8256</span></a>  <span class="comment"> * Is current ip in give list?</span>
<a name="l8257"><span class="linenum">8257</span></a>  <span class="comment"> *</span>
<a name="l8258"><span class="linenum">8258</span></a>  <span class="comment"> * @param string $list</span>
<a name="l8259"><span class="linenum">8259</span></a>  <span class="comment"> * @return bool</span>
<a name="l8260"><span class="linenum">8260</span></a>  <span class="comment"> */</span>
<a name="l8261"><span class="linenum">8261</span></a>  function <a class="function" onClick="logFunction('remoteip_in_list')" href="../_functions/remoteip_in_list.html" onMouseOver="funcPopup(event,'remoteip_in_list')">remoteip_in_list</a>(<a class="var it301" onMouseOver="hilite(301)" onMouseOut="lolite()" onClick="logVariable('list')" href="../_variables/list.html">$list</a>) {
<a name="l8262"><span class="linenum">8262</span></a>      <a class="var it13219" onMouseOver="hilite(13219)" onMouseOut="lolite()" onClick="logVariable('inlist')" href="../_variables/inlist.html">$inlist</a> = false;
<a name="l8263"><span class="linenum">8263</span></a>      <a class="var it13220" onMouseOver="hilite(13220)" onMouseOut="lolite()" onClick="logVariable('clientip')" href="../_variables/clientip.html">$clientip</a> = <a class="function" onClick="logFunction('getremoteaddr')" href="../_functions/getremoteaddr.html" onMouseOver="funcPopup(event,'getremoteaddr')">getremoteaddr</a>(null);
<a name="l8264"><span class="linenum">8264</span></a>  
<a name="l8265"><span class="linenum">8265</span></a>      if (!<a class="var it13220" onMouseOver="hilite(13220)" onMouseOut="lolite()" onClick="logVariable('clientip')" href="../_variables/clientip.html">$clientip</a>) {
<a name="l8266"><span class="linenum">8266</span></a>  <span class="comment">        // Ensure access on cli.</span>
<a name="l8267"><span class="linenum">8267</span></a>          return true;
<a name="l8268"><span class="linenum">8268</span></a>      }
<a name="l8269"><span class="linenum">8269</span></a>  
<a name="l8270"><span class="linenum">8270</span></a>      <a class="var it301" onMouseOver="hilite(301)" onMouseOut="lolite()" onClick="logVariable('list')" href="../_variables/list.html">$list</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(&quot;\n&quot;, <a class="var it301" onMouseOver="hilite(301)" onMouseOut="lolite()" onClick="logVariable('list')" href="../_variables/list.html">$list</a>);
<a name="l8271"><span class="linenum">8271</span></a>      foreach (<a class="var it301" onMouseOver="hilite(301)" onMouseOut="lolite()" onClick="logVariable('list')" href="../_variables/list.html">$list</a> as <a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a>) {
<a name="l8272"><span class="linenum">8272</span></a>          <a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a>);
<a name="l8273"><span class="linenum">8273</span></a>          if (<a class="function" onClick="logFunction('address_in_subnet')" href="../_functions/address_in_subnet.html" onMouseOver="funcPopup(event,'address_in_subnet')">address_in_subnet</a>(<a class="var it13220" onMouseOver="hilite(13220)" onMouseOut="lolite()" onClick="logVariable('clientip')" href="../_variables/clientip.html">$clientip</a>, <a class="var it13208" onMouseOver="hilite(13208)" onMouseOut="lolite()" onClick="logVariable('subnet')" href="../_variables/subnet.html">$subnet</a>)) {
<a name="l8274"><span class="linenum">8274</span></a>              <a class="var it13219" onMouseOver="hilite(13219)" onMouseOut="lolite()" onClick="logVariable('inlist')" href="../_variables/inlist.html">$inlist</a> = true;
<a name="l8275"><span class="linenum">8275</span></a>              break;
<a name="l8276"><span class="linenum">8276</span></a>          }
<a name="l8277"><span class="linenum">8277</span></a>      }
<a name="l8278"><span class="linenum">8278</span></a>      return <a class="var it13219" onMouseOver="hilite(13219)" onMouseOut="lolite()" onClick="logVariable('inlist')" href="../_variables/inlist.html">$inlist</a>;
<a name="l8279"><span class="linenum">8279</span></a>  }
<a name="l8280"><span class="linenum">8280</span></a>  
<a name="l8281"><span class="linenum">8281</span></a>  <span class="comment">/**</span>
<a name="l8282"><span class="linenum">8282</span></a>  <span class="comment"> * Returns most reliable client address</span>
<a name="l8283"><span class="linenum">8283</span></a>  <span class="comment"> *</span>
<a name="l8284"><span class="linenum">8284</span></a>  <span class="comment"> * @param string $default If an address can't be determined, then return this</span>
<a name="l8285"><span class="linenum">8285</span></a>  <span class="comment"> * @return string The remote IP address</span>
<a name="l8286"><span class="linenum">8286</span></a>  <span class="comment"> */</span>
<a name="l8287"><span class="linenum">8287</span></a>  function <a class="function" onClick="logFunction('getremoteaddr')" href="../_functions/getremoteaddr.html" onMouseOver="funcPopup(event,'getremoteaddr')">getremoteaddr</a>(<a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>='0.0.0.0') {
<a name="l8288"><span class="linenum">8288</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l8289"><span class="linenum">8289</span></a>  
<a name="l8290"><span class="linenum">8290</span></a>      if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('getremoteaddrconf')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/getremoteaddrconf.html">getremoteaddrconf</a>)) {
<a name="l8291"><span class="linenum">8291</span></a>  <span class="comment">        // This will happen, for example, before just after the upgrade, as the</span>
<a name="l8292"><span class="linenum">8292</span></a>  <span class="comment">        // user is redirected to the admin screen.</span>
<a name="l8293"><span class="linenum">8293</span></a>          <a class="var it13222" onMouseOver="hilite(13222)" onMouseOut="lolite()" onClick="logVariable('variablestoskip')" href="../_variables/variablestoskip.html">$variablestoskip</a> = 0;
<a name="l8294"><span class="linenum">8294</span></a>      } else {
<a name="l8295"><span class="linenum">8295</span></a>          <a class="var it13222" onMouseOver="hilite(13222)" onMouseOut="lolite()" onClick="logVariable('variablestoskip')" href="../_variables/variablestoskip.html">$variablestoskip</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('getremoteaddrconf')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/getremoteaddrconf.html">getremoteaddrconf</a>;
<a name="l8296"><span class="linenum">8296</span></a>      }
<a name="l8297"><span class="linenum">8297</span></a>      if (!(<a class="var it13222" onMouseOver="hilite(13222)" onMouseOut="lolite()" onClick="logVariable('variablestoskip')" href="../_variables/variablestoskip.html">$variablestoskip</a> &amp; <a class="constant" onClick="logConstant('GETREMOTEADDR_SKIP_HTTP_CLIENT_IP')" href="../_constants/GETREMOTEADDR_SKIP_HTTP_CLIENT_IP.html" onMouseOver="constPopup(event,'GETREMOTEADDR_SKIP_HTTP_CLIENT_IP')">GETREMOTEADDR_SKIP_HTTP_CLIENT_IP</a>)) {
<a name="l8298"><span class="linenum">8298</span></a>          if (!empty(<a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['HTTP_CLIENT_IP'])) {
<a name="l8299"><span class="linenum">8299</span></a>              <a class="var it3308" onMouseOver="hilite(3308)" onMouseOut="lolite()" onClick="logVariable('address')" href="../_variables/address.html">$address</a> = <a class="function" onClick="logFunction('cleanremoteaddr')" href="../_functions/cleanremoteaddr.html" onMouseOver="funcPopup(event,'cleanremoteaddr')">cleanremoteaddr</a>(<a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['HTTP_CLIENT_IP']);
<a name="l8300"><span class="linenum">8300</span></a>              return <a class="var it3308" onMouseOver="hilite(3308)" onMouseOut="lolite()" onClick="logVariable('address')" href="../_variables/address.html">$address</a> ? <a class="var it3308" onMouseOver="hilite(3308)" onMouseOut="lolite()" onClick="logVariable('address')" href="../_variables/address.html">$address</a> : <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>;
<a name="l8301"><span class="linenum">8301</span></a>          }
<a name="l8302"><span class="linenum">8302</span></a>      }
<a name="l8303"><span class="linenum">8303</span></a>      if (!(<a class="var it13222" onMouseOver="hilite(13222)" onMouseOut="lolite()" onClick="logVariable('variablestoskip')" href="../_variables/variablestoskip.html">$variablestoskip</a> &amp; <a class="constant" onClick="logConstant('GETREMOTEADDR_SKIP_HTTP_X_FORWARDED_FOR')" href="../_constants/GETREMOTEADDR_SKIP_HTTP_X_FORWARDED_FOR.html" onMouseOver="constPopup(event,'GETREMOTEADDR_SKIP_HTTP_X_FORWARDED_FOR')">GETREMOTEADDR_SKIP_HTTP_X_FORWARDED_FOR</a>)) {
<a name="l8304"><span class="linenum">8304</span></a>          if (!empty(<a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['HTTP_X_FORWARDED_FOR'])) {
<a name="l8305"><span class="linenum">8305</span></a>              <a class="var it13223" onMouseOver="hilite(13223)" onMouseOut="lolite()" onClick="logVariable('forwardedaddresses')" href="../_variables/forwardedaddresses.html">$forwardedaddresses</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(&quot;,&quot;, <a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['HTTP_X_FORWARDED_FOR']);
<a name="l8306"><span class="linenum">8306</span></a>              <a class="var it3308" onMouseOver="hilite(3308)" onMouseOut="lolite()" onClick="logVariable('address')" href="../_variables/address.html">$address</a> = <a class="var it13223" onMouseOver="hilite(13223)" onMouseOut="lolite()" onClick="logVariable('forwardedaddresses')" href="../_variables/forwardedaddresses.html">$forwardedaddresses</a>[0];
<a name="l8307"><span class="linenum">8307</span></a>  
<a name="l8308"><span class="linenum">8308</span></a>              if (<a class="phpfunction" onClick="logFunction('substr_count')" href="../_functions/substr_count.html" onMouseOver="phpfuncPopup(event,'substr_count')">substr_count</a>(<a class="var it3308" onMouseOver="hilite(3308)" onMouseOut="lolite()" onClick="logVariable('address')" href="../_variables/address.html">$address</a>, &quot;:&quot;) &gt; 1) {
<a name="l8309"><span class="linenum">8309</span></a>  <span class="comment">                // Remove port and brackets from IPv6.</span>
<a name="l8310"><span class="linenum">8310</span></a>                  if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>(&quot;/\[(.*)\]:/&quot;, <a class="var it3308" onMouseOver="hilite(3308)" onMouseOut="lolite()" onClick="logVariable('address')" href="../_variables/address.html">$address</a>, <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>)) {
<a name="l8311"><span class="linenum">8311</span></a>                      <a class="var it3308" onMouseOver="hilite(3308)" onMouseOut="lolite()" onClick="logVariable('address')" href="../_variables/address.html">$address</a> = <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>[1];
<a name="l8312"><span class="linenum">8312</span></a>                  }
<a name="l8313"><span class="linenum">8313</span></a>              } else {
<a name="l8314"><span class="linenum">8314</span></a>  <span class="comment">                // Remove port from IPv4.</span>
<a name="l8315"><span class="linenum">8315</span></a>                  if (<a class="phpfunction" onClick="logFunction('substr_count')" href="../_functions/substr_count.html" onMouseOver="phpfuncPopup(event,'substr_count')">substr_count</a>(<a class="var it3308" onMouseOver="hilite(3308)" onMouseOut="lolite()" onClick="logVariable('address')" href="../_variables/address.html">$address</a>, &quot;:&quot;) == 1) {
<a name="l8316"><span class="linenum">8316</span></a>                      <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(&quot;:&quot;, <a class="var it3308" onMouseOver="hilite(3308)" onMouseOut="lolite()" onClick="logVariable('address')" href="../_variables/address.html">$address</a>);
<a name="l8317"><span class="linenum">8317</span></a>                      <a class="var it3308" onMouseOver="hilite(3308)" onMouseOut="lolite()" onClick="logVariable('address')" href="../_variables/address.html">$address</a> = <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>[0];
<a name="l8318"><span class="linenum">8318</span></a>                  }
<a name="l8319"><span class="linenum">8319</span></a>              }
<a name="l8320"><span class="linenum">8320</span></a>  
<a name="l8321"><span class="linenum">8321</span></a>              <a class="var it3308" onMouseOver="hilite(3308)" onMouseOut="lolite()" onClick="logVariable('address')" href="../_variables/address.html">$address</a> = <a class="function" onClick="logFunction('cleanremoteaddr')" href="../_functions/cleanremoteaddr.html" onMouseOver="funcPopup(event,'cleanremoteaddr')">cleanremoteaddr</a>(<a class="var it3308" onMouseOver="hilite(3308)" onMouseOut="lolite()" onClick="logVariable('address')" href="../_variables/address.html">$address</a>);
<a name="l8322"><span class="linenum">8322</span></a>              return <a class="var it3308" onMouseOver="hilite(3308)" onMouseOut="lolite()" onClick="logVariable('address')" href="../_variables/address.html">$address</a> ? <a class="var it3308" onMouseOver="hilite(3308)" onMouseOut="lolite()" onClick="logVariable('address')" href="../_variables/address.html">$address</a> : <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>;
<a name="l8323"><span class="linenum">8323</span></a>          }
<a name="l8324"><span class="linenum">8324</span></a>      }
<a name="l8325"><span class="linenum">8325</span></a>      if (!empty(<a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['REMOTE_ADDR'])) {
<a name="l8326"><span class="linenum">8326</span></a>          <a class="var it3308" onMouseOver="hilite(3308)" onMouseOut="lolite()" onClick="logVariable('address')" href="../_variables/address.html">$address</a> = <a class="function" onClick="logFunction('cleanremoteaddr')" href="../_functions/cleanremoteaddr.html" onMouseOver="funcPopup(event,'cleanremoteaddr')">cleanremoteaddr</a>(<a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['REMOTE_ADDR']);
<a name="l8327"><span class="linenum">8327</span></a>          return <a class="var it3308" onMouseOver="hilite(3308)" onMouseOut="lolite()" onClick="logVariable('address')" href="../_variables/address.html">$address</a> ? <a class="var it3308" onMouseOver="hilite(3308)" onMouseOut="lolite()" onClick="logVariable('address')" href="../_variables/address.html">$address</a> : <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>;
<a name="l8328"><span class="linenum">8328</span></a>      } else {
<a name="l8329"><span class="linenum">8329</span></a>          return <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>;
<a name="l8330"><span class="linenum">8330</span></a>      }
<a name="l8331"><span class="linenum">8331</span></a>  }
<a name="l8332"><span class="linenum">8332</span></a>  
<a name="l8333"><span class="linenum">8333</span></a>  <span class="comment">/**</span>
<a name="l8334"><span class="linenum">8334</span></a>  <span class="comment"> * Cleans an ip address. Internal addresses are now allowed.</span>
<a name="l8335"><span class="linenum">8335</span></a>  <span class="comment"> * (Originally local addresses were not allowed.)</span>
<a name="l8336"><span class="linenum">8336</span></a>  <span class="comment"> *</span>
<a name="l8337"><span class="linenum">8337</span></a>  <span class="comment"> * @param string $addr IPv4 or IPv6 address</span>
<a name="l8338"><span class="linenum">8338</span></a>  <span class="comment"> * @param bool $compress use IPv6 address compression</span>
<a name="l8339"><span class="linenum">8339</span></a>  <span class="comment"> * @return string normalised ip address string, null if error</span>
<a name="l8340"><span class="linenum">8340</span></a>  <span class="comment"> */</span>
<a name="l8341"><span class="linenum">8341</span></a>  function <a class="function" onClick="logFunction('cleanremoteaddr')" href="../_functions/cleanremoteaddr.html" onMouseOver="funcPopup(event,'cleanremoteaddr')">cleanremoteaddr</a>(<a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>, <a class="var it9655" onMouseOver="hilite(9655)" onMouseOut="lolite()" onClick="logVariable('compress')" href="../_variables/compress.html">$compress</a>=false) {
<a name="l8342"><span class="linenum">8342</span></a>      <a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>);
<a name="l8343"><span class="linenum">8343</span></a>  
<a name="l8344"><span class="linenum">8344</span></a>  <span class="comment">    // TODO: maybe add a separate function is_addr_public() or something like this.</span>
<a name="l8345"><span class="linenum">8345</span></a>  
<a name="l8346"><span class="linenum">8346</span></a>      if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>, ':') !== false) {
<a name="l8347"><span class="linenum">8347</span></a>  <span class="comment">        // Can be only IPv6.</span>
<a name="l8348"><span class="linenum">8348</span></a>          <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(':', <a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>);
<a name="l8349"><span class="linenum">8349</span></a>          <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a> = <a class="phpfunction" onClick="logFunction('count')" href="../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>);
<a name="l8350"><span class="linenum">8350</span></a>  
<a name="l8351"><span class="linenum">8351</span></a>          if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>[<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a>-1], '.') !== false) {
<a name="l8352"><span class="linenum">8352</span></a>  <span class="comment">            // Legacy ipv4 notation.</span>
<a name="l8353"><span class="linenum">8353</span></a>              <a class="var it893" onMouseOver="hilite(893)" onMouseOut="lolite()" onClick="logVariable('last')" href="../_variables/last.html">$last</a> = <a class="phpfunction" onClick="logFunction('array_pop')" href="../_functions/array_pop.html" onMouseOver="phpfuncPopup(event,'array_pop')">array_pop</a>(<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>);
<a name="l8354"><span class="linenum">8354</span></a>              <a class="var it3975" onMouseOver="hilite(3975)" onMouseOut="lolite()" onClick="logVariable('ipv4')" href="../_variables/ipv4.html">$ipv4</a> = <a class="function" onClick="logFunction('cleanremoteaddr')" href="../_functions/cleanremoteaddr.html" onMouseOver="funcPopup(event,'cleanremoteaddr')">cleanremoteaddr</a>(<a class="var it893" onMouseOver="hilite(893)" onMouseOut="lolite()" onClick="logVariable('last')" href="../_variables/last.html">$last</a>, true);
<a name="l8355"><span class="linenum">8355</span></a>              if (<a class="var it3975" onMouseOver="hilite(3975)" onMouseOut="lolite()" onClick="logVariable('ipv4')" href="../_variables/ipv4.html">$ipv4</a> === null) {
<a name="l8356"><span class="linenum">8356</span></a>                  return null;
<a name="l8357"><span class="linenum">8357</span></a>              }
<a name="l8358"><span class="linenum">8358</span></a>              <a class="var it4737" onMouseOver="hilite(4737)" onMouseOut="lolite()" onClick="logVariable('bits')" href="../_variables/bits.html">$bits</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>('.', <a class="var it3975" onMouseOver="hilite(3975)" onMouseOut="lolite()" onClick="logVariable('ipv4')" href="../_variables/ipv4.html">$ipv4</a>);
<a name="l8359"><span class="linenum">8359</span></a>              <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>[] = <a class="phpfunction" onClick="logFunction('dechex')" href="../_functions/dechex.html" onMouseOver="phpfuncPopup(event,'dechex')">dechex</a>(<a class="var it4737" onMouseOver="hilite(4737)" onMouseOut="lolite()" onClick="logVariable('bits')" href="../_variables/bits.html">$bits</a>[0]).<a class="phpfunction" onClick="logFunction('dechex')" href="../_functions/dechex.html" onMouseOver="phpfuncPopup(event,'dechex')">dechex</a>(<a class="var it4737" onMouseOver="hilite(4737)" onMouseOut="lolite()" onClick="logVariable('bits')" href="../_variables/bits.html">$bits</a>[1]);
<a name="l8360"><span class="linenum">8360</span></a>              <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>[] = <a class="phpfunction" onClick="logFunction('dechex')" href="../_functions/dechex.html" onMouseOver="phpfuncPopup(event,'dechex')">dechex</a>(<a class="var it4737" onMouseOver="hilite(4737)" onMouseOut="lolite()" onClick="logVariable('bits')" href="../_variables/bits.html">$bits</a>[2]).<a class="phpfunction" onClick="logFunction('dechex')" href="../_functions/dechex.html" onMouseOver="phpfuncPopup(event,'dechex')">dechex</a>(<a class="var it4737" onMouseOver="hilite(4737)" onMouseOut="lolite()" onClick="logVariable('bits')" href="../_variables/bits.html">$bits</a>[3]);
<a name="l8361"><span class="linenum">8361</span></a>              <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a> = <a class="phpfunction" onClick="logFunction('count')" href="../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>);
<a name="l8362"><span class="linenum">8362</span></a>              <a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(':', <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>);
<a name="l8363"><span class="linenum">8363</span></a>          }
<a name="l8364"><span class="linenum">8364</span></a>  
<a name="l8365"><span class="linenum">8365</span></a>          if (<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a> &lt; 3 or <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a> &gt; 8) {
<a name="l8366"><span class="linenum">8366</span></a>              return null; <span class="comment">// Severly malformed.</span>
<a name="l8367"><span class="linenum">8367</span></a>          }
<a name="l8368"><span class="linenum">8368</span></a>  
<a name="l8369"><span class="linenum">8369</span></a>          if (<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a> != 8) {
<a name="l8370"><span class="linenum">8370</span></a>              if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>, '::') === false) {
<a name="l8371"><span class="linenum">8371</span></a>                  return null; <span class="comment">// Malformed.</span>
<a name="l8372"><span class="linenum">8372</span></a>              }
<a name="l8373"><span class="linenum">8373</span></a>  <span class="comment">            // Uncompress.</span>
<a name="l8374"><span class="linenum">8374</span></a>              <a class="var it13224" onMouseOver="hilite(13224)" onMouseOut="lolite()" onClick="logVariable('insertat')" href="../_variables/insertat.html">$insertat</a> = <a class="phpfunction" onClick="logFunction('array_search')" href="../_functions/array_search.html" onMouseOver="phpfuncPopup(event,'array_search')">array_search</a>('', <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>, true);
<a name="l8375"><span class="linenum">8375</span></a>              <a class="var it10027" onMouseOver="hilite(10027)" onMouseOut="lolite()" onClick="logVariable('missing')" href="../_variables/missing.html">$missing</a> = <a class="phpfunction" onClick="logFunction('array_fill')" href="../_functions/array_fill.html" onMouseOver="phpfuncPopup(event,'array_fill')">array_fill</a>(0, 1 + 8 - <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a>, '0');
<a name="l8376"><span class="linenum">8376</span></a>              <a class="phpfunction" onClick="logFunction('array_splice')" href="../_functions/array_splice.html" onMouseOver="phpfuncPopup(event,'array_splice')">array_splice</a>(<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>, <a class="var it13224" onMouseOver="hilite(13224)" onMouseOut="lolite()" onClick="logVariable('insertat')" href="../_variables/insertat.html">$insertat</a>, 1, <a class="var it10027" onMouseOver="hilite(10027)" onMouseOut="lolite()" onClick="logVariable('missing')" href="../_variables/missing.html">$missing</a>);
<a name="l8377"><span class="linenum">8377</span></a>              foreach (<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('part')" href="../_variables/part.html">$part</a>) {
<a name="l8378"><span class="linenum">8378</span></a>                  if (<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('part')" href="../_variables/part.html">$part</a> === '') {
<a name="l8379"><span class="linenum">8379</span></a>                      <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = '0';
<a name="l8380"><span class="linenum">8380</span></a>                  }
<a name="l8381"><span class="linenum">8381</span></a>              }
<a name="l8382"><span class="linenum">8382</span></a>          }
<a name="l8383"><span class="linenum">8383</span></a>  
<a name="l8384"><span class="linenum">8384</span></a>          <a class="var it10691" onMouseOver="hilite(10691)" onMouseOut="lolite()" onClick="logVariable('adr')" href="../_variables/adr.html">$adr</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(':', <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>);
<a name="l8385"><span class="linenum">8385</span></a>          if (!<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^([0-9a-f]{1,4})(:[0-9a-f]{1,4})*$/i', <a class="var it10691" onMouseOver="hilite(10691)" onMouseOut="lolite()" onClick="logVariable('adr')" href="../_variables/adr.html">$adr</a>)) {
<a name="l8386"><span class="linenum">8386</span></a>              return null; <span class="comment">// Incorrect format - sorry.</span>
<a name="l8387"><span class="linenum">8387</span></a>          }
<a name="l8388"><span class="linenum">8388</span></a>  
<a name="l8389"><span class="linenum">8389</span></a>  <span class="comment">        // Normalise 0s and case.</span>
<a name="l8390"><span class="linenum">8390</span></a>          <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a> = <a class="phpfunction" onClick="logFunction('array_map')" href="../_functions/array_map.html" onMouseOver="phpfuncPopup(event,'array_map')">array_map</a>('hexdec', <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>);
<a name="l8391"><span class="linenum">8391</span></a>          <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a> = <a class="phpfunction" onClick="logFunction('array_map')" href="../_functions/array_map.html" onMouseOver="phpfuncPopup(event,'array_map')">array_map</a>('dechex', <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>);
<a name="l8392"><span class="linenum">8392</span></a>  
<a name="l8393"><span class="linenum">8393</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(':', <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>);
<a name="l8394"><span class="linenum">8394</span></a>  
<a name="l8395"><span class="linenum">8395</span></a>          if (!<a class="var it9655" onMouseOver="hilite(9655)" onMouseOut="lolite()" onClick="logVariable('compress')" href="../_variables/compress.html">$compress</a>) {
<a name="l8396"><span class="linenum">8396</span></a>              return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>;
<a name="l8397"><span class="linenum">8397</span></a>          }
<a name="l8398"><span class="linenum">8398</span></a>  
<a name="l8399"><span class="linenum">8399</span></a>          if (<a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> === '0:0:0:0:0:0:0:0') {
<a name="l8400"><span class="linenum">8400</span></a>              return '::'; <span class="comment">// All addresses.</span>
<a name="l8401"><span class="linenum">8401</span></a>          }
<a name="l8402"><span class="linenum">8402</span></a>  
<a name="l8403"><span class="linenum">8403</span></a>          <a class="var it13225" onMouseOver="hilite(13225)" onMouseOut="lolite()" onClick="logVariable('compressed')" href="../_variables/compressed.html">$compressed</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/(:0)+:0$/', '::', <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>, 1);
<a name="l8404"><span class="linenum">8404</span></a>          if (<a class="var it13225" onMouseOver="hilite(13225)" onMouseOut="lolite()" onClick="logVariable('compressed')" href="../_variables/compressed.html">$compressed</a> !== <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>) {
<a name="l8405"><span class="linenum">8405</span></a>              return <a class="var it13225" onMouseOver="hilite(13225)" onMouseOut="lolite()" onClick="logVariable('compressed')" href="../_variables/compressed.html">$compressed</a>;
<a name="l8406"><span class="linenum">8406</span></a>          }
<a name="l8407"><span class="linenum">8407</span></a>  
<a name="l8408"><span class="linenum">8408</span></a>          <a class="var it13225" onMouseOver="hilite(13225)" onMouseOut="lolite()" onClick="logVariable('compressed')" href="../_variables/compressed.html">$compressed</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/^(0:){2,7}/', '::', <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>, 1);
<a name="l8409"><span class="linenum">8409</span></a>          if (<a class="var it13225" onMouseOver="hilite(13225)" onMouseOut="lolite()" onClick="logVariable('compressed')" href="../_variables/compressed.html">$compressed</a> !== <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>) {
<a name="l8410"><span class="linenum">8410</span></a>              return <a class="var it13225" onMouseOver="hilite(13225)" onMouseOut="lolite()" onClick="logVariable('compressed')" href="../_variables/compressed.html">$compressed</a>;
<a name="l8411"><span class="linenum">8411</span></a>          }
<a name="l8412"><span class="linenum">8412</span></a>  
<a name="l8413"><span class="linenum">8413</span></a>          <a class="var it13225" onMouseOver="hilite(13225)" onMouseOut="lolite()" onClick="logVariable('compressed')" href="../_variables/compressed.html">$compressed</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/(:0){2,6}:/', '::', <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>, 1);
<a name="l8414"><span class="linenum">8414</span></a>          if (<a class="var it13225" onMouseOver="hilite(13225)" onMouseOut="lolite()" onClick="logVariable('compressed')" href="../_variables/compressed.html">$compressed</a> !== <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>) {
<a name="l8415"><span class="linenum">8415</span></a>              return <a class="var it13225" onMouseOver="hilite(13225)" onMouseOut="lolite()" onClick="logVariable('compressed')" href="../_variables/compressed.html">$compressed</a>;
<a name="l8416"><span class="linenum">8416</span></a>          }
<a name="l8417"><span class="linenum">8417</span></a>  
<a name="l8418"><span class="linenum">8418</span></a>          return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>;
<a name="l8419"><span class="linenum">8419</span></a>      }
<a name="l8420"><span class="linenum">8420</span></a>  
<a name="l8421"><span class="linenum">8421</span></a>  <span class="comment">    // First get all things that look like IPv4 addresses.</span>
<a name="l8422"><span class="linenum">8422</span></a>      <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a> = array();
<a name="l8423"><span class="linenum">8423</span></a>      if (!<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/', <a class="var it13204" onMouseOver="hilite(13204)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../_variables/addr.html">$addr</a>, <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>)) {
<a name="l8424"><span class="linenum">8424</span></a>          return null;
<a name="l8425"><span class="linenum">8425</span></a>      }
<a name="l8426"><span class="linenum">8426</span></a>      unset(<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>[0]);
<a name="l8427"><span class="linenum">8427</span></a>  
<a name="l8428"><span class="linenum">8428</span></a>      foreach (<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a>) {
<a name="l8429"><span class="linenum">8429</span></a>          if (<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a> &gt; 255) {
<a name="l8430"><span class="linenum">8430</span></a>              return null;
<a name="l8431"><span class="linenum">8431</span></a>          }
<a name="l8432"><span class="linenum">8432</span></a>          <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = (int)<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a>; <span class="comment">// Normalise 0s.</span>
<a name="l8433"><span class="linenum">8433</span></a>      }
<a name="l8434"><span class="linenum">8434</span></a>  
<a name="l8435"><span class="linenum">8435</span></a>      return <a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>('.', <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>);
<a name="l8436"><span class="linenum">8436</span></a>  }
<a name="l8437"><span class="linenum">8437</span></a>  
<a name="l8438"><span class="linenum">8438</span></a>  <span class="comment">/**</span>
<a name="l8439"><span class="linenum">8439</span></a>  <span class="comment"> * This function will make a complete copy of anything it's given,</span>
<a name="l8440"><span class="linenum">8440</span></a>  <span class="comment"> * regardless of whether it's an object or not.</span>
<a name="l8441"><span class="linenum">8441</span></a>  <span class="comment"> *</span>
<a name="l8442"><span class="linenum">8442</span></a>  <span class="comment"> * @param mixed $thing Something you want cloned</span>
<a name="l8443"><span class="linenum">8443</span></a>  <span class="comment"> * @return mixed What ever it is you passed it</span>
<a name="l8444"><span class="linenum">8444</span></a>  <span class="comment"> */</span>
<a name="l8445"><span class="linenum">8445</span></a>  function <a class="function" onClick="logFunction('fullclone')" href="../_functions/fullclone.html" onMouseOver="funcPopup(event,'fullclone')">fullclone</a>(<a class="var it13226" onMouseOver="hilite(13226)" onMouseOut="lolite()" onClick="logVariable('thing')" href="../_variables/thing.html">$thing</a>) {
<a name="l8446"><span class="linenum">8446</span></a>      return <a class="phpfunction" onClick="logFunction('unserialize')" href="../_functions/unserialize.html" onMouseOver="phpfuncPopup(event,'unserialize')">unserialize</a>(<a class="phpfunction" onClick="logFunction('serialize')" href="../_functions/serialize.html" onMouseOver="phpfuncPopup(event,'serialize')">serialize</a>(<a class="var it13226" onMouseOver="hilite(13226)" onMouseOut="lolite()" onClick="logVariable('thing')" href="../_variables/thing.html">$thing</a>));
<a name="l8447"><span class="linenum">8447</span></a>  }
<a name="l8448"><span class="linenum">8448</span></a>  
<a name="l8449"><span class="linenum">8449</span></a>   <span class="comment">/**</span>
<a name="l8450"><span class="linenum">8450</span></a>  <span class="comment">  * If new messages are waiting for the current user, then insert</span>
<a name="l8451"><span class="linenum">8451</span></a>  <span class="comment">  * JavaScript to pop up the messaging window into the page</span>
<a name="l8452"><span class="linenum">8452</span></a>  <span class="comment">  *</span>
<a name="l8453"><span class="linenum">8453</span></a>  <span class="comment">  * @return void</span>
<a name="l8454"><span class="linenum">8454</span></a>  <span class="comment">  */</span>
<a name="l8455"><span class="linenum">8455</span></a>  function <a class="function" onClick="logFunction('message_popup_window')" href="../_functions/message_popup_window.html" onMouseOver="funcPopup(event,'message_popup_window')">message_popup_window</a>() {
<a name="l8456"><span class="linenum">8456</span></a>      global <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>, <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l8457"><span class="linenum">8457</span></a>  
<a name="l8458"><span class="linenum">8458</span></a>      if (!<a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('get_popup_notification_allowed')" href="../_functions/get_popup_notification_allowed.html" onMouseOver="funcPopup(event,'get_popup_notification_allowed')">get_popup_notification_allowed</a>() || empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('messaging')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/messaging.html">messaging</a>)) {
<a name="l8459"><span class="linenum">8459</span></a>          return;
<a name="l8460"><span class="linenum">8460</span></a>      }
<a name="l8461"><span class="linenum">8461</span></a>  
<a name="l8462"><span class="linenum">8462</span></a>      if (!<a class="function" onClick="logFunction('isloggedin')" href="../_functions/isloggedin.html" onMouseOver="funcPopup(event,'isloggedin')">isloggedin</a>() || <a class="function" onClick="logFunction('isguestuser')" href="../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>()) {
<a name="l8463"><span class="linenum">8463</span></a>          return;
<a name="l8464"><span class="linenum">8464</span></a>      }
<a name="l8465"><span class="linenum">8465</span></a>  
<a name="l8466"><span class="linenum">8466</span></a>      if (!isset(<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('message_lastpopup')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/message_lastpopup.html">message_lastpopup</a>)) {
<a name="l8467"><span class="linenum">8467</span></a>          <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('message_lastpopup')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/message_lastpopup.html">message_lastpopup</a> = 0;
<a name="l8468"><span class="linenum">8468</span></a>      } else if (<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('message_lastpopup')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/message_lastpopup.html">message_lastpopup</a> &gt; (<a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>()-120)) {
<a name="l8469"><span class="linenum">8469</span></a>  <span class="comment">        // Don't run the query to check whether to display a popup if its been run in the last 2 minutes.</span>
<a name="l8470"><span class="linenum">8470</span></a>          return;
<a name="l8471"><span class="linenum">8471</span></a>      }
<a name="l8472"><span class="linenum">8472</span></a>  
<a name="l8473"><span class="linenum">8473</span></a>  <span class="comment">    // A quick query to check whether the user has new messages.</span>
<a name="l8474"><span class="linenum">8474</span></a>      <a class="var it13228" onMouseOver="hilite(13228)" onMouseOut="lolite()" onClick="logVariable('messagecount')" href="../_variables/messagecount.html">$messagecount</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records')" href="../_functions/count_records.html" onMouseOver="funcPopup(event,'count_records')">count_records</a>('message', array('useridto' =&gt; <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l8475"><span class="linenum">8475</span></a>      if (<a class="var it13228" onMouseOver="hilite(13228)" onMouseOut="lolite()" onClick="logVariable('messagecount')" href="../_variables/messagecount.html">$messagecount</a> &lt; 1) {
<a name="l8476"><span class="linenum">8476</span></a>          return;
<a name="l8477"><span class="linenum">8477</span></a>      }
<a name="l8478"><span class="linenum">8478</span></a>  
<a name="l8479"><span class="linenum">8479</span></a>  <span class="comment">    // There are unread messages so now do a more complex but slower query.</span>
<a name="l8480"><span class="linenum">8480</span></a>      <a class="var it13229" onMouseOver="hilite(13229)" onMouseOut="lolite()" onClick="logVariable('messagesql')" href="../_variables/messagesql.html">$messagesql</a> = &quot;SELECT m.id, c.blocked
<a name="l8481"><span class="linenum">8481</span></a>                       FROM {message} m
<a name="l8482"><span class="linenum">8482</span></a>                       JOIN {message_working} mw ON m.id=mw.unreadmessageid
<a name="l8483"><span class="linenum">8483</span></a>                       JOIN {message_processors} p ON mw.processorid=p.id
<a name="l8484"><span class="linenum">8484</span></a>                       JOIN {user} u ON m.useridfrom=u.id
<a name="l8485"><span class="linenum">8485</span></a>                       LEFT JOIN {message_contacts} c ON c.contactid = m.useridfrom
<a name="l8486"><span class="linenum">8486</span></a>                                                     AND c.userid = m.useridto
<a name="l8487"><span class="linenum">8487</span></a>                      WHERE m.useridto = :userid
<a name="l8488"><span class="linenum">8488</span></a>                        AND p.name='popup'&quot;;
<a name="l8489"><span class="linenum">8489</span></a>  
<a name="l8490"><span class="linenum">8490</span></a>  <span class="comment">    // If the user was last notified over an hour ago we can re-notify them of old messages</span>
<a name="l8491"><span class="linenum">8491</span></a>  <span class="comment">    // so don't worry about when the new message was sent.</span>
<a name="l8492"><span class="linenum">8492</span></a>      <a class="var it13230" onMouseOver="hilite(13230)" onMouseOut="lolite()" onClick="logVariable('lastnotifiedlongago')" href="../_variables/lastnotifiedlongago.html">$lastnotifiedlongago</a> = <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('message_lastpopup')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/message_lastpopup.html">message_lastpopup</a> &lt; (<a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>()-3600);
<a name="l8493"><span class="linenum">8493</span></a>      if (!<a class="var it13230" onMouseOver="hilite(13230)" onMouseOut="lolite()" onClick="logVariable('lastnotifiedlongago')" href="../_variables/lastnotifiedlongago.html">$lastnotifiedlongago</a>) {
<a name="l8494"><span class="linenum">8494</span></a>          <a class="var it13229" onMouseOver="hilite(13229)" onMouseOut="lolite()" onClick="logVariable('messagesql')" href="../_variables/messagesql.html">$messagesql</a> .= 'AND m.timecreated &gt; :lastpopuptime';
<a name="l8495"><span class="linenum">8495</span></a>      }
<a name="l8496"><span class="linenum">8496</span></a>  
<a name="l8497"><span class="linenum">8497</span></a>      <a class="var it13231" onMouseOver="hilite(13231)" onMouseOut="lolite()" onClick="logVariable('waitingmessages')" href="../_variables/waitingmessages.html">$waitingmessages</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it13229" onMouseOver="hilite(13229)" onMouseOut="lolite()" onClick="logVariable('messagesql')" href="../_variables/messagesql.html">$messagesql</a>, array('userid' =&gt; <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, 'lastpopuptime' =&gt; <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('message_lastpopup')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/message_lastpopup.html">message_lastpopup</a>));
<a name="l8498"><span class="linenum">8498</span></a>  
<a name="l8499"><span class="linenum">8499</span></a>      <a class="var it13232" onMouseOver="hilite(13232)" onMouseOut="lolite()" onClick="logVariable('validmessages')" href="../_variables/validmessages.html">$validmessages</a> = 0;
<a name="l8500"><span class="linenum">8500</span></a>      foreach (<a class="var it13231" onMouseOver="hilite(13231)" onMouseOut="lolite()" onClick="logVariable('waitingmessages')" href="../_variables/waitingmessages.html">$waitingmessages</a> as <a class="var it13233" onMouseOver="hilite(13233)" onMouseOut="lolite()" onClick="logVariable('messageinfo')" href="../_variables/messageinfo.html">$messageinfo</a>) {
<a name="l8501"><span class="linenum">8501</span></a>          if (<a class="var it13233" onMouseOver="hilite(13233)" onMouseOut="lolite()" onClick="logVariable('messageinfo')" href="../_variables/messageinfo.html">$messageinfo</a>-&gt;<a onClick="logVariable('blocked')" class="var it41079" onMouseOver="hilite(41079)" onMouseOut="lolite()" href="../_variables/blocked.html">blocked</a>) {
<a name="l8502"><span class="linenum">8502</span></a>  <span class="comment">            // Message is from a user who has since been blocked so just mark it read.</span>
<a name="l8503"><span class="linenum">8503</span></a>  <span class="comment">            // Get the full message to mark as read.</span>
<a name="l8504"><span class="linenum">8504</span></a>              <a class="var it13234" onMouseOver="hilite(13234)" onMouseOut="lolite()" onClick="logVariable('messageobject')" href="../_variables/messageobject.html">$messageobject</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('message', array('id' =&gt; <a class="var it13233" onMouseOver="hilite(13233)" onMouseOut="lolite()" onClick="logVariable('messageinfo')" href="../_variables/messageinfo.html">$messageinfo</a>-&gt;<a onClick="logVariable('id')" class="var it41079" onMouseOver="hilite(41079)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l8505"><span class="linenum">8505</span></a>              <a class="function" onClick="logFunction('message_mark_message_read')" href="../_functions/message_mark_message_read.html" onMouseOver="funcPopup(event,'message_mark_message_read')">message_mark_message_read</a>(<a class="var it13234" onMouseOver="hilite(13234)" onMouseOut="lolite()" onClick="logVariable('messageobject')" href="../_variables/messageobject.html">$messageobject</a>, <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>());
<a name="l8506"><span class="linenum">8506</span></a>          } else {
<a name="l8507"><span class="linenum">8507</span></a>              <a class="var it13232" onMouseOver="hilite(13232)" onMouseOut="lolite()" onClick="logVariable('validmessages')" href="../_variables/validmessages.html">$validmessages</a>++;
<a name="l8508"><span class="linenum">8508</span></a>          }
<a name="l8509"><span class="linenum">8509</span></a>      }
<a name="l8510"><span class="linenum">8510</span></a>  
<a name="l8511"><span class="linenum">8511</span></a>      if (<a class="var it13232" onMouseOver="hilite(13232)" onMouseOut="lolite()" onClick="logVariable('validmessages')" href="../_variables/validmessages.html">$validmessages</a> &gt; 0) {
<a name="l8512"><span class="linenum">8512</span></a>          <a class="var it1519" onMouseOver="hilite(1519)" onMouseOut="lolite()" onClick="logVariable('strmessages')" href="../_variables/strmessages.html">$strmessages</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('unreadnewmessages', 'message', <a class="var it13232" onMouseOver="hilite(13232)" onMouseOut="lolite()" onClick="logVariable('validmessages')" href="../_variables/validmessages.html">$validmessages</a>);
<a name="l8513"><span class="linenum">8513</span></a>          <a class="var it13235" onMouseOver="hilite(13235)" onMouseOut="lolite()" onClick="logVariable('strgomessage')" href="../_variables/strgomessage.html">$strgomessage</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('gotomessages', 'message');
<a name="l8514"><span class="linenum">8514</span></a>          <a class="var it13236" onMouseOver="hilite(13236)" onMouseOut="lolite()" onClick="logVariable('strstaymessage')" href="../_variables/strstaymessage.html">$strstaymessage</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('ignore', 'admin');
<a name="l8515"><span class="linenum">8515</span></a>  
<a name="l8516"><span class="linenum">8516</span></a>          <a class="var it13237" onMouseOver="hilite(13237)" onMouseOut="lolite()" onClick="logVariable('notificationsound')" href="../_variables/notificationsound.html">$notificationsound</a> = null;
<a name="l8517"><span class="linenum">8517</span></a>          <a class="var it13238" onMouseOver="hilite(13238)" onMouseOut="lolite()" onClick="logVariable('beep')" href="../_variables/beep.html">$beep</a> = <a class="function" onClick="logFunction('get_user_preferences')" href="../_functions/get_user_preferences.html" onMouseOver="funcPopup(event,'get_user_preferences')">get_user_preferences</a>('message_beepnewmessage', '');
<a name="l8518"><span class="linenum">8518</span></a>          if (!empty(<a class="var it13238" onMouseOver="hilite(13238)" onMouseOut="lolite()" onClick="logVariable('beep')" href="../_variables/beep.html">$beep</a>)) {
<a name="l8519"><span class="linenum">8519</span></a>  <span class="comment">            // Browsers will work down this list until they find something they support.</span>
<a name="l8520"><span class="linenum">8520</span></a>              <a class="var it13239" onMouseOver="hilite(13239)" onMouseOut="lolite()" onClick="logVariable('sourcetags')" href="../_variables/sourcetags.html">$sourcetags</a> =  <a class="class" onClick="logClass('html_writer')" href="../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('empty_tag')" href="../_functions/empty_tag.html" onMouseOver="funcPopup(event,'empty_tag')">empty_tag</a>('source', array('src' =&gt; <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>.'/message/bell.wav', 'type' =&gt; 'audio/wav'));
<a name="l8521"><span class="linenum">8521</span></a>              <a class="var it13239" onMouseOver="hilite(13239)" onMouseOut="lolite()" onClick="logVariable('sourcetags')" href="../_variables/sourcetags.html">$sourcetags</a> .= <a class="class" onClick="logClass('html_writer')" href="../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('empty_tag')" href="../_functions/empty_tag.html" onMouseOver="funcPopup(event,'empty_tag')">empty_tag</a>('source', array('src' =&gt; <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>.'/message/bell.ogg', 'type' =&gt; 'audio/ogg'));
<a name="l8522"><span class="linenum">8522</span></a>              <a class="var it13239" onMouseOver="hilite(13239)" onMouseOut="lolite()" onClick="logVariable('sourcetags')" href="../_variables/sourcetags.html">$sourcetags</a> .= <a class="class" onClick="logClass('html_writer')" href="../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('empty_tag')" href="../_functions/empty_tag.html" onMouseOver="funcPopup(event,'empty_tag')">empty_tag</a>('source', array('src' =&gt; <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>.'/message/bell.mp3', 'type' =&gt; 'audio/mpeg'));
<a name="l8523"><span class="linenum">8523</span></a>              <a class="var it13239" onMouseOver="hilite(13239)" onMouseOut="lolite()" onClick="logVariable('sourcetags')" href="../_variables/sourcetags.html">$sourcetags</a> .= <a class="class" onClick="logClass('html_writer')" href="../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('empty_tag')" href="../_functions/empty_tag.html" onMouseOver="funcPopup(event,'empty_tag')">empty_tag</a>('embed',  array('src' =&gt; <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>.'/message/bell.wav', 'autostart' =&gt; 'true', 'hidden' =&gt; 'true'));
<a name="l8524"><span class="linenum">8524</span></a>  
<a name="l8525"><span class="linenum">8525</span></a>              <a class="var it13237" onMouseOver="hilite(13237)" onMouseOut="lolite()" onClick="logVariable('notificationsound')" href="../_variables/notificationsound.html">$notificationsound</a> = <a class="class" onClick="logClass('html_writer')" href="../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('tag')" href="../_functions/tag.html" onMouseOver="funcPopup(event,'tag')">tag</a>('audio', <a class="var it13239" onMouseOver="hilite(13239)" onMouseOut="lolite()" onClick="logVariable('sourcetags')" href="../_variables/sourcetags.html">$sourcetags</a>, array('preload' =&gt; 'auto', 'autoplay' =&gt; 'autoplay'));
<a name="l8526"><span class="linenum">8526</span></a>          }
<a name="l8527"><span class="linenum">8527</span></a>  
<a name="l8528"><span class="linenum">8528</span></a>          <a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('url')" href="../_variables/url.html">$url</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>.'<a class="filename" href="../message/index.php.html">/message/index.php</a>';
<a name="l8529"><span class="linenum">8529</span></a>          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('content')" href="../_variables/content.html">$content</a> =  <a class="class" onClick="logClass('html_writer')" href="../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('start_tag')" href="../_functions/start_tag.html" onMouseOver="funcPopup(event,'start_tag')">start_tag</a>('div', array('id' =&gt; 'newmessageoverlay', 'class' =&gt; 'mdl-align')).
<a name="l8530"><span class="linenum">8530</span></a>                          <a class="class" onClick="logClass('html_writer')" href="../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('start_tag')" href="../_functions/start_tag.html" onMouseOver="funcPopup(event,'start_tag')">start_tag</a>('div', array('id' =&gt; 'newmessagetext')).
<a name="l8531"><span class="linenum">8531</span></a>                              <a class="var it1519" onMouseOver="hilite(1519)" onMouseOut="lolite()" onClick="logVariable('strmessages')" href="../_variables/strmessages.html">$strmessages</a>.
<a name="l8532"><span class="linenum">8532</span></a>                          <a class="class" onClick="logClass('html_writer')" href="../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('end_tag')" href="../_functions/end_tag.html" onMouseOver="funcPopup(event,'end_tag')">end_tag</a>('div').
<a name="l8533"><span class="linenum">8533</span></a>  
<a name="l8534"><span class="linenum">8534</span></a>                          <a class="var it13237" onMouseOver="hilite(13237)" onMouseOut="lolite()" onClick="logVariable('notificationsound')" href="../_variables/notificationsound.html">$notificationsound</a>.
<a name="l8535"><span class="linenum">8535</span></a>                          <a class="class" onClick="logClass('html_writer')" href="../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('start_tag')" href="../_functions/start_tag.html" onMouseOver="funcPopup(event,'start_tag')">start_tag</a>('div', array('id' =&gt; 'newmessagelinks')).
<a name="l8536"><span class="linenum">8536</span></a>                          <a class="class" onClick="logClass('html_writer')" href="../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="phpfunction" onClick="logFunction('link')" href="../_functions/link.html" onMouseOver="phpfuncPopup(event,'link')">link</a>(<a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('url')" href="../_variables/url.html">$url</a>, <a class="var it13235" onMouseOver="hilite(13235)" onMouseOut="lolite()" onClick="logVariable('strgomessage')" href="../_variables/strgomessage.html">$strgomessage</a>, array('id' =&gt; 'notificationyes')).'&amp;nbsp;&amp;nbsp;&amp;nbsp;'.
<a name="l8537"><span class="linenum">8537</span></a>                          <a class="class" onClick="logClass('html_writer')" href="../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="phpfunction" onClick="logFunction('link')" href="../_functions/link.html" onMouseOver="phpfuncPopup(event,'link')">link</a>('', <a class="var it13236" onMouseOver="hilite(13236)" onMouseOut="lolite()" onClick="logVariable('strstaymessage')" href="../_variables/strstaymessage.html">$strstaymessage</a>, array('id' =&gt; 'notificationno')).
<a name="l8538"><span class="linenum">8538</span></a>                          <a class="class" onClick="logClass('html_writer')" href="../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('end_tag')" href="../_functions/end_tag.html" onMouseOver="funcPopup(event,'end_tag')">end_tag</a>('div');
<a name="l8539"><span class="linenum">8539</span></a>                      <a class="class" onClick="logClass('html_writer')" href="../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('end_tag')" href="../_functions/end_tag.html" onMouseOver="funcPopup(event,'end_tag')">end_tag</a>('div');
<a name="l8540"><span class="linenum">8540</span></a>  
<a name="l8541"><span class="linenum">8541</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>-&gt;<a onClick="logVariable('requires')" class="var it39443" onMouseOver="hilite(39443)" onMouseOut="lolite()" href="../_variables/requires.html">requires</a>-&gt;<a class="function" onClick="logFunction('js_init_call')" href="../_functions/js_init_call.html" onMouseOver="funcPopup(event,'js_init_call')">js_init_call</a>('M.core_message.init_notification', array('', <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('content')" href="../_variables/content.html">$content</a>, <a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('url')" href="../_variables/url.html">$url</a>));
<a name="l8542"><span class="linenum">8542</span></a>  
<a name="l8543"><span class="linenum">8543</span></a>          <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('message_lastpopup')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/message_lastpopup.html">message_lastpopup</a> = <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l8544"><span class="linenum">8544</span></a>      }
<a name="l8545"><span class="linenum">8545</span></a>  }
<a name="l8546"><span class="linenum">8546</span></a>  
<a name="l8547"><span class="linenum">8547</span></a>  <span class="comment">/**</span>
<a name="l8548"><span class="linenum">8548</span></a>  <span class="comment"> * Used to make sure that $min &lt;= $value &lt;= $max</span>
<a name="l8549"><span class="linenum">8549</span></a>  <span class="comment"> *</span>
<a name="l8550"><span class="linenum">8550</span></a>  <span class="comment"> * Make sure that value is between min, and max</span>
<a name="l8551"><span class="linenum">8551</span></a>  <span class="comment"> *</span>
<a name="l8552"><span class="linenum">8552</span></a>  <span class="comment"> * @param int $min The minimum value</span>
<a name="l8553"><span class="linenum">8553</span></a>  <span class="comment"> * @param int $value The value to check</span>
<a name="l8554"><span class="linenum">8554</span></a>  <span class="comment"> * @param int $max The maximum value</span>
<a name="l8555"><span class="linenum">8555</span></a>  <span class="comment"> * @return int</span>
<a name="l8556"><span class="linenum">8556</span></a>  <span class="comment"> */</span>
<a name="l8557"><span class="linenum">8557</span></a>  function <a class="function" onClick="logFunction('bounded_number')" href="../_functions/bounded_number.html" onMouseOver="funcPopup(event,'bounded_number')">bounded_number</a>(<a class="var it1329" onMouseOver="hilite(1329)" onMouseOut="lolite()" onClick="logVariable('min')" href="../_variables/min.html">$min</a>, <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>, <a class="var it588" onMouseOver="hilite(588)" onMouseOut="lolite()" onClick="logVariable('max')" href="../_variables/max.html">$max</a>) {
<a name="l8558"><span class="linenum">8558</span></a>      if (<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> &lt; <a class="var it1329" onMouseOver="hilite(1329)" onMouseOut="lolite()" onClick="logVariable('min')" href="../_variables/min.html">$min</a>) {
<a name="l8559"><span class="linenum">8559</span></a>          return <a class="var it1329" onMouseOver="hilite(1329)" onMouseOut="lolite()" onClick="logVariable('min')" href="../_variables/min.html">$min</a>;
<a name="l8560"><span class="linenum">8560</span></a>      }
<a name="l8561"><span class="linenum">8561</span></a>      if (<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> &gt; <a class="var it588" onMouseOver="hilite(588)" onMouseOut="lolite()" onClick="logVariable('max')" href="../_variables/max.html">$max</a>) {
<a name="l8562"><span class="linenum">8562</span></a>          return <a class="var it588" onMouseOver="hilite(588)" onMouseOut="lolite()" onClick="logVariable('max')" href="../_variables/max.html">$max</a>;
<a name="l8563"><span class="linenum">8563</span></a>      }
<a name="l8564"><span class="linenum">8564</span></a>      return <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l8565"><span class="linenum">8565</span></a>  }
<a name="l8566"><span class="linenum">8566</span></a>  
<a name="l8567"><span class="linenum">8567</span></a>  <span class="comment">/**</span>
<a name="l8568"><span class="linenum">8568</span></a>  <span class="comment"> * Check if there is a nested array within the passed array</span>
<a name="l8569"><span class="linenum">8569</span></a>  <span class="comment"> *</span>
<a name="l8570"><span class="linenum">8570</span></a>  <span class="comment"> * @param array $array</span>
<a name="l8571"><span class="linenum">8571</span></a>  <span class="comment"> * @return bool true if there is a nested array false otherwise</span>
<a name="l8572"><span class="linenum">8572</span></a>  <span class="comment"> */</span>
<a name="l8573"><span class="linenum">8573</span></a>  function <a class="function" onClick="logFunction('array_is_nested')" href="../_functions/array_is_nested.html" onMouseOver="funcPopup(event,'array_is_nested')">array_is_nested</a>(<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a>) {
<a name="l8574"><span class="linenum">8574</span></a>      foreach (<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a> as <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) {
<a name="l8575"><span class="linenum">8575</span></a>          if (<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>)) {
<a name="l8576"><span class="linenum">8576</span></a>              return true;
<a name="l8577"><span class="linenum">8577</span></a>          }
<a name="l8578"><span class="linenum">8578</span></a>      }
<a name="l8579"><span class="linenum">8579</span></a>      return false;
<a name="l8580"><span class="linenum">8580</span></a>  }
<a name="l8581"><span class="linenum">8581</span></a>  
<a name="l8582"><span class="linenum">8582</span></a>  <span class="comment">/**</span>
<a name="l8583"><span class="linenum">8583</span></a>  <span class="comment"> * get_performance_info() pairs up with init_performance_info()</span>
<a name="l8584"><span class="linenum">8584</span></a>  <span class="comment"> * loaded in setup.php. Returns an array with 'html' and 'txt'</span>
<a name="l8585"><span class="linenum">8585</span></a>  <span class="comment"> * values ready for use, and each of the individual stats provided</span>
<a name="l8586"><span class="linenum">8586</span></a>  <span class="comment"> * separately as well.</span>
<a name="l8587"><span class="linenum">8587</span></a>  <span class="comment"> *</span>
<a name="l8588"><span class="linenum">8588</span></a>  <span class="comment"> * @return array</span>
<a name="l8589"><span class="linenum">8589</span></a>  <span class="comment"> */</span>
<a name="l8590"><span class="linenum">8590</span></a>  function <a class="function" onClick="logFunction('get_performance_info')" href="../_functions/get_performance_info.html" onMouseOver="funcPopup(event,'get_performance_info')">get_performance_info</a>() {
<a name="l8591"><span class="linenum">8591</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it13240" onMouseOver="hilite(13240)" onMouseOut="lolite()" onClick="logVariable('PERF')" href="../_variables/PERF.html">$PERF</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>, <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>;
<a name="l8592"><span class="linenum">8592</span></a>  
<a name="l8593"><span class="linenum">8593</span></a>      <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a> = array();
<a name="l8594"><span class="linenum">8594</span></a>      <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['html'] = '';         <span class="comment">// Holds userfriendly HTML representation.</span>
<a name="l8595"><span class="linenum">8595</span></a>      <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['txt']  = <a class="function" onClick="logFunction('me')" href="../_functions/me.html" onMouseOver="funcPopup(event,'me')">me</a>() . ' '; <span class="comment">// Holds log-friendly representation.</span>
<a name="l8596"><span class="linenum">8596</span></a>  
<a name="l8597"><span class="linenum">8597</span></a>      <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['realtime'] = <a class="function" onClick="logFunction('microtime_diff')" href="../_functions/microtime_diff.html" onMouseOver="funcPopup(event,'microtime_diff')">microtime_diff</a>(<a class="var it13240" onMouseOver="hilite(13240)" onMouseOut="lolite()" onClick="logVariable('PERF')" href="../_variables/PERF.html">$PERF</a>-&gt;<a onClick="logVariable('starttime')" class="var it39693" onMouseOver="hilite(39693)" onMouseOut="lolite()" href="../_variables/starttime.html">starttime</a>, <a class="phpfunction" onClick="logFunction('microtime')" href="../_functions/microtime.html" onMouseOver="phpfuncPopup(event,'microtime')">microtime</a>());
<a name="l8598"><span class="linenum">8598</span></a>  
<a name="l8599"><span class="linenum">8599</span></a>      <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['html'] .= '&lt;span class=&quot;timeused&quot;&gt;'.<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['realtime'].' secs&lt;/span&gt; ';
<a name="l8600"><span class="linenum">8600</span></a>      <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['txt'] .= 'time: '.<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['realtime'].'s ';
<a name="l8601"><span class="linenum">8601</span></a>  
<a name="l8602"><span class="linenum">8602</span></a>      if (<a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>('memory_get_usage')) {
<a name="l8603"><span class="linenum">8603</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['memory_total'] = <a class="phpfunction" onClick="logFunction('memory_get_usage')" href="../_functions/memory_get_usage.html" onMouseOver="phpfuncPopup(event,'memory_get_usage')">memory_get_usage</a>();
<a name="l8604"><span class="linenum">8604</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['memory_growth'] = <a class="phpfunction" onClick="logFunction('memory_get_usage')" href="../_functions/memory_get_usage.html" onMouseOver="phpfuncPopup(event,'memory_get_usage')">memory_get_usage</a>() - <a class="var it13240" onMouseOver="hilite(13240)" onMouseOut="lolite()" onClick="logVariable('PERF')" href="../_variables/PERF.html">$PERF</a>-&gt;<a onClick="logVariable('startmemory')" class="var it39693" onMouseOver="hilite(39693)" onMouseOut="lolite()" href="../_variables/startmemory.html">startmemory</a>;
<a name="l8605"><span class="linenum">8605</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['html'] .= '&lt;span class=&quot;memoryused&quot;&gt;RAM: '.<a class="function" onClick="logFunction('display_size')" href="../_functions/display_size.html" onMouseOver="funcPopup(event,'display_size')">display_size</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['memory_total']).'&lt;/span&gt; ';
<a name="l8606"><span class="linenum">8606</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['txt']  .= 'memory_total: '.<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['memory_total'].'<a class="function" onClick="logFunction('B')" href="../_functions/b.html" onMouseOver="funcPopup(event,'b')">B</a> (' . <a class="function" onClick="logFunction('display_size')" href="../_functions/display_size.html" onMouseOver="funcPopup(event,'display_size')">display_size</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['memory_total']).') memory_growth: '.
<a name="l8607"><span class="linenum">8607</span></a>              <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['memory_growth'].'<a class="function" onClick="logFunction('B')" href="../_functions/b.html" onMouseOver="funcPopup(event,'b')">B</a> ('.<a class="function" onClick="logFunction('display_size')" href="../_functions/display_size.html" onMouseOver="funcPopup(event,'display_size')">display_size</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['memory_growth']).') ';
<a name="l8608"><span class="linenum">8608</span></a>      }
<a name="l8609"><span class="linenum">8609</span></a>  
<a name="l8610"><span class="linenum">8610</span></a>      if (<a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>('memory_get_peak_usage')) {
<a name="l8611"><span class="linenum">8611</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['memory_peak'] = memory_get_peak_usage();
<a name="l8612"><span class="linenum">8612</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['html'] .= '&lt;span class=&quot;memoryused&quot;&gt;RAM peak: '.<a class="function" onClick="logFunction('display_size')" href="../_functions/display_size.html" onMouseOver="funcPopup(event,'display_size')">display_size</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['memory_peak']).'&lt;/span&gt; ';
<a name="l8613"><span class="linenum">8613</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['txt']  .= 'memory_peak: '.<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['memory_peak'].'<a class="function" onClick="logFunction('B')" href="../_functions/b.html" onMouseOver="funcPopup(event,'b')">B</a> (' . <a class="function" onClick="logFunction('display_size')" href="../_functions/display_size.html" onMouseOver="funcPopup(event,'display_size')">display_size</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['memory_peak']).') ';
<a name="l8614"><span class="linenum">8614</span></a>      }
<a name="l8615"><span class="linenum">8615</span></a>  
<a name="l8616"><span class="linenum">8616</span></a>      <a class="var it13242" onMouseOver="hilite(13242)" onMouseOut="lolite()" onClick="logVariable('inc')" href="../_variables/inc.html">$inc</a> = <a class="phpfunction" onClick="logFunction('get_included_files')" href="../_functions/get_included_files.html" onMouseOver="phpfuncPopup(event,'get_included_files')">get_included_files</a>();
<a name="l8617"><span class="linenum">8617</span></a>      <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['includecount'] = <a class="phpfunction" onClick="logFunction('count')" href="../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it13242" onMouseOver="hilite(13242)" onMouseOut="lolite()" onClick="logVariable('inc')" href="../_variables/inc.html">$inc</a>);
<a name="l8618"><span class="linenum">8618</span></a>      <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['html'] .= '&lt;span class=&quot;included&quot;&gt;Included '.<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['includecount'].' files&lt;/span&gt; ';
<a name="l8619"><span class="linenum">8619</span></a>      <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['txt']  .= 'includecount: '.<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['includecount'].' ';
<a name="l8620"><span class="linenum">8620</span></a>  
<a name="l8621"><span class="linenum">8621</span></a>      if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('early_install_lang')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/early_install_lang.html">early_install_lang</a>) or empty(<a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>)) {
<a name="l8622"><span class="linenum">8622</span></a>  <span class="comment">        // We can not track more performance before installation or before PAGE init, sorry.</span>
<a name="l8623"><span class="linenum">8623</span></a>          return <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>;
<a name="l8624"><span class="linenum">8624</span></a>      }
<a name="l8625"><span class="linenum">8625</span></a>  
<a name="l8626"><span class="linenum">8626</span></a>      <a class="var it13243" onMouseOver="hilite(13243)" onMouseOut="lolite()" onClick="logVariable('filtermanager')" href="../_variables/filtermanager.html">$filtermanager</a> = <a class="class" onClick="logClass('filter_manager')" href="../_classes/filter_manager.html" onMouseOver="classPopup(event,'filter_manager')">filter_manager</a>::<a class="function" onClick="logFunction('instance')" href="../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>();
<a name="l8627"><span class="linenum">8627</span></a>      if (<a class="phpfunction" onClick="logFunction('method_exists')" href="../_functions/method_exists.html" onMouseOver="phpfuncPopup(event,'method_exists')">method_exists</a>(<a class="var it13243" onMouseOver="hilite(13243)" onMouseOut="lolite()" onClick="logVariable('filtermanager')" href="../_variables/filtermanager.html">$filtermanager</a>, 'get_performance_summary')) {
<a name="l8628"><span class="linenum">8628</span></a>          <a class="function" onClick="logFunction('list')" href="../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it8932" onMouseOver="hilite(8932)" onMouseOut="lolite()" onClick="logVariable('filterinfo')" href="../_variables/filterinfo.html">$filterinfo</a>, <a class="var it13244" onMouseOver="hilite(13244)" onMouseOut="lolite()" onClick="logVariable('nicenames')" href="../_variables/nicenames.html">$nicenames</a>) = <a class="var it13243" onMouseOver="hilite(13243)" onMouseOut="lolite()" onClick="logVariable('filtermanager')" href="../_variables/filtermanager.html">$filtermanager</a>-&gt;<a class="function" onClick="logFunction('get_performance_summary')" href="../_functions/get_performance_summary.html" onMouseOver="funcPopup(event,'get_performance_summary')">get_performance_summary</a>();
<a name="l8629"><span class="linenum">8629</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it8932" onMouseOver="hilite(8932)" onMouseOut="lolite()" onClick="logVariable('filterinfo')" href="../_variables/filterinfo.html">$filterinfo</a>, <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>);
<a name="l8630"><span class="linenum">8630</span></a>          foreach (<a class="var it8932" onMouseOver="hilite(8932)" onMouseOut="lolite()" onClick="logVariable('filterinfo')" href="../_variables/filterinfo.html">$filterinfo</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) {
<a name="l8631"><span class="linenum">8631</span></a>              <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['html'] .= &quot;&lt;span class='<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>'&gt;<a class="var it13244" onMouseOver="hilite(13244)" onMouseOut="lolite()" onClick="logVariable('nicenames')" href="../_variables/nicenames.html">$nicenames</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>]: <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> &lt;/span&gt; &quot;;
<a name="l8632"><span class="linenum">8632</span></a>              <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['txt'] .= &quot;<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>: <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> &quot;;
<a name="l8633"><span class="linenum">8633</span></a>          }
<a name="l8634"><span class="linenum">8634</span></a>      }
<a name="l8635"><span class="linenum">8635</span></a>  
<a name="l8636"><span class="linenum">8636</span></a>      <a class="var it2233" onMouseOver="hilite(2233)" onMouseOut="lolite()" onClick="logVariable('stringmanager')" href="../_variables/stringmanager.html">$stringmanager</a> = <a class="function" onClick="logFunction('get_string_manager')" href="../_functions/get_string_manager.html" onMouseOver="funcPopup(event,'get_string_manager')">get_string_manager</a>();
<a name="l8637"><span class="linenum">8637</span></a>      if (<a class="phpfunction" onClick="logFunction('method_exists')" href="../_functions/method_exists.html" onMouseOver="phpfuncPopup(event,'method_exists')">method_exists</a>(<a class="var it2233" onMouseOver="hilite(2233)" onMouseOut="lolite()" onClick="logVariable('stringmanager')" href="../_variables/stringmanager.html">$stringmanager</a>, 'get_performance_summary')) {
<a name="l8638"><span class="linenum">8638</span></a>          <a class="function" onClick="logFunction('list')" href="../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it8932" onMouseOver="hilite(8932)" onMouseOut="lolite()" onClick="logVariable('filterinfo')" href="../_variables/filterinfo.html">$filterinfo</a>, <a class="var it13244" onMouseOver="hilite(13244)" onMouseOut="lolite()" onClick="logVariable('nicenames')" href="../_variables/nicenames.html">$nicenames</a>) = <a class="var it2233" onMouseOver="hilite(2233)" onMouseOut="lolite()" onClick="logVariable('stringmanager')" href="../_variables/stringmanager.html">$stringmanager</a>-&gt;<a class="function" onClick="logFunction('get_performance_summary')" href="../_functions/get_performance_summary.html" onMouseOver="funcPopup(event,'get_performance_summary')">get_performance_summary</a>();
<a name="l8639"><span class="linenum">8639</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it8932" onMouseOver="hilite(8932)" onMouseOut="lolite()" onClick="logVariable('filterinfo')" href="../_variables/filterinfo.html">$filterinfo</a>, <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>);
<a name="l8640"><span class="linenum">8640</span></a>          foreach (<a class="var it8932" onMouseOver="hilite(8932)" onMouseOut="lolite()" onClick="logVariable('filterinfo')" href="../_variables/filterinfo.html">$filterinfo</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) {
<a name="l8641"><span class="linenum">8641</span></a>              <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['html'] .= &quot;&lt;span class='<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>'&gt;<a class="var it13244" onMouseOver="hilite(13244)" onMouseOut="lolite()" onClick="logVariable('nicenames')" href="../_variables/nicenames.html">$nicenames</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>]: <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> &lt;/span&gt; &quot;;
<a name="l8642"><span class="linenum">8642</span></a>              <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['txt'] .= &quot;<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>: <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> &quot;;
<a name="l8643"><span class="linenum">8643</span></a>          }
<a name="l8644"><span class="linenum">8644</span></a>      }
<a name="l8645"><span class="linenum">8645</span></a>  
<a name="l8646"><span class="linenum">8646</span></a>      if (!empty(<a class="var it13240" onMouseOver="hilite(13240)" onMouseOut="lolite()" onClick="logVariable('PERF')" href="../_variables/PERF.html">$PERF</a>-&gt;<a onClick="logVariable('logwrites')" class="var it39693" onMouseOver="hilite(39693)" onMouseOut="lolite()" href="../_variables/logwrites.html">logwrites</a>)) {
<a name="l8647"><span class="linenum">8647</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['logwrites'] = <a class="var it13240" onMouseOver="hilite(13240)" onMouseOut="lolite()" onClick="logVariable('PERF')" href="../_variables/PERF.html">$PERF</a>-&gt;<a onClick="logVariable('logwrites')" class="var it39693" onMouseOver="hilite(39693)" onMouseOut="lolite()" href="../_variables/logwrites.html">logwrites</a>;
<a name="l8648"><span class="linenum">8648</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['html'] .= '&lt;span class=&quot;logwrites&quot;&gt;Log DB writes '.<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['logwrites'].'&lt;/span&gt; ';
<a name="l8649"><span class="linenum">8649</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['txt'] .= 'logwrites: '.<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['logwrites'].' ';
<a name="l8650"><span class="linenum">8650</span></a>      }
<a name="l8651"><span class="linenum">8651</span></a>  
<a name="l8652"><span class="linenum">8652</span></a>      <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['dbqueries'] = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('perf_get_reads')" href="../_functions/perf_get_reads.html" onMouseOver="funcPopup(event,'perf_get_reads')">perf_get_reads</a>().'/'.(<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('perf_get_writes')" href="../_functions/perf_get_writes.html" onMouseOver="funcPopup(event,'perf_get_writes')">perf_get_writes</a>() - <a class="var it13240" onMouseOver="hilite(13240)" onMouseOut="lolite()" onClick="logVariable('PERF')" href="../_variables/PERF.html">$PERF</a>-&gt;<a onClick="logVariable('logwrites')" class="var it39693" onMouseOver="hilite(39693)" onMouseOut="lolite()" href="../_variables/logwrites.html">logwrites</a>);
<a name="l8653"><span class="linenum">8653</span></a>      <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['html'] .= '&lt;span class=&quot;dbqueries&quot;&gt;DB reads/writes: '.<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['dbqueries'].'&lt;/span&gt; ';
<a name="l8654"><span class="linenum">8654</span></a>      <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['txt'] .= 'db reads/writes: '.<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['dbqueries'].' ';
<a name="l8655"><span class="linenum">8655</span></a>  
<a name="l8656"><span class="linenum">8656</span></a>      <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['dbtime'] = <a class="phpfunction" onClick="logFunction('round')" href="../_functions/round.html" onMouseOver="phpfuncPopup(event,'round')">round</a>(<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('perf_get_queries_time')" href="../_functions/perf_get_queries_time.html" onMouseOver="funcPopup(event,'perf_get_queries_time')">perf_get_queries_time</a>(), 5);
<a name="l8657"><span class="linenum">8657</span></a>      <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['html'] .= '&lt;span class=&quot;dbtime&quot;&gt;DB queries time: '.<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['dbtime'].' secs&lt;/span&gt; ';
<a name="l8658"><span class="linenum">8658</span></a>      <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['txt'] .= 'db queries time: ' . <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['dbtime'] . 's ';
<a name="l8659"><span class="linenum">8659</span></a>  
<a name="l8660"><span class="linenum">8660</span></a>      if (<a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>('posix_times')) {
<a name="l8661"><span class="linenum">8661</span></a>          <a class="var it13246" onMouseOver="hilite(13246)" onMouseOut="lolite()" onClick="logVariable('ptimes')" href="../_variables/ptimes.html">$ptimes</a> = <a class="phpfunction" onClick="logFunction('posix_times')" href="../_functions/posix_times.html" onMouseOver="phpfuncPopup(event,'posix_times')">posix_times</a>();
<a name="l8662"><span class="linenum">8662</span></a>          if (<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it13246" onMouseOver="hilite(13246)" onMouseOut="lolite()" onClick="logVariable('ptimes')" href="../_variables/ptimes.html">$ptimes</a>)) {
<a name="l8663"><span class="linenum">8663</span></a>              foreach (<a class="var it13246" onMouseOver="hilite(13246)" onMouseOut="lolite()" onClick="logVariable('ptimes')" href="../_variables/ptimes.html">$ptimes</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it1140" onMouseOver="hilite(1140)" onMouseOut="lolite()" onClick="logVariable('val')" href="../_variables/val.html">$val</a>) {
<a name="l8664"><span class="linenum">8664</span></a>                  <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = <a class="var it13246" onMouseOver="hilite(13246)" onMouseOut="lolite()" onClick="logVariable('ptimes')" href="../_variables/ptimes.html">$ptimes</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] -  <a class="var it13240" onMouseOver="hilite(13240)" onMouseOut="lolite()" onClick="logVariable('PERF')" href="../_variables/PERF.html">$PERF</a>-&gt;<a onClick="logVariable('startposixtimes')" class="var it39693" onMouseOver="hilite(39693)" onMouseOut="lolite()" href="../_variables/startposixtimes.html">startposixtimes</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>];
<a name="l8665"><span class="linenum">8665</span></a>              }
<a name="l8666"><span class="linenum">8666</span></a>              <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['html'] .= &quot;&lt;span class=\&quot;posixtimes\&quot;&gt;ticks: <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>[ticks] user: <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>[utime] sys: <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>[stime] cuser: <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>[cutime] csys: <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>[cstime]&lt;/span&gt; &quot;;
<a name="l8667"><span class="linenum">8667</span></a>              <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['txt'] .= &quot;ticks: <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>[ticks] user: <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>[utime] sys: <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>[stime] cuser: <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>[cutime] csys: <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>[cstime] &quot;;
<a name="l8668"><span class="linenum">8668</span></a>          }
<a name="l8669"><span class="linenum">8669</span></a>      }
<a name="l8670"><span class="linenum">8670</span></a>  
<a name="l8671"><span class="linenum">8671</span></a>  <span class="comment">    // Grab the load average for the last minute.</span>
<a name="l8672"><span class="linenum">8672</span></a>  <span class="comment">    // /proc will only work under some linux configurations</span>
<a name="l8673"><span class="linenum">8673</span></a>  <span class="comment">    // while uptime is there under MacOSX/Darwin and other unices.</span>
<a name="l8674"><span class="linenum">8674</span></a>      if (<a class="phpfunction" onClick="logFunction('is_readable')" href="../_functions/is_readable.html" onMouseOver="phpfuncPopup(event,'is_readable')">is_readable</a>('/proc/loadavg') &amp;&amp; <a class="var it4766" onMouseOver="hilite(4766)" onMouseOut="lolite()" onClick="logVariable('loadavg')" href="../_variables/loadavg.html">$loadavg</a> = @<a class="phpfunction" onClick="logFunction('file')" href="../_functions/file.html" onMouseOver="phpfuncPopup(event,'file')">file</a>('/proc/loadavg')) {
<a name="l8675"><span class="linenum">8675</span></a>          <a class="function" onClick="logFunction('list')" href="../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it13248" onMouseOver="hilite(13248)" onMouseOut="lolite()" onClick="logVariable('serverload')" href="../_variables/serverload.html">$serverload</a>) = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(' ', <a class="var it4766" onMouseOver="hilite(4766)" onMouseOut="lolite()" onClick="logVariable('loadavg')" href="../_variables/loadavg.html">$loadavg</a>[0]);
<a name="l8676"><span class="linenum">8676</span></a>          unset(<a class="var it4766" onMouseOver="hilite(4766)" onMouseOut="lolite()" onClick="logVariable('loadavg')" href="../_variables/loadavg.html">$loadavg</a>);
<a name="l8677"><span class="linenum">8677</span></a>      } else if ( <a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>('is_executable') &amp;&amp; <a class="phpfunction" onClick="logFunction('is_executable')" href="../_functions/is_executable.html" onMouseOver="phpfuncPopup(event,'is_executable')">is_executable</a>('/usr/bin/uptime') &amp;&amp; <a class="var it4766" onMouseOver="hilite(4766)" onMouseOut="lolite()" onClick="logVariable('loadavg')" href="../_variables/loadavg.html">$loadavg</a> = `/usr/bin/uptime` ) {
<a name="l8678"><span class="linenum">8678</span></a>          if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/load averages?: (\d+[\.,:]\d+)/', <a class="var it4766" onMouseOver="hilite(4766)" onMouseOut="lolite()" onClick="logVariable('loadavg')" href="../_variables/loadavg.html">$loadavg</a>, <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>)) {
<a name="l8679"><span class="linenum">8679</span></a>              <a class="var it13248" onMouseOver="hilite(13248)" onMouseOut="lolite()" onClick="logVariable('serverload')" href="../_variables/serverload.html">$serverload</a> = <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>[1];
<a name="l8680"><span class="linenum">8680</span></a>          } else {
<a name="l8681"><span class="linenum">8681</span></a>              <a class="phpfunction" onClick="logFunction('trigger_error')" href="../_functions/trigger_error.html" onMouseOver="phpfuncPopup(event,'trigger_error')">trigger_error</a>('Could not parse uptime output!');
<a name="l8682"><span class="linenum">8682</span></a>          }
<a name="l8683"><span class="linenum">8683</span></a>      }
<a name="l8684"><span class="linenum">8684</span></a>      if (!empty(<a class="var it13248" onMouseOver="hilite(13248)" onMouseOut="lolite()" onClick="logVariable('serverload')" href="../_variables/serverload.html">$serverload</a>)) {
<a name="l8685"><span class="linenum">8685</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['serverload'] = <a class="var it13248" onMouseOver="hilite(13248)" onMouseOut="lolite()" onClick="logVariable('serverload')" href="../_variables/serverload.html">$serverload</a>;
<a name="l8686"><span class="linenum">8686</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['html'] .= '&lt;span class=&quot;serverload&quot;&gt;Load average: '.<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['serverload'].'&lt;/span&gt; ';
<a name="l8687"><span class="linenum">8687</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['txt'] .= &quot;serverload: {<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['serverload']} &quot;;
<a name="l8688"><span class="linenum">8688</span></a>      }
<a name="l8689"><span class="linenum">8689</span></a>  
<a name="l8690"><span class="linenum">8690</span></a>  <span class="comment">    // Display size of session if session started.</span>
<a name="l8691"><span class="linenum">8691</span></a>      if (<a class="var it6594" onMouseOver="hilite(6594)" onMouseOut="lolite()" onClick="logVariable('si')" href="../_variables/si.html">$si</a> = \core\session\<a class="class" onClick="logClass('manager')" href="../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('get_performance_info')" href="../_functions/get_performance_info.html" onMouseOver="funcPopup(event,'get_performance_info')">get_performance_info</a>()) {
<a name="l8692"><span class="linenum">8692</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['sessionsize'] = <a class="var it6594" onMouseOver="hilite(6594)" onMouseOut="lolite()" onClick="logVariable('si')" href="../_variables/si.html">$si</a>['size'];
<a name="l8693"><span class="linenum">8693</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['html'] .= <a class="var it6594" onMouseOver="hilite(6594)" onMouseOut="lolite()" onClick="logVariable('si')" href="../_variables/si.html">$si</a>['html'];
<a name="l8694"><span class="linenum">8694</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['txt'] .= <a class="var it6594" onMouseOver="hilite(6594)" onMouseOut="lolite()" onClick="logVariable('si')" href="../_variables/si.html">$si</a>['txt'];
<a name="l8695"><span class="linenum">8695</span></a>      }
<a name="l8696"><span class="linenum">8696</span></a>  
<a name="l8697"><span class="linenum">8697</span></a>      if (<a class="var it428" onMouseOver="hilite(428)" onMouseOut="lolite()" onClick="logVariable('stats')" href="../_variables/stats.html">$stats</a> = <a class="class" onClick="logClass('cache_helper')" href="../_classes/cache_helper.html" onMouseOver="classPopup(event,'cache_helper')">cache_helper</a>::<a class="function" onClick="logFunction('get_stats')" href="../_functions/get_stats.html" onMouseOver="funcPopup(event,'get_stats')">get_stats</a>()) {
<a name="l8698"><span class="linenum">8698</span></a>          <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('html')" href="../_variables/html.html">$html</a> = '&lt;span class=&quot;cachesused&quot;&gt;';
<a name="l8699"><span class="linenum">8699</span></a>          <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('html')" href="../_variables/html.html">$html</a> .= '&lt;span class=&quot;cache-stats-heading&quot;&gt;Caches used (hits/misses/sets)&lt;/span&gt;';
<a name="l8700"><span class="linenum">8700</span></a>          <a class="var it72" onMouseOver="hilite(72)" onMouseOut="lolite()" onClick="logVariable('text')" href="../_variables/text.html">$text</a> = 'Caches used (hits/misses/sets): ';
<a name="l8701"><span class="linenum">8701</span></a>          <a class="var it1781" onMouseOver="hilite(1781)" onMouseOut="lolite()" onClick="logVariable('hits')" href="../_variables/hits.html">$hits</a> = 0;
<a name="l8702"><span class="linenum">8702</span></a>          <a class="var it13249" onMouseOver="hilite(13249)" onMouseOut="lolite()" onClick="logVariable('misses')" href="../_variables/misses.html">$misses</a> = 0;
<a name="l8703"><span class="linenum">8703</span></a>          <a class="var it12590" onMouseOver="hilite(12590)" onMouseOut="lolite()" onClick="logVariable('sets')" href="../_variables/sets.html">$sets</a> = 0;
<a name="l8704"><span class="linenum">8704</span></a>          foreach (<a class="var it428" onMouseOver="hilite(428)" onMouseOut="lolite()" onClick="logVariable('stats')" href="../_variables/stats.html">$stats</a> as <a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('definition')" href="../_variables/definition.html">$definition</a> =&gt; <a class="var it1213" onMouseOver="hilite(1213)" onMouseOut="lolite()" onClick="logVariable('details')" href="../_variables/details.html">$details</a>) {
<a name="l8705"><span class="linenum">8705</span></a>              switch (<a class="var it1213" onMouseOver="hilite(1213)" onMouseOut="lolite()" onClick="logVariable('details')" href="../_variables/details.html">$details</a>['mode']) {
<a name="l8706"><span class="linenum">8706</span></a>                  case cache_store::MODE_APPLICATION:
<a name="l8707"><span class="linenum">8707</span></a>                      <a class="var it13250" onMouseOver="hilite(13250)" onMouseOut="lolite()" onClick="logVariable('modeclass')" href="../_variables/modeclass.html">$modeclass</a> = 'application';
<a name="l8708"><span class="linenum">8708</span></a>                      <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../_variables/mode.html">$mode</a> = ' &lt;span title=&quot;application cache&quot;&gt;[a]&lt;/span&gt;';
<a name="l8709"><span class="linenum">8709</span></a>                      break;
<a name="l8710"><span class="linenum">8710</span></a>                  case cache_store::MODE_SESSION:
<a name="l8711"><span class="linenum">8711</span></a>                      <a class="var it13250" onMouseOver="hilite(13250)" onMouseOut="lolite()" onClick="logVariable('modeclass')" href="../_variables/modeclass.html">$modeclass</a> = 'session';
<a name="l8712"><span class="linenum">8712</span></a>                      <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../_variables/mode.html">$mode</a> = ' &lt;span title=&quot;session cache&quot;&gt;[s]&lt;/span&gt;';
<a name="l8713"><span class="linenum">8713</span></a>                      break;
<a name="l8714"><span class="linenum">8714</span></a>                  case cache_store::MODE_REQUEST:
<a name="l8715"><span class="linenum">8715</span></a>                      <a class="var it13250" onMouseOver="hilite(13250)" onMouseOut="lolite()" onClick="logVariable('modeclass')" href="../_variables/modeclass.html">$modeclass</a> = 'request';
<a name="l8716"><span class="linenum">8716</span></a>                      <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../_variables/mode.html">$mode</a> = ' &lt;span title=&quot;request cache&quot;&gt;[r]&lt;/span&gt;';
<a name="l8717"><span class="linenum">8717</span></a>                      break;
<a name="l8718"><span class="linenum">8718</span></a>              }
<a name="l8719"><span class="linenum">8719</span></a>              <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('html')" href="../_variables/html.html">$html</a> .= '&lt;span class=&quot;cache-definition-stats cache-mode-'.<a class="var it13250" onMouseOver="hilite(13250)" onMouseOut="lolite()" onClick="logVariable('modeclass')" href="../_variables/modeclass.html">$modeclass</a>.'&quot;&gt;';
<a name="l8720"><span class="linenum">8720</span></a>              <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('html')" href="../_variables/html.html">$html</a> .= '&lt;span class=&quot;cache-definition-stats-heading&quot;&gt;'.<a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('definition')" href="../_variables/definition.html">$definition</a>.<a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../_variables/mode.html">$mode</a>.'&lt;/span&gt;';
<a name="l8721"><span class="linenum">8721</span></a>              <a class="var it72" onMouseOver="hilite(72)" onMouseOut="lolite()" onClick="logVariable('text')" href="../_variables/text.html">$text</a> .= &quot;<a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('definition')" href="../_variables/definition.html">$definition</a> {&quot;;
<a name="l8722"><span class="linenum">8722</span></a>              foreach (<a class="var it1213" onMouseOver="hilite(1213)" onMouseOut="lolite()" onClick="logVariable('details')" href="../_variables/details.html">$details</a>['stores'] as <a class="var it387" onMouseOver="hilite(387)" onMouseOut="lolite()" onClick="logVariable('store')" href="../_variables/store.html">$store</a> =&gt; <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>) {
<a name="l8723"><span class="linenum">8723</span></a>                  <a class="var it1781" onMouseOver="hilite(1781)" onMouseOut="lolite()" onClick="logVariable('hits')" href="../_variables/hits.html">$hits</a> += <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>['hits'];
<a name="l8724"><span class="linenum">8724</span></a>                  <a class="var it13249" onMouseOver="hilite(13249)" onMouseOut="lolite()" onClick="logVariable('misses')" href="../_variables/misses.html">$misses</a> += <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>['misses'];
<a name="l8725"><span class="linenum">8725</span></a>                  <a class="var it12590" onMouseOver="hilite(12590)" onMouseOut="lolite()" onClick="logVariable('sets')" href="../_variables/sets.html">$sets</a> += <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>['sets'];
<a name="l8726"><span class="linenum">8726</span></a>                  if (<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>['hits'] == 0 and <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>['misses'] &gt; 0) {
<a name="l8727"><span class="linenum">8727</span></a>                      <a class="var it13251" onMouseOver="hilite(13251)" onMouseOut="lolite()" onClick="logVariable('cachestoreclass')" href="../_variables/cachestoreclass.html">$cachestoreclass</a> = 'nohits';
<a name="l8728"><span class="linenum">8728</span></a>                  } else if (<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>['hits'] &lt; <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>['misses']) {
<a name="l8729"><span class="linenum">8729</span></a>                      <a class="var it13251" onMouseOver="hilite(13251)" onMouseOut="lolite()" onClick="logVariable('cachestoreclass')" href="../_variables/cachestoreclass.html">$cachestoreclass</a> = 'lowhits';
<a name="l8730"><span class="linenum">8730</span></a>                  } else {
<a name="l8731"><span class="linenum">8731</span></a>                      <a class="var it13251" onMouseOver="hilite(13251)" onMouseOut="lolite()" onClick="logVariable('cachestoreclass')" href="../_variables/cachestoreclass.html">$cachestoreclass</a> = 'hihits';
<a name="l8732"><span class="linenum">8732</span></a>                  }
<a name="l8733"><span class="linenum">8733</span></a>                  <a class="var it72" onMouseOver="hilite(72)" onMouseOut="lolite()" onClick="logVariable('text')" href="../_variables/text.html">$text</a> .= &quot;<a class="var it387" onMouseOver="hilite(387)" onMouseOut="lolite()" onClick="logVariable('store')" href="../_variables/store.html">$store</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>[hits]/<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>[misses]/<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>[sets]) &quot;;
<a name="l8734"><span class="linenum">8734</span></a>                  <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('html')" href="../_variables/html.html">$html</a> .= &quot;&lt;span class=\&quot;cache-store-stats <a class="var it13251" onMouseOver="hilite(13251)" onMouseOut="lolite()" onClick="logVariable('cachestoreclass')" href="../_variables/cachestoreclass.html">$cachestoreclass</a>\&quot;&gt;<a class="var it387" onMouseOver="hilite(387)" onMouseOut="lolite()" onClick="logVariable('store')" href="../_variables/store.html">$store</a>: <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>[hits] / <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>[misses] / <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>[sets]&lt;/span&gt;&quot;;
<a name="l8735"><span class="linenum">8735</span></a>              }
<a name="l8736"><span class="linenum">8736</span></a>              <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('html')" href="../_variables/html.html">$html</a> .= '&lt;/span&gt;';
<a name="l8737"><span class="linenum">8737</span></a>              <a class="var it72" onMouseOver="hilite(72)" onMouseOut="lolite()" onClick="logVariable('text')" href="../_variables/text.html">$text</a> .= '} ';
<a name="l8738"><span class="linenum">8738</span></a>          }
<a name="l8739"><span class="linenum">8739</span></a>          <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('html')" href="../_variables/html.html">$html</a> .= &quot;&lt;span class='cache-total-stats'&gt;Total: <a class="var it1781" onMouseOver="hilite(1781)" onMouseOut="lolite()" onClick="logVariable('hits')" href="../_variables/hits.html">$hits</a> / <a class="var it13249" onMouseOver="hilite(13249)" onMouseOut="lolite()" onClick="logVariable('misses')" href="../_variables/misses.html">$misses</a> / <a class="var it12590" onMouseOver="hilite(12590)" onMouseOut="lolite()" onClick="logVariable('sets')" href="../_variables/sets.html">$sets</a>&lt;/span&gt;&quot;;
<a name="l8740"><span class="linenum">8740</span></a>          <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('html')" href="../_variables/html.html">$html</a> .= '&lt;/span&gt; ';
<a name="l8741"><span class="linenum">8741</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['cachesused'] = &quot;<a class="var it1781" onMouseOver="hilite(1781)" onMouseOut="lolite()" onClick="logVariable('hits')" href="../_variables/hits.html">$hits</a> / <a class="var it13249" onMouseOver="hilite(13249)" onMouseOut="lolite()" onClick="logVariable('misses')" href="../_variables/misses.html">$misses</a> / <a class="var it12590" onMouseOver="hilite(12590)" onMouseOut="lolite()" onClick="logVariable('sets')" href="../_variables/sets.html">$sets</a>&quot;;
<a name="l8742"><span class="linenum">8742</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['html'] .= <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('html')" href="../_variables/html.html">$html</a>;
<a name="l8743"><span class="linenum">8743</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['txt'] .= <a class="var it72" onMouseOver="hilite(72)" onMouseOut="lolite()" onClick="logVariable('text')" href="../_variables/text.html">$text</a>.'. ';
<a name="l8744"><span class="linenum">8744</span></a>      } else {
<a name="l8745"><span class="linenum">8745</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['cachesused'] = '0 / 0 / 0';
<a name="l8746"><span class="linenum">8746</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['html'] .= '&lt;span class=&quot;cachesused&quot;&gt;Caches used (hits/misses/sets): 0/0/0&lt;/span&gt;';
<a name="l8747"><span class="linenum">8747</span></a>          <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['txt'] .= 'Caches used (hits/misses/sets): 0/0/0 ';
<a name="l8748"><span class="linenum">8748</span></a>      }
<a name="l8749"><span class="linenum">8749</span></a>  
<a name="l8750"><span class="linenum">8750</span></a>      <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['html'] = '&lt;div class=&quot;performanceinfo siteinfo&quot;&gt;'.<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>['html'].'&lt;/div&gt;';
<a name="l8751"><span class="linenum">8751</span></a>      return <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../_variables/info.html">$info</a>;
<a name="l8752"><span class="linenum">8752</span></a>  }
<a name="l8753"><span class="linenum">8753</span></a>  
<a name="l8754"><span class="linenum">8754</span></a>  <span class="comment">/**</span>
<a name="l8755"><span class="linenum">8755</span></a>  <span class="comment"> * Legacy function.</span>
<a name="l8756"><span class="linenum">8756</span></a>  <span class="comment"> *</span>
<a name="l8757"><span class="linenum">8757</span></a>  <span class="comment"> * @todo Document this function linux people</span>
<a name="l8758"><span class="linenum">8758</span></a>  <span class="comment"> */</span>
<a name="l8759"><span class="linenum">8759</span></a>  function <a class="function" onClick="logFunction('apd_get_profiling')" href="../_functions/apd_get_profiling.html" onMouseOver="funcPopup(event,'apd_get_profiling')">apd_get_profiling</a>() {
<a name="l8760"><span class="linenum">8760</span></a>      return <a class="phpfunction" onClick="logFunction('shell_exec')" href="../_functions/shell_exec.html" onMouseOver="phpfuncPopup(event,'shell_exec')">shell_exec</a>('pprofp -u ' . <a class="phpfunction" onClick="logFunction('ini_get')" href="../_functions/ini_get.html" onMouseOver="phpfuncPopup(event,'ini_get')">ini_get</a>('apd.dumpdir') . '/pprof.' . <a class="phpfunction" onClick="logFunction('getmypid')" href="../_functions/getmypid.html" onMouseOver="phpfuncPopup(event,'getmypid')">getmypid</a>() . '.*');
<a name="l8761"><span class="linenum">8761</span></a>  }
<a name="l8762"><span class="linenum">8762</span></a>  
<a name="l8763"><span class="linenum">8763</span></a>  <span class="comment">/**</span>
<a name="l8764"><span class="linenum">8764</span></a>  <span class="comment"> * Delete directory or only its content</span>
<a name="l8765"><span class="linenum">8765</span></a>  <span class="comment"> *</span>
<a name="l8766"><span class="linenum">8766</span></a>  <span class="comment"> * @param string $dir directory path</span>
<a name="l8767"><span class="linenum">8767</span></a>  <span class="comment"> * @param bool $contentonly</span>
<a name="l8768"><span class="linenum">8768</span></a>  <span class="comment"> * @return bool success, true also if dir does not exist</span>
<a name="l8769"><span class="linenum">8769</span></a>  <span class="comment"> */</span>
<a name="l8770"><span class="linenum">8770</span></a>  function <a class="function" onClick="logFunction('remove_dir')" href="../_functions/remove_dir.html" onMouseOver="funcPopup(event,'remove_dir')">remove_dir</a>(<a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a>, <a class="var it13252" onMouseOver="hilite(13252)" onMouseOut="lolite()" onClick="logVariable('contentonly')" href="../_variables/contentonly.html">$contentonly</a>=false) {
<a name="l8771"><span class="linenum">8771</span></a>      if (!<a class="phpfunction" onClick="logFunction('file_exists')" href="../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a>)) {
<a name="l8772"><span class="linenum">8772</span></a>  <span class="comment">        // Nothing to do.</span>
<a name="l8773"><span class="linenum">8773</span></a>          return true;
<a name="l8774"><span class="linenum">8774</span></a>      }
<a name="l8775"><span class="linenum">8775</span></a>      if (!<a class="var it1207" onMouseOver="hilite(1207)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../_variables/handle.html">$handle</a> = <a class="phpfunction" onClick="logFunction('opendir')" href="../_functions/opendir.html" onMouseOver="phpfuncPopup(event,'opendir')">opendir</a>(<a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a>)) {
<a name="l8776"><span class="linenum">8776</span></a>          return false;
<a name="l8777"><span class="linenum">8777</span></a>      }
<a name="l8778"><span class="linenum">8778</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = true;
<a name="l8779"><span class="linenum">8779</span></a>      while (false!==(<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../_variables/item.html">$item</a> = readdir(<a class="var it1207" onMouseOver="hilite(1207)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../_variables/handle.html">$handle</a>))) {
<a name="l8780"><span class="linenum">8780</span></a>          if (<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../_variables/item.html">$item</a> != '.' &amp;&amp; <a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../_variables/item.html">$item</a> != '..') {
<a name="l8781"><span class="linenum">8781</span></a>              if (<a class="phpfunction" onClick="logFunction('is_dir')" href="../_functions/is_dir.html" onMouseOver="phpfuncPopup(event,'is_dir')">is_dir</a>(<a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a>.'/'.<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../_variables/item.html">$item</a>)) {
<a name="l8782"><span class="linenum">8782</span></a>                  <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = <a class="function" onClick="logFunction('remove_dir')" href="../_functions/remove_dir.html" onMouseOver="funcPopup(event,'remove_dir')">remove_dir</a>(<a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a>.'/'.<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../_variables/item.html">$item</a>) &amp;&amp; <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>;
<a name="l8783"><span class="linenum">8783</span></a>              } else {
<a name="l8784"><span class="linenum">8784</span></a>                  <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = <a class="phpfunction" onClick="logFunction('unlink')" href="../_functions/unlink.html" onMouseOver="phpfuncPopup(event,'unlink')">unlink</a>(<a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a>.'/'.<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../_variables/item.html">$item</a>) &amp;&amp; <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>;
<a name="l8785"><span class="linenum">8785</span></a>              }
<a name="l8786"><span class="linenum">8786</span></a>          }
<a name="l8787"><span class="linenum">8787</span></a>      }
<a name="l8788"><span class="linenum">8788</span></a>      <a class="phpfunction" onClick="logFunction('closedir')" href="../_functions/closedir.html" onMouseOver="phpfuncPopup(event,'closedir')">closedir</a>(<a class="var it1207" onMouseOver="hilite(1207)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../_variables/handle.html">$handle</a>);
<a name="l8789"><span class="linenum">8789</span></a>      if (<a class="var it13252" onMouseOver="hilite(13252)" onMouseOut="lolite()" onClick="logVariable('contentonly')" href="../_variables/contentonly.html">$contentonly</a>) {
<a name="l8790"><span class="linenum">8790</span></a>          <a class="phpfunction" onClick="logFunction('clearstatcache')" href="../_functions/clearstatcache.html" onMouseOver="phpfuncPopup(event,'clearstatcache')">clearstatcache</a>(); <span class="comment">// Make sure file stat cache is properly invalidated.</span>
<a name="l8791"><span class="linenum">8791</span></a>          return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>;
<a name="l8792"><span class="linenum">8792</span></a>      }
<a name="l8793"><span class="linenum">8793</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = <a class="phpfunction" onClick="logFunction('rmdir')" href="../_functions/rmdir.html" onMouseOver="phpfuncPopup(event,'rmdir')">rmdir</a>(<a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../_variables/dir.html">$dir</a>); <span class="comment">// If anything left the result will be false, no need for &amp;&amp; $result.</span>
<a name="l8794"><span class="linenum">8794</span></a>      <a class="phpfunction" onClick="logFunction('clearstatcache')" href="../_functions/clearstatcache.html" onMouseOver="phpfuncPopup(event,'clearstatcache')">clearstatcache</a>(); <span class="comment">// Make sure file stat cache is properly invalidated.</span>
<a name="l8795"><span class="linenum">8795</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>;
<a name="l8796"><span class="linenum">8796</span></a>  }
<a name="l8797"><span class="linenum">8797</span></a>  
<a name="l8798"><span class="linenum">8798</span></a>  <span class="comment">/**</span>
<a name="l8799"><span class="linenum">8799</span></a>  <span class="comment"> * Detect if an object or a class contains a given property</span>
<a name="l8800"><span class="linenum">8800</span></a>  <span class="comment"> * will take an actual object or the name of a class</span>
<a name="l8801"><span class="linenum">8801</span></a>  <span class="comment"> *</span>
<a name="l8802"><span class="linenum">8802</span></a>  <span class="comment"> * @param mix $obj Name of class or real object to test</span>
<a name="l8803"><span class="linenum">8803</span></a>  <span class="comment"> * @param string $property name of property to find</span>
<a name="l8804"><span class="linenum">8804</span></a>  <span class="comment"> * @return bool true if property exists</span>
<a name="l8805"><span class="linenum">8805</span></a>  <span class="comment"> */</span>
<a name="l8806"><span class="linenum">8806</span></a>  function <a class="function" onClick="logFunction('object_property_exists')" href="../_functions/object_property_exists.html" onMouseOver="funcPopup(event,'object_property_exists')">object_property_exists</a>( <a class="var it1960" onMouseOver="hilite(1960)" onMouseOut="lolite()" onClick="logVariable('obj')" href="../_variables/obj.html">$obj</a>, <a class="var it1682" onMouseOver="hilite(1682)" onMouseOut="lolite()" onClick="logVariable('property')" href="../_variables/property.html">$property</a> ) {
<a name="l8807"><span class="linenum">8807</span></a>      if (<a class="phpfunction" onClick="logFunction('is_string')" href="../_functions/is_string.html" onMouseOver="phpfuncPopup(event,'is_string')">is_string</a>( <a class="var it1960" onMouseOver="hilite(1960)" onMouseOut="lolite()" onClick="logVariable('obj')" href="../_variables/obj.html">$obj</a> )) {
<a name="l8808"><span class="linenum">8808</span></a>          <a class="var it515" onMouseOver="hilite(515)" onMouseOut="lolite()" onClick="logVariable('properties')" href="../_variables/properties.html">$properties</a> = <a class="phpfunction" onClick="logFunction('get_class_vars')" href="../_functions/get_class_vars.html" onMouseOver="phpfuncPopup(event,'get_class_vars')">get_class_vars</a>( <a class="var it1960" onMouseOver="hilite(1960)" onMouseOut="lolite()" onClick="logVariable('obj')" href="../_variables/obj.html">$obj</a> );
<a name="l8809"><span class="linenum">8809</span></a>      } else {
<a name="l8810"><span class="linenum">8810</span></a>          <a class="var it515" onMouseOver="hilite(515)" onMouseOut="lolite()" onClick="logVariable('properties')" href="../_variables/properties.html">$properties</a> = <a class="phpfunction" onClick="logFunction('get_object_vars')" href="../_functions/get_object_vars.html" onMouseOver="phpfuncPopup(event,'get_object_vars')">get_object_vars</a>( <a class="var it1960" onMouseOver="hilite(1960)" onMouseOut="lolite()" onClick="logVariable('obj')" href="../_variables/obj.html">$obj</a> );
<a name="l8811"><span class="linenum">8811</span></a>      }
<a name="l8812"><span class="linenum">8812</span></a>      return <a class="phpfunction" onClick="logFunction('array_key_exists')" href="../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>( <a class="var it1682" onMouseOver="hilite(1682)" onMouseOut="lolite()" onClick="logVariable('property')" href="../_variables/property.html">$property</a>, <a class="var it515" onMouseOver="hilite(515)" onMouseOut="lolite()" onClick="logVariable('properties')" href="../_variables/properties.html">$properties</a> );
<a name="l8813"><span class="linenum">8813</span></a>  }
<a name="l8814"><span class="linenum">8814</span></a>  
<a name="l8815"><span class="linenum">8815</span></a>  <span class="comment">/**</span>
<a name="l8816"><span class="linenum">8816</span></a>  <span class="comment"> * Converts an object into an associative array</span>
<a name="l8817"><span class="linenum">8817</span></a>  <span class="comment"> *</span>
<a name="l8818"><span class="linenum">8818</span></a>  <span class="comment"> * This function converts an object into an associative array by iterating</span>
<a name="l8819"><span class="linenum">8819</span></a>  <span class="comment"> * over its public properties. Because this function uses the foreach</span>
<a name="l8820"><span class="linenum">8820</span></a>  <span class="comment"> * construct, Iterators are respected. It works recursively on arrays of objects.</span>
<a name="l8821"><span class="linenum">8821</span></a>  <span class="comment"> * Arrays and simple values are returned as is.</span>
<a name="l8822"><span class="linenum">8822</span></a>  <span class="comment"> *</span>
<a name="l8823"><span class="linenum">8823</span></a>  <span class="comment"> * If class has magic properties, it can implement IteratorAggregate</span>
<a name="l8824"><span class="linenum">8824</span></a>  <span class="comment"> * and return all available properties in getIterator()</span>
<a name="l8825"><span class="linenum">8825</span></a>  <span class="comment"> *</span>
<a name="l8826"><span class="linenum">8826</span></a>  <span class="comment"> * @param mixed $var</span>
<a name="l8827"><span class="linenum">8827</span></a>  <span class="comment"> * @return array</span>
<a name="l8828"><span class="linenum">8828</span></a>  <span class="comment"> */</span>
<a name="l8829"><span class="linenum">8829</span></a>  function <a class="function" onClick="logFunction('convert_to_array')" href="../_functions/convert_to_array.html" onMouseOver="funcPopup(event,'convert_to_array')">convert_to_array</a>(<a class="var it3053" onMouseOver="hilite(3053)" onMouseOut="lolite()" onClick="logVariable('var')" href="../_variables/var.html">$var</a>) {
<a name="l8830"><span class="linenum">8830</span></a>      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = array();
<a name="l8831"><span class="linenum">8831</span></a>  
<a name="l8832"><span class="linenum">8832</span></a>  <span class="comment">    // Loop over elements/properties.</span>
<a name="l8833"><span class="linenum">8833</span></a>      foreach (<a class="var it3053" onMouseOver="hilite(3053)" onMouseOut="lolite()" onClick="logVariable('var')" href="../_variables/var.html">$var</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) {
<a name="l8834"><span class="linenum">8834</span></a>  <span class="comment">        // Recursively convert objects.</span>
<a name="l8835"><span class="linenum">8835</span></a>          if (<a class="phpfunction" onClick="logFunction('is_object')" href="../_functions/is_object.html" onMouseOver="phpfuncPopup(event,'is_object')">is_object</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) || <a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>)) {
<a name="l8836"><span class="linenum">8836</span></a>              <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = <a class="function" onClick="logFunction('convert_to_array')" href="../_functions/convert_to_array.html" onMouseOver="funcPopup(event,'convert_to_array')">convert_to_array</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>);
<a name="l8837"><span class="linenum">8837</span></a>          } else {
<a name="l8838"><span class="linenum">8838</span></a>  <span class="comment">            // Simple values are untouched.</span>
<a name="l8839"><span class="linenum">8839</span></a>              <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l8840"><span class="linenum">8840</span></a>          }
<a name="l8841"><span class="linenum">8841</span></a>      }
<a name="l8842"><span class="linenum">8842</span></a>      return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>;
<a name="l8843"><span class="linenum">8843</span></a>  }
<a name="l8844"><span class="linenum">8844</span></a>  
<a name="l8845"><span class="linenum">8845</span></a>  <span class="comment">/**</span>
<a name="l8846"><span class="linenum">8846</span></a>  <span class="comment"> * Detect a custom script replacement in the data directory that will</span>
<a name="l8847"><span class="linenum">8847</span></a>  <span class="comment"> * replace an existing moodle script</span>
<a name="l8848"><span class="linenum">8848</span></a>  <span class="comment"> *</span>
<a name="l8849"><span class="linenum">8849</span></a>  <span class="comment"> * @return string|bool full path name if a custom script exists, false if no custom script exists</span>
<a name="l8850"><span class="linenum">8850</span></a>  <span class="comment"> */</span>
<a name="l8851"><span class="linenum">8851</span></a>  function <a class="function" onClick="logFunction('custom_script_path')" href="../_functions/custom_script_path.html" onMouseOver="funcPopup(event,'custom_script_path')">custom_script_path</a>() {
<a name="l8852"><span class="linenum">8852</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it13253" onMouseOver="hilite(13253)" onMouseOut="lolite()" onClick="logVariable('SCRIPT')" href="../_variables/SCRIPT.html">$SCRIPT</a>;
<a name="l8853"><span class="linenum">8853</span></a>  
<a name="l8854"><span class="linenum">8854</span></a>      if (<a class="var it13253" onMouseOver="hilite(13253)" onMouseOut="lolite()" onClick="logVariable('SCRIPT')" href="../_variables/SCRIPT.html">$SCRIPT</a> === null) {
<a name="l8855"><span class="linenum">8855</span></a>  <span class="comment">        // Probably some weird external script.</span>
<a name="l8856"><span class="linenum">8856</span></a>          return false;
<a name="l8857"><span class="linenum">8857</span></a>      }
<a name="l8858"><span class="linenum">8858</span></a>  
<a name="l8859"><span class="linenum">8859</span></a>      <a class="var it6692" onMouseOver="hilite(6692)" onMouseOut="lolite()" onClick="logVariable('scriptpath')" href="../_variables/scriptpath.html">$scriptpath</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('customscripts')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/customscripts.html">customscripts</a> . <a class="var it13253" onMouseOver="hilite(13253)" onMouseOut="lolite()" onClick="logVariable('SCRIPT')" href="../_variables/SCRIPT.html">$SCRIPT</a>;
<a name="l8860"><span class="linenum">8860</span></a>  
<a name="l8861"><span class="linenum">8861</span></a>  <span class="comment">    // Check the custom script exists.</span>
<a name="l8862"><span class="linenum">8862</span></a>      if (<a class="phpfunction" onClick="logFunction('file_exists')" href="../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it6692" onMouseOver="hilite(6692)" onMouseOut="lolite()" onClick="logVariable('scriptpath')" href="../_variables/scriptpath.html">$scriptpath</a>) and <a class="phpfunction" onClick="logFunction('is_file')" href="../_functions/is_file.html" onMouseOver="phpfuncPopup(event,'is_file')">is_file</a>(<a class="var it6692" onMouseOver="hilite(6692)" onMouseOut="lolite()" onClick="logVariable('scriptpath')" href="../_variables/scriptpath.html">$scriptpath</a>)) {
<a name="l8863"><span class="linenum">8863</span></a>          return <a class="var it6692" onMouseOver="hilite(6692)" onMouseOut="lolite()" onClick="logVariable('scriptpath')" href="../_variables/scriptpath.html">$scriptpath</a>;
<a name="l8864"><span class="linenum">8864</span></a>      } else {
<a name="l8865"><span class="linenum">8865</span></a>          return false;
<a name="l8866"><span class="linenum">8866</span></a>      }
<a name="l8867"><span class="linenum">8867</span></a>  }
<a name="l8868"><span class="linenum">8868</span></a>  
<a name="l8869"><span class="linenum">8869</span></a>  <span class="comment">/**</span>
<a name="l8870"><span class="linenum">8870</span></a>  <span class="comment"> * Returns whether or not the user object is a remote MNET user. This function</span>
<a name="l8871"><span class="linenum">8871</span></a>  <span class="comment"> * is in moodlelib because it does not rely on loading any of the MNET code.</span>
<a name="l8872"><span class="linenum">8872</span></a>  <span class="comment"> *</span>
<a name="l8873"><span class="linenum">8873</span></a>  <span class="comment"> * @param object $user A valid user object</span>
<a name="l8874"><span class="linenum">8874</span></a>  <span class="comment"> * @return bool        True if the user is from a remote Moodle.</span>
<a name="l8875"><span class="linenum">8875</span></a>  <span class="comment"> */</span>
<a name="l8876"><span class="linenum">8876</span></a>  function <a class="function" onClick="logFunction('is_mnet_remote_user')" href="../_functions/is_mnet_remote_user.html" onMouseOver="funcPopup(event,'is_mnet_remote_user')">is_mnet_remote_user</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>) {
<a name="l8877"><span class="linenum">8877</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l8878"><span class="linenum">8878</span></a>  
<a name="l8879"><span class="linenum">8879</span></a>      if (!isset(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/mnet_localhost_id.html">mnet_localhost_id</a>)) {
<a name="l8880"><span class="linenum">8880</span></a>          include_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a> . '<a class="filename" href="../mnet/lib.php.html">/mnet/lib.php</a>');
<a name="l8881"><span class="linenum">8881</span></a>          <a class="var it496" onMouseOver="hilite(496)" onMouseOut="lolite()" onClick="logVariable('env')" href="../_variables/env.html">$env</a> = <span class="keyword">new </span><a class="class" onClick="logClass('mnet_environment')" href="../_classes/mnet_environment.html" onMouseOver="classPopup(event,'mnet_environment')">mnet_environment</a>();
<a name="l8882"><span class="linenum">8882</span></a>          <a class="var it496" onMouseOver="hilite(496)" onMouseOut="lolite()" onClick="logVariable('env')" href="../_variables/env.html">$env</a>-&gt;<a class="function" onClick="logFunction('init')" href="../_functions/init.html" onMouseOver="funcPopup(event,'init')">init</a>();
<a name="l8883"><span class="linenum">8883</span></a>          unset(<a class="var it496" onMouseOver="hilite(496)" onMouseOut="lolite()" onClick="logVariable('env')" href="../_variables/env.html">$env</a>);
<a name="l8884"><span class="linenum">8884</span></a>      }
<a name="l8885"><span class="linenum">8885</span></a>  
<a name="l8886"><span class="linenum">8886</span></a>      return (!empty(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/mnethostid.html">mnethostid</a>) &amp;&amp; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/mnethostid.html">mnethostid</a> != <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/mnet_localhost_id.html">mnet_localhost_id</a>);
<a name="l8887"><span class="linenum">8887</span></a>  }
<a name="l8888"><span class="linenum">8888</span></a>  
<a name="l8889"><span class="linenum">8889</span></a>  <span class="comment">/**</span>
<a name="l8890"><span class="linenum">8890</span></a>  <span class="comment"> * This function will search for browser prefereed languages, setting Moodle</span>
<a name="l8891"><span class="linenum">8891</span></a>  <span class="comment"> * to use the best one available if $SESSION-&gt;lang is undefined</span>
<a name="l8892"><span class="linenum">8892</span></a>  <span class="comment"> */</span>
<a name="l8893"><span class="linenum">8893</span></a>  function <a class="function" onClick="logFunction('setup_lang_from_browser')" href="../_functions/setup_lang_from_browser.html" onMouseOver="funcPopup(event,'setup_lang_from_browser')">setup_lang_from_browser</a>() {
<a name="l8894"><span class="linenum">8894</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>, <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>;
<a name="l8895"><span class="linenum">8895</span></a>  
<a name="l8896"><span class="linenum">8896</span></a>      if (!empty(<a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('lang')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>) or !empty(<a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('lang')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>) or empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('autolang')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/autolang.html">autolang</a>)) {
<a name="l8897"><span class="linenum">8897</span></a>  <span class="comment">        // Lang is defined in session or user profile, nothing to do.</span>
<a name="l8898"><span class="linenum">8898</span></a>          return;
<a name="l8899"><span class="linenum">8899</span></a>      }
<a name="l8900"><span class="linenum">8900</span></a>  
<a name="l8901"><span class="linenum">8901</span></a>      if (!isset(<a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['HTTP_ACCEPT_LANGUAGE'])) { // There isn't list of browser langs, nothing to do.
<a name="l8902"><span class="linenum">8902</span></a>          return;
<a name="l8903"><span class="linenum">8903</span></a>      }
<a name="l8904"><span class="linenum">8904</span></a>  
<a name="l8905"><span class="linenum">8905</span></a>  <span class="comment">    // Extract and clean langs from headers.</span>
<a name="l8906"><span class="linenum">8906</span></a>      <a class="var it13256" onMouseOver="hilite(13256)" onMouseOut="lolite()" onClick="logVariable('rawlangs')" href="../_variables/rawlangs.html">$rawlangs</a> = <a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['HTTP_ACCEPT_LANGUAGE'];
<a name="l8907"><span class="linenum">8907</span></a>      <a class="var it13256" onMouseOver="hilite(13256)" onMouseOut="lolite()" onClick="logVariable('rawlangs')" href="../_variables/rawlangs.html">$rawlangs</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('-', '_', <a class="var it13256" onMouseOver="hilite(13256)" onMouseOut="lolite()" onClick="logVariable('rawlangs')" href="../_variables/rawlangs.html">$rawlangs</a>);         <span class="comment">// We are using underscores.</span>
<a name="l8908"><span class="linenum">8908</span></a>      <a class="var it13256" onMouseOver="hilite(13256)" onMouseOut="lolite()" onClick="logVariable('rawlangs')" href="../_variables/rawlangs.html">$rawlangs</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(',', <a class="var it13256" onMouseOver="hilite(13256)" onMouseOut="lolite()" onClick="logVariable('rawlangs')" href="../_variables/rawlangs.html">$rawlangs</a>);                  <span class="comment">// Convert to array.</span>
<a name="l8909"><span class="linenum">8909</span></a>      <a class="var it4417" onMouseOver="hilite(4417)" onMouseOut="lolite()" onClick="logVariable('langs')" href="../_variables/langs.html">$langs</a> = array();
<a name="l8910"><span class="linenum">8910</span></a>  
<a name="l8911"><span class="linenum">8911</span></a>      <a class="var it2283" onMouseOver="hilite(2283)" onMouseOut="lolite()" onClick="logVariable('order')" href="../_variables/order.html">$order</a> = 1.0;
<a name="l8912"><span class="linenum">8912</span></a>      foreach (<a class="var it13256" onMouseOver="hilite(13256)" onMouseOut="lolite()" onClick="logVariable('rawlangs')" href="../_variables/rawlangs.html">$rawlangs</a> as <a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a>) {
<a name="l8913"><span class="linenum">8913</span></a>          if (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a>, ';') === false) {
<a name="l8914"><span class="linenum">8914</span></a>              <a class="var it4417" onMouseOver="hilite(4417)" onMouseOut="lolite()" onClick="logVariable('langs')" href="../_variables/langs.html">$langs</a>[(string)<a class="var it2283" onMouseOver="hilite(2283)" onMouseOut="lolite()" onClick="logVariable('order')" href="../_variables/order.html">$order</a>] = <a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a>;
<a name="l8915"><span class="linenum">8915</span></a>              <a class="var it2283" onMouseOver="hilite(2283)" onMouseOut="lolite()" onClick="logVariable('order')" href="../_variables/order.html">$order</a> = <a class="var it2283" onMouseOver="hilite(2283)" onMouseOut="lolite()" onClick="logVariable('order')" href="../_variables/order.html">$order</a>-0.01;
<a name="l8916"><span class="linenum">8916</span></a>          } else {
<a name="l8917"><span class="linenum">8917</span></a>              <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(';', <a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a>);
<a name="l8918"><span class="linenum">8918</span></a>              <a class="var it3230" onMouseOver="hilite(3230)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../_variables/pos.html">$pos</a> = <a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>[1], '=');
<a name="l8919"><span class="linenum">8919</span></a>              <a class="var it4417" onMouseOver="hilite(4417)" onMouseOut="lolite()" onClick="logVariable('langs')" href="../_variables/langs.html">$langs</a>[<a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>[1], <a class="var it3230" onMouseOver="hilite(3230)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../_variables/pos.html">$pos</a>+1)] = <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../_variables/parts.html">$parts</a>[0];
<a name="l8920"><span class="linenum">8920</span></a>          }
<a name="l8921"><span class="linenum">8921</span></a>      }
<a name="l8922"><span class="linenum">8922</span></a>      <a class="phpfunction" onClick="logFunction('krsort')" href="../_functions/krsort.html" onMouseOver="phpfuncPopup(event,'krsort')">krsort</a>(<a class="var it4417" onMouseOver="hilite(4417)" onMouseOut="lolite()" onClick="logVariable('langs')" href="../_variables/langs.html">$langs</a>, SORT_NUMERIC);
<a name="l8923"><span class="linenum">8923</span></a>  
<a name="l8924"><span class="linenum">8924</span></a>  <span class="comment">    // Look for such langs under standard locations.</span>
<a name="l8925"><span class="linenum">8925</span></a>      foreach (<a class="var it4417" onMouseOver="hilite(4417)" onMouseOut="lolite()" onClick="logVariable('langs')" href="../_variables/langs.html">$langs</a> as <a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a>) {
<a name="l8926"><span class="linenum">8926</span></a>  <span class="comment">        // Clean it properly for include.</span>
<a name="l8927"><span class="linenum">8927</span></a>          <a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a> = <a class="phpfunction" onClick="logFunction('strtolower')" href="../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a>, <a class="constant" onClick="logConstant('PARAM_SAFEDIR')" href="../_constants/PARAM_SAFEDIR.html" onMouseOver="constPopup(event,'PARAM_SAFEDIR')">PARAM_SAFEDIR</a>));
<a name="l8928"><span class="linenum">8928</span></a>          if (<a class="function" onClick="logFunction('get_string_manager')" href="../_functions/get_string_manager.html" onMouseOver="funcPopup(event,'get_string_manager')">get_string_manager</a>()-&gt;<a class="function" onClick="logFunction('translation_exists')" href="../_functions/translation_exists.html" onMouseOver="funcPopup(event,'translation_exists')">translation_exists</a>(<a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a>, false)) {
<a name="l8929"><span class="linenum">8929</span></a>  <span class="comment">            // Lang exists, set it in session.</span>
<a name="l8930"><span class="linenum">8930</span></a>              <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('lang')" class="var it39589" onMouseOver="hilite(39589)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a> = <a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a>;
<a name="l8931"><span class="linenum">8931</span></a>  <span class="comment">            // We have finished. Go out.</span>
<a name="l8932"><span class="linenum">8932</span></a>              break;
<a name="l8933"><span class="linenum">8933</span></a>          }
<a name="l8934"><span class="linenum">8934</span></a>      }
<a name="l8935"><span class="linenum">8935</span></a>      return;
<a name="l8936"><span class="linenum">8936</span></a>  }
<a name="l8937"><span class="linenum">8937</span></a>  
<a name="l8938"><span class="linenum">8938</span></a>  <span class="comment">/**</span>
<a name="l8939"><span class="linenum">8939</span></a>  <span class="comment"> * Check if $url matches anything in proxybypass list</span>
<a name="l8940"><span class="linenum">8940</span></a>  <span class="comment"> *</span>
<a name="l8941"><span class="linenum">8941</span></a>  <span class="comment"> * Any errors just result in the proxy being used (least bad)</span>
<a name="l8942"><span class="linenum">8942</span></a>  <span class="comment"> *</span>
<a name="l8943"><span class="linenum">8943</span></a>  <span class="comment"> * @param string $url url to check</span>
<a name="l8944"><span class="linenum">8944</span></a>  <span class="comment"> * @return boolean true if we should bypass the proxy</span>
<a name="l8945"><span class="linenum">8945</span></a>  <span class="comment"> */</span>
<a name="l8946"><span class="linenum">8946</span></a>  function <a class="function" onClick="logFunction('is_proxybypass')" href="../_functions/is_proxybypass.html" onMouseOver="funcPopup(event,'is_proxybypass')">is_proxybypass</a>( <a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('url')" href="../_variables/url.html">$url</a> ) {
<a name="l8947"><span class="linenum">8947</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l8948"><span class="linenum">8948</span></a>  
<a name="l8949"><span class="linenum">8949</span></a>  <span class="comment">    // Sanity check.</span>
<a name="l8950"><span class="linenum">8950</span></a>      if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('proxyhost')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/proxyhost.html">proxyhost</a>) or empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('proxybypass')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/proxybypass.html">proxybypass</a>)) {
<a name="l8951"><span class="linenum">8951</span></a>          return false;
<a name="l8952"><span class="linenum">8952</span></a>      }
<a name="l8953"><span class="linenum">8953</span></a>  
<a name="l8954"><span class="linenum">8954</span></a>  <span class="comment">    // Get the host part out of the url.</span>
<a name="l8955"><span class="linenum">8955</span></a>      if (!<a class="var it100" onMouseOver="hilite(100)" onMouseOut="lolite()" onClick="logVariable('host')" href="../_variables/host.html">$host</a> = <a class="phpfunction" onClick="logFunction('parse_url')" href="../_functions/parse_url.html" onMouseOver="phpfuncPopup(event,'parse_url')">parse_url</a>( <a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('url')" href="../_variables/url.html">$url</a>, PHP_URL_HOST )) {
<a name="l8956"><span class="linenum">8956</span></a>          return false;
<a name="l8957"><span class="linenum">8957</span></a>      }
<a name="l8958"><span class="linenum">8958</span></a>  
<a name="l8959"><span class="linenum">8959</span></a>  <span class="comment">    // Get the possible bypass hosts into an array.</span>
<a name="l8960"><span class="linenum">8960</span></a>      <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>( ',', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('proxybypass')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/proxybypass.html">proxybypass</a> );
<a name="l8961"><span class="linenum">8961</span></a>  
<a name="l8962"><span class="linenum">8962</span></a>  <span class="comment">    // Check for a match.</span>
<a name="l8963"><span class="linenum">8963</span></a>  <span class="comment">    // (IPs need to match the left hand side and hosts the right of the url,</span>
<a name="l8964"><span class="linenum">8964</span></a>  <span class="comment">    // but we can recklessly check both as there can't be a false +ve).</span>
<a name="l8965"><span class="linenum">8965</span></a>      foreach (<a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a> as <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a>) {
<a name="l8966"><span class="linenum">8966</span></a>          <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a>);
<a name="l8967"><span class="linenum">8967</span></a>  
<a name="l8968"><span class="linenum">8968</span></a>  <span class="comment">        // Try for IP match (Left side).</span>
<a name="l8969"><span class="linenum">8969</span></a>          <a class="var it13259" onMouseOver="hilite(13259)" onMouseOut="lolite()" onClick="logVariable('lhs')" href="../_variables/lhs.html">$lhs</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it100" onMouseOver="hilite(100)" onMouseOut="lolite()" onClick="logVariable('host')" href="../_variables/host.html">$host</a>, 0, <a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a>));
<a name="l8970"><span class="linenum">8970</span></a>          if (<a class="phpfunction" onClick="logFunction('strcasecmp')" href="../_functions/strcasecmp.html" onMouseOver="phpfuncPopup(event,'strcasecmp')">strcasecmp</a>(<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a>, <a class="var it13259" onMouseOver="hilite(13259)" onMouseOut="lolite()" onClick="logVariable('lhs')" href="../_variables/lhs.html">$lhs</a>)==0) {
<a name="l8971"><span class="linenum">8971</span></a>              return true;
<a name="l8972"><span class="linenum">8972</span></a>          }
<a name="l8973"><span class="linenum">8973</span></a>  
<a name="l8974"><span class="linenum">8974</span></a>  <span class="comment">        // Try for host match (Right side).</span>
<a name="l8975"><span class="linenum">8975</span></a>          <a class="var it13260" onMouseOver="hilite(13260)" onMouseOut="lolite()" onClick="logVariable('rhs')" href="../_variables/rhs.html">$rhs</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it100" onMouseOver="hilite(100)" onMouseOut="lolite()" onClick="logVariable('host')" href="../_variables/host.html">$host</a>, -<a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a>));
<a name="l8976"><span class="linenum">8976</span></a>          if (<a class="phpfunction" onClick="logFunction('strcasecmp')" href="../_functions/strcasecmp.html" onMouseOver="phpfuncPopup(event,'strcasecmp')">strcasecmp</a>(<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('match')" href="../_variables/match.html">$match</a>, <a class="var it13260" onMouseOver="hilite(13260)" onMouseOut="lolite()" onClick="logVariable('rhs')" href="../_variables/rhs.html">$rhs</a>)==0) {
<a name="l8977"><span class="linenum">8977</span></a>              return true;
<a name="l8978"><span class="linenum">8978</span></a>          }
<a name="l8979"><span class="linenum">8979</span></a>      }
<a name="l8980"><span class="linenum">8980</span></a>  
<a name="l8981"><span class="linenum">8981</span></a>  <span class="comment">    // Nothing matched.</span>
<a name="l8982"><span class="linenum">8982</span></a>      return false;
<a name="l8983"><span class="linenum">8983</span></a>  }
<a name="l8984"><span class="linenum">8984</span></a>  
<a name="l8985"><span class="linenum">8985</span></a>  <span class="comment">/**</span>
<a name="l8986"><span class="linenum">8986</span></a>  <span class="comment"> * Check if the passed navigation is of the new style</span>
<a name="l8987"><span class="linenum">8987</span></a>  <span class="comment"> *</span>
<a name="l8988"><span class="linenum">8988</span></a>  <span class="comment"> * @param mixed $navigation</span>
<a name="l8989"><span class="linenum">8989</span></a>  <span class="comment"> * @return bool true for yes false for no</span>
<a name="l8990"><span class="linenum">8990</span></a>  <span class="comment"> */</span>
<a name="l8991"><span class="linenum">8991</span></a>  function <a class="function" onClick="logFunction('is_newnav')" href="../_functions/is_newnav.html" onMouseOver="funcPopup(event,'is_newnav')">is_newnav</a>(<a class="var it1513" onMouseOver="hilite(1513)" onMouseOut="lolite()" onClick="logVariable('navigation')" href="../_variables/navigation.html">$navigation</a>) {
<a name="l8992"><span class="linenum">8992</span></a>      if (<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it1513" onMouseOver="hilite(1513)" onMouseOut="lolite()" onClick="logVariable('navigation')" href="../_variables/navigation.html">$navigation</a>) &amp;&amp; !empty(<a class="var it1513" onMouseOver="hilite(1513)" onMouseOut="lolite()" onClick="logVariable('navigation')" href="../_variables/navigation.html">$navigation</a>['newnav'])) {
<a name="l8993"><span class="linenum">8993</span></a>          return true;
<a name="l8994"><span class="linenum">8994</span></a>      } else {
<a name="l8995"><span class="linenum">8995</span></a>          return false;
<a name="l8996"><span class="linenum">8996</span></a>      }
<a name="l8997"><span class="linenum">8997</span></a>  }
<a name="l8998"><span class="linenum">8998</span></a>  
<a name="l8999"><span class="linenum">8999</span></a>  <span class="comment">/**</span>
<a name="l9000"><span class="linenum">9000</span></a>  <span class="comment"> * Checks whether the given variable name is defined as a variable within the given object.</span>
<a name="l9001"><span class="linenum">9001</span></a>  <span class="comment"> *</span>
<a name="l9002"><span class="linenum">9002</span></a>  <span class="comment"> * This will NOT work with stdClass objects, which have no class variables.</span>
<a name="l9003"><span class="linenum">9003</span></a>  <span class="comment"> *</span>
<a name="l9004"><span class="linenum">9004</span></a>  <span class="comment"> * @param string $var The variable name</span>
<a name="l9005"><span class="linenum">9005</span></a>  <span class="comment"> * @param object $object The object to check</span>
<a name="l9006"><span class="linenum">9006</span></a>  <span class="comment"> * @return boolean</span>
<a name="l9007"><span class="linenum">9007</span></a>  <span class="comment"> */</span>
<a name="l9008"><span class="linenum">9008</span></a>  function <a class="function" onClick="logFunction('in_object_vars')" href="../_functions/in_object_vars.html" onMouseOver="funcPopup(event,'in_object_vars')">in_object_vars</a>(<a class="var it3053" onMouseOver="hilite(3053)" onMouseOut="lolite()" onClick="logVariable('var')" href="../_variables/var.html">$var</a>, <a class="var it3210" onMouseOver="hilite(3210)" onMouseOut="lolite()" onClick="logVariable('object')" href="../_variables/object.html">$object</a>) {
<a name="l9009"><span class="linenum">9009</span></a>      <a class="var it3050" onMouseOver="hilite(3050)" onMouseOut="lolite()" onClick="logVariable('classvars')" href="../_variables/classvars.html">$classvars</a> = <a class="phpfunction" onClick="logFunction('get_class_vars')" href="../_functions/get_class_vars.html" onMouseOver="phpfuncPopup(event,'get_class_vars')">get_class_vars</a>(<a class="phpfunction" onClick="logFunction('get_class')" href="../_functions/get_class.html" onMouseOver="phpfuncPopup(event,'get_class')">get_class</a>(<a class="var it3210" onMouseOver="hilite(3210)" onMouseOut="lolite()" onClick="logVariable('object')" href="../_variables/object.html">$object</a>));
<a name="l9010"><span class="linenum">9010</span></a>      <a class="var it3050" onMouseOver="hilite(3050)" onMouseOut="lolite()" onClick="logVariable('classvars')" href="../_variables/classvars.html">$classvars</a> = <a class="phpfunction" onClick="logFunction('array_keys')" href="../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it3050" onMouseOver="hilite(3050)" onMouseOut="lolite()" onClick="logVariable('classvars')" href="../_variables/classvars.html">$classvars</a>);
<a name="l9011"><span class="linenum">9011</span></a>      return <a class="phpfunction" onClick="logFunction('in_array')" href="../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it3053" onMouseOver="hilite(3053)" onMouseOut="lolite()" onClick="logVariable('var')" href="../_variables/var.html">$var</a>, <a class="var it3050" onMouseOver="hilite(3050)" onMouseOut="lolite()" onClick="logVariable('classvars')" href="../_variables/classvars.html">$classvars</a>);
<a name="l9012"><span class="linenum">9012</span></a>  }
<a name="l9013"><span class="linenum">9013</span></a>  
<a name="l9014"><span class="linenum">9014</span></a>  <span class="comment">/**</span>
<a name="l9015"><span class="linenum">9015</span></a>  <span class="comment"> * Returns an array without repeated objects.</span>
<a name="l9016"><span class="linenum">9016</span></a>  <span class="comment"> * This function is similar to array_unique, but for arrays that have objects as values</span>
<a name="l9017"><span class="linenum">9017</span></a>  <span class="comment"> *</span>
<a name="l9018"><span class="linenum">9018</span></a>  <span class="comment"> * @param array $array</span>
<a name="l9019"><span class="linenum">9019</span></a>  <span class="comment"> * @param bool $keepkeyassoc</span>
<a name="l9020"><span class="linenum">9020</span></a>  <span class="comment"> * @return array</span>
<a name="l9021"><span class="linenum">9021</span></a>  <span class="comment"> */</span>
<a name="l9022"><span class="linenum">9022</span></a>  function <a class="function" onClick="logFunction('object_array_unique')" href="../_functions/object_array_unique.html" onMouseOver="funcPopup(event,'object_array_unique')">object_array_unique</a>(<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a>, <a class="var it13261" onMouseOver="hilite(13261)" onMouseOut="lolite()" onClick="logVariable('keepkeyassoc')" href="../_variables/keepkeyassoc.html">$keepkeyassoc</a> = true) {
<a name="l9023"><span class="linenum">9023</span></a>      <a class="var it13262" onMouseOver="hilite(13262)" onMouseOut="lolite()" onClick="logVariable('duplicatekeys')" href="../_variables/duplicatekeys.html">$duplicatekeys</a> = array();
<a name="l9024"><span class="linenum">9024</span></a>      <a class="var it3524" onMouseOver="hilite(3524)" onMouseOut="lolite()" onClick="logVariable('tmp')" href="../_variables/tmp.html">$tmp</a>         = array();
<a name="l9025"><span class="linenum">9025</span></a>  
<a name="l9026"><span class="linenum">9026</span></a>      foreach (<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it1140" onMouseOver="hilite(1140)" onMouseOut="lolite()" onClick="logVariable('val')" href="../_variables/val.html">$val</a>) {
<a name="l9027"><span class="linenum">9027</span></a>  <span class="comment">        // Convert objects to arrays, in_array() does not support objects.</span>
<a name="l9028"><span class="linenum">9028</span></a>          if (<a class="phpfunction" onClick="logFunction('is_object')" href="../_functions/is_object.html" onMouseOver="phpfuncPopup(event,'is_object')">is_object</a>(<a class="var it1140" onMouseOver="hilite(1140)" onMouseOut="lolite()" onClick="logVariable('val')" href="../_variables/val.html">$val</a>)) {
<a name="l9029"><span class="linenum">9029</span></a>              <a class="var it1140" onMouseOver="hilite(1140)" onMouseOut="lolite()" onClick="logVariable('val')" href="../_variables/val.html">$val</a> = (array)<a class="var it1140" onMouseOver="hilite(1140)" onMouseOut="lolite()" onClick="logVariable('val')" href="../_variables/val.html">$val</a>;
<a name="l9030"><span class="linenum">9030</span></a>          }
<a name="l9031"><span class="linenum">9031</span></a>  
<a name="l9032"><span class="linenum">9032</span></a>          if (!<a class="phpfunction" onClick="logFunction('in_array')" href="../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it1140" onMouseOver="hilite(1140)" onMouseOut="lolite()" onClick="logVariable('val')" href="../_variables/val.html">$val</a>, <a class="var it3524" onMouseOver="hilite(3524)" onMouseOut="lolite()" onClick="logVariable('tmp')" href="../_variables/tmp.html">$tmp</a>)) {
<a name="l9033"><span class="linenum">9033</span></a>              <a class="var it3524" onMouseOver="hilite(3524)" onMouseOut="lolite()" onClick="logVariable('tmp')" href="../_variables/tmp.html">$tmp</a>[] = <a class="var it1140" onMouseOver="hilite(1140)" onMouseOut="lolite()" onClick="logVariable('val')" href="../_variables/val.html">$val</a>;
<a name="l9034"><span class="linenum">9034</span></a>          } else {
<a name="l9035"><span class="linenum">9035</span></a>              <a class="var it13262" onMouseOver="hilite(13262)" onMouseOut="lolite()" onClick="logVariable('duplicatekeys')" href="../_variables/duplicatekeys.html">$duplicatekeys</a>[] = <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>;
<a name="l9036"><span class="linenum">9036</span></a>          }
<a name="l9037"><span class="linenum">9037</span></a>      }
<a name="l9038"><span class="linenum">9038</span></a>  
<a name="l9039"><span class="linenum">9039</span></a>      foreach (<a class="var it13262" onMouseOver="hilite(13262)" onMouseOut="lolite()" onClick="logVariable('duplicatekeys')" href="../_variables/duplicatekeys.html">$duplicatekeys</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>) {
<a name="l9040"><span class="linenum">9040</span></a>          unset(<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>]);
<a name="l9041"><span class="linenum">9041</span></a>      }
<a name="l9042"><span class="linenum">9042</span></a>  
<a name="l9043"><span class="linenum">9043</span></a>      return <a class="var it13261" onMouseOver="hilite(13261)" onMouseOut="lolite()" onClick="logVariable('keepkeyassoc')" href="../_variables/keepkeyassoc.html">$keepkeyassoc</a> ? <a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a> : <a class="phpfunction" onClick="logFunction('array_values')" href="../_functions/array_values.html" onMouseOver="phpfuncPopup(event,'array_values')">array_values</a>(<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('array')" href="../_variables/array.html">$array</a>);
<a name="l9044"><span class="linenum">9044</span></a>  }
<a name="l9045"><span class="linenum">9045</span></a>  
<a name="l9046"><span class="linenum">9046</span></a>  <span class="comment">/**</span>
<a name="l9047"><span class="linenum">9047</span></a>  <span class="comment"> * Is a userid the primary administrator?</span>
<a name="l9048"><span class="linenum">9048</span></a>  <span class="comment"> *</span>
<a name="l9049"><span class="linenum">9049</span></a>  <span class="comment"> * @param int $userid int id of user to check</span>
<a name="l9050"><span class="linenum">9050</span></a>  <span class="comment"> * @return boolean</span>
<a name="l9051"><span class="linenum">9051</span></a>  <span class="comment"> */</span>
<a name="l9052"><span class="linenum">9052</span></a>  function <a class="function" onClick="logFunction('is_primary_admin')" href="../_functions/is_primary_admin.html" onMouseOver="funcPopup(event,'is_primary_admin')">is_primary_admin</a>(<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>) {
<a name="l9053"><span class="linenum">9053</span></a>      <a class="var it13263" onMouseOver="hilite(13263)" onMouseOut="lolite()" onClick="logVariable('primaryadmin')" href="../_variables/primaryadmin.html">$primaryadmin</a> =  <a class="function" onClick="logFunction('get_admin')" href="../_functions/get_admin.html" onMouseOver="funcPopup(event,'get_admin')">get_admin</a>();
<a name="l9054"><span class="linenum">9054</span></a>  
<a name="l9055"><span class="linenum">9055</span></a>      if (<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a> == <a class="var it13263" onMouseOver="hilite(13263)" onMouseOut="lolite()" onClick="logVariable('primaryadmin')" href="../_variables/primaryadmin.html">$primaryadmin</a>-&gt;<a onClick="logVariable('id')" class="var it41080" onMouseOver="hilite(41080)" onMouseOut="lolite()" href="../_variables/id.html">id</a>) {
<a name="l9056"><span class="linenum">9056</span></a>          return true;
<a name="l9057"><span class="linenum">9057</span></a>      } else {
<a name="l9058"><span class="linenum">9058</span></a>          return false;
<a name="l9059"><span class="linenum">9059</span></a>      }
<a name="l9060"><span class="linenum">9060</span></a>  }
<a name="l9061"><span class="linenum">9061</span></a>  
<a name="l9062"><span class="linenum">9062</span></a>  <span class="comment">/**</span>
<a name="l9063"><span class="linenum">9063</span></a>  <span class="comment"> * Returns the site identifier</span>
<a name="l9064"><span class="linenum">9064</span></a>  <span class="comment"> *</span>
<a name="l9065"><span class="linenum">9065</span></a>  <span class="comment"> * @return string $CFG-&gt;siteidentifier, first making sure it is properly initialised.</span>
<a name="l9066"><span class="linenum">9066</span></a>  <span class="comment"> */</span>
<a name="l9067"><span class="linenum">9067</span></a>  function <a class="function" onClick="logFunction('get_site_identifier')" href="../_functions/get_site_identifier.html" onMouseOver="funcPopup(event,'get_site_identifier')">get_site_identifier</a>() {
<a name="l9068"><span class="linenum">9068</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l9069"><span class="linenum">9069</span></a>  <span class="comment">    // Check to see if it is missing. If so, initialise it.</span>
<a name="l9070"><span class="linenum">9070</span></a>      if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('siteidentifier')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/siteidentifier.html">siteidentifier</a>)) {
<a name="l9071"><span class="linenum">9071</span></a>          <a class="function" onClick="logFunction('set_config')" href="../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('siteidentifier', <a class="function" onClick="logFunction('random_string')" href="../_functions/random_string.html" onMouseOver="funcPopup(event,'random_string')">random_string</a>(32) . <a class="var it74" onMouseOver="hilite(74)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['HTTP_HOST']);
<a name="l9072"><span class="linenum">9072</span></a>      }
<a name="l9073"><span class="linenum">9073</span></a>  <span class="comment">    // Return it.</span>
<a name="l9074"><span class="linenum">9074</span></a>      return <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('siteidentifier')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/siteidentifier.html">siteidentifier</a>;
<a name="l9075"><span class="linenum">9075</span></a>  }
<a name="l9076"><span class="linenum">9076</span></a>  
<a name="l9077"><span class="linenum">9077</span></a>  <span class="comment">/**</span>
<a name="l9078"><span class="linenum">9078</span></a>  <span class="comment"> * Check whether the given password has no more than the specified</span>
<a name="l9079"><span class="linenum">9079</span></a>  <span class="comment"> * number of consecutive identical characters.</span>
<a name="l9080"><span class="linenum">9080</span></a>  <span class="comment"> *</span>
<a name="l9081"><span class="linenum">9081</span></a>  <span class="comment"> * @param string $password   password to be checked against the password policy</span>
<a name="l9082"><span class="linenum">9082</span></a>  <span class="comment"> * @param integer $maxchars  maximum number of consecutive identical characters</span>
<a name="l9083"><span class="linenum">9083</span></a>  <span class="comment"> * @return bool</span>
<a name="l9084"><span class="linenum">9084</span></a>  <span class="comment"> */</span>
<a name="l9085"><span class="linenum">9085</span></a>  function <a class="function" onClick="logFunction('check_consecutive_identical_characters')" href="../_functions/check_consecutive_identical_characters.html" onMouseOver="funcPopup(event,'check_consecutive_identical_characters')">check_consecutive_identical_characters</a>(<a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>, <a class="var it13264" onMouseOver="hilite(13264)" onMouseOut="lolite()" onClick="logVariable('maxchars')" href="../_variables/maxchars.html">$maxchars</a>) {
<a name="l9086"><span class="linenum">9086</span></a>  
<a name="l9087"><span class="linenum">9087</span></a>      if (<a class="var it13264" onMouseOver="hilite(13264)" onMouseOut="lolite()" onClick="logVariable('maxchars')" href="../_variables/maxchars.html">$maxchars</a> &lt; 1) {
<a name="l9088"><span class="linenum">9088</span></a>          return true; <span class="comment">// Zero 0 is to disable this check.</span>
<a name="l9089"><span class="linenum">9089</span></a>      }
<a name="l9090"><span class="linenum">9090</span></a>      if (<a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>) &lt;= <a class="var it13264" onMouseOver="hilite(13264)" onMouseOut="lolite()" onClick="logVariable('maxchars')" href="../_variables/maxchars.html">$maxchars</a>) {
<a name="l9091"><span class="linenum">9091</span></a>          return true; <span class="comment">// Too short to fail this test.</span>
<a name="l9092"><span class="linenum">9092</span></a>      }
<a name="l9093"><span class="linenum">9093</span></a>  
<a name="l9094"><span class="linenum">9094</span></a>      <a class="var it13265" onMouseOver="hilite(13265)" onMouseOut="lolite()" onClick="logVariable('previouschar')" href="../_variables/previouschar.html">$previouschar</a> = '';
<a name="l9095"><span class="linenum">9095</span></a>      <a class="var it13266" onMouseOver="hilite(13266)" onMouseOut="lolite()" onClick="logVariable('consecutivecount')" href="../_variables/consecutivecount.html">$consecutivecount</a> = 1;
<a name="l9096"><span class="linenum">9096</span></a>      foreach (<a class="phpfunction" onClick="logFunction('str_split')" href="../_functions/str_split.html" onMouseOver="phpfuncPopup(event,'str_split')">str_split</a>(<a class="var it2550" onMouseOver="hilite(2550)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>) as <a class="var it2425" onMouseOver="hilite(2425)" onMouseOut="lolite()" onClick="logVariable('char')" href="../_variables/char.html">$char</a>) {
<a name="l9097"><span class="linenum">9097</span></a>          if (<a class="var it2425" onMouseOver="hilite(2425)" onMouseOut="lolite()" onClick="logVariable('char')" href="../_variables/char.html">$char</a> != <a class="var it13265" onMouseOver="hilite(13265)" onMouseOut="lolite()" onClick="logVariable('previouschar')" href="../_variables/previouschar.html">$previouschar</a>) {
<a name="l9098"><span class="linenum">9098</span></a>              <a class="var it13266" onMouseOver="hilite(13266)" onMouseOut="lolite()" onClick="logVariable('consecutivecount')" href="../_variables/consecutivecount.html">$consecutivecount</a> = 1;
<a name="l9099"><span class="linenum">9099</span></a>          } else {
<a name="l9100"><span class="linenum">9100</span></a>              <a class="var it13266" onMouseOver="hilite(13266)" onMouseOut="lolite()" onClick="logVariable('consecutivecount')" href="../_variables/consecutivecount.html">$consecutivecount</a>++;
<a name="l9101"><span class="linenum">9101</span></a>              if (<a class="var it13266" onMouseOver="hilite(13266)" onMouseOut="lolite()" onClick="logVariable('consecutivecount')" href="../_variables/consecutivecount.html">$consecutivecount</a> &gt; <a class="var it13264" onMouseOver="hilite(13264)" onMouseOut="lolite()" onClick="logVariable('maxchars')" href="../_variables/maxchars.html">$maxchars</a>) {
<a name="l9102"><span class="linenum">9102</span></a>                  return false; <span class="comment">// Check failed already.</span>
<a name="l9103"><span class="linenum">9103</span></a>              }
<a name="l9104"><span class="linenum">9104</span></a>          }
<a name="l9105"><span class="linenum">9105</span></a>  
<a name="l9106"><span class="linenum">9106</span></a>          <a class="var it13265" onMouseOver="hilite(13265)" onMouseOut="lolite()" onClick="logVariable('previouschar')" href="../_variables/previouschar.html">$previouschar</a> = <a class="var it2425" onMouseOver="hilite(2425)" onMouseOut="lolite()" onClick="logVariable('char')" href="../_variables/char.html">$char</a>;
<a name="l9107"><span class="linenum">9107</span></a>      }
<a name="l9108"><span class="linenum">9108</span></a>  
<a name="l9109"><span class="linenum">9109</span></a>      return true;
<a name="l9110"><span class="linenum">9110</span></a>  }
<a name="l9111"><span class="linenum">9111</span></a>  
<a name="l9112"><span class="linenum">9112</span></a>  <span class="comment">/**</span>
<a name="l9113"><span class="linenum">9113</span></a>  <span class="comment"> * Helper function to do partial function binding.</span>
<a name="l9114"><span class="linenum">9114</span></a>  <span class="comment"> * so we can use it for preg_replace_callback, for example</span>
<a name="l9115"><span class="linenum">9115</span></a>  <span class="comment"> * this works with php functions, user functions, static methods and class methods</span>
<a name="l9116"><span class="linenum">9116</span></a>  <span class="comment"> * it returns you a callback that you can pass on like so:</span>
<a name="l9117"><span class="linenum">9117</span></a>  <span class="comment"> *</span>
<a name="l9118"><span class="linenum">9118</span></a>  <span class="comment"> * $callback = partial('somefunction', $arg1, $arg2);</span>
<a name="l9119"><span class="linenum">9119</span></a>  <span class="comment"> *     or</span>
<a name="l9120"><span class="linenum">9120</span></a>  <span class="comment"> * $callback = partial(array('someclass', 'somestaticmethod'), $arg1, $arg2);</span>
<a name="l9121"><span class="linenum">9121</span></a>  <span class="comment"> *     or even</span>
<a name="l9122"><span class="linenum">9122</span></a>  <span class="comment"> * $obj = new someclass();</span>
<a name="l9123"><span class="linenum">9123</span></a>  <span class="comment"> * $callback = partial(array($obj, 'somemethod'), $arg1, $arg2);</span>
<a name="l9124"><span class="linenum">9124</span></a>  <span class="comment"> *</span>
<a name="l9125"><span class="linenum">9125</span></a>  <span class="comment"> * and then the arguments that are passed through at calltime are appended to the argument list.</span>
<a name="l9126"><span class="linenum">9126</span></a>  <span class="comment"> *</span>
<a name="l9127"><span class="linenum">9127</span></a>  <span class="comment"> * @param mixed $function a php callback</span>
<a name="l9128"><span class="linenum">9128</span></a>  <span class="comment"> * @param mixed $arg1,... $argv arguments to partially bind with</span>
<a name="l9129"><span class="linenum">9129</span></a>  <span class="comment"> * @return array Array callback</span>
<a name="l9130"><span class="linenum">9130</span></a>  <span class="comment"> */</span>
<a name="l9131"><span class="linenum">9131</span></a>  function <a class="function" onClick="logFunction('partial')" href="../_functions/partial.html" onMouseOver="funcPopup(event,'partial')">partial</a>() {
<a name="l9132"><span class="linenum">9132</span></a>      if (!<a class="phpfunction" onClick="logFunction('class_exists')" href="../_functions/class_exists.html" onMouseOver="phpfuncPopup(event,'class_exists')">class_exists</a>('partial')) {
<a name="l9133"><span class="linenum">9133</span></a>          <span class="comment">/**</span>
<a name="l9134"><span class="linenum">9134</span></a>  <span class="comment">         * Used to manage function binding.</span>
<a name="l9135"><span class="linenum">9135</span></a>  <span class="comment">         * @copyright  2009 Penny Leach</span>
<a name="l9136"><span class="linenum">9136</span></a>  <span class="comment">         * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l9137"><span class="linenum">9137</span></a>  <span class="comment">         */</span>
<a name="l9138"><span class="linenum">9138</span></a>          <span class="keyword">class </span><a class="class" onClick="logClass('partial')" href="../_classes/partial.html" onMouseOver="classPopup(event,'partial')">partial</a>{
<a name="l9139"><span class="linenum">9139</span></a>  <span class="comment">            /** @var array */</span>
<a name="l9140"><span class="linenum">9140</span></a>              public <a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../_variables/values.html">$values</a> = array();
<a name="l9141"><span class="linenum">9141</span></a>  <span class="comment">            /** @var string The function to call as a callback. */</span>
<a name="l9142"><span class="linenum">9142</span></a>              public <a class="var it1345" onMouseOver="hilite(1345)" onMouseOut="lolite()" onClick="logVariable('func')" href="../_variables/func.html">$func</a>;
<a name="l9143"><span class="linenum">9143</span></a>              <span class="comment">/**</span>
<a name="l9144"><span class="linenum">9144</span></a>  <span class="comment">             * Constructor</span>
<a name="l9145"><span class="linenum">9145</span></a>  <span class="comment">             * @param string $func</span>
<a name="l9146"><span class="linenum">9146</span></a>  <span class="comment">             * @param array $args</span>
<a name="l9147"><span class="linenum">9147</span></a>  <span class="comment">             */</span>
<a name="l9148"><span class="linenum">9148</span></a>              public function <a class="function" onClick="logFunction('__construct')" href="../_functions/__construct.html" onMouseOver="funcPopup(event,'__construct')">__construct</a>(<a class="var it1345" onMouseOver="hilite(1345)" onMouseOut="lolite()" onClick="logVariable('func')" href="../_variables/func.html">$func</a>, <a class="var it626" onMouseOver="hilite(626)" onMouseOut="lolite()" onClick="logVariable('args')" href="../_variables/args.html">$args</a>) {
<a name="l9149"><span class="linenum">9149</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('values')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/values.html">values</a> = <a class="var it626" onMouseOver="hilite(626)" onMouseOut="lolite()" onClick="logVariable('args')" href="../_variables/args.html">$args</a>;
<a name="l9150"><span class="linenum">9150</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('func')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/func.html">func</a> = <a class="var it1345" onMouseOver="hilite(1345)" onMouseOut="lolite()" onClick="logVariable('func')" href="../_variables/func.html">$func</a>;
<a name="l9151"><span class="linenum">9151</span></a>              }
<a name="l9152"><span class="linenum">9152</span></a>              <span class="comment">/**</span>
<a name="l9153"><span class="linenum">9153</span></a>  <span class="comment">             * Calls the callback function.</span>
<a name="l9154"><span class="linenum">9154</span></a>  <span class="comment">             * @return mixed</span>
<a name="l9155"><span class="linenum">9155</span></a>  <span class="comment">             */</span>
<a name="l9156"><span class="linenum">9156</span></a>              public function <a class="function" onClick="logFunction('method')" href="../_functions/method.html" onMouseOver="funcPopup(event,'method')">method</a>() {
<a name="l9157"><span class="linenum">9157</span></a>                  <a class="var it626" onMouseOver="hilite(626)" onMouseOut="lolite()" onClick="logVariable('args')" href="../_variables/args.html">$args</a> = <a class="phpfunction" onClick="logFunction('func_get_args')" href="../_functions/func_get_args.html" onMouseOver="phpfuncPopup(event,'func_get_args')">func_get_args</a>();
<a name="l9158"><span class="linenum">9158</span></a>                  return <a class="phpfunction" onClick="logFunction('call_user_func_array')" href="../_functions/call_user_func_array.html" onMouseOver="phpfuncPopup(event,'call_user_func_array')">call_user_func_array</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('func')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/func.html">func</a>, <a class="phpfunction" onClick="logFunction('array_merge')" href="../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('values')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/values.html">values</a>, <a class="var it626" onMouseOver="hilite(626)" onMouseOut="lolite()" onClick="logVariable('args')" href="../_variables/args.html">$args</a>));
<a name="l9159"><span class="linenum">9159</span></a>              }
<a name="l9160"><span class="linenum">9160</span></a>          }
<a name="l9161"><span class="linenum">9161</span></a>      }
<a name="l9162"><span class="linenum">9162</span></a>      <a class="var it626" onMouseOver="hilite(626)" onMouseOut="lolite()" onClick="logVariable('args')" href="../_variables/args.html">$args</a> = <a class="phpfunction" onClick="logFunction('func_get_args')" href="../_functions/func_get_args.html" onMouseOver="phpfuncPopup(event,'func_get_args')">func_get_args</a>();
<a name="l9163"><span class="linenum">9163</span></a>      <a class="var it1345" onMouseOver="hilite(1345)" onMouseOut="lolite()" onClick="logVariable('func')" href="../_variables/func.html">$func</a> = <a class="phpfunction" onClick="logFunction('array_shift')" href="../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it626" onMouseOver="hilite(626)" onMouseOut="lolite()" onClick="logVariable('args')" href="../_variables/args.html">$args</a>);
<a name="l9164"><span class="linenum">9164</span></a>      <a class="var it3345" onMouseOver="hilite(3345)" onMouseOut="lolite()" onClick="logVariable('p')" href="../_variables/p.html">$p</a> = <span class="keyword">new </span><a class="class" onClick="logClass('partial')" href="../_classes/partial.html" onMouseOver="classPopup(event,'partial')">partial</a>(<a class="var it1345" onMouseOver="hilite(1345)" onMouseOut="lolite()" onClick="logVariable('func')" href="../_variables/func.html">$func</a>, <a class="var it626" onMouseOver="hilite(626)" onMouseOut="lolite()" onClick="logVariable('args')" href="../_variables/args.html">$args</a>);
<a name="l9165"><span class="linenum">9165</span></a>      return array(<a class="var it3345" onMouseOver="hilite(3345)" onMouseOut="lolite()" onClick="logVariable('p')" href="../_variables/p.html">$p</a>, 'method');
<a name="l9166"><span class="linenum">9166</span></a>  }
<a name="l9167"><span class="linenum">9167</span></a>  
<a name="l9168"><span class="linenum">9168</span></a>  <span class="comment">/**</span>
<a name="l9169"><span class="linenum">9169</span></a>  <span class="comment"> * helper function to load up and initialise the mnet environment</span>
<a name="l9170"><span class="linenum">9170</span></a>  <span class="comment"> * this must be called before you use mnet functions.</span>
<a name="l9171"><span class="linenum">9171</span></a>  <span class="comment"> *</span>
<a name="l9172"><span class="linenum">9172</span></a>  <span class="comment"> * @return mnet_environment the equivalent of old $MNET global</span>
<a name="l9173"><span class="linenum">9173</span></a>  <span class="comment"> */</span>
<a name="l9174"><span class="linenum">9174</span></a>  function <a class="function" onClick="logFunction('get_mnet_environment')" href="../_functions/get_mnet_environment.html" onMouseOver="funcPopup(event,'get_mnet_environment')">get_mnet_environment</a>() {
<a name="l9175"><span class="linenum">9175</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l9176"><span class="linenum">9176</span></a>      require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a> . '<a class="filename" href="../mnet/lib.php.html">/mnet/lib.php</a>');
<a name="l9177"><span class="linenum">9177</span></a>      static <a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a> = null;
<a name="l9178"><span class="linenum">9178</span></a>      if (empty(<a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>)) {
<a name="l9179"><span class="linenum">9179</span></a>          <a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a> = <span class="keyword">new </span><a class="class" onClick="logClass('mnet_environment')" href="../_classes/mnet_environment.html" onMouseOver="classPopup(event,'mnet_environment')">mnet_environment</a>();
<a name="l9180"><span class="linenum">9180</span></a>          <a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>-&gt;<a class="function" onClick="logFunction('init')" href="../_functions/init.html" onMouseOver="funcPopup(event,'init')">init</a>();
<a name="l9181"><span class="linenum">9181</span></a>      }
<a name="l9182"><span class="linenum">9182</span></a>      return <a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../_variables/instance.html">$instance</a>;
<a name="l9183"><span class="linenum">9183</span></a>  }
<a name="l9184"><span class="linenum">9184</span></a>  
<a name="l9185"><span class="linenum">9185</span></a>  <span class="comment">/**</span>
<a name="l9186"><span class="linenum">9186</span></a>  <span class="comment"> * during xmlrpc server code execution, any code wishing to access</span>
<a name="l9187"><span class="linenum">9187</span></a>  <span class="comment"> * information about the remote peer must use this to get it.</span>
<a name="l9188"><span class="linenum">9188</span></a>  <span class="comment"> *</span>
<a name="l9189"><span class="linenum">9189</span></a>  <span class="comment"> * @return mnet_remote_client the equivalent of old $MNETREMOTE_CLIENT global</span>
<a name="l9190"><span class="linenum">9190</span></a>  <span class="comment"> */</span>
<a name="l9191"><span class="linenum">9191</span></a>  function <a class="function" onClick="logFunction('get_mnet_remote_client')" href="../_functions/get_mnet_remote_client.html" onMouseOver="funcPopup(event,'get_mnet_remote_client')">get_mnet_remote_client</a>() {
<a name="l9192"><span class="linenum">9192</span></a>      if (!<a class="phpfunction" onClick="logFunction('defined')" href="../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MNET_SERVER')" href="../_constants/MNET_SERVER.html" onMouseOver="constPopup(event,'MNET_SERVER')">MNET_SERVER</a>')) {
<a name="l9193"><span class="linenum">9193</span></a>          <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('notinxmlrpcserver', 'mnet'));
<a name="l9194"><span class="linenum">9194</span></a>          return false;
<a name="l9195"><span class="linenum">9195</span></a>      }
<a name="l9196"><span class="linenum">9196</span></a>      global <a class="var it13267" onMouseOver="hilite(13267)" onMouseOut="lolite()" onClick="logVariable('MNET_REMOTE_CLIENT')" href="../_variables/MNET_REMOTE_CLIENT.html">$MNET_REMOTE_CLIENT</a>;
<a name="l9197"><span class="linenum">9197</span></a>      if (isset(<a class="var it13267" onMouseOver="hilite(13267)" onMouseOut="lolite()" onClick="logVariable('MNET_REMOTE_CLIENT')" href="../_variables/MNET_REMOTE_CLIENT.html">$MNET_REMOTE_CLIENT</a>)) {
<a name="l9198"><span class="linenum">9198</span></a>          return <a class="var it13267" onMouseOver="hilite(13267)" onMouseOut="lolite()" onClick="logVariable('MNET_REMOTE_CLIENT')" href="../_variables/MNET_REMOTE_CLIENT.html">$MNET_REMOTE_CLIENT</a>;
<a name="l9199"><span class="linenum">9199</span></a>      }
<a name="l9200"><span class="linenum">9200</span></a>      return false;
<a name="l9201"><span class="linenum">9201</span></a>  }
<a name="l9202"><span class="linenum">9202</span></a>  
<a name="l9203"><span class="linenum">9203</span></a>  <span class="comment">/**</span>
<a name="l9204"><span class="linenum">9204</span></a>  <span class="comment"> * during the xmlrpc server code execution, this will be called</span>
<a name="l9205"><span class="linenum">9205</span></a>  <span class="comment"> * to setup the object returned by {@link get_mnet_remote_client}</span>
<a name="l9206"><span class="linenum">9206</span></a>  <span class="comment"> *</span>
<a name="l9207"><span class="linenum">9207</span></a>  <span class="comment"> * @param mnet_remote_client $client the client to set up</span>
<a name="l9208"><span class="linenum">9208</span></a>  <span class="comment"> * @throws moodle_exception</span>
<a name="l9209"><span class="linenum">9209</span></a>  <span class="comment"> */</span>
<a name="l9210"><span class="linenum">9210</span></a>  function <a class="function" onClick="logFunction('set_mnet_remote_client')" href="../_functions/set_mnet_remote_client.html" onMouseOver="funcPopup(event,'set_mnet_remote_client')">set_mnet_remote_client</a>(<a class="var it518" onMouseOver="hilite(518)" onMouseOut="lolite()" onClick="logVariable('client')" href="../_variables/client.html">$client</a>) {
<a name="l9211"><span class="linenum">9211</span></a>      if (!<a class="phpfunction" onClick="logFunction('defined')" href="../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MNET_SERVER')" href="../_constants/MNET_SERVER.html" onMouseOver="constPopup(event,'MNET_SERVER')">MNET_SERVER</a>')) {
<a name="l9212"><span class="linenum">9212</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('notinxmlrpcserver', 'mnet');
<a name="l9213"><span class="linenum">9213</span></a>      }
<a name="l9214"><span class="linenum">9214</span></a>      global <a class="var it13267" onMouseOver="hilite(13267)" onMouseOut="lolite()" onClick="logVariable('MNET_REMOTE_CLIENT')" href="../_variables/MNET_REMOTE_CLIENT.html">$MNET_REMOTE_CLIENT</a>;
<a name="l9215"><span class="linenum">9215</span></a>      <a class="var it13267" onMouseOver="hilite(13267)" onMouseOut="lolite()" onClick="logVariable('MNET_REMOTE_CLIENT')" href="../_variables/MNET_REMOTE_CLIENT.html">$MNET_REMOTE_CLIENT</a> = <a class="var it518" onMouseOver="hilite(518)" onMouseOut="lolite()" onClick="logVariable('client')" href="../_variables/client.html">$client</a>;
<a name="l9216"><span class="linenum">9216</span></a>  }
<a name="l9217"><span class="linenum">9217</span></a>  
<a name="l9218"><span class="linenum">9218</span></a>  <span class="comment">/**</span>
<a name="l9219"><span class="linenum">9219</span></a>  <span class="comment"> * return the jump url for a given remote user</span>
<a name="l9220"><span class="linenum">9220</span></a>  <span class="comment"> * this is used for rewriting forum post links in emails, etc</span>
<a name="l9221"><span class="linenum">9221</span></a>  <span class="comment"> *</span>
<a name="l9222"><span class="linenum">9222</span></a>  <span class="comment"> * @param stdclass $user the user to get the idp url for</span>
<a name="l9223"><span class="linenum">9223</span></a>  <span class="comment"> */</span>
<a name="l9224"><span class="linenum">9224</span></a>  function <a class="function" onClick="logFunction('mnet_get_idp_jump_url')" href="../_functions/mnet_get_idp_jump_url.html" onMouseOver="funcPopup(event,'mnet_get_idp_jump_url')">mnet_get_idp_jump_url</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>) {
<a name="l9225"><span class="linenum">9225</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l9226"><span class="linenum">9226</span></a>  
<a name="l9227"><span class="linenum">9227</span></a>      static <a class="var it13268" onMouseOver="hilite(13268)" onMouseOut="lolite()" onClick="logVariable('mnetjumps')" href="../_variables/mnetjumps.html">$mnetjumps</a> = array();
<a name="l9228"><span class="linenum">9228</span></a>      if (!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/mnethostid.html">mnethostid</a>, <a class="var it13268" onMouseOver="hilite(13268)" onMouseOut="lolite()" onClick="logVariable('mnetjumps')" href="../_variables/mnetjumps.html">$mnetjumps</a>)) {
<a name="l9229"><span class="linenum">9229</span></a>          <a class="var it12026" onMouseOver="hilite(12026)" onMouseOut="lolite()" onClick="logVariable('idp')" href="../_variables/idp.html">$idp</a> = <a class="function" onClick="logFunction('mnet_get_peer_host')" href="../_functions/mnet_get_peer_host.html" onMouseOver="funcPopup(event,'mnet_get_peer_host')">mnet_get_peer_host</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/mnethostid.html">mnethostid</a>);
<a name="l9230"><span class="linenum">9230</span></a>          <a class="var it13269" onMouseOver="hilite(13269)" onMouseOut="lolite()" onClick="logVariable('idpjumppath')" href="../_variables/idpjumppath.html">$idpjumppath</a> = <a class="function" onClick="logFunction('mnet_get_app_jumppath')" href="../_functions/mnet_get_app_jumppath.html" onMouseOver="funcPopup(event,'mnet_get_app_jumppath')">mnet_get_app_jumppath</a>(<a class="var it12026" onMouseOver="hilite(12026)" onMouseOut="lolite()" onClick="logVariable('idp')" href="../_variables/idp.html">$idp</a>-&gt;<a onClick="logVariable('applicationid')" class="var it41081" onMouseOver="hilite(41081)" onMouseOut="lolite()" href="../_variables/applicationid.html">applicationid</a>);
<a name="l9231"><span class="linenum">9231</span></a>          <a class="var it13268" onMouseOver="hilite(13268)" onMouseOut="lolite()" onClick="logVariable('mnetjumps')" href="../_variables/mnetjumps.html">$mnetjumps</a>[<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/mnethostid.html">mnethostid</a>] = <a class="var it12026" onMouseOver="hilite(12026)" onMouseOut="lolite()" onClick="logVariable('idp')" href="../_variables/idp.html">$idp</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it41081" onMouseOver="hilite(41081)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a> . <a class="var it13269" onMouseOver="hilite(13269)" onMouseOut="lolite()" onClick="logVariable('idpjumppath')" href="../_variables/idpjumppath.html">$idpjumppath</a> . '?hostwwwroot=' . <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a> . '&amp;wantsurl=';
<a name="l9232"><span class="linenum">9232</span></a>      }
<a name="l9233"><span class="linenum">9233</span></a>      return <a class="var it13268" onMouseOver="hilite(13268)" onMouseOut="lolite()" onClick="logVariable('mnetjumps')" href="../_variables/mnetjumps.html">$mnetjumps</a>[<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it39447" onMouseOver="hilite(39447)" onMouseOut="lolite()" href="../_variables/mnethostid.html">mnethostid</a>];
<a name="l9234"><span class="linenum">9234</span></a>  }
<a name="l9235"><span class="linenum">9235</span></a>  
<a name="l9236"><span class="linenum">9236</span></a>  <span class="comment">/**</span>
<a name="l9237"><span class="linenum">9237</span></a>  <span class="comment"> * Gets the homepage to use for the current user</span>
<a name="l9238"><span class="linenum">9238</span></a>  <span class="comment"> *</span>
<a name="l9239"><span class="linenum">9239</span></a>  <span class="comment"> * @return int One of HOMEPAGE_*</span>
<a name="l9240"><span class="linenum">9240</span></a>  <span class="comment"> */</span>
<a name="l9241"><span class="linenum">9241</span></a>  function <a class="function" onClick="logFunction('get_home_page')" href="../_functions/get_home_page.html" onMouseOver="funcPopup(event,'get_home_page')">get_home_page</a>() {
<a name="l9242"><span class="linenum">9242</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l9243"><span class="linenum">9243</span></a>  
<a name="l9244"><span class="linenum">9244</span></a>      if (<a class="function" onClick="logFunction('isloggedin')" href="../_functions/isloggedin.html" onMouseOver="funcPopup(event,'isloggedin')">isloggedin</a>() &amp;&amp; !<a class="function" onClick="logFunction('isguestuser')" href="../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>() &amp;&amp; !empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('defaulthomepage')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/defaulthomepage.html">defaulthomepage</a>)) {
<a name="l9245"><span class="linenum">9245</span></a>          if (<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('defaulthomepage')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/defaulthomepage.html">defaulthomepage</a> == <a class="constant" onClick="logConstant('HOMEPAGE_MY')" href="../_constants/HOMEPAGE_MY.html" onMouseOver="constPopup(event,'HOMEPAGE_MY')">HOMEPAGE_MY</a>) {
<a name="l9246"><span class="linenum">9246</span></a>              return <a class="constant" onClick="logConstant('HOMEPAGE_MY')" href="../_constants/HOMEPAGE_MY.html" onMouseOver="constPopup(event,'HOMEPAGE_MY')">HOMEPAGE_MY</a>;
<a name="l9247"><span class="linenum">9247</span></a>          } else {
<a name="l9248"><span class="linenum">9248</span></a>              return (int)<a class="function" onClick="logFunction('get_user_preferences')" href="../_functions/get_user_preferences.html" onMouseOver="funcPopup(event,'get_user_preferences')">get_user_preferences</a>('user_home_page_preference', <a class="constant" onClick="logConstant('HOMEPAGE_MY')" href="../_constants/HOMEPAGE_MY.html" onMouseOver="constPopup(event,'HOMEPAGE_MY')">HOMEPAGE_MY</a>);
<a name="l9249"><span class="linenum">9249</span></a>          }
<a name="l9250"><span class="linenum">9250</span></a>      }
<a name="l9251"><span class="linenum">9251</span></a>      return <a class="constant" onClick="logConstant('HOMEPAGE_SITE')" href="../_constants/HOMEPAGE_SITE.html" onMouseOver="constPopup(event,'HOMEPAGE_SITE')">HOMEPAGE_SITE</a>;
<a name="l9252"><span class="linenum">9252</span></a>  }
<a name="l9253"><span class="linenum">9253</span></a>  
<a name="l9254"><span class="linenum">9254</span></a>  <span class="comment">/**</span>
<a name="l9255"><span class="linenum">9255</span></a>  <span class="comment"> * Gets the name of a course to be displayed when showing a list of courses.</span>
<a name="l9256"><span class="linenum">9256</span></a>  <span class="comment"> * By default this is just $course-&gt;fullname but user can configure it. The</span>
<a name="l9257"><span class="linenum">9257</span></a>  <span class="comment"> * result of this function should be passed through print_string.</span>
<a name="l9258"><span class="linenum">9258</span></a>  <span class="comment"> * @param stdClass|course_in_list $course Moodle course object</span>
<a name="l9259"><span class="linenum">9259</span></a>  <span class="comment"> * @return string Display name of course (either fullname or short + fullname)</span>
<a name="l9260"><span class="linenum">9260</span></a>  <span class="comment"> */</span>
<a name="l9261"><span class="linenum">9261</span></a>  function <a class="function" onClick="logFunction('get_course_display_name_for_list')" href="../_functions/get_course_display_name_for_list.html" onMouseOver="funcPopup(event,'get_course_display_name_for_list')">get_course_display_name_for_list</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>) {
<a name="l9262"><span class="linenum">9262</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l9263"><span class="linenum">9263</span></a>      if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('courselistshortnames')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/courselistshortnames.html">courselistshortnames</a>)) {
<a name="l9264"><span class="linenum">9264</span></a>          if (!(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a> instanceof stdClass)) {
<a name="l9265"><span class="linenum">9265</span></a>              <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a> = (object)<a class="function" onClick="logFunction('convert_to_array')" href="../_functions/convert_to_array.html" onMouseOver="funcPopup(event,'convert_to_array')">convert_to_array</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>);
<a name="l9266"><span class="linenum">9266</span></a>          }
<a name="l9267"><span class="linenum">9267</span></a>          return <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('courseextendednamedisplay', '', <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>);
<a name="l9268"><span class="linenum">9268</span></a>      } else {
<a name="l9269"><span class="linenum">9269</span></a>          return <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('fullname')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../_variables/fullname.html">fullname</a>;
<a name="l9270"><span class="linenum">9270</span></a>      }
<a name="l9271"><span class="linenum">9271</span></a>  }
<a name="l9272"><span class="linenum">9272</span></a>  
<a name="l9273"><span class="linenum">9273</span></a>  <span class="comment">/**</span>
<a name="l9274"><span class="linenum">9274</span></a>  <span class="comment"> * The lang_string class</span>
<a name="l9275"><span class="linenum">9275</span></a>  <span class="comment"> *</span>
<a name="l9276"><span class="linenum">9276</span></a>  <span class="comment"> * This special class is used to create an object representation of a string request.</span>
<a name="l9277"><span class="linenum">9277</span></a>  <span class="comment"> * It is special because processing doesn't occur until the object is first used.</span>
<a name="l9278"><span class="linenum">9278</span></a>  <span class="comment"> * The class was created especially to aid performance in areas where strings were</span>
<a name="l9279"><span class="linenum">9279</span></a>  <span class="comment"> * required to be generated but were not necessarily used.</span>
<a name="l9280"><span class="linenum">9280</span></a>  <span class="comment"> * As an example the admin tree when generated uses over 1500 strings, of which</span>
<a name="l9281"><span class="linenum">9281</span></a>  <span class="comment"> * normally only 1/3 are ever actually printed at any time.</span>
<a name="l9282"><span class="linenum">9282</span></a>  <span class="comment"> * The performance advantage is achieved by not actually processing strings that</span>
<a name="l9283"><span class="linenum">9283</span></a>  <span class="comment"> * arn't being used, as such reducing the processing required for the page.</span>
<a name="l9284"><span class="linenum">9284</span></a>  <span class="comment"> *</span>
<a name="l9285"><span class="linenum">9285</span></a>  <span class="comment"> * How to use the lang_string class?</span>
<a name="l9286"><span class="linenum">9286</span></a>  <span class="comment"> *     There are two methods of using the lang_string class, first through the</span>
<a name="l9287"><span class="linenum">9287</span></a>  <span class="comment"> *     forth argument of the get_string function, and secondly directly.</span>
<a name="l9288"><span class="linenum">9288</span></a>  <span class="comment"> *     The following are examples of both.</span>
<a name="l9289"><span class="linenum">9289</span></a>  <span class="comment"> * 1. Through get_string calls e.g.</span>
<a name="l9290"><span class="linenum">9290</span></a>  <span class="comment"> *     $string = get_string($identifier, $component, $a, true);</span>
<a name="l9291"><span class="linenum">9291</span></a>  <span class="comment"> *     $string = get_string('yes', 'moodle', null, true);</span>
<a name="l9292"><span class="linenum">9292</span></a>  <span class="comment"> * 2. Direct instantiation</span>
<a name="l9293"><span class="linenum">9293</span></a>  <span class="comment"> *     $string = new lang_string($identifier, $component, $a, $lang);</span>
<a name="l9294"><span class="linenum">9294</span></a>  <span class="comment"> *     $string = new lang_string('yes');</span>
<a name="l9295"><span class="linenum">9295</span></a>  <span class="comment"> *</span>
<a name="l9296"><span class="linenum">9296</span></a>  <span class="comment"> * How do I use a lang_string object?</span>
<a name="l9297"><span class="linenum">9297</span></a>  <span class="comment"> *     The lang_string object makes use of a magic __toString method so that you</span>
<a name="l9298"><span class="linenum">9298</span></a>  <span class="comment"> *     are able to use the object exactly as you would use a string in most cases.</span>
<a name="l9299"><span class="linenum">9299</span></a>  <span class="comment"> *     This means you are able to collect it into a variable and then directly</span>
<a name="l9300"><span class="linenum">9300</span></a>  <span class="comment"> *     echo it, or concatenate it into another string, or similar.</span>
<a name="l9301"><span class="linenum">9301</span></a>  <span class="comment"> *     The other thing you can do is manually get the string by calling the</span>
<a name="l9302"><span class="linenum">9302</span></a>  <span class="comment"> *     lang_strings out method e.g.</span>
<a name="l9303"><span class="linenum">9303</span></a>  <span class="comment"> *         $string = new lang_string('yes');</span>
<a name="l9304"><span class="linenum">9304</span></a>  <span class="comment"> *         $string-&gt;out();</span>
<a name="l9305"><span class="linenum">9305</span></a>  <span class="comment"> *     Also worth noting is that the out method can take one argument, $lang which</span>
<a name="l9306"><span class="linenum">9306</span></a>  <span class="comment"> *     allows the developer to change the language on the fly.</span>
<a name="l9307"><span class="linenum">9307</span></a>  <span class="comment"> *</span>
<a name="l9308"><span class="linenum">9308</span></a>  <span class="comment"> * When should I use a lang_string object?</span>
<a name="l9309"><span class="linenum">9309</span></a>  <span class="comment"> *     The lang_string object is designed to be used in any situation where a</span>
<a name="l9310"><span class="linenum">9310</span></a>  <span class="comment"> *     string may not be needed, but needs to be generated.</span>
<a name="l9311"><span class="linenum">9311</span></a>  <span class="comment"> *     The admin tree is a good example of where lang_string objects should be</span>
<a name="l9312"><span class="linenum">9312</span></a>  <span class="comment"> *     used.</span>
<a name="l9313"><span class="linenum">9313</span></a>  <span class="comment"> *     A more practical example would be any class that requries strings that may</span>
<a name="l9314"><span class="linenum">9314</span></a>  <span class="comment"> *     not be printed (after all classes get renderer by renderers and who knows</span>
<a name="l9315"><span class="linenum">9315</span></a>  <span class="comment"> *     what they will do ;))</span>
<a name="l9316"><span class="linenum">9316</span></a>  <span class="comment"> *</span>
<a name="l9317"><span class="linenum">9317</span></a>  <span class="comment"> * When should I not use a lang_string object?</span>
<a name="l9318"><span class="linenum">9318</span></a>  <span class="comment"> *     Don't use lang_strings when you are going to use a string immediately.</span>
<a name="l9319"><span class="linenum">9319</span></a>  <span class="comment"> *     There is no need as it will be processed immediately and there will be no</span>
<a name="l9320"><span class="linenum">9320</span></a>  <span class="comment"> *     advantage, and in fact perhaps a negative hit as a class has to be</span>
<a name="l9321"><span class="linenum">9321</span></a>  <span class="comment"> *     instantiated for a lang_string object, however get_string won't require</span>
<a name="l9322"><span class="linenum">9322</span></a>  <span class="comment"> *     that.</span>
<a name="l9323"><span class="linenum">9323</span></a>  <span class="comment"> *</span>
<a name="l9324"><span class="linenum">9324</span></a>  <span class="comment"> * Limitations:</span>
<a name="l9325"><span class="linenum">9325</span></a>  <span class="comment"> * 1. You cannot use a lang_string object as an array offset. Doing so will</span>
<a name="l9326"><span class="linenum">9326</span></a>  <span class="comment"> *     result in PHP throwing an error. (You can use it as an object property!)</span>
<a name="l9327"><span class="linenum">9327</span></a>  <span class="comment"> *</span>
<a name="l9328"><span class="linenum">9328</span></a>  <span class="comment"> * @package    core</span>
<a name="l9329"><span class="linenum">9329</span></a>  <span class="comment"> * @category   string</span>
<a name="l9330"><span class="linenum">9330</span></a>  <span class="comment"> * @copyright  2011 Sam Hemelryk</span>
<a name="l9331"><span class="linenum">9331</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l9332"><span class="linenum">9332</span></a>  <span class="comment"> */</span>
<a name="l9333"><span class="linenum">9333</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('lang_string')" href="../_classes/lang_string.html" onMouseOver="classPopup(event,'lang_string')">lang_string</a> {
<a name="l9334"><span class="linenum">9334</span></a>  
<a name="l9335"><span class="linenum">9335</span></a>  <span class="comment">    /** @var string The strings identifier */</span>
<a name="l9336"><span class="linenum">9336</span></a>      protected <a class="var it1139" onMouseOver="hilite(1139)" onMouseOut="lolite()" onClick="logVariable('identifier')" href="../_variables/identifier.html">$identifier</a>;
<a name="l9337"><span class="linenum">9337</span></a>  <span class="comment">    /** @var string The strings component. Default '' */</span>
<a name="l9338"><span class="linenum">9338</span></a>      protected <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a> = '';
<a name="l9339"><span class="linenum">9339</span></a>  <span class="comment">    /** @var array|stdClass Any arguments required for the string. Default null */</span>
<a name="l9340"><span class="linenum">9340</span></a>      protected <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a> = null;
<a name="l9341"><span class="linenum">9341</span></a>  <span class="comment">    /** @var string The language to use when processing the string. Default null */</span>
<a name="l9342"><span class="linenum">9342</span></a>      protected <a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a> = null;
<a name="l9343"><span class="linenum">9343</span></a>  
<a name="l9344"><span class="linenum">9344</span></a>  <span class="comment">    /** @var string The processed string (once processed) */</span>
<a name="l9345"><span class="linenum">9345</span></a>      protected <a class="var it160" onMouseOver="hilite(160)" onMouseOut="lolite()" onClick="logVariable('string')" href="../_variables/string.html">$string</a> = null;
<a name="l9346"><span class="linenum">9346</span></a>  
<a name="l9347"><span class="linenum">9347</span></a>      <span class="comment">/**</span>
<a name="l9348"><span class="linenum">9348</span></a>  <span class="comment">     * A special boolean. If set to true then the object has been woken up and</span>
<a name="l9349"><span class="linenum">9349</span></a>  <span class="comment">     * cannot be regenerated. If this is set then $this-&gt;string MUST be used.</span>
<a name="l9350"><span class="linenum">9350</span></a>  <span class="comment">     * @var bool</span>
<a name="l9351"><span class="linenum">9351</span></a>  <span class="comment">     */</span>
<a name="l9352"><span class="linenum">9352</span></a>      protected <a class="var it13272" onMouseOver="hilite(13272)" onMouseOut="lolite()" onClick="logVariable('forcedstring')" href="../_variables/forcedstring.html">$forcedstring</a> = false;
<a name="l9353"><span class="linenum">9353</span></a>  
<a name="l9354"><span class="linenum">9354</span></a>      <span class="comment">/**</span>
<a name="l9355"><span class="linenum">9355</span></a>  <span class="comment">     * Constructs a lang_string object</span>
<a name="l9356"><span class="linenum">9356</span></a>  <span class="comment">     *</span>
<a name="l9357"><span class="linenum">9357</span></a>  <span class="comment">     * This function should do as little processing as possible to ensure the best</span>
<a name="l9358"><span class="linenum">9358</span></a>  <span class="comment">     * performance for strings that won't be used.</span>
<a name="l9359"><span class="linenum">9359</span></a>  <span class="comment">     *</span>
<a name="l9360"><span class="linenum">9360</span></a>  <span class="comment">     * @param string $identifier The strings identifier</span>
<a name="l9361"><span class="linenum">9361</span></a>  <span class="comment">     * @param string $component The strings component</span>
<a name="l9362"><span class="linenum">9362</span></a>  <span class="comment">     * @param stdClass|array $a Any arguments the string requires</span>
<a name="l9363"><span class="linenum">9363</span></a>  <span class="comment">     * @param string $lang The language to use when processing the string.</span>
<a name="l9364"><span class="linenum">9364</span></a>  <span class="comment">     * @throws coding_exception</span>
<a name="l9365"><span class="linenum">9365</span></a>  <span class="comment">     */</span>
<a name="l9366"><span class="linenum">9366</span></a>      public function <a class="function" onClick="logFunction('__construct')" href="../_functions/__construct.html" onMouseOver="funcPopup(event,'__construct')">__construct</a>(<a class="var it1139" onMouseOver="hilite(1139)" onMouseOut="lolite()" onClick="logVariable('identifier')" href="../_variables/identifier.html">$identifier</a>, <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a> = '', <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a> = null, <a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a> = null) {
<a name="l9367"><span class="linenum">9367</span></a>          if (empty(<a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a>)) {
<a name="l9368"><span class="linenum">9368</span></a>              <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a> = 'moodle';
<a name="l9369"><span class="linenum">9369</span></a>          }
<a name="l9370"><span class="linenum">9370</span></a>  
<a name="l9371"><span class="linenum">9371</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('identifier')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/identifier.html">identifier</a> = <a class="var it1139" onMouseOver="hilite(1139)" onMouseOut="lolite()" onClick="logVariable('identifier')" href="../_variables/identifier.html">$identifier</a>;
<a name="l9372"><span class="linenum">9372</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('component')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/component.html">component</a> = <a class="var it547" onMouseOver="hilite(547)" onMouseOut="lolite()" onClick="logVariable('component')" href="../_variables/component.html">$component</a>;
<a name="l9373"><span class="linenum">9373</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('lang')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a> = <a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a>;
<a name="l9374"><span class="linenum">9374</span></a>  
<a name="l9375"><span class="linenum">9375</span></a>  <span class="comment">        // We MUST duplicate $a to ensure that it if it changes by reference those</span>
<a name="l9376"><span class="linenum">9376</span></a>  <span class="comment">        // changes are not carried across.</span>
<a name="l9377"><span class="linenum">9377</span></a>  <span class="comment">        // To do this we always ensure $a or its properties/values are strings</span>
<a name="l9378"><span class="linenum">9378</span></a>  <span class="comment">        // and that any properties/values that arn't convertable are forgotten.</span>
<a name="l9379"><span class="linenum">9379</span></a>          if (!empty(<a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>)) {
<a name="l9380"><span class="linenum">9380</span></a>              if (<a class="phpfunction" onClick="logFunction('is_scalar')" href="../_functions/is_scalar.html" onMouseOver="phpfuncPopup(event,'is_scalar')">is_scalar</a>(<a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>)) {
<a name="l9381"><span class="linenum">9381</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('a')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/a.html">a</a> = <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>;
<a name="l9382"><span class="linenum">9382</span></a>              } else if (<a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a> instanceof lang_string) {
<a name="l9383"><span class="linenum">9383</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('a')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/a.html">a</a> = <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>-&gt;<a class="function" onClick="logFunction('out')" href="../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>();
<a name="l9384"><span class="linenum">9384</span></a>              } else if (<a class="phpfunction" onClick="logFunction('is_object')" href="../_functions/is_object.html" onMouseOver="phpfuncPopup(event,'is_object')">is_object</a>(<a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>) or <a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>)) {
<a name="l9385"><span class="linenum">9385</span></a>                  <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a> = (array)<a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a>;
<a name="l9386"><span class="linenum">9386</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('a')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/a.html">a</a> = array();
<a name="l9387"><span class="linenum">9387</span></a>                  foreach (<a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../_variables/a.html">$a</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) {
<a name="l9388"><span class="linenum">9388</span></a>  <span class="comment">                    // Make sure conversion errors don't get displayed (results in '').</span>
<a name="l9389"><span class="linenum">9389</span></a>                      if (<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>)) {
<a name="l9390"><span class="linenum">9390</span></a>                          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('a')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/a.html">a</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = '';
<a name="l9391"><span class="linenum">9391</span></a>                      } else if (<a class="phpfunction" onClick="logFunction('is_object')" href="../_functions/is_object.html" onMouseOver="phpfuncPopup(event,'is_object')">is_object</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>)) {
<a name="l9392"><span class="linenum">9392</span></a>                          if (<a class="phpfunction" onClick="logFunction('method_exists')" href="../_functions/method_exists.html" onMouseOver="phpfuncPopup(event,'method_exists')">method_exists</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>, '__toString')) {
<a name="l9393"><span class="linenum">9393</span></a>                              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('a')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/a.html">a</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>-&gt;<a class="function" onClick="logFunction('__toString')" href="../_functions/__tostring.html" onMouseOver="funcPopup(event,'__tostring')">__toString</a>();
<a name="l9394"><span class="linenum">9394</span></a>                          } else {
<a name="l9395"><span class="linenum">9395</span></a>                              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('a')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/a.html">a</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = '';
<a name="l9396"><span class="linenum">9396</span></a>                          }
<a name="l9397"><span class="linenum">9397</span></a>                      } else {
<a name="l9398"><span class="linenum">9398</span></a>                          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('a')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/a.html">a</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = (string)<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>;
<a name="l9399"><span class="linenum">9399</span></a>                      }
<a name="l9400"><span class="linenum">9400</span></a>                  }
<a name="l9401"><span class="linenum">9401</span></a>              }
<a name="l9402"><span class="linenum">9402</span></a>          }
<a name="l9403"><span class="linenum">9403</span></a>  
<a name="l9404"><span class="linenum">9404</span></a>          if (<a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(false, <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>)) {
<a name="l9405"><span class="linenum">9405</span></a>              if (<a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('identifier')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/identifier.html">identifier</a>, <a class="constant" onClick="logConstant('PARAM_STRINGID')" href="../_constants/PARAM_STRINGID.html" onMouseOver="constPopup(event,'PARAM_STRINGID')">PARAM_STRINGID</a>) == '') {
<a name="l9406"><span class="linenum">9406</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Invalid string identifier. Most probably some illegal character is part of the string identifier. Please check your string definition');
<a name="l9407"><span class="linenum">9407</span></a>              }
<a name="l9408"><span class="linenum">9408</span></a>              if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('component')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/component.html">component</a>) &amp;&amp; <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('component')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/component.html">component</a>, <a class="constant" onClick="logConstant('PARAM_COMPONENT')" href="../_constants/PARAM_COMPONENT.html" onMouseOver="constPopup(event,'PARAM_COMPONENT')">PARAM_COMPONENT</a>) == '') {
<a name="l9409"><span class="linenum">9409</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Invalid string compontent. Please check your string definition');
<a name="l9410"><span class="linenum">9410</span></a>              }
<a name="l9411"><span class="linenum">9411</span></a>              if (!<a class="function" onClick="logFunction('get_string_manager')" href="../_functions/get_string_manager.html" onMouseOver="funcPopup(event,'get_string_manager')">get_string_manager</a>()-&gt;<a class="function" onClick="logFunction('string_exists')" href="../_functions/string_exists.html" onMouseOver="funcPopup(event,'string_exists')">string_exists</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('identifier')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/identifier.html">identifier</a>, <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('component')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/component.html">component</a>)) {
<a name="l9412"><span class="linenum">9412</span></a>                  <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('String does not exist. Please check your string definition for '.<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('identifier')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/identifier.html">identifier</a>.'/'.<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('component')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/component.html">component</a>, <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l9413"><span class="linenum">9413</span></a>              }
<a name="l9414"><span class="linenum">9414</span></a>          }
<a name="l9415"><span class="linenum">9415</span></a>      }
<a name="l9416"><span class="linenum">9416</span></a>  
<a name="l9417"><span class="linenum">9417</span></a>      <span class="comment">/**</span>
<a name="l9418"><span class="linenum">9418</span></a>  <span class="comment">     * Processes the string.</span>
<a name="l9419"><span class="linenum">9419</span></a>  <span class="comment">     *</span>
<a name="l9420"><span class="linenum">9420</span></a>  <span class="comment">     * This function actually processes the string, stores it in the string property</span>
<a name="l9421"><span class="linenum">9421</span></a>  <span class="comment">     * and then returns it.</span>
<a name="l9422"><span class="linenum">9422</span></a>  <span class="comment">     * You will notice that this function is VERY similar to the get_string method.</span>
<a name="l9423"><span class="linenum">9423</span></a>  <span class="comment">     * That is because it is pretty much doing the same thing.</span>
<a name="l9424"><span class="linenum">9424</span></a>  <span class="comment">     * However as this function is an upgrade it isn't as tolerant to backwards</span>
<a name="l9425"><span class="linenum">9425</span></a>  <span class="comment">     * compatibility.</span>
<a name="l9426"><span class="linenum">9426</span></a>  <span class="comment">     *</span>
<a name="l9427"><span class="linenum">9427</span></a>  <span class="comment">     * @return string</span>
<a name="l9428"><span class="linenum">9428</span></a>  <span class="comment">     * @throws coding_exception</span>
<a name="l9429"><span class="linenum">9429</span></a>  <span class="comment">     */</span>
<a name="l9430"><span class="linenum">9430</span></a>      protected function <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>() {
<a name="l9431"><span class="linenum">9431</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l9432"><span class="linenum">9432</span></a>  
<a name="l9433"><span class="linenum">9433</span></a>  <span class="comment">        // Check if we need to process the string.</span>
<a name="l9434"><span class="linenum">9434</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('string')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/string.html">string</a> === null) {
<a name="l9435"><span class="linenum">9435</span></a>  <span class="comment">            // Check the quality of the identifier.</span>
<a name="l9436"><span class="linenum">9436</span></a>              if (<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('debugdeveloper')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/debugdeveloper.html">debugdeveloper</a> &amp;&amp; <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('identifier')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/identifier.html">identifier</a>, <a class="constant" onClick="logConstant('PARAM_STRINGID')" href="../_constants/PARAM_STRINGID.html" onMouseOver="constPopup(event,'PARAM_STRINGID')">PARAM_STRINGID</a>) === '') {
<a name="l9437"><span class="linenum">9437</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Invalid string identifier. Most probably some illegal character is part of the string identifier. Please check your string definition', <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l9438"><span class="linenum">9438</span></a>              }
<a name="l9439"><span class="linenum">9439</span></a>  
<a name="l9440"><span class="linenum">9440</span></a>  <span class="comment">            // Process the string.</span>
<a name="l9441"><span class="linenum">9441</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('string')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/string.html">string</a> = <a class="function" onClick="logFunction('get_string_manager')" href="../_functions/get_string_manager.html" onMouseOver="funcPopup(event,'get_string_manager')">get_string_manager</a>()-&gt;<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('identifier')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/identifier.html">identifier</a>, <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('component')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/component.html">component</a>, <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('a')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/a.html">a</a>, <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('lang')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>);
<a name="l9442"><span class="linenum">9442</span></a>  <span class="comment">            // Debugging feature lets you display string identifier and component.</span>
<a name="l9443"><span class="linenum">9443</span></a>              if (isset(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('debugstringids')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/debugstringids.html">debugstringids</a>) &amp;&amp; <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('debugstringids')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../_variables/debugstringids.html">debugstringids</a> &amp;&amp; <a class="function" onClick="logFunction('optional_param')" href="../_functions/optional_param.html" onMouseOver="funcPopup(event,'optional_param')">optional_param</a>('strings', 0, <a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>)) {
<a name="l9444"><span class="linenum">9444</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('string')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/string.html">string</a> .= ' {' . <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('identifier')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/identifier.html">identifier</a> . '/' . <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('component')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/component.html">component</a> . '}';
<a name="l9445"><span class="linenum">9445</span></a>              }
<a name="l9446"><span class="linenum">9446</span></a>          }
<a name="l9447"><span class="linenum">9447</span></a>  <span class="comment">        // Return the string.</span>
<a name="l9448"><span class="linenum">9448</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('string')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/string.html">string</a>;
<a name="l9449"><span class="linenum">9449</span></a>      }
<a name="l9450"><span class="linenum">9450</span></a>  
<a name="l9451"><span class="linenum">9451</span></a>      <span class="comment">/**</span>
<a name="l9452"><span class="linenum">9452</span></a>  <span class="comment">     * Returns the string</span>
<a name="l9453"><span class="linenum">9453</span></a>  <span class="comment">     *</span>
<a name="l9454"><span class="linenum">9454</span></a>  <span class="comment">     * @param string $lang The langauge to use when processing the string</span>
<a name="l9455"><span class="linenum">9455</span></a>  <span class="comment">     * @return string</span>
<a name="l9456"><span class="linenum">9456</span></a>  <span class="comment">     */</span>
<a name="l9457"><span class="linenum">9457</span></a>      public function <a class="function" onClick="logFunction('out')" href="../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>(<a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a> = null) {
<a name="l9458"><span class="linenum">9458</span></a>          if (<a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a> !== null &amp;&amp; <a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a> != <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('lang')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a> &amp;&amp; (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('lang')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a> == null &amp;&amp; <a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a> != <a class="function" onClick="logFunction('current_language')" href="../_functions/current_language.html" onMouseOver="funcPopup(event,'current_language')">current_language</a>())) {
<a name="l9459"><span class="linenum">9459</span></a>              if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('forcedstring')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/forcedstring.html">forcedstring</a>) {
<a name="l9460"><span class="linenum">9460</span></a>                  <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('lang_string objects that have been used cannot be printed in another language. ('.<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('lang')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>.' used)', <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l9461"><span class="linenum">9461</span></a>                  return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>();
<a name="l9462"><span class="linenum">9462</span></a>              }
<a name="l9463"><span class="linenum">9463</span></a>              <a class="var it13273" onMouseOver="hilite(13273)" onMouseOut="lolite()" onClick="logVariable('translatedstring')" href="../_variables/translatedstring.html">$translatedstring</a> = <span class="keyword">new </span><a class="class" onClick="logClass('lang_string')" href="../_classes/lang_string.html" onMouseOver="classPopup(event,'lang_string')">lang_string</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('identifier')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/identifier.html">identifier</a>, <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('component')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/component.html">component</a>, <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('a')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/a.html">a</a>, <a class="var it2703" onMouseOver="hilite(2703)" onMouseOut="lolite()" onClick="logVariable('lang')" href="../_variables/lang.html">$lang</a>);
<a name="l9464"><span class="linenum">9464</span></a>              return <a class="var it13273" onMouseOver="hilite(13273)" onMouseOut="lolite()" onClick="logVariable('translatedstring')" href="../_variables/translatedstring.html">$translatedstring</a>-&gt;<a class="function" onClick="logFunction('out')" href="../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>();
<a name="l9465"><span class="linenum">9465</span></a>          }
<a name="l9466"><span class="linenum">9466</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>();
<a name="l9467"><span class="linenum">9467</span></a>      }
<a name="l9468"><span class="linenum">9468</span></a>  
<a name="l9469"><span class="linenum">9469</span></a>      <span class="comment">/**</span>
<a name="l9470"><span class="linenum">9470</span></a>  <span class="comment">     * Magic __toString method for printing a string</span>
<a name="l9471"><span class="linenum">9471</span></a>  <span class="comment">     *</span>
<a name="l9472"><span class="linenum">9472</span></a>  <span class="comment">     * @return string</span>
<a name="l9473"><span class="linenum">9473</span></a>  <span class="comment">     */</span>
<a name="l9474"><span class="linenum">9474</span></a>      public function <a class="function" onClick="logFunction('__toString')" href="../_functions/__tostring.html" onMouseOver="funcPopup(event,'__tostring')">__toString</a>() {
<a name="l9475"><span class="linenum">9475</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>();
<a name="l9476"><span class="linenum">9476</span></a>      }
<a name="l9477"><span class="linenum">9477</span></a>  
<a name="l9478"><span class="linenum">9478</span></a>      <span class="comment">/**</span>
<a name="l9479"><span class="linenum">9479</span></a>  <span class="comment">     * Magic __set_state method used for var_export</span>
<a name="l9480"><span class="linenum">9480</span></a>  <span class="comment">     *</span>
<a name="l9481"><span class="linenum">9481</span></a>  <span class="comment">     * @return string</span>
<a name="l9482"><span class="linenum">9482</span></a>  <span class="comment">     */</span>
<a name="l9483"><span class="linenum">9483</span></a>      public function <a class="function" onClick="logFunction('__set_state')" href="../_functions/__set_state.html" onMouseOver="funcPopup(event,'__set_state')">__set_state</a>() {
<a name="l9484"><span class="linenum">9484</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>();
<a name="l9485"><span class="linenum">9485</span></a>      }
<a name="l9486"><span class="linenum">9486</span></a>  
<a name="l9487"><span class="linenum">9487</span></a>      <span class="comment">/**</span>
<a name="l9488"><span class="linenum">9488</span></a>  <span class="comment">     * Prepares the lang_string for sleep and stores only the forcedstring and</span>
<a name="l9489"><span class="linenum">9489</span></a>  <span class="comment">     * string properties... the string cannot be regenerated so we need to ensure</span>
<a name="l9490"><span class="linenum">9490</span></a>  <span class="comment">     * it is generated for this.</span>
<a name="l9491"><span class="linenum">9491</span></a>  <span class="comment">     *</span>
<a name="l9492"><span class="linenum">9492</span></a>  <span class="comment">     * @return string</span>
<a name="l9493"><span class="linenum">9493</span></a>  <span class="comment">     */</span>
<a name="l9494"><span class="linenum">9494</span></a>      public function <a class="function" onClick="logFunction('__sleep')" href="../_functions/__sleep.html" onMouseOver="funcPopup(event,'__sleep')">__sleep</a>() {
<a name="l9495"><span class="linenum">9495</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>();
<a name="l9496"><span class="linenum">9496</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('forcedstring')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../_variables/forcedstring.html">forcedstring</a> = true;
<a name="l9497"><span class="linenum">9497</span></a>          return array('forcedstring', 'string', 'lang');
<a name="l9498"><span class="linenum">9498</span></a>      }
<a name="l9499"><span class="linenum">9499</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'get_max_upload_sizes': ['get_max_upload_sizes', 'Returns an array of possible sizes in local language ', [['lib','moodlelib.php',6138]], 25],
'bounded_number': ['bounded_number', 'Used to make sure that $min <= $value <= $max ', [['lib','moodlelib.php',8547]], 3],
'set_config': ['set_config', 'Set a configuration value for this plugin ', [['mod/assign','assignmentplugin.php',314],['lib/portfolio','plugin.php',515],['lib','moodlelib.php',1331],['lib','enrollib.php',1152],['lib/editor/tinymce/classes','plugin.php',84]], 985],
'js_reset_all_caches': ['js_reset_all_caches', 'Invalidate all server and client side JS caches. ', [['lib','outputrequirementslib.php',2022]], 1],
'get_mnet_remote_client': ['get_mnet_remote_client', 'during xmlrpc server code execution, any code wishing to access information about the remote peer must use this to get it. ', [['lib','moodlelib.php',9185]], 19],
'clean_filename': ['clean_filename', 'Cleans a given filename by removing suspicious or troublesome characters ', [['lib','moodlelib.php',6378]], 61],
'component_callback': ['component_callback', 'Invoke component\'s callback functions ', [['lib','moodlelib.php',7120]], 15],
'load': ['load', 'Load the config.php file for a particular theme, and return an instance of this class. (That is, this is a factory method.) ', [['lib','outputlib.php',399],['lib/adodb','adodb-active-recordx.inc.php',747],['lib/phpexcel/PHPExcel/Reader/Excel5','Escher.php',94],['lib/htmlpurifier/HTMLPurifier','Language.php',69],['cache/classes','definition.php',323],['lib/htmlpurifier/HTMLPurifier','IDAccumulator.php',44],['lib/mustache/src/Mustache','Loader.php',17],['lib/phpexcel/PHPExcel','IOFactory.php',181],['lib/simplepie/library/SimplePie/Cache','MySQL.php',286],['lib/phpexcel/PHPExcel/Reader','OOCalc.php',293],['lib/mustache/src/Mustache/Cache','NoopCache.php',20],['lib/phpexcel/PHPExcel/Reader','SYLK.php',197],['lib/phpexcel/PHPExcel/Reader','Excel5.php',602],['lib/simplepie/library/SimplePie/Cache','Base.php',87],['lib/pear/HTML/QuickForm','select.php',421],['lib/simplepie/library/SimplePie/Cache','File.php',118],['calendar','lib.php',2631],['backup/cc/cc_lib','xmlbase.php',92],['mod/lesson','locallib.php',1024],['mod/lesson','locallib.php',2243],['mod/lesson','locallib.php',3191],['lib/phpexcel/PHPExcel/Reader','Excel2007.php',337],['lib/mustache/src/Mustache/Cache','FilesystemCache.php',39],['lib/zend/Zend/Loader','PluginLoader.php',350],['lib/mustache/src/Mustache/Loader','StringLoader.php',28],['cache/classes','config.php',128],['lib/phpexcel/PHPExcel/Reader','IReader.php',46],['lib/mustache/src/Mustache/Loader','FilesystemLoader.php',69],['lib/phpexcel/PHPExcel/Reader','Excel2003XML.php',224],['lib/phpexcel/PHPExcel/Reader','CSV.php',218],['lib/phpexcel/PHPExcel','Autoloader.php',62],['lib/phpexcel/PHPExcel/Reader','Gnumeric.php',205],['lib/zend/Zend/Loader/PluginLoader','Interface.php',68],['lib/mustache/src/Mustache','Cache.php',20],['lib/simplepie/library/SimplePie/Cache','Memcache.php',123],['lib/phpunit/classes','autoloader.php',46],['grade/grading','lib.php',227],['lib/zend/Zend/Loader/Autoloader','Resource.php',428],['lib/mustache/src/Mustache/Loader','ArrayLoader.php',41],['lib/phpexcel/PHPExcel/Reader','HTML.php',128],['lib/mustache/src/Mustache/Loader','InlineLoader.php',87],['lib/adodb','adodb-active-record.inc.php',682],['lib/mustache/src/Mustache/Loader','CascadingLoader.php',48]], 182],
'delete_content': ['delete_content', 'Delete all data linked to content, do not delete the context record itself ', [['lib','accesslib.php',5492],['mod/data','lib.php',399]], 9],
'is_proxybypass': ['is_proxybypass', 'Check if $url matches anything in proxybypass list ', [['lib','moodlelib.php',8938]], 4],
'user_create_user': ['user_create_user', 'Creates a user ', [['user','lib.php',26]], 10],
'gettimestamp': ['gettimestamp', 'Returns timestamp in seconds from formatted date-time. ', [['lib/tcpdf/include','tcpdf_static.php',881],['lib/google/src/Google/Service','AdExchangeBuyer.php',1552],['lib/google/src/Google/Service','Spectrum.php',872],['lib/google/src/Google/Service','Spectrum.php',1079],['lib/google/src/Google/Service','Mirror.php',1217],['lib/google/src/Google/Service','Coordinate.php',962],['lib/google/src/Google/Service','Webmasters.php',604],['lib/google/src/Google/Service','ShoppingContent.php',3782],['lib/zend/Zend','Date.php',303],['lib/zend/Zend/Service/WindowsAzure/Storage','TableEntity.php',122]], 42],
'days_in_month': ['days_in_month', 'Calculate the number of days in a given month ', [['lib','moodlelib.php',2396]], 2],
'unset_all_config_for_plugin': ['unset_all_config_for_plugin', 'Remove all the config variables for a given plugin. ', [['lib','moodlelib.php',1523]], 28],
'get_config': ['get_config', 'Get a configuration value for this plugin ', [['mod/assign','assignmentplugin.php',345],['lib/portfolio','plugin.php',546],['question/engine','bank.php',109],['lib','moodlelib.php',1404],['lib','enrollib.php',1141],['lib/editor/tinymce/classes','plugin.php',73],['admin/tool/log/classes/helper','store.php',63]], 847],
'require_course_login': ['require_course_login', 'Weaker version of require_login() ', [['lib','moodlelib.php',2887]], 68],
'groups_delete_groups': ['groups_delete_groups', 'Delete all groups from course ', [['group','lib.php',639]], 3],
'addreplyto': ['addreplyto', 'Add a "Reply-to" address. ', [['lib/phpmailer','class.phpmailer.php',761]], 2],
'swapshuffle_assoc': ['swapshuffle_assoc', 'Like {@link swapshuffle()}, but works on associative arrays ', [['lib','moodlelib.php',7783]], 0],
'email_is_not_allowed': ['email_is_not_allowed', 'Check that an email is allowed.  It returns an error message if there was a problem. ', [['lib','moodlelib.php',5898]], 3],
'object_property_exists': ['object_property_exists', 'Detect if an object or a class contains a given property will take an actual object or the name of a class ', [['lib','moodlelib.php',8798]], 0],
'array_is_nested': ['array_is_nested', 'Check if there is a nested array within the passed array ', [['lib','moodlelib.php',8567]], 0],
'get_all_versions_hash': ['get_all_versions_hash', 'Returns hash of all versions including core and all plugins. ', [['lib/classes','component.php',1069]], 5],
'get_file_browser': ['get_file_browser', 'Returns local file storage instance ', [['lib','moodlelib.php',5983]], 19],
'send_password_change_info': ['send_password_change_info', 'Sends an email containinginformation on how to change your password. ', [['lib','moodlelib.php',5848]], 1],
'reset_course_cache': ['reset_course_cache', 'Resets cache for the course (or all caches) To be called from {@link rebuild_course_cache()} ', [['course/format','lib.php',192]], 9],
'is_internal_auth': ['is_internal_auth', 'Returns true if an internal authentication method is being used. if method not specified then, global default is assumed ', [['lib','moodlelib.php',3649]], 0],
'display_size': ['display_size', 'Converts bytes into display form ', [['lib','moodlelib.php',6341]], 29],
'get_user_key': ['get_user_key', 'Gets a private user access key (and creates one if one doesn\'t exist). ', [['lib','moodlelib.php',3059]], 3],
'encode_stored_config': ['encode_stored_config', 'Encodes the array of emoticon objects into a string storable in config table ', [['lib','moodlelib.php',6827]], 2],
'perf_get_writes': ['perf_get_writes', 'Returns the number of writes done by this database. ', [['lib/dml','moodle_database.php',2536]], 13],
'delete_course': ['delete_course', 'Delete a course, including all related data from the database, and any associated files. ', [['lib','moodlelib.php',4640]], 14],
'is_internal': ['is_internal', 'Returns true if this authentication plugin is \'internal\'. ', [['auth/radius','auth.php',142],['lib','authlib.php',203],['auth/pam','auth.php',92],['auth/db','auth.php',650],['auth/email','auth.php',164],['auth/shibboleth','auth.php',161],['auth/none','auth.php',80],['auth/nologin','auth.php',62],['auth/cas','auth.php',67],['auth/mnet','auth.php',579],['auth/pop3','auth.php',97],['auth/nntp','auth.php',80],['auth/manual','auth.php',103],['auth/fc','auth.php',161],['auth/imap','auth.php',101],['auth/webservice','auth.php',90],['auth/ldap','auth.php',1590]], 18],
'locale_win_charset': ['locale_win_charset', 'This return locale for windows os. ', [['calendar/tests','calendartype_test_example.php',309],['calendar/type/gregorian/classes','structure.php',408]], 2],
'get_max_upload_file_size': ['get_max_upload_file_size', 'Returns the maximum size for uploading files. ', [['lib','moodlelib.php',6060]], 16],
'format_string': ['format_string', 'Given a simple string, this function returns the string processed by enabled string filters if $CFG->filterall is enabled ', [['lib','weblib.php',1318]], 854],
'random_string': ['random_string', 'Generate and return a random string of the specified length. ', [['lib','moodlelib.php',7443]], 32],
'me': ['me', 'Returns the name of the current script, WITH the querystring portion. ', [['lib','weblib.php',182]], 4],
'login_attempt_valid': ['login_attempt_valid', 'To be called after valid user login. ', [['lib','authlib.php',652]], 2],
'get_user_timezone': ['get_user_timezone', 'Returns user timezone. ', [['lib/classes','date.php',216],['lib','moodlelib.php',2279]], 69],
'rc4decrypt': ['rc4decrypt', 'rc4decrypt ', [['lib','moodlelib.php',6927]], 1],
'password_hash': ['password_hash', 'Hash the password using the specified algorithm ', [['lib/password_compat/lib','password.php',26]], 23],
'get_enabled_auth_plugins': ['get_enabled_auth_plugins', 'Returns array of active auth plugins. ', [['lib','moodlelib.php',3616]], 18],
'get_performance_summary': ['get_performance_summary', 'Returns information about the core_string_manager performance. ', [['lib/classes','string_manager_standard.php',397],['lib','filterlib.php',353]], 2],
'trigger': ['trigger', '', [['lib/evalmath','evalmath.class.php',438],['lib/classes/event','base.php',682]], 778],
'plugin_callback': ['plugin_callback', 'Invoke plugin\'s callback functions ', [['lib','moodlelib.php',7103]], 13],
'get_list_of_themes': ['get_list_of_themes', 'Returns a list of valid and compatible themes ', [['lib','moodlelib.php',6732]], 6],
'hash_internal_user_password': ['hash_internal_user_password', 'Calculate hash for a plain text password. ', [['lib','moodlelib.php',4394]], 12],
'login_user': ['login_user', 'Login user, to be called from complete_user_login() only. ', [['lib/classes/session','manager.php',451]], 2],
'get_emoticons': ['get_emoticons', 'Returns the currently enabled emoticons ', [['lib','moodlelib.php',6787]], 5],
'notification': ['notification', 'Output a notification (that is, a status message about something that has just happened). ', [['lib','outputrenderers.php',2762],['lib','outputrenderers.php',4128],['lib','outputrenderers.php',4201]], 495],
'get_complete_user_data': ['get_complete_user_data', 'Get a complete user record, which includes all the info in the user record. ', [['lib','moodlelib.php',4487]], 23],
'on': ['on', '', [['lib/requirejs','require.js',506]], 3494],
'check_php_version': ['check_php_version', 'Returns true if the current version of PHP is greater that the specified one. ', [['lib','moodlelib.php',7256]], 0],
'get_extra_user_fields_sql': ['get_extra_user_fields_sql', 'If the current user is to be shown extra user fields when listing or selecting users, returns a string suitable for including in an SQL select clause to retrieve those fields. ', [['lib','moodlelib.php',3504]], 13],
'check_consecutive_identical_characters': ['check_consecutive_identical_characters', 'Check whether the given password has no more than the specified number of consecutive identical characters. ', [['lib','moodlelib.php',9077]], 1],
'addaddress': ['addaddress', 'Add a "To" address. ', [['lib/phpmailer','class.phpmailer.php',726]], 3],
'get_weekday': ['get_weekday', 'Returns the index of the weekday for a specific calendar date. ', [['calendar/tests','calendartype_test_example.php',170],['calendar/type/gregorian/classes','structure.php',219]], 3],
'enrol_user_delete': ['enrol_user_delete', 'Called when user is about to be deleted. ', [['lib','enrollib.php',863]], 1],
'debugging': ['debugging', 'Standard Debugging Function ', [['lib','weblib.php',2854]], 853],
'required_param_array': ['required_param_array', 'Returns a particular array value for the named variable, taken from POST or GET.  If the parameter doesn\'t exist then an error is thrown because we require this variable. ', [['lib','moodlelib.php',560]], 14],
'get_component_directory': ['get_component_directory', 'Return exact absolute path to a plugin directory. ', [['lib/classes','component.php',1003],['lib','deprecatedlib.php',543]], 44],
'validateurlsyntax': ['validateurlsyntax', 'BEGINNING OF validateUrlSyntax() function ', [['lib','validateurlsyntax.php',167]], 8],
'optional_param_array': ['optional_param_array', 'Returns a particular array value for the named variable, taken from POST or GET, otherwise returning a given default. ', [['lib','moodlelib.php',648]], 71],
'get_directory_size': ['get_directory_size', 'Adds up all the files in a directory and works out the size. ', [['lib','moodlelib.php',6290]], 1],
'authenticate_user_login': ['authenticate_user_login', 'Authenticates a user against the chosen authentication mechanism ', [['lib','moodlelib.php',4052]], 19],
'create_from_userid': ['create_from_userid', 'Create instance of event. ', [['lib/classes/event','user_created.php',117],['lib/classes/event','user_updated.php',117]], 17],
'strlen': ['strlen', 'Multibyte safe strlen() function, uses mbstring or iconv for UTF-8, falls back to typo3. ', [['lib/classes','text.php',281],['lib/typo3','class.t3lib_cs.php',1520]], 1698],
'empty_tag': ['empty_tag', 'Outputs an empty tag with attributes ', [['lib','outputcomponents.php',1096]], 511],
'delete_comments': ['delete_comments', 'Delete comments ', [['comment','locallib.php',203],['comment','lib.php',750]], 3],
'count_records': ['count_records', 'Count the records in a table where all the given conditions met. ', [['lib/dml','moodle_database.php',1717]], 1399],
'complex_random_string': ['complex_random_string', 'Generate a complex random string (useful for md5 salts) ', [['lib','moodlelib.php',7461]], 1],
'delete_area_files': ['delete_area_files', 'Delete all area files (optionally limited by itemid). ', [['lib/filestorage','file_storage.php',740]], 117],
'terminate_current': ['terminate_current', 'Terminate current user session. ', [['lib/classes/session','manager.php',473]], 7],
'custom_script_path': ['custom_script_path', 'Detect a custom script replacement in the data directory that will replace an existing moodle script ', [['lib','moodlelib.php',8845]], 1],
'get_user_field_name': ['get_user_field_name', 'Returns the display name of a field in the user table. Works for most fields that are commonly displayed to users. ', [['lib','moodlelib.php',3531]], 35],
'set_pagelayout': ['set_pagelayout', 'Sets the layout to use for this page. ', [['lib','pagelib.php',1063]], 277],
'setdate': ['setdate', '', [['lib/google/src/Google/Service','QPXExpress.php',1112],['lib/google/src/Google/Service','AdExchangeBuyer.php',1180],['lib/google/src/Google/Service','Reports.php',865],['lib/zend/Zend/Service/Simpy','LinkQuery.php',121],['lib/google/src/Google/Service','Drive.php',4482],['lib/google/src/Google/Service','Books.php',4827],['lib/google/src/Google/Service','Directory.php',3141],['lib/zend/Zend','Date.php',2990],['lib/google/src/Google/Service','Calendar.php',3049],['lib/google/src/Google/Service','Analytics.php',4473],['lib/google/src/Google/Service','Analytics.php',4568]], 42],
'get_course_mods': ['get_course_mods', 'Just gets a raw list of all modules in a course ', [['lib','datalib.php',1248]], 7],
'site_scale_used': ['site_scale_used', 'This function returns the number of activities using scaleid in the entire site ', [['lib','moodlelib.php',7938]], 1],
'get_mnet_environment': ['get_mnet_environment', 'helper function to load up and initialise the mnet environment this must be called before you use mnet functions. ', [['lib','moodlelib.php',9168]], 14],
'fullname': ['fullname', 'Returns a persons full name ', [['lib','moodlelib.php',3234],['mod/assign','locallib.php',3440]], 532],
'login_attempt_failed': ['login_attempt_failed', 'To be called after failed user login. ', [['lib','authlib.php',672]], 20],
'mnet_get_peer_host': ['mnet_get_peer_host', '', [['mnet','lib.php',485]], 1],
'get_weekdays': ['get_weekdays', 'Returns an indexed list of all the names of the weekdays. ', [['calendar/tests','calendartype_test_example.php',148],['calendar/type/gregorian/classes','structure.php',151]], 4],
'get_plugin_list_with_function': ['get_plugin_list_with_function', 'Get a list of all the plugins of a given type that define a certain API function in a certain file. The plugin component names and function names are returned. ', [['lib','moodlelib.php',7009]], 15],
'create_user_key': ['create_user_key', 'Creates a new private user access key. ', [['lib','moodlelib.php',3016]], 5],
'clone': ['clone', '', [['lib/editor/tinymce/tiny_mce/3.5.11/plugins/media/js','media.js',11]], 315],
'rc4encrypt': ['rc4encrypt', 'rc4encrypt ', [['lib','moodlelib.php',6917]], 1],
'fix_utf8': ['fix_utf8', 'Makes sure the data is using valid utf8, invalid characters are discarded. ', [['lib','moodlelib.php',1222]], 32],
'message_mark_message_read': ['message_mark_message_read', 'Mark a single message as read ', [['message','lib.php',2392]], 8],
'login_is_lockedout': ['login_is_lockedout', 'Verify if user is locked out. ', [['lib','authlib.php',607]], 15],
'print_string': ['print_string', 'Prints out a translated string. ', [['lib','moodlelib.php',6680]], 458],
'microtime_diff': ['microtime_diff', 'Calculate the difference between two microtimes ', [['lib','moodlelib.php',7836]], 4],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required. ', [['lib/dml','pgsql_native_moodle_database.php',883],['lib/dml','oci_native_moodle_database.php',1249],['lib/dml','sqlsrv_native_moodle_database.php',978],['lib/dml','mssql_native_moodle_database.php',898],['lib/dml','mysqli_native_moodle_database.php',1177],['lib/dml/tests','dml_test.php',5427],['lib/dml','pdo_moodle_database.php',386],['question/engine/upgrade','upgradelib.php',121]], 1512],
'grade_regrade_final_grades': ['grade_regrade_final_grades', 'Updates all final grades in course. ', [['lib','gradelib.php',1008]], 27],
'try_guestaccess': ['try_guestaccess', 'Attempt to automatically gain temporary guest access to course, calling code has to make sure the plugin and instance are active. ', [['enrol/guest','lib.php',64],['lib','enrollib.php',1254]], 2],
'user_delete': ['user_delete', 'User delete requested - internal user record is mared as deleted already, username not present anymore. ', [['lib','authlib.php',266],['lib','enrollib.php',1856]], 2],
'require_login': ['require_login', 'This function checks that the current user is logged in and has the required privileges ', [['lib','moodlelib.php',2444]], 635],
'moodle_major_version': ['moodle_major_version', 'Returns the major version of this site ', [['lib','moodlelib.php',7296]], 4],
'sql_like': ['sql_like', 'Returns \'LIKE\' part of a query. ', [['lib/dml','pgsql_native_moodle_database.php',1273],['lib/dml','oci_native_moodle_database.php',1523],['lib/dml','sqlsrv_native_moodle_database.php',1224],['lib/dml','moodle_database.php',2004],['lib/dml','mssql_native_moodle_database.php',1160],['lib/dml','mysqli_native_moodle_database.php',1502]], 158],
'get_list_of_plugins': ['get_list_of_plugins', 'Lists plugin-like directories within specified directory ', [['lib','moodlelib.php',7043]], 11],
'shorten_text': ['shorten_text', 'Given some text (which may contain HTML) and an ideal length, this function truncates the text neatly on a word boundary if possible ', [['lib','moodlelib.php',7484]], 79],
'mark_dirty': ['mark_dirty', 'Mark a context as dirty (with timestamp) so as to force reloading of the context. ', [['lib','accesslib.php',5792]], 42],
'timestamp_to_date_string': ['timestamp_to_date_string', 'Returns a formatted string that represents a date in user time. ', [['calendar/tests','calendartype_test_example.php',219],['calendar/type/gregorian/classes','structure.php',276]], 3],
'has_capability': ['has_capability', 'Wrapper round the has_capability funciton that automatically passes in the quiz context. ', [['mod/quiz','attemptlib.php',299],['mod/quiz','attemptlib.php',884],['lib','accesslib.php',346]], 1929],
'is_enabled_auth': ['is_enabled_auth', 'Checks if a given plugin is in the list of enabled authentication plugins. ', [['lib','moodlelib.php',3580]], 30],
'plugin': ['plugin', 'The base class for all Plugin instances. ', [['lib/yuilib/3.17.2/plugin','plugin-debug.js',16],['lib/yuilib/3.17.2/plugin','plugin.js',16]], 9],
'translation_exists': ['translation_exists', 'Checks if the translation exists for the language ', [['lib/classes','string_manager_standard.php',492],['lib/classes','string_manager.php',93],['lib/classes','string_manager_install.php',198]], 10],
'addstringattachment': ['addstringattachment', 'Add a string or binary attachment (non-filesystem). This method can be used to attach ascii or binary data, such as a BLOB record from a database. ', [['lib/phpmailer','class.phpmailer.php',2528]], 2],
'unset_user_preference': ['unset_user_preference', 'Unsets a preference completely by deleting it from the database ', [['lib','moodlelib.php',1919]], 34],
'make_unique_id_code': ['make_unique_id_code', 'make_unique_id_code ', [['lib','moodlelib.php',7962]], 22],
'mimeinfo': ['mimeinfo', 'Obtains information about a filetype based on its extension. Will use a default if no information is present about that particular extension. ', [['lib','filelib.php',1393]], 35],
'format': ['format', 'Format the args for use in exception messages ', [['lib/lessphp/Tree/Mixin','Call.php',153],['mod/wiki/diff','diff_nwiki.php',703],['question/format/xml','format.php',1524]], 155],
'usertime': ['usertime', 'Given a GMT timestamp (seconds since epoch), offsets it by the timezone.  eg 3pm in India is 3pm GMT - 7 * 3600 seconds ', [['lib','moodlelib.php',2226]], 12],
'prepare_emoticon_object': ['prepare_emoticon_object', 'Helper method preparing the stdClass with the emoticon properties ', [['lib','moodlelib.php',6893]], 30],
'get_string': ['get_string', 'Return a core get_string() call ', [['lib/external','externallib.php',112],['lib','moodlelib.php',6538],['lib','moodlelib.php',9417],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38],['lib/classes','string_manager_install.php',95],['question/behaviour','behaviourbase.php',756]], 19235],
'mark_user_preferences_changed': ['mark_user_preferences_changed', 'Called from set/unset_user_preferences, so that the prefs can be correctly reloaded in different sessions. ', [['lib','moodlelib.php',1802]], 3],
'get_recordset_sql': ['get_recordset_sql', 'Get a number of records as a moodle_recordset using a SQL statement. ', [['lib/dml','pgsql_native_moodle_database.php',688],['lib/dml','oci_native_moodle_database.php',1065],['lib/dml','sqlsrv_native_moodle_database.php',761],['lib/dml','mssql_native_moodle_database.php',687],['lib/dml','mysqli_native_moodle_database.php',985],['lib/dml/tests','dml_test.php',5423],['lib/dml','pdo_moodle_database.php',251]], 279],
'user_authenticated_hook': ['user_authenticated_hook', 'Post authentication hook. This method is called from authenticate_user_login() for all enabled auth plugins. ', [['lib','authlib.php',458]], 1],
'moodle_process_email': ['moodle_process_email', '? ', [['lib','moodlelib.php',5265]], 0],
'get_users_from_config': ['get_users_from_config', 'Use this function to get a list of users from a config setting of type admin_setting_users_with_capability. ', [['lib','moodlelib.php',1545]], 2],
'grade_grab_course_grades': ['grade_grab_course_grades', 'Refetches grade data from course activities ', [['lib','gradelib.php',1146]], 3],
'validate_internal_user_password': ['validate_internal_user_password', 'Compare password against hash stored in user object to determine if it is valid. ', [['lib','moodlelib.php',4336]], 10],
'get_string_manager': ['get_string_manager', 'Returns current string_manager instance. ', [['lib','moodlelib.php',6481]], 147],
'get_plugin_directory': ['get_plugin_directory', 'Returns the exact absolute path to plugin directory. ', [['lib/classes','component.php',890],['lib','deprecatedlib.php',508]], 21],
'get_cm': ['get_cm', 'Obtains a single course-module object (for a course-module that is on this course). ', [['lib','modinfolib.php',222],['mod/quiz','attemptlib.php',215],['mod/quiz','attemptlib.php',701],['comment','lib.php',1006]], 96],
'check_password_policy': ['check_password_policy', 'Validate a password against the configured password policy ', [['lib','moodlelib.php',4580]], 13],
'delete_instance': ['delete_instance', 'The assignment has been deleted - remove the plugin specific data ', [['mod/assign','assignmentplugin.php',525],['mod/workshop/allocation/random','lib.php',243],['mod/assign/submission/file','locallib.php',447],['mod/assign/submission/onlinetext','locallib.php',538],['mod/workshop/form/accumulative','lib.php',375],['mod/workshop/form/rubric','lib.php',405],['mod/workshop/form/numerrors','lib.php',394],['lib','enrollib.php',1737],['mod/assign','locallib.php',677],['mod/workshop/form','lib.php',118],['mod/workshop/allocation/scheduled','lib.php',200],['mod/assign/feedback/editpdf','locallib.php',260],['mod/workshop/form/comments','lib.php',360],['mod/assign/feedback/file','locallib.php',256],['lib','accesslib.php',6060],['mod/workshop/eval','lib.php',59],['mod/workshop/allocation/manual','lib.php',349],['mod/assign/feedback/comments','locallib.php',458],['mod/workshop/eval/best','lib.php',125],['mod/workshop/allocation','lib.php',62]], 35],
'mtrace': ['mtrace', 'For outputting debugging info ', [['lib','moodlelib.php',8221]], 323],
'delete': ['delete', 'Deletes a key pair ', [['lib/zend/Zend/Service/Amazon/Ec2','Keypair.php',110],['lib/google/src/Google/Service','Reseller.php',440],['lib/phpexcel/PHPExcel/Shared/PCLZip','pclzip.lib.php',1006],['lib/adodb','adodb-active-recordx.inc.php',949],['lib/zend/Zend/Service/Delicious','Post.php',236],['lib/grade','grade_object.php',270],['lib/zend/Zend/Gdata','Gapps.php',258],['lib/google/src/Google/Service','Fusiontables.php',644],['lib/google/src/Google/Service','Fusiontables.php',809],['lib/google/src/Google/Service','Fusiontables.php',934],['lib/google/src/Google/Service','Fusiontables.php',1127],['lib/google/src/Google/Service','Fusiontables.php',1188],['blog','locallib.php',325],['lib/google/src/Google/Service','Blogger.php',1051],['lib/google/src/Google/Service','Blogger.php',1212],['lib/google/src/Google/Service','Blogger.php',1434],['lib/portfolio','plugin.php',692],['lib/google/src/Google/Service','AdExchangeBuyer.php',605],['lib/google/src/Google/Service','Manager.php',240],['lib/google/src/Google/Service','Manager.php',320],['lib/zend/Zend/Service/Amazon/Ec2','Securitygroups.php',137],['lib','webdavlib.php',691],['lib/grade','grade_item.php',354],['lib/google/src/Google/Service','Gmail.php',686],['lib/google/src/Google/Service','Gmail.php',843],['lib/google/src/Google/Service','Gmail.php',936],['lib/google/src/Google/Service','Gmail.php',1146],['course','lib.php',3133],['lib/google/src/Google/Service','Mirror.php',424],['lib/google/src/Google/Service','Mirror.php',592],['lib/google/src/Google/Service','Mirror.php',660],['lib/google/src/Google/Service','Mirror.php',771],['lib/google/src/Google/Service','Genomics.php',632],['lib/google/src/Google/Service','Genomics.php',731],['lib/google/src/Google/Service','Genomics.php',963],['lib/google/src/Google/Service','Genomics.php',1327],['lib/google/src/Google/Service','Genomics.php',1399],['cache/classes','interfaces.php',161],['lib/google/src/Google/Service','Dfareporting.php',470],['lib/zend/Zend/Gdata/Gbase','ItemEntry.php',133],['lib/google/src/Google/Service','Licensing.php',221],['lib/google/src/Google/Service','Drive.php',1462],['lib/google/src/Google/Service','Drive.php',1536],['lib/google/src/Google/Service','Drive.php',1681],['lib/google/src/Google/Service','Drive.php',1932],['lib/google/src/Google/Service','Drive.php',2002],['lib/google/src/Google/Service','Drive.php',2131],['lib/google/src/Google/Service','Drive.php',2294],['lib/google/src/Google/Service','Drive.php',2414],['completion','data_object.php',272],['lib/google/src/Google/Service','Books.php',1804],['lib/zend/Zend/Gdata','App.php',914],['lib/google/src/Google/Cache','Memcache.php',142],['lib/google/src/Google/Service','Bigquery.php',512],['lib/google/src/Google/Service','Bigquery.php',822],['cache','disabledlib.php',102],['lib/zend/Zend/Server','Cache.php',132],['lib/zend/Zend/Gdata/App','Entry.php',212],['cache/stores/memcached','lib.php',368],['lib/google/src/Google/Service','YouTube.php',1470],['lib/google/src/Google/Service','YouTube.php',1979],['lib/google/src/Google/Service','YouTube.php',2277],['lib/google/src/Google/Service','YouTube.php',2510],['lib/google/src/Google/Service','YouTube.php',2657],['lib/google/src/Google/Service','YouTube.php',2998],['lib/google/src/Google/Service','YouTube.php',3196],['lib/google/src/Google/Service','Webmasters.php',298],['lib/google/src/Google/Service','Webmasters.php',388],['lib/google/src/Google/Service','Autoscaler.php',314],['lib/google/src/Google/Service','Autoscaler.php',428],['calendar','lib.php',2388],['lib/zend/Zend/Service/Amazon','Sqs.php',129],['lib/google/src/Google/Service','ShoppingContent.php',553],['lib/google/src/Google/Service','ShoppingContent.php',735],['lib/google/src/Google/Service','ShoppingContent.php',969],['mod/lesson','locallib.php',1039],['mod/lesson','locallib.php',2274],['lib/google/src/Google/Service','SQLAdmin.php',628],['lib/google/src/Google/Service','SQLAdmin.php',923],['lib/google/src/Google/Service','Fitness.php',458],['lib/google/src/Google/Service','Fitness.php',563],['lib/google/src/Google/Service','TagManager.php',1049],['lib/google/src/Google/Service','TagManager.php',1140],['lib/google/src/Google/Service','TagManager.php',1233],['lib/google/src/Google/Service','TagManager.php',1326],['lib/google/src/Google/Service','TagManager.php',1419],['lib/google/src/Google/Service','TagManager.php',1513],['lib/google/src/Google/Service','TagManager.php',1607],['lib/google/src/Google/Service','TagManager.php',1757],['lib/google/src/Google/Service','Directory.php',1300],['lib/google/src/Google/Service','Directory.php',1477],['lib/google/src/Google/Service','Directory.php',1587],['lib/google/src/Google/Service','Directory.php',1642],['lib/google/src/Google/Service','Directory.php',1769],['lib/google/src/Google/Service','Directory.php',1838],['lib/google/src/Google/Service','Directory.php',1935],['lib/google/src/Google/Service','Directory.php',2042],['lib/google/src/Google/Service','Directory.php',2144],['lib/google/src/Google/Service','Directory.php',2205],['lib/google/src/Google/Service','Directory.php',2405],['lib/google/src/Google/Service','Directory.php',2480],['cache/stores/static','lib.php',374],['lib/google/src/Google/Service','AppState.php',153],['lib/google/src/Google/Service','Taskqueue.php',292],['lib/google/src/Google/Service','Container.php',343],['lib/google/src/Google/Service','AndroidPublisher.php',1177],['lib/google/src/Google/Service','AndroidPublisher.php',1257],['lib/google/src/Google/Service','AndroidPublisher.php',1595],['lib/google/src/Google/Service','AndroidPublisher.php',1690],['lib/google/src/Google/Service','AndroidPublisher.php',1972],['repository','lib.php',427],['repository','lib.php',2012],['lib','accesslib.php',5529],['lib/google/src/Google/Service','AdSenseHost.php',733],['lib/google/src/Google/Service','AdSenseHost.php',1009],['lib/google/src/Google/Service','AdSenseHost.php',1167],['cache/stores/memcache','lib.php',401],['lib','filelib.php',3440],['lib/google/src/Google/Service','MapsEngine.php',1692],['lib/google/src/Google/Service','MapsEngine.php',1990],['lib/google/src/Google/Service','MapsEngine.php',2343],['lib/google/src/Google/Service','MapsEngine.php',2650],['lib/google/src/Google/Service','MapsEngine.php',2911],['lib/grade','grade_grade.php',955],['comment','lib.php',786],['lib/google/src/Google/Service','SiteVerification.php',138],['lib/google/src/Google/Service','Prediction.php',261],['cache/stores/session','lib.php',417],['cache/classes','dummystore.php',198],['lib/google/src/Google/Service','Compute.php',2812],['lib/google/src/Google/Service','Compute.php',2896],['lib/google/src/Google/Service','Compute.php',3139],['lib/google/src/Google/Service','Compute.php',3225],['lib/google/src/Google/Service','Compute.php',3361],['lib/google/src/Google/Service','Compute.php',3463],['lib/google/src/Google/Service','Compute.php',3543],['lib/google/src/Google/Service','Compute.php',3662],['lib/google/src/Google/Service','Compute.php',3725],['lib/google/src/Google/Service','Compute.php',3844],['lib/google/src/Google/Service','Compute.php',3941],['lib/google/src/Google/Service','Compute.php',4080],['lib/google/src/Google/Service','Compute.php',4406],['lib/google/src/Google/Service','Compute.php',4543],['lib/google/src/Google/Service','Compute.php',4660],['lib/google/src/Google/Service','Compute.php',4740],['lib/google/src/Google/Service','Compute.php',4806],['lib/google/src/Google/Service','Compute.php',4927],['lib/google/src/Google/Service','Compute.php',5069],['lib/google/src/Google/Service','Compute.php',5229],['lib/google/src/Google/Service','Compute.php',5360],['badges/criteria','award_criteria.php',330],['badges/criteria','award_criteria_manual.php',220],['lib/google/src/Google/Service','Calendar.php',886],['lib/google/src/Google/Service','Calendar.php',1040],['lib/google/src/Google/Service','Calendar.php',1228],['lib/google/src/Google/Service','Calendar.php',1362],['lib/google/src/Google/Service','Analytics.php',2068],['lib/google/src/Google/Service','Analytics.php',2211],['lib/google/src/Google/Service','Analytics.php',2293],['lib/google/src/Google/Service','Analytics.php',2414],['lib/google/src/Google/Service','Analytics.php',2631],['lib/google/src/Google/Service','Analytics.php',2760],['lib/google/src/Google/Service','Analytics.php',2851],['lib/google/src/Google/Service','Analytics.php',3181],['lib/google/src/Google/Service','Analytics.php',3406],['lib/google/src/Google/Service','Tasks.php',309],['lib/google/src/Google/Service','Tasks.php',427],['cache/classes','loaders.php',777],['cache/classes','loaders.php',1491],['cache/classes','loaders.php',1859],['cache/stores/mongodb','lib.php',361],['lib/grade','grade_category.php',259],['cache/stores/file','lib.php',392],['lib/google/src/Google/Service','Storage.php',945],['lib/google/src/Google/Service','Storage.php',1060],['lib/google/src/Google/Service','Storage.php',1227],['lib/google/src/Google/Service','Storage.php',1349],['lib/google/src/Google/Service','Storage.php',1565],['admin/tool/uploadcourse/classes','course.php',226],['lib/google/src/Google/Cache','Null.php',51],['lib/filestorage','stored_file.php',323],['lib/filebrowser','virtual_root_file.php',69],['lib/google/src/Google/Service','AdSense.php',1257],['lib/google/src/Google/Service','AdSense.php',1729],['lib/google/src/Google/Service','Pubsub.php',239],['lib/google/src/Google/Service','Pubsub.php',378],['lib/grade','grade_scale.php',136],['lib/filebrowser','file_info.php',418],['lib/google/src/Google/Cache','File.php',106],['lib/htmlpurifier/HTMLPurifier','Zipper.php',89],['lib/google/src/Google/Service','Dns.php',370],['lib/filebrowser','file_info_stored.php',631],['lib/google/src/Google/Service','Replicapool.php',374],['lib/google/src/Google/Service','Resourceviews.php',419],['lib','badgeslib.php',620],['lib/google/src/Google/Cache','Apc.php',103],['lib/adodb','adodb-active-record.inc.php',792],['mnet','peer.php',122],['lib/grade','grade_outcome.php',97]], 260],
'get_records_select': ['get_records_select', 'Get a number of records as an array of objects which match a particular WHERE clause. ', [['lib/dml','moodle_database.php',1283]], 163],
'get_users_by_capability': ['get_users_by_capability', 'Who has this capability in this context? ', [['lib','accesslib.php',3707],['availability/classes','capability_checker.php',58]], 53],
'get_user_fieldnames': ['get_user_fieldnames', 'Returns an array of user fields ', [['lib','moodlelib.php',3676]], 1],
'clean_text': ['clean_text', 'Cleans raw text removing nasties. ', [['lib','weblib.php',1568]], 43],
'postlogout_hook': ['postlogout_hook', 'Post logout hook. ', [['lib','authlib.php',596],['auth/cas','auth.php',506]], 1],
'pre_loginpage_hook': ['pre_loginpage_hook', 'Hook for overriding behaviour before going to the login page. ', [['lib','authlib.php',438]], 2],
'set_mnet_remote_client': ['set_mnet_remote_client', 'during the xmlrpc server code execution, this will be called to setup the object returned by {@link get_mnet_remote_client} ', [['lib','moodlelib.php',9203]], 1],
'get_records': ['get_records', 'Get a number of records as an array of objects where all the given conditions met. ', [['lib/dml','moodle_database.php',1236],['lib','coursecatlib.php',654],['question','category_class.php',63]], 860],
'userdate': ['userdate', 'Also in ADORecordSet. ', [['lib/adodb','adodb.inc.php',2607],['lib/adodb','adodb.inc.php',3271],['lib','moodlelib.php',2150]], 496],
'grade_course_reset': ['grade_course_reset', 'Reset all course grades, refetch from the activities and recalculate ', [['lib','gradelib.php',1410]], 1],
'ismoving': ['ismoving', 'Determines if the logged in user is currently moving an activity ', [['lib','moodlelib.php',3219]], 6],
'get_records_menu': ['get_records_menu', 'Get the first two columns from a number of records as an associative array where all the given conditions met. ', [['lib/dml','moodle_database.php',1326]], 69],
'set_user_preferences': ['set_user_preferences', 'Sets a whole array of preferences for the current user ', [['lib','moodlelib.php',1900]], 4],
'increment_revision_number': ['increment_revision_number', 'Increment standard revision field. ', [['lib','datalib.php',1215]], 13],
'is_newnav': ['is_newnav', 'Check if the passed navigation is of the new style ', [['lib','moodlelib.php',8985]], 0],
'fullclone': ['fullclone', 'This function will make a complete copy of anything it\'s given, regardless of whether it\'s an object or not. ', [['lib','moodlelib.php',8438]], 24],
'set_course': ['set_course', 'Set the course data. ', [['mod/assign','locallib.php',255],['lib','pagelib.php',894]], 53],
'make_grades_menu': ['make_grades_menu', 'Creates an array that represents all the current grades that can be chosen using the given grading type. ', [['lib','moodlelib.php',7866]], 10],
'get_parent_language': ['get_parent_language', 'Returns parent language of current active language if defined ', [['lib','moodlelib.php',6432],['lib','componentlib.class.php',764],['lib/tests','componentlib_test.php',169]], 4],
'get_admin': ['get_admin', 'Returns $user object of the main admin user ', [['lib','datalib.php',53]], 65],
'set_login_session_preferences': ['set_login_session_preferences', 'When logging in, this function is run to set certain preferences for the current SESSION. ', [['lib','moodlelib.php',4626]], 1],
'remove_temp_course_roles': ['remove_temp_course_roles', 'Removes any extra guest roles from current USER->access array. This is useful for enrol plugins only. ', [['lib','accesslib.php',1308]], 9],
'get_realuser': ['get_realuser', 'Returns the $USER object ignoring current login-as session ', [['lib/classes/session','manager.php',794]], 10],
'get_child_contexts': ['get_child_contexts', 'Recursive function which, given a context, find all its children contexts. ', [['lib','deprecatedlib.php',3408],['lib','accesslib.php',5616],['lib','accesslib.php',6272],['lib','accesslib.php',6649],['lib','accesslib.php',7372]], 24],
'get_custom_user_profile_fields': ['get_custom_user_profile_fields', 'Return custom user profile fields. ', [['lib','authlib.php',573]], 9],
'message_move_userfrom_unread2read': ['message_move_userfrom_unread2read', 'Moves messages from a particular user from the message table (unread messages) to message_read This is typically only used when a user is deleted ', [['message','lib.php',2353]], 1],
'is_synchronised_with_external': ['is_synchronised_with_external', 'Indicates if moodle should automatically update internal user records with data from external sources using the information from get_userinfo() method. ', [['lib','authlib.php',223],['auth/db','auth.php',664]], 1],
'iserror': ['iserror', '', [['lib/zend/Zend/Rest/Client','Result.php',195],['lib/pear','PEAR.php',239],['lib/phpmailer','class.phpmailer.php',2836],['lib/adodb','adodb-pear.inc.php',204],['lib','boxlib.php',880],['lib/zend/Zend/Http','Response.php',194],['lib/pear/HTML','QuickForm.php',1910]], 28],
'addattachment': ['addattachment', 'Add an attachment from a path on the filesystem. Returns false if the file could not be found or read. ', [['lib/phpmailer','class.phpmailer.php',2059],['lib/horde/framework/Horde/Mime','Mail.php',287]], 3],
'get_login_url': ['get_login_url', 'Returns full login url. ', [['lib','moodlelib.php',2427],['lib','oauthlib.php',466]], 48],
'set_field': ['set_field', 'Sets the custom profile field used for testing. ', [['availability/condition/profile/tests','condition_test.php',349],['lib/dml','moodle_database.php',1688]], 462],
'get_cache_flag': ['get_cache_flag', 'Get volatile flags ', [['lib','moodlelib.php',1657]], 2],
'decode_stored_config': ['decode_stored_config', 'Decodes the string into an array of emoticon objects ', [['lib','moodlelib.php',6838]], 2],
'convert': ['convert', '', [['backup/cc/cc_lib','cc_converter_basiclti.php',36],['backup/cc/cc_lib','cc_converter_page.php',35],['backup/cc/cc_lib','cc_converter_lti.php',36],['backup/cc/cc_lib','cc_converter_url.php',36],['lib/htmlpurifier/HTMLPurifier','UnitConverter.php',63],['backup/cc/cc_lib','cc_converter_resource.php',34],['lib/editor/tinymce/tiny_mce/3.5.11','tiny_mce_src.js',18498],['backup/cc/cc_lib','cc_converter_quiz.php',40],['lib/lessphp','Functions.php',450],['lib/classes','text.php',162],['backup/converter','convertlib.php',119],['backup/cc/cc_lib','cc_converter_label.php',33],['backup/controller','restore_controller.class.php',437],['lib','wiki_to_markdown.php',315],['backup/cc/cc_lib','cc_convert_moodle2.php',29],['backup/cc/cc_lib','cc_converter_forum.php',36],['lib','navigationlib.php',4819],['backup/cc/cc_lib','cc_converter_folder.php',33]], 138],
'make': ['make', '', [['mod/quiz/accessrule/delaybetweenattempts','rule.php',40],['admin/tool/generator/classes','site_backend.php',89],['mod/quiz/accessrule/numattempts','rule.php',40],['lib/htmlpurifier/HTMLPurifier','AttrDef.php',67],['mod/quiz/accessrule/securewindow','rule.php',55],['lib/htmlpurifier/HTMLPurifier/ConfigSchema/Interchange','Id.php',52],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','Bool.php',45],['mod/quiz/accessrule/ipaddress','rule.php',40],['lib/htmlpurifier/HTMLPurifier','DoctypeRegistry.php',96],['lib/yuilib/2in3/2.9.0/build/yui2-logger','yui2-logger.js',655],['mod/quiz/accessrule/safebrowser','rule.php',40],['admin/tool/generator/classes','course_backend.php',202],['backup/util/ui','backup_ui_setting.class.php',234],['admin/tool/assignmentupgrade','locallib.php',110],['cache/classes','loaders.php',163],['lib/htmlpurifier/HTMLPurifier/AttrDef','Clone.php',38],['mod/quiz/accessrule','accessrulebase.php',63],['lib/htmlpurifier/HTMLPurifier/AttrDef','Enum.php',60],['mod/quiz/accessrule/timelimit','rule.php',41],['mod/quiz/accessrule/openclosedate','rule.php',40],['lib/yuilib/2in3/2.9.0/build/yui2-logger','yui2-logger-debug.js',655],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','Pixels.php',64],['lib/htmlpurifier/HTMLPurifier','Length.php',52],['lib/htmlpurifier/HTMLPurifier/AttrDef','URI.php',33],['mod/quiz/accessrule/password','rule.php',40]], 163],
'get_popup_notification_allowed': ['get_popup_notification_allowed', 'Are popup notifications allowed on this page? Popup notifications may be disallowed in situations such as while upgrading or completing a quiz ', [['lib','pagelib.php',1896]], 1],
'password_verify': ['password_verify', 'Verify a password against a hash using a timing attack resistant approach ', [['lib/password_compat/lib','password.php',222]], 10],
'groups_delete_groupings_groups': ['groups_delete_groupings_groups', 'Remove all groups from all groupings in course ', [['group','lib.php',608]], 2],
'filter_delete_all_for_context': ['filter_delete_all_for_context', 'Delete all the data in the database relating to a context, used when contexts are deleted. ', [['lib','filterlib.php',1117]], 3],
'get_user_max_upload_file_size': ['get_user_max_upload_file_size', 'Returns the maximum size for uploading files for the current user ', [['lib','moodlelib.php',6112]], 13],
'dst_offset_on': ['dst_offset_on', 'Calculates the Daylight Saving Offset for a given date/time (timestamp) - Note: Daylight saving only works for string timezones and not for float. ', [['lib','moodlelib.php',2311]], 14],
'reset_text_filters_cache': ['reset_text_filters_cache', 'Resets some data related to filters, called during upgrade or when general filter settings change. ', [['lib','weblib.php',1284]], 4],
'get_stats': ['get_stats', 'Return the stats collected so far. ', [['cache/classes','helper.php',456],['lib','csslib.php',975]], 2],
'current_language': ['current_language', 'Returns the code for the current language ', [['lib','moodlelib.php',6392]], 44],
'getoffset': ['getoffset', '', [['lib/google/src/Google/Service','Genomics.php',2484],['lib/google/src/Google/Service','Datastore.php',1167]], 20],
'find_day_in_month': ['find_day_in_month', 'Calculates when the day appears in specific month ', [['lib','moodlelib.php',2334]], 6],
'get_support_user': ['get_support_user', 'Return support user record, this is currently used in messaging system only for sending messages to support email. $CFG->supportuserid is set then returns user record $CFG->supportemail is set then return dummy record with $CFG->supportemail else return admin user record with hard-coded $user->emailstop = 0, so user gets support message. ', [['lib/classes','user.php',162]], 21],
'start_tag': ['start_tag', '', [['backup/util/xml/parser','progressive_parser.class.php',215],['lib','outputcomponents.php',1075]], 694],
'b': ['b', '', [['lib/flowplayer','flowplayer-3.2.13.js',321]], 477],
'guest_user': ['guest_user', 'Retrieve the guest user object. ', [['lib','moodlelib.php',4035]], 9],
'get_record': ['get_record', 'Get a single database record as an object where all the given conditions met. ', [['lib/dml','moodle_database.php',1413]], 2960],
'iconv': ['iconv', 'iconv wrapper which mutes errors and works around bugs. ', [['lib/htmlpurifier/HTMLPurifier','Encoder.php',40]], 21],
'get_mailer': ['get_mailer', 'Get mailer instance, enable buffering, flush buffer or disable buffering. ', [['lib','moodlelib.php',5296]], 12],
'get_strings': ['get_strings', 'Return multiple call to core get_string() ', [['lib/external','externallib.php',177],['lib','moodlelib.php',6665]], 13],
'record_exists': ['record_exists', 'Test whether a record exists in a table where all the given conditions met. ', [['lib/dml','moodle_database.php',1768]], 735],
'notice': ['notice', 'Print a message and exit. ', [['lib','weblib.php',2481],['lib/mustache/src/Mustache','Logger.php',102],['lib/google/src/Google/Logger','Abstract.php',224],['lib/mustache/src/Mustache/Logger','AbstractLogger.php',87]], 77],
'over_bounce_threshold': ['over_bounce_threshold', 'Check whether the user has exceeded the bounce threshold ', [['lib','moodlelib.php',3133]], 3],
'enrol_get_instances': ['enrol_get_instances', 'Returns enrolment instances in given course. ', [['lib','enrollib.php',140]], 27],
'swapshuffle': ['swapshuffle', 'Given a simple array, this shuffles it up just like shuffle() Unlike PHP\'s shuffle() this function works on any machine. ', [['lib','moodlelib.php',7764]], 1],
'create_from_user': ['create_from_user', 'Create instance of event. ', [['mod/assign/classes/event','submission_locked.php',44],['lib/classes/event','user_password_updated.php',44],['mod/assign/classes/event','submission_unlocked.php',44],['mod/assign/classes/event','workflow_state_updated.php',50],['mod/assign/classes/event','submission_form_viewed.php',50],['mod/assign/classes/event','grading_form_viewed.php',50]], 16],
'set': ['set', '', [['lib/adodb','adodb-active-recordx.inc.php',620],['lib/phpexcel/PHPExcel/Shared/JAMA','Matrix.php',286],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Serializer.php',31],['lib/portfolio','plugin.php',647],['lib/portfolio','exporter.php',154],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Mongo.php',167],['lib/pear/Net/GeoIP','Location.php',125],['cache/classes','interfaces.php',68],['lib/htmlpurifier/HTMLPurifier','AttrTypes.php',85],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Template.php.in',39],['lib/google/src/Google/Cache','Memcache.php',111],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Hashtable.php',162],['cache','disabledlib.php',81],['grade/report/singleview/classes/local/ui','finalgrade.php',136],['cache/stores/memcached','lib.php',320],['lib/google/src/Google/Service','YouTube.php',3122],['lib/google/src/Google/Service','YouTube.php',3481],['lib/zend/Zend','Registry.php',153],['lib/phpmailer','class.phpmailer.php',3144],['grade/report/singleview/classes/local/ui','feedback.php',102],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Db.php',114],['lib/google/src/Google/Service','ShoppingContent.php',919],['lib/htmlpurifier/HTMLPurifier','PropertyList.php',51],['grade/report/singleview/classes/local/ui','override.php',95],['lib/horde/framework/Horde','Variables.php',189],['lib/htmlpurifier/HTMLPurifier','Config.php',289],['cache/stores/static','lib.php',265],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Null.php',24],['lib/portfolio','caller.php',187],['lib/zend/Zend','Date.php',1056],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Memory.php',47],['cache/stores/memcache','lib.php',358],['lib','filelib.php',3615],['cache/stores/session','lib.php',290],['cache/classes','dummystore.php',170],['lib/horde/framework/Horde/Imap/Client','Cache.php',127],['grade/report/singleview/classes/local/ui','exclude.php',77],['cache/classes','loaders.php',484],['cache/classes','loaders.php',1370],['cache/classes','loaders.php',1815],['cache/stores/mongodb','lib.php',305],['lib/zend/Zend/Service','Audioscrobbler.php',125],['cache/stores/file','lib.php',425],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Decorator.php',60],['lib/google/src/Google/Cache','Null.php',42],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Null.php',41],['lib/google/src/Google/Cache','File.php',84],['lib','navigationlib.php',5017],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Cleanup.php',41],['lib/google/src/Google/Cache','Apc.php',80],['lib/adodb','adodb-active-record.inc.php',569],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Cache.php',203]], 4687],
'string_exists': ['string_exists', 'Does the string actually exist? ', [['lib/classes','string_manager_standard.php',263],['lib/classes','string_manager.php',50],['lib/classes','string_manager_install.php',64]], 76],
'ismail': ['ismail', 'Send messages using PHP\'s mail() function. ', [['lib/phpmailer','class.phpmailer.php',685]], 2],
'validate_email': ['validate_email', 'Validates an email to make sure it makes sense. ', [['lib','weblib.php',1042]], 16],
'invalidate_by_definition': ['invalidate_by_definition', 'Invalidates a given set of keys from a given definition. ', [['cache/classes','helper.php',206]], 35],
'perf_get_queries_time': ['perf_get_queries_time', 'Time waiting for the database engine to finish running all queries. ', [['lib/dml','moodle_database.php',2552]], 5],
'addcustomheader': ['addcustomheader', 'Add a custom header. $name value can be overloaded to contain both header name and value (name:value) ', [['lib/phpmailer','class.phpmailer.php',2864],['lib/phpmailer','moodle_phpmailer.php',64]], 3],
'is_restored_user': ['is_restored_user', 'Returns true if the user is a \'restored\' one. ', [['lib','moodlelib.php',3662]], 2],
'getweek': ['getweek', '', [['lib/google/src/Google/Service','Urlshortener.php',278],['lib','moodlelib.php',7626],['lib/zend/Zend','Date.php',4615]], 0],
'or': ['or', '', [['lib/tcpdf','LICENSE.TXT',69]], 552],
'in_object_vars': ['in_object_vars', 'Checks whether the given variable name is defined as a variable within the given object. ', [['lib','moodlelib.php',8999]], 0],
'remove_course_contents': ['remove_course_contents', 'Clear a course out completely, deleting all content but don\'t delete the course itself. ', [['lib','moodlelib.php',4698]], 4],
'date_format_string': ['date_format_string', 'Returns a formatted date ensuring it is UTF-8. ', [['lib','moodlelib.php',2171]], 21],
'get_courses': ['get_courses', 'Returns list of courses, for whole site, or category ', [['lib','datalib.php',592],['course','externallib.php',390],['course','externallib.php',2151],['badges/criteria','award_criteria_courseset.php',76],['lib','coursecatlib.php',1332]], 56],
'get_course_display_name_for_list': ['get_course_display_name_for_list', 'Gets the name of a course to be displayed when showing a list of courses. By default this is just $course->fullname but user can configure it. The result of this function should be passed through print_string. ', [['lib','moodlelib.php',9254]], 17],
'write_close': ['write_close', 'No more changes in session expected. Unblocks the sessions, other scripts may start executing in parallel. ', [['lib/classes/session','manager.php',509]], 45],
'clean_param_array': ['clean_param_array', 'Makes sure array contains only the allowed types, this function does not validate array key names! ', [['lib','moodlelib.php',738]], 17],
'js_init_call': ['js_init_call', 'Ensure that the specified JavaScript function is called from an inline script from page footer. ', [['lib','outputrequirementslib.php',1050]], 95],
'override_active_url': ['override_active_url', 'This sets the URL that the URL of new nodes get compared to when locating the active node. ', [['lib','navigationlib.php',237]], 89],
'count_words': ['count_words', 'Count words in a string. ', [['lib','moodlelib.php',7404]], 16],
'get_capability_info': ['get_capability_info', 'Returns capability information (cached) ', [['lib','accesslib.php',2940]], 7],
'reset_course_userdata': ['reset_course_userdata', 'This function will empty a course of user data. It will retain the activities and the structure of the course. ', [['lib','moodlelib.php',5003]], 2],
'mnet_get_app_jumppath': ['mnet_get_app_jumppath', '', [['mnet','lib.php',545]], 1],
'unenrol_user': ['unenrol_user', 'Unenrol remote user from our course ', [['enrol/mnet','enrol.php',198],['enrol/guest','lib.php',59],['lib','enrollib.php',1425],['enrol','locallib.php',626]], 53],
'format_time': ['format_time', 'Format a date/time (seconds) as weeks, days, hours etc as needed ', [['lib','moodlelib.php',2060]], 59],
'allow_unenrol': ['allow_unenrol', 'Does this plugin allow manual unenrolment of all users? All plugins allowing this must implement \'enrol/xxx:unenrol\' capability ', [['lib','enrollib.php',1189],['enrol/paypal','lib.php',85],['enrol/manual','lib.php',42],['enrol/flatfile','lib.php',59],['enrol/self','lib.php',101]], 5],
'prelogout_hook': ['prelogout_hook', 'Pre logout hook. This method is called from require_logout() for all enabled auth plugins, ', [['lib','authlib.php',470],['auth/mnet','auth.php',841]], 1],
'isloggedin': ['isloggedin', 'Return true, if session is currently logged into the backend server ', [['lib/zend/Zend/Service','LiveDocx.php',293],['lib','accesslib.php',1909]], 177],
'user_not_fully_set_up': ['user_not_fully_set_up', 'Determines if a user has completed setting up their account. ', [['lib','moodlelib.php',3120]], 7],
'profile_save_data': ['profile_save_data', 'Saves profile data for a user. ', [['user/profile','lib.php',479]], 10],
'set_bounce_count': ['set_bounce_count', 'Increment or reset user\'s email bounce count ', [['lib','moodlelib.php',3197]], 2],
'allow_unenrol_user': ['allow_unenrol_user', 'Does this plugin allow manual unenrolment of a specific user? Yes, but only if user suspended... ', [['enrol/database','lib.php',68],['enrol/cohort','lib.php',179],['lib','enrollib.php',1200],['enrol/flatfile','lib.php',70],['enrol/meta','lib.php',80]], 11],
'remove_course_grades': ['remove_course_grades', 'Remove all grade related course data Grade history is kept ', [['lib','gradelib.php',1245]], 2],
'order_in_string': ['order_in_string', 'Returns an array of values in order of occurance in a provided string. The key in the result is the character postion in the string. ', [['lib','moodlelib.php',3440]], 8],
'unformat_float': ['unformat_float', 'Converts locale specific floating point/comma number back to standard PHP float value Do NOT try to do any math operations before this conversion on any user submitted floats! ', [['lib','moodlelib.php',7739]], 50],
'count_letters': ['count_letters', 'Count letters in a string. ', [['lib','moodlelib.php',7427]], 0],
'note_delete_all': ['note_delete_all', 'Delete all notes about users in course- ', [['notes','lib.php',334]], 2],
'issmtp': ['issmtp', 'Send messages using SMTP. ', [['lib/phpmailer','class.phpmailer.php',676]], 3],
'question_delete_course': ['question_delete_course', 'All question categories and their questions are deleted for this course. ', [['lib','questionlib.php',308]], 1],
'object_array_unique': ['object_array_unique', 'Returns an array without repeated objects. This function is similar to array_unique, but for arrays that have objects as values ', [['lib','moodlelib.php',9014]], 0],
'settimezone': ['settimezone', 'Change server and default php timezones. ', [['lib/phpunit/classes','advanced_testcase.php',504],['lib/zend/Zend/Date','DateObject.php',985],['lib/zend/Zend/Gdata/Calendar','EventEntry.php',143],['lib/google/src/Google/Service','IdentityToolkit.php',1543],['lib/google/src/Google/Service','ShoppingContent.php',1921],['lib/phpexcel/PHPExcel/Shared','TimeZone.php',60],['lib/zend/Zend/Gdata/Calendar','ListFeed.php',100],['lib/google/src/Google/Service','Calendar.php',2047],['lib/google/src/Google/Service','Calendar.php',2275],['lib/google/src/Google/Service','Calendar.php',3065],['lib/google/src/Google/Service','Calendar.php',3409],['lib/google/src/Google/Service','Calendar.php',3538],['lib/google/src/Google/Service','Analytics.php',7644],['lib/google/src/Google/Service','AdSense.php',2171],['lib/zend/Zend/Gdata/Calendar','EventFeed.php',100],['lib/zend/Zend/Gdata/Calendar','ListEntry.php',225]], 96],
'address_in_subnet': ['address_in_subnet', 'Function to check the passed address is within the passed subnet ', [['lib','moodlelib.php',7996]], 80],
'html_is_blank': ['html_is_blank', 'Tests whether anything was returned by text editor ', [['lib','moodlelib.php',1316]], 11],
'get_host_from_url': ['get_host_from_url', 'Returns host part from url. ', [['lib','moodlelib.php',1302]], 3],
'require_logout': ['require_logout', 'This function just makes sure a user is logged out. ', [['lib','moodlelib.php',2836]], 6],
'user_login': ['user_login', 'Returns true if the username and password work and false if they are wrong or don\'t exist. ', [['auth/radius','auth.php',46],['lib','authlib.php',132],['auth/pam','auth.php',62],['auth/db','auth.php',50],['auth/email','auth.php',42],['auth/shibboleth','auth.php',46],['auth/none','auth.php',42],['auth/nologin','auth.php',42],['auth/cas','auth.php',53],['auth/mnet','auth.php',44],['auth/pop3','auth.php',43],['auth/nntp','auth.php',43],['auth/manual','auth.php',56],['auth/fc','auth.php',45],['auth/imap','auth.php',43],['auth/webservice','auth.php',43],['auth/ldap','auth.php',153]], 15],
'shift_course_mod_dates': ['shift_course_mod_dates', 'Change dates in module - used from course reset. ', [['lib','moodlelib.php',4968]], 9],
'username_load_fields_from_object': ['username_load_fields_from_object', 'Reduces lines of duplicated code for getting user name fields. ', [['lib','moodlelib.php',3403]], 27],
'exists_auth_plugin': ['exists_auth_plugin', 'Returns whether a given authentication plugin exists. ', [['lib','moodlelib.php',3565]], 4],
'asort_objects_by_method': ['asort_objects_by_method', 'Locale aware sort of objects by a method in common to all objects ', [['lib/classes','collator.php',268]], 3],
'get_file_packer': ['get_file_packer', 'Returns file packer ', [['lib','moodlelib.php',6004]], 58],
'truncate_userinfo': ['truncate_userinfo', 'Will truncate userinfo as it comes from auth_get_userinfo (from external auth) which may have large fields. ', [['lib','moodlelib.php',3844]], 6],
'get_cache_flags': ['get_cache_flags', 'Get volatile flags ', [['lib','moodlelib.php',1632]], 10],
'complete_user_login': ['complete_user_login', 'Call to complete the user login process after authenticate_user_login() has succeeded. It will setup the $USER variable and other required bits and pieces. ', [['lib','moodlelib.php',4261]], 10],
'sesskey': ['sesskey', 'Makes sure that $USER->sesskey exists, if $USER itself exists. It sets a new sesskey if one does not already exist, but does not overwrite existing sesskeys. Returns the sesskey string if $USER exists, or boolean false if not. ', [['lib','sessionlib.php',28]], 631],
'count_records_sql': ['count_records_sql', 'Get the result of a SQL SELECT COUNT(...) query. ', [['lib/dml','moodle_database.php',1747]], 132],
'delete_all_completion_data': ['delete_all_completion_data', 'Deletes all activity and course completion data for an entire course (the below delete_all_state function does this for a single activity). ', [['lib','completionlib.php',787]], 1],
'cleardoubleslashes': ['cleardoubleslashes', 'Replace 1 or more slashes or backslashes to 1 slash ', [['lib','moodlelib.php',8245]], 8],
'is_viewing': ['is_viewing', 'Returns true if the user has moodle/course:view capability in the course, this is intended for admins, managers (aka small admins), inspectors, etc. ', [['lib','accesslib.php',2004]], 25],
'sql_like_escape': ['sql_like_escape', 'Escape sql LIKE special characters like \'_\' or \'%\'. ', [['lib/dml','moodle_database.php',2024]], 16],
'__set_state': ['__set_state', 'Magic __set_state method used for var_export ', [['lib','moodlelib.php',9478],['lib/lessphp','Tree.php',77]], 0],
'get_performance_info': ['get_performance_info', 'get_performance_info() pairs up with init_performance_info() loaded in setup.php. Returns an array with \'html\' and \'txt\' values ready for use, and each of the individual stats provided separately as well. ', [['lib','moodlelib.php',8582],['lib/classes/session','manager.php',102]], 4],
'endecrypt': ['endecrypt', 'Based on a class by Mukul Sabharwal [mukulsabharwal @ yahoo.com] ', [['lib','moodlelib.php',6937]], 2],
'gc_cache_flags': ['gc_cache_flags', 'Garbage-collect volatile flags ', [['lib','moodlelib.php',1737]], 1],
'tag': ['tag', 'Outputs a tag with attributes and contents ', [['lib','outputcomponents.php',1063],['lib/zend/Zend/Service','Technorati.php',228]], 1254],
'set_user': ['set_user', 'Set current user. ', [['lib/classes/session','manager.php',681]], 29],
'enrol_course_delete': ['enrol_course_delete', 'Called when course is about to be deleted. ', [['lib','enrollib.php',880]], 1],
'update_user_login_times': ['update_user_login_times', 'Modify the user table by setting the currently logged in user\'s last login to now. ', [['lib','moodlelib.php',3082]], 1],
'moodle_needs_upgrading': ['moodle_needs_upgrading', 'Determine if moodle installation requires update. ', [['lib','moodlelib.php',7268]], 7],
'get_site': ['get_site', 'Returns $course object of the top-level site. ', [['lib','datalib.php',547]], 76],
'email_to_user': ['email_to_user', 'Send an email to a specified user ', [['lib','moodlelib.php',5419]], 21],
'generate_email_signoff': ['generate_email_signoff', 'Generate a signoff for emails based on support settings ', [['lib','moodlelib.php',5682]], 6],
'get_site_identifier': ['get_site_identifier', 'Returns the site identifier ', [['lib','moodlelib.php',9062],['cache/tests/fixtures','lib.php',282],['cache/classes','config.php',309],['cache/classes','helper.php',616]], 9],
'get': ['get', 'Gets a customer resource if one exists and is owned by the reseller. (customers.get) ', [['lib/google/src/Google/Service','Reseller.php',294],['lib/google/src/Google/Service','Reseller.php',457],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/media/js','media.js',7],['lib/google/src/Google/Service','Replicapoolupdater.php',275],['lib/zend/Zend/Gdata','Gapps.php',187],['lib/google/src/Google/Service','Fusiontables.php',658],['lib/google/src/Google/Service','Fusiontables.php',823],['lib/google/src/Google/Service','Fusiontables.php',947],['lib/google/src/Google/Service','Fusiontables.php',1141],['lib/google/src/Google/Service','Fusiontables.php',1202],['lib/phpexcel/PHPExcel/Shared/JAMA','Matrix.php',148],['lib/htmlpurifier/HTMLPurifier','Context.php',36],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Serializer.php',67],['lib/horde/framework/Horde/Imap/Client/Fetch','Results.php',78],['lib/lessphp','Cache.php',27],['lib/google/src/Google/Service','Blogger.php',931],['lib/google/src/Google/Service','Blogger.php',962],['lib/google/src/Google/Service','Blogger.php',1066],['lib/google/src/Google/Service','Blogger.php',1184],['lib/google/src/Google/Service','Blogger.php',1226],['lib/google/src/Google/Service','Blogger.php',1365],['lib/google/src/Google/Service','Blogger.php',1448],['lib/google/src/Google/Service','Blogger.php',1669],['lib/google/src/Google/Service','Doubleclicksearch.php',256],['lib/google/src/Google/Service','Doubleclicksearch.php',380],['lib/portfolio','plugin.php',631],['lib/google/src/Google/Service','AdExchangeBuyer.php',349],['lib/google/src/Google/Service','AdExchangeBuyer.php',419],['lib/google/src/Google/Service','AdExchangeBuyer.php',460],['lib/google/src/Google/Service','AdExchangeBuyer.php',528],['lib/google/src/Google/Service','AdExchangeBuyer.php',620],['lib/google/src/Google/Service','Manager.php',255],['lib/google/src/Google/Service','Manager.php',334],['lib/google/src/Google/Service','Reports.php',374],['lib/google/src/Google/Service','Reports.php',408],['lib/portfolio','exporter.php',134],['lib','webdavlib.php',264],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Mongo.php',105],['lib/simplepie/library/SimplePie/Parse','Date.php',567],['lib/google/src/Google/Service','Gmail.php',702],['lib/google/src/Google/Service','Gmail.php',859],['lib/google/src/Google/Service','Gmail.php',952],['lib/google/src/Google/Service','Gmail.php',1118],['lib/google/src/Google/Service','Gmail.php',1162],['lib/google/src/Google/Service','Plus.php',352],['lib/google/src/Google/Service','Plus.php',427],['lib/google/src/Google/Service','Plus.php',547],['lib/horde/framework/Horde/Support','ConsistentHash.php',69],['lib/testing/classes','nasty_strings.php',73],['lib/google/src/Google/Service','Mirror.php',437],['lib/google/src/Google/Service','Mirror.php',522],['lib/google/src/Google/Service','Mirror.php',562],['lib/google/src/Google/Service','Mirror.php',673],['lib/google/src/Google/Service','Mirror.php',785],['lib/google/src/Google/Service','Genomics.php',645],['lib/google/src/Google/Service','Genomics.php',744],['lib/google/src/Google/Service','Genomics.php',891],['lib/google/src/Google/Service','Genomics.php',997],['lib/google/src/Google/Service','Genomics.php',1187],['lib/google/src/Google/Service','Genomics.php',1269],['lib/google/src/Google/Service','Genomics.php',1340],['lib/google/src/Google/Service','Genomics.php',1430],['lib/google/src/Google/Service','Urlshortener.php',108],['cache/classes','interfaces.php',41],['lib/google/src/Google/Service','Dfareporting.php',421],['lib/google/src/Google/Service','Dfareporting.php',484],['lib/google/src/Google/Service','Dfareporting.php',626],['lib/google/src/Google/Service','Dfareporting.php',675],['lib/google/src/Google/Service','PlusDomains.php',467],['lib/google/src/Google/Service','PlusDomains.php',592],['lib/google/src/Google/Service','PlusDomains.php',718],['lib/google/src/Google/Service','PlusDomains.php',812],['lib/htmlpurifier/HTMLPurifier','AttrTypes.php',64],['lib/google/src/Google/Service','Licensing.php',236],['lib/google/src/Google/Service','Drive.php',1277],['lib/google/src/Google/Service','Drive.php',1313],['lib/google/src/Google/Service','Drive.php',1366],['lib/google/src/Google/Service','Drive.php',1476],['lib/google/src/Google/Service','Drive.php',1550],['lib/google/src/Google/Service','Drive.php',1706],['lib/google/src/Google/Service','Drive.php',1946],['lib/google/src/Google/Service','Drive.php',2016],['lib/google/src/Google/Service','Drive.php',2147],['lib/google/src/Google/Service','Drive.php',2241],['lib/google/src/Google/Service','Drive.php',2309],['lib/google/src/Google/Service','Drive.php',2428],['lib/google/src/Google/Service','Books.php',1343],['lib/google/src/Google/Service','Books.php',1512],['lib/google/src/Google/Service','Books.php',1564],['lib/google/src/Google/Service','Books.php',1639],['lib/google/src/Google/Service','Books.php',1819],['lib/google/src/Google/Service','Books.php',1960],['lib/google/src/Google/Service','Books.php',2077],['lib/google/src/Google/Service','Books.php',2175],['lib/google/src/Google/Service','Books.php',2207],['lib/zend/Zend/Gdata','App.php',847],['lib/google/src/Google/Service','AdExchangeSeller.php',443],['lib/google/src/Google/Service','AdExchangeSeller.php',551],['lib/google/src/Google/Service','AdExchangeSeller.php',665],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Template.php.in',58],['lib/google/src/Google/Cache','Memcache.php',72],['lib/google/src/Google/Service','Bigquery.php',533],['lib/google/src/Google/Service','Bigquery.php',633],['lib/google/src/Google/Service','Bigquery.php',838],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Hashtable.php',108],['cache','disabledlib.php',55],['lib/zend/Zend/Server','Cache.php',78],['lib/google/src/Google/Service','Groupssettings.php',107],['cache/stores/memcached','lib.php',285],['lib/google/src/Google/Service','Coordinate.php',476],['lib/google/src/Google/Service','Coordinate.php',642],['lib/zend/Zend','Registry.php',130],['lib/google/src/Google/Service','Webmasters.php',314],['lib/google/src/Google/Service','Webmasters.php',403],['lib/google/src/Google/Service','Webmasters.php',479],['lib/google/src/Google/Service','Autoscaler.php',330],['lib/google/src/Google/Service','Autoscaler.php',444],['lib/editor/tinymce/tiny_mce/3.5.11','tiny_mce_src.js',981],['lib/editor/tinymce/tiny_mce/3.5.11','tiny_mce_src.js',16595],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Db.php',65],['lib/google/src/Google/Service','ShoppingContent.php',567],['lib/google/src/Google/Service','ShoppingContent.php',675],['lib/google/src/Google/Service','ShoppingContent.php',749],['lib/google/src/Google/Service','ShoppingContent.php',857],['lib/google/src/Google/Service','ShoppingContent.php',985],['lib/google/src/Google/Service','ShoppingContent.php',1062],['lib/htmlpurifier/HTMLPurifier','PropertyList.php',34],['lib/editor/tinymce/classes','plugin.php',447],['mod/lesson','locallib.php',3239],['lib/horde/framework/Horde','Variables.php',135],['lib/google/src/Google/Service','SQLAdmin.php',528],['lib/google/src/Google/Service','SQLAdmin.php',664],['lib/google/src/Google/Service','SQLAdmin.php',872],['lib/google/src/Google/Service','SQLAdmin.php',941],['lib/google/src/Google/Service','Fitness.php',363],['lib/google/src/Google/Service','Fitness.php',489],['lib/google/src/Google/Service','TagManager.php',977],['lib/google/src/Google/Service','TagManager.php',1063],['lib/google/src/Google/Service','TagManager.php',1155],['lib/google/src/Google/Service','TagManager.php',1248],['lib/google/src/Google/Service','TagManager.php',1341],['lib/google/src/Google/Service','TagManager.php',1434],['lib/google/src/Google/Service','TagManager.php',1528],['lib/google/src/Google/Service','TagManager.php',1622],['lib/google/src/Google/Service','TagManager.php',1772],['lib/google/src/Google/Service','Directory.php',1315],['lib/google/src/Google/Service','Directory.php',1383],['lib/google/src/Google/Service','Directory.php',1490],['lib/google/src/Google/Service','Directory.php',1656],['lib/google/src/Google/Service','Directory.php',1783],['lib/google/src/Google/Service','Directory.php',1853],['lib/google/src/Google/Service','Directory.php',1949],['lib/google/src/Google/Service','Directory.php',2056],['lib/google/src/Google/Service','Directory.php',2160],['lib/google/src/Google/Service','Directory.php',2218],['lib/google/src/Google/Service','Directory.php',2493],['lib/htmlpurifier/HTMLPurifier','Config.php',161],['cache/stores/static','lib.php',220],['question/engine','states.php',116],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Null.php',52],['lib/htmlpurifier/HTMLPurifier','DoctypeRegistry.php',76],['lib/google/src/Google/Service','AppState.php',170],['lib/google/src/Google/Service','Taskqueue.php',263],['lib/google/src/Google/Service','Taskqueue.php',307],['lib/horde/framework/Horde/Imap/Client','Mailbox.php',46],['lib/google/src/Google/Service','Container.php',364],['lib/google/src/Google/Service','Container.php',411],['lib/portfolio','caller.php',170],['lib/portfolio','caller.php',538],['lib/google/src/Google/Service','AndroidPublisher.php',1194],['lib/google/src/Google/Service','AndroidPublisher.php',1296],['lib/google/src/Google/Service','AndroidPublisher.php',1437],['lib/google/src/Google/Service','AndroidPublisher.php',1500],['lib/google/src/Google/Service','AndroidPublisher.php',1723],['lib/google/src/Google/Service','AndroidPublisher.php',1811],['lib/google/src/Google/Service','AndroidPublisher.php',1875],['lib/google/src/Google/Service','AndroidPublisher.php',1987],['lib/google/src/Google/Service','AndroidPublisher.php',2112],['lib/google/src/Google/Service','AndroidPublisher.php',2182],['lib/zend/Zend','Date.php',516],['lib/google/src/Google/Service','AdSenseHost.php',644],['lib/google/src/Google/Service','AdSenseHost.php',685],['lib/google/src/Google/Service','AdSenseHost.php',750],['lib/google/src/Google/Service','AdSenseHost.php',917],['lib/google/src/Google/Service','AdSenseHost.php',1025],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Memory.php',74],['cache/stores/memcache','lib.php',312],['lib/google/src/Google/Service','Games.php',1219],['lib/google/src/Google/Service','Games.php',1338],['lib/google/src/Google/Service','Games.php',1440],['lib/google/src/Google/Service','Games.php',1698],['lib/google/src/Google/Service','Games.php',1805],['lib/google/src/Google/Service','Games.php',1947],['lib/google/src/Google/Service','Games.php',2081],['lib','filelib.php',3341],['lib','filelib.php',3589],['lib','oauthlib.php',302],['lib/google/src/Google/Service','MapsEngine.php',1529],['lib/google/src/Google/Service','MapsEngine.php',1708],['lib/google/src/Google/Service','MapsEngine.php',2005],['lib/google/src/Google/Service','MapsEngine.php',2267],['lib/google/src/Google/Service','MapsEngine.php',2359],['lib/google/src/Google/Service','MapsEngine.php',2665],['lib/google/src/Google/Service','MapsEngine.php',2926],['lib/google/src/Google/Service','MapsEngine.php',3117],['lib/minify/lib','JSMinPlus.php',1827],['lib/google/src/Google/Service','SiteVerification.php',151],['lib/horde/framework/Horde/Support','Array.php',30],['lib/google/src/Google/Service','Prediction.php',275],['cache/stores/session','lib.php',225],['cache/classes','dummystore.php',141],['lib/google/src/Google/Service','Compute.php',2828],['lib/google/src/Google/Service','Compute.php',2911],['lib/google/src/Google/Service','Compute.php',3050],['lib/google/src/Google/Service','Compute.php',3155],['lib/google/src/Google/Service','Compute.php',3240],['lib/google/src/Google/Service','Compute.php',3377],['lib/google/src/Google/Service','Compute.php',3478],['lib/google/src/Google/Service','Compute.php',3558],['lib/google/src/Google/Service','Compute.php',3676],['lib/google/src/Google/Service','Compute.php',3741],['lib/google/src/Google/Service','Compute.php',3876],['lib/google/src/Google/Service','Compute.php',3957],['lib/google/src/Google/Service','Compute.php',4132],['lib/google/src/Google/Service','Compute.php',4306],['lib/google/src/Google/Service','Compute.php',4355],['lib/google/src/Google/Service','Compute.php',4421],['lib/google/src/Google/Service','Compute.php',4486],['lib/google/src/Google/Service','Compute.php',4559],['lib/google/src/Google/Service','Compute.php',4611],['lib/google/src/Google/Service','Compute.php',4675],['lib/google/src/Google/Service','Compute.php',4756],['lib/google/src/Google/Service','Compute.php',4822],['lib/google/src/Google/Service','Compute.php',4943],['lib/google/src/Google/Service','Compute.php',5085],['lib/google/src/Google/Service','Compute.php',5244],['lib/google/src/Google/Service','Compute.php',5376],['lib/google/src/Google/Service','Compute.php',5428],['lib/horde/framework/Horde/Imap/Client','Cache.php',88],['lib/google/src/Google/Service','Calendar.php',900],['lib/google/src/Google/Service','Calendar.php',1053],['lib/google/src/Google/Service','Calendar.php',1241],['lib/google/src/Google/Service','Calendar.php',1337],['lib/google/src/Google/Service','Calendar.php',1379],['lib/google/src/Google/Service','Calendar.php',1780],['lib/google/src/Google/Service','Analytics.php',1891],['lib/google/src/Google/Service','Analytics.php',1940],['lib/google/src/Google/Service','Analytics.php',1987],['lib/google/src/Google/Service','Analytics.php',2309],['lib/google/src/Google/Service','Analytics.php',2429],['lib/google/src/Google/Service','Analytics.php',2522],['lib/google/src/Google/Service','Analytics.php',2648],['lib/google/src/Google/Service','Analytics.php',2867],['lib/google/src/Google/Service','Analytics.php',3004],['lib/google/src/Google/Service','Analytics.php',3095],['lib/google/src/Google/Service','Analytics.php',3197],['lib/google/src/Google/Service','Analytics.php',3308],['lib/google/src/Google/Service','Tasks.php',322],['lib/google/src/Google/Service','Tasks.php',441],['lib/behat/classes','behat_context_helper.php',66],['backup/cc/cc_lib/gral_lib','cssparser.php',137],['cache/classes','loaders.php',270],['cache/classes','loaders.php',1442],['cache/classes','loaders.php',1749],['cache/stores/mongodb','lib.php',252],['lib/zend/Zend/Service','Audioscrobbler.php',110],['lib/google/src/Google/Service','Oauth2.php',143],['lib/google/src/Google/Service','Oauth2.php',180],['cache/stores/file','lib.php',329],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Decorator.php',79],['lib/google/src/Google/Service','Storage.php',962],['lib/google/src/Google/Service','Storage.php',1078],['lib/google/src/Google/Service','Storage.php',1244],['lib/google/src/Google/Service','Storage.php',1370],['lib/google/src/Google/Service','Storage.php',1592],['lib/google/src/Google/Cache','Null.php',34],['lib/google/src/Google/Service','AdSense.php',1075],['lib/google/src/Google/Service','AdSense.php',1154],['lib/google/src/Google/Service','AdSense.php',1302],['lib/google/src/Google/Service','AdSense.php',1518],['lib/google/src/Google/Service','AdSense.php',1630],['lib/google/src/Google/Service','AdSense.php',1772],['lib/google/src/Google/Service','AdSense.php',2046],['lib/google/src/Google/Service','Pubsub.php',254],['lib/google/src/Google/Service','Pubsub.php',393],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Null.php',27],['lib/google/src/Google/Cache','File.php',45],['lib','navigationlib.php',382],['lib','navigationlib.php',833],['lib','navigationlib.php',2693],['lib','navigationlib.php',3126],['lib/google/src/Google/Service','Dns.php',299],['lib/google/src/Google/Service','Dns.php',385],['lib/google/src/Google/Service','Dns.php',434],['lib/mustache/src/Mustache','HelperCollection.php',81],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Cleanup.php',68],['lib/google/src/Google/Service','Replicapool.php',416],['lib/google/src/Google/Service','Replicapool.php',571],['lib/google/src/Google/Service','Resourceviews.php',350],['lib/google/src/Google/Service','Resourceviews.php',435],['lib','coursecatlib.php',215],['lib/google/src/Google/Cache','Apc.php',50],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Cache.php',163]], 21003],
'add_record_snapshot': ['add_record_snapshot', 'Add cached data that will be most probably used in event observers. ', [['lib/classes/event','base.php',757]], 262],
'get_auth_plugin': ['get_auth_plugin', 'Returns an authentication plugin instance. ', [['lib','moodlelib.php',3596]], 76],
'end_tag': ['end_tag', '', [['backup/util/xml/parser','progressive_parser.class.php',261],['lib','outputcomponents.php',1086],['backup/util/xml','xml_writer.class.php',177]], 858],
'draw_rand_array': ['draw_rand_array', 'Given an arbitrary array, and a number of draws, this function returns an array with that amount of items.  The indexes are retained. ', [['lib','moodlelib.php',7800]], 1],
'question_delete_activity': ['question_delete_activity', 'All question categories and their questions are deleted for this activity. ', [['lib','questionlib.php',492]], 1],
'get_fast_modinfo': ['get_fast_modinfo', 'Returns reference to full info about modules in course (including visibility). Cached and as fast as possible (0 or 1 db query). ', [['lib','modinfolib.php',2001]], 277],
'get_num_days_in_month': ['get_num_days_in_month', 'Returns the number of days in a given month. ', [['calendar/tests','calendartype_test_example.php',182],['calendar/type/gregorian/classes','structure.php',231]], 5],
'role_unassign_all': ['role_unassign_all', 'Removes multiple role assignments, parameters may contain: \'roleid\', \'userid\', \'contextid\', \'component\', \'enrolid\'. ', [['lib','accesslib.php',1805]], 45],
'require_user_key_login': ['require_user_key_login', 'Require key login. Function terminates with error if key not found or incorrect. ', [['lib','moodlelib.php',2963]], 5],
'set_user_preference': ['set_user_preference', 'Sets a preference for the specified user. ', [['lib','moodlelib.php',1822]], 163],
'list': ['list', '', [['mod/data/preset/imagegallery','jstemplate.js',9]], 1891],
'out': ['out', 'Returns the string ', [['lib','moodlelib.php',9451],['lib','weblib.php',547],['lib','tablelib.php',1526],['lib','csslib.php',1540],['lib','csslib.php',1698],['lib','csslib.php',2078],['lib','csslib.php',2162],['lib','csslib.php',2306],['lib','csslib.php',2495],['lib','csslib.php',3240],['report/loglive/classes','table_log_ajax.php',37]], 549],
'blocks_delete_all_for_context': ['blocks_delete_all_for_context', 'Delete all the blocks that belong to a particular context. ', [['lib','blocklib.php',2041]], 3],
'settime': ['settime', '', [['lib/google/src/Google/Service','Reports.php',731],['lib/google/src/Google/Service','PlusDomains.php',2824],['lib/zend/Zend/Gdata/YouTube','VideoQuery.php',202],['lib/google/src/Google/Service','Audit.php',400],['lib/zend/Zend','Date.php',2828],['lib/google/src/Google/Service','Analytics.php',4644],['lib/zend/Zend/Gdata/Exif/Extension','Tags.php',537],['lib/zend/Zend/Gdata/Media/Extension','MediaThumbnail.php',204]], 20],
'get_home_page': ['get_home_page', 'Gets the homepage to use for the current user ', [['lib','moodlelib.php',9236]], 6],
'lower': ['lower', 'Makes a string lowercase. ', [['lib/horde/framework/Horde','String.php',167]], 83],
'make_timestamp': ['make_timestamp', 'Given date parts in user time produce a GMT timestamp. ', [['lib','moodlelib.php',2027]], 43],
'dayofweek': ['dayofweek', 'Returns the day of week for a Gregorian calendar date. 0 = sunday, 6 = saturday ', [['lib/zend/Zend/Date','DateObject.php',611],['lib','moodlelib.php',2410],['lib/phpexcel/PHPExcel/Calculation','DateTime.php',1089]], 26],
'span': ['span', 'Creates a <span> tag. (Shortcut function.) ', [['lib','outputcomponents.php',1841]], 119],
'cleanremoteaddr': ['cleanremoteaddr', 'Cleans an ip address. Internal addresses are now allowed. (Originally local addresses were not allowed.) ', [['lib','moodlelib.php',8333]], 25],
'theme_reset_all_caches': ['theme_reset_all_caches', 'Invalidate all server and client side caches. ', [['lib','outputlib.php',37]], 3],
'get_coursemodule_from_instance': ['get_coursemodule_from_instance', 'Given an instance number of a module, finds the coursemodule description ', [['lib','datalib.php',1331]], 365],
'user_accesstime_log': ['user_accesstime_log', 'Store user last access times - called when use enters a course or site ', [['lib','datalib.php',1616]], 4],
'update_user_record_by_id': ['update_user_record_by_id', 'Will update a local user record from an external source (MNET users can not be updated using this method!). ', [['lib','moodlelib.php',3779]], 2],
'create': ['create', 'Creates a new 2048 bit RSA key pair and returns a unique ID that can be used to reference this key pair when launching new instances. ', [['lib/zend/Zend/Service/Amazon/Ec2','Keypair.php',39],['lib/phpexcel/PHPExcel/Shared/PCLZip','pclzip.lib.php',271],['repository/filesystem','lib.php',283],['lib/zend/Zend/Service/Amazon/Ec2','Securitygroups.php',39],['lib/google/src/Google/Service','Gmail.php',670],['lib/google/src/Google/Service','Gmail.php',827],['course','lib.php',2874],['lib/classes/event','base.php',139],['lib/google/src/Google/Service','Genomics.php',618],['lib/google/src/Google/Service','Genomics.php',717],['lib/google/src/Google/Service','Genomics.php',850],['lib/google/src/Google/Service','Genomics.php',1313],['lib','modinfolib.php',1747],['calendar','lib.php',2651],['lib/zend/Zend/Service/Amazon','Sqs.php',82],['lib','weblib.php',3048],['mod/lesson','locallib.php',1013],['mod/lesson','locallib.php',2166],['mod/lesson','locallib.php',3203],['lib/google/src/Google/Service','Fitness.php',340],['lib/google/src/Google/Service','TagManager.php',1034],['lib/google/src/Google/Service','TagManager.php',1124],['lib/google/src/Google/Service','TagManager.php',1217],['lib/google/src/Google/Service','TagManager.php',1310],['lib/google/src/Google/Service','TagManager.php',1403],['lib/google/src/Google/Service','TagManager.php',1497],['lib/google/src/Google/Service','TagManager.php',1591],['lib/google/src/Google/Service','TagManager.php',1742],['lib/simplepie/library/SimplePie','Cache.php',95],['lib/htmlpurifier/HTMLPurifier','Config.php',114],['lib/htmlpurifier/HTMLPurifier','Lexer.php',53],['lib/google/src/Google/Service','Container.php',314],['lib/adodb','adodb-xmlschema03.inc.php',170],['lib/adodb','adodb-xmlschema03.inc.php',514],['lib/adodb','adodb-xmlschema03.inc.php',779],['lib/adodb','adodb-xmlschema03.inc.php',930],['lib/adodb','adodb-xmlschema03.inc.php',1228],['repository','lib.php',206],['repository','lib.php',1960],['mod/quiz','attemptlib.php',100],['mod/quiz','attemptlib.php',555],['lib/google/src/Google/Service','Games.php',1648],['lib/google/src/Google/Service','Games.php',2012],['lib/google/src/Google/Service','MapsEngine.php',1676],['lib/google/src/Google/Service','MapsEngine.php',1976],['lib/google/src/Google/Service','MapsEngine.php',2252],['lib/google/src/Google/Service','MapsEngine.php',2329],['lib/google/src/Google/Service','MapsEngine.php',2897],['lib/adodb','adodb-xmlschema.inc.php',152],['lib/adodb','adodb-xmlschema.inc.php',473],['lib/adodb','adodb-xmlschema.inc.php',738],['lib/adodb','adodb-xmlschema.inc.php',884],['lib/adodb','adodb-xmlschema.inc.php',1129],['lib/horde/framework/Horde/Imap/Client/Interaction','Server.php',65],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',81],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',58],['lib/google/src/Google/Service','Pubsub.php',219],['lib/google/src/Google/Service','Pubsub.php',364],['lib/htmlpurifier/HTMLPurifier','ElementDef.php',135],['lib/simplepie/library/SimplePie','Registry.php',153],['lib','navigationlib.php',266],['lib/google/src/Google/Service','Dns.php',282],['lib/google/src/Google/Service','Dns.php',355],['lib','coursecatlib.php',328],['mod/quiz/classes','structure.php',65]], 3074],
'is_enrolled': ['is_enrolled', 'Returns true if user is enrolled (is participating) in course this is intended for students and teachers. ', [['lib','accesslib.php',2037]], 143],
'optional_param': ['optional_param', 'Returns a particular value for the named variable, taken from POST or GET, otherwise returning a given default. ', [['lib','moodlelib.php',605]], 2167],
'unset_config': ['unset_config', 'Removes a key from global configuration. ', [['lib','moodlelib.php',1499]], 89],
'enrol_check_plugins': ['enrol_check_plugins', 'Check all the login enrolment information for the given user object by querying the enrolment plugins ', [['lib','enrollib.php',186]], 8],
'apd_get_profiling': ['apd_get_profiling', 'Legacy function. ', [['lib','moodlelib.php',8754]], 0],
'delete_ratings': ['delete_ratings', 'Delete one or more ratings. Specify either a rating id, an item id or just the context id. ', [['rating','lib.php',381]], 16],
'reset_caches': ['reset_caches', 'Reset any caches ', [['lib/classes/update','checker.php',74],['lib/dml','moodle_database.php',1019],['lib/classes','string_manager_standard.php',594],['lib/classes','text.php',108],['lib/classes','string_manager.php',127],['repository','lib.php',2686],['lib','accesslib.php',5098],['lib','accesslib.php',5994],['lib/classes','string_manager_install.php',245],['lib/classes','filetypes.php',419],['mod/glossary/classes/local','concept_cache.php',49],['lib/classes','plugin_manager.php',95],['lib','filterlib.php',93],['lib/classes/update','deployer.php',66]], 101],
'ishtml': ['ishtml', 'Sets message type to HTML or plain. ', [['lib/phpmailer','class.phpmailer.php',662]], 4],
'convert_to_array': ['convert_to_array', 'Converts an object into an associative array ', [['lib','moodlelib.php',8815]], 10],
'get_record_select': ['get_record_select', 'Get a single database record as an object which match a particular WHERE clause. ', [['lib/dml','moodle_database.php',1432]], 19],
'usergetdate': ['usergetdate', 'Given a $time timestamp in GMT (seconds since epoch), returns an array that represents the date in user time ', [['lib','moodlelib.php',2208]], 15],
'is_number': ['is_number', 'Return true if given value is integer or string with integer value ', [['lib','moodlelib.php',1286],['lib/phpexcel/PHPExcel/Calculation','Functions.php',440]], 65],
'smtpclose': ['smtpclose', 'Close the active SMTP session if one exists. ', [['lib/phpmailer','class.phpmailer.php',1370]], 2],
'get_plugin_types': ['get_plugin_types', 'Get list of available plugin types together with their location. ', [['lib/classes','component.php',771],['lib','deprecatedlib.php',433],['lib/classes','plugin_manager.php',116]], 60],
'badges_handle_course_deletion': ['badges_handle_course_deletion', 'Handles what happens to the course badges when a course is deleted. ', [['lib','badgeslib.php',1191]], 1],
'remoteip_in_list': ['remoteip_in_list', 'Is current ip in give list? ', [['lib','moodlelib.php',8255]], 5],
'plugin_supports': ['plugin_supports', 'Checks whether a plugin supports a specified feature. ', [['lib','moodlelib.php',7193]], 59],
'send': ['send', '', [['lib/horde/framework/Horde/Mail/Transport','Smtpmx.php',179],['lib/horde/framework/Horde/Mail/Transport','Smtphorde.php',116],['lib/horde/framework/Horde/Mail/Transport','Null.php',54],['lib/zend/Zend/Service/DeveloperGarden','SendSms.php',126],['lib/google/src/Google/Service','Gmail.php',739],['lib/google/src/Google/Service','Gmail.php',1057],['lib','excellib.class.php',132],['lib/horde/framework/Horde/Mail/Transport','Mail.php',60],['auth/cas/CAS/CAS/Request','AbstractRequest.php',223],['lib/pear/Auth','RADIUS.php',370],['lib/phpmailer','class.phpmailer.php',954],['lib/zend/Zend/Service/Amazon','Sqs.php',185],['lib/horde/framework/Horde/Mail/Transport','Smtp.php',158],['auth/cas/CAS/CAS/ProxiedService/Http','Abstract.php',126],['auth/cas/CAS/CAS/ProxiedService','Http.php',62],['lib/jabber/XMPP','XMLStream.php',677],['lib','odslib.class.php',81],['auth/cas/CAS/CAS/Request','CurlMultiRequest.php',99],['lib/horde/framework/Horde/Mime','Part.php',1679],['backup/util/xml/output','memory_xml_output.class.php',59],['lib/horde/framework/Horde/Mail/Transport','Mock.php',91],['lib/horde/framework/Horde/Mail/Transport','Sendmail.php',89],['mnet/xmlrpc','client.php',119],['auth/cas/CAS/CAS/Request','RequestInterface.php',136],['lib/jabber/XMPP','BOSH.php',150],['auth/cas/CAS/CAS/Request','MultiRequestInterface.php',75],['mod/lti/classes/local/ltiservice','response.php',205],['backup/util/xml/output','file_xml_output.class.php',66],['lib/htmlpurifier/HTMLPurifier','ErrorCollector.php',65],['lib/horde/framework/Horde/Mime','Mail.php',372]], 205],
'password_is_legacy_hash': ['password_is_legacy_hash', 'Check a password hash to see if it was hashed using the legacy hash algorithm (md5). ', [['lib','moodlelib.php',4326]], 5],
'get_userinfo': ['get_userinfo', 'Read user information from external database and returns it as array(). Function should return all information available. If you are saving this information to moodle user-table you should honour synchronisation flags ', [['lib','authlib.php',376],['auth/db','auth.php',188],['auth/shibboleth','auth.php',86],['auth/cas','auth.php',455],['auth/fc','auth.php',73],['auth/ldap','auth.php',243]], 8],
'user_update_user': ['user_update_user', 'Update a user with a user object (will compare against the ID) ', [['user','lib.php',117]], 27],
'user_update_password': ['user_update_password', 'Updates the user\'s password. ', [['lib','authlib.php',234],['auth/db','auth.php',231],['auth/email','auth.php',58],['auth/none','auth.php',58],['auth/nologin','auth.php',50],['auth/manual','auth.php',81],['auth/webservice','auth.php',72],['auth/ldap','auth.php',1315]], 14],
'profile_load_custom_fields': ['profile_load_custom_fields', 'Load custom profile fields into user object ', [['user/profile','lib.php',611]], 5],
'default_emoticons': ['default_emoticons', 'Returns default set of emoticons supported by Moodle ', [['lib','moodlelib.php',6853]], 2],
'update_user_record': ['update_user_record', 'will update a local user record from an external source. is a lighter version of the one in moodlelib -- won\'t do expensive ops such as enrolment. ', [['auth/db','auth.php',511],['lib','moodlelib.php',3764],['auth/ldap','auth.php',980]], 5],
'blog_remove_associations_for_course': ['blog_remove_associations_for_course', 'remove all associations for the blog entries of a particular course ', [['blog','lib.php',129]], 1],
'get_directory_list': ['get_directory_list', 'Returns an array with all the filenames in all subdirectories, relative to the given rootdir. ', [['lib','moodlelib.php',6225]], 6],
'generate_password': ['generate_password', 'Returns a randomly generated password of length $maxlen.  inspired by ', [['lib','moodlelib.php',7642],['lib/classes/update','deployer.php',469]], 8],
'usertimezone': ['usertimezone', 'Returns a string that prints the user\'s timezone ', [['lib','moodlelib.php',2266]], 8],
'message_popup_window': ['message_popup_window', 'If new messages are waiting for the current user, then insert JavaScript to pop up the messaging window into the page ', [['lib','moodlelib.php',8449]], 1],
'isguestuser': ['isguestuser', 'Determines if a user is logged in as real guest user with username \'guest\'. ', [['lib','accesslib.php',1922]], 237],
'send_confirmation_email': ['send_confirmation_email', 'Send email to specified user with confirmation text and activation link. ', [['lib','moodlelib.php',5786]], 2],
'remove_grade_letters': ['remove_grade_letters', 'Remove grade letters for given context ', [['lib','gradelib.php',1228]], 1],
'is_siteadmin': ['is_siteadmin', 'Check if the user is an admin at the site level. ', [['lib','accesslib.php',604]], 92],
'clean_param': ['clean_param', 'Used by {@link optional_param()} and {@link required_param()} to clean the variables and/or cast to specific types, based on an options field. <code> $course->format = clean_param($course->format, PARAM_ALPHA); $selectedgradeitem = clean_param($selectedgradeitem, PARAM_INT); </code> ', [['lib','moodlelib.php',768]], 607],
'can_change_password': ['can_change_password', 'Returns true if this authentication plugin can change the user\'s password. ', [['auth/radius','auth.php',151],['lib','authlib.php',151],['auth/pam','auth.php',101],['auth/db','auth.php',675],['auth/email','auth.php',173],['auth/shibboleth','auth.php',170],['auth/none','auth.php',89],['auth/nologin','auth.php',72],['auth/cas','auth.php',76],['auth/mnet','auth.php',588],['auth/pop3','auth.php',106],['auth/nntp','auth.php',89],['auth/manual','auth.php',112],['auth/fc','auth.php',170],['auth/imap','auth.php',110],['auth/webservice','auth.php',101],['auth/ldap','auth.php',1599]], 13],
'mnet_get_idp_jump_url': ['mnet_get_idp_jump_url', 'return the jump url for a given remote user this is used for rewriting forum post links in emails, etc ', [['lib','moodlelib.php',9218]], 1],
'init': ['init', '', [['lib/editor/tinymce/tiny_mce/3.5.11/plugins/fullpage/js','fullpage.js',162],['report/log/classes/event','user_report_viewed.php',44],['mod/wiki/classes/event','page_deleted.php',43],['mod/chat/classes/event','sessions_viewed.php',83],['mod/glossary/classes/event','category_deleted.php',37],['mod/workshop/classes/event','assessment_evaluations_reset.php',45],['lib/classes/event','tag_updated.php',49],['lib/classes/event','course_resources_list_viewed.php',41],['mod/lesson/classes/event','content_page_viewed.php',39],['mod/feedback/item/captcha','lib.php',27],['lib/classes/event','blog_association_created.php',46],['lib/classes/event','user_profile_viewed.php',47],['mod/feedback/classes/event','response_submitted.php',48],['lib/classes/event','badge_awarded.php',45],['mod/lti/classes/event','course_module_viewed.php',39],['lib/htmlpurifier/HTMLPurifier/ChildDef','StrictBlockquote.php',97],['mod/resource/classes/event','course_module_viewed.php',39],['blocks/login','block_login.php',26],['report/outline/classes/event','report_viewed.php',44],['lib/editor/tinymce/plugins/moodlemedia/tinymce/js','media.js',13],['admin/tool/xmldb/actions/move_updown_table','move_updown_table.class.php',32],['question/classes/bank','checkbox_column.php',28],['mod/assign/classes/event','extension_granted.php',86],['admin/tool/capability/classes/event','report_viewed.php',36],['blocks/participants','block_participants.php',26],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/table/js','cell.js',5],['lib/classes/event','message_viewed.php',45],['lib/classes/event','course_category_created.php',39],['admin/tool/log/store/database/classes/log','store.php',62],['blocks/feedback','block_feedback.php',32],['lib/editor/tinymce/tiny_mce/3.5.11/themes/advanced/js','about.js',3],['mod/quiz/classes/event','group_override_updated.php',45],['mod/survey/classes/event','response_submitted.php',45],['mod/book/tool/exportimscp/classes/event','book_exported.php',94],['report/loglive/classes/event','report_viewed.php',38],['mod/forum/classes/event','post_deleted.php',46],['mod/folder/classes/event','course_module_viewed.php',39],['mod/assign/classes/event','submission_duplicated.php',86],['grade/report/singleview/classes/local/screen','select.php',41],['lib/adodb','adodb.inc.php',2847],['lib/adodb','adodb.inc.php',2978],['mod/chat/classes/event','message_sent.php',77],['mod/workshop/classes/event','submission_created.php',44],['lib/classes/event','note_updated.php',47],['mod/lesson/classes/event','group_override_deleted.php',45],['mod/feedback/classes/event','response_deleted.php',48],['lib/classes/event','course_module_instance_list_viewed.php',49],['lib/tests/fixtures','stats_events.php',32],['lib/tests/fixtures','stats_events.php',39],['lib/tests/fixtures','stats_events.php',46],['lib/tests/fixtures','stats_events.php',53],['mod/assign/classes/event','submission_locked.php',87],['mod/lesson/classes/event','page_updated.php',63],['mod/forum/classes/event','discussion_subscription_deleted.php',45],['mod/quiz/classes/event','attempt_preview_started.php',45],['mod/assign/classes/event','batch_set_workflow_state_viewed.php',71],['blocks/quiz_results','block_quiz_results.php',40],['lib/xhprof/xhprof_html/jquery','jquery.autocomplete.js',565],['blocks/community','block_community.php',28],['mod/lesson/classes/event','user_override_updated.php',45],['mod/quiz/classes/event','report_viewed.php',46],['admin/tool/xmldb/actions/view_structure_xml','view_structure_xml.class.php',32],['mod/workshop/allocation/random','lib.php',56],['mod/lesson/classes/event','question_answered.php',45],['lib/portfolio','plugin.php',476],['mod/forum/classes/event','discussion_viewed.php',39],['mod/workshop/classes/event','submission_viewed.php',44],['admin/tool/xmldb/actions','XMLDBCheckAction.class.php',38],['mod/assign/classes/event','submission_updated.php',49],['mod/workshop/classes/event','submission_reassessed.php',46],['mod/assign/submission/onlinetext/classes/event','submission_created.php',45],['mod/glossary/classes/event','entry_deleted.php',45],['lib/classes/event','user_created.php',39],['mod/workshop/classes/event','course_module_viewed.php',42],['admin/tool/xmldb/actions/delete_xml_file','delete_xml_file.class.php',32],['mod/data/classes/event','field_updated.php',46],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/xhtmlxtras/js','abbr.js',1],['admin/tool/xmldb/actions/edit_key','edit_key.class.php',32],['mod/data/classes/event','template_updated.php',46],['lib/classes/event','comment_created.php',47],['lib/classes/event','cohort_deleted.php',38],['mod/scorm/classes/event','tracks_viewed.php',46],['lib/classes/event','course_viewed.php',46],['grade/report/overview/classes/event','grade_report_viewed.php',39],['admin/tool/xmldb/actions/view_structure_php','view_structure_php.class.php',33],['grade/report/user/classes/event','grade_report_viewed.php',39],['lib/classes/event','course_content_deleted.php',45],['lib/google/src/Google/Service','Spectrum.php',130],['lib/lessphp','Environment.php',56],['mod/quiz/classes/event','attempt_abandoned.php',44],['admin/tool/xmldb/actions/delete_field','delete_field.class.php',32],['blocks/mnet_hosts','block_mnet_hosts.php',26],['mod/workshop/classes/event','phase_switched.php',44],['lib/classes/event','content_viewed.php',56],['mod/scorm/classes/event','course_module_viewed.php',38],['admin/tool/xmldb/actions/check_oracle_semantics','check_oracle_semantics.class.php',37],['blocks/course_overview','block_course_overview.php',38],['lib/classes/event','course_completion_updated.php',39],['report/completion/classes/event','report_viewed.php',39],['mod/forum/classes/event','discussion_updated.php',44],['lib/classes/event','course_reset_ended.php',71],['mod/glossary/classes/event','course_module_viewed.php',38],['mod/choice/classes/event','answer_submitted.php',90],['admin/tool/xmldb/actions/view_table_php','view_table_php.class.php',33],['mod/forum/classes/event','assessable_uploaded.php',104],['admin/tool/xmldb/actions/view_structure_sql','view_structure_sql.class.php',33],['mod/wiki/classes/event','page_diff_viewed.php',44],['lib/classes/event','course_category_updated.php',42],['admin/tool/langimport/classes/event','langpack_updated.php',61],['grade/report/singleview/classes/local/screen','grade.php',126],['lib/tests','blocklib_test.php',500],['lib/classes/event','webservice_service_created.php',83],['lib/classes/event','course_created.php',46],['mod/lesson/classes/event','lesson_started.php',39],['mod/assign/classes/event','grading_table_viewed.php',71],['admin/tool/xmldb/actions/move_updown_field','move_updown_field.class.php',32],['lib/classes/event','calendar_event_deleted.php',47],['mod/feedback/classes/event','course_module_viewed.php',44],['lib/classes/event','group_created.php',83],['lib/classes','component.php',116],['blocks/mentees','block_mentees.php',27],['lib/minify/lib','FirePHP.php',221],['blocks/myprofile','block_myprofile.php',40],['lib/adodb/drivers','adodb-pdo.inc.php',538],['mod/quiz/classes/event','user_override_created.php',44],['mod/glossary/classes/event','category_updated.php',37],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/xhtmlxtras/js','attributes.js',1],['blocks/social_activities','block_social_activities.php',26],['mod/assign/classes/event','submission_viewed.php',67],['mod/glossary/classes/event','entry_disapproved.php',37],['lib/classes/event','user_password_updated.php',62],['mod/assign/classes/event','all_submissions_downloaded.php',84],['blocks/calendar_month','block_calendar_month.php',26],['mod/choice/classes/event','course_module_viewed.php',38],['lib/classes/event','role_deleted.php',46],['admin/tool/xmldb/actions/unload_xml_file','unload_xml_file.class.php',32],['auth/cas/CAS/CAS/PGTStorage','File.php',150],['question/classes/bank','column_base.php',53],['admin/tool/log/store/legacy/tests/fixtures','event.php',39],['lib/classes/event','user_loggedinas.php',46],['mod/assign/classes/event','submission_confirmation_form_viewed.php',71],['mod/assign/tests/fixtures','event_mod_assign_fixtures.php',57],['admin/tool/xmldb/actions/move_updown_index','move_updown_index.class.php',32],['mod/lesson/classes/event','essay_attempt_viewed.php',39],['mod/forum/classes/event','discussion_moved.php',45],['admin/tool/xmldb/actions/check_indexes','check_indexes.class.php',34],['mod/assign/submission/onlinetext/classes/event','assessable_uploaded.php',101],['mod/assign/classes/event','reveal_identities_confirmation_page_viewed.php',71],['mod/survey/classes/event','report_downloaded.php',46],['mod/wiki/classes/event','page_updated.php',43],['mod/chat/classes/event','course_module_viewed.php',38],['admin/tool/xmldb/actions/view_table_xml','view_table_xml.class.php',32],['admin/tool/log/store/standard/tests/fixtures','event.php',39],['mod/assign/classes/event','submission_unlocked.php',87],['admin/tool/xmldb/actions/new_field','new_field.class.php',32],['lib/classes/event','user_list_viewed.php',47],['mod/forum/classes/event','readtracking_disabled.php',44],['lib/classes/event','comments_viewed.php',41],['lib/classes/event','cohort_member_added.php',38],['lib/classes/event','grouping_created.php',83],['mod/assign/feedback/offline','importgradeslib.php',83],['lib/classes/event','recent_activity_viewed.php',39],['lib/classes/event','role_allow_switch_updated.php',39],['blocks/navigation','block_navigation.php',55],['lib/classes/event','user_login_failed.php',45],['lib/classes/event','message_contact_added.php',39],['lib/editor/atto/yui/build/moodle-editor_atto-rangy','moodle-editor_atto-rangy-debug.js',126],['mod/assign/submission/file/classes/event','submission_updated.php',45],['admin/tool/xmldb/actions/new_key','new_key.class.php',32],['question/classes/bank','question_text_row.php',29],['lib/classes/event','role_allow_assign_updated.php',39],['mod/quiz/classes/event','user_override_deleted.php',44],['mod/quiz/classes/event','edit_page_viewed.php',45],['lib/classes/event','email_failed.php',40],['mod/quiz/classes/event','course_module_viewed.php',39],['lib/classes/event','tag_removed.php',49],['mod/lesson/classes/event','highscores_viewed.php',39],['lib/zend/Zend','Registry.php',77],['report/stats/classes/event','user_report_viewed.php',38],['mod/quiz/classes/event','group_override_deleted.php',45],['mod/book/classes/event','chapter_updated.php',100],['mod/lesson/classes/event','question_viewed.php',45],['blocks/site_main_menu','block_site_main_menu.php',26],['lib/simplepie/library','SimplePie.php',1198],['mod/scorm/classes/event','interactions_viewed.php',45],['lib/classes/event','course_module_updated.php',48],['admin/tool/xmldb/actions/new_table','new_table.class.php',32],['mod/forum/classes/event','discussion_subscription_created.php',45],['mod/quiz/classes/event','question_manually_graded.php',46],['lib/classes/session','file.php',53],['lib/classes/event','mnet_access_control_created.php',48],['lib/classes/event','role_assigned.php',47],['lib/classes/event','unknown_logged.php',39],['mod/scorm/classes/event','user_report_viewed.php',45],['admin/tool/monitor/classes/event','subscription_criteria_met.php',45],['blocks/blog_tags','block_blog_tags.php',32],['mod/url/classes/event','course_module_viewed.php',39],['admin/tool/xmldb/actions/check_defaults','check_defaults.class.php',34],['report/participation/classes/event','report_viewed.php',48],['auth/cas/CAS/CAS/PGTStorage','AbstractStorage.php',173],['lib/classes/event','user_updated.php',39],['blocks/private_files','block_private_files.php',28],['lib/classes/event','course_section_updated.php',45],['lib/classes/event','comment_deleted.php',47],['mod/assign/classes/event','marker_updated.php',98],['lib/classes/event','webservice_login_failed.php',80],['mod/assign/submission/file/classes/event','assessable_uploaded.php',113],['admin/tool/log/store/database/tests/fixtures','event.php',39],['mod/workshop/allocation/scheduled','lib.php',52],['admin/tool/xmldb/actions/edit_index','edit_index.class.php',32],['mod/lti/classes/event','unknown_service_api_called.php',64],['blocks/news_items','block_news_items.php',33],['lib/classes/event','cohort_updated.php',38],['admin/tool/xmldb/actions/template','template.class.php',31],['mod/forum/classes/event','post_updated.php',46],['mod/book/classes/event','chapter_viewed.php',97],['lib/classes/event','note_deleted.php',47],['lib/classes/event','user_loggedout.php',44],['lib/classes/event','grade_report_viewed.php',42],['blocks/messages','block_messages.php',26],['mod/assign/submission/onlinetext/classes/event','submission_updated.php',45],['mod/assign/classes/event','workflow_state_updated.php',97],['blocks/course_summary','block_course_summary.php',26],['mod/book/classes/event','chapter_deleted.php',97],['lib/classes/event','course_deleted.php',47],['admin/tool/xmldb/actions/edit_table','edit_table.class.php',36],['lib/classes/event','blog_entry_deleted.php',43],['admin/tool/log/store/legacy/classes/event','legacy_logged.php',31],['question/classes/bank','copy_action_column.php',30],['lib/classes/event','webservice_token_created.php',83],['lib/tcpdf/include/barcodes','qrcode.php',853],['mod/forum/classes/event','course_searched.php',45],['lib/classes/event','group_updated.php',83],['admin/tool/xmldb/actions/check_foreign_keys','check_foreign_keys.class.php',38],['mod/quiz/classes/event','attempt_started.php',37],['mod/lesson/classes/event','group_override_updated.php',45],['lib/classes/event','course_module_viewed.php',40],['lib/classes/event','mnet_access_control_updated.php',48],['mod/quiz/classes/question/bank','add_action_column.php',40],['mod/wiki/classes/event','comments_viewed.php',38],['mod/lesson/classes/event','course_module_viewed.php',40],['question/classes/bank','edit_action_column.php',29],['admin/tool/xmldb/actions/new_index','new_index.class.php',32],['lib/tests/fixtures','event_fixtures.php',42],['lib/tests/fixtures','event_fixtures.php',117],['lib/tests/fixtures','event_fixtures.php',124],['lib/tests/fixtures','event_fixtures.php',131],['lib/tests/fixtures','event_fixtures.php',139],['lib/tests/fixtures','event_fixtures.php',147],['lib/tests/fixtures','event_fixtures.php',155],['lib/tests/fixtures','event_fixtures.php',162],['lib/tests/fixtures','event_fixtures.php',170],['lib/tests/fixtures','event_fixtures.php',178],['lib/tests/fixtures','event_fixtures.php',186],['lib/tests/fixtures','event_fixtures.php',193],['lib/tests/fixtures','event_fixtures.php',201],['lib/tests/fixtures','event_fixtures.php',216],['lib/tests/fixtures','event_fixtures.php',225],['lib/tests/fixtures','event_fixtures.php',238],['lib/tests/fixtures','event_fixtures.php',267],['lib/tests/fixtures','event_fixtures.php',304],['lib/tests/fixtures','event_fixtures.php',315],['lib/tests/fixtures','event_fixtures.php',338],['lib/tests/fixtures','event_fixtures.php',345],['mod/assign/submission/file/classes/event','submission_created.php',45],['admin/tool/xmldb/actions/edit_xml_file_save','edit_xml_file_save.class.php',32],['admin/tool/xmldb/actions/new_table_from_mysql','new_table_from_mysql.class.php',33],['admin/tool/xmldb/actions/get_db_directories','get_db_directories.class.php',33],['lib/editor/atto/yui/build/moodle-editor_atto-rangy','moodle-editor_atto-rangy.js',126],['admin/tool/xmldb/actions/main_view','main_view.class.php',35],['mod/quiz/classes/event','attempt_submitted.php',44],['mod/data/classes/event','field_created.php',47],['lib/classes/event','question_category_created.php',39],['admin/tool/monitor/classes/event','rule_deleted.php',39],['admin/tool/xmldb/actions/generate_all_documentation','generate_all_documentation.class.php',33],['admin/tool/xmldb/actions/view_index_xml','view_index_xml.class.php',32],['blocks/tag_youtube','block_tag_youtube.php',29],['backup/converter/moodle1','lib.php',111],['mod/lesson/classes/event','group_override_created.php',46],['admin/tool/xmldb/actions/edit_table_save','edit_table_save.class.php',32],['mod/workshop/classes/event','assessments_reset.php',44],['mod/lesson/classes/event','lesson_resumed.php',39],['mod/assign/classes/event','feedback_viewed.php',67],['lib/classes/event','blog_entry_updated.php',42],['report/questioninstances/classes/event','report_viewed.php',44],['mod/assign/classes/event','submission_form_viewed.php',74],['admin/tool/xmldb/actions/create_xml_file','create_xml_file.class.php',31],['mod/folder/classes/event','folder_updated.php',39],['mod/assign/classes/event','submission_created.php',49],['mod/assign/classes/event','statement_accepted.php',86],['lib/classes/event','grade_deleted.php',50],['lib/classes/event','role_capabilities_updated.php',42],['lib/classes/event','blog_entries_viewed.php',53],['admin/tool/xmldb/actions/edit_key_save','edit_key_save.class.php',33],['mod/wiki/classes/event','page_viewed.php',37],['question/engine','states.php',64],['lib/classes/event','group_deleted.php',83],['mod/imscp/classes/event','course_module_viewed.php',40],['question/classes/bank','delete_action_column.php',30],['blocks/completionstatus','block_completionstatus.php',36],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/style/js','props.js',57],['lib/classes/event','webservice_token_sent.php',65],['lib/editor/atto/yui/src/rangy/js','rangy-core.js',126],['mod/quiz/classes/event','attempt_becameoverdue.php',47],['lib/classes/event','assessable_submitted.php',46],['mod/quiz/classes/event','attempt_viewed.php',45],['mod/assign/classes/event','submission_status_updated.php',88],['mod/page/classes/event','course_module_viewed.php',38],['mod/assign/classes/event','grading_form_viewed.php',74],['lib/editor/tinymce/tiny_mce/3.5.11/themes/advanced/js','color_picker.js',63],['blocks/badges','block_badges.php',35],['lib/classes/event','course_module_completion_updated.php',39],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/table/js','row.js',3],['mod/workshop/classes/event','assessment_evaluated.php',45],['admin/tool/xmldb/actions/edit_field','edit_field.class.php',32],['mod/book/classes/event','course_module_viewed.php',57],['blocks/activity_modules','block_activity_modules.php',29],['report/log/classes/event','report_viewed.php',48],['blocks/search_forums','block_search_forums.php',26],['admin/tool/xmldb/actions/load_xml_files','load_xml_files.class.php',32],['lib/classes/event','course_module_deleted.php',47],['mod/book/classes/event','chapter_created.php',100],['mod/workshop/classes/event','submission_assessed.php',45],['lib/classes/event','cohort_created.php',38],['lib/classes/event','webservice_function_called.php',76],['mod/scorm/classes/event','sco_launched.php',45],['lib/classes/event','blog_entry_created.php',44],['lib/classes/event','user_enrolment_created.php',44],['mod/data/classes/event','record_created.php',45],['admin/tool/xmldb/actions/delete_index','delete_index.class.php',32],['mod/quiz/classes/event','attempt_summary_viewed.php',45],['mnet','environment.php',24],['lib/classes/event','user_enrolment_updated.php',44],['mod/quiz/classes/event','attempt_reviewed.php',44],['admin/tool/xmldb/actions/save_xml_file','save_xml_file.class.php',37],['mod/lesson/classes/event','page_moved.php',47],['mod/glossary/classes/event','category_created.php',37],['lib/classes/session','database.php',65],['grade','lib.php',128],['mod/lesson/classes/event','page_created.php',45],['mod/forum/classes/event','course_module_viewed.php',39],['lib/classes/event','cohort_member_removed.php',39],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/table/js','table.js',295],['lib','csvlib.class.php',216],['mod/wiki/classes/event','page_version_viewed.php',43],['lib/classes/event','role_allow_override_updated.php',39],['mod/workshop/classes/event','assessable_uploaded.php',112],['mod/survey/classes/event','course_module_viewed.php',39],['lib/classes/event','grouping_updated.php',83],['admin/tool/monitor/classes/event','rule_updated.php',39],['lib/classes/event','course_module_created.php',48],['comment','lib.php',237],['lib/classes/event','tag_added.php',49],['lib/minify/lib','JSMinPlus.php',1753],['grade/report/singleview/classes/local/screen','user.php',94],['admin/tool/langimport/classes/event','langpack_removed.php',61],['mod/feedback/item/multichoice','lib.php',32],['mod/assign/classes/event','assessable_submitted.php',118],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/xhtmlxtras/js','cite.js',1],['mod/workshop/classes/event','submission_updated.php',44],['mod/lesson/classes/event','page_deleted.php',45],['lib/classes/event','grouping_deleted.php',90],['blocks/section_links','block_section_links.php',34],['backup/converter','convertlib.php',211],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/xhtmlxtras/js','acronym.js',1],['lib/classes/event','tag_flagged.php',46],['mod/wiki/classes/event','page_history_viewed.php',37],['lib/classes/session','memcache.php',88],['mod/survey/classes/event','report_viewed.php',46],['lib/classes/event','tag_created.php',46],['admin/tool/xmldb/actions/move_updown_key','move_updown_key.class.php',32],['report/stats/classes/event','report_viewed.php',46],['lib/classes/event','note_created.php',47],['blocks/blog_menu','block_blog_menu.php',32],['backup/util/xml/output','memory_xml_output.class.php',51],['blocks/selfcompletion','block_selfcompletion.php',37],['admin/tool/xmldb/actions/view_reserved_words','view_reserved_words.class.php',35],['admin/tool/xmldb/actions/view_table_sql','view_table_sql.class.php',33],['auth/cas/CAS/CAS/PGTStorage','Db.php',174],['mod/data/classes/event','course_module_viewed.php',40],['lib/classes/event','course_reset_started.php',71],['mod/feedback/item/textfield','lib.php',26],['admin/tool/monitor/classes/event','subscription_created.php',39],['admin/tool/xmldb/actions/edit_xml_file','edit_xml_file.class.php',35],['mod/book/tool/print/classes/event','book_printed.php',94],['lib/classes/event','webservice_service_user_removed.php',77],['mod/data/classes/event','record_deleted.php',45],['admin/tool/xmldb/actions/view_key_xml','view_key_xml.class.php',32],['mod/choice/classes/event','answer_updated.php',90],['blocks/online_users','block_online_users.php',31],['lib/classes/event','group_member_removed.php',87],['blocks/activity_results','block_activity_results.php',51],['admin/tool/xmldb/actions/view_xml','view_xml.class.php',32],['mod/glossary/classes/event','entry_viewed.php',39],['mod/forum/classes/event','user_report_viewed.php',45],['lib/classes/event','course_category_deleted.php',50],['mod/forum/classes/event','subscription_created.php',44],['admin/tool/xmldb/actions/check_bigints','check_bigints.class.php',32],['lib/classes/event','calendar_event_created.php',47],['blocks/blog_recent','block_blog_recent.php',33],['lib/classes/event','message_contact_blocked.php',39],['mod/feedback/item/multichoicerated','lib.php',37],['lib/classes/event','webservice_service_updated.php',77],['mod/wiki/classes/event','page_version_restored.php',43],['mod/data/classes/event','template_viewed.php',45],['blocks/admin_bookmarks','block_admin_bookmarks.php',41],['lib/classes/event','course_user_report_viewed.php',46],['mod/data/classes/event','record_updated.php',45],['mod/quiz/report','attemptsreport.php',67],['mod/wiki/classes/event','page_map_viewed.php',43],['admin/tool/log/classes/log','manager.php',39],['admin/tool/xmldb/actions/edit_index_save','edit_index_save.class.php',33],['mod/wiki/classes/event','page_locks_deleted.php',43],['lib/classes/event','webservice_service_deleted.php',77],['blocks/glossary_random','block_glossary_random.php',32],['mod/workshop/allocation/manual','lib.php',55],['mod/forum/classes/event','readtracking_enabled.php',44],['question/classes/bank/search','category_condition.php',79],['blocks/course_list','block_course_list.php',29],['lib/adodb/drivers','adodb-oci8.inc.php',1377],['lib/classes/event','role_unassigned.php',47],['mod/feedback/item/label','lib.php',29],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/xhtmlxtras/js','del.js',1],['lib/classes/event','course_restored.php',49],['mod/choice/classes/event','report_viewed.php',38],['lib/classes/event','user_deleted.php',48],['lib/classes/event','user_enrolment_deleted.php',45],['mod/book/tool/print/classes/event','chapter_printed.php',97],['mod/assign/classes/event','identities_revealed.php',84],['lib/classes/event','user_graded.php',85],['lib/classes/event','course_updated.php',49],['blocks/tags','block_tags.php',26],['lib/classes/session','memcached.php',102],['mod/forum/classes/event','post_created.php',46],['mod/data/classes/event','field_deleted.php',46],['lib/classes/event','tag_deleted.php',46],['mod/glossary/classes/event','entry_created.php',43],['admin/tool/xmldb/actions','XMLDBAction.class.php',63],['grade/report/singleview/tests/fixtures','screen.php',38],['mod/forum/classes/event','discussion_created.php',44],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/advlink/js','advlink.js',22],['blocks/recent_activity','block_recent_activity.php',43],['mod/forum/classes/event','discussion_deleted.php',45],['mod/scorm/classes/event','attempt_deleted.php',44],['blocks/calendar_upcoming','block_calendar_upcoming.php',26],['mod/lesson/classes/event','lesson_ended.php',40],['mod/feedback/item/textarea','lib.php',26],['admin/tool/xmldb/actions/load_xml_file','load_xml_file.class.php',32],['mod/forum/classes/event','subscribers_viewed.php',45],['mod/scorm/classes/event','report_viewed.php',45],['mod/feedback/item/numeric','lib.php',27],['admin/tool/xmldb/actions/delete_table','delete_table.class.php',32],['mod/data/preset/imagegallery','jstemplate.js',4],['mod/workshop/allocation','lib.php',40],['lib','graphlib.php',158],['mod/lesson/classes/event','user_override_deleted.php',44],['report/completion/classes/event','user_report_viewed.php',39],['admin/tool/langimport/classes/event','langpack_imported.php',61],['mod/forum/classes/event','subscription_deleted.php',44],['mod/lesson/classes/event','highscore_added.php',47],['mod/lesson/classes/event','essay_assessed.php',46],['lib/classes/event','message_sent.php',74],['lib/classes/event','message_contact_removed.php',39],['lib/classes/event','tag_unflagged.php',46],['mod/assign/classes/event','submission_graded.php',87],['lib','csslib.php',1493],['lib','csslib.php',1579],['lib','csslib.php',2462],['lib','csslib.php',2572],['lib','csslib.php',2593],['lib','csslib.php',2732],['lib','csslib.php',2762],['lib','csslib.php',2792],['lib','csslib.php',2822],['lib','csslib.php',2852],['lib','csslib.php',3186],['lib','csslib.php',3266],['lib','csslib.php',3309],['lib','csslib.php',3352],['lib','csslib.php',3395],['lib','csslib.php',3438],['lib','csslib.php',3525],['lib','csslib.php',3578],['lib','csslib.php',3608],['lib','csslib.php',3638],['lib','csslib.php',3668],['lib','csslib.php',3698],['lib','csslib.php',3728],['lib','csslib.php',3758],['lib','csslib.php',3788],['lib','csslib.php',3818],['lib','csslib.php',3848],['lib','csslib.php',3878],['lib','csslib.php',3908],['lib','csslib.php',3938],['lib','csslib.php',4243],['lib','csslib.php',4277],['lib','csslib.php',4328],['lib','csslib.php',4381],['lib','csslib.php',4413],['lib','csslib.php',4464],['lib','csslib.php',4515],['lib','csslib.php',4566],['lib','csslib.php',4596],['lib','csslib.php',4626],['lib','csslib.php',4656],['lib','csslib.php',4791],['lib','csslib.php',4821],['lib','csslib.php',4851],['lib','csslib.php',4881],['lib','csslib.php',4910],['lib','csslib.php',4945],['lib','csslib.php',4977],['mod/assign/classes/event','batch_set_marker_allocation_viewed.php',71],['report/outline/classes/event','activity_report_viewed.php',38],['lib/classes/event','calendar_event_updated.php',47],['mod/lesson/classes/event','user_override_created.php',44],['blocks/html','block_html.php',27],['admin/tool/xmldb/actions/view_field_xml','view_field_xml.class.php',32],['mod/wiki/classes/event','course_module_viewed.php',38],['mod/workshop/classes/event','assessment_reevaluated.php',45],['mod/feedback/item/info','lib.php',26],['lib/classes/event','assessable_uploaded.php',53],['mod/quiz/classes/event','user_override_updated.php',45],['mod/feedback/item','feedback_item_class.php',151],['lib/classes/event','webservice_service_user_added.php',77],['admin/tool/xmldb/actions/revert_changes','revert_changes.class.php',32],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/xhtmlxtras/js','ins.js',1],['backup/util/xml/output','file_xml_output.class.php',44],['admin/tool/monitor/classes/event','subscription_deleted.php',39],['lib/classes/event','notes_viewed.php',41],['mod/glossary/classes/event','entry_updated.php',43],['blocks/comments','block_comments.php',32],['admin/tool/monitor/classes/event','rule_created.php',39],['mod/wiki/classes/event','page_version_deleted.php',43],['lib/classes/event','course_completed.php',64],['admin/tool/xmldb/actions/edit_field_save','edit_field_save.class.php',33],['mod/assign/classes/event','submission_status_viewed.php',71],['portfolio/mahara','lib.php',53],['mod/glossary/classes/event','entry_approved.php',37],['webservice/amf/testclient','AMFTester.mxml',58],['admin/tool/xmldb/actions/delete_key','delete_key.class.php',32],['mod/wiki/classes/event','page_created.php',37],['mod/quiz/classes/event','group_override_created.php',46],['blocks/settings','block_settings.php',46],['blocks/tag_flickr','block_tag_flickr.php',30],['lib/classes/event','group_member_added.php',96],['lib/classes/event','message_contact_unblocked.php',39],['mod/quiz/classes/event','attempt_deleted.php',38],['admin/tool/xmldb/actions/generate_documentation','generate_documentation.class.php',32],['lib/classes/event','user_loggedin.php',91],['blocks/rss_client','block_rss_client.php',27],['mod/lesson/classes/event','lesson_restarted.php',39]], 446],
'validate_param': ['validate_param', 'Strict validation of parameter values, the values are only converted to requested PHP type. Internally it is using clean_param, the values before and after cleaning must be equal - otherwise an invalid_parameter_exception is thrown. Objects and classes are not accepted. ', [['lib','moodlelib.php',695]], 31],
'__construct': ['__construct', 'Constructor ', [['lib/jabber/XMPP','Log.php',67],['lib/zend/Zend/Gdata/Books','VolumeFeed.php',41],['lib/markdown','MarkdownExtra.php',51],['lib/zend/Zend/Gdata/Books/Extension','BooksCategory.php',42],['lib/horde/framework/Horde/Support','Uuid.php',23],['lib/zend/Zend/Validate','Iban.php',106],['repository/wikimedia','wikimedia.php',35],['lib/lessphp/Tree','Operation.php',19],['lib/alfresco/Service','Version.php',38],['lib/filestorage','file_exceptions.php',36],['lib/filestorage','file_exceptions.php',57],['lib/filestorage','file_exceptions.php',89],['lib/filestorage','file_exceptions.php',108],['lib/filestorage','file_exceptions.php',129],['backup/moodle2','backup_activity_task.class.php',45],['lib/htmlpurifier/HTMLPurifier','AttrCollections.php',16],['lib/phpunit/classes','database_driver_testcase.php',55],['lib/google/src/Google/Service','Reseller.php',44],['lib/horde/framework/Horde/Imap/Client/Interaction/Command','Continuation.php',42],['lib/phpunit/classes','advanced_testcase.php',45],['lib/zend/Zend/Service/DeveloperGarden/Request','RequestAbstract.php',40],['lib','outputlib.php',447],['lib','outputlib.php',2000],['repository/filesystem','lib.php',48],['lib/zend/Zend/XmlRpc/Value','Nil.php',40],['lib/lessphp/Tree','NameValue.php',21],['lib/zend/Zend/Gdata/YouTube','UserProfileEntry.php',283],['lib/zend/Zend/Gdata/Gapps','EmailListRecipientEntry.php',69],['lib/simplepie/library/SimplePie','Restriction.php',81],['lib/filebrowser','file_info_context_course.php',39],['lib/filebrowser','file_info_context_course.php',492],['lib/filebrowser','file_info_context_course.php',596],['lib/filebrowser','file_info_context_course.php',745],['lib/minify/lib/MrClay/Cli','Arg.php',82],['lib/horde/framework/Horde/Crypt/Blowfish','Mcrypt.php',47],['lib/classes/update','checker.php',50],['lib/adodb','adodb-active-recordx.inc.php',131],['lib/phpexcel/PHPExcel','Calculation.php',1721],['lib/zend/Zend/Gdata/Photos/Extension','NumPhotos.php',50],['availability/classes','info_module.php',40],['lib/zend/Zend/Gdata/Geo/Extension','GmlPos.php',49],['lib/zend/Zend/Gdata/App/Extension','Link.php',49],['lib/zend/Zend/Gdata/Photos/Extension','Access.php',51],['lib/zend/Zend/Server/Reflection','Parameter.php',58],['lib/zend/Zend/Service/DeveloperGarden/Client','ClientAbstract.php',129],['lib/horde/framework/Horde/Imap/Client','DateTime.php',29],['lib/zend/Zend/Validate/Db','Abstract.php',79],['cache/locks/file','lib.php',66],['lib/phpexcel/PHPExcel/CachedObjectStorage','PHPTemp.php',180],['question/type/missingtype','edit_missingtype_form.php',38],['auth/cas/CAS/CAS','Client.php',862],['lib/horde/framework/Horde/Imap/Client/Data','Envelope.php',46],['lib/zend/Zend/Gdata/Books','VolumeQuery.php',46],['lib/minify/lib/Minify/Cache','XCache.php',22],['lib/zend/Zend/XmlRpc','Request.php',92],['lib/zend/Zend/Service/Delicious','Post.php',74],['lib/zend/Zend/Gdata/Extension','FeedLink.php',53],['lib/zend/Zend/Http/Client/Adapter','Socket.php',97],['lib/grade','grade_object.php',80],['lib/zend/Zend/Gdata/YouTube','ContactFeed.php',55],['backup/util/plan','base_plan.class.php',39],['backup/util/plan','base_plan.class.php',215],['mod/lti/service/toolsettings/classes/local/resource','systemsettings.php',43],['lib/google/src/Google/Auth','LoginTicket.php',35],['lib/phpexcel/PHPExcel/Reader/Excel5','Escher.php',84],['lib/zend/Zend/Service/DeveloperGarden/SecurityTokenServer','Cache.php',59],['question/type/randomsamatch','question.php',114],['lib/zend/Zend/Service/WindowsAzure/Storage','SignedIdentifier.php',49],['lib/zend/Zend/Amf/Parse','OutputStream.php',40],['blocks','moodleblock.class.php',111],['lib/simplepie','autoloader.php',62],['mod/scorm','renderer.php',129],['lib/zend/Zend/Gdata/Extension','Who.php',64],['lib/zend/Zend/Gdata/Gapps','EmailListQuery.php',54],['lib/zend/Zend/Service/Simpy','LinkSet.php',47],['repository/flickr_public','lib.php',49],['lib/horde/framework/Horde/Imap/Client/Base','Debug.php',55],['lib/google/src/Google/Service','Replicapoolupdater.php',47],['admin/tool/generator/classes','site_backend.php',58],['mod/assign','assignmentplugin.php',50],['mod/lti/service/toolsettings/classes/local/resource','linksettings.php',45],['mod/lti/service/profile/classes/local/resource','profile.php',43],['lib/htmlpurifier/HTMLPurifier/AttrDef','Integer.php',36],['lib/horde/framework/Horde/Mail/Transport','Smtpmx.php',138],['backup/util/structure','base_optigroup.class.php',35],['backup/util/structure','base_optigroup.class.php',169],['lib/lessphp/Tree','Anonymous.php',21],['user','renderer.php',186],['lib/zend/Zend/Service/WindowsAzure','Storage.php',170],['lib/google/src/Google','Service.php',26],['lib/lessphp/Tree','Url.php',17],['webservice','lib.php',745],['webservice','lib.php',841],['webservice','lib.php',1120],['lib/phpexcel/PHPExcel/Worksheet/AutoFilter/Column','Rule.php',270],['lib/zend/Zend/Gdata/YouTube/Extension','MediaContent.php',55],['lib/horde/framework/Horde/Support','Randomid.php',26],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','DenyElementDecorator.php',21],['lib/tests','completionlib_test.php',863],['lib/zend/Zend/Service/Amazon','Accessories.php',44],['lib/zend/Zend/Validate/Barcode','Code39ext.php',47],['mod/assign/feedback/editpdf/classes','comment.php',58],['lib/phpexcel/PHPExcel/Writer/PDF','mPDF.php',46],['backup/moodle2','backup_settingslib.php',42],['lib/zend/Zend/Service/DeveloperGarden/Request/ConferenceCall','GetConferenceTemplateListRequest.php',46],['lib/zend/Zend/XmlRpc/Value','Base64.php',40],['backup/util/structure','backup_structure_processor.class.php',45],['backup/util/structure','backup_structure_processor.class.php',133],['lib/zend/Zend/Service/WindowsAzure/Storage','Blob.php',117],['lib/lessphp','Parser.php',75],['lib/zend/Zend/Service/DeveloperGarden/Response/IpLocation','LocateIPResponse.php',47],['lib/zend/Zend/Gdata','Query.php',72],['lib/zend/Zend/Service/Technorati','TagResultSet.php',57],['lib/zend/Zend/Rest/Client','Result.php',42],['lib/lessphp/Tree','Call.php',19],['lib/zend/Zend/Server/Method','Callback.php',59],['lib/minify/lib/Minify/JS','ClosureCompiler.php',38],['mod/workshop/backup/moodle1','lib.php',308],['lib/zend/Zend/Gdata/YouTube','ActivityFeed.php',54],['admin/tool/log/store/database/classes/log','store.php',47],['lib/zend/Zend/Validate','Alpha.php',65],['lib/zend/Zend/Gdata','Gapps.php',109],['lib/zend/Zend/Service/Flickr','Result.php',174],['question/type/multianswer','edit_multianswer_form.php',58],['mod/assign/feedback/file','renderable.php',44],['lib/horde/framework/Horde','Secret.php',48],['lib/zend/Zend/Gdata/Photos/Extension','AlbumId.php',51],['lib/lessphp/SourceMap','Base64VLQ.php',67],['lib/lessphp/Tree/Mixin','Call.php',14],['auth/cas/CAS/CAS','GracefullTerminationException.php',48],['lib/google/src/Google/Service','Fusiontables.php',48],['grade/report/singleview','lib.php',69],['lib/classes/lock','lock.php',55],['grade/grading/form','lib.php',82],['grade/grading/form','lib.php',766],['blog','locallib.php',71],['blog','locallib.php',581],['blog','locallib.php',849],['blog','locallib.php',894],['blog','locallib.php',953],['blog','locallib.php',1004],['blog','locallib.php',1028],['blog','locallib.php',1038],['blog','locallib.php',1050],['blog','locallib.php',1071],['lib/zend/Zend/Gdata/Exif/Extension','Flash.php',49],['backup/cc/cc_lib','cc_general.php',38],['lib/phpexcel/PHPExcel/Shared/JAMA','Matrix.php',61],['admin/webservice','lib.php',38],['lib/zend/Zend/Validate/File','FilesSize.php',60],['lib/phpexcel/PHPExcel/Writer/PDF','DomPDF.php',46],['lib/horde/framework/Horde/Imap/Client/Data/Format','Nstring.php',27],['repository/boxnet','lib.php',56],['lib/htmlpurifier/HTMLPurifier','Language.php',63],['lib/zend/Zend/Validate','Int.php',53],['lib/horde/framework/Horde/Mail/Transport','Smtphorde.php',62],['lib/zend/Zend/Soap','Server.php',146],['lib/zend/Zend/Gdata/Photos','PhotoEntry.php',215],['lib/zend/Zend/Service/Yahoo','LocalResult.php',111],['lib/zend/Zend/Service/DeveloperGarden/Request/BaseUserService','GetAccountBalance.php',40],['badges/lib','backpacklib.php',40],['lib/zend/Zend/Service/Yahoo','Result.php',77],['lib/form','filemanager.php',306],['lib/lessphp/Tree','Condition.php',18],['lib/pear/PEAR','Exception.php',107],['lib/zend/Zend/Gdata/YouTube/Extension','Racy.php',45],['question/classes/bank','view.php',70],['lib/adodb','adodb.inc.php',2790],['lib/adodb','adodb.inc.php',2865],['lib/zend/Zend/Gdata/App/Extension','Text.php',45],['question/engine/upgrade/tests','helper.php',45],['lib/zend/Zend/Validate/Barcode','Ean5.php',47],['blocks/private_files','renderer.php',83],['backup/util/settings/section','section_backup_setting.class.php',25],['lib/classes','useragent.php',115],['lib/zend/Zend/Gdata/Photos/Extension','CommentCount.php',51],['lib/horde/framework/Horde/Imap/Client/Data/Format','String.php',38],['lib/zend/Zend/Gdata/Spreadsheets/Extension','ColCount.php',49],['lib/horde/framework/Horde/Translation/Handler','Gettext.php',34],['lib/portfolio','exceptions.php',50],['lib/zend/Zend/Gdata/Calendar/Extension','QuickAdd.php',45],['lib/xmldb','xmldb_object.php',55],['lib/zend/Zend/Service','SlideShare.php',283],['webservice/amf','introspector.php',52],['question/behaviour/adaptive','behaviour.php',310],['question/behaviour','behaviourtypebase.php',133],['admin/tool/assignmentupgrade','upgradableassignmentstable.php',49],['course','renderer.php',52],['lib/zend/Zend/Validate','Hostname.php',315],['lib/phpexcel/PHPExcel/CachedObjectStorage','Memcache.php',249],['lib/zend/Zend/Amf','Server.php',134],['enrol/imsenterprise','locallib.php',38],['enrol/imsenterprise','locallib.php',115],['lib/zend/Zend/Http','Cookie.php',98],['lib/lessphp/Tree','Extend.php',28],['lib/zend/Zend/Validate','Barcode.php',75],['lib/zend/Zend/XmlRpc/Value','BigInteger.php',47],['lib/google/src/Google/Service','DoubleClickBidManager.php',40],['lib/google/src/Google/Service','QPXExpress.php',39],['lib/zend/Zend/Server/Reflection/Function','Abstract.php',105],['lib/phpexcel/PHPExcel/Style','Color.php',72],['lib/zend/Zend/Validate/File','Hash.php',60],['backup/util/settings/root','root_backup_setting.class.php',34],['backup/cc/cc_lib','cc_converter_basiclti.php',29],['lib/zend/Zend/Gdata/Photos/Extension','QuotaCurrent.php',50],['lib/zend/Zend/Service/Nirvanix/Namespace','Base.php',76],['lib/horde/framework/Horde/Imap/Client/Fetch','Results.php',54],['lib/zend/Zend/Service/Technorati','DailyCountsResult.php',60],['lib/zend/Zend/Rest','Server.php',102],['lib/zend/Zend/Gdata/Photos','UserFeed.php',106],['lib/tcpdf/include/barcodes','pdf417.php',523],['lib/minify/lib/Minify/CSS','Compressor.php',51],['lib/zend/Zend/Gdata/YouTube/Extension','VideoId.php',44],['lib/google/src/Google/Service','Blogger.php',50],['mod/workshop/allocation/random','lib.php',52],['mod/workshop/allocation/random','lib.php',727],['lib/zend/Zend/Gdata/App/Extension','Published.php',43],['lib/google/src/Google/Service','Doubleclicksearch.php',43],['lib/htmlpurifier/HTMLPurifier/AttrTransform','Nofollow.php',16],['lib/phpexcel/PHPExcel/Shared/trend','powerBestFitClass.php',129],['lib/zend/Zend/Gdata/Photos','AlbumEntry.php',193],['lib/zend/Zend/Gdata/Docs','DocumentListFeed.php',56],['lib/zend/Zend/Gdata/App/Extension','Icon.php',43],['lib/portfolio','plugin.php',445],['lib/zend/Zend/Gdata/Extension','OpenSearchItemsPerPage.php',44],['lib/horde/framework/Horde/Exception','LastError.php',16],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','ID.php',28],['lib/zend/Zend/Service/Yahoo','WebResult.php',83],['lib/horde/framework/Horde/Imap/Client/Interaction','Client.php',34],['lib/google/src/Google/Service','AdExchangeBuyer.php',46],['lib/dtl','file_xml_database_exporter.php',36],['backup/cc','validator.php',30],['backup/cc','validator.php',116],['backup/cc','validator.php',202],['backup/cc','validator.php',230],['backup/cc','validator.php',236],['backup/cc','validator.php',242],['backup/cc','validator.php',248],['backup/cc','validator.php',254],['backup/cc','validator.php',260],['lib/zend/Zend/Gdata/YouTube/Extension','Token.php',44],['lib/phpexcel/PHPExcel/Worksheet','HeaderFooterDrawing.php',87],['lib/phpexcel/PHPExcel/Writer/PDF','tcPDF.php',47],['lib/xmldb','xmldb_field.php',84],['lib/phpexcel/PHPExcel/Writer','Excel2007.php',126],['lib/zend/Zend/Service/DeveloperGarden/Request/ConferenceCall','GetConferenceStatusRequest.php',65],['lib/google/src/Google/Service','Manager.php',57],['lib/zend/Zend/Service/Amazon','Offer.php',79],['lib/horde/framework/Horde/Imap/Client/Data/Format','Mailbox.php',35],['lib/zend/Zend/Gdata/App','FeedEntryParent.php',129],['lib/zend/Zend/Service/Technorati','KeyInfoResult.php',61],['lib/htmlpurifier/HTMLPurifier/TagTransform','Simple.php',19],['webservice/rest','lib.php',47],['lib/zend/Zend/Service/StrikeIron','Decorator.php',47],['lib/google/src/Google/Http','Batch.php',38],['lib/google/src/Google/Service','Reports.php',47],['auth/cas/CAS/CAS','OutOfSequenceBeforeAuthenticationCallException.php',47],['lib/zend/Zend/Gdata/Media/Extension','MediaKeywords.php',43],['repository/url','lib.php',46],['lib','xmlize.php',31],['mod/forum/classes','potential_subscriber_selector.php',47],['lib/filebrowser','file_info_context_system.php',37],['lib/zend/Zend/Service/Amazon','Abstract.php',74],['lib/zend/Zend/Server','Definition.php',43],['lib/minify/lib/Minify','ImportProcessor.php',48],['lib/zend/Zend/Amf/Util','BinaryStream.php',53],['lib/portfolio','exporter.php',113],['backup/cc/cc_lib','cc_converter_page.php',28],['lib/zend/Zend/Gdata/YouTube','SubscriptionFeed.php',55],['lib/alfresco/Service','SpacesStore.php',28],['repository/recent','lib.php',39],['lib/zend/Zend/Service/DeveloperGarden/IpLocation','IpAddress.php',59],['lib/zend/Zend/Validate','Regex.php',62],['lib/phpexcel/PHPExcel/Shared/trend','exponentialBestFitClass.php',135],['lib/phpexcel/PHPExcel','ReferenceHelper.php',65],['lib','webdavlib.php',84],['lib/htmlpurifier/HTMLPurifier/AttrTransform','TargetBlank.php',17],['auth/cas/CAS/CAS','AuthenticationException.php',53],['lib/zend/Zend/Gdata/Gapps','NicknameQuery.php',54],['lib/bennu','iCalendar_properties.php',28],['lib/bennu','iCalendar_properties.php',220],['lib/bennu','iCalendar_properties.php',238],['lib/bennu','iCalendar_properties.php',259],['lib/bennu','iCalendar_properties.php',275],['lib/bennu','iCalendar_properties.php',296],['lib/bennu','iCalendar_properties.php',343],['lib/bennu','iCalendar_properties.php',358],['lib/bennu','iCalendar_properties.php',376],['lib/bennu','iCalendar_properties.php',391],['lib/bennu','iCalendar_properties.php',406],['lib/bennu','iCalendar_properties.php',447],['lib/bennu','iCalendar_properties.php',462],['lib/bennu','iCalendar_properties.php',485],['lib/bennu','iCalendar_properties.php',509],['lib/bennu','iCalendar_properties.php',524],['lib/bennu','iCalendar_properties.php',555],['lib/bennu','iCalendar_properties.php',573],['lib/bennu','iCalendar_properties.php',594],['lib/bennu','iCalendar_properties.php',637],['lib/bennu','iCalendar_properties.php',680],['lib/bennu','iCalendar_properties.php',724],['lib/bennu','iCalendar_properties.php',747],['lib/bennu','iCalendar_properties.php',782],['lib/bennu','iCalendar_properties.php',808],['lib/bennu','iCalendar_properties.php',849],['lib/bennu','iCalendar_properties.php',864],['lib/bennu','iCalendar_properties.php',905],['lib/bennu','iCalendar_properties.php',938],['lib/bennu','iCalendar_properties.php',952],['lib/bennu','iCalendar_properties.php',965],['lib/bennu','iCalendar_properties.php',987],['lib/bennu','iCalendar_properties.php',1017],['lib/bennu','iCalendar_properties.php',1031],['lib/bennu','iCalendar_properties.php',1061],['lib/bennu','iCalendar_properties.php',1075],['lib/bennu','iCalendar_properties.php',1098],['lib/bennu','iCalendar_properties.php',1110],['lib/bennu','iCalendar_properties.php',1139],['lib/bennu','iCalendar_properties.php',1160],['lib/bennu','iCalendar_properties.php',1181],['lib/bennu','iCalendar_properties.php',1203],['lib/bennu','iCalendar_properties.php',1227],['lib/bennu','iCalendar_properties.php',1260],['lib/bennu','iCalendar_properties.php',1386],['lib/bennu','iCalendar_properties.php',1407],['lib/bennu','iCalendar_properties.php',1429],['lib/bennu','iCalendar_properties.php',1450],['lib/phpexcel/PHPExcel/Calculation','ExceptionHandler.php',36],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Mongo.php',78],['lib/horde/framework/Horde','Domhtml.php',53],['auth/cas/CAS/CAS','OutOfSequenceBeforeProxyException.php',48],['lib/simplepie/library/SimplePie/Parse','Date.php',536],['lib/google/src/Google/Service','Customsearch.php',38],['lib/zend/Zend/Gdata/App','MediaFileSource.php',54],['backup/util/plan','restore_step.class.php',32],['backup/util/plan','restore_step.class.php',104],['lib/lessphp/Tree','Comment.php',17],['availability/tests/fixtures','mock_info.php',40],['lib/htmlpurifier/HTMLPurifier/AttrTransform','EnumToCSS.php',34],['backup/util/ui','base_ui.class.php',84],['lib/phpexcel/PHPExcel','DocumentSecurity.php',73],['lib/htmlpurifier/HTMLPurifier/AttrDef/URI','Host.php',15],['backup/cc/cc_lib','cc_converter_lti.php',29],['lib/zend/Zend/Gdata/YouTube/Extension','Position.php',44],['lib/zend/Zend/Service/WindowsAzure/Credentials','CredentialsAbstract.php',77],['lib/zend/Zend/Soap','AutoDiscover.php',94],['lib/htmlpurifier/HTMLPurifier','URI.php',58],['lib/phpexcel/PHPExcel','IOFactory.php',77],['lib/zend/Zend/Gdata/App/Extension','Email.php',43],['lib/zend/Zend/Gdata/Media/Extension','MediaHash.php',45],['lib/zend/Zend/Gdata/App/Extension','Element.php',42],['lib/google/src/Google/Service','Gmail.php',55],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Multiple.php',33],['repository/dropbox','lib.php',49],['lib/minify/lib/Minify','Source.php',43],['backup/util/dbops','backup_dbops.class.php',37],['lib/google/src/Google/Service','Plus.php',52],['lib/horde/framework/Horde/Imap/Client/Data/Format','List.php',28],['lib/google/src/Google/Service','Spectrum.php',38],['files','renderer.php',1080],['lib/zend/Zend/Validate/Barcode','Ean2.php',47],['course','lib.php',2932],['lib/horde/framework/Horde/Support','ConsistentHash.php',56],['lib/zend/Zend/Service/Simpy','Watchlist.php',89],['lib/phpexcel/PHPExcel','Style.php',101],['lib/zend/Zend/Gdata/YouTube/Extension','CountHint.php',44],['lib/minify/lib/Minify/Cache','Memcache.php',22],['auth/db','auth.php',36],['lib/zend/Zend/Gdata/Gapps','UserQuery.php',54],['admin/roles/classes','assign_user_selector_base.php',40],['lib/zend/Zend/Gdata/Exif/Extension','Model.php',49],['lib/zend/Zend/Gdata/YouTube','PlaylistListFeed.php',55],['lib/zend/Zend/Gdata/Docs','DocumentListEntry.php',42],['mod/quiz/tests','repaginate_test.php',39],['question/engine','questionusage.php',78],['question/engine','questionusage.php',973],['lib/simplepie/library/SimplePie/Cache','MySQL.php',80],['lib/zend/Zend/Service/Twitter','Search.php',70],['lib/zend/Zend/Server/Method','Parameter.php',59],['lib/phpunit/classes','basic_testcase.php',39],['lib/zend/Zend/Service/WindowsAzure/Storage','BlobContainer.php',50],['lib/zend/Zend/Service/DeveloperGarden/Response/LocalSearch','LocalSearchResponse.php',50],['lib/horde/framework/Horde/Imap/Client','Ids.php',78],['mod/wiki/parser/markups','html.php',18],['lib/google/src/Google/Service','Mirror.php',49],['lib/classes/event','base.php',114],['lib/alfresco/Service','Repository.php',36],['lib/zend/Zend/Service/Technorati','CosmosResult.php',84],['backup/moodle2','backup_xml_transformer.class.php',50],['lib/phpexcel/PHPExcel/Reader/Excel5','RC4.php',42],['lib/zend/Zend/Service/Yahoo','PageDataResult.php',47],['lib/zend/Zend/Service/WindowsAzure/Storage','Table.php',99],['lib/zend/Zend/Service/DeveloperGarden/Request/ConferenceCall','UpdateConferenceTemplateRequest.php',60],['lib/phpexcel/PHPExcel/Shared/JAMA','EigenvalueDecomposition.php',775],['lib/tcpdf','tcpdf_parser.php',92],['lib/minify/lib/Minify/Cache','APC.php',19],['lib/zend/Zend/Gdata','MimeBodyString.php',49],['lib/phpexcel/PHPExcel/Reader','OOCalc.php',55],['lib/phpexcel/PHPExcel/Calculation','FormulaParser.php',92],['lib/google/src/Google/Http','MediaFileUpload.php',73],['lib/zend/Zend/XmlRpc/Client','ServerProxy.php',54],['lib','listlib.php',82],['lib','listlib.php',485],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Background.php',20],['lib/zend/Zend/Gdata/Health','ProfileFeed.php',49],['lib/google/src/Google/Service','Genomics.php',60],['lib/google/src/Google/Service','Urlshortener.php',40],['lib/zend/Zend/Server/Reflection','Method.php',51],['lib/tests','medialib_test.php',631],['lib/htmlpurifier/HTMLPurifier/ChildDef','Required.php',23],['lib/zend/Zend/Soap/Client','DotNet.php',43],['admin/roles/classes','allow_role_page.php',37],['backup/util/dbops','restore_dbops.class.php',1755],['lib/zend/Zend/Service/Yahoo','NewsResult.php',97],['backup/util/plan','restore_task.class.php',32],['backup/util/plan','restore_task.class.php',121],['webservice/rest','locallib.php',40],['lib/simplepie/library/SimplePie','Sanitize.php',75],['lib','uploadlib.php',40],['lib/zend/Zend/Gdata','Health.php',109],['lib','questionlib.php',1269],['lib','questionlib.php',1513],['lib/dml','oci_native_moodle_recordset.php',34],['lib/zend/Zend/Service/DeveloperGarden/Request/ConferenceCall','RemoveParticipantRequest.php',53],['lib/zend/Zend/XmlRpc/Value','String.php',38],['lib/zend/Zend/Gdata/Calendar/Extension','AccessLevel.php',45],['lib/ddl','database_manager.php',48],['lib/zend/Zend/Service/DeveloperGarden/Request/ConferenceCall','CreateConferenceTemplateRequest.php',60],['backup/util/xml/parser','progressive_parser.class.php',79],['backup/util/xml/parser','progressive_parser.class.php',305],['backup/util/settings','base_setting.class.php',89],['backup/util/settings','base_setting.class.php',556],['lib/dtl','database_exporter.php',55],['mod/workshop/form/accumulative','lib.php',99],['lib/htmlpurifier/HTMLPurifier','HTMLDefinition.php',182],['grade/report/singleview/classes/local/ui','bulk_insert.php',40],['lib/zend/Zend/Validate','Float.php',53],['lib/zend/Zend/Gdata/Gapps/Extension','EmailList.php',59],['cache/classes','interfaces.php',473],['lib/zend/Zend/Gdata/App/Extension','Edited.php',43],['lib/zend/Zend/Gdata/Gapps','UserEntry.php',103],['lib/lessphp/Tree','Element.php',19],['lib','moodlelib.php',9143],['lib','moodlelib.php',9354],['repository/picasa','lib.php',41],['webservice/soap','lib.php',42],['lib/zend/Zend/Gdata/Calendar','EventEntry.php',71],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Border.php',18],['lib/phpexcel/PHPExcel/Shared/trend','linearBestFitClass.php',98],['backup/cc/cc_lib','cc_assesment_essay.php',25],['lib/zend/Zend/Service/WindowsAzure/RetryPolicy','RetryN.php',56],['lib/dml','moodle_temptables.php',51],['lib/zend/Zend/Gdata/Media/Extension','MediaContent.php',116],['lib/zend/Zend/Gdata/Gapps','EmailListEntry.php',80],['admin/roles/classes','allow_assign_page.php',31],['lib/zend/Zend/Gdata','Books.php',80],['lib/zend/Zend/Amf/Value','MessageHeader.php',64],['lib/zend/Zend/Validate','GreaterThan.php',59],['lib/zend/Zend/Gdata/YouTube/Extension','PlaylistId.php',44],['calendar/classes','rrule_manager.php',182],['lib/phpexcel/PHPExcel/Worksheet','Drawing.php',45],['lib/zend/Zend/Service/ReCaptcha','Response.php',53],['lib/simplepie/library/SimplePie/HTTP','Parser.php',131],['lib/phpexcel/PHPExcel/Style','NumberFormat.php',106],['lib/zend/Zend/Amf/Value/Messaging','RemotingMessage.php',58],['lib/tcpdf','tcpdf.php',1822],['lib/zend/Zend/Gdata/YouTube/Extension','Username.php',44],['lib/zend/Zend/Gdata/Photos/Extension','Version.php',51],['lib/htmlpurifier/HTMLPurifier/AttrTransform','Input.php',14],['lib/zend/Zend/Service/WindowsAzure/Storage','Batch.php',77],['lib/mustache/src/Mustache','Engine.php',61],['lib/xmldb','xmldb_structure.php',40],['lib/zend/Zend/Gdata/Photos','TagEntry.php',61],['webservice/amf','locallib.php',41],['webservice/amf','locallib.php',60],['lib/htmlpurifier/HTMLPurifier/ChildDef','Chameleon.php',36],['lib/horde/framework/Horde/Imap/Client','Base.php',153],['question/type/numerical/tests','form_test.php',40],['lib/google/src/Google/Service','IdentityToolkit.php',38],['comment','locallib.php',39],['lib/zend/Zend/Gdata/Extension','Comments.php',50],['lib/google/src/Google/Service','Resource.php',60],['lib/horde/framework/Horde/Imap/Client/Socket','Catenate.php',37],['lib/zend/Zend/Gdata/YouTube/Extension','Recorded.php',44],['lib/zend/Zend/Amf/Request','Http.php',46],['backup/util/settings','setting_dependency.class.php',68],['backup/util/settings','setting_dependency.class.php',175],['backup/util/settings','setting_dependency.class.php',328],['backup/util/settings','setting_dependency.class.php',439],['backup/util/settings','setting_dependency.class.php',465],['backup/util/settings','setting_dependency.class.php',491],['backup/util/settings','setting_dependency.class.php',556],['question/engine/upgrade','behaviourconverters.php',78],['lib/zend/Zend/Service/DeveloperGarden/ConferenceCall','ParticipantDetail.php',62],['repository/s3','lib.php',39],['lib/minify/lib/MrClay','Cli.php',74],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','AlphaValue.php',6],['lib/horde/framework/Horde/Imap/Client','Tokenize.php',67],['lib/zend/Zend/Gdata/App','HttpException.php',51],['lib/zend/Zend/Soap/Client','Common.php',40],['lib/google/src/Google/Service','Dfareporting.php',45],['lib/lessphp/Output','Mapped.php',39],['lib/classes/output','notification.php',66],['lib/google/src/Google/Service','PlusDomains.php',72],['backup/util/plan','base_task.class.php',40],['backup/util/plan','base_task.class.php',277],['lib/editor/tinymce','adminlib.php',36],['lib/zend/Zend/Service/Amazon/Ec2','Exception.php',41],['lib/phpexcel/PHPExcel/Cell','Hyperlink.php',52],['lib/simplepie/library/SimplePie','Locator.php',68],['lib/phpexcel/PHPExcel/Chart/Renderer','jpgraph.php',846],['lib/xmldb','xmldb_key.php',43],['user/filters','checkbox.php',51],['lib/phpexcel/PHPExcel/Reader','SYLK.php',75],['question/type/numerical','questiontype.php',507],['backup/cc/cc_lib','cc_converter_url.php',29],['lib/zend/Zend/Gdata/App/Extension','Control.php',50],['lib/minify/lib','FirePHP.php',189],['lib/lessphp/Tree/Mixin','Definition.php',18],['lib/zend/Zend/Service/Yahoo','LocalResultSet.php',61],['lib','ddllib.php',80],['lib','ddllib.php',93],['lib','ddllib.php',107],['lib','ddllib.php',126],['lib','ddllib.php',140],['admin/tool/langimport/classes','controller.php',48],['lib/google/src/Google/Auth','AssertionCredentials.php',53],['lib/horde/framework/Horde/Stream','String.php',27],['lib','excellib.class.php',47],['lib','excellib.class.php',155],['lib','excellib.class.php',454],['lib/horde/framework/Horde/Stream','Temp.php',25],['lib/alfresco/Service','VersionHistory.php',34],['lib/zend/Zend/Service/DeveloperGarden/ConferenceCall','ConferenceSchedule.php',81],['mod/quiz/classes','repaginate.php',49],['lib/zend/Zend/Validate','Isbn.php',65],['lib/zend/Zend/Service/Amazon','Image.php',55],['backup/util/ui','restore_ui_components.php',81],['backup/util/ui','restore_ui_components.php',287],['backup/util/ui','restore_ui_components.php',382],['lib/classes/lock','db_record_lock_factory.php',61],['lib/horde/framework/Horde/Stream','TempString.php',40],['lib/htmlpurifier/HTMLPurifier/ConfigSchema','InterchangeBuilder.php',15],['lib/htmlpurifier/HTMLPurifier/ChildDef','Empty.php',22],['lib/zend/Zend/Gdata/Spreadsheets/Extension','Cell.php',76],['question/type/calculated','question.php',188],['question/type/calculated','question.php',303],['lib/horde/framework/Horde/Text','Flowed.php',75],['lib/horde/framework/Horde/Imap/Client/Data/Format','Date.php',25],['lib/zend/Zend/Gdata/Gapps/Extension','Login.php',111],['mod/workshop/form/rubric','lib.php',105],['cohort','locallib.php',37],['cohort','locallib.php',101],['lib/zend/Zend/XmlRpc/Value','DateTime.php',53],['lib/zend/Zend/Service/WindowsAzure/Storage','QueueMessage.php',52],['lib/htmlpurifier/HTMLPurifier','Queue.php',24],['lib/zend/Zend/Amf/Parse','Serializer.php',40],['lib/google/src/Google/Service','GroupsMigration.php',38],['lib/phpexcel/PHPExcel/Worksheet','PageSetup.php',277],['lib/zend/Zend/Gdata/Gapps','ServiceException.php',61],['lib/htmlpurifier/HTMLPurifier','AttrTypes.php',14],['lib/zend/Zend/XmlRpc','Fault.php',100],['lib/zend/Zend/Gdata','Photos.php',124],['question/type/calculated','datasetdefinitions_form.php',53],['lib/phpexcel/PHPExcel/Reader','Excel5.php',424],['question/type/shortanswer','question.php',43],['backup/util/structure','base_final_element.class.php',38],['backup/util/structure','base_final_element.class.php',239],['backup/util/structure','base_final_element.class.php',256],['lib/zend/Zend/Service','LiveDocx.php',67],['backup/util/plan','backup_plan.class.php',36],['backup/util/plan','backup_plan.class.php',130],['lib/google/src/Google/Auth','AppIdentity.php',38],['lib/zend/Zend/Gdata/Exif/Extension','FocalLength.php',49],['lib/zend/Zend/Gdata/App/Extension','Id.php',43],['lib/zend/Zend/Gdata/Books/Extension','PreviewLink.php',42],['mod/chat','locallib.php',179],['mod/chat','locallib.php',227],['lib/google/src/Google/Service','Licensing.php',38],['auth/cas/CAS/CAS/PGTStorage','File.php',105],['lib/zend/Zend/Server/Method','Definition.php',64],['lib/zend/Zend/Service/DeveloperGarden/Request/ConferenceCall','GetParticipantStatusRequest.php',53],['question/classes/bank','column_base.php',44],['lib/zend/Zend/XmlRpc/Server','Fault.php',67],['lib/zend/Zend/Amf/Value/Messaging','AcknowledgeMessage.php',40],['grade/report/singleview/classes/local/ui','range.php',38],['lib/zend/Zend/Gdata/Books/Extension','Viewability.php',45],['mod/book','locallib.php',405],['lib/zend/Zend/XmlRpc/Value','Array.php',39],['lib/zend/Zend/Service/Technorati','Result.php',63],['lib/zend/Zend/Service/DeveloperGarden/Request/ConferenceCall','RemoveConferenceTemplateRequest.php',46],['lib/zend/Zend/Gdata/Exif/Extension','Exposure.php',49],['lib/zend/Zend/Gdata/Exif','Feed.php',58],['question/type/randomsamatch/tests','helper.php',121],['lib/htmlpurifier/HTMLPurifier','PropertyListIterator.php',22],['question/engine/upgrade','logger.php',42],['question/engine/upgrade','logger.php',87],['lib/portfolio/formats/leap2a','lib.php',62],['lib/portfolio/formats/leap2a','lib.php',258],['lib/portfolio/formats/leap2a','lib.php',503],['lib/zend/Zend/Gdata/Spreadsheets','CellEntry.php',49],['lib/zend/Zend/Gdata/Photos/Extension','PhotoId.php',49],['lib/zend/Zend/Http/Response','Stream.php',120],['lib','modinfolib.php',429],['lib','modinfolib.php',1680],['lib','modinfolib.php',2516],['lib/dtl','database_importer.php',61],['lib/tcpdf','tcpdf_barcodes_2d.php',58],['lib/zend/Zend/Gdata/Exif/Extension','Iso.php',49],['lib/zend/Zend/Gdata/YouTube','VideoQuery.php',48],['lib/lessphp/Tree','Variable.php',20],['backup/moodle2','restore_activity_task.class.php',48],['lib/htmlpurifier/HTMLPurifier/AttrTransform','ImgSpace.php',24],['lib/google/src/Google/Signer','P12.php',33],['lib/lessphp/Tree','DetachedRuleset.php',15],['lib/zend/Zend/Gdata/YouTube','SubscriptionEntry.php',138],['lib/zend/Zend/Http/Client/Adapter','Test.php',81],['','mdeploy.php',120],['lib/ddl','sqlite_sql_generator.php',73],['lib/google/src/Google/Service','Drive.php',70],['mod/quiz/classes','admin_review_setting.php',82],['lib','pdflib.php',161],['lib/zend/Zend/Gdata/YouTube/Extension','Duration.php',45],['mod/quiz/report','attemptsreport_options.php',95],['lib/zend/Zend/Validate/File','Md5.php',60],['backup/util/helper','restore_questions_parser_processor.class.php',42],['lib/horde/framework/Horde/Imap/Client/Exception','SearchCharset.php',34],['lib/filebrowser','file_info_context_coursecat.php',39],['badges','renderer.php',972],['badges','renderer.php',1013],['badges','renderer.php',1077],['badges','renderer.php',1110],['badges','renderer.php',1136],['lib/horde/framework/Horde/Imap/Client','Socket.php',168],['lib/htmlpurifier/HTMLPurifier/ConfigSchema/Interchange','Id.php',17],['lib/zend/Zend/Gdata/Gapps/Extension','Nickname.php',59],['lib/zend/Zend/Gdata/YouTube/Extension','MediaRating.php',54],['lib/htmlpurifier/HTMLPurifier','UnitConverter.php',50],['mnet/xmlrpc','serverlib.php',674],['completion','data_object.php',68],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Filter.php',15],['lib/horde/framework/Horde/Support','StringStream.php',30],['lib/simplepie/library/SimplePie','gzdecode.php',186],['lib/jabber/XMPP','Roster.php',48],['lib/classes/dml','recordset_walk.php',64],['lib','dmllib.php',69],['lib','dmllib.php',84],['lib','dmllib.php',104],['lib','dmllib.php',129],['lib','dmllib.php',159],['lib','dmllib.php',187],['lib','dmllib.php',240],['lib','dmllib.php',270],['lib/phpexcel/PHPExcel/Worksheet','BaseDrawing.php',129],['lib/google/src/Google/Service','Books.php',57],['mod/assign/feedback/offline','importgradeslib.php',60],['lib/zend/Zend/Gdata','App.php',165],['lib/pear/Net','GeoIP.php',323],['lib/zend/Zend/Gdata/Photos/Extension','Name.php',50],['lib/google/src/Google/Service','AdExchangeSeller.php',53],['lib/zend/Zend/Gdata/Docs','Query.php',75],['lib/zend/Zend/Gdata/YouTube/Extension','Occupation.php',44],['lib/zend/Zend/Gdata/Exif/Extension','Time.php',49],['cache/tests/fixtures','lib.php',325],['lib/horde/framework/Horde/Mail/Rfc822','List.php',61],['lib/google/src/Google/Cache','Memcache.php',42],['lib/dml','sqlsrv_native_moodle_database.php',47],['backup/util/structure','backup_optigroup_element.class.php',51],['backup/cc/cc_lib','cc_converter_resource.php',28],['lib/simplepie/library/SimplePie','Caption.php',98],['mod/lti','OAuth.php',73],['mod/lti','OAuth.php',89],['mod/lti','OAuth.php',244],['mod/lti','OAuth.php',499],['lib/classes','collator.php',58],['lib/zend/Zend/Service/Delicious','PostList.php',56],['lib/classes/output','mustache_filesystem_loader.php',39],['lib/zend/Zend/Service/Amazon/Ec2','Abstract.php',91],['backup/util/xml/parser/processors','grouped_parser_processor.class.php',67],['mod/workshop/form/numerrors','lib.php',102],['lib/zend/Zend/Service/DeveloperGarden/Request/ConferenceCall','GetConferenceTemplateRequest.php',46],['report/log/classes','table_log.php',52],['lib/zend/Zend/Gdata/YouTube','CommentEntry.php',48],['lib/simplepie/library/SimplePie/Cache','Base.php',70],['lib/zend/Zend/Gdata/YouTube/Extension','Status.php',44],['lib/adodb','adodb-exceptions.inc.php',28],['backup/util/helper','backup_array_iterator.class.php',39],['lib/zend/Zend/Rest','Client.php',54],['lib/zend/Zend/Gdata/YouTube/Extension','Company.php',44],['question/classes/statistics/responses','analysis_for_class.php',68],['lib/zend/Zend/Service/DeveloperGarden/Request/ConferenceCall','RemoveConferenceTemplateParticipantRequest.php',53],['question/engine','lib.php',770],['question/engine','lib.php',1000],['question/engine','lib.php',1048],['lib/tcpdf','tcpdf_barcodes_1d.php',58],['lib/google/src/Google/Service','Bigquery.php',59],['backup/moodle2','restore_course_task.class.php',41],['lib/zend/Zend/Gdata/Media/Extension','MediaRestriction.php',54],['lib/htmlpurifier/HTMLPurifier','DefinitionCache.php',22],['lib/phpexcel/PHPExcel/Writer','CSV.php',86],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Hashtable.php',73],['cache','disabledlib.php',44],['lib/htmlpurifier/HTMLPurifier','PercentEncoder.php',20],['lib/mustache/src/Mustache/Exception','UnknownTemplateException.php',22],['webservice/xmlrpc','locallib.php',85],['lib/google/src/Google/Service','Freebase.php',38],['mod/lti/service/profile/classes/local/service','profile.php',41],['admin/tool/monitor/classes/output/managesubs','rules.php',56],['backup/util/settings','backup_setting.class.php',43],['grade/report/singleview/classes/local/ui','checkbox_attribute.php',42],['lib/alfresco/Service','ContentData.php',38],['enrol/ldap','lib.php',36],['lib/zend/Zend/Validate/File','MimeType.php',112],['lib/zend/Zend/Gdata/Gbase/Extension','BaseAttribute.php',47],['lib/zend/Zend/Gdata/Gapps','NicknameEntry.php',79],['lib/minify/lib/Minify','HTML.php',49],['lib/zend/Zend/Gdata/Extension','OriginalEvent.php',56],['lib/zend/Zend/Gdata/YouTube','InboxFeed.php',55],['lib/google/src/Google/Service','Groupssettings.php',40],['availability/classes','info.php',55],['lib/horde/framework/Horde/Mail/Rfc822','Group.php',45],['lib/tests','navigationlib_test.php',472],['lib/tests','navigationlib_test.php',530],['lib/tests','navigationlib_test.php',557],['lib/zend/Zend/Service/DeveloperGarden/Request/IpLocation','LocateIPRequest.php',58],['mod/quiz/report/statistics/classes','calculated.php',43],['grade/report/singleview/classes/local/ui','dropdown_attribute.php',49],['cache/stores/memcached','lib.php',107],['lib/zend/Zend/Validate','Between.php',89],['lib/zend/Zend/Gdata/Media/Extension','MediaGroup.php',183],['user/selector','lib.php',85],['user/selector','lib.php',674],['lib/google/src/Google/Service','YouTube.php',68],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Length.php',23],['lib/zend/Zend/Gdata','Exif.php',51],['backup/util/helper','backup_helper.class.php',380],['backup/util/plan','backup_step.class.php',32],['backup/util/plan','backup_step.class.php',55],['backup/util/helper','restore_inforef_parser_processor.class.php',37],['lib/phpexcel/PHPExcel/Cell','DataValidation.php',154],['lib/phpexcel/PHPExcel/CalcEngine','Logger.php',71],['lib/zend/Zend/Gdata','YouTube.php',192],['lib/zend/Zend/Gdata/Calendar/Extension','Link.php',48],['blocks','edit_form.php',47],['lib/dml','mssql_native_moodle_recordset.php',34],['mod/assign','locallib.php',149],['mod/assign','locallib.php',7411],['grade/report/user','lib.php',188],['lib/zend/Zend/Validate/Barcode','Code93ext.php',47],['lib/zend/Zend/Service/DeveloperGarden/Request/BaseUserService','ChangeQuotaPool.php',47],['lib/phpexcel/PHPExcel/CachedObjectStorage','SQLite3.php',294],['lib/horde/framework/Horde/Mail/Transport','Mail.php',53],['lib/zend/Zend/Gdata','Media.php',51],['lib/zend/Zend/Gdata/Gapps/Extension','Quota.php',59],['lib/zend/Zend/Amf/Value','ByteArray.php',38],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','Bool.php',22],['lib/simplepie/library/SimplePie/Cache','File.php',82],['lib/behat/form_field','behat_form_field.php',59],['mod/lti/service/toolproxy/classes/local/resource','toolproxy.php',47],['backup/moodle2','restore_subplugin.class.php',45],['lib/zend/Zend/Gdata/Spreadsheets','SpreadsheetFeed.php',54],['backup/util/structure','base_processor.class.php',49],['lib/zend/Zend/Gdata/Calendar/Extension','Timezone.php',45],['lib/zend/Zend/Validate','Ip.php',56],['lib/zend/Zend/Gdata/Extension','OpenSearchTotalResults.php',44],['badges/criteria','award_criteria_activity.php',45],['lib/zend/Zend/Service/Technorati','DailyCountsResultSet.php',67],['lib/zend/Zend/XmlRpc/Value','Collection.php',40],['lib/google/src/Google/Service','Coordinate.php',47],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','LinkTypes.php',21],['lib/classes/output','mustache_pix_helper.php',43],['lib/zend/Zend/Amf/Value','MessageBody.php',81],['user/classes/output/myprofile','node.php',82],['lib/htmlpurifier/HTMLPurifier','TokenFactory.php',43],['lib/zend/Zend','Registry.php',186],['lib/lessphp/Exception','Chunk.php',19],['lib/dtl','database_mover.php',33],['lib/zend/Zend/Http','CookieJar.php',106],['lib/zend/Zend/Gdata/Extension','Transparency.php',44],['lib/zend/Zend/Gdata/Media/Extension','MediaText.php',64],['lib/phpexcel/PHPExcel/RichText','TextElement.php',43],['lib/simplepie/library/SimplePie','Enclosure.php',219],['lib/google/src/Google/Service','Webmasters.php',46],['lib/lessphp/Tree','Value.php',14],['lib/simplepie/library','SimplePie.php',611],['lib/google/src/Google/Service','Autoscaler.php',46],['lib/zend/Zend/Gdata/App','CaptchaRequiredException.php',64],['lib/behat/features/bootstrap','behat_init_context.php',45],['lib/horde/framework/Horde/Imap/Client/Socket','ClientSort.php',37],['mod/folder','renderer.php',139],['lib/google/src/Google/Service','Webfonts.php',38],['lib/zend/Zend/Gdata/DublinCore/Extension','Description.php',44],['admin/roles/classes','admins_potential_selector.php',30],['lib/zend/Zend/Soap/Client','Local.php',52],['lib/horde/framework/Horde/Imap/Client/Interaction/Server','Tagged.php',36],['lib/lessphp/Tree','Negative.php',14],['mod/quiz','override_form.php',58],['lib/classes/session','file.php',40],['lib/google/src/Google/Auth','OAuth2.php',55],['admin/roles/classes','check_users_selector.php',38],['lib/phpexcel/PHPExcel/Reader/Excel2007','Theme.php',68],['mod/lti/classes/local/ltiservice','service_base.php',63],['lib/alfresco/Service','Store.php',31],['lib/google/src/Google/Service','Audit.php',39],['lib/zend/Zend/Gdata','Gbase.php',95],['mod/wiki','pagelib.php',94],['mod/wiki','pagelib.php',381],['mod/wiki','pagelib.php',986],['mod/wiki','pagelib.php',1195],['mod/wiki','pagelib.php',2201],['mod/wiki','pagelib.php',2429],['lib/simplepie/library/SimplePie/Decode/HTML','Entities.php',80],['calendar','lib.php',1968],['calendar','lib.php',2709],['lib/zend/Zend/Gdata/Photos','AlbumFeed.php',133],['lib/phpmailer','class.phpmailer.php',572],['lib/google/src/Google/Service','Datastore.php',46],['lib/google/src/Google/Service','YouTubeAnalytics.php',45],['lib/lessphp/Tree','Keyword.php',17],['lib/zend/Zend/Service/Amazon','Sqs.php',70],['backup/util/plan','backup_structure_step.class.php',38],['availability/condition/profile/classes','condition.php',73],['lib/simplepie/library/SimplePie','Rating.php',73],['lib/htmlpurifier/HTMLPurifier/AttrTransform','Length.php',19],['lib/horde/framework/Horde/Support','Backtrace.php',20],['lib/simplepie/library/SimplePie','Author.php',81],['report/loglive/classes','table_log.php',50],['lib','completionlib.php',243],['backup/cc/cc_lib','cc_converter_quiz.php',33],['lib/zend/Zend/Gdata/Exif/Extension','Make.php',49],['lib/dml','moodle_database.php',139],['lib/lessphp/Tree','Media.php',18],['lib/horde/framework/Horde/Imap/Client','Url.php',112],['lib/classes/update','info.php',48],['backup/moodle2','backup_subplugin.class.php',44],['backup/util/ui','base_moodleform.class.php',68],['lib/zend/Zend/Gdata/DublinCore/Extension','Creator.php',44],['lib/alfresco/Service','Association.php',28],['lib/zend/Zend/Gdata/Geo/Extension','GeoRssWhere.php',62],['auth/cas/CAS/CAS/PGTStorage','AbstractStorage.php',57],['lib/zend/Zend/Service','Twitter.php',125],['question/classes/statistics/responses','analysis_for_actual_response.php',70],['admin/tool/log/classes/log','store.php',30],['lib/phpexcel/PHPExcel','Comment.php',101],['lib/zend/Zend/Service/DeveloperGarden/Request/ConferenceCall','CommitConferenceRequest.php',46],['filter','local_settings_form.php',33],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Composite.php',25],['backup/util/plan','base_step.class.php',35],['backup/util/plan','base_step.class.php',127],['badges/classes','assertion.php',49],['lib/zend/Zend/Service/DeveloperGarden/Request/ConferenceCall','UpdateParticipantRequest.php',67],['lib/phpexcel/PHPExcel','RichText.php',45],['lib/zend/Zend/Gdata/App','Base.php',111],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Db.php',38],['lib/filestorage','file_storage.php',57],['lib/adodb/drivers','adodb-postgres64.inc.php',125],['lib/adodb/drivers','adodb-postgres64.inc.php',904],['lib/phpexcel/PHPExcel/Chart','Title.php',53],['lib/zend/Zend/Mime','Part.php',51],['lib/phpexcel/PHPExcel','Worksheet.php',335],['lib/phpexcel/PHPExcel/Worksheet','MemoryDrawing.php',78],['lib/google/src/Google/Service','Pagespeedonline.php',39],['lib/zend/Zend/Gdata/DublinCore/Extension','Language.php',44],['lib/phpexcel/PHPExcel/Worksheet','SheetView.php',77],['lib/alfresco/Service/WebService','AlfrescoWebService.php',30],['admin/tool/monitor/classes/output/managerules','renderable.php',56],['lib/google/src/Google/Service','ShoppingContent.php',47],['backup/util/xml/parser/processors','selective_exact_parser_processor.class.php',35],['lib/zend/Zend/Gdata/Spreadsheets','ListQuery.php',57],['backup/moodle2','backup_format_plugin.class.php',40],['mod/workshop/allocation/scheduled','lib.php',48],['lib','outputfactories.php',120],['lib','outputfactories.php',367],['lib/zend/Zend/Gdata/Spreadsheets','ListEntry.php',62],['repository/merlot','lib.php',37],['lib/htmlpurifier/HTMLPurifier','PropertyList.php',29],['mod/chat','chatd.php',78],['mod/chat','chatd.php',103],['lib/lessphp/Visitor','extendFinder.php',15],['lib/zend/Zend/Gdata/YouTube/Extension','MediaGroup.php',112],['mod/quiz/report/grading','gradingsettings_form.php',44],['lib/zend/Zend/Service/Simpy','Note.php',104],['lib/zend/Zend/Gdata/Photos/Extension','Rotation.php',51],['lib/phpexcel/PHPExcel/Worksheet','RowDimension.php',89],['lib/editor/tinymce/classes','plugin.php',49],['question/type/calculatedsimple','edit_calculatedsimple_form.php',72],['lib/zend/Zend/XmlRpc/Value','Integer.php',40],['lib/zend/Zend/Validate/File','Upload.php',74],['lib/phpexcel/PHPExcel/Shared/trend','polynomialBestFitClass.php',201],['admin/roles/classes','capability_table_with_risks.php',46],['lib/zend/Zend/Gdata/Extension','EntryLink.php',52],['question/type','questiontypebase.php',55],['question/type','questiontypebase.php',1442],['lib','outputrequirementslib.php',166],['lib/google/src/Google/Service','Appsactivity.php',49],['lib/horde/framework/Horde/Mail/Transport','Smtp.php',100],['lib/zend/Zend/Loader','Autoloader.php',446],['lib/horde/framework/Horde/Support','CombineStream.php',29],['lib/zend/Zend/Gdata','Docs.php',87],['lib/alfresco/Service/Logger','Logger.php',27],['lib/zend/Zend/Gdata/App/Extension','Logo.php',43],['lib/dml','pgsql_native_moodle_recordset.php',44],['backup/cc/cc_lib','cc_version11.php',57],['lib','weblib.php',315],['lib','weblib.php',3025],['lib','weblib.php',3325],['lib','weblib.php',3360],['lib','weblib.php',3435],['backup/cc/cc_lib','xmlbase.php',52],['backup/cc/cc_lib','cc_organization.php',47],['backup/cc/cc_lib','cc_organization.php',145],['mod/lesson','locallib.php',2007],['mod/lesson','locallib.php',2602],['lib/zend/Zend/Service/LiveDocx','MailMerge.php',61],['lib/phpexcel/PHPExcel/Worksheet/Drawing','Shadow.php',101],['lib/zend/Zend/Server/Reflection','ReturnValue.php',47],['lib/minify/lib/Minify','Build.php',77],['lib/horde/framework/Horde','Variables.php',60],['auth/cas/CAS/CAS','ProxyChain.php',48],['lib/phpexcel/PHPExcel','NamedRange.php',73],['lib/zend/Zend/Gdata/Extension','OpenSearchStartIndex.php',44],['lib/horde/framework/Horde/Imap/Client/Password','Xoauth2.php',44],['lib/zend/Zend/Service/Amazon','OfferSet.php',79],['grade/export/txt','grade_export_txt.php',27],['admin/roles/classes','allow_override_page.php',31],['lib/lessphp/Tree','Assignment.php',15],['lib/zend/Zend/Gdata/Books/Extension','ThumbnailLink.php',42],['lib/zend/Zend/Gdata/YouTube/Extension','Uploaded.php',44],['lib/zend/Zend/Gdata/Extension','AttendeeStatus.php',44],['lib/tcpdf/include/barcodes','qrcode.php',631],['lib/zend/Zend/Gdata/Photos/Extension','Weight.php',51],['enrol','locallib.php',125],['enrol','locallib.php',1240],['enrol','locallib.php',1363],['enrol','locallib.php',1414],['enrol','locallib.php',1447],['lib/lessphp/Visitor','toCSS.php',13],['question/classes/statistics/questions','calculator.php',66],['mod/forum','locallib.php',55],['mod/forum','locallib.php',419],['backup/util/helper','restore_prechecks_helper.class.php',213],['grade/edit/tree','lib.php',57],['grade/edit/tree','lib.php',605],['grade/edit/tree','lib.php',638],['grade/edit/tree','lib.php',804],['lib/zend/Zend/Gdata','Geo.php',56],['lib/zend/Zend/Gdata/Books','CollectionFeed.php',41],['lib/classes','string_manager_standard.php',53],['backup/util/loggers','base_logger.class.php',42],['backup/util/loggers','base_logger.class.php',163],['admin/tool/installaddon/classes','validator.php',223],['admin/tool/generator/classes','backend.php',84],['lib/zend/Zend/Service/WindowsAzure/Credentials','SharedAccessSignature.php',53],['lib/zend/Zend/Gdata/Spreadsheets/Extension','Custom.php',49],['availability/condition/completion/classes','condition.php',48],['question/classes/statistics/questions','calculated.php',181],['lib/lessphp/Tree','Javascript.php',20],['mod/quiz','locallib.php',1898],['lib/phpexcel/PHPExcel/Worksheet','ColumnDimension.php',89],['lib/phpexcel/PHPExcel/Reader','Excel2007.php',62],['lib/zend/Zend/Gdata/DublinCore/Extension','Date.php',45],['lib/mustache/src/Mustache/Cache','FilesystemCache.php',27],['lib/zend/Zend/Loader','PluginLoader.php',95],['lib/zend/Zend/Gdata/YouTube/Extension','Description.php',44],['lib/horde/framework/Horde/Imap/Client/Interaction','Command.php',72],['lib/zend/Zend/Gdata/App/Extension','Generator.php',45],['lib/zend/Zend/Gdata/DublinCore/Extension','Rights.php',44],['lib/phpexcel/PHPExcel/Style','Conditional.php',93],['repository/skydrive','lib.php',42],['lib/google/src/Google/Service','SQLAdmin.php',48],['lib/zend/Zend/Gdata/YouTube/Extension','NoEmbed.php',44],['lib/zend/Zend/Gdata/Exif/Extension','ImageUniqueId.php',49],['lib/simplepie/library/SimplePie','Item.php',82],['lib/phpexcel/PHPExcel/Writer/PDF','Core.php',214],['lib/zend/Zend/Validate/File','IsImage.php',53],['lib/zend/Zend/Date','Exception.php',39],['lib/zend/Zend/Amf/Adobe','Introspector.php',65],['lib/htmlpurifier/HTMLPurifier','URIParser.php',10],['lib/zend/Zend/Service','ReCaptcha.php',117],['lib/zend/Zend/Gdata/Health','ProfileEntry.php',61],['lib/zend/Zend/Server/Reflection','Prototype.php',45],['admin/roles/classes','allow_switch_page.php',33],['backup/util/helper','restore_logs_processor.class.php',45],['backup/util/helper','restore_logs_processor.class.php',140],['lib/google/src/Google/Service','Fitness.php',57],['filter/emoticon/tests','filter_test.php',68],['backup/util/helper','convert_helper.class.php',378],['backup/util/ui','restore_ui_stage.class.php',42],['backup/util/ui','restore_ui_stage.class.php',265],['backup/util/ui','restore_ui_stage.class.php',452],['backup/util/ui','restore_ui_stage.class.php',592],['backup/util/ui','restore_ui_stage.class.php',704],['backup/util/ui','restore_ui_stage.class.php',852],['backup/util/ui','restore_ui_stage.class.php',959],['backup/util/ui','restore_ui_stage.class.php',1100],['repository/webdav','lib.php',38],['repository/dropbox','locallib.php',46],['lib/lessphp/Exception','Parser.php',30],['lib/filestorage','tgz_packer.php',726],['lib/filestorage','tgz_packer.php',808],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','URI.php',15],['backup/converter/moodle1','lib.php',725],['backup/converter/moodle1','lib.php',865],['backup/converter/moodle1','lib.php',1145],['backup/converter/moodle1','lib.php',1190],['backup/converter/moodle1','lib.php',1480],['lib/classes/output','mustache_javascript_helper.php',40],['auth/cas/CAS/CAS/ProxiedService/Http','Abstract.php',58],['lib/zend/Zend/Gdata/YouTube/Extension','FirstName.php',44],['lib/zend/Zend/Service/WindowsAzure/Storage','Queue.php',83],['lib/horde/framework/Horde/Imap/Client/Data','Format.php',32],['lib/zend/Zend/Gdata/Media/Extension','MediaDescription.php',53],['lib/google/src/Google/Service','TagManager.php',66],['lib/zend/Zend/Server','Abstract.php',89],['cache/classes','config.php',80],['lib/htmlpurifier/HTMLPurifier','Generator.php',67],['lib','outputcomponents.php',80],['lib','outputcomponents.php',204],['lib','outputcomponents.php',469],['lib','outputcomponents.php',523],['lib','outputcomponents.php',579],['lib','outputcomponents.php',655],['lib','outputcomponents.php',773],['lib','outputcomponents.php',915],['lib','outputcomponents.php',999],['lib','outputcomponents.php',2178],['lib','outputcomponents.php',2217],['lib','outputcomponents.php',2290],['lib','outputcomponents.php',2371],['lib','outputcomponents.php',2574],['lib','outputcomponents.php',2622],['lib','outputcomponents.php',2682],['lib','outputcomponents.php',2855],['lib','outputcomponents.php',3025],['lib','outputcomponents.php',3129],['lib','outputcomponents.php',3196],['lib','outputcomponents.php',3324],['lib','outputcomponents.php',3608],['lib','outputcomponents.php',3637],['lib','outputcomponents.php',3663],['lib','outputcomponents.php',3685],['lib','outputcomponents.php',3714],['lib','outputcomponents.php',3746],['lib/zend/Zend/Validate/Barcode','Code25.php',53],['lib/zend/Zend/Gdata/YouTube','CommentFeed.php',53],['lib/dtl','string_xml_database_importer.php',34],['question/engine','questionattemptstep.php',97],['question/engine','questionattemptstep.php',608],['lib/htmlpurifier/HTMLPurifier/Node','Element.php',39],['lib/simplepie/library/SimplePie','Cache.php',69],['backup/util/ui','renderer.php',813],['grade/export/xls','grade_export_xls.php',24],['lib/google/src/Google/Service','Directory.php',110],['lib/zend/Zend/Gdata/YouTube/Extension','State.php',47],['lib/phpexcel/PHPExcel/Style','Alignment.php',97],['mod/quiz/report/statistics','statistics_table.php',45],['backup/util/structure','base_nested_element.class.php',44],['backup/util/structure','base_nested_element.class.php',258],['lib/zend/Zend/Gdata/DublinCore/Extension','Title.php',44],['lib/htmlpurifier/HTMLPurifier','Config.php',100],['lib/zend/Zend/Validate/Barcode','Code93.php',67],['lib/lessphp','Functions.php',15],['lib/adodb/drivers','adodb-postgres7.inc.php',78],['lib/adodb/drivers','adodb-postgres7.inc.php',273],['lib/adodb/drivers','adodb-postgres7.inc.php',304],['lib/zend/Zend/Service/DeveloperGarden/Request/ConferenceCall','GetRunningConferenceRequest.php',46],['lib/zend/Zend/Service/DeveloperGarden/Request/ConferenceCall','UpdateConferenceRequest.php',74],['lib/zend/Zend/Validate','EmailAddress.php',118],['mod/workshop','locallib.php',178],['mod/workshop','locallib.php',2801],['mod/workshop','locallib.php',3236],['mod/workshop','locallib.php',3472],['mod/workshop','locallib.php',3714],['mod/workshop','locallib.php',3800],['mod/workshop','locallib.php',3885],['mod/workshop','locallib.php',3904],['lib/zend/Zend/XmlRpc/Value','Struct.php',39],['lib/zend/Zend/Gdata/Books/Extension','Embeddability.php',45],['lib/horde/framework/Horde/Mime','Mdn.php',35],['cache/stores/static','lib.php',127],['lib','blocklib.php',54],['lib','blocklib.php',152],['lib/zend/Zend/Gdata/Books/Extension','Review.php',46],['lib','componentlib.class.php',597],['lib','componentlib.class.php',821],['lib/zend/Zend/Validate/Barcode','Code39.php',66],['lib/filebrowser','file_info_context_module.php',47],['lib/phpexcel/PHPExcel/Shared/JAMA','CholeskyDecomposition.php',42],['question/engine','states.php',61],['lib/jabber/XMPP','XMLStream.php',171],['lib/jabber/XMPP','XMPP.php',101],['lib/classes/lock','lock_factory.php',39],['lib/tests','collator_test.php',310],['lib/horde/framework/Horde/Imap/Client/Exception','NoSupportPop3.php',26],['course/format','lib.php',78],['lib/ddl','sql_generator.php',175],['lib/zend/Zend/XmlRpc/Generator','GeneratorAbstract.php',35],['mod/quiz','accessmanager.php',45],['lib/zend/Zend/Amf/Value','TraitsInfo.php',53],['admin/tool/monitor/classes/output/managesubs','subs.php',51],['lib/zend/Zend/Service/Nirvanix','Response.php',43],['lib','boxlib.php',293],['repository/flickr_public','image.php',34],['lib/google/src/Google/Service','AppState.php',40],['backup/util/structure','backup_nested_element.class.php',44],['lib/filestorage','zip_archive.php',66],['lib/google/src/Google/Service','Taskqueue.php',44],['lib/zend/Zend/Server/Method','Prototype.php',49],['lib/zend/Zend/Service/Technorati','Author.php',90],['mod/workshop/form/comments','lib.php',99],['lib/phpexcel/PHPExcel/RichText','Run.php',43],['lib/phpexcel/PHPExcel/Chart','DataSeriesValues.php',89],['lib/horde/framework/Horde/Imap/Client/Data','Acl.php',32],['lib/phpexcel/PHPExcel/Writer/Excel2007','WriterPart.php',69],['lib/zend/Zend/Service/Simpy','WatchlistFilter.php',48],['lib/zend/Zend/Service/DeveloperGarden/Request/ConferenceCall','RemoveConferenceRequest.php',46],['lib/zend/Zend/Gdata/Photos','UserEntry.php',131],['lib/mustache/src/Mustache/Loader','FilesystemLoader.php',33],['lib/zend/Zend/Gdata/Spreadsheets','ListFeed.php',54],['lib/phpexcel/PHPExcel','DocumentProperties.php',131],['lib/phpexcel/PHPExcel/Reader','Excel2003XML.php',62],['lib/lessphp/Tree','Paren.php',14],['lib/zend/Zend/Gdata/Photos/Extension','Thumbnail.php',50],['lib/horde/framework/Horde/Imap/Client','Mailbox.php',62],['admin/tool/customlang','locallib.php',44],['admin/tool/customlang','locallib.php',405],['admin/tool/customlang','locallib.php',471],['backup/util/xml/parser/processors','selective_like_parser_processor.class.php',35],['lib/filebrowser','file_info_context_user.php',39],['lib/google/src/Google/Service','CivicInfo.php',40],['lib/zend/Zend/Gdata/YouTube/Extension','Private.php',44],['lib/zend/Zend/Gdata/YouTube/Extension','Music.php',44],['backup/moodle2','restore_block_task.class.php',45],['lib/zend/Zend','Gdata.php',99],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Number.php',18],['lib/simplepie','moodle_simplepie.php',50],['lib/simplepie','moodle_simplepie.php',121],['lib/phpunit/classes','hint_resultprinter.php',37],['backup/util/plan','restore_plan.class.php',43],['backup/util/plan','restore_plan.class.php',203],['admin/roles/classes','capability_table_base.php',51],['lib/htmlpurifier/HTMLPurifier','Lexer.php',152],['lib/google/src/Google/Service','Container.php',44],['lib/zend/Zend/Service/Simpy','TagSet.php',47],['lib/phpexcel/PHPExcel/Chart','Legend.php',82],['question/type/calculated/tests','helper.php',205],['lib/phpexcel/PHPExcel/Reader','CSV.php',103],['availability/classes','result.php',46],['lib/zend/Zend/XmlRpc/Value','Double.php',40],['backup/util/helper','restore_users_parser_processor.class.php',43],['lib/htmlpurifier/HTMLPurifier/ConfigSchema','ValidatorAtom.php',31],['lib/htmlpurifier/HTMLPurifier/Lexer','PH5P.php',462],['lib/htmlpurifier/HTMLPurifier/Lexer','PH5P.php',1700],['lib/horde/framework/Horde/Mime','Related.php',32],['report/log/classes','renderable.php',93],['lib/horde/framework/Horde/Imap/Client/Base','Mailbox.php',59],['lib/phpexcel/PHPExcel/Style','Font.php',108],['lib/htmlpurifier/HTMLPurifier/ChildDef','Table.php',57],['backup/util/settings/activity','activity_backup_setting.class.php',25],['lib/mustache/src/Mustache/Exception','UnknownHelperException.php',22],['course/tests/fixtures','course_capability_assignment.php',60],['lib/zend/Zend/Service/Amazon','ResultSet.php',68],['lib/zend/Zend/Validate','Callback.php',69],['lib/zend/Zend/Gdata/Books','CollectionEntry.php',41],['lib/zend/Zend/Gdata/DublinCore/Extension','Publisher.php',44],['lib/zend/Zend/Gdata/Spreadsheets','WorksheetEntry.php',56],['badges/lib','bakerlib.php',52],['backup/util/xml','xml_writer.class.php',57],['backup/util/xml','xml_writer.class.php',284],['lib/portfolio','caller.php',67],['lib/zend/Zend/Validate/File','Sha1.php',60],['lib/htmlpurifier/HTMLPurifier/Strategy','Core.php',8],['lib/zend/Zend/Gdata/Media','Feed.php',58],['lib/zend/Zend/Gdata/YouTube/Extension','LastName.php',44],['mod/data','locallib.php',64],['mod/data','locallib.php',431],['lib/zend/Zend/Gdata/App/Extension','Content.php',44],['lib/classes/update','checker_exception.php',37],['backup/cc/cc_lib','cc_manifest.php',45],['lib','odslib.class.php',42],['lib','odslib.class.php',121],['lib','odslib.class.php',419],['lib','odslib.class.php',824],['lib/zend/Zend/Gdata/Books/Extension','AnnotationLink.php',42],['lib/zend/Zend/Gdata/Calendar/Extension','Color.php',46],['backup/util/helper','restore_structure_parser_processor.class.php',41],['admin/tool/log/store/standard/classes/log','store.php',37],['lib/horde/framework/Horde/Imap/Client/Mailbox','List.php',46],['lib/alfresco/Service','Session.php',39],['grade/report/singleview/classes/local/ui','empty_element.php',38],['enrol/database','settingslib.php',34],['lib/phpexcel/PHPExcel/Worksheet/AutoFilter','Column.php',125],['lib/google/src/Google/Service','AndroidPublisher.php',51],['lib/zend/Zend/Service','StrikeIron.php',43],['lib/zend/Zend/Gdata/Books/Extension','InfoLink.php',41],['lib/lessphp/SourceMap','Generator.php',82],['filter/urltolink/tests','filter_test.php',209],['lib/horde/framework/Horde/Socket','Client.php',52],['lib/zend/Zend/Service/Amazon','Item.php',112],['repository','lib.php',116],['repository','lib.php',533],['admin/roles/classes','define_role_table_basic.php',31],['lib/phpexcel/PHPExcel','WorksheetIterator.php',54],['lib/zend/Zend/Gdata/Photos/Extension','NumPhotosRemaining.php',50],['mod/quiz','attemptlib.php',41],['mod/quiz','attemptlib.php',82],['mod/quiz','attemptlib.php',505],['mod/quiz','attemptlib.php',2058],['mod/quiz','attemptlib.php',2113],['lib/zend/Zend/Server/Reflection','Node.php',51],['lib/zend/Zend/Gdata/Media/Extension','MediaTitle.php',49],['lib/zend/Zend','Date.php',123],['lib/zend/Zend','Mime.php',290],['lib','accesslib.php',5301],['lib','accesslib.php',5846],['lib','accesslib.php',6116],['lib','accesslib.php',6357],['lib','accesslib.php',6544],['lib','accesslib.php',6776],['lib','accesslib.php',6998],['lib','accesslib.php',7240],['question/engine/tests','helpers.php',582],['question/engine/tests','helpers.php',594],['question/engine/tests','helpers.php',608],['question/engine/tests','helpers.php',623],['question/engine/tests','helpers.php',637],['question/engine/tests','helpers.php',652],['question/engine/tests','helpers.php',665],['question/engine/tests','helpers.php',676],['question/engine/tests','helpers.php',1180],['lib/zend/Zend/Validate','Ccnum.php',62],['lib/zend/Zend/Gdata/Extension','EventStatus.php',44],['lib/google/src/Google/Verifier','Pem.php',29],['lib/zend/Zend/Service/Technorati','BlogInfoResult.php',74],['admin/tool/log/classes','setting_managestores.php',30],['lib','outputactions.php',60],['lib','outputactions.php',91],['lib','outputactions.php',148],['backup/cc/cc_lib','cc_assesment_truefalse.php',27],['backup/util/ui','restore_moodleform.class.php',34],['grade/report/singleview/classes/local/ui','element.php',47],['mod/quiz/report','attemptsreport_table.php',76],['lib/lessphp/Tree','Attribute.php',16],['lib/phpexcel/PHPExcel/Style','Supervisor.php',52],['lib/zend/Zend/Gdata/Media/Extension','MediaCategory.php',50],['lib/google/src/Google/Service','AdSenseHost.php',49],['lib/zend/Zend/Gdata/Photos/Extension','Checksum.php',51],['lib/lessphp/Tree','Expression.php',16],['mod/workshop','fileinfolib.php',43],['mod/workshop','fileinfolib.php',198],['course/format','renderer.php',44],['lib/zend/Zend/XmlRpc/Value','Boolean.php',40],['blocks/rss_client','editfeed.php',36],['lib/phpexcel/PHPExcel/Worksheet','Protection.php',157],['question/type/numerical','question.php',321],['auth/cas/CAS/CAS/ProxiedService','Imap.php',51],['lib/typo3','class.t3lib_cs.php',509],['lib/simplepie/library/SimplePie/XML/Declaration','Parser.php',110],['lib/zend/Zend/Gdata/Health','ProfileListEntry.php',49],['lib/htmlpurifier/HTMLPurifier/Filter','ExtractStyleBlocks.php',57],['cache/stores/memcache','lib.php',120],['lib/htmlpurifier/HTMLPurifier/AttrDef','Switch.php',29],['lib/zend/Zend/Gdata/Calendar/Extension','WebContent.php',47],['lib/zend/Zend/Gdata/Photos/Extension','Id.php',50],['lib/google/src/Google/Service','Games.php',60],['lib/zend/Zend/Validate/File','Size.php',92],['lib/classes/lock','file_lock_factory.php',57],['lib/htmlpurifier/HTMLPurifier/AttrTransform','SafeParam.php',27],['lib/phpexcel/PHPExcel/Reader','Gnumeric.php',64],['lib','filelib.php',2700],['lib','filelib.php',3560],['lib/classes/session','database.php',52],['lib/zend/Zend/Gdata/YouTube/Extension','Movies.php',44],['grade','lib.php',103],['grade','lib.php',785],['availability/condition/grouping/classes','condition.php',46],['lib/zend/Zend/Service/Technorati','SearchResult.php',84],['lib/dml','mysqli_native_moodle_recordset.php',42],['lib/zend/Zend/XmlRpc','Server.php',186],['mod/assign/feedback/editpdf/classes','annotation.php',66],['lib/htmlpurifier/HTMLPurifier/ConfigSchema','Validator.php',30],['lib/htmlpurifier','HTMLPurifier.php',104],['lib/zend/Zend/Gdata/Media/Extension','MediaPlayer.php',59],['lib/phpexcel/PHPExcel','Cell.php',122],['lib/phpexcel/PHPExcel/CachedObjectStorage','APC.php',248],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Percentage.php',18],['lib','oauthlib.php',65],['lib','oauthlib.php',409],['backup/util/helper','restore_log_rule.class.php',62],['lib/phpexcel/PHPExcel/Calculation','FormulaToken.php',108],['lib/zend/Zend/Server/Reflection','Class.php',66],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Font.php',22],['mnet/service/enrol','locallib.php',48],['mnet/service/enrol','locallib.php',466],['mnet/service/enrol','locallib.php',537],['repository/flickr','lib.php',51],['lib','csvlib.class.php',64],['lib','csvlib.class.php',398],['lib/google/src/Google/Service','MapsEngine.php',66],['lib/xhprof/xhprof_lib/utils','xhprof_runs.php',87],['lib/filestorage','tgz_extractor.php',119],['lib/zend/Zend/Soap','Client.php',142],['lib/zend/Zend/Gdata/Calendar/Extension','Hidden.php',45],['cache/classes','factory.php',149],['lib/zend/Zend/Gdata/Media/Extension','MediaCredit.php',54],['course','dnduploadlib.php',109],['course','dnduploadlib.php',407],['mod/lti/classes/local/ltiservice','resource_base.php',62],['lib/zend/Zend/Http','Response.php',132],['lib/horde/framework/Horde/Imap/Client','Exception.php',247],['lib/zend/Zend/Service/DeveloperGarden/Request/ConferenceCall','GetConferenceListRequest.php',63],['backup/util/ui','backup_moodleform.class.php',41],['lib/phpexcel/PHPExcel/Chart','Layout.php',143],['comment','lib.php',100],['lib/phpexcel','PHPExcel.php',354],['grade/export/ods','grade_export_ods.php',24],['auth/cas/CAS/CAS','ProxyTicketException.php',46],['lib/minify/lib','JSMinPlus.php',193],['lib/minify/lib','JSMinPlus.php',726],['lib/minify/lib','JSMinPlus.php',1638],['lib/minify/lib','JSMinPlus.php',1656],['lib/minify/lib','JSMinPlus.php',1748],['lib/zend/Zend/Gdata/YouTube/Extension','Location.php',44],['lib/lessphp/Tree','Dimension.php',15],['lib/phpexcel/PHPExcel/Worksheet','Row.php',54],['lib/phpexcel/PHPExcel/Writer','HTML.php',135],['lib/zend/Zend/Service/Technorati','TagsResultSet.php',41],['backup/moodle2','backup_theme_plugin.class.php',61],['lib/zend/Zend/Gdata','Extension.php',43],['lib/htmlpurifier/HTMLPurifier/ChildDef','Custom.php',36],['lib/google/src/Google/Service','SiteVerification.php',43],['lib/htmlpurifier/HTMLPurifier/Token','Text.php',34],['mod/forum/classes','subscriber_selector_base.php',53],['lib/zend/Zend','Auth.php',45],['lib/phpexcel/PHPExcel/Style','Borders.php',121],['lib/zend/Zend/Service/DeveloperGarden/Request/ConferenceCall','CreateConferenceRequest.php',67],['lib/zend/Zend/Gdata/Calendar','ListFeed.php',54],['lib/zend/Zend/Gdata/Extension','Visibility.php',44],['webservice/xmlrpc','lib.php',42],['lib/phpexcel/PHPExcel/CachedObjectStorage','CacheBase.php',76],['lib/zend/Zend/Gdata/App','MediaEntry.php',57],['lib/horde/framework/Horde/Mime','Part.php',261],['backup/util/ui','backup_ui_stage.class.php',43],['backup/util/ui','backup_ui_stage.class.php',79],['backup/util/ui','backup_ui_stage.class.php',234],['backup/util/ui','backup_ui_stage.class.php',387],['backup/util/ui','backup_ui_stage.class.php',516],['backup/util/ui','backup_ui_stage.class.php',575],['question/classes/engine/variants','least_used_strategy.php',51],['lib/horde/framework/Horde/Support','Array.php',21],['lib/zend/Zend/Gdata/YouTube/Extension','Statistics.php',93],['lib/zend/Zend/Gdata/Photos/Extension','BytesUsed.php',50],['lib','tablelib.php',127],['lib','tablelib.php',1400],['lib','tablelib.php',1723],['lib/zend/Zend/Gdata/App/Extension','Uri.php',43],['backup/util/plan','backup_task.class.php',32],['backup/util/plan','backup_task.class.php',56],['lib/zend/Zend/Gdata/Media/Extension','MediaCopyright.php',53],['lib/zend/Zend/Gdata/DublinCore/Extension','Identifier.php',44],['backup/util/xml/parser/processors','findpaths_parser_processor.class.php',35],['lib/zend/Zend/Gdata/Gbase','Feed.php',49],['availability/condition/date/classes','condition.php',52],['backup/util/helper','restore_moodlexml_parser_processor.class.php',38],['admin/tool/generator/classes','course_backend.php',116],['lib/google/src/Google/Service','Prediction.php',51],['cache/stores/session','lib.php',131],['cache/classes','dummystore.php',62],['lib/zend/Zend/XmlRpc/Server','System.php',39],['lib/zend/Zend/Service/WindowsAzure/Storage','TableInstance.php',50],['backup/util/settings/course','course_backup_setting.class.php',25],['mod/quiz/classes/question','qubaids_for_users_attempts.php',37],['mod/lesson','override_form.php',58],['lib/zend/Zend/Service/Simpy','WatchlistSet.php',47],['lib/google/src/Google/Service','Compute.php',78],['badges/criteria','award_criteria.php',127],['lib/zend/Zend/Gdata/Calendar/Extension','Selected.php',45],['lib/minify/lib/Minify/Cache','ZendPlatform.php',23],['lib/zend/Zend/Validate','PostCode.php',65],['lib/dml','oci_native_moodle_temptables.php',40],['lib/zend/Zend/Gdata/Photos/Extension','CommentingEnabled.php',51],['lib/simplepie/library/SimplePie','Category.php',81],['auth/cas/CAS/CAS','CookieJar.php',46],['lib/phpexcel/PHPExcel/Reader/Excel5','MD5.php',45],['backup/util/ui','backup_ui_setting.class.php',70],['backup/util/ui','backup_ui_setting.class.php',200],['backup/util/ui','backup_ui_setting.class.php',398],['backup/util/ui','backup_ui_setting.class.php',504],['backup/util/ui','backup_ui_setting.class.php',583],['user/classes/output/myprofile','category.php',68],['grade/report/singleview/classes/local/ui','grade_attribute_format.php',47],['mod/wiki/parser','parser.php',98],['backup/converter','convertlib.php',52],['backup/converter','convertlib.php',277],['repository/googledocs','lib.php',65],['lib/htmlpurifier/HTMLPurifier','Doctype.php',48],['lib/zend/Zend/Validate/File','Extension.php',71],['mod/imscp','locallib.php',289],['lib/classes/session','memcache.php',50],['lib/horde/framework/Horde/Imap/Client','Cache.php',53],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','ImportantDecorator.php',21],['lib/zend/Zend/Service','Simpy.php',53],['lib/horde/framework/Horde/Imap/Client/Interaction','Server.php',91],['lib/zend/Zend/Gdata/Gapps','EmailListRecipientQuery.php',54],['lib/zend/Zend/Gdata/YouTube','PlaylistVideoEntry.php',55],['lib/zend/Zend/Gdata/Photos','CommentEntry.php',85],['lib/horde/framework/Horde/Exception','PermissionDenied.php',15],['lib/zend/Zend/Gdata/YouTube','InboxEntry.php',92],['lib/jabber/XMPP','XMPP_Old.php',45],['lib/horde/framework/Horde/Imap/Client/Data/Format','Nil.php',27],['backup/cc/cc_lib','cc_converter_label.php',28],['lib/phpexcel/PHPExcel/Style','Border.php',75],['lib/zend/Zend/Service/DeveloperGarden/Request/ConferenceCall','GetConferenceTemplateParticipantRequest.php',53],['enrol/manual','locallib.php',37],['enrol/manual','locallib.php',102],['admin/tool/assignmentupgrade','locallib.php',50],['admin/tool/assignmentupgrade','locallib.php',93],['lib/zend/Zend/Gdata/Exif/Extension','Distance.php',49],['lib/phpexcel/PHPExcel/Writer','PDF.php',46],['lib/zend/Zend/Gdata/Photos/Extension','Size.php',50],['lib/google/src/Google/Service','CloudMonitoring.php',42],['backup/util/xml/output','memory_xml_output.class.php',37],['lib/horde/framework/Horde/Imap/Client/Data','Thread.php',41],['lib/simplepie/library/SimplePie','Credit.php',81],['lib/zend/Zend/Service','Delicious.php',112],['lib/bennu','iCalendar_components.php',21],['lib/bennu','iCalendar_components.php',333],['lib/bennu','iCalendar_components.php',355],['lib/bennu','iCalendar_components.php',433],['lib/bennu','iCalendar_components.php',513],['lib/bennu','iCalendar_components.php',551],['lib/bennu','iCalendar_components.php',602],['lib/bennu','iCalendar_components.php',659],['lib/bennu','iCalendar_components.php',679],['lib','outputrenderers.php',117],['lib','outputrenderers.php',282],['lib','outputrenderers.php',405],['lib','outputrenderers.php',4280],['lib','outputrenderers.php',4533],['lib/zend/Zend/Service/Amazon','ListmaniaList.php',44],['lib/zend/Zend/Service','Flickr.php',54],['backup/util/helper','restore_decode_rule.class.php',47],['backup/util/helper','restore_decode_rule.class.php',192],['lib/mustache/src/Mustache/Exception','UnknownFilterException.php',22],['lib/google/src/Google/Logger','File.php',49],['backup','backup.class.php',146],['lib/zend/Zend/Gdata/App/Extension','Updated.php',43],['lib/zend/Zend/Gdata/YouTube','PlaylistVideoFeed.php',55],['auth/cas/CAS/CAS/PGTStorage','Db.php',122],['lib/phpexcel/PHPExcel/Chart','DataSeries.php',137],['lib/zend/Zend/Gdata/Geo','Feed.php',51],['lib/phpexcel/PHPExcel/Shared/trend','logarithmicBestFitClass.php',107],['backup/util/loggers','file_logger.class.php',35],['admin/roles/classes','admins_existing_selector.php',30],['lib/phpexcel/PHPExcel/Shared/JAMA','LUDecomposition.php',57],['lib/zend/Zend/Gdata/Extension','Reminder.php',48],['course/format/topics','renderer.php',38],['mod/lesson/classes','file_info.php',45],['question/type/calculatedmulti','edit_calculatedmulti_form.php',47],['lib/phpexcel/PHPExcel/Worksheet','AutoFilter.php',62],['lib/minify/lib/HTTP','Encoder.php',75],['lib/zend/Zend/Gdata/App/Extension','Name.php',43],['lib/google/src/Google/Service','Calendar.php',50],['question/type','questionbase.php',124],['question/type','questionbase.php',438],['question/type','questionbase.php',531],['question/type','questionbase.php',750],['question/type','questionbase.php',835],['question/type','questionbase.php',868],['question/type','questionbase.php',914],['question/type','questionbase.php',1013],['lib/dml','database_column_info.php',137],['lib/zend/Zend/Gdata/YouTube/Extension','Gender.php',44],['lib/zend/Zend/Service','Yahoo.php',49],['lib/zend/Zend/Service/Amazon','SimilarProduct.php',44],['lib/mustache/src/Mustache/Exception','SyntaxException.php',23],['lib/htmlpurifier/HTMLPurifier','URIDefinition.php',21],['lib/horde/framework/Horde','Stream.php',50],['lib/google/src/Google/Service','Analytics.php',76],['lib/horde/framework/Horde/Mail/Transport','Mock.php',76],['lib/xmldb','xmldb_file.php',43],['lib/zend/Zend/Gdata/YouTube','PlaylistListEntry.php',97],['lib/zend/Zend/Service/Amazon/Ec2','Response.php',78],['lib/zend/Zend/Soap/Wsdl/Strategy','Composite.php',60],['lib/google/src/Google/Service','Tasks.php',44],['lib/zend/Zend/XmlRpc','Response.php',68],['lib/horde/framework/Horde/Exception','NotFound.php',15],['lib/horde/framework/Horde/Mail/Rfc822','Address.php',66],['lib/zend/Zend/Gdata/Books','VolumeEntry.php',131],['question','previewlib.php',122],['mod/wiki','renderer.php',537],['lib/phpexcel/PHPExcel/Worksheet','RowIterator.php',62],['mod/assign','renderable.php',41],['mod/assign','renderable.php',71],['mod/assign','renderable.php',103],['mod/assign','renderable.php',139],['mod/assign','renderable.php',191],['mod/assign','renderable.php',242],['mod/assign','renderable.php',291],['mod/assign','renderable.php',393],['mod/assign','renderable.php',517],['mod/assign','renderable.php',576],['mod/assign','renderable.php',613],['mod/assign','renderable.php',653],['mod/assign','renderable.php',706],['mod/assign','renderable.php',760],['lib/mustache/src/Mustache','Autoloader.php',19],['lib/zend/Zend/Service/DeveloperGarden/Request/SmsValidation','Invalidate.php',46],['lib/zend/Zend/Service/Yahoo','ImageResult.php',97],['lib/phpexcel/PHPExcel/Worksheet','HeaderFooter.php',183],['mod/quiz/classes/question/bank','custom_view.php',44],['lib/htmlpurifier/HTMLPurifier/Token','Tag.php',33],['lib/zend/Zend/Amf/Adobe','Auth.php',56],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','FontFamily.php',11],['auth/cas/CAS/CAS','TypeMismatchException.php',43],['grade/report/singleview/classes/local/screen','screen.php',67],['lib/zend/Zend/Amf/Parse','Deserializer.php',45],['lib/zend/Zend/Service/Delicious','SimplePost.php',56],['lib/zend/Zend/Service/Technorati','ResultSet.php',112],['cache/classes','loaders.php',196],['cache/classes','loaders.php',1211],['cache/classes','loaders.php',1606],['lib/zend/Zend/Gdata/Gbase','Entry.php',62],['lib/zend/Zend/Validate','Identical.php',64],['lib/horde/framework/Horde/Mail/Transport','Sendmail.php',65],['cache/stores/mongodb','lib.php',116],['mod/quiz/report/statistics/classes','calculator.php',39],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','FrameTarget.php',19],['lib/zend/Zend/Gdata/App/Extension','Draft.php',44],['enrol/ldap','settingslib.php',32],['enrol/ldap','settingslib.php',90],['enrol/ldap','settingslib.php',204],['lib/zend/Zend/Service/DeveloperGarden/ConferenceCall','ConferenceDetail.php',54],['lib/zend/Zend/Service/Yahoo','InlinkDataResult.php',47],['lib/lessphp/Tree','UnicodeDescriptor.php',14],['lib/lessphp/Tree','Directive.php',20],['lib/zend/Zend/Service/Yahoo','VideoResult.php',118],['question/type/calculated','edit_calculated_form.php',51],['lib/classes','string_manager_install.php',43],['lib/google/src/Google/Service','GamesManagement.php',50],['lib/google/src/Google/Logger','Psr.php',37],['grade/report/history/classes/output','user_button.php',40],['lib','externallib.php',129],['lib','externallib.php',426],['lib','externallib.php',457],['lib','externallib.php',488],['lib','externallib.php',517],['lib','externallib.php',649],['lib','externallib.php',684],['lib','externallib.php',782],['backup/util/ui','base_ui_stage.class.php',67],['lib/zend/Zend/Validate','CreditCard.php',136],['lib/zend/Zend/Gdata/Spreadsheets','CellQuery.php',57],['lib/htmlpurifier/HTMLPurifier/AttrDef','Clone.php',18],['mod/quiz/accessrule','accessrulebase.php',52],['lib/mustache/src/Mustache','Context.php',20],['lib/zend/Zend/Service/DeveloperGarden/Request/VoiceButler','CallStatus.php',46],['lib/zend/Zend/Gdata/Spreadsheets','CellFeed.php',78],['backup/util/xml/parser/processors','progressive_parser_processor.class.php',57],['lib/lessphp/Tree','Color.php',15],['lib/zend/Zend/Service/StrikeIron','Base.php',56],['lib/zend/Zend/Gdata/Exif/Extension','FStop.php',49],['lib/htmlpurifier/HTMLPurifier/AttrTransform','BoolToCSS.php',24],['lib/horde/framework/Horde/Imap/Client/Ids','Map.php',44],['lib/zend/Zend/Service/Simpy','Tag.php',48],['lib/htmlpurifier/HTMLPurifier/AttrDef','Enum.php',30],['cache/classes','helper.php',90],['lib/zend/Zend/Soap','Wsdl.php',73],['lib/htmlpurifier/HTMLPurifier/Lexer','DOMLex.php',35],['lib/zend/Zend/Validate/Barcode','Code25interleaved.php',53],['webservice/soap','locallib.php',162],['lib/lessphp/Tree','Quoted.php',20],['lib/simplepie/library/SimplePie/Cache','Memcache.php',81],['lib/zend/Zend/Gdata/YouTube','ActivityEntry.php',88],['backup/controller','restore_controller.class.php',63],['backup/controller','restore_controller.class.php',517],['lib/zend/Zend/Service','Audioscrobbler.php',65],['lib/zend/Zend/Service/Flickr','ResultSet.php',82],['lib/mustache/src/Mustache/Logger','StreamLogger.php',44],['lib/zend/Zend/XmlRpc/Request','Stdin.php',47],['lib/zend/Zend/Service/DeveloperGarden/Request/SmsValidation','Validate.php',63],['mod/glossary','locallib.php',481],['lib/google/src/Google/Logger','Abstract.php',121],['lib/horde/framework/Horde/Support','Guid.php',24],['lib/zend/Zend/Http/Client/Adapter','Curl.php',92],['lib/google/src/Google/Service','Oauth2.php',50],['lib/phpmailer','moodle_phpmailer.php',47],['lib/zend/Zend/Validate/Barcode','Intelligentmail.php',47],['repository/skydrive','microsoftliveapi.php',50],['mod/workshop/allocation/manual','lib.php',51],['lib/zend/Zend/Validate/File','Exists.php',62],['lib/xhprof','xhprof_moodle.php',788],['question/classes/bank/search','category_condition.php',60],['lib/markdown','Markdown.php',96],['grade/report/grader','lib.php',104],['lib/zend/Zend/Gdata/YouTube/Extension','Control.php',48],['lib/zend/Zend/Validate','StringLength.php',79],['question/behaviour','behaviourbase.php',50],['backup/cc/cc_lib','cc_converter_forum.php',29],['lib/zend/Zend/Gdata/Photos/Extension','Nickname.php',50],['lib/zend/Zend/Gdata/Exif/Extension','Tags.php',169],['lib/zend/Zend/Uri','Http.php',108],['lib/zend/Zend/Gdata/YouTube/Extension','Hometown.php',44],['cache/stores/file','lib.php',117],['lib/zend/Zend/Service','Amazon.php',75],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Decorator.php',12],['lib/zend/Zend/Gdata/Media/Extension','MediaThumbnail.php',64],['lib/zend/Zend/Service/Yahoo','Image.php',56],['lib/zend/Zend/Gdata','Feed.php',87],['lib/google/src/Google/Service','Storage.php',54],['backup/cc/cc_lib','cc_asssesment.php',290],['backup/cc/cc_lib','cc_asssesment.php',345],['backup/cc/cc_lib','cc_asssesment.php',364],['backup/cc/cc_lib','cc_asssesment.php',415],['backup/cc/cc_lib','cc_asssesment.php',476],['backup/cc/cc_lib','cc_asssesment.php',486],['backup/cc/cc_lib','cc_asssesment.php',561],['backup/cc/cc_lib','cc_asssesment.php',585],['backup/cc/cc_lib','cc_asssesment.php',635],['backup/cc/cc_lib','cc_asssesment.php',668],['backup/cc/cc_lib','cc_asssesment.php',693],['backup/cc/cc_lib','cc_asssesment.php',788],['backup/cc/cc_lib','cc_asssesment.php',814],['backup/cc/cc_lib','cc_asssesment.php',838],['backup/cc/cc_lib','cc_asssesment.php',965],['backup/cc/cc_lib','cc_asssesment.php',971],['backup/cc/cc_lib','cc_asssesment.php',986],['backup/cc/cc_lib','cc_asssesment.php',1003],['backup/cc/cc_lib','cc_asssesment.php',1017],['backup/cc/cc_lib','cc_asssesment.php',1045],['backup/cc/cc_lib','cc_asssesment.php',1186],['backup/cc/cc_lib','cc_asssesment.php',1263],['backup/cc/cc_lib','cc_asssesment.php',1317],['backup/cc/cc_lib','cc_asssesment.php',1389],['backup/cc/cc_lib','cc_asssesment.php',1451],['backup/cc/cc_lib','cc_asssesment.php',1558],['backup/cc/cc_lib','cc_asssesment.php',1620],['backup/cc/cc_lib','cc_asssesment.php',1648],['backup/cc/cc_lib','cc_asssesment.php',1716],['backup/cc/cc_lib','cc_asssesment.php',2155],['backup/cc/cc_lib','cc_asssesment.php',2264],['backup/cc/cc_lib','cc_asssesment.php',2469],['admin/tool/uploadcourse/classes','course.php',111],['lib/zend/Zend/Gdata/Extension','Where.php',52],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','ListStyle.php',20],['lib/zend/Zend/Service/Amazon','S3.php',102],['lib/horde/framework/Horde/Stream','Existing.php',28],['backup/util/output','output_controller.class.php',44],['backup/cc/cc_lib','cc_version1.php',57],['question/classes/statistics/responses','analysis_for_question.php',58],['lib/zend/Zend/Service/Simpy','Link.php',104],['backup/converter/moodle1','handlerlib.php',120],['backup/converter/moodle1','handlerlib.php',1710],['backup/converter/moodle1','handlerlib.php',1902],['backup/converter/moodle1','handlerlib.php',2155],['cache','lib.php',66],['cache','lib.php',109],['cache','lib.php',138],['cache','lib.php',183],['lib/zend/Zend/Gdata','Calendar.php',77],['lib/zend/Zend/Validate','Date.php',71],['backup/util/structure','base_atom.class.php',41],['backup/util/structure','base_atom.class.php',114],['backup/util/structure','base_atom.class.php',135],['backup/util/structure','base_atom.class.php',156],['lib/xmldb','xmldb_table.php',49],['lib/htmlpurifier/HTMLPurifier','Encoder.php',10],['backup/cc','cc112moodle.php',59],['lib/zend/Zend/XmlRpc/Client','ServerIntrospection.php',43],['lib/zend/Zend/Gdata/Photos','PhotoFeed.php',147],['backup/controller','backup_controller.class.php',68],['backup/controller','backup_controller.class.php',407],['lib','adminlib.php',792],['lib','adminlib.php',1139],['lib','adminlib.php',1213],['lib','adminlib.php',1356],['lib','adminlib.php',1553],['lib','adminlib.php',1925],['lib','adminlib.php',2037],['lib','adminlib.php',2103],['lib','adminlib.php',2204],['lib','adminlib.php',2246],['lib','adminlib.php',2284],['lib','adminlib.php',2372],['lib','adminlib.php',2406],['lib','adminlib.php',2563],['lib','adminlib.php',2648],['lib','adminlib.php',2877],['lib','adminlib.php',3033],['lib','adminlib.php',3175],['lib','adminlib.php',3266],['lib','adminlib.php',3430],['lib','adminlib.php',3510],['lib','adminlib.php',3621],['lib','adminlib.php',3772],['lib','adminlib.php',4001],['lib','adminlib.php',4068],['lib','adminlib.php',4286],['lib','adminlib.php',4315],['lib','adminlib.php',4344],['lib','adminlib.php',4368],['lib','adminlib.php',4398],['lib','adminlib.php',4434],['lib','adminlib.php',4469],['lib','adminlib.php',4501],['lib','adminlib.php',4591],['lib','adminlib.php',4624],['lib','adminlib.php',4680],['lib','adminlib.php',4704],['lib','adminlib.php',4730],['lib','adminlib.php',4753],['lib','adminlib.php',4770],['lib','adminlib.php',4815],['lib','adminlib.php',4878],['lib','adminlib.php',4913],['lib','adminlib.php',4956],['lib','adminlib.php',5039],['lib','adminlib.php',5169],['lib','adminlib.php',5211],['lib','adminlib.php',5256],['lib','adminlib.php',5313],['lib','adminlib.php',5329],['lib','adminlib.php',5385],['lib','adminlib.php',5610],['lib','adminlib.php',5664],['lib','adminlib.php',5718],['lib','adminlib.php',5735],['lib','adminlib.php',5783],['lib','adminlib.php',5825],['lib','adminlib.php',5876],['lib','adminlib.php',5932],['lib','adminlib.php',6161],['lib','adminlib.php',6341],['lib','adminlib.php',6435],['lib','adminlib.php',6582],['lib','adminlib.php',7206],['lib','adminlib.php',7658],['lib','adminlib.php',7841],['lib','adminlib.php',8128],['lib','adminlib.php',8275],['lib','adminlib.php',8435],['lib','adminlib.php',8582],['lib','adminlib.php',8746],['lib','adminlib.php',8939],['lib','adminlib.php',8993],['lib','adminlib.php',9055],['lib','adminlib.php',9100],['mod/workshop/eval/best','lib.php',44],['lib/zend/Zend/Gdata/Calendar','EventQuery.php',91],['lib/zend/Zend/Service/Technorati','TagResult.php',94],['lib/google/src/Google/Cache','Null.php',26],['enrol/flatfile','adminlib.php',35],['lib/phpexcel/PHPExcel/Chart','PlotArea.php',52],['mod/quiz/report/statistics','statistics_question_table.php',49],['lib/zend/Zend/Service/DeveloperGarden/Request/ConferenceCall','AddConferenceTemplateParticipantRequest.php',53],['mod/data','lib.php',66],['mod/data','lib.php',2164],['mod/data','lib.php',2438],['mod/data','lib.php',2459],['question/classes/statistics/questions','calculated_for_subquestion.php',57],['lib/horde/framework/Horde/Crypt/Blowfish','Base.php',56],['lib/classes/session','memcached.php',51],['lib/google/src/Google/IO','Abstract.php',37],['availability/classes','info_section.php',40],['lib/zend/Zend/Gdata/YouTube/Extension','Books.php',44],['lib/phpexcel/PHPExcel/Shared/JAMA','QRDecomposition.php',48],['lib/filestorage','stored_file.php',63],['grade/report/history/classes/output','tablelog.php',72],['lib/classes','plugin_manager.php',71],['lib/google/src/Google','Model.php',32],['lib/zend/Zend/Gdata/YouTube/Extension','Relationship.php',44],['lib/horde/framework/Horde/Crypt','Blowfish.php',54],['lib/filebrowser','virtual_root_file.php',45],['auth/cas/CAS/CAS','OutOfSequenceBeforeClientException.php',47],['availability/condition/grade/classes','condition.php',46],['lib/phpexcel/PHPExcel/CachedObjectStorage','DiscISAM.php',188],['admin/roles/classes','check_capability_table.php',40],['lib/zend/Zend/Gdata/Media','Entry.php',60],['lib/zend/Zend/Gdata','MimeFile.php',43],['admin/tool/xmldb/actions','XMLDBAction.class.php',56],['backup/cc/cc_lib','cc_resources.php',102],['lib/zend/Zend/Loader/Autoloader','Resource.php',62],['lib/phpexcel/PHPExcel/Worksheet','PageMargins.php',80],['backup/util/xml/parser/processors','simplified_parser_processor.class.php',46],['lib/simplepie/library/SimplePie','IRI.php',252],['lib/htmlpurifier/HTMLPurifier','ContentSets.php',33],['lib/htmlpurifier/HTMLPurifier','HTMLModuleManager.php',68],['lib/htmlpurifier/HTMLPurifier/Token','Comment.php',19],['lib/zend/Zend/Gdata/Calendar/Extension','SendEventNotifications.php',44],['lib/zend/Zend/Service/WindowsAzure/Storage','TableEntity.php',66],['lib/zend/Zend/Service/DeveloperGarden/Request/LocalSearch','LocalSearchRequest.php',60],['mod/quiz/report/overview','overview_table.php',41],['lib/zend/Zend/Gdata/Photos/Extension','Client.php',51],['backup/cc/cc_lib','cc_converters.php',75],['lib/google/src/Google/Service','AdSense.php',68],['lib/zend/Zend/Gdata','Entry.php',48],['lib','filterlib.php',74],['lib','filterlib.php',382],['lib/lessphp/Tree','Alpha.php',13],['lib/zend/Zend/Gdata','DublinCore.php',51],['lib/horde/framework/Horde/Support','Stack.php',18],['lib/lessphp/Tree','Selector.php',31],['lib/zend/Zend/Service','Nirvanix.php',47],['lib/dtl','file_xml_database_importer.php',34],['mod/workshop','mod_form.php',44],['lib/zend/Zend/Service/Technorati','CosmosResultSet.php',73],['lib/horde/framework/Horde/Imap/Client/Data','AclRights.php',39],['lib/zend/Zend/Gdata/YouTube/Extension','Age.php',44],['repository/s3','S3.php',176],['repository/s3','S3.php',1994],['repository/s3','S3.php',2346],['lib/lessphp/Tree','Ruleset.php',45],['lib/zend/Zend/Service/Simpy','NoteSet.php',47],['backup/util/xml/output','xml_output.class.php',52],['backup/util/xml/output','xml_output.class.php',158],['lib/google/src/Google/Service','Pubsub.php',44],['lib/alfresco/Service','Node.php',51],['lib/zend/Zend/Service','Technorati.php',79],['lib/horde/framework/Horde/Imap/Client/Data','BaseSubject.php',39],['admin/tool/monitor/classes','subscription.php',43],['lib/zend/Zend/Gdata/App/Extension','Person.php',61],['backup/moodle2','backup_course_task.class.php',39],['grade/report/singleview/classes/local/ui','text_attribute.php',42],['lib/dml','sqlsrv_native_moodle_recordset.php',40],['lib/zend/Zend/Gdata/YouTube','ContactEntry.php',61],['lib/zend/Zend/Gdata/Extension','AttendeeType.php',44],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','Pixels.php',17],['mod/assignment/backup/moodle1','lib.php',223],['lib/zend/Zend/Gdata/Health/Extension','Ccr.php',43],['lib/horde/framework/Horde/Mail/Rfc822','Identification.php',34],['mod/quiz','mod_form.php',48],['backup/util/structure','restore_path_element.class.php',47],['backup/util/structure','restore_path_element.class.php',128],['lib/zend/Zend/Gdata/Calendar','EventFeed.php',55],['lib/zend/Zend/Gdata/Spreadsheets','DocumentQuery.php',57],['availability/tests/fixtures','mock_condition.php',52],['lib/lessphp','Visitor.php',14],['mod/assign/feedback/editpdf/classes','widget.php',53],['lib/minify/lib/Minify/Cache','File.php',9],['lib/zend/Zend/Gdata/Exif','Entry.php',64],['grade/tests','reportlib_test.php',36],['mod/workshop/allocation','lib.php',103],['lib/zend/Zend/Service/WindowsAzure/Storage','BlobInstance.php',57],['lib/zend/Zend/Gdata/Photos/Extension','User.php',50],['admin/tool/uploadcourse/classes','tracker.php',72],['lib/zend/Zend/Service/Technorati','GetInfoResult.php',52],['lib/zend/Zend/Service/WindowsAzure','SessionHandler.php',61],['lib/zend/Zend/Gdata/YouTube/Extension','Hobbies.php',44],['lib/mustache/src/Mustache/Loader','ArrayLoader.php',31],['lib/zend/Zend/Gdata/Photos/Extension','Width.php',50],['admin/roles/classes','view_role_definition_table.php',28],['lib/phpunit/classes','arraydataset.php',45],['lib/horde/framework/Horde/Imap/Client/Data','Sync.php',133],['lib/zend/Zend','Exception.php',34],['backup/util/xml/parser/tests','parser_test.php',797],['lib/zend/Zend/Validate/File','ImageSize.php',113],['lib/zend/Zend/Validate','Alnum.php',65],['lib/zend/Zend/Service/Flickr','Image.php',62],['lib/phpexcel/PHPExcel/Calculation','Function.php',71],['lib/horde/framework/Horde/Support','Inflector.php',115],['lib/horde/framework/Horde/Exception','Pear.php',22],['question/classes/bank','random_question_loader.php',61],['lib/phpexcel/PHPExcel/Reader','HTML.php',104],['lib/mustache/src/Mustache/Loader','InlineLoader.php',57],['lib/zend/Zend/Gdata/Photos/Extension','QuotaLimit.php',51],['admin/tool/uploadcourse/classes','processor.php',122],['lib/zend/Zend/Gdata/Spreadsheets','WorksheetFeed.php',40],['lib/lessphp/Tree','Rule.php',24],['lib/zend/Zend/Service/Amazon','EditorialReview.php',44],['lib/zend/Zend/Service/ReCaptcha','MailHide.php',86],['lib/htmlpurifier/HTMLPurifier/AttrTransform','NameSync.php',11],['lib/classes/progress','display_if_slow.php',60],['availability/condition/group/classes','condition.php',43],['lib/zend/Zend/Gdata/Photos/Extension','Location.php',50],['backup/moodle2','restore_settingslib.php',125],['lib/filebrowser','file_info.php',43],['repository/equella','lib.php',42],['lib/zend/Zend/Http','Client.php',242],['lib/alfresco/Service','ChildAssociation.php',30],['lib/zend/Zend/Gdata/DublinCore/Extension','Subject.php',44],['lib/zend/Zend/Gdata/App/Extension','Category.php',46],['badges/lib','awardlib.php',55],['admin/roles/classes','override_permissions_table_advanced.php',31],['lib/mustache/src/Mustache','Template.php',29],['backup/util/helper','restore_roles_parser_processor.class.php',39],['lib','csslib.php',1501],['lib','csslib.php',1587],['lib','csslib.php',2068],['lib','csslib.php',2136],['lib','csslib.php',2242],['lib/zend/Zend/Service/WindowsAzure/Storage','QueueInstance.php',49],['mod/lti/service/toolproxy/classes/local/service','toolproxy.php',41],['admin/roles/classes','define_role_table_advanced.php',46],['backup/moodle2','restore_section_task.class.php',42],['mod/lti/service/toolsettings/classes/local/resource','contextsettings.php',44],['lib/google/src/Google','Client.php',71],['lib/simplepie/library/SimplePie/Content/Type','Sniffer.php',69],['backup/moodle2','restore_plugin.class.php',43],['lib/simplepie/library/SimplePie','Registry.php',99],['backup/cc','cc2moodle.php',105],['lib/classes/lock','postgres_lock_factory.php',81],['lib/phpexcel/PHPExcel/Shared','XMLWriter.php',56],['lib/htmlpurifier/HTMLPurifier','Length.php',41],['lib/zend/Zend/Validate/File','Count.php',92],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',54],['lib/editor/atto','adminlib.php',109],['lib/google/src/Google/Service','Admin.php',40],['lib/dml','moodle_transaction.php',40],['backup/util/plan','restore_structure_step.class.php',46],['question/engine','questionattempt.php',166],['question/engine','questionattempt.php',1513],['question/engine','questionattempt.php',1599],['question/engine','questionattempt.php',1684],['lib/zend/Zend/Service/Technorati','Weblog.php',152],['lib/zend/Zend/Service/DeveloperGarden/ConferenceCall','ParticipantStatus.php',48],['lib/htmlpurifier/HTMLPurifier/AttrDef','URI.php',23],['backup/util/helper','restore_decode_content.class.php',50],['backup/util/helper','restore_decode_content.class.php',125],['lib/google/src/Google/Cache','File.php',39],['lib/google/src/Google/Http','Request.php',55],['backup/moodle2','backup_block_task.class.php',43],['lib/simplepie/library/SimplePie','Source.php',61],['lib/google/src/Google/Service','Translate.php',40],['availability/classes','capability_checker.php',49],['lib','navigationlib.php',145],['lib','navigationlib.php',1012],['lib','navigationlib.php',2814],['lib','navigationlib.php',3075],['lib','navigationlib.php',3409],['lib','navigationlib.php',4775],['lib','navigationlib.php',4956],['lib/zend/Zend/Gdata/YouTube/Extension','MediaCredit.php',64],['lib/dml','pdo_moodle_database.php',42],['lib/zend/Zend/Gdata/YouTube/Extension','ReleaseDate.php',44],['lib/htmlpurifier/HTMLPurifier/Printer','ConfigForm.php',40],['lib/htmlpurifier/HTMLPurifier/Printer','ConfigForm.php',221],['lib/zend/Zend/Service/DeveloperGarden/Request/ConferenceCall','NewParticipantRequest.php',53],['lib/zend/Zend/Gdata/Spreadsheets/Extension','RowCount.php',49],['lib/zend/Zend/Validate/File','IsCompressed.php',53],['lib/zend/Zend/Gdata/Photos/Extension','MaxPhotosPerAlbum.php',51],['lib/zend/Zend/Gdata/Extension','When.php',52],['question/classes/bank/search','hidden_condition.php',42],['report/loglive/classes','renderable.php',73],['mod/lti/classes/local/ltiservice','response.php',58],['lib/zend/Zend/Gdata/Extension','Recurrence.php',43],['lib/zend/Zend/Gdata/Books/Extension','BooksLink.php',41],['backup/util/loggers','database_logger.class.php',40],['lib/phpexcel/PHPExcel/CachedObjectStorage','Wincache.php',250],['lib/phpexcel/PHPExcel','HashTable.php',52],['lib/horde/framework/Horde/Imap/Client/Namespace','List.php',34],['lib/htmlpurifier/HTMLPurifier','Zipper.php',25],['lib/classes/update','deployer.php',42],['lib/zend/Zend/Gdata/YouTube','VideoFeed.php',53],['lib/zend/Zend/Service/DeveloperGarden/Request/BaseUserService','GetQuotaInformation.php',40],['lib/minify/lib','CSSmin.php',43],['lib/zend/Zend/Validate/File','Crc32.php',60],['mod/feedback/item','feedback_item_class.php',20],['question/engine/upgrade','upgradelib.php',280],['question/engine/upgrade','upgradelib.php',381],['lib/simplepie/library/SimplePie','Copyright.php',73],['lib/zend/Zend/Gdata/Spreadsheets','SpreadsheetEntry.php',43],['lib/google/src/Google/Service','Dns.php',50],['lib/zend/Zend/Gdata/Gapps','Query.php',57],['lib/zend/Zend/Gdata/YouTube/Extension','School.php',44],['lib/mustache/src/Mustache','HelperCollection.php',19],['mod/assign','gradingtable.php',68],['backup/util/xml/output','file_xml_output.class.php',37],['lib','upgradelib.php',45],['lib','upgradelib.php',61],['lib','upgradelib.php',76],['lib','upgradelib.php',94],['lib','upgradelib.php',111],['lib/zend/Zend/Service','Akismet.php',77],['lib','googleapi.php',52],['lib','googleapi.php',243],['lib/zend/Zend/Service/Yahoo','ResultSet.php',84],['lib/classes/message/inbound','processing_failed_exception.php',36],['lib','portfoliolib.php',101],['lib/lessphp/Tree','Import.php',30],['lib/phpexcel/PHPExcel/Shared/JAMA','SingularValueDecomposition.php',53],['lib/tests/fixtures','test_renderer_factory.php',41],['mod/lesson','editpage_form.php',41],['grade/report','lib.php',156],['lib/zend/Zend/XmlRpc/Request','Http.php',53],['lib/filebrowser','file_info_stored.php',51],['lib/phpexcel/PHPExcel/Style','Protection.php',57],['lib/google/src/Google','Config.php',30],['lib/horde/framework/Horde/Imap/Client/Exception','ServerResponse.php',44],['lib/zend/Zend/Validate','LessThan.php',58],['grade/export','lib.php',60],['lib/zend/Zend/Gdata/YouTube/Extension','PlaylistTitle.php',44],['availability/classes','tree.php',118],['lib/htmlpurifier/HTMLPurifier/Node','Text.php',35],['question/classes/statistics/responses','analysis_for_subpart.php',50],['lib/zend/Zend/Validate','InArray.php',65],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','BackgroundPosition.php',57],['lib/zend/Zend/Gdata/Photos/Extension','Height.php',50],['lib/zend/Zend/Gdata/Gapps','Error.php',76],['backup/util/helper','restore_decode_processor.class.php',47],['backup/util/helper','restore_decode_processor.class.php',182],['lib/phpexcel/PHPExcel','Chart.php',150],['lib/google/src/Google/Service','Replicapool.php',48],['lib/zend/Zend/Gdata/Media/Extension','MediaRating.php',49],['lib/zend/Zend/Gdata/YouTube','VideoEntry.php',175],['admin/tool/installaddon/classes','pluginfo_client.php',68],['admin/tool/installaddon/classes','pluginfo_client.php',206],['lib/google/src/Google/Service','Resourceviews.php',54],['admin/tool/log/store/legacy/classes/log','store.php',33],['backup/moodle2','backup_section_task.class.php',40],['lib/phpexcel/PHPExcel/Worksheet','CellIterator.php',68],['question/type/tests','question_first_matching_answer_grading_strategy_test.php',40],['repository/youtube','lib.php',40],['lib/tcpdf/include/barcodes','datamatrix.php',229],['lib/testing/generator','component_generator_base.php',45],['lib/zend/Zend/Gdata/DublinCore/Extension','Format.php',44],['lib','badgeslib.php',133],['admin/tool/installaddon/classes','installer.php',488],['admin/tool/installaddon/classes','installer.php',745],['lib/zend/Zend/XmlRpc','Client.php',122],['lib/mustache/src/Mustache','LambdaHelper.php',24],['admin/roles/classes','permissions_table.php',38],['lib/jabber/XMPP','XMLObj.php',76],['lib','coursecatlib.php',197],['lib','coursecatlib.php',2668],['question/type','edit_question_form.php',96],['lib/zend/Zend/Gdata','MediaMimeStream.php',80],['mod/quiz/report/responses','last_responses_table.php',39],['lib/zend/Zend/Gdata/Photos/Extension','Timestamp.php',51],['lib','setuplib.php',106],['lib','setuplib.php',158],['lib','setuplib.php',174],['lib','setuplib.php',194],['lib','setuplib.php',224],['lib','setuplib.php',246],['lib','setuplib.php',262],['lib','setuplib.php',284],['lib','setuplib.php',303],['lib','setuplib.php',321],['lib/google/src/Google/Cache','Apc.php',35],['mod/lti/service/toolsettings/classes/local/service','toolsettings.php',41],['lib/htmlpurifier/HTMLPurifier','ErrorCollector.php',57],['lib/lessphp/Tree','Unit.php',16],['lib/zend/Zend/Service/DeveloperGarden/Request/VoiceButler','TearDownCall.php',46],['lib/minify/lib/HTTP','ConditionalGet.php',109],['lib/phpexcel/PHPExcel/CachedObjectStorage','SQLite.php',261],['lib/htmlpurifier/HTMLPurifier','Printer.php',21],['lib/zend/Zend/Service/Amazon','CustomerReview.php',69],['lib/zend/Zend/Gdata/YouTube/Extension','QueryString.php',44],['lib/zend/Zend/Gdata/Gapps/Extension','Name.php',65],['mod/assign','adminlib.php',41],['mod/assign','adminlib.php',102],['lib/lessphp/Tree','RulesetCall.php',14],['lib/zend/Zend/Gdata/Extension','Rating.php',49],['repository/alfresco','lib.php',42],['lib/zend/Zend/Service/Technorati','SearchResultSet.php',49],['lib/zend/Zend/Gdata/Photos','UserQuery.php',71],['enrol','renderer.php',426],['enrol','renderer.php',728],['badges/criteria','award_criteria_course.php',47],['lib/zend/Zend/Gdata/Extension','RecurrenceException.php',56],['lib/phpexcel/PHPExcel/Style','Fill.php',89],['lib/zend/Zend/Service/Technorati','TagsResult.php',60],['lib/horde/framework/Horde/Imap/Client/Interaction','Pipeline.php',60],['lib/google/src/Google/Service','Exception.php',12],['lib/zend/Zend/Gdata','Spreadsheets.php',115],['lib/xmldb','xmldb_index.php',56],['question/classes/statistics/responses','analyser.php',69],['lib/htmlpurifier/HTMLPurifier/Node','Comment.php',19],['lib/zend/Zend/Gdata/Photos/Extension','Position.php',50],['lib/google/src/Google/Auth','Simple.php',32],['lib/zend/Zend/Gdata/Geo/Extension','GmlPoint.php',62],['lib/horde/framework/Horde/Crypt/Blowfish/Php','Base.php',318],['lib/horde/framework/Horde/Imap/Client/Cache','Backend.php',33],['lib/zend/Zend/Rest','Route.php',71],['lib/zend/Zend/Service/DeveloperGarden/Request/ConferenceCall','UpdateConferenceTemplateParticipantRequest.php',60],['question','category_class.php',58],['lib/classes/progress','display.php',48],['lib/horde/framework/Horde/Imap/Client/Exception','NoSupportExtension.php',33],['lib/zend/Zend/Gdata/App/Extension','Rights.php',43],['lib/adodb','adodb-active-record.inc.php',113],['lib/horde/framework/Horde/Exception','Wrapped.php',16],['lib/zend/Zend/Validate','NotEmpty.php',77],['question/type/calculated','datasetitems_form.php',72],['lib/horde/framework/Horde/Support','ObjectStub.php',29],['lib/dml','pdo_moodle_recordset.php',41],['backup/cc/cc_lib','cc_converter_folder.php',28],['lib/horde/framework/Horde/Mime','Mail.php',93],['lib/zend/Zend/Gdata/Calendar','ListEntry.php',85],['admin/tool/monitor/classes','rule.php',44],['backup/cc/cc_lib','cc_utils.php',313],['backup/cc/cc_lib','cc_utils.php',381],['backup/cc/cc_lib','cc_utils.php',437],['lib/horde/framework/Horde/Imap/Client/Auth','DigestMD5.php',69],['lib/zend/Zend/Gdata/Geo','Entry.php',55],['lib/zend/Zend/Gdata/YouTube/Extension','Link.php',48],['lib','flickrlib.php',53],['lib/zend/Zend/Gdata/YouTube/Extension','AboutMe.php',44],['lib/zend/Zend/Service/DeveloperGarden','Credential.php',54],['grade/report/overview','lib.php',76],['lib/simplepie/library/SimplePie','File.php',68],['backup/moodle2','backup_plugin.class.php',44],['lib/zend/Zend/Gdata/Extension','ExtendedProperty.php',46],['backup/cc/cc_lib','cc_assesment_sfib.php',27],['rating','lib.php',114],['rating','lib.php',1070],['lib','dtllib.php',66],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Cache.php',68],['lib/mustache/src/Mustache/Loader','CascadingLoader.php',20],['question/engine','datalib.php',68],['question/engine','datalib.php',1330],['question/engine','datalib.php',1631],['question/engine','datalib.php',1739],['question/engine','datalib.php',1869],['question/engine','datalib.php',1940],['lib/phpexcel/PHPExcel/Shared/trend','bestFitClass.php',405]], 1047],
'delete_records_select': ['delete_records_select', 'Delete one or more records from a table which match a particular WHERE clause. ', [['lib/dml','pgsql_native_moodle_database.php',1247],['lib/dml','oci_native_moodle_database.php',1445],['lib/dml','sqlsrv_native_moodle_database.php',1153],['lib/dml','mssql_native_moodle_database.php',1082],['lib/dml','mysqli_native_moodle_database.php',1469],['lib/dml/tests','dml_test.php',5432],['lib/dml','pdo_moodle_database.php',207]], 166],
'kill_user_sessions': ['kill_user_sessions', 'Terminate all sessions of given user unconditionally. ', [['lib/classes/session','manager.php',608]], 14],
'print_maintenance_message': ['print_maintenance_message', 'Prints a maintenance message from $CFG->maintenance_message or default if empty. ', [['lib','weblib.php',2763]], 2],
'instance': ['instance', 'Retrieve sole instance of the registry. ', [['lib/htmlpurifier/HTMLPurifier','URISchemeRegistry.php',9],['lib/classes/update','checker.php',62],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',29],['lib/classes','useragent.php',101],['backup/cc','validator.php',35],['lib/portfolio','exporter.php',251],['lib/tests','update_deployer_test.php',69],['lib/tests','string_manager_standard_test.php',124],['lib','modinfolib.php',373],['','mdeploy.php',96],['cache','disabledlib.php',171],['cache','disabledlib.php',296],['admin/tool/installaddon/classes','validator.php',85],['cache/classes','config.php',87],['course/format','lib.php',156],['lib','accesslib.php',6184],['lib','accesslib.php',6436],['lib','accesslib.php',6614],['lib','accesslib.php',6868],['lib','accesslib.php',7129],['lib','accesslib.php',7341],['cache','locallib.php',52],['lib/htmlpurifier','HTMLPurifier.php',251],['cache/classes','factory.php',114],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',53],['cache/classes','helper.php',76],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',31],['lib/classes','plugin_manager.php',83],['lib','filterlib.php',81],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',80],['lib/classes/update','deployer.php',54],['admin/tool/installaddon/classes','pluginfo_client.php',37],['admin/tool/installaddon/classes','installer.php',40],['backup/cc/cc_lib','cc_utils.php',387],['backup/cc/cc_lib','cc_utils.php',443]], 3942],
'unset_cache_flag': ['unset_cache_flag', 'Removes a single volatile flag ', [['lib','moodlelib.php',1724]], 2],
'make_menu_from_list': ['make_menu_from_list', 'Given a list (eg a,b,c,d,e) this function returns an array of 1->a, 2->b, 3->c etc ', [['lib','moodlelib.php',7849]], 9],
'get_records_sql': ['get_records_sql', 'Get a number of records as an array of objects using a SQL statement. ', [['lib/dml','pgsql_native_moodle_database.php',732],['lib/dml','oci_native_moodle_database.php',1102],['lib/dml','sqlsrv_native_moodle_database.php',823],['lib/dml','mssql_native_moodle_database.php',741],['lib/dml','mysqli_native_moodle_database.php',1049],['lib/dml/tests','dml_test.php',5424],['lib/dml','pdo_moodle_database.php',308]], 678],
'set_cm': ['set_cm', 'The course module that this page belongs to (if it does belong to one). ', [['lib','pagelib.php',979]], 36],
'update_internal_user_password': ['update_internal_user_password', 'Update password hash in user object (if necessary). ', [['lib','moodlelib.php',4422]], 19],
'setnew_password_and_mail': ['setnew_password_and_mail', 'Sets specified user\'s password and send the new password to the user via email. ', [['lib','moodlelib.php',5703]], 4],
'course_scale_used': ['course_scale_used', 'This function returns the number of activities using the given scale in the given course. ', [['lib','moodlelib.php',7896]], 2],
'fulldelete': ['fulldelete', 'Recursively delete the file or folder with path $location. That is, if it is a file delete it. If it is a folder, delete all its content then delete it. If $location does not exist to start, that is not considered an error. ', [['lib','filelib.php',2468]], 38],
'is_primary_admin': ['is_primary_admin', 'Is a userid the primary administrator? ', [['lib','moodlelib.php',9046]], 1],
'is_role_switched': ['is_role_switched', 'Checks if the user has switched roles within the given course. ', [['lib','accesslib.php',4385]], 11],
'normalize_component': ['normalize_component', 'Normalize the component name using the "frankenstyle" rules. ', [['lib/classes','component.php',968],['lib','deprecatedlib.php',528]], 85],
'moodle_setlocale': ['moodle_setlocale', 'Sets the system locale ', [['lib','moodlelib.php',7334]], 3],
'coursetag_delete_course_tags': ['coursetag_delete_course_tags', 'Course tagging function used only during the deletion of a course (called by lib/moodlelib.php) to clean up associated tags ', [['tag','coursetagslib.php',308]], 3],
'execute': ['execute', 'Exceptionally override the execute method, so, based in the activity_included setting, we are able to skip the execution of one task completely ', [['backup/moodle2','backup_activity_task.class.php',205],['backup/converter/moodle1','backuplib.php',10],['filter/tex','latex.php',60],['backup/util/plan','base_plan.class.php',158],['mod/lti/service/toolsettings/classes/local/resource','systemsettings.php',61],['mod/lti/service/toolsettings/classes/local/resource','linksettings.php',63],['mod/lti/service/profile/classes/local/resource','profile.php',76],['webservice','lib.php',1772],['lib/classes/task','context_cleanup_task.php',41],['lib/adodb','adodb.inc.php',967],['enrol/imsenterprise/classes/task','cron_task.php',43],['admin/tool/messageinbound/classes/task','cleanup_task.php',47],['lib/classes/task','calendar_cron_task.php',40],['mod/workshop/allocation/random','lib.php',83],['lib/classes/task','registration_cron_task.php',40],['lib/classes/task','portfolio_cron_task.php',40],['lib/htmlpurifier/HTMLPurifier/Strategy','Composite.php',21],['lib/google/src/Google/Http','Batch.php',56],['backup/converter/imscc11','lib.php',85],['lib/classes/task','file_temp_cleanup_task.php',40],['filter/tex','texdebug.php',287],['admin/tool/monitor/classes','notification_task.php',39],['lib/classes/task','stats_cron_task.php',40],['lib/classes/task','backup_cleanup_task.php',40],['admin/tool/log/store/legacy/classes/task','cleanup_task.php',40],['backup/util/ui','backup_ui.class.php',122],['lib/dml','pgsql_native_moodle_database.php',665],['lib/classes/task','messaging_cleanup_task.php',40],['lib/zend/Zend/Service/WindowsAzure/RetryPolicy','RetryN.php',68],['lib/classes/task','session_cleanup_task.php',40],['lib/classes/task','completion_cron_task.php',40],['lib/dml','oci_native_moodle_database.php',1009],['backup/util/plan','base_task.class.php',162],['lib/adodb/drivers','adodb-pdo.inc.php',464],['backup/util/plan','backup_plan.class.php',112],['backup/util/ui','restore_ui.class.php',206],['backup/converter/imscc11','backuplib.php',42],['backup/moodle2','restore_activity_task.class.php',183],['','mdeploy.php',743],['lib/dml','sqlsrv_native_moodle_database.php',745],['lib/htmlpurifier/HTMLPurifier/Strategy','MakeWellFormed.php',66],['lib/google/src/Google/Http','REST.php',28],['admin/tool/langimport/classes/task','update_langpacks_task.php',44],['mod/lti/service/toolproxy/classes/local/resource','toolproxy.php',62],['lib/classes/task','plagiarism_cron_task.php',40],['admin/tool/messageinbound/classes/task','pickup_task.php',47],['backup/util/plan','backup_structure_step.class.php',50],['mod/forum/classes/task','cron_task.php',39],['mod/workshop/allocation/scheduled','lib.php',128],['lib/classes/task','file_trash_cleanup_task.php',40],['backup/util/plan','restore_execution_step.class.php',25],['lib/tests/fixtures','task_fixtures.php',30],['lib/tests/fixtures','task_fixtures.php',39],['lib/tests/fixtures','task_fixtures.php',48],['lib/tests/fixtures','task_fixtures.php',57],['admin/tool/installaddon/classes','validator.php',114],['backup/util/plan','backup_execution_step.class.php',25],['lib/classes/task','password_reset_cleanup_task.php',40],['lib/classes/task','automated_backup_task.php',40],['backup/converter/moodle1','lib.php',142],['lib/htmlpurifier/HTMLPurifier/Strategy','ValidateAttributes.php',16],['lib/classes/task','create_contexts_task.php',40],['backup/util/plan','restore_plan.class.php',159],['backup/converter/imscc1','lib.php',84],['lib/dml','mssql_native_moodle_database.php',662],['admin/tool/log/store/standard/classes/task','cleanup_task.php',40],['lib/classes/task','cache_cleanup_task.php',40],['lib/classes/task','badges_cron_task.php',40],['lib/classes/task','cache_cron_task.php',40],['backup/util/interfaces','executable.class.php',32],['lib/htmlpurifier/HTMLPurifier/Strategy','FixNesting.php',41],['lib/adodb/drivers','adodb-oci8po.inc.php',52],['lib/classes/task','question_cron_task.php',40],['lib/zend/Zend/Service/WindowsAzure/RetryPolicy','NoRetry.php',37],['lib/dml','mysqli_native_moodle_database.php',955],['lib/htmlpurifier/HTMLPurifier/Strategy','RemoveForeignElements.php',20],['backup/util/plan/tests/fixtures','plan_fixtures.php',47],['backup/util/plan/tests/fixtures','plan_fixtures.php',55],['lib/classes/task','events_cron_task.php',40],['lib/classes/task','delete_unconfirmed_users_task.php',40],['lib/adodb/drivers','adodb-oci8.inc.php',786],['backup/converter/imscc1','backuplib.php',10],['lib/classes/task','tag_cron_task.php',40],['lib/classes/task','blog_cron_task.php',40],['lib/classes/task','send_failed_login_notifications_task.php',43],['lib/classes/task','grade_cron_task.php',40],['lib/dml/tests','dml_test.php',5422],['admin/tool/uploadcourse/classes','processor.php',174],['backup/moodle2','restore_section_task.class.php',87],['mod/lti/service/toolsettings/classes/local/resource','contextsettings.php',62],['lib/google/src/Google','Client.php',545],['backup/util/plan','restore_structure_step.class.php',62],['lib/classes/task','legacy_plugin_cron_task.php',42],['lib/dml','pdo_moodle_database.php',226],['lib/classes/task','check_for_updates_task.php',40],['backup/util/helper','restore_decode_processor.class.php',73],['backup/moodle2','backup_section_task.class.php',97],['webservice/amf/testclient','AMFTester.mxml',282],['lib/classes/task','delete_incomplete_users_task.php',40],['mod/assign','adminlib.php',342],['lib/classes/task','send_new_user_passwords_task.php',40],['admin/tool/monitor/classes/task','clean_events.php',41]], 733],
'password_needs_rehash': ['password_needs_rehash', 'Determine if the password hash needs to be rehashed according to the options provided ', [['lib/password_compat/lib','password.php',195]], 2],
'grade_user_delete': ['grade_user_delete', 'Deletes all of a user\'s grade data from gradebook ', [['lib','gradelib.php',1327]], 1],
'get_emoticon_manager': ['get_emoticon_manager', 'Factory function for emoticon_manager ', [['lib','moodlelib.php',6758]], 9],
'clearattachments': ['clearattachments', 'Clear all filesystem, string, and binary attachments. ', [['lib/phpmailer','class.phpmailer.php',2746]], 1],
'set_send_count': ['set_send_count', 'Used to increment or reset email sent count ', [['lib','moodlelib.php',3169]], 2],
'remove_dir': ['remove_dir', 'Delete directory or only its content ', [['lib','moodlelib.php',8763]], 41],
'get_extra_user_fields': ['get_extra_user_fields', 'Checks if current user is shown any extra fields when listing users. ', [['lib','moodlelib.php',3465]], 41],
'require': ['require', '', [['lib/yuilib/3.17.2/timers','timers-debug.js',27],['lib/yuilib/3.17.2/timers','timers.js',27]], 454],
'__sleep': ['__sleep', 'Prepares the lang_string for sleep and stores only the forcedstring and string properties... the string cannot be regenerated so we need to ensure it is generated for this. ', [['lib','moodlelib.php',9487],['lib/horde/framework/Horde/Imap/Client','Tokenize.php',94],['lib/minify/lib','FirePHP.php',199],['lib/horde/framework/Horde/Socket','Client.php',110],['backup/util/loggers','file_logger.class.php',56],['lib/zend/Zend/Service/Technorati','ResultSet.php',260]], 0],
'get_plugin_list_with_file': ['get_plugin_list_with_file', 'Get a list of all the plugins of a given type that contain a particular file. ', [['lib/classes','component.php',851],['lib','deprecatedlib.php',3818]], 24],
'clear_criteria': ['clear_criteria', 'Clear old course completion criteria ', [['lib','completionlib.php',493]], 2],
'get_user_preferences': ['get_user_preferences', 'Used to fetch user preference(s) ', [['lib','moodlelib.php',1969]], 177],
'set_cache_flag': ['set_cache_flag', 'Set a volatile flag ', [['lib','moodlelib.php',1679]], 14],
'is_valid_plugin_name': ['is_valid_plugin_name', 'This method validates a plug name. It is much faster than calling clean_param. ', [['lib','moodlelib.php',6998],['lib/classes','component.php',926]], 51],
'purge_all': ['purge_all', 'Purge all of the cache stores of all of their data. ', [['cache/classes','helper.php',464]], 11],
's': ['s', 'Count of attempts selected by $this->whichattempts ', [['mod/quiz/report/statistics/classes','calculated.php',91],['lib','weblib.php',84]], 988],
'required_param': ['required_param', 'Returns a particular value for the named variable, taken from POST or GET.  If the parameter doesn\'t exist then an error is thrown because we require this variable. ', [['lib','moodlelib.php',521]], 816],
'prepare_renderable_emoticon': ['prepare_renderable_emoticon', 'Converts emoticon object into renderable pix_emoticon object ', [['lib','moodlelib.php',6810]], 3],
'update_record': ['update_record', 'Update a record in a table ', [['lib/dml','pgsql_native_moodle_database.php',1137],['lib/dml','oci_native_moodle_database.php',1355],['lib/dml','sqlsrv_native_moodle_database.php',1081],['lib/dml','mssql_native_moodle_database.php',1003],['lib/dml','mysqli_native_moodle_database.php',1397],['lib/dml/tests','dml_test.php',5430],['lib/dml','pdo_moodle_database.php',460]], 565],
'get_plugin_list': ['get_plugin_list', 'Get list of plugins of given type. ', [['lib/classes','component.php',781],['lib','deprecatedlib.php',467],['admin/tool/monitor/classes','eventlist.php',176]], 184],
'sync_roles': ['sync_roles', 'Sync roles for this user - usually creator ', [['lib','authlib.php',367],['auth/fc','auth.php',180],['auth/ldap','auth.php',1790]], 1],
'partial': ['partial', 'Generate Mustache Template partial call PHP source. ', [['lib/mustache/src/Mustache','Compiler.php',400],['lib','moodlelib.php',9112]], 6],
'close': ['close', 'Close the connection to the server ', [['lib/zend/Zend/Http/Client/Adapter','Socket.php',486],['lib/tests','completionlib_test.php',888],['lib/adodb','adodb.inc.php',2164],['lib/adodb','adodb.inc.php',2844],['lib/adodb','adodb.inc.php',3536],['lib','webdavlib.php',176],['admin/tool/uploaduser','locallib.php',149],['lib/dml','oci_native_moodle_recordset.php',80],['lib/tcpdf','tcpdf.php',2943],['lib/horde/framework/Horde/Imap/Client','Base.php',1846],['lib','excellib.class.php',93],['lib/zend/Zend/Http/Client/Adapter','Test.php',187],['lib/classes/dml','recordset_walk.php',153],['mod/assign/feedback/offline','importgradeslib.php',178],['lib/pear/Net','GeoIP.php',556],['backup/util/helper','backup_array_iterator.class.php',63],['lib/zend/Zend/Gdata/App','LoggingHttpClientAdapterSocket.php',109],['lib/zend/Zend/Http/Client/Adapter','Proxy.php',266],['lib/dml','mssql_native_moodle_recordset.php',87],['lib/pear/Auth','RADIUS.php',542],['lib/pear/Auth','RADIUS.php',703],['lib/pear/Auth','RADIUS.php',824],['lib/phpmailer','class.smtp.php',507],['lib/phpexcel/PHPExcel/Shared','ZipArchive.php',80],['lib/phpunit/classes','event_sink.php',39],['lib/zend/Zend/Http/Client/Adapter','Interface.php',73],['lib/dml','pgsql_native_moodle_recordset.php',104],['auth/fc','fcFPP.php',72],['lib/filestorage','zip_archive.php',183],['lib','odslib.class.php',71],['lib/horde/framework/Horde/Socket','Client.php',135],['question/engine/tests','helpers.php',1225],['grade','lib.php',323],['lib/dml','mysqli_native_moodle_recordset.php',86],['lib','csvlib.class.php',256],['lib/google/src/Google/Logger','File.php',130],['lib/horde/framework/Horde','Stream.php',585],['lib/phpunit/classes','phpmailer_sink.php',41],['lib/phpunit/classes','message_sink.php',39],['lib/zend/Zend/Http/Client/Adapter','Curl.php',460],['lib/dml','sqlsrv_native_moodle_recordset.php',133],['lib/zend/Zend/Service/WindowsAzure','SessionHandler.php',109],['backup/util/helper','backup_null_iterator.class.php',53],['grade/export','lib.php',662],['lib/dml','pdo_moodle_recordset.php',79]], 1036],
'redirect': ['redirect', 'Redirect the browser ', [['','mdeploy.php',1474],['lib','weblib.php',2514]], 948],
'generate_email_processing_address': ['generate_email_processing_address', 'Generate an email processing address. ', [['lib','moodlelib.php',5251]], 1],
'clearallrecipients': ['clearallrecipients', 'Clear all recipient types. ', [['lib/phpmailer','class.phpmailer.php',2734]], 1],
'get_localised_timezone': ['get_localised_timezone', 'Returns localised timezone name. ', [['lib/classes','date.php',86]], 11],
'valid_uploaded_file': ['valid_uploaded_file', 'Returns current name of file on disk if it exists. ', [['lib','moodlelib.php',6043]], 0],
'usergetmidnight': ['usergetmidnight', 'Given a time, return the GMT timestamp of the most recent midnight for the current user. ', [['lib','moodlelib.php',2247]], 22],
'isqmail': ['isqmail', 'Send messages using qmail. ', [['lib/phpmailer','class.phpmailer.php',710]], 2],
'clearcustomheaders': ['clearcustomheaders', 'Clear all custom headers. ', [['lib/phpmailer','class.phpmailer.php',2755]], 1],
'enrol_get_enrolment_end': ['enrol_get_enrolment_end', 'This function returns the end of current active user enrolment. ', [['lib','enrollib.php',963]], 2],
'set_context': ['set_context', 'Set the context. ', [['mod/assign','locallib.php',246],['lib/portfolio','caller.php',568],['grade/grading','lib.php',116],['lib','pagelib.php',942]], 254],
'change_password_url': ['change_password_url', 'Returns the URL for changing the users\' passwords, or empty if the default URL can be used. ', [['lib','authlib.php',162],['auth/db','auth.php',685],['auth/email','auth.php',183],['auth/none','auth.php',99],['auth/cas','auth.php',259],['auth/mnet','auth.php',599],['auth/pop3','auth.php',116],['auth/manual','auth.php',122],['auth/imap','auth.php',120],['auth/webservice','auth.php',111],['auth/ldap','auth.php',1609]], 9],
'clearreplytos': ['clearreplytos', 'Clear all ReplyTo recipients. ', [['lib/phpmailer','class.phpmailer.php',2725]], 1],
'get_all_user_name_fields': ['get_all_user_name_fields', 'A centralised location for the all name fields. Returns an array / sql string snippet. ', [['lib','moodlelib.php',3345]], 94],
'setup_lang_from_browser': ['setup_lang_from_browser', 'This function will search for browser prefereed languages, setting Moodle to use the best one available if $SESSION->lang is undefined ', [['lib','moodlelib.php',8889]], 1],
'groups_delete_groupings': ['groups_delete_groupings', 'Delete all groupings from course ', [['group','lib.php',669]], 3],
'force_current_language': ['force_current_language', 'Force the current language to get strings and dates localised in the given language. ', [['lib','moodlelib.php',6459]], 12],
'get_real_size': ['get_real_size', 'Converts numbers like 10M into bytes. ', [['lib','setuplib.php',1253]], 25],
'send_password_change_confirmation_email': ['send_password_change_confirmation_email', 'Sends a password change confirmation email. ', [['lib','moodlelib.php',5817]], 1],
'delete_user': ['delete_user', 'Marks user deleted in internal user database and notifies the auth plugin. Also unenrols user from all roles and does other cleanup. ', [['lib','moodlelib.php',3879]], 29],
'delete_user_key': ['delete_user_key', 'Delete the user\'s new private user access keys for a particular script. ', [['lib','moodlelib.php',3047]], 1],
'json_encode': ['json_encode', 'encodes an arbitrary variable into JSON format ', [['lib/minify/lib','FirePHP.php',1124]], 247],
'get_columns': ['get_columns', 'Returns detailed information about columns in table. This information is cached internally. ', [['lib/dml','pgsql_native_moodle_database.php',385],['lib/dml','oci_native_moodle_database.php',464],['lib/dml','sqlsrv_native_moodle_database.php',462],['lib/dml','sqlite3_pdo_moodle_database.php',195],['lib/dml','mssql_native_moodle_database.php',392],['lib','csvlib.class.php',190],['lib/dml','mysqli_native_moodle_database.php',572],['lib/dml/tests','dml_test.php',5417]], 108],
'component_callback_exists': ['component_callback_exists', 'Determine if a component callback exists and return the function name to call. Note that this function will include the required library files so that the functioname returned can be called directly. ', [['lib','moodlelib.php',7145]], 4],
'create_user_record': ['create_user_record', 'Creates a bare-bones user record ', [['lib','moodlelib.php',3691]], 3],
'try_autoenrol': ['try_autoenrol', 'Attempt to automatically enrol current user in course without any interaction, calling code has to make sure the plugin and instance are active. ', [['lib','enrollib.php',1239]], 1],
'print_error': ['print_error', 'Abort execution by throwing of a general exception, default exception handler displays the error message in most cases. ', [['lib','setuplib.php',449]], 1560],
'text_to_html': ['text_to_html', 'Given plain text, makes it into HTML as nicely as possible. ', [['lib','weblib.php',1784]], 36],
'enrol_get_plugins': ['enrol_get_plugins', 'Returns instances of enrol plugins ', [['lib','enrollib.php',70]], 45],
'tag_set': ['tag_set', 'Set the tags assigned to a record.  This overwrites the current tags. ', [['tag','lib.php',105]], 29],
'method': ['method', 'Calls the callback function. ', [['lib','moodlelib.php',9152]], 135],
'get_field_select': ['get_field_select', 'Get a single field value from a table record which match a particular WHERE clause. ', [['lib/dml','moodle_database.php',1514]], 44],
'groups_delete_group_members': ['groups_delete_group_members', 'Remove all users (or one user) from all groups in course ', [['group','lib.php',563]], 6],
'get_admins': ['get_admins', 'Returns list of all admins, using 1 DB query ', [['lib','datalib.php',93]], 19],
'perf_get_reads': ['perf_get_reads', 'Returns the number of reads done by this database. ', [['lib/dml','moodle_database.php',2528]], 68],
'set_default_server_timezone': ['set_default_server_timezone', 'Set PHP default timezone to $CFG->timezone. ', [['lib/classes','date.php',185]], 23],
'get_user_timezone_object': ['get_user_timezone_object', 'Return user timezone object. ', [['lib/classes','date.php',271]], 5],
'reset_password_and_mail': ['reset_password_and_mail', 'Resets specified user\'s password and send the new password to the user via email. ', [['lib','moodlelib.php',5743]], 0],
'is_mnet_remote_user': ['is_mnet_remote_user', 'Returns whether or not the user object is a remote MNET user. This function is in moodlelib because it does not rely on loading any of the MNET code. ', [['lib','moodlelib.php',8869]], 20],
'make_cache_directory': ['make_cache_directory', 'Create a directory under cachedir and make sure it is writable. ', [['lib','setuplib.php',1605]], 13],
'delete_records': ['delete_records', 'Delete the records from a table where all the given conditions met. If conditions not specified, table is truncated. ', [['lib/dml','moodle_database.php',1815],['lib/dml','sqlite3_pdo_moodle_database.php',337]], 778],
'check_user_preferences_loaded': ['check_user_preferences_loaded', 'Refresh user preference cache. This is used most often for $USER object that is stored in session, but it also helps with performance in cron script. ', [['lib','moodlelib.php',1750]], 11],
'make_localcache_directory': ['make_localcache_directory', 'Create a directory under localcachedir and make sure it is writable. The files in this directory MUST NOT change, use revisions or content hashes to work around this limitation - this means you can only add new files here. ', [['lib','setuplib.php',1625]], 17],
'get_field': ['get_field', 'Get the right field name to fetch a stat for these attempts that is calculated for more than one $whichattempts (count or avg). ', [['mod/quiz/report/statistics/classes','calculated.php',109],['lib/dml','moodle_database.php',1497],['user/filters','lib.php',124],['lib/behat','behat_field_manager.php',243]], 485],
'prevent_local_passwords': ['prevent_local_passwords', '', [['auth/radius','auth.php',138],['lib','authlib.php',215],['auth/pam','auth.php',88],['auth/db','auth.php',646],['auth/email','auth.php',160],['auth/shibboleth','auth.php',157],['auth/none','auth.php',76],['auth/nologin','auth.php',57],['auth/cas','auth.php',49],['auth/mnet','auth.php',575],['auth/pop3','auth.php',93],['auth/nntp','auth.php',76],['auth/manual','auth.php',99],['auth/fc','auth.php',157],['auth/imap','auth.php',97],['auth/ldap','auth.php',1581]], 2],
'reset_course_page_comments': ['reset_course_page_comments', 'Delete page_comments in whole course, used by course reset ', [['comment','lib.php',769]], 1],
'__tostring': ['__tostring', 'Cooerce to string. ', [['lib/horde/framework/Horde/Support','Uuid.php',75],['lib/simplepie/library/SimplePie','Restriction.php',94],['lib/horde/framework/Horde/Imap/Client','DateTime.php',59],['lib/zend/Zend/XmlRpc','Request.php',437],['lib/zend/Zend/Gdata/Extension','Who.php',174],['lib/horde/framework/Horde/Support','Randomid.php',65],['lib/zend/Zend/Rest/Client','Result.php',215],['lib/horde/framework/Horde/Imap/Client/Data/Format','DateTime.php',27],['lib/pear','PEAR.php',1004],['lib/horde/framework/Horde/Imap/Client/Data/Format','Nstring.php',39],['lib/pear/PEAR','Exception.php',315],['lib/zend/Zend/Gdata/YouTube/Extension','Racy.php',115],['lib/adodb','adodb.inc.php',2971],['lib/horde/framework/Horde/Imap/Client/Data/Format','String.php',81],['lib/zend/Zend/Gdata/Calendar/Extension','QuickAdd.php',123],['lib/zend/Zend/XmlRpc/Response','Http.php',38],['lib/zend/Zend/Http','Cookie.php',260],['backup/cc','validator.php',97],['lib/horde/framework/Horde/Imap/Client/Data/Format','Mailbox.php',44],['lib/alfresco/Service','SpacesStore.php',33],['lib/zend/Zend/Gdata/App','MediaFileSource.php',136],['lib/zend/Zend/Gdata/YouTube/Extension','Position.php',78],['lib/horde/framework/Horde/Imap/Client/Data/Format','List.php',68],['lib/pear/Net/GeoIP','Location.php',176],['lib/horde/framework/Horde/Imap/Client','Ids.php',150],['lib/horde/framework/Horde/Support','Stub.php',21],['lib/zend/Zend/Gdata/Calendar/Extension','AccessLevel.php',116],['lib/zend/Zend/Gdata/Gapps/Extension','EmailList.php',133],['lib','moodlelib.php',9469],['lib/zend/Zend/Gdata/Media/Extension','MediaContent.php',259],['lib/horde/framework/Horde/Imap/Client','Tokenize.php',101],['lib/horde/framework/Horde/Stream','TempString.php',109],['lib/horde/framework/Horde/Imap/Client/Data/Format','Date.php',44],['lib/zend/Zend/Gdata/Gapps/Extension','Login.php',472],['lib/zend/Zend/Gdata/Gapps','ServiceException.php',196],['lib/zend/Zend/XmlRpc','Fault.php',298],['lib/zend/Zend','Uri.php',48],['lib/zend/Zend/Gdata/YouTube/Extension','Duration.php',115],['lib/horde/framework/Horde/Imap/Client/Data/Format','Number.php',27],['lib/zend/Zend/Gdata/Gapps/Extension','Nickname.php',133],['lib/simplepie/library/SimplePie','Caption.php',113],['mod/lti','OAuth.php',79],['mod/lti','OAuth.php',109],['mod/lti','OAuth.php',460],['lib/horde/framework/Horde/Imap/Client/Data','Namespace.php',122],['lib/horde/framework/Horde/Imap/Client/Search','Query.php',60],['lib/alfresco/Service','ContentData.php',57],['lib/classes/output','mustache_uniqid_helper.php',41],['lib/zend/Zend/Gdata/Gapps/Extension','Quota.php',133],['lib/zend/Zend/Gdata/Calendar/Extension','Timezone.php',115],['lib/zend/Zend/Gdata/Extension','Transparency.php',113],['lib/simplepie/library/SimplePie','Enclosure.php',264],['lib/simplepie/library','SimplePie.php',655],['lib/alfresco/Service','Store.php',38],['lib/simplepie/library/SimplePie','Rating.php',85],['lib/horde/framework/Horde/Support','Backtrace.php',121],['lib/simplepie/library/SimplePie','Author.php',95],['lib/horde/framework/Horde/Imap/Client','Url.php',132],['lib/phpexcel/PHPExcel','Comment.php',318],['lib/phpexcel/PHPExcel','RichText.php',130],['lib/zend/Zend/Gdata/App','Base.php',561],['lib/zend/Zend/Service/WindowsAzure/Storage','TableEntityQuery.php',317],['lib','weblib.php',538],['lib/zend/Zend/Gdata/Extension','AttendeeStatus.php',113],['lib/simplepie/library/SimplePie','Item.php',110],['lib/zend/Zend/Service','ReCaptcha.php',153],['lib/horde/framework/Horde/Imap/Client/Data','Format.php',44],['lib/zend/Zend/Amf','Response.php',140],['lib/zend/Zend/Gdata/YouTube/Extension','State.php',182],['question/engine','states.php',108],['lib/zend/Zend/XmlRpc/Generator','GeneratorAbstract.php',109],['lib/horde/framework/Horde/Imap/Client/Data','Acl.php',43],['lib/horde/framework/Horde/Imap/Client','Mailbox.php',116],['lib/zend/Zend/Gdata/Calendar/Extension','Color.php',116],['lib/zend/Zend','Date.php',468],['lib/zend/Zend/Gdata/Extension','EventStatus.php',92],['lib/phpexcel/PHPExcel','Cell.php',979],['lib/zend/Zend/Gdata/Calendar/Extension','Hidden.php',124],['lib/zend/Zend/Http','Response.php',400],['lib/lessphp/Tree','Dimension.php',74],['lib/zend/Zend/Gdata/Extension','Visibility.php',113],['lib/zend/Zend/Gdata/YouTube/Extension','Statistics.php',294],['lib/zend/Zend/Gdata/Calendar/Extension','Selected.php',124],['lib/simplepie/library/SimplePie','Category.php',95],['lib/horde/framework/Horde/Imap/Client/Interaction','Server.php',139],['lib/horde/framework/Horde/Imap/Client/Data/Format','Nil.php',34],['lib/simplepie/library/SimplePie','Credit.php',94],['lib/zend/Zend/Gdata/Extension','Reminder.php',103],['lib/phpexcel/PHPExcel/Worksheet','AutoFilter.php',850],['lib/horde/framework/Horde','Stream.php',103],['lib/zend/Zend/XmlRpc','Response.php',239],['availability/classes','condition.php',93],['lib/horde/framework/Horde/Support','Guid.php',63],['lib/zend/Zend/Gdata/Extension','Where.php',117],['lib/simplepie/library/SimplePie','IRI.php',133],['lib/zend/Zend/Gdata/Calendar/Extension','SendEventNotifications.php',122],['lib/horde/framework/Horde/Imap/Client/Data','AclRights.php',59],['lib/zend/Zend/Service/DeveloperGarden/Response/VoiceButler','NewCallResponse.php',51],['lib/alfresco/Service','Node.php',292],['lib/horde/framework/Horde/Imap/Client/Data','BaseSubject.php',84],['lib/zend/Zend/Gdata/Extension','AttendeeType.php',113],['lib/dml/tests','dml_test.php',5446],['lib/zend/Zend','Exception.php',69],['lib/zend/Zend/Service/ReCaptcha','MailHide.php',161],['grade/report/singleview/classes/local/ui','attribute_format.php',44],['lib/simplepie/library/SimplePie','Source.php',72],['lib/zend/Zend/Gdata/Extension','When.php',115],['lib/simplepie/library/SimplePie','Copyright.php',85],['availability/classes','tree.php',91],['lib/zend/Zend/Gdata/Gapps','Error.php',223],['lib/lessphp/Tree','Unit.php',48],['lib/zend/Zend/Gdata/Gapps/Extension','Name.php',172],['lib/horde/framework/Horde/Imap/Client/Auth','DigestMD5.php',107],['lib/zend/Zend/Gdata/Extension','ExtendedProperty.php',79],['lib/horde/framework/Horde/Mail/Rfc822','Object.php',25],['question/engine','datalib.php',1686],['question/engine','datalib.php',1754]], 41],
'qualified_me': ['qualified_me', 'Guesses the full URL of the current script. ', [['lib','weblib.php',197]], 26],
'update_site_identifier': ['update_site_identifier', 'Update the site identifier stored by the cache API. ', [['cache','locallib.php',629],['cache/classes','helper.php',597]], 4],
'getremoteaddr': ['getremoteaddr', 'Returns most reliable client address ', [['lib','moodlelib.php',8281]], 62],
'format_float': ['format_float', 'This function should be identical to {@link qtype_calculated_variable_substituter::format_float()}. Except that we do not try to do locale-aware replacement of the decimal point. ', [['question/type/calculated/db','upgradelib.php',205],['lib','moodlelib.php',7707],['question/type/calculatedmulti/db','upgradelib.php',229],['question/type/calculated','question.php',328]], 154],
'get_calendar_instance': ['get_calendar_instance', 'Returns an instance of the currently used calendar type. ', [['calendar/classes','type_factory.php',30]], 35],
'get_file_storage': ['get_file_storage', 'Returns local file storage instance ', [['lib','moodlelib.php',5950]], 486],
'purge_all_caches': ['purge_all_caches', 'Invalidates browser caches and cached data in temp. ', [['lib','moodlelib.php',1588]], 13],
'can_reset_password': ['can_reset_password', 'Returns true if plugin allows resetting of internal password. ', [['lib','authlib.php',279],['auth/db','auth.php',701],['auth/email','auth.php',193],['auth/none','auth.php',109],['auth/nologin','auth.php',81],['auth/manual','auth.php',132],['auth/webservice','auth.php',121],['auth/ldap','auth.php',504]], 3],
'get_list_of_charsets': ['get_list_of_charsets', 'Returns a list of charset codes ', [['lib','moodlelib.php',6708]], 4],
'is_loggedinas': ['is_loggedinas', 'Is current $USER logged-in-as somebody else? ', [['lib/classes/session','manager.php',786]], 32],
'clear_static_caches': ['clear_static_caches', 'This function is used to indicate that any long running cron processes should exit at the next opportunity and restart. This is because something (e.g. DB changes) has changed and the static caches may be stale. ', [['lib/classes/task','manager.php',615]], 1],
'is_readable': ['is_readable', '', [], 207],
'file': ['file', '', [], 82],
'floor': ['floor', '', [], 467],
'explode': ['explode', '', [], 1599],
'is_array': ['is_array', '', [], 1820],
'memory_get_usage': ['memory_get_usage', '', [], 16],
'preg_split': ['preg_split', '', [], 127],
'each': ['each', '', [], 2224],
'count': ['count', '', [], 3984],
'class_exists': ['class_exists', '', [], 273],
'trim': ['trim', '', [], 1889],
'in_array': ['in_array', '', [], 1173],
'krsort': ['krsort', '', [], 15],
'is_executable': ['is_executable', '', [], 11],
'getmypid': ['getmypid', '', [], 9],
'call_user_func_array': ['call_user_func_array', '', [], 101],
'session_id': ['session_id', '', [], 35],
'time': ['time', '', [], 1768],
'round': ['round', '', [], 903],
'base64_decode': ['base64_decode', '', [], 101],
'array_shift': ['array_shift', '', [], 607],
'array_pop': ['array_pop', '', [], 438],
'implode': ['implode', '', [], 1259],
'str_shuffle': ['str_shuffle', '', [], 7],
'is_float': ['is_float', '', [], 39],
'array_unshift': ['array_unshift', '', [], 114],
'ord': ['ord', '', [], 438],
'array_map': ['array_map', '', [], 149],
'array_slice': ['array_slice', '', [], 169],
'number_format': ['number_format', '', [], 44],
'preg_quote': ['preg_quote', '', [], 207],
'opendir': ['opendir', '', [], 40],
'array_key_exists': ['array_key_exists', '', [], 1539],
'array_search': ['array_search', '', [], 188],
'substr': ['substr', '', [], 2883],
'strtolower': ['strtolower', '', [], 922],
'unlink': ['unlink', '', [], 252],
'str_split': ['str_split', '', [], 30],
'stripos': ['stripos', '', [], 95],
'substr_count': ['substr_count', '', [], 78],
'ip2long': ['ip2long', '', [], 14],
'escapeshellarg': ['escapeshellarg', '', [], 31],
'func_num_args': ['func_num_args', '', [], 52],
'is_scalar': ['is_scalar', '', [], 28],
'hexdec': ['hexdec', '', [], 74],
'class_implements': ['class_implements', '', [], 14],
'str_replace': ['str_replace', '', [], 1667],
'pack': ['pack', '', [], 154],
'is_null': ['is_null', '', [], 1992],
'filetype': ['filetype', '', [], 4],
'file_exists': ['file_exists', '', [], 873],
'func_get_args': ['func_get_args', '', [], 154],
'array_keys': ['array_keys', '', [], 1152],
'strrev': ['strrev', '', [], 38],
'base64_encode': ['base64_encode', '', [], 146],
'array_unique': ['array_unique', '', [], 173],
'ini_get': ['ini_get', '', [], 142],
'unserialize': ['unserialize', '', [], 180],
'is_numeric': ['is_numeric', '', [], 723],
'get_class_vars': ['get_class_vars', '', [], 3],
'asort': ['asort', '', [], 109],
'urlencode': ['urlencode', '', [], 234],
'strcasecmp': ['strcasecmp', '', [], 50],
'mb_convert_encoding': ['mb_convert_encoding', '', [], 18],
'closedir': ['closedir', '', [], 30],
'get_class': ['get_class', '', [], 332],
'preg_replace_callback': ['preg_replace_callback', '', [], 130],
'array_merge': ['array_merge', '', [], 2320],
'trigger_error': ['trigger_error', '', [], 135],
'microtime': ['microtime', '', [], 115],
'setlocale': ['setlocale', '', [], 51],
'strip_tags': ['strip_tags', '', [], 149],
'is_string': ['is_string', '', [], 680],
'array_splice': ['array_splice', '', [], 54],
'urldecode': ['urldecode', '', [], 58],
'abs': ['abs', '', [], 551],
'flush': ['flush', '', [], 71],
'fwrite': ['fwrite', '', [], 209],
'gmdate': ['gmdate', '', [], 145],
'array_reverse': ['array_reverse', '', [], 127],
'array_values': ['array_values', '', [], 283],
'intval': ['intval', '', [], 484],
'unpack': ['unpack', '', [], 66],
'parse_url': ['parse_url', '', [], 66],
'realpath': ['realpath', '', [], 140],
'chr': ['chr', '', [], 821],
'define': ['define', '', [], 2170],
'shell_exec': ['shell_exec', '', [], 3],
'posix_times': ['posix_times', '', [], 2],
'addslashes': ['addslashes', '', [], 31],
'is_dir': ['is_dir', '', [], 221],
'mt_rand': ['mt_rand', '', [], 54],
'is_file': ['is_file', '', [], 108],
'ksort': ['ksort', '', [], 158],
'rmdir': ['rmdir', '', [], 29],
'html_entity_decode': ['html_entity_decode', '', [], 25],
'strpos': ['strpos', '', [], 1623],
'getdate': ['getdate', '', [], 237],
'strftime': ['strftime', '', [], 17],
'exec': ['exec', '', [], 330],
'error_log': ['error_log', '', [], 105],
'defined': ['defined', '', [], 4098],
'phpversion': ['phpversion', '', [], 25],
'preg_match': ['preg_match', '', [], 1317],
'is_bool': ['is_bool', '', [], 177],
'end': ['end', '', [], 432],
'filesize': ['filesize', '', [], 89],
'get_object_vars': ['get_object_vars', '', [], 54],
'get_included_files': ['get_included_files', '', [], 2],
'function_exists': ['function_exists', '', [], 443],
'dechex': ['dechex', '', [], 45],
'serialize': ['serialize', '', [], 266],
'version_compare': ['version_compare', '', [], 69],
'method_exists': ['method_exists', '', [], 279],
'mb_substitute_character': ['mb_substitute_character', '', [], 6],
'reset': ['reset', '', [], 1070],
'preg_replace': ['preg_replace', '', [], 903],
'str_ireplace': ['str_ireplace', '', [], 27],
'link': ['link', '', [], 635],
'is_uploaded_file': ['is_uploaded_file', '', [], 6],
'rand': ['rand', '', [], 107],
'is_object': ['is_object', '', [], 508],
'preg_match_all': ['preg_match_all', '', [], 159],
'clearstatcache': ['clearstatcache', '', [], 30],
'array_fill': ['array_fill', '', [], 59],
'sleep': ['sleep', '', [], 35],
'header': ['header', '', [], 1294]};
CLASS_DATA={
'email_failed': ['email_failed', 'Email failed event class. ', [['lib/classes/event','email_failed.php',30]], 2],
'user_loggedin': ['user_loggedin', 'User login event class. ', [['lib/classes/event','user_loggedin.php',29]], 3],
'core_user': ['core_user', 'User class to access user details. ', [['lib/classes','user.php',27]], 143],
'course_reset_started': ['course_reset_started', 'core course reset started event class. ', [['lib/classes/event','course_reset_started.php',28]], 1],
'filter_manager': ['filter_manager', 'Class to manage the filtering of strings. It is intended that this class is only used by weblib.php. Client code should probably be using the format_text and format_string functions. ', [['lib','filterlib.php',44]], 13],
'type_factory': ['type_factory', 'Class \core_calendar\type_factory. ', [['calendar/classes','type_factory.php',19]], 42],
'context_system': ['context_system', 'System context class ', [['lib','accesslib.php',6106]], 929],
'require_login_exception': ['require_login_exception', 'Course/activity access exception. ', [['lib','setuplib.php',148]], 13],
'user_updated': ['user_updated', 'Event when user profile is updated. ', [['lib/classes/event','user_updated.php',29]], 9],
'manager': ['manager', 'Defines MAnager class for myprofile navigation tree. ', [['user/classes/output/myprofile','manager.php',28],['lib/classes/log','manager.php',29],['admin/tool/messageinbound/classes','manager.php',29],['lib/classes/message','manager.php',31],['lib/classes/message/inbound','manager.php',29],['admin/tool/log/classes/log','manager.php',29],['lib/classes/session','manager.php',29],['lib/classes/task','manager.php',28],['lib/classes/event','manager.php',30]], 346],
'coding_exception': ['coding_exception', 'Exception indicating programming error, must be fixed by a programer. For example a core API might throw this type of exception if a plugin calls it incorrectly. ', [['lib','setuplib.php',214]], 867],
'file_browser': ['file_browser', 'This class provides the main entry point for other code wishing to get information about files. ', [['lib/filebrowser','file_browser.php',41]], 1],
'user_login_failed': ['user_login_failed', 'User login failed event class. ', [['lib/classes/event','user_login_failed.php',29]], 9],
'course_content_deleted': ['course_content_deleted', 'Course content deleted event class. ', [['lib/classes/event','course_content_deleted.php',29]], 1],
'core_collator': ['core_collator', 'A collator class with static methods that can be used for sorting. ', [['lib/classes','collator.php',28]], 130],
'mnet_environment': ['mnet_environment', 'Info about the local environment, wrt RPC ', [['mnet','environment.php',2]], 2],
'navigation_node': ['navigation_node', 'This class is used to represent a node in a navigation tree ', [['lib','navigationlib.php',34]], 338],
'cache_helper': ['cache_helper', 'The cache helper class. ', [['cache/classes','helper.php',31]], 131],
'partial': ['partial', 'Used to manage function binding. ', [['lib','moodlelib.php',9133]], 1],
'emoticon_manager': ['emoticon_manager', 'Provides core support for plugins that have to deal with emoticons (like HTML editor or emoticon filter). ', [['lib','moodlelib.php',6773]], 1],
'user_loggedout': ['user_loggedout', 'Event when user logout. ', [['lib/classes/event','user_loggedout.php',28]], 1],
'invalid_parameter_exception': ['invalid_parameter_exception', 'Exception indicating malformed parameter problem. This exception is not supposed to be thrown when processing user submitted data in forms. It is more suitable for WS and other low level stuff. ', [['lib','setuplib.php',234]], 58],
'user_password_updated': ['user_password_updated', 'Event when user password is changed or reset. ', [['lib/classes/event','user_password_updated.php',29]], 4],
'moodle_url': ['moodle_url', 'Class for creating and manipulating urls. ', [['lib','weblib.php',240]], 2887],
'file_storage': ['file_storage', 'File storage class used for low level access to stored files. ', [['lib/filestorage','file_storage.php',30]], 16],
'context_course': ['context_course', 'Course context class ', [['lib','accesslib.php',6766]], 1197],
'core_plugin_manager': ['core_plugin_manager', 'Singleton class providing general plugins management functionality. ', [['lib/classes','plugin_manager.php',31]], 187],
'pix_emoticon': ['pix_emoticon', 'Data structure representing an emoticon image ', [['lib','outputcomponents.php',568]], 2],
'context_module': ['context_module', 'Course module context class ', [['lib','accesslib.php',6988]], 942],
'rating_manager': ['rating_manager', 'The rating_manager class provides the ability to retrieve sets of ratings from the database ', [['rating','lib.php',365]], 25],
'context_user': ['context_user', 'User context class ', [['lib','accesslib.php',6347]], 288],
'core_text': ['core_text', 'defines string api\'s for manipulating strings ', [['lib/classes','text.php',27]], 512],
'html_writer': ['html_writer', 'Simple html output class ', [['lib','outputcomponents.php',1052]], 4832],
'core_date': ['core_date', 'Core date and time related code. ', [['lib/classes','date.php',26]], 194],
'cache': ['cache', 'The main cache class. ', [['cache/classes','loaders.php',31]], 213],
'course_reset_ended': ['course_reset_ended', 'The course reset ended event class. ', [['lib/classes/event','course_reset_ended.php',28]], 1],
'moodle_exception': ['moodle_exception', 'Base Moodle Exception class ', [['lib','setuplib.php',68]], 478],
'core_string_manager_standard': ['core_string_manager_standard', 'Standard string_manager implementation ', [['lib/classes','string_manager_standard.php',28]], 2],
'moodle_phpmailer': ['moodle_phpmailer', 'Moodle Customised version of the PHPMailer class ', [['lib/phpmailer','moodle_phpmailer.php',34]], 1],
'core_component': ['core_component', 'Collection of components related methods. ', [['lib/classes','component.php',41]], 485],
'course_deleted': ['course_deleted', 'Course deleted event class. ', [['lib/classes/event','course_deleted.php',29]], 1],
'user_created': ['user_created', 'Event when new user profile is created. ', [['lib/classes/event','user_created.php',29]], 8],
'user_deleted': ['user_deleted', 'User deleted event class. ', [['lib/classes/event','user_deleted.php',28]], 1],
'context_helper': ['context_helper', 'Context maintenance and helper methods. ', [['lib','accesslib.php',5824]], 210],
'completion_info': ['completion_info', 'Class represents completion information for a course. ', [['lib','completionlib.php',210]], 119],
'theme_config': ['theme_config', 'This class represents the configuration variables of a Moodle theme. ', [['lib','outputlib.php',100]], 39],
'core_string_manager_install': ['core_string_manager_install', 'Fetches minimum strings for installation ', [['lib/classes','string_manager_install.php',28]], 1],
'lang_string': ['lang_string', 'The lang_string class ', [['lib','moodlelib.php',9273]], 1548],
'comment': ['comment', 'This class represents a comment box on a page of feedback. ', [['mod/assign/feedback/editpdf/classes','comment.php',27],['comment','lib.php',26]], 54]};
CONST_DATA={
'AUTH_LOGIN_NOUSER': ['AUTH_LOGIN_NOUSER', '', [['lib','authlib.php',68]], 8],
'YEARSECS': ['YEARSECS', '', [['lib','moodlelib.php',39]], 18],
'PARAM_URL': ['PARAM_URL', '', [['lib','moodlelib.php',239]], 121],
'BLOG_COURSE_LEVEL': ['BLOG_COURSE_LEVEL', '', [['lib','moodlelib.php',369]], 1],
'PARAM_INT': ['PARAM_INT', '', [['lib','moodlelib.php',156]], 2948],
'PARAM_RAW_TRIMMED': ['PARAM_RAW_TRIMMED', '', [['lib','moodlelib.php',198]], 60],
'PARAM_ALPHA': ['PARAM_ALPHA', '', [['lib','moodlelib.php',77]], 377],
'DEBUG_DEVELOPER': ['DEBUG_DEVELOPER', '', [['lib','setuplib.php',40]], 554],
'AUTH_LOGIN_FAILED': ['AUTH_LOGIN_FAILED', '', [['lib','authlib.php',74]], 7],
'AJAX_SCRIPT': ['AJAX_SCRIPT', '', [['message','ajax.php',25],['login','token.php',24],['mod/glossary','showentry_ajax.php',2],['lib/editor/atto','autosave-ajax.php',25],['mod/forum','subscribe_ajax.php',25],['lib/editor/atto/plugins/equation','ajax.php',26],['availability/condition/date','ajax.php',25],['message/output/airnotifier','rest.php',26],['enrol/manual','ajax.php',28],['rating','rate_ajax.php',28],['enrol','ajax.php',28],['badges','backpackconnect.php',27],['grade/report/history','users_ajax.php',26],['mod/assign/feedback/editpdf','ajax.php',29],['lib/ajax','service.php',30],['','install.php',47],['mod/feedback','ajax.php',26],['badges','ajax.php',27],['mod/quiz','questionbank.ajax.php',26],['','help_ajax.php',27],['mod/quiz','autosave.ajax.php',25],['mod/chat','chat_ajax.php',17],['course','rest.php',27],['mod/lti','ajax.php',29],['badges','assertion.php',27],['repository','repository_ajax.php',27],['course','category.ajax.php',28],['lib/ajax','getnavbranch.php',28],['lib','sessionkeepalive_ajax.php',25],['mod/quiz','edit_rest.php',26],['tag','tag_autocomplete.php',25],['mod/assign/feedback/editpdf','ajax_progress.php',26],['course','dndupload.php',26],['webservice','pluginfile.php',29],['lib','setup.php',351],['question','toggleflag.php',27],['repository','draftfiles_ajax.php',27],['user/selector','search.php',25],['lib/ajax','getsiteadminbranch.php',28],['admin/tool/installaddon','permcheck.php',27],['webservice','upload.php',40],['comment','comment_ajax.php',24],['report/loglive','loglive_ajax.php',25],['lib/ajax','blocks.php',25],['course/ajax','management.php',27],['blocks/course_overview','save.php',24]], 71],
'TAG_MAX_LENGTH': ['TAG_MAX_LENGTH', '', [['lib','moodlelib.php',382]], 4],
'FEATURE_MOD_INTRO': ['FEATURE_MOD_INTRO', '', [['lib','moodlelib.php',426]], 31],
'PARAM_INTEGER': ['PARAM_INTEGER', '', [['lib','moodlelib.php',264]], 1],
'DAYSECS': ['DAYSECS', '', [['lib','moodlelib.php',49]], 68],
'VALUE_OPTIONAL': ['VALUE_OPTIONAL', '', [['lib','moodlelib.php',337]], 409],
'MOD_SUBTYPE_NO_CHILDREN': ['MOD_SUBTYPE_NO_CHILDREN', '', [['lib','moodlelib.php',452]], 5],
'PASSWORD_LOWER': ['PASSWORD_LOWER', '', [['lib','moodlelib.php',385]], 3],
'PARAM_BASE64': ['PARAM_BASE64', '', [['lib','moodlelib.php',103]], 4],
'HOURMINS': ['HOURMINS', '', [['lib','moodlelib.php',69]], 1],
'USER_CAN_IGNORE_FILE_SIZE_LIMITS': ['USER_CAN_IGNORE_FILE_SIZE_LIMITS', '', [['lib','moodlelib.php',503]], 10],
'PARAM_CLEANFILE': ['PARAM_CLEANFILE', '', [['lib','moodlelib.php',302]], 1],
'PARAM_FLOAT': ['PARAM_FLOAT', '', [['lib','moodlelib.php',146]], 93],
'MINSECS': ['MINSECS', '', [['lib','moodlelib.php',59]], 11],
'CONTEXT_MODULE': ['CONTEXT_MODULE', '', [['lib','accesslib.php',150]], 462],
'MOODLE_OFFICIAL_MOBILE_SERVICE': ['MOODLE_OFFICIAL_MOBILE_SERVICE', '', [['lib','moodlelib.php',498]], 8],
'HOURSECS': ['HOURSECS', '', [['lib','moodlelib.php',54]], 26],
'CAP_PROHIBIT': ['CAP_PROHIBIT', '', [['lib','accesslib.php',139]], 63],
'FEATURE_COMMENT': ['FEATURE_COMMENT', '', [['lib','moodlelib.php',430]], 1],
'PARAM_CLEANHTML': ['PARAM_CLEANHTML', '', [['lib','moodlelib.php',123]], 44],
'HOMEPAGE_USER': ['HOMEPAGE_USER', '', [['lib','moodlelib.php',482]], 4],
'PARAM_NUMBER': ['PARAM_NUMBER', '', [['lib','moodlelib.php',270]], 2],
'GETREMOTEADDR_SKIP_HTTP_CLIENT_IP': ['GETREMOTEADDR_SKIP_HTTP_CLIENT_IP', '', [['lib','moodlelib.php',362]], 4],
'MOD_ARCHETYPE_ASSIGNMENT': ['MOD_ARCHETYPE_ASSIGNMENT', '', [['lib','moodlelib.php',447]], 1],
'PARAM_PATH': ['PARAM_PATH', '', [['lib','moodlelib.php',178]], 173],
'PARAM_ALPHANUM': ['PARAM_ALPHANUM', '', [['lib','moodlelib.php',88]], 97],
'COURSE_DISPLAY_SINGLEPAGE': ['COURSE_DISPLAY_SINGLEPAGE', '', [['lib','moodlelib.php',508]], 10],
'AUTH_LOGIN_UNAUTHORISED': ['AUTH_LOGIN_UNAUTHORISED', '', [['lib','authlib.php',80]], 3],
'PHPUNIT_TEST': ['PHPUNIT_TEST', '', [['admin/cli','install.php',143],['','install.php',49],['lib','setup.php',247],['lib/phpunit','bootstrap.php',63]], 54],
'PAGE_COURSE_VIEW': ['PAGE_COURSE_VIEW', '', [['lib','moodlelib.php',359]], 2],
'PARAM_CLEAN': ['PARAM_CLEAN', '', [['lib','moodlelib.php',258]], 61],
'PARAM_LOCALURL': ['PARAM_LOCALURL', '', [['lib','moodlelib.php',167]], 64],
'BLOG_USER_LEVEL': ['BLOG_USER_LEVEL', '', [['lib','moodlelib.php',367]], 13],
'PASSWORD_DEFAULT': ['PASSWORD_DEFAULT', '', [['lib/password_compat/lib','password.php',20]], 4],
'SITEID': ['SITEID', '', [['admin/cli','install.php',217],['','install.php',244],['lib/db','install.php',87],['lib','setup.php',748]], 612],
'PARAM_USERNAME': ['PARAM_USERNAME', '', [['lib','moodlelib.php',245]], 55],
'MOD_ARCHETYPE_RESOURCE': ['MOD_ARCHETYPE_RESOURCE', '', [['lib','moodlelib.php',445]], 13],
'PARAM_STRINGID': ['PARAM_STRINGID', '', [['lib','moodlelib.php',250]], 27],
'MOD_ARCHETYPE_SYSTEM': ['MOD_ARCHETYPE_SYSTEM', '', [['lib','moodlelib.php',449]], 6],
'ENROL_INSTANCE_ENABLED': ['ENROL_INSTANCE_ENABLED', '', [['lib','enrollib.php',31]], 92],
'PARAM_FORMAT': ['PARAM_FORMAT', '', [['lib','moodlelib.php',284]], 1],
'COURSE_DISPLAY_MULTIPAGE': ['COURSE_DISPLAY_MULTIPAGE', '', [['lib','moodlelib.php',512]], 14],
'VALUE_REQUIRED': ['VALUE_REQUIRED', '', [['lib','moodlelib.php',332]], 32],
'PARAM_PERMISSION': ['PARAM_PERMISSION', '', [['lib','moodlelib.php',188]], 3],
'FEATURE_USES_QUESTIONS': ['FEATURE_USES_QUESTIONS', '', [['lib','moodlelib.php',440]], 6],
'PARAM_ALPHAEXT': ['PARAM_ALPHAEXT', '', [['lib','moodlelib.php',83]], 33],
'FORMAT_HTML': ['FORMAT_HTML', '', [['lib','weblib.php',47]], 999],
'FEATURE_SHOW_DESCRIPTION': ['FEATURE_SHOW_DESCRIPTION', '', [['lib','moodlelib.php',437]], 22],
'FEATURE_MOD_ARCHETYPE': ['FEATURE_MOD_ARCHETYPE', '', [['lib','moodlelib.php',424]], 13],
'NULL_NOT_ALLOWED': ['NULL_NOT_ALLOWED', '', [['lib','moodlelib.php',347]], 27],
'PARAM_SAFEDIR': ['PARAM_SAFEDIR', '', [['lib','moodlelib.php',203]], 49],
'MNET_SERVER': ['MNET_SERVER', '', [['mnet/xmlrpc','server.php',18]], 5],
'EXTERNAL_TOKEN_PERMANENT': ['EXTERNAL_TOKEN_PERMANENT', '', [['lib','moodlelib.php',461]], 11],
'PARAM_CAPABILITY': ['PARAM_CAPABILITY', '', [['lib','moodlelib.php',114]], 14],
'EXTERNAL_TOKEN_EMBEDDED': ['EXTERNAL_TOKEN_EMBEDDED', '', [['lib','moodlelib.php',469]], 6],
'WEEKSECS': ['WEEKSECS', '', [['lib','moodlelib.php',44]], 20],
'AUTH_LOGIN_LOCKOUT': ['AUTH_LOGIN_LOCKOUT', '', [['lib','authlib.php',77]], 3],
'AUTH_LOGIN_SUSPENDED': ['AUTH_LOGIN_SUSPENDED', '', [['lib','authlib.php',71]], 8],
'BLOG_GLOBAL_LEVEL': ['BLOG_GLOBAL_LEVEL', '', [['lib','moodlelib.php',371]], 15],
'PARAM_LANG': ['PARAM_LANG', '', [['lib','moodlelib.php',161]], 20],
'FEATURE_RATE': ['FEATURE_RATE', '', [['lib','moodlelib.php',432]], 10],
'HOMEPAGE_MY': ['HOMEPAGE_MY', '', [['lib','moodlelib.php',478]], 14],
'NO_MOODLE_COOKIES': ['NO_MOODLE_COOKIES', '', [['theme','javascript.php',83],['login','token.php',26],['mod/lti','service.php',27],['filter/algebra','pix.php',8],['','help.php',29],['mod/lti','services.php',27],['mod/chat/gui_header_js','chatinput.php',17],['theme','font.php',124],['user','grouppix.php',30],['grade/import/xml','fetch.php',18],['grade/export/xls','dump.php',18],['mod/data','css.php',26],['lib/editor/tinymce','all_strings.php',25],['mod/data','js.php',26],['filter/tex','pix.php',8],['theme','image.php',127],['filter/tex','displaytex.php',28],['auth/ldap','ntlmsso_magic.php',7],['','help_ajax.php',26],['rss','file.php',34],['theme','styles.php',112],['mnet/xmlrpc','server.php',16],['mod/chat/gui_sockets','chatinput.php',17],['badges','assertion.php',28],['mod/chat/gui_header_js','users.php',17],['mod/chat/gui_header_js','jsupdated.php',33],['mod/assign/feedback/editpdf','ajax_progress.php',28],['theme','styles_debug.php',29],['lib/editor/tinymce/plugins/moodleemoticon','dialog.php',25],['webservice','pluginfile.php',34],['grade/export/ods','dump.php',18],['lib','setup.php',753],['lib','setup.php',757],['lib','setup.php',762],['lib','setup.php',765],['lib','setup.php',767],['mod/chat/gui_header_js','jsupdate.php',17],['webservice','upload.php',45],['grade/export/xml','dump.php',18],['lib/editor/tinymce/plugins','loader.php',32],['lib','setuplib.php',831],['grade/export/txt','dump.php',18]], 51],
'PARAM_TEXT': ['PARAM_TEXT', '', [['lib','moodlelib.php',228]], 476],
'HUB_HUBDIRECTORYURL': ['HUB_HUBDIRECTORYURL', '', [['lib','moodlelib.php',487]], 4],
'PARAM_AUTH': ['PARAM_AUTH', '', [['lib','moodlelib.php',98]], 3],
'AUTH_PASSWORD_NOT_CACHED': ['AUTH_PASSWORD_NOT_CACHED', '', [['lib','moodlelib.php',517]], 14],
'GETREMOTEADDR_SKIP_HTTP_X_FORWARDED_FOR': ['GETREMOTEADDR_SKIP_HTTP_X_FORWARDED_FOR', '', [['lib','moodlelib.php',364]], 4],
'IGNORE_MULTIPLE': ['IGNORE_MULTIPLE', '', [['lib','dmllib.php',50]], 43],
'PARAM_COMPONENT': ['PARAM_COMPONENT', '', [['lib','moodlelib.php',310]], 94],
'PARAM_EMAIL': ['PARAM_EMAIL', '', [['lib','moodlelib.php',128]], 14],
'PARAM_TIMEZONE': ['PARAM_TIMEZONE', '', [['lib','moodlelib.php',297]], 7],
'MUST_EXIST': ['MUST_EXIST', '', [['lib','dmllib.php',52]], 1252],
'FEATURE_MODEDIT_DEFAULT_COMPLETION': ['FEATURE_MODEDIT_DEFAULT_COMPLETION', '', [['lib','moodlelib.php',428]], 3],
'FEATURE_GROUPMEMBERSONLY': ['FEATURE_GROUPMEMBERSONLY', '', [['lib','moodlelib.php',421]], 3],
'PARAM_SAFEPATH': ['PARAM_SAFEPATH', '', [['lib','moodlelib.php',208]], 9],
'PARAM_ALPHANUMEXT': ['PARAM_ALPHANUMEXT', '', [['lib','moodlelib.php',93]], 165],
'PARAM_MULTILANG': ['PARAM_MULTILANG', '', [['lib','moodlelib.php',290]], 3],
'DAYMINS': ['DAYMINS', '', [['lib','moodlelib.php',64]], 1],
'FEATURE_BACKUP_MOODLE2': ['FEATURE_BACKUP_MOODLE2', '', [['lib','moodlelib.php',434]], 34],
'HUB_MOODLEORGHUBURL': ['HUB_MOODLEORGHUBURL', '', [['lib','moodlelib.php',493]], 18],
'PARAM_ACTION': ['PARAM_ACTION', '', [['lib','moodlelib.php',277]], 1],
'PARAM_NOTAGS': ['PARAM_NOTAGS', '', [['lib','moodlelib.php',172]], 176],
'USER_KEY_LOGIN': ['USER_KEY_LOGIN', '', [['lib','moodlelib.php',3009]], 3],
'PARAM_PLUGIN': ['PARAM_PLUGIN', '', [['lib','moodlelib.php',324]], 118],
'PARAM_PEM': ['PARAM_PEM', '', [['lib','moodlelib.php',183]], 8],
'HOMEPAGE_SITE': ['HOMEPAGE_SITE', '', [['lib','moodlelib.php',474]], 7],
'PASSWORD_DIGITS': ['PASSWORD_DIGITS', '', [['lib','moodlelib.php',387]], 4],
'PARAM_TAGLIST': ['PARAM_TAGLIST', '', [['lib','moodlelib.php',223]], 7],
'BEHAT_SITE_RUNNING': ['BEHAT_SITE_RUNNING', '', [['lib','setup.php',131]], 15],
'MOD_ARCHETYPE_OTHER': ['MOD_ARCHETYPE_OTHER', '', [['lib','moodlelib.php',443]], 5],
'CONTEXT_COURSE': ['CONTEXT_COURSE', '', [['lib','accesslib.php',148]], 422],
'CAP_PREVENT': ['CAP_PREVENT', '', [['lib','accesslib.php',137]], 40],
'DEBUG_NORMAL': ['DEBUG_NORMAL', '', [['lib','setuplib.php',36]], 22],
'PARAM_FILE': ['PARAM_FILE', '', [['lib','moodlelib.php',133]], 122],
'PARAM_THEME': ['PARAM_THEME', '', [['lib','moodlelib.php',233]], 8],
'DEBUG_ALL': ['DEBUG_ALL', '', [['lib','setuplib.php',38]], 17],
'PARAM_SEQUENCE': ['PARAM_SEQUENCE', '', [['lib','moodlelib.php',213]], 31],
'PARAM_RAW': ['PARAM_RAW', '', [['lib','moodlelib.php',193]], 692],
'ENROL_MAX_TIMESTAMP': ['ENROL_MAX_TIMESTAMP', '', [['lib','enrollib.php',46]], 6],
'PASSWORD_UPPER': ['PASSWORD_UPPER', '', [['lib','moodlelib.php',386]], 3],
'PARAM_TAG': ['PARAM_TAG', '', [['lib','moodlelib.php',218]], 18],
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',138],['','install.php',93],['lib','setup.php',386]], 3532],
'CAP_ALLOW': ['CAP_ALLOW', '', [['lib','accesslib.php',135]], 1292],
'PASSWORD_NONALPHANUM': ['PASSWORD_NONALPHANUM', '', [['lib','moodlelib.php',388]], 3],
'BLOG_GROUP_LEVEL': ['BLOG_GROUP_LEVEL', '', [['lib','moodlelib.php',368]], 1],
'PARAM_BOOL': ['PARAM_BOOL', '', [['lib','moodlelib.php',108]], 502],
'PARAM_AREA': ['PARAM_AREA', '', [['lib','moodlelib.php',317]], 45],
'CAP_INHERIT': ['CAP_INHERIT', '', [['lib','accesslib.php',133]], 35],
'NULL_ALLOWED': ['NULL_ALLOWED', '', [['lib','moodlelib.php',352]], 15],
'CONTEXT_USER': ['CONTEXT_USER', '', [['lib','accesslib.php',144]], 95],
'PARAM_HOST': ['PARAM_HOST', '', [['lib','moodlelib.php',151]], 7],
'CLI_SCRIPT': ['CLI_SCRIPT', '', [['auth/ldap/cli','sync_users.php',49],['admin/tool/behat/cli','init.php',36],['auth/db/cli','sync_users.php',45],['admin/cli','mysql_collation.php',25],['admin/cli','cron.php',31],['admin/tool/behat/cli','util_single_run.php',90],['repository/boxnet/cli','migrationv1.php',25],['admin/cli','install.php',32],['enrol/self/cli','sync.php',31],['enrol/flatfile/cli','sync.php',30],['enrol/meta/cli','sync.php',31],['admin/cli','fix_deleted_users.php',26],['','mdeploy.php',65],['admin/cli','check_database_schema.php',26],['admin/tool/dbtransfer/cli','migrate.php',30],['enrol/paypal/cli','sync.php',30],['admin/tool/behat/cli','util.php',34],['admin/tool/replace/cli','replace.php',25],['','install.php',46],['mod/chat','chatd.php',25],['admin/tool/generator/cli','maketestsite.php',25],['enrol/database/cli','sync.php',34],['enrol/manual/cli','sync.php',30],['admin','cron.php',47],['admin/cli','mysql_engine.php',27],['admin/tool/generator/cli','maketestcourse.php',25],['admin/cli','upgrade.php',38],['admin/cli','reset_password.php',27],['admin/cli','maintenance.php',26],['admin/cli','install_database.php',31],['lib/editor/tinymce/cli','update_lang_files.php',25],['theme/base/cli','svgtool.php',26],['admin/cli','automated_backups.php',29],['admin/cli','mysql_compressed_rows.php',26],['admin/cli','backup.php',26],['admin/tool/behat/cli','run.php',30],['admin/tool/task/cli','schedule_task.php',25],['enrol/ldap/cli','sync.php',43],['lib/filestorage/tests/fixtures','zip_info.php',25],['auth/cas/cli','sync_users.php',45],['lib','setup.php',289],['admin/cli','alternative_component_cache.php',30],['enrol/category/cli','sync.php',33],['lib/phpunit','bootstrap.php',73],['lib/tests/behat','behat_hooks.php',115],['admin/cli','fix_course_sequence.php',26],['admin/cli','purge_caches.php',24],['admin/tool/generator/cli','maketestplan.php',25],['lib/filestorage/tests/fixtures','zip_create_test_file.php',25],['enrol/cohort/cli','sync.php',31],['admin/tool/uploadcourse/cli','uploadcourse.php',25]], 109],
'AUTH_LOGIN_OK': ['AUTH_LOGIN_OK', '', [['lib','authlib.php',65]], 4],
'BLOG_SITE_LEVEL': ['BLOG_SITE_LEVEL', '', [['lib','moodlelib.php',370]], 17],
'VALUE_DEFAULT': ['VALUE_DEFAULT', '', [['lib','moodlelib.php',342]], 129]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu May 28 19:17:31 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
