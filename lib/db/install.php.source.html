<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /lib/db/install.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Aug 11 10:00:09 2016 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='lib/db';
filename='install.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/lib/db/</a> -> <a href="install.php.html">install.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="install.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="install.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * This file is executed right after the install.xml</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * For more information, take a look to the documentation available:</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> *     - Upgrade API: {@link http://docs.moodle.org/dev/Upgrade_API}</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> *</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * @package   core_install</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> * @category  upgrade</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment"> * @copyright 2009 Petr Skoda (http://skodak.org)</span>
<a name="l26"><span class="linenum">  26</span></a>  <span class="comment"> * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment"> */</span>
<a name="l28"><span class="linenum">  28</span></a>  
<a name="l29"><span class="linenum">  29</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die();
<a name="l30"><span class="linenum">  30</span></a>  
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment">/**</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> * Main post-install tasks to be executed after the BD schema is available</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> *</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> * This function is automatically executed after Moodle core DB has been</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> * created at initial install. It's in charge of perform the initial tasks</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment"> * not covered by the {@link install.xml} file, like create initial users,</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment"> * roles, templates, moving stuff from other plugins...</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment"> *</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="comment"> * Note that the function is only invoked once, at install time, so if new tasks</span>
<a name="l40"><span class="linenum">  40</span></a>  <span class="comment"> * are needed in the future, they will need to be added both here (for new sites)</span>
<a name="l41"><span class="linenum">  41</span></a>  <span class="comment"> * and in the corresponding {@link upgrade.php} file (for existing sites).</span>
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment"> *</span>
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment"> * All plugins within Moodle (modules, blocks, reports...) support the existence of</span>
<a name="l44"><span class="linenum">  44</span></a>  <span class="comment"> * their own install.php file, using the &quot;Frankenstyle&quot; component name as</span>
<a name="l45"><span class="linenum">  45</span></a>  <span class="comment"> * defined at {@link http://docs.moodle.org/dev/Frankenstyle}, for example:</span>
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment"> *     - {@link xmldb_page_install()}. (modules don't require the plugintype (&quot;mod_&quot;) to be used.</span>
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment"> *     - {@link xmldb_enrol_meta_install()}.</span>
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment"> *     - {@link xmldb_workshopform_accumulative_install()}.</span>
<a name="l49"><span class="linenum">  49</span></a>  <span class="comment"> *     - ....</span>
<a name="l50"><span class="linenum">  50</span></a>  <span class="comment"> *</span>
<a name="l51"><span class="linenum">  51</span></a>  <span class="comment"> * Finally, note that it's also supported to have one uninstall.php file that is</span>
<a name="l52"><span class="linenum">  52</span></a>  <span class="comment"> * executed also once, each time one plugin is uninstalled (before the DB schema is</span>
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment"> * deleted). Those uninstall files will contain one function, using the &quot;Frankenstyle&quot;</span>
<a name="l54"><span class="linenum">  54</span></a>  <span class="comment"> * naming conventions, like {@link xmldb_enrol_meta_uninstall()} or {@link xmldb_workshop_uninstall()}.</span>
<a name="l55"><span class="linenum">  55</span></a>  <span class="comment"> */</span>
<a name="l56"><span class="linenum">  56</span></a>  function <a class="function" onClick="logFunction('xmldb_main_install')" href="../../_functions/xmldb_main_install.html" onMouseOver="funcPopup(event,'xmldb_main_install')">xmldb_main_install</a>() {
<a name="l57"><span class="linenum">  57</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it940" onMouseOver="hilite(940)" onMouseOut="lolite()" onClick="logVariable('SITE')" href="../../_variables/SITE.html">$SITE</a>, <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>;
<a name="l58"><span class="linenum">  58</span></a>  
<a name="l59"><span class="linenum">  59</span></a>  <span class="comment">    // Make sure system context exists</span>
<a name="l60"><span class="linenum">  60</span></a>      <a class="var it832" onMouseOver="hilite(832)" onMouseOut="lolite()" onClick="logVariable('syscontext')" href="../../_variables/syscontext.html">$syscontext</a> = <a class="class" onClick="logClass('context_system')" href="../../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(0, <a class="constant" onClick="logConstant('MUST_EXIST')" href="../../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>, false);
<a name="l61"><span class="linenum">  61</span></a>      if (<a class="var it832" onMouseOver="hilite(832)" onMouseOut="lolite()" onClick="logVariable('syscontext')" href="../../_variables/syscontext.html">$syscontext</a>-&gt;<a onClick="logVariable('id')" class="var it43085" onMouseOver="hilite(43085)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> != <a class="constant" onClick="logConstant('SYSCONTEXTID')" href="../../_constants/SYSCONTEXTID.html" onMouseOver="constPopup(event,'SYSCONTEXTID')">SYSCONTEXTID</a>) {
<a name="l62"><span class="linenum">  62</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('generalexceptionmessage', 'error', '', 'Unexpected new system context id!');
<a name="l63"><span class="linenum">  63</span></a>      }
<a name="l64"><span class="linenum">  64</span></a>  
<a name="l65"><span class="linenum">  65</span></a>  
<a name="l66"><span class="linenum">  66</span></a>  <span class="comment">    // Create site course</span>
<a name="l67"><span class="linenum">  67</span></a>      if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('record_exists')" href="../../_functions/record_exists.html" onMouseOver="funcPopup(event,'record_exists')">record_exists</a>('course', array())) {
<a name="l68"><span class="linenum">  68</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('generalexceptionmessage', 'error', '', 'Can not create frontpage course, courses already exist.');
<a name="l69"><span class="linenum">  69</span></a>      }
<a name="l70"><span class="linenum">  70</span></a>      <a class="var it21536" onMouseOver="hilite(21536)" onMouseOut="lolite()" onClick="logVariable('newsite')" href="../../_variables/newsite.html">$newsite</a> = new stdClass();
<a name="l71"><span class="linenum">  71</span></a>      <a class="var it21536" onMouseOver="hilite(21536)" onMouseOut="lolite()" onClick="logVariable('newsite')" href="../../_variables/newsite.html">$newsite</a>-&gt;<a onClick="logVariable('fullname')" class="var it43836" onMouseOver="hilite(43836)" onMouseOut="lolite()" href="../../_variables/fullname.html">fullname</a>     = '';
<a name="l72"><span class="linenum">  72</span></a>      <a class="var it21536" onMouseOver="hilite(21536)" onMouseOut="lolite()" onClick="logVariable('newsite')" href="../../_variables/newsite.html">$newsite</a>-&gt;<a onClick="logVariable('shortname')" class="var it43836" onMouseOver="hilite(43836)" onMouseOut="lolite()" href="../../_variables/shortname.html">shortname</a>    = '';
<a name="l73"><span class="linenum">  73</span></a>      <a class="var it21536" onMouseOver="hilite(21536)" onMouseOut="lolite()" onClick="logVariable('newsite')" href="../../_variables/newsite.html">$newsite</a>-&gt;<a onClick="logVariable('summary')" class="var it43836" onMouseOver="hilite(43836)" onMouseOut="lolite()" href="../../_variables/summary.html">summary</a>      = NULL;
<a name="l74"><span class="linenum">  74</span></a>      <a class="var it21536" onMouseOver="hilite(21536)" onMouseOut="lolite()" onClick="logVariable('newsite')" href="../../_variables/newsite.html">$newsite</a>-&gt;<a onClick="logVariable('newsitems')" class="var it43836" onMouseOver="hilite(43836)" onMouseOut="lolite()" href="../../_variables/newsitems.html">newsitems</a>    = 3;
<a name="l75"><span class="linenum">  75</span></a>      <a class="var it21536" onMouseOver="hilite(21536)" onMouseOut="lolite()" onClick="logVariable('newsite')" href="../../_variables/newsite.html">$newsite</a>-&gt;<a onClick="logVariable('numsections')" class="var it43836" onMouseOver="hilite(43836)" onMouseOut="lolite()" href="../../_variables/numsections.html">numsections</a>  = 1;
<a name="l76"><span class="linenum">  76</span></a>      <a class="var it21536" onMouseOver="hilite(21536)" onMouseOut="lolite()" onClick="logVariable('newsite')" href="../../_variables/newsite.html">$newsite</a>-&gt;<a onClick="logVariable('category')" class="var it43836" onMouseOver="hilite(43836)" onMouseOut="lolite()" href="../../_variables/category.html">category</a>     = 0;
<a name="l77"><span class="linenum">  77</span></a>      <a class="var it21536" onMouseOver="hilite(21536)" onMouseOut="lolite()" onClick="logVariable('newsite')" href="../../_variables/newsite.html">$newsite</a>-&gt;<a onClick="logVariable('format')" class="var it43836" onMouseOver="hilite(43836)" onMouseOut="lolite()" href="../../_variables/format.html">format</a>       = 'site';  <span class="comment">// Only for this course</span>
<a name="l78"><span class="linenum">  78</span></a>      <a class="var it21536" onMouseOver="hilite(21536)" onMouseOut="lolite()" onClick="logVariable('newsite')" href="../../_variables/newsite.html">$newsite</a>-&gt;<a onClick="logVariable('timecreated')" class="var it43836" onMouseOver="hilite(43836)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a>  = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l79"><span class="linenum">  79</span></a>      <a class="var it21536" onMouseOver="hilite(21536)" onMouseOut="lolite()" onClick="logVariable('newsite')" href="../../_variables/newsite.html">$newsite</a>-&gt;<a onClick="logVariable('timemodified')" class="var it43836" onMouseOver="hilite(43836)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="var it21536" onMouseOver="hilite(21536)" onMouseOut="lolite()" onClick="logVariable('newsite')" href="../../_variables/newsite.html">$newsite</a>-&gt;<a onClick="logVariable('timecreated')" class="var it43836" onMouseOver="hilite(43836)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a>;
<a name="l80"><span class="linenum">  80</span></a>  
<a name="l81"><span class="linenum">  81</span></a>      if (<a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('SITEID')" href="../../_constants/SITEID.html" onMouseOver="constPopup(event,'SITEID')">SITEID</a>')) {
<a name="l82"><span class="linenum">  82</span></a>          <a class="var it21536" onMouseOver="hilite(21536)" onMouseOut="lolite()" onClick="logVariable('newsite')" href="../../_variables/newsite.html">$newsite</a>-&gt;<a onClick="logVariable('id')" class="var it43836" onMouseOver="hilite(43836)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="constant" onClick="logConstant('SITEID')" href="../../_constants/SITEID.html" onMouseOver="constPopup(event,'SITEID')">SITEID</a>;
<a name="l83"><span class="linenum">  83</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('import_record')" href="../../_functions/import_record.html" onMouseOver="funcPopup(event,'import_record')">import_record</a>('course', <a class="var it21536" onMouseOver="hilite(21536)" onMouseOut="lolite()" onClick="logVariable('newsite')" href="../../_variables/newsite.html">$newsite</a>);
<a name="l84"><span class="linenum">  84</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_manager')" href="../../_functions/get_manager.html" onMouseOver="funcPopup(event,'get_manager')">get_manager</a>()-&gt;<a class="function" onClick="logFunction('reset_sequence')" href="../../_functions/reset_sequence.html" onMouseOver="funcPopup(event,'reset_sequence')">reset_sequence</a>('course');
<a name="l85"><span class="linenum">  85</span></a>      } else {
<a name="l86"><span class="linenum">  86</span></a>          <a class="var it21536" onMouseOver="hilite(21536)" onMouseOut="lolite()" onClick="logVariable('newsite')" href="../../_variables/newsite.html">$newsite</a>-&gt;<a onClick="logVariable('id')" class="var it43836" onMouseOver="hilite(43836)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('course', <a class="var it21536" onMouseOver="hilite(21536)" onMouseOut="lolite()" onClick="logVariable('newsite')" href="../../_variables/newsite.html">$newsite</a>);
<a name="l87"><span class="linenum">  87</span></a>          <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SITEID')" href="../../_constants/SITEID.html" onMouseOver="constPopup(event,'SITEID')">SITEID</a>', <a class="var it21536" onMouseOver="hilite(21536)" onMouseOut="lolite()" onClick="logVariable('newsite')" href="../../_variables/newsite.html">$newsite</a>-&gt;<a onClick="logVariable('id')" class="var it43836" onMouseOver="hilite(43836)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l88"><span class="linenum">  88</span></a>      }
<a name="l89"><span class="linenum">  89</span></a>  <span class="comment">    // set the field 'numsections'. We can not use format_site::update_format_options() because</span>
<a name="l90"><span class="linenum">  90</span></a>  <span class="comment">    // the file is not loaded</span>
<a name="l91"><span class="linenum">  91</span></a>      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('course_format_options', array('courseid' =&gt; <a class="constant" onClick="logConstant('SITEID')" href="../../_constants/SITEID.html" onMouseOver="constPopup(event,'SITEID')">SITEID</a>, 'format' =&gt; 'site',
<a name="l92"><span class="linenum">  92</span></a>          'sectionid' =&gt; 0, 'name' =&gt; 'numsections', 'value' =&gt; <a class="var it21536" onMouseOver="hilite(21536)" onMouseOut="lolite()" onClick="logVariable('newsite')" href="../../_variables/newsite.html">$newsite</a>-&gt;<a onClick="logVariable('numsections')" class="var it43836" onMouseOver="hilite(43836)" onMouseOut="lolite()" href="../../_variables/numsections.html">numsections</a>));
<a name="l93"><span class="linenum">  93</span></a>      <a class="var it940" onMouseOver="hilite(940)" onMouseOut="lolite()" onClick="logVariable('SITE')" href="../../_variables/SITE.html">$SITE</a> = <a class="function" onClick="logFunction('get_site')" href="../../_functions/get_site.html" onMouseOver="funcPopup(event,'get_site')">get_site</a>();
<a name="l94"><span class="linenum">  94</span></a>      if (<a class="var it21536" onMouseOver="hilite(21536)" onMouseOut="lolite()" onClick="logVariable('newsite')" href="../../_variables/newsite.html">$newsite</a>-&gt;<a onClick="logVariable('id')" class="var it43836" onMouseOver="hilite(43836)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> != <a class="var it940" onMouseOver="hilite(940)" onMouseOut="lolite()" onClick="logVariable('SITE')" href="../../_variables/SITE.html">$SITE</a>-&gt;<a onClick="logVariable('id')" class="var it43008" onMouseOver="hilite(43008)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>) {
<a name="l95"><span class="linenum">  95</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('generalexceptionmessage', 'error', '', 'Unexpected new site course id!');
<a name="l96"><span class="linenum">  96</span></a>      }
<a name="l97"><span class="linenum">  97</span></a>  <span class="comment">    // Make sure site course context exists</span>
<a name="l98"><span class="linenum">  98</span></a>      <a class="class" onClick="logClass('context_course')" href="../../_classes/context_course.html" onMouseOver="classPopup(event,'context_course')">context_course</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it940" onMouseOver="hilite(940)" onMouseOut="lolite()" onClick="logVariable('SITE')" href="../../_variables/SITE.html">$SITE</a>-&gt;<a onClick="logVariable('id')" class="var it43008" onMouseOver="hilite(43008)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l99"><span class="linenum">  99</span></a>  <span class="comment">    // Update the global frontpage cache</span>
<a name="l100"><span class="linenum"> 100</span></a>      <a class="var it940" onMouseOver="hilite(940)" onMouseOut="lolite()" onClick="logVariable('SITE')" href="../../_variables/SITE.html">$SITE</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('course', array('id'=&gt;<a class="var it21536" onMouseOver="hilite(21536)" onMouseOut="lolite()" onClick="logVariable('newsite')" href="../../_variables/newsite.html">$newsite</a>-&gt;<a onClick="logVariable('id')" class="var it43836" onMouseOver="hilite(43836)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>), '*', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l101"><span class="linenum"> 101</span></a>  
<a name="l102"><span class="linenum"> 102</span></a>  
<a name="l103"><span class="linenum"> 103</span></a>  <span class="comment">    // Create default course category</span>
<a name="l104"><span class="linenum"> 104</span></a>      if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('record_exists')" href="../../_functions/record_exists.html" onMouseOver="funcPopup(event,'record_exists')">record_exists</a>('course_categories', array())) {
<a name="l105"><span class="linenum"> 105</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('generalexceptionmessage', 'error', '', 'Can not create default course category, categories already exist.');
<a name="l106"><span class="linenum"> 106</span></a>      }
<a name="l107"><span class="linenum"> 107</span></a>      <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a> = new stdClass();
<a name="l108"><span class="linenum"> 108</span></a>      <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a>-&gt;<a onClick="logVariable('name')" class="var it43105" onMouseOver="hilite(43105)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>         = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('miscellaneous');
<a name="l109"><span class="linenum"> 109</span></a>      <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a>-&gt;<a onClick="logVariable('depth')" class="var it43105" onMouseOver="hilite(43105)" onMouseOut="lolite()" href="../../_variables/depth.html">depth</a>        = 1;
<a name="l110"><span class="linenum"> 110</span></a>      <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a>-&gt;<a onClick="logVariable('sortorder')" class="var it43105" onMouseOver="hilite(43105)" onMouseOut="lolite()" href="../../_variables/sortorder.html">sortorder</a>    = <a class="constant" onClick="logConstant('MAX_COURSES_IN_CATEGORY')" href="../../_constants/MAX_COURSES_IN_CATEGORY.html" onMouseOver="constPopup(event,'MAX_COURSES_IN_CATEGORY')">MAX_COURSES_IN_CATEGORY</a>;
<a name="l111"><span class="linenum"> 111</span></a>      <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a>-&gt;<a onClick="logVariable('timemodified')" class="var it43105" onMouseOver="hilite(43105)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l112"><span class="linenum"> 112</span></a>      <a class="var it2604" onMouseOver="hilite(2604)" onMouseOut="lolite()" onClick="logVariable('catid')" href="../../_variables/catid.html">$catid</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('course_categories', <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a>);
<a name="l113"><span class="linenum"> 113</span></a>      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('course_categories', 'path', '/'.<a class="var it2604" onMouseOver="hilite(2604)" onMouseOut="lolite()" onClick="logVariable('catid')" href="../../_variables/catid.html">$catid</a>, array('id'=&gt;<a class="var it2604" onMouseOver="hilite(2604)" onMouseOut="lolite()" onClick="logVariable('catid')" href="../../_variables/catid.html">$catid</a>));
<a name="l114"><span class="linenum"> 114</span></a>  <span class="comment">    // Make sure category context exists</span>
<a name="l115"><span class="linenum"> 115</span></a>      <a class="class" onClick="logClass('context_coursecat')" href="../../_classes/context_coursecat.html" onMouseOver="classPopup(event,'context_coursecat')">context_coursecat</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it2604" onMouseOver="hilite(2604)" onMouseOut="lolite()" onClick="logVariable('catid')" href="../../_variables/catid.html">$catid</a>);
<a name="l116"><span class="linenum"> 116</span></a>  
<a name="l117"><span class="linenum"> 117</span></a>  
<a name="l118"><span class="linenum"> 118</span></a>      <a class="var it722" onMouseOver="hilite(722)" onMouseOut="lolite()" onClick="logVariable('defaults')" href="../../_variables/defaults.html">$defaults</a> = array(
<a name="l119"><span class="linenum"> 119</span></a>          'rolesactive'           =&gt; '0', // marks fully set up system
<a name="l120"><span class="linenum"> 120</span></a>          'auth'                  =&gt; 'email',
<a name="l121"><span class="linenum"> 121</span></a>          'auth_pop3mailbox'      =&gt; 'INBOX',
<a name="l122"><span class="linenum"> 122</span></a>          'enrol_plugins_enabled' =&gt; 'manual,guest,self,cohort',
<a name="l123"><span class="linenum"> 123</span></a>          'theme'                 =&gt; <a class="class" onClick="logClass('theme_config')" href="../../_classes/theme_config.html" onMouseOver="classPopup(event,'theme_config')">theme_config</a>::DEFAULT_THEME,
<a name="l124"><span class="linenum"> 124</span></a>          'filter_multilang_converted' =&gt; 1,
<a name="l125"><span class="linenum"> 125</span></a>          'siteidentifier'        =&gt; <a class="function" onClick="logFunction('random_string')" href="../../_functions/random_string.html" onMouseOver="funcPopup(event,'random_string')">random_string</a>(32).<a class="function" onClick="logFunction('get_host_from_url')" href="../../_functions/get_host_from_url.html" onMouseOver="funcPopup(event,'get_host_from_url')">get_host_from_url</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>),
<a name="l126"><span class="linenum"> 126</span></a>          'backup_version'        =&gt; 2008111700,
<a name="l127"><span class="linenum"> 127</span></a>          'backup_release'        =&gt; '2.0 dev',
<a name="l128"><span class="linenum"> 128</span></a>          'mnet_dispatcher_mode'  =&gt; 'off',
<a name="l129"><span class="linenum"> 129</span></a>          'sessiontimeout'        =&gt; 7200, // must be present during roles installation
<a name="l130"><span class="linenum"> 130</span></a>          'stringfilters'         =&gt; '', // These two are managed in a strange way by the filters
<a name="l131"><span class="linenum"> 131</span></a>          'filterall'             =&gt; 0, // setting page, so have to be initialised here.
<a name="l132"><span class="linenum"> 132</span></a>          'texteditors'           =&gt; 'atto,tinymce,textarea',
<a name="l133"><span class="linenum"> 133</span></a>          'antiviruses'           =&gt; '',
<a name="l134"><span class="linenum"> 134</span></a>          'upgrade_minmaxgradestepignored' =&gt; 1, // New installs should not run this upgrade step.
<a name="l135"><span class="linenum"> 135</span></a>          'upgrade_extracreditweightsstepignored' =&gt; 1, // New installs should not run this upgrade step.
<a name="l136"><span class="linenum"> 136</span></a>          'upgrade_calculatedgradeitemsignored' =&gt; 1, // New installs should not run this upgrade step.
<a name="l137"><span class="linenum"> 137</span></a>          'upgrade_letterboundarycourses' =&gt; 1, // New installs should not run this upgrade step.
<a name="l138"><span class="linenum"> 138</span></a>      );
<a name="l139"><span class="linenum"> 139</span></a>      foreach(<a class="var it722" onMouseOver="hilite(722)" onMouseOut="lolite()" onClick="logVariable('defaults')" href="../../_variables/defaults.html">$defaults</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l140"><span class="linenum"> 140</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>(<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>, <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>);
<a name="l141"><span class="linenum"> 141</span></a>      }
<a name="l142"><span class="linenum"> 142</span></a>  
<a name="l143"><span class="linenum"> 143</span></a>  
<a name="l144"><span class="linenum"> 144</span></a>  <span class="comment">    // Bootstrap mnet</span>
<a name="l145"><span class="linenum"> 145</span></a>      <a class="var it2359" onMouseOver="hilite(2359)" onMouseOut="lolite()" onClick="logVariable('mnethost')" href="../../_variables/mnethost.html">$mnethost</a> = new stdClass();
<a name="l146"><span class="linenum"> 146</span></a>      <a class="var it2359" onMouseOver="hilite(2359)" onMouseOut="lolite()" onClick="logVariable('mnethost')" href="../../_variables/mnethost.html">$mnethost</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it43837" onMouseOver="hilite(43837)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>    = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>;
<a name="l147"><span class="linenum"> 147</span></a>      <a class="var it2359" onMouseOver="hilite(2359)" onMouseOut="lolite()" onClick="logVariable('mnethost')" href="../../_variables/mnethost.html">$mnethost</a>-&gt;<a onClick="logVariable('name')" class="var it43837" onMouseOver="hilite(43837)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>       = '';
<a name="l148"><span class="linenum"> 148</span></a>      <a class="var it2359" onMouseOver="hilite(2359)" onMouseOut="lolite()" onClick="logVariable('mnethost')" href="../../_variables/mnethost.html">$mnethost</a>-&gt;<a onClick="logVariable('name')" class="var it43837" onMouseOver="hilite(43837)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>       = '';
<a name="l149"><span class="linenum"> 149</span></a>      <a class="var it2359" onMouseOver="hilite(2359)" onMouseOut="lolite()" onClick="logVariable('mnethost')" href="../../_variables/mnethost.html">$mnethost</a>-&gt;<a onClick="logVariable('public_key')" class="var it43837" onMouseOver="hilite(43837)" onMouseOut="lolite()" href="../../_variables/public_key.html">public_key</a> = '';
<a name="l150"><span class="linenum"> 150</span></a>  
<a name="l151"><span class="linenum"> 151</span></a>      if (empty(<a class="var it836" onMouseOver="hilite(836)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['SERVER_ADDR'])) {
<a name="l152"><span class="linenum"> 152</span></a>  <span class="comment">        // SERVER_ADDR is only returned by Apache-like webservers</span>
<a name="l153"><span class="linenum"> 153</span></a>          <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>(&quot;@^(?:http[s]?://)?([A-Z0-9\-\.]+).*@i&quot;, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>, <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>);
<a name="l154"><span class="linenum"> 154</span></a>          <a class="var it27424" onMouseOver="hilite(27424)" onMouseOut="lolite()" onClick="logVariable('my_hostname')" href="../../_variables/my_hostname.html">$my_hostname</a> = <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l155"><span class="linenum"> 155</span></a>          <a class="var it27425" onMouseOver="hilite(27425)" onMouseOut="lolite()" onClick="logVariable('my_ip')" href="../../_variables/my_ip.html">$my_ip</a>       = <a class="phpfunction" onClick="logFunction('gethostbyname')" href="../../_functions/gethostbyname.html" onMouseOver="phpfuncPopup(event,'gethostbyname')">gethostbyname</a>(<a class="var it27424" onMouseOver="hilite(27424)" onMouseOut="lolite()" onClick="logVariable('my_hostname')" href="../../_variables/my_hostname.html">$my_hostname</a>);  <span class="comment">// Returns unmodified hostname on failure. DOH!</span>
<a name="l156"><span class="linenum"> 156</span></a>          if (<a class="var it27425" onMouseOver="hilite(27425)" onMouseOut="lolite()" onClick="logVariable('my_ip')" href="../../_variables/my_ip.html">$my_ip</a> == <a class="var it27424" onMouseOver="hilite(27424)" onMouseOut="lolite()" onClick="logVariable('my_hostname')" href="../../_variables/my_hostname.html">$my_hostname</a>) {
<a name="l157"><span class="linenum"> 157</span></a>              <a class="var it2359" onMouseOver="hilite(2359)" onMouseOut="lolite()" onClick="logVariable('mnethost')" href="../../_variables/mnethost.html">$mnethost</a>-&gt;<a onClick="logVariable('ip_address')" class="var it43837" onMouseOver="hilite(43837)" onMouseOut="lolite()" href="../../_variables/ip_address.html">ip_address</a> = 'UNKNOWN';
<a name="l158"><span class="linenum"> 158</span></a>          } else {
<a name="l159"><span class="linenum"> 159</span></a>              <a class="var it2359" onMouseOver="hilite(2359)" onMouseOut="lolite()" onClick="logVariable('mnethost')" href="../../_variables/mnethost.html">$mnethost</a>-&gt;<a onClick="logVariable('ip_address')" class="var it43837" onMouseOver="hilite(43837)" onMouseOut="lolite()" href="../../_variables/ip_address.html">ip_address</a> = <a class="var it27425" onMouseOver="hilite(27425)" onMouseOut="lolite()" onClick="logVariable('my_ip')" href="../../_variables/my_ip.html">$my_ip</a>;
<a name="l160"><span class="linenum"> 160</span></a>          }
<a name="l161"><span class="linenum"> 161</span></a>      } else {
<a name="l162"><span class="linenum"> 162</span></a>          <a class="var it2359" onMouseOver="hilite(2359)" onMouseOut="lolite()" onClick="logVariable('mnethost')" href="../../_variables/mnethost.html">$mnethost</a>-&gt;<a onClick="logVariable('ip_address')" class="var it43837" onMouseOver="hilite(43837)" onMouseOut="lolite()" href="../../_variables/ip_address.html">ip_address</a> = <a class="var it836" onMouseOver="hilite(836)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['SERVER_ADDR'];
<a name="l163"><span class="linenum"> 163</span></a>      }
<a name="l164"><span class="linenum"> 164</span></a>  
<a name="l165"><span class="linenum"> 165</span></a>      <a class="var it27426" onMouseOver="hilite(27426)" onMouseOut="lolite()" onClick="logVariable('mnetid')" href="../../_variables/mnetid.html">$mnetid</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('mnet_host', <a class="var it2359" onMouseOver="hilite(2359)" onMouseOut="lolite()" onClick="logVariable('mnethost')" href="../../_variables/mnethost.html">$mnethost</a>);
<a name="l166"><span class="linenum"> 166</span></a>      <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('mnet_localhost_id', <a class="var it27426" onMouseOver="hilite(27426)" onMouseOut="lolite()" onClick="logVariable('mnetid')" href="../../_variables/mnetid.html">$mnetid</a>);
<a name="l167"><span class="linenum"> 167</span></a>  
<a name="l168"><span class="linenum"> 168</span></a>  <span class="comment">    // Initial insert of mnet applications info</span>
<a name="l169"><span class="linenum"> 169</span></a>      <a class="var it27427" onMouseOver="hilite(27427)" onMouseOut="lolite()" onClick="logVariable('mnet_app')" href="../../_variables/mnet_app.html">$mnet_app</a> = new stdClass();
<a name="l170"><span class="linenum"> 170</span></a>      <a class="var it27427" onMouseOver="hilite(27427)" onMouseOut="lolite()" onClick="logVariable('mnet_app')" href="../../_variables/mnet_app.html">$mnet_app</a>-&gt;<a onClick="logVariable('name')" class="var it43838" onMouseOver="hilite(43838)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>              = 'moodle';
<a name="l171"><span class="linenum"> 171</span></a>      <a class="var it27427" onMouseOver="hilite(27427)" onMouseOut="lolite()" onClick="logVariable('mnet_app')" href="../../_variables/mnet_app.html">$mnet_app</a>-&gt;<a onClick="logVariable('display_name')" class="var it43838" onMouseOver="hilite(43838)" onMouseOut="lolite()" href="../../_variables/display_name.html">display_name</a>      = 'Moodle';
<a name="l172"><span class="linenum"> 172</span></a>      <a class="var it27427" onMouseOver="hilite(27427)" onMouseOut="lolite()" onClick="logVariable('mnet_app')" href="../../_variables/mnet_app.html">$mnet_app</a>-&gt;<a onClick="logVariable('xmlrpc_server_url')" class="var it43838" onMouseOver="hilite(43838)" onMouseOut="lolite()" href="../../_variables/xmlrpc_server_url.html">xmlrpc_server_url</a> = '<a class="filename" href="../../mnet/xmlrpc/server.php.html">/mnet/xmlrpc/server.php</a>';
<a name="l173"><span class="linenum"> 173</span></a>      <a class="var it27427" onMouseOver="hilite(27427)" onMouseOut="lolite()" onClick="logVariable('mnet_app')" href="../../_variables/mnet_app.html">$mnet_app</a>-&gt;<a onClick="logVariable('sso_land_url')" class="var it43838" onMouseOver="hilite(43838)" onMouseOut="lolite()" href="../../_variables/sso_land_url.html">sso_land_url</a>      = '<a class="filename" href="../../auth/mnet/land.php.html">/auth/mnet/land.php</a>';
<a name="l174"><span class="linenum"> 174</span></a>      <a class="var it27427" onMouseOver="hilite(27427)" onMouseOut="lolite()" onClick="logVariable('mnet_app')" href="../../_variables/mnet_app.html">$mnet_app</a>-&gt;<a onClick="logVariable('sso_jump_url')" class="var it43838" onMouseOver="hilite(43838)" onMouseOut="lolite()" href="../../_variables/sso_jump_url.html">sso_jump_url</a>      = '<a class="filename" href="../../auth/mnet/jump.php.html">/auth/mnet/jump.php</a>';
<a name="l175"><span class="linenum"> 175</span></a>      <a class="var it27431" onMouseOver="hilite(27431)" onMouseOut="lolite()" onClick="logVariable('moodleapplicationid')" href="../../_variables/moodleapplicationid.html">$moodleapplicationid</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('mnet_application', <a class="var it27427" onMouseOver="hilite(27427)" onMouseOut="lolite()" onClick="logVariable('mnet_app')" href="../../_variables/mnet_app.html">$mnet_app</a>);
<a name="l176"><span class="linenum"> 176</span></a>  
<a name="l177"><span class="linenum"> 177</span></a>      <a class="var it27427" onMouseOver="hilite(27427)" onMouseOut="lolite()" onClick="logVariable('mnet_app')" href="../../_variables/mnet_app.html">$mnet_app</a> = new stdClass();
<a name="l178"><span class="linenum"> 178</span></a>      <a class="var it27427" onMouseOver="hilite(27427)" onMouseOut="lolite()" onClick="logVariable('mnet_app')" href="../../_variables/mnet_app.html">$mnet_app</a>-&gt;<a onClick="logVariable('name')" class="var it43838" onMouseOver="hilite(43838)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>              = 'mahara';
<a name="l179"><span class="linenum"> 179</span></a>      <a class="var it27427" onMouseOver="hilite(27427)" onMouseOut="lolite()" onClick="logVariable('mnet_app')" href="../../_variables/mnet_app.html">$mnet_app</a>-&gt;<a onClick="logVariable('display_name')" class="var it43838" onMouseOver="hilite(43838)" onMouseOut="lolite()" href="../../_variables/display_name.html">display_name</a>      = 'Mahara';
<a name="l180"><span class="linenum"> 180</span></a>      <a class="var it27427" onMouseOver="hilite(27427)" onMouseOut="lolite()" onClick="logVariable('mnet_app')" href="../../_variables/mnet_app.html">$mnet_app</a>-&gt;<a onClick="logVariable('xmlrpc_server_url')" class="var it43838" onMouseOver="hilite(43838)" onMouseOut="lolite()" href="../../_variables/xmlrpc_server_url.html">xmlrpc_server_url</a> = '/api/xmlrpc/server.php';
<a name="l181"><span class="linenum"> 181</span></a>      <a class="var it27427" onMouseOver="hilite(27427)" onMouseOut="lolite()" onClick="logVariable('mnet_app')" href="../../_variables/mnet_app.html">$mnet_app</a>-&gt;<a onClick="logVariable('sso_land_url')" class="var it43838" onMouseOver="hilite(43838)" onMouseOut="lolite()" href="../../_variables/sso_land_url.html">sso_land_url</a>      = '/auth/xmlrpc/land.php';
<a name="l182"><span class="linenum"> 182</span></a>      <a class="var it27427" onMouseOver="hilite(27427)" onMouseOut="lolite()" onClick="logVariable('mnet_app')" href="../../_variables/mnet_app.html">$mnet_app</a>-&gt;<a onClick="logVariable('sso_jump_url')" class="var it43838" onMouseOver="hilite(43838)" onMouseOut="lolite()" href="../../_variables/sso_jump_url.html">sso_jump_url</a>      = '/auth/xmlrpc/jump.php';
<a name="l183"><span class="linenum"> 183</span></a>      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('mnet_application', <a class="var it27427" onMouseOver="hilite(27427)" onMouseOut="lolite()" onClick="logVariable('mnet_app')" href="../../_variables/mnet_app.html">$mnet_app</a>);
<a name="l184"><span class="linenum"> 184</span></a>  
<a name="l185"><span class="linenum"> 185</span></a>  <span class="comment">    // Set up the probably-to-be-removed-soon 'All hosts' record</span>
<a name="l186"><span class="linenum"> 186</span></a>      <a class="var it27432" onMouseOver="hilite(27432)" onMouseOut="lolite()" onClick="logVariable('mnetallhosts')" href="../../_variables/mnetallhosts.html">$mnetallhosts</a>                     = new stdClass();
<a name="l187"><span class="linenum"> 187</span></a>      <a class="var it27432" onMouseOver="hilite(27432)" onMouseOut="lolite()" onClick="logVariable('mnetallhosts')" href="../../_variables/mnetallhosts.html">$mnetallhosts</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it43839" onMouseOver="hilite(43839)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>            = '';
<a name="l188"><span class="linenum"> 188</span></a>      <a class="var it27432" onMouseOver="hilite(27432)" onMouseOut="lolite()" onClick="logVariable('mnetallhosts')" href="../../_variables/mnetallhosts.html">$mnetallhosts</a>-&gt;<a onClick="logVariable('ip_address')" class="var it43839" onMouseOver="hilite(43839)" onMouseOut="lolite()" href="../../_variables/ip_address.html">ip_address</a>         = '';
<a name="l189"><span class="linenum"> 189</span></a>      <a class="var it27432" onMouseOver="hilite(27432)" onMouseOut="lolite()" onClick="logVariable('mnetallhosts')" href="../../_variables/mnetallhosts.html">$mnetallhosts</a>-&gt;<a onClick="logVariable('public_key')" class="var it43839" onMouseOver="hilite(43839)" onMouseOut="lolite()" href="../../_variables/public_key.html">public_key</a>         = '';
<a name="l190"><span class="linenum"> 190</span></a>      <a class="var it27432" onMouseOver="hilite(27432)" onMouseOut="lolite()" onClick="logVariable('mnetallhosts')" href="../../_variables/mnetallhosts.html">$mnetallhosts</a>-&gt;<a onClick="logVariable('public_key_expires')" class="var it43839" onMouseOver="hilite(43839)" onMouseOut="lolite()" href="../../_variables/public_key_expires.html">public_key_expires</a> = 0;
<a name="l191"><span class="linenum"> 191</span></a>      <a class="var it27432" onMouseOver="hilite(27432)" onMouseOut="lolite()" onClick="logVariable('mnetallhosts')" href="../../_variables/mnetallhosts.html">$mnetallhosts</a>-&gt;<a onClick="logVariable('last_connect_time')" class="var it43839" onMouseOver="hilite(43839)" onMouseOut="lolite()" href="../../_variables/last_connect_time.html">last_connect_time</a>  = 0;
<a name="l192"><span class="linenum"> 192</span></a>      <a class="var it27432" onMouseOver="hilite(27432)" onMouseOut="lolite()" onClick="logVariable('mnetallhosts')" href="../../_variables/mnetallhosts.html">$mnetallhosts</a>-&gt;<a onClick="logVariable('last_log_id')" class="var it43839" onMouseOver="hilite(43839)" onMouseOut="lolite()" href="../../_variables/last_log_id.html">last_log_id</a>        = 0;
<a name="l193"><span class="linenum"> 193</span></a>      <a class="var it27432" onMouseOver="hilite(27432)" onMouseOut="lolite()" onClick="logVariable('mnetallhosts')" href="../../_variables/mnetallhosts.html">$mnetallhosts</a>-&gt;<a onClick="logVariable('deleted')" class="var it43839" onMouseOver="hilite(43839)" onMouseOut="lolite()" href="../../_variables/deleted.html">deleted</a>            = 0;
<a name="l194"><span class="linenum"> 194</span></a>      <a class="var it27432" onMouseOver="hilite(27432)" onMouseOut="lolite()" onClick="logVariable('mnetallhosts')" href="../../_variables/mnetallhosts.html">$mnetallhosts</a>-&gt;<a onClick="logVariable('name')" class="var it43839" onMouseOver="hilite(43839)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>               = 'All Hosts';
<a name="l195"><span class="linenum"> 195</span></a>      <a class="var it27432" onMouseOver="hilite(27432)" onMouseOut="lolite()" onClick="logVariable('mnetallhosts')" href="../../_variables/mnetallhosts.html">$mnetallhosts</a>-&gt;<a onClick="logVariable('applicationid')" class="var it43839" onMouseOver="hilite(43839)" onMouseOut="lolite()" href="../../_variables/applicationid.html">applicationid</a>      = <a class="var it27431" onMouseOver="hilite(27431)" onMouseOut="lolite()" onClick="logVariable('moodleapplicationid')" href="../../_variables/moodleapplicationid.html">$moodleapplicationid</a>;
<a name="l196"><span class="linenum"> 196</span></a>      <a class="var it27432" onMouseOver="hilite(27432)" onMouseOut="lolite()" onClick="logVariable('mnetallhosts')" href="../../_variables/mnetallhosts.html">$mnetallhosts</a>-&gt;<a onClick="logVariable('id')" class="var it43839" onMouseOver="hilite(43839)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>                 = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('mnet_host', <a class="var it27432" onMouseOver="hilite(27432)" onMouseOut="lolite()" onClick="logVariable('mnetallhosts')" href="../../_variables/mnetallhosts.html">$mnetallhosts</a>, true);
<a name="l197"><span class="linenum"> 197</span></a>      <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('mnet_all_hosts_id', <a class="var it27432" onMouseOver="hilite(27432)" onMouseOut="lolite()" onClick="logVariable('mnetallhosts')" href="../../_variables/mnetallhosts.html">$mnetallhosts</a>-&gt;<a onClick="logVariable('id')" class="var it43839" onMouseOver="hilite(43839)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l198"><span class="linenum"> 198</span></a>  
<a name="l199"><span class="linenum"> 199</span></a>  <span class="comment">    // Create guest record - do not assign any role, guest user gets the default guest role automatically on the fly</span>
<a name="l200"><span class="linenum"> 200</span></a>      if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('record_exists')" href="../../_functions/record_exists.html" onMouseOver="funcPopup(event,'record_exists')">record_exists</a>('user', array())) {
<a name="l201"><span class="linenum"> 201</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('generalexceptionmessage', 'error', '', 'Can not create default users, users already exist.');
<a name="l202"><span class="linenum"> 202</span></a>      }
<a name="l203"><span class="linenum"> 203</span></a>      <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('guest')" href="../../_variables/guest.html">$guest</a> = new stdClass();
<a name="l204"><span class="linenum"> 204</span></a>      <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('guest')" href="../../_variables/guest.html">$guest</a>-&gt;<a onClick="logVariable('auth')" class="var it43840" onMouseOver="hilite(43840)" onMouseOut="lolite()" href="../../_variables/auth.html">auth</a>        = 'manual';
<a name="l205"><span class="linenum"> 205</span></a>      <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('guest')" href="../../_variables/guest.html">$guest</a>-&gt;<a onClick="logVariable('username')" class="var it43840" onMouseOver="hilite(43840)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>    = 'guest';
<a name="l206"><span class="linenum"> 206</span></a>      <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('guest')" href="../../_variables/guest.html">$guest</a>-&gt;<a onClick="logVariable('password')" class="var it43840" onMouseOver="hilite(43840)" onMouseOut="lolite()" href="../../_variables/password.html">password</a>    = <a class="function" onClick="logFunction('hash_internal_user_password')" href="../../_functions/hash_internal_user_password.html" onMouseOver="funcPopup(event,'hash_internal_user_password')">hash_internal_user_password</a>('guest');
<a name="l207"><span class="linenum"> 207</span></a>      <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('guest')" href="../../_variables/guest.html">$guest</a>-&gt;<a onClick="logVariable('firstname')" class="var it43840" onMouseOver="hilite(43840)" onMouseOut="lolite()" href="../../_variables/firstname.html">firstname</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('guestuser');
<a name="l208"><span class="linenum"> 208</span></a>      <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('guest')" href="../../_variables/guest.html">$guest</a>-&gt;<a onClick="logVariable('lastname')" class="var it43840" onMouseOver="hilite(43840)" onMouseOut="lolite()" href="../../_variables/lastname.html">lastname</a>    = ' ';
<a name="l209"><span class="linenum"> 209</span></a>      <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('guest')" href="../../_variables/guest.html">$guest</a>-&gt;<a onClick="logVariable('email')" class="var it43840" onMouseOver="hilite(43840)" onMouseOut="lolite()" href="../../_variables/email.html">email</a>       = 'root@localhost';
<a name="l210"><span class="linenum"> 210</span></a>      <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('guest')" href="../../_variables/guest.html">$guest</a>-&gt;<a onClick="logVariable('description')" class="var it43840" onMouseOver="hilite(43840)" onMouseOut="lolite()" href="../../_variables/description.html">description</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('guestuserinfo');
<a name="l211"><span class="linenum"> 211</span></a>      <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('guest')" href="../../_variables/guest.html">$guest</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it43840" onMouseOver="hilite(43840)" onMouseOut="lolite()" href="../../_variables/mnethostid.html">mnethostid</a>  = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/mnet_localhost_id.html">mnet_localhost_id</a>;
<a name="l212"><span class="linenum"> 212</span></a>      <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('guest')" href="../../_variables/guest.html">$guest</a>-&gt;<a onClick="logVariable('confirmed')" class="var it43840" onMouseOver="hilite(43840)" onMouseOut="lolite()" href="../../_variables/confirmed.html">confirmed</a>   = 1;
<a name="l213"><span class="linenum"> 213</span></a>      <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('guest')" href="../../_variables/guest.html">$guest</a>-&gt;<a onClick="logVariable('lang')" class="var it43840" onMouseOver="hilite(43840)" onMouseOut="lolite()" href="../../_variables/lang.html">lang</a>        = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('lang')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/lang.html">lang</a>;
<a name="l214"><span class="linenum"> 214</span></a>      <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('guest')" href="../../_variables/guest.html">$guest</a>-&gt;<a onClick="logVariable('timemodified')" class="var it43840" onMouseOver="hilite(43840)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a>= <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l215"><span class="linenum"> 215</span></a>      <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('guest')" href="../../_variables/guest.html">$guest</a>-&gt;<a onClick="logVariable('id')" class="var it43840" onMouseOver="hilite(43840)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('user', <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('guest')" href="../../_variables/guest.html">$guest</a>);
<a name="l216"><span class="linenum"> 216</span></a>      if (<a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('guest')" href="../../_variables/guest.html">$guest</a>-&gt;<a onClick="logVariable('id')" class="var it43840" onMouseOver="hilite(43840)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> != 1) {
<a name="l217"><span class="linenum"> 217</span></a>          echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>('Unexpected id generated for the Guest account. Your database configuration or clustering setup may not be fully supported', 'notifyproblem');
<a name="l218"><span class="linenum"> 218</span></a>      }
<a name="l219"><span class="linenum"> 219</span></a>  <span class="comment">    // Store guest id</span>
<a name="l220"><span class="linenum"> 220</span></a>      <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('siteguest', <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('guest')" href="../../_variables/guest.html">$guest</a>-&gt;<a onClick="logVariable('id')" class="var it43840" onMouseOver="hilite(43840)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l221"><span class="linenum"> 221</span></a>  <span class="comment">    // Make sure user context exists</span>
<a name="l222"><span class="linenum"> 222</span></a>      <a class="class" onClick="logClass('context_user')" href="../../_classes/context_user.html" onMouseOver="classPopup(event,'context_user')">context_user</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('guest')" href="../../_variables/guest.html">$guest</a>-&gt;<a onClick="logVariable('id')" class="var it43840" onMouseOver="hilite(43840)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l223"><span class="linenum"> 223</span></a>  
<a name="l224"><span class="linenum"> 224</span></a>  
<a name="l225"><span class="linenum"> 225</span></a>  <span class="comment">    // Now create admin user</span>
<a name="l226"><span class="linenum"> 226</span></a>      <a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../../_variables/admin.html">$admin</a> = new stdClass();
<a name="l227"><span class="linenum"> 227</span></a>      <a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../../_variables/admin.html">$admin</a>-&gt;<a onClick="logVariable('auth')" class="var it43601" onMouseOver="hilite(43601)" onMouseOut="lolite()" href="../../_variables/auth.html">auth</a>         = 'manual';
<a name="l228"><span class="linenum"> 228</span></a>      <a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../../_variables/admin.html">$admin</a>-&gt;<a onClick="logVariable('firstname')" class="var it43601" onMouseOver="hilite(43601)" onMouseOut="lolite()" href="../../_variables/firstname.html">firstname</a>    = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('admin');
<a name="l229"><span class="linenum"> 229</span></a>      <a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../../_variables/admin.html">$admin</a>-&gt;<a onClick="logVariable('lastname')" class="var it43601" onMouseOver="hilite(43601)" onMouseOut="lolite()" href="../../_variables/lastname.html">lastname</a>     = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('user');
<a name="l230"><span class="linenum"> 230</span></a>      <a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../../_variables/admin.html">$admin</a>-&gt;<a onClick="logVariable('username')" class="var it43601" onMouseOver="hilite(43601)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>     = 'admin';
<a name="l231"><span class="linenum"> 231</span></a>      <a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../../_variables/admin.html">$admin</a>-&gt;<a onClick="logVariable('password')" class="var it43601" onMouseOver="hilite(43601)" onMouseOut="lolite()" href="../../_variables/password.html">password</a>     = 'adminsetuppending';
<a name="l232"><span class="linenum"> 232</span></a>      <a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../../_variables/admin.html">$admin</a>-&gt;<a onClick="logVariable('email')" class="var it43601" onMouseOver="hilite(43601)" onMouseOut="lolite()" href="../../_variables/email.html">email</a>        = '';
<a name="l233"><span class="linenum"> 233</span></a>      <a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../../_variables/admin.html">$admin</a>-&gt;<a onClick="logVariable('confirmed')" class="var it43601" onMouseOver="hilite(43601)" onMouseOut="lolite()" href="../../_variables/confirmed.html">confirmed</a>    = 1;
<a name="l234"><span class="linenum"> 234</span></a>      <a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../../_variables/admin.html">$admin</a>-&gt;<a onClick="logVariable('mnethostid')" class="var it43601" onMouseOver="hilite(43601)" onMouseOut="lolite()" href="../../_variables/mnethostid.html">mnethostid</a>   = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/mnet_localhost_id.html">mnet_localhost_id</a>;
<a name="l235"><span class="linenum"> 235</span></a>      <a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../../_variables/admin.html">$admin</a>-&gt;<a onClick="logVariable('lang')" class="var it43601" onMouseOver="hilite(43601)" onMouseOut="lolite()" href="../../_variables/lang.html">lang</a>         = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('lang')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/lang.html">lang</a>;
<a name="l236"><span class="linenum"> 236</span></a>      <a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../../_variables/admin.html">$admin</a>-&gt;<a onClick="logVariable('maildisplay')" class="var it43601" onMouseOver="hilite(43601)" onMouseOut="lolite()" href="../../_variables/maildisplay.html">maildisplay</a>  = 1;
<a name="l237"><span class="linenum"> 237</span></a>      <a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../../_variables/admin.html">$admin</a>-&gt;<a onClick="logVariable('timemodified')" class="var it43601" onMouseOver="hilite(43601)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l238"><span class="linenum"> 238</span></a>      <a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../../_variables/admin.html">$admin</a>-&gt;<a onClick="logVariable('lastip')" class="var it43601" onMouseOver="hilite(43601)" onMouseOut="lolite()" href="../../_variables/lastip.html">lastip</a>       = <a class="constant" onClick="logConstant('CLI_SCRIPT')" href="../../_constants/CLI_SCRIPT.html" onMouseOver="constPopup(event,'CLI_SCRIPT')">CLI_SCRIPT</a> ? '0.0.0.0' : <a class="function" onClick="logFunction('getremoteaddr')" href="../../_functions/getremoteaddr.html" onMouseOver="funcPopup(event,'getremoteaddr')">getremoteaddr</a>(); <span class="comment">// installation hijacking prevention</span>
<a name="l239"><span class="linenum"> 239</span></a>      <a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../../_variables/admin.html">$admin</a>-&gt;<a onClick="logVariable('id')" class="var it43601" onMouseOver="hilite(43601)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('user', <a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../../_variables/admin.html">$admin</a>);
<a name="l240"><span class="linenum"> 240</span></a>  
<a name="l241"><span class="linenum"> 241</span></a>      if (<a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../../_variables/admin.html">$admin</a>-&gt;<a onClick="logVariable('id')" class="var it43601" onMouseOver="hilite(43601)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> != 2) {
<a name="l242"><span class="linenum"> 242</span></a>          echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>('Unexpected id generated for the Admin account. Your database configuration or clustering setup may not be fully supported', 'notifyproblem');
<a name="l243"><span class="linenum"> 243</span></a>      }
<a name="l244"><span class="linenum"> 244</span></a>      if (<a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../../_variables/admin.html">$admin</a>-&gt;<a onClick="logVariable('id')" class="var it43601" onMouseOver="hilite(43601)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> != (<a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('guest')" href="../../_variables/guest.html">$guest</a>-&gt;<a onClick="logVariable('id')" class="var it43840" onMouseOver="hilite(43840)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> + 1)) {
<a name="l245"><span class="linenum"> 245</span></a>          echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>('Nonconsecutive id generated for the Admin account. Your database configuration or clustering setup may not be fully supported.', 'notifyproblem');
<a name="l246"><span class="linenum"> 246</span></a>      }
<a name="l247"><span class="linenum"> 247</span></a>  
<a name="l248"><span class="linenum"> 248</span></a>  <span class="comment">    // Store list of admins</span>
<a name="l249"><span class="linenum"> 249</span></a>      <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('siteadmins', <a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../../_variables/admin.html">$admin</a>-&gt;<a onClick="logVariable('id')" class="var it43601" onMouseOver="hilite(43601)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l250"><span class="linenum"> 250</span></a>  <span class="comment">    // Make sure user context exists</span>
<a name="l251"><span class="linenum"> 251</span></a>      <a class="class" onClick="logClass('context_user')" href="../../_classes/context_user.html" onMouseOver="classPopup(event,'context_user')">context_user</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('admin')" href="../../_variables/admin.html">$admin</a>-&gt;<a onClick="logVariable('id')" class="var it43601" onMouseOver="hilite(43601)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l252"><span class="linenum"> 252</span></a>  
<a name="l253"><span class="linenum"> 253</span></a>  
<a name="l254"><span class="linenum"> 254</span></a>  <span class="comment">    // Install the roles system.</span>
<a name="l255"><span class="linenum"> 255</span></a>      <a class="var it3181" onMouseOver="hilite(3181)" onMouseOut="lolite()" onClick="logVariable('managerrole')" href="../../_variables/managerrole.html">$managerrole</a>        = <a class="function" onClick="logFunction('create_role')" href="../../_functions/create_role.html" onMouseOver="funcPopup(event,'create_role')">create_role</a>('', 'manager', '', 'manager');
<a name="l256"><span class="linenum"> 256</span></a>      <a class="var it23503" onMouseOver="hilite(23503)" onMouseOut="lolite()" onClick="logVariable('coursecreatorrole')" href="../../_variables/coursecreatorrole.html">$coursecreatorrole</a>  = <a class="function" onClick="logFunction('create_role')" href="../../_functions/create_role.html" onMouseOver="funcPopup(event,'create_role')">create_role</a>('', 'coursecreator', '', 'coursecreator');
<a name="l257"><span class="linenum"> 257</span></a>      <a class="var it27433" onMouseOver="hilite(27433)" onMouseOut="lolite()" onClick="logVariable('editteacherrole')" href="../../_variables/editteacherrole.html">$editteacherrole</a>    = <a class="function" onClick="logFunction('create_role')" href="../../_functions/create_role.html" onMouseOver="funcPopup(event,'create_role')">create_role</a>('', 'editingteacher', '', 'editingteacher');
<a name="l258"><span class="linenum"> 258</span></a>      <a class="var it27434" onMouseOver="hilite(27434)" onMouseOut="lolite()" onClick="logVariable('noneditteacherrole')" href="../../_variables/noneditteacherrole.html">$noneditteacherrole</a> = <a class="function" onClick="logFunction('create_role')" href="../../_functions/create_role.html" onMouseOver="funcPopup(event,'create_role')">create_role</a>('', 'teacher', '', 'teacher');
<a name="l259"><span class="linenum"> 259</span></a>      <a class="var it1111" onMouseOver="hilite(1111)" onMouseOut="lolite()" onClick="logVariable('studentrole')" href="../../_variables/studentrole.html">$studentrole</a>        = <a class="function" onClick="logFunction('create_role')" href="../../_functions/create_role.html" onMouseOver="funcPopup(event,'create_role')">create_role</a>('', 'student', '', 'student');
<a name="l260"><span class="linenum"> 260</span></a>      <a class="var it26553" onMouseOver="hilite(26553)" onMouseOut="lolite()" onClick="logVariable('guestrole')" href="../../_variables/guestrole.html">$guestrole</a>          = <a class="function" onClick="logFunction('create_role')" href="../../_functions/create_role.html" onMouseOver="funcPopup(event,'create_role')">create_role</a>('', 'guest', '', 'guest');
<a name="l261"><span class="linenum"> 261</span></a>      <a class="var it12209" onMouseOver="hilite(12209)" onMouseOut="lolite()" onClick="logVariable('userrole')" href="../../_variables/userrole.html">$userrole</a>           = <a class="function" onClick="logFunction('create_role')" href="../../_functions/create_role.html" onMouseOver="funcPopup(event,'create_role')">create_role</a>('', 'user', '', 'user');
<a name="l262"><span class="linenum"> 262</span></a>      <a class="var it27435" onMouseOver="hilite(27435)" onMouseOut="lolite()" onClick="logVariable('frontpagerole')" href="../../_variables/frontpagerole.html">$frontpagerole</a>      = <a class="function" onClick="logFunction('create_role')" href="../../_functions/create_role.html" onMouseOver="funcPopup(event,'create_role')">create_role</a>('', 'frontpage', '', 'frontpage');
<a name="l263"><span class="linenum"> 263</span></a>  
<a name="l264"><span class="linenum"> 264</span></a>  <span class="comment">    // Now is the correct moment to install capabilities - after creation of legacy roles, but before assigning of roles</span>
<a name="l265"><span class="linenum"> 265</span></a>      <a class="function" onClick="logFunction('update_capabilities')" href="../../_functions/update_capabilities.html" onMouseOver="funcPopup(event,'update_capabilities')">update_capabilities</a>('moodle');
<a name="l266"><span class="linenum"> 266</span></a>  
<a name="l267"><span class="linenum"> 267</span></a>  
<a name="l268"><span class="linenum"> 268</span></a>  <span class="comment">    // Default allow role matrices.</span>
<a name="l269"><span class="linenum"> 269</span></a>      foreach (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('role') as <a class="var it573" onMouseOver="hilite(573)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>) {
<a name="l270"><span class="linenum"> 270</span></a>          foreach (array('assign', 'override', 'switch') as <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>) {
<a name="l271"><span class="linenum"> 271</span></a>              <a class="var it307" onMouseOver="hilite(307)" onMouseOut="lolite()" onClick="logVariable('function')" href="../../_variables/function.html">$function</a> = 'allow_'.<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>;
<a name="l272"><span class="linenum"> 272</span></a>              <a class="var it27436" onMouseOver="hilite(27436)" onMouseOut="lolite()" onClick="logVariable('allows')" href="../../_variables/allows.html">$allows</a> = <a class="function" onClick="logFunction('get_default_role_archetype_allows')" href="../../_functions/get_default_role_archetype_allows.html" onMouseOver="funcPopup(event,'get_default_role_archetype_allows')">get_default_role_archetype_allows</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>, <a class="var it573" onMouseOver="hilite(573)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>-&gt;<a onClick="logVariable('archetype')" class="var it42915" onMouseOver="hilite(42915)" onMouseOut="lolite()" href="../../_variables/archetype.html">archetype</a>);
<a name="l273"><span class="linenum"> 273</span></a>              foreach (<a class="var it27436" onMouseOver="hilite(27436)" onMouseOut="lolite()" onClick="logVariable('allows')" href="../../_variables/allows.html">$allows</a> as <a class="var it12430" onMouseOver="hilite(12430)" onMouseOut="lolite()" onClick="logVariable('allowid')" href="../../_variables/allowid.html">$allowid</a>) {
<a name="l274"><span class="linenum"> 274</span></a>                  <a class="var it307" onMouseOver="hilite(307)" onMouseOut="lolite()" onClick="logVariable('function')" href="../../_variables/function.html">$function</a>(<a class="var it573" onMouseOver="hilite(573)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>-&gt;<a onClick="logVariable('id')" class="var it42915" onMouseOver="hilite(42915)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it12430" onMouseOver="hilite(12430)" onMouseOut="lolite()" onClick="logVariable('allowid')" href="../../_variables/allowid.html">$allowid</a>);
<a name="l275"><span class="linenum"> 275</span></a>              }
<a name="l276"><span class="linenum"> 276</span></a>          }
<a name="l277"><span class="linenum"> 277</span></a>      }
<a name="l278"><span class="linenum"> 278</span></a>  
<a name="l279"><span class="linenum"> 279</span></a>  <span class="comment">    // Set up the context levels where you can assign each role.</span>
<a name="l280"><span class="linenum"> 280</span></a>      <a class="function" onClick="logFunction('set_role_contextlevels')" href="../../_functions/set_role_contextlevels.html" onMouseOver="funcPopup(event,'set_role_contextlevels')">set_role_contextlevels</a>(<a class="var it3181" onMouseOver="hilite(3181)" onMouseOut="lolite()" onClick="logVariable('managerrole')" href="../../_variables/managerrole.html">$managerrole</a>,        <a class="function" onClick="logFunction('get_default_contextlevels')" href="../../_functions/get_default_contextlevels.html" onMouseOver="funcPopup(event,'get_default_contextlevels')">get_default_contextlevels</a>('manager'));
<a name="l281"><span class="linenum"> 281</span></a>      <a class="function" onClick="logFunction('set_role_contextlevels')" href="../../_functions/set_role_contextlevels.html" onMouseOver="funcPopup(event,'set_role_contextlevels')">set_role_contextlevels</a>(<a class="var it23503" onMouseOver="hilite(23503)" onMouseOut="lolite()" onClick="logVariable('coursecreatorrole')" href="../../_variables/coursecreatorrole.html">$coursecreatorrole</a>,  <a class="function" onClick="logFunction('get_default_contextlevels')" href="../../_functions/get_default_contextlevels.html" onMouseOver="funcPopup(event,'get_default_contextlevels')">get_default_contextlevels</a>('coursecreator'));
<a name="l282"><span class="linenum"> 282</span></a>      <a class="function" onClick="logFunction('set_role_contextlevels')" href="../../_functions/set_role_contextlevels.html" onMouseOver="funcPopup(event,'set_role_contextlevels')">set_role_contextlevels</a>(<a class="var it27433" onMouseOver="hilite(27433)" onMouseOut="lolite()" onClick="logVariable('editteacherrole')" href="../../_variables/editteacherrole.html">$editteacherrole</a>,    <a class="function" onClick="logFunction('get_default_contextlevels')" href="../../_functions/get_default_contextlevels.html" onMouseOver="funcPopup(event,'get_default_contextlevels')">get_default_contextlevels</a>('editingteacher'));
<a name="l283"><span class="linenum"> 283</span></a>      <a class="function" onClick="logFunction('set_role_contextlevels')" href="../../_functions/set_role_contextlevels.html" onMouseOver="funcPopup(event,'set_role_contextlevels')">set_role_contextlevels</a>(<a class="var it27434" onMouseOver="hilite(27434)" onMouseOut="lolite()" onClick="logVariable('noneditteacherrole')" href="../../_variables/noneditteacherrole.html">$noneditteacherrole</a>, <a class="function" onClick="logFunction('get_default_contextlevels')" href="../../_functions/get_default_contextlevels.html" onMouseOver="funcPopup(event,'get_default_contextlevels')">get_default_contextlevels</a>('teacher'));
<a name="l284"><span class="linenum"> 284</span></a>      <a class="function" onClick="logFunction('set_role_contextlevels')" href="../../_functions/set_role_contextlevels.html" onMouseOver="funcPopup(event,'set_role_contextlevels')">set_role_contextlevels</a>(<a class="var it1111" onMouseOver="hilite(1111)" onMouseOut="lolite()" onClick="logVariable('studentrole')" href="../../_variables/studentrole.html">$studentrole</a>,        <a class="function" onClick="logFunction('get_default_contextlevels')" href="../../_functions/get_default_contextlevels.html" onMouseOver="funcPopup(event,'get_default_contextlevels')">get_default_contextlevels</a>('student'));
<a name="l285"><span class="linenum"> 285</span></a>      <a class="function" onClick="logFunction('set_role_contextlevels')" href="../../_functions/set_role_contextlevels.html" onMouseOver="funcPopup(event,'set_role_contextlevels')">set_role_contextlevels</a>(<a class="var it26553" onMouseOver="hilite(26553)" onMouseOut="lolite()" onClick="logVariable('guestrole')" href="../../_variables/guestrole.html">$guestrole</a>,          <a class="function" onClick="logFunction('get_default_contextlevels')" href="../../_functions/get_default_contextlevels.html" onMouseOver="funcPopup(event,'get_default_contextlevels')">get_default_contextlevels</a>('guest'));
<a name="l286"><span class="linenum"> 286</span></a>      <a class="function" onClick="logFunction('set_role_contextlevels')" href="../../_functions/set_role_contextlevels.html" onMouseOver="funcPopup(event,'set_role_contextlevels')">set_role_contextlevels</a>(<a class="var it12209" onMouseOver="hilite(12209)" onMouseOut="lolite()" onClick="logVariable('userrole')" href="../../_variables/userrole.html">$userrole</a>,           <a class="function" onClick="logFunction('get_default_contextlevels')" href="../../_functions/get_default_contextlevels.html" onMouseOver="funcPopup(event,'get_default_contextlevels')">get_default_contextlevels</a>('user'));
<a name="l287"><span class="linenum"> 287</span></a>  
<a name="l288"><span class="linenum"> 288</span></a>  <span class="comment">    // Init theme and JS revisions</span>
<a name="l289"><span class="linenum"> 289</span></a>      <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('themerev', <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>());
<a name="l290"><span class="linenum"> 290</span></a>      <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('jsrev', <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>());
<a name="l291"><span class="linenum"> 291</span></a>  
<a name="l292"><span class="linenum"> 292</span></a>  <span class="comment">    // No admin setting for this any more, GD is now required, remove in Moodle 2.6.</span>
<a name="l293"><span class="linenum"> 293</span></a>      <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('gdversion', 2);
<a name="l294"><span class="linenum"> 294</span></a>  
<a name="l295"><span class="linenum"> 295</span></a>  <span class="comment">    // Install licenses</span>
<a name="l296"><span class="linenum"> 296</span></a>      require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a> . '/licenselib.php');
<a name="l297"><span class="linenum"> 297</span></a>      <a class="class" onClick="logClass('license_manager')" href="../../_classes/license_manager.html" onMouseOver="classPopup(event,'license_manager')">license_manager</a>::<a class="function" onClick="logFunction('install_licenses')" href="../../_functions/install_licenses.html" onMouseOver="funcPopup(event,'install_licenses')">install_licenses</a>();
<a name="l298"><span class="linenum"> 298</span></a>  
<a name="l299"><span class="linenum"> 299</span></a>  <span class="comment">    // Init profile pages defaults</span>
<a name="l300"><span class="linenum"> 300</span></a>      if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('record_exists')" href="../../_functions/record_exists.html" onMouseOver="funcPopup(event,'record_exists')">record_exists</a>('my_pages', array())) {
<a name="l301"><span class="linenum"> 301</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('generalexceptionmessage', 'error', '', 'Can not create default profile pages, records already exist.');
<a name="l302"><span class="linenum"> 302</span></a>      }
<a name="l303"><span class="linenum"> 303</span></a>      <a class="var it27437" onMouseOver="hilite(27437)" onMouseOut="lolite()" onClick="logVariable('mypage')" href="../../_variables/mypage.html">$mypage</a> = new stdClass();
<a name="l304"><span class="linenum"> 304</span></a>      <a class="var it27437" onMouseOver="hilite(27437)" onMouseOut="lolite()" onClick="logVariable('mypage')" href="../../_variables/mypage.html">$mypage</a>-&gt;<a onClick="logVariable('userid')" class="var it43841" onMouseOver="hilite(43841)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> = NULL;
<a name="l305"><span class="linenum"> 305</span></a>      <a class="var it27437" onMouseOver="hilite(27437)" onMouseOut="lolite()" onClick="logVariable('mypage')" href="../../_variables/mypage.html">$mypage</a>-&gt;<a onClick="logVariable('name')" class="var it43841" onMouseOver="hilite(43841)" onMouseOut="lolite()" href="../../_variables/name.html">name</a> = '__default';
<a name="l306"><span class="linenum"> 306</span></a>      <a class="var it27437" onMouseOver="hilite(27437)" onMouseOut="lolite()" onClick="logVariable('mypage')" href="../../_variables/mypage.html">$mypage</a>-&gt;<a onClick="logVariable('private')" class="var it43841" onMouseOver="hilite(43841)" onMouseOut="lolite()" href="../../_variables/private.html">private</a> = 0;
<a name="l307"><span class="linenum"> 307</span></a>      <a class="var it27437" onMouseOver="hilite(27437)" onMouseOut="lolite()" onClick="logVariable('mypage')" href="../../_variables/mypage.html">$mypage</a>-&gt;<a onClick="logVariable('sortorder')" class="var it43841" onMouseOver="hilite(43841)" onMouseOut="lolite()" href="../../_variables/sortorder.html">sortorder</a>  = 0;
<a name="l308"><span class="linenum"> 308</span></a>      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('my_pages', <a class="var it27437" onMouseOver="hilite(27437)" onMouseOut="lolite()" onClick="logVariable('mypage')" href="../../_variables/mypage.html">$mypage</a>);
<a name="l309"><span class="linenum"> 309</span></a>      <a class="var it27437" onMouseOver="hilite(27437)" onMouseOut="lolite()" onClick="logVariable('mypage')" href="../../_variables/mypage.html">$mypage</a>-&gt;<a onClick="logVariable('private')" class="var it43841" onMouseOver="hilite(43841)" onMouseOut="lolite()" href="../../_variables/private.html">private</a> = 1;
<a name="l310"><span class="linenum"> 310</span></a>      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('my_pages', <a class="var it27437" onMouseOver="hilite(27437)" onMouseOut="lolite()" onClick="logVariable('mypage')" href="../../_variables/mypage.html">$mypage</a>);
<a name="l311"><span class="linenum"> 311</span></a>  
<a name="l312"><span class="linenum"> 312</span></a>  <span class="comment">    // Set a sensible default sort order for the most-used question types.</span>
<a name="l313"><span class="linenum"> 313</span></a>      <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('multichoice_sortorder', 1, 'question');
<a name="l314"><span class="linenum"> 314</span></a>      <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('truefalse_sortorder', 2, 'question');
<a name="l315"><span class="linenum"> 315</span></a>      <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('match_sortorder', 3, 'question');
<a name="l316"><span class="linenum"> 316</span></a>      <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('shortanswer_sortorder', 4, 'question');
<a name="l317"><span class="linenum"> 317</span></a>      <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('numerical_sortorder', 5, 'question');
<a name="l318"><span class="linenum"> 318</span></a>      <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('essay_sortorder', 6, 'question');
<a name="l319"><span class="linenum"> 319</span></a>  
<a name="l320"><span class="linenum"> 320</span></a>      require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a> . '/db/upgradelib.php');
<a name="l321"><span class="linenum"> 321</span></a>      <a class="function" onClick="logFunction('make_default_scale')" href="../../_functions/make_default_scale.html" onMouseOver="funcPopup(event,'make_default_scale')">make_default_scale</a>();
<a name="l322"><span class="linenum"> 322</span></a>      <a class="function" onClick="logFunction('make_competence_scale')" href="../../_functions/make_competence_scale.html" onMouseOver="funcPopup(event,'make_competence_scale')">make_competence_scale</a>();
<a name="l323"><span class="linenum"> 323</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'record_exists': ['record_exists', 'Check if a record exists by ID. ', [['competency/classes','persistent.php',842],['lib/dml','moodle_database.php',1817]], 901],
'get_host_from_url': ['get_host_from_url', 'Returns host part from url. ', [['lib','moodlelib.php',1307]], 3],
'import_record': ['import_record', 'Import a record into a table, id field is required. Basic safety checks only. Lobs are supported. ', [['lib/dml','pdo_moodle_database.php',577],['lib/dml','oci_native_moodle_database.php',1333],['lib/dml','pgsql_native_moodle_database.php',1020],['lib/dml','mssql_native_moodle_database.php',997],['lib/dml','mysqli_native_moodle_database.php',1339],['lib/dml','sqlsrv_native_moodle_database.php',1081],['lib/dml/tests','dml_test.php',5549]], 24],
'install_licenses': ['install_licenses', 'Install moodle build-in licenses ', [['lib','licenselib.php',137]], 1],
'get_record': ['get_record', 'Load a single record. ', [['competency/classes','persistent.php',738],['lib/dml','moodle_database.php',1462]], 3224],
'getremoteaddr': ['getremoteaddr', 'Returns most reliable client address ', [['lib','moodlelib.php',8569]], 61],
'reset_sequence': ['reset_sequence', 'Reset a sequence to the id field of a table. ', [['lib/ddl','database_manager.php',103]], 12],
'get_manager': ['get_manager', 'Returns the sql generator used for db manipulation. Used mostly in upgrade.php scripts. ', [['lib/dml','moodle_database.php',1080]], 229],
'make_default_scale': ['make_default_scale', 'This function creates a default separated/connected scale so there\'s something in the database.  The locations of strings and files is a bit odd, but this is because we need to maintain backward compatibility with many different existing language translations and older sites. ', [['lib/db','upgradelib.php',311]], 1],
'get_records': ['get_records', 'Load a list of records. ', [['competency/classes','persistent.php',709],['mod/glossary/classes','entry_query_builder.php',295],['lib/dml','moodle_database.php',1285],['lib','coursecatlib.php',651],['question','category_class.php',63]], 965],
'set_role_contextlevels': ['set_role_contextlevels', 'Set the context levels at which a particular role can be assigned. Throws exceptions in case of error. ', [['lib','accesslib.php',3720]], 13],
'instance': ['instance', 'Returns an instance of the cache_factor method. ', [['cache','disabledlib.php',171],['cache','disabledlib.php',296],['lib/classes','useragent.php',101],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',80],['lib/htmlpurifier/HTMLPurifier','URISchemeRegistry.php',9],['search/classes','manager.php',109],['cache','locallib.php',52],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',53],['lib/classes','plugin_manager.php',103],['lib/htmlpurifier','HTMLPurifier.php',251],['course/format','lib.php',156],['lib/classes/update','checker.php',62],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',31],['admin/tool/installaddon/classes','installer.php',40],['lib','modinfolib.php',373],['cache/classes','helper.php',76],['lib/tests','string_manager_standard_test.php',124],['lib/portfolio','exporter.php',251],['lib/classes/update','validator.php',88],['search/classes','document_factory.php',49],['lib','accesslib.php',6235],['lib','accesslib.php',6487],['lib','accesslib.php',6665],['lib','accesslib.php',6919],['lib','accesslib.php',7180],['lib','accesslib.php',7392],['backup/cc/cc_lib','cc_utils.php',387],['backup/cc/cc_lib','cc_utils.php',443],['lib','filterlib.php',80],['search/tests/fixtures','testable_core_search.php',43],['lib/tests/fixtures','testable_update_checker.php',45],['backup/cc','validator.php',35],['cache/classes','config.php',87],['cache/classes','factory.php',114],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',29]], 4647],
'hash_internal_user_password': ['hash_internal_user_password', 'Calculate hash for a plain text password. ', [['lib','moodlelib.php',4425]], 12],
'update_capabilities': ['update_capabilities', 'Updates the capabilities table with the component capability definitions. If no parameters are given, the function updates the core moodle capabilities. ', [['lib','accesslib.php',2689]], 13],
'create_role': ['create_role', 'Creates a new role in the system. ', [['lib/testing/generator','data_generator.php',726],['lib','accesslib.php',1453]], 100],
'get_string': ['get_string', 'Get String returns a requested string ', [['lib/classes','string_manager_install.php',95],['lib','moodlelib.php',6735],['lib','moodlelib.php',9695],['lib/external','externallib.php',102],['question/behaviour','behaviourbase.php',770],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38]], 20134],
'make_competence_scale': ['make_competence_scale', 'Create another default scale. ', [['lib/db','upgradelib.php',339]], 2],
'set_config': ['set_config', 'Set a key in global configuration ', [['lib','moodlelib.php',1336],['lib','enrollib.php',1153],['lib/editor/tinymce/classes','plugin.php',84],['mod/assign','assignmentplugin.php',314],['lib/portfolio','plugin.php',515]], 1119],
'get_site': ['get_site', 'Returns $course object of the top-level site. ', [['lib','datalib.php',547]], 77],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required, Some conversions and safety checks are carried out. Lobs are supported. If the return ID isn\'t required, then this just reports success as true/false. $data is an object containing needed data ', [['lib/dml','pdo_moodle_database.php',387],['lib/dml','oci_native_moodle_database.php',1297],['lib/dml','pgsql_native_moodle_database.php',889],['lib/dml','mssql_native_moodle_database.php',962],['lib/dml','mysqli_native_moodle_database.php',1185],['question/engine/upgrade','upgradelib.php',124],['lib/dml','sqlsrv_native_moodle_database.php',1045],['lib/dml/tests','dml_test.php',5548]], 1611],
'get_default_contextlevels': ['get_default_contextlevels', 'Returns default context levels where roles can be assigned. ', [['lib','accesslib.php',3695]], 10],
'set_field': ['set_field', 'Set a single field in every table record where all the given conditions met. ', [['lib/dml','moodle_database.php',1737],['availability/condition/profile/tests','condition_test.php',349]], 485],
'random_string': ['random_string', 'Generate and return a random string of the specified length. ', [['lib','moodlelib.php',7736]], 42],
'get_default_role_archetype_allows': ['get_default_role_archetype_allows', 'Return default roles that can be assigned, overridden or switched by give role archetype. ', [['lib','accesslib.php',2587]], 14],
'notification': ['notification', 'Output a notification (that is, a status message about something that has just happened). ', [['lib','outputrenderers.php',2849],['lib','outputrenderers.php',4412],['lib','outputrenderers.php',4496]], 540],
'xmldb_main_install': ['xmldb_main_install', 'Main post-install tasks to be executed after the BD schema is available ', [['lib/db','install.php',31]], 1],
'defined': ['defined', '', [], 4731],
'gethostbyname': ['gethostbyname', '', [], 4],
'time': ['time', '', [], 1959],
'preg_match': ['preg_match', '', [], 1286],
'define': ['define', '', [], 2373]};
CLASS_DATA={
'license_manager': ['license_manager', '', [['lib','licenselib.php',31]], 7],
'context_system': ['context_system', 'System context class ', [['lib','accesslib.php',6157]], 1147],
'context_user': ['context_user', 'User context class ', [['lib','accesslib.php',6398]], 414],
'theme_config': ['theme_config', 'This class represents the configuration variables of a Moodle theme. ', [['lib','outputlib.php',126]], 41],
'context_coursecat': ['context_coursecat', 'Course category context class ', [['lib','accesslib.php',6585]], 194],
'context_course': ['context_course', 'Course context class ', [['lib','accesslib.php',6817]], 1323],
'moodle_exception': ['moodle_exception', 'Base Moodle Exception class ', [['lib','setuplib.php',75]], 606]};
CONST_DATA={
'CLI_SCRIPT': ['CLI_SCRIPT', '', [['enrol/ldap/cli','sync.php',43],['lib/filestorage/tests/fixtures','zip_create_test_file.php',25],['admin/cli','fix_course_sequence.php',26],['admin/tool/behat/cli','run.php',30],['admin/cli','upgrade.php',38],['admin/cli','install.php',32],['admin/tool/uploadcourse/cli','uploadcourse.php',25],['admin/cli','fix_orphaned_question_categories.php',29],['admin/tool/generator/cli','maketestsite.php',25],['admin/cli','purge_caches.php',24],['admin/cli','install_database.php',31],['admin/tool/behat/cli','util.php',34],['admin/tool/task/cli','schedule_task.php',25],['admin/tool/replace/cli','replace.php',25],['auth/db/cli','sync_users.php',45],['admin/cli','automated_backups.php',29],['enrol/manual/cli','sync.php',30],['lib/editor/tinymce/cli','update_lang_files.php',25],['auth/ldap/cli','sync_users.php',47],['admin/cli','fix_deleted_users.php',26],['admin/cli','maintenance.php',26],['lib/tests/behat','behat_hooks.php',133],['admin/cli','reset_password.php',27],['admin/tool/dbtransfer/cli','migrate.php',30],['enrol/category/cli','sync.php',33],['admin/cli','mysql_compressed_rows.php',26],['enrol/paypal/cli','sync.php',30],['admin/cli','cron.php',31],['enrol/database/cli','sync.php',34],['admin/cli','mysql_collation.php',25],['auth/cas/cli','sync_users.php',43],['enrol/cohort/cli','sync.php',31],['admin/tool/generator/cli','maketestcourse.php',25],['admin/cli','backup.php',26],['search/cli','indexer.php',25],['admin/cli','check_database_schema.php',26],['admin/tool/behat/cli','util_single_run.php',90],['enrol/self/cli','sync.php',31],['','install.php',46],['theme/base/cli','svgtool.php',26],['admin','cron.php',47],['admin/tool/behat/cli','init.php',36],['enrol/meta/cli','sync.php',31],['admin/cli','alternative_component_cache.php',30],['admin/tool/generator/cli','maketestplan.php',25],['lib/phpunit','bootstrap.php',73],['lib','setup.php',289],['mod/chat','chatd.php',25],['lib/filestorage/tests/fixtures','zip_info.php',25],['enrol/flatfile/cli','sync.php',45],['admin/cli','mysql_engine.php',27]], 114],
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',140],['','install.php',93],['lib','setup.php',391]], 4153],
'MUST_EXIST': ['MUST_EXIST', '', [['lib','dmllib.php',52]], 1384],
'MAX_COURSES_IN_CATEGORY': ['MAX_COURSES_IN_CATEGORY', '', [['lib','datalib.php',35]], 12],
'SYSCONTEXTID': ['SYSCONTEXTID', '', [['lib','accesslib.php',6316]], 72],
'SITEID': ['SITEID', '', [['admin/cli','install.php',219],['lib/db','install.php',87],['','install.php',242],['lib','setup.php',755]], 608]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Aug 11 10:00:09 2016</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
