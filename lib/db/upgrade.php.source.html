<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /lib/db/upgrade.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Aug 11 10:00:09 2016 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='lib/db';
filename='upgrade.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/lib/db/</a> -> <a href="upgrade.php.html">upgrade.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="upgrade.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="upgrade.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * This file keeps track of upgrades to Moodle.</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * Sometimes, changes between versions involve</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * alterations to database structures and other</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * major things that may break installations.</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> *</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> * The upgrade function in this file will attempt</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment"> * to perform all the necessary actions to upgrade</span>
<a name="l26"><span class="linenum">  26</span></a>  <span class="comment"> * your older installation to the current version.</span>
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment"> *</span>
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment"> * If there's something it cannot do itself, it</span>
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment"> * will tell you what you need to do.</span>
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment"> *</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment"> * The commands in here will all be database-neutral,</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> * using the methods of database_manager class</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> *</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> * Please do not forget to use upgrade_set_timeout()</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> * before any action that may take longer time to finish.</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment"> *</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment"> * @package   core_install</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment"> * @category  upgrade</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="comment"> * @copyright 2006 onwards Martin Dougiamas  http://dougiamas.com</span>
<a name="l40"><span class="linenum">  40</span></a>  <span class="comment"> * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l41"><span class="linenum">  41</span></a>  <span class="comment"> */</span>
<a name="l42"><span class="linenum">  42</span></a>  
<a name="l43"><span class="linenum">  43</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die();
<a name="l44"><span class="linenum">  44</span></a>  
<a name="l45"><span class="linenum">  45</span></a>  <span class="comment">/**</span>
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment"> * Main upgrade tasks to be executed on Moodle version bump</span>
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment"> *</span>
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment"> * This function is automatically executed after one bump in the Moodle core</span>
<a name="l49"><span class="linenum">  49</span></a>  <span class="comment"> * version is detected. It's in charge of performing the required tasks</span>
<a name="l50"><span class="linenum">  50</span></a>  <span class="comment"> * to raise core from the previous version to the next one.</span>
<a name="l51"><span class="linenum">  51</span></a>  <span class="comment"> *</span>
<a name="l52"><span class="linenum">  52</span></a>  <span class="comment"> * It's a collection of ordered blocks of code, named &quot;upgrade steps&quot;,</span>
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment"> * each one performing one isolated (from the rest of steps) task. Usually</span>
<a name="l54"><span class="linenum">  54</span></a>  <span class="comment"> * tasks involve creating new DB objects or performing manipulation of the</span>
<a name="l55"><span class="linenum">  55</span></a>  <span class="comment"> * information for cleanup/fixup purposes.</span>
<a name="l56"><span class="linenum">  56</span></a>  <span class="comment"> *</span>
<a name="l57"><span class="linenum">  57</span></a>  <span class="comment"> * Each upgrade step has a fixed structure, that can be summarised as follows:</span>
<a name="l58"><span class="linenum">  58</span></a>  <span class="comment"> *</span>
<a name="l59"><span class="linenum">  59</span></a>  <span class="comment"> * if ($oldversion &lt; XXXXXXXXXX.XX) {</span>
<a name="l60"><span class="linenum">  60</span></a>  <span class="comment"> *     // Explanation of the update step, linking to issue in the Tracker if necessary</span>
<a name="l61"><span class="linenum">  61</span></a>  <span class="comment"> *     upgrade_set_timeout(XX); // Optional for big tasks</span>
<a name="l62"><span class="linenum">  62</span></a>  <span class="comment"> *     // Code to execute goes here, usually the XMLDB Editor will</span>
<a name="l63"><span class="linenum">  63</span></a>  <span class="comment"> *     // help you here. See {@link http://docs.moodle.org/dev/XMLDB_editor}.</span>
<a name="l64"><span class="linenum">  64</span></a>  <span class="comment"> *     upgrade_main_savepoint(true, XXXXXXXXXX.XX);</span>
<a name="l65"><span class="linenum">  65</span></a>  <span class="comment"> * }</span>
<a name="l66"><span class="linenum">  66</span></a>  <span class="comment"> *</span>
<a name="l67"><span class="linenum">  67</span></a>  <span class="comment"> * All plugins within Moodle (modules, blocks, reports...) support the existence of</span>
<a name="l68"><span class="linenum">  68</span></a>  <span class="comment"> * their own upgrade.php file, using the &quot;Frankenstyle&quot; component name as</span>
<a name="l69"><span class="linenum">  69</span></a>  <span class="comment"> * defined at {@link http://docs.moodle.org/dev/Frankenstyle}, for example:</span>
<a name="l70"><span class="linenum">  70</span></a>  <span class="comment"> *     - {@link xmldb_page_upgrade($oldversion)}. (modules don't require the plugintype (&quot;mod_&quot;) to be used.</span>
<a name="l71"><span class="linenum">  71</span></a>  <span class="comment"> *     - {@link xmldb_auth_manual_upgrade($oldversion)}.</span>
<a name="l72"><span class="linenum">  72</span></a>  <span class="comment"> *     - {@link xmldb_workshopform_accumulative_upgrade($oldversion)}.</span>
<a name="l73"><span class="linenum">  73</span></a>  <span class="comment"> *     - ....</span>
<a name="l74"><span class="linenum">  74</span></a>  <span class="comment"> *</span>
<a name="l75"><span class="linenum">  75</span></a>  <span class="comment"> * In order to keep the contents of this file reduced, it's allowed to create some helper</span>
<a name="l76"><span class="linenum">  76</span></a>  <span class="comment"> * functions to be used here in the {@link upgradelib.php} file at the same directory. Note</span>
<a name="l77"><span class="linenum">  77</span></a>  <span class="comment"> * that such a file must be manually included from upgrade.php, and there are some restrictions</span>
<a name="l78"><span class="linenum">  78</span></a>  <span class="comment"> * about what can be used within it.</span>
<a name="l79"><span class="linenum">  79</span></a>  <span class="comment"> *</span>
<a name="l80"><span class="linenum">  80</span></a>  <span class="comment"> * For more information, take a look to the documentation available:</span>
<a name="l81"><span class="linenum">  81</span></a>  <span class="comment"> *     - Data definition API: {@link http://docs.moodle.org/dev/Data_definition_API}</span>
<a name="l82"><span class="linenum">  82</span></a>  <span class="comment"> *     - Upgrade API: {@link http://docs.moodle.org/dev/Upgrade_API}</span>
<a name="l83"><span class="linenum">  83</span></a>  <span class="comment"> *</span>
<a name="l84"><span class="linenum">  84</span></a>  <span class="comment"> * @param int $oldversion</span>
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment"> * @return bool always true</span>
<a name="l86"><span class="linenum">  86</span></a>  <span class="comment"> */</span>
<a name="l87"><span class="linenum">  87</span></a>  function <a class="function" onClick="logFunction('xmldb_main_upgrade')" href="../../_functions/xmldb_main_upgrade.html" onMouseOver="funcPopup(event,'xmldb_main_upgrade')">xmldb_main_upgrade</a>(<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a>) {
<a name="l88"><span class="linenum">  88</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l89"><span class="linenum">  89</span></a>  
<a name="l90"><span class="linenum">  90</span></a>      require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a>.'/db/upgradelib.php'); <span class="comment">// Core Upgrade-related functions.</span>
<a name="l91"><span class="linenum">  91</span></a>  
<a name="l92"><span class="linenum">  92</span></a>      <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_manager')" href="../../_functions/get_manager.html" onMouseOver="funcPopup(event,'get_manager')">get_manager</a>(); <span class="comment">// Loads ddl manager and xmldb classes.</span>
<a name="l93"><span class="linenum">  93</span></a>  
<a name="l94"><span class="linenum">  94</span></a>  <span class="comment">    // Always keep this upgrade step with version being the minimum</span>
<a name="l95"><span class="linenum">  95</span></a>  <span class="comment">    // allowed version to upgrade from (v2.7.0 right now).</span>
<a name="l96"><span class="linenum">  96</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014051200) {
<a name="l97"><span class="linenum">  97</span></a>  <span class="comment">        // Just in case somebody hacks upgrade scripts or env, we really can not continue.</span>
<a name="l98"><span class="linenum">  98</span></a>          echo(&quot;You need to upgrade to 2.7.x or higher first!\n&quot;);
<a name="l99"><span class="linenum">  99</span></a>          exit(1);
<a name="l100"><span class="linenum"> 100</span></a>  <span class="comment">        // Note this savepoint is 100% unreachable, but needed to pass the upgrade checks.</span>
<a name="l101"><span class="linenum"> 101</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014051200);
<a name="l102"><span class="linenum"> 102</span></a>      }
<a name="l103"><span class="linenum"> 103</span></a>  
<a name="l104"><span class="linenum"> 104</span></a>  <span class="comment">    // MDL-32543 Make sure that the log table has correct length for action and url fields.</span>
<a name="l105"><span class="linenum"> 105</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014051200.02) {
<a name="l106"><span class="linenum"> 106</span></a>  
<a name="l107"><span class="linenum"> 107</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('log');
<a name="l108"><span class="linenum"> 108</span></a>  
<a name="l109"><span class="linenum"> 109</span></a>          <a class="var it734" onMouseOver="hilite(734)" onMouseOut="lolite()" onClick="logVariable('columns')" href="../../_variables/columns.html">$columns</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_columns')" href="../../_functions/get_columns.html" onMouseOver="funcPopup(event,'get_columns')">get_columns</a>('log');
<a name="l110"><span class="linenum"> 110</span></a>          if (<a class="var it734" onMouseOver="hilite(734)" onMouseOut="lolite()" onClick="logVariable('columns')" href="../../_variables/columns.html">$columns</a>['action']-&gt;max_length &lt; 40) {
<a name="l111"><span class="linenum"> 111</span></a>              <a class="var it6564" onMouseOver="hilite(6564)" onMouseOut="lolite()" onClick="logVariable('index1')" href="../../_variables/index1.html">$index1</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('course-module-action', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('course', 'module', 'action'));
<a name="l112"><span class="linenum"> 112</span></a>              if (<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it6564" onMouseOver="hilite(6564)" onMouseOut="lolite()" onClick="logVariable('index1')" href="../../_variables/index1.html">$index1</a>)) {
<a name="l113"><span class="linenum"> 113</span></a>                  <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('drop_index')" href="../../_functions/drop_index.html" onMouseOver="funcPopup(event,'drop_index')">drop_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it6564" onMouseOver="hilite(6564)" onMouseOut="lolite()" onClick="logVariable('index1')" href="../../_variables/index1.html">$index1</a>);
<a name="l114"><span class="linenum"> 114</span></a>              }
<a name="l115"><span class="linenum"> 115</span></a>              <a class="var it6565" onMouseOver="hilite(6565)" onMouseOut="lolite()" onClick="logVariable('index2')" href="../../_variables/index2.html">$index2</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('action', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('action'));
<a name="l116"><span class="linenum"> 116</span></a>              if (<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it6565" onMouseOver="hilite(6565)" onMouseOut="lolite()" onClick="logVariable('index2')" href="../../_variables/index2.html">$index2</a>)) {
<a name="l117"><span class="linenum"> 117</span></a>                  <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('drop_index')" href="../../_functions/drop_index.html" onMouseOver="funcPopup(event,'drop_index')">drop_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it6565" onMouseOver="hilite(6565)" onMouseOut="lolite()" onClick="logVariable('index2')" href="../../_variables/index2.html">$index2</a>);
<a name="l118"><span class="linenum"> 118</span></a>              }
<a name="l119"><span class="linenum"> 119</span></a>              <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('action', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '40', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null, 'cmid');
<a name="l120"><span class="linenum"> 120</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('change_field_precision')" href="../../_functions/change_field_precision.html" onMouseOver="funcPopup(event,'change_field_precision')">change_field_precision</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l121"><span class="linenum"> 121</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it6564" onMouseOver="hilite(6564)" onMouseOut="lolite()" onClick="logVariable('index1')" href="../../_variables/index1.html">$index1</a>);
<a name="l122"><span class="linenum"> 122</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it6565" onMouseOver="hilite(6565)" onMouseOut="lolite()" onClick="logVariable('index2')" href="../../_variables/index2.html">$index2</a>);
<a name="l123"><span class="linenum"> 123</span></a>          }
<a name="l124"><span class="linenum"> 124</span></a>  
<a name="l125"><span class="linenum"> 125</span></a>          if (<a class="var it734" onMouseOver="hilite(734)" onMouseOut="lolite()" onClick="logVariable('columns')" href="../../_variables/columns.html">$columns</a>['url']-&gt;max_length &lt; 100) {
<a name="l126"><span class="linenum"> 126</span></a>              <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('url', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '100', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null, 'action');
<a name="l127"><span class="linenum"> 127</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('change_field_precision')" href="../../_functions/change_field_precision.html" onMouseOver="funcPopup(event,'change_field_precision')">change_field_precision</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l128"><span class="linenum"> 128</span></a>          }
<a name="l129"><span class="linenum"> 129</span></a>  
<a name="l130"><span class="linenum"> 130</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014051200.02);
<a name="l131"><span class="linenum"> 131</span></a>      }
<a name="l132"><span class="linenum"> 132</span></a>  
<a name="l133"><span class="linenum"> 133</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014060300.00) {
<a name="l134"><span class="linenum"> 134</span></a>          <a class="var it28878" onMouseOver="hilite(28878)" onMouseOut="lolite()" onClick="logVariable('gspath')" href="../../_variables/gspath.html">$gspath</a> = <a class="function" onClick="logFunction('get_config')" href="../../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>('assignfeedback_editpdf', 'gspath');
<a name="l135"><span class="linenum"> 135</span></a>          if (<a class="var it28878" onMouseOver="hilite(28878)" onMouseOut="lolite()" onClick="logVariable('gspath')" href="../../_variables/gspath.html">$gspath</a> !== false) {
<a name="l136"><span class="linenum"> 136</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('pathtogs', <a class="var it28878" onMouseOver="hilite(28878)" onMouseOut="lolite()" onClick="logVariable('gspath')" href="../../_variables/gspath.html">$gspath</a>);
<a name="l137"><span class="linenum"> 137</span></a>              <a class="function" onClick="logFunction('unset_config')" href="../../_functions/unset_config.html" onMouseOver="funcPopup(event,'unset_config')">unset_config</a>('gspath', 'assignfeedback_editpdf');
<a name="l138"><span class="linenum"> 138</span></a>          }
<a name="l139"><span class="linenum"> 139</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014060300.00);
<a name="l140"><span class="linenum"> 140</span></a>      }
<a name="l141"><span class="linenum"> 141</span></a>  
<a name="l142"><span class="linenum"> 142</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014061000.00) {
<a name="l143"><span class="linenum"> 143</span></a>  <span class="comment">        // Fixing possible wrong MIME type for Publisher files.</span>
<a name="l144"><span class="linenum"> 144</span></a>          <a class="var it29610" onMouseOver="hilite(29610)" onMouseOut="lolite()" onClick="logVariable('filetypes')" href="../../_variables/filetypes.html">$filetypes</a> = array('%.pub'=&gt;'application/x-mspublisher');
<a name="l145"><span class="linenum"> 145</span></a>          <a class="function" onClick="logFunction('upgrade_mimetypes')" href="../../_functions/upgrade_mimetypes.html" onMouseOver="funcPopup(event,'upgrade_mimetypes')">upgrade_mimetypes</a>(<a class="var it29610" onMouseOver="hilite(29610)" onMouseOut="lolite()" onClick="logVariable('filetypes')" href="../../_variables/filetypes.html">$filetypes</a>);
<a name="l146"><span class="linenum"> 146</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014061000.00);
<a name="l147"><span class="linenum"> 147</span></a>      }
<a name="l148"><span class="linenum"> 148</span></a>  
<a name="l149"><span class="linenum"> 149</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014062600.01) {
<a name="l150"><span class="linenum"> 150</span></a>  <span class="comment">        // We only want to delete DragMath if the directory no longer exists. If the directory</span>
<a name="l151"><span class="linenum"> 151</span></a>  <span class="comment">        // is present then it means it has been restored, so do not perform the uninstall.</span>
<a name="l152"><span class="linenum"> 152</span></a>          if (!<a class="function" onClick="logFunction('check_dir_exists')" href="../../_functions/check_dir_exists.html" onMouseOver="funcPopup(event,'check_dir_exists')">check_dir_exists</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a> . '/editor/tinymce/plugins/dragmath', false)) {
<a name="l153"><span class="linenum"> 153</span></a>  <span class="comment">            // Purge DragMath plugin which is incompatible with GNU GPL license.</span>
<a name="l154"><span class="linenum"> 154</span></a>              <a class="function" onClick="logFunction('unset_all_config_for_plugin')" href="../../_functions/unset_all_config_for_plugin.html" onMouseOver="funcPopup(event,'unset_all_config_for_plugin')">unset_all_config_for_plugin</a>('tinymce_dragmath');
<a name="l155"><span class="linenum"> 155</span></a>          }
<a name="l156"><span class="linenum"> 156</span></a>  
<a name="l157"><span class="linenum"> 157</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l158"><span class="linenum"> 158</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014062600.01);
<a name="l159"><span class="linenum"> 159</span></a>      }
<a name="l160"><span class="linenum"> 160</span></a>  
<a name="l161"><span class="linenum"> 161</span></a>  <span class="comment">    // Switch the order of the fields in the files_reference index, to improve the performance of search_references.</span>
<a name="l162"><span class="linenum"> 162</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014070100.00) {
<a name="l163"><span class="linenum"> 163</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('files_reference');
<a name="l164"><span class="linenum"> 164</span></a>          <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('uq_external_file', <a class="constant" onClick="logConstant('XMLDB_INDEX_UNIQUE')" href="../../_constants/XMLDB_INDEX_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_UNIQUE')">XMLDB_INDEX_UNIQUE</a>, array('repositoryid', 'referencehash'));
<a name="l165"><span class="linenum"> 165</span></a>          if (<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>)) {
<a name="l166"><span class="linenum"> 166</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('drop_index')" href="../../_functions/drop_index.html" onMouseOver="funcPopup(event,'drop_index')">drop_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>);
<a name="l167"><span class="linenum"> 167</span></a>          }
<a name="l168"><span class="linenum"> 168</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014070100.00);
<a name="l169"><span class="linenum"> 169</span></a>      }
<a name="l170"><span class="linenum"> 170</span></a>  
<a name="l171"><span class="linenum"> 171</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014070101.00) {
<a name="l172"><span class="linenum"> 172</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('files_reference');
<a name="l173"><span class="linenum"> 173</span></a>          <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('uq_external_file', <a class="constant" onClick="logConstant('XMLDB_INDEX_UNIQUE')" href="../../_constants/XMLDB_INDEX_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_UNIQUE')">XMLDB_INDEX_UNIQUE</a>, array('referencehash', 'repositoryid'));
<a name="l174"><span class="linenum"> 174</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>)) {
<a name="l175"><span class="linenum"> 175</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>);
<a name="l176"><span class="linenum"> 176</span></a>          }
<a name="l177"><span class="linenum"> 177</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014070101.00);
<a name="l178"><span class="linenum"> 178</span></a>      }
<a name="l179"><span class="linenum"> 179</span></a>  
<a name="l180"><span class="linenum"> 180</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014072400.01) {
<a name="l181"><span class="linenum"> 181</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('user_devices');
<a name="l182"><span class="linenum"> 182</span></a>          <a class="var it23283" onMouseOver="hilite(23283)" onMouseOut="lolite()" onClick="logVariable('oldindex')" href="../../_variables/oldindex.html">$oldindex</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('pushid-platform', <a class="constant" onClick="logConstant('XMLDB_KEY_UNIQUE')" href="../../_constants/XMLDB_KEY_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_KEY_UNIQUE')">XMLDB_KEY_UNIQUE</a>, array('pushid', 'platform'));
<a name="l183"><span class="linenum"> 183</span></a>          if (<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it23283" onMouseOver="hilite(23283)" onMouseOut="lolite()" onClick="logVariable('oldindex')" href="../../_variables/oldindex.html">$oldindex</a>)) {
<a name="l184"><span class="linenum"> 184</span></a>              <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_key')" href="../../_classes/xmldb_key.html" onMouseOver="classPopup(event,'xmldb_key')">xmldb_key</a>('pushid-platform', <a class="constant" onClick="logConstant('XMLDB_KEY_UNIQUE')" href="../../_constants/XMLDB_KEY_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_KEY_UNIQUE')">XMLDB_KEY_UNIQUE</a>, array('pushid', 'platform'));
<a name="l185"><span class="linenum"> 185</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('drop_key')" href="../../_functions/drop_key.html" onMouseOver="funcPopup(event,'drop_key')">drop_key</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>);
<a name="l186"><span class="linenum"> 186</span></a>          }
<a name="l187"><span class="linenum"> 187</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014072400.01);
<a name="l188"><span class="linenum"> 188</span></a>      }
<a name="l189"><span class="linenum"> 189</span></a>  
<a name="l190"><span class="linenum"> 190</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014080801.00) {
<a name="l191"><span class="linenum"> 191</span></a>  
<a name="l192"><span class="linenum"> 192</span></a>  <span class="comment">        // Define index behaviour (not unique) to be added to question_attempts.</span>
<a name="l193"><span class="linenum"> 193</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('question_attempts');
<a name="l194"><span class="linenum"> 194</span></a>          <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('behaviour', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('behaviour'));
<a name="l195"><span class="linenum"> 195</span></a>  
<a name="l196"><span class="linenum"> 196</span></a>  <span class="comment">        // Conditionally launch add index behaviour.</span>
<a name="l197"><span class="linenum"> 197</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>)) {
<a name="l198"><span class="linenum"> 198</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>);
<a name="l199"><span class="linenum"> 199</span></a>          }
<a name="l200"><span class="linenum"> 200</span></a>  
<a name="l201"><span class="linenum"> 201</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l202"><span class="linenum"> 202</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014080801.00);
<a name="l203"><span class="linenum"> 203</span></a>      }
<a name="l204"><span class="linenum"> 204</span></a>  
<a name="l205"><span class="linenum"> 205</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014082900.01) {
<a name="l206"><span class="linenum"> 206</span></a>  <span class="comment">        // Fixing possible wrong MIME type for 7-zip and Rar files.</span>
<a name="l207"><span class="linenum"> 207</span></a>          <a class="var it29610" onMouseOver="hilite(29610)" onMouseOut="lolite()" onClick="logVariable('filetypes')" href="../../_variables/filetypes.html">$filetypes</a> = array(
<a name="l208"><span class="linenum"> 208</span></a>                  '%.7z' =&gt; 'application/x-7z-compressed',
<a name="l209"><span class="linenum"> 209</span></a>                  '%.rar' =&gt; 'application/x-rar-compressed');
<a name="l210"><span class="linenum"> 210</span></a>          <a class="function" onClick="logFunction('upgrade_mimetypes')" href="../../_functions/upgrade_mimetypes.html" onMouseOver="funcPopup(event,'upgrade_mimetypes')">upgrade_mimetypes</a>(<a class="var it29610" onMouseOver="hilite(29610)" onMouseOut="lolite()" onClick="logVariable('filetypes')" href="../../_variables/filetypes.html">$filetypes</a>);
<a name="l211"><span class="linenum"> 211</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014082900.01);
<a name="l212"><span class="linenum"> 212</span></a>      }
<a name="l213"><span class="linenum"> 213</span></a>  
<a name="l214"><span class="linenum"> 214</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014082900.02) {
<a name="l215"><span class="linenum"> 215</span></a>  <span class="comment">        // Replace groupmembersonly usage with new availability system.</span>
<a name="l216"><span class="linenum"> 216</span></a>          <a class="var it4224" onMouseOver="hilite(4224)" onMouseOut="lolite()" onClick="logVariable('transaction')" href="../../_variables/transaction.html">$transaction</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('start_delegated_transaction')" href="../../_functions/start_delegated_transaction.html" onMouseOver="funcPopup(event,'start_delegated_transaction')">start_delegated_transaction</a>();
<a name="l217"><span class="linenum"> 217</span></a>          if (<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('enablegroupmembersonly')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/enablegroupmembersonly.html">enablegroupmembersonly</a>) {
<a name="l218"><span class="linenum"> 218</span></a>  <span class="comment">            // If it isn't already enabled, we need to enable availability.</span>
<a name="l219"><span class="linenum"> 219</span></a>              if (!<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('enableavailability')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/enableavailability.html">enableavailability</a>) {
<a name="l220"><span class="linenum"> 220</span></a>                  <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('enableavailability', 1);
<a name="l221"><span class="linenum"> 221</span></a>              }
<a name="l222"><span class="linenum"> 222</span></a>  
<a name="l223"><span class="linenum"> 223</span></a>  <span class="comment">            // Count all course-modules with groupmembersonly set (for progress</span>
<a name="l224"><span class="linenum"> 224</span></a>  <span class="comment">            // bar).</span>
<a name="l225"><span class="linenum"> 225</span></a>              <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('total')" href="../../_variables/total.html">$total</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records')" href="../../_functions/count_records.html" onMouseOver="funcPopup(event,'count_records')">count_records</a>('course_modules', array('groupmembersonly' =&gt; 1));
<a name="l226"><span class="linenum"> 226</span></a>              <a class="var it4895" onMouseOver="hilite(4895)" onMouseOut="lolite()" onClick="logVariable('pbar')" href="../../_variables/pbar.html">$pbar</a> = <span class="keyword">new </span><a class="class" onClick="logClass('progress_bar')" href="../../_classes/progress_bar.html" onMouseOver="classPopup(event,'progress_bar')">progress_bar</a>('upgradegroupmembersonly', 500, true);
<a name="l227"><span class="linenum"> 227</span></a>  
<a name="l228"><span class="linenum"> 228</span></a>  <span class="comment">            // Get all these course-modules, one at a time.</span>
<a name="l229"><span class="linenum"> 229</span></a>              <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../_variables/rs.html">$rs</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset')" href="../../_functions/get_recordset.html" onMouseOver="funcPopup(event,'get_recordset')">get_recordset</a>('course_modules', array('groupmembersonly' =&gt; 1),
<a name="l230"><span class="linenum"> 230</span></a>                      'course, id');
<a name="l231"><span class="linenum"> 231</span></a>              <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> = 0;
<a name="l232"><span class="linenum"> 232</span></a>              foreach (<a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../_variables/rs.html">$rs</a> as <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>) {
<a name="l233"><span class="linenum"> 233</span></a>  <span class="comment">                // Calculate and set new availability value.</span>
<a name="l234"><span class="linenum"> 234</span></a>                  <a class="var it8486" onMouseOver="hilite(8486)" onMouseOut="lolite()" onClick="logVariable('availability')" href="../../_variables/availability.html">$availability</a> = <a class="function" onClick="logFunction('upgrade_group_members_only')" href="../../_functions/upgrade_group_members_only.html" onMouseOver="funcPopup(event,'upgrade_group_members_only')">upgrade_group_members_only</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('groupingid')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/groupingid.html">groupingid</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('availability')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/availability.html">availability</a>);
<a name="l235"><span class="linenum"> 235</span></a>                  <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('course_modules', 'availability', <a class="var it8486" onMouseOver="hilite(8486)" onMouseOut="lolite()" onClick="logVariable('availability')" href="../../_variables/availability.html">$availability</a>,
<a name="l236"><span class="linenum"> 236</span></a>                          array('id' =&gt; <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l237"><span class="linenum"> 237</span></a>  
<a name="l238"><span class="linenum"> 238</span></a>  <span class="comment">                // Update progress.</span>
<a name="l239"><span class="linenum"> 239</span></a>                  <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>++;
<a name="l240"><span class="linenum"> 240</span></a>                  <a class="var it4895" onMouseOver="hilite(4895)" onMouseOut="lolite()" onClick="logVariable('pbar')" href="../../_variables/pbar.html">$pbar</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>(<a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>, <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('total')" href="../../_variables/total.html">$total</a>, &quot;Upgrading groupmembersonly settings - <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>/<a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('total')" href="../../_variables/total.html">$total</a>.&quot;);
<a name="l241"><span class="linenum"> 241</span></a>              }
<a name="l242"><span class="linenum"> 242</span></a>              <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../_variables/rs.html">$rs</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l243"><span class="linenum"> 243</span></a>          }
<a name="l244"><span class="linenum"> 244</span></a>  
<a name="l245"><span class="linenum"> 245</span></a>  <span class="comment">        // Define field groupmembersonly to be dropped from course_modules.</span>
<a name="l246"><span class="linenum"> 246</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('course_modules');
<a name="l247"><span class="linenum"> 247</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('groupmembersonly');
<a name="l248"><span class="linenum"> 248</span></a>  
<a name="l249"><span class="linenum"> 249</span></a>  <span class="comment">        // Conditionally launch drop field groupmembersonly.</span>
<a name="l250"><span class="linenum"> 250</span></a>          if (<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>)) {
<a name="l251"><span class="linenum"> 251</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('drop_field')" href="../../_functions/drop_field.html" onMouseOver="funcPopup(event,'drop_field')">drop_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l252"><span class="linenum"> 252</span></a>          }
<a name="l253"><span class="linenum"> 253</span></a>  
<a name="l254"><span class="linenum"> 254</span></a>  <span class="comment">        // Unset old config variable.</span>
<a name="l255"><span class="linenum"> 255</span></a>          <a class="function" onClick="logFunction('unset_config')" href="../../_functions/unset_config.html" onMouseOver="funcPopup(event,'unset_config')">unset_config</a>('enablegroupmembersonly');
<a name="l256"><span class="linenum"> 256</span></a>          <a class="var it4224" onMouseOver="hilite(4224)" onMouseOut="lolite()" onClick="logVariable('transaction')" href="../../_variables/transaction.html">$transaction</a>-&gt;<a class="function" onClick="logFunction('allow_commit')" href="../../_functions/allow_commit.html" onMouseOver="funcPopup(event,'allow_commit')">allow_commit</a>();
<a name="l257"><span class="linenum"> 257</span></a>  
<a name="l258"><span class="linenum"> 258</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014082900.02);
<a name="l259"><span class="linenum"> 259</span></a>      }
<a name="l260"><span class="linenum"> 260</span></a>  
<a name="l261"><span class="linenum"> 261</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014100100.00) {
<a name="l262"><span class="linenum"> 262</span></a>  
<a name="l263"><span class="linenum"> 263</span></a>  <span class="comment">        // Define table messageinbound_handlers to be created.</span>
<a name="l264"><span class="linenum"> 264</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('messageinbound_handlers');
<a name="l265"><span class="linenum"> 265</span></a>  
<a name="l266"><span class="linenum"> 266</span></a>  <span class="comment">        // Adding fields to table messageinbound_handlers.</span>
<a name="l267"><span class="linenum"> 267</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l268"><span class="linenum"> 268</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('component', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '100', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l269"><span class="linenum"> 269</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('classname', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '255', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l270"><span class="linenum"> 270</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('defaultexpiration', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '86400');
<a name="l271"><span class="linenum"> 271</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('validateaddress', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '1', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '1');
<a name="l272"><span class="linenum"> 272</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('enabled', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '1', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0');
<a name="l273"><span class="linenum"> 273</span></a>  
<a name="l274"><span class="linenum"> 274</span></a>  <span class="comment">        // Adding keys to table messageinbound_handlers.</span>
<a name="l275"><span class="linenum"> 275</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l276"><span class="linenum"> 276</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('classname', <a class="constant" onClick="logConstant('XMLDB_KEY_UNIQUE')" href="../../_constants/XMLDB_KEY_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_KEY_UNIQUE')">XMLDB_KEY_UNIQUE</a>, array('classname'));
<a name="l277"><span class="linenum"> 277</span></a>  
<a name="l278"><span class="linenum"> 278</span></a>  <span class="comment">        // Conditionally launch create table for messageinbound_handlers.</span>
<a name="l279"><span class="linenum"> 279</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l280"><span class="linenum"> 280</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l281"><span class="linenum"> 281</span></a>          }
<a name="l282"><span class="linenum"> 282</span></a>  
<a name="l283"><span class="linenum"> 283</span></a>  <span class="comment">        // Define table messageinbound_datakeys to be created.</span>
<a name="l284"><span class="linenum"> 284</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('messageinbound_datakeys');
<a name="l285"><span class="linenum"> 285</span></a>  
<a name="l286"><span class="linenum"> 286</span></a>  <span class="comment">        // Adding fields to table messageinbound_datakeys.</span>
<a name="l287"><span class="linenum"> 287</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l288"><span class="linenum"> 288</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('handler', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l289"><span class="linenum"> 289</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('datavalue', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l290"><span class="linenum"> 290</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('datakey', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '64', null, null, null, null);
<a name="l291"><span class="linenum"> 291</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timecreated', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l292"><span class="linenum"> 292</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('expires', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l293"><span class="linenum"> 293</span></a>  
<a name="l294"><span class="linenum"> 294</span></a>  <span class="comment">        // Adding keys to table messageinbound_datakeys.</span>
<a name="l295"><span class="linenum"> 295</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l296"><span class="linenum"> 296</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('handler_datavalue', <a class="constant" onClick="logConstant('XMLDB_KEY_UNIQUE')" href="../../_constants/XMLDB_KEY_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_KEY_UNIQUE')">XMLDB_KEY_UNIQUE</a>, array('handler', 'datavalue'));
<a name="l297"><span class="linenum"> 297</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('handler', <a class="constant" onClick="logConstant('XMLDB_KEY_FOREIGN')" href="../../_constants/XMLDB_KEY_FOREIGN.html" onMouseOver="constPopup(event,'XMLDB_KEY_FOREIGN')">XMLDB_KEY_FOREIGN</a>, array('handler'), 'messageinbound_handlers', array('id'));
<a name="l298"><span class="linenum"> 298</span></a>  
<a name="l299"><span class="linenum"> 299</span></a>  <span class="comment">        // Conditionally launch create table for messageinbound_datakeys.</span>
<a name="l300"><span class="linenum"> 300</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l301"><span class="linenum"> 301</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l302"><span class="linenum"> 302</span></a>          }
<a name="l303"><span class="linenum"> 303</span></a>  
<a name="l304"><span class="linenum"> 304</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l305"><span class="linenum"> 305</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014100100.00);
<a name="l306"><span class="linenum"> 306</span></a>      }
<a name="l307"><span class="linenum"> 307</span></a>  
<a name="l308"><span class="linenum"> 308</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014100600.01) {
<a name="l309"><span class="linenum"> 309</span></a>  <span class="comment">        // Define field aggregationstatus to be added to grade_grades.</span>
<a name="l310"><span class="linenum"> 310</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('grade_grades');
<a name="l311"><span class="linenum"> 311</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('aggregationstatus', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, 'unknown', 'timemodified');
<a name="l312"><span class="linenum"> 312</span></a>  
<a name="l313"><span class="linenum"> 313</span></a>  <span class="comment">        // Conditionally launch add field aggregationstatus.</span>
<a name="l314"><span class="linenum"> 314</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>)) {
<a name="l315"><span class="linenum"> 315</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l316"><span class="linenum"> 316</span></a>          }
<a name="l317"><span class="linenum"> 317</span></a>  
<a name="l318"><span class="linenum"> 318</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('aggregationweight', <a class="constant" onClick="logConstant('XMLDB_TYPE_NUMBER')" href="../../_constants/XMLDB_TYPE_NUMBER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_NUMBER')">XMLDB_TYPE_NUMBER</a>, '10, 5', null, null, null, null, 'aggregationstatus');
<a name="l319"><span class="linenum"> 319</span></a>  
<a name="l320"><span class="linenum"> 320</span></a>  <span class="comment">        // Conditionally launch add field aggregationweight.</span>
<a name="l321"><span class="linenum"> 321</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>)) {
<a name="l322"><span class="linenum"> 322</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l323"><span class="linenum"> 323</span></a>          }
<a name="l324"><span class="linenum"> 324</span></a>  
<a name="l325"><span class="linenum"> 325</span></a>  <span class="comment">        // Define field aggregationcoef2 to be added to grade_items.</span>
<a name="l326"><span class="linenum"> 326</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('grade_items');
<a name="l327"><span class="linenum"> 327</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('aggregationcoef2', <a class="constant" onClick="logConstant('XMLDB_TYPE_NUMBER')" href="../../_constants/XMLDB_TYPE_NUMBER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_NUMBER')">XMLDB_TYPE_NUMBER</a>, '10, 5', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0', 'aggregationcoef');
<a name="l328"><span class="linenum"> 328</span></a>  
<a name="l329"><span class="linenum"> 329</span></a>  <span class="comment">        // Conditionally launch add field aggregationcoef2.</span>
<a name="l330"><span class="linenum"> 330</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>)) {
<a name="l331"><span class="linenum"> 331</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l332"><span class="linenum"> 332</span></a>          }
<a name="l333"><span class="linenum"> 333</span></a>  
<a name="l334"><span class="linenum"> 334</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('weightoverride', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '1', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0', 'needsupdate');
<a name="l335"><span class="linenum"> 335</span></a>  
<a name="l336"><span class="linenum"> 336</span></a>  <span class="comment">        // Conditionally launch add field weightoverride.</span>
<a name="l337"><span class="linenum"> 337</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>)) {
<a name="l338"><span class="linenum"> 338</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l339"><span class="linenum"> 339</span></a>          }
<a name="l340"><span class="linenum"> 340</span></a>  
<a name="l341"><span class="linenum"> 341</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l342"><span class="linenum"> 342</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014100600.01);
<a name="l343"><span class="linenum"> 343</span></a>      }
<a name="l344"><span class="linenum"> 344</span></a>  
<a name="l345"><span class="linenum"> 345</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014100600.02) {
<a name="l346"><span class="linenum"> 346</span></a>  
<a name="l347"><span class="linenum"> 347</span></a>  <span class="comment">        // Define field aggregationcoef2 to be added to grade_items_history.</span>
<a name="l348"><span class="linenum"> 348</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('grade_items_history');
<a name="l349"><span class="linenum"> 349</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('aggregationcoef2', <a class="constant" onClick="logConstant('XMLDB_TYPE_NUMBER')" href="../../_constants/XMLDB_TYPE_NUMBER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_NUMBER')">XMLDB_TYPE_NUMBER</a>, '10, 5', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0', 'aggregationcoef');
<a name="l350"><span class="linenum"> 350</span></a>  
<a name="l351"><span class="linenum"> 351</span></a>  <span class="comment">        // Conditionally launch add field aggregationcoef2.</span>
<a name="l352"><span class="linenum"> 352</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>)) {
<a name="l353"><span class="linenum"> 353</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l354"><span class="linenum"> 354</span></a>          }
<a name="l355"><span class="linenum"> 355</span></a>  
<a name="l356"><span class="linenum"> 356</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l357"><span class="linenum"> 357</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014100600.02);
<a name="l358"><span class="linenum"> 358</span></a>      }
<a name="l359"><span class="linenum"> 359</span></a>  
<a name="l360"><span class="linenum"> 360</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014100600.03) {
<a name="l361"><span class="linenum"> 361</span></a>  
<a name="l362"><span class="linenum"> 362</span></a>  <span class="comment">        // Define field weightoverride to be added to grade_items_history.</span>
<a name="l363"><span class="linenum"> 363</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('grade_items_history');
<a name="l364"><span class="linenum"> 364</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('weightoverride', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '1', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0', 'decimals');
<a name="l365"><span class="linenum"> 365</span></a>  
<a name="l366"><span class="linenum"> 366</span></a>  <span class="comment">        // Conditionally launch add field weightoverride.</span>
<a name="l367"><span class="linenum"> 367</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>)) {
<a name="l368"><span class="linenum"> 368</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l369"><span class="linenum"> 369</span></a>          }
<a name="l370"><span class="linenum"> 370</span></a>  
<a name="l371"><span class="linenum"> 371</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l372"><span class="linenum"> 372</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014100600.03);
<a name="l373"><span class="linenum"> 373</span></a>      }
<a name="l374"><span class="linenum"> 374</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014100600.04) {
<a name="l375"><span class="linenum"> 375</span></a>  <span class="comment">        // Set flags so we can display a notice on all courses that might</span>
<a name="l376"><span class="linenum"> 376</span></a>  <span class="comment">        // be affected by the uprade to natural aggregation.</span>
<a name="l377"><span class="linenum"> 377</span></a>          if (!<a class="function" onClick="logFunction('get_config')" href="../../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>('grades_sumofgrades_upgrade_flagged', 'core')) {
<a name="l378"><span class="linenum"> 378</span></a>  <span class="comment">            // 13 == SUM_OF_GRADES.</span>
<a name="l379"><span class="linenum"> 379</span></a>              <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = 'SELECT DISTINCT courseid
<a name="l380"><span class="linenum"> 380</span></a>                        FROM {grade_categories}
<a name="l381"><span class="linenum"> 381</span></a>                       WHERE aggregation = ?';
<a name="l382"><span class="linenum"> 382</span></a>              <a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, array(13));
<a name="l383"><span class="linenum"> 383</span></a>  
<a name="l384"><span class="linenum"> 384</span></a>              foreach (<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a> as <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>) {
<a name="l385"><span class="linenum"> 385</span></a>                  <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('show_sumofgrades_upgrade_' . <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('courseid')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>, 1);
<a name="l386"><span class="linenum"> 386</span></a>  <span class="comment">                // Set each of the grade items to needing an update so that when the user visits the grade reports the</span>
<a name="l387"><span class="linenum"> 387</span></a>  <span class="comment">                // figures will be updated.</span>
<a name="l388"><span class="linenum"> 388</span></a>                  <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('grade_items', 'needsupdate', 1, array('courseid' =&gt; <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('courseid')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>));
<a name="l389"><span class="linenum"> 389</span></a>              }
<a name="l390"><span class="linenum"> 390</span></a>  
<a name="l391"><span class="linenum"> 391</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('grades_sumofgrades_upgrade_flagged', 1);
<a name="l392"><span class="linenum"> 392</span></a>          }
<a name="l393"><span class="linenum"> 393</span></a>  
<a name="l394"><span class="linenum"> 394</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l395"><span class="linenum"> 395</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014100600.04);
<a name="l396"><span class="linenum"> 396</span></a>      }
<a name="l397"><span class="linenum"> 397</span></a>  
<a name="l398"><span class="linenum"> 398</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014100700.00) {
<a name="l399"><span class="linenum"> 399</span></a>  
<a name="l400"><span class="linenum"> 400</span></a>  <span class="comment">        // Define table messageinbound_messagelist to be created.</span>
<a name="l401"><span class="linenum"> 401</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('messageinbound_messagelist');
<a name="l402"><span class="linenum"> 402</span></a>  
<a name="l403"><span class="linenum"> 403</span></a>  <span class="comment">        // Adding fields to table messageinbound_messagelist.</span>
<a name="l404"><span class="linenum"> 404</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l405"><span class="linenum"> 405</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('messageid', <a class="constant" onClick="logConstant('XMLDB_TYPE_TEXT')" href="../../_constants/XMLDB_TYPE_TEXT.html" onMouseOver="constPopup(event,'XMLDB_TYPE_TEXT')">XMLDB_TYPE_TEXT</a>, null, null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l406"><span class="linenum"> 406</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('userid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l407"><span class="linenum"> 407</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('address', <a class="constant" onClick="logConstant('XMLDB_TYPE_TEXT')" href="../../_constants/XMLDB_TYPE_TEXT.html" onMouseOver="constPopup(event,'XMLDB_TYPE_TEXT')">XMLDB_TYPE_TEXT</a>, null, null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l408"><span class="linenum"> 408</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timecreated', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l409"><span class="linenum"> 409</span></a>  
<a name="l410"><span class="linenum"> 410</span></a>  <span class="comment">        // Adding keys to table messageinbound_messagelist.</span>
<a name="l411"><span class="linenum"> 411</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l412"><span class="linenum"> 412</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('userid', <a class="constant" onClick="logConstant('XMLDB_KEY_FOREIGN')" href="../../_constants/XMLDB_KEY_FOREIGN.html" onMouseOver="constPopup(event,'XMLDB_KEY_FOREIGN')">XMLDB_KEY_FOREIGN</a>, array('userid'), 'user', array('id'));
<a name="l413"><span class="linenum"> 413</span></a>  
<a name="l414"><span class="linenum"> 414</span></a>  <span class="comment">        // Conditionally launch create table for messageinbound_messagelist.</span>
<a name="l415"><span class="linenum"> 415</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l416"><span class="linenum"> 416</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l417"><span class="linenum"> 417</span></a>          }
<a name="l418"><span class="linenum"> 418</span></a>  
<a name="l419"><span class="linenum"> 419</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l420"><span class="linenum"> 420</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014100700.00);
<a name="l421"><span class="linenum"> 421</span></a>      }
<a name="l422"><span class="linenum"> 422</span></a>  
<a name="l423"><span class="linenum"> 423</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014100700.01) {
<a name="l424"><span class="linenum"> 424</span></a>  
<a name="l425"><span class="linenum"> 425</span></a>  <span class="comment">        // Define field visible to be added to cohort.</span>
<a name="l426"><span class="linenum"> 426</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('cohort');
<a name="l427"><span class="linenum"> 427</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('visible', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '1', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '1', 'descriptionformat');
<a name="l428"><span class="linenum"> 428</span></a>  
<a name="l429"><span class="linenum"> 429</span></a>  <span class="comment">        // Conditionally launch add field visible.</span>
<a name="l430"><span class="linenum"> 430</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>)) {
<a name="l431"><span class="linenum"> 431</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l432"><span class="linenum"> 432</span></a>          }
<a name="l433"><span class="linenum"> 433</span></a>  
<a name="l434"><span class="linenum"> 434</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l435"><span class="linenum"> 435</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014100700.01);
<a name="l436"><span class="linenum"> 436</span></a>      }
<a name="l437"><span class="linenum"> 437</span></a>  
<a name="l438"><span class="linenum"> 438</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014100800.00) {
<a name="l439"><span class="linenum"> 439</span></a>  <span class="comment">        // Remove qformat_learnwise (unless it has manually been added back).</span>
<a name="l440"><span class="linenum"> 440</span></a>          if (!<a class="phpfunction" onClick="logFunction('file_exists')" href="../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a> . '/question/format/learnwise/format.php')) {
<a name="l441"><span class="linenum"> 441</span></a>              <a class="function" onClick="logFunction('unset_all_config_for_plugin')" href="../../_functions/unset_all_config_for_plugin.html" onMouseOver="funcPopup(event,'unset_all_config_for_plugin')">unset_all_config_for_plugin</a>('qformat_learnwise');
<a name="l442"><span class="linenum"> 442</span></a>          }
<a name="l443"><span class="linenum"> 443</span></a>  
<a name="l444"><span class="linenum"> 444</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l445"><span class="linenum"> 445</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014100800.00);
<a name="l446"><span class="linenum"> 446</span></a>      }
<a name="l447"><span class="linenum"> 447</span></a>  
<a name="l448"><span class="linenum"> 448</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014101001.00) {
<a name="l449"><span class="linenum"> 449</span></a>  <span class="comment">        // Some blocks added themselves to the my/ home page, but they did not declare the</span>
<a name="l450"><span class="linenum"> 450</span></a>  <span class="comment">        // subpage of the default my home page. While the upgrade script has been fixed, this</span>
<a name="l451"><span class="linenum"> 451</span></a>  <span class="comment">        // upgrade script will fix the data that was wrongly added.</span>
<a name="l452"><span class="linenum"> 452</span></a>  
<a name="l453"><span class="linenum"> 453</span></a>  <span class="comment">        // We only proceed if we can find the right entry from my_pages. Private =&gt; 1 refers to</span>
<a name="l454"><span class="linenum"> 454</span></a>  <span class="comment">        // the constant value MY_PAGE_PRIVATE.</span>
<a name="l455"><span class="linenum"> 455</span></a>          if (<a class="var it10014" onMouseOver="hilite(10014)" onMouseOut="lolite()" onClick="logVariable('systempage')" href="../../_variables/systempage.html">$systempage</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('my_pages', array('userid' =&gt; null, 'private' =&gt; 1))) {
<a name="l456"><span class="linenum"> 456</span></a>  
<a name="l457"><span class="linenum"> 457</span></a>  <span class="comment">            // Select the blocks there could have been automatically added. showinsubcontexts is hardcoded to 0</span>
<a name="l458"><span class="linenum"> 458</span></a>  <span class="comment">            // because it is possible for administrators to have forced it on the my/ page by adding it to the</span>
<a name="l459"><span class="linenum"> 459</span></a>  <span class="comment">            // system directly rather than updating the default my/ page.</span>
<a name="l460"><span class="linenum"> 460</span></a>              <a class="var it3742" onMouseOver="hilite(3742)" onMouseOut="lolite()" onClick="logVariable('blocks')" href="../../_variables/blocks.html">$blocks</a> = array('course_overview', 'private_files', 'online_users', 'badges', 'calendar_month', 'calendar_upcoming');
<a name="l461"><span class="linenum"> 461</span></a>              <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it30819" onMouseOver="hilite(30819)" onMouseOut="lolite()" onClick="logVariable('blocksql')" href="../../_variables/blocksql.html">$blocksql</a>, <a class="var it30820" onMouseOver="hilite(30820)" onMouseOut="lolite()" onClick="logVariable('blockparams')" href="../../_variables/blockparams.html">$blockparams</a>) = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it3742" onMouseOver="hilite(3742)" onMouseOut="lolite()" onClick="logVariable('blocks')" href="../../_variables/blocks.html">$blocks</a>, <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>);
<a name="l462"><span class="linenum"> 462</span></a>              <a class="var it1047" onMouseOver="hilite(1047)" onMouseOut="lolite()" onClick="logVariable('select')" href="../../_variables/select.html">$select</a> = &quot;parentcontextid = :contextid
<a name="l463"><span class="linenum"> 463</span></a>                      AND pagetypepattern = :page
<a name="l464"><span class="linenum"> 464</span></a>                      AND showinsubcontexts = 0
<a name="l465"><span class="linenum"> 465</span></a>                      AND subpagepattern IS NULL
<a name="l466"><span class="linenum"> 466</span></a>                      AND blockname <a class="var it30819" onMouseOver="hilite(30819)" onMouseOut="lolite()" onClick="logVariable('blocksql')" href="../../_variables/blocksql.html">$blocksql</a>&quot;;
<a name="l467"><span class="linenum"> 467</span></a>              <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array(
<a name="l468"><span class="linenum"> 468</span></a>                  'contextid' =&gt; <a class="class" onClick="logClass('context_system')" href="../../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>()-&gt;id,
<a name="l469"><span class="linenum"> 469</span></a>                  'page' =&gt; 'my-index'
<a name="l470"><span class="linenum"> 470</span></a>              );
<a name="l471"><span class="linenum"> 471</span></a>              <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it30820" onMouseOver="hilite(30820)" onMouseOut="lolite()" onClick="logVariable('blockparams')" href="../../_variables/blockparams.html">$blockparams</a>);
<a name="l472"><span class="linenum"> 472</span></a>  
<a name="l473"><span class="linenum"> 473</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field_select')" href="../../_functions/set_field_select.html" onMouseOver="funcPopup(event,'set_field_select')">set_field_select</a>(
<a name="l474"><span class="linenum"> 474</span></a>                  'block_instances',
<a name="l475"><span class="linenum"> 475</span></a>                  'subpagepattern',
<a name="l476"><span class="linenum"> 476</span></a>                  <a class="var it10014" onMouseOver="hilite(10014)" onMouseOut="lolite()" onClick="logVariable('systempage')" href="../../_variables/systempage.html">$systempage</a>-&gt;<a onClick="logVariable('id')" class="var it42986" onMouseOver="hilite(42986)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l477"><span class="linenum"> 477</span></a>                  <a class="var it1047" onMouseOver="hilite(1047)" onMouseOut="lolite()" onClick="logVariable('select')" href="../../_variables/select.html">$select</a>,
<a name="l478"><span class="linenum"> 478</span></a>                  <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>
<a name="l479"><span class="linenum"> 479</span></a>              );
<a name="l480"><span class="linenum"> 480</span></a>          }
<a name="l481"><span class="linenum"> 481</span></a>  
<a name="l482"><span class="linenum"> 482</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l483"><span class="linenum"> 483</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014101001.00);
<a name="l484"><span class="linenum"> 484</span></a>      }
<a name="l485"><span class="linenum"> 485</span></a>  
<a name="l486"><span class="linenum"> 486</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014102000.00) {
<a name="l487"><span class="linenum"> 487</span></a>  
<a name="l488"><span class="linenum"> 488</span></a>  <span class="comment">        // Define field aggregatesubcats to be dropped from grade_categories.</span>
<a name="l489"><span class="linenum"> 489</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('grade_categories');
<a name="l490"><span class="linenum"> 490</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('aggregatesubcats');
<a name="l491"><span class="linenum"> 491</span></a>  
<a name="l492"><span class="linenum"> 492</span></a>  <span class="comment">        // Conditionally launch drop field aggregatesubcats.</span>
<a name="l493"><span class="linenum"> 493</span></a>          if (<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>)) {
<a name="l494"><span class="linenum"> 494</span></a>  
<a name="l495"><span class="linenum"> 495</span></a>              <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = 'SELECT DISTINCT courseid
<a name="l496"><span class="linenum"> 496</span></a>                        FROM {grade_categories}
<a name="l497"><span class="linenum"> 497</span></a>                       WHERE aggregatesubcats = ?';
<a name="l498"><span class="linenum"> 498</span></a>              <a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, array(1));
<a name="l499"><span class="linenum"> 499</span></a>  
<a name="l500"><span class="linenum"> 500</span></a>              foreach (<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a> as <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>) {
<a name="l501"><span class="linenum"> 501</span></a>                  <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('show_aggregatesubcats_upgrade_' . <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('courseid')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>, 1);
<a name="l502"><span class="linenum"> 502</span></a>  <span class="comment">                // Set each of the grade items to needing an update so that when the user visits the grade reports the</span>
<a name="l503"><span class="linenum"> 503</span></a>  <span class="comment">                // figures will be updated.</span>
<a name="l504"><span class="linenum"> 504</span></a>                  <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('grade_items', 'needsupdate', 1, array('courseid' =&gt; <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('courseid')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>));
<a name="l505"><span class="linenum"> 505</span></a>              }
<a name="l506"><span class="linenum"> 506</span></a>  
<a name="l507"><span class="linenum"> 507</span></a>  
<a name="l508"><span class="linenum"> 508</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('drop_field')" href="../../_functions/drop_field.html" onMouseOver="funcPopup(event,'drop_field')">drop_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l509"><span class="linenum"> 509</span></a>          }
<a name="l510"><span class="linenum"> 510</span></a>  
<a name="l511"><span class="linenum"> 511</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l512"><span class="linenum"> 512</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014102000.00);
<a name="l513"><span class="linenum"> 513</span></a>      }
<a name="l514"><span class="linenum"> 514</span></a>  
<a name="l515"><span class="linenum"> 515</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014110300.00) {
<a name="l516"><span class="linenum"> 516</span></a>  <span class="comment">        // Run script restoring missing folder records for draft file areas.</span>
<a name="l517"><span class="linenum"> 517</span></a>          <a class="function" onClick="logFunction('upgrade_fix_missing_root_folders_draft')" href="../../_functions/upgrade_fix_missing_root_folders_draft.html" onMouseOver="funcPopup(event,'upgrade_fix_missing_root_folders_draft')">upgrade_fix_missing_root_folders_draft</a>();
<a name="l518"><span class="linenum"> 518</span></a>  
<a name="l519"><span class="linenum"> 519</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l520"><span class="linenum"> 520</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014110300.00);
<a name="l521"><span class="linenum"> 521</span></a>      }
<a name="l522"><span class="linenum"> 522</span></a>  
<a name="l523"><span class="linenum"> 523</span></a>  <span class="comment">    // Moodle v2.8.0 release upgrade line.</span>
<a name="l524"><span class="linenum"> 524</span></a>  <span class="comment">    // Put any upgrade step following this.</span>
<a name="l525"><span class="linenum"> 525</span></a>  
<a name="l526"><span class="linenum"> 526</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014111000.00) {
<a name="l527"><span class="linenum"> 527</span></a>  <span class="comment">        // Coming from 2.7 or older, we need to flag the step minmaxgrade to be ignored.</span>
<a name="l528"><span class="linenum"> 528</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('upgrade_minmaxgradestepignored', 1);
<a name="l529"><span class="linenum"> 529</span></a>  <span class="comment">        // Coming from 2.7 or older, we need to flag the step for changing calculated grades to be regraded.</span>
<a name="l530"><span class="linenum"> 530</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('upgrade_calculatedgradeitemsonlyregrade', 1);
<a name="l531"><span class="linenum"> 531</span></a>  
<a name="l532"><span class="linenum"> 532</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l533"><span class="linenum"> 533</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014111000.00);
<a name="l534"><span class="linenum"> 534</span></a>      }
<a name="l535"><span class="linenum"> 535</span></a>  
<a name="l536"><span class="linenum"> 536</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014120100.00) {
<a name="l537"><span class="linenum"> 537</span></a>  
<a name="l538"><span class="linenum"> 538</span></a>  <span class="comment">        // Define field sslverification to be added to mnet_host.</span>
<a name="l539"><span class="linenum"> 539</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('mnet_host');
<a name="l540"><span class="linenum"> 540</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('sslverification', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '1', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0', 'applicationid');
<a name="l541"><span class="linenum"> 541</span></a>  
<a name="l542"><span class="linenum"> 542</span></a>  <span class="comment">        // Conditionally launch add field sslverification.</span>
<a name="l543"><span class="linenum"> 543</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>)) {
<a name="l544"><span class="linenum"> 544</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l545"><span class="linenum"> 545</span></a>          }
<a name="l546"><span class="linenum"> 546</span></a>  
<a name="l547"><span class="linenum"> 547</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l548"><span class="linenum"> 548</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014120100.00);
<a name="l549"><span class="linenum"> 549</span></a>      }
<a name="l550"><span class="linenum"> 550</span></a>  
<a name="l551"><span class="linenum"> 551</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014120101.00) {
<a name="l552"><span class="linenum"> 552</span></a>  
<a name="l553"><span class="linenum"> 553</span></a>  <span class="comment">        // Define field component to be added to comments.</span>
<a name="l554"><span class="linenum"> 554</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('comments');
<a name="l555"><span class="linenum"> 555</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('component', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '255', null, null, null, null, 'contextid');
<a name="l556"><span class="linenum"> 556</span></a>  
<a name="l557"><span class="linenum"> 557</span></a>  <span class="comment">        // Conditionally launch add field component.</span>
<a name="l558"><span class="linenum"> 558</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>)) {
<a name="l559"><span class="linenum"> 559</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l560"><span class="linenum"> 560</span></a>          }
<a name="l561"><span class="linenum"> 561</span></a>  
<a name="l562"><span class="linenum"> 562</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l563"><span class="linenum"> 563</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014120101.00);
<a name="l564"><span class="linenum"> 564</span></a>      }
<a name="l565"><span class="linenum"> 565</span></a>  
<a name="l566"><span class="linenum"> 566</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2014120102.00) {
<a name="l567"><span class="linenum"> 567</span></a>  
<a name="l568"><span class="linenum"> 568</span></a>  <span class="comment">        // Define table user_password_history to be created.</span>
<a name="l569"><span class="linenum"> 569</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('user_password_history');
<a name="l570"><span class="linenum"> 570</span></a>  
<a name="l571"><span class="linenum"> 571</span></a>  <span class="comment">        // Adding fields to table user_password_history.</span>
<a name="l572"><span class="linenum"> 572</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l573"><span class="linenum"> 573</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('userid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l574"><span class="linenum"> 574</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('hash', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '255', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l575"><span class="linenum"> 575</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timecreated', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l576"><span class="linenum"> 576</span></a>  
<a name="l577"><span class="linenum"> 577</span></a>  <span class="comment">        // Adding keys to table user_password_history.</span>
<a name="l578"><span class="linenum"> 578</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l579"><span class="linenum"> 579</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('userid', <a class="constant" onClick="logConstant('XMLDB_KEY_FOREIGN')" href="../../_constants/XMLDB_KEY_FOREIGN.html" onMouseOver="constPopup(event,'XMLDB_KEY_FOREIGN')">XMLDB_KEY_FOREIGN</a>, array('userid'), 'user', array('id'));
<a name="l580"><span class="linenum"> 580</span></a>  
<a name="l581"><span class="linenum"> 581</span></a>  <span class="comment">        // Conditionally launch create table for user_password_history.</span>
<a name="l582"><span class="linenum"> 582</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l583"><span class="linenum"> 583</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l584"><span class="linenum"> 584</span></a>          }
<a name="l585"><span class="linenum"> 585</span></a>  
<a name="l586"><span class="linenum"> 586</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l587"><span class="linenum"> 587</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2014120102.00);
<a name="l588"><span class="linenum"> 588</span></a>      }
<a name="l589"><span class="linenum"> 589</span></a>  
<a name="l590"><span class="linenum"> 590</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015010800.01) {
<a name="l591"><span class="linenum"> 591</span></a>  
<a name="l592"><span class="linenum"> 592</span></a>  <span class="comment">        // Make sure the private files handler is not set to expire.</span>
<a name="l593"><span class="linenum"> 593</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('messageinbound_handlers', 'defaultexpiration', 0,
<a name="l594"><span class="linenum"> 594</span></a>                  array('classname' =&gt; '\core\message\inbound\private_files_handler'));
<a name="l595"><span class="linenum"> 595</span></a>  
<a name="l596"><span class="linenum"> 596</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l597"><span class="linenum"> 597</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015010800.01);
<a name="l598"><span class="linenum"> 598</span></a>  
<a name="l599"><span class="linenum"> 599</span></a>      }
<a name="l600"><span class="linenum"> 600</span></a>  
<a name="l601"><span class="linenum"> 601</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015012600.00) {
<a name="l602"><span class="linenum"> 602</span></a>  
<a name="l603"><span class="linenum"> 603</span></a>  <span class="comment">        // If the site is using internal and external storage, or just external</span>
<a name="l604"><span class="linenum"> 604</span></a>  <span class="comment">        // storage, and the external path specified is empty we change the setting</span>
<a name="l605"><span class="linenum"> 605</span></a>  <span class="comment">        // to internal only. That is how the backup code is handling this</span>
<a name="l606"><span class="linenum"> 606</span></a>  <span class="comment">        // misconfiguration.</span>
<a name="l607"><span class="linenum"> 607</span></a>          <a class="var it15659" onMouseOver="hilite(15659)" onMouseOut="lolite()" onClick="logVariable('storage')" href="../../_variables/storage.html">$storage</a> = (int) <a class="function" onClick="logFunction('get_config')" href="../../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>('backup', 'backup_auto_storage');
<a name="l608"><span class="linenum"> 608</span></a>          <a class="var it3232" onMouseOver="hilite(3232)" onMouseOut="lolite()" onClick="logVariable('folder')" href="../../_variables/folder.html">$folder</a> = <a class="function" onClick="logFunction('get_config')" href="../../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>('backup', 'backup_auto_destination');
<a name="l609"><span class="linenum"> 609</span></a>          if (<a class="var it15659" onMouseOver="hilite(15659)" onMouseOut="lolite()" onClick="logVariable('storage')" href="../../_variables/storage.html">$storage</a> !== 0 &amp;&amp; empty(<a class="var it3232" onMouseOver="hilite(3232)" onMouseOut="lolite()" onClick="logVariable('folder')" href="../../_variables/folder.html">$folder</a>)) {
<a name="l610"><span class="linenum"> 610</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('backup_auto_storage', 0, 'backup');
<a name="l611"><span class="linenum"> 611</span></a>          }
<a name="l612"><span class="linenum"> 612</span></a>  
<a name="l613"><span class="linenum"> 613</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l614"><span class="linenum"> 614</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015012600.00);
<a name="l615"><span class="linenum"> 615</span></a>      }
<a name="l616"><span class="linenum"> 616</span></a>  
<a name="l617"><span class="linenum"> 617</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015012600.01) {
<a name="l618"><span class="linenum"> 618</span></a>  
<a name="l619"><span class="linenum"> 619</span></a>  <span class="comment">        // Convert calendar_lookahead to nearest new value.</span>
<a name="l620"><span class="linenum"> 620</span></a>          <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_field')" href="../../_functions/get_field.html" onMouseOver="funcPopup(event,'get_field')">get_field</a>('config', 'value', array('name' =&gt; 'calendar_lookahead'));
<a name="l621"><span class="linenum"> 621</span></a>          if (<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> &gt; 90) {
<a name="l622"><span class="linenum"> 622</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('calendar_lookahead', '120');
<a name="l623"><span class="linenum"> 623</span></a>          } else if (<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> &gt; 60 and <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> &lt; 90) {
<a name="l624"><span class="linenum"> 624</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('calendar_lookahead', '90');
<a name="l625"><span class="linenum"> 625</span></a>          } else if (<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> &gt; 30 and <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> &lt; 60) {
<a name="l626"><span class="linenum"> 626</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('calendar_lookahead', '60');
<a name="l627"><span class="linenum"> 627</span></a>          } else if (<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> &gt; 21 and <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> &lt; 30) {
<a name="l628"><span class="linenum"> 628</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('calendar_lookahead', '30');
<a name="l629"><span class="linenum"> 629</span></a>          } else if (<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> &gt; 14 and <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> &lt; 21) {
<a name="l630"><span class="linenum"> 630</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('calendar_lookahead', '21');
<a name="l631"><span class="linenum"> 631</span></a>          } else if (<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> &gt; 7 and <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> &lt; 14) {
<a name="l632"><span class="linenum"> 632</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('calendar_lookahead', '14');
<a name="l633"><span class="linenum"> 633</span></a>          }
<a name="l634"><span class="linenum"> 634</span></a>  
<a name="l635"><span class="linenum"> 635</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l636"><span class="linenum"> 636</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015012600.01);
<a name="l637"><span class="linenum"> 637</span></a>      }
<a name="l638"><span class="linenum"> 638</span></a>  
<a name="l639"><span class="linenum"> 639</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015021100.00) {
<a name="l640"><span class="linenum"> 640</span></a>  
<a name="l641"><span class="linenum"> 641</span></a>  <span class="comment">        // Define field timemodified to be added to registration_hubs.</span>
<a name="l642"><span class="linenum"> 642</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('registration_hubs');
<a name="l643"><span class="linenum"> 643</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('timemodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0', 'secret');
<a name="l644"><span class="linenum"> 644</span></a>  
<a name="l645"><span class="linenum"> 645</span></a>  <span class="comment">        // Conditionally launch add field timemodified.</span>
<a name="l646"><span class="linenum"> 646</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>)) {
<a name="l647"><span class="linenum"> 647</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l648"><span class="linenum"> 648</span></a>          }
<a name="l649"><span class="linenum"> 649</span></a>  
<a name="l650"><span class="linenum"> 650</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l651"><span class="linenum"> 651</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015021100.00);
<a name="l652"><span class="linenum"> 652</span></a>      }
<a name="l653"><span class="linenum"> 653</span></a>  
<a name="l654"><span class="linenum"> 654</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015022401.00) {
<a name="l655"><span class="linenum"> 655</span></a>  
<a name="l656"><span class="linenum"> 656</span></a>  <span class="comment">        // Define index useridfromto (not unique) to be added to message.</span>
<a name="l657"><span class="linenum"> 657</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('message');
<a name="l658"><span class="linenum"> 658</span></a>          <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('useridfromto', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('useridfrom', 'useridto'));
<a name="l659"><span class="linenum"> 659</span></a>  
<a name="l660"><span class="linenum"> 660</span></a>  <span class="comment">        // Conditionally launch add index useridfromto.</span>
<a name="l661"><span class="linenum"> 661</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>)) {
<a name="l662"><span class="linenum"> 662</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>);
<a name="l663"><span class="linenum"> 663</span></a>          }
<a name="l664"><span class="linenum"> 664</span></a>  
<a name="l665"><span class="linenum"> 665</span></a>  <span class="comment">        // Define index useridfromto (not unique) to be added to message_read.</span>
<a name="l666"><span class="linenum"> 666</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('message_read');
<a name="l667"><span class="linenum"> 667</span></a>          <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('useridfromto', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('useridfrom', 'useridto'));
<a name="l668"><span class="linenum"> 668</span></a>  
<a name="l669"><span class="linenum"> 669</span></a>  <span class="comment">        // Conditionally launch add index useridfromto.</span>
<a name="l670"><span class="linenum"> 670</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>)) {
<a name="l671"><span class="linenum"> 671</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>);
<a name="l672"><span class="linenum"> 672</span></a>          }
<a name="l673"><span class="linenum"> 673</span></a>  
<a name="l674"><span class="linenum"> 674</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l675"><span class="linenum"> 675</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015022401.00);
<a name="l676"><span class="linenum"> 676</span></a>      }
<a name="l677"><span class="linenum"> 677</span></a>  
<a name="l678"><span class="linenum"> 678</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015022500.00) {
<a name="l679"><span class="linenum"> 679</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('user_devices');
<a name="l680"><span class="linenum"> 680</span></a>          <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('uuid-userid', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('uuid', 'userid'));
<a name="l681"><span class="linenum"> 681</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>)) {
<a name="l682"><span class="linenum"> 682</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>);
<a name="l683"><span class="linenum"> 683</span></a>          }
<a name="l684"><span class="linenum"> 684</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015022500.00);
<a name="l685"><span class="linenum"> 685</span></a>      }
<a name="l686"><span class="linenum"> 686</span></a>  
<a name="l687"><span class="linenum"> 687</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015030400.00) {
<a name="l688"><span class="linenum"> 688</span></a>  <span class="comment">        // We have long since switched to storing timemodified per hub rather than a single 'registered' timestamp.</span>
<a name="l689"><span class="linenum"> 689</span></a>          <a class="function" onClick="logFunction('unset_config')" href="../../_functions/unset_config.html" onMouseOver="funcPopup(event,'unset_config')">unset_config</a>('registered');
<a name="l690"><span class="linenum"> 690</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015030400.00);
<a name="l691"><span class="linenum"> 691</span></a>      }
<a name="l692"><span class="linenum"> 692</span></a>  
<a name="l693"><span class="linenum"> 693</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015031100.00) {
<a name="l694"><span class="linenum"> 694</span></a>  <span class="comment">        // Unset old config variable.</span>
<a name="l695"><span class="linenum"> 695</span></a>          <a class="function" onClick="logFunction('unset_config')" href="../../_functions/unset_config.html" onMouseOver="funcPopup(event,'unset_config')">unset_config</a>('enabletgzbackups');
<a name="l696"><span class="linenum"> 696</span></a>  
<a name="l697"><span class="linenum"> 697</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015031100.00);
<a name="l698"><span class="linenum"> 698</span></a>      }
<a name="l699"><span class="linenum"> 699</span></a>  
<a name="l700"><span class="linenum"> 700</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015031400.00) {
<a name="l701"><span class="linenum"> 701</span></a>  
<a name="l702"><span class="linenum"> 702</span></a>  <span class="comment">        // Define index useridfrom (not unique) to be dropped form message.</span>
<a name="l703"><span class="linenum"> 703</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('message');
<a name="l704"><span class="linenum"> 704</span></a>          <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('useridfrom', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('useridfrom'));
<a name="l705"><span class="linenum"> 705</span></a>  
<a name="l706"><span class="linenum"> 706</span></a>  <span class="comment">        // Conditionally launch drop index useridfrom.</span>
<a name="l707"><span class="linenum"> 707</span></a>          if (<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>)) {
<a name="l708"><span class="linenum"> 708</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('drop_index')" href="../../_functions/drop_index.html" onMouseOver="funcPopup(event,'drop_index')">drop_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>);
<a name="l709"><span class="linenum"> 709</span></a>          }
<a name="l710"><span class="linenum"> 710</span></a>  
<a name="l711"><span class="linenum"> 711</span></a>  <span class="comment">        // Define index useridfrom (not unique) to be dropped form message_read.</span>
<a name="l712"><span class="linenum"> 712</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('message_read');
<a name="l713"><span class="linenum"> 713</span></a>          <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('useridfrom', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('useridfrom'));
<a name="l714"><span class="linenum"> 714</span></a>  
<a name="l715"><span class="linenum"> 715</span></a>  <span class="comment">        // Conditionally launch drop index useridfrom.</span>
<a name="l716"><span class="linenum"> 716</span></a>          if (<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>)) {
<a name="l717"><span class="linenum"> 717</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('drop_index')" href="../../_functions/drop_index.html" onMouseOver="funcPopup(event,'drop_index')">drop_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>);
<a name="l718"><span class="linenum"> 718</span></a>          }
<a name="l719"><span class="linenum"> 719</span></a>  
<a name="l720"><span class="linenum"> 720</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l721"><span class="linenum"> 721</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015031400.00);
<a name="l722"><span class="linenum"> 722</span></a>      }
<a name="l723"><span class="linenum"> 723</span></a>  
<a name="l724"><span class="linenum"> 724</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015031900.01) {
<a name="l725"><span class="linenum"> 725</span></a>          <a class="function" onClick="logFunction('unset_config')" href="../../_functions/unset_config.html" onMouseOver="funcPopup(event,'unset_config')">unset_config</a>('crontime', 'registration');
<a name="l726"><span class="linenum"> 726</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015031900.01);
<a name="l727"><span class="linenum"> 727</span></a>      }
<a name="l728"><span class="linenum"> 728</span></a>  
<a name="l729"><span class="linenum"> 729</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015032000.00) {
<a name="l730"><span class="linenum"> 730</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('badge_criteria');
<a name="l731"><span class="linenum"> 731</span></a>  
<a name="l732"><span class="linenum"> 732</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('description', <a class="constant" onClick="logConstant('XMLDB_TYPE_TEXT')" href="../../_constants/XMLDB_TYPE_TEXT.html" onMouseOver="constPopup(event,'XMLDB_TYPE_TEXT')">XMLDB_TYPE_TEXT</a>, null, null, null, null, null);
<a name="l733"><span class="linenum"> 733</span></a>  <span class="comment">        // Conditionally add description field to the badge_criteria table.</span>
<a name="l734"><span class="linenum"> 734</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>)) {
<a name="l735"><span class="linenum"> 735</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l736"><span class="linenum"> 736</span></a>          }
<a name="l737"><span class="linenum"> 737</span></a>  
<a name="l738"><span class="linenum"> 738</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('descriptionformat', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, 2, null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, 0);
<a name="l739"><span class="linenum"> 739</span></a>  <span class="comment">        // Conditionally add description format field to the badge_criteria table.</span>
<a name="l740"><span class="linenum"> 740</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>)) {
<a name="l741"><span class="linenum"> 741</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l742"><span class="linenum"> 742</span></a>          }
<a name="l743"><span class="linenum"> 743</span></a>  
<a name="l744"><span class="linenum"> 744</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015032000.00);
<a name="l745"><span class="linenum"> 745</span></a>      }
<a name="l746"><span class="linenum"> 746</span></a>  
<a name="l747"><span class="linenum"> 747</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015040200.01) {
<a name="l748"><span class="linenum"> 748</span></a>  <span class="comment">        // Force uninstall of deleted tool.</span>
<a name="l749"><span class="linenum"> 749</span></a>          if (!<a class="phpfunction" onClick="logFunction('file_exists')" href="../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(&quot;<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>/<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('admin')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/admin.html">admin</a>/tool/timezoneimport&quot;)) {
<a name="l750"><span class="linenum"> 750</span></a>  <span class="comment">            // Remove capabilities.</span>
<a name="l751"><span class="linenum"> 751</span></a>              <a class="function" onClick="logFunction('capabilities_cleanup')" href="../../_functions/capabilities_cleanup.html" onMouseOver="funcPopup(event,'capabilities_cleanup')">capabilities_cleanup</a>('tool_timezoneimport');
<a name="l752"><span class="linenum"> 752</span></a>  <span class="comment">            // Remove all other associated config.</span>
<a name="l753"><span class="linenum"> 753</span></a>              <a class="function" onClick="logFunction('unset_all_config_for_plugin')" href="../../_functions/unset_all_config_for_plugin.html" onMouseOver="funcPopup(event,'unset_all_config_for_plugin')">unset_all_config_for_plugin</a>('tool_timezoneimport');
<a name="l754"><span class="linenum"> 754</span></a>          }
<a name="l755"><span class="linenum"> 755</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015040200.01);
<a name="l756"><span class="linenum"> 756</span></a>      }
<a name="l757"><span class="linenum"> 757</span></a>  
<a name="l758"><span class="linenum"> 758</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015040200.02) {
<a name="l759"><span class="linenum"> 759</span></a>  <span class="comment">        // Define table timezone to be dropped.</span>
<a name="l760"><span class="linenum"> 760</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('timezone');
<a name="l761"><span class="linenum"> 761</span></a>  <span class="comment">        // Conditionally launch drop table for timezone.</span>
<a name="l762"><span class="linenum"> 762</span></a>          if (<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l763"><span class="linenum"> 763</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('drop_table')" href="../../_functions/drop_table.html" onMouseOver="funcPopup(event,'drop_table')">drop_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l764"><span class="linenum"> 764</span></a>          }
<a name="l765"><span class="linenum"> 765</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015040200.02);
<a name="l766"><span class="linenum"> 766</span></a>      }
<a name="l767"><span class="linenum"> 767</span></a>  
<a name="l768"><span class="linenum"> 768</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015040200.03) {
<a name="l769"><span class="linenum"> 769</span></a>          if (isset(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('timezone')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/timezone.html">timezone</a>) and <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('timezone')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/timezone.html">timezone</a> == 99) {
<a name="l770"><span class="linenum"> 770</span></a>  <span class="comment">            // Migrate to real server timezone.</span>
<a name="l771"><span class="linenum"> 771</span></a>              <a class="function" onClick="logFunction('unset_config')" href="../../_functions/unset_config.html" onMouseOver="funcPopup(event,'unset_config')">unset_config</a>('timezone');
<a name="l772"><span class="linenum"> 772</span></a>          }
<a name="l773"><span class="linenum"> 773</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015040200.03);
<a name="l774"><span class="linenum"> 774</span></a>      }
<a name="l775"><span class="linenum"> 775</span></a>  
<a name="l776"><span class="linenum"> 776</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015040700.01) {
<a name="l777"><span class="linenum"> 777</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('config_plugins', array('name' =&gt; 'requiremodintro'));
<a name="l778"><span class="linenum"> 778</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015040700.01);
<a name="l779"><span class="linenum"> 779</span></a>      }
<a name="l780"><span class="linenum"> 780</span></a>  
<a name="l781"><span class="linenum"> 781</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015040900.01) {
<a name="l782"><span class="linenum"> 782</span></a>  <span class="comment">        // Add &quot;My grades&quot; to the user menu.</span>
<a name="l783"><span class="linenum"> 783</span></a>          <a class="var it16612" onMouseOver="hilite(16612)" onMouseOut="lolite()" onClick="logVariable('oldconfig')" href="../../_variables/oldconfig.html">$oldconfig</a> = <a class="function" onClick="logFunction('get_config')" href="../../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>('core', 'customusermenuitems');
<a name="l784"><span class="linenum"> 784</span></a>          if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(&quot;mygrades,grades|/grade/report/mygrades.php|grades&quot;, <a class="var it16612" onMouseOver="hilite(16612)" onMouseOut="lolite()" onClick="logVariable('oldconfig')" href="../../_variables/oldconfig.html">$oldconfig</a>) === false) {
<a name="l785"><span class="linenum"> 785</span></a>              <a class="var it13854" onMouseOver="hilite(13854)" onMouseOut="lolite()" onClick="logVariable('newconfig')" href="../../_variables/newconfig.html">$newconfig</a> = &quot;mygrades,grades|/grade/report/mygrades.php|grades\n&quot; . <a class="var it16612" onMouseOver="hilite(16612)" onMouseOut="lolite()" onClick="logVariable('oldconfig')" href="../../_variables/oldconfig.html">$oldconfig</a>;
<a name="l786"><span class="linenum"> 786</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('customusermenuitems', <a class="var it13854" onMouseOver="hilite(13854)" onMouseOut="lolite()" onClick="logVariable('newconfig')" href="../../_variables/newconfig.html">$newconfig</a>);
<a name="l787"><span class="linenum"> 787</span></a>          }
<a name="l788"><span class="linenum"> 788</span></a>  
<a name="l789"><span class="linenum"> 789</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015040900.01);
<a name="l790"><span class="linenum"> 790</span></a>      }
<a name="l791"><span class="linenum"> 791</span></a>  
<a name="l792"><span class="linenum"> 792</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015040900.02) {
<a name="l793"><span class="linenum"> 793</span></a>  <span class="comment">        // Update the default user menu (add preferences, remove my files and my badges).</span>
<a name="l794"><span class="linenum"> 794</span></a>          <a class="var it16612" onMouseOver="hilite(16612)" onMouseOut="lolite()" onClick="logVariable('oldconfig')" href="../../_variables/oldconfig.html">$oldconfig</a> = <a class="function" onClick="logFunction('get_config')" href="../../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>('core', 'customusermenuitems');
<a name="l795"><span class="linenum"> 795</span></a>  
<a name="l796"><span class="linenum"> 796</span></a>  <span class="comment">        // Add &quot;My preferences&quot; at the end.</span>
<a name="l797"><span class="linenum"> 797</span></a>          if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it16612" onMouseOver="hilite(16612)" onMouseOut="lolite()" onClick="logVariable('oldconfig')" href="../../_variables/oldconfig.html">$oldconfig</a>, &quot;mypreferences,moodle|/user/preference.php|preferences&quot;) === false) {
<a name="l798"><span class="linenum"> 798</span></a>              <a class="var it13854" onMouseOver="hilite(13854)" onMouseOut="lolite()" onClick="logVariable('newconfig')" href="../../_variables/newconfig.html">$newconfig</a> = <a class="var it16612" onMouseOver="hilite(16612)" onMouseOut="lolite()" onClick="logVariable('oldconfig')" href="../../_variables/oldconfig.html">$oldconfig</a> . &quot;\nmypreferences,moodle|/user/preferences.php|preferences&quot;;
<a name="l799"><span class="linenum"> 799</span></a>          } else {
<a name="l800"><span class="linenum"> 800</span></a>              <a class="var it13854" onMouseOver="hilite(13854)" onMouseOut="lolite()" onClick="logVariable('newconfig')" href="../../_variables/newconfig.html">$newconfig</a> = <a class="var it16612" onMouseOver="hilite(16612)" onMouseOut="lolite()" onClick="logVariable('oldconfig')" href="../../_variables/oldconfig.html">$oldconfig</a>;
<a name="l801"><span class="linenum"> 801</span></a>          }
<a name="l802"><span class="linenum"> 802</span></a>  <span class="comment">        // Remove my files.</span>
<a name="l803"><span class="linenum"> 803</span></a>          <a class="var it13854" onMouseOver="hilite(13854)" onMouseOut="lolite()" onClick="logVariable('newconfig')" href="../../_variables/newconfig.html">$newconfig</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(&quot;myfiles,moodle|/user/files.php|download&quot;, &quot;&quot;, <a class="var it13854" onMouseOver="hilite(13854)" onMouseOut="lolite()" onClick="logVariable('newconfig')" href="../../_variables/newconfig.html">$newconfig</a>);
<a name="l804"><span class="linenum"> 804</span></a>  <span class="comment">        // Remove my badges.</span>
<a name="l805"><span class="linenum"> 805</span></a>          <a class="var it13854" onMouseOver="hilite(13854)" onMouseOut="lolite()" onClick="logVariable('newconfig')" href="../../_variables/newconfig.html">$newconfig</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(&quot;mybadges,badges|/badges/mybadges.php|award&quot;, &quot;&quot;, <a class="var it13854" onMouseOver="hilite(13854)" onMouseOut="lolite()" onClick="logVariable('newconfig')" href="../../_variables/newconfig.html">$newconfig</a>);
<a name="l806"><span class="linenum"> 806</span></a>  <span class="comment">        // Remove holes.</span>
<a name="l807"><span class="linenum"> 807</span></a>          <a class="var it13854" onMouseOver="hilite(13854)" onMouseOut="lolite()" onClick="logVariable('newconfig')" href="../../_variables/newconfig.html">$newconfig</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/\n+/', &quot;\n&quot;, <a class="var it13854" onMouseOver="hilite(13854)" onMouseOut="lolite()" onClick="logVariable('newconfig')" href="../../_variables/newconfig.html">$newconfig</a>);
<a name="l808"><span class="linenum"> 808</span></a>          <a class="var it13854" onMouseOver="hilite(13854)" onMouseOut="lolite()" onClick="logVariable('newconfig')" href="../../_variables/newconfig.html">$newconfig</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/(\r\n)+/', &quot;\n&quot;, <a class="var it13854" onMouseOver="hilite(13854)" onMouseOut="lolite()" onClick="logVariable('newconfig')" href="../../_variables/newconfig.html">$newconfig</a>);
<a name="l809"><span class="linenum"> 809</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('customusermenuitems', <a class="var it13854" onMouseOver="hilite(13854)" onMouseOut="lolite()" onClick="logVariable('newconfig')" href="../../_variables/newconfig.html">$newconfig</a>);
<a name="l810"><span class="linenum"> 810</span></a>  
<a name="l811"><span class="linenum"> 811</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015040900.02);
<a name="l812"><span class="linenum"> 812</span></a>      }
<a name="l813"><span class="linenum"> 813</span></a>  
<a name="l814"><span class="linenum"> 814</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015050400.00) {
<a name="l815"><span class="linenum"> 815</span></a>          <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a> = <a class="function" onClick="logFunction('get_config')" href="../../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>('core', 'customusermenuitems');
<a name="l816"><span class="linenum"> 816</span></a>  
<a name="l817"><span class="linenum"> 817</span></a>  <span class="comment">        // Change &quot;My preferences&quot; in the user menu to &quot;Preferences&quot;.</span>
<a name="l818"><span class="linenum"> 818</span></a>          <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(&quot;mypreferences,moodle|/user/preferences.php|preferences&quot;,
<a name="l819"><span class="linenum"> 819</span></a>              &quot;preferences,moodle|/user/preferences.php|preferences&quot;, <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>);
<a name="l820"><span class="linenum"> 820</span></a>  
<a name="l821"><span class="linenum"> 821</span></a>  <span class="comment">        // Change &quot;My grades&quot; in the user menu to &quot;Grades&quot;.</span>
<a name="l822"><span class="linenum"> 822</span></a>          <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(&quot;mygrades,grades|/grade/report/mygrades.php|grades&quot;,
<a name="l823"><span class="linenum"> 823</span></a>              &quot;grades,grades|/grade/report/mygrades.php|grades&quot;, <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>);
<a name="l824"><span class="linenum"> 824</span></a>  
<a name="l825"><span class="linenum"> 825</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('customusermenuitems', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>);
<a name="l826"><span class="linenum"> 826</span></a>  
<a name="l827"><span class="linenum"> 827</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015050400.00);
<a name="l828"><span class="linenum"> 828</span></a>      }
<a name="l829"><span class="linenum"> 829</span></a>  
<a name="l830"><span class="linenum"> 830</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015050401.00) {
<a name="l831"><span class="linenum"> 831</span></a>  <span class="comment">        // Make sure we have messages in the user menu because it's no longer in the nav tree.</span>
<a name="l832"><span class="linenum"> 832</span></a>          <a class="var it16612" onMouseOver="hilite(16612)" onMouseOut="lolite()" onClick="logVariable('oldconfig')" href="../../_variables/oldconfig.html">$oldconfig</a> = <a class="function" onClick="logFunction('get_config')" href="../../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>('core', 'customusermenuitems');
<a name="l833"><span class="linenum"> 833</span></a>          <a class="var it30821" onMouseOver="hilite(30821)" onMouseOut="lolite()" onClick="logVariable('messagesconfig')" href="../../_variables/messagesconfig.html">$messagesconfig</a> = &quot;messages,message|/message/index.php|message&quot;;
<a name="l834"><span class="linenum"> 834</span></a>          <a class="var it30822" onMouseOver="hilite(30822)" onMouseOut="lolite()" onClick="logVariable('preferencesconfig')" href="../../_variables/preferencesconfig.html">$preferencesconfig</a> = &quot;preferences,moodle|/user/preferences.php|preferences&quot;;
<a name="l835"><span class="linenum"> 835</span></a>  
<a name="l836"><span class="linenum"> 836</span></a>  <span class="comment">        // See if it exists.</span>
<a name="l837"><span class="linenum"> 837</span></a>          if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it16612" onMouseOver="hilite(16612)" onMouseOut="lolite()" onClick="logVariable('oldconfig')" href="../../_variables/oldconfig.html">$oldconfig</a>, <a class="var it30821" onMouseOver="hilite(30821)" onMouseOut="lolite()" onClick="logVariable('messagesconfig')" href="../../_variables/messagesconfig.html">$messagesconfig</a>) === false) {
<a name="l838"><span class="linenum"> 838</span></a>  <span class="comment">            // See if preferences exists.</span>
<a name="l839"><span class="linenum"> 839</span></a>              if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it16612" onMouseOver="hilite(16612)" onMouseOut="lolite()" onClick="logVariable('oldconfig')" href="../../_variables/oldconfig.html">$oldconfig</a>, &quot;preferences,moodle|/user/preferences.php|preferences&quot;) !== false) {
<a name="l840"><span class="linenum"> 840</span></a>  <span class="comment">                // Insert it before preferences.</span>
<a name="l841"><span class="linenum"> 841</span></a>                  <a class="var it13854" onMouseOver="hilite(13854)" onMouseOut="lolite()" onClick="logVariable('newconfig')" href="../../_variables/newconfig.html">$newconfig</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(<a class="var it30822" onMouseOver="hilite(30822)" onMouseOut="lolite()" onClick="logVariable('preferencesconfig')" href="../../_variables/preferencesconfig.html">$preferencesconfig</a>, <a class="var it30821" onMouseOver="hilite(30821)" onMouseOut="lolite()" onClick="logVariable('messagesconfig')" href="../../_variables/messagesconfig.html">$messagesconfig</a> . &quot;\n&quot; . <a class="var it30822" onMouseOver="hilite(30822)" onMouseOut="lolite()" onClick="logVariable('preferencesconfig')" href="../../_variables/preferencesconfig.html">$preferencesconfig</a>, <a class="var it16612" onMouseOver="hilite(16612)" onMouseOut="lolite()" onClick="logVariable('oldconfig')" href="../../_variables/oldconfig.html">$oldconfig</a>);
<a name="l842"><span class="linenum"> 842</span></a>              } else {
<a name="l843"><span class="linenum"> 843</span></a>  <span class="comment">                // Custom config - we can only insert it at the end.</span>
<a name="l844"><span class="linenum"> 844</span></a>                  <a class="var it13854" onMouseOver="hilite(13854)" onMouseOut="lolite()" onClick="logVariable('newconfig')" href="../../_variables/newconfig.html">$newconfig</a> = <a class="var it16612" onMouseOver="hilite(16612)" onMouseOut="lolite()" onClick="logVariable('oldconfig')" href="../../_variables/oldconfig.html">$oldconfig</a> . &quot;\n&quot; . <a class="var it30821" onMouseOver="hilite(30821)" onMouseOut="lolite()" onClick="logVariable('messagesconfig')" href="../../_variables/messagesconfig.html">$messagesconfig</a>;
<a name="l845"><span class="linenum"> 845</span></a>              }
<a name="l846"><span class="linenum"> 846</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('customusermenuitems', <a class="var it13854" onMouseOver="hilite(13854)" onMouseOut="lolite()" onClick="logVariable('newconfig')" href="../../_variables/newconfig.html">$newconfig</a>);
<a name="l847"><span class="linenum"> 847</span></a>          }
<a name="l848"><span class="linenum"> 848</span></a>  
<a name="l849"><span class="linenum"> 849</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015050401.00);
<a name="l850"><span class="linenum"> 850</span></a>      }
<a name="l851"><span class="linenum"> 851</span></a>  
<a name="l852"><span class="linenum"> 852</span></a>  <span class="comment">    // Moodle v2.9.0 release upgrade line.</span>
<a name="l853"><span class="linenum"> 853</span></a>  <span class="comment">    // Put any upgrade step following this.</span>
<a name="l854"><span class="linenum"> 854</span></a>  
<a name="l855"><span class="linenum"> 855</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015060400.02) {
<a name="l856"><span class="linenum"> 856</span></a>  
<a name="l857"><span class="linenum"> 857</span></a>  <span class="comment">        // Sites that were upgrading from 2.7 and older will ignore this step.</span>
<a name="l858"><span class="linenum"> 858</span></a>          if (empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('upgrade_minmaxgradestepignored')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/upgrade_minmaxgradestepignored.html">upgrade_minmaxgradestepignored</a>)) {
<a name="l859"><span class="linenum"> 859</span></a>  
<a name="l860"><span class="linenum"> 860</span></a>              <a class="function" onClick="logFunction('upgrade_minmaxgrade')" href="../../_functions/upgrade_minmaxgrade.html" onMouseOver="funcPopup(event,'upgrade_minmaxgrade')">upgrade_minmaxgrade</a>();
<a name="l861"><span class="linenum"> 861</span></a>  
<a name="l862"><span class="linenum"> 862</span></a>  <span class="comment">            // Flags this upgrade step as already run to prevent it from running multiple times.</span>
<a name="l863"><span class="linenum"> 863</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('upgrade_minmaxgradestepignored', 1);
<a name="l864"><span class="linenum"> 864</span></a>          }
<a name="l865"><span class="linenum"> 865</span></a>  
<a name="l866"><span class="linenum"> 866</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015060400.02);
<a name="l867"><span class="linenum"> 867</span></a>      }
<a name="l868"><span class="linenum"> 868</span></a>  
<a name="l869"><span class="linenum"> 869</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015061900.00) {
<a name="l870"><span class="linenum"> 870</span></a>  <span class="comment">        // MDL-49257. Changed the algorithm of calculating automatic weights of extra credit items.</span>
<a name="l871"><span class="linenum"> 871</span></a>  
<a name="l872"><span class="linenum"> 872</span></a>  <span class="comment">        // Before the change, in case when grade category (in &quot;Natural&quot; agg. method) had items with</span>
<a name="l873"><span class="linenum"> 873</span></a>  <span class="comment">        // overridden weights, the automatic weight of extra credit items was illogical.</span>
<a name="l874"><span class="linenum"> 874</span></a>  <span class="comment">        // In order to prevent grades changes after the upgrade we need to freeze gradebook calculation</span>
<a name="l875"><span class="linenum"> 875</span></a>  <span class="comment">        // for the affected courses.</span>
<a name="l876"><span class="linenum"> 876</span></a>  
<a name="l877"><span class="linenum"> 877</span></a>  <span class="comment">        // This script in included in each major version upgrade process so make sure we don't run it twice.</span>
<a name="l878"><span class="linenum"> 878</span></a>          if (empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('upgrade_extracreditweightsstepignored')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/upgrade_extracreditweightsstepignored.html">upgrade_extracreditweightsstepignored</a>)) {
<a name="l879"><span class="linenum"> 879</span></a>              <a class="function" onClick="logFunction('upgrade_extra_credit_weightoverride')" href="../../_functions/upgrade_extra_credit_weightoverride.html" onMouseOver="funcPopup(event,'upgrade_extra_credit_weightoverride')">upgrade_extra_credit_weightoverride</a>();
<a name="l880"><span class="linenum"> 880</span></a>  
<a name="l881"><span class="linenum"> 881</span></a>  <span class="comment">            // To skip running the same script on the upgrade to the next major release.</span>
<a name="l882"><span class="linenum"> 882</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('upgrade_extracreditweightsstepignored', 1);
<a name="l883"><span class="linenum"> 883</span></a>          }
<a name="l884"><span class="linenum"> 884</span></a>  
<a name="l885"><span class="linenum"> 885</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l886"><span class="linenum"> 886</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015061900.00);
<a name="l887"><span class="linenum"> 887</span></a>      }
<a name="l888"><span class="linenum"> 888</span></a>  
<a name="l889"><span class="linenum"> 889</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015062500.01) {
<a name="l890"><span class="linenum"> 890</span></a>  <span class="comment">        // MDL-48239. Changed calculated grade items so that the maximum and minimum grade can be set.</span>
<a name="l891"><span class="linenum"> 891</span></a>  
<a name="l892"><span class="linenum"> 892</span></a>  <span class="comment">        // If the changes are accepted and a regrade is done on the gradebook then some grades may change significantly.</span>
<a name="l893"><span class="linenum"> 893</span></a>  <span class="comment">        // This is here to freeze the gradebook in affected courses.</span>
<a name="l894"><span class="linenum"> 894</span></a>  
<a name="l895"><span class="linenum"> 895</span></a>  <span class="comment">        // This script is included in each major version upgrade process so make sure we don't run it twice.</span>
<a name="l896"><span class="linenum"> 896</span></a>          if (empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('upgrade_calculatedgradeitemsignored')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/upgrade_calculatedgradeitemsignored.html">upgrade_calculatedgradeitemsignored</a>)) {
<a name="l897"><span class="linenum"> 897</span></a>              <a class="function" onClick="logFunction('upgrade_calculated_grade_items')" href="../../_functions/upgrade_calculated_grade_items.html" onMouseOver="funcPopup(event,'upgrade_calculated_grade_items')">upgrade_calculated_grade_items</a>();
<a name="l898"><span class="linenum"> 898</span></a>  
<a name="l899"><span class="linenum"> 899</span></a>  <span class="comment">            // To skip running the same script on the upgrade to the next major release.</span>
<a name="l900"><span class="linenum"> 900</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('upgrade_calculatedgradeitemsignored', 1);
<a name="l901"><span class="linenum"> 901</span></a>  <span class="comment">            // This config value is never used again.</span>
<a name="l902"><span class="linenum"> 902</span></a>              <a class="function" onClick="logFunction('unset_config')" href="../../_functions/unset_config.html" onMouseOver="funcPopup(event,'unset_config')">unset_config</a>('upgrade_calculatedgradeitemsonlyregrade');
<a name="l903"><span class="linenum"> 903</span></a>          }
<a name="l904"><span class="linenum"> 904</span></a>  
<a name="l905"><span class="linenum"> 905</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l906"><span class="linenum"> 906</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015062500.01);
<a name="l907"><span class="linenum"> 907</span></a>      }
<a name="l908"><span class="linenum"> 908</span></a>  
<a name="l909"><span class="linenum"> 909</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015081300.01) {
<a name="l910"><span class="linenum"> 910</span></a>  
<a name="l911"><span class="linenum"> 911</span></a>  <span class="comment">        // Define field importtype to be added to grade_import_values.</span>
<a name="l912"><span class="linenum"> 912</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('grade_import_values');
<a name="l913"><span class="linenum"> 913</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('importonlyfeedback', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '1', null, null, null, '0', 'importer');
<a name="l914"><span class="linenum"> 914</span></a>  
<a name="l915"><span class="linenum"> 915</span></a>  <span class="comment">        // Conditionally launch add field importtype.</span>
<a name="l916"><span class="linenum"> 916</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>)) {
<a name="l917"><span class="linenum"> 917</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l918"><span class="linenum"> 918</span></a>          }
<a name="l919"><span class="linenum"> 919</span></a>  
<a name="l920"><span class="linenum"> 920</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l921"><span class="linenum"> 921</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015081300.01);
<a name="l922"><span class="linenum"> 922</span></a>      }
<a name="l923"><span class="linenum"> 923</span></a>  
<a name="l924"><span class="linenum"> 924</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015082400.00) {
<a name="l925"><span class="linenum"> 925</span></a>  
<a name="l926"><span class="linenum"> 926</span></a>  <span class="comment">        // Define table webdav_locks to be dropped.</span>
<a name="l927"><span class="linenum"> 927</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('webdav_locks');
<a name="l928"><span class="linenum"> 928</span></a>  
<a name="l929"><span class="linenum"> 929</span></a>  <span class="comment">        // Conditionally launch drop table for webdav_locks.</span>
<a name="l930"><span class="linenum"> 930</span></a>          if (<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l931"><span class="linenum"> 931</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('drop_table')" href="../../_functions/drop_table.html" onMouseOver="funcPopup(event,'drop_table')">drop_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l932"><span class="linenum"> 932</span></a>          }
<a name="l933"><span class="linenum"> 933</span></a>  
<a name="l934"><span class="linenum"> 934</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l935"><span class="linenum"> 935</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015082400.00);
<a name="l936"><span class="linenum"> 936</span></a>      }
<a name="l937"><span class="linenum"> 937</span></a>  
<a name="l938"><span class="linenum"> 938</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015090200.00) {
<a name="l939"><span class="linenum"> 939</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('message');
<a name="l940"><span class="linenum"> 940</span></a>  
<a name="l941"><span class="linenum"> 941</span></a>  <span class="comment">        // Define the deleted fields to be added to the message tables.</span>
<a name="l942"><span class="linenum"> 942</span></a>          <a class="var it30826" onMouseOver="hilite(30826)" onMouseOut="lolite()" onClick="logVariable('field1')" href="../../_variables/field1.html">$field1</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('timeuserfromdeleted', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0',
<a name="l943"><span class="linenum"> 943</span></a>              'timecreated');
<a name="l944"><span class="linenum"> 944</span></a>          <a class="var it30827" onMouseOver="hilite(30827)" onMouseOut="lolite()" onClick="logVariable('field2')" href="../../_variables/field2.html">$field2</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('timeusertodeleted', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0',
<a name="l945"><span class="linenum"> 945</span></a>              'timecreated');
<a name="l946"><span class="linenum"> 946</span></a>          <a class="var it23283" onMouseOver="hilite(23283)" onMouseOut="lolite()" onClick="logVariable('oldindex')" href="../../_variables/oldindex.html">$oldindex</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('useridfromto', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>,
<a name="l947"><span class="linenum"> 947</span></a>              array('useridfrom', 'useridto'));
<a name="l948"><span class="linenum"> 948</span></a>          <a class="var it23281" onMouseOver="hilite(23281)" onMouseOut="lolite()" onClick="logVariable('newindex')" href="../../_variables/newindex.html">$newindex</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('useridfromtodeleted', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>,
<a name="l949"><span class="linenum"> 949</span></a>              array('useridfrom', 'useridto', 'timeuserfromdeleted', 'timeusertodeleted'));
<a name="l950"><span class="linenum"> 950</span></a>  
<a name="l951"><span class="linenum"> 951</span></a>  <span class="comment">        // Conditionally launch add field timeuserfromdeleted.</span>
<a name="l952"><span class="linenum"> 952</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it30826" onMouseOver="hilite(30826)" onMouseOut="lolite()" onClick="logVariable('field1')" href="../../_variables/field1.html">$field1</a>)) {
<a name="l953"><span class="linenum"> 953</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it30826" onMouseOver="hilite(30826)" onMouseOut="lolite()" onClick="logVariable('field1')" href="../../_variables/field1.html">$field1</a>);
<a name="l954"><span class="linenum"> 954</span></a>          }
<a name="l955"><span class="linenum"> 955</span></a>  
<a name="l956"><span class="linenum"> 956</span></a>  <span class="comment">        // Conditionally launch add field timeusertodeleted.</span>
<a name="l957"><span class="linenum"> 957</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it30827" onMouseOver="hilite(30827)" onMouseOut="lolite()" onClick="logVariable('field2')" href="../../_variables/field2.html">$field2</a>)) {
<a name="l958"><span class="linenum"> 958</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it30827" onMouseOver="hilite(30827)" onMouseOut="lolite()" onClick="logVariable('field2')" href="../../_variables/field2.html">$field2</a>);
<a name="l959"><span class="linenum"> 959</span></a>          }
<a name="l960"><span class="linenum"> 960</span></a>  
<a name="l961"><span class="linenum"> 961</span></a>  <span class="comment">        // Conditionally launch drop index useridfromto.</span>
<a name="l962"><span class="linenum"> 962</span></a>          if (<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it23283" onMouseOver="hilite(23283)" onMouseOut="lolite()" onClick="logVariable('oldindex')" href="../../_variables/oldindex.html">$oldindex</a>)) {
<a name="l963"><span class="linenum"> 963</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('drop_index')" href="../../_functions/drop_index.html" onMouseOver="funcPopup(event,'drop_index')">drop_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it23283" onMouseOver="hilite(23283)" onMouseOut="lolite()" onClick="logVariable('oldindex')" href="../../_variables/oldindex.html">$oldindex</a>);
<a name="l964"><span class="linenum"> 964</span></a>          }
<a name="l965"><span class="linenum"> 965</span></a>  
<a name="l966"><span class="linenum"> 966</span></a>  <span class="comment">        // Conditionally launch add index useridfromtodeleted.</span>
<a name="l967"><span class="linenum"> 967</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it23281" onMouseOver="hilite(23281)" onMouseOut="lolite()" onClick="logVariable('newindex')" href="../../_variables/newindex.html">$newindex</a>)) {
<a name="l968"><span class="linenum"> 968</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it23281" onMouseOver="hilite(23281)" onMouseOut="lolite()" onClick="logVariable('newindex')" href="../../_variables/newindex.html">$newindex</a>);
<a name="l969"><span class="linenum"> 969</span></a>          }
<a name="l970"><span class="linenum"> 970</span></a>  
<a name="l971"><span class="linenum"> 971</span></a>  <span class="comment">        // Now add them to the message_read table.</span>
<a name="l972"><span class="linenum"> 972</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('message_read');
<a name="l973"><span class="linenum"> 973</span></a>  
<a name="l974"><span class="linenum"> 974</span></a>  <span class="comment">        // Conditionally launch add field timeuserfromdeleted.</span>
<a name="l975"><span class="linenum"> 975</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it30826" onMouseOver="hilite(30826)" onMouseOut="lolite()" onClick="logVariable('field1')" href="../../_variables/field1.html">$field1</a>)) {
<a name="l976"><span class="linenum"> 976</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it30826" onMouseOver="hilite(30826)" onMouseOut="lolite()" onClick="logVariable('field1')" href="../../_variables/field1.html">$field1</a>);
<a name="l977"><span class="linenum"> 977</span></a>          }
<a name="l978"><span class="linenum"> 978</span></a>  
<a name="l979"><span class="linenum"> 979</span></a>  <span class="comment">        // Conditionally launch add field timeusertodeleted.</span>
<a name="l980"><span class="linenum"> 980</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it30827" onMouseOver="hilite(30827)" onMouseOut="lolite()" onClick="logVariable('field2')" href="../../_variables/field2.html">$field2</a>)) {
<a name="l981"><span class="linenum"> 981</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it30827" onMouseOver="hilite(30827)" onMouseOut="lolite()" onClick="logVariable('field2')" href="../../_variables/field2.html">$field2</a>);
<a name="l982"><span class="linenum"> 982</span></a>          }
<a name="l983"><span class="linenum"> 983</span></a>  
<a name="l984"><span class="linenum"> 984</span></a>  <span class="comment">        // Conditionally launch drop index useridfromto.</span>
<a name="l985"><span class="linenum"> 985</span></a>          if (<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it23283" onMouseOver="hilite(23283)" onMouseOut="lolite()" onClick="logVariable('oldindex')" href="../../_variables/oldindex.html">$oldindex</a>)) {
<a name="l986"><span class="linenum"> 986</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('drop_index')" href="../../_functions/drop_index.html" onMouseOver="funcPopup(event,'drop_index')">drop_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it23283" onMouseOver="hilite(23283)" onMouseOut="lolite()" onClick="logVariable('oldindex')" href="../../_variables/oldindex.html">$oldindex</a>);
<a name="l987"><span class="linenum"> 987</span></a>          }
<a name="l988"><span class="linenum"> 988</span></a>  
<a name="l989"><span class="linenum"> 989</span></a>  <span class="comment">        // Conditionally launch add index useridfromtodeleted.</span>
<a name="l990"><span class="linenum"> 990</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it23281" onMouseOver="hilite(23281)" onMouseOut="lolite()" onClick="logVariable('newindex')" href="../../_variables/newindex.html">$newindex</a>)) {
<a name="l991"><span class="linenum"> 991</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it23281" onMouseOver="hilite(23281)" onMouseOut="lolite()" onClick="logVariable('newindex')" href="../../_variables/newindex.html">$newindex</a>);
<a name="l992"><span class="linenum"> 992</span></a>          }
<a name="l993"><span class="linenum"> 993</span></a>  
<a name="l994"><span class="linenum"> 994</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l995"><span class="linenum"> 995</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015090200.00);
<a name="l996"><span class="linenum"> 996</span></a>      }
<a name="l997"><span class="linenum"> 997</span></a>  
<a name="l998"><span class="linenum"> 998</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015090801.00) {
<a name="l999"><span class="linenum"> 999</span></a>  <span class="comment">        // This upgrade script merges all tag instances pointing to the same course tag.</span>
<a name="l1000"><span class="linenum">1000</span></a>  <span class="comment">        // User id is no longer used for those tag instances.</span>
<a name="l1001"><span class="linenum">1001</span></a>          <a class="function" onClick="logFunction('upgrade_course_tags')" href="../../_functions/upgrade_course_tags.html" onMouseOver="funcPopup(event,'upgrade_course_tags')">upgrade_course_tags</a>();
<a name="l1002"><span class="linenum">1002</span></a>  
<a name="l1003"><span class="linenum">1003</span></a>  <span class="comment">        // If configuration variable &quot;Show course tags&quot; is set, disable the block</span>
<a name="l1004"><span class="linenum">1004</span></a>  <span class="comment">        // 'tags' because it can not be used for tagging courses any more.</span>
<a name="l1005"><span class="linenum">1005</span></a>          if (!empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('block_tags_showcoursetags')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/block_tags_showcoursetags.html">block_tags_showcoursetags</a>)) {
<a name="l1006"><span class="linenum">1006</span></a>              if (<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('block', array('name' =&gt; 'tags'), 'id, visible')) {
<a name="l1007"><span class="linenum">1007</span></a>                  if (<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('visible')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/visible.html">visible</a>) {
<a name="l1008"><span class="linenum">1008</span></a>                      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('block', array('id' =&gt; <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'visible' =&gt; 0));
<a name="l1009"><span class="linenum">1009</span></a>                  }
<a name="l1010"><span class="linenum">1010</span></a>              }
<a name="l1011"><span class="linenum">1011</span></a>          }
<a name="l1012"><span class="linenum">1012</span></a>  
<a name="l1013"><span class="linenum">1013</span></a>  <span class="comment">        // Define index idname (unique) to be dropped form tag (it's really weird).</span>
<a name="l1014"><span class="linenum">1014</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('tag');
<a name="l1015"><span class="linenum">1015</span></a>          <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('idname', <a class="constant" onClick="logConstant('XMLDB_INDEX_UNIQUE')" href="../../_constants/XMLDB_INDEX_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_UNIQUE')">XMLDB_INDEX_UNIQUE</a>, array('id', 'name'));
<a name="l1016"><span class="linenum">1016</span></a>  
<a name="l1017"><span class="linenum">1017</span></a>  <span class="comment">        // Conditionally launch drop index idname.</span>
<a name="l1018"><span class="linenum">1018</span></a>          if (<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>)) {
<a name="l1019"><span class="linenum">1019</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('drop_index')" href="../../_functions/drop_index.html" onMouseOver="funcPopup(event,'drop_index')">drop_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>);
<a name="l1020"><span class="linenum">1020</span></a>          }
<a name="l1021"><span class="linenum">1021</span></a>  
<a name="l1022"><span class="linenum">1022</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1023"><span class="linenum">1023</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015090801.00);
<a name="l1024"><span class="linenum">1024</span></a>      }
<a name="l1025"><span class="linenum">1025</span></a>  
<a name="l1026"><span class="linenum">1026</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015092200.00) {
<a name="l1027"><span class="linenum">1027</span></a>  <span class="comment">        // Define index qtype (not unique) to be added to question.</span>
<a name="l1028"><span class="linenum">1028</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('question');
<a name="l1029"><span class="linenum">1029</span></a>          <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('qtype', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('qtype'));
<a name="l1030"><span class="linenum">1030</span></a>  
<a name="l1031"><span class="linenum">1031</span></a>  <span class="comment">        // Conditionally launch add index qtype.</span>
<a name="l1032"><span class="linenum">1032</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>)) {
<a name="l1033"><span class="linenum">1033</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>);
<a name="l1034"><span class="linenum">1034</span></a>          }
<a name="l1035"><span class="linenum">1035</span></a>  
<a name="l1036"><span class="linenum">1036</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1037"><span class="linenum">1037</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015092200.00);
<a name="l1038"><span class="linenum">1038</span></a>      }
<a name="l1039"><span class="linenum">1039</span></a>  
<a name="l1040"><span class="linenum">1040</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015092900.00) {
<a name="l1041"><span class="linenum">1041</span></a>  <span class="comment">        // Rename backup_auto_keep setting to backup_auto_max_kept.</span>
<a name="l1042"><span class="linenum">1042</span></a>          <a class="var it10178" onMouseOver="hilite(10178)" onMouseOut="lolite()" onClick="logVariable('keep')" href="../../_variables/keep.html">$keep</a> = <a class="function" onClick="logFunction('get_config')" href="../../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>('backup', 'backup_auto_keep');
<a name="l1043"><span class="linenum">1043</span></a>          if (<a class="var it10178" onMouseOver="hilite(10178)" onMouseOut="lolite()" onClick="logVariable('keep')" href="../../_variables/keep.html">$keep</a> !== false) {
<a name="l1044"><span class="linenum">1044</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('backup_auto_max_kept', <a class="var it10178" onMouseOver="hilite(10178)" onMouseOut="lolite()" onClick="logVariable('keep')" href="../../_variables/keep.html">$keep</a>, 'backup');
<a name="l1045"><span class="linenum">1045</span></a>              <a class="function" onClick="logFunction('unset_config')" href="../../_functions/unset_config.html" onMouseOver="funcPopup(event,'unset_config')">unset_config</a>('backup_auto_keep', 'backup');
<a name="l1046"><span class="linenum">1046</span></a>          }
<a name="l1047"><span class="linenum">1047</span></a>  
<a name="l1048"><span class="linenum">1048</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1049"><span class="linenum">1049</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015092900.00);
<a name="l1050"><span class="linenum">1050</span></a>      }
<a name="l1051"><span class="linenum">1051</span></a>  
<a name="l1052"><span class="linenum">1052</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015100600.00) {
<a name="l1053"><span class="linenum">1053</span></a>  
<a name="l1054"><span class="linenum">1054</span></a>  <span class="comment">        // Define index notification (not unique) to be added to message_read.</span>
<a name="l1055"><span class="linenum">1055</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('message_read');
<a name="l1056"><span class="linenum">1056</span></a>          <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('notificationtimeread', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('notification', 'timeread'));
<a name="l1057"><span class="linenum">1057</span></a>  
<a name="l1058"><span class="linenum">1058</span></a>  <span class="comment">        // Conditionally launch add index notification.</span>
<a name="l1059"><span class="linenum">1059</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>)) {
<a name="l1060"><span class="linenum">1060</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>);
<a name="l1061"><span class="linenum">1061</span></a>          }
<a name="l1062"><span class="linenum">1062</span></a>  
<a name="l1063"><span class="linenum">1063</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1064"><span class="linenum">1064</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015100600.00);
<a name="l1065"><span class="linenum">1065</span></a>      }
<a name="l1066"><span class="linenum">1066</span></a>  
<a name="l1067"><span class="linenum">1067</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2015100800.01) {
<a name="l1068"><span class="linenum">1068</span></a>  <span class="comment">        // The only flag for preventing all plugins installation features is</span>
<a name="l1069"><span class="linenum">1069</span></a>  <span class="comment">        // now $CFG-&gt;disableupdateautodeploy in config.php.</span>
<a name="l1070"><span class="linenum">1070</span></a>          <a class="function" onClick="logFunction('unset_config')" href="../../_functions/unset_config.html" onMouseOver="funcPopup(event,'unset_config')">unset_config</a>('updateautodeploy');
<a name="l1071"><span class="linenum">1071</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2015100800.01);
<a name="l1072"><span class="linenum">1072</span></a>      }
<a name="l1073"><span class="linenum">1073</span></a>  
<a name="l1074"><span class="linenum">1074</span></a>  <span class="comment">    // Moodle v3.0.0 release upgrade line.</span>
<a name="l1075"><span class="linenum">1075</span></a>  <span class="comment">    // Put any upgrade step following this.</span>
<a name="l1076"><span class="linenum">1076</span></a>  
<a name="l1077"><span class="linenum">1077</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016011300.01) {
<a name="l1078"><span class="linenum">1078</span></a>  
<a name="l1079"><span class="linenum">1079</span></a>  <span class="comment">        // This is a big upgrade script. We create new table tag_coll and the field</span>
<a name="l1080"><span class="linenum">1080</span></a>  <span class="comment">        // tag.tagcollid pointing to it.</span>
<a name="l1081"><span class="linenum">1081</span></a>  
<a name="l1082"><span class="linenum">1082</span></a>  <span class="comment">        // Define table tag_coll to be created.</span>
<a name="l1083"><span class="linenum">1083</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('tag_coll');
<a name="l1084"><span class="linenum">1084</span></a>  
<a name="l1085"><span class="linenum">1085</span></a>  <span class="comment">        // Adding fields to table tagcloud.</span>
<a name="l1086"><span class="linenum">1086</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l1087"><span class="linenum">1087</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('name', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '255', null, null, null, null);
<a name="l1088"><span class="linenum">1088</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('isdefault', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '2', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0');
<a name="l1089"><span class="linenum">1089</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('component', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '100', null, null, null, null);
<a name="l1090"><span class="linenum">1090</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('sortorder', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '5', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0');
<a name="l1091"><span class="linenum">1091</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('searchable', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '2', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '1');
<a name="l1092"><span class="linenum">1092</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('customurl', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '255', null, null, null, null);
<a name="l1093"><span class="linenum">1093</span></a>  
<a name="l1094"><span class="linenum">1094</span></a>  <span class="comment">        // Adding keys to table tagcloud.</span>
<a name="l1095"><span class="linenum">1095</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l1096"><span class="linenum">1096</span></a>  
<a name="l1097"><span class="linenum">1097</span></a>  <span class="comment">        // Conditionally launch create table for tagcloud.</span>
<a name="l1098"><span class="linenum">1098</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l1099"><span class="linenum">1099</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l1100"><span class="linenum">1100</span></a>          }
<a name="l1101"><span class="linenum">1101</span></a>  
<a name="l1102"><span class="linenum">1102</span></a>  <span class="comment">        // Table {tag}.</span>
<a name="l1103"><span class="linenum">1103</span></a>  <span class="comment">        // Define index name (unique) to be dropped form tag - we will replace it with index on (tagcollid,name) later.</span>
<a name="l1104"><span class="linenum">1104</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('tag');
<a name="l1105"><span class="linenum">1105</span></a>          <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('name', <a class="constant" onClick="logConstant('XMLDB_INDEX_UNIQUE')" href="../../_constants/XMLDB_INDEX_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_UNIQUE')">XMLDB_INDEX_UNIQUE</a>, array('name'));
<a name="l1106"><span class="linenum">1106</span></a>  
<a name="l1107"><span class="linenum">1107</span></a>  <span class="comment">        // Conditionally launch drop index name.</span>
<a name="l1108"><span class="linenum">1108</span></a>          if (<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>)) {
<a name="l1109"><span class="linenum">1109</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('drop_index')" href="../../_functions/drop_index.html" onMouseOver="funcPopup(event,'drop_index')">drop_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>);
<a name="l1110"><span class="linenum">1110</span></a>          }
<a name="l1111"><span class="linenum">1111</span></a>  
<a name="l1112"><span class="linenum">1112</span></a>  <span class="comment">        // Define field tagcollid to be added to tag, we create it as null first and will change to notnull later.</span>
<a name="l1113"><span class="linenum">1113</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('tag');
<a name="l1114"><span class="linenum">1114</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('tagcollid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null, 'userid');
<a name="l1115"><span class="linenum">1115</span></a>  
<a name="l1116"><span class="linenum">1116</span></a>  <span class="comment">        // Conditionally launch add field tagcloudid.</span>
<a name="l1117"><span class="linenum">1117</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>)) {
<a name="l1118"><span class="linenum">1118</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l1119"><span class="linenum">1119</span></a>          }
<a name="l1120"><span class="linenum">1120</span></a>  
<a name="l1121"><span class="linenum">1121</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1122"><span class="linenum">1122</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016011300.01);
<a name="l1123"><span class="linenum">1123</span></a>      }
<a name="l1124"><span class="linenum">1124</span></a>  
<a name="l1125"><span class="linenum">1125</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016011300.02) {
<a name="l1126"><span class="linenum">1126</span></a>  <span class="comment">        // Create a default tag collection if not exists and update the field tag.tagcollid to point to it.</span>
<a name="l1127"><span class="linenum">1127</span></a>          if (!<a class="var it30829" onMouseOver="hilite(30829)" onMouseOut="lolite()" onClick="logVariable('tcid')" href="../../_variables/tcid.html">$tcid</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_field_sql')" href="../../_functions/get_field_sql.html" onMouseOver="funcPopup(event,'get_field_sql')">get_field_sql</a>('SELECT id FROM {tag_coll} ORDER BY isdefault DESC, sortorder, id', null,
<a name="l1128"><span class="linenum">1128</span></a>                  <a class="constant" onClick="logConstant('IGNORE_MULTIPLE')" href="../../_constants/IGNORE_MULTIPLE.html" onMouseOver="constPopup(event,'IGNORE_MULTIPLE')">IGNORE_MULTIPLE</a>)) {
<a name="l1129"><span class="linenum">1129</span></a>              <a class="var it30829" onMouseOver="hilite(30829)" onMouseOut="lolite()" onClick="logVariable('tcid')" href="../../_variables/tcid.html">$tcid</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('tag_coll', array('isdefault' =&gt; 1, 'sortorder' =&gt; 0));
<a name="l1130"><span class="linenum">1130</span></a>          }
<a name="l1131"><span class="linenum">1131</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>('UPDATE {tag} SET tagcollid = ? WHERE tagcollid IS NULL', array(<a class="var it30829" onMouseOver="hilite(30829)" onMouseOut="lolite()" onClick="logVariable('tcid')" href="../../_variables/tcid.html">$tcid</a>));
<a name="l1132"><span class="linenum">1132</span></a>  
<a name="l1133"><span class="linenum">1133</span></a>  <span class="comment">        // Define index tagcollname (unique) to be added to tag.</span>
<a name="l1134"><span class="linenum">1134</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('tag');
<a name="l1135"><span class="linenum">1135</span></a>          <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('tagcollname', <a class="constant" onClick="logConstant('XMLDB_INDEX_UNIQUE')" href="../../_constants/XMLDB_INDEX_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_UNIQUE')">XMLDB_INDEX_UNIQUE</a>, array('tagcollid', 'name'));
<a name="l1136"><span class="linenum">1136</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('tagcollid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null, 'userid');
<a name="l1137"><span class="linenum">1137</span></a>  
<a name="l1138"><span class="linenum">1138</span></a>  <span class="comment">        // Conditionally launch add index tagcollname.</span>
<a name="l1139"><span class="linenum">1139</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>)) {
<a name="l1140"><span class="linenum">1140</span></a>  <span class="comment">            // Launch change of nullability for field tagcollid.</span>
<a name="l1141"><span class="linenum">1141</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('change_field_notnull')" href="../../_functions/change_field_notnull.html" onMouseOver="funcPopup(event,'change_field_notnull')">change_field_notnull</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l1142"><span class="linenum">1142</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>);
<a name="l1143"><span class="linenum">1143</span></a>          }
<a name="l1144"><span class="linenum">1144</span></a>  
<a name="l1145"><span class="linenum">1145</span></a>  <span class="comment">        // Define key tagcollid (foreign) to be added to tag.</span>
<a name="l1146"><span class="linenum">1146</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('tag');
<a name="l1147"><span class="linenum">1147</span></a>          <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_key')" href="../../_classes/xmldb_key.html" onMouseOver="classPopup(event,'xmldb_key')">xmldb_key</a>('tagcollid', <a class="constant" onClick="logConstant('XMLDB_KEY_FOREIGN')" href="../../_constants/XMLDB_KEY_FOREIGN.html" onMouseOver="constPopup(event,'XMLDB_KEY_FOREIGN')">XMLDB_KEY_FOREIGN</a>, array('tagcollid'), 'tag_coll', array('id'));
<a name="l1148"><span class="linenum">1148</span></a>  
<a name="l1149"><span class="linenum">1149</span></a>  <span class="comment">        // Launch add key tagcloudid.</span>
<a name="l1150"><span class="linenum">1150</span></a>          <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>);
<a name="l1151"><span class="linenum">1151</span></a>  
<a name="l1152"><span class="linenum">1152</span></a>  <span class="comment">        // Define index tagcolltype (not unique) to be added to tag.</span>
<a name="l1153"><span class="linenum">1153</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('tag');
<a name="l1154"><span class="linenum">1154</span></a>          <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('tagcolltype', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('tagcollid', 'tagtype'));
<a name="l1155"><span class="linenum">1155</span></a>  
<a name="l1156"><span class="linenum">1156</span></a>  <span class="comment">        // Conditionally launch add index tagcolltype.</span>
<a name="l1157"><span class="linenum">1157</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>)) {
<a name="l1158"><span class="linenum">1158</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>);
<a name="l1159"><span class="linenum">1159</span></a>          }
<a name="l1160"><span class="linenum">1160</span></a>  
<a name="l1161"><span class="linenum">1161</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1162"><span class="linenum">1162</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016011300.02);
<a name="l1163"><span class="linenum">1163</span></a>      }
<a name="l1164"><span class="linenum">1164</span></a>  
<a name="l1165"><span class="linenum">1165</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016011300.03) {
<a name="l1166"><span class="linenum">1166</span></a>  
<a name="l1167"><span class="linenum">1167</span></a>  <span class="comment">        // Define table tag_area to be created.</span>
<a name="l1168"><span class="linenum">1168</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('tag_area');
<a name="l1169"><span class="linenum">1169</span></a>  
<a name="l1170"><span class="linenum">1170</span></a>  <span class="comment">        // Adding fields to table tag_area.</span>
<a name="l1171"><span class="linenum">1171</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l1172"><span class="linenum">1172</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('component', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '100', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1173"><span class="linenum">1173</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('itemtype', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '100', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1174"><span class="linenum">1174</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('enabled', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '2', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '1');
<a name="l1175"><span class="linenum">1175</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('tagcollid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1176"><span class="linenum">1176</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('callback', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '100', null, null, null, null);
<a name="l1177"><span class="linenum">1177</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('callbackfile', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '100', null, null, null, null);
<a name="l1178"><span class="linenum">1178</span></a>  
<a name="l1179"><span class="linenum">1179</span></a>  <span class="comment">        // Adding keys to table tag_area.</span>
<a name="l1180"><span class="linenum">1180</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l1181"><span class="linenum">1181</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('tagcollid', <a class="constant" onClick="logConstant('XMLDB_KEY_FOREIGN')" href="../../_constants/XMLDB_KEY_FOREIGN.html" onMouseOver="constPopup(event,'XMLDB_KEY_FOREIGN')">XMLDB_KEY_FOREIGN</a>, array('tagcollid'), 'tag_coll', array('id'));
<a name="l1182"><span class="linenum">1182</span></a>  
<a name="l1183"><span class="linenum">1183</span></a>  <span class="comment">        // Adding indexes to table tag_area.</span>
<a name="l1184"><span class="linenum">1184</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('compitemtype', <a class="constant" onClick="logConstant('XMLDB_INDEX_UNIQUE')" href="../../_constants/XMLDB_INDEX_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_UNIQUE')">XMLDB_INDEX_UNIQUE</a>, array('component', 'itemtype'));
<a name="l1185"><span class="linenum">1185</span></a>  
<a name="l1186"><span class="linenum">1186</span></a>  <span class="comment">        // Conditionally launch create table for tag_area.</span>
<a name="l1187"><span class="linenum">1187</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l1188"><span class="linenum">1188</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l1189"><span class="linenum">1189</span></a>          }
<a name="l1190"><span class="linenum">1190</span></a>  
<a name="l1191"><span class="linenum">1191</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1192"><span class="linenum">1192</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016011300.03);
<a name="l1193"><span class="linenum">1193</span></a>      }
<a name="l1194"><span class="linenum">1194</span></a>  
<a name="l1195"><span class="linenum">1195</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016011300.04) {
<a name="l1196"><span class="linenum">1196</span></a>  
<a name="l1197"><span class="linenum">1197</span></a>  <span class="comment">        // Define index itemtype-itemid-tagid-tiuserid (unique) to be dropped form tag_instance.</span>
<a name="l1198"><span class="linenum">1198</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('tag_instance');
<a name="l1199"><span class="linenum">1199</span></a>          <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('itemtype-itemid-tagid-tiuserid', <a class="constant" onClick="logConstant('XMLDB_INDEX_UNIQUE')" href="../../_constants/XMLDB_INDEX_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_UNIQUE')">XMLDB_INDEX_UNIQUE</a>,
<a name="l1200"><span class="linenum">1200</span></a>                  array('itemtype', 'itemid', 'tagid', 'tiuserid'));
<a name="l1201"><span class="linenum">1201</span></a>  
<a name="l1202"><span class="linenum">1202</span></a>  <span class="comment">        // Conditionally launch drop index itemtype-itemid-tagid-tiuserid.</span>
<a name="l1203"><span class="linenum">1203</span></a>          if (<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>)) {
<a name="l1204"><span class="linenum">1204</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('drop_index')" href="../../_functions/drop_index.html" onMouseOver="funcPopup(event,'drop_index')">drop_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>);
<a name="l1205"><span class="linenum">1205</span></a>          }
<a name="l1206"><span class="linenum">1206</span></a>  
<a name="l1207"><span class="linenum">1207</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1208"><span class="linenum">1208</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016011300.04);
<a name="l1209"><span class="linenum">1209</span></a>      }
<a name="l1210"><span class="linenum">1210</span></a>  
<a name="l1211"><span class="linenum">1211</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016011300.05) {
<a name="l1212"><span class="linenum">1212</span></a>  
<a name="l1213"><span class="linenum">1213</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>(&quot;UPDATE {tag_instance} SET component = ? WHERE component IS NULL&quot;, array(''));
<a name="l1214"><span class="linenum">1214</span></a>  
<a name="l1215"><span class="linenum">1215</span></a>  <span class="comment">        // Changing nullability of field component on table tag_instance to not null.</span>
<a name="l1216"><span class="linenum">1216</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('tag_instance');
<a name="l1217"><span class="linenum">1217</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('component', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '100', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null, 'tagid');
<a name="l1218"><span class="linenum">1218</span></a>  
<a name="l1219"><span class="linenum">1219</span></a>  <span class="comment">        // Launch change of nullability for field component.</span>
<a name="l1220"><span class="linenum">1220</span></a>          <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('change_field_notnull')" href="../../_functions/change_field_notnull.html" onMouseOver="funcPopup(event,'change_field_notnull')">change_field_notnull</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l1221"><span class="linenum">1221</span></a>  
<a name="l1222"><span class="linenum">1222</span></a>  <span class="comment">        // Changing type of field itemtype on table tag_instance to char.</span>
<a name="l1223"><span class="linenum">1223</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('tag_instance');
<a name="l1224"><span class="linenum">1224</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('itemtype', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '100', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null, 'component');
<a name="l1225"><span class="linenum">1225</span></a>  
<a name="l1226"><span class="linenum">1226</span></a>  <span class="comment">        // Launch change of type for field itemtype.</span>
<a name="l1227"><span class="linenum">1227</span></a>          <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('change_field_type')" href="../../_functions/change_field_type.html" onMouseOver="funcPopup(event,'change_field_type')">change_field_type</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l1228"><span class="linenum">1228</span></a>  
<a name="l1229"><span class="linenum">1229</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1230"><span class="linenum">1230</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016011300.05);
<a name="l1231"><span class="linenum">1231</span></a>      }
<a name="l1232"><span class="linenum">1232</span></a>  
<a name="l1233"><span class="linenum">1233</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016011300.06) {
<a name="l1234"><span class="linenum">1234</span></a>  
<a name="l1235"><span class="linenum">1235</span></a>  <span class="comment">        // Define index taggeditem (unique) to be added to tag_instance.</span>
<a name="l1236"><span class="linenum">1236</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('tag_instance');
<a name="l1237"><span class="linenum">1237</span></a>          <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('taggeditem', <a class="constant" onClick="logConstant('XMLDB_INDEX_UNIQUE')" href="../../_constants/XMLDB_INDEX_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_UNIQUE')">XMLDB_INDEX_UNIQUE</a>, array('component', 'itemtype', 'itemid', 'tiuserid', 'tagid'));
<a name="l1238"><span class="linenum">1238</span></a>  
<a name="l1239"><span class="linenum">1239</span></a>  <span class="comment">        // Conditionally launch add index taggeditem.</span>
<a name="l1240"><span class="linenum">1240</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>)) {
<a name="l1241"><span class="linenum">1241</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>);
<a name="l1242"><span class="linenum">1242</span></a>          }
<a name="l1243"><span class="linenum">1243</span></a>  
<a name="l1244"><span class="linenum">1244</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1245"><span class="linenum">1245</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016011300.06);
<a name="l1246"><span class="linenum">1246</span></a>      }
<a name="l1247"><span class="linenum">1247</span></a>  
<a name="l1248"><span class="linenum">1248</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016011300.07) {
<a name="l1249"><span class="linenum">1249</span></a>  
<a name="l1250"><span class="linenum">1250</span></a>  <span class="comment">        // Define index taglookup (not unique) to be added to tag_instance.</span>
<a name="l1251"><span class="linenum">1251</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('tag_instance');
<a name="l1252"><span class="linenum">1252</span></a>          <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('taglookup', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('itemtype', 'component', 'tagid', 'contextid'));
<a name="l1253"><span class="linenum">1253</span></a>  
<a name="l1254"><span class="linenum">1254</span></a>  <span class="comment">        // Conditionally launch add index taglookup.</span>
<a name="l1255"><span class="linenum">1255</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>)) {
<a name="l1256"><span class="linenum">1256</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>);
<a name="l1257"><span class="linenum">1257</span></a>          }
<a name="l1258"><span class="linenum">1258</span></a>  
<a name="l1259"><span class="linenum">1259</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1260"><span class="linenum">1260</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016011300.07);
<a name="l1261"><span class="linenum">1261</span></a>      }
<a name="l1262"><span class="linenum">1262</span></a>  
<a name="l1263"><span class="linenum">1263</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016011301.00) {
<a name="l1264"><span class="linenum">1264</span></a>  
<a name="l1265"><span class="linenum">1265</span></a>  <span class="comment">        // Force uninstall of deleted tool.</span>
<a name="l1266"><span class="linenum">1266</span></a>          if (!<a class="phpfunction" onClick="logFunction('file_exists')" href="../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(&quot;<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>/webservice/amf&quot;)) {
<a name="l1267"><span class="linenum">1267</span></a>  <span class="comment">            // Remove capabilities.</span>
<a name="l1268"><span class="linenum">1268</span></a>              <a class="function" onClick="logFunction('capabilities_cleanup')" href="../../_functions/capabilities_cleanup.html" onMouseOver="funcPopup(event,'capabilities_cleanup')">capabilities_cleanup</a>('webservice_amf');
<a name="l1269"><span class="linenum">1269</span></a>  <span class="comment">            // Remove all other associated config.</span>
<a name="l1270"><span class="linenum">1270</span></a>              <a class="function" onClick="logFunction('unset_all_config_for_plugin')" href="../../_functions/unset_all_config_for_plugin.html" onMouseOver="funcPopup(event,'unset_all_config_for_plugin')">unset_all_config_for_plugin</a>('webservice_amf');
<a name="l1271"><span class="linenum">1271</span></a>          }
<a name="l1272"><span class="linenum">1272</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016011301.00);
<a name="l1273"><span class="linenum">1273</span></a>      }
<a name="l1274"><span class="linenum">1274</span></a>  
<a name="l1275"><span class="linenum">1275</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016011901.00) {
<a name="l1276"><span class="linenum">1276</span></a>  
<a name="l1277"><span class="linenum">1277</span></a>  <span class="comment">        // Convert calendar_lookahead to nearest new value.</span>
<a name="l1278"><span class="linenum">1278</span></a>          <a class="var it4224" onMouseOver="hilite(4224)" onMouseOut="lolite()" onClick="logVariable('transaction')" href="../../_variables/transaction.html">$transaction</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('start_delegated_transaction')" href="../../_functions/start_delegated_transaction.html" onMouseOver="funcPopup(event,'start_delegated_transaction')">start_delegated_transaction</a>();
<a name="l1279"><span class="linenum">1279</span></a>  
<a name="l1280"><span class="linenum">1280</span></a>  <span class="comment">        // Count all users who curretly have that preference set (for progress bar).</span>
<a name="l1281"><span class="linenum">1281</span></a>          <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('total')" href="../../_variables/total.html">$total</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records_select')" href="../../_functions/count_records_select.html" onMouseOver="funcPopup(event,'count_records_select')">count_records_select</a>('user_preferences', &quot;name = 'calendar_lookahead' AND value != '0'&quot;);
<a name="l1282"><span class="linenum">1282</span></a>          <a class="var it4895" onMouseOver="hilite(4895)" onMouseOut="lolite()" onClick="logVariable('pbar')" href="../../_variables/pbar.html">$pbar</a> = <span class="keyword">new </span><a class="class" onClick="logClass('progress_bar')" href="../../_classes/progress_bar.html" onMouseOver="classPopup(event,'progress_bar')">progress_bar</a>('upgradecalendarlookahead', 500, true);
<a name="l1283"><span class="linenum">1283</span></a>  
<a name="l1284"><span class="linenum">1284</span></a>  <span class="comment">        // Get all these users, one at a time.</span>
<a name="l1285"><span class="linenum">1285</span></a>          <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../_variables/rs.html">$rs</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset_select')" href="../../_functions/get_recordset_select.html" onMouseOver="funcPopup(event,'get_recordset_select')">get_recordset_select</a>('user_preferences', &quot;name = 'calendar_lookahead' AND value != '0'&quot;);
<a name="l1286"><span class="linenum">1286</span></a>          <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> = 0;
<a name="l1287"><span class="linenum">1287</span></a>          foreach (<a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../_variables/rs.html">$rs</a> as <a class="var it15791" onMouseOver="hilite(15791)" onMouseOut="lolite()" onClick="logVariable('userpref')" href="../../_variables/userpref.html">$userpref</a>) {
<a name="l1288"><span class="linenum">1288</span></a>  
<a name="l1289"><span class="linenum">1289</span></a>  <span class="comment">            // Calculate and set new lookahead value.</span>
<a name="l1290"><span class="linenum">1290</span></a>              if (<a class="var it15791" onMouseOver="hilite(15791)" onMouseOut="lolite()" onClick="logVariable('userpref')" href="../../_variables/userpref.html">$userpref</a>-&gt;<a onClick="logVariable('value')" class="var it43842" onMouseOver="hilite(43842)" onMouseOut="lolite()" href="../../_variables/value.html">value</a> &gt; 90) {
<a name="l1291"><span class="linenum">1291</span></a>                  <a class="var it3475" onMouseOver="hilite(3475)" onMouseOut="lolite()" onClick="logVariable('newvalue')" href="../../_variables/newvalue.html">$newvalue</a> = 120;
<a name="l1292"><span class="linenum">1292</span></a>              } else if (<a class="var it15791" onMouseOver="hilite(15791)" onMouseOut="lolite()" onClick="logVariable('userpref')" href="../../_variables/userpref.html">$userpref</a>-&gt;<a onClick="logVariable('value')" class="var it43842" onMouseOver="hilite(43842)" onMouseOut="lolite()" href="../../_variables/value.html">value</a> &gt; 60 and <a class="var it15791" onMouseOver="hilite(15791)" onMouseOut="lolite()" onClick="logVariable('userpref')" href="../../_variables/userpref.html">$userpref</a>-&gt;<a onClick="logVariable('value')" class="var it43842" onMouseOver="hilite(43842)" onMouseOut="lolite()" href="../../_variables/value.html">value</a> &lt; 90) {
<a name="l1293"><span class="linenum">1293</span></a>                  <a class="var it3475" onMouseOver="hilite(3475)" onMouseOut="lolite()" onClick="logVariable('newvalue')" href="../../_variables/newvalue.html">$newvalue</a> = 90;
<a name="l1294"><span class="linenum">1294</span></a>              } else if (<a class="var it15791" onMouseOver="hilite(15791)" onMouseOut="lolite()" onClick="logVariable('userpref')" href="../../_variables/userpref.html">$userpref</a>-&gt;<a onClick="logVariable('value')" class="var it43842" onMouseOver="hilite(43842)" onMouseOut="lolite()" href="../../_variables/value.html">value</a> &gt; 30 and <a class="var it15791" onMouseOver="hilite(15791)" onMouseOut="lolite()" onClick="logVariable('userpref')" href="../../_variables/userpref.html">$userpref</a>-&gt;<a onClick="logVariable('value')" class="var it43842" onMouseOver="hilite(43842)" onMouseOut="lolite()" href="../../_variables/value.html">value</a> &lt; 60) {
<a name="l1295"><span class="linenum">1295</span></a>                  <a class="var it3475" onMouseOver="hilite(3475)" onMouseOut="lolite()" onClick="logVariable('newvalue')" href="../../_variables/newvalue.html">$newvalue</a> = 60;
<a name="l1296"><span class="linenum">1296</span></a>              } else if (<a class="var it15791" onMouseOver="hilite(15791)" onMouseOut="lolite()" onClick="logVariable('userpref')" href="../../_variables/userpref.html">$userpref</a>-&gt;<a onClick="logVariable('value')" class="var it43842" onMouseOver="hilite(43842)" onMouseOut="lolite()" href="../../_variables/value.html">value</a> &gt; 21 and <a class="var it15791" onMouseOver="hilite(15791)" onMouseOut="lolite()" onClick="logVariable('userpref')" href="../../_variables/userpref.html">$userpref</a>-&gt;<a onClick="logVariable('value')" class="var it43842" onMouseOver="hilite(43842)" onMouseOut="lolite()" href="../../_variables/value.html">value</a> &lt; 30) {
<a name="l1297"><span class="linenum">1297</span></a>                  <a class="var it3475" onMouseOver="hilite(3475)" onMouseOut="lolite()" onClick="logVariable('newvalue')" href="../../_variables/newvalue.html">$newvalue</a> = 30;
<a name="l1298"><span class="linenum">1298</span></a>              } else if (<a class="var it15791" onMouseOver="hilite(15791)" onMouseOut="lolite()" onClick="logVariable('userpref')" href="../../_variables/userpref.html">$userpref</a>-&gt;<a onClick="logVariable('value')" class="var it43842" onMouseOver="hilite(43842)" onMouseOut="lolite()" href="../../_variables/value.html">value</a> &gt; 14 and <a class="var it15791" onMouseOver="hilite(15791)" onMouseOut="lolite()" onClick="logVariable('userpref')" href="../../_variables/userpref.html">$userpref</a>-&gt;<a onClick="logVariable('value')" class="var it43842" onMouseOver="hilite(43842)" onMouseOut="lolite()" href="../../_variables/value.html">value</a> &lt; 21) {
<a name="l1299"><span class="linenum">1299</span></a>                  <a class="var it3475" onMouseOver="hilite(3475)" onMouseOut="lolite()" onClick="logVariable('newvalue')" href="../../_variables/newvalue.html">$newvalue</a> = 21;
<a name="l1300"><span class="linenum">1300</span></a>              } else if (<a class="var it15791" onMouseOver="hilite(15791)" onMouseOut="lolite()" onClick="logVariable('userpref')" href="../../_variables/userpref.html">$userpref</a>-&gt;<a onClick="logVariable('value')" class="var it43842" onMouseOver="hilite(43842)" onMouseOut="lolite()" href="../../_variables/value.html">value</a> &gt; 7 and <a class="var it15791" onMouseOver="hilite(15791)" onMouseOut="lolite()" onClick="logVariable('userpref')" href="../../_variables/userpref.html">$userpref</a>-&gt;<a onClick="logVariable('value')" class="var it43842" onMouseOver="hilite(43842)" onMouseOut="lolite()" href="../../_variables/value.html">value</a> &lt; 14) {
<a name="l1301"><span class="linenum">1301</span></a>                  <a class="var it3475" onMouseOver="hilite(3475)" onMouseOut="lolite()" onClick="logVariable('newvalue')" href="../../_variables/newvalue.html">$newvalue</a> = 14;
<a name="l1302"><span class="linenum">1302</span></a>              } else {
<a name="l1303"><span class="linenum">1303</span></a>                  <a class="var it3475" onMouseOver="hilite(3475)" onMouseOut="lolite()" onClick="logVariable('newvalue')" href="../../_variables/newvalue.html">$newvalue</a> = <a class="var it15791" onMouseOver="hilite(15791)" onMouseOut="lolite()" onClick="logVariable('userpref')" href="../../_variables/userpref.html">$userpref</a>-&gt;<a onClick="logVariable('value')" class="var it43842" onMouseOver="hilite(43842)" onMouseOut="lolite()" href="../../_variables/value.html">value</a>;
<a name="l1304"><span class="linenum">1304</span></a>              }
<a name="l1305"><span class="linenum">1305</span></a>  
<a name="l1306"><span class="linenum">1306</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('user_preferences', 'value', <a class="var it3475" onMouseOver="hilite(3475)" onMouseOut="lolite()" onClick="logVariable('newvalue')" href="../../_variables/newvalue.html">$newvalue</a>, array('id' =&gt; <a class="var it15791" onMouseOver="hilite(15791)" onMouseOut="lolite()" onClick="logVariable('userpref')" href="../../_variables/userpref.html">$userpref</a>-&gt;<a onClick="logVariable('id')" class="var it43842" onMouseOver="hilite(43842)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l1307"><span class="linenum">1307</span></a>  
<a name="l1308"><span class="linenum">1308</span></a>  <span class="comment">            // Update progress.</span>
<a name="l1309"><span class="linenum">1309</span></a>              <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>++;
<a name="l1310"><span class="linenum">1310</span></a>              <a class="var it4895" onMouseOver="hilite(4895)" onMouseOut="lolite()" onClick="logVariable('pbar')" href="../../_variables/pbar.html">$pbar</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>(<a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>, <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('total')" href="../../_variables/total.html">$total</a>, &quot;Upgrading user preference settings - <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>/<a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('total')" href="../../_variables/total.html">$total</a>.&quot;);
<a name="l1311"><span class="linenum">1311</span></a>          }
<a name="l1312"><span class="linenum">1312</span></a>          <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../_variables/rs.html">$rs</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l1313"><span class="linenum">1313</span></a>          <a class="var it4224" onMouseOver="hilite(4224)" onMouseOut="lolite()" onClick="logVariable('transaction')" href="../../_variables/transaction.html">$transaction</a>-&gt;<a class="function" onClick="logFunction('allow_commit')" href="../../_functions/allow_commit.html" onMouseOver="funcPopup(event,'allow_commit')">allow_commit</a>();
<a name="l1314"><span class="linenum">1314</span></a>  
<a name="l1315"><span class="linenum">1315</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016011901.00);
<a name="l1316"><span class="linenum">1316</span></a>      }
<a name="l1317"><span class="linenum">1317</span></a>  
<a name="l1318"><span class="linenum">1318</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016020200.00) {
<a name="l1319"><span class="linenum">1319</span></a>  
<a name="l1320"><span class="linenum">1320</span></a>  <span class="comment">        // Define field isstandard to be added to tag.</span>
<a name="l1321"><span class="linenum">1321</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('tag');
<a name="l1322"><span class="linenum">1322</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('isstandard', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '1', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0', 'rawname');
<a name="l1323"><span class="linenum">1323</span></a>  
<a name="l1324"><span class="linenum">1324</span></a>  <span class="comment">        // Conditionally launch add field isstandard.</span>
<a name="l1325"><span class="linenum">1325</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>)) {
<a name="l1326"><span class="linenum">1326</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l1327"><span class="linenum">1327</span></a>          }
<a name="l1328"><span class="linenum">1328</span></a>  
<a name="l1329"><span class="linenum">1329</span></a>  <span class="comment">        // Define index tagcolltype (not unique) to be dropped form tag.</span>
<a name="l1330"><span class="linenum">1330</span></a>          <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('tagcolltype', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('tagcollid', 'tagtype'));
<a name="l1331"><span class="linenum">1331</span></a>  
<a name="l1332"><span class="linenum">1332</span></a>  <span class="comment">        // Conditionally launch drop index tagcolltype.</span>
<a name="l1333"><span class="linenum">1333</span></a>          if (<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>)) {
<a name="l1334"><span class="linenum">1334</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('drop_index')" href="../../_functions/drop_index.html" onMouseOver="funcPopup(event,'drop_index')">drop_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>);
<a name="l1335"><span class="linenum">1335</span></a>          }
<a name="l1336"><span class="linenum">1336</span></a>  
<a name="l1337"><span class="linenum">1337</span></a>  <span class="comment">        // Define index tagcolltype (not unique) to be added to tag.</span>
<a name="l1338"><span class="linenum">1338</span></a>          <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('tagcolltype', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('tagcollid', 'isstandard'));
<a name="l1339"><span class="linenum">1339</span></a>  
<a name="l1340"><span class="linenum">1340</span></a>  <span class="comment">        // Conditionally launch add index tagcolltype.</span>
<a name="l1341"><span class="linenum">1341</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>)) {
<a name="l1342"><span class="linenum">1342</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>);
<a name="l1343"><span class="linenum">1343</span></a>          }
<a name="l1344"><span class="linenum">1344</span></a>  
<a name="l1345"><span class="linenum">1345</span></a>  <span class="comment">        // Define field tagtype to be dropped from tag.</span>
<a name="l1346"><span class="linenum">1346</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('tagtype');
<a name="l1347"><span class="linenum">1347</span></a>  
<a name="l1348"><span class="linenum">1348</span></a>  <span class="comment">        // Conditionally launch drop field tagtype and update isstandard.</span>
<a name="l1349"><span class="linenum">1349</span></a>          if (<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>)) {
<a name="l1350"><span class="linenum">1350</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>(&quot;UPDATE {tag} SET isstandard=(CASE WHEN (tagtype = ?) THEN 1 ELSE 0 END)&quot;, array('official'));
<a name="l1351"><span class="linenum">1351</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('drop_field')" href="../../_functions/drop_field.html" onMouseOver="funcPopup(event,'drop_field')">drop_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l1352"><span class="linenum">1352</span></a>          }
<a name="l1353"><span class="linenum">1353</span></a>  
<a name="l1354"><span class="linenum">1354</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1355"><span class="linenum">1355</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016020200.00);
<a name="l1356"><span class="linenum">1356</span></a>      }
<a name="l1357"><span class="linenum">1357</span></a>  
<a name="l1358"><span class="linenum">1358</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016020201.00) {
<a name="l1359"><span class="linenum">1359</span></a>  
<a name="l1360"><span class="linenum">1360</span></a>  <span class="comment">        // Define field showstandard to be added to tag_area.</span>
<a name="l1361"><span class="linenum">1361</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('tag_area');
<a name="l1362"><span class="linenum">1362</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('showstandard', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '1', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0', 'callbackfile');
<a name="l1363"><span class="linenum">1363</span></a>  
<a name="l1364"><span class="linenum">1364</span></a>  <span class="comment">        // Conditionally launch add field showstandard.</span>
<a name="l1365"><span class="linenum">1365</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>)) {
<a name="l1366"><span class="linenum">1366</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l1367"><span class="linenum">1367</span></a>          }
<a name="l1368"><span class="linenum">1368</span></a>  
<a name="l1369"><span class="linenum">1369</span></a>  <span class="comment">        // By default set user area to hide standard tags. 2 = core_tag_tag::HIDE_STANDARD (can not use constant here).</span>
<a name="l1370"><span class="linenum">1370</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>(&quot;UPDATE {tag_area} SET showstandard = ? WHERE itemtype = ? AND component = ?&quot;,
<a name="l1371"><span class="linenum">1371</span></a>              array(2, 'user', 'core'));
<a name="l1372"><span class="linenum">1372</span></a>  
<a name="l1373"><span class="linenum">1373</span></a>  <span class="comment">        // Changing precision of field enabled on table tag_area to (1).</span>
<a name="l1374"><span class="linenum">1374</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('tag_area');
<a name="l1375"><span class="linenum">1375</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('enabled', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '1', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '1', 'itemtype');
<a name="l1376"><span class="linenum">1376</span></a>  
<a name="l1377"><span class="linenum">1377</span></a>  <span class="comment">        // Launch change of precision for field enabled.</span>
<a name="l1378"><span class="linenum">1378</span></a>          <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('change_field_precision')" href="../../_functions/change_field_precision.html" onMouseOver="funcPopup(event,'change_field_precision')">change_field_precision</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l1379"><span class="linenum">1379</span></a>  
<a name="l1380"><span class="linenum">1380</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1381"><span class="linenum">1381</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016020201.00);
<a name="l1382"><span class="linenum">1382</span></a>      }
<a name="l1383"><span class="linenum">1383</span></a>  
<a name="l1384"><span class="linenum">1384</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016021500.00) {
<a name="l1385"><span class="linenum">1385</span></a>          <a class="var it5370" onMouseOver="hilite(5370)" onMouseOut="lolite()" onClick="logVariable('root')" href="../../_variables/root.html">$root</a> = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('tempdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/tempdir.html">tempdir</a> . '/download';
<a name="l1386"><span class="linenum">1386</span></a>          if (<a class="phpfunction" onClick="logFunction('is_dir')" href="../../_functions/is_dir.html" onMouseOver="phpfuncPopup(event,'is_dir')">is_dir</a>(<a class="var it5370" onMouseOver="hilite(5370)" onMouseOut="lolite()" onClick="logVariable('root')" href="../../_variables/root.html">$root</a>)) {
<a name="l1387"><span class="linenum">1387</span></a>  <span class="comment">            // Fetch each repository type - include all repos, not just enabled.</span>
<a name="l1388"><span class="linenum">1388</span></a>              <a class="var it10503" onMouseOver="hilite(10503)" onMouseOut="lolite()" onClick="logVariable('repositories')" href="../../_variables/repositories.html">$repositories</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('repository', array(), '', 'type');
<a name="l1389"><span class="linenum">1389</span></a>  
<a name="l1390"><span class="linenum">1390</span></a>              foreach (<a class="var it10503" onMouseOver="hilite(10503)" onMouseOut="lolite()" onClick="logVariable('repositories')" href="../../_variables/repositories.html">$repositories</a> as <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> =&gt; <a class="var it641" onMouseOver="hilite(641)" onMouseOut="lolite()" onClick="logVariable('repository')" href="../../_variables/repository.html">$repository</a>) {
<a name="l1391"><span class="linenum">1391</span></a>                  <a class="var it6532" onMouseOver="hilite(6532)" onMouseOut="lolite()" onClick="logVariable('directory')" href="../../_variables/directory.html">$directory</a> = <a class="var it5370" onMouseOver="hilite(5370)" onMouseOut="lolite()" onClick="logVariable('root')" href="../../_variables/root.html">$root</a> . '/repository_' . <a class="var it641" onMouseOver="hilite(641)" onMouseOut="lolite()" onClick="logVariable('repository')" href="../../_variables/repository.html">$repository</a>-&gt;<a onClick="logVariable('type')" class="var it43843" onMouseOver="hilite(43843)" onMouseOut="lolite()" href="../../_variables/type.html">type</a>;
<a name="l1392"><span class="linenum">1392</span></a>                  if (<a class="phpfunction" onClick="logFunction('is_dir')" href="../../_functions/is_dir.html" onMouseOver="phpfuncPopup(event,'is_dir')">is_dir</a>(<a class="var it6532" onMouseOver="hilite(6532)" onMouseOut="lolite()" onClick="logVariable('directory')" href="../../_variables/directory.html">$directory</a>)) {
<a name="l1393"><span class="linenum">1393</span></a>                      <a class="function" onClick="logFunction('fulldelete')" href="../../_functions/fulldelete.html" onMouseOver="funcPopup(event,'fulldelete')">fulldelete</a>(<a class="var it6532" onMouseOver="hilite(6532)" onMouseOut="lolite()" onClick="logVariable('directory')" href="../../_variables/directory.html">$directory</a>);
<a name="l1394"><span class="linenum">1394</span></a>                  }
<a name="l1395"><span class="linenum">1395</span></a>              }
<a name="l1396"><span class="linenum">1396</span></a>          }
<a name="l1397"><span class="linenum">1397</span></a>  
<a name="l1398"><span class="linenum">1398</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1399"><span class="linenum">1399</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016021500.00);
<a name="l1400"><span class="linenum">1400</span></a>      }
<a name="l1401"><span class="linenum">1401</span></a>  
<a name="l1402"><span class="linenum">1402</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016021501.00) {
<a name="l1403"><span class="linenum">1403</span></a>  <span class="comment">        // This could take a long time. Unfortunately, no way to know how long, and no way to do progress, so setting for 1 hour.</span>
<a name="l1404"><span class="linenum">1404</span></a>          <a class="function" onClick="logFunction('upgrade_set_timeout')" href="../../_functions/upgrade_set_timeout.html" onMouseOver="funcPopup(event,'upgrade_set_timeout')">upgrade_set_timeout</a>(3600);
<a name="l1405"><span class="linenum">1405</span></a>  
<a name="l1406"><span class="linenum">1406</span></a>  <span class="comment">        // Define index userid-itemid (not unique) to be added to grade_grades_history.</span>
<a name="l1407"><span class="linenum">1407</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('grade_grades_history');
<a name="l1408"><span class="linenum">1408</span></a>          <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_index')" href="../../_classes/xmldb_index.html" onMouseOver="classPopup(event,'xmldb_index')">xmldb_index</a>('userid-itemid-timemodified', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('userid', 'itemid', 'timemodified'));
<a name="l1409"><span class="linenum">1409</span></a>  
<a name="l1410"><span class="linenum">1410</span></a>  <span class="comment">        // Conditionally launch add index userid-itemid.</span>
<a name="l1411"><span class="linenum">1411</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('index_exists')" href="../../_functions/index_exists.html" onMouseOver="funcPopup(event,'index_exists')">index_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>)) {
<a name="l1412"><span class="linenum">1412</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>);
<a name="l1413"><span class="linenum">1413</span></a>          }
<a name="l1414"><span class="linenum">1414</span></a>  
<a name="l1415"><span class="linenum">1415</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1416"><span class="linenum">1416</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016021501.00);
<a name="l1417"><span class="linenum">1417</span></a>      }
<a name="l1418"><span class="linenum">1418</span></a>  
<a name="l1419"><span class="linenum">1419</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016030103.00) {
<a name="l1420"><span class="linenum">1420</span></a>  
<a name="l1421"><span class="linenum">1421</span></a>  <span class="comment">        // MDL-50887. Implement plugins infrastructure for antivirus and create ClamAV plugin.</span>
<a name="l1422"><span class="linenum">1422</span></a>  <span class="comment">        // This routine moves core ClamAV configuration to plugin level.</span>
<a name="l1423"><span class="linenum">1423</span></a>  
<a name="l1424"><span class="linenum">1424</span></a>  <span class="comment">        // If clamav was configured and enabled, enable the plugin.</span>
<a name="l1425"><span class="linenum">1425</span></a>          if (!empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('runclamonupload')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/runclamonupload.html">runclamonupload</a>) &amp;&amp; !empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('pathtoclam')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/pathtoclam.html">pathtoclam</a>)) {
<a name="l1426"><span class="linenum">1426</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('antiviruses', 'clamav');
<a name="l1427"><span class="linenum">1427</span></a>          } else {
<a name="l1428"><span class="linenum">1428</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('antiviruses', '');
<a name="l1429"><span class="linenum">1429</span></a>          }
<a name="l1430"><span class="linenum">1430</span></a>  
<a name="l1431"><span class="linenum">1431</span></a>          if (isset(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('runclamonupload')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/runclamonupload.html">runclamonupload</a>)) {
<a name="l1432"><span class="linenum">1432</span></a>  <span class="comment">            // Just unset global configuration, we have already enabled the plugin</span>
<a name="l1433"><span class="linenum">1433</span></a>  <span class="comment">            // which implies that ClamAV will be used for scanning uploaded files.</span>
<a name="l1434"><span class="linenum">1434</span></a>              <a class="function" onClick="logFunction('unset_config')" href="../../_functions/unset_config.html" onMouseOver="funcPopup(event,'unset_config')">unset_config</a>('runclamonupload');
<a name="l1435"><span class="linenum">1435</span></a>          }
<a name="l1436"><span class="linenum">1436</span></a>  <span class="comment">        // Move core ClamAV configuration settings to plugin.</span>
<a name="l1437"><span class="linenum">1437</span></a>          if (isset(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('pathtoclam')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/pathtoclam.html">pathtoclam</a>)) {
<a name="l1438"><span class="linenum">1438</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('pathtoclam', <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('pathtoclam')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/pathtoclam.html">pathtoclam</a>, 'antivirus_clamav');
<a name="l1439"><span class="linenum">1439</span></a>              <a class="function" onClick="logFunction('unset_config')" href="../../_functions/unset_config.html" onMouseOver="funcPopup(event,'unset_config')">unset_config</a>('pathtoclam');
<a name="l1440"><span class="linenum">1440</span></a>          }
<a name="l1441"><span class="linenum">1441</span></a>          if (isset(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('quarantinedir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/quarantinedir.html">quarantinedir</a>)) {
<a name="l1442"><span class="linenum">1442</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('quarantinedir', <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('quarantinedir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/quarantinedir.html">quarantinedir</a>, 'antivirus_clamav');
<a name="l1443"><span class="linenum">1443</span></a>              <a class="function" onClick="logFunction('unset_config')" href="../../_functions/unset_config.html" onMouseOver="funcPopup(event,'unset_config')">unset_config</a>('quarantinedir');
<a name="l1444"><span class="linenum">1444</span></a>          }
<a name="l1445"><span class="linenum">1445</span></a>          if (isset(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('clamfailureonupload')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/clamfailureonupload.html">clamfailureonupload</a>)) {
<a name="l1446"><span class="linenum">1446</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('clamfailureonupload', <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('clamfailureonupload')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/clamfailureonupload.html">clamfailureonupload</a>, 'antivirus_clamav');
<a name="l1447"><span class="linenum">1447</span></a>              <a class="function" onClick="logFunction('unset_config')" href="../../_functions/unset_config.html" onMouseOver="funcPopup(event,'unset_config')">unset_config</a>('clamfailureonupload');
<a name="l1448"><span class="linenum">1448</span></a>          }
<a name="l1449"><span class="linenum">1449</span></a>  
<a name="l1450"><span class="linenum">1450</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1451"><span class="linenum">1451</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016030103.00);
<a name="l1452"><span class="linenum">1452</span></a>      }
<a name="l1453"><span class="linenum">1453</span></a>  
<a name="l1454"><span class="linenum">1454</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016030400.01) {
<a name="l1455"><span class="linenum">1455</span></a>  <span class="comment">        // Add the new services field.</span>
<a name="l1456"><span class="linenum">1456</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('external_functions');
<a name="l1457"><span class="linenum">1457</span></a>          <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_field')" href="../../_classes/xmldb_field.html" onMouseOver="classPopup(event,'xmldb_field')">xmldb_field</a>('services', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '1333', null, null, null, null, 'capabilities');
<a name="l1458"><span class="linenum">1458</span></a>  
<a name="l1459"><span class="linenum">1459</span></a>  <span class="comment">        // Conditionally launch add field services.</span>
<a name="l1460"><span class="linenum">1460</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('field_exists')" href="../../_functions/field_exists.html" onMouseOver="funcPopup(event,'field_exists')">field_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>)) {
<a name="l1461"><span class="linenum">1461</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>);
<a name="l1462"><span class="linenum">1462</span></a>          }
<a name="l1463"><span class="linenum">1463</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1464"><span class="linenum">1464</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016030400.01);
<a name="l1465"><span class="linenum">1465</span></a>      }
<a name="l1466"><span class="linenum">1466</span></a>  
<a name="l1467"><span class="linenum">1467</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016041500.50) {
<a name="l1468"><span class="linenum">1468</span></a>  
<a name="l1469"><span class="linenum">1469</span></a>  <span class="comment">        // Define table competency to be created.</span>
<a name="l1470"><span class="linenum">1470</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('competency');
<a name="l1471"><span class="linenum">1471</span></a>  
<a name="l1472"><span class="linenum">1472</span></a>  <span class="comment">        // Adding fields to table competency.</span>
<a name="l1473"><span class="linenum">1473</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l1474"><span class="linenum">1474</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('shortname', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '100', null, null, null, null);
<a name="l1475"><span class="linenum">1475</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('description', <a class="constant" onClick="logConstant('XMLDB_TYPE_TEXT')" href="../../_constants/XMLDB_TYPE_TEXT.html" onMouseOver="constPopup(event,'XMLDB_TYPE_TEXT')">XMLDB_TYPE_TEXT</a>, null, null, null, null, null);
<a name="l1476"><span class="linenum">1476</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('descriptionformat', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '4', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0');
<a name="l1477"><span class="linenum">1477</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('idnumber', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '100', null, null, null, null);
<a name="l1478"><span class="linenum">1478</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('competencyframeworkid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1479"><span class="linenum">1479</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('parentid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0');
<a name="l1480"><span class="linenum">1480</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('path', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '255', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1481"><span class="linenum">1481</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('sortorder', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1482"><span class="linenum">1482</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('ruletype', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '100', null, null, null, null);
<a name="l1483"><span class="linenum">1483</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('ruleoutcome', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '2', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0');
<a name="l1484"><span class="linenum">1484</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('ruleconfig', <a class="constant" onClick="logConstant('XMLDB_TYPE_TEXT')" href="../../_constants/XMLDB_TYPE_TEXT.html" onMouseOver="constPopup(event,'XMLDB_TYPE_TEXT')">XMLDB_TYPE_TEXT</a>, null, null, null, null, null);
<a name="l1485"><span class="linenum">1485</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('scaleid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1486"><span class="linenum">1486</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('scaleconfiguration', <a class="constant" onClick="logConstant('XMLDB_TYPE_TEXT')" href="../../_constants/XMLDB_TYPE_TEXT.html" onMouseOver="constPopup(event,'XMLDB_TYPE_TEXT')">XMLDB_TYPE_TEXT</a>, null, null, null, null, null);
<a name="l1487"><span class="linenum">1487</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timecreated', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1488"><span class="linenum">1488</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timemodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1489"><span class="linenum">1489</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('usermodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1490"><span class="linenum">1490</span></a>  
<a name="l1491"><span class="linenum">1491</span></a>  <span class="comment">        // Adding keys to table competency.</span>
<a name="l1492"><span class="linenum">1492</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l1493"><span class="linenum">1493</span></a>  
<a name="l1494"><span class="linenum">1494</span></a>  <span class="comment">        // Adding indexes to table competency.</span>
<a name="l1495"><span class="linenum">1495</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('idnumberframework', <a class="constant" onClick="logConstant('XMLDB_INDEX_UNIQUE')" href="../../_constants/XMLDB_INDEX_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_UNIQUE')">XMLDB_INDEX_UNIQUE</a>, array('competencyframeworkid', 'idnumber'));
<a name="l1496"><span class="linenum">1496</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('ruleoutcome', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('ruleoutcome'));
<a name="l1497"><span class="linenum">1497</span></a>  
<a name="l1498"><span class="linenum">1498</span></a>  <span class="comment">        // Conditionally launch create table for competency.</span>
<a name="l1499"><span class="linenum">1499</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l1500"><span class="linenum">1500</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l1501"><span class="linenum">1501</span></a>          }
<a name="l1502"><span class="linenum">1502</span></a>  
<a name="l1503"><span class="linenum">1503</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1504"><span class="linenum">1504</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016041500.50);
<a name="l1505"><span class="linenum">1505</span></a>      }
<a name="l1506"><span class="linenum">1506</span></a>  
<a name="l1507"><span class="linenum">1507</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016041500.51) {
<a name="l1508"><span class="linenum">1508</span></a>  
<a name="l1509"><span class="linenum">1509</span></a>  <span class="comment">        // Define table competency_coursecompsetting to be created.</span>
<a name="l1510"><span class="linenum">1510</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('competency_coursecompsetting');
<a name="l1511"><span class="linenum">1511</span></a>  
<a name="l1512"><span class="linenum">1512</span></a>  <span class="comment">        // Adding fields to table competency_coursecompsetting.</span>
<a name="l1513"><span class="linenum">1513</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l1514"><span class="linenum">1514</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('courseid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1515"><span class="linenum">1515</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('pushratingstouserplans', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '2', null, null, null, null);
<a name="l1516"><span class="linenum">1516</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timecreated', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1517"><span class="linenum">1517</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timemodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1518"><span class="linenum">1518</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('usermodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1519"><span class="linenum">1519</span></a>  
<a name="l1520"><span class="linenum">1520</span></a>  <span class="comment">        // Adding keys to table competency_coursecompsetting.</span>
<a name="l1521"><span class="linenum">1521</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l1522"><span class="linenum">1522</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('courseidlink', <a class="constant" onClick="logConstant('XMLDB_KEY_FOREIGN_UNIQUE')" href="../../_constants/XMLDB_KEY_FOREIGN_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_KEY_FOREIGN_UNIQUE')">XMLDB_KEY_FOREIGN_UNIQUE</a>, array('courseid'), 'course', array('id'));
<a name="l1523"><span class="linenum">1523</span></a>  
<a name="l1524"><span class="linenum">1524</span></a>  <span class="comment">        // Conditionally launch create table for competency_coursecompsetting.</span>
<a name="l1525"><span class="linenum">1525</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l1526"><span class="linenum">1526</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l1527"><span class="linenum">1527</span></a>          }
<a name="l1528"><span class="linenum">1528</span></a>  
<a name="l1529"><span class="linenum">1529</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1530"><span class="linenum">1530</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016041500.51);
<a name="l1531"><span class="linenum">1531</span></a>      }
<a name="l1532"><span class="linenum">1532</span></a>  
<a name="l1533"><span class="linenum">1533</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016041500.52) {
<a name="l1534"><span class="linenum">1534</span></a>  
<a name="l1535"><span class="linenum">1535</span></a>  <span class="comment">        // Define table competency_framework to be created.</span>
<a name="l1536"><span class="linenum">1536</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('competency_framework');
<a name="l1537"><span class="linenum">1537</span></a>  
<a name="l1538"><span class="linenum">1538</span></a>  <span class="comment">        // Adding fields to table competency_framework.</span>
<a name="l1539"><span class="linenum">1539</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l1540"><span class="linenum">1540</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('shortname', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '100', null, null, null, null);
<a name="l1541"><span class="linenum">1541</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('contextid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1542"><span class="linenum">1542</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('idnumber', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '100', null, null, null, null);
<a name="l1543"><span class="linenum">1543</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('description', <a class="constant" onClick="logConstant('XMLDB_TYPE_TEXT')" href="../../_constants/XMLDB_TYPE_TEXT.html" onMouseOver="constPopup(event,'XMLDB_TYPE_TEXT')">XMLDB_TYPE_TEXT</a>, null, null, null, null, null);
<a name="l1544"><span class="linenum">1544</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('descriptionformat', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '4', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0');
<a name="l1545"><span class="linenum">1545</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('scaleid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '11', null, null, null, null);
<a name="l1546"><span class="linenum">1546</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('scaleconfiguration', <a class="constant" onClick="logConstant('XMLDB_TYPE_TEXT')" href="../../_constants/XMLDB_TYPE_TEXT.html" onMouseOver="constPopup(event,'XMLDB_TYPE_TEXT')">XMLDB_TYPE_TEXT</a>, null, null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1547"><span class="linenum">1547</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('visible', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '2', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '1');
<a name="l1548"><span class="linenum">1548</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('taxonomies', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '255', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1549"><span class="linenum">1549</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timecreated', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1550"><span class="linenum">1550</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timemodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1551"><span class="linenum">1551</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('usermodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1552"><span class="linenum">1552</span></a>  
<a name="l1553"><span class="linenum">1553</span></a>  <span class="comment">        // Adding keys to table competency_framework.</span>
<a name="l1554"><span class="linenum">1554</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l1555"><span class="linenum">1555</span></a>  
<a name="l1556"><span class="linenum">1556</span></a>  <span class="comment">        // Adding indexes to table competency_framework.</span>
<a name="l1557"><span class="linenum">1557</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('idnumber', <a class="constant" onClick="logConstant('XMLDB_INDEX_UNIQUE')" href="../../_constants/XMLDB_INDEX_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_UNIQUE')">XMLDB_INDEX_UNIQUE</a>, array('idnumber'));
<a name="l1558"><span class="linenum">1558</span></a>  
<a name="l1559"><span class="linenum">1559</span></a>  <span class="comment">        // Conditionally launch create table for competency_framework.</span>
<a name="l1560"><span class="linenum">1560</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l1561"><span class="linenum">1561</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l1562"><span class="linenum">1562</span></a>          }
<a name="l1563"><span class="linenum">1563</span></a>  
<a name="l1564"><span class="linenum">1564</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1565"><span class="linenum">1565</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016041500.52);
<a name="l1566"><span class="linenum">1566</span></a>      }
<a name="l1567"><span class="linenum">1567</span></a>  
<a name="l1568"><span class="linenum">1568</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016041500.53) {
<a name="l1569"><span class="linenum">1569</span></a>  
<a name="l1570"><span class="linenum">1570</span></a>  <span class="comment">        // Define table competency_coursecomp to be created.</span>
<a name="l1571"><span class="linenum">1571</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('competency_coursecomp');
<a name="l1572"><span class="linenum">1572</span></a>  
<a name="l1573"><span class="linenum">1573</span></a>  <span class="comment">        // Adding fields to table competency_coursecomp.</span>
<a name="l1574"><span class="linenum">1574</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l1575"><span class="linenum">1575</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('courseid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1576"><span class="linenum">1576</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('competencyid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1577"><span class="linenum">1577</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('ruleoutcome', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '2', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1578"><span class="linenum">1578</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timecreated', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1579"><span class="linenum">1579</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timemodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1580"><span class="linenum">1580</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('usermodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1581"><span class="linenum">1581</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('sortorder', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1582"><span class="linenum">1582</span></a>  
<a name="l1583"><span class="linenum">1583</span></a>  <span class="comment">        // Adding keys to table competency_coursecomp.</span>
<a name="l1584"><span class="linenum">1584</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l1585"><span class="linenum">1585</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('courseidlink', <a class="constant" onClick="logConstant('XMLDB_KEY_FOREIGN')" href="../../_constants/XMLDB_KEY_FOREIGN.html" onMouseOver="constPopup(event,'XMLDB_KEY_FOREIGN')">XMLDB_KEY_FOREIGN</a>, array('courseid'), 'course', array('id'));
<a name="l1586"><span class="linenum">1586</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('competencyid', <a class="constant" onClick="logConstant('XMLDB_KEY_FOREIGN')" href="../../_constants/XMLDB_KEY_FOREIGN.html" onMouseOver="constPopup(event,'XMLDB_KEY_FOREIGN')">XMLDB_KEY_FOREIGN</a>, array('competencyid'), 'competency_competency', array('id'));
<a name="l1587"><span class="linenum">1587</span></a>  
<a name="l1588"><span class="linenum">1588</span></a>  <span class="comment">        // Adding indexes to table competency_coursecomp.</span>
<a name="l1589"><span class="linenum">1589</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('courseidruleoutcome', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('courseid', 'ruleoutcome'));
<a name="l1590"><span class="linenum">1590</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('courseidcompetencyid', <a class="constant" onClick="logConstant('XMLDB_INDEX_UNIQUE')" href="../../_constants/XMLDB_INDEX_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_UNIQUE')">XMLDB_INDEX_UNIQUE</a>, array('courseid', 'competencyid'));
<a name="l1591"><span class="linenum">1591</span></a>  
<a name="l1592"><span class="linenum">1592</span></a>  <span class="comment">        // Conditionally launch create table for competency_coursecomp.</span>
<a name="l1593"><span class="linenum">1593</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l1594"><span class="linenum">1594</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l1595"><span class="linenum">1595</span></a>          }
<a name="l1596"><span class="linenum">1596</span></a>  
<a name="l1597"><span class="linenum">1597</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1598"><span class="linenum">1598</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016041500.53);
<a name="l1599"><span class="linenum">1599</span></a>      }
<a name="l1600"><span class="linenum">1600</span></a>  
<a name="l1601"><span class="linenum">1601</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016041500.54) {
<a name="l1602"><span class="linenum">1602</span></a>  
<a name="l1603"><span class="linenum">1603</span></a>  <span class="comment">        // Define table competency_plan to be created.</span>
<a name="l1604"><span class="linenum">1604</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('competency_plan');
<a name="l1605"><span class="linenum">1605</span></a>  
<a name="l1606"><span class="linenum">1606</span></a>  <span class="comment">        // Adding fields to table competency_plan.</span>
<a name="l1607"><span class="linenum">1607</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l1608"><span class="linenum">1608</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('name', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '100', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1609"><span class="linenum">1609</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('description', <a class="constant" onClick="logConstant('XMLDB_TYPE_TEXT')" href="../../_constants/XMLDB_TYPE_TEXT.html" onMouseOver="constPopup(event,'XMLDB_TYPE_TEXT')">XMLDB_TYPE_TEXT</a>, null, null, null, null, null);
<a name="l1610"><span class="linenum">1610</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('descriptionformat', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '4', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0');
<a name="l1611"><span class="linenum">1611</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('userid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1612"><span class="linenum">1612</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('templateid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1613"><span class="linenum">1613</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('origtemplateid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1614"><span class="linenum">1614</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('status', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '1', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1615"><span class="linenum">1615</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('duedate', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, '0');
<a name="l1616"><span class="linenum">1616</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('reviewerid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1617"><span class="linenum">1617</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timecreated', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1618"><span class="linenum">1618</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timemodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0');
<a name="l1619"><span class="linenum">1619</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('usermodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1620"><span class="linenum">1620</span></a>  
<a name="l1621"><span class="linenum">1621</span></a>  <span class="comment">        // Adding keys to table competency_plan.</span>
<a name="l1622"><span class="linenum">1622</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l1623"><span class="linenum">1623</span></a>  
<a name="l1624"><span class="linenum">1624</span></a>  <span class="comment">        // Adding indexes to table competency_plan.</span>
<a name="l1625"><span class="linenum">1625</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('useridstatus', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('userid', 'status'));
<a name="l1626"><span class="linenum">1626</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('templateid', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('templateid'));
<a name="l1627"><span class="linenum">1627</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('statusduedate', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('status', 'duedate'));
<a name="l1628"><span class="linenum">1628</span></a>  
<a name="l1629"><span class="linenum">1629</span></a>  <span class="comment">        // Conditionally launch create table for competency_plan.</span>
<a name="l1630"><span class="linenum">1630</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l1631"><span class="linenum">1631</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l1632"><span class="linenum">1632</span></a>          }
<a name="l1633"><span class="linenum">1633</span></a>  
<a name="l1634"><span class="linenum">1634</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1635"><span class="linenum">1635</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016041500.54);
<a name="l1636"><span class="linenum">1636</span></a>      }
<a name="l1637"><span class="linenum">1637</span></a>  
<a name="l1638"><span class="linenum">1638</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016041500.55) {
<a name="l1639"><span class="linenum">1639</span></a>  
<a name="l1640"><span class="linenum">1640</span></a>  <span class="comment">        // Define table competency_template to be created.</span>
<a name="l1641"><span class="linenum">1641</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('competency_template');
<a name="l1642"><span class="linenum">1642</span></a>  
<a name="l1643"><span class="linenum">1643</span></a>  <span class="comment">        // Adding fields to table competency_template.</span>
<a name="l1644"><span class="linenum">1644</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l1645"><span class="linenum">1645</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('shortname', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '100', null, null, null, null);
<a name="l1646"><span class="linenum">1646</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('contextid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1647"><span class="linenum">1647</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('description', <a class="constant" onClick="logConstant('XMLDB_TYPE_TEXT')" href="../../_constants/XMLDB_TYPE_TEXT.html" onMouseOver="constPopup(event,'XMLDB_TYPE_TEXT')">XMLDB_TYPE_TEXT</a>, null, null, null, null, null);
<a name="l1648"><span class="linenum">1648</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('descriptionformat', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '4', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0');
<a name="l1649"><span class="linenum">1649</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('visible', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '2', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '1');
<a name="l1650"><span class="linenum">1650</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('duedate', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1651"><span class="linenum">1651</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timecreated', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1652"><span class="linenum">1652</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timemodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1653"><span class="linenum">1653</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('usermodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1654"><span class="linenum">1654</span></a>  
<a name="l1655"><span class="linenum">1655</span></a>  <span class="comment">        // Adding keys to table competency_template.</span>
<a name="l1656"><span class="linenum">1656</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l1657"><span class="linenum">1657</span></a>  
<a name="l1658"><span class="linenum">1658</span></a>  <span class="comment">        // Conditionally launch create table for competency_template.</span>
<a name="l1659"><span class="linenum">1659</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l1660"><span class="linenum">1660</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l1661"><span class="linenum">1661</span></a>          }
<a name="l1662"><span class="linenum">1662</span></a>  
<a name="l1663"><span class="linenum">1663</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1664"><span class="linenum">1664</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016041500.55);
<a name="l1665"><span class="linenum">1665</span></a>      }
<a name="l1666"><span class="linenum">1666</span></a>  
<a name="l1667"><span class="linenum">1667</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016041500.56) {
<a name="l1668"><span class="linenum">1668</span></a>  
<a name="l1669"><span class="linenum">1669</span></a>  <span class="comment">        // Define table competency_templatecomp to be created.</span>
<a name="l1670"><span class="linenum">1670</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('competency_templatecomp');
<a name="l1671"><span class="linenum">1671</span></a>  
<a name="l1672"><span class="linenum">1672</span></a>  <span class="comment">        // Adding fields to table competency_templatecomp.</span>
<a name="l1673"><span class="linenum">1673</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l1674"><span class="linenum">1674</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('templateid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1675"><span class="linenum">1675</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('competencyid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1676"><span class="linenum">1676</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timecreated', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1677"><span class="linenum">1677</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timemodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1678"><span class="linenum">1678</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('usermodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1679"><span class="linenum">1679</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('sortorder', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1680"><span class="linenum">1680</span></a>  
<a name="l1681"><span class="linenum">1681</span></a>  <span class="comment">        // Adding keys to table competency_templatecomp.</span>
<a name="l1682"><span class="linenum">1682</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l1683"><span class="linenum">1683</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('templateidlink', <a class="constant" onClick="logConstant('XMLDB_KEY_FOREIGN')" href="../../_constants/XMLDB_KEY_FOREIGN.html" onMouseOver="constPopup(event,'XMLDB_KEY_FOREIGN')">XMLDB_KEY_FOREIGN</a>, array('templateid'), 'competency_template', array('id'));
<a name="l1684"><span class="linenum">1684</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('competencyid', <a class="constant" onClick="logConstant('XMLDB_KEY_FOREIGN')" href="../../_constants/XMLDB_KEY_FOREIGN.html" onMouseOver="constPopup(event,'XMLDB_KEY_FOREIGN')">XMLDB_KEY_FOREIGN</a>, array('competencyid'), 'competency_competency', array('id'));
<a name="l1685"><span class="linenum">1685</span></a>  
<a name="l1686"><span class="linenum">1686</span></a>  <span class="comment">        // Conditionally launch create table for competency_templatecomp.</span>
<a name="l1687"><span class="linenum">1687</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l1688"><span class="linenum">1688</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l1689"><span class="linenum">1689</span></a>          }
<a name="l1690"><span class="linenum">1690</span></a>  
<a name="l1691"><span class="linenum">1691</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1692"><span class="linenum">1692</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016041500.56);
<a name="l1693"><span class="linenum">1693</span></a>      }
<a name="l1694"><span class="linenum">1694</span></a>  
<a name="l1695"><span class="linenum">1695</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016041500.57) {
<a name="l1696"><span class="linenum">1696</span></a>  
<a name="l1697"><span class="linenum">1697</span></a>  <span class="comment">        // Define table competency_templatecohort to be created.</span>
<a name="l1698"><span class="linenum">1698</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('competency_templatecohort');
<a name="l1699"><span class="linenum">1699</span></a>  
<a name="l1700"><span class="linenum">1700</span></a>  <span class="comment">        // Adding fields to table competency_templatecohort.</span>
<a name="l1701"><span class="linenum">1701</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l1702"><span class="linenum">1702</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('templateid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1703"><span class="linenum">1703</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('cohortid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1704"><span class="linenum">1704</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timecreated', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1705"><span class="linenum">1705</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timemodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1706"><span class="linenum">1706</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('usermodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1707"><span class="linenum">1707</span></a>  
<a name="l1708"><span class="linenum">1708</span></a>  <span class="comment">        // Adding keys to table competency_templatecohort.</span>
<a name="l1709"><span class="linenum">1709</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l1710"><span class="linenum">1710</span></a>  
<a name="l1711"><span class="linenum">1711</span></a>  <span class="comment">        // Adding indexes to table competency_templatecohort.</span>
<a name="l1712"><span class="linenum">1712</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('templateid', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('templateid'));
<a name="l1713"><span class="linenum">1713</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('templatecohortids', <a class="constant" onClick="logConstant('XMLDB_INDEX_UNIQUE')" href="../../_constants/XMLDB_INDEX_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_UNIQUE')">XMLDB_INDEX_UNIQUE</a>, array('templateid', 'cohortid'));
<a name="l1714"><span class="linenum">1714</span></a>  
<a name="l1715"><span class="linenum">1715</span></a>  <span class="comment">        // Conditionally launch create table for competency_templatecohort.</span>
<a name="l1716"><span class="linenum">1716</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l1717"><span class="linenum">1717</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l1718"><span class="linenum">1718</span></a>          }
<a name="l1719"><span class="linenum">1719</span></a>  
<a name="l1720"><span class="linenum">1720</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1721"><span class="linenum">1721</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016041500.57);
<a name="l1722"><span class="linenum">1722</span></a>      }
<a name="l1723"><span class="linenum">1723</span></a>  
<a name="l1724"><span class="linenum">1724</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016041500.58) {
<a name="l1725"><span class="linenum">1725</span></a>  
<a name="l1726"><span class="linenum">1726</span></a>  <span class="comment">        // Define table competency_relatedcomp to be created.</span>
<a name="l1727"><span class="linenum">1727</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('competency_relatedcomp');
<a name="l1728"><span class="linenum">1728</span></a>  
<a name="l1729"><span class="linenum">1729</span></a>  <span class="comment">        // Adding fields to table competency_relatedcomp.</span>
<a name="l1730"><span class="linenum">1730</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l1731"><span class="linenum">1731</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('competencyid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1732"><span class="linenum">1732</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('relatedcompetencyid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1733"><span class="linenum">1733</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timecreated', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1734"><span class="linenum">1734</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timemodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1735"><span class="linenum">1735</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('usermodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1736"><span class="linenum">1736</span></a>  
<a name="l1737"><span class="linenum">1737</span></a>  <span class="comment">        // Adding keys to table competency_relatedcomp.</span>
<a name="l1738"><span class="linenum">1738</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l1739"><span class="linenum">1739</span></a>  
<a name="l1740"><span class="linenum">1740</span></a>  <span class="comment">        // Conditionally launch create table for competency_relatedcomp.</span>
<a name="l1741"><span class="linenum">1741</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l1742"><span class="linenum">1742</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l1743"><span class="linenum">1743</span></a>          }
<a name="l1744"><span class="linenum">1744</span></a>  
<a name="l1745"><span class="linenum">1745</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1746"><span class="linenum">1746</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016041500.58);
<a name="l1747"><span class="linenum">1747</span></a>      }
<a name="l1748"><span class="linenum">1748</span></a>  
<a name="l1749"><span class="linenum">1749</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016041500.59) {
<a name="l1750"><span class="linenum">1750</span></a>  
<a name="l1751"><span class="linenum">1751</span></a>  <span class="comment">        // Define table competency_usercomp to be created.</span>
<a name="l1752"><span class="linenum">1752</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('competency_usercomp');
<a name="l1753"><span class="linenum">1753</span></a>  
<a name="l1754"><span class="linenum">1754</span></a>  <span class="comment">        // Adding fields to table competency_usercomp.</span>
<a name="l1755"><span class="linenum">1755</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l1756"><span class="linenum">1756</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('userid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1757"><span class="linenum">1757</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('competencyid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1758"><span class="linenum">1758</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('status', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '2', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, '0');
<a name="l1759"><span class="linenum">1759</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('reviewerid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1760"><span class="linenum">1760</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('proficiency', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '2', null, null, null, null);
<a name="l1761"><span class="linenum">1761</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('grade', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1762"><span class="linenum">1762</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timecreated', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1763"><span class="linenum">1763</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timemodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1764"><span class="linenum">1764</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('usermodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1765"><span class="linenum">1765</span></a>  
<a name="l1766"><span class="linenum">1766</span></a>  <span class="comment">        // Adding keys to table competency_usercomp.</span>
<a name="l1767"><span class="linenum">1767</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l1768"><span class="linenum">1768</span></a>  
<a name="l1769"><span class="linenum">1769</span></a>  <span class="comment">        // Adding indexes to table competency_usercomp.</span>
<a name="l1770"><span class="linenum">1770</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('useridcompetency', <a class="constant" onClick="logConstant('XMLDB_INDEX_UNIQUE')" href="../../_constants/XMLDB_INDEX_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_UNIQUE')">XMLDB_INDEX_UNIQUE</a>, array('userid', 'competencyid'));
<a name="l1771"><span class="linenum">1771</span></a>  
<a name="l1772"><span class="linenum">1772</span></a>  <span class="comment">        // Conditionally launch create table for competency_usercomp.</span>
<a name="l1773"><span class="linenum">1773</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l1774"><span class="linenum">1774</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l1775"><span class="linenum">1775</span></a>          }
<a name="l1776"><span class="linenum">1776</span></a>  
<a name="l1777"><span class="linenum">1777</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1778"><span class="linenum">1778</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016041500.59);
<a name="l1779"><span class="linenum">1779</span></a>      }
<a name="l1780"><span class="linenum">1780</span></a>  
<a name="l1781"><span class="linenum">1781</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016041500.60) {
<a name="l1782"><span class="linenum">1782</span></a>  
<a name="l1783"><span class="linenum">1783</span></a>  <span class="comment">        // Define table competency_usercompcourse to be created.</span>
<a name="l1784"><span class="linenum">1784</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('competency_usercompcourse');
<a name="l1785"><span class="linenum">1785</span></a>  
<a name="l1786"><span class="linenum">1786</span></a>  <span class="comment">        // Adding fields to table competency_usercompcourse.</span>
<a name="l1787"><span class="linenum">1787</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l1788"><span class="linenum">1788</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('userid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1789"><span class="linenum">1789</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('courseid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1790"><span class="linenum">1790</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('competencyid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1791"><span class="linenum">1791</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('proficiency', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '2', null, null, null, null);
<a name="l1792"><span class="linenum">1792</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('grade', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1793"><span class="linenum">1793</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timecreated', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1794"><span class="linenum">1794</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timemodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1795"><span class="linenum">1795</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('usermodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1796"><span class="linenum">1796</span></a>  
<a name="l1797"><span class="linenum">1797</span></a>  <span class="comment">        // Adding keys to table competency_usercompcourse.</span>
<a name="l1798"><span class="linenum">1798</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l1799"><span class="linenum">1799</span></a>  
<a name="l1800"><span class="linenum">1800</span></a>  <span class="comment">        // Adding indexes to table competency_usercompcourse.</span>
<a name="l1801"><span class="linenum">1801</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('useridcoursecomp', <a class="constant" onClick="logConstant('XMLDB_INDEX_UNIQUE')" href="../../_constants/XMLDB_INDEX_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_UNIQUE')">XMLDB_INDEX_UNIQUE</a>, array('userid', 'courseid', 'competencyid'));
<a name="l1802"><span class="linenum">1802</span></a>  
<a name="l1803"><span class="linenum">1803</span></a>  <span class="comment">        // Conditionally launch create table for competency_usercompcourse.</span>
<a name="l1804"><span class="linenum">1804</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l1805"><span class="linenum">1805</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l1806"><span class="linenum">1806</span></a>          }
<a name="l1807"><span class="linenum">1807</span></a>  
<a name="l1808"><span class="linenum">1808</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1809"><span class="linenum">1809</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016041500.60);
<a name="l1810"><span class="linenum">1810</span></a>      }
<a name="l1811"><span class="linenum">1811</span></a>  
<a name="l1812"><span class="linenum">1812</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016041500.61) {
<a name="l1813"><span class="linenum">1813</span></a>  
<a name="l1814"><span class="linenum">1814</span></a>  <span class="comment">        // Define table competency_usercompplan to be created.</span>
<a name="l1815"><span class="linenum">1815</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('competency_usercompplan');
<a name="l1816"><span class="linenum">1816</span></a>  
<a name="l1817"><span class="linenum">1817</span></a>  <span class="comment">        // Adding fields to table competency_usercompplan.</span>
<a name="l1818"><span class="linenum">1818</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l1819"><span class="linenum">1819</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('userid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1820"><span class="linenum">1820</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('competencyid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1821"><span class="linenum">1821</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('planid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1822"><span class="linenum">1822</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('proficiency', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '2', null, null, null, null);
<a name="l1823"><span class="linenum">1823</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('grade', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1824"><span class="linenum">1824</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('sortorder', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1825"><span class="linenum">1825</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timecreated', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1826"><span class="linenum">1826</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timemodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1827"><span class="linenum">1827</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('usermodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1828"><span class="linenum">1828</span></a>  
<a name="l1829"><span class="linenum">1829</span></a>  <span class="comment">        // Adding keys to table competency_usercompplan.</span>
<a name="l1830"><span class="linenum">1830</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l1831"><span class="linenum">1831</span></a>  
<a name="l1832"><span class="linenum">1832</span></a>  <span class="comment">        // Adding indexes to table competency_usercompplan.</span>
<a name="l1833"><span class="linenum">1833</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('usercompetencyplan', <a class="constant" onClick="logConstant('XMLDB_INDEX_UNIQUE')" href="../../_constants/XMLDB_INDEX_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_UNIQUE')">XMLDB_INDEX_UNIQUE</a>, array('userid', 'competencyid', 'planid'));
<a name="l1834"><span class="linenum">1834</span></a>  
<a name="l1835"><span class="linenum">1835</span></a>  <span class="comment">        // Conditionally launch create table for competency_usercompplan.</span>
<a name="l1836"><span class="linenum">1836</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l1837"><span class="linenum">1837</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l1838"><span class="linenum">1838</span></a>          }
<a name="l1839"><span class="linenum">1839</span></a>  
<a name="l1840"><span class="linenum">1840</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1841"><span class="linenum">1841</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016041500.61);
<a name="l1842"><span class="linenum">1842</span></a>      }
<a name="l1843"><span class="linenum">1843</span></a>  
<a name="l1844"><span class="linenum">1844</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016041500.62) {
<a name="l1845"><span class="linenum">1845</span></a>  
<a name="l1846"><span class="linenum">1846</span></a>  <span class="comment">        // Define table competency_plancomp to be created.</span>
<a name="l1847"><span class="linenum">1847</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('competency_plancomp');
<a name="l1848"><span class="linenum">1848</span></a>  
<a name="l1849"><span class="linenum">1849</span></a>  <span class="comment">        // Adding fields to table competency_plancomp.</span>
<a name="l1850"><span class="linenum">1850</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l1851"><span class="linenum">1851</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('planid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1852"><span class="linenum">1852</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('competencyid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1853"><span class="linenum">1853</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('sortorder', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1854"><span class="linenum">1854</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timecreated', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1855"><span class="linenum">1855</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timemodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1856"><span class="linenum">1856</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('usermodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1857"><span class="linenum">1857</span></a>  
<a name="l1858"><span class="linenum">1858</span></a>  <span class="comment">        // Adding keys to table competency_plancomp.</span>
<a name="l1859"><span class="linenum">1859</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l1860"><span class="linenum">1860</span></a>  
<a name="l1861"><span class="linenum">1861</span></a>  <span class="comment">        // Adding indexes to table competency_plancomp.</span>
<a name="l1862"><span class="linenum">1862</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('planidcompetencyid', <a class="constant" onClick="logConstant('XMLDB_INDEX_UNIQUE')" href="../../_constants/XMLDB_INDEX_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_UNIQUE')">XMLDB_INDEX_UNIQUE</a>, array('planid', 'competencyid'));
<a name="l1863"><span class="linenum">1863</span></a>  
<a name="l1864"><span class="linenum">1864</span></a>  <span class="comment">        // Conditionally launch create table for competency_plancomp.</span>
<a name="l1865"><span class="linenum">1865</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l1866"><span class="linenum">1866</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l1867"><span class="linenum">1867</span></a>          }
<a name="l1868"><span class="linenum">1868</span></a>  
<a name="l1869"><span class="linenum">1869</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1870"><span class="linenum">1870</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016041500.62);
<a name="l1871"><span class="linenum">1871</span></a>      }
<a name="l1872"><span class="linenum">1872</span></a>  
<a name="l1873"><span class="linenum">1873</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016041500.63) {
<a name="l1874"><span class="linenum">1874</span></a>  
<a name="l1875"><span class="linenum">1875</span></a>  <span class="comment">        // Define table competency_evidence to be created.</span>
<a name="l1876"><span class="linenum">1876</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('competency_evidence');
<a name="l1877"><span class="linenum">1877</span></a>  
<a name="l1878"><span class="linenum">1878</span></a>  <span class="comment">        // Adding fields to table competency_evidence.</span>
<a name="l1879"><span class="linenum">1879</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l1880"><span class="linenum">1880</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('usercompetencyid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1881"><span class="linenum">1881</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('contextid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1882"><span class="linenum">1882</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('action', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '2', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1883"><span class="linenum">1883</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('actionuserid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1884"><span class="linenum">1884</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('descidentifier', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '255', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1885"><span class="linenum">1885</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('desccomponent', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '255', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1886"><span class="linenum">1886</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('desca', <a class="constant" onClick="logConstant('XMLDB_TYPE_TEXT')" href="../../_constants/XMLDB_TYPE_TEXT.html" onMouseOver="constPopup(event,'XMLDB_TYPE_TEXT')">XMLDB_TYPE_TEXT</a>, null, null, null, null, null);
<a name="l1887"><span class="linenum">1887</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('url', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '255', null, null, null, null);
<a name="l1888"><span class="linenum">1888</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('grade', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, null, null, null);
<a name="l1889"><span class="linenum">1889</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('note', <a class="constant" onClick="logConstant('XMLDB_TYPE_TEXT')" href="../../_constants/XMLDB_TYPE_TEXT.html" onMouseOver="constPopup(event,'XMLDB_TYPE_TEXT')">XMLDB_TYPE_TEXT</a>, null, null, null, null, null);
<a name="l1890"><span class="linenum">1890</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timecreated', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1891"><span class="linenum">1891</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timemodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1892"><span class="linenum">1892</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('usermodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1893"><span class="linenum">1893</span></a>  
<a name="l1894"><span class="linenum">1894</span></a>  <span class="comment">        // Adding keys to table competency_evidence.</span>
<a name="l1895"><span class="linenum">1895</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l1896"><span class="linenum">1896</span></a>  
<a name="l1897"><span class="linenum">1897</span></a>  <span class="comment">        // Adding indexes to table competency_evidence.</span>
<a name="l1898"><span class="linenum">1898</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('usercompetencyid', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('usercompetencyid'));
<a name="l1899"><span class="linenum">1899</span></a>  
<a name="l1900"><span class="linenum">1900</span></a>  <span class="comment">        // Conditionally launch create table for competency_evidence.</span>
<a name="l1901"><span class="linenum">1901</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l1902"><span class="linenum">1902</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l1903"><span class="linenum">1903</span></a>          }
<a name="l1904"><span class="linenum">1904</span></a>  
<a name="l1905"><span class="linenum">1905</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1906"><span class="linenum">1906</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016041500.63);
<a name="l1907"><span class="linenum">1907</span></a>      }
<a name="l1908"><span class="linenum">1908</span></a>  
<a name="l1909"><span class="linenum">1909</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016041500.64) {
<a name="l1910"><span class="linenum">1910</span></a>  
<a name="l1911"><span class="linenum">1911</span></a>  <span class="comment">        // Define table competency_userevidence to be created.</span>
<a name="l1912"><span class="linenum">1912</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('competency_userevidence');
<a name="l1913"><span class="linenum">1913</span></a>  
<a name="l1914"><span class="linenum">1914</span></a>  <span class="comment">        // Adding fields to table competency_userevidence.</span>
<a name="l1915"><span class="linenum">1915</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l1916"><span class="linenum">1916</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('userid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1917"><span class="linenum">1917</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('name', <a class="constant" onClick="logConstant('XMLDB_TYPE_CHAR')" href="../../_constants/XMLDB_TYPE_CHAR.html" onMouseOver="constPopup(event,'XMLDB_TYPE_CHAR')">XMLDB_TYPE_CHAR</a>, '100', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1918"><span class="linenum">1918</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('description', <a class="constant" onClick="logConstant('XMLDB_TYPE_TEXT')" href="../../_constants/XMLDB_TYPE_TEXT.html" onMouseOver="constPopup(event,'XMLDB_TYPE_TEXT')">XMLDB_TYPE_TEXT</a>, null, null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1919"><span class="linenum">1919</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('descriptionformat', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '1', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1920"><span class="linenum">1920</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('url', <a class="constant" onClick="logConstant('XMLDB_TYPE_TEXT')" href="../../_constants/XMLDB_TYPE_TEXT.html" onMouseOver="constPopup(event,'XMLDB_TYPE_TEXT')">XMLDB_TYPE_TEXT</a>, null, null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1921"><span class="linenum">1921</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timecreated', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1922"><span class="linenum">1922</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timemodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1923"><span class="linenum">1923</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('usermodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1924"><span class="linenum">1924</span></a>  
<a name="l1925"><span class="linenum">1925</span></a>  <span class="comment">        // Adding keys to table competency_userevidence.</span>
<a name="l1926"><span class="linenum">1926</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l1927"><span class="linenum">1927</span></a>  
<a name="l1928"><span class="linenum">1928</span></a>  <span class="comment">        // Adding indexes to table competency_userevidence.</span>
<a name="l1929"><span class="linenum">1929</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('userid', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('userid'));
<a name="l1930"><span class="linenum">1930</span></a>  
<a name="l1931"><span class="linenum">1931</span></a>  <span class="comment">        // Conditionally launch create table for competency_userevidence.</span>
<a name="l1932"><span class="linenum">1932</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l1933"><span class="linenum">1933</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l1934"><span class="linenum">1934</span></a>          }
<a name="l1935"><span class="linenum">1935</span></a>  
<a name="l1936"><span class="linenum">1936</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1937"><span class="linenum">1937</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016041500.64);
<a name="l1938"><span class="linenum">1938</span></a>      }
<a name="l1939"><span class="linenum">1939</span></a>  
<a name="l1940"><span class="linenum">1940</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016041500.65) {
<a name="l1941"><span class="linenum">1941</span></a>  
<a name="l1942"><span class="linenum">1942</span></a>  <span class="comment">        // Define table competency_userevidencecomp to be created.</span>
<a name="l1943"><span class="linenum">1943</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('competency_userevidencecomp');
<a name="l1944"><span class="linenum">1944</span></a>  
<a name="l1945"><span class="linenum">1945</span></a>  <span class="comment">        // Adding fields to table competency_userevidencecomp.</span>
<a name="l1946"><span class="linenum">1946</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l1947"><span class="linenum">1947</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('userevidenceid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1948"><span class="linenum">1948</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('competencyid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1949"><span class="linenum">1949</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timecreated', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1950"><span class="linenum">1950</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timemodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1951"><span class="linenum">1951</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('usermodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1952"><span class="linenum">1952</span></a>  
<a name="l1953"><span class="linenum">1953</span></a>  <span class="comment">        // Adding keys to table competency_userevidencecomp.</span>
<a name="l1954"><span class="linenum">1954</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l1955"><span class="linenum">1955</span></a>  
<a name="l1956"><span class="linenum">1956</span></a>  <span class="comment">        // Adding indexes to table competency_userevidencecomp.</span>
<a name="l1957"><span class="linenum">1957</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('userevidenceid', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('userevidenceid'));
<a name="l1958"><span class="linenum">1958</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('userevidencecompids', <a class="constant" onClick="logConstant('XMLDB_INDEX_UNIQUE')" href="../../_constants/XMLDB_INDEX_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_UNIQUE')">XMLDB_INDEX_UNIQUE</a>, array('userevidenceid', 'competencyid'));
<a name="l1959"><span class="linenum">1959</span></a>  
<a name="l1960"><span class="linenum">1960</span></a>  <span class="comment">        // Conditionally launch create table for competency_userevidencecomp.</span>
<a name="l1961"><span class="linenum">1961</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l1962"><span class="linenum">1962</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l1963"><span class="linenum">1963</span></a>          }
<a name="l1964"><span class="linenum">1964</span></a>  
<a name="l1965"><span class="linenum">1965</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1966"><span class="linenum">1966</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016041500.65);
<a name="l1967"><span class="linenum">1967</span></a>      }
<a name="l1968"><span class="linenum">1968</span></a>  
<a name="l1969"><span class="linenum">1969</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016041500.66) {
<a name="l1970"><span class="linenum">1970</span></a>  
<a name="l1971"><span class="linenum">1971</span></a>  <span class="comment">        // Define table competency_modulecomp to be created.</span>
<a name="l1972"><span class="linenum">1972</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>('competency_modulecomp');
<a name="l1973"><span class="linenum">1973</span></a>  
<a name="l1974"><span class="linenum">1974</span></a>  <span class="comment">        // Adding fields to table competency_modulecomp.</span>
<a name="l1975"><span class="linenum">1975</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('id', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, <a class="constant" onClick="logConstant('XMLDB_SEQUENCE')" href="../../_constants/XMLDB_SEQUENCE.html" onMouseOver="constPopup(event,'XMLDB_SEQUENCE')">XMLDB_SEQUENCE</a>, null);
<a name="l1976"><span class="linenum">1976</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('cmid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1977"><span class="linenum">1977</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timecreated', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1978"><span class="linenum">1978</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('timemodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1979"><span class="linenum">1979</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('usermodified', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1980"><span class="linenum">1980</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('sortorder', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1981"><span class="linenum">1981</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('competencyid', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '10', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1982"><span class="linenum">1982</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_field')" href="../../_functions/add_field.html" onMouseOver="funcPopup(event,'add_field')">add_field</a>('ruleoutcome', <a class="constant" onClick="logConstant('XMLDB_TYPE_INTEGER')" href="../../_constants/XMLDB_TYPE_INTEGER.html" onMouseOver="constPopup(event,'XMLDB_TYPE_INTEGER')">XMLDB_TYPE_INTEGER</a>, '2', null, <a class="constant" onClick="logConstant('XMLDB_NOTNULL')" href="../../_constants/XMLDB_NOTNULL.html" onMouseOver="constPopup(event,'XMLDB_NOTNULL')">XMLDB_NOTNULL</a>, null, null);
<a name="l1983"><span class="linenum">1983</span></a>  
<a name="l1984"><span class="linenum">1984</span></a>  <span class="comment">        // Adding keys to table competency_modulecomp.</span>
<a name="l1985"><span class="linenum">1985</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('primary', <a class="constant" onClick="logConstant('XMLDB_KEY_PRIMARY')" href="../../_constants/XMLDB_KEY_PRIMARY.html" onMouseOver="constPopup(event,'XMLDB_KEY_PRIMARY')">XMLDB_KEY_PRIMARY</a>, array('id'));
<a name="l1986"><span class="linenum">1986</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('cmidkey', <a class="constant" onClick="logConstant('XMLDB_KEY_FOREIGN')" href="../../_constants/XMLDB_KEY_FOREIGN.html" onMouseOver="constPopup(event,'XMLDB_KEY_FOREIGN')">XMLDB_KEY_FOREIGN</a>, array('cmid'), 'course_modules', array('id'));
<a name="l1987"><span class="linenum">1987</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_key')" href="../../_functions/add_key.html" onMouseOver="funcPopup(event,'add_key')">add_key</a>('competencyidkey', <a class="constant" onClick="logConstant('XMLDB_KEY_FOREIGN')" href="../../_constants/XMLDB_KEY_FOREIGN.html" onMouseOver="constPopup(event,'XMLDB_KEY_FOREIGN')">XMLDB_KEY_FOREIGN</a>, array('competencyid'), 'competency_competency', array('id'));
<a name="l1988"><span class="linenum">1988</span></a>  
<a name="l1989"><span class="linenum">1989</span></a>  <span class="comment">        // Adding indexes to table competency_modulecomp.</span>
<a name="l1990"><span class="linenum">1990</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('cmidruleoutcome', <a class="constant" onClick="logConstant('XMLDB_INDEX_NOTUNIQUE')" href="../../_constants/XMLDB_INDEX_NOTUNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_NOTUNIQUE')">XMLDB_INDEX_NOTUNIQUE</a>, array('cmid', 'ruleoutcome'));
<a name="l1991"><span class="linenum">1991</span></a>          <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>-&gt;<a class="function" onClick="logFunction('add_index')" href="../../_functions/add_index.html" onMouseOver="funcPopup(event,'add_index')">add_index</a>('cmidcompetencyid', <a class="constant" onClick="logConstant('XMLDB_INDEX_UNIQUE')" href="../../_constants/XMLDB_INDEX_UNIQUE.html" onMouseOver="constPopup(event,'XMLDB_INDEX_UNIQUE')">XMLDB_INDEX_UNIQUE</a>, array('cmid', 'competencyid'));
<a name="l1992"><span class="linenum">1992</span></a>  
<a name="l1993"><span class="linenum">1993</span></a>  <span class="comment">        // Conditionally launch create table for competency_modulecomp.</span>
<a name="l1994"><span class="linenum">1994</span></a>          if (!<a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>)) {
<a name="l1995"><span class="linenum">1995</span></a>              <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('create_table')" href="../../_functions/create_table.html" onMouseOver="funcPopup(event,'create_table')">create_table</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>);
<a name="l1996"><span class="linenum">1996</span></a>          }
<a name="l1997"><span class="linenum">1997</span></a>  
<a name="l1998"><span class="linenum">1998</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l1999"><span class="linenum">1999</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016041500.66);
<a name="l2000"><span class="linenum">2000</span></a>      }
<a name="l2001"><span class="linenum">2001</span></a>  
<a name="l2002"><span class="linenum">2002</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016042100.00) {
<a name="l2003"><span class="linenum">2003</span></a>  <span class="comment">        // Update all countries to upper case.</span>
<a name="l2004"><span class="linenum">2004</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>(&quot;UPDATE {user} SET country = <a class="function" onClick="logFunction('UPPER')" href="../../_functions/upper.html" onMouseOver="funcPopup(event,'upper')">UPPER</a>(country)&quot;);
<a name="l2005"><span class="linenum">2005</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l2006"><span class="linenum">2006</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016042100.00);
<a name="l2007"><span class="linenum">2007</span></a>      }
<a name="l2008"><span class="linenum">2008</span></a>  
<a name="l2009"><span class="linenum">2009</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016042600.01) {
<a name="l2010"><span class="linenum">2010</span></a>          <a class="var it30833" onMouseOver="hilite(30833)" onMouseOut="lolite()" onClick="logVariable('deprecatedwebservices')" href="../../_variables/deprecatedwebservices.html">$deprecatedwebservices</a> = [
<a name="l2011"><span class="linenum">2011</span></a>              'moodle_course_create_courses',
<a name="l2012"><span class="linenum">2012</span></a>              'moodle_course_get_courses',
<a name="l2013"><span class="linenum">2013</span></a>              'moodle_enrol_get_enrolled_users',
<a name="l2014"><span class="linenum">2014</span></a>              'moodle_enrol_get_users_courses',
<a name="l2015"><span class="linenum">2015</span></a>              'moodle_enrol_manual_enrol_users',
<a name="l2016"><span class="linenum">2016</span></a>              'moodle_file_get_files',
<a name="l2017"><span class="linenum">2017</span></a>              'moodle_file_upload',
<a name="l2018"><span class="linenum">2018</span></a>              'moodle_group_add_groupmembers',
<a name="l2019"><span class="linenum">2019</span></a>              'moodle_group_create_groups',
<a name="l2020"><span class="linenum">2020</span></a>              'moodle_group_delete_groupmembers',
<a name="l2021"><span class="linenum">2021</span></a>              'moodle_group_delete_groups',
<a name="l2022"><span class="linenum">2022</span></a>              'moodle_group_get_course_groups',
<a name="l2023"><span class="linenum">2023</span></a>              'moodle_group_get_groupmembers',
<a name="l2024"><span class="linenum">2024</span></a>              'moodle_group_get_groups',
<a name="l2025"><span class="linenum">2025</span></a>              'moodle_message_send_instantmessages',
<a name="l2026"><span class="linenum">2026</span></a>              'moodle_notes_create_notes',
<a name="l2027"><span class="linenum">2027</span></a>              'moodle_role_assign',
<a name="l2028"><span class="linenum">2028</span></a>              'moodle_role_unassign',
<a name="l2029"><span class="linenum">2029</span></a>              'moodle_user_create_users',
<a name="l2030"><span class="linenum">2030</span></a>              'moodle_user_delete_users',
<a name="l2031"><span class="linenum">2031</span></a>              'moodle_user_get_course_participants_by_id',
<a name="l2032"><span class="linenum">2032</span></a>              'moodle_user_get_users_by_courseid',
<a name="l2033"><span class="linenum">2033</span></a>              'moodle_user_get_users_by_id',
<a name="l2034"><span class="linenum">2034</span></a>              'moodle_user_update_users',
<a name="l2035"><span class="linenum">2035</span></a>              'core_grade_get_definitions',
<a name="l2036"><span class="linenum">2036</span></a>              'core_user_get_users_by_id',
<a name="l2037"><span class="linenum">2037</span></a>              'moodle_webservice_get_siteinfo',
<a name="l2038"><span class="linenum">2038</span></a>              'mod_forum_get_forum_discussions'
<a name="l2039"><span class="linenum">2039</span></a>          ];
<a name="l2040"><span class="linenum">2040</span></a>  
<a name="l2041"><span class="linenum">2041</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it1041" onMouseOver="hilite(1041)" onMouseOut="lolite()" onClick="logVariable('insql')" href="../../_variables/insql.html">$insql</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it30833" onMouseOver="hilite(30833)" onMouseOut="lolite()" onClick="logVariable('deprecatedwebservices')" href="../../_variables/deprecatedwebservices.html">$deprecatedwebservices</a>);
<a name="l2042"><span class="linenum">2042</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records_select')" href="../../_functions/delete_records_select.html" onMouseOver="funcPopup(event,'delete_records_select')">delete_records_select</a>('external_functions', &quot;name <a class="var it1041" onMouseOver="hilite(1041)" onMouseOut="lolite()" onClick="logVariable('insql')" href="../../_variables/insql.html">$insql</a>&quot;, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l2043"><span class="linenum">2043</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records_select')" href="../../_functions/delete_records_select.html" onMouseOver="funcPopup(event,'delete_records_select')">delete_records_select</a>('external_services_functions', &quot;functionname <a class="var it1041" onMouseOver="hilite(1041)" onMouseOut="lolite()" onClick="logVariable('insql')" href="../../_variables/insql.html">$insql</a>&quot;, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l2044"><span class="linenum">2044</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l2045"><span class="linenum">2045</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016042600.01);
<a name="l2046"><span class="linenum">2046</span></a>      }
<a name="l2047"><span class="linenum">2047</span></a>  
<a name="l2048"><span class="linenum">2048</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016051300.00) {
<a name="l2049"><span class="linenum">2049</span></a>  <span class="comment">        // Add a default competency rating scale.</span>
<a name="l2050"><span class="linenum">2050</span></a>          <a class="function" onClick="logFunction('make_competence_scale')" href="../../_functions/make_competence_scale.html" onMouseOver="funcPopup(event,'make_competence_scale')">make_competence_scale</a>();
<a name="l2051"><span class="linenum">2051</span></a>  
<a name="l2052"><span class="linenum">2052</span></a>  <span class="comment">        // Savepoint reached.</span>
<a name="l2053"><span class="linenum">2053</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016051300.00);
<a name="l2054"><span class="linenum">2054</span></a>      }
<a name="l2055"><span class="linenum">2055</span></a>  
<a name="l2056"><span class="linenum">2056</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016051700.01) {
<a name="l2057"><span class="linenum">2057</span></a>  <span class="comment">        // This script is included in each major version upgrade process (3.0, 3.1) so make sure we don't run it twice.</span>
<a name="l2058"><span class="linenum">2058</span></a>          if (empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('upgrade_letterboundarycourses')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/upgrade_letterboundarycourses.html">upgrade_letterboundarycourses</a>)) {
<a name="l2059"><span class="linenum">2059</span></a>  <span class="comment">            // MDL-45390. If a grade is being displayed with letters and the grade boundaries are not being adhered to properly</span>
<a name="l2060"><span class="linenum">2060</span></a>  <span class="comment">            // then this course will also be frozen.</span>
<a name="l2061"><span class="linenum">2061</span></a>  <span class="comment">            // If the changes are accepted then the display of some grades may change.</span>
<a name="l2062"><span class="linenum">2062</span></a>  <span class="comment">            // This is here to freeze the gradebook in affected courses.</span>
<a name="l2063"><span class="linenum">2063</span></a>              <a class="function" onClick="logFunction('upgrade_course_letter_boundary')" href="../../_functions/upgrade_course_letter_boundary.html" onMouseOver="funcPopup(event,'upgrade_course_letter_boundary')">upgrade_course_letter_boundary</a>();
<a name="l2064"><span class="linenum">2064</span></a>  
<a name="l2065"><span class="linenum">2065</span></a>  <span class="comment">            // To skip running the same script on the upgrade to the next major version release.</span>
<a name="l2066"><span class="linenum">2066</span></a>              <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('upgrade_letterboundarycourses', 1);
<a name="l2067"><span class="linenum">2067</span></a>          }
<a name="l2068"><span class="linenum">2068</span></a>  <span class="comment">        // Main savepoint reached.</span>
<a name="l2069"><span class="linenum">2069</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016051700.01);
<a name="l2070"><span class="linenum">2070</span></a>      }
<a name="l2071"><span class="linenum">2071</span></a>  
<a name="l2072"><span class="linenum">2072</span></a>  <span class="comment">    // Moodle v3.1.0 release upgrade line.</span>
<a name="l2073"><span class="linenum">2073</span></a>  <span class="comment">    // Put any upgrade step following this.</span>
<a name="l2074"><span class="linenum">2074</span></a>  
<a name="l2075"><span class="linenum">2075</span></a>      if (<a class="var it443" onMouseOver="hilite(443)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> &lt; 2016070700.01) {
<a name="l2076"><span class="linenum">2076</span></a>  
<a name="l2077"><span class="linenum">2077</span></a>  <span class="comment">        // If someone is emotionally attached to it let's leave the config (basically the version) there.</span>
<a name="l2078"><span class="linenum">2078</span></a>          if (!<a class="phpfunction" onClick="logFunction('file_exists')" href="../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a> . '/report/search/classes/output/form.php')) {
<a name="l2079"><span class="linenum">2079</span></a>              <a class="function" onClick="logFunction('unset_all_config_for_plugin')" href="../../_functions/unset_all_config_for_plugin.html" onMouseOver="funcPopup(event,'unset_all_config_for_plugin')">unset_all_config_for_plugin</a>('report_search');
<a name="l2080"><span class="linenum">2080</span></a>          }
<a name="l2081"><span class="linenum">2081</span></a>  
<a name="l2082"><span class="linenum">2082</span></a>  <span class="comment">        // Savepoint reached.</span>
<a name="l2083"><span class="linenum">2083</span></a>          <a class="function" onClick="logFunction('upgrade_main_savepoint')" href="../../_functions/upgrade_main_savepoint.html" onMouseOver="funcPopup(event,'upgrade_main_savepoint')">upgrade_main_savepoint</a>(true, 2016070700.01);
<a name="l2084"><span class="linenum">2084</span></a>      }
<a name="l2085"><span class="linenum">2085</span></a>  
<a name="l2086"><span class="linenum">2086</span></a>      return true;
<a name="l2087"><span class="linenum">2087</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'drop_field': ['drop_field', 'This function will drop the field from the table passed as arguments ', [['lib/ddl','database_manager.php',548]], 14],
'execute': ['execute', 'Run langpack update ', [['admin/tool/langimport/classes/task','update_langpacks_task.php',44],['backup/converter/imscc1','lib.php',84],['lib/classes/task','blog_cron_task.php',40],['mod/workshop/allocation/scheduled','lib.php',128],['lib/classes/task','send_new_user_passwords_task.php',40],['admin/tool/log/store/standard/classes/task','cleanup_task.php',40],['lib/dml','pdo_moodle_database.php',227],['lib/classes/task','tag_cron_task.php',42],['enrol/imsenterprise/classes/task','cron_task.php',43],['lib/classes/task','completion_daily_task.php',42],['lib/google/src/Google/Http','Batch.php',61],['lib/dml','oci_native_moodle_database.php',1048],['lib/classes/task','context_cleanup_task.php',41],['backup/util/plan','backup_structure_step.class.php',50],['backup/util/ui','restore_ui.class.php',206],['webservice','lib.php',1319],['lib/classes/task','stats_cron_task.php',40],['lib/htmlpurifier/HTMLPurifier/Strategy','ValidateAttributes.php',16],['lib/htmlpurifier/HTMLPurifier/Strategy','RemoveForeignElements.php',20],['lib/classes/task','legacy_plugin_cron_task.php',42],['backup/moodle2','restore_activity_task.class.php',189],['lib/classes/task','portfolio_cron_task.php',40],['lib/google/src/Google/Http','REST.php',27],['lib/htmlpurifier/HTMLPurifier/Strategy','MakeWellFormed.php',66],['backup/converter/imscc11','backuplib.php',42],['lib/classes/task','question_cron_task.php',40],['lib/classes/task','cache_cron_task.php',40],['admin/tool/log/store/legacy/classes/task','cleanup_task.php',40],['mod/lti/service/memberships/classes/local/resource','linkmemberships.php',62],['admin/tool/messageinbound/classes/task','cleanup_task.php',47],['lib/adodb/drivers','adodb-pdo.inc.php',559],['lib/editor/atto/classes/task','autosave_cleanup_task.php',42],['admin/tool/recyclebin/classes/task','cleanup_category_bin.php',43],['lib/classes/task','completion_regular_task.php',42],['lib/adodb/drivers','adodb-oci8po.inc.php',54],['lib/classes/task','events_cron_task.php',40],['mod/workshop/allocation/random','lib.php',83],['mod/assign/feedback/editpdf/classes/task','convert_submissions.php',47],['auth/cas/classes/task','sync_task.php',43],['admin/tool/recyclebin/classes/task','cleanup_course_bin.php',43],['mod/lti/service/toolsettings/classes/local/resource','contextsettings.php',62],['backup/util/helper','restore_decode_processor.class.php',73],['lib/behat','behat_base.php',840],['enrol/flatfile/classes/task','flatfile_sync_task.php',46],['lib/classes/task','registration_cron_task.php',40],['backup/moodle2','backup_section_task.class.php',97],['lib/classes/task','check_for_updates_task.php',40],['backup/util/plan/tests/fixtures','plan_fixtures.php',48],['backup/util/plan/tests/fixtures','plan_fixtures.php',56],['mod/forum/classes/task','cron_task.php',39],['lib/classes/task','send_failed_login_notifications_task.php',43],['enrol/lti/classes/task','sync_grades.php',45],['lib/dml','pgsql_native_moodle_database.php',665],['lib/htmlpurifier/HTMLPurifier/Strategy','Composite.php',21],['lib/classes/update','validator.php',117],['lib/google/src/Google','Client.php',574],['lib/dml','mssql_native_moodle_database.php',711],['mod/lti/service/profile/classes/local/resource','profile.php',76],['backup/util/plan','backup_plan.class.php',112],['lib/dml','mysqli_native_moodle_database.php',963],['backup/util/ui','backup_ui.class.php',122],['admin/tool/monitor/classes/task','clean_events.php',41],['backup/converter/moodle1','backuplib.php',10],['backup/converter/imscc11','lib.php',85],['lib/classes/task','grade_cron_task.php',40],['lib/classes/task','file_temp_cleanup_task.php',40],['backup/moodle2','restore_section_task.class.php',87],['mod/lti/service/toolsettings/classes/local/resource','linksettings.php',63],['filter/tex','latex.php',70],['lib/adodb','adodb.inc.php',1088],['lib/classes/task','plagiarism_cron_task.php',40],['mod/lti/service/toolproxy/classes/local/resource','toolproxy.php',62],['backup/converter/moodle1','lib.php',142],['backup/util/plan','restore_structure_step.class.php',62],['lib/classes/task','search_index_task.php',44],['enrol/lti/classes/task','sync_members.php',55],['lib/classes/task','session_cleanup_task.php',40],['mod/lti/service/toolsettings/classes/local/resource','systemsettings.php',61],['lib/classes/task','backup_cleanup_task.php',40],['lib/classes/task','delete_unconfirmed_users_task.php',40],['backup/converter/imscc1','backuplib.php',10],['lib/classes/task','badges_cron_task.php',40],['admin/tool/uploadcourse/classes','processor.php',174],['lib/classes/task','calendar_cron_task.php',40],['backup/util/plan','base_plan.class.php',158],['auth/ldap/classes/task','sync_task.php',43],['lib/adodb/drivers','adodb-oci8.inc.php',920],['backup/util/plan','restore_plan.class.php',159],['lib/tests/fixtures','task_fixtures.php',30],['lib/tests/fixtures','task_fixtures.php',39],['lib/tests/fixtures','task_fixtures.php',48],['lib/tests/fixtures','task_fixtures.php',57],['lib/dml','sqlsrv_native_moodle_database.php',795],['lib/classes/task','create_contexts_task.php',40],['lib/classes/task','file_trash_cleanup_task.php',40],['admin/tool/cohortroles/classes/task','cohort_role_sync.php',46],['lib/classes/task','complete_plans_task.php',52],['lib/classes/task','messaging_cleanup_task.php',40],['backup/util/plan','backup_execution_step.class.php',25],['lib/classes/task','cache_cleanup_task.php',40],['backup/moodle2','backup_activity_task.class.php',211],['filter/tex','texdebug.php',287],['lib/classes/task','password_reset_cleanup_task.php',40],['lib/classes/task','search_optimize_task.php',47],['mod/assign','adminlib.php',342],['lib/classes/task','delete_incomplete_users_task.php',40],['lib/classes/task','automated_backup_task.php',40],['admin/tool/messageinbound/classes/task','pickup_task.php',47],['backup/util/plan','restore_execution_step.class.php',25],['lib/classes/task','sync_plans_from_template_cohorts_task.php',50],['admin/tool/monitor/classes','notification_task.php',39],['lib/dml/tests','dml_test.php',5543],['lib/htmlpurifier/HTMLPurifier/Strategy','FixNesting.php',41],['mod/lti/service/memberships/classes/local/resource','contextmemberships.php',60],['admin/tool/monitor/classes/task','check_subscriptions.php',60],['backup/util/interfaces','executable.class.php',32],['backup/util/plan','base_task.class.php',162]], 1058],
'get_in_or_equal': ['get_in_or_equal', 'Constructs \'IN()\' or \'=\' sql fragment ', [['lib/dml','oci_native_moodle_database.php',1635],['lib/dml','moodle_database.php',711]], 438],
'upgrade_course_tags': ['upgrade_course_tags', 'This upgrade script merges all tag instances pointing to the same course tag ', [['lib/db','upgradelib.php',291]], 4],
'unset_config': ['unset_config', 'Removes a key from global configuration. ', [['lib','moodlelib.php',1504]], 77],
'update': ['update', 'In addition to update() as defined in grade_object, handle the grade_outcome and grade_scale objects. Force regrading if necessary, rounds the float numbers using php function, the reason is we need to compare the db value with computed number to skip regrading if possible. ', [['lib/grade','grade_item.php',274],['lib/google/src/Google/Service','Tasks.php',386],['lib/google/src/Google/Service','Tasks.php',556],['lib/google/src/Google/Service','AndroidPublisher.php',1413],['lib/google/src/Google/Service','AndroidPublisher.php',1545],['lib/google/src/Google/Service','AndroidPublisher.php',1615],['lib/google/src/Google/Service','AndroidPublisher.php',1853],['lib/google/src/Google/Service','AndroidPublisher.php',1919],['lib/google/src/Google/Service','AndroidPublisher.php',2003],['lib/google/src/Google/Service','AndroidPublisher.php',2177],['lib/google/src/Google/Service','Reseller.php',344],['lib/grade','grade_category.php',226],['lib/grade','grade_scale.php',125],['lib/adodb','adodb-active-record.inc.php',1004],['lib/grade','grade_object.php',238],['lib/google/src/Google/Service','YouTubeAnalytics.php',534],['completion','data_object.php',252],['mod/lesson/pagetypes','matching.php',308],['tag/classes','collection.php',215],['lib/google/src/Google/Service','AdExchangeBuyer.php',802],['lib/google/src/Google/Service','AdExchangeBuyer.php',906],['lib/google/src/Google/Service','AdExchangeBuyer.php',1013],['lib/google/src/Google/Service','AdExchangeBuyer.php',1181],['lib/google/src/Google/Service','AdExchangeBuyer.php',1357],['lib/google/src/Google/Service','AdExchangeBuyer.php',1640],['lib/google/src/Google/Service','Books.php',2025],['lib/grade','grade_grade.php',1009],['lib/grade','grade_outcome.php',144],['lib/google/src/Google/Service','Analytics.php',2215],['lib/google/src/Google/Service','Analytics.php',2388],['lib/google/src/Google/Service','Analytics.php',2501],['lib/google/src/Google/Service','Analytics.php',2626],['lib/google/src/Google/Service','Analytics.php',2736],['lib/google/src/Google/Service','Analytics.php',2843],['lib/google/src/Google/Service','Analytics.php',2971],['lib/google/src/Google/Service','Analytics.php',3062],['lib/google/src/Google/Service','Analytics.php',3185],['lib/google/src/Google/Service','Analytics.php',3502],['lib/google/src/Google/Service','Analytics.php',3604],['lib/google/src/Google/Service','Analytics.php',3686],['lib/google/src/Google/Service','Coordinate.php',611],['lib/google/src/Google/Service','Coordinate.php',727],['lib/google/src/Google/Service','DeploymentManager.php',589],['tag/classes/output','tagareacollection.php',68],['lib','weblib.php',3312],['lib/google/src/Google/Service','Blogger.php',1349],['lib/google/src/Google/Service','Blogger.php',1647],['lib/google/src/Google/Service','Dataflow.php',350],['tag/classes/output','tagcollname.php',58],['competency/classes','persistent.php',452],['lib/google/src/Google/Service','Cloudresourcemanager.php',344],['lib/google/src/Google/Service','Cloudresourcemanager.php',555],['lib/google/src/Google/Service','TagManager.php',977],['lib/google/src/Google/Service','TagManager.php',1066],['lib/google/src/Google/Service','TagManager.php',1159],['lib/google/src/Google/Service','TagManager.php',1219],['lib/google/src/Google/Service','TagManager.php',1311],['lib/google/src/Google/Service','TagManager.php',1405],['lib/google/src/Google/Service','TagManager.php',1499],['lib/google/src/Google/Service','TagManager.php',1650],['lib/google/src/Google/Service','TagManager.php',1743],['mod/lesson','locallib.php',2691],['lib/google/src/Google/Service','Bigquery.php',621],['lib/google/src/Google/Service','Bigquery.php',953],['lib/google/src/Google/Service','ShoppingContent.php',1136],['lib/google/src/Google/Service','ShoppingContent.php',1238],['lib/google/src/Google/Service','ShoppingContent.php',1401],['lib/google/src/Google/Service','ShoppingContent.php',1534],['mod/lesson/pagetypes','truefalse.php',163],['lib/google/src/Google/Service','Clouddebugger.php',307],['lib/filestorage','stored_file.php',103],['lib/google/src/Google/Service','Container.php',366],['lib/horde/framework/Horde/Support','Array.php',70],['lib/google/src/Google/Service','Storage.php',1127],['lib/google/src/Google/Service','Storage.php',1268],['lib/google/src/Google/Service','Storage.php',1423],['lib/google/src/Google/Service','Storage.php',1564],['lib/google/src/Google/Service','Storage.php',1904],['tag/classes/output','tagname.php',56],['tag/classes/output','tagcollsearchable.php',72],['lib/google/src/Google/Service','Games.php',1508],['lib/google/src/Google/Service','Licensing.php',335],['lib/google/src/Google/Service','Fitness.php',478],['lib/google/src/Google/Service','Fitness.php',691],['lib/google/src/Google/Service','Gmail.php',833],['lib/google/src/Google/Service','Gmail.php',986],['lib/google/src/Google/Service','Taskqueue.php',398],['lib/adodb','adodb-active-recordx.inc.php',1136],['grade/grading/form','lib.php',905],['lib/google/src/Google/Service','Doubleclicksearch.php',326],['lib/google/src/Google/Service','Autoscaler.php',400],['tag/classes/output','tagisstandard.php',70],['lib/google/src/Google/Service','Prediction.php',339],['lib/google/src/Google/Service','SiteVerification.php',227],['lib/google/src/Google/Service','Drive.php',1691],['lib/google/src/Google/Service','Drive.php',1961],['lib/google/src/Google/Service','Drive.php',2208],['lib/google/src/Google/Service','Drive.php',2320],['lib/google/src/Google/Service','Drive.php',2370],['lib/google/src/Google/Service','Drive.php',2494],['lib/google/src/Google/Service','Drive.php',2582],['tag/classes/output','tagflag.php',71],['lib/google/src/Google/Service','Proximitybeacon.php',440],['lib/google/src/Google/Service','Groupssettings.php',138],['lib/google/src/Google/Service','Directory.php',1829],['lib/google/src/Google/Service','Directory.php',1889],['lib/google/src/Google/Service','Directory.php',2141],['lib/google/src/Google/Service','Directory.php',2306],['lib/google/src/Google/Service','Directory.php',2489],['lib/google/src/Google/Service','Directory.php',2597],['lib/google/src/Google/Service','Directory.php',2808],['lib/google/src/Google/Service','Directory.php',2910],['lib/google/src/Google/Service','Directory.php',3131],['lib/google/src/Google/Service','Directory.php',3317],['lib/google/src/Google/Service','Fusiontables.php',727],['lib/google/src/Google/Service','Fusiontables.php',892],['lib/google/src/Google/Service','Fusiontables.php',1094],['lib/google/src/Google/Service','Fusiontables.php',1269],['lib/google/src/Google/Service','AdSenseHost.php',846],['lib/google/src/Google/Service','AdSenseHost.php',1097],['course/classes/output','course_module_name.php',81],['lib/google/src/Google/Service','Mirror.php',496],['lib/google/src/Google/Service','Mirror.php',634],['lib/google/src/Google/Service','Mirror.php',745],['tag/classes','area.php',226],['lib/google/src/Google/Service','AndroidEnterprise.php',1064],['lib/google/src/Google/Service','AndroidEnterprise.php',1165],['lib/google/src/Google/Service','AndroidEnterprise.php',1489],['lib/google/src/Google/Service','AndroidEnterprise.php',1672],['grade/grading/form/rubric','lib.php',828],['lib/xhprof/xhprof_html/jquery','jquery.tooltip.js',200],['mod/lesson/pagetypes','essay.php',158],['lib','coursecatlib.php',438],['tag/classes','tag.php',893],['lib/google/src/Google/Service','Calendar.php',1006],['lib/google/src/Google/Service','Calendar.php',1181],['lib/google/src/Google/Service','Calendar.php',1333],['lib/google/src/Google/Service','Calendar.php',1714],['lib/google/src/Google/Service','PlusDomains.php',692],['lib/google/src/Google/Service','GamesConfiguration.php',334],['lib/google/src/Google/Service','GamesConfiguration.php',473],['mod/lesson/pagetypes','branchtable.php',262],['tag/classes/output','tagareashowstandard.php',64],['lib/google/src/Google/Service','AppState.php',202],['calendar','lib.php',2206],['tag/classes/output','tagareaenabled.php',69],['cohort/classes/output','cohortidnumber.php',53],['lib/google/src/Google/Service','Classroom.php',564],['cohort/classes/output','cohortname.php',53],['lib/google/src/Google/Service','SQLAdmin.php',947],['lib/google/src/Google/Service','SQLAdmin.php',1267],['lib/google/src/Google/Service','SQLAdmin.php',1534],['grade/grading/form/guide','lib.php',836],['lib/google/src/Google/Service','Compute.php',4253],['lib/google/src/Google/Service','Compute.php',4398],['lib/google/src/Google/Service','Compute.php',4767],['lib/google/src/Google/Service','Compute.php',5348],['lib/google/src/Google/Service','Compute.php',5478],['lib/google/src/Google/Service','Compute.php',8131],['lib/google/src/Google/Service','YouTube.php',1959],['lib/google/src/Google/Service','YouTube.php',2194],['lib/google/src/Google/Service','YouTube.php',2303],['lib/google/src/Google/Service','YouTube.php',2429],['lib/google/src/Google/Service','YouTube.php',2570],['lib/google/src/Google/Service','YouTube.php',3111],['lib/google/src/Google/Service','YouTube.php',3348],['lib/google/src/Google/Service','YouTube.php',3518],['lib/google/src/Google/Service','YouTube.php',3708],['lib/google/src/Google/Service','YouTube.php',4400],['lib/google/src/Google/Service','Dfareporting.php',4752],['lib/google/src/Google/Service','Dfareporting.php',4840],['lib/google/src/Google/Service','Dfareporting.php',4973],['lib/google/src/Google/Service','Dfareporting.php',5090],['lib/google/src/Google/Service','Dfareporting.php',5204],['lib/google/src/Google/Service','Dfareporting.php',5400],['lib/google/src/Google/Service','Dfareporting.php',5656],['lib/google/src/Google/Service','Dfareporting.php',5848],['lib/google/src/Google/Service','Dfareporting.php',5970],['lib/google/src/Google/Service','Dfareporting.php',6078],['lib/google/src/Google/Service','Dfareporting.php',6196],['lib/google/src/Google/Service','Dfareporting.php',6502],['lib/google/src/Google/Service','Dfareporting.php',6704],['lib/google/src/Google/Service','Dfareporting.php',6834],['lib/google/src/Google/Service','Dfareporting.php',6912],['lib/google/src/Google/Service','Dfareporting.php',7077],['lib/google/src/Google/Service','Dfareporting.php',7476],['lib/google/src/Google/Service','Dfareporting.php',7594],['lib/google/src/Google/Service','Dfareporting.php',7744],['lib/google/src/Google/Service','Dfareporting.php',7968],['lib/google/src/Google/Service','Dfareporting.php',8075],['lib/google/src/Google/Service','Dfareporting.php',8202],['lib/google/src/Google/Service','Dfareporting.php',8394],['lib/google/src/Google/Service','Dfareporting.php',8557],['lib/google/src/Google/Service','Dfareporting.php',8861],['lib/horde/framework/Horde/Imap/Client/Ids','Map.php',72]], 498],
'get_field': ['get_field', 'Gets an instance of the form field. ', [['lib/behat','behat_field_manager.php',248],['mod/quiz/report/statistics/classes','calculated.php',109],['lib/dml','moodle_database.php',1546],['user/filters','lib.php',124]], 536],
'get_manager': ['get_manager', 'Returns the sql generator used for db manipulation. Used mostly in upgrade.php scripts. ', [['lib/dml','moodle_database.php',1080]], 229],
'upgrade_course_letter_boundary': ['upgrade_course_letter_boundary', 'Marks all courses that require rounded grade items be updated. ', [['lib/db','upgradelib.php',361]], 8],
'xmldb_main_upgrade': ['xmldb_main_upgrade', 'Main upgrade tasks to be executed on Moodle version bump ', [['lib/db','upgrade.php',45]], 1],
'change_field_precision': ['change_field_precision', 'This function will change the precision of the field in the table passed as arguments ', [['lib/ddl','database_manager.php',598]], 14],
'add_index': ['add_index', 'This function will add one new index to the table with all its attributes defined ', [['lib/xmldb','xmldb_table.php',802],['lib/ddl','database_manager.php',802]], 92],
'table_exists': ['table_exists', 'Given one xmldb_table, checks if it exists in DB (true/false). ', [['lib/ddl','sql_generator.php',215],['lib/ddl','database_manager.php',90]], 131],
'upgrade_main_savepoint': ['upgrade_main_savepoint', 'Upgrade savepoint, marks end of each upgrade block. It stores new main version, resets upgrade timeout and abort upgrade if user cancels page loading. ', [['lib','upgradelib.php',189]], 97],
'upgrade_set_timeout': ['upgrade_set_timeout', 'Sets maximum expected time needed for upgrade task. Please always make sure that upgrade will not run longer! ', [['lib','upgradelib.php',140]], 8],
'drop_index': ['drop_index', 'This function will drop the index in the table passed as arguments Before dropping the index, the function will check it exists ', [['lib/ddl','database_manager.php',829]], 16],
'upgrade_group_members_only': ['upgrade_group_members_only', 'Using data for a single course-module that has groupmembersonly enabled, returns the new availability value that incorporates the correct groupmembersonly option. ', [['lib/db','upgradelib.php',79]], 2],
'get_record': ['get_record', 'Load a single record. ', [['competency/classes','persistent.php',738],['lib/dml','moodle_database.php',1462]], 3224],
'get_records': ['get_records', 'Load a list of records. ', [['competency/classes','persistent.php',709],['mod/glossary/classes','entry_query_builder.php',295],['lib/dml','moodle_database.php',1285],['lib','coursecatlib.php',651],['question','category_class.php',63]], 965],
'instance': ['instance', 'Returns an instance of the cache_factor method. ', [['cache','disabledlib.php',171],['cache','disabledlib.php',296],['lib/classes','useragent.php',101],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',80],['lib/htmlpurifier/HTMLPurifier','URISchemeRegistry.php',9],['search/classes','manager.php',109],['cache','locallib.php',52],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',53],['lib/classes','plugin_manager.php',103],['lib/htmlpurifier','HTMLPurifier.php',251],['course/format','lib.php',156],['lib/classes/update','checker.php',62],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',31],['admin/tool/installaddon/classes','installer.php',40],['lib','modinfolib.php',373],['cache/classes','helper.php',76],['lib/tests','string_manager_standard_test.php',124],['lib/portfolio','exporter.php',251],['lib/classes/update','validator.php',88],['search/classes','document_factory.php',49],['lib','accesslib.php',6235],['lib','accesslib.php',6487],['lib','accesslib.php',6665],['lib','accesslib.php',6919],['lib','accesslib.php',7180],['lib','accesslib.php',7392],['backup/cc/cc_lib','cc_utils.php',387],['backup/cc/cc_lib','cc_utils.php',443],['lib','filterlib.php',80],['search/tests/fixtures','testable_core_search.php',43],['lib/tests/fixtures','testable_update_checker.php',45],['backup/cc','validator.php',35],['cache/classes','config.php',87],['cache/classes','factory.php',114],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',29]], 4647],
'field_exists': ['field_exists', 'Given one xmldb_field, check if it exists in DB (true/false). ', [['lib/ddl','database_manager.php',128]], 111],
'upper': ['upper', 'Makes a string uppercase. ', [['lib/horde/framework/Horde','String.php',203]], 33],
'upgrade_extra_credit_weightoverride': ['upgrade_extra_credit_weightoverride', 'Marks all courses with changes in extra credit weight calculation ', [['lib/db','upgradelib.php',153]], 5],
'get_field_sql': ['get_field_sql', 'Get a single field value (first field) using a SQL statement. ', [['lib/dml','moodle_database.php',1588]], 138],
'capabilities_cleanup': ['capabilities_cleanup', 'Deletes cached capabilities that are no longer needed by the component. Also unassigns these capabilities from any roles that have them. NOTE: this function is called from lib/db/upgrade.php ', [['lib','accesslib.php',2812]], 4],
'delete_records_select': ['delete_records_select', '', [['lib/dml','pdo_moodle_database.php',208],['lib/dml','oci_native_moodle_database.php',1495],['lib/dml','pgsql_native_moodle_database.php',1162],['lib/dml','mssql_native_moodle_database.php',1146],['lib/dml','mysqli_native_moodle_database.php',1477],['lib/dml','sqlsrv_native_moodle_database.php',1220],['lib/dml/tests','dml_test.php',5553]], 163],
'get_columns': ['get_columns', 'Returns detailed information about columns in table. This information is cached internally. ', [['lib/dml','oci_native_moodle_database.php',464],['lib','csvlib.class.php',190],['lib/dml','sqlite3_pdo_moodle_database.php',195],['lib/dml','pgsql_native_moodle_database.php',353],['lib/dml','mssql_native_moodle_database.php',432],['lib/dml','mysqli_native_moodle_database.php',572],['lib/dml','sqlsrv_native_moodle_database.php',503],['lib/dml/tests','dml_test.php',5538]], 107],
'drop_key': ['drop_key', 'This function will drop the key in the table passed as arguments ', [['lib/ddl','database_manager.php',759]], 4],
'fulldelete': ['fulldelete', 'Recursively delete the file or folder with path $location. That is, if it is a file delete it. If it is a folder, delete all its content then delete it. If $location does not exist to start, that is not considered an error. ', [['lib','filelib.php',2370]], 39],
'index_exists': ['index_exists', 'Given one xmldb_index, check if it exists in DB (true/false). ', [['lib/ddl','database_manager.php',214]], 44],
'upgrade_fix_missing_root_folders_draft': ['upgrade_fix_missing_root_folders_draft', 'Detect draft file areas with missing root directory records and add them. ', [['lib','upgradelib.php',2041]], 2],
'close': ['close', 'Close archive, write changes to disk. ', [['lib/filestorage','zip_archive.php',183],['lib/dml','mssql_native_moodle_recordset.php',87],['auth/fc','fcFPP.php',78],['lib/dml','mysqli_native_moodle_recordset.php',86],['lib/spout/src/Spout/Reader','ReaderInterface.php',30],['lib/spout/src/Spout/Writer/ODS/Internal','Workbook.php',81],['lib/dml','pdo_moodle_recordset.php',79],['lib','csvlib.class.php',256],['lib/horde/framework/Horde/Socket','Client.php',135],['backup/util/helper','backup_null_iterator.class.php',53],['admin/tool/uploaduser','locallib.php',149],['lib/tcpdf','tcpdf.php',2943],['lib/phpunit/classes','phpmailer_sink.php',41],['lib/phpmailer','class.smtp.php',582],['lib/dml','sqlsrv_native_moodle_recordset.php',133],['lib/classes/dml','recordset_walk.php',153],['lib/spout/src/Spout/Writer/XLSX/Helper','SharedStringsHelper.php',84],['grade/export','lib.php',689],['lib','excellib.class.php',93],['backup/util/loggers','file_logger.class.php',69],['grade','lib.php',324],['backup/util/helper','backup_array_iterator.class.php',63],['lib/horde/framework/Horde/Imap/Client','Base.php',1846],['mod/assign/feedback/offline','importgradeslib.php',204],['lib/dml','oci_native_moodle_recordset.php',80],['lib/adodb','adodb.inc.php',2361],['lib/adodb','adodb.inc.php',3090],['lib/adodb','adodb.inc.php',3870],['lib/google/src/Google/Logger','File.php',132],['lib/phpunit/classes','event_sink.php',39],['lib/horde/framework/Horde','Stream.php',585],['backup/util/loggers','base_logger.class.php',89],['lib/phpexcel/PHPExcel/Shared','ZipArchive.php',71],['question/engine/tests','helpers.php',1241],['lib/spout/src/Spout/Writer','AbstractWriter.php',312],['lib','odslib.class.php',71],['lib/spout/src/Spout/Writer/Common/Internal','WorksheetInterface.php',34],['lib/spout/src/Spout/Writer/ODS/Internal','Worksheet.php',214],['lib/spout/src/Spout/Writer','WriterInterface.php',84],['lib/spout/src/Spout/Writer/XLSX/Internal','Worksheet.php',174],['lib/spout/src/Spout/Reader','AbstractReader.php',183],['lib/phpunit/classes','message_sink.php',39],['lib/spout/src/Spout/Writer/Common/Internal','WorkbookInterface.php',65],['lib/spout/src/Spout/Writer/XLSX/Internal','Workbook.php',95],['lib/pear/Net','GeoIP.php',556],['lib/tests','completionlib_test.php',907],['lib/pear/Auth','RADIUS.php',550],['lib/pear/Auth','RADIUS.php',710],['lib/pear/Auth','RADIUS.php',829],['lib','webdavlib.php',176],['lib/dml','pgsql_native_moodle_recordset.php',107]], 1128],
'add_field': ['add_field', 'Add a field to select. ', [['mod/glossary/classes','entry_query_builder.php',99],['lib/xmldb','xmldb_table.php',766],['lib/ddl','database_manager.php',522]], 775],
'delete_records': ['delete_records', 'Delete the records from a table where all the given conditions met. If conditions not specified, table is truncated. ', [['lib/dml','sqlite3_pdo_moodle_database.php',345],['lib/dml','moodle_database.php',1864]], 773],
'list': ['list', '', [['mod/data/preset/imagegallery','jstemplate.js',9]], 2229],
'drop_table': ['drop_table', 'This function will drop the table passed as argument and all the associated objects (keys, indexes, constraints, sequences, triggers) will be dropped too. ', [['lib/ddl','database_manager.php',315]], 60],
'upgrade_calculated_grade_items': ['upgrade_calculated_grade_items', 'Marks all courses that require calculated grade items be updated. ', [['lib/db','upgradelib.php',188]], 5],
'set_config': ['set_config', 'Set a key in global configuration ', [['lib','moodlelib.php',1336],['lib','enrollib.php',1153],['lib/editor/tinymce/classes','plugin.php',84],['mod/assign','assignmentplugin.php',314],['lib/portfolio','plugin.php',515]], 1119],
'upgrade_mimetypes': ['upgrade_mimetypes', 'Updates the mime-types for files that exist in the database, based on their file extension. ', [['lib/db','upgradelib.php',133]], 2],
'change_field_type': ['change_field_type', 'This function will change the type of the field in the table passed as arguments ', [['lib/ddl','database_manager.php',573]], 19],
'set_field_select': ['set_field_select', 'Set a single field in every table row where the select statement evaluates to true. ', [['lib/dml','pdo_moodle_database.php',492],['lib/dml','oci_native_moodle_database.php',1436],['lib/dml','pgsql_native_moodle_database.php',1121],['lib/dml','mssql_native_moodle_database.php',1097],['lib/dml','mysqli_native_moodle_database.php',1435],['lib/dml','sqlsrv_native_moodle_database.php',1178],['lib/dml/tests','dml_test.php',5552]], 67],
'get_recordset': ['get_recordset', 'Get the recordset. ', [['mod/glossary/classes','entry_query_builder.php',305],['lib/dml','moodle_database.php',1162]], 92],
'get_records_sql': ['get_records_sql', 'Get a number of records as an array of objects. ', [['lib/dml','pdo_moodle_database.php',309],['lib/dml','oci_native_moodle_database.php',1145],['lib/dml','pgsql_native_moodle_database.php',732],['lib/dml','mssql_native_moodle_database.php',805],['lib/dml','mysqli_native_moodle_database.php',1057],['lib/dml','sqlsrv_native_moodle_database.php',890],['lib/dml/tests','dml_test.php',5545]], 700],
'add_key': ['add_key', 'This function will add one new key to the table with all its attributes defined ', [['lib/xmldb','xmldb_table.php',787],['lib/ddl','database_manager.php',739]], 207],
'update_record': ['update_record', 'Update a record in a table ', [['lib/dml','pdo_moodle_database.php',461],['lib/dml','oci_native_moodle_database.php',1404],['lib/dml','pgsql_native_moodle_database.php',1089],['lib/dml','mssql_native_moodle_database.php',1067],['lib/dml','mysqli_native_moodle_database.php',1405],['lib/dml','sqlsrv_native_moodle_database.php',1148],['lib/dml/tests','dml_test.php',5551]], 650],
'make_competence_scale': ['make_competence_scale', 'Create another default scale. ', [['lib/db','upgradelib.php',339]], 2],
'create_table': ['create_table', 'This function will create the table passed as argument with all its fields/keys/indexes/sequences, everything based in the XMLDB object ', [['lib/ddl','database_manager.php',428]], 158],
'count_records_select': ['count_records_select', 'Count a list of records. ', [['competency/classes','persistent.php',828],['lib/dml','moodle_database.php',1779]], 73],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required, Some conversions and safety checks are carried out. Lobs are supported. If the return ID isn\'t required, then this just reports success as true/false. $data is an object containing needed data ', [['lib/dml','pdo_moodle_database.php',387],['lib/dml','oci_native_moodle_database.php',1297],['lib/dml','pgsql_native_moodle_database.php',889],['lib/dml','mssql_native_moodle_database.php',962],['lib/dml','mysqli_native_moodle_database.php',1185],['question/engine/upgrade','upgradelib.php',124],['lib/dml','sqlsrv_native_moodle_database.php',1045],['lib/dml/tests','dml_test.php',5548]], 1611],
'change_field_notnull': ['change_field_notnull', 'This function will change the nullability of the field in the table passed as arguments ', [['lib/ddl','database_manager.php',623]], 5],
'upgrade_minmaxgrade': ['upgrade_minmaxgrade', 'Upgrade the minmaxgrade setting. ', [['lib','upgradelib.php',2145]], 5],
'count_records': ['count_records', 'Count a list of records. ', [['competency/classes','persistent.php',815],['mod/glossary/classes','entry_query_builder.php',152],['lib/dml','moodle_database.php',1766]], 1630],
'check_dir_exists': ['check_dir_exists', 'Function to check if a directory exists and by default create it if not exists. ', [['lib','setuplib.php',1430]], 46],
'unset_all_config_for_plugin': ['unset_all_config_for_plugin', 'Remove all the config variables for a given plugin. ', [['lib','moodlelib.php',1528]], 8],
'start_delegated_transaction': ['start_delegated_transaction', 'On DBs that support it, switch to transaction mode and begin a transaction you\'ll need to ensure you call allow_commit() on the returned object or your changes *will* be lost. ', [['lib/dml','moodle_database.php',2393]], 145],
'get_recordset_select': ['get_recordset_select', 'Get a number of records as a moodle_recordset which match a particular WHERE clause. ', [['lib/dml','moodle_database.php',1224]], 45],
'set_field': ['set_field', 'Set a single field in every table record where all the given conditions met. ', [['lib/dml','moodle_database.php',1737],['availability/condition/profile/tests','condition_test.php',349]], 485],
'get_config': ['get_config', 'Config get method. ', [['lib/classes/antivirus','scanner.php',54],['competency/classes','competency_rule.php',59],['question/engine','bank.php',109],['admin/tool/log/classes/helper','store.php',63],['lib','moodlelib.php',1409],['lib','enrollib.php',1142],['lib/editor/tinymce/classes','plugin.php',73],['competency/classes','competency_rule_points.php',43],['search/classes','base.php',169],['mod/assign','assignmentplugin.php',345],['lib/portfolio','plugin.php',546]], 934],
'allow_commit': ['allow_commit', 'Commit delegated transaction. The real database commit SQL is executed only after committing all delegated transactions. ', [['lib/dml','moodle_transaction.php',78]], 135],
'preg_replace': ['preg_replace', '', [], 917],
'is_dir': ['is_dir', '', [], 211],
'array_merge': ['array_merge', '', [], 2944],
'file_exists': ['file_exists', '', [], 867],
'str_replace': ['str_replace', '', [], 1648],
'strpos': ['strpos', '', [], 1604],
'defined': ['defined', '', [], 4731]};
CLASS_DATA={
'progress_bar': ['progress_bar', 'Progress bar class. ', [['lib','weblib.php',3157]], 9],
'xmldb_field': ['xmldb_field', '', [['lib/xmldb','xmldb_field.php',29]], 156],
'context_system': ['context_system', 'System context class ', [['lib','accesslib.php',6157]], 1147],
'xmldb_key': ['xmldb_key', '', [['lib/xmldb','xmldb_key.php',29]], 18],
'xmldb_index': ['xmldb_index', '', [['lib/xmldb','xmldb_index.php',29]], 54],
'xmldb_table': ['xmldb_table', '', [['lib/xmldb','xmldb_table.php',29]], 230]};
CONST_DATA={
'XMLDB_INDEX_UNIQUE': ['XMLDB_INDEX_UNIQUE', '', [['lib/xmldb','xmldb_constants.php',82]], 36],
'XMLDB_NOTNULL': ['XMLDB_NOTNULL', '', [['lib/xmldb','xmldb_constants.php',78]], 573],
'XMLDB_KEY_UNIQUE': ['XMLDB_KEY_UNIQUE', '', [['lib/xmldb','xmldb_constants.php',66]], 31],
'XMLDB_KEY_PRIMARY': ['XMLDB_KEY_PRIMARY', '', [['lib/xmldb','xmldb_constants.php',64]], 189],
'IGNORE_MULTIPLE': ['IGNORE_MULTIPLE', '', [['lib','dmllib.php',50]], 43],
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',140],['','install.php',93],['lib','setup.php',391]], 4153],
'XMLDB_TYPE_INTEGER': ['XMLDB_TYPE_INTEGER', '', [['lib/xmldb','xmldb_constants.php',44]], 583],
'XMLDB_KEY_FOREIGN_UNIQUE': ['XMLDB_KEY_FOREIGN_UNIQUE', '', [['lib/xmldb','xmldb_constants.php',72]], 37],
'XMLDB_TYPE_CHAR': ['XMLDB_TYPE_CHAR', '', [['lib/xmldb','xmldb_constants.php',50]], 181],
'XMLDB_INDEX_NOTUNIQUE': ['XMLDB_INDEX_NOTUNIQUE', '', [['lib/xmldb','xmldb_constants.php',84]], 72],
'XMLDB_TYPE_TEXT': ['XMLDB_TYPE_TEXT', '', [['lib/xmldb','xmldb_constants.php',52]], 107],
'XMLDB_SEQUENCE': ['XMLDB_SEQUENCE', '', [['lib/xmldb','xmldb_constants.php',80]], 167],
'SQL_PARAMS_NAMED': ['SQL_PARAMS_NAMED', '', [['lib/dml','moodle_database.php',32]], 315],
'XMLDB_KEY_FOREIGN': ['XMLDB_KEY_FOREIGN', '', [['lib/xmldb','xmldb_constants.php',68]], 64],
'XMLDB_TYPE_NUMBER': ['XMLDB_TYPE_NUMBER', '', [['lib/xmldb','xmldb_constants.php',46]], 66]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Aug 11 10:00:09 2016</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
