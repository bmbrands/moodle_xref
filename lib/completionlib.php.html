<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : Detail view of completionlib.php</title>
    <link rel="stylesheet" href="../sample.css" type="text/css">
    <link rel="stylesheet" href="../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu May 28 19:17:31 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../';
subdir='lib';
filename='completionlib.php.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="details-heading"><a href="./index.html">/lib/</a> -> <a href="completionlib.php.source.html">completionlib.php</a> (summary)</h2>
<div class="details-summary">
<p class="viewlinks">[<a href="completionlib.php.source.html">Source view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="../_stats.html">Project Stats</a>]</p>
<p><b>Contains classes, functions and constants used during the tracking of activity completion for users. Completion top-level options (admin setting enablecompletion)</b></p>
<table>
<tr><td align="right">Copyright: </td><td>1999 onwards Martin Dougiamas   {@link http://moodle.com}</td></tr>
<tr><td align="right">License: </td><td><a href="http://www.gnu.org/copyleft/gpl.html" target="_blank">http://www.gnu.org/copyleft/gpl.html</a> GNU GPL v3 or later</td></tr>
<tr><td align="right">File Size: </td><td>1332 lines (48 kb)</td></tr>
<tr><td align="right">Included or required:</td><td>0 times</td></tr>
<tr><td align="right" valign="top">Referenced: </td><td>0 times</td></tr>
<tr><td align="right" valign="top">Includes or requires: </td><td>0 files</td></tr>
</table>
<h3>Defines 1 class</h3>
<div class="inset">
<p><b>completion_info::</b> (37 methods):<br>
&nbsp;&nbsp;<a href="#get_aggregation_methods">get_aggregation_methods</a>()<br>
&nbsp;&nbsp;<a href="#__construct">__construct</a>()<br>
&nbsp;&nbsp;<a href="#is_enabled_for_site">is_enabled_for_site</a>()<br>
&nbsp;&nbsp;<a href="#is_enabled">is_enabled</a>()<br>
&nbsp;&nbsp;<a href="#print_help_icon">print_help_icon</a>()<br>
&nbsp;&nbsp;<a href="#display_help_icon">display_help_icon</a>()<br>
&nbsp;&nbsp;<a href="#get_completion">get_completion</a>()<br>
&nbsp;&nbsp;<a href="#get_completions">get_completions</a>()<br>
&nbsp;&nbsp;<a href="#get_user_completion">get_user_completion</a>()<br>
&nbsp;&nbsp;<a href="#has_criteria">has_criteria</a>()<br>
&nbsp;&nbsp;<a href="#get_criteria">get_criteria</a>()<br>
&nbsp;&nbsp;<a href="#get_aggregation_method">get_aggregation_method</a>()<br>
&nbsp;&nbsp;<a href="#get_incomplete_criteria">get_incomplete_criteria</a>()<br>
&nbsp;&nbsp;<a href="#clear_criteria">clear_criteria</a>()<br>
&nbsp;&nbsp;<a href="#is_course_complete">is_course_complete</a>()<br>
&nbsp;&nbsp;<a href="#update_state">update_state</a>()<br>
&nbsp;&nbsp;<a href="#internal_get_state">internal_get_state</a>()<br>
&nbsp;&nbsp;<a href="#set_module_viewed">set_module_viewed</a>()<br>
&nbsp;&nbsp;<a href="#count_user_data">count_user_data</a>()<br>
&nbsp;&nbsp;<a href="#count_course_user_data">count_course_user_data</a>()<br>
&nbsp;&nbsp;<a href="#is_course_locked">is_course_locked</a>()<br>
&nbsp;&nbsp;<a href="#delete_course_completion_data">delete_course_completion_data</a>()<br>
&nbsp;&nbsp;<a href="#delete_all_completion_data">delete_all_completion_data</a>()<br>
&nbsp;&nbsp;<a href="#delete_all_state">delete_all_state</a>()<br>
&nbsp;&nbsp;<a href="#reset_all_state">reset_all_state</a>()<br>
&nbsp;&nbsp;<a href="#get_data">get_data</a>()<br>
&nbsp;&nbsp;<a href="#internal_set_data">internal_set_data</a>()<br>
&nbsp;&nbsp;<a href="#has_activities">has_activities</a>()<br>
&nbsp;&nbsp;<a href="#get_activities">get_activities</a>()<br>
&nbsp;&nbsp;<a href="#is_tracked_user">is_tracked_user</a>()<br>
&nbsp;&nbsp;<a href="#get_num_tracked_users">get_num_tracked_users</a>()<br>
&nbsp;&nbsp;<a href="#get_tracked_users">get_tracked_users</a>()<br>
&nbsp;&nbsp;<a href="#get_progress_all">get_progress_all</a>()<br>
&nbsp;&nbsp;<a href="#inform_grade_changed">inform_grade_changed</a>()<br>
&nbsp;&nbsp;<a href="#internal_get_grade_state">internal_get_grade_state</a>()<br>
&nbsp;&nbsp;<a href="#aggregate_completion_states">aggregate_completion_states</a>()<br>
&nbsp;&nbsp;<a href="#internal_systemerror">internal_systemerror</a>()<br>
</p>
</div>
<h3>Defines 37 functions</h3>
<div class="inset">
&nbsp;&nbsp;<a href="#completion_can_view_data">completion_can_view_data</a>()<br>
</div>
</div>
<br><div class="details-funclist">
<div class="details-classinfo">
<p class="details-classtitle">Class: <a name="completion_info"><b>completion_info</b></a>&nbsp;&nbsp;- <a href="../_classes/completion_info.html"><small>X-Ref</small></a>
</p>
<b>Class represents completion information for a course.<BR>
</b><br>
Does not contain any data, so you can safely construct it multiple times<BR>
without causing any problems.<BR>
<BR>
<div class="inset"><table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="get_aggregation_methods" onClick="logFunction('get_aggregation_methods', 'completionlib.php.source.html#l232')" href="completionlib.php.source.html#l232">get_aggregation_methods</a>()&nbsp;&nbsp;
<a href="../_functions/get_aggregation_methods.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Return array of aggregation methods<BR>
</b><BR><b>return:</b> array<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="__construct" onClick="logFunction('__construct', 'completionlib.php.source.html#l243')" href="completionlib.php.source.html#l243">__construct</a>(<a href="../_variables/course.html">$course</a>)&nbsp;&nbsp;
<a href="../_functions/__construct.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Constructs with course details.<BR>
</b><BR>When instantiating a new completion info object you must provide a course<BR>
object with at least id, and enablecompletion properties. Property<BR>
cacherev is needed if you check completion of the current user since<BR>
it is used for cache validation.<BR>
<BR>
<b>param:</b> stdClass $course Moodle course object.<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="is_enabled_for_site" onClick="logFunction('is_enabled_for_site', 'completionlib.php.source.html#l258')" href="completionlib.php.source.html#l258">is_enabled_for_site</a>()&nbsp;&nbsp;
<a href="../_functions/is_enabled_for_site.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Determines whether completion is enabled across entire site.<BR>
</b><BR><b>return:</b> bool COMPLETION_ENABLED (true) if completion is enabled for the site,<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="is_enabled" onClick="logFunction('is_enabled', 'completionlib.php.source.html#l269')" href="completionlib.php.source.html#l269">is_enabled</a>(<a href="../_variables/cm.html">$cm</a> = null)&nbsp;&nbsp;
<a href="../_functions/is_enabled.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Checks whether completion is enabled in a particular course and possibly<BR>
activity.<BR>
</b><BR><b>param:</b> stdClass|cm_info $cm Course-module object. If not specified, returns the course<br>
<b>return:</b> mixed COMPLETION_ENABLED or COMPLETION_DISABLED (==0) in the case of<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="print_help_icon" onClick="logFunction('print_help_icon', 'completionlib.php.source.html#l306')" href="completionlib.php.source.html#l306">print_help_icon</a>()&nbsp;&nbsp;
<a href="../_functions/print_help_icon.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Displays the 'Your progress' help icon, if completion tracking is enabled.<BR>
Just prints the result of display_help_icon().<BR>
</b><BR></td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="display_help_icon" onClick="logFunction('display_help_icon', 'completionlib.php.source.html#l316')" href="completionlib.php.source.html#l316">display_help_icon</a>()&nbsp;&nbsp;
<a href="../_functions/display_help_icon.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Returns the 'Your progress' help icon, if completion tracking is enabled.<BR>
</b><BR><b>return:</b> string HTML code for help icon, or blank if not needed<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="get_completion" onClick="logFunction('get_completion', 'completionlib.php.source.html#l332')" href="completionlib.php.source.html#l332">get_completion</a>(<a href="../_variables/user_id.html">$user_id</a>, <a href="../_variables/criteriatype.html">$criteriatype</a>)&nbsp;&nbsp;
<a href="../_functions/get_completion.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Get a course completion for a user<BR>
</b><BR><b>param:</b> int $user_id User id<br>
<b>param:</b> int $criteriatype Specific criteria type to return<br>
<b>return:</b> bool|completion_criteria_completion returns false on fail<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="get_completions" onClick="logFunction('get_completions', 'completionlib.php.source.html#l351')" href="completionlib.php.source.html#l351">get_completions</a>(<a href="../_variables/user_id.html">$user_id</a>, <a href="../_variables/criteriatype.html">$criteriatype</a> = null)&nbsp;&nbsp;
<a href="../_functions/get_completions.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Get all course criteria's completion objects for a user<BR>
</b><BR><b>param:</b> int $user_id User id<br>
<b>param:</b> int $criteriatype Specific criteria type to return (optional)<br>
<b>return:</b> array<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="get_user_completion" onClick="logFunction('get_user_completion', 'completionlib.php.source.html#l379')" href="completionlib.php.source.html#l379">get_user_completion</a>(<a href="../_variables/user_id.html">$user_id</a>, <a href="../_variables/criteria.html">$criteria</a>)&nbsp;&nbsp;
<a href="../_functions/get_user_completion.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Get completion object for a user and a criteria<BR>
</b><BR><b>param:</b> int $user_id User id<br>
<b>param:</b> completion_criteria $criteria Criteria object<br>
<b>return:</b> completion_criteria_completion<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="has_criteria" onClick="logFunction('has_criteria', 'completionlib.php.source.html#l397')" href="completionlib.php.source.html#l397">has_criteria</a>()&nbsp;&nbsp;
<a href="../_functions/has_criteria.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Check if course has completion criteria set<BR>
</b><BR><b>return:</b> bool Returns true if there are criteria<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="get_criteria" onClick="logFunction('get_criteria', 'completionlib.php.source.html#l408')" href="completionlib.php.source.html#l408">get_criteria</a>(<a href="../_variables/criteriatype.html">$criteriatype</a> = null)&nbsp;&nbsp;
<a href="../_functions/get_criteria.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Get course completion criteria<BR>
</b><BR><b>param:</b> int $criteriatype Specific criteria type to return (optional)<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="get_aggregation_method" onClick="logFunction('get_aggregation_method', 'completionlib.php.source.html#l452')" href="completionlib.php.source.html#l452">get_aggregation_method</a>(<a href="../_variables/criteriatype.html">$criteriatype</a> = null)&nbsp;&nbsp;
<a href="../_functions/get_aggregation_method.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Get aggregation method<BR>
</b><BR><b>param:</b> int $criteriatype If none supplied, get overall aggregation method (optional)<br>
<b>return:</b> int One of COMPLETION_AGGREGATION_ALL or COMPLETION_AGGREGATION_ANY<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="get_incomplete_criteria" onClick="logFunction('get_incomplete_criteria', 'completionlib.php.source.html#l473')" href="completionlib.php.source.html#l473">get_incomplete_criteria</a>()&nbsp;&nbsp;
<a href="../_functions/get_incomplete_criteria.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Get incomplete course completion criteria<BR>
</b><BR><b>return:</b> array<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="clear_criteria" onClick="logFunction('clear_criteria', 'completionlib.php.source.html#l493')" href="completionlib.php.source.html#l493">clear_criteria</a>()&nbsp;&nbsp;
<a href="../_functions/clear_criteria.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Clear old course completion criteria<BR>
</b><BR></td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="is_course_complete" onClick="logFunction('is_course_complete', 'completionlib.php.source.html#l504')" href="completionlib.php.source.html#l504">is_course_complete</a>(<a href="../_variables/user_id.html">$user_id</a>)&nbsp;&nbsp;
<a href="../_functions/is_course_complete.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Has the supplied user completed this course<BR>
</b><BR><b>param:</b> int $user_id User's id<br>
<b>return:</b> boolean<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="update_state" onClick="logFunction('update_state', 'completionlib.php.source.html#l520')" href="completionlib.php.source.html#l520">update_state</a>(<a href="../_variables/cm.html">$cm</a>, <a href="../_variables/possibleresult.html">$possibleresult</a>=COMPLETION_UNKNOWN, <a href="../_variables/userid.html">$userid</a>=0)&nbsp;&nbsp;
<a href="../_functions/update_state.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Updates (if necessary) the completion state of activity $cm for the given<BR>
user.<BR>
</b><BR>For manual completion, this function is called when completion is toggled<BR>
with $possibleresult set to the target state.<BR>
<BR>
For automatic completion, this function should be called every time a module<BR>
does something which might influence a user's completion state. For example,<BR>
if a forum provides options for marking itself 'completed' once a user makes<BR>
N posts, this function should be called every time a user makes a new post.<BR>
[After the post has been saved to the database]. When calling, you do not<BR>
need to pass in the new completion state. Instead this function carries out<BR>
completion calculation by checking grades and viewed state itself, and<BR>
calling the involved module via modulename_get_completion_state() to check<BR>
module-specific conditions.<BR>
<BR>
<b>param:</b> stdClass|cm_info $cm Course-module<br>
<b>param:</b> int $possibleresult Expected completion result. If the event that<br>
<b>param:</b> int $userid User ID to be updated. Default 0 = current user<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="internal_get_state" onClick="logFunction('internal_get_state', 'completionlib.php.source.html#l594')" href="completionlib.php.source.html#l594">internal_get_state</a>(<a href="../_variables/cm.html">$cm</a>, <a href="../_variables/userid.html">$userid</a>, <a href="../_variables/current.html">$current</a>)&nbsp;&nbsp;
<a href="../_functions/internal_get_state.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Calculates the completion state for an activity and user.<BR>
</b><BR>Internal function. Not private, so we can unit-test it.<BR>
<BR>
<b>param:</b> stdClass|cm_info $cm Activity<br>
<b>param:</b> int $userid ID of user<br>
<b>param:</b> stdClass $current Previous completion information from database<br>
<b>return:</b> mixed<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="set_module_viewed" onClick="logFunction('set_module_viewed', 'completionlib.php.source.html#l670')" href="completionlib.php.source.html#l670">set_module_viewed</a>(<a href="../_variables/cm.html">$cm</a>, <a href="../_variables/userid.html">$userid</a>=0)&nbsp;&nbsp;
<a href="../_functions/set_module_viewed.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Marks a module as viewed.<BR>
</b><BR>Should be called whenever a module is 'viewed' (it is up to the module how to<BR>
determine that). Has no effect if viewing is not set as a completion condition.<BR>
<BR>
Note that this function must be called before you print the page header because<BR>
it is possible that the navigation block may depend on it. If you call it after<BR>
printing the header, it shows a developer debug warning.<BR>
<BR>
<b>param:</b> stdClass|cm_info $cm Activity<br>
<b>param:</b> int $userid User ID or 0 (default) for current user<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="count_user_data" onClick="logFunction('count_user_data', 'completionlib.php.source.html#l710')" href="completionlib.php.source.html#l710">count_user_data</a>(<a href="../_variables/cm.html">$cm</a>)&nbsp;&nbsp;
<a href="../_functions/count_user_data.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Determines how much completion data exists for an activity. This is used when<BR>
deciding whether completion information should be 'locked' in the module<BR>
editing form.<BR>
</b><BR><b>param:</b> cm_info $cm Activity<br>
<b>return:</b> int The number of users who have completion data stored for this<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="count_course_user_data" onClick="logFunction('count_course_user_data', 'completionlib.php.source.html#l731')" href="completionlib.php.source.html#l731">count_course_user_data</a>(<a href="../_variables/user_id.html">$user_id</a> = null)&nbsp;&nbsp;
<a href="../_functions/count_course_user_data.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Determines how much course completion data exists for a course. This is used when<BR>
deciding whether completion information should be 'locked' in the completion<BR>
settings form and activity completion settings.<BR>
</b><BR><b>param:</b> int $user_id Optionally only get course completion data for a single user<br>
<b>return:</b> int The number of users who have completion data stored for this<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="is_course_locked" onClick="logFunction('is_course_locked', 'completionlib.php.source.html#l763')" href="completionlib.php.source.html#l763">is_course_locked</a>()&nbsp;&nbsp;
<a href="../_functions/is_course_locked.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Check if this course's completion criteria should be locked<BR>
</b><BR><b>return:</b> boolean<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="delete_course_completion_data" onClick="logFunction('delete_course_completion_data', 'completionlib.php.source.html#l772')" href="completionlib.php.source.html#l772">delete_course_completion_data</a>()&nbsp;&nbsp;
<a href="../_functions/delete_course_completion_data.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Deletes all course completion completion data.<BR>
</b><BR>Intended to be used when unlocking completion criteria settings.<BR>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="delete_all_completion_data" onClick="logFunction('delete_all_completion_data', 'completionlib.php.source.html#l787')" href="completionlib.php.source.html#l787">delete_all_completion_data</a>()&nbsp;&nbsp;
<a href="../_functions/delete_all_completion_data.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Deletes all activity and course completion data for an entire course<BR>
(the below delete_all_state function does this for a single activity).<BR>
</b><BR>Used by course reset page.<BR>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="delete_all_state" onClick="logFunction('delete_all_state', 'completionlib.php.source.html#l805')" href="completionlib.php.source.html#l805">delete_all_state</a>(<a href="../_variables/cm.html">$cm</a>)&nbsp;&nbsp;
<a href="../_functions/delete_all_state.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Deletes completion state related to an activity for all users.<BR>
</b><BR>Intended for use only when the activity itself is deleted.<BR>
<BR>
<b>param:</b> stdClass|cm_info $cm Activity<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="reset_all_state" onClick="logFunction('reset_all_state', 'completionlib.php.source.html#l838')" href="completionlib.php.source.html#l838">reset_all_state</a>(<a href="../_variables/cm.html">$cm</a>)&nbsp;&nbsp;
<a href="../_functions/reset_all_state.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Recalculates completion state related to an activity for all users.<BR>
</b><BR>Intended for use if completion conditions change. (This should be avoided<BR>
as it may cause some things to become incomplete when they were previously<BR>
complete, with the effect - for example - of hiding a later activity that<BR>
was previously available.)<BR>
<BR>
Resetting state of manual tickbox has same result as deleting state for<BR>
it.<BR>
<BR>
<b>param:</b> stcClass|cm_info $cm Activity<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="get_data" onClick="logFunction('get_data', 'completionlib.php.source.html#l882')" href="completionlib.php.source.html#l882">get_data</a>(<a href="../_variables/cm.html">$cm</a>, <a href="../_variables/wholecourse.html">$wholecourse</a> = false, <a href="../_variables/userid.html">$userid</a> = 0, <a href="../_variables/modinfo.html">$modinfo</a> = null)&nbsp;&nbsp;
<a href="../_functions/get_data.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Obtains completion data for a particular activity and user (from the<BR>
completion cache if available, or by SQL query)<BR>
</b><BR><b>param:</b> stcClass|cm_info $cm Activity; only required field is -&gt;id<br>
<b>param:</b> bool $wholecourse If true (default false) then, when necessary to<br>
<b>param:</b> int $userid User ID or 0 (default) for current user<br>
<b>param:</b> array $modinfo Supply the value here - this is used for unit<br>
<b>return:</b> object Completion data (record from course_modules_completion)<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="internal_set_data" onClick="logFunction('internal_set_data', 'completionlib.php.source.html#l992')" href="completionlib.php.source.html#l992">internal_set_data</a>(<a href="../_variables/cm.html">$cm</a>, <a href="../_variables/data.html">$data</a>)&nbsp;&nbsp;
<a href="../_functions/internal_set_data.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Updates completion data for a particular coursemodule and user (user is<BR>
determined from $data).<BR>
</b><BR>(Internal function. Not private, so we can unit-test it.)<BR>
<BR>
<b>param:</b> stdClass|cm_info $cm Activity<br>
<b>param:</b> stdClass $data Data about completion for that user<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="has_activities" onClick="logFunction('has_activities', 'completionlib.php.source.html#l1052')" href="completionlib.php.source.html#l1052">has_activities</a>()&nbsp;&nbsp;
<a href="../_functions/has_activities.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Return whether or not the course has activities with completion enabled.<BR>
</b><BR><b>return:</b> boolean true when there is at least one activity with completion enabled.<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="get_activities" onClick="logFunction('get_activities', 'completionlib.php.source.html#l1067')" href="completionlib.php.source.html#l1067">get_activities</a>()&nbsp;&nbsp;
<a href="../_functions/get_activities.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Obtains a list of activities for which completion is enabled on the<BR>
course. The list is ordered by the section order of those activities.<BR>
</b><BR><b>return:</b> cm_info[] Array from $cmid =&gt; $cm of all activities with completion enabled,<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="is_tracked_user" onClick="logFunction('is_tracked_user', 'completionlib.php.source.html#l1085')" href="completionlib.php.source.html#l1085">is_tracked_user</a>(<a href="../_variables/userid.html">$userid</a>)&nbsp;&nbsp;
<a href="../_functions/is_tracked_user.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Checks to see if the userid supplied has a tracked role in<BR>
this course<BR>
</b><BR><b>param:</b> int $userid User id<br>
<b>return:</b> bool<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="get_num_tracked_users" onClick="logFunction('get_num_tracked_users', 'completionlib.php.source.html#l1096')" href="completionlib.php.source.html#l1096">get_num_tracked_users</a>(<a href="../_variables/where.html">$where</a> = '', <a href="../_variables/whereparams.html">$whereparams</a> = array()&nbsp;&nbsp;
<a href="../_functions/get_num_tracked_users.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Returns the number of users whose progress is tracked in this course.<BR>
</b><BR>Optionally supply a search's where clause, or a group id.<BR>
<BR>
<b>param:</b> string $where Where clause sql (use 'u.whatever' for user table fields)<br>
<b>param:</b> array $whereparams Where clause params<br>
<b>param:</b> int $groupid Group id<br>
<b>return:</b> int Number of tracked users<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="get_tracked_users" onClick="logFunction('get_tracked_users', 'completionlib.php.source.html#l1120')" href="completionlib.php.source.html#l1120">get_tracked_users</a>(<a href="../_variables/where.html">$where</a> = '', <a href="../_variables/whereparams.html">$whereparams</a> = array()&nbsp;&nbsp;
<a href="../_functions/get_tracked_users.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Return array of users whose progress is tracked in this course.<BR>
</b><BR>Optionally supply a search's where clause, group id, sorting, paging.<BR>
<BR>
<b>param:</b> string $where Where clause sql, referring to 'u.' fields (optional)<br>
<b>param:</b> array $whereparams Where clause params (optional)<br>
<b>param:</b> int $groupid Group ID to restrict to (optional)<br>
<b>param:</b> string $sort Order by clause (optional)<br>
<b>param:</b> int $limitfrom Result start (optional)<br>
<b>param:</b> int $limitnum Result max size (optional)<br>
<b>param:</b> context $extracontext If set, includes extra user information fields<br>
<b>return:</b> array Array of user objects with standard user fields<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="get_progress_all" onClick="logFunction('get_progress_all', 'completionlib.php.source.html#l1163')" href="completionlib.php.source.html#l1163">get_progress_all</a>(<a href="../_variables/where.html">$where</a> = '', <a href="../_variables/where_params.html">$where_params</a> = array()&nbsp;&nbsp;
<a href="../_functions/get_progress_all.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Obtains progress information across a course for all users on that course, or<BR>
for all users in a specific group. Intended for use when displaying progress.<BR>
</b><BR>This includes only users who, in course context, have one of the roles for<BR>
which progress is tracked (the gradebookroles admin option) and are enrolled in course.<BR>
<BR>
Users are included (in the first array) even if they do not have<BR>
completion progress for any course-module.<BR>
<BR>
<b>param:</b> bool $sortfirstname If true, sort by first name, otherwise sort by<br>
<b>param:</b> string $where Where clause sql (optional)<br>
<b>param:</b> array $where_params Where clause params (optional)<br>
<b>param:</b> int $groupid Group ID or 0 (default)/false for all groups<br>
<b>param:</b> int $pagesize Number of users to actually return (optional)<br>
<b>param:</b> int $start User to start at if paging (optional)<br>
<b>param:</b> context $extracontext If set, includes extra user information fields<br>
<b>return:</b> stdClass with -&gt;total and -&gt;start (same as $start) and -&gt;users;<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="inform_grade_changed" onClick="logFunction('inform_grade_changed', 'completionlib.php.source.html#l1227')" href="completionlib.php.source.html#l1227">inform_grade_changed</a>(<a href="../_variables/cm.html">$cm</a>, <a href="../_variables/item.html">$item</a>, <a href="../_variables/grade.html">$grade</a>, <a href="../_variables/deleted.html">$deleted</a>)&nbsp;&nbsp;
<a href="../_functions/inform_grade_changed.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Called by grade code to inform the completion system when a grade has<BR>
been changed. If the changed grade is used to determine completion for<BR>
the course-module, then the completion status will be updated.<BR>
</b><BR><b>param:</b> stdClass|cm_info $cm Course-module for item that owns grade<br>
<b>param:</b> grade_item $item Grade item<br>
<b>param:</b> stdClass $grade<br>
<b>param:</b> bool $deleted<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="internal_get_grade_state" onClick="logFunction('internal_get_grade_state', 'completionlib.php.source.html#l1260')" href="completionlib.php.source.html#l1260">internal_get_grade_state</a>(<a href="../_variables/item.html">$item</a>, <a href="../_variables/grade.html">$grade</a>)&nbsp;&nbsp;
<a href="../_functions/internal_get_grade_state.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Calculates the completion state that would result from a graded item<BR>
(where grade-based completion is turned on) based on the actual grade<BR>
and settings.<BR>
</b><BR>Internal function. Not private, so we can unit-test it.<BR>
<BR>
<b>param:</b> grade_item $item an instance of grade_item<br>
<b>param:</b> grade_grade $grade an instance of grade_grade<br>
<b>return:</b> int Completion state e.g. COMPLETION_INCOMPLETE<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="aggregate_completion_states" onClick="logFunction('aggregate_completion_states', 'completionlib.php.source.html#l1303')" href="completionlib.php.source.html#l1303">aggregate_completion_states</a>(<a href="../_variables/type.html">$type</a>, <a href="../_variables/old.html">$old</a>, <a href="../_variables/new.html">$new</a>)&nbsp;&nbsp;
<a href="../_functions/aggregate_completion_states.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Aggregate activity completion state<BR>
</b><BR><b>param:</b> int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$type&nbsp;&nbsp;&nbsp;Aggregation type (COMPLETION_* constant)<br>
<b>param:</b> bool&nbsp;&nbsp;&nbsp;&nbsp;$old&nbsp;&nbsp;&nbsp;&nbsp;Old state<br>
<b>param:</b> bool&nbsp;&nbsp;&nbsp;&nbsp;$new&nbsp;&nbsp;&nbsp;&nbsp;New state<br>
<b>return:</b> bool<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="internal_systemerror" onClick="logFunction('internal_systemerror', 'completionlib.php.source.html#l1319')" href="completionlib.php.source.html#l1319">internal_systemerror</a>(<a href="../_variables/error.html">$error</a>)&nbsp;&nbsp;
<a href="../_functions/internal_systemerror.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>This is to be used only for system errors (things that shouldn't happen)<BR>
and not user-level errors.<BR>
</b><BR><b>param:</b> string $error Error string (will not be displayed to user unless debugging is enabled)<br>
</td></tr></table>

<br>
</div>
</div>
<div class="details-classtitle"><a name="functions"><b>Functions</b></a></div>
<div class="details-classinfo">
Functions that are not part of a class:<br><br>
<div class="inset"><table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="completion_can_view_data" onClick="logFunction('completion_can_view_data', 'completionlib.php.source.html#l143')" href="completionlib.php.source.html#l143">completion_can_view_data</a>(<a href="../_variables/userid.html">$userid</a>, <a href="../_variables/course.html">$course</a> = null)&nbsp;&nbsp;
<a href="../_functions/completion_can_view_data.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Utility function for checking if the logged in user can view<BR>
another's completion data for a particular course<BR>
</b><BR><b>param:</b> int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$userid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Completion data's owner<br>
<b>param:</b> mixed&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$course&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Course object or Course ID (optional)<br>
<b>return:</b> boolean<br>
</td></tr></table>

<br>
</div></div>

</div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu May 28 19:17:31 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
