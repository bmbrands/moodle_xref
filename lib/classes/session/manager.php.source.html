<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /lib/classes/session/manager.php source</title>
    <link rel="stylesheet" href="../../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Aug 11 10:00:09 2016 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../../';
subdir='lib/classes/session';
filename='manager.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/lib/classes/session/</a> -> <a href="manager.php.html">manager.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="manager.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="manager.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * Session manager class.</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * @package    core</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @copyright  2013 Petr Skoda {@link http://skodak.org}</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> */</span>
<a name="l24"><span class="linenum">  24</span></a>  
<a name="l25"><span class="linenum">  25</span></a>  namespace core\session;
<a name="l26"><span class="linenum">  26</span></a>  
<a name="l27"><span class="linenum">  27</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../../../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die();
<a name="l28"><span class="linenum">  28</span></a>  
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment">/**</span>
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment"> * Session manager, this is the public Moodle API for sessions.</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment"> *</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> * Following PHP functions MUST NOT be used directly:</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> * - session_start() - not necessary, lib/setup.php starts session automatically,</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> *   use define('NO_MOODLE_COOKIE', true) if session not necessary.</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> * - session_write_close() - use \core\session\manager::write_close() instead.</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment"> * - session_destroy() - use require_logout() instead.</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment"> *</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment"> * @package    core</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="comment"> * @copyright  2013 Petr Skoda {@link http://skodak.org}</span>
<a name="l40"><span class="linenum">  40</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l41"><span class="linenum">  41</span></a>  <span class="comment"> */</span>
<a name="l42"><span class="linenum">  42</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('manager')" href="../../../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a> {
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment">    /** @var handler $handler active session handler instance */</span>
<a name="l44"><span class="linenum">  44</span></a>      protected static <a class="var it2691" onMouseOver="hilite(2691)" onMouseOut="lolite()" onClick="logVariable('handler')" href="../../../_variables/handler.html">$handler</a>;
<a name="l45"><span class="linenum">  45</span></a>  
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment">    /** @var bool $sessionactive Is the session active? */</span>
<a name="l47"><span class="linenum">  47</span></a>      protected static <a class="var it39832" onMouseOver="hilite(39832)" onMouseOut="lolite()" onClick="logVariable('sessionactive')" href="../../../_variables/sessionactive.html">$sessionactive</a> = null;
<a name="l48"><span class="linenum">  48</span></a>  
<a name="l49"><span class="linenum">  49</span></a>      <span class="comment">/**</span>
<a name="l50"><span class="linenum">  50</span></a>  <span class="comment">     * Start user session.</span>
<a name="l51"><span class="linenum">  51</span></a>  <span class="comment">     *</span>
<a name="l52"><span class="linenum">  52</span></a>  <span class="comment">     * Note: This is intended to be called only from lib/setup.php!</span>
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment">     */</span>
<a name="l54"><span class="linenum">  54</span></a>      public static function <a class="function" onClick="logFunction('start')" href="../../../_functions/start.html" onMouseOver="funcPopup(event,'start')">start</a>() {
<a name="l55"><span class="linenum">  55</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l56"><span class="linenum">  56</span></a>  
<a name="l57"><span class="linenum">  57</span></a>          if (isset(self::<a class="var it39832" onMouseOver="hilite(39832)" onMouseOut="lolite()" onClick="logVariable('sessionactive')" href="../../../_variables/sessionactive.html">$sessionactive</a>)) {
<a name="l58"><span class="linenum">  58</span></a>              <a class="function" onClick="logFunction('debugging')" href="../../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Session was already started!', <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../../../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l59"><span class="linenum">  59</span></a>              return;
<a name="l60"><span class="linenum">  60</span></a>          }
<a name="l61"><span class="linenum">  61</span></a>  
<a name="l62"><span class="linenum">  62</span></a>          self::<a class="function" onClick="logFunction('load_handler')" href="../../../_functions/load_handler.html" onMouseOver="funcPopup(event,'load_handler')">load_handler</a>();
<a name="l63"><span class="linenum">  63</span></a>  
<a name="l64"><span class="linenum">  64</span></a>  <span class="comment">        // Init the session handler only if everything initialised properly in lib/setup.php file</span>
<a name="l65"><span class="linenum">  65</span></a>  <span class="comment">        // and the session is actually required.</span>
<a name="l66"><span class="linenum">  66</span></a>          if (empty(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>) or empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('version')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/version.html">version</a>) or !<a class="phpfunction" onClick="logFunction('defined')" href="../../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('NO_MOODLE_COOKIES')" href="../../../_constants/NO_MOODLE_COOKIES.html" onMouseOver="constPopup(event,'NO_MOODLE_COOKIES')">NO_MOODLE_COOKIES</a>') or <a class="constant" onClick="logConstant('NO_MOODLE_COOKIES')" href="../../../_constants/NO_MOODLE_COOKIES.html" onMouseOver="constPopup(event,'NO_MOODLE_COOKIES')">NO_MOODLE_COOKIES</a> or <a class="constant" onClick="logConstant('CLI_SCRIPT')" href="../../../_constants/CLI_SCRIPT.html" onMouseOver="constPopup(event,'CLI_SCRIPT')">CLI_SCRIPT</a>) {
<a name="l67"><span class="linenum">  67</span></a>              self::<a class="var it39832" onMouseOver="hilite(39832)" onMouseOut="lolite()" onClick="logVariable('sessionactive')" href="../../../_variables/sessionactive.html">$sessionactive</a> = false;
<a name="l68"><span class="linenum">  68</span></a>              self::<a class="function" onClick="logFunction('init_empty_session')" href="../../../_functions/init_empty_session.html" onMouseOver="funcPopup(event,'init_empty_session')">init_empty_session</a>();
<a name="l69"><span class="linenum">  69</span></a>              return;
<a name="l70"><span class="linenum">  70</span></a>          }
<a name="l71"><span class="linenum">  71</span></a>  
<a name="l72"><span class="linenum">  72</span></a>          try {
<a name="l73"><span class="linenum">  73</span></a>              self::<a class="var it2691" onMouseOver="hilite(2691)" onMouseOut="lolite()" onClick="logVariable('handler')" href="../../../_variables/handler.html">$handler</a>-&gt;<a class="function" onClick="logFunction('init')" href="../../../_functions/init.html" onMouseOver="funcPopup(event,'init')">init</a>();
<a name="l74"><span class="linenum">  74</span></a>              self::<a class="function" onClick="logFunction('prepare_cookies')" href="../../../_functions/prepare_cookies.html" onMouseOver="funcPopup(event,'prepare_cookies')">prepare_cookies</a>();
<a name="l75"><span class="linenum">  75</span></a>              <a class="var it34857" onMouseOver="hilite(34857)" onMouseOut="lolite()" onClick="logVariable('isnewsession')" href="../../../_variables/isnewsession.html">$isnewsession</a> = empty(<a class="var it23946" onMouseOver="hilite(23946)" onMouseOut="lolite()" onClick="logVariable('_COOKIE')" href="../../../_variables/_COOKIE.html">$_COOKIE</a>[<a class="phpfunction" onClick="logFunction('session_name')" href="../../../_functions/session_name.html" onMouseOver="phpfuncPopup(event,'session_name')">session_name</a>()]);
<a name="l76"><span class="linenum">  76</span></a>  
<a name="l77"><span class="linenum">  77</span></a>              if (!self::<a class="var it2691" onMouseOver="hilite(2691)" onMouseOut="lolite()" onClick="logVariable('handler')" href="../../../_variables/handler.html">$handler</a>-&gt;<a class="function" onClick="logFunction('start')" href="../../../_functions/start.html" onMouseOver="funcPopup(event,'start')">start</a>()) {
<a name="l78"><span class="linenum">  78</span></a>  <span class="comment">                // Could not successfully start/recover session.</span>
<a name="l79"><span class="linenum">  79</span></a>                  throw new \core\session\exception(<a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('servererror'));
<a name="l80"><span class="linenum">  80</span></a>              }
<a name="l81"><span class="linenum">  81</span></a>  
<a name="l82"><span class="linenum">  82</span></a>              self::<a class="function" onClick="logFunction('initialise_user_session')" href="../../../_functions/initialise_user_session.html" onMouseOver="funcPopup(event,'initialise_user_session')">initialise_user_session</a>(<a class="var it34857" onMouseOver="hilite(34857)" onMouseOut="lolite()" onClick="logVariable('isnewsession')" href="../../../_variables/isnewsession.html">$isnewsession</a>);
<a name="l83"><span class="linenum">  83</span></a>              self::<a class="function" onClick="logFunction('check_security')" href="../../../_functions/check_security.html" onMouseOver="funcPopup(event,'check_security')">check_security</a>();
<a name="l84"><span class="linenum">  84</span></a>  
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment">            // Link global $USER and $SESSION,</span>
<a name="l86"><span class="linenum">  86</span></a>  <span class="comment">            // this is tricky because PHP does not allow references to references</span>
<a name="l87"><span class="linenum">  87</span></a>  <span class="comment">            // and global keyword uses internally once reference to the $GLOBALS array.</span>
<a name="l88"><span class="linenum">  88</span></a>  <span class="comment">            // The solution is to use the $GLOBALS['USER'] and $GLOBALS['$SESSION']</span>
<a name="l89"><span class="linenum">  89</span></a>  <span class="comment">            // as the main storage of data and put references to $_SESSION.</span>
<a name="l90"><span class="linenum">  90</span></a>              <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['USER'] = <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['USER'];
<a name="l91"><span class="linenum">  91</span></a>              <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['USER'] =&amp; <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['USER'];
<a name="l92"><span class="linenum">  92</span></a>              <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['SESSION'] = <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['SESSION'];
<a name="l93"><span class="linenum">  93</span></a>              <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['SESSION'] =&amp; <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['SESSION'];
<a name="l94"><span class="linenum">  94</span></a>  
<a name="l95"><span class="linenum">  95</span></a>          } catch (\Exception <a class="var it341" onMouseOver="hilite(341)" onMouseOut="lolite()" onClick="logVariable('ex')" href="../../../_variables/ex.html">$ex</a>) {
<a name="l96"><span class="linenum">  96</span></a>              self::<a class="function" onClick="logFunction('init_empty_session')" href="../../../_functions/init_empty_session.html" onMouseOver="funcPopup(event,'init_empty_session')">init_empty_session</a>();
<a name="l97"><span class="linenum">  97</span></a>              self::<a class="var it39832" onMouseOver="hilite(39832)" onMouseOut="lolite()" onClick="logVariable('sessionactive')" href="../../../_variables/sessionactive.html">$sessionactive</a> = false;
<a name="l98"><span class="linenum">  98</span></a>              throw <a class="var it341" onMouseOver="hilite(341)" onMouseOut="lolite()" onClick="logVariable('ex')" href="../../../_variables/ex.html">$ex</a>;
<a name="l99"><span class="linenum">  99</span></a>          }
<a name="l100"><span class="linenum"> 100</span></a>  
<a name="l101"><span class="linenum"> 101</span></a>          self::<a class="var it39832" onMouseOver="hilite(39832)" onMouseOut="lolite()" onClick="logVariable('sessionactive')" href="../../../_variables/sessionactive.html">$sessionactive</a> = true;
<a name="l102"><span class="linenum"> 102</span></a>      }
<a name="l103"><span class="linenum"> 103</span></a>  
<a name="l104"><span class="linenum"> 104</span></a>      <span class="comment">/**</span>
<a name="l105"><span class="linenum"> 105</span></a>  <span class="comment">     * Returns current page performance info.</span>
<a name="l106"><span class="linenum"> 106</span></a>  <span class="comment">     *</span>
<a name="l107"><span class="linenum"> 107</span></a>  <span class="comment">     * @return array perf info</span>
<a name="l108"><span class="linenum"> 108</span></a>  <span class="comment">     */</span>
<a name="l109"><span class="linenum"> 109</span></a>      public static function <a class="function" onClick="logFunction('get_performance_info')" href="../../../_functions/get_performance_info.html" onMouseOver="funcPopup(event,'get_performance_info')">get_performance_info</a>() {
<a name="l110"><span class="linenum"> 110</span></a>          if (!<a class="phpfunction" onClick="logFunction('session_id')" href="../../../_functions/session_id.html" onMouseOver="phpfuncPopup(event,'session_id')">session_id</a>()) {
<a name="l111"><span class="linenum"> 111</span></a>              return array();
<a name="l112"><span class="linenum"> 112</span></a>          }
<a name="l113"><span class="linenum"> 113</span></a>  
<a name="l114"><span class="linenum"> 114</span></a>          self::<a class="function" onClick="logFunction('load_handler')" href="../../../_functions/load_handler.html" onMouseOver="funcPopup(event,'load_handler')">load_handler</a>();
<a name="l115"><span class="linenum"> 115</span></a>          <a class="var it804" onMouseOver="hilite(804)" onMouseOut="lolite()" onClick="logVariable('size')" href="../../../_variables/size.html">$size</a> = <a class="function" onClick="logFunction('display_size')" href="../../../_functions/display_size.html" onMouseOver="funcPopup(event,'display_size')">display_size</a>(<a class="function" onClick="logFunction('strlen')" href="../../../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="phpfunction" onClick="logFunction('session_encode')" href="../../../_functions/session_encode.html" onMouseOver="phpfuncPopup(event,'session_encode')">session_encode</a>()));
<a name="l116"><span class="linenum"> 116</span></a>          <a class="var it2691" onMouseOver="hilite(2691)" onMouseOut="lolite()" onClick="logVariable('handler')" href="../../../_variables/handler.html">$handler</a> = <a class="phpfunction" onClick="logFunction('get_class')" href="../../../_functions/get_class.html" onMouseOver="phpfuncPopup(event,'get_class')">get_class</a>(self::<a class="var it2691" onMouseOver="hilite(2691)" onMouseOut="lolite()" onClick="logVariable('handler')" href="../../../_variables/handler.html">$handler</a>);
<a name="l117"><span class="linenum"> 117</span></a>  
<a name="l118"><span class="linenum"> 118</span></a>          <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a> = array();
<a name="l119"><span class="linenum"> 119</span></a>          <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a>['size'] = <a class="var it804" onMouseOver="hilite(804)" onMouseOut="lolite()" onClick="logVariable('size')" href="../../../_variables/size.html">$size</a>;
<a name="l120"><span class="linenum"> 120</span></a>          <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a>['html'] = &quot;&lt;span class=\&quot;sessionsize\&quot;&gt;<a class="function" onClick="logFunction('Session')" href="../../../_functions/session.html" onMouseOver="funcPopup(event,'session')">Session</a> (<a class="var it2691" onMouseOver="hilite(2691)" onMouseOut="lolite()" onClick="logVariable('handler')" href="../../../_variables/handler.html">$handler</a>): <a class="var it804" onMouseOver="hilite(804)" onMouseOut="lolite()" onClick="logVariable('size')" href="../../../_variables/size.html">$size</a>&lt;/span&gt; &quot;;
<a name="l121"><span class="linenum"> 121</span></a>          <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a>['txt'] = &quot;<a class="function" onClick="logFunction('Session')" href="../../../_functions/session.html" onMouseOver="funcPopup(event,'session')">Session</a> (<a class="var it2691" onMouseOver="hilite(2691)" onMouseOut="lolite()" onClick="logVariable('handler')" href="../../../_variables/handler.html">$handler</a>): <a class="var it804" onMouseOver="hilite(804)" onMouseOut="lolite()" onClick="logVariable('size')" href="../../../_variables/size.html">$size</a> &quot;;
<a name="l122"><span class="linenum"> 122</span></a>  
<a name="l123"><span class="linenum"> 123</span></a>          return <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a>;
<a name="l124"><span class="linenum"> 124</span></a>      }
<a name="l125"><span class="linenum"> 125</span></a>  
<a name="l126"><span class="linenum"> 126</span></a>      <span class="comment">/**</span>
<a name="l127"><span class="linenum"> 127</span></a>  <span class="comment">     * Create handler instance.</span>
<a name="l128"><span class="linenum"> 128</span></a>  <span class="comment">     */</span>
<a name="l129"><span class="linenum"> 129</span></a>      protected static function <a class="function" onClick="logFunction('load_handler')" href="../../../_functions/load_handler.html" onMouseOver="funcPopup(event,'load_handler')">load_handler</a>() {
<a name="l130"><span class="linenum"> 130</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l131"><span class="linenum"> 131</span></a>  
<a name="l132"><span class="linenum"> 132</span></a>          if (self::<a class="var it2691" onMouseOver="hilite(2691)" onMouseOut="lolite()" onClick="logVariable('handler')" href="../../../_variables/handler.html">$handler</a>) {
<a name="l133"><span class="linenum"> 133</span></a>              return;
<a name="l134"><span class="linenum"> 134</span></a>          }
<a name="l135"><span class="linenum"> 135</span></a>  
<a name="l136"><span class="linenum"> 136</span></a>  <span class="comment">        // Find out which handler to use.</span>
<a name="l137"><span class="linenum"> 137</span></a>          if (<a class="constant" onClick="logConstant('PHPUNIT_TEST')" href="../../../_constants/PHPUNIT_TEST.html" onMouseOver="constPopup(event,'PHPUNIT_TEST')">PHPUNIT_TEST</a>) {
<a name="l138"><span class="linenum"> 138</span></a>              <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('class')" href="../../../_variables/class.html">$class</a> = '\core\session\file';
<a name="l139"><span class="linenum"> 139</span></a>  
<a name="l140"><span class="linenum"> 140</span></a>          } else if (!empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('session_handler_class')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/session_handler_class.html">session_handler_class</a>)) {
<a name="l141"><span class="linenum"> 141</span></a>              <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('class')" href="../../../_variables/class.html">$class</a> = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('session_handler_class')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/session_handler_class.html">session_handler_class</a>;
<a name="l142"><span class="linenum"> 142</span></a>  
<a name="l143"><span class="linenum"> 143</span></a>          } else if (!empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dbsessions')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/dbsessions.html">dbsessions</a>) and <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('session_lock_supported')" href="../../../_functions/session_lock_supported.html" onMouseOver="funcPopup(event,'session_lock_supported')">session_lock_supported</a>()) {
<a name="l144"><span class="linenum"> 144</span></a>              <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('class')" href="../../../_variables/class.html">$class</a> = '\core\session\database';
<a name="l145"><span class="linenum"> 145</span></a>  
<a name="l146"><span class="linenum"> 146</span></a>          } else {
<a name="l147"><span class="linenum"> 147</span></a>              <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('class')" href="../../../_variables/class.html">$class</a> = '\core\session\file';
<a name="l148"><span class="linenum"> 148</span></a>          }
<a name="l149"><span class="linenum"> 149</span></a>          self::<a class="var it2691" onMouseOver="hilite(2691)" onMouseOut="lolite()" onClick="logVariable('handler')" href="../../../_variables/handler.html">$handler</a> = new <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('class')" href="../../../_variables/class.html">$class</a>();
<a name="l150"><span class="linenum"> 150</span></a>      }
<a name="l151"><span class="linenum"> 151</span></a>  
<a name="l152"><span class="linenum"> 152</span></a>      <span class="comment">/**</span>
<a name="l153"><span class="linenum"> 153</span></a>  <span class="comment">     * Empty current session, fill it with not-logged-in user info.</span>
<a name="l154"><span class="linenum"> 154</span></a>  <span class="comment">     *</span>
<a name="l155"><span class="linenum"> 155</span></a>  <span class="comment">     * This is intended for installation scripts, unit tests and other</span>
<a name="l156"><span class="linenum"> 156</span></a>  <span class="comment">     * special areas. Do NOT use for logout and session termination</span>
<a name="l157"><span class="linenum"> 157</span></a>  <span class="comment">     * in normal requests!</span>
<a name="l158"><span class="linenum"> 158</span></a>  <span class="comment">     */</span>
<a name="l159"><span class="linenum"> 159</span></a>      public static function <a class="function" onClick="logFunction('init_empty_session')" href="../../../_functions/init_empty_session.html" onMouseOver="funcPopup(event,'init_empty_session')">init_empty_session</a>() {
<a name="l160"><span class="linenum"> 160</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>;
<a name="l161"><span class="linenum"> 161</span></a>  
<a name="l162"><span class="linenum"> 162</span></a>          if (isset(<a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['SESSION']-&gt;notifications)) {
<a name="l163"><span class="linenum"> 163</span></a>  <span class="comment">            // Backup notifications. These should be preserved across session changes until the user fetches and clears them.</span>
<a name="l164"><span class="linenum"> 164</span></a>              <a class="var it1809" onMouseOver="hilite(1809)" onMouseOut="lolite()" onClick="logVariable('notifications')" href="../../../_variables/notifications.html">$notifications</a> = <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['SESSION']-&gt;notifications;
<a name="l165"><span class="linenum"> 165</span></a>          }
<a name="l166"><span class="linenum"> 166</span></a>          <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['SESSION'] = new \stdClass();
<a name="l167"><span class="linenum"> 167</span></a>  
<a name="l168"><span class="linenum"> 168</span></a>          <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['USER'] = new \stdClass();
<a name="l169"><span class="linenum"> 169</span></a>          <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['USER']-&gt;id = 0;
<a name="l170"><span class="linenum"> 170</span></a>  
<a name="l171"><span class="linenum"> 171</span></a>          if (!empty(<a class="var it1809" onMouseOver="hilite(1809)" onMouseOut="lolite()" onClick="logVariable('notifications')" href="../../../_variables/notifications.html">$notifications</a>)) {
<a name="l172"><span class="linenum"> 172</span></a>  <span class="comment">            // Restore notifications.</span>
<a name="l173"><span class="linenum"> 173</span></a>              <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['SESSION']-&gt;notifications = <a class="var it1809" onMouseOver="hilite(1809)" onMouseOut="lolite()" onClick="logVariable('notifications')" href="../../../_variables/notifications.html">$notifications</a>;
<a name="l174"><span class="linenum"> 174</span></a>          }
<a name="l175"><span class="linenum"> 175</span></a>          if (isset(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/mnet_localhost_id.html">mnet_localhost_id</a>)) {
<a name="l176"><span class="linenum"> 176</span></a>              <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['USER']-&gt;mnethostid = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/mnet_localhost_id.html">mnet_localhost_id</a>;
<a name="l177"><span class="linenum"> 177</span></a>          } else {
<a name="l178"><span class="linenum"> 178</span></a>  <span class="comment">            // Not installed yet, the future host id will be most probably 1.</span>
<a name="l179"><span class="linenum"> 179</span></a>              <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['USER']-&gt;mnethostid = 1;
<a name="l180"><span class="linenum"> 180</span></a>          }
<a name="l181"><span class="linenum"> 181</span></a>  
<a name="l182"><span class="linenum"> 182</span></a>  <span class="comment">        // Link global $USER and $SESSION.</span>
<a name="l183"><span class="linenum"> 183</span></a>          <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a> = array();
<a name="l184"><span class="linenum"> 184</span></a>          <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['USER'] =&amp; <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['USER'];
<a name="l185"><span class="linenum"> 185</span></a>          <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['SESSION'] =&amp; <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['SESSION'];
<a name="l186"><span class="linenum"> 186</span></a>      }
<a name="l187"><span class="linenum"> 187</span></a>  
<a name="l188"><span class="linenum"> 188</span></a>      <span class="comment">/**</span>
<a name="l189"><span class="linenum"> 189</span></a>  <span class="comment">     * Make sure all cookie and session related stuff is configured properly before session start.</span>
<a name="l190"><span class="linenum"> 190</span></a>  <span class="comment">     */</span>
<a name="l191"><span class="linenum"> 191</span></a>      protected static function <a class="function" onClick="logFunction('prepare_cookies')" href="../../../_functions/prepare_cookies.html" onMouseOver="funcPopup(event,'prepare_cookies')">prepare_cookies</a>() {
<a name="l192"><span class="linenum"> 192</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>;
<a name="l193"><span class="linenum"> 193</span></a>  
<a name="l194"><span class="linenum"> 194</span></a>          if (!isset(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('cookiesecure')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/cookiesecure.html">cookiesecure</a>) <a class="function" onClick="logFunction('or')" href="../../../_functions/or.html" onMouseOver="funcPopup(event,'or')">or</a> (!<a class="function" onClick="logFunction('is_https')" href="../../../_functions/is_https.html" onMouseOver="funcPopup(event,'is_https')">is_https</a>() and empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sslproxy')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sslproxy.html">sslproxy</a>))) {
<a name="l195"><span class="linenum"> 195</span></a>              <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('cookiesecure')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/cookiesecure.html">cookiesecure</a> = 0;
<a name="l196"><span class="linenum"> 196</span></a>          }
<a name="l197"><span class="linenum"> 197</span></a>  
<a name="l198"><span class="linenum"> 198</span></a>          if (!isset(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('cookiehttponly')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/cookiehttponly.html">cookiehttponly</a>)) {
<a name="l199"><span class="linenum"> 199</span></a>              <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('cookiehttponly')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/cookiehttponly.html">cookiehttponly</a> = 0;
<a name="l200"><span class="linenum"> 200</span></a>          }
<a name="l201"><span class="linenum"> 201</span></a>  
<a name="l202"><span class="linenum"> 202</span></a>  <span class="comment">        // Set sessioncookie variable if it isn't already.</span>
<a name="l203"><span class="linenum"> 203</span></a>          if (!isset(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookie')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookie.html">sessioncookie</a>)) {
<a name="l204"><span class="linenum"> 204</span></a>              <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookie')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookie.html">sessioncookie</a> = '';
<a name="l205"><span class="linenum"> 205</span></a>          }
<a name="l206"><span class="linenum"> 206</span></a>          <a class="var it39833" onMouseOver="hilite(39833)" onMouseOut="lolite()" onClick="logVariable('sessionname')" href="../../../_variables/sessionname.html">$sessionname</a> = 'MoodleSession'.<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookie')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookie.html">sessioncookie</a>;
<a name="l207"><span class="linenum"> 207</span></a>  
<a name="l208"><span class="linenum"> 208</span></a>  <span class="comment">        // Make sure cookie domain makes sense for this wwwroot.</span>
<a name="l209"><span class="linenum"> 209</span></a>          if (!isset(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookiedomain')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookiedomain.html">sessioncookiedomain</a>)) {
<a name="l210"><span class="linenum"> 210</span></a>              <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookiedomain')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookiedomain.html">sessioncookiedomain</a> = '';
<a name="l211"><span class="linenum"> 211</span></a>          } else if (<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookiedomain')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookiedomain.html">sessioncookiedomain</a> !== '') {
<a name="l212"><span class="linenum"> 212</span></a>              <a class="var it213" onMouseOver="hilite(213)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../../_variables/host.html">$host</a> = <a class="phpfunction" onClick="logFunction('parse_url')" href="../../../_functions/parse_url.html" onMouseOver="phpfuncPopup(event,'parse_url')">parse_url</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/wwwroot.html">wwwroot</a>, PHP_URL_HOST);
<a name="l213"><span class="linenum"> 213</span></a>              if (<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookiedomain')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookiedomain.html">sessioncookiedomain</a> !== <a class="var it213" onMouseOver="hilite(213)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../../_variables/host.html">$host</a>) {
<a name="l214"><span class="linenum"> 214</span></a>                  if (<a class="phpfunction" onClick="logFunction('substr')" href="../../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookiedomain')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookiedomain.html">sessioncookiedomain</a>, 0, 1) === '.') {
<a name="l215"><span class="linenum"> 215</span></a>                      if (!<a class="phpfunction" onClick="logFunction('preg_match')" href="../../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('|^.*'.<a class="phpfunction" onClick="logFunction('preg_quote')" href="../../../_functions/preg_quote.html" onMouseOver="phpfuncPopup(event,'preg_quote')">preg_quote</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookiedomain')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookiedomain.html">sessioncookiedomain</a>, '|').'$|', <a class="var it213" onMouseOver="hilite(213)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../../_variables/host.html">$host</a>)) {
<a name="l216"><span class="linenum"> 216</span></a>  <span class="comment">                        // Invalid domain - it must be end part of host.</span>
<a name="l217"><span class="linenum"> 217</span></a>                          <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookiedomain')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookiedomain.html">sessioncookiedomain</a> = '';
<a name="l218"><span class="linenum"> 218</span></a>                      }
<a name="l219"><span class="linenum"> 219</span></a>                  } else {
<a name="l220"><span class="linenum"> 220</span></a>                      if (!<a class="phpfunction" onClick="logFunction('preg_match')" href="../../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('|^.*\.'.<a class="phpfunction" onClick="logFunction('preg_quote')" href="../../../_functions/preg_quote.html" onMouseOver="phpfuncPopup(event,'preg_quote')">preg_quote</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookiedomain')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookiedomain.html">sessioncookiedomain</a>, '|').'$|', <a class="var it213" onMouseOver="hilite(213)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../../_variables/host.html">$host</a>)) {
<a name="l221"><span class="linenum"> 221</span></a>  <span class="comment">                        // Invalid domain - it must be end part of host.</span>
<a name="l222"><span class="linenum"> 222</span></a>                          <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookiedomain')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookiedomain.html">sessioncookiedomain</a> = '';
<a name="l223"><span class="linenum"> 223</span></a>                      }
<a name="l224"><span class="linenum"> 224</span></a>                  }
<a name="l225"><span class="linenum"> 225</span></a>              }
<a name="l226"><span class="linenum"> 226</span></a>          }
<a name="l227"><span class="linenum"> 227</span></a>  
<a name="l228"><span class="linenum"> 228</span></a>  <span class="comment">        // Make sure the cookiepath is valid for this wwwroot or autodetect if not specified.</span>
<a name="l229"><span class="linenum"> 229</span></a>          if (!isset(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookiepath')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookiepath.html">sessioncookiepath</a>)) {
<a name="l230"><span class="linenum"> 230</span></a>              <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookiepath')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookiepath.html">sessioncookiepath</a> = '';
<a name="l231"><span class="linenum"> 231</span></a>          }
<a name="l232"><span class="linenum"> 232</span></a>          if (<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookiepath')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookiepath.html">sessioncookiepath</a> !== '/') {
<a name="l233"><span class="linenum"> 233</span></a>              <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../_variables/path.html">$path</a> = <a class="phpfunction" onClick="logFunction('parse_url')" href="../../../_functions/parse_url.html" onMouseOver="phpfuncPopup(event,'parse_url')">parse_url</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/wwwroot.html">wwwroot</a>, PHP_URL_PATH).'/';
<a name="l234"><span class="linenum"> 234</span></a>              if (<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookiepath')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookiepath.html">sessioncookiepath</a> === '') {
<a name="l235"><span class="linenum"> 235</span></a>                  <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookiepath')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookiepath.html">sessioncookiepath</a> = <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../_variables/path.html">$path</a>;
<a name="l236"><span class="linenum"> 236</span></a>              } else {
<a name="l237"><span class="linenum"> 237</span></a>                  if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../_variables/path.html">$path</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookiepath')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookiepath.html">sessioncookiepath</a>) !== 0 or <a class="phpfunction" onClick="logFunction('substr')" href="../../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookiepath')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookiepath.html">sessioncookiepath</a>, -1) !== '/') {
<a name="l238"><span class="linenum"> 238</span></a>                      <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookiepath')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookiepath.html">sessioncookiepath</a> = <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../_variables/path.html">$path</a>;
<a name="l239"><span class="linenum"> 239</span></a>                  }
<a name="l240"><span class="linenum"> 240</span></a>              }
<a name="l241"><span class="linenum"> 241</span></a>          }
<a name="l242"><span class="linenum"> 242</span></a>  
<a name="l243"><span class="linenum"> 243</span></a>  <span class="comment">        // Discard session ID from POST, GET and globals to tighten security,</span>
<a name="l244"><span class="linenum"> 244</span></a>  <span class="comment">        // this is session fixation prevention.</span>
<a name="l245"><span class="linenum"> 245</span></a>          unset(<a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>[<a class="var it39833" onMouseOver="hilite(39833)" onMouseOut="lolite()" onClick="logVariable('sessionname')" href="../../../_variables/sessionname.html">$sessionname</a>]);
<a name="l246"><span class="linenum"> 246</span></a>          unset(<a class="var it385" onMouseOver="hilite(385)" onMouseOut="lolite()" onClick="logVariable('_GET')" href="../../../_variables/_GET.html">$_GET</a>[<a class="var it39833" onMouseOver="hilite(39833)" onMouseOut="lolite()" onClick="logVariable('sessionname')" href="../../../_variables/sessionname.html">$sessionname</a>]);
<a name="l247"><span class="linenum"> 247</span></a>          unset(<a class="var it2242" onMouseOver="hilite(2242)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../../../_variables/_POST.html">$_POST</a>[<a class="var it39833" onMouseOver="hilite(39833)" onMouseOut="lolite()" onClick="logVariable('sessionname')" href="../../../_variables/sessionname.html">$sessionname</a>]);
<a name="l248"><span class="linenum"> 248</span></a>          unset(<a class="var it3189" onMouseOver="hilite(3189)" onMouseOut="lolite()" onClick="logVariable('_REQUEST')" href="../../../_variables/_REQUEST.html">$_REQUEST</a>[<a class="var it39833" onMouseOver="hilite(39833)" onMouseOut="lolite()" onClick="logVariable('sessionname')" href="../../../_variables/sessionname.html">$sessionname</a>]);
<a name="l249"><span class="linenum"> 249</span></a>  
<a name="l250"><span class="linenum"> 250</span></a>  <span class="comment">        // Compatibility hack for non-browser access to our web interface.</span>
<a name="l251"><span class="linenum"> 251</span></a>          if (!empty(<a class="var it23946" onMouseOver="hilite(23946)" onMouseOut="lolite()" onClick="logVariable('_COOKIE')" href="../../../_variables/_COOKIE.html">$_COOKIE</a>[<a class="var it39833" onMouseOver="hilite(39833)" onMouseOut="lolite()" onClick="logVariable('sessionname')" href="../../../_variables/sessionname.html">$sessionname</a>]) &amp;&amp; <a class="var it23946" onMouseOver="hilite(23946)" onMouseOut="lolite()" onClick="logVariable('_COOKIE')" href="../../../_variables/_COOKIE.html">$_COOKIE</a>[<a class="var it39833" onMouseOver="hilite(39833)" onMouseOut="lolite()" onClick="logVariable('sessionname')" href="../../../_variables/sessionname.html">$sessionname</a>] == &quot;deleted&quot;) {
<a name="l252"><span class="linenum"> 252</span></a>              unset(<a class="var it23946" onMouseOver="hilite(23946)" onMouseOut="lolite()" onClick="logVariable('_COOKIE')" href="../../../_variables/_COOKIE.html">$_COOKIE</a>[<a class="var it39833" onMouseOver="hilite(39833)" onMouseOut="lolite()" onClick="logVariable('sessionname')" href="../../../_variables/sessionname.html">$sessionname</a>]);
<a name="l253"><span class="linenum"> 253</span></a>          }
<a name="l254"><span class="linenum"> 254</span></a>  
<a name="l255"><span class="linenum"> 255</span></a>  <span class="comment">        // Set configuration.</span>
<a name="l256"><span class="linenum"> 256</span></a>          <a class="phpfunction" onClick="logFunction('session_name')" href="../../../_functions/session_name.html" onMouseOver="phpfuncPopup(event,'session_name')">session_name</a>(<a class="var it39833" onMouseOver="hilite(39833)" onMouseOut="lolite()" onClick="logVariable('sessionname')" href="../../../_variables/sessionname.html">$sessionname</a>);
<a name="l257"><span class="linenum"> 257</span></a>          <a class="phpfunction" onClick="logFunction('session_set_cookie_params')" href="../../../_functions/session_set_cookie_params.html" onMouseOver="phpfuncPopup(event,'session_set_cookie_params')">session_set_cookie_params</a>(0, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookiepath')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookiepath.html">sessioncookiepath</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessioncookiedomain')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessioncookiedomain.html">sessioncookiedomain</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('cookiesecure')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/cookiesecure.html">cookiesecure</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('cookiehttponly')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/cookiehttponly.html">cookiehttponly</a>);
<a name="l258"><span class="linenum"> 258</span></a>          <a class="phpfunction" onClick="logFunction('ini_set')" href="../../../_functions/ini_set.html" onMouseOver="phpfuncPopup(event,'ini_set')">ini_set</a>('session.use_trans_sid', '0');
<a name="l259"><span class="linenum"> 259</span></a>          <a class="phpfunction" onClick="logFunction('ini_set')" href="../../../_functions/ini_set.html" onMouseOver="phpfuncPopup(event,'ini_set')">ini_set</a>('session.use_only_cookies', '1');
<a name="l260"><span class="linenum"> 260</span></a>          <a class="phpfunction" onClick="logFunction('ini_set')" href="../../../_functions/ini_set.html" onMouseOver="phpfuncPopup(event,'ini_set')">ini_set</a>('session.hash_function', '0');        <span class="comment">// For now MD5 - we do not have room for sha-1 in sessions table.</span>
<a name="l261"><span class="linenum"> 261</span></a>          <a class="phpfunction" onClick="logFunction('ini_set')" href="../../../_functions/ini_set.html" onMouseOver="phpfuncPopup(event,'ini_set')">ini_set</a>('session.use_strict_mode', '0');      <span class="comment">// We have custom protection in session init.</span>
<a name="l262"><span class="linenum"> 262</span></a>          <a class="phpfunction" onClick="logFunction('ini_set')" href="../../../_functions/ini_set.html" onMouseOver="phpfuncPopup(event,'ini_set')">ini_set</a>('session.serialize_handler', 'php');  <span class="comment">// We can move to 'php_serialize' after we require PHP 5.5.4 form Moodle.</span>
<a name="l263"><span class="linenum"> 263</span></a>  
<a name="l264"><span class="linenum"> 264</span></a>  <span class="comment">        // Moodle does normal session timeouts, this is for leftovers only.</span>
<a name="l265"><span class="linenum"> 265</span></a>          <a class="phpfunction" onClick="logFunction('ini_set')" href="../../../_functions/ini_set.html" onMouseOver="phpfuncPopup(event,'ini_set')">ini_set</a>('session.gc_probability', 1);
<a name="l266"><span class="linenum"> 266</span></a>          <a class="phpfunction" onClick="logFunction('ini_set')" href="../../../_functions/ini_set.html" onMouseOver="phpfuncPopup(event,'ini_set')">ini_set</a>('session.gc_divisor', 1000);
<a name="l267"><span class="linenum"> 267</span></a>          <a class="phpfunction" onClick="logFunction('ini_set')" href="../../../_functions/ini_set.html" onMouseOver="phpfuncPopup(event,'ini_set')">ini_set</a>('session.gc_maxlifetime', 60*60*24*4);
<a name="l268"><span class="linenum"> 268</span></a>      }
<a name="l269"><span class="linenum"> 269</span></a>  
<a name="l270"><span class="linenum"> 270</span></a>      <span class="comment">/**</span>
<a name="l271"><span class="linenum"> 271</span></a>  <span class="comment">     * Initialise $_SESSION, handles google access</span>
<a name="l272"><span class="linenum"> 272</span></a>  <span class="comment">     * and sets up not-logged-in user properly.</span>
<a name="l273"><span class="linenum"> 273</span></a>  <span class="comment">     *</span>
<a name="l274"><span class="linenum"> 274</span></a>  <span class="comment">     * WARNING: $USER and $SESSION are set up later, do not use them yet!</span>
<a name="l275"><span class="linenum"> 275</span></a>  <span class="comment">     *</span>
<a name="l276"><span class="linenum"> 276</span></a>  <span class="comment">     * @param bool $newsid is this a new session in first http request?</span>
<a name="l277"><span class="linenum"> 277</span></a>  <span class="comment">     */</span>
<a name="l278"><span class="linenum"> 278</span></a>      protected static function <a class="function" onClick="logFunction('initialise_user_session')" href="../../../_functions/initialise_user_session.html" onMouseOver="funcPopup(event,'initialise_user_session')">initialise_user_session</a>(<a class="var it39834" onMouseOver="hilite(39834)" onMouseOut="lolite()" onClick="logVariable('newsid')" href="../../../_variables/newsid.html">$newsid</a>) {
<a name="l279"><span class="linenum"> 279</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l280"><span class="linenum"> 280</span></a>  
<a name="l281"><span class="linenum"> 281</span></a>          <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a> = <a class="phpfunction" onClick="logFunction('session_id')" href="../../../_functions/session_id.html" onMouseOver="phpfuncPopup(event,'session_id')">session_id</a>();
<a name="l282"><span class="linenum"> 282</span></a>          if (!<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a>) {
<a name="l283"><span class="linenum"> 283</span></a>  <span class="comment">            // No session, very weird.</span>
<a name="l284"><span class="linenum"> 284</span></a>              <a class="phpfunction" onClick="logFunction('error_log')" href="../../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>('Missing session ID, session not started!');
<a name="l285"><span class="linenum"> 285</span></a>              self::<a class="function" onClick="logFunction('init_empty_session')" href="../../../_functions/init_empty_session.html" onMouseOver="funcPopup(event,'init_empty_session')">init_empty_session</a>();
<a name="l286"><span class="linenum"> 286</span></a>              return;
<a name="l287"><span class="linenum"> 287</span></a>          }
<a name="l288"><span class="linenum"> 288</span></a>  
<a name="l289"><span class="linenum"> 289</span></a>          if (!<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('sessions', array('sid'=&gt;<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a>), 'id, sid, state, userid, lastip, timecreated, timemodified')) {
<a name="l290"><span class="linenum"> 290</span></a>              if (!<a class="var it39834" onMouseOver="hilite(39834)" onMouseOut="lolite()" onClick="logVariable('newsid')" href="../../../_variables/newsid.html">$newsid</a>) {
<a name="l291"><span class="linenum"> 291</span></a>                  if (!empty(<a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['USER']-&gt;id)) {
<a name="l292"><span class="linenum"> 292</span></a>  <span class="comment">                    // This should not happen, just log it, we MUST not produce any output here!</span>
<a name="l293"><span class="linenum"> 293</span></a>                      <a class="phpfunction" onClick="logFunction('error_log')" href="../../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>(&quot;Cannot find session record <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a> for user &quot;.<a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['USER']-&gt;id.&quot;, creating new session.&quot;);
<a name="l294"><span class="linenum"> 294</span></a>                  }
<a name="l295"><span class="linenum"> 295</span></a>  <span class="comment">                // Prevent session fixation attacks.</span>
<a name="l296"><span class="linenum"> 296</span></a>                  <a class="phpfunction" onClick="logFunction('session_regenerate_id')" href="../../../_functions/session_regenerate_id.html" onMouseOver="phpfuncPopup(event,'session_regenerate_id')">session_regenerate_id</a>(true);
<a name="l297"><span class="linenum"> 297</span></a>              }
<a name="l298"><span class="linenum"> 298</span></a>              <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a> = array();
<a name="l299"><span class="linenum"> 299</span></a>          }
<a name="l300"><span class="linenum"> 300</span></a>          unset(<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a>);
<a name="l301"><span class="linenum"> 301</span></a>  
<a name="l302"><span class="linenum"> 302</span></a>          if (isset(<a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['USER']-&gt;id)) {
<a name="l303"><span class="linenum"> 303</span></a>              if (!empty(<a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['USER']-&gt;realuser)) {
<a name="l304"><span class="linenum"> 304</span></a>                  <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a> = <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['USER']-&gt;realuser;
<a name="l305"><span class="linenum"> 305</span></a>              } else {
<a name="l306"><span class="linenum"> 306</span></a>                  <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a> = <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['USER']-&gt;id;
<a name="l307"><span class="linenum"> 307</span></a>              }
<a name="l308"><span class="linenum"> 308</span></a>  
<a name="l309"><span class="linenum"> 309</span></a>  <span class="comment">            // Verify timeout first.</span>
<a name="l310"><span class="linenum"> 310</span></a>              <a class="var it16246" onMouseOver="hilite(16246)" onMouseOut="lolite()" onClick="logVariable('maxlifetime')" href="../../../_variables/maxlifetime.html">$maxlifetime</a> = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessiontimeout')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessiontimeout.html">sessiontimeout</a>;
<a name="l311"><span class="linenum"> 311</span></a>              <a class="var it1356" onMouseOver="hilite(1356)" onMouseOut="lolite()" onClick="logVariable('timeout')" href="../../../_variables/timeout.html">$timeout</a> = false;
<a name="l312"><span class="linenum"> 312</span></a>              if (<a class="function" onClick="logFunction('isguestuser')" href="../../../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>(<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a>) or empty(<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a>)) {
<a name="l313"><span class="linenum"> 313</span></a>  <span class="comment">                // Ignore guest and not-logged in timeouts, there is very little risk here.</span>
<a name="l314"><span class="linenum"> 314</span></a>                  <a class="var it1356" onMouseOver="hilite(1356)" onMouseOut="lolite()" onClick="logVariable('timeout')" href="../../../_variables/timeout.html">$timeout</a> = false;
<a name="l315"><span class="linenum"> 315</span></a>  
<a name="l316"><span class="linenum"> 316</span></a>              } else if (<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('timemodified')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/timemodified.html">timemodified</a> &lt; <a class="phpfunction" onClick="logFunction('time')" href="../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() - <a class="var it16246" onMouseOver="hilite(16246)" onMouseOut="lolite()" onClick="logVariable('maxlifetime')" href="../../../_variables/maxlifetime.html">$maxlifetime</a>) {
<a name="l317"><span class="linenum"> 317</span></a>                  <a class="var it1356" onMouseOver="hilite(1356)" onMouseOut="lolite()" onClick="logVariable('timeout')" href="../../../_variables/timeout.html">$timeout</a> = true;
<a name="l318"><span class="linenum"> 318</span></a>                  <a class="var it363" onMouseOver="hilite(363)" onMouseOut="lolite()" onClick="logVariable('authsequence')" href="../../../_variables/authsequence.html">$authsequence</a> = <a class="function" onClick="logFunction('get_enabled_auth_plugins')" href="../../../_functions/get_enabled_auth_plugins.html" onMouseOver="funcPopup(event,'get_enabled_auth_plugins')">get_enabled_auth_plugins</a>(); <span class="comment">// Auths, in sequence.</span>
<a name="l319"><span class="linenum"> 319</span></a>                  foreach (<a class="var it363" onMouseOver="hilite(363)" onMouseOut="lolite()" onClick="logVariable('authsequence')" href="../../../_variables/authsequence.html">$authsequence</a> as <a class="var it364" onMouseOver="hilite(364)" onMouseOut="lolite()" onClick="logVariable('authname')" href="../../../_variables/authname.html">$authname</a>) {
<a name="l320"><span class="linenum"> 320</span></a>                      <a class="var it365" onMouseOver="hilite(365)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../../../_variables/authplugin.html">$authplugin</a> = <a class="function" onClick="logFunction('get_auth_plugin')" href="../../../_functions/get_auth_plugin.html" onMouseOver="funcPopup(event,'get_auth_plugin')">get_auth_plugin</a>(<a class="var it364" onMouseOver="hilite(364)" onMouseOut="lolite()" onClick="logVariable('authname')" href="../../../_variables/authname.html">$authname</a>);
<a name="l321"><span class="linenum"> 321</span></a>                      if (<a class="var it365" onMouseOver="hilite(365)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../../../_variables/authplugin.html">$authplugin</a>-&gt;<a class="function" onClick="logFunction('ignore_timeout_hook')" href="../../../_functions/ignore_timeout_hook.html" onMouseOver="funcPopup(event,'ignore_timeout_hook')">ignore_timeout_hook</a>(<a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['USER'], <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('sid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/sid.html">sid</a>, <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('timecreated')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/timecreated.html">timecreated</a>, <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('timemodified')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/timemodified.html">timemodified</a>)) {
<a name="l322"><span class="linenum"> 322</span></a>                          <a class="var it1356" onMouseOver="hilite(1356)" onMouseOut="lolite()" onClick="logVariable('timeout')" href="../../../_variables/timeout.html">$timeout</a> = false;
<a name="l323"><span class="linenum"> 323</span></a>                          break;
<a name="l324"><span class="linenum"> 324</span></a>                      }
<a name="l325"><span class="linenum"> 325</span></a>                  }
<a name="l326"><span class="linenum"> 326</span></a>              }
<a name="l327"><span class="linenum"> 327</span></a>  
<a name="l328"><span class="linenum"> 328</span></a>              if (<a class="var it1356" onMouseOver="hilite(1356)" onMouseOut="lolite()" onClick="logVariable('timeout')" href="../../../_variables/timeout.html">$timeout</a>) {
<a name="l329"><span class="linenum"> 329</span></a>                  <a class="phpfunction" onClick="logFunction('session_regenerate_id')" href="../../../_functions/session_regenerate_id.html" onMouseOver="phpfuncPopup(event,'session_regenerate_id')">session_regenerate_id</a>(true);
<a name="l330"><span class="linenum"> 330</span></a>                  <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a> = array();
<a name="l331"><span class="linenum"> 331</span></a>                  <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('sessions', array('id'=&gt;<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>));
<a name="l332"><span class="linenum"> 332</span></a>  
<a name="l333"><span class="linenum"> 333</span></a>              } else {
<a name="l334"><span class="linenum"> 334</span></a>  <span class="comment">                // Update session tracking record.</span>
<a name="l335"><span class="linenum"> 335</span></a>  
<a name="l336"><span class="linenum"> 336</span></a>                  <a class="var it2088" onMouseOver="hilite(2088)" onMouseOut="lolite()" onClick="logVariable('update')" href="../../../_variables/update.html">$update</a> = new \stdClass();
<a name="l337"><span class="linenum"> 337</span></a>                  <a class="var it5658" onMouseOver="hilite(5658)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../../_variables/updated.html">$updated</a> = false;
<a name="l338"><span class="linenum"> 338</span></a>  
<a name="l339"><span class="linenum"> 339</span></a>                  if (<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('userid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/userid.html">userid</a> != <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a>) {
<a name="l340"><span class="linenum"> 340</span></a>                      <a class="var it2088" onMouseOver="hilite(2088)" onMouseOut="lolite()" onClick="logVariable('update')" href="../../../_variables/update.html">$update</a>-&gt;<a onClick="logVariable('userid')" class="var it43829" onMouseOver="hilite(43829)" onMouseOut="lolite()" href="../../../_variables/userid.html">userid</a> = <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('userid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/userid.html">userid</a> = <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a>;
<a name="l341"><span class="linenum"> 341</span></a>                      <a class="var it5658" onMouseOver="hilite(5658)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../../_variables/updated.html">$updated</a> = true;
<a name="l342"><span class="linenum"> 342</span></a>                  }
<a name="l343"><span class="linenum"> 343</span></a>  
<a name="l344"><span class="linenum"> 344</span></a>                  <a class="var it4562" onMouseOver="hilite(4562)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../../../_variables/ip.html">$ip</a> = <a class="function" onClick="logFunction('getremoteaddr')" href="../../../_functions/getremoteaddr.html" onMouseOver="funcPopup(event,'getremoteaddr')">getremoteaddr</a>();
<a name="l345"><span class="linenum"> 345</span></a>                  if (<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('lastip')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/lastip.html">lastip</a> != <a class="var it4562" onMouseOver="hilite(4562)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../../../_variables/ip.html">$ip</a>) {
<a name="l346"><span class="linenum"> 346</span></a>                      <a class="var it2088" onMouseOver="hilite(2088)" onMouseOut="lolite()" onClick="logVariable('update')" href="../../../_variables/update.html">$update</a>-&gt;<a onClick="logVariable('lastip')" class="var it43829" onMouseOver="hilite(43829)" onMouseOut="lolite()" href="../../../_variables/lastip.html">lastip</a> = <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('lastip')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/lastip.html">lastip</a> = <a class="var it4562" onMouseOver="hilite(4562)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../../../_variables/ip.html">$ip</a>;
<a name="l347"><span class="linenum"> 347</span></a>                      <a class="var it5658" onMouseOver="hilite(5658)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../../_variables/updated.html">$updated</a> = true;
<a name="l348"><span class="linenum"> 348</span></a>                  }
<a name="l349"><span class="linenum"> 349</span></a>  
<a name="l350"><span class="linenum"> 350</span></a>                  <a class="var it595" onMouseOver="hilite(595)" onMouseOut="lolite()" onClick="logVariable('updatefreq')" href="../../../_variables/updatefreq.html">$updatefreq</a> = empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('session_update_timemodified_frequency')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/session_update_timemodified_frequency.html">session_update_timemodified_frequency</a>) ? 20 : <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('session_update_timemodified_frequency')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/session_update_timemodified_frequency.html">session_update_timemodified_frequency</a>;
<a name="l351"><span class="linenum"> 351</span></a>  
<a name="l352"><span class="linenum"> 352</span></a>                  if (<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('timemodified')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/timemodified.html">timemodified</a> == <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('timecreated')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/timecreated.html">timecreated</a>) {
<a name="l353"><span class="linenum"> 353</span></a>  <span class="comment">                    // Always do first update of existing record.</span>
<a name="l354"><span class="linenum"> 354</span></a>                      <a class="var it2088" onMouseOver="hilite(2088)" onMouseOut="lolite()" onClick="logVariable('update')" href="../../../_variables/update.html">$update</a>-&gt;<a onClick="logVariable('timemodified')" class="var it43829" onMouseOver="hilite(43829)" onMouseOut="lolite()" href="../../../_variables/timemodified.html">timemodified</a> = <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('timemodified')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l355"><span class="linenum"> 355</span></a>                      <a class="var it5658" onMouseOver="hilite(5658)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../../_variables/updated.html">$updated</a> = true;
<a name="l356"><span class="linenum"> 356</span></a>  
<a name="l357"><span class="linenum"> 357</span></a>                  } else if (<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('timemodified')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/timemodified.html">timemodified</a> &lt; <a class="phpfunction" onClick="logFunction('time')" href="../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() - <a class="var it595" onMouseOver="hilite(595)" onMouseOut="lolite()" onClick="logVariable('updatefreq')" href="../../../_variables/updatefreq.html">$updatefreq</a>) {
<a name="l358"><span class="linenum"> 358</span></a>  <span class="comment">                    // Update the session modified flag only once every 20 seconds.</span>
<a name="l359"><span class="linenum"> 359</span></a>                      <a class="var it2088" onMouseOver="hilite(2088)" onMouseOut="lolite()" onClick="logVariable('update')" href="../../../_variables/update.html">$update</a>-&gt;<a onClick="logVariable('timemodified')" class="var it43829" onMouseOver="hilite(43829)" onMouseOut="lolite()" href="../../../_variables/timemodified.html">timemodified</a> = <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('timemodified')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l360"><span class="linenum"> 360</span></a>                      <a class="var it5658" onMouseOver="hilite(5658)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../../_variables/updated.html">$updated</a> = true;
<a name="l361"><span class="linenum"> 361</span></a>                  }
<a name="l362"><span class="linenum"> 362</span></a>  
<a name="l363"><span class="linenum"> 363</span></a>                  if (<a class="var it5658" onMouseOver="hilite(5658)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../../_variables/updated.html">$updated</a>) {
<a name="l364"><span class="linenum"> 364</span></a>                      <a class="var it2088" onMouseOver="hilite(2088)" onMouseOut="lolite()" onClick="logVariable('update')" href="../../../_variables/update.html">$update</a>-&gt;<a onClick="logVariable('id')" class="var it43829" onMouseOver="hilite(43829)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a> = <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>;
<a name="l365"><span class="linenum"> 365</span></a>                      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('sessions', <a class="var it2088" onMouseOver="hilite(2088)" onMouseOut="lolite()" onClick="logVariable('update')" href="../../../_variables/update.html">$update</a>);
<a name="l366"><span class="linenum"> 366</span></a>                  }
<a name="l367"><span class="linenum"> 367</span></a>  
<a name="l368"><span class="linenum"> 368</span></a>                  return;
<a name="l369"><span class="linenum"> 369</span></a>              }
<a name="l370"><span class="linenum"> 370</span></a>          } else {
<a name="l371"><span class="linenum"> 371</span></a>              if (<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>) {
<a name="l372"><span class="linenum"> 372</span></a>  <span class="comment">                // This happens when people switch session handlers...</span>
<a name="l373"><span class="linenum"> 373</span></a>                  <a class="phpfunction" onClick="logFunction('session_regenerate_id')" href="../../../_functions/session_regenerate_id.html" onMouseOver="phpfuncPopup(event,'session_regenerate_id')">session_regenerate_id</a>(true);
<a name="l374"><span class="linenum"> 374</span></a>                  <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a> = array();
<a name="l375"><span class="linenum"> 375</span></a>                  <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('sessions', array('id'=&gt;<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>));
<a name="l376"><span class="linenum"> 376</span></a>              }
<a name="l377"><span class="linenum"> 377</span></a>          }
<a name="l378"><span class="linenum"> 378</span></a>          unset(<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>);
<a name="l379"><span class="linenum"> 379</span></a>  
<a name="l380"><span class="linenum"> 380</span></a>          <a class="var it39836" onMouseOver="hilite(39836)" onMouseOut="lolite()" onClick="logVariable('timedout')" href="../../../_variables/timedout.html">$timedout</a> = false;
<a name="l381"><span class="linenum"> 381</span></a>          if (!isset(<a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['SESSION'])) {
<a name="l382"><span class="linenum"> 382</span></a>              <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['SESSION'] = new \stdClass();
<a name="l383"><span class="linenum"> 383</span></a>              if (!<a class="var it39834" onMouseOver="hilite(39834)" onMouseOut="lolite()" onClick="logVariable('newsid')" href="../../../_variables/newsid.html">$newsid</a>) {
<a name="l384"><span class="linenum"> 384</span></a>                  <a class="var it39836" onMouseOver="hilite(39836)" onMouseOut="lolite()" onClick="logVariable('timedout')" href="../../../_variables/timedout.html">$timedout</a> = true;
<a name="l385"><span class="linenum"> 385</span></a>              }
<a name="l386"><span class="linenum"> 386</span></a>          }
<a name="l387"><span class="linenum"> 387</span></a>  
<a name="l388"><span class="linenum"> 388</span></a>          <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a> = null;
<a name="l389"><span class="linenum"> 389</span></a>  
<a name="l390"><span class="linenum"> 390</span></a>          if (!empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('opentogoogle')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/opentogoogle.html">opentogoogle</a>)) {
<a name="l391"><span class="linenum"> 391</span></a>              if (\<a class="class" onClick="logClass('core_useragent')" href="../../../_classes/core_useragent.html" onMouseOver="classPopup(event,'core_useragent')">core_useragent</a>::<a class="function" onClick="logFunction('is_web_crawler')" href="../../../_functions/is_web_crawler.html" onMouseOver="funcPopup(event,'is_web_crawler')">is_web_crawler</a>()) {
<a name="l392"><span class="linenum"> 392</span></a>                  <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a> = <a class="function" onClick="logFunction('guest_user')" href="../../../_functions/guest_user.html" onMouseOver="funcPopup(event,'guest_user')">guest_user</a>();
<a name="l393"><span class="linenum"> 393</span></a>              }
<a name="l394"><span class="linenum"> 394</span></a>              <a class="var it382" onMouseOver="hilite(382)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../../_variables/referer.html">$referer</a> = <a class="function" onClick="logFunction('get_local_referer')" href="../../../_functions/get_local_referer.html" onMouseOver="funcPopup(event,'get_local_referer')">get_local_referer</a>(false);
<a name="l395"><span class="linenum"> 395</span></a>              if (!empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('guestloginbutton')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/guestloginbutton.html">guestloginbutton</a>) and !<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a> and !empty(<a class="var it382" onMouseOver="hilite(382)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../../_variables/referer.html">$referer</a>)) {
<a name="l396"><span class="linenum"> 396</span></a>  <span class="comment">                // Automatically log in users coming from search engine results.</span>
<a name="l397"><span class="linenum"> 397</span></a>                  if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it382" onMouseOver="hilite(382)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../../_variables/referer.html">$referer</a>, 'google') !== false ) {
<a name="l398"><span class="linenum"> 398</span></a>                      <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a> = <a class="function" onClick="logFunction('guest_user')" href="../../../_functions/guest_user.html" onMouseOver="funcPopup(event,'guest_user')">guest_user</a>();
<a name="l399"><span class="linenum"> 399</span></a>                  } else if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it382" onMouseOver="hilite(382)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../../_variables/referer.html">$referer</a>, 'altavista') !== false ) {
<a name="l400"><span class="linenum"> 400</span></a>                      <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a> = <a class="function" onClick="logFunction('guest_user')" href="../../../_functions/guest_user.html" onMouseOver="funcPopup(event,'guest_user')">guest_user</a>();
<a name="l401"><span class="linenum"> 401</span></a>                  }
<a name="l402"><span class="linenum"> 402</span></a>              }
<a name="l403"><span class="linenum"> 403</span></a>          }
<a name="l404"><span class="linenum"> 404</span></a>  
<a name="l405"><span class="linenum"> 405</span></a>  <span class="comment">        // Setup $USER and insert the session tracking record.</span>
<a name="l406"><span class="linenum"> 406</span></a>          if (<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>) {
<a name="l407"><span class="linenum"> 407</span></a>              self::<a class="function" onClick="logFunction('set_user')" href="../../../_functions/set_user.html" onMouseOver="funcPopup(event,'set_user')">set_user</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>);
<a name="l408"><span class="linenum"> 408</span></a>              self::<a class="function" onClick="logFunction('add_session_record')" href="../../../_functions/add_session_record.html" onMouseOver="funcPopup(event,'add_session_record')">add_session_record</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>);
<a name="l409"><span class="linenum"> 409</span></a>          } else {
<a name="l410"><span class="linenum"> 410</span></a>              self::<a class="function" onClick="logFunction('init_empty_session')" href="../../../_functions/init_empty_session.html" onMouseOver="funcPopup(event,'init_empty_session')">init_empty_session</a>();
<a name="l411"><span class="linenum"> 411</span></a>              self::<a class="function" onClick="logFunction('add_session_record')" href="../../../_functions/add_session_record.html" onMouseOver="funcPopup(event,'add_session_record')">add_session_record</a>(0);
<a name="l412"><span class="linenum"> 412</span></a>          }
<a name="l413"><span class="linenum"> 413</span></a>  
<a name="l414"><span class="linenum"> 414</span></a>          if (<a class="var it39836" onMouseOver="hilite(39836)" onMouseOut="lolite()" onClick="logVariable('timedout')" href="../../../_variables/timedout.html">$timedout</a>) {
<a name="l415"><span class="linenum"> 415</span></a>              <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['SESSION']-&gt;has_timed_out = true;
<a name="l416"><span class="linenum"> 416</span></a>          }
<a name="l417"><span class="linenum"> 417</span></a>      }
<a name="l418"><span class="linenum"> 418</span></a>  
<a name="l419"><span class="linenum"> 419</span></a>      <span class="comment">/**</span>
<a name="l420"><span class="linenum"> 420</span></a>  <span class="comment">     * Insert new empty session record.</span>
<a name="l421"><span class="linenum"> 421</span></a>  <span class="comment">     * @param int $userid</span>
<a name="l422"><span class="linenum"> 422</span></a>  <span class="comment">     * @return \stdClass the new record</span>
<a name="l423"><span class="linenum"> 423</span></a>  <span class="comment">     */</span>
<a name="l424"><span class="linenum"> 424</span></a>      protected static function <a class="function" onClick="logFunction('add_session_record')" href="../../../_functions/add_session_record.html" onMouseOver="funcPopup(event,'add_session_record')">add_session_record</a>(<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a>) {
<a name="l425"><span class="linenum"> 425</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l426"><span class="linenum"> 426</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a> = new \stdClass();
<a name="l427"><span class="linenum"> 427</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('state')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/state.html">state</a>       = 0;
<a name="l428"><span class="linenum"> 428</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('sid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/sid.html">sid</a>         = <a class="phpfunction" onClick="logFunction('session_id')" href="../../../_functions/session_id.html" onMouseOver="phpfuncPopup(event,'session_id')">session_id</a>();
<a name="l429"><span class="linenum"> 429</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('sessdata')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/sessdata.html">sessdata</a>    = null;
<a name="l430"><span class="linenum"> 430</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('userid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/userid.html">userid</a>      = <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a>;
<a name="l431"><span class="linenum"> 431</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('timecreated')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/timecreated.html">timecreated</a> = <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('timemodified')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l432"><span class="linenum"> 432</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('firstip')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/firstip.html">firstip</a>     = <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('lastip')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/lastip.html">lastip</a> = <a class="function" onClick="logFunction('getremoteaddr')" href="../../../_functions/getremoteaddr.html" onMouseOver="funcPopup(event,'getremoteaddr')">getremoteaddr</a>();
<a name="l433"><span class="linenum"> 433</span></a>  
<a name="l434"><span class="linenum"> 434</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('sessions', <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>);
<a name="l435"><span class="linenum"> 435</span></a>  
<a name="l436"><span class="linenum"> 436</span></a>          return <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>;
<a name="l437"><span class="linenum"> 437</span></a>      }
<a name="l438"><span class="linenum"> 438</span></a>  
<a name="l439"><span class="linenum"> 439</span></a>      <span class="comment">/**</span>
<a name="l440"><span class="linenum"> 440</span></a>  <span class="comment">     * Do various session security checks.</span>
<a name="l441"><span class="linenum"> 441</span></a>  <span class="comment">     *</span>
<a name="l442"><span class="linenum"> 442</span></a>  <span class="comment">     * WARNING: $USER and $SESSION are set up later, do not use them yet!</span>
<a name="l443"><span class="linenum"> 443</span></a>  <span class="comment">     * @throws \core\session\exception</span>
<a name="l444"><span class="linenum"> 444</span></a>  <span class="comment">     */</span>
<a name="l445"><span class="linenum"> 445</span></a>      protected static function <a class="function" onClick="logFunction('check_security')" href="../../../_functions/check_security.html" onMouseOver="funcPopup(event,'check_security')">check_security</a>() {
<a name="l446"><span class="linenum"> 446</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>;
<a name="l447"><span class="linenum"> 447</span></a>  
<a name="l448"><span class="linenum"> 448</span></a>          if (!empty(<a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['USER']-&gt;id) and !empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('tracksessionip')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/tracksessionip.html">tracksessionip</a>)) {
<a name="l449"><span class="linenum"> 449</span></a>  <span class="comment">            // Make sure current IP matches the one for this session.</span>
<a name="l450"><span class="linenum"> 450</span></a>              <a class="var it9281" onMouseOver="hilite(9281)" onMouseOut="lolite()" onClick="logVariable('remoteaddr')" href="../../../_variables/remoteaddr.html">$remoteaddr</a> = <a class="function" onClick="logFunction('getremoteaddr')" href="../../../_functions/getremoteaddr.html" onMouseOver="funcPopup(event,'getremoteaddr')">getremoteaddr</a>();
<a name="l451"><span class="linenum"> 451</span></a>  
<a name="l452"><span class="linenum"> 452</span></a>              if (empty(<a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['USER']-&gt;sessionip)) {
<a name="l453"><span class="linenum"> 453</span></a>                  <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['USER']-&gt;sessionip = <a class="var it9281" onMouseOver="hilite(9281)" onMouseOut="lolite()" onClick="logVariable('remoteaddr')" href="../../../_variables/remoteaddr.html">$remoteaddr</a>;
<a name="l454"><span class="linenum"> 454</span></a>              }
<a name="l455"><span class="linenum"> 455</span></a>  
<a name="l456"><span class="linenum"> 456</span></a>              if (<a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['USER']-&gt;sessionip != <a class="var it9281" onMouseOver="hilite(9281)" onMouseOut="lolite()" onClick="logVariable('remoteaddr')" href="../../../_variables/remoteaddr.html">$remoteaddr</a>) {
<a name="l457"><span class="linenum"> 457</span></a>  <span class="comment">                // This is a security feature - terminate the session in case of any doubt.</span>
<a name="l458"><span class="linenum"> 458</span></a>                  self::<a class="function" onClick="logFunction('terminate_current')" href="../../../_functions/terminate_current.html" onMouseOver="funcPopup(event,'terminate_current')">terminate_current</a>();
<a name="l459"><span class="linenum"> 459</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('exception')" href="../../../_classes/exception.html" onMouseOver="classPopup(event,'exception')">exception</a>('sessionipnomatch2', 'error');
<a name="l460"><span class="linenum"> 460</span></a>              }
<a name="l461"><span class="linenum"> 461</span></a>          }
<a name="l462"><span class="linenum"> 462</span></a>      }
<a name="l463"><span class="linenum"> 463</span></a>  
<a name="l464"><span class="linenum"> 464</span></a>      <span class="comment">/**</span>
<a name="l465"><span class="linenum"> 465</span></a>  <span class="comment">     * Login user, to be called from complete_user_login() only.</span>
<a name="l466"><span class="linenum"> 466</span></a>  <span class="comment">     * @param \stdClass $user</span>
<a name="l467"><span class="linenum"> 467</span></a>  <span class="comment">     */</span>
<a name="l468"><span class="linenum"> 468</span></a>      public static function <a class="function" onClick="logFunction('login_user')" href="../../../_functions/login_user.html" onMouseOver="funcPopup(event,'login_user')">login_user</a>(\stdClass <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>) {
<a name="l469"><span class="linenum"> 469</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l470"><span class="linenum"> 470</span></a>  
<a name="l471"><span class="linenum"> 471</span></a>  <span class="comment">        // Regenerate session id and delete old session,</span>
<a name="l472"><span class="linenum"> 472</span></a>  <span class="comment">        // this helps prevent session fixation attacks from the same domain.</span>
<a name="l473"><span class="linenum"> 473</span></a>  
<a name="l474"><span class="linenum"> 474</span></a>          <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a> = <a class="phpfunction" onClick="logFunction('session_id')" href="../../../_functions/session_id.html" onMouseOver="phpfuncPopup(event,'session_id')">session_id</a>();
<a name="l475"><span class="linenum"> 475</span></a>          <a class="phpfunction" onClick="logFunction('session_regenerate_id')" href="../../../_functions/session_regenerate_id.html" onMouseOver="phpfuncPopup(event,'session_regenerate_id')">session_regenerate_id</a>(true);
<a name="l476"><span class="linenum"> 476</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('sessions', array('sid'=&gt;<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a>));
<a name="l477"><span class="linenum"> 477</span></a>          self::<a class="function" onClick="logFunction('add_session_record')" href="../../../_functions/add_session_record.html" onMouseOver="funcPopup(event,'add_session_record')">add_session_record</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>);
<a name="l478"><span class="linenum"> 478</span></a>  
<a name="l479"><span class="linenum"> 479</span></a>  <span class="comment">        // Let enrol plugins deal with new enrolments if necessary.</span>
<a name="l480"><span class="linenum"> 480</span></a>          <a class="function" onClick="logFunction('enrol_check_plugins')" href="../../../_functions/enrol_check_plugins.html" onMouseOver="funcPopup(event,'enrol_check_plugins')">enrol_check_plugins</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>);
<a name="l481"><span class="linenum"> 481</span></a>  
<a name="l482"><span class="linenum"> 482</span></a>  <span class="comment">        // Setup $USER object.</span>
<a name="l483"><span class="linenum"> 483</span></a>          self::<a class="function" onClick="logFunction('set_user')" href="../../../_functions/set_user.html" onMouseOver="funcPopup(event,'set_user')">set_user</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>);
<a name="l484"><span class="linenum"> 484</span></a>      }
<a name="l485"><span class="linenum"> 485</span></a>  
<a name="l486"><span class="linenum"> 486</span></a>      <span class="comment">/**</span>
<a name="l487"><span class="linenum"> 487</span></a>  <span class="comment">     * Terminate current user session.</span>
<a name="l488"><span class="linenum"> 488</span></a>  <span class="comment">     * @return void</span>
<a name="l489"><span class="linenum"> 489</span></a>  <span class="comment">     */</span>
<a name="l490"><span class="linenum"> 490</span></a>      public static function <a class="function" onClick="logFunction('terminate_current')" href="../../../_functions/terminate_current.html" onMouseOver="funcPopup(event,'terminate_current')">terminate_current</a>() {
<a name="l491"><span class="linenum"> 491</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l492"><span class="linenum"> 492</span></a>  
<a name="l493"><span class="linenum"> 493</span></a>          if (!self::<a class="var it39832" onMouseOver="hilite(39832)" onMouseOut="lolite()" onClick="logVariable('sessionactive')" href="../../../_variables/sessionactive.html">$sessionactive</a>) {
<a name="l494"><span class="linenum"> 494</span></a>              self::<a class="function" onClick="logFunction('init_empty_session')" href="../../../_functions/init_empty_session.html" onMouseOver="funcPopup(event,'init_empty_session')">init_empty_session</a>();
<a name="l495"><span class="linenum"> 495</span></a>              self::<a class="var it39832" onMouseOver="hilite(39832)" onMouseOut="lolite()" onClick="logVariable('sessionactive')" href="../../../_variables/sessionactive.html">$sessionactive</a> = false;
<a name="l496"><span class="linenum"> 496</span></a>              return;
<a name="l497"><span class="linenum"> 497</span></a>          }
<a name="l498"><span class="linenum"> 498</span></a>  
<a name="l499"><span class="linenum"> 499</span></a>          try {
<a name="l500"><span class="linenum"> 500</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('external_tokens', array('sid'=&gt;<a class="phpfunction" onClick="logFunction('session_id')" href="../../../_functions/session_id.html" onMouseOver="phpfuncPopup(event,'session_id')">session_id</a>(), 'tokentype'=&gt;<a class="constant" onClick="logConstant('EXTERNAL_TOKEN_EMBEDDED')" href="../../../_constants/EXTERNAL_TOKEN_EMBEDDED.html" onMouseOver="constPopup(event,'EXTERNAL_TOKEN_EMBEDDED')">EXTERNAL_TOKEN_EMBEDDED</a>));
<a name="l501"><span class="linenum"> 501</span></a>          } catch (\Exception <a class="var it2583" onMouseOver="hilite(2583)" onMouseOut="lolite()" onClick="logVariable('ignored')" href="../../../_variables/ignored.html">$ignored</a>) {
<a name="l502"><span class="linenum"> 502</span></a>  <span class="comment">            // Probably install/upgrade - ignore this problem.</span>
<a name="l503"><span class="linenum"> 503</span></a>          }
<a name="l504"><span class="linenum"> 504</span></a>  
<a name="l505"><span class="linenum"> 505</span></a>  <span class="comment">        // Initialize variable to pass-by-reference to headers_sent(&amp;$file, &amp;$line).</span>
<a name="l506"><span class="linenum"> 506</span></a>          <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../../_variables/file.html">$file</a> = null;
<a name="l507"><span class="linenum"> 507</span></a>          <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../../_variables/line.html">$line</a> = null;
<a name="l508"><span class="linenum"> 508</span></a>          if (<a class="phpfunction" onClick="logFunction('headers_sent')" href="../../../_functions/headers_sent.html" onMouseOver="phpfuncPopup(event,'headers_sent')">headers_sent</a>(<a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../../_variables/file.html">$file</a>, <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../../_variables/line.html">$line</a>)) {
<a name="l509"><span class="linenum"> 509</span></a>              <a class="phpfunction" onClick="logFunction('error_log')" href="../../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>('Cannot terminate session properly - headers were already sent in file: '.<a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../../_variables/file.html">$file</a>.' on line '.<a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../../_variables/line.html">$line</a>);
<a name="l510"><span class="linenum"> 510</span></a>          }
<a name="l511"><span class="linenum"> 511</span></a>  
<a name="l512"><span class="linenum"> 512</span></a>  <span class="comment">        // Write new empty session and make sure the old one is deleted.</span>
<a name="l513"><span class="linenum"> 513</span></a>          <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a> = <a class="phpfunction" onClick="logFunction('session_id')" href="../../../_functions/session_id.html" onMouseOver="phpfuncPopup(event,'session_id')">session_id</a>();
<a name="l514"><span class="linenum"> 514</span></a>          <a class="phpfunction" onClick="logFunction('session_regenerate_id')" href="../../../_functions/session_regenerate_id.html" onMouseOver="phpfuncPopup(event,'session_regenerate_id')">session_regenerate_id</a>(true);
<a name="l515"><span class="linenum"> 515</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('sessions', array('sid'=&gt;<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a>));
<a name="l516"><span class="linenum"> 516</span></a>          self::<a class="function" onClick="logFunction('init_empty_session')" href="../../../_functions/init_empty_session.html" onMouseOver="funcPopup(event,'init_empty_session')">init_empty_session</a>();
<a name="l517"><span class="linenum"> 517</span></a>          self::<a class="function" onClick="logFunction('add_session_record')" href="../../../_functions/add_session_record.html" onMouseOver="funcPopup(event,'add_session_record')">add_session_record</a>(<a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['USER']-&gt;id); <span class="comment">// Do not use $USER here because it may not be set up yet.</span>
<a name="l518"><span class="linenum"> 518</span></a>          <a class="phpfunction" onClick="logFunction('session_write_close')" href="../../../_functions/session_write_close.html" onMouseOver="phpfuncPopup(event,'session_write_close')">session_write_close</a>();
<a name="l519"><span class="linenum"> 519</span></a>          self::<a class="var it39832" onMouseOver="hilite(39832)" onMouseOut="lolite()" onClick="logVariable('sessionactive')" href="../../../_variables/sessionactive.html">$sessionactive</a> = false;
<a name="l520"><span class="linenum"> 520</span></a>      }
<a name="l521"><span class="linenum"> 521</span></a>  
<a name="l522"><span class="linenum"> 522</span></a>      <span class="comment">/**</span>
<a name="l523"><span class="linenum"> 523</span></a>  <span class="comment">     * No more changes in session expected.</span>
<a name="l524"><span class="linenum"> 524</span></a>  <span class="comment">     * Unblocks the sessions, other scripts may start executing in parallel.</span>
<a name="l525"><span class="linenum"> 525</span></a>  <span class="comment">     */</span>
<a name="l526"><span class="linenum"> 526</span></a>      public static function <a class="function" onClick="logFunction('write_close')" href="../../../_functions/write_close.html" onMouseOver="funcPopup(event,'write_close')">write_close</a>() {
<a name="l527"><span class="linenum"> 527</span></a>          if (<a class="phpfunction" onClick="logFunction('version_compare')" href="../../../_functions/version_compare.html" onMouseOver="phpfuncPopup(event,'version_compare')">version_compare</a>(PHP_VERSION, '5.6.0', '&gt;=')) {
<a name="l528"><span class="linenum"> 528</span></a>  <span class="comment">            // More control over whether session data</span>
<a name="l529"><span class="linenum"> 529</span></a>  <span class="comment">            // is persisted or not.</span>
<a name="l530"><span class="linenum"> 530</span></a>              if (self::<a class="var it39832" onMouseOver="hilite(39832)" onMouseOut="lolite()" onClick="logVariable('sessionactive')" href="../../../_variables/sessionactive.html">$sessionactive</a> &amp;&amp; <a class="phpfunction" onClick="logFunction('session_id')" href="../../../_functions/session_id.html" onMouseOver="phpfuncPopup(event,'session_id')">session_id</a>()) {
<a name="l531"><span class="linenum"> 531</span></a>  <span class="comment">                // Write session and release lock only if</span>
<a name="l532"><span class="linenum"> 532</span></a>  <span class="comment">                // indication session start was clean.</span>
<a name="l533"><span class="linenum"> 533</span></a>                  <a class="phpfunction" onClick="logFunction('session_write_close')" href="../../../_functions/session_write_close.html" onMouseOver="phpfuncPopup(event,'session_write_close')">session_write_close</a>();
<a name="l534"><span class="linenum"> 534</span></a>              } else {
<a name="l535"><span class="linenum"> 535</span></a>  <span class="comment">                // Otherwise, if possibile lock exists want</span>
<a name="l536"><span class="linenum"> 536</span></a>  <span class="comment">                // to clear it, but do not write session.</span>
<a name="l537"><span class="linenum"> 537</span></a>                  @session_abort();
<a name="l538"><span class="linenum"> 538</span></a>              }
<a name="l539"><span class="linenum"> 539</span></a>          } else {
<a name="l540"><span class="linenum"> 540</span></a>  <span class="comment">            // Any indication session was started, attempt</span>
<a name="l541"><span class="linenum"> 541</span></a>  <span class="comment">            // to close it.</span>
<a name="l542"><span class="linenum"> 542</span></a>              if (self::<a class="var it39832" onMouseOver="hilite(39832)" onMouseOut="lolite()" onClick="logVariable('sessionactive')" href="../../../_variables/sessionactive.html">$sessionactive</a> || <a class="phpfunction" onClick="logFunction('session_id')" href="../../../_functions/session_id.html" onMouseOver="phpfuncPopup(event,'session_id')">session_id</a>()) {
<a name="l543"><span class="linenum"> 543</span></a>                  <a class="phpfunction" onClick="logFunction('session_write_close')" href="../../../_functions/session_write_close.html" onMouseOver="phpfuncPopup(event,'session_write_close')">session_write_close</a>();
<a name="l544"><span class="linenum"> 544</span></a>              }
<a name="l545"><span class="linenum"> 545</span></a>          }
<a name="l546"><span class="linenum"> 546</span></a>          self::<a class="var it39832" onMouseOver="hilite(39832)" onMouseOut="lolite()" onClick="logVariable('sessionactive')" href="../../../_variables/sessionactive.html">$sessionactive</a> = false;
<a name="l547"><span class="linenum"> 547</span></a>      }
<a name="l548"><span class="linenum"> 548</span></a>  
<a name="l549"><span class="linenum"> 549</span></a>      <span class="comment">/**</span>
<a name="l550"><span class="linenum"> 550</span></a>  <span class="comment">     * Does the PHP session with given id exist?</span>
<a name="l551"><span class="linenum"> 551</span></a>  <span class="comment">     *</span>
<a name="l552"><span class="linenum"> 552</span></a>  <span class="comment">     * The session must exist both in session table and actual</span>
<a name="l553"><span class="linenum"> 553</span></a>  <span class="comment">     * session backend and the session must not be timed out.</span>
<a name="l554"><span class="linenum"> 554</span></a>  <span class="comment">     *</span>
<a name="l555"><span class="linenum"> 555</span></a>  <span class="comment">     * Timeout evaluation is simplified, the auth hooks are not executed.</span>
<a name="l556"><span class="linenum"> 556</span></a>  <span class="comment">     *</span>
<a name="l557"><span class="linenum"> 557</span></a>  <span class="comment">     * @param string $sid</span>
<a name="l558"><span class="linenum"> 558</span></a>  <span class="comment">     * @return bool</span>
<a name="l559"><span class="linenum"> 559</span></a>  <span class="comment">     */</span>
<a name="l560"><span class="linenum"> 560</span></a>      public static function <a class="function" onClick="logFunction('session_exists')" href="../../../_functions/session_exists.html" onMouseOver="funcPopup(event,'session_exists')">session_exists</a>(<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a>) {
<a name="l561"><span class="linenum"> 561</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>;
<a name="l562"><span class="linenum"> 562</span></a>  
<a name="l563"><span class="linenum"> 563</span></a>          if (empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('version')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/version.html">version</a>)) {
<a name="l564"><span class="linenum"> 564</span></a>  <span class="comment">            // Not installed yet, do not try to access database.</span>
<a name="l565"><span class="linenum"> 565</span></a>              return false;
<a name="l566"><span class="linenum"> 566</span></a>          }
<a name="l567"><span class="linenum"> 567</span></a>  
<a name="l568"><span class="linenum"> 568</span></a>  <span class="comment">        // Note: add sessions-&gt;state checking here if it gets implemented.</span>
<a name="l569"><span class="linenum"> 569</span></a>          if (!<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('sessions', array('sid' =&gt; <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a>), 'id, userid, timemodified')) {
<a name="l570"><span class="linenum"> 570</span></a>              return false;
<a name="l571"><span class="linenum"> 571</span></a>          }
<a name="l572"><span class="linenum"> 572</span></a>  
<a name="l573"><span class="linenum"> 573</span></a>          if (empty(<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('userid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/userid.html">userid</a>) or <a class="function" onClick="logFunction('isguestuser')" href="../../../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>(<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('userid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/userid.html">userid</a>)) {
<a name="l574"><span class="linenum"> 574</span></a>  <span class="comment">            // Ignore guest and not-logged-in timeouts, there is very little risk here.</span>
<a name="l575"><span class="linenum"> 575</span></a>          } else if (<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('timemodified')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../_variables/timemodified.html">timemodified</a> &lt; <a class="phpfunction" onClick="logFunction('time')" href="../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() - <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessiontimeout')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessiontimeout.html">sessiontimeout</a>) {
<a name="l576"><span class="linenum"> 576</span></a>              return false;
<a name="l577"><span class="linenum"> 577</span></a>          }
<a name="l578"><span class="linenum"> 578</span></a>  
<a name="l579"><span class="linenum"> 579</span></a>  <span class="comment">        // There is no need the existence of handler storage in public API.</span>
<a name="l580"><span class="linenum"> 580</span></a>          self::<a class="function" onClick="logFunction('load_handler')" href="../../../_functions/load_handler.html" onMouseOver="funcPopup(event,'load_handler')">load_handler</a>();
<a name="l581"><span class="linenum"> 581</span></a>          return self::<a class="var it2691" onMouseOver="hilite(2691)" onMouseOut="lolite()" onClick="logVariable('handler')" href="../../../_variables/handler.html">$handler</a>-&gt;<a class="function" onClick="logFunction('session_exists')" href="../../../_functions/session_exists.html" onMouseOver="funcPopup(event,'session_exists')">session_exists</a>(<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a>);
<a name="l582"><span class="linenum"> 582</span></a>      }
<a name="l583"><span class="linenum"> 583</span></a>  
<a name="l584"><span class="linenum"> 584</span></a>      <span class="comment">/**</span>
<a name="l585"><span class="linenum"> 585</span></a>  <span class="comment">     * Fake last access for given session, this prevents session timeout.</span>
<a name="l586"><span class="linenum"> 586</span></a>  <span class="comment">     * @param string $sid</span>
<a name="l587"><span class="linenum"> 587</span></a>  <span class="comment">     */</span>
<a name="l588"><span class="linenum"> 588</span></a>      public static function <a class="function" onClick="logFunction('touch_session')" href="../../../_functions/touch_session.html" onMouseOver="funcPopup(event,'touch_session')">touch_session</a>(<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a>) {
<a name="l589"><span class="linenum"> 589</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l590"><span class="linenum"> 590</span></a>  
<a name="l591"><span class="linenum"> 591</span></a>  <span class="comment">        // Timeouts depend on core sessions table only, no need to update anything in external stores.</span>
<a name="l592"><span class="linenum"> 592</span></a>  
<a name="l593"><span class="linenum"> 593</span></a>          <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a> = &quot;UPDATE {sessions} SET timemodified = :now WHERE sid = :sid&quot;;
<a name="l594"><span class="linenum"> 594</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../../../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a>, array('now'=&gt;<a class="phpfunction" onClick="logFunction('time')" href="../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>(), 'sid'=&gt;<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a>));
<a name="l595"><span class="linenum"> 595</span></a>      }
<a name="l596"><span class="linenum"> 596</span></a>  
<a name="l597"><span class="linenum"> 597</span></a>      <span class="comment">/**</span>
<a name="l598"><span class="linenum"> 598</span></a>  <span class="comment">     * Terminate all sessions unconditionally.</span>
<a name="l599"><span class="linenum"> 599</span></a>  <span class="comment">     */</span>
<a name="l600"><span class="linenum"> 600</span></a>      public static function <a class="function" onClick="logFunction('kill_all_sessions')" href="../../../_functions/kill_all_sessions.html" onMouseOver="funcPopup(event,'kill_all_sessions')">kill_all_sessions</a>() {
<a name="l601"><span class="linenum"> 601</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l602"><span class="linenum"> 602</span></a>  
<a name="l603"><span class="linenum"> 603</span></a>          self::<a class="function" onClick="logFunction('terminate_current')" href="../../../_functions/terminate_current.html" onMouseOver="funcPopup(event,'terminate_current')">terminate_current</a>();
<a name="l604"><span class="linenum"> 604</span></a>  
<a name="l605"><span class="linenum"> 605</span></a>          self::<a class="function" onClick="logFunction('load_handler')" href="../../../_functions/load_handler.html" onMouseOver="funcPopup(event,'load_handler')">load_handler</a>();
<a name="l606"><span class="linenum"> 606</span></a>          self::<a class="var it2691" onMouseOver="hilite(2691)" onMouseOut="lolite()" onClick="logVariable('handler')" href="../../../_variables/handler.html">$handler</a>-&gt;<a class="function" onClick="logFunction('kill_all_sessions')" href="../../../_functions/kill_all_sessions.html" onMouseOver="funcPopup(event,'kill_all_sessions')">kill_all_sessions</a>();
<a name="l607"><span class="linenum"> 607</span></a>  
<a name="l608"><span class="linenum"> 608</span></a>          try {
<a name="l609"><span class="linenum"> 609</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('sessions');
<a name="l610"><span class="linenum"> 610</span></a>          } catch (\dml_exception <a class="var it2583" onMouseOver="hilite(2583)" onMouseOut="lolite()" onClick="logVariable('ignored')" href="../../../_variables/ignored.html">$ignored</a>) {
<a name="l611"><span class="linenum"> 611</span></a>  <span class="comment">            // Do not show any warnings - might be during upgrade/installation.</span>
<a name="l612"><span class="linenum"> 612</span></a>          }
<a name="l613"><span class="linenum"> 613</span></a>      }
<a name="l614"><span class="linenum"> 614</span></a>  
<a name="l615"><span class="linenum"> 615</span></a>      <span class="comment">/**</span>
<a name="l616"><span class="linenum"> 616</span></a>  <span class="comment">     * Terminate give session unconditionally.</span>
<a name="l617"><span class="linenum"> 617</span></a>  <span class="comment">     * @param string $sid</span>
<a name="l618"><span class="linenum"> 618</span></a>  <span class="comment">     */</span>
<a name="l619"><span class="linenum"> 619</span></a>      public static function <a class="function" onClick="logFunction('kill_session')" href="../../../_functions/kill_session.html" onMouseOver="funcPopup(event,'kill_session')">kill_session</a>(<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a>) {
<a name="l620"><span class="linenum"> 620</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l621"><span class="linenum"> 621</span></a>  
<a name="l622"><span class="linenum"> 622</span></a>          self::<a class="function" onClick="logFunction('load_handler')" href="../../../_functions/load_handler.html" onMouseOver="funcPopup(event,'load_handler')">load_handler</a>();
<a name="l623"><span class="linenum"> 623</span></a>  
<a name="l624"><span class="linenum"> 624</span></a>          if (<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a> === <a class="phpfunction" onClick="logFunction('session_id')" href="../../../_functions/session_id.html" onMouseOver="phpfuncPopup(event,'session_id')">session_id</a>()) {
<a name="l625"><span class="linenum"> 625</span></a>              self::<a class="function" onClick="logFunction('write_close')" href="../../../_functions/write_close.html" onMouseOver="funcPopup(event,'write_close')">write_close</a>();
<a name="l626"><span class="linenum"> 626</span></a>          }
<a name="l627"><span class="linenum"> 627</span></a>  
<a name="l628"><span class="linenum"> 628</span></a>          self::<a class="var it2691" onMouseOver="hilite(2691)" onMouseOut="lolite()" onClick="logVariable('handler')" href="../../../_variables/handler.html">$handler</a>-&gt;<a class="function" onClick="logFunction('kill_session')" href="../../../_functions/kill_session.html" onMouseOver="funcPopup(event,'kill_session')">kill_session</a>(<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a>);
<a name="l629"><span class="linenum"> 629</span></a>  
<a name="l630"><span class="linenum"> 630</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('sessions', array('sid'=&gt;<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a>));
<a name="l631"><span class="linenum"> 631</span></a>      }
<a name="l632"><span class="linenum"> 632</span></a>  
<a name="l633"><span class="linenum"> 633</span></a>      <span class="comment">/**</span>
<a name="l634"><span class="linenum"> 634</span></a>  <span class="comment">     * Terminate all sessions of given user unconditionally.</span>
<a name="l635"><span class="linenum"> 635</span></a>  <span class="comment">     * @param int $userid</span>
<a name="l636"><span class="linenum"> 636</span></a>  <span class="comment">     * @param string $keepsid keep this sid if present</span>
<a name="l637"><span class="linenum"> 637</span></a>  <span class="comment">     */</span>
<a name="l638"><span class="linenum"> 638</span></a>      public static function <a class="function" onClick="logFunction('kill_user_sessions')" href="../../../_functions/kill_user_sessions.html" onMouseOver="funcPopup(event,'kill_user_sessions')">kill_user_sessions</a>(<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a>, <a class="var it39838" onMouseOver="hilite(39838)" onMouseOut="lolite()" onClick="logVariable('keepsid')" href="../../../_variables/keepsid.html">$keepsid</a> = null) {
<a name="l639"><span class="linenum"> 639</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l640"><span class="linenum"> 640</span></a>  
<a name="l641"><span class="linenum"> 641</span></a>          <a class="var it3363" onMouseOver="hilite(3363)" onMouseOut="lolite()" onClick="logVariable('sessions')" href="../../../_variables/sessions.html">$sessions</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('sessions', array('userid'=&gt;<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a>), 'id DESC', 'id, sid');
<a name="l642"><span class="linenum"> 642</span></a>          foreach (<a class="var it3363" onMouseOver="hilite(3363)" onMouseOut="lolite()" onClick="logVariable('sessions')" href="../../../_variables/sessions.html">$sessions</a> as <a class="var it2387" onMouseOver="hilite(2387)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../_variables/session.html">$session</a>) {
<a name="l643"><span class="linenum"> 643</span></a>              if (<a class="var it39838" onMouseOver="hilite(39838)" onMouseOut="lolite()" onClick="logVariable('keepsid')" href="../../../_variables/keepsid.html">$keepsid</a> and <a class="var it39838" onMouseOver="hilite(39838)" onMouseOut="lolite()" onClick="logVariable('keepsid')" href="../../../_variables/keepsid.html">$keepsid</a> === <a class="var it2387" onMouseOver="hilite(2387)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../_variables/session.html">$session</a>-&gt;<a onClick="logVariable('sid')" class="var it43343" onMouseOver="hilite(43343)" onMouseOut="lolite()" href="../../../_variables/sid.html">sid</a>) {
<a name="l644"><span class="linenum"> 644</span></a>                  continue;
<a name="l645"><span class="linenum"> 645</span></a>              }
<a name="l646"><span class="linenum"> 646</span></a>              self::<a class="function" onClick="logFunction('kill_session')" href="../../../_functions/kill_session.html" onMouseOver="funcPopup(event,'kill_session')">kill_session</a>(<a class="var it2387" onMouseOver="hilite(2387)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../_variables/session.html">$session</a>-&gt;<a onClick="logVariable('sid')" class="var it43343" onMouseOver="hilite(43343)" onMouseOut="lolite()" href="../../../_variables/sid.html">sid</a>);
<a name="l647"><span class="linenum"> 647</span></a>          }
<a name="l648"><span class="linenum"> 648</span></a>      }
<a name="l649"><span class="linenum"> 649</span></a>  
<a name="l650"><span class="linenum"> 650</span></a>      <span class="comment">/**</span>
<a name="l651"><span class="linenum"> 651</span></a>  <span class="comment">     * Terminate other sessions of current user depending</span>
<a name="l652"><span class="linenum"> 652</span></a>  <span class="comment">     * on $CFG-&gt;limitconcurrentlogins restriction.</span>
<a name="l653"><span class="linenum"> 653</span></a>  <span class="comment">     *</span>
<a name="l654"><span class="linenum"> 654</span></a>  <span class="comment">     * This is expected to be called right after complete_user_login().</span>
<a name="l655"><span class="linenum"> 655</span></a>  <span class="comment">     *</span>
<a name="l656"><span class="linenum"> 656</span></a>  <span class="comment">     * NOTE:</span>
<a name="l657"><span class="linenum"> 657</span></a>  <span class="comment">     *  * Do not use from SSO auth plugins, this would not work.</span>
<a name="l658"><span class="linenum"> 658</span></a>  <span class="comment">     *  * Do not use from web services because they do not have sessions.</span>
<a name="l659"><span class="linenum"> 659</span></a>  <span class="comment">     *</span>
<a name="l660"><span class="linenum"> 660</span></a>  <span class="comment">     * @param int $userid</span>
<a name="l661"><span class="linenum"> 661</span></a>  <span class="comment">     * @param string $sid session id to be always keep, usually the current one</span>
<a name="l662"><span class="linenum"> 662</span></a>  <span class="comment">     * @return void</span>
<a name="l663"><span class="linenum"> 663</span></a>  <span class="comment">     */</span>
<a name="l664"><span class="linenum"> 664</span></a>      public static function <a class="function" onClick="logFunction('apply_concurrent_login_limit')" href="../../../_functions/apply_concurrent_login_limit.html" onMouseOver="funcPopup(event,'apply_concurrent_login_limit')">apply_concurrent_login_limit</a>(<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a>, <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a> = null) {
<a name="l665"><span class="linenum"> 665</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l666"><span class="linenum"> 666</span></a>  
<a name="l667"><span class="linenum"> 667</span></a>  <span class="comment">        // NOTE: the $sid parameter is here mainly to allow testing,</span>
<a name="l668"><span class="linenum"> 668</span></a>  <span class="comment">        //       in most cases it should be current session id.</span>
<a name="l669"><span class="linenum"> 669</span></a>  
<a name="l670"><span class="linenum"> 670</span></a>          if (<a class="function" onClick="logFunction('isguestuser')" href="../../../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>(<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a>) or empty(<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a>)) {
<a name="l671"><span class="linenum"> 671</span></a>  <span class="comment">            // This applies to real users only!</span>
<a name="l672"><span class="linenum"> 672</span></a>              return;
<a name="l673"><span class="linenum"> 673</span></a>          }
<a name="l674"><span class="linenum"> 674</span></a>  
<a name="l675"><span class="linenum"> 675</span></a>          if (empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('limitconcurrentlogins')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/limitconcurrentlogins.html">limitconcurrentlogins</a>) or <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('limitconcurrentlogins')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/limitconcurrentlogins.html">limitconcurrentlogins</a> &lt; 0) {
<a name="l676"><span class="linenum"> 676</span></a>              return;
<a name="l677"><span class="linenum"> 677</span></a>          }
<a name="l678"><span class="linenum"> 678</span></a>  
<a name="l679"><span class="linenum"> 679</span></a>          <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../../_variables/count.html">$count</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records')" href="../../../_functions/count_records.html" onMouseOver="funcPopup(event,'count_records')">count_records</a>('sessions', array('userid' =&gt; <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a>));
<a name="l680"><span class="linenum"> 680</span></a>  
<a name="l681"><span class="linenum"> 681</span></a>          if (<a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../../_variables/count.html">$count</a> &lt;= <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('limitconcurrentlogins')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/limitconcurrentlogins.html">limitconcurrentlogins</a>) {
<a name="l682"><span class="linenum"> 682</span></a>              return;
<a name="l683"><span class="linenum"> 683</span></a>          }
<a name="l684"><span class="linenum"> 684</span></a>  
<a name="l685"><span class="linenum"> 685</span></a>          <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../../_variables/i.html">$i</a> = 0;
<a name="l686"><span class="linenum"> 686</span></a>          <a class="var it1047" onMouseOver="hilite(1047)" onMouseOut="lolite()" onClick="logVariable('select')" href="../../../_variables/select.html">$select</a> = &quot;userid = :userid&quot;;
<a name="l687"><span class="linenum"> 687</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a> = array('userid' =&gt; <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a>);
<a name="l688"><span class="linenum"> 688</span></a>          if (<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a>) {
<a name="l689"><span class="linenum"> 689</span></a>              if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('record_exists')" href="../../../_functions/record_exists.html" onMouseOver="funcPopup(event,'record_exists')">record_exists</a>('sessions', array('sid' =&gt; <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a>, 'userid' =&gt; <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a>))) {
<a name="l690"><span class="linenum"> 690</span></a>                  <a class="var it1047" onMouseOver="hilite(1047)" onMouseOut="lolite()" onClick="logVariable('select')" href="../../../_variables/select.html">$select</a> .= &quot; AND sid &lt;&gt; :sid&quot;;
<a name="l691"><span class="linenum"> 691</span></a>                  <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>['sid'] = <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('sid')" href="../../../_variables/sid.html">$sid</a>;
<a name="l692"><span class="linenum"> 692</span></a>                  <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../../_variables/i.html">$i</a> = 1;
<a name="l693"><span class="linenum"> 693</span></a>              }
<a name="l694"><span class="linenum"> 694</span></a>          }
<a name="l695"><span class="linenum"> 695</span></a>  
<a name="l696"><span class="linenum"> 696</span></a>          <a class="var it3363" onMouseOver="hilite(3363)" onMouseOut="lolite()" onClick="logVariable('sessions')" href="../../../_variables/sessions.html">$sessions</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_select')" href="../../../_functions/get_records_select.html" onMouseOver="funcPopup(event,'get_records_select')">get_records_select</a>('sessions', <a class="var it1047" onMouseOver="hilite(1047)" onMouseOut="lolite()" onClick="logVariable('select')" href="../../../_variables/select.html">$select</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>, 'timecreated DESC', 'id, sid');
<a name="l697"><span class="linenum"> 697</span></a>          foreach (<a class="var it3363" onMouseOver="hilite(3363)" onMouseOut="lolite()" onClick="logVariable('sessions')" href="../../../_variables/sessions.html">$sessions</a> as <a class="var it2387" onMouseOver="hilite(2387)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../_variables/session.html">$session</a>) {
<a name="l698"><span class="linenum"> 698</span></a>              <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../../_variables/i.html">$i</a>++;
<a name="l699"><span class="linenum"> 699</span></a>              if (<a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../../_variables/i.html">$i</a> &lt;= <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('limitconcurrentlogins')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/limitconcurrentlogins.html">limitconcurrentlogins</a>) {
<a name="l700"><span class="linenum"> 700</span></a>                  continue;
<a name="l701"><span class="linenum"> 701</span></a>              }
<a name="l702"><span class="linenum"> 702</span></a>              self::<a class="function" onClick="logFunction('kill_session')" href="../../../_functions/kill_session.html" onMouseOver="funcPopup(event,'kill_session')">kill_session</a>(<a class="var it2387" onMouseOver="hilite(2387)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../_variables/session.html">$session</a>-&gt;<a onClick="logVariable('sid')" class="var it43343" onMouseOver="hilite(43343)" onMouseOut="lolite()" href="../../../_variables/sid.html">sid</a>);
<a name="l703"><span class="linenum"> 703</span></a>          }
<a name="l704"><span class="linenum"> 704</span></a>      }
<a name="l705"><span class="linenum"> 705</span></a>  
<a name="l706"><span class="linenum"> 706</span></a>      <span class="comment">/**</span>
<a name="l707"><span class="linenum"> 707</span></a>  <span class="comment">     * Set current user.</span>
<a name="l708"><span class="linenum"> 708</span></a>  <span class="comment">     *</span>
<a name="l709"><span class="linenum"> 709</span></a>  <span class="comment">     * @param \stdClass $user record</span>
<a name="l710"><span class="linenum"> 710</span></a>  <span class="comment">     */</span>
<a name="l711"><span class="linenum"> 711</span></a>      public static function <a class="function" onClick="logFunction('set_user')" href="../../../_functions/set_user.html" onMouseOver="funcPopup(event,'set_user')">set_user</a>(\stdClass <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>) {
<a name="l712"><span class="linenum"> 712</span></a>          <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['USER'] = <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>;
<a name="l713"><span class="linenum"> 713</span></a>          unset(<a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['USER']-&gt;description); <span class="comment">// Conserve memory.</span>
<a name="l714"><span class="linenum"> 714</span></a>          unset(<a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['USER']-&gt;password);    <span class="comment">// Improve security.</span>
<a name="l715"><span class="linenum"> 715</span></a>          if (isset(<a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['USER']-&gt;lang)) {
<a name="l716"><span class="linenum"> 716</span></a>  <span class="comment">            // Make sure it is a valid lang pack name.</span>
<a name="l717"><span class="linenum"> 717</span></a>              <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['USER']-&gt;lang = <a class="function" onClick="logFunction('clean_param')" href="../../../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['USER']-&gt;lang, <a class="constant" onClick="logConstant('PARAM_LANG')" href="../../../_constants/PARAM_LANG.html" onMouseOver="constPopup(event,'PARAM_LANG')">PARAM_LANG</a>);
<a name="l718"><span class="linenum"> 718</span></a>          }
<a name="l719"><span class="linenum"> 719</span></a>  
<a name="l720"><span class="linenum"> 720</span></a>  <span class="comment">        // Relink session with global $USER just in case it got unlinked somehow.</span>
<a name="l721"><span class="linenum"> 721</span></a>          <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['USER'] =&amp; <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['USER'];
<a name="l722"><span class="linenum"> 722</span></a>  
<a name="l723"><span class="linenum"> 723</span></a>  <span class="comment">        // Init session key.</span>
<a name="l724"><span class="linenum"> 724</span></a>          <a class="function" onClick="logFunction('sesskey')" href="../../../_functions/sesskey.html" onMouseOver="funcPopup(event,'sesskey')">sesskey</a>();
<a name="l725"><span class="linenum"> 725</span></a>      }
<a name="l726"><span class="linenum"> 726</span></a>  
<a name="l727"><span class="linenum"> 727</span></a>      <span class="comment">/**</span>
<a name="l728"><span class="linenum"> 728</span></a>  <span class="comment">     * Periodic timed-out session cleanup.</span>
<a name="l729"><span class="linenum"> 729</span></a>  <span class="comment">     */</span>
<a name="l730"><span class="linenum"> 730</span></a>      public static function <a class="function" onClick="logFunction('gc')" href="../../../_functions/gc.html" onMouseOver="funcPopup(event,'gc')">gc</a>() {
<a name="l731"><span class="linenum"> 731</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l732"><span class="linenum"> 732</span></a>  
<a name="l733"><span class="linenum"> 733</span></a>  <span class="comment">        // This may take a long time...</span>
<a name="l734"><span class="linenum"> 734</span></a>          \<a class="class" onClick="logClass('core_php_time_limit')" href="../../../_classes/core_php_time_limit.html" onMouseOver="classPopup(event,'core_php_time_limit')">core_php_time_limit</a>::<a class="function" onClick="logFunction('raise')" href="../../../_functions/raise.html" onMouseOver="funcPopup(event,'raise')">raise</a>();
<a name="l735"><span class="linenum"> 735</span></a>  
<a name="l736"><span class="linenum"> 736</span></a>          <a class="var it16246" onMouseOver="hilite(16246)" onMouseOut="lolite()" onClick="logVariable('maxlifetime')" href="../../../_variables/maxlifetime.html">$maxlifetime</a> = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessiontimeout')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessiontimeout.html">sessiontimeout</a>;
<a name="l737"><span class="linenum"> 737</span></a>  
<a name="l738"><span class="linenum"> 738</span></a>          try {
<a name="l739"><span class="linenum"> 739</span></a>  <span class="comment">            // Kill all sessions of deleted and suspended users without any hesitation.</span>
<a name="l740"><span class="linenum"> 740</span></a>              <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset_select')" href="../../../_functions/get_recordset_select.html" onMouseOver="funcPopup(event,'get_recordset_select')">get_recordset_select</a>('sessions', &quot;userid IN (SELECT id FROM {user} WHERE deleted &lt;&gt; 0 OR suspended &lt;&gt; 0)&quot;, array(), 'id DESC', 'id, sid');
<a name="l741"><span class="linenum"> 741</span></a>              foreach (<a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> as <a class="var it2387" onMouseOver="hilite(2387)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../_variables/session.html">$session</a>) {
<a name="l742"><span class="linenum"> 742</span></a>                  self::<a class="function" onClick="logFunction('kill_session')" href="../../../_functions/kill_session.html" onMouseOver="funcPopup(event,'kill_session')">kill_session</a>(<a class="var it2387" onMouseOver="hilite(2387)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../_variables/session.html">$session</a>-&gt;<a onClick="logVariable('sid')" class="var it43343" onMouseOver="hilite(43343)" onMouseOut="lolite()" href="../../../_variables/sid.html">sid</a>);
<a name="l743"><span class="linenum"> 743</span></a>              }
<a name="l744"><span class="linenum"> 744</span></a>              <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l745"><span class="linenum"> 745</span></a>  
<a name="l746"><span class="linenum"> 746</span></a>  <span class="comment">            // Kill sessions of users with disabled plugins.</span>
<a name="l747"><span class="linenum"> 747</span></a>              <a class="var it39840" onMouseOver="hilite(39840)" onMouseOut="lolite()" onClick="logVariable('auth_sequence')" href="../../../_variables/auth_sequence.html">$auth_sequence</a> = <a class="function" onClick="logFunction('get_enabled_auth_plugins')" href="../../../_functions/get_enabled_auth_plugins.html" onMouseOver="funcPopup(event,'get_enabled_auth_plugins')">get_enabled_auth_plugins</a>(true);
<a name="l748"><span class="linenum"> 748</span></a>              <a class="var it39840" onMouseOver="hilite(39840)" onMouseOut="lolite()" onClick="logVariable('auth_sequence')" href="../../../_variables/auth_sequence.html">$auth_sequence</a> = <a class="phpfunction" onClick="logFunction('array_flip')" href="../../../_functions/array_flip.html" onMouseOver="phpfuncPopup(event,'array_flip')">array_flip</a>(<a class="var it39840" onMouseOver="hilite(39840)" onMouseOut="lolite()" onClick="logVariable('auth_sequence')" href="../../../_variables/auth_sequence.html">$auth_sequence</a>);
<a name="l749"><span class="linenum"> 749</span></a>              unset(<a class="var it39840" onMouseOver="hilite(39840)" onMouseOut="lolite()" onClick="logVariable('auth_sequence')" href="../../../_variables/auth_sequence.html">$auth_sequence</a>['nologin']); <span class="comment">// No login means user cannot login.</span>
<a name="l750"><span class="linenum"> 750</span></a>              <a class="var it39840" onMouseOver="hilite(39840)" onMouseOut="lolite()" onClick="logVariable('auth_sequence')" href="../../../_variables/auth_sequence.html">$auth_sequence</a> = <a class="phpfunction" onClick="logFunction('array_flip')" href="../../../_functions/array_flip.html" onMouseOver="phpfuncPopup(event,'array_flip')">array_flip</a>(<a class="var it39840" onMouseOver="hilite(39840)" onMouseOut="lolite()" onClick="logVariable('auth_sequence')" href="../../../_variables/auth_sequence.html">$auth_sequence</a>);
<a name="l751"><span class="linenum"> 751</span></a>  
<a name="l752"><span class="linenum"> 752</span></a>              <a class="function" onClick="logFunction('list')" href="../../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it39841" onMouseOver="hilite(39841)" onMouseOut="lolite()" onClick="logVariable('notplugins')" href="../../../_variables/notplugins.html">$notplugins</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>) = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it39840" onMouseOver="hilite(39840)" onMouseOut="lolite()" onClick="logVariable('auth_sequence')" href="../../../_variables/auth_sequence.html">$auth_sequence</a>, <a class="constant" onClick="logConstant('SQL_PARAMS_QM')" href="../../../_constants/SQL_PARAMS_QM.html" onMouseOver="constPopup(event,'SQL_PARAMS_QM')">SQL_PARAMS_QM</a>, '', false);
<a name="l753"><span class="linenum"> 753</span></a>              <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset_select')" href="../../../_functions/get_recordset_select.html" onMouseOver="funcPopup(event,'get_recordset_select')">get_recordset_select</a>('sessions', &quot;userid IN (SELECT id FROM {user} WHERE auth <a class="var it39841" onMouseOver="hilite(39841)" onMouseOut="lolite()" onClick="logVariable('notplugins')" href="../../../_variables/notplugins.html">$notplugins</a>)&quot;, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>, 'id DESC', 'id, sid');
<a name="l754"><span class="linenum"> 754</span></a>              foreach (<a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> as <a class="var it2387" onMouseOver="hilite(2387)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../_variables/session.html">$session</a>) {
<a name="l755"><span class="linenum"> 755</span></a>                  self::<a class="function" onClick="logFunction('kill_session')" href="../../../_functions/kill_session.html" onMouseOver="funcPopup(event,'kill_session')">kill_session</a>(<a class="var it2387" onMouseOver="hilite(2387)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../_variables/session.html">$session</a>-&gt;<a onClick="logVariable('sid')" class="var it43343" onMouseOver="hilite(43343)" onMouseOut="lolite()" href="../../../_variables/sid.html">sid</a>);
<a name="l756"><span class="linenum"> 756</span></a>              }
<a name="l757"><span class="linenum"> 757</span></a>              <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l758"><span class="linenum"> 758</span></a>  
<a name="l759"><span class="linenum"> 759</span></a>  <span class="comment">            // Now get a list of time-out candidates - real users only.</span>
<a name="l760"><span class="linenum"> 760</span></a>              <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a> = &quot;SELECT u.*, s.sid, s.timecreated AS s_timecreated, s.timemodified AS s_timemodified
<a name="l761"><span class="linenum"> 761</span></a>                        FROM {user} u
<a name="l762"><span class="linenum"> 762</span></a>                        JOIN {sessions} s ON s.userid = u.id
<a name="l763"><span class="linenum"> 763</span></a>                       WHERE s.timemodified &lt; :purgebefore AND u.id &lt;&gt; :guestid&quot;;
<a name="l764"><span class="linenum"> 764</span></a>              <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a> = array('purgebefore' =&gt; (<a class="phpfunction" onClick="logFunction('time')" href="../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() - <a class="var it16246" onMouseOver="hilite(16246)" onMouseOut="lolite()" onClick="logVariable('maxlifetime')" href="../../../_variables/maxlifetime.html">$maxlifetime</a>), 'guestid'=&gt;<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('siteguest')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/siteguest.html">siteguest</a>);
<a name="l765"><span class="linenum"> 765</span></a>  
<a name="l766"><span class="linenum"> 766</span></a>              <a class="var it13826" onMouseOver="hilite(13826)" onMouseOut="lolite()" onClick="logVariable('authplugins')" href="../../../_variables/authplugins.html">$authplugins</a> = array();
<a name="l767"><span class="linenum"> 767</span></a>              foreach (<a class="var it39840" onMouseOver="hilite(39840)" onMouseOut="lolite()" onClick="logVariable('auth_sequence')" href="../../../_variables/auth_sequence.html">$auth_sequence</a> as <a class="var it364" onMouseOver="hilite(364)" onMouseOut="lolite()" onClick="logVariable('authname')" href="../../../_variables/authname.html">$authname</a>) {
<a name="l768"><span class="linenum"> 768</span></a>                  <a class="var it13826" onMouseOver="hilite(13826)" onMouseOut="lolite()" onClick="logVariable('authplugins')" href="../../../_variables/authplugins.html">$authplugins</a>[<a class="var it364" onMouseOver="hilite(364)" onMouseOut="lolite()" onClick="logVariable('authname')" href="../../../_variables/authname.html">$authname</a>] = <a class="function" onClick="logFunction('get_auth_plugin')" href="../../../_functions/get_auth_plugin.html" onMouseOver="funcPopup(event,'get_auth_plugin')">get_auth_plugin</a>(<a class="var it364" onMouseOver="hilite(364)" onMouseOut="lolite()" onClick="logVariable('authname')" href="../../../_variables/authname.html">$authname</a>);
<a name="l769"><span class="linenum"> 769</span></a>              }
<a name="l770"><span class="linenum"> 770</span></a>              <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset_sql')" href="../../../_functions/get_recordset_sql.html" onMouseOver="funcPopup(event,'get_recordset_sql')">get_recordset_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>);
<a name="l771"><span class="linenum"> 771</span></a>              foreach (<a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> as <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>) {
<a name="l772"><span class="linenum"> 772</span></a>                  foreach (<a class="var it13826" onMouseOver="hilite(13826)" onMouseOut="lolite()" onClick="logVariable('authplugins')" href="../../../_variables/authplugins.html">$authplugins</a> as <a class="var it365" onMouseOver="hilite(365)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../../../_variables/authplugin.html">$authplugin</a>) {
<a name="l773"><span class="linenum"> 773</span></a>  <span class="comment">                    /** @var \auth_plugin_base $authplugin*/</span>
<a name="l774"><span class="linenum"> 774</span></a>                      if (<a class="var it365" onMouseOver="hilite(365)" onMouseOut="lolite()" onClick="logVariable('authplugin')" href="../../../_variables/authplugin.html">$authplugin</a>-&gt;<a class="function" onClick="logFunction('ignore_timeout_hook')" href="../../../_functions/ignore_timeout_hook.html" onMouseOver="funcPopup(event,'ignore_timeout_hook')">ignore_timeout_hook</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('sid')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../../_variables/sid.html">sid</a>, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('s_timecreated')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../../_variables/s_timecreated.html">s_timecreated</a>, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('s_timemodified')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../../_variables/s_timemodified.html">s_timemodified</a>)) {
<a name="l775"><span class="linenum"> 775</span></a>                          continue;
<a name="l776"><span class="linenum"> 776</span></a>                      }
<a name="l777"><span class="linenum"> 777</span></a>                  }
<a name="l778"><span class="linenum"> 778</span></a>                  self::<a class="function" onClick="logFunction('kill_session')" href="../../../_functions/kill_session.html" onMouseOver="funcPopup(event,'kill_session')">kill_session</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('sid')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../../_variables/sid.html">sid</a>);
<a name="l779"><span class="linenum"> 779</span></a>              }
<a name="l780"><span class="linenum"> 780</span></a>              <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l781"><span class="linenum"> 781</span></a>  
<a name="l782"><span class="linenum"> 782</span></a>  <span class="comment">            // Delete expired sessions for guest user account, give them larger timeout, there is no security risk here.</span>
<a name="l783"><span class="linenum"> 783</span></a>              <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a> = array('purgebefore' =&gt; (<a class="phpfunction" onClick="logFunction('time')" href="../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() - (<a class="var it16246" onMouseOver="hilite(16246)" onMouseOut="lolite()" onClick="logVariable('maxlifetime')" href="../../../_variables/maxlifetime.html">$maxlifetime</a> * 5)), 'guestid'=&gt;<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('siteguest')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/siteguest.html">siteguest</a>);
<a name="l784"><span class="linenum"> 784</span></a>              <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset_select')" href="../../../_functions/get_recordset_select.html" onMouseOver="funcPopup(event,'get_recordset_select')">get_recordset_select</a>('sessions', 'userid = :guestid AND timemodified &lt; :purgebefore', <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>, 'id DESC', 'id, sid');
<a name="l785"><span class="linenum"> 785</span></a>              foreach (<a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> as <a class="var it2387" onMouseOver="hilite(2387)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../_variables/session.html">$session</a>) {
<a name="l786"><span class="linenum"> 786</span></a>                  self::<a class="function" onClick="logFunction('kill_session')" href="../../../_functions/kill_session.html" onMouseOver="funcPopup(event,'kill_session')">kill_session</a>(<a class="var it2387" onMouseOver="hilite(2387)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../_variables/session.html">$session</a>-&gt;<a onClick="logVariable('sid')" class="var it43343" onMouseOver="hilite(43343)" onMouseOut="lolite()" href="../../../_variables/sid.html">sid</a>);
<a name="l787"><span class="linenum"> 787</span></a>              }
<a name="l788"><span class="linenum"> 788</span></a>              <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l789"><span class="linenum"> 789</span></a>  
<a name="l790"><span class="linenum"> 790</span></a>  <span class="comment">            // Delete expired sessions for userid = 0 (not logged in), better kill them asap to release memory.</span>
<a name="l791"><span class="linenum"> 791</span></a>              <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a> = array('purgebefore' =&gt; (<a class="phpfunction" onClick="logFunction('time')" href="../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() - <a class="var it16246" onMouseOver="hilite(16246)" onMouseOut="lolite()" onClick="logVariable('maxlifetime')" href="../../../_variables/maxlifetime.html">$maxlifetime</a>));
<a name="l792"><span class="linenum"> 792</span></a>              <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset_select')" href="../../../_functions/get_recordset_select.html" onMouseOver="funcPopup(event,'get_recordset_select')">get_recordset_select</a>('sessions', 'userid = 0 AND timemodified &lt; :purgebefore', <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>, 'id DESC', 'id, sid');
<a name="l793"><span class="linenum"> 793</span></a>              foreach (<a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> as <a class="var it2387" onMouseOver="hilite(2387)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../_variables/session.html">$session</a>) {
<a name="l794"><span class="linenum"> 794</span></a>                  self::<a class="function" onClick="logFunction('kill_session')" href="../../../_functions/kill_session.html" onMouseOver="funcPopup(event,'kill_session')">kill_session</a>(<a class="var it2387" onMouseOver="hilite(2387)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../_variables/session.html">$session</a>-&gt;<a onClick="logVariable('sid')" class="var it43343" onMouseOver="hilite(43343)" onMouseOut="lolite()" href="../../../_variables/sid.html">sid</a>);
<a name="l795"><span class="linenum"> 795</span></a>              }
<a name="l796"><span class="linenum"> 796</span></a>              <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l797"><span class="linenum"> 797</span></a>  
<a name="l798"><span class="linenum"> 798</span></a>  <span class="comment">            // Cleanup letfovers from the first browser access because it may set multiple cookies and then use only one.</span>
<a name="l799"><span class="linenum"> 799</span></a>              <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a> = array('purgebefore' =&gt; (<a class="phpfunction" onClick="logFunction('time')" href="../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() - 60*3));
<a name="l800"><span class="linenum"> 800</span></a>              <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset_select')" href="../../../_functions/get_recordset_select.html" onMouseOver="funcPopup(event,'get_recordset_select')">get_recordset_select</a>('sessions', 'userid = 0 AND timemodified = timecreated AND timemodified &lt; :purgebefore', <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>, 'id ASC', 'id, sid');
<a name="l801"><span class="linenum"> 801</span></a>              foreach (<a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> as <a class="var it2387" onMouseOver="hilite(2387)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../_variables/session.html">$session</a>) {
<a name="l802"><span class="linenum"> 802</span></a>                  self::<a class="function" onClick="logFunction('kill_session')" href="../../../_functions/kill_session.html" onMouseOver="funcPopup(event,'kill_session')">kill_session</a>(<a class="var it2387" onMouseOver="hilite(2387)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../_variables/session.html">$session</a>-&gt;<a onClick="logVariable('sid')" class="var it43343" onMouseOver="hilite(43343)" onMouseOut="lolite()" href="../../../_variables/sid.html">sid</a>);
<a name="l803"><span class="linenum"> 803</span></a>              }
<a name="l804"><span class="linenum"> 804</span></a>              <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l805"><span class="linenum"> 805</span></a>  
<a name="l806"><span class="linenum"> 806</span></a>          } catch (\Exception <a class="var it341" onMouseOver="hilite(341)" onMouseOut="lolite()" onClick="logVariable('ex')" href="../../../_variables/ex.html">$ex</a>) {
<a name="l807"><span class="linenum"> 807</span></a>              <a class="function" onClick="logFunction('debugging')" href="../../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Error gc-ing sessions: '.<a class="var it341" onMouseOver="hilite(341)" onMouseOut="lolite()" onClick="logVariable('ex')" href="../../../_variables/ex.html">$ex</a>-&gt;<a class="function" onClick="logFunction('getMessage')" href="../../../_functions/getmessage.html" onMouseOver="funcPopup(event,'getmessage')">getMessage</a>(), <a class="constant" onClick="logConstant('DEBUG_NORMAL')" href="../../../_constants/DEBUG_NORMAL.html" onMouseOver="constPopup(event,'DEBUG_NORMAL')">DEBUG_NORMAL</a>, <a class="var it341" onMouseOver="hilite(341)" onMouseOut="lolite()" onClick="logVariable('ex')" href="../../../_variables/ex.html">$ex</a>-&gt;getTrace());
<a name="l808"><span class="linenum"> 808</span></a>          }
<a name="l809"><span class="linenum"> 809</span></a>      }
<a name="l810"><span class="linenum"> 810</span></a>  
<a name="l811"><span class="linenum"> 811</span></a>      <span class="comment">/**</span>
<a name="l812"><span class="linenum"> 812</span></a>  <span class="comment">     * Is current $USER logged-in-as somebody else?</span>
<a name="l813"><span class="linenum"> 813</span></a>  <span class="comment">     * @return bool</span>
<a name="l814"><span class="linenum"> 814</span></a>  <span class="comment">     */</span>
<a name="l815"><span class="linenum"> 815</span></a>      public static function <a class="function" onClick="logFunction('is_loggedinas')" href="../../../_functions/is_loggedinas.html" onMouseOver="funcPopup(event,'is_loggedinas')">is_loggedinas</a>() {
<a name="l816"><span class="linenum"> 816</span></a>          return !empty(<a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['USER']-&gt;realuser);
<a name="l817"><span class="linenum"> 817</span></a>      }
<a name="l818"><span class="linenum"> 818</span></a>  
<a name="l819"><span class="linenum"> 819</span></a>      <span class="comment">/**</span>
<a name="l820"><span class="linenum"> 820</span></a>  <span class="comment">     * Returns the $USER object ignoring current login-as session</span>
<a name="l821"><span class="linenum"> 821</span></a>  <span class="comment">     * @return \stdClass user object</span>
<a name="l822"><span class="linenum"> 822</span></a>  <span class="comment">     */</span>
<a name="l823"><span class="linenum"> 823</span></a>      public static function <a class="function" onClick="logFunction('get_realuser')" href="../../../_functions/get_realuser.html" onMouseOver="funcPopup(event,'get_realuser')">get_realuser</a>() {
<a name="l824"><span class="linenum"> 824</span></a>          if (self::<a class="function" onClick="logFunction('is_loggedinas')" href="../../../_functions/is_loggedinas.html" onMouseOver="funcPopup(event,'is_loggedinas')">is_loggedinas</a>()) {
<a name="l825"><span class="linenum"> 825</span></a>              return <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['REALUSER'];
<a name="l826"><span class="linenum"> 826</span></a>          } else {
<a name="l827"><span class="linenum"> 827</span></a>              return <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['USER'];
<a name="l828"><span class="linenum"> 828</span></a>          }
<a name="l829"><span class="linenum"> 829</span></a>      }
<a name="l830"><span class="linenum"> 830</span></a>  
<a name="l831"><span class="linenum"> 831</span></a>      <span class="comment">/**</span>
<a name="l832"><span class="linenum"> 832</span></a>  <span class="comment">     * Login as another user - no security checks here.</span>
<a name="l833"><span class="linenum"> 833</span></a>  <span class="comment">     * @param int $userid</span>
<a name="l834"><span class="linenum"> 834</span></a>  <span class="comment">     * @param \context $context</span>
<a name="l835"><span class="linenum"> 835</span></a>  <span class="comment">     * @return void</span>
<a name="l836"><span class="linenum"> 836</span></a>  <span class="comment">     */</span>
<a name="l837"><span class="linenum"> 837</span></a>      public static function <a class="function" onClick="logFunction('loginas')" href="../../../_functions/loginas.html" onMouseOver="funcPopup(event,'loginas')">loginas</a>(<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a>, \context <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../_variables/context.html">$context</a>) {
<a name="l838"><span class="linenum"> 838</span></a>          global <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../../_variables/USER.html">$USER</a>;
<a name="l839"><span class="linenum"> 839</span></a>  
<a name="l840"><span class="linenum"> 840</span></a>          if (self::<a class="function" onClick="logFunction('is_loggedinas')" href="../../../_functions/is_loggedinas.html" onMouseOver="funcPopup(event,'is_loggedinas')">is_loggedinas</a>()) {
<a name="l841"><span class="linenum"> 841</span></a>              return;
<a name="l842"><span class="linenum"> 842</span></a>          }
<a name="l843"><span class="linenum"> 843</span></a>  
<a name="l844"><span class="linenum"> 844</span></a>  <span class="comment">        // Switch to fresh new $_SESSION.</span>
<a name="l845"><span class="linenum"> 845</span></a>          <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a> = array();
<a name="l846"><span class="linenum"> 846</span></a>          <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['REALSESSION'] = <a class="function" onClick="logFunction('clone')" href="../../../_functions/clone.html" onMouseOver="funcPopup(event,'clone')">clone</a>(<a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['SESSION']);
<a name="l847"><span class="linenum"> 847</span></a>          <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['SESSION'] = new \stdClass();
<a name="l848"><span class="linenum"> 848</span></a>          <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['SESSION'] =&amp; <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['SESSION'];
<a name="l849"><span class="linenum"> 849</span></a>  
<a name="l850"><span class="linenum"> 850</span></a>  <span class="comment">        // Create the new $USER object with all details and reload needed capabilities.</span>
<a name="l851"><span class="linenum"> 851</span></a>          <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['REALUSER'] = <a class="function" onClick="logFunction('clone')" href="../../../_functions/clone.html" onMouseOver="funcPopup(event,'clone')">clone</a>(<a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../../_variables/GLOBALS.html">$GLOBALS</a>['USER']);
<a name="l852"><span class="linenum"> 852</span></a>          <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a> = <a class="function" onClick="logFunction('get_complete_user_data')" href="../../../_functions/get_complete_user_data.html" onMouseOver="funcPopup(event,'get_complete_user_data')">get_complete_user_data</a>('id', <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a>);
<a name="l853"><span class="linenum"> 853</span></a>          <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('realuser')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../../_variables/realuser.html">realuser</a>       = <a class="var it3197" onMouseOver="hilite(3197)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../../../_variables/_SESSION.html">$_SESSION</a>['REALUSER']-&gt;id;
<a name="l854"><span class="linenum"> 854</span></a>          <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('loginascontext')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../../_variables/loginascontext.html">loginascontext</a> = <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../_variables/context.html">$context</a>;
<a name="l855"><span class="linenum"> 855</span></a>  
<a name="l856"><span class="linenum"> 856</span></a>  <span class="comment">        // Let enrol plugins deal with new enrolments if necessary.</span>
<a name="l857"><span class="linenum"> 857</span></a>          <a class="function" onClick="logFunction('enrol_check_plugins')" href="../../../_functions/enrol_check_plugins.html" onMouseOver="funcPopup(event,'enrol_check_plugins')">enrol_check_plugins</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>);
<a name="l858"><span class="linenum"> 858</span></a>  
<a name="l859"><span class="linenum"> 859</span></a>  <span class="comment">        // Create event before $USER is updated.</span>
<a name="l860"><span class="linenum"> 860</span></a>          <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../../_variables/event.html">$event</a> = \core\event\<a class="class" onClick="logClass('user_loggedinas')" href="../../../_classes/user_loggedinas.html" onMouseOver="classPopup(event,'user_loggedinas')">user_loggedinas</a>::<a class="function" onClick="logFunction('create')" href="../../../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(
<a name="l861"><span class="linenum"> 861</span></a>              array(
<a name="l862"><span class="linenum"> 862</span></a>                  'objectid' =&gt; <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>,
<a name="l863"><span class="linenum"> 863</span></a>                  'context' =&gt; <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../_variables/context.html">$context</a>,
<a name="l864"><span class="linenum"> 864</span></a>                  'relateduserid' =&gt; <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a>,
<a name="l865"><span class="linenum"> 865</span></a>                  'other' =&gt; array(
<a name="l866"><span class="linenum"> 866</span></a>                      'originalusername' =&gt; <a class="function" onClick="logFunction('fullname')" href="../../../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../../_variables/USER.html">$USER</a>, true),
<a name="l867"><span class="linenum"> 867</span></a>                      'loggedinasusername' =&gt; <a class="function" onClick="logFunction('fullname')" href="../../../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>, true)
<a name="l868"><span class="linenum"> 868</span></a>                  )
<a name="l869"><span class="linenum"> 869</span></a>              )
<a name="l870"><span class="linenum"> 870</span></a>          );
<a name="l871"><span class="linenum"> 871</span></a>  <span class="comment">        // Set up global $USER.</span>
<a name="l872"><span class="linenum"> 872</span></a>          \core\session\<a class="class" onClick="logClass('manager')" href="../../../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('set_user')" href="../../../_functions/set_user.html" onMouseOver="funcPopup(event,'set_user')">set_user</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>);
<a name="l873"><span class="linenum"> 873</span></a>          <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../../../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l874"><span class="linenum"> 874</span></a>      }
<a name="l875"><span class="linenum"> 875</span></a>  
<a name="l876"><span class="linenum"> 876</span></a>      <span class="comment">/**</span>
<a name="l877"><span class="linenum"> 877</span></a>  <span class="comment">     * Add a JS session keepalive to the page.</span>
<a name="l878"><span class="linenum"> 878</span></a>  <span class="comment">     *</span>
<a name="l879"><span class="linenum"> 879</span></a>  <span class="comment">     * A JS session keepalive script will be called to update the session modification time every $frequency seconds.</span>
<a name="l880"><span class="linenum"> 880</span></a>  <span class="comment">     *</span>
<a name="l881"><span class="linenum"> 881</span></a>  <span class="comment">     * Upon failure, the specified error message will be shown to the user.</span>
<a name="l882"><span class="linenum"> 882</span></a>  <span class="comment">     *</span>
<a name="l883"><span class="linenum"> 883</span></a>  <span class="comment">     * @param string $identifier The string identifier for the message to show on failure.</span>
<a name="l884"><span class="linenum"> 884</span></a>  <span class="comment">     * @param string $component The string component for the message to show on failure.</span>
<a name="l885"><span class="linenum"> 885</span></a>  <span class="comment">     * @param int $frequency The update frequency in seconds.</span>
<a name="l886"><span class="linenum"> 886</span></a>  <span class="comment">     * @throws coding_exception IF the frequency is longer than the session lifetime.</span>
<a name="l887"><span class="linenum"> 887</span></a>  <span class="comment">     */</span>
<a name="l888"><span class="linenum"> 888</span></a>      public static function <a class="function" onClick="logFunction('keepalive')" href="../../../_functions/keepalive.html" onMouseOver="funcPopup(event,'keepalive')">keepalive</a>(<a class="var it724" onMouseOver="hilite(724)" onMouseOut="lolite()" onClick="logVariable('identifier')" href="../../../_variables/identifier.html">$identifier</a> = 'sessionerroruser', <a class="var it227" onMouseOver="hilite(227)" onMouseOut="lolite()" onClick="logVariable('component')" href="../../../_variables/component.html">$component</a> = 'error', <a class="var it5198" onMouseOver="hilite(5198)" onMouseOut="lolite()" onClick="logVariable('frequency')" href="../../../_variables/frequency.html">$frequency</a> = null) {
<a name="l889"><span class="linenum"> 889</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>, <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../../_variables/PAGE.html">$PAGE</a>;
<a name="l890"><span class="linenum"> 890</span></a>  
<a name="l891"><span class="linenum"> 891</span></a>          if (<a class="var it5198" onMouseOver="hilite(5198)" onMouseOut="lolite()" onClick="logVariable('frequency')" href="../../../_variables/frequency.html">$frequency</a>) {
<a name="l892"><span class="linenum"> 892</span></a>              if (<a class="var it5198" onMouseOver="hilite(5198)" onMouseOut="lolite()" onClick="logVariable('frequency')" href="../../../_variables/frequency.html">$frequency</a> &gt; <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessiontimeout')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessiontimeout.html">sessiontimeout</a>) {
<a name="l893"><span class="linenum"> 893</span></a>  <span class="comment">                // Sanity check the frequency.</span>
<a name="l894"><span class="linenum"> 894</span></a>                  throw new \coding_exception('Keepalive frequency is longer than the session lifespan.');
<a name="l895"><span class="linenum"> 895</span></a>              }
<a name="l896"><span class="linenum"> 896</span></a>          } else {
<a name="l897"><span class="linenum"> 897</span></a>  <span class="comment">            // A frequency of sessiontimeout / 3 allows for one missed request whilst still preserving the session.</span>
<a name="l898"><span class="linenum"> 898</span></a>              <a class="var it5198" onMouseOver="hilite(5198)" onMouseOut="lolite()" onClick="logVariable('frequency')" href="../../../_variables/frequency.html">$frequency</a> = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sessiontimeout')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sessiontimeout.html">sessiontimeout</a> / 3;
<a name="l899"><span class="linenum"> 899</span></a>          }
<a name="l900"><span class="linenum"> 900</span></a>  
<a name="l901"><span class="linenum"> 901</span></a>  <span class="comment">        // Add the session keepalive script to the list of page output requirements.</span>
<a name="l902"><span class="linenum"> 902</span></a>          <a class="var it39844" onMouseOver="hilite(39844)" onMouseOut="lolite()" onClick="logVariable('sessionkeepaliveurl')" href="../../../_variables/sessionkeepaliveurl.html">$sessionkeepaliveurl</a> = new \moodle_url('<a class="filename" href="../../../lib/sessionkeepalive_ajax.php.html">/lib/sessionkeepalive_ajax.php</a>');
<a name="l903"><span class="linenum"> 903</span></a>          <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../../_variables/PAGE.html">$PAGE</a>-&gt;<a onClick="logVariable('requires')" class="var it42916" onMouseOver="hilite(42916)" onMouseOut="lolite()" href="../../../_variables/requires.html">requires</a>-&gt;<a class="function" onClick="logFunction('string_for_js')" href="../../../_functions/string_for_js.html" onMouseOver="funcPopup(event,'string_for_js')">string_for_js</a>(<a class="var it724" onMouseOver="hilite(724)" onMouseOut="lolite()" onClick="logVariable('identifier')" href="../../../_variables/identifier.html">$identifier</a>, <a class="var it227" onMouseOver="hilite(227)" onMouseOut="lolite()" onClick="logVariable('component')" href="../../../_variables/component.html">$component</a>);
<a name="l904"><span class="linenum"> 904</span></a>          <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../../_variables/PAGE.html">$PAGE</a>-&gt;<a onClick="logVariable('requires')" class="var it42916" onMouseOver="hilite(42916)" onMouseOut="lolite()" href="../../../_variables/requires.html">requires</a>-&gt;<a class="function" onClick="logFunction('yui_module')" href="../../../_functions/yui_module.html" onMouseOver="funcPopup(event,'yui_module')">yui_module</a>('moodle-core-checknet', 'M.core.checknet.init', array(array(
<a name="l905"><span class="linenum"> 905</span></a>  <span class="comment">            // The JS config takes this is milliseconds rather than seconds.</span>
<a name="l906"><span class="linenum"> 906</span></a>              'frequency' =&gt; <a class="var it5198" onMouseOver="hilite(5198)" onMouseOut="lolite()" onClick="logVariable('frequency')" href="../../../_variables/frequency.html">$frequency</a> * 1000,
<a name="l907"><span class="linenum"> 907</span></a>              'message' =&gt; array(<a class="var it724" onMouseOver="hilite(724)" onMouseOut="lolite()" onClick="logVariable('identifier')" href="../../../_variables/identifier.html">$identifier</a>, <a class="var it227" onMouseOver="hilite(227)" onMouseOut="lolite()" onClick="logVariable('component')" href="../../../_variables/component.html">$component</a>),
<a name="l908"><span class="linenum"> 908</span></a>              'uri' =&gt; <a class="var it39844" onMouseOver="hilite(39844)" onMouseOut="lolite()" onClick="logVariable('sessionkeepaliveurl')" href="../../../_variables/sessionkeepaliveurl.html">$sessionkeepaliveurl</a>-&gt;<a class="function" onClick="logFunction('out')" href="../../../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>(),
<a name="l909"><span class="linenum"> 909</span></a>          )));
<a name="l910"><span class="linenum"> 910</span></a>      }
<a name="l911"><span class="linenum"> 911</span></a>  
<a name="l912"><span class="linenum"> 912</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'or': ['or', '', [['lib/tcpdf','LICENSE.TXT',69]], 556],
'strlen': ['strlen', 'Counts the number of characters. Unit-tested by Kasper (single byte charsets only) ', [['lib/typo3','class.t3lib_cs.php',1520],['lib/classes','text.php',305]], 1649],
'get_in_or_equal': ['get_in_or_equal', 'Constructs \'IN()\' or \'=\' sql fragment ', [['lib/dml','oci_native_moodle_database.php',1635],['lib/dml','moodle_database.php',711]], 438],
'execute': ['execute', 'Run langpack update ', [['admin/tool/langimport/classes/task','update_langpacks_task.php',44],['backup/converter/imscc1','lib.php',84],['lib/classes/task','blog_cron_task.php',40],['mod/workshop/allocation/scheduled','lib.php',128],['lib/classes/task','send_new_user_passwords_task.php',40],['admin/tool/log/store/standard/classes/task','cleanup_task.php',40],['lib/dml','pdo_moodle_database.php',227],['lib/classes/task','tag_cron_task.php',42],['enrol/imsenterprise/classes/task','cron_task.php',43],['lib/classes/task','completion_daily_task.php',42],['lib/google/src/Google/Http','Batch.php',61],['lib/dml','oci_native_moodle_database.php',1048],['lib/classes/task','context_cleanup_task.php',41],['backup/util/plan','backup_structure_step.class.php',50],['backup/util/ui','restore_ui.class.php',206],['webservice','lib.php',1319],['lib/classes/task','stats_cron_task.php',40],['lib/htmlpurifier/HTMLPurifier/Strategy','ValidateAttributes.php',16],['lib/htmlpurifier/HTMLPurifier/Strategy','RemoveForeignElements.php',20],['lib/classes/task','legacy_plugin_cron_task.php',42],['backup/moodle2','restore_activity_task.class.php',189],['lib/classes/task','portfolio_cron_task.php',40],['lib/google/src/Google/Http','REST.php',27],['lib/htmlpurifier/HTMLPurifier/Strategy','MakeWellFormed.php',66],['backup/converter/imscc11','backuplib.php',42],['lib/classes/task','question_cron_task.php',40],['lib/classes/task','cache_cron_task.php',40],['admin/tool/log/store/legacy/classes/task','cleanup_task.php',40],['mod/lti/service/memberships/classes/local/resource','linkmemberships.php',62],['admin/tool/messageinbound/classes/task','cleanup_task.php',47],['lib/adodb/drivers','adodb-pdo.inc.php',559],['lib/editor/atto/classes/task','autosave_cleanup_task.php',42],['admin/tool/recyclebin/classes/task','cleanup_category_bin.php',43],['lib/classes/task','completion_regular_task.php',42],['lib/adodb/drivers','adodb-oci8po.inc.php',54],['lib/classes/task','events_cron_task.php',40],['mod/workshop/allocation/random','lib.php',83],['mod/assign/feedback/editpdf/classes/task','convert_submissions.php',47],['auth/cas/classes/task','sync_task.php',43],['admin/tool/recyclebin/classes/task','cleanup_course_bin.php',43],['mod/lti/service/toolsettings/classes/local/resource','contextsettings.php',62],['backup/util/helper','restore_decode_processor.class.php',73],['lib/behat','behat_base.php',840],['enrol/flatfile/classes/task','flatfile_sync_task.php',46],['lib/classes/task','registration_cron_task.php',40],['backup/moodle2','backup_section_task.class.php',97],['lib/classes/task','check_for_updates_task.php',40],['backup/util/plan/tests/fixtures','plan_fixtures.php',48],['backup/util/plan/tests/fixtures','plan_fixtures.php',56],['mod/forum/classes/task','cron_task.php',39],['lib/classes/task','send_failed_login_notifications_task.php',43],['enrol/lti/classes/task','sync_grades.php',45],['lib/dml','pgsql_native_moodle_database.php',665],['lib/htmlpurifier/HTMLPurifier/Strategy','Composite.php',21],['lib/classes/update','validator.php',117],['lib/google/src/Google','Client.php',574],['lib/dml','mssql_native_moodle_database.php',711],['mod/lti/service/profile/classes/local/resource','profile.php',76],['backup/util/plan','backup_plan.class.php',112],['lib/dml','mysqli_native_moodle_database.php',963],['backup/util/ui','backup_ui.class.php',122],['admin/tool/monitor/classes/task','clean_events.php',41],['backup/converter/moodle1','backuplib.php',10],['backup/converter/imscc11','lib.php',85],['lib/classes/task','grade_cron_task.php',40],['lib/classes/task','file_temp_cleanup_task.php',40],['backup/moodle2','restore_section_task.class.php',87],['mod/lti/service/toolsettings/classes/local/resource','linksettings.php',63],['filter/tex','latex.php',70],['lib/adodb','adodb.inc.php',1088],['lib/classes/task','plagiarism_cron_task.php',40],['mod/lti/service/toolproxy/classes/local/resource','toolproxy.php',62],['backup/converter/moodle1','lib.php',142],['backup/util/plan','restore_structure_step.class.php',62],['lib/classes/task','search_index_task.php',44],['enrol/lti/classes/task','sync_members.php',55],['lib/classes/task','session_cleanup_task.php',40],['mod/lti/service/toolsettings/classes/local/resource','systemsettings.php',61],['lib/classes/task','backup_cleanup_task.php',40],['lib/classes/task','delete_unconfirmed_users_task.php',40],['backup/converter/imscc1','backuplib.php',10],['lib/classes/task','badges_cron_task.php',40],['admin/tool/uploadcourse/classes','processor.php',174],['lib/classes/task','calendar_cron_task.php',40],['backup/util/plan','base_plan.class.php',158],['auth/ldap/classes/task','sync_task.php',43],['lib/adodb/drivers','adodb-oci8.inc.php',920],['backup/util/plan','restore_plan.class.php',159],['lib/tests/fixtures','task_fixtures.php',30],['lib/tests/fixtures','task_fixtures.php',39],['lib/tests/fixtures','task_fixtures.php',48],['lib/tests/fixtures','task_fixtures.php',57],['lib/dml','sqlsrv_native_moodle_database.php',795],['lib/classes/task','create_contexts_task.php',40],['lib/classes/task','file_trash_cleanup_task.php',40],['admin/tool/cohortroles/classes/task','cohort_role_sync.php',46],['lib/classes/task','complete_plans_task.php',52],['lib/classes/task','messaging_cleanup_task.php',40],['backup/util/plan','backup_execution_step.class.php',25],['lib/classes/task','cache_cleanup_task.php',40],['backup/moodle2','backup_activity_task.class.php',211],['filter/tex','texdebug.php',287],['lib/classes/task','password_reset_cleanup_task.php',40],['lib/classes/task','search_optimize_task.php',47],['mod/assign','adminlib.php',342],['lib/classes/task','delete_incomplete_users_task.php',40],['lib/classes/task','automated_backup_task.php',40],['admin/tool/messageinbound/classes/task','pickup_task.php',47],['backup/util/plan','restore_execution_step.class.php',25],['lib/classes/task','sync_plans_from_template_cohorts_task.php',50],['admin/tool/monitor/classes','notification_task.php',39],['lib/dml/tests','dml_test.php',5543],['lib/htmlpurifier/HTMLPurifier/Strategy','FixNesting.php',41],['mod/lti/service/memberships/classes/local/resource','contextmemberships.php',60],['admin/tool/monitor/classes/task','check_subscriptions.php',60],['backup/util/interfaces','executable.class.php',32],['backup/util/plan','base_task.class.php',162]], 1058],
'record_exists': ['record_exists', 'Check if a record exists by ID. ', [['competency/classes','persistent.php',842],['lib/dml','moodle_database.php',1817]], 901],
'display_size': ['display_size', 'Converts bytes into display form ', [['lib','moodlelib.php',6538]], 34],
'session_lock_supported': ['session_lock_supported', '', [['lib/dml','oci_native_moodle_database.php',1797],['lib/dml','pgsql_native_moodle_database.php',1265],['lib/dml','mssql_native_moodle_database.php',1336],['lib/dml','mysqli_native_moodle_database.php',1667],['lib/dml','moodle_database.php',2553],['lib/dml','sqlsrv_native_moodle_database.php',1405]], 9],
'add_session_record': ['add_session_record', 'Insert new empty session record. ', [['lib/classes/session','manager.php',419]], 4],
'get_recordset_sql': ['get_recordset_sql', 'Get a number of records as an moodle_recordset.  $sql must be a complete SQL query. Since this method is a little less readable, use of it should be restricted to code where it\'s possible there might be large datasets being returned.  For known small datasets use get_records_sql - it leads to simpler code. ', [['lib/dml','pdo_moodle_database.php',252],['lib/dml','oci_native_moodle_database.php',1106],['lib/dml','pgsql_native_moodle_database.php',688],['lib/dml','mssql_native_moodle_database.php',736],['lib/dml','mysqli_native_moodle_database.php',993],['lib/dml','sqlsrv_native_moodle_database.php',811],['lib/dml/tests','dml_test.php',5544]], 283],
'is_https': ['is_https', 'Determines whether or not the Moodle site is being served over HTTPS. ', [['lib','weblib.php',205]], 20],
'enrol_check_plugins': ['enrol_check_plugins', 'Check all the login enrolment information for the given user object by querying the enrolment plugins ', [['lib','enrollib.php',186]], 8],
'out': ['out', 'Returns the selector for use in a CSS rule ', [['lib','csslib.php',1540],['lib','csslib.php',1698],['lib','csslib.php',2078],['lib','csslib.php',2162],['lib','csslib.php',2306],['lib','csslib.php',2495],['lib','csslib.php',3240],['mod/feedback/classes','responses_table.php',332],['lib','moodlelib.php',9729],['lib','weblib.php',545],['lib','tablelib.php',1594],['report/loglive/classes','table_log_ajax.php',37]], 626],
'get_record': ['get_record', 'Load a single record. ', [['competency/classes','persistent.php',738],['lib/dml','moodle_database.php',1462]], 3224],
'getremoteaddr': ['getremoteaddr', 'Returns most reliable client address ', [['lib','moodlelib.php',8569]], 61],
'get_realuser': ['get_realuser', 'Returns the $USER object ignoring current login-as session ', [['lib/classes/session','manager.php',819]], 8],
'create': ['create', 'Auto-scan an incoming line to determine the response type. ', [['lib/horde/framework/Horde/Imap/Client/Interaction','Server.php',65],['lib/google/src/Google/Service','Partners.php',492],['lib/simplepie/library/SimplePie','Cache.php',95],['lib/google/src/Google/Service','YouTubeReporting.php',237],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',81],['lib/google/src/Google/Service','MapsEngine.php',1677],['lib/google/src/Google/Service','MapsEngine.php',1977],['lib/google/src/Google/Service','MapsEngine.php',2253],['lib/google/src/Google/Service','MapsEngine.php',2330],['lib/google/src/Google/Service','MapsEngine.php',2898],['lib/spout/src/Spout/Writer','WriterFactory.php',18],['lib/google/src/Google/Service','Dns.php',290],['lib/google/src/Google/Service','Dns.php',363],['lib/google/src/Google/Service','Appengine.php',438],['tag/classes','collection.php',188],['lib/adodb','adodb-xmlschema.inc.php',152],['lib/adodb','adodb-xmlschema.inc.php',473],['lib/adodb','adodb-xmlschema.inc.php',738],['lib/adodb','adodb-xmlschema.inc.php',884],['lib/adodb','adodb-xmlschema.inc.php',1129],['mod/quiz','attemptlib.php',100],['mod/quiz','attemptlib.php',596],['lib','weblib.php',3206],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',58],['lib/google/src/Google/Service','Dataflow.php',273],['lib/simplepie/library/SimplePie','Registry.php',153],['competency/classes','persistent.php',387],['lib/google/src/Google/Service','Cloudresourcemanager.php',373],['lib/phpexcel/PHPExcel/Shared/PCLZip','pclzip.lib.php',270],['lib/google/src/Google/Service','TagManager.php',1007],['lib/google/src/Google/Service','TagManager.php',1097],['lib/google/src/Google/Service','TagManager.php',1249],['lib/google/src/Google/Service','TagManager.php',1342],['lib/google/src/Google/Service','TagManager.php',1436],['lib/google/src/Google/Service','TagManager.php',1530],['lib/google/src/Google/Service','TagManager.php',1681],['mod/lesson','locallib.php',1011],['mod/lesson','locallib.php',2163],['mod/lesson','locallib.php',3212],['lib','modinfolib.php',1732],['repository','lib.php',206],['repository','lib.php',1910],['lib','navigationlib.php',268],['lib/htmlpurifier/HTMLPurifier','Config.php',114],['lib/google/src/Google/Service','Container.php',284],['lib/google/src/Google/Service','Genomics.php',632],['lib/google/src/Google/Service','Genomics.php',721],['lib/google/src/Google/Service','Genomics.php',1312],['lib/google/src/Google/Service','Genomics.php',1427],['lib/google/src/Google/Service','Games.php',1649],['lib/google/src/Google/Service','Games.php',2013],['lib/google/src/Google/Service','Fitness.php',377],['lib/google/src/Google/Service','Gmail.php',747],['lib/google/src/Google/Service','Gmail.php',905],['mod/quiz/classes','structure.php',65],['lib/htmlpurifier/HTMLPurifier','ElementDef.php',135],['lib/adodb','adodb-xmlschema03.inc.php',170],['lib/adodb','adodb-xmlschema03.inc.php',514],['lib/adodb','adodb-xmlschema03.inc.php',779],['lib/adodb','adodb-xmlschema03.inc.php',930],['lib/adodb','adodb-xmlschema03.inc.php',1228],['lib/google/src/Google/Service','Proximitybeacon.php',500],['tag/classes','area.php',205],['course','lib.php',3003],['question/type/ddmarker','shapes.php',170],['lib/classes/event','base.php',149],['lib','coursecatlib.php',325],['repository/filesystem','lib.php',498],['lib/google/src/Google/Service','Storagetransfer.php',281],['calendar','lib.php',2686],['lib/htmlpurifier/HTMLPurifier','Lexer.php',53],['lib/google/src/Google/Service','Classroom.php',445],['lib/google/src/Google/Service','Classroom.php',596],['lib/google/src/Google/Service','Classroom.php',673],['lib/google/src/Google/Service','Classroom.php',783],['lib/google/src/Google/Service','Classroom.php',912],['lib/spout/src/Spout/Reader','ReaderFactory.php',18],['lib/google/src/Google/Service','Pubsub.php',220],['lib/google/src/Google/Service','Pubsub.php',365],['lib/google/src/Google/Service','CloudMonitoring.php',258]], 3276],
'start': ['start', 'Starts the session. ', [['lib/classes/session','memcache.php',73],['admin/tool/uploaduser','locallib.php',61],['backup/util/xml/output','xml_output.class.php',74],['backup/util/xml','xml_writer.class.php',81],['lib/classes/session','handler.php',37],['lib/google/src/Google/Service','AdSenseHost.php',964],['lib/classes/session','memcached.php',84],['lib/htmlpurifier/HTMLPurifier','Printer.php',45],['question/engine','questionattempt.php',938],['question/engine','questionattempt.php',1581],['lib/classes/session','manager.php',49],['lib/google/src/Google/Service','Compute.php',6544],['lib/pear/Auth','RADIUS.php',350],['admin/tool/uploadcourse/classes','tracker.php',188]], 146],
'gc': ['gc', 'Periodic timed-out session cleanup. ', [['lib/classes/session','manager.php',727]], 9],
'login_user': ['login_user', 'Log the current user into a chat room in the given chat. ', [['mod/chat/classes','external.php',59],['lib/classes/session','manager.php',464]], 6],
'get_records': ['get_records', 'Load a list of records. ', [['competency/classes','persistent.php',709],['mod/glossary/classes','entry_query_builder.php',295],['lib/dml','moodle_database.php',1285],['lib','coursecatlib.php',651],['question','category_class.php',63]], 965],
'yui_module': ['yui_module', 'Creates a JavaScript function call that requires one or more modules to be loaded. ', [['lib','outputrequirementslib.php',1023]], 81],
'set_user': ['set_user', 'Set current user. ', [['lib/classes/session','manager.php',706]], 28],
'initialise_user_session': ['initialise_user_session', 'Initialise $_SESSION, handles google access and sets up not-logged-in user properly. ', [['lib/classes/session','manager.php',270]], 1],
'kill_user_sessions': ['kill_user_sessions', 'Terminate all sessions of given user unconditionally. ', [['lib/classes/session','manager.php',633]], 13],
'write_close': ['write_close', 'No more changes in session expected. Unblocks the sessions, other scripts may start executing in parallel. ', [['lib/classes/session','manager.php',522]], 52],
'debugging': ['debugging', 'Standard Debugging Function ', [['lib','weblib.php',3012]], 1007],
'clone': ['clone', '', [['lib/editor/tinymce/tiny_mce/3.5.11/plugins/media/js','media.js',11]], 370],
'get_string': ['get_string', 'Get String returns a requested string ', [['lib/classes','string_manager_install.php',95],['lib','moodlelib.php',6735],['lib','moodlelib.php',9695],['lib/external','externallib.php',102],['question/behaviour','behaviourbase.php',770],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38]], 20134],
'close': ['close', 'Close archive, write changes to disk. ', [['lib/filestorage','zip_archive.php',183],['lib/dml','mssql_native_moodle_recordset.php',87],['auth/fc','fcFPP.php',78],['lib/dml','mysqli_native_moodle_recordset.php',86],['lib/spout/src/Spout/Reader','ReaderInterface.php',30],['lib/spout/src/Spout/Writer/ODS/Internal','Workbook.php',81],['lib/dml','pdo_moodle_recordset.php',79],['lib','csvlib.class.php',256],['lib/horde/framework/Horde/Socket','Client.php',135],['backup/util/helper','backup_null_iterator.class.php',53],['admin/tool/uploaduser','locallib.php',149],['lib/tcpdf','tcpdf.php',2943],['lib/phpunit/classes','phpmailer_sink.php',41],['lib/phpmailer','class.smtp.php',582],['lib/dml','sqlsrv_native_moodle_recordset.php',133],['lib/classes/dml','recordset_walk.php',153],['lib/spout/src/Spout/Writer/XLSX/Helper','SharedStringsHelper.php',84],['grade/export','lib.php',689],['lib','excellib.class.php',93],['backup/util/loggers','file_logger.class.php',69],['grade','lib.php',324],['backup/util/helper','backup_array_iterator.class.php',63],['lib/horde/framework/Horde/Imap/Client','Base.php',1846],['mod/assign/feedback/offline','importgradeslib.php',204],['lib/dml','oci_native_moodle_recordset.php',80],['lib/adodb','adodb.inc.php',2361],['lib/adodb','adodb.inc.php',3090],['lib/adodb','adodb.inc.php',3870],['lib/google/src/Google/Logger','File.php',132],['lib/phpunit/classes','event_sink.php',39],['lib/horde/framework/Horde','Stream.php',585],['backup/util/loggers','base_logger.class.php',89],['lib/phpexcel/PHPExcel/Shared','ZipArchive.php',71],['question/engine/tests','helpers.php',1241],['lib/spout/src/Spout/Writer','AbstractWriter.php',312],['lib','odslib.class.php',71],['lib/spout/src/Spout/Writer/Common/Internal','WorksheetInterface.php',34],['lib/spout/src/Spout/Writer/ODS/Internal','Worksheet.php',214],['lib/spout/src/Spout/Writer','WriterInterface.php',84],['lib/spout/src/Spout/Writer/XLSX/Internal','Worksheet.php',174],['lib/spout/src/Spout/Reader','AbstractReader.php',183],['lib/phpunit/classes','message_sink.php',39],['lib/spout/src/Spout/Writer/Common/Internal','WorkbookInterface.php',65],['lib/spout/src/Spout/Writer/XLSX/Internal','Workbook.php',95],['lib/pear/Net','GeoIP.php',556],['lib/tests','completionlib_test.php',907],['lib/pear/Auth','RADIUS.php',550],['lib/pear/Auth','RADIUS.php',710],['lib/pear/Auth','RADIUS.php',829],['lib','webdavlib.php',176],['lib/dml','pgsql_native_moodle_recordset.php',107]], 1128],
'string_for_js': ['string_for_js', 'Make a language string available to JavaScript. ', [['lib','outputrequirementslib.php',1120]], 64],
'clean_param': ['clean_param', 'Used by {@link optional_param()} and {@link required_param()} to clean the variables and/or cast to specific types, based on an options field. <code> $course->format = clean_param($course->format, PARAM_ALPHA); $selectedgradeitem = clean_param($selectedgradeitem, PARAM_INT); </code> ', [['lib','moodlelib.php',769]], 635],
'sesskey': ['sesskey', 'Makes sure that $USER->sesskey exists, if $USER itself exists. It sets a new sesskey if one does not already exist, but does not overwrite existing sesskeys. Returns the sesskey string if $USER exists, or boolean false if not. ', [['lib','sessionlib.php',28]], 641],
'get_performance_info': ['get_performance_info', 'get_performance_info() pairs up with init_performance_info() loaded in setup.php. Returns an array with \'html\' and \'txt\' values ready for use, and each of the individual stats provided separately as well. ', [['lib','moodlelib.php',8869],['lib/classes/session','manager.php',104]], 4],
'fullname': ['fullname', 'Returns a persons full name ', [['lib','moodlelib.php',3249],['mod/assign','locallib.php',3915]], 546],
'init': ['init', 'Init method. ', [['lib/classes/event','competency_plan_unlinked.php',90],['lib/classes/session','file.php',53],['lib/classes/event','grouping_group_assigned.php',66],['admin/tool/xmldb/actions/view_table_sql','view_table_sql.class.php',33],['lib/classes/event','enrol_instance_deleted.php',88],['report/log/classes/event','user_report_viewed.php',44],['mod/quiz/classes/event','attempt_reviewed.php',44],['lib/classes/event','tag_unflagged.php',46],['mod/workshop/allocation/scheduled','lib.php',52],['lib/classes/event','role_unassigned.php',47],['mod/assign/classes/event','grading_form_viewed.php',74],['question/classes/bank','edit_action_column.php',29],['blocks/blog_menu','block_blog_menu.php',32],['mod/workshop/classes/event','submission_deleted.php',44],['admin/tool/xmldb/actions/view_table_php','view_table_php.class.php',33],['mod/forum/classes/event','discussion_updated.php',44],['lib/classes/event','course_module_instance_list_viewed.php',49],['lib/classes/event','course_created.php',46],['mod/assign/classes/event','extension_granted.php',86],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/xhtmlxtras/js','attributes.js',1],['blocks/course_overview','block_course_overview.php',38],['admin/tool/xmldb/actions/delete_index','delete_index.class.php',32],['lib/classes/event','course_deleted.php',47],['lib/minify/lib','FirePHP.php',221],['lib/lessphp','Environment.php',56],['mod/forum/classes/event','readtracking_enabled.php',44],['mod/wiki/classes/event','page_created.php',37],['lib/classes/event','competency_viewed.php',88],['mod/choice/classes/event','answer_updated.php',90],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/table/js','row.js',3],['lib/minify/lib','JSMinPlus.php',1753],['lib/classes/event','search_indexed.php',39],['lib/classes/event','badge_criteria_updated.php',44],['mod/wiki/classes/event','page_version_deleted.php',43],['lib/classes/event','competency_user_competency_rated_in_plan.php',107],['lib/classes/event','webservice_token_sent.php',65],['mod/glossary/classes/event','entry_deleted.php',45],['lib/classes/event','competency_template_viewed.php',90],['mod/feedback/classes','responses_anon_table.php',42],['mod/assign/tests/fixtures','event_mod_assign_fixtures.php',57],['admin/tool/langimport/classes/event','langpack_removed.php',61],['mod/glossary/classes/event','category_deleted.php',37],['mod/lti/classes/event','unknown_service_api_called.php',64],['lib/classes/event','badge_deleted.php',40],['mod/quiz/classes/event','user_override_updated.php',45],['lib/classes/event','message_contact_added.php',39],['lib/classes/event','cohort_member_added.php',38],['lib/classes/event','blog_entry_updated.php',42],['admin/tool/xmldb/actions/move_updown_table','move_updown_table.class.php',32],['mod/assign/classes/event','workflow_state_updated.php',97],['blocks/completionstatus','block_completionstatus.php',36],['mod/forum/classes/event','assessable_uploaded.php',104],['mod/assign/classes/event','submission_created.php',49],['lib/classes/event','group_deleted.php',83],['lib/classes/event','role_allow_assign_updated.php',39],['lib/simplepie/library','SimplePie.php',1198],['blocks/globalsearch','block_globalsearch.php',36],['lib/tests','blocklib_test.php',564],['lib/tests/fixtures','stats_events.php',32],['lib/tests/fixtures','stats_events.php',39],['lib/tests/fixtures','stats_events.php',46],['lib/tests/fixtures','stats_events.php',53],['mod/lesson/classes/event','highscore_added.php',50],['mod/forum/classes/event','discussion_pinned.php',35],['lib/classes/event','webservice_function_called.php',76],['lib/classes/event','competency_plan_reopened.php',93],['mod/lesson/classes/event','essay_attempt_viewed.php',39],['mod/wiki/classes/event','page_locks_deleted.php',43],['lib/classes/event','webservice_service_deleted.php',77],['mod/forum/classes/event','discussion_subscription_created.php',45],['lib/editor/atto/yui/build/moodle-editor_atto-rangy','moodle-editor_atto-rangy-debug.js',242],['admin/tool/log/store/database/tests/fixtures','event.php',39],['mod/workshop/classes/event','assessable_uploaded.php',112],['lib','csslib.php',1493],['lib','csslib.php',1579],['lib','csslib.php',2462],['lib','csslib.php',2572],['lib','csslib.php',2593],['lib','csslib.php',2732],['lib','csslib.php',2762],['lib','csslib.php',2792],['lib','csslib.php',2822],['lib','csslib.php',2852],['lib','csslib.php',3186],['lib','csslib.php',3266],['lib','csslib.php',3309],['lib','csslib.php',3352],['lib','csslib.php',3395],['lib','csslib.php',3438],['lib','csslib.php',3525],['lib','csslib.php',3578],['lib','csslib.php',3608],['lib','csslib.php',3638],['lib','csslib.php',3668],['lib','csslib.php',3698],['lib','csslib.php',3728],['lib','csslib.php',3758],['lib','csslib.php',3788],['lib','csslib.php',3818],['lib','csslib.php',3848],['lib','csslib.php',3878],['lib','csslib.php',3908],['lib','csslib.php',3938],['lib','csslib.php',4243],['lib','csslib.php',4277],['lib','csslib.php',4328],['lib','csslib.php',4381],['lib','csslib.php',4413],['lib','csslib.php',4464],['lib','csslib.php',4515],['lib','csslib.php',4566],['lib','csslib.php',4596],['lib','csslib.php',4626],['lib','csslib.php',4656],['lib','csslib.php',4791],['lib','csslib.php',4821],['lib','csslib.php',4851],['lib','csslib.php',4881],['lib','csslib.php',4910],['lib','csslib.php',4945],['lib','csslib.php',4977],['lib/classes/event','user_loggedout.php',44],['lib/classes/event','webservice_token_created.php',83],['lib/classes/event','tag_collection_updated.php',39],['mod/data/classes/event','field_deleted.php',46],['lib/phpexcel/PHPExcel/Shared/OLE/PPS','File.php',44],['mod/book/classes/event','chapter_created.php',100],['lib/classes/event','email_failed.php',48],['admin/tool/xmldb/actions/view_structure_sql','view_structure_sql.class.php',33],['blocks/calendar_upcoming','block_calendar_upcoming.php',26],['mod/survey/classes/event','report_downloaded.php',46],['mod/workshop/classes/event','phase_switched.php',44],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/table/js','table.js',295],['admin/tool/xmldb/actions/edit_key_save','edit_key_save.class.php',33],['blocks/private_files','block_private_files.php',28],['mod/page/classes/event','course_module_viewed.php',38],['lib/classes/event','course_reset_started.php',71],['mod/workshop/classes/event','assessment_evaluated.php',45],['lib/classes/event','blog_association_created.php',46],['backup/converter','convertlib.php',211],['report/outline/classes/event','activity_report_viewed.php',38],['lib/classes/event','competency_plan_updated.php',93],['mod/choice/classes/event','answer_submitted.php',90],['blocks/admin_bookmarks','block_admin_bookmarks.php',41],['admin/tool/xmldb/actions/view_field_xml','view_field_xml.class.php',32],['blocks/myprofile','block_myprofile.php',40],['mod/lesson/classes/event','lesson_ended.php',40],['lib/classes/event','role_allow_switch_updated.php',39],['lib/classes/session','memcache.php',88],['lib/classes/event','competency_user_competency_rated_in_course.php',107],['question/classes/bank','question_text_row.php',29],['lib/classes/event','tag_created.php',46],['report/participation/classes/event','report_viewed.php',48],['lib/classes/event','role_capabilities_updated.php',42],['blocks/mentees','block_mentees.php',27],['lib','csvlib.class.php',216],['mod/survey/classes/event','response_submitted.php',45],['lib/classes/event','badge_archived.php',38],['mod/workshop/classes/event','assessment_reevaluated.php',45],['mod/assign/classes/event','submission_locked.php',87],['admin/tool/xmldb/actions/view_table_xml','view_table_xml.class.php',32],['report/outline/classes/event','report_viewed.php',44],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/style/js','props.js',57],['lib/classes/event','user_deleted.php',48],['lib/classes/event','mnet_access_control_updated.php',48],['mod/lesson/classes/event','essay_assessed.php',46],['blocks/html','block_html.php',27],['mod/book/tool/print/classes/event','book_printed.php',94],['mod/feedback/classes','responses_table.php',82],['lib/classes/event','grouping_deleted.php',90],['blocks/section_links','block_section_links.php',34],['lib/classes/event','course_viewed.php',46],['mod/forum/classes/event','user_report_viewed.php',45],['admin/tool/xmldb/actions/check_bigints','check_bigints.class.php',32],['admin/tool/xmldb/actions/check_defaults','check_defaults.class.php',34],['admin/tool/xmldb/actions/edit_xml_file_save','edit_xml_file_save.class.php',32],['admin/tool/xmldb/actions/move_updown_index','move_updown_index.class.php',32],['mod/quiz/classes/event','attempt_summary_viewed.php',45],['lib/classes/event','webservice_service_user_added.php',77],['mod/forum/classes/event','discussion_unpinned.php',35],['lib/classes/event','grouping_group_unassigned.php',66],['blocks/lp','block_lp.php',45],['mod/assign/submission/file/classes/event','submission_updated.php',45],['mod/quiz/report','attemptsreport.php',67],['mod/chat/classes/event','message_sent.php',77],['mod/chat/classes/event','course_module_viewed.php',38],['lib/classes/event','role_assigned.php',47],['blocks/site_main_menu','block_site_main_menu.php',26],['blocks/social_activities','block_social_activities.php',26],['lib/htmlpurifier/HTMLPurifier/ChildDef','StrictBlockquote.php',97],['mod/glossary/classes/event','entry_viewed.php',39],['mod/data/classes/event','record_created.php',45],['admin/tool/xmldb/actions/main_view','main_view.class.php',35],['lib/classes/event','course_category_deleted.php',50],['mod/quiz/classes/event','course_module_viewed.php',39],['lib/classes/event','role_deleted.php',46],['blocks/tag_flickr','block_tag_flickr.php',30],['mod/wiki/classes/event','page_version_viewed.php',43],['admin/tool/recyclebin/classes/event','category_bin_item_deleted.php',38],['mod/data/classes/event','course_module_viewed.php',40],['auth/cas/CAS/CAS/PGTStorage','File.php',150],['mod/choice/classes/event','course_module_viewed.php',38],['admin/tool/log/store/standard/tests/fixtures','event.php',39],['admin/tool/monitor/classes/event','rule_created.php',39],['admin/tool/xmldb/actions/check_oracle_semantics','check_oracle_semantics.class.php',37],['question/classes/bank','checkbox_column.php',28],['lib/classes/event','competency_user_competency_plan_viewed.php',100],['lib/adodb/drivers','adodb-pdo.inc.php',651],['mod/forum/classes/event','course_module_viewed.php',39],['mod/workshop/classes/event','submission_updated.php',44],['mod/choice/classes/event','report_viewed.php',44],['mod/lesson/classes/event','group_override_deleted.php',45],['mod/wiki/classes/event','page_map_viewed.php',43],['blocks/mnet_hosts','block_mnet_hosts.php',26],['admin/tool/log/store/legacy/tests/fixtures','event.php',39],['admin/tool/xmldb/actions/new_index','new_index.class.php',32],['admin/tool/xmldb/actions/get_db_directories','get_db_directories.class.php',33],['mod/lesson/classes/event','question_answered.php',45],['mod/choice/classes/event','report_downloaded.php',46],['lib/classes/event','competency_user_evidence_created.php',91],['lib/classes/event','course_module_completion_updated.php',45],['admin/tool/xmldb/actions/delete_xml_file','delete_xml_file.class.php',32],['backup/util/xml/output','file_xml_output.class.php',44],['question/engine','states.php',64],['lib/classes/event','note_updated.php',47],['lib/classes/event','note_created.php',47],['lib/classes/event','competency_framework_created.php',90],['lib/classes/event','course_resources_list_viewed.php',41],['lib/classes/event','tag_updated.php',49],['mod/forum/classes/event','subscribers_viewed.php',45],['question/classes/bank','column_base.php',53],['mod/book/tool/exportimscp/classes/event','book_exported.php',94],['mod/quiz/classes/question/bank','add_action_column.php',40],['blocks/quiz_results','block_quiz_results.php',40],['lib/classes/event','user_enrolment_deleted.php',45],['admin/tool/recyclebin/classes/event','course_bin_item_restored.php',38],['admin/tool/xmldb/actions/unload_xml_file','unload_xml_file.class.php',32],['lib/classes/event','webservice_service_updated.php',77],['mod/lesson/classes/event','group_override_created.php',46],['admin/tool/xmldb/actions/view_index_xml','view_index_xml.class.php',32],['admin/tool/xmldb/actions/generate_documentation','generate_documentation.class.php',32],['mod/scorm/classes/event','attempt_deleted.php',44],['admin/tool/xmldb/actions/new_field','new_field.class.php',32],['lib/classes/event','competency_user_competency_review_request_cancelled.php',90],['lib/classes/event','webservice_service_created.php',83],['mod/workshop/allocation/random','lib.php',56],['mod/wiki/classes/event','page_version_restored.php',43],['mod/forum/classes/event','discussion_deleted.php',45],['lib/classes/event','competency_framework_updated.php',91],['mod/lesson/classes/event','lesson_restarted.php',39],['mod/wiki/classes/event','page_updated.php',43],['mod/assign/classes/event','marker_updated.php',98],['admin/tool/xmldb/actions/new_key','new_key.class.php',32],['admin/tool/xmldb/actions/check_indexes','check_indexes.class.php',34],['admin/tool/xmldb/actions/new_table_from_mysql','new_table_from_mysql.class.php',33],['lib/classes/event','course_module_updated.php',48],['admin/tool/xmldb/actions/delete_field','delete_field.class.php',32],['lib/classes/event','competency_template_deleted.php',82],['blocks/settings','block_settings.php',46],['mod/assign/classes/event','submission_confirmation_form_viewed.php',71],['report/questioninstances/classes/event','report_viewed.php',44],['lib/classes/event','message_contact_blocked.php',39],['lib/classes/event','competency_template_updated.php',93],['lib/classes/event','badge_disabled.php',38],['mod/assign/classes/event','grading_table_viewed.php',71],['lib/classes/event','badge_enabled.php',38],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/xhtmlxtras/js','del.js',1],['mod/quiz/classes/event','edit_page_viewed.php',45],['blocks/activity_modules','block_activity_modules.php',29],['mod/scorm/classes/event','tracks_viewed.php',46],['mod/wiki/classes/event','page_diff_viewed.php',44],['lib/tcpdf/include/barcodes','qrcode.php',854],['lib/classes/event','assessable_submitted.php',46],['lib/classes/event','grouping_created.php',83],['mod/assign/submission/onlinetext/classes/event','submission_created.php',45],['lib/classes/event','calendar_event_deleted.php',47],['lib/classes/event','group_updated.php',83],['mod/book/classes/event','chapter_updated.php',100],['lib/classes/event','grade_deleted.php',50],['admin/tool/recyclebin/classes/event','course_bin_item_created.php',38],['lib/classes/event','user_loggedin.php',91],['mod/forum/classes/event','subscription_created.php',44],['lib/classes/event','tag_collection_created.php',39],['grade/report/overview/classes/event','grade_report_viewed.php',39],['mod/assign/classes/event','batch_set_marker_allocation_viewed.php',71],['mod/quiz/classes/event','group_override_updated.php',45],['lib/classes/event','competency_plan_created.php',90],['mod/glossary/classes/event','entry_disapproved.php',37],['lib/classes/event','message_viewed.php',45],['lib/classes/event','comment_created.php',47],['lib/classes/event','course_content_deleted.php',45],['blocks/glossary_random','block_glossary_random.php',38],['mod/feedback/classes/event','response_deleted.php',48],['lib/classes/event','competency_evidence_created.php',125],['lib/classes/event','comment_deleted.php',47],['lib/classes/event','competency_user_competency_review_requested.php',90],['mod/quiz/classes/event','attempt_abandoned.php',44],['admin/tool/xmldb/actions/delete_table','delete_table.class.php',32],['mod/scorm/classes/event','user_report_viewed.php',45],['mod/quiz/classes/event','attempt_becameoverdue.php',47],['mod/quiz/classes/event','group_override_created.php',46],['mod/book/tool/print/classes/event','chapter_printed.php',97],['mod/data/classes/event','record_deleted.php',45],['admin/tool/xmldb/actions/view_structure_xml','view_structure_xml.class.php',32],['lib/classes/event','competency_user_competency_viewed.php',99],['lib/classes/event','dashboard_viewed.php',40],['mod/lesson/classes/event','question_viewed.php',45],['lib/classes/event','user_profile_viewed.php',47],['mod/lesson/classes/event','user_override_deleted.php',44],['mod/data/preset/imagegallery','jstemplate.js',4],['grade','lib.php',128],['lib/classes/event','cohort_member_removed.php',39],['mod/lesson/classes/event','lesson_started.php',39],['blocks/news_items','block_news_items.php',33],['mod/lesson/classes/event','page_updated.php',64],['mod/resource/classes/event','course_module_viewed.php',39],['mod/workshop/classes/event','submission_viewed.php',44],['lib/editor/tinymce/plugins/moodlemedia/tinymce/js','media.js',13],['lib/classes/event','competency_deleted.php',96],['admin/tool/xmldb/actions/revert_changes','revert_changes.class.php',32],['lib/xhprof/xhprof_html/jquery','jquery.autocomplete.js',565],['mod/assign/feedback/offline','importgradeslib.php',91],['mod/glossary/classes/event','entry_created.php',43],['lib/classes/event','dashboard_reset.php',40],['admin/tool/xmldb/actions/edit_index_save','edit_index_save.class.php',33],['lib/classes','component.php',119],['admin/tool/xmldb/actions/view_structure_php','view_structure_php.class.php',33],['mod/wiki/classes/event','page_history_viewed.php',37],['blocks/blog_tags','block_blog_tags.php',32],['lib/classes/event','competency_plan_review_request_cancelled.php',93],['lib/classes/event','competency_plan_deleted.php',82],['blocks/feedback','block_feedback.php',31],['mod/quiz/classes/event','attempt_viewed.php',45],['lib/adodb','adodb.inc.php',3102],['lib/adodb','adodb.inc.php',3266],['mod/data/classes/event','field_updated.php',46],['lib/classes/event','grouping_updated.php',83],['lib/editor/tinymce/tiny_mce/3.5.11/themes/advanced/js','about.js',3],['backup/converter/moodle1','lib.php',111],['lib/classes/event','question_category_created.php',39],['grade/report/user/classes/event','grade_report_viewed.php',39],['lib/classes/event','user_login_failed.php',45],['mod/scorm/classes/event','report_viewed.php',45],['mod/chat/classes/event','sessions_viewed.php',83],['admin/tool/recyclebin/classes/event','course_bin_item_deleted.php',38],['mod/quiz/classes/event','user_override_deleted.php',44],['portfolio/mahara','lib.php',53],['mod/quiz/classes/event','attempt_submitted.php',44],['mod/lesson/classes/event','group_override_updated.php',45],['mod/workshop/classes/event','submission_created.php',44],['mod/assign/classes/event','submission_updated.php',49],['lib/editor/atto/yui/build/moodle-editor_atto-rangy','moodle-editor_atto-rangy.js',242],['comment','lib.php',241],['mod/assign/submission/onlinetext/classes/event','assessable_uploaded.php',101],['lib/classes/event','competency_updated.php',88],['lib/classes/event','note_deleted.php',47],['mod/lesson/classes/event','page_moved.php',47],['admin/tool/xmldb/actions/edit_key','edit_key.class.php',32],['mod/book/classes/event','course_module_viewed.php',57],['mod/workshop/allocation/manual','lib.php',55],['lib/classes/event','course_completed.php',64],['lib/classes/event','tag_added.php',49],['lib/classes/event','competency_created.php',88],['mod/lesson/classes/event','highscores_viewed.php',42],['lib/classes/event','message_contact_unblocked.php',39],['admin/tool/xmldb/actions/template','template.class.php',31],['admin/tool/xmldb/actions/view_key_xml','view_key_xml.class.php',32],['blocks/search_forums','block_search_forums.php',26],['lib/classes/event','user_enrolment_created.php',44],['admin/tool/xmldb/actions/generate_all_documentation','generate_all_documentation.class.php',33],['lib/classes/event','course_module_created.php',48],['lib/classes/event','webservice_service_user_removed.php',77],['report/log/classes/event','report_viewed.php',48],['mod/assign/submission/file/classes/event','assessable_uploaded.php',113],['mod/imscp/classes/event','course_module_viewed.php',40],['lib/classes/event','group_member_added.php',96],['mod/forum/classes/event','discussion_viewed.php',39],['mod/assign/classes/event','submission_viewed.php',67],['mod/lti/classes/event','course_module_viewed.php',39],['mod/workshop/classes/event','submission_reassessed.php',46],['mod/feedback/classes/event','course_module_viewed.php',44],['admin/tool/xmldb/actions/load_xml_file','load_xml_file.class.php',32],['admin/tool/log/store/database/classes/log','store.php',62],['mod/workshop/classes/event','assessment_evaluations_reset.php',45],['mod/assign/classes/event','statement_accepted.php',86],['mod/assign/classes/event','feedback_viewed.php',67],['admin/tool/xmldb/actions/edit_field_save','edit_field_save.class.php',33],['mod/forum/classes/event','discussion_moved.php',45],['lib/classes/event','competency_user_evidence_deleted.php',82],['mod/assign/classes/event','batch_set_workflow_state_viewed.php',71],['mod/lesson/classes/event','lesson_resumed.php',39],['lib/editor/tinymce/tiny_mce/3.5.11/themes/advanced/js','color_picker.js',63],['blocks/navigation','block_navigation.php',55],['blocks/comments','block_comments.php',32],['lib/classes/event','comments_viewed.php',41],['mod/data/classes/event','template_viewed.php',45],['mod/wiki/classes/event','page_deleted.php',43],['mod/quiz/classes/event','report_viewed.php',46],['admin/tool/xmldb/actions/save_xml_file','save_xml_file.class.php',37],['admin/tool/xmldb/actions','XMLDBCheckAction.class.php',38],['mod/workshop/allocation','lib.php',40],['admin/tool/xmldb/actions/edit_table','edit_table.class.php',36],['mod/scorm/classes/event','sco_launched.php',45],['mod/glossary/classes/event','entry_updated.php',43],['mod/lesson/classes/event','user_override_created.php',44],['mod/glossary/classes/event','category_updated.php',37],['lib/classes/event','course_updated.php',49],['mod/feedback/classes/event','response_submitted.php',48],['lib/classes/event','blog_entry_deleted.php',43],['mod/book/classes/event','chapter_deleted.php',97],['report/completion/classes/event','report_viewed.php',39],['lib/classes/event','recent_activity_viewed.php',39],['mod/quiz/classes/event','question_manually_graded.php',46],['mod/assign/classes/event','submission_status_updated.php',88],['lib/classes/event','user_enrolment_updated.php',44],['admin/tool/xmldb/actions/delete_key','delete_key.class.php',32],['admin/tool/log/classes/log','manager.php',39],['lib/google/src/Google/Service','Spectrum.php',131],['lib/classes/event','tag_deleted.php',46],['report/completion/classes/event','user_report_viewed.php',39],['report/stats/classes/event','report_viewed.php',46],['lib/classes/event','calendar_event_created.php',47],['mod/survey/classes/event','course_module_viewed.php',45],['blocks/badges','block_badges.php',35],['mod/assign/classes/event','submission_duplicated.php',86],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/advlink/js','advlink.js',22],['lib/classes/event','competency_framework_deleted.php',82],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/xhtmlxtras/js','abbr.js',1],['lib/classes/event','course_section_updated.php',45],['lib/classes/event','message_sent.php',74],['lib/classes/event','calendar_subscription_deleted.php',45],['blocks/blog_recent','block_blog_recent.php',33],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/xhtmlxtras/js','ins.js',1],['lib/classes/event','course_category_updated.php',42],['admin/tool/xmldb/actions/create_xml_file','create_xml_file.class.php',31],['lib/classes/event','user_password_updated.php',62],['mod/forum/classes/event','subscription_deleted.php',44],['mod/assign/classes/event','reveal_identities_confirmation_page_viewed.php',71],['lib/classes/event','user_loggedinas.php',46],['lib/classes/event','competency_template_created.php',90],['blocks/selfcompletion','block_selfcompletion.php',37],['lib/classes/event','user_created.php',39],['blocks/community','block_community.php',28],['admin/tool/recyclebin/classes/event','category_bin_item_restored.php',38],['report/loglive/classes/event','report_viewed.php',38],['admin/tool/monitor/classes/event','subscription_created.php',39],['lib/classes/session','memcached.php',118],['mod/book/classes/event','chapter_viewed.php',97],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/xhtmlxtras/js','acronym.js',1],['lib/classes/event','badge_awarded.php',45],['lib/classes/event','calendar_subscription_created.php',46],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/table/js','cell.js',5],['lib/classes/event','enrol_instance_created.php',87],['mod/folder/classes/event','course_module_viewed.php',39],['lib/classes/event','user_list_viewed.php',47],['mod/forum/classes/event','post_deleted.php',46],['mod/quiz/classes/event','group_override_deleted.php',45],['lib/classes/event','badge_created.php',38],['blocks/recent_activity','block_recent_activity.php',43],['lib/classes/event','competency_framework_viewed.php',87],['lib/classes/event','tag_collection_deleted.php',39],['mod/glossary/classes/event','course_module_viewed.php',44],['admin/tool/xmldb/actions/edit_xml_file','edit_xml_file.class.php',35],['lib/classes/event','group_member_removed.php',87],['lib/classes/event','grade_report_viewed.php',42],['mod/scorm/classes/event','course_module_viewed.php',38],['lib/classes/event','calendar_event_updated.php',47],['lib/classes/event','user_updated.php',39],['mod/lesson/classes/event','page_created.php',45],['grade/report/singleview/classes/local/screen','select.php',41],['lib/classes/event','assessable_uploaded.php',53],['grade/report/singleview/classes/local/screen','user.php',94],['mod/assign/classes/event','submission_form_viewed.php',74],['mod/url/classes/event','course_module_viewed.php',39],['auth/cas/CAS/CAS/PGTStorage','Db.php',174],['lib/adodb/drivers','adodb-oci8.inc.php',1564],['lib/classes/session','database.php',65],['question/classes/bank/search','category_condition.php',79],['lib/classes/event','course_completion_updated.php',39],['lib/classes/event','competency_plan_review_started.php',93],['lib/classes/event','course_user_report_viewed.php',46],['mod/folder/classes/event','all_files_downloaded.php',39],['mod/workshop/classes/event','assessments_reset.php',44],['mod/data/classes/event','template_updated.php',46],['mod/assign/classes/event','identities_revealed.php',84],['question/classes/bank','copy_action_column.php',30],['admin/tool/log/store/legacy/classes/event','legacy_logged.php',31],['lib/classes/event','notes_viewed.php',41],['admin/tool/recyclebin/classes/event','category_bin_item_created.php',38],['lib/classes/event','competency_plan_viewed.php',90],['mod/data/classes/event','record_updated.php',45],['lib/classes/event','competency_plan_unapproved.php',93],['mod/lesson/classes/event','content_page_viewed.php',39],['admin/tool/monitor/classes/event','subscription_deleted.php',39],['mod/assign/classes/event','assessable_submitted.php',118],['grade/report/singleview/classes/local/screen','grade.php',126],['admin/tool/xmldb/actions/move_updown_field','move_updown_field.class.php',32],['mod/quiz/classes/event','attempt_started.php',43],['blocks/tag_youtube','block_tag_youtube.php',34],['lib/editor/atto/yui/src/rangy/js','rangy-core.js',242],['mod/wiki/classes/event','course_module_viewed.php',38],['lib/classes/event','competency_user_competency_rated.php',100],['mod/forum/classes/event','post_updated.php',46],['admin/tool/xmldb/actions/edit_table_save','edit_table_save.class.php',32],['lib/classes/event','course_module_deleted.php',47],['lib/classes/event','competency_plan_review_requested.php',93],['lib/classes/event','user_graded.php',85],['lib/classes/event','webservice_login_failed.php',80],['blocks/course_summary','block_course_summary.php',32],['mod/forum/classes/event','post_created.php',46],['mod/assign/classes/event','submission_status_viewed.php',71],['mod/scorm/classes/event','cmielement_submitted.php',46],['lib/classes/event','enrol_instance_updated.php',88],['admin/tool/capability/classes/event','report_viewed.php',36],['mod/data/classes/event','field_created.php',47],['admin/tool/xmldb/actions/edit_index','edit_index.class.php',32],['mod/folder/classes/event','folder_updated.php',39],['lib/classes/event','badge_updated.php',38],['lib/tests/fixtures','event_fixtures.php',42],['lib/tests/fixtures','event_fixtures.php',117],['lib/tests/fixtures','event_fixtures.php',124],['lib/tests/fixtures','event_fixtures.php',131],['lib/tests/fixtures','event_fixtures.php',139],['lib/tests/fixtures','event_fixtures.php',147],['lib/tests/fixtures','event_fixtures.php',155],['lib/tests/fixtures','event_fixtures.php',162],['lib/tests/fixtures','event_fixtures.php',170],['lib/tests/fixtures','event_fixtures.php',178],['lib/tests/fixtures','event_fixtures.php',186],['lib/tests/fixtures','event_fixtures.php',193],['lib/tests/fixtures','event_fixtures.php',201],['lib/tests/fixtures','event_fixtures.php',216],['lib/tests/fixtures','event_fixtures.php',225],['lib/tests/fixtures','event_fixtures.php',238],['lib/tests/fixtures','event_fixtures.php',267],['lib/tests/fixtures','event_fixtures.php',304],['lib/tests/fixtures','event_fixtures.php',315],['lib/tests/fixtures','event_fixtures.php',338],['lib/tests/fixtures','event_fixtures.php',345],['mod/lesson/classes/event','course_module_viewed.php',40],['admin/tool/xmldb/actions/edit_field','edit_field.class.php',32],['admin/tool/xmldb/actions/move_updown_key','move_updown_key.class.php',32],['lib','graphlib.php',158],['mod/survey/classes/event','report_viewed.php',46],['grade/report/singleview/tests/fixtures','screen.php',38],['blocks/tags','block_tags.php',26],['mod/quiz/classes/event','attempt_deleted.php',44],['blocks/participants','block_participants.php',26],['mod/glossary/classes/event','entry_approved.php',37],['mod/wiki/classes/event','comments_viewed.php',38],['mod/wiki/classes/event','page_viewed.php',46],['mod/assign/submission/onlinetext/classes/event','submission_updated.php',45],['mod/forum/classes/event','readtracking_disabled.php',44],['mod/assign/submission/file/classes/event','submission_created.php',45],['admin/tool/langimport/classes/event','langpack_imported.php',61],['lib/classes/event','competency_plan_review_stopped.php',93],['admin/tool/langimport/classes/event','langpack_updated.php',61],['blocks/online_users','block_online_users.php',33],['admin/tool/xmldb/actions/load_xml_files','load_xml_files.class.php',32],['lib/classes/event','unknown_logged.php',39],['lib/classes/event','competency_user_competency_viewed_in_plan.php',104],['lib/classes/event','competency_user_competency_viewed_in_course.php',103],['mod/glossary/classes/event','category_created.php',37],['lib/portfolio','plugin.php',476],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/xhtmlxtras/js','cite.js',1],['mnet','environment.php',20],['blocks/login','block_login.php',26],['report/stats/classes/event','user_report_viewed.php',38],['lib/classes/event','dashboards_reset.php',40],['lib/classes/event','calendar_subscription_updated.php',46],['lib/classes/event','cohort_updated.php',38],['admin/tool/monitor/classes/event','rule_updated.php',39],['mod/lesson/classes/event','page_deleted.php',45],['lib/classes/event','course_section_deleted.php',46],['admin/tool/monitor/classes/event','subscription_criteria_met.php',45],['admin/tool/xmldb/actions/new_table','new_table.class.php',32],['lib/classes/event','mnet_access_control_created.php',48],['mod/forum/classes/event','discussion_created.php',44],['lib/classes/event','blog_entries_viewed.php',53],['mod/quiz/classes/event','attempt_preview_started.php',45],['lib/classes/event','content_viewed.php',56],['lib/classes/event','competency_user_evidence_updated.php',91],['blocks/activity_results','block_activity_results.php',51],['blocks/calendar_month','block_calendar_month.php',26],['backup/util/xml/output','memory_xml_output.class.php',51],['mod/assign/classes/event','submission_graded.php',87],['admin/tool/xmldb/actions/view_reserved_words','view_reserved_words.class.php',35],['mod/assign/classes/event','all_submissions_downloaded.php',84],['lib/classes/event','course_restored.php',49],['auth/cas/CAS/CAS/PGTStorage','AbstractStorage.php',173],['lib/classes/event','group_created.php',83],['lib/classes/event','badge_criteria_deleted.php',43],['lib/classes/event','tag_flagged.php',46],['lib/classes/event','competency_plan_completed.php',93],['mod/lesson/classes/event','user_override_updated.php',45],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/fullpage/js','fullpage.js',162],['lib/classes/event','role_allow_override_updated.php',39],['admin/tool/xmldb/actions/check_foreign_keys','check_foreign_keys.class.php',38],['mod/forum/classes/event','discussion_subscription_deleted.php',45],['lib/classes/event','cohort_deleted.php',38],['blocks/course_list','block_course_list.php',29],['lib/classes/event','badge_criteria_created.php',43],['blocks/messages','block_messages.php',26],['mod/workshop/classes/event','course_module_viewed.php',42],['admin/tool/xmldb/actions/view_xml','view_xml.class.php',32],['lib/classes/event','blog_entry_created.php',44],['blocks/rss_client','block_rss_client.php',36],['mod/scorm/classes/event','interactions_viewed.php',45],['mod/workshop/classes/event','submission_assessed.php',45],['lib/classes/event','badge_duplicated.php',38],['lib/classes/event','course_category_created.php',39],['lib/classes/event','cohort_created.php',38],['lib/classes/event','tag_removed.php',49],['lib/classes/event','competency_plan_approved.php',93],['mod/choice/classes/event','answer_deleted.php',74],['lib/classes/event','competency_user_competency_review_started.php',90],['lib/classes/event','course_reset_ended.php',71],['mod/quiz/classes/event','user_override_created.php',44],['admin/tool/xmldb/actions','XMLDBAction.class.php',63],['mod/forum/classes/event','course_searched.php',45],['lib/classes/event','message_contact_removed.php',39],['admin/tool/monitor/classes/event','rule_deleted.php',39],['lib/classes/event','message_deleted.php',83],['mod/assign/classes/event','submission_unlocked.php',87],['lib/classes/event','competency_user_competency_review_stopped.php',90],['lib/classes/event','course_module_viewed.php',40],['question/classes/bank','delete_action_column.php',30]], 470],
'delete_records': ['delete_records', 'Delete the records from a table where all the given conditions met. If conditions not specified, table is truncated. ', [['lib/dml','sqlite3_pdo_moodle_database.php',345],['lib/dml','moodle_database.php',1864]], 773],
'isguestuser': ['isguestuser', 'Determines if a user is logged in as real guest user with username \'guest\'. ', [['lib','accesslib.php',1923]], 260],
'get_complete_user_data': ['get_complete_user_data', 'Get a complete user record, which includes all the info in the user record. ', [['lib','moodlelib.php',4516]], 24],
'guest_user': ['guest_user', 'Retrieve the guest user object. ', [['lib','moodlelib.php',4060]], 10],
'keepalive': ['keepalive', 'Add a JS session keepalive to the page. ', [['lib/classes/session','manager.php',876]], 1],
'list': ['list', '', [['mod/data/preset/imagegallery','jstemplate.js',9]], 2229],
'check_security': ['check_security', '', [['backup/util/checks','backup_check.class.php',86],['lib/classes/session','manager.php',439],['backup/util/checks','restore_check.class.php',53]], 8],
'apply_concurrent_login_limit': ['apply_concurrent_login_limit', 'Terminate other sessions of current user depending on $CFG->limitconcurrentlogins restriction. ', [['lib/classes/session','manager.php',650]], 21],
'is_web_crawler': ['is_web_crawler', 'Returns true if the client appears to be some kind of web crawler. This may include other types of crawler. ', [['lib/classes','useragent.php',990],['lib','deprecatedlib.php',2242]], 11],
'session_exists': ['session_exists', 'Check the backend contains data for this session id. ', [['lib/classes/session','file.php',78],['lib/classes/session','memcache.php',123],['lib/classes/session','memcached.php',148],['lib/classes/session','database.php',84],['lib/classes/session','manager.php',549]], 13],
'update_record': ['update_record', 'Update a record in a table ', [['lib/dml','pdo_moodle_database.php',461],['lib/dml','oci_native_moodle_database.php',1404],['lib/dml','pgsql_native_moodle_database.php',1089],['lib/dml','mssql_native_moodle_database.php',1067],['lib/dml','mysqli_native_moodle_database.php',1405],['lib/dml','sqlsrv_native_moodle_database.php',1148],['lib/dml/tests','dml_test.php',5551]], 650],
'init_empty_session': ['init_empty_session', 'Empty current session, fill it with not-logged-in user info. ', [['lib/classes/session','manager.php',152]], 22],
'raise': ['raise', 'Sets the PHP time limit to a number of seconds from now. ', [['lib/classes','php_time_limit.php',41]], 90],
'get_enabled_auth_plugins': ['get_enabled_auth_plugins', 'Returns array of active auth plugins. ', [['lib','moodlelib.php',3628]], 18],
'touch_session': ['touch_session', 'Fake last access for given session, this prevents session timeout. ', [['lib/classes/session','manager.php',584]], 5],
'loginas': ['loginas', 'Login as another user - no security checks here. ', [['lib/classes/session','manager.php',831]], 10],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required, Some conversions and safety checks are carried out. Lobs are supported. If the return ID isn\'t required, then this just reports success as true/false. $data is an object containing needed data ', [['lib/dml','pdo_moodle_database.php',387],['lib/dml','oci_native_moodle_database.php',1297],['lib/dml','pgsql_native_moodle_database.php',889],['lib/dml','mssql_native_moodle_database.php',962],['lib/dml','mysqli_native_moodle_database.php',1185],['question/engine/upgrade','upgradelib.php',124],['lib/dml','sqlsrv_native_moodle_database.php',1045],['lib/dml/tests','dml_test.php',5548]], 1611],
'trigger': ['trigger', '', [['lib/evalmath','evalmath.class.php',448],['lib/classes/event','base.php',765]], 964],
'kill_all_sessions': ['kill_all_sessions', 'Kill all active sessions, the core sessions table is purged afterwards. ', [['lib/classes/session','file.php',95],['lib/classes/session','memcache.php',167],['lib/classes/session','memcached.php',179],['lib/classes/session','database.php',97],['lib/classes/session','manager.php',597]], 5],
'terminate_current': ['terminate_current', 'Terminate current user session. ', [['lib/classes/session','manager.php',486]], 7],
'get_auth_plugin': ['get_auth_plugin', 'Returns an authentication plugin instance. ', [['lib','moodlelib.php',3608]], 81],
'count_records': ['count_records', 'Count a list of records. ', [['competency/classes','persistent.php',815],['mod/glossary/classes','entry_query_builder.php',152],['lib/dml','moodle_database.php',1766]], 1630],
'get_records_select': ['get_records_select', 'Load a list of records based on a select query. ', [['competency/classes','persistent.php',751],['lib/dml','moodle_database.php',1332]], 166],
'session': ['session', '', [['lib/editor/atto/yui/build/moodle-editor_atto-rangy','moodle-editor_atto-rangy-debug.js',7170],['lib/editor/atto/yui/src/rangy/js','rangy-textrange.js',1071],['lib/editor/atto/yui/build/moodle-editor_atto-rangy','moodle-editor_atto-rangy.js',7170]], 5],
'ignore_timeout_hook': ['ignore_timeout_hook', 'Hook called before timing out of database session. This is useful for SSO and MNET. ', [['lib','authlib.php',517]], 2],
'is_loggedinas': ['is_loggedinas', 'Is current $USER logged-in-as somebody else? ', [['lib/classes/session','manager.php',811]], 30],
'get_recordset_select': ['get_recordset_select', 'Get a number of records as a moodle_recordset which match a particular WHERE clause. ', [['lib/dml','moodle_database.php',1224]], 45],
'get_local_referer': ['get_local_referer', 'Returns the cleaned local URL of the HTTP_REFERER less the URL query string parameters if required. ', [['lib','weblib.php',219]], 31],
'getmessage': ['getmessage', '', [['lib/google/src/Google/Service','Freebase.php',441],['lib/google/src/Google/Service','AdSense.php',2970],['lib/google/src/Google/Service','Replicapool.php',1165],['lib/google/src/Google/Service','Replicapool.php',1257],['lib/google/src/Google/Service','Computeaccounts.php',1368],['lib/google/src/Google/Service','Computeaccounts.php',1460],['lib/google/src/Google/Service','Appengine.php',1604],['lib/google/src/Google/Service','Books.php',3579],['lib/google/src/Google/Service','Books.php',4429],['lib/google/src/Google/Service','Script.php',360],['lib/google/src/Google/Service','DeploymentManager.php',1116],['lib/google/src/Google/Service','DeploymentManager.php',1604],['lib/google/src/Google/Service','DeploymentManager.php',1641],['lib/google/src/Google/Service','DeploymentManager.php',1823],['lib/google/src/Google/Service','DeploymentManager.php',1860],['lib/google/src/Google/Service','Dataflow.php',2656],['lib/google/src/Google/Service','CloudUserAccounts.php',1807],['lib/google/src/Google/Service','CloudUserAccounts.php',1899],['lib/google/src/Google/Service','Replicapoolupdater.php',617],['lib/google/src/Google/Service','Replicapoolupdater.php',926],['lib/google/src/Google/Service','Replicapoolupdater.php',1018],['lib/google/src/Google/Service','Replicapoolupdater.php',1252],['lib/google/src/Google/Service','Bigquery.php',1367],['lib/google/src/Google/Service','ShoppingContent.php',4125],['lib/google/src/Google/Service','ShoppingContent.php',4527],['lib/google/src/Google/Service','ShoppingContent.php',4572],['lib/google/src/Google/Service','Genomics.php',3622],['lib/google/src/Google/Service','Reports.php',1106],['lib/google/src/Google/Service','Gmail.php',1371],['lib/google/src/Google/Service','Gmail.php',1467],['lib/google/src/Google/Service','Gmail.php',1495],['lib/google/src/Google/Service','Gmail.php',1513],['lib/google/src/Google/Service','Gmail.php',1531],['lib/google/src/Google/Service','Autoscaler.php',1079],['lib/google/src/Google/Service','Autoscaler.php',1171],['lib/google/src/Google/Service','AdExchangeSeller.php',1043],['lib/google/src/Google/Service','IdentityToolkit.php',1266],['lib/pear','PEAR.php',941],['lib/google/src/Google/Service','Storagetransfer.php',948],['lib/htmlpurifier/HTMLPurifier','Language.php',86],['lib/google/src/Google/Service','Resourceviews.php',894],['lib/google/src/Google/Service','Resourceviews.php',986],['lib/google/src/Google/Service','SQLAdmin.php',3029],['lib/google/src/Google/Service','Compute.php',8752],['lib/google/src/Google/Service','Compute.php',9200],['lib/google/src/Google/Service','Compute.php',10292],['lib/google/src/Google/Service','Compute.php',10384],['lib/google/src/Google/Service','Compute.php',10890],['lib/google/src/Google/Service','Compute.php',12525],['lib/google/src/Google/Service','Compute.php',12771],['lib/google/src/Google/Service','Compute.php',13249],['lib/google/src/Google/Service','Compute.php',13652],['lib/google/src/Google/Service','Compute.php',13804],['lib/google/src/Google/Service','Compute.php',14396],['lib/google/src/Google/Service','Compute.php',14488],['lib/google/src/Google/Service','Compute.php',14580],['lib/google/src/Google/Service','Compute.php',15235],['lib/google/src/Google/Service','Compute.php',16249],['lib/google/src/Google/Service','Compute.php',16675],['lib/google/src/Google/Service','Compute.php',17005],['lib/google/src/Google/Service','Compute.php',17723],['lib/google/src/Google/Service','Pubsub.php',711],['lib/google/src/Google/Service','Pubsub.php',748],['lib/google/src/Google/Service','Dfareporting.php',19533]], 489],
'kill_session': ['kill_session', 'Kill one session, the session record is removed afterwards. ', [['lib/classes/session','file.php',107],['lib/classes/session','memcache.php',194],['lib/classes/session','memcached.php',217],['lib/classes/session','database.php',106],['lib/classes/session','manager.php',615]], 16],
'load_handler': ['load_handler', 'Create handler instance. ', [['lib/classes/session','manager.php',126]], 5],
'prepare_cookies': ['prepare_cookies', 'Make sure all cookie and session related stuff is configured properly before session start. ', [['lib/classes/session','manager.php',188]], 1],
'headers_sent': ['headers_sent', '', [], 13],
'defined': ['defined', '', [], 4731],
'session_set_cookie_params': ['session_set_cookie_params', '', [], 1],
'ini_set': ['ini_set', '', [], 124],
'session_write_close': ['session_write_close', '', [], 6],
'session_name': ['session_name', '', [], 8],
'preg_match': ['preg_match', '', [], 1286],
'version_compare': ['version_compare', '', [], 74],
'error_log': ['error_log', '', [], 90],
'session_id': ['session_id', '', [], 37],
'session_encode': ['session_encode', '', [], 1],
'strpos': ['strpos', '', [], 1604],
'time': ['time', '', [], 1959],
'array_flip': ['array_flip', '', [], 131],
'preg_quote': ['preg_quote', '', [], 205],
'session_regenerate_id': ['session_regenerate_id', '', [], 5],
'get_class': ['get_class', '', [], 305],
'substr': ['substr', '', [], 2823],
'parse_url': ['parse_url', '', [], 55]};
CLASS_DATA={
'manager': ['manager', 'Search subsystem manager. ', [['search/classes','manager.php',31],['user/classes/output/myprofile','manager.php',28],['lib/classes/antivirus','manager.php',29],['lib/classes/event','manager.php',30],['lib/classes/task','manager.php',28],['admin/tool/messageinbound/classes','manager.php',29],['lib/classes/message/inbound','manager.php',29],['admin/tool/log/classes/log','manager.php',29],['lib/classes/log','manager.php',29],['lib/classes/session','manager.php',29],['lib/classes/message','manager.php',31]], 585],
'core_php_time_limit': ['core_php_time_limit', 'Utility class to manage PHP time limit. ', [['lib/classes','php_time_limit.php',27]], 92],
'user_loggedinas': ['user_loggedinas', 'User loggedinas event class. ', [['lib/classes/event','user_loggedinas.php',29]], 1],
'exception': ['exception', 'Session related exception class. ', [['lib/classes/session','exception.php',29],['lib/horde/framework/Horde/Socket/Client','Exception.php',17]], 219],
'core_useragent': ['core_useragent', 'The user agent class. ', [['lib/classes','useragent.php',25]], 159]};
CONST_DATA={
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',140],['','install.php',93],['lib','setup.php',391]], 4153],
'DEBUG_DEVELOPER': ['DEBUG_DEVELOPER', '', [['lib','setuplib.php',40]], 736],
'SQL_PARAMS_QM': ['SQL_PARAMS_QM', '', [['lib/dml','moodle_database.php',35]], 40],
'EXTERNAL_TOKEN_EMBEDDED': ['EXTERNAL_TOKEN_EMBEDDED', '', [['lib','moodlelib.php',473]], 6],
'PHPUNIT_TEST': ['PHPUNIT_TEST', '', [['admin/cli','install.php',145],['','install.php',49],['lib/phpunit','bootstrap.php',63],['lib','setup.php',247]], 59],
'NO_MOODLE_COOKIES': ['NO_MOODLE_COOKIES', '', [['rss','file.php',34],['grade/export/xml','dump.php',18],['login','token.php',26],['','help.php',29],['grade/import/xml','fetch.php',18],['lib/ajax','service-nologin.php',30],['webservice','upload.php',42],['mod/data','js.php',26],['theme','font.php',124],['mod/data','css.php',26],['grade/export/txt','dump.php',18],['grade/export/xls','dump.php',18],['auth/ldap','ntlmsso_magic.php',7],['lib/editor/tinymce','all_strings.php',25],['lib/flowplayer','flowplayer-3.2.18.swf.php',26],['theme','image.php',127],['mod/lti','services.php',27],['mod/assign/feedback/editpdf','ajax_progress.php',28],['mod/chat/gui_header_js','chatinput.php',17],['','help_ajax.php',26],['user','grouppix.php',30],['mod/chat/gui_sockets','chatinput.php',17],['theme','javascript.php',83],['badges','assertion.php',28],['lib/editor/tinymce/plugins','loader.php',32],['filter/tex','pix.php',8],['mod/lti','service.php',27],['mod/chat/gui_header_js','jsupdated.php',33],['filter/algebra','pix.php',8],['grade/export/ods','dump.php',18],['theme','styles_debug.php',29],['mod/chat/gui_header_js','users.php',17],['lib/flowplayer','flowplayer.audio-3.2.11.swf.php',26],['lib','setuplib.php',863],['mnet/xmlrpc','server.php',16],['mod/chat/gui_header_js','jsupdate.php',17],['filter/tex','displaytex.php',28],['webservice','pluginfile.php',34],['theme','styles.php',112],['lib','setup.php',760],['lib','setup.php',764],['lib','setup.php',769],['lib','setup.php',772],['lib','setup.php',774],['lib/flowplayer','flowplayer.controls-3.2.16.swf.php',26],['lib/editor/tinymce/plugins/moodleemoticon','dialog.php',25]], 57],
'PARAM_LANG': ['PARAM_LANG', '', [['lib','moodlelib.php',161]], 19],
'CLI_SCRIPT': ['CLI_SCRIPT', '', [['enrol/ldap/cli','sync.php',43],['lib/filestorage/tests/fixtures','zip_create_test_file.php',25],['admin/cli','fix_course_sequence.php',26],['admin/tool/behat/cli','run.php',30],['admin/cli','upgrade.php',38],['admin/cli','install.php',32],['admin/tool/uploadcourse/cli','uploadcourse.php',25],['admin/cli','fix_orphaned_question_categories.php',29],['admin/tool/generator/cli','maketestsite.php',25],['admin/cli','purge_caches.php',24],['admin/cli','install_database.php',31],['admin/tool/behat/cli','util.php',34],['admin/tool/task/cli','schedule_task.php',25],['admin/tool/replace/cli','replace.php',25],['auth/db/cli','sync_users.php',45],['admin/cli','automated_backups.php',29],['enrol/manual/cli','sync.php',30],['lib/editor/tinymce/cli','update_lang_files.php',25],['auth/ldap/cli','sync_users.php',47],['admin/cli','fix_deleted_users.php',26],['admin/cli','maintenance.php',26],['lib/tests/behat','behat_hooks.php',133],['admin/cli','reset_password.php',27],['admin/tool/dbtransfer/cli','migrate.php',30],['enrol/category/cli','sync.php',33],['admin/cli','mysql_compressed_rows.php',26],['enrol/paypal/cli','sync.php',30],['admin/cli','cron.php',31],['enrol/database/cli','sync.php',34],['admin/cli','mysql_collation.php',25],['auth/cas/cli','sync_users.php',43],['enrol/cohort/cli','sync.php',31],['admin/tool/generator/cli','maketestcourse.php',25],['admin/cli','backup.php',26],['search/cli','indexer.php',25],['admin/cli','check_database_schema.php',26],['admin/tool/behat/cli','util_single_run.php',90],['enrol/self/cli','sync.php',31],['','install.php',46],['theme/base/cli','svgtool.php',26],['admin','cron.php',47],['admin/tool/behat/cli','init.php',36],['enrol/meta/cli','sync.php',31],['admin/cli','alternative_component_cache.php',30],['admin/tool/generator/cli','maketestplan.php',25],['lib/phpunit','bootstrap.php',73],['lib','setup.php',289],['mod/chat','chatd.php',25],['lib/filestorage/tests/fixtures','zip_info.php',25],['enrol/flatfile/cli','sync.php',45],['admin/cli','mysql_engine.php',27]], 114],
'DEBUG_NORMAL': ['DEBUG_NORMAL', '', [['lib','setuplib.php',36]], 22]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Aug 11 10:00:09 2016</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
