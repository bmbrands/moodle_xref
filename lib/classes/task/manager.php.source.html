<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /lib/classes/task/manager.php source</title>
    <link rel="stylesheet" href="../../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu May 28 19:17:31 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../../';
subdir='lib/classes/task';
filename='manager.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/lib/classes/task/</a> -> <a href="manager.php.html">manager.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="manager.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="manager.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * Scheduled and adhoc task management.</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * @package    core</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @category   task</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @copyright  2013 Damyon Wiese</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> */</span>
<a name="l25"><span class="linenum">  25</span></a>  namespace core\task;
<a name="l26"><span class="linenum">  26</span></a>  
<a name="l27"><span class="linenum">  27</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('CORE_TASK_TASKS_FILENAME')" href="../../../_constants/CORE_TASK_TASKS_FILENAME.html" onMouseOver="constPopup(event,'CORE_TASK_TASKS_FILENAME')">CORE_TASK_TASKS_FILENAME</a>', 'db/tasks.php');
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment">/**</span>
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment"> * Collection of task related methods.</span>
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment"> *</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment"> * Some locking rules for this class:</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> * All changes to scheduled tasks must be protected with both - the global cron lock and the lock</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> * for the specific scheduled task (in that order). Locks must be released in the reverse order.</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> * @copyright  2013 Damyon Wiese</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment"> */</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('manager')" href="../../../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a> {
<a name="l38"><span class="linenum">  38</span></a>  
<a name="l39"><span class="linenum">  39</span></a>      <span class="comment">/**</span>
<a name="l40"><span class="linenum">  40</span></a>  <span class="comment">     * Given a component name, will load the list of tasks in the db/tasks.php file for that component.</span>
<a name="l41"><span class="linenum">  41</span></a>  <span class="comment">     *</span>
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment">     * @param string $componentname - The name of the component to fetch the tasks for.</span>
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment">     * @return \core\task\scheduled_task[] - List of scheduled tasks for this component.</span>
<a name="l44"><span class="linenum">  44</span></a>  <span class="comment">     */</span>
<a name="l45"><span class="linenum">  45</span></a>      public static function <a class="function" onClick="logFunction('load_default_scheduled_tasks_for_component')" href="../../../_functions/load_default_scheduled_tasks_for_component.html" onMouseOver="funcPopup(event,'load_default_scheduled_tasks_for_component')">load_default_scheduled_tasks_for_component</a>(<a class="var it9637" onMouseOver="hilite(9637)" onMouseOut="lolite()" onClick="logVariable('componentname')" href="../../../_variables/componentname.html">$componentname</a>) {
<a name="l46"><span class="linenum">  46</span></a>          <a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../_variables/dir.html">$dir</a> = \<a class="class" onClick="logClass('core_component')" href="../../../_classes/core_component.html" onMouseOver="classPopup(event,'core_component')">core_component</a>::<a class="function" onClick="logFunction('get_component_directory')" href="../../../_functions/get_component_directory.html" onMouseOver="funcPopup(event,'get_component_directory')">get_component_directory</a>(<a class="var it9637" onMouseOver="hilite(9637)" onMouseOut="lolite()" onClick="logVariable('componentname')" href="../../../_variables/componentname.html">$componentname</a>);
<a name="l47"><span class="linenum">  47</span></a>  
<a name="l48"><span class="linenum">  48</span></a>          if (!<a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../_variables/dir.html">$dir</a>) {
<a name="l49"><span class="linenum">  49</span></a>              return array();
<a name="l50"><span class="linenum">  50</span></a>          }
<a name="l51"><span class="linenum">  51</span></a>  
<a name="l52"><span class="linenum">  52</span></a>          <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../../_variables/file.html">$file</a> = <a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../_variables/dir.html">$dir</a> . '/' . <a class="constant" onClick="logConstant('CORE_TASK_TASKS_FILENAME')" href="../../../_constants/CORE_TASK_TASKS_FILENAME.html" onMouseOver="constPopup(event,'CORE_TASK_TASKS_FILENAME')">CORE_TASK_TASKS_FILENAME</a>;
<a name="l53"><span class="linenum">  53</span></a>          if (!<a class="phpfunction" onClick="logFunction('file_exists')" href="../../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../../_variables/file.html">$file</a>)) {
<a name="l54"><span class="linenum">  54</span></a>              return array();
<a name="l55"><span class="linenum">  55</span></a>          }
<a name="l56"><span class="linenum">  56</span></a>  
<a name="l57"><span class="linenum">  57</span></a>          <a class="var it3194" onMouseOver="hilite(3194)" onMouseOut="lolite()" onClick="logVariable('tasks')" href="../../../_variables/tasks.html">$tasks</a> = null;
<a name="l58"><span class="linenum">  58</span></a>          require_once(<a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../../_variables/file.html">$file</a>);
<a name="l59"><span class="linenum">  59</span></a>  
<a name="l60"><span class="linenum">  60</span></a>          if (!isset(<a class="var it3194" onMouseOver="hilite(3194)" onMouseOut="lolite()" onClick="logVariable('tasks')" href="../../../_variables/tasks.html">$tasks</a>)) {
<a name="l61"><span class="linenum">  61</span></a>              return array();
<a name="l62"><span class="linenum">  62</span></a>          }
<a name="l63"><span class="linenum">  63</span></a>  
<a name="l64"><span class="linenum">  64</span></a>          <a class="var it36127" onMouseOver="hilite(36127)" onMouseOut="lolite()" onClick="logVariable('scheduledtasks')" href="../../../_variables/scheduledtasks.html">$scheduledtasks</a> = array();
<a name="l65"><span class="linenum">  65</span></a>  
<a name="l66"><span class="linenum">  66</span></a>          foreach (<a class="var it3194" onMouseOver="hilite(3194)" onMouseOut="lolite()" onClick="logVariable('tasks')" href="../../../_variables/tasks.html">$tasks</a> as <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>) {
<a name="l67"><span class="linenum">  67</span></a>              <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a> = (object) <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>;
<a name="l68"><span class="linenum">  68</span></a>              <a class="var it36128" onMouseOver="hilite(36128)" onMouseOut="lolite()" onClick="logVariable('scheduledtask')" href="../../../_variables/scheduledtask.html">$scheduledtask</a> = self::<a class="function" onClick="logFunction('scheduled_task_from_record')" href="../../../_functions/scheduled_task_from_record.html" onMouseOver="funcPopup(event,'scheduled_task_from_record')">scheduled_task_from_record</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>);
<a name="l69"><span class="linenum">  69</span></a>  <span class="comment">            // Safety check in case the task in the DB does not match a real class (maybe something was uninstalled).</span>
<a name="l70"><span class="linenum">  70</span></a>              if (<a class="var it36128" onMouseOver="hilite(36128)" onMouseOut="lolite()" onClick="logVariable('scheduledtask')" href="../../../_variables/scheduledtask.html">$scheduledtask</a>) {
<a name="l71"><span class="linenum">  71</span></a>                  <a class="var it36128" onMouseOver="hilite(36128)" onMouseOut="lolite()" onClick="logVariable('scheduledtask')" href="../../../_variables/scheduledtask.html">$scheduledtask</a>-&gt;<a class="function" onClick="logFunction('set_component')" href="../../../_functions/set_component.html" onMouseOver="funcPopup(event,'set_component')">set_component</a>(<a class="var it9637" onMouseOver="hilite(9637)" onMouseOut="lolite()" onClick="logVariable('componentname')" href="../../../_variables/componentname.html">$componentname</a>);
<a name="l72"><span class="linenum">  72</span></a>                  <a class="var it36127" onMouseOver="hilite(36127)" onMouseOut="lolite()" onClick="logVariable('scheduledtasks')" href="../../../_variables/scheduledtasks.html">$scheduledtasks</a>[] = <a class="var it36128" onMouseOver="hilite(36128)" onMouseOut="lolite()" onClick="logVariable('scheduledtask')" href="../../../_variables/scheduledtask.html">$scheduledtask</a>;
<a name="l73"><span class="linenum">  73</span></a>              }
<a name="l74"><span class="linenum">  74</span></a>          }
<a name="l75"><span class="linenum">  75</span></a>  
<a name="l76"><span class="linenum">  76</span></a>          return <a class="var it36127" onMouseOver="hilite(36127)" onMouseOut="lolite()" onClick="logVariable('scheduledtasks')" href="../../../_variables/scheduledtasks.html">$scheduledtasks</a>;
<a name="l77"><span class="linenum">  77</span></a>      }
<a name="l78"><span class="linenum">  78</span></a>  
<a name="l79"><span class="linenum">  79</span></a>      <span class="comment">/**</span>
<a name="l80"><span class="linenum">  80</span></a>  <span class="comment">     * Update the database to contain a list of scheduled task for a component.</span>
<a name="l81"><span class="linenum">  81</span></a>  <span class="comment">     * The list of scheduled tasks is taken from @load_scheduled_tasks_for_component.</span>
<a name="l82"><span class="linenum">  82</span></a>  <span class="comment">     * Will throw exceptions for any errors.</span>
<a name="l83"><span class="linenum">  83</span></a>  <span class="comment">     *</span>
<a name="l84"><span class="linenum">  84</span></a>  <span class="comment">     * @param string $componentname - The frankenstyle component name.</span>
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment">     */</span>
<a name="l86"><span class="linenum">  86</span></a>      public static function <a class="function" onClick="logFunction('reset_scheduled_tasks_for_component')" href="../../../_functions/reset_scheduled_tasks_for_component.html" onMouseOver="funcPopup(event,'reset_scheduled_tasks_for_component')">reset_scheduled_tasks_for_component</a>(<a class="var it9637" onMouseOver="hilite(9637)" onMouseOut="lolite()" onClick="logVariable('componentname')" href="../../../_variables/componentname.html">$componentname</a>) {
<a name="l87"><span class="linenum">  87</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l88"><span class="linenum">  88</span></a>          <a class="var it3194" onMouseOver="hilite(3194)" onMouseOut="lolite()" onClick="logVariable('tasks')" href="../../../_variables/tasks.html">$tasks</a> = self::<a class="function" onClick="logFunction('load_default_scheduled_tasks_for_component')" href="../../../_functions/load_default_scheduled_tasks_for_component.html" onMouseOver="funcPopup(event,'load_default_scheduled_tasks_for_component')">load_default_scheduled_tasks_for_component</a>(<a class="var it9637" onMouseOver="hilite(9637)" onMouseOut="lolite()" onClick="logVariable('componentname')" href="../../../_variables/componentname.html">$componentname</a>);
<a name="l89"><span class="linenum">  89</span></a>  
<a name="l90"><span class="linenum">  90</span></a>          foreach (<a class="var it3194" onMouseOver="hilite(3194)" onMouseOut="lolite()" onClick="logVariable('tasks')" href="../../../_variables/tasks.html">$tasks</a> as <a class="var it36129" onMouseOver="hilite(36129)" onMouseOut="lolite()" onClick="logVariable('taskid')" href="../../../_variables/taskid.html">$taskid</a> =&gt; <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>) {
<a name="l91"><span class="linenum">  91</span></a>              <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a> = <a class="phpfunction" onClick="logFunction('get_class')" href="../../../_functions/get_class.html" onMouseOver="phpfuncPopup(event,'get_class')">get_class</a>(<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>);
<a name="l92"><span class="linenum">  92</span></a>              if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>, '\\') !== 0) {
<a name="l93"><span class="linenum">  93</span></a>                  <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a> = '\\' . <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>;
<a name="l94"><span class="linenum">  94</span></a>              }
<a name="l95"><span class="linenum">  95</span></a>  
<a name="l96"><span class="linenum">  96</span></a>              if (<a class="var it36130" onMouseOver="hilite(36130)" onMouseOut="lolite()" onClick="logVariable('currenttask')" href="../../../_variables/currenttask.html">$currenttask</a> = self::<a class="function" onClick="logFunction('get_scheduled_task')" href="../../../_functions/get_scheduled_task.html" onMouseOver="funcPopup(event,'get_scheduled_task')">get_scheduled_task</a>(<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>)) {
<a name="l97"><span class="linenum">  97</span></a>                  if (<a class="var it36130" onMouseOver="hilite(36130)" onMouseOut="lolite()" onClick="logVariable('currenttask')" href="../../../_variables/currenttask.html">$currenttask</a>-&gt;<a class="function" onClick="logFunction('is_customised')" href="../../../_functions/is_customised.html" onMouseOver="funcPopup(event,'is_customised')">is_customised</a>()) {
<a name="l98"><span class="linenum">  98</span></a>  <span class="comment">                    // If there is an existing task with a custom schedule, do not override it.</span>
<a name="l99"><span class="linenum">  99</span></a>                      continue;
<a name="l100"><span class="linenum"> 100</span></a>                  }
<a name="l101"><span class="linenum"> 101</span></a>  
<a name="l102"><span class="linenum"> 102</span></a>  <span class="comment">                // Update the record from the default task data.</span>
<a name="l103"><span class="linenum"> 103</span></a>                  self::<a class="function" onClick="logFunction('configure_scheduled_task')" href="../../../_functions/configure_scheduled_task.html" onMouseOver="funcPopup(event,'configure_scheduled_task')">configure_scheduled_task</a>(<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>);
<a name="l104"><span class="linenum"> 104</span></a>              } else {
<a name="l105"><span class="linenum"> 105</span></a>  <span class="comment">                // Ensure that the first run follows the schedule.</span>
<a name="l106"><span class="linenum"> 106</span></a>                  <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_next_run_time')" href="../../../_functions/set_next_run_time.html" onMouseOver="funcPopup(event,'set_next_run_time')">set_next_run_time</a>(<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_next_scheduled_time')" href="../../../_functions/get_next_scheduled_time.html" onMouseOver="funcPopup(event,'get_next_scheduled_time')">get_next_scheduled_time</a>());
<a name="l107"><span class="linenum"> 107</span></a>  
<a name="l108"><span class="linenum"> 108</span></a>  <span class="comment">                // Insert the new task in the database.</span>
<a name="l109"><span class="linenum"> 109</span></a>                  <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a> = self::<a class="function" onClick="logFunction('record_from_scheduled_task')" href="../../../_functions/record_from_scheduled_task.html" onMouseOver="funcPopup(event,'record_from_scheduled_task')">record_from_scheduled_task</a>(<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>);
<a name="l110"><span class="linenum"> 110</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('task_scheduled', <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>);
<a name="l111"><span class="linenum"> 111</span></a>              }
<a name="l112"><span class="linenum"> 112</span></a>          }
<a name="l113"><span class="linenum"> 113</span></a>      }
<a name="l114"><span class="linenum"> 114</span></a>  
<a name="l115"><span class="linenum"> 115</span></a>      <span class="comment">/**</span>
<a name="l116"><span class="linenum"> 116</span></a>  <span class="comment">     * Queue an adhoc task to run in the background.</span>
<a name="l117"><span class="linenum"> 117</span></a>  <span class="comment">     *</span>
<a name="l118"><span class="linenum"> 118</span></a>  <span class="comment">     * @param \core\task\adhoc_task $task - The new adhoc task information to store.</span>
<a name="l119"><span class="linenum"> 119</span></a>  <span class="comment">     * @return boolean - True if the config was saved.</span>
<a name="l120"><span class="linenum"> 120</span></a>  <span class="comment">     */</span>
<a name="l121"><span class="linenum"> 121</span></a>      public static function <a class="function" onClick="logFunction('queue_adhoc_task')" href="../../../_functions/queue_adhoc_task.html" onMouseOver="funcPopup(event,'queue_adhoc_task')">queue_adhoc_task</a>(adhoc_task <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>) {
<a name="l122"><span class="linenum"> 122</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l123"><span class="linenum"> 123</span></a>  
<a name="l124"><span class="linenum"> 124</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a> = self::<a class="function" onClick="logFunction('record_from_adhoc_task')" href="../../../_functions/record_from_adhoc_task.html" onMouseOver="funcPopup(event,'record_from_adhoc_task')">record_from_adhoc_task</a>(<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>);
<a name="l125"><span class="linenum"> 125</span></a>  <span class="comment">        // Schedule it immediately.</span>
<a name="l126"><span class="linenum"> 126</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('nextruntime')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/nextruntime.html">nextruntime</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() - 1;
<a name="l127"><span class="linenum"> 127</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('task_adhoc', <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>);
<a name="l128"><span class="linenum"> 128</span></a>  
<a name="l129"><span class="linenum"> 129</span></a>          return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a>;
<a name="l130"><span class="linenum"> 130</span></a>      }
<a name="l131"><span class="linenum"> 131</span></a>  
<a name="l132"><span class="linenum"> 132</span></a>      <span class="comment">/**</span>
<a name="l133"><span class="linenum"> 133</span></a>  <span class="comment">     * Change the default configuration for a scheduled task.</span>
<a name="l134"><span class="linenum"> 134</span></a>  <span class="comment">     * The list of scheduled tasks is taken from {@link load_scheduled_tasks_for_component}.</span>
<a name="l135"><span class="linenum"> 135</span></a>  <span class="comment">     *</span>
<a name="l136"><span class="linenum"> 136</span></a>  <span class="comment">     * @param \core\task\scheduled_task $task - The new scheduled task information to store.</span>
<a name="l137"><span class="linenum"> 137</span></a>  <span class="comment">     * @return boolean - True if the config was saved.</span>
<a name="l138"><span class="linenum"> 138</span></a>  <span class="comment">     */</span>
<a name="l139"><span class="linenum"> 139</span></a>      public static function <a class="function" onClick="logFunction('configure_scheduled_task')" href="../../../_functions/configure_scheduled_task.html" onMouseOver="funcPopup(event,'configure_scheduled_task')">configure_scheduled_task</a>(scheduled_task <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>) {
<a name="l140"><span class="linenum"> 140</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l141"><span class="linenum"> 141</span></a>  
<a name="l142"><span class="linenum"> 142</span></a>          <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a> = <a class="phpfunction" onClick="logFunction('get_class')" href="../../../_functions/get_class.html" onMouseOver="phpfuncPopup(event,'get_class')">get_class</a>(<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>);
<a name="l143"><span class="linenum"> 143</span></a>          if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>, '\\') !== 0) {
<a name="l144"><span class="linenum"> 144</span></a>              <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a> = '\\' . <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>;
<a name="l145"><span class="linenum"> 145</span></a>          }
<a name="l146"><span class="linenum"> 146</span></a>  
<a name="l147"><span class="linenum"> 147</span></a>          <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('original')" href="../../../_variables/original.html">$original</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('task_scheduled', array('classname'=&gt;<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>), 'id', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../../../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l148"><span class="linenum"> 148</span></a>  
<a name="l149"><span class="linenum"> 149</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a> = self::<a class="function" onClick="logFunction('record_from_scheduled_task')" href="../../../_functions/record_from_scheduled_task.html" onMouseOver="funcPopup(event,'record_from_scheduled_task')">record_from_scheduled_task</a>(<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>);
<a name="l150"><span class="linenum"> 150</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a> = <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('original')" href="../../../_variables/original.html">$original</a>-&gt;<a onClick="logVariable('id')" class="var it40827" onMouseOver="hilite(40827)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>;
<a name="l151"><span class="linenum"> 151</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('nextruntime')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/nextruntime.html">nextruntime</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_next_scheduled_time')" href="../../../_functions/get_next_scheduled_time.html" onMouseOver="funcPopup(event,'get_next_scheduled_time')">get_next_scheduled_time</a>();
<a name="l152"><span class="linenum"> 152</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('task_scheduled', <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>);
<a name="l153"><span class="linenum"> 153</span></a>  
<a name="l154"><span class="linenum"> 154</span></a>          return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a>;
<a name="l155"><span class="linenum"> 155</span></a>      }
<a name="l156"><span class="linenum"> 156</span></a>  
<a name="l157"><span class="linenum"> 157</span></a>      <span class="comment">/**</span>
<a name="l158"><span class="linenum"> 158</span></a>  <span class="comment">     * Utility method to create a DB record from a scheduled task.</span>
<a name="l159"><span class="linenum"> 159</span></a>  <span class="comment">     *</span>
<a name="l160"><span class="linenum"> 160</span></a>  <span class="comment">     * @param \core\task\scheduled_task $task</span>
<a name="l161"><span class="linenum"> 161</span></a>  <span class="comment">     * @return \stdClass</span>
<a name="l162"><span class="linenum"> 162</span></a>  <span class="comment">     */</span>
<a name="l163"><span class="linenum"> 163</span></a>      public static function <a class="function" onClick="logFunction('record_from_scheduled_task')" href="../../../_functions/record_from_scheduled_task.html" onMouseOver="funcPopup(event,'record_from_scheduled_task')">record_from_scheduled_task</a>(<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>) {
<a name="l164"><span class="linenum"> 164</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a> = new \stdClass();
<a name="l165"><span class="linenum"> 165</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('classname')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a> = <a class="phpfunction" onClick="logFunction('get_class')" href="../../../_functions/get_class.html" onMouseOver="phpfuncPopup(event,'get_class')">get_class</a>(<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>);
<a name="l166"><span class="linenum"> 166</span></a>          if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('classname')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a>, '\\') !== 0) {
<a name="l167"><span class="linenum"> 167</span></a>              <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('classname')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a> = '\\' . <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('classname')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a>;
<a name="l168"><span class="linenum"> 168</span></a>          }
<a name="l169"><span class="linenum"> 169</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('component')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/component.html">component</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_component')" href="../../../_functions/get_component.html" onMouseOver="funcPopup(event,'get_component')">get_component</a>();
<a name="l170"><span class="linenum"> 170</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('blocking')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/blocking.html">blocking</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('is_blocking')" href="../../../_functions/is_blocking.html" onMouseOver="funcPopup(event,'is_blocking')">is_blocking</a>();
<a name="l171"><span class="linenum"> 171</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('customised')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/customised.html">customised</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('is_customised')" href="../../../_functions/is_customised.html" onMouseOver="funcPopup(event,'is_customised')">is_customised</a>();
<a name="l172"><span class="linenum"> 172</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('lastruntime')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/lastruntime.html">lastruntime</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_last_run_time')" href="../../../_functions/get_last_run_time.html" onMouseOver="funcPopup(event,'get_last_run_time')">get_last_run_time</a>();
<a name="l173"><span class="linenum"> 173</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('nextruntime')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/nextruntime.html">nextruntime</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_next_run_time')" href="../../../_functions/get_next_run_time.html" onMouseOver="funcPopup(event,'get_next_run_time')">get_next_run_time</a>();
<a name="l174"><span class="linenum"> 174</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('faildelay')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/faildelay.html">faildelay</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_fail_delay')" href="../../../_functions/get_fail_delay.html" onMouseOver="funcPopup(event,'get_fail_delay')">get_fail_delay</a>();
<a name="l175"><span class="linenum"> 175</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('hour')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/hour.html">hour</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_hour')" href="../../../_functions/get_hour.html" onMouseOver="funcPopup(event,'get_hour')">get_hour</a>();
<a name="l176"><span class="linenum"> 176</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('minute')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/minute.html">minute</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_minute')" href="../../../_functions/get_minute.html" onMouseOver="funcPopup(event,'get_minute')">get_minute</a>();
<a name="l177"><span class="linenum"> 177</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('day')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/day.html">day</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_day')" href="../../../_functions/get_day.html" onMouseOver="funcPopup(event,'get_day')">get_day</a>();
<a name="l178"><span class="linenum"> 178</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('dayofweek')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/dayofweek.html">dayofweek</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_day_of_week')" href="../../../_functions/get_day_of_week.html" onMouseOver="funcPopup(event,'get_day_of_week')">get_day_of_week</a>();
<a name="l179"><span class="linenum"> 179</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('month')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/month.html">month</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_month')" href="../../../_functions/get_month.html" onMouseOver="funcPopup(event,'get_month')">get_month</a>();
<a name="l180"><span class="linenum"> 180</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('disabled')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/disabled.html">disabled</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_disabled')" href="../../../_functions/get_disabled.html" onMouseOver="funcPopup(event,'get_disabled')">get_disabled</a>();
<a name="l181"><span class="linenum"> 181</span></a>  
<a name="l182"><span class="linenum"> 182</span></a>          return <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>;
<a name="l183"><span class="linenum"> 183</span></a>      }
<a name="l184"><span class="linenum"> 184</span></a>  
<a name="l185"><span class="linenum"> 185</span></a>      <span class="comment">/**</span>
<a name="l186"><span class="linenum"> 186</span></a>  <span class="comment">     * Utility method to create a DB record from an adhoc task.</span>
<a name="l187"><span class="linenum"> 187</span></a>  <span class="comment">     *</span>
<a name="l188"><span class="linenum"> 188</span></a>  <span class="comment">     * @param \core\task\adhoc_task $task</span>
<a name="l189"><span class="linenum"> 189</span></a>  <span class="comment">     * @return \stdClass</span>
<a name="l190"><span class="linenum"> 190</span></a>  <span class="comment">     */</span>
<a name="l191"><span class="linenum"> 191</span></a>      public static function <a class="function" onClick="logFunction('record_from_adhoc_task')" href="../../../_functions/record_from_adhoc_task.html" onMouseOver="funcPopup(event,'record_from_adhoc_task')">record_from_adhoc_task</a>(<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>) {
<a name="l192"><span class="linenum"> 192</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a> = new \stdClass();
<a name="l193"><span class="linenum"> 193</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('classname')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a> = <a class="phpfunction" onClick="logFunction('get_class')" href="../../../_functions/get_class.html" onMouseOver="phpfuncPopup(event,'get_class')">get_class</a>(<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>);
<a name="l194"><span class="linenum"> 194</span></a>          if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('classname')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a>, '\\') !== 0) {
<a name="l195"><span class="linenum"> 195</span></a>              <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('classname')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a> = '\\' . <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('classname')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a>;
<a name="l196"><span class="linenum"> 196</span></a>          }
<a name="l197"><span class="linenum"> 197</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_id')" href="../../../_functions/get_id.html" onMouseOver="funcPopup(event,'get_id')">get_id</a>();
<a name="l198"><span class="linenum"> 198</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('component')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/component.html">component</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_component')" href="../../../_functions/get_component.html" onMouseOver="funcPopup(event,'get_component')">get_component</a>();
<a name="l199"><span class="linenum"> 199</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('blocking')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/blocking.html">blocking</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('is_blocking')" href="../../../_functions/is_blocking.html" onMouseOver="funcPopup(event,'is_blocking')">is_blocking</a>();
<a name="l200"><span class="linenum"> 200</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('nextruntime')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/nextruntime.html">nextruntime</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_next_run_time')" href="../../../_functions/get_next_run_time.html" onMouseOver="funcPopup(event,'get_next_run_time')">get_next_run_time</a>();
<a name="l201"><span class="linenum"> 201</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('faildelay')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/faildelay.html">faildelay</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_fail_delay')" href="../../../_functions/get_fail_delay.html" onMouseOver="funcPopup(event,'get_fail_delay')">get_fail_delay</a>();
<a name="l202"><span class="linenum"> 202</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('customdata')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/customdata.html">customdata</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_custom_data_as_string')" href="../../../_functions/get_custom_data_as_string.html" onMouseOver="funcPopup(event,'get_custom_data_as_string')">get_custom_data_as_string</a>();
<a name="l203"><span class="linenum"> 203</span></a>  
<a name="l204"><span class="linenum"> 204</span></a>          return <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>;
<a name="l205"><span class="linenum"> 205</span></a>      }
<a name="l206"><span class="linenum"> 206</span></a>  
<a name="l207"><span class="linenum"> 207</span></a>      <span class="comment">/**</span>
<a name="l208"><span class="linenum"> 208</span></a>  <span class="comment">     * Utility method to create an adhoc task from a DB record.</span>
<a name="l209"><span class="linenum"> 209</span></a>  <span class="comment">     *</span>
<a name="l210"><span class="linenum"> 210</span></a>  <span class="comment">     * @param \stdClass $record</span>
<a name="l211"><span class="linenum"> 211</span></a>  <span class="comment">     * @return \core\task\adhoc_task</span>
<a name="l212"><span class="linenum"> 212</span></a>  <span class="comment">     */</span>
<a name="l213"><span class="linenum"> 213</span></a>      public static function <a class="function" onClick="logFunction('adhoc_task_from_record')" href="../../../_functions/adhoc_task_from_record.html" onMouseOver="funcPopup(event,'adhoc_task_from_record')">adhoc_task_from_record</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>) {
<a name="l214"><span class="linenum"> 214</span></a>          <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a> = <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('classname')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a>;
<a name="l215"><span class="linenum"> 215</span></a>          if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>, '\\') !== 0) {
<a name="l216"><span class="linenum"> 216</span></a>              <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a> = '\\' . <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>;
<a name="l217"><span class="linenum"> 217</span></a>          }
<a name="l218"><span class="linenum"> 218</span></a>          if (!<a class="phpfunction" onClick="logFunction('class_exists')" href="../../../_functions/class_exists.html" onMouseOver="phpfuncPopup(event,'class_exists')">class_exists</a>(<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>)) {
<a name="l219"><span class="linenum"> 219</span></a>              <a class="function" onClick="logFunction('debugging')" href="../../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(&quot;Failed to load task: &quot; . <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>, <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../../../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l220"><span class="linenum"> 220</span></a>              return false;
<a name="l221"><span class="linenum"> 221</span></a>          }
<a name="l222"><span class="linenum"> 222</span></a>          <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a> = new <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>;
<a name="l223"><span class="linenum"> 223</span></a>          if (isset(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('nextruntime')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/nextruntime.html">nextruntime</a>)) {
<a name="l224"><span class="linenum"> 224</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_next_run_time')" href="../../../_functions/set_next_run_time.html" onMouseOver="funcPopup(event,'set_next_run_time')">set_next_run_time</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('nextruntime')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/nextruntime.html">nextruntime</a>);
<a name="l225"><span class="linenum"> 225</span></a>          }
<a name="l226"><span class="linenum"> 226</span></a>          if (isset(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>)) {
<a name="l227"><span class="linenum"> 227</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_id')" href="../../../_functions/set_id.html" onMouseOver="funcPopup(event,'set_id')">set_id</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>);
<a name="l228"><span class="linenum"> 228</span></a>          }
<a name="l229"><span class="linenum"> 229</span></a>          if (isset(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('component')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/component.html">component</a>)) {
<a name="l230"><span class="linenum"> 230</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_component')" href="../../../_functions/set_component.html" onMouseOver="funcPopup(event,'set_component')">set_component</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('component')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/component.html">component</a>);
<a name="l231"><span class="linenum"> 231</span></a>          }
<a name="l232"><span class="linenum"> 232</span></a>          <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_blocking')" href="../../../_functions/set_blocking.html" onMouseOver="funcPopup(event,'set_blocking')">set_blocking</a>(!empty(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('blocking')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/blocking.html">blocking</a>));
<a name="l233"><span class="linenum"> 233</span></a>          if (isset(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('faildelay')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/faildelay.html">faildelay</a>)) {
<a name="l234"><span class="linenum"> 234</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_fail_delay')" href="../../../_functions/set_fail_delay.html" onMouseOver="funcPopup(event,'set_fail_delay')">set_fail_delay</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('faildelay')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/faildelay.html">faildelay</a>);
<a name="l235"><span class="linenum"> 235</span></a>          }
<a name="l236"><span class="linenum"> 236</span></a>          if (isset(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('customdata')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/customdata.html">customdata</a>)) {
<a name="l237"><span class="linenum"> 237</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_custom_data_as_string')" href="../../../_functions/set_custom_data_as_string.html" onMouseOver="funcPopup(event,'set_custom_data_as_string')">set_custom_data_as_string</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('customdata')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/customdata.html">customdata</a>);
<a name="l238"><span class="linenum"> 238</span></a>          }
<a name="l239"><span class="linenum"> 239</span></a>  
<a name="l240"><span class="linenum"> 240</span></a>          return <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>;
<a name="l241"><span class="linenum"> 241</span></a>      }
<a name="l242"><span class="linenum"> 242</span></a>  
<a name="l243"><span class="linenum"> 243</span></a>      <span class="comment">/**</span>
<a name="l244"><span class="linenum"> 244</span></a>  <span class="comment">     * Utility method to create a task from a DB record.</span>
<a name="l245"><span class="linenum"> 245</span></a>  <span class="comment">     *</span>
<a name="l246"><span class="linenum"> 246</span></a>  <span class="comment">     * @param \stdClass $record</span>
<a name="l247"><span class="linenum"> 247</span></a>  <span class="comment">     * @return \core\task\scheduled_task</span>
<a name="l248"><span class="linenum"> 248</span></a>  <span class="comment">     */</span>
<a name="l249"><span class="linenum"> 249</span></a>      public static function <a class="function" onClick="logFunction('scheduled_task_from_record')" href="../../../_functions/scheduled_task_from_record.html" onMouseOver="funcPopup(event,'scheduled_task_from_record')">scheduled_task_from_record</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>) {
<a name="l250"><span class="linenum"> 250</span></a>          <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a> = <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('classname')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a>;
<a name="l251"><span class="linenum"> 251</span></a>          if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>, '\\') !== 0) {
<a name="l252"><span class="linenum"> 252</span></a>              <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a> = '\\' . <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>;
<a name="l253"><span class="linenum"> 253</span></a>          }
<a name="l254"><span class="linenum"> 254</span></a>          if (!<a class="phpfunction" onClick="logFunction('class_exists')" href="../../../_functions/class_exists.html" onMouseOver="phpfuncPopup(event,'class_exists')">class_exists</a>(<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>)) {
<a name="l255"><span class="linenum"> 255</span></a>              <a class="function" onClick="logFunction('debugging')" href="../../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(&quot;Failed to load task: &quot; . <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>, <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../../../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l256"><span class="linenum"> 256</span></a>              return false;
<a name="l257"><span class="linenum"> 257</span></a>          }
<a name="l258"><span class="linenum"> 258</span></a>  <span class="comment">        /** @var \core\task\scheduled_task $task */</span>
<a name="l259"><span class="linenum"> 259</span></a>          <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a> = new <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>;
<a name="l260"><span class="linenum"> 260</span></a>          if (isset(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('lastruntime')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/lastruntime.html">lastruntime</a>)) {
<a name="l261"><span class="linenum"> 261</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_last_run_time')" href="../../../_functions/set_last_run_time.html" onMouseOver="funcPopup(event,'set_last_run_time')">set_last_run_time</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('lastruntime')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/lastruntime.html">lastruntime</a>);
<a name="l262"><span class="linenum"> 262</span></a>          }
<a name="l263"><span class="linenum"> 263</span></a>          if (isset(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('nextruntime')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/nextruntime.html">nextruntime</a>)) {
<a name="l264"><span class="linenum"> 264</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_next_run_time')" href="../../../_functions/set_next_run_time.html" onMouseOver="funcPopup(event,'set_next_run_time')">set_next_run_time</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('nextruntime')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/nextruntime.html">nextruntime</a>);
<a name="l265"><span class="linenum"> 265</span></a>          }
<a name="l266"><span class="linenum"> 266</span></a>          if (isset(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('customised')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/customised.html">customised</a>)) {
<a name="l267"><span class="linenum"> 267</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_customised')" href="../../../_functions/set_customised.html" onMouseOver="funcPopup(event,'set_customised')">set_customised</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('customised')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/customised.html">customised</a>);
<a name="l268"><span class="linenum"> 268</span></a>          }
<a name="l269"><span class="linenum"> 269</span></a>          if (isset(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('component')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/component.html">component</a>)) {
<a name="l270"><span class="linenum"> 270</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_component')" href="../../../_functions/set_component.html" onMouseOver="funcPopup(event,'set_component')">set_component</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('component')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/component.html">component</a>);
<a name="l271"><span class="linenum"> 271</span></a>          }
<a name="l272"><span class="linenum"> 272</span></a>          <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_blocking')" href="../../../_functions/set_blocking.html" onMouseOver="funcPopup(event,'set_blocking')">set_blocking</a>(!empty(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('blocking')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/blocking.html">blocking</a>));
<a name="l273"><span class="linenum"> 273</span></a>          if (isset(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('minute')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/minute.html">minute</a>)) {
<a name="l274"><span class="linenum"> 274</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_minute')" href="../../../_functions/set_minute.html" onMouseOver="funcPopup(event,'set_minute')">set_minute</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('minute')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/minute.html">minute</a>);
<a name="l275"><span class="linenum"> 275</span></a>          }
<a name="l276"><span class="linenum"> 276</span></a>          if (isset(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('hour')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/hour.html">hour</a>)) {
<a name="l277"><span class="linenum"> 277</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_hour')" href="../../../_functions/set_hour.html" onMouseOver="funcPopup(event,'set_hour')">set_hour</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('hour')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/hour.html">hour</a>);
<a name="l278"><span class="linenum"> 278</span></a>          }
<a name="l279"><span class="linenum"> 279</span></a>          if (isset(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('day')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/day.html">day</a>)) {
<a name="l280"><span class="linenum"> 280</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_day')" href="../../../_functions/set_day.html" onMouseOver="funcPopup(event,'set_day')">set_day</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('day')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/day.html">day</a>);
<a name="l281"><span class="linenum"> 281</span></a>          }
<a name="l282"><span class="linenum"> 282</span></a>          if (isset(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('month')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/month.html">month</a>)) {
<a name="l283"><span class="linenum"> 283</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_month')" href="../../../_functions/set_month.html" onMouseOver="funcPopup(event,'set_month')">set_month</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('month')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/month.html">month</a>);
<a name="l284"><span class="linenum"> 284</span></a>          }
<a name="l285"><span class="linenum"> 285</span></a>          if (isset(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('dayofweek')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/dayofweek.html">dayofweek</a>)) {
<a name="l286"><span class="linenum"> 286</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_day_of_week')" href="../../../_functions/set_day_of_week.html" onMouseOver="funcPopup(event,'set_day_of_week')">set_day_of_week</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('dayofweek')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/dayofweek.html">dayofweek</a>);
<a name="l287"><span class="linenum"> 287</span></a>          }
<a name="l288"><span class="linenum"> 288</span></a>          if (isset(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('faildelay')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/faildelay.html">faildelay</a>)) {
<a name="l289"><span class="linenum"> 289</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_fail_delay')" href="../../../_functions/set_fail_delay.html" onMouseOver="funcPopup(event,'set_fail_delay')">set_fail_delay</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('faildelay')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/faildelay.html">faildelay</a>);
<a name="l290"><span class="linenum"> 290</span></a>          }
<a name="l291"><span class="linenum"> 291</span></a>          if (isset(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('disabled')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/disabled.html">disabled</a>)) {
<a name="l292"><span class="linenum"> 292</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_disabled')" href="../../../_functions/set_disabled.html" onMouseOver="funcPopup(event,'set_disabled')">set_disabled</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('disabled')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/disabled.html">disabled</a>);
<a name="l293"><span class="linenum"> 293</span></a>          }
<a name="l294"><span class="linenum"> 294</span></a>  
<a name="l295"><span class="linenum"> 295</span></a>          return <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>;
<a name="l296"><span class="linenum"> 296</span></a>      }
<a name="l297"><span class="linenum"> 297</span></a>  
<a name="l298"><span class="linenum"> 298</span></a>      <span class="comment">/**</span>
<a name="l299"><span class="linenum"> 299</span></a>  <span class="comment">     * Given a component name, will load the list of tasks from the scheduled_tasks table for that component.</span>
<a name="l300"><span class="linenum"> 300</span></a>  <span class="comment">     * Do not execute tasks loaded from this function - they have not been locked.</span>
<a name="l301"><span class="linenum"> 301</span></a>  <span class="comment">     * @param string $componentname - The name of the component to load the tasks for.</span>
<a name="l302"><span class="linenum"> 302</span></a>  <span class="comment">     * @return \core\task\scheduled_task[]</span>
<a name="l303"><span class="linenum"> 303</span></a>  <span class="comment">     */</span>
<a name="l304"><span class="linenum"> 304</span></a>      public static function <a class="function" onClick="logFunction('load_scheduled_tasks_for_component')" href="../../../_functions/load_scheduled_tasks_for_component.html" onMouseOver="funcPopup(event,'load_scheduled_tasks_for_component')">load_scheduled_tasks_for_component</a>(<a class="var it9637" onMouseOver="hilite(9637)" onMouseOut="lolite()" onClick="logVariable('componentname')" href="../../../_variables/componentname.html">$componentname</a>) {
<a name="l305"><span class="linenum"> 305</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l306"><span class="linenum"> 306</span></a>  
<a name="l307"><span class="linenum"> 307</span></a>          <a class="var it3194" onMouseOver="hilite(3194)" onMouseOut="lolite()" onClick="logVariable('tasks')" href="../../../_variables/tasks.html">$tasks</a> = array();
<a name="l308"><span class="linenum"> 308</span></a>  <span class="comment">        // We are just reading - so no locks required.</span>
<a name="l309"><span class="linenum"> 309</span></a>          <a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('task_scheduled', array('component' =&gt; <a class="var it9637" onMouseOver="hilite(9637)" onMouseOut="lolite()" onClick="logVariable('componentname')" href="../../../_variables/componentname.html">$componentname</a>), 'classname', '*', <a class="constant" onClick="logConstant('IGNORE_MISSING')" href="../../../_constants/IGNORE_MISSING.html" onMouseOver="constPopup(event,'IGNORE_MISSING')">IGNORE_MISSING</a>);
<a name="l310"><span class="linenum"> 310</span></a>          foreach (<a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a> as <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>) {
<a name="l311"><span class="linenum"> 311</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a> = self::<a class="function" onClick="logFunction('scheduled_task_from_record')" href="../../../_functions/scheduled_task_from_record.html" onMouseOver="funcPopup(event,'scheduled_task_from_record')">scheduled_task_from_record</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>);
<a name="l312"><span class="linenum"> 312</span></a>  <span class="comment">            // Safety check in case the task in the DB does not match a real class (maybe something was uninstalled).</span>
<a name="l313"><span class="linenum"> 313</span></a>              if (<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>) {
<a name="l314"><span class="linenum"> 314</span></a>                  <a class="var it3194" onMouseOver="hilite(3194)" onMouseOut="lolite()" onClick="logVariable('tasks')" href="../../../_variables/tasks.html">$tasks</a>[] = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>;
<a name="l315"><span class="linenum"> 315</span></a>              }
<a name="l316"><span class="linenum"> 316</span></a>          }
<a name="l317"><span class="linenum"> 317</span></a>  
<a name="l318"><span class="linenum"> 318</span></a>          return <a class="var it3194" onMouseOver="hilite(3194)" onMouseOut="lolite()" onClick="logVariable('tasks')" href="../../../_variables/tasks.html">$tasks</a>;
<a name="l319"><span class="linenum"> 319</span></a>      }
<a name="l320"><span class="linenum"> 320</span></a>  
<a name="l321"><span class="linenum"> 321</span></a>      <span class="comment">/**</span>
<a name="l322"><span class="linenum"> 322</span></a>  <span class="comment">     * This function load the scheduled task details for a given classname.</span>
<a name="l323"><span class="linenum"> 323</span></a>  <span class="comment">     *</span>
<a name="l324"><span class="linenum"> 324</span></a>  <span class="comment">     * @param string $classname</span>
<a name="l325"><span class="linenum"> 325</span></a>  <span class="comment">     * @return \core\task\scheduled_task or false</span>
<a name="l326"><span class="linenum"> 326</span></a>  <span class="comment">     */</span>
<a name="l327"><span class="linenum"> 327</span></a>      public static function <a class="function" onClick="logFunction('get_scheduled_task')" href="../../../_functions/get_scheduled_task.html" onMouseOver="funcPopup(event,'get_scheduled_task')">get_scheduled_task</a>(<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>) {
<a name="l328"><span class="linenum"> 328</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l329"><span class="linenum"> 329</span></a>  
<a name="l330"><span class="linenum"> 330</span></a>          if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>, '\\') !== 0) {
<a name="l331"><span class="linenum"> 331</span></a>              <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a> = '\\' . <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>;
<a name="l332"><span class="linenum"> 332</span></a>          }
<a name="l333"><span class="linenum"> 333</span></a>  <span class="comment">        // We are just reading - so no locks required.</span>
<a name="l334"><span class="linenum"> 334</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('task_scheduled', array('classname'=&gt;<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>), '*', <a class="constant" onClick="logConstant('IGNORE_MISSING')" href="../../../_constants/IGNORE_MISSING.html" onMouseOver="constPopup(event,'IGNORE_MISSING')">IGNORE_MISSING</a>);
<a name="l335"><span class="linenum"> 335</span></a>          if (!<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>) {
<a name="l336"><span class="linenum"> 336</span></a>              return false;
<a name="l337"><span class="linenum"> 337</span></a>          }
<a name="l338"><span class="linenum"> 338</span></a>          return self::<a class="function" onClick="logFunction('scheduled_task_from_record')" href="../../../_functions/scheduled_task_from_record.html" onMouseOver="funcPopup(event,'scheduled_task_from_record')">scheduled_task_from_record</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>);
<a name="l339"><span class="linenum"> 339</span></a>      }
<a name="l340"><span class="linenum"> 340</span></a>  
<a name="l341"><span class="linenum"> 341</span></a>      <span class="comment">/**</span>
<a name="l342"><span class="linenum"> 342</span></a>  <span class="comment">     * This function load the default scheduled task details for a given classname.</span>
<a name="l343"><span class="linenum"> 343</span></a>  <span class="comment">     *</span>
<a name="l344"><span class="linenum"> 344</span></a>  <span class="comment">     * @param string $classname</span>
<a name="l345"><span class="linenum"> 345</span></a>  <span class="comment">     * @return \core\task\scheduled_task or false</span>
<a name="l346"><span class="linenum"> 346</span></a>  <span class="comment">     */</span>
<a name="l347"><span class="linenum"> 347</span></a>      public static function <a class="function" onClick="logFunction('get_default_scheduled_task')" href="../../../_functions/get_default_scheduled_task.html" onMouseOver="funcPopup(event,'get_default_scheduled_task')">get_default_scheduled_task</a>(<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>) {
<a name="l348"><span class="linenum"> 348</span></a>          <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a> = self::<a class="function" onClick="logFunction('get_scheduled_task')" href="../../../_functions/get_scheduled_task.html" onMouseOver="funcPopup(event,'get_scheduled_task')">get_scheduled_task</a>(<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>);
<a name="l349"><span class="linenum"> 349</span></a>          <a class="var it36131" onMouseOver="hilite(36131)" onMouseOut="lolite()" onClick="logVariable('componenttasks')" href="../../../_variables/componenttasks.html">$componenttasks</a> = array();
<a name="l350"><span class="linenum"> 350</span></a>  
<a name="l351"><span class="linenum"> 351</span></a>  <span class="comment">        // Safety check in case no task was found for the given classname.</span>
<a name="l352"><span class="linenum"> 352</span></a>          if (<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>) {
<a name="l353"><span class="linenum"> 353</span></a>              <a class="var it36131" onMouseOver="hilite(36131)" onMouseOut="lolite()" onClick="logVariable('componenttasks')" href="../../../_variables/componenttasks.html">$componenttasks</a> = self::<a class="function" onClick="logFunction('load_default_scheduled_tasks_for_component')" href="../../../_functions/load_default_scheduled_tasks_for_component.html" onMouseOver="funcPopup(event,'load_default_scheduled_tasks_for_component')">load_default_scheduled_tasks_for_component</a>(<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_component')" href="../../../_functions/get_component.html" onMouseOver="funcPopup(event,'get_component')">get_component</a>());
<a name="l354"><span class="linenum"> 354</span></a>          }
<a name="l355"><span class="linenum"> 355</span></a>  
<a name="l356"><span class="linenum"> 356</span></a>          foreach (<a class="var it36131" onMouseOver="hilite(36131)" onMouseOut="lolite()" onClick="logVariable('componenttasks')" href="../../../_variables/componenttasks.html">$componenttasks</a> as <a class="var it36132" onMouseOver="hilite(36132)" onMouseOut="lolite()" onClick="logVariable('componenttask')" href="../../../_variables/componenttask.html">$componenttask</a>) {
<a name="l357"><span class="linenum"> 357</span></a>              if (<a class="phpfunction" onClick="logFunction('get_class')" href="../../../_functions/get_class.html" onMouseOver="phpfuncPopup(event,'get_class')">get_class</a>(<a class="var it36132" onMouseOver="hilite(36132)" onMouseOut="lolite()" onClick="logVariable('componenttask')" href="../../../_variables/componenttask.html">$componenttask</a>) == <a class="phpfunction" onClick="logFunction('get_class')" href="../../../_functions/get_class.html" onMouseOver="phpfuncPopup(event,'get_class')">get_class</a>(<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>)) {
<a name="l358"><span class="linenum"> 358</span></a>                  return <a class="var it36132" onMouseOver="hilite(36132)" onMouseOut="lolite()" onClick="logVariable('componenttask')" href="../../../_variables/componenttask.html">$componenttask</a>;
<a name="l359"><span class="linenum"> 359</span></a>              }
<a name="l360"><span class="linenum"> 360</span></a>          }
<a name="l361"><span class="linenum"> 361</span></a>  
<a name="l362"><span class="linenum"> 362</span></a>          return false;
<a name="l363"><span class="linenum"> 363</span></a>      }
<a name="l364"><span class="linenum"> 364</span></a>  
<a name="l365"><span class="linenum"> 365</span></a>      <span class="comment">/**</span>
<a name="l366"><span class="linenum"> 366</span></a>  <span class="comment">     * This function will return a list of all the scheduled tasks that exist in the database.</span>
<a name="l367"><span class="linenum"> 367</span></a>  <span class="comment">     *</span>
<a name="l368"><span class="linenum"> 368</span></a>  <span class="comment">     * @return \core\task\scheduled_task[]</span>
<a name="l369"><span class="linenum"> 369</span></a>  <span class="comment">     */</span>
<a name="l370"><span class="linenum"> 370</span></a>      public static function <a class="function" onClick="logFunction('get_all_scheduled_tasks')" href="../../../_functions/get_all_scheduled_tasks.html" onMouseOver="funcPopup(event,'get_all_scheduled_tasks')">get_all_scheduled_tasks</a>() {
<a name="l371"><span class="linenum"> 371</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l372"><span class="linenum"> 372</span></a>  
<a name="l373"><span class="linenum"> 373</span></a>          <a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('task_scheduled', null, 'component, classname', '*', <a class="constant" onClick="logConstant('IGNORE_MISSING')" href="../../../_constants/IGNORE_MISSING.html" onMouseOver="constPopup(event,'IGNORE_MISSING')">IGNORE_MISSING</a>);
<a name="l374"><span class="linenum"> 374</span></a>          <a class="var it3194" onMouseOver="hilite(3194)" onMouseOut="lolite()" onClick="logVariable('tasks')" href="../../../_variables/tasks.html">$tasks</a> = array();
<a name="l375"><span class="linenum"> 375</span></a>  
<a name="l376"><span class="linenum"> 376</span></a>          foreach (<a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a> as <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>) {
<a name="l377"><span class="linenum"> 377</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a> = self::<a class="function" onClick="logFunction('scheduled_task_from_record')" href="../../../_functions/scheduled_task_from_record.html" onMouseOver="funcPopup(event,'scheduled_task_from_record')">scheduled_task_from_record</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>);
<a name="l378"><span class="linenum"> 378</span></a>  <span class="comment">            // Safety check in case the task in the DB does not match a real class (maybe something was uninstalled).</span>
<a name="l379"><span class="linenum"> 379</span></a>              if (<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>) {
<a name="l380"><span class="linenum"> 380</span></a>                  <a class="var it3194" onMouseOver="hilite(3194)" onMouseOut="lolite()" onClick="logVariable('tasks')" href="../../../_variables/tasks.html">$tasks</a>[] = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>;
<a name="l381"><span class="linenum"> 381</span></a>              }
<a name="l382"><span class="linenum"> 382</span></a>          }
<a name="l383"><span class="linenum"> 383</span></a>  
<a name="l384"><span class="linenum"> 384</span></a>          return <a class="var it3194" onMouseOver="hilite(3194)" onMouseOut="lolite()" onClick="logVariable('tasks')" href="../../../_variables/tasks.html">$tasks</a>;
<a name="l385"><span class="linenum"> 385</span></a>      }
<a name="l386"><span class="linenum"> 386</span></a>  
<a name="l387"><span class="linenum"> 387</span></a>      <span class="comment">/**</span>
<a name="l388"><span class="linenum"> 388</span></a>  <span class="comment">     * This function will dispatch the next adhoc task in the queue. The task will be handed out</span>
<a name="l389"><span class="linenum"> 389</span></a>  <span class="comment">     * with an open lock - possibly on the entire cron process. Make sure you call either</span>
<a name="l390"><span class="linenum"> 390</span></a>  <span class="comment">     * {@link adhoc_task_failed} or {@link adhoc_task_complete} to release the lock and reschedule the task.</span>
<a name="l391"><span class="linenum"> 391</span></a>  <span class="comment">     *</span>
<a name="l392"><span class="linenum"> 392</span></a>  <span class="comment">     * @param int $timestart</span>
<a name="l393"><span class="linenum"> 393</span></a>  <span class="comment">     * @return \core\task\adhoc_task or null if not found</span>
<a name="l394"><span class="linenum"> 394</span></a>  <span class="comment">     */</span>
<a name="l395"><span class="linenum"> 395</span></a>      public static function <a class="function" onClick="logFunction('get_next_adhoc_task')" href="../../../_functions/get_next_adhoc_task.html" onMouseOver="funcPopup(event,'get_next_adhoc_task')">get_next_adhoc_task</a>(<a class="var it347" onMouseOver="hilite(347)" onMouseOut="lolite()" onClick="logVariable('timestart')" href="../../../_variables/timestart.html">$timestart</a>) {
<a name="l396"><span class="linenum"> 396</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l397"><span class="linenum"> 397</span></a>          <a class="var it33391" onMouseOver="hilite(33391)" onMouseOut="lolite()" onClick="logVariable('cronlockfactory')" href="../../../_variables/cronlockfactory.html">$cronlockfactory</a> = \core\lock\<a class="class" onClick="logClass('lock_config')" href="../../../_classes/lock_config.html" onMouseOver="classPopup(event,'lock_config')">lock_config</a>::<a class="function" onClick="logFunction('get_lock_factory')" href="../../../_functions/get_lock_factory.html" onMouseOver="funcPopup(event,'get_lock_factory')">get_lock_factory</a>('cron');
<a name="l398"><span class="linenum"> 398</span></a>  
<a name="l399"><span class="linenum"> 399</span></a>          if (!<a class="var it11529" onMouseOver="hilite(11529)" onMouseOut="lolite()" onClick="logVariable('cronlock')" href="../../../_variables/cronlock.html">$cronlock</a> = <a class="var it33391" onMouseOver="hilite(33391)" onMouseOut="lolite()" onClick="logVariable('cronlockfactory')" href="../../../_variables/cronlockfactory.html">$cronlockfactory</a>-&gt;<a class="function" onClick="logFunction('get_lock')" href="../../../_functions/get_lock.html" onMouseOver="funcPopup(event,'get_lock')">get_lock</a>('core_cron', 10)) {
<a name="l400"><span class="linenum"> 400</span></a>              throw new \moodle_exception('locktimeout');
<a name="l401"><span class="linenum"> 401</span></a>          }
<a name="l402"><span class="linenum"> 402</span></a>  
<a name="l403"><span class="linenum"> 403</span></a>          <a class="var it1076" onMouseOver="hilite(1076)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../../_variables/where.html">$where</a> = '(nextruntime IS NULL OR nextruntime &lt; :timestart1)';
<a name="l404"><span class="linenum"> 404</span></a>          <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a> = array('timestart1' =&gt; <a class="var it347" onMouseOver="hilite(347)" onMouseOut="lolite()" onClick="logVariable('timestart')" href="../../../_variables/timestart.html">$timestart</a>);
<a name="l405"><span class="linenum"> 405</span></a>          <a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_select')" href="../../../_functions/get_records_select.html" onMouseOver="funcPopup(event,'get_records_select')">get_records_select</a>('task_adhoc', <a class="var it1076" onMouseOver="hilite(1076)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../../_variables/where.html">$where</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>);
<a name="l406"><span class="linenum"> 406</span></a>  
<a name="l407"><span class="linenum"> 407</span></a>          foreach (<a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a> as <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>) {
<a name="l408"><span class="linenum"> 408</span></a>  
<a name="l409"><span class="linenum"> 409</span></a>              if (<a class="var it5784" onMouseOver="hilite(5784)" onMouseOut="lolite()" onClick="logVariable('lock')" href="../../../_variables/lock.html">$lock</a> = <a class="var it33391" onMouseOver="hilite(33391)" onMouseOut="lolite()" onClick="logVariable('cronlockfactory')" href="../../../_variables/cronlockfactory.html">$cronlockfactory</a>-&gt;<a class="function" onClick="logFunction('get_lock')" href="../../../_functions/get_lock.html" onMouseOver="funcPopup(event,'get_lock')">get_lock</a>('adhoc_' . <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>, 10)) {
<a name="l410"><span class="linenum"> 410</span></a>                  <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a> = '\\' . <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('classname')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a>;
<a name="l411"><span class="linenum"> 411</span></a>                  <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a> = self::<a class="function" onClick="logFunction('adhoc_task_from_record')" href="../../../_functions/adhoc_task_from_record.html" onMouseOver="funcPopup(event,'adhoc_task_from_record')">adhoc_task_from_record</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>);
<a name="l412"><span class="linenum"> 412</span></a>  <span class="comment">                // Safety check in case the task in the DB does not match a real class (maybe something was uninstalled).</span>
<a name="l413"><span class="linenum"> 413</span></a>                  if (!<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>) {
<a name="l414"><span class="linenum"> 414</span></a>                      <a class="var it5784" onMouseOver="hilite(5784)" onMouseOut="lolite()" onClick="logVariable('lock')" href="../../../_variables/lock.html">$lock</a>-&gt;<a class="function" onClick="logFunction('release')" href="../../../_functions/release.html" onMouseOver="funcPopup(event,'release')">release</a>();
<a name="l415"><span class="linenum"> 415</span></a>                      continue;
<a name="l416"><span class="linenum"> 416</span></a>                  }
<a name="l417"><span class="linenum"> 417</span></a>  
<a name="l418"><span class="linenum"> 418</span></a>                  <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_lock')" href="../../../_functions/set_lock.html" onMouseOver="funcPopup(event,'set_lock')">set_lock</a>(<a class="var it5784" onMouseOver="hilite(5784)" onMouseOut="lolite()" onClick="logVariable('lock')" href="../../../_variables/lock.html">$lock</a>);
<a name="l419"><span class="linenum"> 419</span></a>                  if (!<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('is_blocking')" href="../../../_functions/is_blocking.html" onMouseOver="funcPopup(event,'is_blocking')">is_blocking</a>()) {
<a name="l420"><span class="linenum"> 420</span></a>                      <a class="var it11529" onMouseOver="hilite(11529)" onMouseOut="lolite()" onClick="logVariable('cronlock')" href="../../../_variables/cronlock.html">$cronlock</a>-&gt;<a class="function" onClick="logFunction('release')" href="../../../_functions/release.html" onMouseOver="funcPopup(event,'release')">release</a>();
<a name="l421"><span class="linenum"> 421</span></a>                  } else {
<a name="l422"><span class="linenum"> 422</span></a>                      <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_cron_lock')" href="../../../_functions/set_cron_lock.html" onMouseOver="funcPopup(event,'set_cron_lock')">set_cron_lock</a>(<a class="var it11529" onMouseOver="hilite(11529)" onMouseOut="lolite()" onClick="logVariable('cronlock')" href="../../../_variables/cronlock.html">$cronlock</a>);
<a name="l423"><span class="linenum"> 423</span></a>                  }
<a name="l424"><span class="linenum"> 424</span></a>                  return <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>;
<a name="l425"><span class="linenum"> 425</span></a>              }
<a name="l426"><span class="linenum"> 426</span></a>          }
<a name="l427"><span class="linenum"> 427</span></a>  
<a name="l428"><span class="linenum"> 428</span></a>  <span class="comment">        // No tasks.</span>
<a name="l429"><span class="linenum"> 429</span></a>          <a class="var it11529" onMouseOver="hilite(11529)" onMouseOut="lolite()" onClick="logVariable('cronlock')" href="../../../_variables/cronlock.html">$cronlock</a>-&gt;<a class="function" onClick="logFunction('release')" href="../../../_functions/release.html" onMouseOver="funcPopup(event,'release')">release</a>();
<a name="l430"><span class="linenum"> 430</span></a>          return null;
<a name="l431"><span class="linenum"> 431</span></a>      }
<a name="l432"><span class="linenum"> 432</span></a>  
<a name="l433"><span class="linenum"> 433</span></a>      <span class="comment">/**</span>
<a name="l434"><span class="linenum"> 434</span></a>  <span class="comment">     * This function will dispatch the next scheduled task in the queue. The task will be handed out</span>
<a name="l435"><span class="linenum"> 435</span></a>  <span class="comment">     * with an open lock - possibly on the entire cron process. Make sure you call either</span>
<a name="l436"><span class="linenum"> 436</span></a>  <span class="comment">     * {@link scheduled_task_failed} or {@link scheduled_task_complete} to release the lock and reschedule the task.</span>
<a name="l437"><span class="linenum"> 437</span></a>  <span class="comment">     *</span>
<a name="l438"><span class="linenum"> 438</span></a>  <span class="comment">     * @param int $timestart - The start of the cron process - do not repeat any tasks that have been run more recently than this.</span>
<a name="l439"><span class="linenum"> 439</span></a>  <span class="comment">     * @return \core\task\scheduled_task or null</span>
<a name="l440"><span class="linenum"> 440</span></a>  <span class="comment">     */</span>
<a name="l441"><span class="linenum"> 441</span></a>      public static function <a class="function" onClick="logFunction('get_next_scheduled_task')" href="../../../_functions/get_next_scheduled_task.html" onMouseOver="funcPopup(event,'get_next_scheduled_task')">get_next_scheduled_task</a>(<a class="var it347" onMouseOver="hilite(347)" onMouseOut="lolite()" onClick="logVariable('timestart')" href="../../../_variables/timestart.html">$timestart</a>) {
<a name="l442"><span class="linenum"> 442</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l443"><span class="linenum"> 443</span></a>          <a class="var it33391" onMouseOver="hilite(33391)" onMouseOut="lolite()" onClick="logVariable('cronlockfactory')" href="../../../_variables/cronlockfactory.html">$cronlockfactory</a> = \core\lock\<a class="class" onClick="logClass('lock_config')" href="../../../_classes/lock_config.html" onMouseOver="classPopup(event,'lock_config')">lock_config</a>::<a class="function" onClick="logFunction('get_lock_factory')" href="../../../_functions/get_lock_factory.html" onMouseOver="funcPopup(event,'get_lock_factory')">get_lock_factory</a>('cron');
<a name="l444"><span class="linenum"> 444</span></a>  
<a name="l445"><span class="linenum"> 445</span></a>          if (!<a class="var it11529" onMouseOver="hilite(11529)" onMouseOut="lolite()" onClick="logVariable('cronlock')" href="../../../_variables/cronlock.html">$cronlock</a> = <a class="var it33391" onMouseOver="hilite(33391)" onMouseOut="lolite()" onClick="logVariable('cronlockfactory')" href="../../../_variables/cronlockfactory.html">$cronlockfactory</a>-&gt;<a class="function" onClick="logFunction('get_lock')" href="../../../_functions/get_lock.html" onMouseOver="funcPopup(event,'get_lock')">get_lock</a>('core_cron', 10)) {
<a name="l446"><span class="linenum"> 446</span></a>              throw new \moodle_exception('locktimeout');
<a name="l447"><span class="linenum"> 447</span></a>          }
<a name="l448"><span class="linenum"> 448</span></a>  
<a name="l449"><span class="linenum"> 449</span></a>          <a class="var it1076" onMouseOver="hilite(1076)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../../_variables/where.html">$where</a> = &quot;(lastruntime IS NULL OR lastruntime &lt; :timestart1)
<a name="l450"><span class="linenum"> 450</span></a>                    AND (nextruntime IS NULL OR nextruntime &lt; :timestart2)
<a name="l451"><span class="linenum"> 451</span></a>                    AND disabled = 0&quot;;
<a name="l452"><span class="linenum"> 452</span></a>          <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a> = array('timestart1' =&gt; <a class="var it347" onMouseOver="hilite(347)" onMouseOut="lolite()" onClick="logVariable('timestart')" href="../../../_variables/timestart.html">$timestart</a>, 'timestart2' =&gt; <a class="var it347" onMouseOver="hilite(347)" onMouseOut="lolite()" onClick="logVariable('timestart')" href="../../../_variables/timestart.html">$timestart</a>);
<a name="l453"><span class="linenum"> 453</span></a>          <a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_select')" href="../../../_functions/get_records_select.html" onMouseOver="funcPopup(event,'get_records_select')">get_records_select</a>('task_scheduled', <a class="var it1076" onMouseOver="hilite(1076)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../../_variables/where.html">$where</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>);
<a name="l454"><span class="linenum"> 454</span></a>  
<a name="l455"><span class="linenum"> 455</span></a>          <a class="var it2592" onMouseOver="hilite(2592)" onMouseOut="lolite()" onClick="logVariable('pluginmanager')" href="../../../_variables/pluginmanager.html">$pluginmanager</a> = \<a class="class" onClick="logClass('core_plugin_manager')" href="../../../_classes/core_plugin_manager.html" onMouseOver="classPopup(event,'core_plugin_manager')">core_plugin_manager</a>::<a class="function" onClick="logFunction('instance')" href="../../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>();
<a name="l456"><span class="linenum"> 456</span></a>  
<a name="l457"><span class="linenum"> 457</span></a>          foreach (<a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a> as <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>) {
<a name="l458"><span class="linenum"> 458</span></a>  
<a name="l459"><span class="linenum"> 459</span></a>              if (<a class="var it5784" onMouseOver="hilite(5784)" onMouseOut="lolite()" onClick="logVariable('lock')" href="../../../_variables/lock.html">$lock</a> = <a class="var it33391" onMouseOver="hilite(33391)" onMouseOut="lolite()" onClick="logVariable('cronlockfactory')" href="../../../_variables/cronlockfactory.html">$cronlockfactory</a>-&gt;<a class="function" onClick="logFunction('get_lock')" href="../../../_functions/get_lock.html" onMouseOver="funcPopup(event,'get_lock')">get_lock</a>((<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('classname')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a>), 10)) {
<a name="l460"><span class="linenum"> 460</span></a>                  <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a> = '\\' . <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('classname')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a>;
<a name="l461"><span class="linenum"> 461</span></a>                  <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a> = self::<a class="function" onClick="logFunction('scheduled_task_from_record')" href="../../../_functions/scheduled_task_from_record.html" onMouseOver="funcPopup(event,'scheduled_task_from_record')">scheduled_task_from_record</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>);
<a name="l462"><span class="linenum"> 462</span></a>  <span class="comment">                // Safety check in case the task in the DB does not match a real class (maybe something was uninstalled).</span>
<a name="l463"><span class="linenum"> 463</span></a>                  if (!<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>) {
<a name="l464"><span class="linenum"> 464</span></a>                      <a class="var it5784" onMouseOver="hilite(5784)" onMouseOut="lolite()" onClick="logVariable('lock')" href="../../../_variables/lock.html">$lock</a>-&gt;<a class="function" onClick="logFunction('release')" href="../../../_functions/release.html" onMouseOver="funcPopup(event,'release')">release</a>();
<a name="l465"><span class="linenum"> 465</span></a>                      continue;
<a name="l466"><span class="linenum"> 466</span></a>                  }
<a name="l467"><span class="linenum"> 467</span></a>  
<a name="l468"><span class="linenum"> 468</span></a>                  <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_lock')" href="../../../_functions/set_lock.html" onMouseOver="funcPopup(event,'set_lock')">set_lock</a>(<a class="var it5784" onMouseOver="hilite(5784)" onMouseOut="lolite()" onClick="logVariable('lock')" href="../../../_variables/lock.html">$lock</a>);
<a name="l469"><span class="linenum"> 469</span></a>  
<a name="l470"><span class="linenum"> 470</span></a>  <span class="comment">                // See if the component is disabled.</span>
<a name="l471"><span class="linenum"> 471</span></a>                  <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('plugininfo')" href="../../../_variables/plugininfo.html">$plugininfo</a> = <a class="var it2592" onMouseOver="hilite(2592)" onMouseOut="lolite()" onClick="logVariable('pluginmanager')" href="../../../_variables/pluginmanager.html">$pluginmanager</a>-&gt;<a class="function" onClick="logFunction('get_plugin_info')" href="../../../_functions/get_plugin_info.html" onMouseOver="funcPopup(event,'get_plugin_info')">get_plugin_info</a>(<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_component')" href="../../../_functions/get_component.html" onMouseOver="funcPopup(event,'get_component')">get_component</a>());
<a name="l472"><span class="linenum"> 472</span></a>  
<a name="l473"><span class="linenum"> 473</span></a>                  if (<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('plugininfo')" href="../../../_variables/plugininfo.html">$plugininfo</a>) {
<a name="l474"><span class="linenum"> 474</span></a>                      if ((<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('plugininfo')" href="../../../_variables/plugininfo.html">$plugininfo</a>-&gt;<a class="function" onClick="logFunction('is_enabled')" href="../../../_functions/is_enabled.html" onMouseOver="funcPopup(event,'is_enabled')">is_enabled</a>() === false) &amp;&amp; !<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_run_if_component_disabled')" href="../../../_functions/get_run_if_component_disabled.html" onMouseOver="funcPopup(event,'get_run_if_component_disabled')">get_run_if_component_disabled</a>()) {
<a name="l475"><span class="linenum"> 475</span></a>                          <a class="var it5784" onMouseOver="hilite(5784)" onMouseOut="lolite()" onClick="logVariable('lock')" href="../../../_variables/lock.html">$lock</a>-&gt;<a class="function" onClick="logFunction('release')" href="../../../_functions/release.html" onMouseOver="funcPopup(event,'release')">release</a>();
<a name="l476"><span class="linenum"> 476</span></a>                          continue;
<a name="l477"><span class="linenum"> 477</span></a>                      }
<a name="l478"><span class="linenum"> 478</span></a>                  }
<a name="l479"><span class="linenum"> 479</span></a>  
<a name="l480"><span class="linenum"> 480</span></a>                  if (!<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('is_blocking')" href="../../../_functions/is_blocking.html" onMouseOver="funcPopup(event,'is_blocking')">is_blocking</a>()) {
<a name="l481"><span class="linenum"> 481</span></a>                      <a class="var it11529" onMouseOver="hilite(11529)" onMouseOut="lolite()" onClick="logVariable('cronlock')" href="../../../_variables/cronlock.html">$cronlock</a>-&gt;<a class="function" onClick="logFunction('release')" href="../../../_functions/release.html" onMouseOver="funcPopup(event,'release')">release</a>();
<a name="l482"><span class="linenum"> 482</span></a>                  } else {
<a name="l483"><span class="linenum"> 483</span></a>                      <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_cron_lock')" href="../../../_functions/set_cron_lock.html" onMouseOver="funcPopup(event,'set_cron_lock')">set_cron_lock</a>(<a class="var it11529" onMouseOver="hilite(11529)" onMouseOut="lolite()" onClick="logVariable('cronlock')" href="../../../_variables/cronlock.html">$cronlock</a>);
<a name="l484"><span class="linenum"> 484</span></a>                  }
<a name="l485"><span class="linenum"> 485</span></a>                  return <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>;
<a name="l486"><span class="linenum"> 486</span></a>              }
<a name="l487"><span class="linenum"> 487</span></a>          }
<a name="l488"><span class="linenum"> 488</span></a>  
<a name="l489"><span class="linenum"> 489</span></a>  <span class="comment">        // No tasks.</span>
<a name="l490"><span class="linenum"> 490</span></a>          <a class="var it11529" onMouseOver="hilite(11529)" onMouseOut="lolite()" onClick="logVariable('cronlock')" href="../../../_variables/cronlock.html">$cronlock</a>-&gt;<a class="function" onClick="logFunction('release')" href="../../../_functions/release.html" onMouseOver="funcPopup(event,'release')">release</a>();
<a name="l491"><span class="linenum"> 491</span></a>          return null;
<a name="l492"><span class="linenum"> 492</span></a>      }
<a name="l493"><span class="linenum"> 493</span></a>  
<a name="l494"><span class="linenum"> 494</span></a>      <span class="comment">/**</span>
<a name="l495"><span class="linenum"> 495</span></a>  <span class="comment">     * This function indicates that an adhoc task was not completed successfully and should be retried.</span>
<a name="l496"><span class="linenum"> 496</span></a>  <span class="comment">     *</span>
<a name="l497"><span class="linenum"> 497</span></a>  <span class="comment">     * @param \core\task\adhoc_task $task</span>
<a name="l498"><span class="linenum"> 498</span></a>  <span class="comment">     */</span>
<a name="l499"><span class="linenum"> 499</span></a>      public static function <a class="function" onClick="logFunction('adhoc_task_failed')" href="../../../_functions/adhoc_task_failed.html" onMouseOver="funcPopup(event,'adhoc_task_failed')">adhoc_task_failed</a>(adhoc_task <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>) {
<a name="l500"><span class="linenum"> 500</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l501"><span class="linenum"> 501</span></a>          <a class="var it16024" onMouseOver="hilite(16024)" onMouseOut="lolite()" onClick="logVariable('delay')" href="../../../_variables/delay.html">$delay</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_fail_delay')" href="../../../_functions/get_fail_delay.html" onMouseOver="funcPopup(event,'get_fail_delay')">get_fail_delay</a>();
<a name="l502"><span class="linenum"> 502</span></a>  
<a name="l503"><span class="linenum"> 503</span></a>  <span class="comment">        // Reschedule task with exponential fall off for failing tasks.</span>
<a name="l504"><span class="linenum"> 504</span></a>          if (empty(<a class="var it16024" onMouseOver="hilite(16024)" onMouseOut="lolite()" onClick="logVariable('delay')" href="../../../_variables/delay.html">$delay</a>)) {
<a name="l505"><span class="linenum"> 505</span></a>              <a class="var it16024" onMouseOver="hilite(16024)" onMouseOut="lolite()" onClick="logVariable('delay')" href="../../../_variables/delay.html">$delay</a> = 60;
<a name="l506"><span class="linenum"> 506</span></a>          } else {
<a name="l507"><span class="linenum"> 507</span></a>              <a class="var it16024" onMouseOver="hilite(16024)" onMouseOut="lolite()" onClick="logVariable('delay')" href="../../../_variables/delay.html">$delay</a> *= 2;
<a name="l508"><span class="linenum"> 508</span></a>          }
<a name="l509"><span class="linenum"> 509</span></a>  
<a name="l510"><span class="linenum"> 510</span></a>  <span class="comment">        // Max of 24 hour delay.</span>
<a name="l511"><span class="linenum"> 511</span></a>          if (<a class="var it16024" onMouseOver="hilite(16024)" onMouseOut="lolite()" onClick="logVariable('delay')" href="../../../_variables/delay.html">$delay</a> &gt; 86400) {
<a name="l512"><span class="linenum"> 512</span></a>              <a class="var it16024" onMouseOver="hilite(16024)" onMouseOut="lolite()" onClick="logVariable('delay')" href="../../../_variables/delay.html">$delay</a> = 86400;
<a name="l513"><span class="linenum"> 513</span></a>          }
<a name="l514"><span class="linenum"> 514</span></a>  
<a name="l515"><span class="linenum"> 515</span></a>          <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a> = <a class="phpfunction" onClick="logFunction('get_class')" href="../../../_functions/get_class.html" onMouseOver="phpfuncPopup(event,'get_class')">get_class</a>(<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>);
<a name="l516"><span class="linenum"> 516</span></a>          if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>, '\\') !== 0) {
<a name="l517"><span class="linenum"> 517</span></a>              <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a> = '\\' . <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>;
<a name="l518"><span class="linenum"> 518</span></a>          }
<a name="l519"><span class="linenum"> 519</span></a>  
<a name="l520"><span class="linenum"> 520</span></a>          <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_next_run_time')" href="../../../_functions/set_next_run_time.html" onMouseOver="funcPopup(event,'set_next_run_time')">set_next_run_time</a>(<a class="phpfunction" onClick="logFunction('time')" href="../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() + <a class="var it16024" onMouseOver="hilite(16024)" onMouseOut="lolite()" onClick="logVariable('delay')" href="../../../_variables/delay.html">$delay</a>);
<a name="l521"><span class="linenum"> 521</span></a>          <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('set_fail_delay')" href="../../../_functions/set_fail_delay.html" onMouseOver="funcPopup(event,'set_fail_delay')">set_fail_delay</a>(<a class="var it16024" onMouseOver="hilite(16024)" onMouseOut="lolite()" onClick="logVariable('delay')" href="../../../_variables/delay.html">$delay</a>);
<a name="l522"><span class="linenum"> 522</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a> = self::<a class="function" onClick="logFunction('record_from_adhoc_task')" href="../../../_functions/record_from_adhoc_task.html" onMouseOver="funcPopup(event,'record_from_adhoc_task')">record_from_adhoc_task</a>(<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>);
<a name="l523"><span class="linenum"> 523</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('task_adhoc', <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>);
<a name="l524"><span class="linenum"> 524</span></a>  
<a name="l525"><span class="linenum"> 525</span></a>          if (<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('is_blocking')" href="../../../_functions/is_blocking.html" onMouseOver="funcPopup(event,'is_blocking')">is_blocking</a>()) {
<a name="l526"><span class="linenum"> 526</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_cron_lock')" href="../../../_functions/get_cron_lock.html" onMouseOver="funcPopup(event,'get_cron_lock')">get_cron_lock</a>()-&gt;<a class="function" onClick="logFunction('release')" href="../../../_functions/release.html" onMouseOver="funcPopup(event,'release')">release</a>();
<a name="l527"><span class="linenum"> 527</span></a>          }
<a name="l528"><span class="linenum"> 528</span></a>          <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_lock')" href="../../../_functions/get_lock.html" onMouseOver="funcPopup(event,'get_lock')">get_lock</a>()-&gt;<a class="function" onClick="logFunction('release')" href="../../../_functions/release.html" onMouseOver="funcPopup(event,'release')">release</a>();
<a name="l529"><span class="linenum"> 529</span></a>      }
<a name="l530"><span class="linenum"> 530</span></a>  
<a name="l531"><span class="linenum"> 531</span></a>      <span class="comment">/**</span>
<a name="l532"><span class="linenum"> 532</span></a>  <span class="comment">     * This function indicates that an adhoc task was completed successfully.</span>
<a name="l533"><span class="linenum"> 533</span></a>  <span class="comment">     *</span>
<a name="l534"><span class="linenum"> 534</span></a>  <span class="comment">     * @param \core\task\adhoc_task $task</span>
<a name="l535"><span class="linenum"> 535</span></a>  <span class="comment">     */</span>
<a name="l536"><span class="linenum"> 536</span></a>      public static function <a class="function" onClick="logFunction('adhoc_task_complete')" href="../../../_functions/adhoc_task_complete.html" onMouseOver="funcPopup(event,'adhoc_task_complete')">adhoc_task_complete</a>(adhoc_task <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>) {
<a name="l537"><span class="linenum"> 537</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l538"><span class="linenum"> 538</span></a>  
<a name="l539"><span class="linenum"> 539</span></a>  <span class="comment">        // Delete the adhoc task record - it is finished.</span>
<a name="l540"><span class="linenum"> 540</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('task_adhoc', array('id' =&gt; <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_id')" href="../../../_functions/get_id.html" onMouseOver="funcPopup(event,'get_id')">get_id</a>()));
<a name="l541"><span class="linenum"> 541</span></a>  
<a name="l542"><span class="linenum"> 542</span></a>  <span class="comment">        // Reschedule and then release the locks.</span>
<a name="l543"><span class="linenum"> 543</span></a>          if (<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('is_blocking')" href="../../../_functions/is_blocking.html" onMouseOver="funcPopup(event,'is_blocking')">is_blocking</a>()) {
<a name="l544"><span class="linenum"> 544</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_cron_lock')" href="../../../_functions/get_cron_lock.html" onMouseOver="funcPopup(event,'get_cron_lock')">get_cron_lock</a>()-&gt;<a class="function" onClick="logFunction('release')" href="../../../_functions/release.html" onMouseOver="funcPopup(event,'release')">release</a>();
<a name="l545"><span class="linenum"> 545</span></a>          }
<a name="l546"><span class="linenum"> 546</span></a>          <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_lock')" href="../../../_functions/get_lock.html" onMouseOver="funcPopup(event,'get_lock')">get_lock</a>()-&gt;<a class="function" onClick="logFunction('release')" href="../../../_functions/release.html" onMouseOver="funcPopup(event,'release')">release</a>();
<a name="l547"><span class="linenum"> 547</span></a>      }
<a name="l548"><span class="linenum"> 548</span></a>  
<a name="l549"><span class="linenum"> 549</span></a>      <span class="comment">/**</span>
<a name="l550"><span class="linenum"> 550</span></a>  <span class="comment">     * This function indicates that a scheduled task was not completed successfully and should be retried.</span>
<a name="l551"><span class="linenum"> 551</span></a>  <span class="comment">     *</span>
<a name="l552"><span class="linenum"> 552</span></a>  <span class="comment">     * @param \core\task\scheduled_task $task</span>
<a name="l553"><span class="linenum"> 553</span></a>  <span class="comment">     */</span>
<a name="l554"><span class="linenum"> 554</span></a>      public static function <a class="function" onClick="logFunction('scheduled_task_failed')" href="../../../_functions/scheduled_task_failed.html" onMouseOver="funcPopup(event,'scheduled_task_failed')">scheduled_task_failed</a>(scheduled_task <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>) {
<a name="l555"><span class="linenum"> 555</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l556"><span class="linenum"> 556</span></a>  
<a name="l557"><span class="linenum"> 557</span></a>          <a class="var it16024" onMouseOver="hilite(16024)" onMouseOut="lolite()" onClick="logVariable('delay')" href="../../../_variables/delay.html">$delay</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_fail_delay')" href="../../../_functions/get_fail_delay.html" onMouseOver="funcPopup(event,'get_fail_delay')">get_fail_delay</a>();
<a name="l558"><span class="linenum"> 558</span></a>  
<a name="l559"><span class="linenum"> 559</span></a>  <span class="comment">        // Reschedule task with exponential fall off for failing tasks.</span>
<a name="l560"><span class="linenum"> 560</span></a>          if (empty(<a class="var it16024" onMouseOver="hilite(16024)" onMouseOut="lolite()" onClick="logVariable('delay')" href="../../../_variables/delay.html">$delay</a>)) {
<a name="l561"><span class="linenum"> 561</span></a>              <a class="var it16024" onMouseOver="hilite(16024)" onMouseOut="lolite()" onClick="logVariable('delay')" href="../../../_variables/delay.html">$delay</a> = 60;
<a name="l562"><span class="linenum"> 562</span></a>          } else {
<a name="l563"><span class="linenum"> 563</span></a>              <a class="var it16024" onMouseOver="hilite(16024)" onMouseOut="lolite()" onClick="logVariable('delay')" href="../../../_variables/delay.html">$delay</a> *= 2;
<a name="l564"><span class="linenum"> 564</span></a>          }
<a name="l565"><span class="linenum"> 565</span></a>  
<a name="l566"><span class="linenum"> 566</span></a>  <span class="comment">        // Max of 24 hour delay.</span>
<a name="l567"><span class="linenum"> 567</span></a>          if (<a class="var it16024" onMouseOver="hilite(16024)" onMouseOut="lolite()" onClick="logVariable('delay')" href="../../../_variables/delay.html">$delay</a> &gt; 86400) {
<a name="l568"><span class="linenum"> 568</span></a>              <a class="var it16024" onMouseOver="hilite(16024)" onMouseOut="lolite()" onClick="logVariable('delay')" href="../../../_variables/delay.html">$delay</a> = 86400;
<a name="l569"><span class="linenum"> 569</span></a>          }
<a name="l570"><span class="linenum"> 570</span></a>  
<a name="l571"><span class="linenum"> 571</span></a>          <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a> = <a class="phpfunction" onClick="logFunction('get_class')" href="../../../_functions/get_class.html" onMouseOver="phpfuncPopup(event,'get_class')">get_class</a>(<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>);
<a name="l572"><span class="linenum"> 572</span></a>          if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>, '\\') !== 0) {
<a name="l573"><span class="linenum"> 573</span></a>              <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a> = '\\' . <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>;
<a name="l574"><span class="linenum"> 574</span></a>          }
<a name="l575"><span class="linenum"> 575</span></a>  
<a name="l576"><span class="linenum"> 576</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('task_scheduled', array('classname' =&gt; <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>));
<a name="l577"><span class="linenum"> 577</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('nextruntime')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/nextruntime.html">nextruntime</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() + <a class="var it16024" onMouseOver="hilite(16024)" onMouseOut="lolite()" onClick="logVariable('delay')" href="../../../_variables/delay.html">$delay</a>;
<a name="l578"><span class="linenum"> 578</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('faildelay')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/faildelay.html">faildelay</a> = <a class="var it16024" onMouseOver="hilite(16024)" onMouseOut="lolite()" onClick="logVariable('delay')" href="../../../_variables/delay.html">$delay</a>;
<a name="l579"><span class="linenum"> 579</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('task_scheduled', <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>);
<a name="l580"><span class="linenum"> 580</span></a>  
<a name="l581"><span class="linenum"> 581</span></a>          if (<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('is_blocking')" href="../../../_functions/is_blocking.html" onMouseOver="funcPopup(event,'is_blocking')">is_blocking</a>()) {
<a name="l582"><span class="linenum"> 582</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_cron_lock')" href="../../../_functions/get_cron_lock.html" onMouseOver="funcPopup(event,'get_cron_lock')">get_cron_lock</a>()-&gt;<a class="function" onClick="logFunction('release')" href="../../../_functions/release.html" onMouseOver="funcPopup(event,'release')">release</a>();
<a name="l583"><span class="linenum"> 583</span></a>          }
<a name="l584"><span class="linenum"> 584</span></a>          <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_lock')" href="../../../_functions/get_lock.html" onMouseOver="funcPopup(event,'get_lock')">get_lock</a>()-&gt;<a class="function" onClick="logFunction('release')" href="../../../_functions/release.html" onMouseOver="funcPopup(event,'release')">release</a>();
<a name="l585"><span class="linenum"> 585</span></a>      }
<a name="l586"><span class="linenum"> 586</span></a>  
<a name="l587"><span class="linenum"> 587</span></a>      <span class="comment">/**</span>
<a name="l588"><span class="linenum"> 588</span></a>  <span class="comment">     * This function indicates that a scheduled task was completed successfully and should be rescheduled.</span>
<a name="l589"><span class="linenum"> 589</span></a>  <span class="comment">     *</span>
<a name="l590"><span class="linenum"> 590</span></a>  <span class="comment">     * @param \core\task\scheduled_task $task</span>
<a name="l591"><span class="linenum"> 591</span></a>  <span class="comment">     */</span>
<a name="l592"><span class="linenum"> 592</span></a>      public static function <a class="function" onClick="logFunction('scheduled_task_complete')" href="../../../_functions/scheduled_task_complete.html" onMouseOver="funcPopup(event,'scheduled_task_complete')">scheduled_task_complete</a>(scheduled_task <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>) {
<a name="l593"><span class="linenum"> 593</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l594"><span class="linenum"> 594</span></a>  
<a name="l595"><span class="linenum"> 595</span></a>          <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a> = <a class="phpfunction" onClick="logFunction('get_class')" href="../../../_functions/get_class.html" onMouseOver="phpfuncPopup(event,'get_class')">get_class</a>(<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>);
<a name="l596"><span class="linenum"> 596</span></a>          if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>, '\\') !== 0) {
<a name="l597"><span class="linenum"> 597</span></a>              <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a> = '\\' . <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>;
<a name="l598"><span class="linenum"> 598</span></a>          }
<a name="l599"><span class="linenum"> 599</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('task_scheduled', array('classname' =&gt; <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>));
<a name="l600"><span class="linenum"> 600</span></a>          if (<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>) {
<a name="l601"><span class="linenum"> 601</span></a>              <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('lastruntime')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/lastruntime.html">lastruntime</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l602"><span class="linenum"> 602</span></a>              <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('faildelay')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/faildelay.html">faildelay</a> = 0;
<a name="l603"><span class="linenum"> 603</span></a>              <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('nextruntime')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/nextruntime.html">nextruntime</a> = <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_next_scheduled_time')" href="../../../_functions/get_next_scheduled_time.html" onMouseOver="funcPopup(event,'get_next_scheduled_time')">get_next_scheduled_time</a>();
<a name="l604"><span class="linenum"> 604</span></a>  
<a name="l605"><span class="linenum"> 605</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('task_scheduled', <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>);
<a name="l606"><span class="linenum"> 606</span></a>          }
<a name="l607"><span class="linenum"> 607</span></a>  
<a name="l608"><span class="linenum"> 608</span></a>  <span class="comment">        // Reschedule and then release the locks.</span>
<a name="l609"><span class="linenum"> 609</span></a>          if (<a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('is_blocking')" href="../../../_functions/is_blocking.html" onMouseOver="funcPopup(event,'is_blocking')">is_blocking</a>()) {
<a name="l610"><span class="linenum"> 610</span></a>              <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_cron_lock')" href="../../../_functions/get_cron_lock.html" onMouseOver="funcPopup(event,'get_cron_lock')">get_cron_lock</a>()-&gt;<a class="function" onClick="logFunction('release')" href="../../../_functions/release.html" onMouseOver="funcPopup(event,'release')">release</a>();
<a name="l611"><span class="linenum"> 611</span></a>          }
<a name="l612"><span class="linenum"> 612</span></a>          <a class="var it2490" onMouseOver="hilite(2490)" onMouseOut="lolite()" onClick="logVariable('task')" href="../../../_variables/task.html">$task</a>-&gt;<a class="function" onClick="logFunction('get_lock')" href="../../../_functions/get_lock.html" onMouseOver="funcPopup(event,'get_lock')">get_lock</a>()-&gt;<a class="function" onClick="logFunction('release')" href="../../../_functions/release.html" onMouseOver="funcPopup(event,'release')">release</a>();
<a name="l613"><span class="linenum"> 613</span></a>      }
<a name="l614"><span class="linenum"> 614</span></a>  
<a name="l615"><span class="linenum"> 615</span></a>      <span class="comment">/**</span>
<a name="l616"><span class="linenum"> 616</span></a>  <span class="comment">     * This function is used to indicate that any long running cron processes should exit at the</span>
<a name="l617"><span class="linenum"> 617</span></a>  <span class="comment">     * next opportunity and restart. This is because something (e.g. DB changes) has changed and</span>
<a name="l618"><span class="linenum"> 618</span></a>  <span class="comment">     * the static caches may be stale.</span>
<a name="l619"><span class="linenum"> 619</span></a>  <span class="comment">     */</span>
<a name="l620"><span class="linenum"> 620</span></a>      public static function <a class="function" onClick="logFunction('clear_static_caches')" href="../../../_functions/clear_static_caches.html" onMouseOver="funcPopup(event,'clear_static_caches')">clear_static_caches</a>() {
<a name="l621"><span class="linenum"> 621</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l622"><span class="linenum"> 622</span></a>  <span class="comment">        // Do not use get/set config here because the caches cannot be relied on.</span>
<a name="l623"><span class="linenum"> 623</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('config', array('name'=&gt;'scheduledtaskreset'));
<a name="l624"><span class="linenum"> 624</span></a>          if (<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>) {
<a name="l625"><span class="linenum"> 625</span></a>              <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('value')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/value.html">value</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l626"><span class="linenum"> 626</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('config', <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>);
<a name="l627"><span class="linenum"> 627</span></a>          } else {
<a name="l628"><span class="linenum"> 628</span></a>              <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a> = new \stdClass();
<a name="l629"><span class="linenum"> 629</span></a>              <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('name')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a> = 'scheduledtaskreset';
<a name="l630"><span class="linenum"> 630</span></a>              <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('value')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/value.html">value</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l631"><span class="linenum"> 631</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('config', <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>);
<a name="l632"><span class="linenum"> 632</span></a>          }
<a name="l633"><span class="linenum"> 633</span></a>      }
<a name="l634"><span class="linenum"> 634</span></a>  
<a name="l635"><span class="linenum"> 635</span></a>      <span class="comment">/**</span>
<a name="l636"><span class="linenum"> 636</span></a>  <span class="comment">     * Return true if the static caches have been cleared since $starttime.</span>
<a name="l637"><span class="linenum"> 637</span></a>  <span class="comment">     * @param int $starttime The time this process started.</span>
<a name="l638"><span class="linenum"> 638</span></a>  <span class="comment">     * @return boolean True if static caches need resetting.</span>
<a name="l639"><span class="linenum"> 639</span></a>  <span class="comment">     */</span>
<a name="l640"><span class="linenum"> 640</span></a>      public static function <a class="function" onClick="logFunction('static_caches_cleared_since')" href="../../../_functions/static_caches_cleared_since.html" onMouseOver="funcPopup(event,'static_caches_cleared_since')">static_caches_cleared_since</a>(<a class="var it2488" onMouseOver="hilite(2488)" onMouseOut="lolite()" onClick="logVariable('starttime')" href="../../../_variables/starttime.html">$starttime</a>) {
<a name="l641"><span class="linenum"> 641</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l642"><span class="linenum"> 642</span></a>          <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('config', array('name'=&gt;'scheduledtaskreset'));
<a name="l643"><span class="linenum"> 643</span></a>          return <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a> &amp;&amp; (<a class="phpfunction" onClick="logFunction('intval')" href="../../../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('value')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../_variables/value.html">value</a>) &gt; <a class="var it2488" onMouseOver="hilite(2488)" onMouseOut="lolite()" onClick="logVariable('starttime')" href="../../../_variables/starttime.html">$starttime</a>);
<a name="l644"><span class="linenum"> 644</span></a>      }
<a name="l645"><span class="linenum"> 645</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'configure_scheduled_task': ['configure_scheduled_task', 'Change the default configuration for a scheduled task. The list of scheduled tasks is taken from {@link load_scheduled_tasks_for_component}. ', [['lib/classes/task','manager.php',132]], 4],
'get_next_run_time': ['get_next_run_time', 'Get the next run time for this task. ', [['lib/classes/task','task_base.php',77]], 5],
'set_component': ['set_component', 'Setter for $component. ', [['lib/classes/task','task_base.php',117],['lib/classes/message/inbound','handler.php',110],['comment','lib.php',268],['grade/grading','lib.php',135]], 7],
'set_day': ['set_day', 'Setter for $day. ', [['lib/classes/task','scheduled_task.php',161]], 6],
'get_next_scheduled_time': ['get_next_scheduled_time', 'Calculate when this task should next be run based on the schedule. ', [['lib/classes/task','scheduled_task.php',324]], 10],
'set_day_of_week': ['set_day_of_week', 'Setter for $dayofweek. ', [['lib/classes/task','scheduled_task.php',177]], 7],
'get_all_scheduled_tasks': ['get_all_scheduled_tasks', 'This function will return a list of all the scheduled tasks that exist in the database. ', [['lib/classes/task','manager.php',365]], 2],
'get_custom_data_as_string': ['get_custom_data_as_string', 'Alternate getter for $customdata. ', [['lib/classes/task','adhoc_task.php',83]], 1],
'debugging': ['debugging', 'Standard Debugging Function ', [['lib','weblib.php',2854]], 853],
'get_lock': ['get_lock', 'Get the current lock for this task. ', [['lib/classes/task','task_base.php',69],['lib/classes/lock','db_record_lock_factory.php',109],['lib/classes/lock','lock_factory.php',77],['lib/dml','oci_native_moodle_package.sql',41],['lib/dml','oci_native_moodle_package.sql',77],['lib/classes/lock','file_lock_factory.php',125],['lib/classes/lock','postgres_lock_factory.php',171]], 22],
'get_component_directory': ['get_component_directory', 'Return exact absolute path to a plugin directory. ', [['lib/classes','component.php',1003],['lib','deprecatedlib.php',543]], 44],
'set_disabled': ['set_disabled', 'Setter for $disabled. ', [['lib/classes/task','scheduled_task.php',196]], 5],
'get_scheduled_task': ['get_scheduled_task', 'This function load the scheduled task details for a given classname. ', [['lib/classes/task','manager.php',321]], 10],
'get_plugin_info': ['get_plugin_info', 'Returns information about the known plugin, or null ', [['lib/classes','plugin_manager.php',620]], 30],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required. ', [['lib/dml','pgsql_native_moodle_database.php',883],['lib/dml','oci_native_moodle_database.php',1249],['lib/dml','sqlsrv_native_moodle_database.php',978],['lib/dml','mssql_native_moodle_database.php',898],['lib/dml','mysqli_native_moodle_database.php',1177],['lib/dml/tests','dml_test.php',5427],['lib/dml','pdo_moodle_database.php',386],['question/engine/upgrade','upgradelib.php',121]], 1512],
'load_default_scheduled_tasks_for_component': ['load_default_scheduled_tasks_for_component', 'Given a component name, will load the list of tasks in the db/tasks.php file for that component. ', [['lib/classes/task','manager.php',39]], 2],
'set_lock': ['set_lock', 'Set the current lock for this task. ', [['lib/classes/task','task_base.php',53]], 3],
'get_month': ['get_month', 'Getter for $month. ', [['lib/classes/task','scheduled_task.php',153]], 4],
'get_last_run_time': ['get_last_run_time', 'Get the last run time for this scheduled task. ', [['lib/classes/task','scheduled_task.php',73]], 5],
'scheduled_task_failed': ['scheduled_task_failed', 'This function indicates that a scheduled task was not completed successfully and should be retried. ', [['lib/classes/task','manager.php',549]], 3],
'get_day_of_week': ['get_day_of_week', 'Getter for $dayofweek. ', [['lib/classes/task','scheduled_task.php',188]], 6],
'get_records_select': ['get_records_select', 'Get a number of records as an array of objects which match a particular WHERE clause. ', [['lib/dml','moodle_database.php',1283]], 163],
'set_month': ['set_month', 'Setter for $month. ', [['lib/classes/task','scheduled_task.php',145]], 5],
'load_scheduled_tasks_for_component': ['load_scheduled_tasks_for_component', 'Given a component name, will load the list of tasks from the scheduled_tasks table for that component. Do not execute tasks loaded from this function - they have not been locked. ', [['lib/classes/task','manager.php',298]], 2],
'adhoc_task_complete': ['adhoc_task_complete', 'This function indicates that an adhoc task was completed successfully. ', [['lib/classes/task','manager.php',531]], 3],
'get_records': ['get_records', 'Get a number of records as an array of objects where all the given conditions met. ', [['lib/dml','moodle_database.php',1236],['lib','coursecatlib.php',654],['question','category_class.php',63]], 860],
'get_id': ['get_id', 'Returns instance id ', [['grade/grading/form','lib.php',854],['cache/classes','definition.php',596],['lib/classes/task','adhoc_task.php',51],['question/engine','questionusage.php',120],['mod/lti/classes/local/ltiservice','service_base.php',76],['lib/simplepie/library/SimplePie','Item.php',199],['question/engine','questionattemptstep.php',136],['mod/lti/classes/local/ltiservice','resource_base.php',81],['backup/converter','convertlib.php',100],['admin/tool/uploadcourse/classes','course.php',335],['backup/controller','backup_controller.class.php',261],['lib','adminlib.php',1716],['lib/filestorage','stored_file.php',786],['lib/filebrowser','virtual_root_file.php',290]], 169],
'set_customised': ['set_customised', 'Has this task been changed from it\'s default config? ', [['lib/classes/task','scheduled_task.php',97]], 4],
'record_from_adhoc_task': ['record_from_adhoc_task', 'Utility method to create a DB record from an adhoc task. ', [['lib/classes/task','manager.php',185]], 2],
'adhoc_task_failed': ['adhoc_task_failed', 'This function indicates that an adhoc task was not completed successfully and should be retried. ', [['lib/classes/task','manager.php',494]], 2],
'set_next_run_time': ['set_next_run_time', 'Set the next run time for this task. ', [['lib/classes/task','task_base.php',85]], 9],
'set_last_run_time': ['set_last_run_time', 'Set the last run time for this scheduled task. ', [['lib/classes/task','scheduled_task.php',81]], 1],
'get_record': ['get_record', 'Get a single database record as an object where all the given conditions met. ', [['lib/dml','moodle_database.php',1413]], 2960],
'scheduled_task_from_record': ['scheduled_task_from_record', 'Utility method to create a task from a DB record. ', [['lib/classes/task','manager.php',243]], 5],
'is_enabled': ['is_enabled', 'Allows hiding this plugin from the submission/feedback screen if it is not enabled. ', [['mod/assign','assignmentplugin.php',223],['lib/classes/plugininfo','orphaned.php',37],['lib','completionlib.php',269],['mod/assign/submission/comments','locallib.php',172],['mod/assign/feedback/editpdf','locallib.php',276],['lib/classes/plugininfo','base.php',371],['lib/classes/plugininfo','tool.php',39],['admin/tool/health','index.php',393],['admin/tool/log/classes/plugininfo','logstore.php',35],['lib/classes/message/inbound','manager.php',37],['lib/classes/plugininfo','mnetservice.php',33],['mod/assignment/classes/plugininfo','assignment.php',32],['lib','adminlib.php',1952],['mod/assign/feedback/offline','locallib.php',365],['lib','medialib.php',318],['lib','medialib.php',634],['lib','medialib.php',1265]], 200],
'set_blocking': ['set_blocking', 'Setter for $blocking. ', [['lib/classes/task','task_base.php',101]], 2],
'get_next_adhoc_task': ['get_next_adhoc_task', 'This function will dispatch the next adhoc task in the queue. The task will be handed out with an open lock - possibly on the entire cron process. Make sure you call either {@link adhoc_task_failed} or {@link adhoc_task_complete} to release the lock and reschedule the task. ', [['lib/classes/task','manager.php',387]], 6],
'get_lock_factory': ['get_lock_factory', 'Get an instance of the currently configured locking subclass. ', [['lib/classes/lock','lock_config.php',40]], 10],
'queue_adhoc_task': ['queue_adhoc_task', 'Queue an adhoc task to run in the background. ', [['lib/classes/task','manager.php',115]], 2],
'get_default_scheduled_task': ['get_default_scheduled_task', 'This function load the default scheduled task details for a given classname. ', [['lib/classes/task','manager.php',341]], 1],
'get_cron_lock': ['get_cron_lock', 'Get the current lock for the entire cron. ', [['lib/classes/task','task_base.php',93]], 4],
'static_caches_cleared_since': ['static_caches_cleared_since', 'Return true if the static caches have been cleared since $starttime. ', [['lib/classes/task','manager.php',635]], 2],
'get_run_if_component_disabled': ['get_run_if_component_disabled', 'Override this function if you want this scheduled task to run, even if the component is disabled. ', [['lib/classes/task','scheduled_task.php',212]], 4],
'scheduled_task_complete': ['scheduled_task_complete', 'This function indicates that a scheduled task was completed successfully and should be rescheduled. ', [['lib/classes/task','manager.php',587]], 4],
'set_cron_lock': ['set_cron_lock', 'Set the current lock for the entire cron process. ', [['lib/classes/task','task_base.php',61],['lib','adminlib.php',440]], 12],
'instance': ['instance', 'Retrieve sole instance of the registry. ', [['lib/htmlpurifier/HTMLPurifier','URISchemeRegistry.php',9],['lib/classes/update','checker.php',62],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',29],['lib/classes','useragent.php',101],['backup/cc','validator.php',35],['lib/portfolio','exporter.php',251],['lib/tests','update_deployer_test.php',69],['lib/tests','string_manager_standard_test.php',124],['lib','modinfolib.php',373],['','mdeploy.php',96],['cache','disabledlib.php',171],['cache','disabledlib.php',296],['admin/tool/installaddon/classes','validator.php',85],['cache/classes','config.php',87],['course/format','lib.php',156],['lib','accesslib.php',6184],['lib','accesslib.php',6436],['lib','accesslib.php',6614],['lib','accesslib.php',6868],['lib','accesslib.php',7129],['lib','accesslib.php',7341],['cache','locallib.php',52],['lib/htmlpurifier','HTMLPurifier.php',251],['cache/classes','factory.php',114],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',53],['cache/classes','helper.php',76],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',31],['lib/classes','plugin_manager.php',83],['lib','filterlib.php',81],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',80],['lib/classes/update','deployer.php',54],['admin/tool/installaddon/classes','pluginfo_client.php',37],['admin/tool/installaddon/classes','installer.php',40],['backup/cc/cc_lib','cc_utils.php',387],['backup/cc/cc_lib','cc_utils.php',443]], 3942],
'reset_scheduled_tasks_for_component': ['reset_scheduled_tasks_for_component', 'Update the database to contain a list of scheduled task for a component. The list of scheduled tasks is taken from @load_scheduled_tasks_for_component. Will throw exceptions for any errors. ', [['lib/classes/task','manager.php',79]], 12],
'adhoc_task_from_record': ['adhoc_task_from_record', 'Utility method to create an adhoc task from a DB record. ', [['lib/classes/task','manager.php',207]], 1],
'set_minute': ['set_minute', 'Setter for $minute. Accepts a special \'R\' value which will be translated to a random minute. ', [['lib/classes/task','scheduled_task.php',105]], 11],
'set_custom_data_as_string': ['set_custom_data_as_string', 'Alternate setter for $customdata. Expects the data as a json_encoded string. ', [['lib/classes/task','adhoc_task.php',67]], 1],
'is_customised': ['is_customised', 'Has this task been changed from it\'s default config? ', [['lib/classes/task','scheduled_task.php',89]], 3],
'update_record': ['update_record', 'Update a record in a table ', [['lib/dml','pgsql_native_moodle_database.php',1137],['lib/dml','oci_native_moodle_database.php',1355],['lib/dml','sqlsrv_native_moodle_database.php',1081],['lib/dml','mssql_native_moodle_database.php',1003],['lib/dml','mysqli_native_moodle_database.php',1397],['lib/dml/tests','dml_test.php',5430],['lib/dml','pdo_moodle_database.php',460]], 565],
'get_minute': ['get_minute', 'Getter for $minute. ', [['lib/classes/task','scheduled_task.php',117]], 6],
'get_fail_delay': ['get_fail_delay', 'Getter for $faildelay. ', [['lib/classes/task','task_base.php',141]], 5],
'get_hour': ['get_hour', 'Getter for $hour. ', [['lib/classes/task','scheduled_task.php',137]], 6],
'is_blocking': ['is_blocking', 'Getter for $blocking. ', [['lib/classes/task','task_base.php',109]], 9],
'set_fail_delay': ['set_fail_delay', 'Setter for $faildelay. ', [['lib/classes/task','task_base.php',133]], 3],
'get_day': ['get_day', 'Gets the day from day string. ', [['calendar/classes','rrule_manager.php',296],['lib/classes/task','scheduled_task.php',169]], 8],
'release': ['release', 'Note: do not call manually! ', [['lib/testing/classes','test_lock.php',82],['lib/classes/lock','lock.php',93],['lib/zend/Zend/Service/Amazon/Ec2','Elasticip.php',95]], 39],
'get_component': ['get_component', 'Returns gradable component name ', [['grade/grading/form','lib.php',111],['cache/classes','definition.php',633],['lib/classes/task','task_base.php',125],['comment','lib.php',971],['lib/filestorage','stored_file.php',661],['grade/grading','lib.php',126],['lib/filebrowser','virtual_root_file.php',191],['availability/classes','frontend.php',86]], 66],
'get_next_scheduled_task': ['get_next_scheduled_task', 'This function will dispatch the next scheduled task in the queue. The task will be handed out with an open lock - possibly on the entire cron process. Make sure you call either {@link scheduled_task_failed} or {@link scheduled_task_complete} to release the lock and reschedule the task. ', [['lib/classes/task','manager.php',433]], 7],
'delete_records': ['delete_records', 'Delete the records from a table where all the given conditions met. If conditions not specified, table is truncated. ', [['lib/dml','moodle_database.php',1815],['lib/dml','sqlite3_pdo_moodle_database.php',337]], 778],
'get_disabled': ['get_disabled', 'Getter for $disabled. ', [['lib/classes/task','scheduled_task.php',204]], 5],
'set_hour': ['set_hour', 'Setter for $hour. Accepts a special \'R\' value which will be translated to a random hour. ', [['lib/classes/task','scheduled_task.php',125]], 9],
'record_from_scheduled_task': ['record_from_scheduled_task', 'Utility method to create a DB record from a scheduled task. ', [['lib/classes/task','manager.php',157]], 5],
'set_id': ['set_id', 'Setter for $id. ', [['lib/classes/task','adhoc_task.php',43],['lib/classes/message/inbound','handler.php',100],['mnet','peer.php',257]], 19],
'clear_static_caches': ['clear_static_caches', 'This function is used to indicate that any long running cron processes should exit at the next opportunity and restart. This is because something (e.g. DB changes) has changed and the static caches may be stale. ', [['lib/classes/task','manager.php',615]], 1],
'class_exists': ['class_exists', '', [], 273],
'time': ['time', '', [], 1768],
'file_exists': ['file_exists', '', [], 873],
'get_class': ['get_class', '', [], 332],
'intval': ['intval', '', [], 484],
'define': ['define', '', [], 2170],
'strpos': ['strpos', '', [], 1623]};
CLASS_DATA={
'manager': ['manager', 'Defines MAnager class for myprofile navigation tree. ', [['user/classes/output/myprofile','manager.php',28],['lib/classes/log','manager.php',29],['admin/tool/messageinbound/classes','manager.php',29],['lib/classes/message','manager.php',31],['lib/classes/message/inbound','manager.php',29],['admin/tool/log/classes/log','manager.php',29],['lib/classes/session','manager.php',29],['lib/classes/task','manager.php',28],['lib/classes/event','manager.php',30]], 346],
'lock_config': ['lock_config', 'Lock configuration class, used to get an instance of the currently configured lock factory. ', [['lib/classes/lock','lock_config.php',30]], 10],
'core_plugin_manager': ['core_plugin_manager', 'Singleton class providing general plugins management functionality. ', [['lib/classes','plugin_manager.php',31]], 187],
'core_component': ['core_component', 'Collection of components related methods. ', [['lib/classes','component.php',41]], 485]};
CONST_DATA={
'DEBUG_DEVELOPER': ['DEBUG_DEVELOPER', '', [['lib','setuplib.php',40]], 554],
'IGNORE_MISSING': ['IGNORE_MISSING', '', [['lib','dmllib.php',48]], 204],
'MUST_EXIST': ['MUST_EXIST', '', [['lib','dmllib.php',52]], 1252],
'CORE_TASK_TASKS_FILENAME': ['CORE_TASK_TASKS_FILENAME', '', [['lib/classes/task','manager.php',27]], 2]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu May 28 19:17:31 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
