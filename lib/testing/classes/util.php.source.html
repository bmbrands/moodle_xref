<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /lib/testing/classes/util.php source</title>
    <link rel="stylesheet" href="../../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu May 28 19:17:31 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../../';
subdir='lib/testing/classes';
filename='util.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/lib/testing/classes/</a> -> <a href="util.php.html">util.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="util.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="util.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * Testing util classes</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * @abstract</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @package    core</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @category   test</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * @copyright  2012 Petr Skoda {@link http://skodak.org}</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment"> */</span>
<a name="l26"><span class="linenum">  26</span></a>  
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment">/**</span>
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment"> * Utils for test sites creation</span>
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment"> *</span>
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment"> * @package   core</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment"> * @category  test</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> * @copyright 2012 Petr Skoda {@link http://skodak.org}</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> */</span>
<a name="l35"><span class="linenum">  35</span></a>  abstract class testing_util {
<a name="l36"><span class="linenum">  36</span></a>  
<a name="l37"><span class="linenum">  37</span></a>      <span class="comment">/**</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment">     * @var string dataroot (likely to be $CFG-&gt;dataroot).</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="comment">     */</span>
<a name="l40"><span class="linenum">  40</span></a>      private static <a class="var it68" onMouseOver="hilite(68)" onMouseOut="lolite()" onClick="logVariable('dataroot')" href="../../../_variables/dataroot.html">$dataroot</a> = null;
<a name="l41"><span class="linenum">  41</span></a>  
<a name="l42"><span class="linenum">  42</span></a>      <span class="comment">/**</span>
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment">     * @var testing_data_generator</span>
<a name="l44"><span class="linenum">  44</span></a>  <span class="comment">     */</span>
<a name="l45"><span class="linenum">  45</span></a>      protected static <a class="var it1064" onMouseOver="hilite(1064)" onMouseOut="lolite()" onClick="logVariable('generator')" href="../../../_variables/generator.html">$generator</a> = null;
<a name="l46"><span class="linenum">  46</span></a>  
<a name="l47"><span class="linenum">  47</span></a>      <span class="comment">/**</span>
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment">     * @var string current version hash from php files</span>
<a name="l49"><span class="linenum">  49</span></a>  <span class="comment">     */</span>
<a name="l50"><span class="linenum">  50</span></a>      protected static <a class="var it39189" onMouseOver="hilite(39189)" onMouseOut="lolite()" onClick="logVariable('versionhash')" href="../../../_variables/versionhash.html">$versionhash</a> = null;
<a name="l51"><span class="linenum">  51</span></a>  
<a name="l52"><span class="linenum">  52</span></a>      <span class="comment">/**</span>
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment">     * @var array original content of all database tables</span>
<a name="l54"><span class="linenum">  54</span></a>  <span class="comment">     */</span>
<a name="l55"><span class="linenum">  55</span></a>      protected static <a class="var it2629" onMouseOver="hilite(2629)" onMouseOut="lolite()" onClick="logVariable('tabledata')" href="../../../_variables/tabledata.html">$tabledata</a> = null;
<a name="l56"><span class="linenum">  56</span></a>  
<a name="l57"><span class="linenum">  57</span></a>      <span class="comment">/**</span>
<a name="l58"><span class="linenum">  58</span></a>  <span class="comment">     * @var array original structure of all database tables</span>
<a name="l59"><span class="linenum">  59</span></a>  <span class="comment">     */</span>
<a name="l60"><span class="linenum">  60</span></a>      protected static <a class="var it39190" onMouseOver="hilite(39190)" onMouseOut="lolite()" onClick="logVariable('tablestructure')" href="../../../_variables/tablestructure.html">$tablestructure</a> = null;
<a name="l61"><span class="linenum">  61</span></a>  
<a name="l62"><span class="linenum">  62</span></a>      <span class="comment">/**</span>
<a name="l63"><span class="linenum">  63</span></a>  <span class="comment">     * @var array original structure of all database tables</span>
<a name="l64"><span class="linenum">  64</span></a>  <span class="comment">     */</span>
<a name="l65"><span class="linenum">  65</span></a>      protected static <a class="var it39191" onMouseOver="hilite(39191)" onMouseOut="lolite()" onClick="logVariable('sequencenames')" href="../../../_variables/sequencenames.html">$sequencenames</a> = null;
<a name="l66"><span class="linenum">  66</span></a>  
<a name="l67"><span class="linenum">  67</span></a>      <span class="comment">/**</span>
<a name="l68"><span class="linenum">  68</span></a>  <span class="comment">     * @var string name of the json file where we store the list of dataroot files to not reset during reset_dataroot.</span>
<a name="l69"><span class="linenum">  69</span></a>  <span class="comment">     */</span>
<a name="l70"><span class="linenum">  70</span></a>      private static <a class="var it39192" onMouseOver="hilite(39192)" onMouseOut="lolite()" onClick="logVariable('originaldatafilesjson')" href="../../../_variables/originaldatafilesjson.html">$originaldatafilesjson</a> = 'originaldatafiles.json';
<a name="l71"><span class="linenum">  71</span></a>  
<a name="l72"><span class="linenum">  72</span></a>      <span class="comment">/**</span>
<a name="l73"><span class="linenum">  73</span></a>  <span class="comment">     * @var boolean set to true once $originaldatafilesjson file is created.</span>
<a name="l74"><span class="linenum">  74</span></a>  <span class="comment">     */</span>
<a name="l75"><span class="linenum">  75</span></a>      private static <a class="var it39193" onMouseOver="hilite(39193)" onMouseOut="lolite()" onClick="logVariable('originaldatafilesjsonadded')" href="../../../_variables/originaldatafilesjsonadded.html">$originaldatafilesjsonadded</a> = false;
<a name="l76"><span class="linenum">  76</span></a>  
<a name="l77"><span class="linenum">  77</span></a>      <span class="comment">/**</span>
<a name="l78"><span class="linenum">  78</span></a>  <span class="comment">     * @var int next sequence value for a single test cycle.</span>
<a name="l79"><span class="linenum">  79</span></a>  <span class="comment">     */</span>
<a name="l80"><span class="linenum">  80</span></a>      protected static <a class="var it39194" onMouseOver="hilite(39194)" onMouseOut="lolite()" onClick="logVariable('sequencenextstartingid')" href="../../../_variables/sequencenextstartingid.html">$sequencenextstartingid</a> = null;
<a name="l81"><span class="linenum">  81</span></a>      <span class="comment">/**</span>
<a name="l82"><span class="linenum">  82</span></a>  <span class="comment">     * Return the name of the JSON file containing the init filenames.</span>
<a name="l83"><span class="linenum">  83</span></a>  <span class="comment">     *</span>
<a name="l84"><span class="linenum">  84</span></a>  <span class="comment">     * @static</span>
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment">     * @return string</span>
<a name="l86"><span class="linenum">  86</span></a>  <span class="comment">     */</span>
<a name="l87"><span class="linenum">  87</span></a>      public static function <a class="function" onClick="logFunction('get_originaldatafilesjson')" href="../../../_functions/get_originaldatafilesjson.html" onMouseOver="funcPopup(event,'get_originaldatafilesjson')">get_originaldatafilesjson</a>() {
<a name="l88"><span class="linenum">  88</span></a>          return self::<a class="var it39192" onMouseOver="hilite(39192)" onMouseOut="lolite()" onClick="logVariable('originaldatafilesjson')" href="../../../_variables/originaldatafilesjson.html">$originaldatafilesjson</a>;
<a name="l89"><span class="linenum">  89</span></a>      }
<a name="l90"><span class="linenum">  90</span></a>  
<a name="l91"><span class="linenum">  91</span></a>      <span class="comment">/**</span>
<a name="l92"><span class="linenum">  92</span></a>  <span class="comment">     * Return the dataroot. It's useful when mocking the dataroot when unit testing this class itself.</span>
<a name="l93"><span class="linenum">  93</span></a>  <span class="comment">     *</span>
<a name="l94"><span class="linenum">  94</span></a>  <span class="comment">     * @static</span>
<a name="l95"><span class="linenum">  95</span></a>  <span class="comment">     * @return string the dataroot.</span>
<a name="l96"><span class="linenum">  96</span></a>  <span class="comment">     */</span>
<a name="l97"><span class="linenum">  97</span></a>      public static function <a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>() {
<a name="l98"><span class="linenum">  98</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>;
<a name="l99"><span class="linenum">  99</span></a>  
<a name="l100"><span class="linenum"> 100</span></a>  <span class="comment">        //  By default it's the test framework dataroot.</span>
<a name="l101"><span class="linenum"> 101</span></a>          if (empty(self::<a class="var it68" onMouseOver="hilite(68)" onMouseOut="lolite()" onClick="logVariable('dataroot')" href="../../../_variables/dataroot.html">$dataroot</a>)) {
<a name="l102"><span class="linenum"> 102</span></a>              self::<a class="var it68" onMouseOver="hilite(68)" onMouseOut="lolite()" onClick="logVariable('dataroot')" href="../../../_variables/dataroot.html">$dataroot</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dataroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../../_variables/dataroot.html">dataroot</a>;
<a name="l103"><span class="linenum"> 103</span></a>          }
<a name="l104"><span class="linenum"> 104</span></a>  
<a name="l105"><span class="linenum"> 105</span></a>          return self::<a class="var it68" onMouseOver="hilite(68)" onMouseOut="lolite()" onClick="logVariable('dataroot')" href="../../../_variables/dataroot.html">$dataroot</a>;
<a name="l106"><span class="linenum"> 106</span></a>      }
<a name="l107"><span class="linenum"> 107</span></a>  
<a name="l108"><span class="linenum"> 108</span></a>      <span class="comment">/**</span>
<a name="l109"><span class="linenum"> 109</span></a>  <span class="comment">     * Set the dataroot. It's useful when mocking the dataroot when unit testing this class itself.</span>
<a name="l110"><span class="linenum"> 110</span></a>  <span class="comment">     *</span>
<a name="l111"><span class="linenum"> 111</span></a>  <span class="comment">     * @param string $dataroot the dataroot of the test framework.</span>
<a name="l112"><span class="linenum"> 112</span></a>  <span class="comment">     * @static</span>
<a name="l113"><span class="linenum"> 113</span></a>  <span class="comment">     */</span>
<a name="l114"><span class="linenum"> 114</span></a>      public static function <a class="function" onClick="logFunction('set_dataroot')" href="../../../_functions/set_dataroot.html" onMouseOver="funcPopup(event,'set_dataroot')">set_dataroot</a>(<a class="var it68" onMouseOver="hilite(68)" onMouseOut="lolite()" onClick="logVariable('dataroot')" href="../../../_variables/dataroot.html">$dataroot</a>) {
<a name="l115"><span class="linenum"> 115</span></a>          self::<a class="var it68" onMouseOver="hilite(68)" onMouseOut="lolite()" onClick="logVariable('dataroot')" href="../../../_variables/dataroot.html">$dataroot</a> = <a class="var it68" onMouseOver="hilite(68)" onMouseOut="lolite()" onClick="logVariable('dataroot')" href="../../../_variables/dataroot.html">$dataroot</a>;
<a name="l116"><span class="linenum"> 116</span></a>      }
<a name="l117"><span class="linenum"> 117</span></a>  
<a name="l118"><span class="linenum"> 118</span></a>      <span class="comment">/**</span>
<a name="l119"><span class="linenum"> 119</span></a>  <span class="comment">     * Returns the testing framework name</span>
<a name="l120"><span class="linenum"> 120</span></a>  <span class="comment">     * @static</span>
<a name="l121"><span class="linenum"> 121</span></a>  <span class="comment">     * @return string</span>
<a name="l122"><span class="linenum"> 122</span></a>  <span class="comment">     */</span>
<a name="l123"><span class="linenum"> 123</span></a>      protected static final function <a class="function" onClick="logFunction('get_framework')" href="../../../_functions/get_framework.html" onMouseOver="funcPopup(event,'get_framework')">get_framework</a>() {
<a name="l124"><span class="linenum"> 124</span></a>          <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a> = get_called_class();
<a name="l125"><span class="linenum"> 125</span></a>          return <a class="phpfunction" onClick="logFunction('substr')" href="../../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>, 0, <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../../_variables/classname.html">$classname</a>, '_'));
<a name="l126"><span class="linenum"> 126</span></a>      }
<a name="l127"><span class="linenum"> 127</span></a>  
<a name="l128"><span class="linenum"> 128</span></a>      <span class="comment">/**</span>
<a name="l129"><span class="linenum"> 129</span></a>  <span class="comment">     * Get data generator</span>
<a name="l130"><span class="linenum"> 130</span></a>  <span class="comment">     * @static</span>
<a name="l131"><span class="linenum"> 131</span></a>  <span class="comment">     * @return testing_data_generator</span>
<a name="l132"><span class="linenum"> 132</span></a>  <span class="comment">     */</span>
<a name="l133"><span class="linenum"> 133</span></a>      public static function <a class="function" onClick="logFunction('get_data_generator')" href="../../../_functions/get_data_generator.html" onMouseOver="funcPopup(event,'get_data_generator')">get_data_generator</a>() {
<a name="l134"><span class="linenum"> 134</span></a>          if (<a class="phpfunction" onClick="logFunction('is_null')" href="../../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(self::<a class="var it1064" onMouseOver="hilite(1064)" onMouseOut="lolite()" onClick="logVariable('generator')" href="../../../_variables/generator.html">$generator</a>)) {
<a name="l135"><span class="linenum"> 135</span></a>              <span class="keyword">require_once</span> <a class="filename" href="../../../lib/testing/generator/lib.php.html" onMouseOver="reqPopup(event, 'lib.php', '../../../lib/testing/generator/lib.php')">(__DIR__.'/../generator/lib.php')</a>;
<a name="l136"><span class="linenum"> 136</span></a>              self::<a class="var it1064" onMouseOver="hilite(1064)" onMouseOut="lolite()" onClick="logVariable('generator')" href="../../../_variables/generator.html">$generator</a> = <span class="keyword">new </span><a class="class" onClick="logClass('testing_data_generator')" href="../../../_classes/testing_data_generator.html" onMouseOver="classPopup(event,'testing_data_generator')">testing_data_generator</a>();
<a name="l137"><span class="linenum"> 137</span></a>          }
<a name="l138"><span class="linenum"> 138</span></a>          return self::<a class="var it1064" onMouseOver="hilite(1064)" onMouseOut="lolite()" onClick="logVariable('generator')" href="../../../_variables/generator.html">$generator</a>;
<a name="l139"><span class="linenum"> 139</span></a>      }
<a name="l140"><span class="linenum"> 140</span></a>  
<a name="l141"><span class="linenum"> 141</span></a>      <span class="comment">/**</span>
<a name="l142"><span class="linenum"> 142</span></a>  <span class="comment">     * Does this site (db and dataroot) appear to be used for production?</span>
<a name="l143"><span class="linenum"> 143</span></a>  <span class="comment">     * We try very hard to prevent accidental damage done to production servers!!</span>
<a name="l144"><span class="linenum"> 144</span></a>  <span class="comment">     *</span>
<a name="l145"><span class="linenum"> 145</span></a>  <span class="comment">     * @static</span>
<a name="l146"><span class="linenum"> 146</span></a>  <span class="comment">     * @return bool</span>
<a name="l147"><span class="linenum"> 147</span></a>  <span class="comment">     */</span>
<a name="l148"><span class="linenum"> 148</span></a>      public static function <a class="function" onClick="logFunction('is_test_site')" href="../../../_functions/is_test_site.html" onMouseOver="funcPopup(event,'is_test_site')">is_test_site</a>() {
<a name="l149"><span class="linenum"> 149</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>;
<a name="l150"><span class="linenum"> 150</span></a>  
<a name="l151"><span class="linenum"> 151</span></a>          <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a> = self::<a class="function" onClick="logFunction('get_framework')" href="../../../_functions/get_framework.html" onMouseOver="funcPopup(event,'get_framework')">get_framework</a>();
<a name="l152"><span class="linenum"> 152</span></a>  
<a name="l153"><span class="linenum"> 153</span></a>          if (!<a class="phpfunction" onClick="logFunction('file_exists')" href="../../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>() . '/' . <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a> . 'testdir.txt')) {
<a name="l154"><span class="linenum"> 154</span></a>  <span class="comment">            // this is already tested in bootstrap script,</span>
<a name="l155"><span class="linenum"> 155</span></a>  <span class="comment">            // but anyway presence of this file means the dataroot is for testing</span>
<a name="l156"><span class="linenum"> 156</span></a>              return false;
<a name="l157"><span class="linenum"> 157</span></a>          }
<a name="l158"><span class="linenum"> 158</span></a>  
<a name="l159"><span class="linenum"> 159</span></a>          <a class="var it448" onMouseOver="hilite(448)" onMouseOut="lolite()" onClick="logVariable('tables')" href="../../../_variables/tables.html">$tables</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_tables')" href="../../../_functions/get_tables.html" onMouseOver="funcPopup(event,'get_tables')">get_tables</a>(false);
<a name="l160"><span class="linenum"> 160</span></a>          if (<a class="var it448" onMouseOver="hilite(448)" onMouseOut="lolite()" onClick="logVariable('tables')" href="../../../_variables/tables.html">$tables</a>) {
<a name="l161"><span class="linenum"> 161</span></a>              if (!<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_manager')" href="../../../_functions/get_manager.html" onMouseOver="funcPopup(event,'get_manager')">get_manager</a>()-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>('config')) {
<a name="l162"><span class="linenum"> 162</span></a>                  return false;
<a name="l163"><span class="linenum"> 163</span></a>              }
<a name="l164"><span class="linenum"> 164</span></a>              if (!<a class="function" onClick="logFunction('get_config')" href="../../../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>('core', <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a> . 'test')) {
<a name="l165"><span class="linenum"> 165</span></a>                  return false;
<a name="l166"><span class="linenum"> 166</span></a>              }
<a name="l167"><span class="linenum"> 167</span></a>          }
<a name="l168"><span class="linenum"> 168</span></a>  
<a name="l169"><span class="linenum"> 169</span></a>          return true;
<a name="l170"><span class="linenum"> 170</span></a>      }
<a name="l171"><span class="linenum"> 171</span></a>  
<a name="l172"><span class="linenum"> 172</span></a>      <span class="comment">/**</span>
<a name="l173"><span class="linenum"> 173</span></a>  <span class="comment">     * Returns whether test database and dataroot were created using the current version codebase</span>
<a name="l174"><span class="linenum"> 174</span></a>  <span class="comment">     *</span>
<a name="l175"><span class="linenum"> 175</span></a>  <span class="comment">     * @return bool</span>
<a name="l176"><span class="linenum"> 176</span></a>  <span class="comment">     */</span>
<a name="l177"><span class="linenum"> 177</span></a>      public static function <a class="function" onClick="logFunction('is_test_data_updated')" href="../../../_functions/is_test_data_updated.html" onMouseOver="funcPopup(event,'is_test_data_updated')">is_test_data_updated</a>() {
<a name="l178"><span class="linenum"> 178</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>;
<a name="l179"><span class="linenum"> 179</span></a>  
<a name="l180"><span class="linenum"> 180</span></a>          <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a> = self::<a class="function" onClick="logFunction('get_framework')" href="../../../_functions/get_framework.html" onMouseOver="funcPopup(event,'get_framework')">get_framework</a>();
<a name="l181"><span class="linenum"> 181</span></a>  
<a name="l182"><span class="linenum"> 182</span></a>          <a class="var it993" onMouseOver="hilite(993)" onMouseOut="lolite()" onClick="logVariable('datarootpath')" href="../../../_variables/datarootpath.html">$datarootpath</a> = self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>() . '/' . <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a>;
<a name="l183"><span class="linenum"> 183</span></a>          if (!<a class="phpfunction" onClick="logFunction('file_exists')" href="../../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it993" onMouseOver="hilite(993)" onMouseOut="lolite()" onClick="logVariable('datarootpath')" href="../../../_variables/datarootpath.html">$datarootpath</a> . '/tabledata.ser') or !<a class="phpfunction" onClick="logFunction('file_exists')" href="../../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it993" onMouseOver="hilite(993)" onMouseOut="lolite()" onClick="logVariable('datarootpath')" href="../../../_variables/datarootpath.html">$datarootpath</a> . '/tablestructure.ser')) {
<a name="l184"><span class="linenum"> 184</span></a>              return false;
<a name="l185"><span class="linenum"> 185</span></a>          }
<a name="l186"><span class="linenum"> 186</span></a>  
<a name="l187"><span class="linenum"> 187</span></a>          if (!<a class="phpfunction" onClick="logFunction('file_exists')" href="../../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it993" onMouseOver="hilite(993)" onMouseOut="lolite()" onClick="logVariable('datarootpath')" href="../../../_variables/datarootpath.html">$datarootpath</a> . '/versionshash.txt')) {
<a name="l188"><span class="linenum"> 188</span></a>              return false;
<a name="l189"><span class="linenum"> 189</span></a>          }
<a name="l190"><span class="linenum"> 190</span></a>  
<a name="l191"><span class="linenum"> 191</span></a>          <a class="var it6788" onMouseOver="hilite(6788)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../../../_variables/hash.html">$hash</a> = <a class="class" onClick="logClass('core_component')" href="../../../_classes/core_component.html" onMouseOver="classPopup(event,'core_component')">core_component</a>::<a class="function" onClick="logFunction('get_all_versions_hash')" href="../../../_functions/get_all_versions_hash.html" onMouseOver="funcPopup(event,'get_all_versions_hash')">get_all_versions_hash</a>();
<a name="l192"><span class="linenum"> 192</span></a>          <a class="var it26640" onMouseOver="hilite(26640)" onMouseOut="lolite()" onClick="logVariable('oldhash')" href="../../../_variables/oldhash.html">$oldhash</a> = <a class="phpfunction" onClick="logFunction('file_get_contents')" href="../../../_functions/file_get_contents.html" onMouseOver="phpfuncPopup(event,'file_get_contents')">file_get_contents</a>(<a class="var it993" onMouseOver="hilite(993)" onMouseOut="lolite()" onClick="logVariable('datarootpath')" href="../../../_variables/datarootpath.html">$datarootpath</a> . '/versionshash.txt');
<a name="l193"><span class="linenum"> 193</span></a>  
<a name="l194"><span class="linenum"> 194</span></a>          if (<a class="var it6788" onMouseOver="hilite(6788)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../../../_variables/hash.html">$hash</a> !== <a class="var it26640" onMouseOver="hilite(26640)" onMouseOut="lolite()" onClick="logVariable('oldhash')" href="../../../_variables/oldhash.html">$oldhash</a>) {
<a name="l195"><span class="linenum"> 195</span></a>              return false;
<a name="l196"><span class="linenum"> 196</span></a>          }
<a name="l197"><span class="linenum"> 197</span></a>  
<a name="l198"><span class="linenum"> 198</span></a>          <a class="var it25856" onMouseOver="hilite(25856)" onMouseOut="lolite()" onClick="logVariable('dbhash')" href="../../../_variables/dbhash.html">$dbhash</a> = <a class="function" onClick="logFunction('get_config')" href="../../../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>('core', <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a> . 'test');
<a name="l199"><span class="linenum"> 199</span></a>          if (<a class="var it6788" onMouseOver="hilite(6788)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../../../_variables/hash.html">$hash</a> !== <a class="var it25856" onMouseOver="hilite(25856)" onMouseOut="lolite()" onClick="logVariable('dbhash')" href="../../../_variables/dbhash.html">$dbhash</a>) {
<a name="l200"><span class="linenum"> 200</span></a>              return false;
<a name="l201"><span class="linenum"> 201</span></a>          }
<a name="l202"><span class="linenum"> 202</span></a>  
<a name="l203"><span class="linenum"> 203</span></a>          return true;
<a name="l204"><span class="linenum"> 204</span></a>      }
<a name="l205"><span class="linenum"> 205</span></a>  
<a name="l206"><span class="linenum"> 206</span></a>      <span class="comment">/**</span>
<a name="l207"><span class="linenum"> 207</span></a>  <span class="comment">     * Stores the status of the database</span>
<a name="l208"><span class="linenum"> 208</span></a>  <span class="comment">     *</span>
<a name="l209"><span class="linenum"> 209</span></a>  <span class="comment">     * Serializes the contents and the structure and</span>
<a name="l210"><span class="linenum"> 210</span></a>  <span class="comment">     * stores it in the test framework space in dataroot</span>
<a name="l211"><span class="linenum"> 211</span></a>  <span class="comment">     */</span>
<a name="l212"><span class="linenum"> 212</span></a>      protected static function <a class="function" onClick="logFunction('store_database_state')" href="../../../_functions/store_database_state.html" onMouseOver="funcPopup(event,'store_database_state')">store_database_state</a>() {
<a name="l213"><span class="linenum"> 213</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>;
<a name="l214"><span class="linenum"> 214</span></a>  
<a name="l215"><span class="linenum"> 215</span></a>          <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a> = self::<a class="function" onClick="logFunction('get_framework')" href="../../../_functions/get_framework.html" onMouseOver="funcPopup(event,'get_framework')">get_framework</a>();
<a name="l216"><span class="linenum"> 216</span></a>  
<a name="l217"><span class="linenum"> 217</span></a>  <span class="comment">        // store data for all tables</span>
<a name="l218"><span class="linenum"> 218</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a> = array();
<a name="l219"><span class="linenum"> 219</span></a>          <a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a> = array();
<a name="l220"><span class="linenum"> 220</span></a>          <a class="var it448" onMouseOver="hilite(448)" onMouseOut="lolite()" onClick="logVariable('tables')" href="../../../_variables/tables.html">$tables</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_tables')" href="../../../_functions/get_tables.html" onMouseOver="funcPopup(event,'get_tables')">get_tables</a>();
<a name="l221"><span class="linenum"> 221</span></a>          foreach (<a class="var it448" onMouseOver="hilite(448)" onMouseOut="lolite()" onClick="logVariable('tables')" href="../../../_variables/tables.html">$tables</a> as <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>) {
<a name="l222"><span class="linenum"> 222</span></a>              <a class="var it1020" onMouseOver="hilite(1020)" onMouseOut="lolite()" onClick="logVariable('columns')" href="../../../_variables/columns.html">$columns</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_columns')" href="../../../_functions/get_columns.html" onMouseOver="funcPopup(event,'get_columns')">get_columns</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>);
<a name="l223"><span class="linenum"> 223</span></a>              <a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>] = <a class="var it1020" onMouseOver="hilite(1020)" onMouseOut="lolite()" onClick="logVariable('columns')" href="../../../_variables/columns.html">$columns</a>;
<a name="l224"><span class="linenum"> 224</span></a>              if (isset(<a class="var it1020" onMouseOver="hilite(1020)" onMouseOut="lolite()" onClick="logVariable('columns')" href="../../../_variables/columns.html">$columns</a>['id']) and <a class="var it1020" onMouseOver="hilite(1020)" onMouseOut="lolite()" onClick="logVariable('columns')" href="../../../_variables/columns.html">$columns</a>['id']-&gt;auto_increment) {
<a name="l225"><span class="linenum"> 225</span></a>                  <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>] = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>, array(), 'id ASC');
<a name="l226"><span class="linenum"> 226</span></a>              } else {
<a name="l227"><span class="linenum"> 227</span></a>  <span class="comment">                // there should not be many of these</span>
<a name="l228"><span class="linenum"> 228</span></a>                  <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>] = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>, array());
<a name="l229"><span class="linenum"> 229</span></a>              }
<a name="l230"><span class="linenum"> 230</span></a>          }
<a name="l231"><span class="linenum"> 231</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a> = <a class="phpfunction" onClick="logFunction('serialize')" href="../../../_functions/serialize.html" onMouseOver="phpfuncPopup(event,'serialize')">serialize</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a>);
<a name="l232"><span class="linenum"> 232</span></a>          <a class="var it24811" onMouseOver="hilite(24811)" onMouseOut="lolite()" onClick="logVariable('datafile')" href="../../../_variables/datafile.html">$datafile</a> = self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>() . '/' . <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a> . '/tabledata.ser';
<a name="l233"><span class="linenum"> 233</span></a>          <a class="phpfunction" onClick="logFunction('file_put_contents')" href="../../../_functions/file_put_contents.html" onMouseOver="phpfuncPopup(event,'file_put_contents')">file_put_contents</a>(<a class="var it24811" onMouseOver="hilite(24811)" onMouseOut="lolite()" onClick="logVariable('datafile')" href="../../../_variables/datafile.html">$datafile</a>, <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a>);
<a name="l234"><span class="linenum"> 234</span></a>          <a class="function" onClick="logFunction('testing_fix_file_permissions')" href="../../../_functions/testing_fix_file_permissions.html" onMouseOver="funcPopup(event,'testing_fix_file_permissions')">testing_fix_file_permissions</a>(<a class="var it24811" onMouseOver="hilite(24811)" onMouseOut="lolite()" onClick="logVariable('datafile')" href="../../../_variables/datafile.html">$datafile</a>);
<a name="l235"><span class="linenum"> 235</span></a>  
<a name="l236"><span class="linenum"> 236</span></a>          <a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a> = <a class="phpfunction" onClick="logFunction('serialize')" href="../../../_functions/serialize.html" onMouseOver="phpfuncPopup(event,'serialize')">serialize</a>(<a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a>);
<a name="l237"><span class="linenum"> 237</span></a>          <a class="var it8030" onMouseOver="hilite(8030)" onMouseOut="lolite()" onClick="logVariable('structurefile')" href="../../../_variables/structurefile.html">$structurefile</a> = self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>() . '/' . <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a> . '/tablestructure.ser';
<a name="l238"><span class="linenum"> 238</span></a>          <a class="phpfunction" onClick="logFunction('file_put_contents')" href="../../../_functions/file_put_contents.html" onMouseOver="phpfuncPopup(event,'file_put_contents')">file_put_contents</a>(<a class="var it8030" onMouseOver="hilite(8030)" onMouseOut="lolite()" onClick="logVariable('structurefile')" href="../../../_variables/structurefile.html">$structurefile</a>, <a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a>);
<a name="l239"><span class="linenum"> 239</span></a>          <a class="function" onClick="logFunction('testing_fix_file_permissions')" href="../../../_functions/testing_fix_file_permissions.html" onMouseOver="funcPopup(event,'testing_fix_file_permissions')">testing_fix_file_permissions</a>(<a class="var it8030" onMouseOver="hilite(8030)" onMouseOut="lolite()" onClick="logVariable('structurefile')" href="../../../_variables/structurefile.html">$structurefile</a>);
<a name="l240"><span class="linenum"> 240</span></a>      }
<a name="l241"><span class="linenum"> 241</span></a>  
<a name="l242"><span class="linenum"> 242</span></a>      <span class="comment">/**</span>
<a name="l243"><span class="linenum"> 243</span></a>  <span class="comment">     * Stores the version hash in both database and dataroot</span>
<a name="l244"><span class="linenum"> 244</span></a>  <span class="comment">     */</span>
<a name="l245"><span class="linenum"> 245</span></a>      protected static function <a class="function" onClick="logFunction('store_versions_hash')" href="../../../_functions/store_versions_hash.html" onMouseOver="funcPopup(event,'store_versions_hash')">store_versions_hash</a>() {
<a name="l246"><span class="linenum"> 246</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>;
<a name="l247"><span class="linenum"> 247</span></a>  
<a name="l248"><span class="linenum"> 248</span></a>          <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a> = self::<a class="function" onClick="logFunction('get_framework')" href="../../../_functions/get_framework.html" onMouseOver="funcPopup(event,'get_framework')">get_framework</a>();
<a name="l249"><span class="linenum"> 249</span></a>          <a class="var it6788" onMouseOver="hilite(6788)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../../../_variables/hash.html">$hash</a> = <a class="class" onClick="logClass('core_component')" href="../../../_classes/core_component.html" onMouseOver="classPopup(event,'core_component')">core_component</a>::<a class="function" onClick="logFunction('get_all_versions_hash')" href="../../../_functions/get_all_versions_hash.html" onMouseOver="funcPopup(event,'get_all_versions_hash')">get_all_versions_hash</a>();
<a name="l250"><span class="linenum"> 250</span></a>  
<a name="l251"><span class="linenum"> 251</span></a>  <span class="comment">        // add test db flag</span>
<a name="l252"><span class="linenum"> 252</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>(<a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a> . 'test', <a class="var it6788" onMouseOver="hilite(6788)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../../../_variables/hash.html">$hash</a>);
<a name="l253"><span class="linenum"> 253</span></a>  
<a name="l254"><span class="linenum"> 254</span></a>  <span class="comment">        // hash all plugin versions - helps with very fast detection of db structure changes</span>
<a name="l255"><span class="linenum"> 255</span></a>          <a class="var it22585" onMouseOver="hilite(22585)" onMouseOut="lolite()" onClick="logVariable('hashfile')" href="../../../_variables/hashfile.html">$hashfile</a> = self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>() . '/' . <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a> . '/versionshash.txt';
<a name="l256"><span class="linenum"> 256</span></a>          <a class="phpfunction" onClick="logFunction('file_put_contents')" href="../../../_functions/file_put_contents.html" onMouseOver="phpfuncPopup(event,'file_put_contents')">file_put_contents</a>(<a class="var it22585" onMouseOver="hilite(22585)" onMouseOut="lolite()" onClick="logVariable('hashfile')" href="../../../_variables/hashfile.html">$hashfile</a>, <a class="var it6788" onMouseOver="hilite(6788)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../../../_variables/hash.html">$hash</a>);
<a name="l257"><span class="linenum"> 257</span></a>          <a class="function" onClick="logFunction('testing_fix_file_permissions')" href="../../../_functions/testing_fix_file_permissions.html" onMouseOver="funcPopup(event,'testing_fix_file_permissions')">testing_fix_file_permissions</a>(<a class="var it22585" onMouseOver="hilite(22585)" onMouseOut="lolite()" onClick="logVariable('hashfile')" href="../../../_variables/hashfile.html">$hashfile</a>);
<a name="l258"><span class="linenum"> 258</span></a>      }
<a name="l259"><span class="linenum"> 259</span></a>  
<a name="l260"><span class="linenum"> 260</span></a>      <span class="comment">/**</span>
<a name="l261"><span class="linenum"> 261</span></a>  <span class="comment">     * Returns contents of all tables right after installation.</span>
<a name="l262"><span class="linenum"> 262</span></a>  <span class="comment">     * @static</span>
<a name="l263"><span class="linenum"> 263</span></a>  <span class="comment">     * @return array  $table=&gt;$records</span>
<a name="l264"><span class="linenum"> 264</span></a>  <span class="comment">     */</span>
<a name="l265"><span class="linenum"> 265</span></a>      protected static function <a class="function" onClick="logFunction('get_tabledata')" href="../../../_functions/get_tabledata.html" onMouseOver="funcPopup(event,'get_tabledata')">get_tabledata</a>() {
<a name="l266"><span class="linenum"> 266</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>;
<a name="l267"><span class="linenum"> 267</span></a>  
<a name="l268"><span class="linenum"> 268</span></a>          <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a> = self::<a class="function" onClick="logFunction('get_framework')" href="../../../_functions/get_framework.html" onMouseOver="funcPopup(event,'get_framework')">get_framework</a>();
<a name="l269"><span class="linenum"> 269</span></a>  
<a name="l270"><span class="linenum"> 270</span></a>          <a class="var it24811" onMouseOver="hilite(24811)" onMouseOut="lolite()" onClick="logVariable('datafile')" href="../../../_variables/datafile.html">$datafile</a> = self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>() . '/' . <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a> . '/tabledata.ser';
<a name="l271"><span class="linenum"> 271</span></a>          if (!<a class="phpfunction" onClick="logFunction('file_exists')" href="../../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it24811" onMouseOver="hilite(24811)" onMouseOut="lolite()" onClick="logVariable('datafile')" href="../../../_variables/datafile.html">$datafile</a>)) {
<a name="l272"><span class="linenum"> 272</span></a>  <span class="comment">            // Not initialised yet.</span>
<a name="l273"><span class="linenum"> 273</span></a>              return array();
<a name="l274"><span class="linenum"> 274</span></a>          }
<a name="l275"><span class="linenum"> 275</span></a>  
<a name="l276"><span class="linenum"> 276</span></a>          if (!isset(self::<a class="var it2629" onMouseOver="hilite(2629)" onMouseOut="lolite()" onClick="logVariable('tabledata')" href="../../../_variables/tabledata.html">$tabledata</a>)) {
<a name="l277"><span class="linenum"> 277</span></a>              <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a> = <a class="phpfunction" onClick="logFunction('file_get_contents')" href="../../../_functions/file_get_contents.html" onMouseOver="phpfuncPopup(event,'file_get_contents')">file_get_contents</a>(<a class="var it24811" onMouseOver="hilite(24811)" onMouseOut="lolite()" onClick="logVariable('datafile')" href="../../../_variables/datafile.html">$datafile</a>);
<a name="l278"><span class="linenum"> 278</span></a>              self::<a class="var it2629" onMouseOver="hilite(2629)" onMouseOut="lolite()" onClick="logVariable('tabledata')" href="../../../_variables/tabledata.html">$tabledata</a> = <a class="phpfunction" onClick="logFunction('unserialize')" href="../../../_functions/unserialize.html" onMouseOver="phpfuncPopup(event,'unserialize')">unserialize</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a>);
<a name="l279"><span class="linenum"> 279</span></a>          }
<a name="l280"><span class="linenum"> 280</span></a>  
<a name="l281"><span class="linenum"> 281</span></a>          if (!<a class="phpfunction" onClick="logFunction('is_array')" href="../../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(self::<a class="var it2629" onMouseOver="hilite(2629)" onMouseOut="lolite()" onClick="logVariable('tabledata')" href="../../../_variables/tabledata.html">$tabledata</a>)) {
<a name="l282"><span class="linenum"> 282</span></a>              <a class="function" onClick="logFunction('testing_error')" href="../../../_functions/testing_error.html" onMouseOver="funcPopup(event,'testing_error')">testing_error</a>(1, 'Can not read dataroot/' . <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a> . '/tabledata.ser or invalid format, reinitialize test database.');
<a name="l283"><span class="linenum"> 283</span></a>          }
<a name="l284"><span class="linenum"> 284</span></a>  
<a name="l285"><span class="linenum"> 285</span></a>          return self::<a class="var it2629" onMouseOver="hilite(2629)" onMouseOut="lolite()" onClick="logVariable('tabledata')" href="../../../_variables/tabledata.html">$tabledata</a>;
<a name="l286"><span class="linenum"> 286</span></a>      }
<a name="l287"><span class="linenum"> 287</span></a>  
<a name="l288"><span class="linenum"> 288</span></a>      <span class="comment">/**</span>
<a name="l289"><span class="linenum"> 289</span></a>  <span class="comment">     * Returns structure of all tables right after installation.</span>
<a name="l290"><span class="linenum"> 290</span></a>  <span class="comment">     * @static</span>
<a name="l291"><span class="linenum"> 291</span></a>  <span class="comment">     * @return array $table=&gt;$records</span>
<a name="l292"><span class="linenum"> 292</span></a>  <span class="comment">     */</span>
<a name="l293"><span class="linenum"> 293</span></a>      public static function <a class="function" onClick="logFunction('get_tablestructure')" href="../../../_functions/get_tablestructure.html" onMouseOver="funcPopup(event,'get_tablestructure')">get_tablestructure</a>() {
<a name="l294"><span class="linenum"> 294</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>;
<a name="l295"><span class="linenum"> 295</span></a>  
<a name="l296"><span class="linenum"> 296</span></a>          <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a> = self::<a class="function" onClick="logFunction('get_framework')" href="../../../_functions/get_framework.html" onMouseOver="funcPopup(event,'get_framework')">get_framework</a>();
<a name="l297"><span class="linenum"> 297</span></a>  
<a name="l298"><span class="linenum"> 298</span></a>          <a class="var it8030" onMouseOver="hilite(8030)" onMouseOut="lolite()" onClick="logVariable('structurefile')" href="../../../_variables/structurefile.html">$structurefile</a> = self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>() . '/' . <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a> . '/tablestructure.ser';
<a name="l299"><span class="linenum"> 299</span></a>          if (!<a class="phpfunction" onClick="logFunction('file_exists')" href="../../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it8030" onMouseOver="hilite(8030)" onMouseOut="lolite()" onClick="logVariable('structurefile')" href="../../../_variables/structurefile.html">$structurefile</a>)) {
<a name="l300"><span class="linenum"> 300</span></a>  <span class="comment">            // Not initialised yet.</span>
<a name="l301"><span class="linenum"> 301</span></a>              return array();
<a name="l302"><span class="linenum"> 302</span></a>          }
<a name="l303"><span class="linenum"> 303</span></a>  
<a name="l304"><span class="linenum"> 304</span></a>          if (!isset(self::<a class="var it39190" onMouseOver="hilite(39190)" onMouseOut="lolite()" onClick="logVariable('tablestructure')" href="../../../_variables/tablestructure.html">$tablestructure</a>)) {
<a name="l305"><span class="linenum"> 305</span></a>              <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a> = <a class="phpfunction" onClick="logFunction('file_get_contents')" href="../../../_functions/file_get_contents.html" onMouseOver="phpfuncPopup(event,'file_get_contents')">file_get_contents</a>(<a class="var it8030" onMouseOver="hilite(8030)" onMouseOut="lolite()" onClick="logVariable('structurefile')" href="../../../_variables/structurefile.html">$structurefile</a>);
<a name="l306"><span class="linenum"> 306</span></a>              self::<a class="var it39190" onMouseOver="hilite(39190)" onMouseOut="lolite()" onClick="logVariable('tablestructure')" href="../../../_variables/tablestructure.html">$tablestructure</a> = <a class="phpfunction" onClick="logFunction('unserialize')" href="../../../_functions/unserialize.html" onMouseOver="phpfuncPopup(event,'unserialize')">unserialize</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a>);
<a name="l307"><span class="linenum"> 307</span></a>          }
<a name="l308"><span class="linenum"> 308</span></a>  
<a name="l309"><span class="linenum"> 309</span></a>          if (!<a class="phpfunction" onClick="logFunction('is_array')" href="../../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(self::<a class="var it39190" onMouseOver="hilite(39190)" onMouseOut="lolite()" onClick="logVariable('tablestructure')" href="../../../_variables/tablestructure.html">$tablestructure</a>)) {
<a name="l310"><span class="linenum"> 310</span></a>              <a class="function" onClick="logFunction('testing_error')" href="../../../_functions/testing_error.html" onMouseOver="funcPopup(event,'testing_error')">testing_error</a>(1, 'Can not read dataroot/' . <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a> . '/tablestructure.ser or invalid format, reinitialize test database.');
<a name="l311"><span class="linenum"> 311</span></a>          }
<a name="l312"><span class="linenum"> 312</span></a>  
<a name="l313"><span class="linenum"> 313</span></a>          return self::<a class="var it39190" onMouseOver="hilite(39190)" onMouseOut="lolite()" onClick="logVariable('tablestructure')" href="../../../_variables/tablestructure.html">$tablestructure</a>;
<a name="l314"><span class="linenum"> 314</span></a>      }
<a name="l315"><span class="linenum"> 315</span></a>  
<a name="l316"><span class="linenum"> 316</span></a>      <span class="comment">/**</span>
<a name="l317"><span class="linenum"> 317</span></a>  <span class="comment">     * Returns the names of sequences for each autoincrementing id field in all standard tables.</span>
<a name="l318"><span class="linenum"> 318</span></a>  <span class="comment">     * @static</span>
<a name="l319"><span class="linenum"> 319</span></a>  <span class="comment">     * @return array $table=&gt;$sequencename</span>
<a name="l320"><span class="linenum"> 320</span></a>  <span class="comment">     */</span>
<a name="l321"><span class="linenum"> 321</span></a>      public static function <a class="function" onClick="logFunction('get_sequencenames')" href="../../../_functions/get_sequencenames.html" onMouseOver="funcPopup(event,'get_sequencenames')">get_sequencenames</a>() {
<a name="l322"><span class="linenum"> 322</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l323"><span class="linenum"> 323</span></a>  
<a name="l324"><span class="linenum"> 324</span></a>          if (isset(self::<a class="var it39191" onMouseOver="hilite(39191)" onMouseOut="lolite()" onClick="logVariable('sequencenames')" href="../../../_variables/sequencenames.html">$sequencenames</a>)) {
<a name="l325"><span class="linenum"> 325</span></a>              return self::<a class="var it39191" onMouseOver="hilite(39191)" onMouseOut="lolite()" onClick="logVariable('sequencenames')" href="../../../_variables/sequencenames.html">$sequencenames</a>;
<a name="l326"><span class="linenum"> 326</span></a>          }
<a name="l327"><span class="linenum"> 327</span></a>  
<a name="l328"><span class="linenum"> 328</span></a>          if (!<a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a> = self::<a class="function" onClick="logFunction('get_tablestructure')" href="../../../_functions/get_tablestructure.html" onMouseOver="funcPopup(event,'get_tablestructure')">get_tablestructure</a>()) {
<a name="l329"><span class="linenum"> 329</span></a>              return array();
<a name="l330"><span class="linenum"> 330</span></a>          }
<a name="l331"><span class="linenum"> 331</span></a>  
<a name="l332"><span class="linenum"> 332</span></a>          self::<a class="var it39191" onMouseOver="hilite(39191)" onMouseOut="lolite()" onClick="logVariable('sequencenames')" href="../../../_variables/sequencenames.html">$sequencenames</a> = array();
<a name="l333"><span class="linenum"> 333</span></a>          foreach (<a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a> as <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a> =&gt; <a class="var it7277" onMouseOver="hilite(7277)" onMouseOut="lolite()" onClick="logVariable('ignored')" href="../../../_variables/ignored.html">$ignored</a>) {
<a name="l334"><span class="linenum"> 334</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../../_variables/name.html">$name</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_manager')" href="../../../_functions/get_manager.html" onMouseOver="funcPopup(event,'get_manager')">get_manager</a>()-&gt;generator-&gt;<a class="function" onClick="logFunction('getSequenceFromDB')" href="../../../_functions/getsequencefromdb.html" onMouseOver="funcPopup(event,'getsequencefromdb')">getSequenceFromDB</a>(<span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>));
<a name="l335"><span class="linenum"> 335</span></a>              if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../../_variables/name.html">$name</a> !== false) {
<a name="l336"><span class="linenum"> 336</span></a>                  self::<a class="var it39191" onMouseOver="hilite(39191)" onMouseOut="lolite()" onClick="logVariable('sequencenames')" href="../../../_variables/sequencenames.html">$sequencenames</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>] = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../../_variables/name.html">$name</a>;
<a name="l337"><span class="linenum"> 337</span></a>              }
<a name="l338"><span class="linenum"> 338</span></a>          }
<a name="l339"><span class="linenum"> 339</span></a>  
<a name="l340"><span class="linenum"> 340</span></a>          return self::<a class="var it39191" onMouseOver="hilite(39191)" onMouseOut="lolite()" onClick="logVariable('sequencenames')" href="../../../_variables/sequencenames.html">$sequencenames</a>;
<a name="l341"><span class="linenum"> 341</span></a>      }
<a name="l342"><span class="linenum"> 342</span></a>  
<a name="l343"><span class="linenum"> 343</span></a>      <span class="comment">/**</span>
<a name="l344"><span class="linenum"> 344</span></a>  <span class="comment">     * Returns list of tables that are unmodified and empty.</span>
<a name="l345"><span class="linenum"> 345</span></a>  <span class="comment">     *</span>
<a name="l346"><span class="linenum"> 346</span></a>  <span class="comment">     * @static</span>
<a name="l347"><span class="linenum"> 347</span></a>  <span class="comment">     * @return array of table names, empty if unknown</span>
<a name="l348"><span class="linenum"> 348</span></a>  <span class="comment">     */</span>
<a name="l349"><span class="linenum"> 349</span></a>      protected static function <a class="function" onClick="logFunction('guess_unmodified_empty_tables')" href="../../../_functions/guess_unmodified_empty_tables.html" onMouseOver="funcPopup(event,'guess_unmodified_empty_tables')">guess_unmodified_empty_tables</a>() {
<a name="l350"><span class="linenum"> 350</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l351"><span class="linenum"> 351</span></a>  
<a name="l352"><span class="linenum"> 352</span></a>          <a class="var it18192" onMouseOver="hilite(18192)" onMouseOut="lolite()" onClick="logVariable('dbfamily')" href="../../../_variables/dbfamily.html">$dbfamily</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_dbfamily')" href="../../../_functions/get_dbfamily.html" onMouseOver="funcPopup(event,'get_dbfamily')">get_dbfamily</a>();
<a name="l353"><span class="linenum"> 353</span></a>  
<a name="l354"><span class="linenum"> 354</span></a>          if (<a class="var it18192" onMouseOver="hilite(18192)" onMouseOut="lolite()" onClick="logVariable('dbfamily')" href="../../../_variables/dbfamily.html">$dbfamily</a> === 'mysql') {
<a name="l355"><span class="linenum"> 355</span></a>              <a class="var it14953" onMouseOver="hilite(14953)" onMouseOut="lolite()" onClick="logVariable('empties')" href="../../../_variables/empties.html">$empties</a> = array();
<a name="l356"><span class="linenum"> 356</span></a>              <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../../_variables/prefix.html">$prefix</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_prefix')" href="../../../_functions/get_prefix.html" onMouseOver="funcPopup(event,'get_prefix')">get_prefix</a>();
<a name="l357"><span class="linenum"> 357</span></a>              <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset_sql')" href="../../../_functions/get_recordset_sql.html" onMouseOver="funcPopup(event,'get_recordset_sql')">get_recordset_sql</a>(&quot;SHOW TABLE STATUS LIKE ?&quot;, array(<a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../../_variables/prefix.html">$prefix</a>.'%'));
<a name="l358"><span class="linenum"> 358</span></a>              foreach (<a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> as <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a>) {
<a name="l359"><span class="linenum"> 359</span></a>                  <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a> = <a class="phpfunction" onClick="logFunction('strtolower')" href="../../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a>-&gt;<a onClick="logVariable('name')" class="var it39470" onMouseOver="hilite(39470)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a>);
<a name="l360"><span class="linenum"> 360</span></a>                  if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>, <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../../_variables/prefix.html">$prefix</a>) !== 0) {
<a name="l361"><span class="linenum"> 361</span></a>  <span class="comment">                    // incorrect table match caused by _</span>
<a name="l362"><span class="linenum"> 362</span></a>                      continue;
<a name="l363"><span class="linenum"> 363</span></a>                  }
<a name="l364"><span class="linenum"> 364</span></a>                  if (!<a class="phpfunction" onClick="logFunction('is_null')" href="../../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a>-&gt;<a onClick="logVariable('auto_increment')" class="var it39470" onMouseOver="hilite(39470)" onMouseOut="lolite()" href="../../../_variables/auto_increment.html">auto_increment</a>)) {
<a name="l365"><span class="linenum"> 365</span></a>                      <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/^'.<a class="phpfunction" onClick="logFunction('preg_quote')" href="../../../_functions/preg_quote.html" onMouseOver="phpfuncPopup(event,'preg_quote')">preg_quote</a>(<a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../../_variables/prefix.html">$prefix</a>, '/').'/', '', <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>);
<a name="l366"><span class="linenum"> 366</span></a>                      if (<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a>-&gt;<a onClick="logVariable('auto_increment')" class="var it39470" onMouseOver="hilite(39470)" onMouseOut="lolite()" href="../../../_variables/auto_increment.html">auto_increment</a> == 1) {
<a name="l367"><span class="linenum"> 367</span></a>                          <a class="var it14953" onMouseOver="hilite(14953)" onMouseOut="lolite()" onClick="logVariable('empties')" href="../../../_variables/empties.html">$empties</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>] = <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>;
<a name="l368"><span class="linenum"> 368</span></a>                      }
<a name="l369"><span class="linenum"> 369</span></a>                  }
<a name="l370"><span class="linenum"> 370</span></a>              }
<a name="l371"><span class="linenum"> 371</span></a>              <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l372"><span class="linenum"> 372</span></a>              return <a class="var it14953" onMouseOver="hilite(14953)" onMouseOut="lolite()" onClick="logVariable('empties')" href="../../../_variables/empties.html">$empties</a>;
<a name="l373"><span class="linenum"> 373</span></a>  
<a name="l374"><span class="linenum"> 374</span></a>          } else if (<a class="var it18192" onMouseOver="hilite(18192)" onMouseOut="lolite()" onClick="logVariable('dbfamily')" href="../../../_variables/dbfamily.html">$dbfamily</a> === 'mssql') {
<a name="l375"><span class="linenum"> 375</span></a>              <a class="var it14953" onMouseOver="hilite(14953)" onMouseOut="lolite()" onClick="logVariable('empties')" href="../../../_variables/empties.html">$empties</a> = array();
<a name="l376"><span class="linenum"> 376</span></a>              <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../../_variables/prefix.html">$prefix</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_prefix')" href="../../../_functions/get_prefix.html" onMouseOver="funcPopup(event,'get_prefix')">get_prefix</a>();
<a name="l377"><span class="linenum"> 377</span></a>              <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a> = &quot;SELECT t.name
<a name="l378"><span class="linenum"> 378</span></a>                        FROM sys.identity_columns i
<a name="l379"><span class="linenum"> 379</span></a>                        JOIN sys.tables t ON t.object_id = i.object_id
<a name="l380"><span class="linenum"> 380</span></a>                       WHERE t.name LIKE ?
<a name="l381"><span class="linenum"> 381</span></a>                         AND i.name = 'id'
<a name="l382"><span class="linenum"> 382</span></a>                         AND i.last_value IS NULL&quot;;
<a name="l383"><span class="linenum"> 383</span></a>              <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset_sql')" href="../../../_functions/get_recordset_sql.html" onMouseOver="funcPopup(event,'get_recordset_sql')">get_recordset_sql</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a>, array(<a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../../_variables/prefix.html">$prefix</a>.'%'));
<a name="l384"><span class="linenum"> 384</span></a>              foreach (<a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> as <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a>) {
<a name="l385"><span class="linenum"> 385</span></a>                  <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a> = <a class="phpfunction" onClick="logFunction('strtolower')" href="../../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a>-&gt;<a onClick="logVariable('name')" class="var it39470" onMouseOver="hilite(39470)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a>);
<a name="l386"><span class="linenum"> 386</span></a>                  if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>, <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../../_variables/prefix.html">$prefix</a>) !== 0) {
<a name="l387"><span class="linenum"> 387</span></a>  <span class="comment">                    // incorrect table match caused by _</span>
<a name="l388"><span class="linenum"> 388</span></a>                      continue;
<a name="l389"><span class="linenum"> 389</span></a>                  }
<a name="l390"><span class="linenum"> 390</span></a>                  <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/^'.<a class="phpfunction" onClick="logFunction('preg_quote')" href="../../../_functions/preg_quote.html" onMouseOver="phpfuncPopup(event,'preg_quote')">preg_quote</a>(<a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../../_variables/prefix.html">$prefix</a>, '/').'/', '', <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>);
<a name="l391"><span class="linenum"> 391</span></a>                  <a class="var it14953" onMouseOver="hilite(14953)" onMouseOut="lolite()" onClick="logVariable('empties')" href="../../../_variables/empties.html">$empties</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>] = <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>;
<a name="l392"><span class="linenum"> 392</span></a>              }
<a name="l393"><span class="linenum"> 393</span></a>              <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l394"><span class="linenum"> 394</span></a>              return <a class="var it14953" onMouseOver="hilite(14953)" onMouseOut="lolite()" onClick="logVariable('empties')" href="../../../_variables/empties.html">$empties</a>;
<a name="l395"><span class="linenum"> 395</span></a>  
<a name="l396"><span class="linenum"> 396</span></a>          } else if (<a class="var it18192" onMouseOver="hilite(18192)" onMouseOut="lolite()" onClick="logVariable('dbfamily')" href="../../../_variables/dbfamily.html">$dbfamily</a> === 'oracle') {
<a name="l397"><span class="linenum"> 397</span></a>              <a class="var it31292" onMouseOver="hilite(31292)" onMouseOut="lolite()" onClick="logVariable('sequences')" href="../../../_variables/sequences.html">$sequences</a> = self::<a class="function" onClick="logFunction('get_sequencenames')" href="../../../_functions/get_sequencenames.html" onMouseOver="funcPopup(event,'get_sequencenames')">get_sequencenames</a>();
<a name="l398"><span class="linenum"> 398</span></a>              <a class="var it31292" onMouseOver="hilite(31292)" onMouseOut="lolite()" onClick="logVariable('sequences')" href="../../../_variables/sequences.html">$sequences</a> = <a class="phpfunction" onClick="logFunction('array_map')" href="../../../_functions/array_map.html" onMouseOver="phpfuncPopup(event,'array_map')">array_map</a>('strtoupper', <a class="var it31292" onMouseOver="hilite(31292)" onMouseOut="lolite()" onClick="logVariable('sequences')" href="../../../_variables/sequences.html">$sequences</a>);
<a name="l399"><span class="linenum"> 399</span></a>              <a class="var it7163" onMouseOver="hilite(7163)" onMouseOut="lolite()" onClick="logVariable('lookup')" href="../../../_variables/lookup.html">$lookup</a> = <a class="phpfunction" onClick="logFunction('array_flip')" href="../../../_functions/array_flip.html" onMouseOver="phpfuncPopup(event,'array_flip')">array_flip</a>(<a class="var it31292" onMouseOver="hilite(31292)" onMouseOut="lolite()" onClick="logVariable('sequences')" href="../../../_variables/sequences.html">$sequences</a>);
<a name="l400"><span class="linenum"> 400</span></a>              <a class="var it14953" onMouseOver="hilite(14953)" onMouseOut="lolite()" onClick="logVariable('empties')" href="../../../_variables/empties.html">$empties</a> = array();
<a name="l401"><span class="linenum"> 401</span></a>              <a class="function" onClick="logFunction('list')" href="../../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it39195" onMouseOver="hilite(39195)" onMouseOut="lolite()" onClick="logVariable('seqs')" href="../../../_variables/seqs.html">$seqs</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>) = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it31292" onMouseOver="hilite(31292)" onMouseOut="lolite()" onClick="logVariable('sequences')" href="../../../_variables/sequences.html">$sequences</a>);
<a name="l402"><span class="linenum"> 402</span></a>              <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a> = &quot;SELECT sequence_name FROM user_sequences WHERE last_number = 1 AND sequence_name <a class="var it39195" onMouseOver="hilite(39195)" onMouseOut="lolite()" onClick="logVariable('seqs')" href="../../../_variables/seqs.html">$seqs</a>&quot;;
<a name="l403"><span class="linenum"> 403</span></a>              <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset_sql')" href="../../../_functions/get_recordset_sql.html" onMouseOver="funcPopup(event,'get_recordset_sql')">get_recordset_sql</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>);
<a name="l404"><span class="linenum"> 404</span></a>              foreach (<a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> as <a class="var it4727" onMouseOver="hilite(4727)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../../_variables/seq.html">$seq</a>) {
<a name="l405"><span class="linenum"> 405</span></a>                  <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a> = <a class="var it7163" onMouseOver="hilite(7163)" onMouseOut="lolite()" onClick="logVariable('lookup')" href="../../../_variables/lookup.html">$lookup</a>[<a class="var it4727" onMouseOver="hilite(4727)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../../_variables/seq.html">$seq</a>-&gt;<a onClick="logVariable('sequence_name')" class="var it40175" onMouseOver="hilite(40175)" onMouseOut="lolite()" href="../../../_variables/sequence_name.html">sequence_name</a>];
<a name="l406"><span class="linenum"> 406</span></a>                  <a class="var it14953" onMouseOver="hilite(14953)" onMouseOut="lolite()" onClick="logVariable('empties')" href="../../../_variables/empties.html">$empties</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>] = <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>;
<a name="l407"><span class="linenum"> 407</span></a>              }
<a name="l408"><span class="linenum"> 408</span></a>              <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l409"><span class="linenum"> 409</span></a>              return <a class="var it14953" onMouseOver="hilite(14953)" onMouseOut="lolite()" onClick="logVariable('empties')" href="../../../_variables/empties.html">$empties</a>;
<a name="l410"><span class="linenum"> 410</span></a>  
<a name="l411"><span class="linenum"> 411</span></a>          } else {
<a name="l412"><span class="linenum"> 412</span></a>              return array();
<a name="l413"><span class="linenum"> 413</span></a>          }
<a name="l414"><span class="linenum"> 414</span></a>      }
<a name="l415"><span class="linenum"> 415</span></a>  
<a name="l416"><span class="linenum"> 416</span></a>      <span class="comment">/**</span>
<a name="l417"><span class="linenum"> 417</span></a>  <span class="comment">     * Determine the next unique starting id sequences.</span>
<a name="l418"><span class="linenum"> 418</span></a>  <span class="comment">     *</span>
<a name="l419"><span class="linenum"> 419</span></a>  <span class="comment">     * @static</span>
<a name="l420"><span class="linenum"> 420</span></a>  <span class="comment">     * @param array $records The records to use to determine the starting value for the table.</span>
<a name="l421"><span class="linenum"> 421</span></a>  <span class="comment">     * @return int The value the sequence should be set to.</span>
<a name="l422"><span class="linenum"> 422</span></a>  <span class="comment">     */</span>
<a name="l423"><span class="linenum"> 423</span></a>      private static function <a class="function" onClick="logFunction('get_next_sequence_starting_value')" href="../../../_functions/get_next_sequence_starting_value.html" onMouseOver="funcPopup(event,'get_next_sequence_starting_value')">get_next_sequence_starting_value</a>(<a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a>) {
<a name="l424"><span class="linenum"> 424</span></a>          <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../_variables/id.html">$id</a> = self::<a class="var it39194" onMouseOver="hilite(39194)" onMouseOut="lolite()" onClick="logVariable('sequencenextstartingid')" href="../../../_variables/sequencenextstartingid.html">$sequencenextstartingid</a>;
<a name="l425"><span class="linenum"> 425</span></a>  
<a name="l426"><span class="linenum"> 426</span></a>  <span class="comment">        // If there are records, calculate the minimum id we can use.</span>
<a name="l427"><span class="linenum"> 427</span></a>  <span class="comment">        // It must be bigger than the last record's id.</span>
<a name="l428"><span class="linenum"> 428</span></a>          if (!empty(<a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a>)) {
<a name="l429"><span class="linenum"> 429</span></a>              <a class="var it35072" onMouseOver="hilite(35072)" onMouseOut="lolite()" onClick="logVariable('lastrecord')" href="../../../_variables/lastrecord.html">$lastrecord</a> = <a class="phpfunction" onClick="logFunction('end')" href="../../../_functions/end.html" onMouseOver="phpfuncPopup(event,'end')">end</a>(<a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a>);
<a name="l430"><span class="linenum"> 430</span></a>              <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../_variables/id.html">$id</a> = <a class="phpfunction" onClick="logFunction('max')" href="../../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">max</a>(<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../_variables/id.html">$id</a>, <a class="var it35072" onMouseOver="hilite(35072)" onMouseOut="lolite()" onClick="logVariable('lastrecord')" href="../../../_variables/lastrecord.html">$lastrecord</a>-&gt;<a onClick="logVariable('id')" class="var it41735" onMouseOver="hilite(41735)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a> + 1);
<a name="l431"><span class="linenum"> 431</span></a>          }
<a name="l432"><span class="linenum"> 432</span></a>  
<a name="l433"><span class="linenum"> 433</span></a>          self::<a class="var it39194" onMouseOver="hilite(39194)" onMouseOut="lolite()" onClick="logVariable('sequencenextstartingid')" href="../../../_variables/sequencenextstartingid.html">$sequencenextstartingid</a> = <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../_variables/id.html">$id</a> + 1000;
<a name="l434"><span class="linenum"> 434</span></a>          return <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../_variables/id.html">$id</a>;
<a name="l435"><span class="linenum"> 435</span></a>      }
<a name="l436"><span class="linenum"> 436</span></a>  
<a name="l437"><span class="linenum"> 437</span></a>      <span class="comment">/**</span>
<a name="l438"><span class="linenum"> 438</span></a>  <span class="comment">     * Reset all database sequences to initial values.</span>
<a name="l439"><span class="linenum"> 439</span></a>  <span class="comment">     *</span>
<a name="l440"><span class="linenum"> 440</span></a>  <span class="comment">     * @static</span>
<a name="l441"><span class="linenum"> 441</span></a>  <span class="comment">     * @param array $empties tables that are known to be unmodified and empty</span>
<a name="l442"><span class="linenum"> 442</span></a>  <span class="comment">     * @return void</span>
<a name="l443"><span class="linenum"> 443</span></a>  <span class="comment">     */</span>
<a name="l444"><span class="linenum"> 444</span></a>      public static function <a class="function" onClick="logFunction('reset_all_database_sequences')" href="../../../_functions/reset_all_database_sequences.html" onMouseOver="funcPopup(event,'reset_all_database_sequences')">reset_all_database_sequences</a>(array <a class="var it14953" onMouseOver="hilite(14953)" onMouseOut="lolite()" onClick="logVariable('empties')" href="../../../_variables/empties.html">$empties</a> = null) {
<a name="l445"><span class="linenum"> 445</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l446"><span class="linenum"> 446</span></a>  
<a name="l447"><span class="linenum"> 447</span></a>          if (!<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a> = self::<a class="function" onClick="logFunction('get_tabledata')" href="../../../_functions/get_tabledata.html" onMouseOver="funcPopup(event,'get_tabledata')">get_tabledata</a>()) {
<a name="l448"><span class="linenum"> 448</span></a>  <span class="comment">            // Not initialised yet.</span>
<a name="l449"><span class="linenum"> 449</span></a>              return;
<a name="l450"><span class="linenum"> 450</span></a>          }
<a name="l451"><span class="linenum"> 451</span></a>          if (!<a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a> = self::<a class="function" onClick="logFunction('get_tablestructure')" href="../../../_functions/get_tablestructure.html" onMouseOver="funcPopup(event,'get_tablestructure')">get_tablestructure</a>()) {
<a name="l452"><span class="linenum"> 452</span></a>  <span class="comment">            // Not initialised yet.</span>
<a name="l453"><span class="linenum"> 453</span></a>              return;
<a name="l454"><span class="linenum"> 454</span></a>          }
<a name="l455"><span class="linenum"> 455</span></a>  
<a name="l456"><span class="linenum"> 456</span></a>  <span class="comment">        // If all starting Id's are the same, it's difficult to detect coding and testing</span>
<a name="l457"><span class="linenum"> 457</span></a>  <span class="comment">        // errors that use the incorrect id in tests.  The classic case is cmid vs instance id.</span>
<a name="l458"><span class="linenum"> 458</span></a>  <span class="comment">        // To reduce the chance of the coding error, we start sequences at different values where possible.</span>
<a name="l459"><span class="linenum"> 459</span></a>  <span class="comment">        // In a attempt to avoid tables with existing id's we start at a high number.</span>
<a name="l460"><span class="linenum"> 460</span></a>  <span class="comment">        // Reset the value each time all database sequences are reset.</span>
<a name="l461"><span class="linenum"> 461</span></a>          if (<a class="phpfunction" onClick="logFunction('defined')" href="../../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('PHPUNIT_SEQUENCE_START') and PHPUNIT_SEQUENCE_START) {
<a name="l462"><span class="linenum"> 462</span></a>              self::<a class="var it39194" onMouseOver="hilite(39194)" onMouseOut="lolite()" onClick="logVariable('sequencenextstartingid')" href="../../../_variables/sequencenextstartingid.html">$sequencenextstartingid</a> = PHPUNIT_SEQUENCE_START;
<a name="l463"><span class="linenum"> 463</span></a>          } else {
<a name="l464"><span class="linenum"> 464</span></a>              self::<a class="var it39194" onMouseOver="hilite(39194)" onMouseOut="lolite()" onClick="logVariable('sequencenextstartingid')" href="../../../_variables/sequencenextstartingid.html">$sequencenextstartingid</a> = 100000;
<a name="l465"><span class="linenum"> 465</span></a>          }
<a name="l466"><span class="linenum"> 466</span></a>  
<a name="l467"><span class="linenum"> 467</span></a>          <a class="var it18192" onMouseOver="hilite(18192)" onMouseOut="lolite()" onClick="logVariable('dbfamily')" href="../../../_variables/dbfamily.html">$dbfamily</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_dbfamily')" href="../../../_functions/get_dbfamily.html" onMouseOver="funcPopup(event,'get_dbfamily')">get_dbfamily</a>();
<a name="l468"><span class="linenum"> 468</span></a>          if (<a class="var it18192" onMouseOver="hilite(18192)" onMouseOut="lolite()" onClick="logVariable('dbfamily')" href="../../../_variables/dbfamily.html">$dbfamily</a> === 'postgres') {
<a name="l469"><span class="linenum"> 469</span></a>              <a class="var it7629" onMouseOver="hilite(7629)" onMouseOut="lolite()" onClick="logVariable('queries')" href="../../../_variables/queries.html">$queries</a> = array();
<a name="l470"><span class="linenum"> 470</span></a>              <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../../_variables/prefix.html">$prefix</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_prefix')" href="../../../_functions/get_prefix.html" onMouseOver="funcPopup(event,'get_prefix')">get_prefix</a>();
<a name="l471"><span class="linenum"> 471</span></a>              foreach (<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a> as <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a> =&gt; <a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a>) {
<a name="l472"><span class="linenum"> 472</span></a>                  if (isset(<a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>]['id']) and <a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>]['id']-&gt;auto_increment) {
<a name="l473"><span class="linenum"> 473</span></a>                      <a class="var it25779" onMouseOver="hilite(25779)" onMouseOut="lolite()" onClick="logVariable('nextid')" href="../../../_variables/nextid.html">$nextid</a> = self::<a class="function" onClick="logFunction('get_next_sequence_starting_value')" href="../../../_functions/get_next_sequence_starting_value.html" onMouseOver="funcPopup(event,'get_next_sequence_starting_value')">get_next_sequence_starting_value</a>(<a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a>);
<a name="l474"><span class="linenum"> 474</span></a>                      <a class="var it7629" onMouseOver="hilite(7629)" onMouseOut="lolite()" onClick="logVariable('queries')" href="../../../_variables/queries.html">$queries</a>[] = &quot;ALTER SEQUENCE {<a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../../_variables/prefix.html">$prefix</a>}{<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>}_id_seq RESTART WITH <a class="var it25779" onMouseOver="hilite(25779)" onMouseOut="lolite()" onClick="logVariable('nextid')" href="../../../_variables/nextid.html">$nextid</a>&quot;;
<a name="l475"><span class="linenum"> 475</span></a>                  }
<a name="l476"><span class="linenum"> 476</span></a>              }
<a name="l477"><span class="linenum"> 477</span></a>              if (<a class="var it7629" onMouseOver="hilite(7629)" onMouseOut="lolite()" onClick="logVariable('queries')" href="../../../_variables/queries.html">$queries</a>) {
<a name="l478"><span class="linenum"> 478</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('change_database_structure')" href="../../../_functions/change_database_structure.html" onMouseOver="funcPopup(event,'change_database_structure')">change_database_structure</a>(<a class="phpfunction" onClick="logFunction('implode')" href="../../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(';', <a class="var it7629" onMouseOver="hilite(7629)" onMouseOut="lolite()" onClick="logVariable('queries')" href="../../../_variables/queries.html">$queries</a>));
<a name="l479"><span class="linenum"> 479</span></a>              }
<a name="l480"><span class="linenum"> 480</span></a>  
<a name="l481"><span class="linenum"> 481</span></a>          } else if (<a class="var it18192" onMouseOver="hilite(18192)" onMouseOut="lolite()" onClick="logVariable('dbfamily')" href="../../../_variables/dbfamily.html">$dbfamily</a> === 'mysql') {
<a name="l482"><span class="linenum"> 482</span></a>              <a class="var it31292" onMouseOver="hilite(31292)" onMouseOut="lolite()" onClick="logVariable('sequences')" href="../../../_variables/sequences.html">$sequences</a> = array();
<a name="l483"><span class="linenum"> 483</span></a>              <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../../_variables/prefix.html">$prefix</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_prefix')" href="../../../_functions/get_prefix.html" onMouseOver="funcPopup(event,'get_prefix')">get_prefix</a>();
<a name="l484"><span class="linenum"> 484</span></a>              <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset_sql')" href="../../../_functions/get_recordset_sql.html" onMouseOver="funcPopup(event,'get_recordset_sql')">get_recordset_sql</a>(&quot;SHOW TABLE STATUS LIKE ?&quot;, array(<a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../../_variables/prefix.html">$prefix</a>.'%'));
<a name="l485"><span class="linenum"> 485</span></a>              foreach (<a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> as <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a>) {
<a name="l486"><span class="linenum"> 486</span></a>                  <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a> = <a class="phpfunction" onClick="logFunction('strtolower')" href="../../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a>-&gt;<a onClick="logVariable('name')" class="var it39470" onMouseOver="hilite(39470)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a>);
<a name="l487"><span class="linenum"> 487</span></a>                  if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>, <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../../_variables/prefix.html">$prefix</a>) !== 0) {
<a name="l488"><span class="linenum"> 488</span></a>  <span class="comment">                    // incorrect table match caused by _</span>
<a name="l489"><span class="linenum"> 489</span></a>                      continue;
<a name="l490"><span class="linenum"> 490</span></a>                  }
<a name="l491"><span class="linenum"> 491</span></a>                  if (!<a class="phpfunction" onClick="logFunction('is_null')" href="../../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a>-&gt;<a onClick="logVariable('auto_increment')" class="var it39470" onMouseOver="hilite(39470)" onMouseOut="lolite()" href="../../../_variables/auto_increment.html">auto_increment</a>)) {
<a name="l492"><span class="linenum"> 492</span></a>                      <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/^'.<a class="phpfunction" onClick="logFunction('preg_quote')" href="../../../_functions/preg_quote.html" onMouseOver="phpfuncPopup(event,'preg_quote')">preg_quote</a>(<a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../../_variables/prefix.html">$prefix</a>, '/').'/', '', <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>);
<a name="l493"><span class="linenum"> 493</span></a>                      <a class="var it31292" onMouseOver="hilite(31292)" onMouseOut="lolite()" onClick="logVariable('sequences')" href="../../../_variables/sequences.html">$sequences</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>] = <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a>-&gt;<a onClick="logVariable('auto_increment')" class="var it39470" onMouseOver="hilite(39470)" onMouseOut="lolite()" href="../../../_variables/auto_increment.html">auto_increment</a>;
<a name="l494"><span class="linenum"> 494</span></a>                  }
<a name="l495"><span class="linenum"> 495</span></a>              }
<a name="l496"><span class="linenum"> 496</span></a>              <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l497"><span class="linenum"> 497</span></a>              <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../../_variables/prefix.html">$prefix</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_prefix')" href="../../../_functions/get_prefix.html" onMouseOver="funcPopup(event,'get_prefix')">get_prefix</a>();
<a name="l498"><span class="linenum"> 498</span></a>              foreach (<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a> as <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a> =&gt; <a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a>) {
<a name="l499"><span class="linenum"> 499</span></a>                  if (isset(<a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>]['id']) and <a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>]['id']-&gt;auto_increment) {
<a name="l500"><span class="linenum"> 500</span></a>                      if (isset(<a class="var it31292" onMouseOver="hilite(31292)" onMouseOut="lolite()" onClick="logVariable('sequences')" href="../../../_variables/sequences.html">$sequences</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>])) {
<a name="l501"><span class="linenum"> 501</span></a>                          <a class="var it25779" onMouseOver="hilite(25779)" onMouseOut="lolite()" onClick="logVariable('nextid')" href="../../../_variables/nextid.html">$nextid</a> = self::<a class="function" onClick="logFunction('get_next_sequence_starting_value')" href="../../../_functions/get_next_sequence_starting_value.html" onMouseOver="funcPopup(event,'get_next_sequence_starting_value')">get_next_sequence_starting_value</a>(<a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a>);
<a name="l502"><span class="linenum"> 502</span></a>                          if (<a class="var it31292" onMouseOver="hilite(31292)" onMouseOut="lolite()" onClick="logVariable('sequences')" href="../../../_variables/sequences.html">$sequences</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>] != <a class="var it25779" onMouseOver="hilite(25779)" onMouseOut="lolite()" onClick="logVariable('nextid')" href="../../../_variables/nextid.html">$nextid</a>) {
<a name="l503"><span class="linenum"> 503</span></a>                              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('change_database_structure')" href="../../../_functions/change_database_structure.html" onMouseOver="funcPopup(event,'change_database_structure')">change_database_structure</a>(&quot;ALTER TABLE {<a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../../_variables/prefix.html">$prefix</a>}{<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>} AUTO_INCREMENT = <a class="var it25779" onMouseOver="hilite(25779)" onMouseOut="lolite()" onClick="logVariable('nextid')" href="../../../_variables/nextid.html">$nextid</a>&quot;);
<a name="l504"><span class="linenum"> 504</span></a>                          }
<a name="l505"><span class="linenum"> 505</span></a>  
<a name="l506"><span class="linenum"> 506</span></a>                      } else {
<a name="l507"><span class="linenum"> 507</span></a>  <span class="comment">                        // some problem exists, fallback to standard code</span>
<a name="l508"><span class="linenum"> 508</span></a>                          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_manager')" href="../../../_functions/get_manager.html" onMouseOver="funcPopup(event,'get_manager')">get_manager</a>()-&gt;<a class="function" onClick="logFunction('reset_sequence')" href="../../../_functions/reset_sequence.html" onMouseOver="funcPopup(event,'reset_sequence')">reset_sequence</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>);
<a name="l509"><span class="linenum"> 509</span></a>                      }
<a name="l510"><span class="linenum"> 510</span></a>                  }
<a name="l511"><span class="linenum"> 511</span></a>              }
<a name="l512"><span class="linenum"> 512</span></a>  
<a name="l513"><span class="linenum"> 513</span></a>          } else if (<a class="var it18192" onMouseOver="hilite(18192)" onMouseOut="lolite()" onClick="logVariable('dbfamily')" href="../../../_variables/dbfamily.html">$dbfamily</a> === 'oracle') {
<a name="l514"><span class="linenum"> 514</span></a>              <a class="var it31292" onMouseOver="hilite(31292)" onMouseOut="lolite()" onClick="logVariable('sequences')" href="../../../_variables/sequences.html">$sequences</a> = self::<a class="function" onClick="logFunction('get_sequencenames')" href="../../../_functions/get_sequencenames.html" onMouseOver="funcPopup(event,'get_sequencenames')">get_sequencenames</a>();
<a name="l515"><span class="linenum"> 515</span></a>              <a class="var it31292" onMouseOver="hilite(31292)" onMouseOut="lolite()" onClick="logVariable('sequences')" href="../../../_variables/sequences.html">$sequences</a> = <a class="phpfunction" onClick="logFunction('array_map')" href="../../../_functions/array_map.html" onMouseOver="phpfuncPopup(event,'array_map')">array_map</a>('strtoupper', <a class="var it31292" onMouseOver="hilite(31292)" onMouseOut="lolite()" onClick="logVariable('sequences')" href="../../../_variables/sequences.html">$sequences</a>);
<a name="l516"><span class="linenum"> 516</span></a>              <a class="var it7163" onMouseOver="hilite(7163)" onMouseOut="lolite()" onClick="logVariable('lookup')" href="../../../_variables/lookup.html">$lookup</a> = <a class="phpfunction" onClick="logFunction('array_flip')" href="../../../_functions/array_flip.html" onMouseOver="phpfuncPopup(event,'array_flip')">array_flip</a>(<a class="var it31292" onMouseOver="hilite(31292)" onMouseOut="lolite()" onClick="logVariable('sequences')" href="../../../_variables/sequences.html">$sequences</a>);
<a name="l517"><span class="linenum"> 517</span></a>  
<a name="l518"><span class="linenum"> 518</span></a>              <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('current')" href="../../../_variables/current.html">$current</a> = array();
<a name="l519"><span class="linenum"> 519</span></a>              <a class="function" onClick="logFunction('list')" href="../../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it39195" onMouseOver="hilite(39195)" onMouseOut="lolite()" onClick="logVariable('seqs')" href="../../../_variables/seqs.html">$seqs</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>) = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it31292" onMouseOver="hilite(31292)" onMouseOut="lolite()" onClick="logVariable('sequences')" href="../../../_variables/sequences.html">$sequences</a>);
<a name="l520"><span class="linenum"> 520</span></a>              <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a> = &quot;SELECT sequence_name, last_number FROM user_sequences WHERE sequence_name <a class="var it39195" onMouseOver="hilite(39195)" onMouseOut="lolite()" onClick="logVariable('seqs')" href="../../../_variables/seqs.html">$seqs</a>&quot;;
<a name="l521"><span class="linenum"> 521</span></a>              <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset_sql')" href="../../../_functions/get_recordset_sql.html" onMouseOver="funcPopup(event,'get_recordset_sql')">get_recordset_sql</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>);
<a name="l522"><span class="linenum"> 522</span></a>              foreach (<a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> as <a class="var it4727" onMouseOver="hilite(4727)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../../_variables/seq.html">$seq</a>) {
<a name="l523"><span class="linenum"> 523</span></a>                  <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a> = <a class="var it7163" onMouseOver="hilite(7163)" onMouseOut="lolite()" onClick="logVariable('lookup')" href="../../../_variables/lookup.html">$lookup</a>[<a class="var it4727" onMouseOver="hilite(4727)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../../_variables/seq.html">$seq</a>-&gt;<a onClick="logVariable('sequence_name')" class="var it40175" onMouseOver="hilite(40175)" onMouseOut="lolite()" href="../../../_variables/sequence_name.html">sequence_name</a>];
<a name="l524"><span class="linenum"> 524</span></a>                  <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('current')" href="../../../_variables/current.html">$current</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>] = <a class="var it4727" onMouseOver="hilite(4727)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../../_variables/seq.html">$seq</a>-&gt;<a onClick="logVariable('last_number')" class="var it40175" onMouseOver="hilite(40175)" onMouseOut="lolite()" href="../../../_variables/last_number.html">last_number</a>;
<a name="l525"><span class="linenum"> 525</span></a>              }
<a name="l526"><span class="linenum"> 526</span></a>              <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l527"><span class="linenum"> 527</span></a>  
<a name="l528"><span class="linenum"> 528</span></a>              foreach (<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a> as <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a> =&gt; <a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a>) {
<a name="l529"><span class="linenum"> 529</span></a>                  if (isset(<a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>]['id']) and <a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>]['id']-&gt;auto_increment) {
<a name="l530"><span class="linenum"> 530</span></a>                      <a class="var it35072" onMouseOver="hilite(35072)" onMouseOut="lolite()" onClick="logVariable('lastrecord')" href="../../../_variables/lastrecord.html">$lastrecord</a> = <a class="phpfunction" onClick="logFunction('end')" href="../../../_functions/end.html" onMouseOver="phpfuncPopup(event,'end')">end</a>(<a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a>);
<a name="l531"><span class="linenum"> 531</span></a>                      if (<a class="var it35072" onMouseOver="hilite(35072)" onMouseOut="lolite()" onClick="logVariable('lastrecord')" href="../../../_variables/lastrecord.html">$lastrecord</a>) {
<a name="l532"><span class="linenum"> 532</span></a>                          <a class="var it25779" onMouseOver="hilite(25779)" onMouseOut="lolite()" onClick="logVariable('nextid')" href="../../../_variables/nextid.html">$nextid</a> = <a class="var it35072" onMouseOver="hilite(35072)" onMouseOut="lolite()" onClick="logVariable('lastrecord')" href="../../../_variables/lastrecord.html">$lastrecord</a>-&gt;<a onClick="logVariable('id')" class="var it41735" onMouseOver="hilite(41735)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a> + 1;
<a name="l533"><span class="linenum"> 533</span></a>                      } else {
<a name="l534"><span class="linenum"> 534</span></a>                          <a class="var it25779" onMouseOver="hilite(25779)" onMouseOut="lolite()" onClick="logVariable('nextid')" href="../../../_variables/nextid.html">$nextid</a> = 1;
<a name="l535"><span class="linenum"> 535</span></a>                      }
<a name="l536"><span class="linenum"> 536</span></a>                      if (!isset(<a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('current')" href="../../../_variables/current.html">$current</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>])) {
<a name="l537"><span class="linenum"> 537</span></a>                          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_manager')" href="../../../_functions/get_manager.html" onMouseOver="funcPopup(event,'get_manager')">get_manager</a>()-&gt;<a class="function" onClick="logFunction('reset_sequence')" href="../../../_functions/reset_sequence.html" onMouseOver="funcPopup(event,'reset_sequence')">reset_sequence</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>);
<a name="l538"><span class="linenum"> 538</span></a>                      } else if (<a class="var it25779" onMouseOver="hilite(25779)" onMouseOut="lolite()" onClick="logVariable('nextid')" href="../../../_variables/nextid.html">$nextid</a> == <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('current')" href="../../../_variables/current.html">$current</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>]) {
<a name="l539"><span class="linenum"> 539</span></a>                          continue;
<a name="l540"><span class="linenum"> 540</span></a>                      }
<a name="l541"><span class="linenum"> 541</span></a>  <span class="comment">                    // reset as fast as possible - alternatively we could use http://stackoverflow.com/questions/51470/how-do-i-reset-a-sequence-in-oracle</span>
<a name="l542"><span class="linenum"> 542</span></a>                      <a class="var it6850" onMouseOver="hilite(6850)" onMouseOut="lolite()" onClick="logVariable('seqname')" href="../../../_variables/seqname.html">$seqname</a> = <a class="var it31292" onMouseOver="hilite(31292)" onMouseOut="lolite()" onClick="logVariable('sequences')" href="../../../_variables/sequences.html">$sequences</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>];
<a name="l543"><span class="linenum"> 543</span></a>                      <a class="var it39197" onMouseOver="hilite(39197)" onMouseOut="lolite()" onClick="logVariable('cachesize')" href="../../../_variables/cachesize.html">$cachesize</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_manager')" href="../../../_functions/get_manager.html" onMouseOver="funcPopup(event,'get_manager')">get_manager</a>()-&gt;generator-&gt;sequence_cache_size;
<a name="l544"><span class="linenum"> 544</span></a>                      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('change_database_structure')" href="../../../_functions/change_database_structure.html" onMouseOver="funcPopup(event,'change_database_structure')">change_database_structure</a>(&quot;DROP SEQUENCE <a class="var it6850" onMouseOver="hilite(6850)" onMouseOut="lolite()" onClick="logVariable('seqname')" href="../../../_variables/seqname.html">$seqname</a>&quot;);
<a name="l545"><span class="linenum"> 545</span></a>                      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('change_database_structure')" href="../../../_functions/change_database_structure.html" onMouseOver="funcPopup(event,'change_database_structure')">change_database_structure</a>(&quot;CREATE SEQUENCE <a class="var it6850" onMouseOver="hilite(6850)" onMouseOut="lolite()" onClick="logVariable('seqname')" href="../../../_variables/seqname.html">$seqname</a> START WITH <a class="var it25779" onMouseOver="hilite(25779)" onMouseOut="lolite()" onClick="logVariable('nextid')" href="../../../_variables/nextid.html">$nextid</a> INCREMENT BY 1 NOMAXVALUE CACHE <a class="var it39197" onMouseOver="hilite(39197)" onMouseOut="lolite()" onClick="logVariable('cachesize')" href="../../../_variables/cachesize.html">$cachesize</a>&quot;);
<a name="l546"><span class="linenum"> 546</span></a>                  }
<a name="l547"><span class="linenum"> 547</span></a>              }
<a name="l548"><span class="linenum"> 548</span></a>  
<a name="l549"><span class="linenum"> 549</span></a>          } else {
<a name="l550"><span class="linenum"> 550</span></a>  <span class="comment">            // note: does mssql support any kind of faster reset?</span>
<a name="l551"><span class="linenum"> 551</span></a>  <span class="comment">            // This also implies mssql will not use unique sequence values.</span>
<a name="l552"><span class="linenum"> 552</span></a>              if (<a class="phpfunction" onClick="logFunction('is_null')" href="../../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it14953" onMouseOver="hilite(14953)" onMouseOut="lolite()" onClick="logVariable('empties')" href="../../../_variables/empties.html">$empties</a>)) {
<a name="l553"><span class="linenum"> 553</span></a>                  <a class="var it14953" onMouseOver="hilite(14953)" onMouseOut="lolite()" onClick="logVariable('empties')" href="../../../_variables/empties.html">$empties</a> = self::<a class="function" onClick="logFunction('guess_unmodified_empty_tables')" href="../../../_functions/guess_unmodified_empty_tables.html" onMouseOver="funcPopup(event,'guess_unmodified_empty_tables')">guess_unmodified_empty_tables</a>();
<a name="l554"><span class="linenum"> 554</span></a>              }
<a name="l555"><span class="linenum"> 555</span></a>              foreach (<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a> as <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a> =&gt; <a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a>) {
<a name="l556"><span class="linenum"> 556</span></a>                  if (isset(<a class="var it14953" onMouseOver="hilite(14953)" onMouseOut="lolite()" onClick="logVariable('empties')" href="../../../_variables/empties.html">$empties</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>])) {
<a name="l557"><span class="linenum"> 557</span></a>                      continue;
<a name="l558"><span class="linenum"> 558</span></a>                  }
<a name="l559"><span class="linenum"> 559</span></a>                  if (isset(<a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>]['id']) and <a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>]['id']-&gt;auto_increment) {
<a name="l560"><span class="linenum"> 560</span></a>                      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_manager')" href="../../../_functions/get_manager.html" onMouseOver="funcPopup(event,'get_manager')">get_manager</a>()-&gt;<a class="function" onClick="logFunction('reset_sequence')" href="../../../_functions/reset_sequence.html" onMouseOver="funcPopup(event,'reset_sequence')">reset_sequence</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>);
<a name="l561"><span class="linenum"> 561</span></a>                  }
<a name="l562"><span class="linenum"> 562</span></a>              }
<a name="l563"><span class="linenum"> 563</span></a>          }
<a name="l564"><span class="linenum"> 564</span></a>      }
<a name="l565"><span class="linenum"> 565</span></a>  
<a name="l566"><span class="linenum"> 566</span></a>      <span class="comment">/**</span>
<a name="l567"><span class="linenum"> 567</span></a>  <span class="comment">     * Reset all database tables to default values.</span>
<a name="l568"><span class="linenum"> 568</span></a>  <span class="comment">     * @static</span>
<a name="l569"><span class="linenum"> 569</span></a>  <span class="comment">     * @return bool true if reset done, false if skipped</span>
<a name="l570"><span class="linenum"> 570</span></a>  <span class="comment">     */</span>
<a name="l571"><span class="linenum"> 571</span></a>      public static function <a class="function" onClick="logFunction('reset_database')" href="../../../_functions/reset_database.html" onMouseOver="funcPopup(event,'reset_database')">reset_database</a>() {
<a name="l572"><span class="linenum"> 572</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l573"><span class="linenum"> 573</span></a>  
<a name="l574"><span class="linenum"> 574</span></a>          <a class="var it448" onMouseOver="hilite(448)" onMouseOut="lolite()" onClick="logVariable('tables')" href="../../../_variables/tables.html">$tables</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_tables')" href="../../../_functions/get_tables.html" onMouseOver="funcPopup(event,'get_tables')">get_tables</a>(false);
<a name="l575"><span class="linenum"> 575</span></a>          if (!<a class="var it448" onMouseOver="hilite(448)" onMouseOut="lolite()" onClick="logVariable('tables')" href="../../../_variables/tables.html">$tables</a> or empty(<a class="var it448" onMouseOver="hilite(448)" onMouseOut="lolite()" onClick="logVariable('tables')" href="../../../_variables/tables.html">$tables</a>['config'])) {
<a name="l576"><span class="linenum"> 576</span></a>  <span class="comment">            // not installed yet</span>
<a name="l577"><span class="linenum"> 577</span></a>              return false;
<a name="l578"><span class="linenum"> 578</span></a>          }
<a name="l579"><span class="linenum"> 579</span></a>  
<a name="l580"><span class="linenum"> 580</span></a>          if (!<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a> = self::<a class="function" onClick="logFunction('get_tabledata')" href="../../../_functions/get_tabledata.html" onMouseOver="funcPopup(event,'get_tabledata')">get_tabledata</a>()) {
<a name="l581"><span class="linenum"> 581</span></a>  <span class="comment">            // not initialised yet</span>
<a name="l582"><span class="linenum"> 582</span></a>              return false;
<a name="l583"><span class="linenum"> 583</span></a>          }
<a name="l584"><span class="linenum"> 584</span></a>          if (!<a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a> = self::<a class="function" onClick="logFunction('get_tablestructure')" href="../../../_functions/get_tablestructure.html" onMouseOver="funcPopup(event,'get_tablestructure')">get_tablestructure</a>()) {
<a name="l585"><span class="linenum"> 585</span></a>  <span class="comment">            // not initialised yet</span>
<a name="l586"><span class="linenum"> 586</span></a>              return false;
<a name="l587"><span class="linenum"> 587</span></a>          }
<a name="l588"><span class="linenum"> 588</span></a>  
<a name="l589"><span class="linenum"> 589</span></a>          <a class="var it14953" onMouseOver="hilite(14953)" onMouseOut="lolite()" onClick="logVariable('empties')" href="../../../_variables/empties.html">$empties</a> = self::<a class="function" onClick="logFunction('guess_unmodified_empty_tables')" href="../../../_functions/guess_unmodified_empty_tables.html" onMouseOver="funcPopup(event,'guess_unmodified_empty_tables')">guess_unmodified_empty_tables</a>();
<a name="l590"><span class="linenum"> 590</span></a>  
<a name="l591"><span class="linenum"> 591</span></a>          <a class="var it39198" onMouseOver="hilite(39198)" onMouseOut="lolite()" onClick="logVariable('borkedmysql')" href="../../../_variables/borkedmysql.html">$borkedmysql</a> = false;
<a name="l592"><span class="linenum"> 592</span></a>          if (<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_dbfamily')" href="../../../_functions/get_dbfamily.html" onMouseOver="funcPopup(event,'get_dbfamily')">get_dbfamily</a>() === 'mysql') {
<a name="l593"><span class="linenum"> 593</span></a>              <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../../_variables/version.html">$version</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_server_info')" href="../../../_functions/get_server_info.html" onMouseOver="funcPopup(event,'get_server_info')">get_server_info</a>();
<a name="l594"><span class="linenum"> 594</span></a>              if (<a class="phpfunction" onClick="logFunction('version_compare')" href="../../../_functions/version_compare.html" onMouseOver="phpfuncPopup(event,'version_compare')">version_compare</a>(<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../../_variables/version.html">$version</a>['version'], '5.6.0') == 1 and <a class="phpfunction" onClick="logFunction('version_compare')" href="../../../_functions/version_compare.html" onMouseOver="phpfuncPopup(event,'version_compare')">version_compare</a>(<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../../_variables/version.html">$version</a>['version'], '5.6.16') == -1) {
<a name="l595"><span class="linenum"> 595</span></a>  <span class="comment">                // Everything that comes from Oracle is evil!</span>
<a name="l596"><span class="linenum"> 596</span></a>  <span class="comment">                //</span>
<a name="l597"><span class="linenum"> 597</span></a>  <span class="comment">                // See http://dev.mysql.com/doc/refman/5.6/en/alter-table.html</span>
<a name="l598"><span class="linenum"> 598</span></a>  <span class="comment">                // You cannot reset the counter to a value less than or equal to to the value that is currently in use.</span>
<a name="l599"><span class="linenum"> 599</span></a>  <span class="comment">                //</span>
<a name="l600"><span class="linenum"> 600</span></a>  <span class="comment">                // From 5.6.16 release notes:</span>
<a name="l601"><span class="linenum"> 601</span></a>  <span class="comment">                //   InnoDB: The ALTER TABLE INPLACE algorithm would fail to decrease the auto-increment value.</span>
<a name="l602"><span class="linenum"> 602</span></a>  <span class="comment">                //           (Bug #17250787, Bug #69882)</span>
<a name="l603"><span class="linenum"> 603</span></a>                  <a class="var it39198" onMouseOver="hilite(39198)" onMouseOut="lolite()" onClick="logVariable('borkedmysql')" href="../../../_variables/borkedmysql.html">$borkedmysql</a> = true;
<a name="l604"><span class="linenum"> 604</span></a>  
<a name="l605"><span class="linenum"> 605</span></a>              } else if (<a class="phpfunction" onClick="logFunction('version_compare')" href="../../../_functions/version_compare.html" onMouseOver="phpfuncPopup(event,'version_compare')">version_compare</a>(<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../../_variables/version.html">$version</a>['version'], '10.0.0') == 1) {
<a name="l606"><span class="linenum"> 606</span></a>  <span class="comment">                // And MariaDB is no better!</span>
<a name="l607"><span class="linenum"> 607</span></a>  <span class="comment">                // Let's hope they pick the patch sometime later...</span>
<a name="l608"><span class="linenum"> 608</span></a>                  <a class="var it39198" onMouseOver="hilite(39198)" onMouseOut="lolite()" onClick="logVariable('borkedmysql')" href="../../../_variables/borkedmysql.html">$borkedmysql</a> = true;
<a name="l609"><span class="linenum"> 609</span></a>              }
<a name="l610"><span class="linenum"> 610</span></a>          }
<a name="l611"><span class="linenum"> 611</span></a>  
<a name="l612"><span class="linenum"> 612</span></a>          if (<a class="var it39198" onMouseOver="hilite(39198)" onMouseOut="lolite()" onClick="logVariable('borkedmysql')" href="../../../_variables/borkedmysql.html">$borkedmysql</a>) {
<a name="l613"><span class="linenum"> 613</span></a>              <a class="var it39199" onMouseOver="hilite(39199)" onMouseOut="lolite()" onClick="logVariable('mysqlsequences')" href="../../../_variables/mysqlsequences.html">$mysqlsequences</a> = array();
<a name="l614"><span class="linenum"> 614</span></a>              <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../../_variables/prefix.html">$prefix</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_prefix')" href="../../../_functions/get_prefix.html" onMouseOver="funcPopup(event,'get_prefix')">get_prefix</a>();
<a name="l615"><span class="linenum"> 615</span></a>              <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset_sql')" href="../../../_functions/get_recordset_sql.html" onMouseOver="funcPopup(event,'get_recordset_sql')">get_recordset_sql</a>(&quot;SHOW TABLE STATUS LIKE ?&quot;, array(<a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../../_variables/prefix.html">$prefix</a>.'%'));
<a name="l616"><span class="linenum"> 616</span></a>              foreach (<a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../_variables/rs.html">$rs</a> as <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a>) {
<a name="l617"><span class="linenum"> 617</span></a>                  <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a> = <a class="phpfunction" onClick="logFunction('strtolower')" href="../../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a>-&gt;<a onClick="logVariable('name')" class="var it39470" onMouseOver="hilite(39470)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a>);
<a name="l618"><span class="linenum"> 618</span></a>                  if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>, <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../../_variables/prefix.html">$prefix</a>) !== 0) {
<a name="l619"><span class="linenum"> 619</span></a>  <span class="comment">                    // Incorrect table match caused by _ char.</span>
<a name="l620"><span class="linenum"> 620</span></a>                      continue;
<a name="l621"><span class="linenum"> 621</span></a>                  }
<a name="l622"><span class="linenum"> 622</span></a>                  if (!<a class="phpfunction" onClick="logFunction('is_null')" href="../../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a>-&gt;<a onClick="logVariable('auto_increment')" class="var it39470" onMouseOver="hilite(39470)" onMouseOut="lolite()" href="../../../_variables/auto_increment.html">auto_increment</a>)) {
<a name="l623"><span class="linenum"> 623</span></a>                      <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/^'.<a class="phpfunction" onClick="logFunction('preg_quote')" href="../../../_functions/preg_quote.html" onMouseOver="phpfuncPopup(event,'preg_quote')">preg_quote</a>(<a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../../_variables/prefix.html">$prefix</a>, '/').'/', '', <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>);
<a name="l624"><span class="linenum"> 624</span></a>                      <a class="var it39199" onMouseOver="hilite(39199)" onMouseOut="lolite()" onClick="logVariable('mysqlsequences')" href="../../../_variables/mysqlsequences.html">$mysqlsequences</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>] = <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a>-&gt;<a onClick="logVariable('auto_increment')" class="var it39470" onMouseOver="hilite(39470)" onMouseOut="lolite()" href="../../../_variables/auto_increment.html">auto_increment</a>;
<a name="l625"><span class="linenum"> 625</span></a>                  }
<a name="l626"><span class="linenum"> 626</span></a>              }
<a name="l627"><span class="linenum"> 627</span></a>          }
<a name="l628"><span class="linenum"> 628</span></a>  
<a name="l629"><span class="linenum"> 629</span></a>          foreach (<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a> as <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a> =&gt; <a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a>) {
<a name="l630"><span class="linenum"> 630</span></a>              if (<a class="var it39198" onMouseOver="hilite(39198)" onMouseOut="lolite()" onClick="logVariable('borkedmysql')" href="../../../_variables/borkedmysql.html">$borkedmysql</a>) {
<a name="l631"><span class="linenum"> 631</span></a>                  if (empty(<a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a>) and isset(<a class="var it14953" onMouseOver="hilite(14953)" onMouseOut="lolite()" onClick="logVariable('empties')" href="../../../_variables/empties.html">$empties</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>])) {
<a name="l632"><span class="linenum"> 632</span></a>                      continue;
<a name="l633"><span class="linenum"> 633</span></a>                  }
<a name="l634"><span class="linenum"> 634</span></a>  
<a name="l635"><span class="linenum"> 635</span></a>                  if (isset(<a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>]['id']) and <a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>]['id']-&gt;auto_increment) {
<a name="l636"><span class="linenum"> 636</span></a>                      <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('current')" href="../../../_variables/current.html">$current</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>, array(), 'id ASC');
<a name="l637"><span class="linenum"> 637</span></a>                      if (<a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('current')" href="../../../_variables/current.html">$current</a> == <a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a>) {
<a name="l638"><span class="linenum"> 638</span></a>                          if (isset(<a class="var it39199" onMouseOver="hilite(39199)" onMouseOut="lolite()" onClick="logVariable('mysqlsequences')" href="../../../_variables/mysqlsequences.html">$mysqlsequences</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>]) and <a class="var it39199" onMouseOver="hilite(39199)" onMouseOut="lolite()" onClick="logVariable('mysqlsequences')" href="../../../_variables/mysqlsequences.html">$mysqlsequences</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>] == <a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>]['id']-&gt;auto_increment) {
<a name="l639"><span class="linenum"> 639</span></a>                              continue;
<a name="l640"><span class="linenum"> 640</span></a>                          }
<a name="l641"><span class="linenum"> 641</span></a>                      }
<a name="l642"><span class="linenum"> 642</span></a>                  }
<a name="l643"><span class="linenum"> 643</span></a>  
<a name="l644"><span class="linenum"> 644</span></a>  <span class="comment">                // Use TRUNCATE as a workaround and reinsert everything.</span>
<a name="l645"><span class="linenum"> 645</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>, null);
<a name="l646"><span class="linenum"> 646</span></a>                  foreach (<a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a> as <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>) {
<a name="l647"><span class="linenum"> 647</span></a>                      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('import_record')" href="../../../_functions/import_record.html" onMouseOver="funcPopup(event,'import_record')">import_record</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>, <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>, false, true);
<a name="l648"><span class="linenum"> 648</span></a>                  }
<a name="l649"><span class="linenum"> 649</span></a>                  continue;
<a name="l650"><span class="linenum"> 650</span></a>              }
<a name="l651"><span class="linenum"> 651</span></a>  
<a name="l652"><span class="linenum"> 652</span></a>              if (empty(<a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a>)) {
<a name="l653"><span class="linenum"> 653</span></a>                  if (isset(<a class="var it14953" onMouseOver="hilite(14953)" onMouseOut="lolite()" onClick="logVariable('empties')" href="../../../_variables/empties.html">$empties</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>])) {
<a name="l654"><span class="linenum"> 654</span></a>  <span class="comment">                    // table was not modified and is empty</span>
<a name="l655"><span class="linenum"> 655</span></a>                  } else {
<a name="l656"><span class="linenum"> 656</span></a>                      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>, array());
<a name="l657"><span class="linenum"> 657</span></a>                  }
<a name="l658"><span class="linenum"> 658</span></a>                  continue;
<a name="l659"><span class="linenum"> 659</span></a>              }
<a name="l660"><span class="linenum"> 660</span></a>  
<a name="l661"><span class="linenum"> 661</span></a>              if (isset(<a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>]['id']) and <a class="var it997" onMouseOver="hilite(997)" onMouseOut="lolite()" onClick="logVariable('structure')" href="../../../_variables/structure.html">$structure</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>]['id']-&gt;auto_increment) {
<a name="l662"><span class="linenum"> 662</span></a>                  <a class="var it39200" onMouseOver="hilite(39200)" onMouseOut="lolite()" onClick="logVariable('currentrecords')" href="../../../_variables/currentrecords.html">$currentrecords</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>, array(), 'id ASC');
<a name="l663"><span class="linenum"> 663</span></a>                  <a class="var it3069" onMouseOver="hilite(3069)" onMouseOut="lolite()" onClick="logVariable('changed')" href="../../../_variables/changed.html">$changed</a> = false;
<a name="l664"><span class="linenum"> 664</span></a>                  foreach (<a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a> as <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../_variables/id.html">$id</a> =&gt; <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>) {
<a name="l665"><span class="linenum"> 665</span></a>                      if (!isset(<a class="var it39200" onMouseOver="hilite(39200)" onMouseOut="lolite()" onClick="logVariable('currentrecords')" href="../../../_variables/currentrecords.html">$currentrecords</a>[<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../_variables/id.html">$id</a>])) {
<a name="l666"><span class="linenum"> 666</span></a>                          <a class="var it3069" onMouseOver="hilite(3069)" onMouseOut="lolite()" onClick="logVariable('changed')" href="../../../_variables/changed.html">$changed</a> = true;
<a name="l667"><span class="linenum"> 667</span></a>                          break;
<a name="l668"><span class="linenum"> 668</span></a>                      }
<a name="l669"><span class="linenum"> 669</span></a>                      if ((array)<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a> != (array)<a class="var it39200" onMouseOver="hilite(39200)" onMouseOut="lolite()" onClick="logVariable('currentrecords')" href="../../../_variables/currentrecords.html">$currentrecords</a>[<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../_variables/id.html">$id</a>]) {
<a name="l670"><span class="linenum"> 670</span></a>                          <a class="var it3069" onMouseOver="hilite(3069)" onMouseOut="lolite()" onClick="logVariable('changed')" href="../../../_variables/changed.html">$changed</a> = true;
<a name="l671"><span class="linenum"> 671</span></a>                          break;
<a name="l672"><span class="linenum"> 672</span></a>                      }
<a name="l673"><span class="linenum"> 673</span></a>                      unset(<a class="var it39200" onMouseOver="hilite(39200)" onMouseOut="lolite()" onClick="logVariable('currentrecords')" href="../../../_variables/currentrecords.html">$currentrecords</a>[<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../_variables/id.html">$id</a>]);
<a name="l674"><span class="linenum"> 674</span></a>                  }
<a name="l675"><span class="linenum"> 675</span></a>                  if (!<a class="var it3069" onMouseOver="hilite(3069)" onMouseOut="lolite()" onClick="logVariable('changed')" href="../../../_variables/changed.html">$changed</a>) {
<a name="l676"><span class="linenum"> 676</span></a>                      if (<a class="var it39200" onMouseOver="hilite(39200)" onMouseOut="lolite()" onClick="logVariable('currentrecords')" href="../../../_variables/currentrecords.html">$currentrecords</a>) {
<a name="l677"><span class="linenum"> 677</span></a>                          <a class="var it35072" onMouseOver="hilite(35072)" onMouseOut="lolite()" onClick="logVariable('lastrecord')" href="../../../_variables/lastrecord.html">$lastrecord</a> = <a class="phpfunction" onClick="logFunction('end')" href="../../../_functions/end.html" onMouseOver="phpfuncPopup(event,'end')">end</a>(<a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a>);
<a name="l678"><span class="linenum"> 678</span></a>                          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records_select')" href="../../../_functions/delete_records_select.html" onMouseOver="funcPopup(event,'delete_records_select')">delete_records_select</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>, &quot;id &gt; ?&quot;, array(<a class="var it35072" onMouseOver="hilite(35072)" onMouseOut="lolite()" onClick="logVariable('lastrecord')" href="../../../_variables/lastrecord.html">$lastrecord</a>-&gt;<a onClick="logVariable('id')" class="var it41735" onMouseOver="hilite(41735)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>));
<a name="l679"><span class="linenum"> 679</span></a>                          continue;
<a name="l680"><span class="linenum"> 680</span></a>                      } else {
<a name="l681"><span class="linenum"> 681</span></a>                          continue;
<a name="l682"><span class="linenum"> 682</span></a>                      }
<a name="l683"><span class="linenum"> 683</span></a>                  }
<a name="l684"><span class="linenum"> 684</span></a>              }
<a name="l685"><span class="linenum"> 685</span></a>  
<a name="l686"><span class="linenum"> 686</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>, array());
<a name="l687"><span class="linenum"> 687</span></a>              foreach (<a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../_variables/records.html">$records</a> as <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>) {
<a name="l688"><span class="linenum"> 688</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('import_record')" href="../../../_functions/import_record.html" onMouseOver="funcPopup(event,'import_record')">import_record</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>, <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../_variables/record.html">$record</a>, false, true);
<a name="l689"><span class="linenum"> 689</span></a>              }
<a name="l690"><span class="linenum"> 690</span></a>          }
<a name="l691"><span class="linenum"> 691</span></a>  
<a name="l692"><span class="linenum"> 692</span></a>  <span class="comment">        // reset all next record ids - aka sequences</span>
<a name="l693"><span class="linenum"> 693</span></a>          self::<a class="function" onClick="logFunction('reset_all_database_sequences')" href="../../../_functions/reset_all_database_sequences.html" onMouseOver="funcPopup(event,'reset_all_database_sequences')">reset_all_database_sequences</a>(<a class="var it14953" onMouseOver="hilite(14953)" onMouseOut="lolite()" onClick="logVariable('empties')" href="../../../_variables/empties.html">$empties</a>);
<a name="l694"><span class="linenum"> 694</span></a>  
<a name="l695"><span class="linenum"> 695</span></a>  <span class="comment">        // remove extra tables</span>
<a name="l696"><span class="linenum"> 696</span></a>          foreach (<a class="var it448" onMouseOver="hilite(448)" onMouseOut="lolite()" onClick="logVariable('tables')" href="../../../_variables/tables.html">$tables</a> as <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>) {
<a name="l697"><span class="linenum"> 697</span></a>              if (!isset(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a>[<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>])) {
<a name="l698"><span class="linenum"> 698</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_manager')" href="../../../_functions/get_manager.html" onMouseOver="funcPopup(event,'get_manager')">get_manager</a>()-&gt;<a class="function" onClick="logFunction('drop_table')" href="../../../_functions/drop_table.html" onMouseOver="funcPopup(event,'drop_table')">drop_table</a>(<span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>));
<a name="l699"><span class="linenum"> 699</span></a>              }
<a name="l700"><span class="linenum"> 700</span></a>          }
<a name="l701"><span class="linenum"> 701</span></a>  
<a name="l702"><span class="linenum"> 702</span></a>          return true;
<a name="l703"><span class="linenum"> 703</span></a>      }
<a name="l704"><span class="linenum"> 704</span></a>  
<a name="l705"><span class="linenum"> 705</span></a>      <span class="comment">/**</span>
<a name="l706"><span class="linenum"> 706</span></a>  <span class="comment">     * Purge dataroot directory</span>
<a name="l707"><span class="linenum"> 707</span></a>  <span class="comment">     * @static</span>
<a name="l708"><span class="linenum"> 708</span></a>  <span class="comment">     * @return void</span>
<a name="l709"><span class="linenum"> 709</span></a>  <span class="comment">     */</span>
<a name="l710"><span class="linenum"> 710</span></a>      public static function <a class="function" onClick="logFunction('reset_dataroot')" href="../../../_functions/reset_dataroot.html" onMouseOver="funcPopup(event,'reset_dataroot')">reset_dataroot</a>() {
<a name="l711"><span class="linenum"> 711</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>;
<a name="l712"><span class="linenum"> 712</span></a>  
<a name="l713"><span class="linenum"> 713</span></a>          <a class="var it39201" onMouseOver="hilite(39201)" onMouseOut="lolite()" onClick="logVariable('childclassname')" href="../../../_variables/childclassname.html">$childclassname</a> = self::<a class="function" onClick="logFunction('get_framework')" href="../../../_functions/get_framework.html" onMouseOver="funcPopup(event,'get_framework')">get_framework</a>() . '_util';
<a name="l714"><span class="linenum"> 714</span></a>  
<a name="l715"><span class="linenum"> 715</span></a>  <span class="comment">        // Do not delete automatically installed files.</span>
<a name="l716"><span class="linenum"> 716</span></a>          self::<a class="function" onClick="logFunction('skip_original_data_files')" href="../../../_functions/skip_original_data_files.html" onMouseOver="funcPopup(event,'skip_original_data_files')">skip_original_data_files</a>(<a class="var it39201" onMouseOver="hilite(39201)" onMouseOut="lolite()" onClick="logVariable('childclassname')" href="../../../_variables/childclassname.html">$childclassname</a>);
<a name="l717"><span class="linenum"> 717</span></a>  
<a name="l718"><span class="linenum"> 718</span></a>  <span class="comment">        // Clear file status cache, before checking file_exists.</span>
<a name="l719"><span class="linenum"> 719</span></a>          <a class="phpfunction" onClick="logFunction('clearstatcache')" href="../../../_functions/clearstatcache.html" onMouseOver="phpfuncPopup(event,'clearstatcache')">clearstatcache</a>();
<a name="l720"><span class="linenum"> 720</span></a>  
<a name="l721"><span class="linenum"> 721</span></a>  <span class="comment">        // Clean up the dataroot folder.</span>
<a name="l722"><span class="linenum"> 722</span></a>          <a class="var it1207" onMouseOver="hilite(1207)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../_variables/handle.html">$handle</a> = <a class="phpfunction" onClick="logFunction('opendir')" href="../../../_functions/opendir.html" onMouseOver="phpfuncPopup(event,'opendir')">opendir</a>(self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>());
<a name="l723"><span class="linenum"> 723</span></a>          while (false !== (<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../../_variables/item.html">$item</a> = readdir(<a class="var it1207" onMouseOver="hilite(1207)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../_variables/handle.html">$handle</a>))) {
<a name="l724"><span class="linenum"> 724</span></a>              if (<a class="phpfunction" onClick="logFunction('in_array')" href="../../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../../_variables/item.html">$item</a>, <a class="var it39201" onMouseOver="hilite(39201)" onMouseOut="lolite()" onClick="logVariable('childclassname')" href="../../../_variables/childclassname.html">$childclassname</a>::<a class="var it25854" onMouseOver="hilite(25854)" onMouseOut="lolite()" onClick="logVariable('datarootskiponreset')" href="../../../_variables/datarootskiponreset.html">$datarootskiponreset</a>)) {
<a name="l725"><span class="linenum"> 725</span></a>                  continue;
<a name="l726"><span class="linenum"> 726</span></a>              }
<a name="l727"><span class="linenum"> 727</span></a>              if (<a class="phpfunction" onClick="logFunction('is_dir')" href="../../../_functions/is_dir.html" onMouseOver="phpfuncPopup(event,'is_dir')">is_dir</a>(self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>().&quot;/<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../../_variables/item.html">$item</a>&quot;)) {
<a name="l728"><span class="linenum"> 728</span></a>                  <a class="function" onClick="logFunction('remove_dir')" href="../../../_functions/remove_dir.html" onMouseOver="funcPopup(event,'remove_dir')">remove_dir</a>(self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>().&quot;/<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../../_variables/item.html">$item</a>&quot;, false);
<a name="l729"><span class="linenum"> 729</span></a>              } else {
<a name="l730"><span class="linenum"> 730</span></a>                  <a class="phpfunction" onClick="logFunction('unlink')" href="../../../_functions/unlink.html" onMouseOver="phpfuncPopup(event,'unlink')">unlink</a>(self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>().&quot;/<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../../_variables/item.html">$item</a>&quot;);
<a name="l731"><span class="linenum"> 731</span></a>              }
<a name="l732"><span class="linenum"> 732</span></a>          }
<a name="l733"><span class="linenum"> 733</span></a>          <a class="phpfunction" onClick="logFunction('closedir')" href="../../../_functions/closedir.html" onMouseOver="phpfuncPopup(event,'closedir')">closedir</a>(<a class="var it1207" onMouseOver="hilite(1207)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../_variables/handle.html">$handle</a>);
<a name="l734"><span class="linenum"> 734</span></a>  
<a name="l735"><span class="linenum"> 735</span></a>  <span class="comment">        // Clean up the dataroot/filedir folder.</span>
<a name="l736"><span class="linenum"> 736</span></a>          if (<a class="phpfunction" onClick="logFunction('file_exists')" href="../../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>() . '/filedir')) {
<a name="l737"><span class="linenum"> 737</span></a>              <a class="var it1207" onMouseOver="hilite(1207)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../_variables/handle.html">$handle</a> = <a class="phpfunction" onClick="logFunction('opendir')" href="../../../_functions/opendir.html" onMouseOver="phpfuncPopup(event,'opendir')">opendir</a>(self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>() . '/filedir');
<a name="l738"><span class="linenum"> 738</span></a>              while (false !== (<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../../_variables/item.html">$item</a> = readdir(<a class="var it1207" onMouseOver="hilite(1207)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../_variables/handle.html">$handle</a>))) {
<a name="l739"><span class="linenum"> 739</span></a>                  if (<a class="phpfunction" onClick="logFunction('in_array')" href="../../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>('filedir/' . <a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../../_variables/item.html">$item</a>, <a class="var it39201" onMouseOver="hilite(39201)" onMouseOut="lolite()" onClick="logVariable('childclassname')" href="../../../_variables/childclassname.html">$childclassname</a>::<a class="var it25854" onMouseOver="hilite(25854)" onMouseOut="lolite()" onClick="logVariable('datarootskiponreset')" href="../../../_variables/datarootskiponreset.html">$datarootskiponreset</a>)) {
<a name="l740"><span class="linenum"> 740</span></a>                      continue;
<a name="l741"><span class="linenum"> 741</span></a>                  }
<a name="l742"><span class="linenum"> 742</span></a>                  if (<a class="phpfunction" onClick="logFunction('is_dir')" href="../../../_functions/is_dir.html" onMouseOver="phpfuncPopup(event,'is_dir')">is_dir</a>(self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>().&quot;/filedir/<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../../_variables/item.html">$item</a>&quot;)) {
<a name="l743"><span class="linenum"> 743</span></a>                      <a class="function" onClick="logFunction('remove_dir')" href="../../../_functions/remove_dir.html" onMouseOver="funcPopup(event,'remove_dir')">remove_dir</a>(self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>().&quot;/filedir/<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../../_variables/item.html">$item</a>&quot;, false);
<a name="l744"><span class="linenum"> 744</span></a>                  } else {
<a name="l745"><span class="linenum"> 745</span></a>                      <a class="phpfunction" onClick="logFunction('unlink')" href="../../../_functions/unlink.html" onMouseOver="phpfuncPopup(event,'unlink')">unlink</a>(self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>().&quot;/filedir/<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../../_variables/item.html">$item</a>&quot;);
<a name="l746"><span class="linenum"> 746</span></a>                  }
<a name="l747"><span class="linenum"> 747</span></a>              }
<a name="l748"><span class="linenum"> 748</span></a>              <a class="phpfunction" onClick="logFunction('closedir')" href="../../../_functions/closedir.html" onMouseOver="phpfuncPopup(event,'closedir')">closedir</a>(<a class="var it1207" onMouseOver="hilite(1207)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../_variables/handle.html">$handle</a>);
<a name="l749"><span class="linenum"> 749</span></a>          }
<a name="l750"><span class="linenum"> 750</span></a>  
<a name="l751"><span class="linenum"> 751</span></a>          <a class="function" onClick="logFunction('make_temp_directory')" href="../../../_functions/make_temp_directory.html" onMouseOver="funcPopup(event,'make_temp_directory')">make_temp_directory</a>('');
<a name="l752"><span class="linenum"> 752</span></a>          <a class="function" onClick="logFunction('make_cache_directory')" href="../../../_functions/make_cache_directory.html" onMouseOver="funcPopup(event,'make_cache_directory')">make_cache_directory</a>('');
<a name="l753"><span class="linenum"> 753</span></a>          <a class="function" onClick="logFunction('make_localcache_directory')" href="../../../_functions/make_localcache_directory.html" onMouseOver="funcPopup(event,'make_localcache_directory')">make_localcache_directory</a>('');
<a name="l754"><span class="linenum"> 754</span></a>  <span class="comment">        // Reset the cache API so that it recreates it's required directories as well.</span>
<a name="l755"><span class="linenum"> 755</span></a>          <a class="class" onClick="logClass('cache_factory')" href="../../../_classes/cache_factory.html" onMouseOver="classPopup(event,'cache_factory')">cache_factory</a>::<a class="phpfunction" onClick="logFunction('reset')" href="../../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>();
<a name="l756"><span class="linenum"> 756</span></a>  <span class="comment">        // Purge all data from the caches. This is required for consistency.</span>
<a name="l757"><span class="linenum"> 757</span></a>  <span class="comment">        // Any file caches that happened to be within the data root will have already been clearer (because we just deleted cache)</span>
<a name="l758"><span class="linenum"> 758</span></a>  <span class="comment">        // and now we will purge any other caches as well.</span>
<a name="l759"><span class="linenum"> 759</span></a>          <a class="class" onClick="logClass('cache_helper')" href="../../../_classes/cache_helper.html" onMouseOver="classPopup(event,'cache_helper')">cache_helper</a>::<a class="function" onClick="logFunction('purge_all')" href="../../../_functions/purge_all.html" onMouseOver="funcPopup(event,'purge_all')">purge_all</a>();
<a name="l760"><span class="linenum"> 760</span></a>      }
<a name="l761"><span class="linenum"> 761</span></a>  
<a name="l762"><span class="linenum"> 762</span></a>      <span class="comment">/**</span>
<a name="l763"><span class="linenum"> 763</span></a>  <span class="comment">     * Gets a text-based site version description.</span>
<a name="l764"><span class="linenum"> 764</span></a>  <span class="comment">     *</span>
<a name="l765"><span class="linenum"> 765</span></a>  <span class="comment">     * @return string The site info</span>
<a name="l766"><span class="linenum"> 766</span></a>  <span class="comment">     */</span>
<a name="l767"><span class="linenum"> 767</span></a>      public static function <a class="function" onClick="logFunction('get_site_info')" href="../../../_functions/get_site_info.html" onMouseOver="funcPopup(event,'get_site_info')">get_site_info</a>() {
<a name="l768"><span class="linenum"> 768</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>;
<a name="l769"><span class="linenum"> 769</span></a>  
<a name="l770"><span class="linenum"> 770</span></a>          <a class="var it71" onMouseOver="hilite(71)" onMouseOut="lolite()" onClick="logVariable('output')" href="../../../_variables/output.html">$output</a> = '';
<a name="l771"><span class="linenum"> 771</span></a>  
<a name="l772"><span class="linenum"> 772</span></a>  <span class="comment">        // All developers have to understand English, do not localise!</span>
<a name="l773"><span class="linenum"> 773</span></a>  
<a name="l774"><span class="linenum"> 774</span></a>          <a class="var it1816" onMouseOver="hilite(1816)" onMouseOut="lolite()" onClick="logVariable('release')" href="../../../_variables/release.html">$release</a> = null;
<a name="l775"><span class="linenum"> 775</span></a>          <a class="function" onClick="logFunction('require')" href="../../../_functions/require.html" onMouseOver="funcPopup(event,'require')">require</a>(&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../../_variables/dirroot.html">dirroot</a>/version.php&quot;);
<a name="l776"><span class="linenum"> 776</span></a>  
<a name="l777"><span class="linenum"> 777</span></a>          <a class="var it71" onMouseOver="hilite(71)" onMouseOut="lolite()" onClick="logVariable('output')" href="../../../_variables/output.html">$output</a> .= &quot;Moodle <a class="var it1816" onMouseOver="hilite(1816)" onMouseOut="lolite()" onClick="logVariable('release')" href="../../../_variables/release.html">$release</a>, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dbtype')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../../_variables/dbtype.html">dbtype</a>&quot;;
<a name="l778"><span class="linenum"> 778</span></a>          if (<a class="var it6788" onMouseOver="hilite(6788)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../../../_variables/hash.html">$hash</a> = self::<a class="function" onClick="logFunction('get_git_hash')" href="../../../_functions/get_git_hash.html" onMouseOver="funcPopup(event,'get_git_hash')">get_git_hash</a>()) {
<a name="l779"><span class="linenum"> 779</span></a>              <a class="var it71" onMouseOver="hilite(71)" onMouseOut="lolite()" onClick="logVariable('output')" href="../../../_variables/output.html">$output</a> .= &quot;, <a class="var it6788" onMouseOver="hilite(6788)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../../../_variables/hash.html">$hash</a>&quot;;
<a name="l780"><span class="linenum"> 780</span></a>          }
<a name="l781"><span class="linenum"> 781</span></a>          <a class="var it71" onMouseOver="hilite(71)" onMouseOut="lolite()" onClick="logVariable('output')" href="../../../_variables/output.html">$output</a> .= &quot;\n&quot;;
<a name="l782"><span class="linenum"> 782</span></a>  
<a name="l783"><span class="linenum"> 783</span></a>          return <a class="var it71" onMouseOver="hilite(71)" onMouseOut="lolite()" onClick="logVariable('output')" href="../../../_variables/output.html">$output</a>;
<a name="l784"><span class="linenum"> 784</span></a>      }
<a name="l785"><span class="linenum"> 785</span></a>  
<a name="l786"><span class="linenum"> 786</span></a>      <span class="comment">/**</span>
<a name="l787"><span class="linenum"> 787</span></a>  <span class="comment">     * Try to get current git hash of the Moodle in $CFG-&gt;dirroot.</span>
<a name="l788"><span class="linenum"> 788</span></a>  <span class="comment">     * @return string null if unknown, sha1 hash if known</span>
<a name="l789"><span class="linenum"> 789</span></a>  <span class="comment">     */</span>
<a name="l790"><span class="linenum"> 790</span></a>      public static function <a class="function" onClick="logFunction('get_git_hash')" href="../../../_functions/get_git_hash.html" onMouseOver="funcPopup(event,'get_git_hash')">get_git_hash</a>() {
<a name="l791"><span class="linenum"> 791</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>;
<a name="l792"><span class="linenum"> 792</span></a>  
<a name="l793"><span class="linenum"> 793</span></a>  <span class="comment">        // This is a bit naive, but it should mostly work for all platforms.</span>
<a name="l794"><span class="linenum"> 794</span></a>  
<a name="l795"><span class="linenum"> 795</span></a>          if (!<a class="phpfunction" onClick="logFunction('file_exists')" href="../../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../../_variables/dirroot.html">dirroot</a>/.git/HEAD&quot;)) {
<a name="l796"><span class="linenum"> 796</span></a>              return null;
<a name="l797"><span class="linenum"> 797</span></a>          }
<a name="l798"><span class="linenum"> 798</span></a>  
<a name="l799"><span class="linenum"> 799</span></a>          <a class="var it39202" onMouseOver="hilite(39202)" onMouseOut="lolite()" onClick="logVariable('headcontent')" href="../../../_variables/headcontent.html">$headcontent</a> = <a class="phpfunction" onClick="logFunction('file_get_contents')" href="../../../_functions/file_get_contents.html" onMouseOver="phpfuncPopup(event,'file_get_contents')">file_get_contents</a>(&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../../_variables/dirroot.html">dirroot</a>/.git/HEAD&quot;);
<a name="l800"><span class="linenum"> 800</span></a>          if (<a class="var it39202" onMouseOver="hilite(39202)" onMouseOut="lolite()" onClick="logVariable('headcontent')" href="../../../_variables/headcontent.html">$headcontent</a> === false) {
<a name="l801"><span class="linenum"> 801</span></a>              return null;
<a name="l802"><span class="linenum"> 802</span></a>          }
<a name="l803"><span class="linenum"> 803</span></a>  
<a name="l804"><span class="linenum"> 804</span></a>          <a class="var it39202" onMouseOver="hilite(39202)" onMouseOut="lolite()" onClick="logVariable('headcontent')" href="../../../_variables/headcontent.html">$headcontent</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it39202" onMouseOver="hilite(39202)" onMouseOut="lolite()" onClick="logVariable('headcontent')" href="../../../_variables/headcontent.html">$headcontent</a>);
<a name="l805"><span class="linenum"> 805</span></a>  
<a name="l806"><span class="linenum"> 806</span></a>  <span class="comment">        // If it is pointing to a hash we return it directly.</span>
<a name="l807"><span class="linenum"> 807</span></a>          if (<a class="function" onClick="logFunction('strlen')" href="../../../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it39202" onMouseOver="hilite(39202)" onMouseOut="lolite()" onClick="logVariable('headcontent')" href="../../../_variables/headcontent.html">$headcontent</a>) === 40) {
<a name="l808"><span class="linenum"> 808</span></a>              return <a class="var it39202" onMouseOver="hilite(39202)" onMouseOut="lolite()" onClick="logVariable('headcontent')" href="../../../_variables/headcontent.html">$headcontent</a>;
<a name="l809"><span class="linenum"> 809</span></a>          }
<a name="l810"><span class="linenum"> 810</span></a>  
<a name="l811"><span class="linenum"> 811</span></a>          if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it39202" onMouseOver="hilite(39202)" onMouseOut="lolite()" onClick="logVariable('headcontent')" href="../../../_variables/headcontent.html">$headcontent</a>, 'ref: ') !== 0) {
<a name="l812"><span class="linenum"> 812</span></a>              return null;
<a name="l813"><span class="linenum"> 813</span></a>          }
<a name="l814"><span class="linenum"> 814</span></a>  
<a name="l815"><span class="linenum"> 815</span></a>          <a class="var it3592" onMouseOver="hilite(3592)" onMouseOut="lolite()" onClick="logVariable('ref')" href="../../../_variables/ref.html">$ref</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it39202" onMouseOver="hilite(39202)" onMouseOut="lolite()" onClick="logVariable('headcontent')" href="../../../_variables/headcontent.html">$headcontent</a>, 5);
<a name="l816"><span class="linenum"> 816</span></a>  
<a name="l817"><span class="linenum"> 817</span></a>          if (!<a class="phpfunction" onClick="logFunction('file_exists')" href="../../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../../_variables/dirroot.html">dirroot</a>/.git/<a class="var it3592" onMouseOver="hilite(3592)" onMouseOut="lolite()" onClick="logVariable('ref')" href="../../../_variables/ref.html">$ref</a>&quot;)) {
<a name="l818"><span class="linenum"> 818</span></a>              return null;
<a name="l819"><span class="linenum"> 819</span></a>          }
<a name="l820"><span class="linenum"> 820</span></a>  
<a name="l821"><span class="linenum"> 821</span></a>          <a class="var it6788" onMouseOver="hilite(6788)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../../../_variables/hash.html">$hash</a> = <a class="phpfunction" onClick="logFunction('file_get_contents')" href="../../../_functions/file_get_contents.html" onMouseOver="phpfuncPopup(event,'file_get_contents')">file_get_contents</a>(&quot;<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../../_variables/dirroot.html">dirroot</a>/.git/<a class="var it3592" onMouseOver="hilite(3592)" onMouseOut="lolite()" onClick="logVariable('ref')" href="../../../_variables/ref.html">$ref</a>&quot;);
<a name="l822"><span class="linenum"> 822</span></a>  
<a name="l823"><span class="linenum"> 823</span></a>          if (<a class="var it6788" onMouseOver="hilite(6788)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../../../_variables/hash.html">$hash</a> === false) {
<a name="l824"><span class="linenum"> 824</span></a>              return null;
<a name="l825"><span class="linenum"> 825</span></a>          }
<a name="l826"><span class="linenum"> 826</span></a>  
<a name="l827"><span class="linenum"> 827</span></a>          <a class="var it6788" onMouseOver="hilite(6788)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../../../_variables/hash.html">$hash</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it6788" onMouseOver="hilite(6788)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../../../_variables/hash.html">$hash</a>);
<a name="l828"><span class="linenum"> 828</span></a>  
<a name="l829"><span class="linenum"> 829</span></a>          if (<a class="function" onClick="logFunction('strlen')" href="../../../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it6788" onMouseOver="hilite(6788)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../../../_variables/hash.html">$hash</a>) != 40) {
<a name="l830"><span class="linenum"> 830</span></a>              return null;
<a name="l831"><span class="linenum"> 831</span></a>          }
<a name="l832"><span class="linenum"> 832</span></a>  
<a name="l833"><span class="linenum"> 833</span></a>          return <a class="var it6788" onMouseOver="hilite(6788)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../../../_variables/hash.html">$hash</a>;
<a name="l834"><span class="linenum"> 834</span></a>      }
<a name="l835"><span class="linenum"> 835</span></a>  
<a name="l836"><span class="linenum"> 836</span></a>      <span class="comment">/**</span>
<a name="l837"><span class="linenum"> 837</span></a>  <span class="comment">     * Drop the whole test database</span>
<a name="l838"><span class="linenum"> 838</span></a>  <span class="comment">     * @static</span>
<a name="l839"><span class="linenum"> 839</span></a>  <span class="comment">     * @param bool $displayprogress</span>
<a name="l840"><span class="linenum"> 840</span></a>  <span class="comment">     */</span>
<a name="l841"><span class="linenum"> 841</span></a>      protected static function <a class="function" onClick="logFunction('drop_database')" href="../../../_functions/drop_database.html" onMouseOver="funcPopup(event,'drop_database')">drop_database</a>(<a class="var it25861" onMouseOver="hilite(25861)" onMouseOut="lolite()" onClick="logVariable('displayprogress')" href="../../../_variables/displayprogress.html">$displayprogress</a> = false) {
<a name="l842"><span class="linenum"> 842</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l843"><span class="linenum"> 843</span></a>  
<a name="l844"><span class="linenum"> 844</span></a>          <a class="var it448" onMouseOver="hilite(448)" onMouseOut="lolite()" onClick="logVariable('tables')" href="../../../_variables/tables.html">$tables</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_tables')" href="../../../_functions/get_tables.html" onMouseOver="funcPopup(event,'get_tables')">get_tables</a>(false);
<a name="l845"><span class="linenum"> 845</span></a>          if (isset(<a class="var it448" onMouseOver="hilite(448)" onMouseOut="lolite()" onClick="logVariable('tables')" href="../../../_variables/tables.html">$tables</a>['config'])) {
<a name="l846"><span class="linenum"> 846</span></a>  <span class="comment">            // config always last to prevent problems with interrupted drops!</span>
<a name="l847"><span class="linenum"> 847</span></a>              unset(<a class="var it448" onMouseOver="hilite(448)" onMouseOut="lolite()" onClick="logVariable('tables')" href="../../../_variables/tables.html">$tables</a>['config']);
<a name="l848"><span class="linenum"> 848</span></a>              <a class="var it448" onMouseOver="hilite(448)" onMouseOut="lolite()" onClick="logVariable('tables')" href="../../../_variables/tables.html">$tables</a>['config'] = 'config';
<a name="l849"><span class="linenum"> 849</span></a>          }
<a name="l850"><span class="linenum"> 850</span></a>  
<a name="l851"><span class="linenum"> 851</span></a>          if (<a class="var it25861" onMouseOver="hilite(25861)" onMouseOut="lolite()" onClick="logVariable('displayprogress')" href="../../../_variables/displayprogress.html">$displayprogress</a>) {
<a name="l852"><span class="linenum"> 852</span></a>              echo &quot;Dropping tables:\n&quot;;
<a name="l853"><span class="linenum"> 853</span></a>          }
<a name="l854"><span class="linenum"> 854</span></a>          <a class="var it39203" onMouseOver="hilite(39203)" onMouseOut="lolite()" onClick="logVariable('dotsonline')" href="../../../_variables/dotsonline.html">$dotsonline</a> = 0;
<a name="l855"><span class="linenum"> 855</span></a>          foreach (<a class="var it448" onMouseOver="hilite(448)" onMouseOut="lolite()" onClick="logVariable('tables')" href="../../../_variables/tables.html">$tables</a> as <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('tablename')" href="../../../_variables/tablename.html">$tablename</a>) {
<a name="l856"><span class="linenum"> 856</span></a>              <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a> = <span class="keyword">new </span><a class="class" onClick="logClass('xmldb_table')" href="../../../_classes/xmldb_table.html" onMouseOver="classPopup(event,'xmldb_table')">xmldb_table</a>(<a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('tablename')" href="../../../_variables/tablename.html">$tablename</a>);
<a name="l857"><span class="linenum"> 857</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_manager')" href="../../../_functions/get_manager.html" onMouseOver="funcPopup(event,'get_manager')">get_manager</a>()-&gt;<a class="function" onClick="logFunction('drop_table')" href="../../../_functions/drop_table.html" onMouseOver="funcPopup(event,'drop_table')">drop_table</a>(<a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../../_variables/table.html">$table</a>);
<a name="l858"><span class="linenum"> 858</span></a>  
<a name="l859"><span class="linenum"> 859</span></a>              if (<a class="var it39203" onMouseOver="hilite(39203)" onMouseOut="lolite()" onClick="logVariable('dotsonline')" href="../../../_variables/dotsonline.html">$dotsonline</a> == 60) {
<a name="l860"><span class="linenum"> 860</span></a>                  if (<a class="var it25861" onMouseOver="hilite(25861)" onMouseOut="lolite()" onClick="logVariable('displayprogress')" href="../../../_variables/displayprogress.html">$displayprogress</a>) {
<a name="l861"><span class="linenum"> 861</span></a>                      echo &quot;\n&quot;;
<a name="l862"><span class="linenum"> 862</span></a>                  }
<a name="l863"><span class="linenum"> 863</span></a>                  <a class="var it39203" onMouseOver="hilite(39203)" onMouseOut="lolite()" onClick="logVariable('dotsonline')" href="../../../_variables/dotsonline.html">$dotsonline</a> = 0;
<a name="l864"><span class="linenum"> 864</span></a>              }
<a name="l865"><span class="linenum"> 865</span></a>              if (<a class="var it25861" onMouseOver="hilite(25861)" onMouseOut="lolite()" onClick="logVariable('displayprogress')" href="../../../_variables/displayprogress.html">$displayprogress</a>) {
<a name="l866"><span class="linenum"> 866</span></a>                  echo '.';
<a name="l867"><span class="linenum"> 867</span></a>              }
<a name="l868"><span class="linenum"> 868</span></a>              <a class="var it39203" onMouseOver="hilite(39203)" onMouseOut="lolite()" onClick="logVariable('dotsonline')" href="../../../_variables/dotsonline.html">$dotsonline</a> += 1;
<a name="l869"><span class="linenum"> 869</span></a>          }
<a name="l870"><span class="linenum"> 870</span></a>          if (<a class="var it25861" onMouseOver="hilite(25861)" onMouseOut="lolite()" onClick="logVariable('displayprogress')" href="../../../_variables/displayprogress.html">$displayprogress</a>) {
<a name="l871"><span class="linenum"> 871</span></a>              echo &quot;\n&quot;;
<a name="l872"><span class="linenum"> 872</span></a>          }
<a name="l873"><span class="linenum"> 873</span></a>      }
<a name="l874"><span class="linenum"> 874</span></a>  
<a name="l875"><span class="linenum"> 875</span></a>      <span class="comment">/**</span>
<a name="l876"><span class="linenum"> 876</span></a>  <span class="comment">     * Drops the test framework dataroot</span>
<a name="l877"><span class="linenum"> 877</span></a>  <span class="comment">     * @static</span>
<a name="l878"><span class="linenum"> 878</span></a>  <span class="comment">     */</span>
<a name="l879"><span class="linenum"> 879</span></a>      protected static function <a class="function" onClick="logFunction('drop_dataroot')" href="../../../_functions/drop_dataroot.html" onMouseOver="funcPopup(event,'drop_dataroot')">drop_dataroot</a>() {
<a name="l880"><span class="linenum"> 880</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>;
<a name="l881"><span class="linenum"> 881</span></a>  
<a name="l882"><span class="linenum"> 882</span></a>          <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a> = self::<a class="function" onClick="logFunction('get_framework')" href="../../../_functions/get_framework.html" onMouseOver="funcPopup(event,'get_framework')">get_framework</a>();
<a name="l883"><span class="linenum"> 883</span></a>          <a class="var it39201" onMouseOver="hilite(39201)" onMouseOut="lolite()" onClick="logVariable('childclassname')" href="../../../_variables/childclassname.html">$childclassname</a> = <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a> . '_util';
<a name="l884"><span class="linenum"> 884</span></a>  
<a name="l885"><span class="linenum"> 885</span></a>          <a class="var it595" onMouseOver="hilite(595)" onMouseOut="lolite()" onClick="logVariable('files')" href="../../../_variables/files.html">$files</a> = <a class="phpfunction" onClick="logFunction('scandir')" href="../../../_functions/scandir.html" onMouseOver="phpfuncPopup(event,'scandir')">scandir</a>(self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>() . '/'  . <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a>);
<a name="l886"><span class="linenum"> 886</span></a>          foreach (<a class="var it595" onMouseOver="hilite(595)" onMouseOut="lolite()" onClick="logVariable('files')" href="../../../_variables/files.html">$files</a> as <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../../_variables/file.html">$file</a>) {
<a name="l887"><span class="linenum"> 887</span></a>              if (<a class="phpfunction" onClick="logFunction('in_array')" href="../../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../../_variables/file.html">$file</a>, <a class="var it39201" onMouseOver="hilite(39201)" onMouseOut="lolite()" onClick="logVariable('childclassname')" href="../../../_variables/childclassname.html">$childclassname</a>::<a class="var it25855" onMouseOver="hilite(25855)" onMouseOut="lolite()" onClick="logVariable('datarootskipondrop')" href="../../../_variables/datarootskipondrop.html">$datarootskipondrop</a>)) {
<a name="l888"><span class="linenum"> 888</span></a>                  continue;
<a name="l889"><span class="linenum"> 889</span></a>              }
<a name="l890"><span class="linenum"> 890</span></a>              <a class="var it154" onMouseOver="hilite(154)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../_variables/path.html">$path</a> = self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>() . '/' . <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('framework')" href="../../../_variables/framework.html">$framework</a> . '/' . <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../../_variables/file.html">$file</a>;
<a name="l891"><span class="linenum"> 891</span></a>              if (<a class="phpfunction" onClick="logFunction('is_dir')" href="../../../_functions/is_dir.html" onMouseOver="phpfuncPopup(event,'is_dir')">is_dir</a>(<a class="var it154" onMouseOver="hilite(154)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../_variables/path.html">$path</a>)) {
<a name="l892"><span class="linenum"> 892</span></a>                  <a class="function" onClick="logFunction('remove_dir')" href="../../../_functions/remove_dir.html" onMouseOver="funcPopup(event,'remove_dir')">remove_dir</a>(<a class="var it154" onMouseOver="hilite(154)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../_variables/path.html">$path</a>, false);
<a name="l893"><span class="linenum"> 893</span></a>              } else {
<a name="l894"><span class="linenum"> 894</span></a>                  <a class="phpfunction" onClick="logFunction('unlink')" href="../../../_functions/unlink.html" onMouseOver="phpfuncPopup(event,'unlink')">unlink</a>(<a class="var it154" onMouseOver="hilite(154)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../_variables/path.html">$path</a>);
<a name="l895"><span class="linenum"> 895</span></a>              }
<a name="l896"><span class="linenum"> 896</span></a>          }
<a name="l897"><span class="linenum"> 897</span></a>  
<a name="l898"><span class="linenum"> 898</span></a>          <a class="var it39204" onMouseOver="hilite(39204)" onMouseOut="lolite()" onClick="logVariable('jsonfilepath')" href="../../../_variables/jsonfilepath.html">$jsonfilepath</a> = self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>() . '/' . self::<a class="var it39192" onMouseOver="hilite(39192)" onMouseOut="lolite()" onClick="logVariable('originaldatafilesjson')" href="../../../_variables/originaldatafilesjson.html">$originaldatafilesjson</a>;
<a name="l899"><span class="linenum"> 899</span></a>          if (<a class="phpfunction" onClick="logFunction('file_exists')" href="../../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it39204" onMouseOver="hilite(39204)" onMouseOut="lolite()" onClick="logVariable('jsonfilepath')" href="../../../_variables/jsonfilepath.html">$jsonfilepath</a>)) {
<a name="l900"><span class="linenum"> 900</span></a>  <span class="comment">            // Delete the json file.</span>
<a name="l901"><span class="linenum"> 901</span></a>              <a class="phpfunction" onClick="logFunction('unlink')" href="../../../_functions/unlink.html" onMouseOver="phpfuncPopup(event,'unlink')">unlink</a>(<a class="var it39204" onMouseOver="hilite(39204)" onMouseOut="lolite()" onClick="logVariable('jsonfilepath')" href="../../../_variables/jsonfilepath.html">$jsonfilepath</a>);
<a name="l902"><span class="linenum"> 902</span></a>  <span class="comment">            // Delete the dataroot filedir.</span>
<a name="l903"><span class="linenum"> 903</span></a>              <a class="function" onClick="logFunction('remove_dir')" href="../../../_functions/remove_dir.html" onMouseOver="funcPopup(event,'remove_dir')">remove_dir</a>(self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>() . '/filedir', false);
<a name="l904"><span class="linenum"> 904</span></a>          }
<a name="l905"><span class="linenum"> 905</span></a>      }
<a name="l906"><span class="linenum"> 906</span></a>  
<a name="l907"><span class="linenum"> 907</span></a>      <span class="comment">/**</span>
<a name="l908"><span class="linenum"> 908</span></a>  <span class="comment">     * Skip the original dataroot files to not been reset.</span>
<a name="l909"><span class="linenum"> 909</span></a>  <span class="comment">     *</span>
<a name="l910"><span class="linenum"> 910</span></a>  <span class="comment">     * @static</span>
<a name="l911"><span class="linenum"> 911</span></a>  <span class="comment">     * @param string $utilclassname the util class name..</span>
<a name="l912"><span class="linenum"> 912</span></a>  <span class="comment">     */</span>
<a name="l913"><span class="linenum"> 913</span></a>      protected static function <a class="function" onClick="logFunction('skip_original_data_files')" href="../../../_functions/skip_original_data_files.html" onMouseOver="funcPopup(event,'skip_original_data_files')">skip_original_data_files</a>(<a class="var it39205" onMouseOver="hilite(39205)" onMouseOut="lolite()" onClick="logVariable('utilclassname')" href="../../../_variables/utilclassname.html">$utilclassname</a>) {
<a name="l914"><span class="linenum"> 914</span></a>          <a class="var it39204" onMouseOver="hilite(39204)" onMouseOut="lolite()" onClick="logVariable('jsonfilepath')" href="../../../_variables/jsonfilepath.html">$jsonfilepath</a> = self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>() . '/' . self::<a class="var it39192" onMouseOver="hilite(39192)" onMouseOut="lolite()" onClick="logVariable('originaldatafilesjson')" href="../../../_variables/originaldatafilesjson.html">$originaldatafilesjson</a>;
<a name="l915"><span class="linenum"> 915</span></a>          if (<a class="phpfunction" onClick="logFunction('file_exists')" href="../../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it39204" onMouseOver="hilite(39204)" onMouseOut="lolite()" onClick="logVariable('jsonfilepath')" href="../../../_variables/jsonfilepath.html">$jsonfilepath</a>)) {
<a name="l916"><span class="linenum"> 916</span></a>  
<a name="l917"><span class="linenum"> 917</span></a>              <a class="var it39206" onMouseOver="hilite(39206)" onMouseOut="lolite()" onClick="logVariable('listfiles')" href="../../../_variables/listfiles.html">$listfiles</a> = <a class="phpfunction" onClick="logFunction('file_get_contents')" href="../../../_functions/file_get_contents.html" onMouseOver="phpfuncPopup(event,'file_get_contents')">file_get_contents</a>(<a class="var it39204" onMouseOver="hilite(39204)" onMouseOut="lolite()" onClick="logVariable('jsonfilepath')" href="../../../_variables/jsonfilepath.html">$jsonfilepath</a>);
<a name="l918"><span class="linenum"> 918</span></a>  
<a name="l919"><span class="linenum"> 919</span></a>  <span class="comment">            // Mark each files as to not be reset.</span>
<a name="l920"><span class="linenum"> 920</span></a>              if (!empty(<a class="var it39206" onMouseOver="hilite(39206)" onMouseOut="lolite()" onClick="logVariable('listfiles')" href="../../../_variables/listfiles.html">$listfiles</a>) &amp;&amp; !self::<a class="var it39193" onMouseOver="hilite(39193)" onMouseOut="lolite()" onClick="logVariable('originaldatafilesjsonadded')" href="../../../_variables/originaldatafilesjsonadded.html">$originaldatafilesjsonadded</a>) {
<a name="l921"><span class="linenum"> 921</span></a>                  <a class="var it39207" onMouseOver="hilite(39207)" onMouseOut="lolite()" onClick="logVariable('originaldatarootfiles')" href="../../../_variables/originaldatarootfiles.html">$originaldatarootfiles</a> = json_decode(<a class="var it39206" onMouseOver="hilite(39206)" onMouseOut="lolite()" onClick="logVariable('listfiles')" href="../../../_variables/listfiles.html">$listfiles</a>);
<a name="l922"><span class="linenum"> 922</span></a>  <span class="comment">                // Keep the json file. Only drop_dataroot() should delete it.</span>
<a name="l923"><span class="linenum"> 923</span></a>                  <a class="var it39207" onMouseOver="hilite(39207)" onMouseOut="lolite()" onClick="logVariable('originaldatarootfiles')" href="../../../_variables/originaldatarootfiles.html">$originaldatarootfiles</a>[] = self::<a class="var it39192" onMouseOver="hilite(39192)" onMouseOut="lolite()" onClick="logVariable('originaldatafilesjson')" href="../../../_variables/originaldatafilesjson.html">$originaldatafilesjson</a>;
<a name="l924"><span class="linenum"> 924</span></a>                  <a class="var it39205" onMouseOver="hilite(39205)" onMouseOut="lolite()" onClick="logVariable('utilclassname')" href="../../../_variables/utilclassname.html">$utilclassname</a>::<a class="var it25854" onMouseOver="hilite(25854)" onMouseOut="lolite()" onClick="logVariable('datarootskiponreset')" href="../../../_variables/datarootskiponreset.html">$datarootskiponreset</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it39205" onMouseOver="hilite(39205)" onMouseOut="lolite()" onClick="logVariable('utilclassname')" href="../../../_variables/utilclassname.html">$utilclassname</a>::<a class="var it25854" onMouseOver="hilite(25854)" onMouseOut="lolite()" onClick="logVariable('datarootskiponreset')" href="../../../_variables/datarootskiponreset.html">$datarootskiponreset</a>,
<a name="l925"><span class="linenum"> 925</span></a>                      <a class="var it39207" onMouseOver="hilite(39207)" onMouseOut="lolite()" onClick="logVariable('originaldatarootfiles')" href="../../../_variables/originaldatarootfiles.html">$originaldatarootfiles</a>);
<a name="l926"><span class="linenum"> 926</span></a>                  self::<a class="var it39193" onMouseOver="hilite(39193)" onMouseOut="lolite()" onClick="logVariable('originaldatafilesjsonadded')" href="../../../_variables/originaldatafilesjsonadded.html">$originaldatafilesjsonadded</a> = true;
<a name="l927"><span class="linenum"> 927</span></a>              }
<a name="l928"><span class="linenum"> 928</span></a>          }
<a name="l929"><span class="linenum"> 929</span></a>      }
<a name="l930"><span class="linenum"> 930</span></a>  
<a name="l931"><span class="linenum"> 931</span></a>      <span class="comment">/**</span>
<a name="l932"><span class="linenum"> 932</span></a>  <span class="comment">     * Save the list of the original dataroot files into a json file.</span>
<a name="l933"><span class="linenum"> 933</span></a>  <span class="comment">     */</span>
<a name="l934"><span class="linenum"> 934</span></a>      protected static function <a class="function" onClick="logFunction('save_original_data_files')" href="../../../_functions/save_original_data_files.html" onMouseOver="funcPopup(event,'save_original_data_files')">save_original_data_files</a>() {
<a name="l935"><span class="linenum"> 935</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>;
<a name="l936"><span class="linenum"> 936</span></a>  
<a name="l937"><span class="linenum"> 937</span></a>          <a class="var it39204" onMouseOver="hilite(39204)" onMouseOut="lolite()" onClick="logVariable('jsonfilepath')" href="../../../_variables/jsonfilepath.html">$jsonfilepath</a> = self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>() . '/' . self::<a class="var it39192" onMouseOver="hilite(39192)" onMouseOut="lolite()" onClick="logVariable('originaldatafilesjson')" href="../../../_variables/originaldatafilesjson.html">$originaldatafilesjson</a>;
<a name="l938"><span class="linenum"> 938</span></a>  
<a name="l939"><span class="linenum"> 939</span></a>  <span class="comment">        // Save the original dataroot files if not done (only executed the first time).</span>
<a name="l940"><span class="linenum"> 940</span></a>          if (!<a class="phpfunction" onClick="logFunction('file_exists')" href="../../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it39204" onMouseOver="hilite(39204)" onMouseOut="lolite()" onClick="logVariable('jsonfilepath')" href="../../../_variables/jsonfilepath.html">$jsonfilepath</a>)) {
<a name="l941"><span class="linenum"> 941</span></a>  
<a name="l942"><span class="linenum"> 942</span></a>              <a class="var it39206" onMouseOver="hilite(39206)" onMouseOut="lolite()" onClick="logVariable('listfiles')" href="../../../_variables/listfiles.html">$listfiles</a> = array();
<a name="l943"><span class="linenum"> 943</span></a>              <a class="var it39206" onMouseOver="hilite(39206)" onMouseOut="lolite()" onClick="logVariable('listfiles')" href="../../../_variables/listfiles.html">$listfiles</a>['filedir/.'] = 'filedir/.';
<a name="l944"><span class="linenum"> 944</span></a>              <a class="var it39206" onMouseOver="hilite(39206)" onMouseOut="lolite()" onClick="logVariable('listfiles')" href="../../../_variables/listfiles.html">$listfiles</a>['filedir/..'] = 'filedir/..';
<a name="l945"><span class="linenum"> 945</span></a>  
<a name="l946"><span class="linenum"> 946</span></a>              <a class="var it13107" onMouseOver="hilite(13107)" onMouseOut="lolite()" onClick="logVariable('filedir')" href="../../../_variables/filedir.html">$filedir</a> = self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>() . '/filedir';
<a name="l947"><span class="linenum"> 947</span></a>              if (<a class="phpfunction" onClick="logFunction('file_exists')" href="../../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it13107" onMouseOver="hilite(13107)" onMouseOut="lolite()" onClick="logVariable('filedir')" href="../../../_variables/filedir.html">$filedir</a>)) {
<a name="l948"><span class="linenum"> 948</span></a>                  <a class="var it3461" onMouseOver="hilite(3461)" onMouseOut="lolite()" onClick="logVariable('directory')" href="../../../_variables/directory.html">$directory</a> = new RecursiveDirectoryIterator(<a class="var it13107" onMouseOver="hilite(13107)" onMouseOut="lolite()" onClick="logVariable('filedir')" href="../../../_variables/filedir.html">$filedir</a>);
<a name="l949"><span class="linenum"> 949</span></a>                  foreach (new RecursiveIteratorIterator(<a class="var it3461" onMouseOver="hilite(3461)" onMouseOut="lolite()" onClick="logVariable('directory')" href="../../../_variables/directory.html">$directory</a>) as <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../../_variables/file.html">$file</a>) {
<a name="l950"><span class="linenum"> 950</span></a>                      if (<a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../../_variables/file.html">$file</a>-&gt;isDir()) {
<a name="l951"><span class="linenum"> 951</span></a>                          <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../../_variables/file.html">$file</a>-&gt;<a class="function" onClick="logFunction('getPath')" href="../../../_functions/getpath.html" onMouseOver="funcPopup(event,'getpath')">getPath</a>(), <a class="function" onClick="logFunction('strlen')" href="../../../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>() . '/'));
<a name="l952"><span class="linenum"> 952</span></a>                      } else {
<a name="l953"><span class="linenum"> 953</span></a>                          <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../../_variables/file.html">$file</a>-&gt;getPathName(), <a class="function" onClick="logFunction('strlen')" href="../../../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(self::<a class="function" onClick="logFunction('get_dataroot')" href="../../../_functions/get_dataroot.html" onMouseOver="funcPopup(event,'get_dataroot')">get_dataroot</a>() . '/'));
<a name="l954"><span class="linenum"> 954</span></a>                      }
<a name="l955"><span class="linenum"> 955</span></a>                      <a class="var it39206" onMouseOver="hilite(39206)" onMouseOut="lolite()" onClick="logVariable('listfiles')" href="../../../_variables/listfiles.html">$listfiles</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>] = <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>;
<a name="l956"><span class="linenum"> 956</span></a>                  }
<a name="l957"><span class="linenum"> 957</span></a>              }
<a name="l958"><span class="linenum"> 958</span></a>  
<a name="l959"><span class="linenum"> 959</span></a>  <span class="comment">            // Save the file list in a JSON file.</span>
<a name="l960"><span class="linenum"> 960</span></a>              <a class="var it773" onMouseOver="hilite(773)" onMouseOut="lolite()" onClick="logVariable('fp')" href="../../../_variables/fp.html">$fp</a> = <a class="function" onClick="logFunction('fopen')" href="../../../_functions/fopen.html" onMouseOver="funcPopup(event,'fopen')">fopen</a>(<a class="var it39204" onMouseOver="hilite(39204)" onMouseOut="lolite()" onClick="logVariable('jsonfilepath')" href="../../../_variables/jsonfilepath.html">$jsonfilepath</a>, 'w');
<a name="l961"><span class="linenum"> 961</span></a>              <a class="phpfunction" onClick="logFunction('fwrite')" href="../../../_functions/fwrite.html" onMouseOver="phpfuncPopup(event,'fwrite')">fwrite</a>(<a class="var it773" onMouseOver="hilite(773)" onMouseOut="lolite()" onClick="logVariable('fp')" href="../../../_variables/fp.html">$fp</a>, <a class="function" onClick="logFunction('json_encode')" href="../../../_functions/json_encode.html" onMouseOver="funcPopup(event,'json_encode')">json_encode</a>(<a class="phpfunction" onClick="logFunction('array_values')" href="../../../_functions/array_values.html" onMouseOver="phpfuncPopup(event,'array_values')">array_values</a>(<a class="var it39206" onMouseOver="hilite(39206)" onMouseOut="lolite()" onClick="logVariable('listfiles')" href="../../../_variables/listfiles.html">$listfiles</a>)));
<a name="l962"><span class="linenum"> 962</span></a>              <a class="phpfunction" onClick="logFunction('fclose')" href="../../../_functions/fclose.html" onMouseOver="phpfuncPopup(event,'fclose')">fclose</a>(<a class="var it773" onMouseOver="hilite(773)" onMouseOut="lolite()" onClick="logVariable('fp')" href="../../../_variables/fp.html">$fp</a>);
<a name="l963"><span class="linenum"> 963</span></a>          }
<a name="l964"><span class="linenum"> 964</span></a>      }
<a name="l965"><span class="linenum"> 965</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'set_config': ['set_config', 'Set a configuration value for this plugin ', [['mod/assign','assignmentplugin.php',314],['lib/portfolio','plugin.php',515],['lib','moodlelib.php',1331],['lib','enrollib.php',1152],['lib/editor/tinymce/classes','plugin.php',84]], 985],
'reset_sequence': ['reset_sequence', 'Reset a sequence to the id field of a table. ', [['lib/ddl','database_manager.php',102]], 12],
'fopen': ['fopen', 'Return a stream handle to this string stream. ', [['lib/horde/framework/Horde/Support','StringStream.php',41],['lib/horde/framework/Horde/Support','CombineStream.php',41]], 231],
'set_dataroot': ['set_dataroot', 'Set the dataroot. It\'s useful when mocking the dataroot when unit testing this class itself. ', [['lib/testing/classes','util.php',108]], 0],
'get_config': ['get_config', 'Get a configuration value for this plugin ', [['mod/assign','assignmentplugin.php',345],['lib/portfolio','plugin.php',546],['question/engine','bank.php',109],['lib','moodlelib.php',1404],['lib','enrollib.php',1141],['lib/editor/tinymce/classes','plugin.php',73],['admin/tool/log/classes/helper','store.php',63]], 847],
'get_tabledata': ['get_tabledata', 'Returns contents of all tables right after installation. ', [['lib/testing/classes','util.php',260]], 2],
'get_all_versions_hash': ['get_all_versions_hash', 'Returns hash of all versions including core and all plugins. ', [['lib/classes','component.php',1069]], 5],
'getsequencefromdb': ['getsequencefromdb', 'Given one xmldb_table returns one string with the sequence of the table in the table (fetched from DB) The sequence name for oracle is calculated by looking the corresponding trigger and retrieving the sequence name from it (because sequences are independent elements) ', [['lib/ddl','oracle_sql_generator.php',570],['lib/ddl','sql_generator.php',1218],['lib/ddl','postgres_sql_generator.php',433]], 4],
'testing_error': ['testing_error', 'Prints an error and stops execution ', [['lib/testing','lib.php',148]], 4],
'testing_fix_file_permissions': ['testing_fix_file_permissions', 'Try to change permissions to $CFG->dirroot or $CFG->dataroot if possible ', [['lib/testing','lib.php',64]], 8],
'is_test_site': ['is_test_site', 'Does this site (db and dataroot) appear to be used for production? We try very hard to prevent accidental damage done to production servers!! ', [['lib/testing/classes','util.php',141]], 5],
'is_test_data_updated': ['is_test_data_updated', 'Returns whether test database and dataroot were created using the current version codebase ', [['lib/testing/classes','util.php',172]], 3],
'guess_unmodified_empty_tables': ['guess_unmodified_empty_tables', 'Returns list of tables that are unmodified and empty. ', [['lib/testing/classes','util.php',343]], 2],
'get_sequencenames': ['get_sequencenames', 'Returns the names of sequences for each autoincrementing id field in all standard tables. ', [['lib/testing/classes','util.php',316]], 2],
'strlen': ['strlen', 'Multibyte safe strlen() function, uses mbstring or iconv for UTF-8, falls back to typo3. ', [['lib/classes','text.php',281],['lib/typo3','class.t3lib_cs.php',1520]], 1698],
'make_temp_directory': ['make_temp_directory', 'Create a directory under tempdir and make sure it is writable. ', [['lib','setuplib.php',1578]], 58],
'import_record': ['import_record', 'Import a record into a table, id field is required. Safety checks are NOT carried out. Lobs are supported. ', [['lib/dml','pgsql_native_moodle_database.php',1046],['lib/dml','oci_native_moodle_database.php',1285],['lib/dml','sqlsrv_native_moodle_database.php',1014],['lib/dml','mssql_native_moodle_database.php',933],['lib/dml','mysqli_native_moodle_database.php',1331],['lib/dml/tests','dml_test.php',5428],['lib/dml','pdo_moodle_database.php',576]], 24],
'store_database_state': ['store_database_state', 'Stores the status of the database ', [['lib/testing/classes','util.php',206]], 2],
'get_recordset_sql': ['get_recordset_sql', 'Get a number of records as a moodle_recordset using a SQL statement. ', [['lib/dml','pgsql_native_moodle_database.php',688],['lib/dml','oci_native_moodle_database.php',1065],['lib/dml','sqlsrv_native_moodle_database.php',761],['lib/dml','mssql_native_moodle_database.php',687],['lib/dml','mysqli_native_moodle_database.php',985],['lib/dml/tests','dml_test.php',5423],['lib/dml','pdo_moodle_database.php',251]], 279],
'get_tablestructure': ['get_tablestructure', 'Returns structure of all tables right after installation. ', [['lib/testing/classes','util.php',288]], 4],
'drop_table': ['drop_table', 'This function will drop the table passed as argument and all the associated objects (keys, indexes, constraints, sequences, triggers) will be dropped too. ', [['lib/ddl','database_manager.php',308]], 77],
'get_records': ['get_records', 'Get a number of records as an array of objects where all the given conditions met. ', [['lib/dml','moodle_database.php',1236],['lib','coursecatlib.php',654],['question','category_class.php',63]], 860],
'get_dataroot': ['get_dataroot', 'Return the dataroot. It\'s useful when mocking the dataroot when unit testing this class itself. ', [['lib/testing/classes','util.php',91]], 25],
'table_exists': ['table_exists', 'Given one xmldb_table, check if it exists in DB (true/false). ', [['lib/ddl','database_manager.php',89],['lib/ddl','sql_generator.php',215]], 156],
'reset_all_database_sequences': ['reset_all_database_sequences', 'Reset all database sequences to initial values. ', [['lib/testing/classes','util.php',437]], 2],
'get_tables': ['get_tables', 'Return tables in database WITHOUT current prefix. ', [['lib/dml','pgsql_native_moodle_database.php',304],['lib/dml','oci_native_moodle_database.php',384],['lib/dml','sqlsrv_native_moodle_database.php',366],['lib/dml','sqlite3_pdo_moodle_database.php',137],['lib/dml','mssql_native_moodle_database.php',309],['lib/dml','mysqli_native_moodle_database.php',512],['lib/dml/tests','dml_test.php',5415]], 38],
'get_next_sequence_starting_value': ['get_next_sequence_starting_value', 'Determine the next unique starting id sequences. ', [['lib/testing/classes','util.php',416]], 2],
'skip_original_data_files': ['skip_original_data_files', 'Skip the original dataroot files to not been reset. ', [['lib/testing/classes','util.php',907]], 1],
'getpath': ['getpath', 'Return the value of a node, given a path to the node if it doesn\'t exist return the default value. ', [['question','format.php',987],['lib/zend/Zend/Http','Cookie.php',163],['lib/phpexcel/PHPExcel/Worksheet','HeaderFooterDrawing.php',285],['lib/google/src/Google/Service','Manager.php',909],['lib/google/src/Google/Service','Manager.php',1464],['lib/editor/tinymce/plugins/spellchecker/classes/utils','Logger.php',93],['lib/phpexcel/PHPExcel/Worksheet','Drawing.php',87],['lib/xmldb','xmldb_structure.php',51],['auth/cas/CAS/CAS/PGTStorage','File.php',60],['lib/google/src/Google/Service','Webmasters.php',863],['lib/htmlpurifier/HTMLPurifier','Bootstrap.php',53],['lib/google/src/Google/Service','Datastore.php',616],['lib/google/src/Google/Service','Compute.php',11611],['lib/google/src/Google/Service','Compute.php',11830],['question/format/xml','format.php',117],['lib/zend/Zend/Uri','Http.php',524],['mod/lesson','format.php',757],['lib/minify/lib/Minify/Cache','File.php',111],['lib/lessphp/Tree','Import.php',103]], 216],
'get_dbfamily': ['get_dbfamily', 'Returns database family type - describes SQL dialect Note: can be used before connect() ', [['lib/dml','pgsql_native_moodle_database.php',61],['lib/dml','oci_native_moodle_database.php',67],['lib/dml','sqlsrv_native_moodle_database.php',75],['lib/dml','sqlite3_pdo_moodle_database.php',50],['lib/dml','mssql_native_moodle_database.php',56],['lib/dml','mysqli_native_moodle_database.php',117],['lib/dml/tests','dml_test.php',5406]], 59],
'reset_dataroot': ['reset_dataroot', 'Purge dataroot directory ', [['lib/testing/classes','util.php',705]], 5],
'drop_dataroot': ['drop_dataroot', 'Drops the test framework dataroot ', [['lib/testing/classes','util.php',875]], 2],
'get_server_info': ['get_server_info', 'Returns database server info array ', [['lib/dml','pgsql_native_moodle_database.php',262],['lib/dml','oci_native_moodle_database.php',274],['lib/dml','mariadb_native_moodle_database.php',77],['lib/dml','sqlsrv_native_moodle_database.php',253],['lib/dml','mssql_native_moodle_database.php',245],['lib/dml','mysqli_native_moodle_database.php',488],['lib/dml/tests','dml_test.php',5412],['lib/dml','pdo_moodle_database.php',131]], 8],
'list': ['list', '', [['mod/data/preset/imagegallery','jstemplate.js',9]], 1891],
'reset_database': ['reset_database', 'Reset all database tables to default values. ', [['lib/phpunit/classes','util.php',276],['lib/testing/classes','util.php',566]], 4],
'get_manager': ['get_manager', 'Returns the sql generator used for db manipulation. Used mostly in upgrade.php scripts. ', [['lib/dml','moodle_database.php',1030]], 273],
'get_git_hash': ['get_git_hash', 'Try to get current git hash of the Moodle in $CFG->dirroot. ', [['lib/testing/classes','util.php',786]], 2],
'get_prefix': ['get_prefix', 'Returns database table prefix Note: can be used before connect() ', [['lib/dml','moodle_database.php',162],['backup/util/loggers','base_logger.class.php',146]], 29],
'delete_records_select': ['delete_records_select', 'Delete one or more records from a table which match a particular WHERE clause. ', [['lib/dml','pgsql_native_moodle_database.php',1247],['lib/dml','oci_native_moodle_database.php',1445],['lib/dml','sqlsrv_native_moodle_database.php',1153],['lib/dml','mssql_native_moodle_database.php',1082],['lib/dml','mysqli_native_moodle_database.php',1469],['lib/dml/tests','dml_test.php',5432],['lib/dml','pdo_moodle_database.php',207]], 166],
'store_versions_hash': ['store_versions_hash', 'Stores the version hash in both database and dataroot ', [['lib/testing/classes','util.php',242]], 2],
'change_database_structure': ['change_database_structure', 'Do NOT use in code, to be used by database_manager only! ', [['lib/dml','pgsql_native_moodle_database.php',631],['lib/dml','oci_native_moodle_database.php',889],['lib/dml','sqlsrv_native_moodle_database.php',675],['lib/dml','mssql_native_moodle_database.php',596],['lib/dml','mysqli_native_moodle_database.php',889],['lib/dml/tests','dml_test.php',5421],['lib/dml','pdo_moodle_database.php',175]], 19],
'remove_dir': ['remove_dir', 'Delete directory or only its content ', [['lib','moodlelib.php',8763]], 41],
'save_original_data_files': ['save_original_data_files', 'Save the list of the original dataroot files into a json file. ', [['lib/testing/classes','util.php',931]], 2],
'require': ['require', '', [['lib/yuilib/3.17.2/timers','timers-debug.js',27],['lib/yuilib/3.17.2/timers','timers.js',27]], 454],
'purge_all': ['purge_all', 'Purge all of the cache stores of all of their data. ', [['cache/classes','helper.php',464]], 11],
'close': ['close', 'Close the connection to the server ', [['lib/zend/Zend/Http/Client/Adapter','Socket.php',486],['lib/tests','completionlib_test.php',888],['lib/adodb','adodb.inc.php',2164],['lib/adodb','adodb.inc.php',2844],['lib/adodb','adodb.inc.php',3536],['lib','webdavlib.php',176],['admin/tool/uploaduser','locallib.php',149],['lib/dml','oci_native_moodle_recordset.php',80],['lib/tcpdf','tcpdf.php',2943],['lib/horde/framework/Horde/Imap/Client','Base.php',1846],['lib','excellib.class.php',93],['lib/zend/Zend/Http/Client/Adapter','Test.php',187],['lib/classes/dml','recordset_walk.php',153],['mod/assign/feedback/offline','importgradeslib.php',178],['lib/pear/Net','GeoIP.php',556],['backup/util/helper','backup_array_iterator.class.php',63],['lib/zend/Zend/Gdata/App','LoggingHttpClientAdapterSocket.php',109],['lib/zend/Zend/Http/Client/Adapter','Proxy.php',266],['lib/dml','mssql_native_moodle_recordset.php',87],['lib/pear/Auth','RADIUS.php',542],['lib/pear/Auth','RADIUS.php',703],['lib/pear/Auth','RADIUS.php',824],['lib/phpmailer','class.smtp.php',507],['lib/phpexcel/PHPExcel/Shared','ZipArchive.php',80],['lib/phpunit/classes','event_sink.php',39],['lib/zend/Zend/Http/Client/Adapter','Interface.php',73],['lib/dml','pgsql_native_moodle_recordset.php',104],['auth/fc','fcFPP.php',72],['lib/filestorage','zip_archive.php',183],['lib','odslib.class.php',71],['lib/horde/framework/Horde/Socket','Client.php',135],['question/engine/tests','helpers.php',1225],['grade','lib.php',323],['lib/dml','mysqli_native_moodle_recordset.php',86],['lib','csvlib.class.php',256],['lib/google/src/Google/Logger','File.php',130],['lib/horde/framework/Horde','Stream.php',585],['lib/phpunit/classes','phpmailer_sink.php',41],['lib/phpunit/classes','message_sink.php',39],['lib/zend/Zend/Http/Client/Adapter','Curl.php',460],['lib/dml','sqlsrv_native_moodle_recordset.php',133],['lib/zend/Zend/Service/WindowsAzure','SessionHandler.php',109],['backup/util/helper','backup_null_iterator.class.php',53],['grade/export','lib.php',662],['lib/dml','pdo_moodle_recordset.php',79]], 1036],
'get_originaldatafilesjson': ['get_originaldatafilesjson', 'Return the name of the JSON file containing the init filenames. ', [['lib/testing/classes','util.php',81]], 0],
'drop_database': ['drop_database', 'Drop the whole test database ', [['lib/testing/classes','util.php',836]], 2],
'get_in_or_equal': ['get_in_or_equal', 'Constructs \'IN()\' or \'=\' sql fragment ', [['lib/dml','oci_native_moodle_database.php',1583],['lib/dml','moodle_database.php',678]], 375],
'get_site_info': ['get_site_info', 'Return user information including profile picture + basic site information Note: - no capability checking because we return only known information about logged user ', [['webservice','externallib.php',63],['admin/registration','lib.php',191],['lib/testing/classes','util.php',762]], 7],
'json_encode': ['json_encode', 'encodes an arbitrary variable into JSON format ', [['lib/minify/lib','FirePHP.php',1124]], 247],
'get_columns': ['get_columns', 'Returns detailed information about columns in table. This information is cached internally. ', [['lib/dml','pgsql_native_moodle_database.php',385],['lib/dml','oci_native_moodle_database.php',464],['lib/dml','sqlsrv_native_moodle_database.php',462],['lib/dml','sqlite3_pdo_moodle_database.php',195],['lib/dml','mssql_native_moodle_database.php',392],['lib','csvlib.class.php',190],['lib/dml','mysqli_native_moodle_database.php',572],['lib/dml/tests','dml_test.php',5417]], 108],
'get_data_generator': ['get_data_generator', 'Get data generator ', [['lib/testing/classes','util.php',128]], 5],
'make_cache_directory': ['make_cache_directory', 'Create a directory under cachedir and make sure it is writable. ', [['lib','setuplib.php',1605]], 13],
'delete_records': ['delete_records', 'Delete the records from a table where all the given conditions met. If conditions not specified, table is truncated. ', [['lib/dml','moodle_database.php',1815],['lib/dml','sqlite3_pdo_moodle_database.php',337]], 778],
'make_localcache_directory': ['make_localcache_directory', 'Create a directory under localcachedir and make sure it is writable. The files in this directory MUST NOT change, use revisions or content hashes to work around this limitation - this means you can only add new files here. ', [['lib','setuplib.php',1625]], 17],
'get_framework': ['get_framework', 'Returns the testing framework name ', [['lib/testing/classes','util.php',118]], 8],
'is_array': ['is_array', '', [], 1820],
'file_put_contents': ['file_put_contents', '', [], 86],
'scandir': ['scandir', '', [], 13],
'trim': ['trim', '', [], 1889],
'in_array': ['in_array', '', [], 1173],
'implode': ['implode', '', [], 1259],
'array_map': ['array_map', '', [], 149],
'preg_quote': ['preg_quote', '', [], 207],
'array_flip': ['array_flip', '', [], 118],
'opendir': ['opendir', '', [], 40],
'substr': ['substr', '', [], 2883],
'strtolower': ['strtolower', '', [], 922],
'unlink': ['unlink', '', [], 252],
'is_null': ['is_null', '', [], 1992],
'file_exists': ['file_exists', '', [], 873],
'file_get_contents': ['file_get_contents', '', [], 215],
'unserialize': ['unserialize', '', [], 180],
'closedir': ['closedir', '', [], 30],
'fclose': ['fclose', '', [], 280],
'array_merge': ['array_merge', '', [], 2320],
'fwrite': ['fwrite', '', [], 209],
'array_values': ['array_values', '', [], 283],
'max': ['max', '', [], 1096],
'is_dir': ['is_dir', '', [], 221],
'strpos': ['strpos', '', [], 1623],
'defined': ['defined', '', [], 4098],
'end': ['end', '', [], 432],
'serialize': ['serialize', '', [], 266],
'version_compare': ['version_compare', '', [], 69],
'reset': ['reset', '', [], 1070],
'preg_replace': ['preg_replace', '', [], 903],
'clearstatcache': ['clearstatcache', '', [], 30]};
CLASS_DATA={
'cache_factory': ['cache_factory', 'The cache factory class. ', [['cache/classes','factory.php',31]], 58],
'testing_data_generator': ['testing_data_generator', 'Data generator class for unit tests and other tools that need to create fake test sites. ', [['lib/testing/generator','data_generator.php',28]], 7],
'cache_helper': ['cache_helper', 'The cache helper class. ', [['cache/classes','helper.php',31]], 131],
'xmldb_table': ['xmldb_table', '', [['lib/xmldb','xmldb_table.php',29]], 397],
'core_component': ['core_component', 'Collection of components related methods. ', [['lib/classes','component.php',41]], 485]};
CONST_DATA={
};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu May 28 19:17:31 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
