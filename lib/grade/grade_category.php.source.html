<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /lib/grade/grade_category.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu May 28 19:17:31 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='lib/grade';
filename='grade_category.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/lib/grade/</a> -> <a href="grade_category.php.html">grade_category.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="grade_category.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="grade_category.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * Definition of a class to represent a grade category</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * @package   core_grades</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @copyright 2006 Nicolas Connault</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> */</span>
<a name="l24"><span class="linenum">  24</span></a>  
<a name="l25"><span class="linenum">  25</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die();
<a name="l26"><span class="linenum">  26</span></a>  
<a name="l27"><span class="linenum">  27</span></a>  <span class="keyword">require_once</span> <a class="filename" href="../../lib/grade/grade_object.php.html" onMouseOver="reqPopup(event, 'grade_object.php', '../../lib/grade/grade_object.php')">('grade_object.php')</a>;
<a name="l28"><span class="linenum">  28</span></a>  
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment">/**</span>
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment"> * grade_category is an object mapped to DB table {prefix}grade_categories</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment"> *</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> * @package   core_grades</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> * @category  grade</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> * @copyright 2007 Nicolas Connault</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment"> */</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a> extends grade_object {
<a name="l38"><span class="linenum">  38</span></a>      <span class="comment">/**</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="comment">     * The DB table.</span>
<a name="l40"><span class="linenum">  40</span></a>  <span class="comment">     * @var string $table</span>
<a name="l41"><span class="linenum">  41</span></a>  <span class="comment">     */</span>
<a name="l42"><span class="linenum">  42</span></a>      public <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = 'grade_categories';
<a name="l43"><span class="linenum">  43</span></a>  
<a name="l44"><span class="linenum">  44</span></a>      <span class="comment">/**</span>
<a name="l45"><span class="linenum">  45</span></a>  <span class="comment">     * Array of required table fields, must start with 'id'.</span>
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment">     * @var array $required_fields</span>
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment">     */</span>
<a name="l48"><span class="linenum">  48</span></a>      public <a class="var it3047" onMouseOver="hilite(3047)" onMouseOut="lolite()" onClick="logVariable('required_fields')" href="../../_variables/required_fields.html">$required_fields</a> = array('id', 'courseid', 'parent', 'depth', 'path', 'fullname', 'aggregation',
<a name="l49"><span class="linenum">  49</span></a>                                   'keephigh', 'droplow', 'aggregateonlygraded', 'aggregateoutcomes',
<a name="l50"><span class="linenum">  50</span></a>                                   'timecreated', 'timemodified', 'hidden');
<a name="l51"><span class="linenum">  51</span></a>  
<a name="l52"><span class="linenum">  52</span></a>      <span class="comment">/**</span>
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment">     * The course this category belongs to.</span>
<a name="l54"><span class="linenum">  54</span></a>  <span class="comment">     * @var int $courseid</span>
<a name="l55"><span class="linenum">  55</span></a>  <span class="comment">     */</span>
<a name="l56"><span class="linenum">  56</span></a>      public <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>;
<a name="l57"><span class="linenum">  57</span></a>  
<a name="l58"><span class="linenum">  58</span></a>      <span class="comment">/**</span>
<a name="l59"><span class="linenum">  59</span></a>  <span class="comment">     * The category this category belongs to (optional).</span>
<a name="l60"><span class="linenum">  60</span></a>  <span class="comment">     * @var int $parent</span>
<a name="l61"><span class="linenum">  61</span></a>  <span class="comment">     */</span>
<a name="l62"><span class="linenum">  62</span></a>      public <a class="var it75" onMouseOver="hilite(75)" onMouseOut="lolite()" onClick="logVariable('parent')" href="../../_variables/parent.html">$parent</a>;
<a name="l63"><span class="linenum">  63</span></a>  
<a name="l64"><span class="linenum">  64</span></a>      <span class="comment">/**</span>
<a name="l65"><span class="linenum">  65</span></a>  <span class="comment">     * The grade_category object referenced by $this-&gt;parent (PK).</span>
<a name="l66"><span class="linenum">  66</span></a>  <span class="comment">     * @var grade_category $parent_category</span>
<a name="l67"><span class="linenum">  67</span></a>  <span class="comment">     */</span>
<a name="l68"><span class="linenum">  68</span></a>      public <a class="var it6486" onMouseOver="hilite(6486)" onMouseOut="lolite()" onClick="logVariable('parent_category')" href="../../_variables/parent_category.html">$parent_category</a>;
<a name="l69"><span class="linenum">  69</span></a>  
<a name="l70"><span class="linenum">  70</span></a>      <span class="comment">/**</span>
<a name="l71"><span class="linenum">  71</span></a>  <span class="comment">     * The number of parents this category has.</span>
<a name="l72"><span class="linenum">  72</span></a>  <span class="comment">     * @var int $depth</span>
<a name="l73"><span class="linenum">  73</span></a>  <span class="comment">     */</span>
<a name="l74"><span class="linenum">  74</span></a>      public <a class="var it250" onMouseOver="hilite(250)" onMouseOut="lolite()" onClick="logVariable('depth')" href="../../_variables/depth.html">$depth</a> = 0;
<a name="l75"><span class="linenum">  75</span></a>  
<a name="l76"><span class="linenum">  76</span></a>      <span class="comment">/**</span>
<a name="l77"><span class="linenum">  77</span></a>  <span class="comment">     * Shows the hierarchical path for this category as /1/2/3/ (like course_categories), the last number being</span>
<a name="l78"><span class="linenum">  78</span></a>  <span class="comment">     * this category's autoincrement ID number.</span>
<a name="l79"><span class="linenum">  79</span></a>  <span class="comment">     * @var string $path</span>
<a name="l80"><span class="linenum">  80</span></a>  <span class="comment">     */</span>
<a name="l81"><span class="linenum">  81</span></a>      public <a class="var it154" onMouseOver="hilite(154)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../_variables/path.html">$path</a>;
<a name="l82"><span class="linenum">  82</span></a>  
<a name="l83"><span class="linenum">  83</span></a>      <span class="comment">/**</span>
<a name="l84"><span class="linenum">  84</span></a>  <span class="comment">     * The name of this category.</span>
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment">     * @var string $fullname</span>
<a name="l86"><span class="linenum">  86</span></a>  <span class="comment">     */</span>
<a name="l87"><span class="linenum">  87</span></a>      public <a class="var it104" onMouseOver="hilite(104)" onMouseOut="lolite()" onClick="logVariable('fullname')" href="../../_variables/fullname.html">$fullname</a>;
<a name="l88"><span class="linenum">  88</span></a>  
<a name="l89"><span class="linenum">  89</span></a>      <span class="comment">/**</span>
<a name="l90"><span class="linenum">  90</span></a>  <span class="comment">     * A constant pointing to one of the predefined aggregation strategies (none, mean, median, sum etc) .</span>
<a name="l91"><span class="linenum">  91</span></a>  <span class="comment">     * @var int $aggregation</span>
<a name="l92"><span class="linenum">  92</span></a>  <span class="comment">     */</span>
<a name="l93"><span class="linenum">  93</span></a>      public <a class="var it10016" onMouseOver="hilite(10016)" onMouseOut="lolite()" onClick="logVariable('aggregation')" href="../../_variables/aggregation.html">$aggregation</a> = <a class="constant" onClick="logConstant('GRADE_AGGREGATE_SUM')" href="../../_constants/GRADE_AGGREGATE_SUM.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_SUM')">GRADE_AGGREGATE_SUM</a>;
<a name="l94"><span class="linenum">  94</span></a>  
<a name="l95"><span class="linenum">  95</span></a>      <span class="comment">/**</span>
<a name="l96"><span class="linenum">  96</span></a>  <span class="comment">     * Keep only the X highest items.</span>
<a name="l97"><span class="linenum">  97</span></a>  <span class="comment">     * @var int $keephigh</span>
<a name="l98"><span class="linenum">  98</span></a>  <span class="comment">     */</span>
<a name="l99"><span class="linenum">  99</span></a>      public <a class="var it24179" onMouseOver="hilite(24179)" onMouseOut="lolite()" onClick="logVariable('keephigh')" href="../../_variables/keephigh.html">$keephigh</a> = 0;
<a name="l100"><span class="linenum"> 100</span></a>  
<a name="l101"><span class="linenum"> 101</span></a>      <span class="comment">/**</span>
<a name="l102"><span class="linenum"> 102</span></a>  <span class="comment">     * Drop the X lowest items.</span>
<a name="l103"><span class="linenum"> 103</span></a>  <span class="comment">     * @var int $droplow</span>
<a name="l104"><span class="linenum"> 104</span></a>  <span class="comment">     */</span>
<a name="l105"><span class="linenum"> 105</span></a>      public <a class="var it24180" onMouseOver="hilite(24180)" onMouseOut="lolite()" onClick="logVariable('droplow')" href="../../_variables/droplow.html">$droplow</a> = 0;
<a name="l106"><span class="linenum"> 106</span></a>  
<a name="l107"><span class="linenum"> 107</span></a>      <span class="comment">/**</span>
<a name="l108"><span class="linenum"> 108</span></a>  <span class="comment">     * Aggregate only graded items</span>
<a name="l109"><span class="linenum"> 109</span></a>  <span class="comment">     * @var int $aggregateonlygraded</span>
<a name="l110"><span class="linenum"> 110</span></a>  <span class="comment">     */</span>
<a name="l111"><span class="linenum"> 111</span></a>      public <a class="var it16225" onMouseOver="hilite(16225)" onMouseOut="lolite()" onClick="logVariable('aggregateonlygraded')" href="../../_variables/aggregateonlygraded.html">$aggregateonlygraded</a> = 0;
<a name="l112"><span class="linenum"> 112</span></a>  
<a name="l113"><span class="linenum"> 113</span></a>      <span class="comment">/**</span>
<a name="l114"><span class="linenum"> 114</span></a>  <span class="comment">     * Aggregate outcomes together with normal items</span>
<a name="l115"><span class="linenum"> 115</span></a>  <span class="comment">     * @var int $aggregateoutcomes</span>
<a name="l116"><span class="linenum"> 116</span></a>  <span class="comment">     */</span>
<a name="l117"><span class="linenum"> 117</span></a>      public <a class="var it10022" onMouseOver="hilite(10022)" onMouseOut="lolite()" onClick="logVariable('aggregateoutcomes')" href="../../_variables/aggregateoutcomes.html">$aggregateoutcomes</a> = 0;
<a name="l118"><span class="linenum"> 118</span></a>  
<a name="l119"><span class="linenum"> 119</span></a>      <span class="comment">/**</span>
<a name="l120"><span class="linenum"> 120</span></a>  <span class="comment">     * Array of grade_items or grade_categories nested exactly 1 level below this category</span>
<a name="l121"><span class="linenum"> 121</span></a>  <span class="comment">     * @var array $children</span>
<a name="l122"><span class="linenum"> 122</span></a>  <span class="comment">     */</span>
<a name="l123"><span class="linenum"> 123</span></a>      public <a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a>;
<a name="l124"><span class="linenum"> 124</span></a>  
<a name="l125"><span class="linenum"> 125</span></a>      <span class="comment">/**</span>
<a name="l126"><span class="linenum"> 126</span></a>  <span class="comment">     * A hierarchical array of all children below this category. This is stored separately from</span>
<a name="l127"><span class="linenum"> 127</span></a>  <span class="comment">     * $children because it is more memory-intensive and may not be used as often.</span>
<a name="l128"><span class="linenum"> 128</span></a>  <span class="comment">     * @var array $all_children</span>
<a name="l129"><span class="linenum"> 129</span></a>  <span class="comment">     */</span>
<a name="l130"><span class="linenum"> 130</span></a>      public <a class="var it33667" onMouseOver="hilite(33667)" onMouseOut="lolite()" onClick="logVariable('all_children')" href="../../_variables/all_children.html">$all_children</a>;
<a name="l131"><span class="linenum"> 131</span></a>  
<a name="l132"><span class="linenum"> 132</span></a>      <span class="comment">/**</span>
<a name="l133"><span class="linenum"> 133</span></a>  <span class="comment">     * An associated grade_item object, with itemtype=category, used to calculate and cache a set of grade values</span>
<a name="l134"><span class="linenum"> 134</span></a>  <span class="comment">     * for this category.</span>
<a name="l135"><span class="linenum"> 135</span></a>  <span class="comment">     * @var grade_item $grade_item</span>
<a name="l136"><span class="linenum"> 136</span></a>  <span class="comment">     */</span>
<a name="l137"><span class="linenum"> 137</span></a>      public <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>;
<a name="l138"><span class="linenum"> 138</span></a>  
<a name="l139"><span class="linenum"> 139</span></a>      <span class="comment">/**</span>
<a name="l140"><span class="linenum"> 140</span></a>  <span class="comment">     * Temporary sortorder for speedup of children resorting</span>
<a name="l141"><span class="linenum"> 141</span></a>  <span class="comment">     * @var int $sortorder</span>
<a name="l142"><span class="linenum"> 142</span></a>  <span class="comment">     */</span>
<a name="l143"><span class="linenum"> 143</span></a>      public <a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a>;
<a name="l144"><span class="linenum"> 144</span></a>  
<a name="l145"><span class="linenum"> 145</span></a>      <span class="comment">/**</span>
<a name="l146"><span class="linenum"> 146</span></a>  <span class="comment">     * List of options which can be &quot;forced&quot; from site settings.</span>
<a name="l147"><span class="linenum"> 147</span></a>  <span class="comment">     * @var array $forceable</span>
<a name="l148"><span class="linenum"> 148</span></a>  <span class="comment">     */</span>
<a name="l149"><span class="linenum"> 149</span></a>      public <a class="var it27529" onMouseOver="hilite(27529)" onMouseOut="lolite()" onClick="logVariable('forceable')" href="../../_variables/forceable.html">$forceable</a> = array('aggregation', 'keephigh', 'droplow', 'aggregateonlygraded', 'aggregateoutcomes');
<a name="l150"><span class="linenum"> 150</span></a>  
<a name="l151"><span class="linenum"> 151</span></a>      <span class="comment">/**</span>
<a name="l152"><span class="linenum"> 152</span></a>  <span class="comment">     * String representing the aggregation coefficient. Variable is used as cache.</span>
<a name="l153"><span class="linenum"> 153</span></a>  <span class="comment">     * @var string $coefstring</span>
<a name="l154"><span class="linenum"> 154</span></a>  <span class="comment">     */</span>
<a name="l155"><span class="linenum"> 155</span></a>      public <a class="var it24656" onMouseOver="hilite(24656)" onMouseOut="lolite()" onClick="logVariable('coefstring')" href="../../_variables/coefstring.html">$coefstring</a> = null;
<a name="l156"><span class="linenum"> 156</span></a>  
<a name="l157"><span class="linenum"> 157</span></a>      <span class="comment">/**</span>
<a name="l158"><span class="linenum"> 158</span></a>  <span class="comment">     * Static variable storing the result from {@link self::can_apply_limit_rules}.</span>
<a name="l159"><span class="linenum"> 159</span></a>  <span class="comment">     * @var bool</span>
<a name="l160"><span class="linenum"> 160</span></a>  <span class="comment">     */</span>
<a name="l161"><span class="linenum"> 161</span></a>      protected <a class="var it33668" onMouseOver="hilite(33668)" onMouseOut="lolite()" onClick="logVariable('canapplylimitrules')" href="../../_variables/canapplylimitrules.html">$canapplylimitrules</a>;
<a name="l162"><span class="linenum"> 162</span></a>  
<a name="l163"><span class="linenum"> 163</span></a>      <span class="comment">/**</span>
<a name="l164"><span class="linenum"> 164</span></a>  <span class="comment">     * Builds this category's path string based on its parents (if any) and its own id number.</span>
<a name="l165"><span class="linenum"> 165</span></a>  <span class="comment">     * This is typically done just before inserting this object in the DB for the first time,</span>
<a name="l166"><span class="linenum"> 166</span></a>  <span class="comment">     * or when a new parent is added or changed. It is a recursive function: once the calling</span>
<a name="l167"><span class="linenum"> 167</span></a>  <span class="comment">     * object no longer has a parent, the path is complete.</span>
<a name="l168"><span class="linenum"> 168</span></a>  <span class="comment">     *</span>
<a name="l169"><span class="linenum"> 169</span></a>  <span class="comment">     * @param grade_category $grade_category A Grade_Category object</span>
<a name="l170"><span class="linenum"> 170</span></a>  <span class="comment">     * @return string The category's path string</span>
<a name="l171"><span class="linenum"> 171</span></a>  <span class="comment">     */</span>
<a name="l172"><span class="linenum"> 172</span></a>      public static function <a class="function" onClick="logFunction('build_path')" href="../../_functions/build_path.html" onMouseOver="funcPopup(event,'build_path')">build_path</a>(<a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a>) {
<a name="l173"><span class="linenum"> 173</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l174"><span class="linenum"> 174</span></a>  
<a name="l175"><span class="linenum"> 175</span></a>          if (empty(<a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a>-&gt;<a onClick="logVariable('parent')" class="var it40058" onMouseOver="hilite(40058)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>)) {
<a name="l176"><span class="linenum"> 176</span></a>              return '/'.<a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a>-&gt;<a onClick="logVariable('id')" class="var it40058" onMouseOver="hilite(40058)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>.'/';
<a name="l177"><span class="linenum"> 177</span></a>  
<a name="l178"><span class="linenum"> 178</span></a>          } else {
<a name="l179"><span class="linenum"> 179</span></a>              <a class="var it75" onMouseOver="hilite(75)" onMouseOut="lolite()" onClick="logVariable('parent')" href="../../_variables/parent.html">$parent</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('grade_categories', array('id' =&gt; <a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a>-&gt;<a onClick="logVariable('parent')" class="var it40058" onMouseOver="hilite(40058)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>));
<a name="l180"><span class="linenum"> 180</span></a>              return <a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>::<a class="function" onClick="logFunction('build_path')" href="../../_functions/build_path.html" onMouseOver="funcPopup(event,'build_path')">build_path</a>(<a class="var it75" onMouseOver="hilite(75)" onMouseOut="lolite()" onClick="logVariable('parent')" href="../../_variables/parent.html">$parent</a>).<a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a>-&gt;<a onClick="logVariable('id')" class="var it40058" onMouseOver="hilite(40058)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>.'/';
<a name="l181"><span class="linenum"> 181</span></a>          }
<a name="l182"><span class="linenum"> 182</span></a>      }
<a name="l183"><span class="linenum"> 183</span></a>  
<a name="l184"><span class="linenum"> 184</span></a>      <span class="comment">/**</span>
<a name="l185"><span class="linenum"> 185</span></a>  <span class="comment">     * Finds and returns a grade_category instance based on params.</span>
<a name="l186"><span class="linenum"> 186</span></a>  <span class="comment">     *</span>
<a name="l187"><span class="linenum"> 187</span></a>  <span class="comment">     * @param array $params associative arrays varname=&gt;value</span>
<a name="l188"><span class="linenum"> 188</span></a>  <span class="comment">     * @return grade_category The retrieved grade_category instance or false if none found.</span>
<a name="l189"><span class="linenum"> 189</span></a>  <span class="comment">     */</span>
<a name="l190"><span class="linenum"> 190</span></a>      public static function <a class="function" onClick="logFunction('fetch')" href="../../_functions/fetch.html" onMouseOver="funcPopup(event,'fetch')">fetch</a>(<a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) {
<a name="l191"><span class="linenum"> 191</span></a>          return grade_object::<a class="function" onClick="logFunction('fetch_helper')" href="../../_functions/fetch_helper.html" onMouseOver="funcPopup(event,'fetch_helper')">fetch_helper</a>('grade_categories', 'grade_category', <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l192"><span class="linenum"> 192</span></a>      }
<a name="l193"><span class="linenum"> 193</span></a>  
<a name="l194"><span class="linenum"> 194</span></a>      <span class="comment">/**</span>
<a name="l195"><span class="linenum"> 195</span></a>  <span class="comment">     * Finds and returns all grade_category instances based on params.</span>
<a name="l196"><span class="linenum"> 196</span></a>  <span class="comment">     *</span>
<a name="l197"><span class="linenum"> 197</span></a>  <span class="comment">     * @param array $params associative arrays varname=&gt;value</span>
<a name="l198"><span class="linenum"> 198</span></a>  <span class="comment">     * @return array array of grade_category insatnces or false if none found.</span>
<a name="l199"><span class="linenum"> 199</span></a>  <span class="comment">     */</span>
<a name="l200"><span class="linenum"> 200</span></a>      public static function <a class="function" onClick="logFunction('fetch_all')" href="../../_functions/fetch_all.html" onMouseOver="funcPopup(event,'fetch_all')">fetch_all</a>(<a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) {
<a name="l201"><span class="linenum"> 201</span></a>          return grade_object::<a class="function" onClick="logFunction('fetch_all_helper')" href="../../_functions/fetch_all_helper.html" onMouseOver="funcPopup(event,'fetch_all_helper')">fetch_all_helper</a>('grade_categories', 'grade_category', <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l202"><span class="linenum"> 202</span></a>      }
<a name="l203"><span class="linenum"> 203</span></a>  
<a name="l204"><span class="linenum"> 204</span></a>      <span class="comment">/**</span>
<a name="l205"><span class="linenum"> 205</span></a>  <span class="comment">     * In addition to update() as defined in grade_object, call force_regrading of parent categories, if applicable.</span>
<a name="l206"><span class="linenum"> 206</span></a>  <span class="comment">     *</span>
<a name="l207"><span class="linenum"> 207</span></a>  <span class="comment">     * @param string $source from where was the object updated (mod/forum, manual, etc.)</span>
<a name="l208"><span class="linenum"> 208</span></a>  <span class="comment">     * @return bool success</span>
<a name="l209"><span class="linenum"> 209</span></a>  <span class="comment">     */</span>
<a name="l210"><span class="linenum"> 210</span></a>      public function <a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>(<a class="var it1344" onMouseOver="hilite(1344)" onMouseOut="lolite()" onClick="logVariable('source')" href="../../_variables/source.html">$source</a>=null) {
<a name="l211"><span class="linenum"> 211</span></a>  <span class="comment">        // load the grade item or create a new one</span>
<a name="l212"><span class="linenum"> 212</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l213"><span class="linenum"> 213</span></a>  
<a name="l214"><span class="linenum"> 214</span></a>  <span class="comment">        // force recalculation of path;</span>
<a name="l215"><span class="linenum"> 215</span></a>          if (empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('path')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/path.html">path</a>)) {
<a name="l216"><span class="linenum"> 216</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('path')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/path.html">path</a>  = <a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>::<a class="function" onClick="logFunction('build_path')" href="../../_functions/build_path.html" onMouseOver="funcPopup(event,'build_path')">build_path</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>);
<a name="l217"><span class="linenum"> 217</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('depth')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/depth.html">depth</a> = <a class="phpfunction" onClick="logFunction('substr_count')" href="../../_functions/substr_count.html" onMouseOver="phpfuncPopup(event,'substr_count')">substr_count</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('path')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/path.html">path</a>, '/') - 1;
<a name="l218"><span class="linenum"> 218</span></a>              <a class="var it33669" onMouseOver="hilite(33669)" onMouseOut="lolite()" onClick="logVariable('updatechildren')" href="../../_variables/updatechildren.html">$updatechildren</a> = true;
<a name="l219"><span class="linenum"> 219</span></a>  
<a name="l220"><span class="linenum"> 220</span></a>          } else {
<a name="l221"><span class="linenum"> 221</span></a>              <a class="var it33669" onMouseOver="hilite(33669)" onMouseOut="lolite()" onClick="logVariable('updatechildren')" href="../../_variables/updatechildren.html">$updatechildren</a> = false;
<a name="l222"><span class="linenum"> 222</span></a>          }
<a name="l223"><span class="linenum"> 223</span></a>  
<a name="l224"><span class="linenum"> 224</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('apply_forced_settings')" href="../../_functions/apply_forced_settings.html" onMouseOver="funcPopup(event,'apply_forced_settings')">apply_forced_settings</a>();
<a name="l225"><span class="linenum"> 225</span></a>  
<a name="l226"><span class="linenum"> 226</span></a>  <span class="comment">        // these are exclusive</span>
<a name="l227"><span class="linenum"> 227</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('droplow')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/droplow.html">droplow</a> &gt; 0) {
<a name="l228"><span class="linenum"> 228</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('keephigh')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/keephigh.html">keephigh</a> = 0;
<a name="l229"><span class="linenum"> 229</span></a>  
<a name="l230"><span class="linenum"> 230</span></a>          } else if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('keephigh')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/keephigh.html">keephigh</a> &gt; 0) {
<a name="l231"><span class="linenum"> 231</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('droplow')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/droplow.html">droplow</a> = 0;
<a name="l232"><span class="linenum"> 232</span></a>          }
<a name="l233"><span class="linenum"> 233</span></a>  
<a name="l234"><span class="linenum"> 234</span></a>  <span class="comment">        // Recalculate grades if needed</span>
<a name="l235"><span class="linenum"> 235</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('qualifies_for_regrading')" href="../../_functions/qualifies_for_regrading.html" onMouseOver="funcPopup(event,'qualifies_for_regrading')">qualifies_for_regrading</a>()) {
<a name="l236"><span class="linenum"> 236</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('force_regrading')" href="../../_functions/force_regrading.html" onMouseOver="funcPopup(event,'force_regrading')">force_regrading</a>();
<a name="l237"><span class="linenum"> 237</span></a>          }
<a name="l238"><span class="linenum"> 238</span></a>  
<a name="l239"><span class="linenum"> 239</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('timemodified')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l240"><span class="linenum"> 240</span></a>  
<a name="l241"><span class="linenum"> 241</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = parent::<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>(<a class="var it1344" onMouseOver="hilite(1344)" onMouseOut="lolite()" onClick="logVariable('source')" href="../../_variables/source.html">$source</a>);
<a name="l242"><span class="linenum"> 242</span></a>  
<a name="l243"><span class="linenum"> 243</span></a>  <span class="comment">        // now update paths in all child categories</span>
<a name="l244"><span class="linenum"> 244</span></a>          if (<a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> and <a class="var it33669" onMouseOver="hilite(33669)" onMouseOut="lolite()" onClick="logVariable('updatechildren')" href="../../_variables/updatechildren.html">$updatechildren</a>) {
<a name="l245"><span class="linenum"> 245</span></a>  
<a name="l246"><span class="linenum"> 246</span></a>              if (<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a> = <a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>::<a class="function" onClick="logFunction('fetch_all')" href="../../_functions/fetch_all.html" onMouseOver="funcPopup(event,'fetch_all')">fetch_all</a>(array('parent'=&gt;<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('id')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l247"><span class="linenum"> 247</span></a>  
<a name="l248"><span class="linenum"> 248</span></a>                  foreach (<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a> as <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>) {
<a name="l249"><span class="linenum"> 249</span></a>                      <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>-&gt;<a onClick="logVariable('path')" class="var it39612" onMouseOver="hilite(39612)" onMouseOut="lolite()" href="../../_variables/path.html">path</a>  = null;
<a name="l250"><span class="linenum"> 250</span></a>                      <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>-&gt;<a onClick="logVariable('depth')" class="var it39612" onMouseOver="hilite(39612)" onMouseOut="lolite()" href="../../_variables/depth.html">depth</a> = 0;
<a name="l251"><span class="linenum"> 251</span></a>                      <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>(<a class="var it1344" onMouseOver="hilite(1344)" onMouseOut="lolite()" onClick="logVariable('source')" href="../../_variables/source.html">$source</a>);
<a name="l252"><span class="linenum"> 252</span></a>                  }
<a name="l253"><span class="linenum"> 253</span></a>              }
<a name="l254"><span class="linenum"> 254</span></a>          }
<a name="l255"><span class="linenum"> 255</span></a>  
<a name="l256"><span class="linenum"> 256</span></a>          return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l257"><span class="linenum"> 257</span></a>      }
<a name="l258"><span class="linenum"> 258</span></a>  
<a name="l259"><span class="linenum"> 259</span></a>      <span class="comment">/**</span>
<a name="l260"><span class="linenum"> 260</span></a>  <span class="comment">     * If parent::delete() is successful, send force_regrading message to parent category.</span>
<a name="l261"><span class="linenum"> 261</span></a>  <span class="comment">     *</span>
<a name="l262"><span class="linenum"> 262</span></a>  <span class="comment">     * @param string $source from where was the object deleted (mod/forum, manual, etc.)</span>
<a name="l263"><span class="linenum"> 263</span></a>  <span class="comment">     * @return bool success</span>
<a name="l264"><span class="linenum"> 264</span></a>  <span class="comment">     */</span>
<a name="l265"><span class="linenum"> 265</span></a>      public function <a class="function" onClick="logFunction('delete')" href="../../_functions/delete.html" onMouseOver="funcPopup(event,'delete')">delete</a>(<a class="var it1344" onMouseOver="hilite(1344)" onMouseOut="lolite()" onClick="logVariable('source')" href="../../_variables/source.html">$source</a>=null) {
<a name="l266"><span class="linenum"> 266</span></a>          <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l267"><span class="linenum"> 267</span></a>  
<a name="l268"><span class="linenum"> 268</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_course_category')" href="../../_functions/is_course_category.html" onMouseOver="funcPopup(event,'is_course_category')">is_course_category</a>()) {
<a name="l269"><span class="linenum"> 269</span></a>  
<a name="l270"><span class="linenum"> 270</span></a>              if (<a class="var it3174" onMouseOver="hilite(3174)" onMouseOut="lolite()" onClick="logVariable('categories')" href="../../_variables/categories.html">$categories</a> = <a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>::<a class="function" onClick="logFunction('fetch_all')" href="../../_functions/fetch_all.html" onMouseOver="funcPopup(event,'fetch_all')">fetch_all</a>(array('courseid'=&gt;<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('courseid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>))) {
<a name="l271"><span class="linenum"> 271</span></a>  
<a name="l272"><span class="linenum"> 272</span></a>                  foreach (<a class="var it3174" onMouseOver="hilite(3174)" onMouseOut="lolite()" onClick="logVariable('categories')" href="../../_variables/categories.html">$categories</a> as <a class="var it2246" onMouseOver="hilite(2246)" onMouseOut="lolite()" onClick="logVariable('category')" href="../../_variables/category.html">$category</a>) {
<a name="l273"><span class="linenum"> 273</span></a>  
<a name="l274"><span class="linenum"> 274</span></a>                      if (<a class="var it2246" onMouseOver="hilite(2246)" onMouseOut="lolite()" onClick="logVariable('category')" href="../../_variables/category.html">$category</a>-&gt;<a onClick="logVariable('id')" class="var it39558" onMouseOver="hilite(39558)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> == <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('id')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>) {
<a name="l275"><span class="linenum"> 275</span></a>                          continue; <span class="comment">// do not delete course category yet</span>
<a name="l276"><span class="linenum"> 276</span></a>                      }
<a name="l277"><span class="linenum"> 277</span></a>                      <a class="var it2246" onMouseOver="hilite(2246)" onMouseOut="lolite()" onClick="logVariable('category')" href="../../_variables/category.html">$category</a>-&gt;<a class="function" onClick="logFunction('delete')" href="../../_functions/delete.html" onMouseOver="funcPopup(event,'delete')">delete</a>(<a class="var it1344" onMouseOver="hilite(1344)" onMouseOut="lolite()" onClick="logVariable('source')" href="../../_variables/source.html">$source</a>);
<a name="l278"><span class="linenum"> 278</span></a>                  }
<a name="l279"><span class="linenum"> 279</span></a>              }
<a name="l280"><span class="linenum"> 280</span></a>  
<a name="l281"><span class="linenum"> 281</span></a>              if (<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a> = <a class="class" onClick="logClass('grade_item')" href="../../_classes/grade_item.html" onMouseOver="classPopup(event,'grade_item')">grade_item</a>::<a class="function" onClick="logFunction('fetch_all')" href="../../_functions/fetch_all.html" onMouseOver="funcPopup(event,'fetch_all')">fetch_all</a>(array('courseid'=&gt;<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('courseid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>))) {
<a name="l282"><span class="linenum"> 282</span></a>  
<a name="l283"><span class="linenum"> 283</span></a>                  foreach (<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a> as <a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>) {
<a name="l284"><span class="linenum"> 284</span></a>  
<a name="l285"><span class="linenum"> 285</span></a>                      if (<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>-&gt;<a onClick="logVariable('id')" class="var it39599" onMouseOver="hilite(39599)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> == <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>-&gt;<a onClick="logVariable('id')" class="var it39507" onMouseOver="hilite(39507)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>) {
<a name="l286"><span class="linenum"> 286</span></a>                          continue; <span class="comment">// do not delete course item yet</span>
<a name="l287"><span class="linenum"> 287</span></a>                      }
<a name="l288"><span class="linenum"> 288</span></a>                      <a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>-&gt;<a class="function" onClick="logFunction('delete')" href="../../_functions/delete.html" onMouseOver="funcPopup(event,'delete')">delete</a>(<a class="var it1344" onMouseOver="hilite(1344)" onMouseOut="lolite()" onClick="logVariable('source')" href="../../_variables/source.html">$source</a>);
<a name="l289"><span class="linenum"> 289</span></a>                  }
<a name="l290"><span class="linenum"> 290</span></a>              }
<a name="l291"><span class="linenum"> 291</span></a>  
<a name="l292"><span class="linenum"> 292</span></a>          } else {
<a name="l293"><span class="linenum"> 293</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('force_regrading')" href="../../_functions/force_regrading.html" onMouseOver="funcPopup(event,'force_regrading')">force_regrading</a>();
<a name="l294"><span class="linenum"> 294</span></a>  
<a name="l295"><span class="linenum"> 295</span></a>              <a class="var it75" onMouseOver="hilite(75)" onMouseOut="lolite()" onClick="logVariable('parent')" href="../../_variables/parent.html">$parent</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_parent_category')" href="../../_functions/load_parent_category.html" onMouseOver="funcPopup(event,'load_parent_category')">load_parent_category</a>();
<a name="l296"><span class="linenum"> 296</span></a>  
<a name="l297"><span class="linenum"> 297</span></a>  <span class="comment">            // Update children's categoryid/parent field first</span>
<a name="l298"><span class="linenum"> 298</span></a>              if (<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a> = <a class="class" onClick="logClass('grade_item')" href="../../_classes/grade_item.html" onMouseOver="classPopup(event,'grade_item')">grade_item</a>::<a class="function" onClick="logFunction('fetch_all')" href="../../_functions/fetch_all.html" onMouseOver="funcPopup(event,'fetch_all')">fetch_all</a>(array('categoryid'=&gt;<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('id')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l299"><span class="linenum"> 299</span></a>                  foreach (<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a> as <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>) {
<a name="l300"><span class="linenum"> 300</span></a>                      <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>-&gt;<a class="function" onClick="logFunction('set_parent')" href="../../_functions/set_parent.html" onMouseOver="funcPopup(event,'set_parent')">set_parent</a>(<a class="var it75" onMouseOver="hilite(75)" onMouseOut="lolite()" onClick="logVariable('parent')" href="../../_variables/parent.html">$parent</a>-&gt;<a onClick="logVariable('id')" class="var it39475" onMouseOver="hilite(39475)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l301"><span class="linenum"> 301</span></a>                  }
<a name="l302"><span class="linenum"> 302</span></a>              }
<a name="l303"><span class="linenum"> 303</span></a>  
<a name="l304"><span class="linenum"> 304</span></a>              if (<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a> = <a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>::<a class="function" onClick="logFunction('fetch_all')" href="../../_functions/fetch_all.html" onMouseOver="funcPopup(event,'fetch_all')">fetch_all</a>(array('parent'=&gt;<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('id')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l305"><span class="linenum"> 305</span></a>                  foreach (<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a> as <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>) {
<a name="l306"><span class="linenum"> 306</span></a>                      <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>-&gt;<a class="function" onClick="logFunction('set_parent')" href="../../_functions/set_parent.html" onMouseOver="funcPopup(event,'set_parent')">set_parent</a>(<a class="var it75" onMouseOver="hilite(75)" onMouseOut="lolite()" onClick="logVariable('parent')" href="../../_variables/parent.html">$parent</a>-&gt;<a onClick="logVariable('id')" class="var it39475" onMouseOver="hilite(39475)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l307"><span class="linenum"> 307</span></a>                  }
<a name="l308"><span class="linenum"> 308</span></a>              }
<a name="l309"><span class="linenum"> 309</span></a>          }
<a name="l310"><span class="linenum"> 310</span></a>  
<a name="l311"><span class="linenum"> 311</span></a>  <span class="comment">        // first delete the attached grade item and grades</span>
<a name="l312"><span class="linenum"> 312</span></a>          <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>-&gt;<a class="function" onClick="logFunction('delete')" href="../../_functions/delete.html" onMouseOver="funcPopup(event,'delete')">delete</a>(<a class="var it1344" onMouseOver="hilite(1344)" onMouseOut="lolite()" onClick="logVariable('source')" href="../../_variables/source.html">$source</a>);
<a name="l313"><span class="linenum"> 313</span></a>  
<a name="l314"><span class="linenum"> 314</span></a>  <span class="comment">        // delete category itself</span>
<a name="l315"><span class="linenum"> 315</span></a>          return parent::<a class="function" onClick="logFunction('delete')" href="../../_functions/delete.html" onMouseOver="funcPopup(event,'delete')">delete</a>(<a class="var it1344" onMouseOver="hilite(1344)" onMouseOut="lolite()" onClick="logVariable('source')" href="../../_variables/source.html">$source</a>);
<a name="l316"><span class="linenum"> 316</span></a>      }
<a name="l317"><span class="linenum"> 317</span></a>  
<a name="l318"><span class="linenum"> 318</span></a>      <span class="comment">/**</span>
<a name="l319"><span class="linenum"> 319</span></a>  <span class="comment">     * In addition to the normal insert() defined in grade_object, this method sets the depth</span>
<a name="l320"><span class="linenum"> 320</span></a>  <span class="comment">     * and path for this object, and update the record accordingly.</span>
<a name="l321"><span class="linenum"> 321</span></a>  <span class="comment">     *</span>
<a name="l322"><span class="linenum"> 322</span></a>  <span class="comment">     * We do this here instead of in the constructor as they both need to know the record's</span>
<a name="l323"><span class="linenum"> 323</span></a>  <span class="comment">     * ID number, which only gets created at insertion time.</span>
<a name="l324"><span class="linenum"> 324</span></a>  <span class="comment">     * This method also creates an associated grade_item if this wasn't done during construction.</span>
<a name="l325"><span class="linenum"> 325</span></a>  <span class="comment">     *</span>
<a name="l326"><span class="linenum"> 326</span></a>  <span class="comment">     * @param string $source from where was the object inserted (mod/forum, manual, etc.)</span>
<a name="l327"><span class="linenum"> 327</span></a>  <span class="comment">     * @return int PK ID if successful, false otherwise</span>
<a name="l328"><span class="linenum"> 328</span></a>  <span class="comment">     */</span>
<a name="l329"><span class="linenum"> 329</span></a>      public function <a class="function" onClick="logFunction('insert')" href="../../_functions/insert.html" onMouseOver="funcPopup(event,'insert')">insert</a>(<a class="var it1344" onMouseOver="hilite(1344)" onMouseOut="lolite()" onClick="logVariable('source')" href="../../_variables/source.html">$source</a>=null) {
<a name="l330"><span class="linenum"> 330</span></a>  
<a name="l331"><span class="linenum"> 331</span></a>          if (empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('courseid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>)) {
<a name="l332"><span class="linenum"> 332</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('cannotinsertgrade');
<a name="l333"><span class="linenum"> 333</span></a>          }
<a name="l334"><span class="linenum"> 334</span></a>  
<a name="l335"><span class="linenum"> 335</span></a>          if (empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('parent')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>)) {
<a name="l336"><span class="linenum"> 336</span></a>              <a class="var it9997" onMouseOver="hilite(9997)" onMouseOut="lolite()" onClick="logVariable('course_category')" href="../../_variables/course_category.html">$course_category</a> = <a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>::<a class="function" onClick="logFunction('fetch_course_category')" href="../../_functions/fetch_course_category.html" onMouseOver="funcPopup(event,'fetch_course_category')">fetch_course_category</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('courseid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>);
<a name="l337"><span class="linenum"> 337</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('parent')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a> = <a class="var it9997" onMouseOver="hilite(9997)" onMouseOut="lolite()" onClick="logVariable('course_category')" href="../../_variables/course_category.html">$course_category</a>-&gt;<a onClick="logVariable('id')" class="var it40059" onMouseOver="hilite(40059)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l338"><span class="linenum"> 338</span></a>          }
<a name="l339"><span class="linenum"> 339</span></a>  
<a name="l340"><span class="linenum"> 340</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('path')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/path.html">path</a> = null;
<a name="l341"><span class="linenum"> 341</span></a>  
<a name="l342"><span class="linenum"> 342</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('timecreated')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('timemodified')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l343"><span class="linenum"> 343</span></a>  
<a name="l344"><span class="linenum"> 344</span></a>          if (!parent::<a class="function" onClick="logFunction('insert')" href="../../_functions/insert.html" onMouseOver="funcPopup(event,'insert')">insert</a>(<a class="var it1344" onMouseOver="hilite(1344)" onMouseOut="lolite()" onClick="logVariable('source')" href="../../_variables/source.html">$source</a>)) {
<a name="l345"><span class="linenum"> 345</span></a>              <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(&quot;Could not insert this category: &quot; . <a class="phpfunction" onClick="logFunction('print_r')" href="../../_functions/print_r.html" onMouseOver="phpfuncPopup(event,'print_r')">print_r</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, true));
<a name="l346"><span class="linenum"> 346</span></a>              return false;
<a name="l347"><span class="linenum"> 347</span></a>          }
<a name="l348"><span class="linenum"> 348</span></a>  
<a name="l349"><span class="linenum"> 349</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('force_regrading')" href="../../_functions/force_regrading.html" onMouseOver="funcPopup(event,'force_regrading')">force_regrading</a>();
<a name="l350"><span class="linenum"> 350</span></a>  
<a name="l351"><span class="linenum"> 351</span></a>  <span class="comment">        // build path and depth</span>
<a name="l352"><span class="linenum"> 352</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>(<a class="var it1344" onMouseOver="hilite(1344)" onMouseOut="lolite()" onClick="logVariable('source')" href="../../_variables/source.html">$source</a>);
<a name="l353"><span class="linenum"> 353</span></a>  
<a name="l354"><span class="linenum"> 354</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('id')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l355"><span class="linenum"> 355</span></a>      }
<a name="l356"><span class="linenum"> 356</span></a>  
<a name="l357"><span class="linenum"> 357</span></a>      <span class="comment">/**</span>
<a name="l358"><span class="linenum"> 358</span></a>  <span class="comment">     * Internal function - used only from fetch_course_category()</span>
<a name="l359"><span class="linenum"> 359</span></a>  <span class="comment">     * Normal insert() can not be used for course category</span>
<a name="l360"><span class="linenum"> 360</span></a>  <span class="comment">     *</span>
<a name="l361"><span class="linenum"> 361</span></a>  <span class="comment">     * @param int $courseid The course ID</span>
<a name="l362"><span class="linenum"> 362</span></a>  <span class="comment">     * @return int The ID of the new course category</span>
<a name="l363"><span class="linenum"> 363</span></a>  <span class="comment">     */</span>
<a name="l364"><span class="linenum"> 364</span></a>      public function <a class="function" onClick="logFunction('insert_course_category')" href="../../_functions/insert_course_category.html" onMouseOver="funcPopup(event,'insert_course_category')">insert_course_category</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>) {
<a name="l365"><span class="linenum"> 365</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('courseid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>    = <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>;
<a name="l366"><span class="linenum"> 366</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('fullname')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/fullname.html">fullname</a>    = '?';
<a name="l367"><span class="linenum"> 367</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('path')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/path.html">path</a>        = null;
<a name="l368"><span class="linenum"> 368</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('parent')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>      = null;
<a name="l369"><span class="linenum"> 369</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregation')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregation.html">aggregation</a> = <a class="constant" onClick="logConstant('GRADE_AGGREGATE_WEIGHTED_MEAN2')" href="../../_constants/GRADE_AGGREGATE_WEIGHTED_MEAN2.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_WEIGHTED_MEAN2')">GRADE_AGGREGATE_WEIGHTED_MEAN2</a>;
<a name="l370"><span class="linenum"> 370</span></a>  
<a name="l371"><span class="linenum"> 371</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('apply_default_settings')" href="../../_functions/apply_default_settings.html" onMouseOver="funcPopup(event,'apply_default_settings')">apply_default_settings</a>();
<a name="l372"><span class="linenum"> 372</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('apply_forced_settings')" href="../../_functions/apply_forced_settings.html" onMouseOver="funcPopup(event,'apply_forced_settings')">apply_forced_settings</a>();
<a name="l373"><span class="linenum"> 373</span></a>  
<a name="l374"><span class="linenum"> 374</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('timecreated')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('timemodified')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l375"><span class="linenum"> 375</span></a>  
<a name="l376"><span class="linenum"> 376</span></a>          if (!parent::<a class="function" onClick="logFunction('insert')" href="../../_functions/insert.html" onMouseOver="funcPopup(event,'insert')">insert</a>('system')) {
<a name="l377"><span class="linenum"> 377</span></a>              <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(&quot;Could not insert this category: &quot; . <a class="phpfunction" onClick="logFunction('print_r')" href="../../_functions/print_r.html" onMouseOver="phpfuncPopup(event,'print_r')">print_r</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, true));
<a name="l378"><span class="linenum"> 378</span></a>              return false;
<a name="l379"><span class="linenum"> 379</span></a>          }
<a name="l380"><span class="linenum"> 380</span></a>  
<a name="l381"><span class="linenum"> 381</span></a>  <span class="comment">        // build path and depth</span>
<a name="l382"><span class="linenum"> 382</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>('system');
<a name="l383"><span class="linenum"> 383</span></a>  
<a name="l384"><span class="linenum"> 384</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('id')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l385"><span class="linenum"> 385</span></a>      }
<a name="l386"><span class="linenum"> 386</span></a>  
<a name="l387"><span class="linenum"> 387</span></a>      <span class="comment">/**</span>
<a name="l388"><span class="linenum"> 388</span></a>  <span class="comment">     * Compares the values held by this object with those of the matching record in DB, and returns</span>
<a name="l389"><span class="linenum"> 389</span></a>  <span class="comment">     * whether or not these differences are sufficient to justify an update of all parent objects.</span>
<a name="l390"><span class="linenum"> 390</span></a>  <span class="comment">     * This assumes that this object has an ID number and a matching record in DB. If not, it will return false.</span>
<a name="l391"><span class="linenum"> 391</span></a>  <span class="comment">     *</span>
<a name="l392"><span class="linenum"> 392</span></a>  <span class="comment">     * @return bool</span>
<a name="l393"><span class="linenum"> 393</span></a>  <span class="comment">     */</span>
<a name="l394"><span class="linenum"> 394</span></a>      public function <a class="function" onClick="logFunction('qualifies_for_regrading')" href="../../_functions/qualifies_for_regrading.html" onMouseOver="funcPopup(event,'qualifies_for_regrading')">qualifies_for_regrading</a>() {
<a name="l395"><span class="linenum"> 395</span></a>          if (empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('id')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>)) {
<a name="l396"><span class="linenum"> 396</span></a>              <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(&quot;Can not regrade non existing category&quot;);
<a name="l397"><span class="linenum"> 397</span></a>              return false;
<a name="l398"><span class="linenum"> 398</span></a>          }
<a name="l399"><span class="linenum"> 399</span></a>  
<a name="l400"><span class="linenum"> 400</span></a>          <a class="var it9982" onMouseOver="hilite(9982)" onMouseOut="lolite()" onClick="logVariable('db_item')" href="../../_variables/db_item.html">$db_item</a> = <a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>::<a class="function" onClick="logFunction('fetch')" href="../../_functions/fetch.html" onMouseOver="funcPopup(event,'fetch')">fetch</a>(array('id'=&gt;<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('id')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l401"><span class="linenum"> 401</span></a>  
<a name="l402"><span class="linenum"> 402</span></a>          <a class="var it33670" onMouseOver="hilite(33670)" onMouseOut="lolite()" onClick="logVariable('aggregationdiff')" href="../../_variables/aggregationdiff.html">$aggregationdiff</a> = <a class="var it9982" onMouseOver="hilite(9982)" onMouseOut="lolite()" onClick="logVariable('db_item')" href="../../_variables/db_item.html">$db_item</a>-&gt;<a onClick="logVariable('aggregation')" class="var it40060" onMouseOver="hilite(40060)" onMouseOut="lolite()" href="../../_variables/aggregation.html">aggregation</a>         != <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregation')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregation.html">aggregation</a>;
<a name="l403"><span class="linenum"> 403</span></a>          <a class="var it33671" onMouseOver="hilite(33671)" onMouseOut="lolite()" onClick="logVariable('keephighdiff')" href="../../_variables/keephighdiff.html">$keephighdiff</a>    = <a class="var it9982" onMouseOver="hilite(9982)" onMouseOut="lolite()" onClick="logVariable('db_item')" href="../../_variables/db_item.html">$db_item</a>-&gt;<a onClick="logVariable('keephigh')" class="var it40060" onMouseOver="hilite(40060)" onMouseOut="lolite()" href="../../_variables/keephigh.html">keephigh</a>            != <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('keephigh')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/keephigh.html">keephigh</a>;
<a name="l404"><span class="linenum"> 404</span></a>          <a class="var it33672" onMouseOver="hilite(33672)" onMouseOut="lolite()" onClick="logVariable('droplowdiff')" href="../../_variables/droplowdiff.html">$droplowdiff</a>     = <a class="var it9982" onMouseOver="hilite(9982)" onMouseOut="lolite()" onClick="logVariable('db_item')" href="../../_variables/db_item.html">$db_item</a>-&gt;<a onClick="logVariable('droplow')" class="var it40060" onMouseOver="hilite(40060)" onMouseOut="lolite()" href="../../_variables/droplow.html">droplow</a>             != <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('droplow')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/droplow.html">droplow</a>;
<a name="l405"><span class="linenum"> 405</span></a>          <a class="var it33673" onMouseOver="hilite(33673)" onMouseOut="lolite()" onClick="logVariable('aggonlygrddiff')" href="../../_variables/aggonlygrddiff.html">$aggonlygrddiff</a>  = <a class="var it9982" onMouseOver="hilite(9982)" onMouseOut="lolite()" onClick="logVariable('db_item')" href="../../_variables/db_item.html">$db_item</a>-&gt;<a onClick="logVariable('aggregateonlygraded')" class="var it40060" onMouseOver="hilite(40060)" onMouseOut="lolite()" href="../../_variables/aggregateonlygraded.html">aggregateonlygraded</a> != <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregateonlygraded')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregateonlygraded.html">aggregateonlygraded</a>;
<a name="l406"><span class="linenum"> 406</span></a>          <a class="var it33674" onMouseOver="hilite(33674)" onMouseOut="lolite()" onClick="logVariable('aggoutcomesdiff')" href="../../_variables/aggoutcomesdiff.html">$aggoutcomesdiff</a> = <a class="var it9982" onMouseOver="hilite(9982)" onMouseOut="lolite()" onClick="logVariable('db_item')" href="../../_variables/db_item.html">$db_item</a>-&gt;<a onClick="logVariable('aggregateoutcomes')" class="var it40060" onMouseOver="hilite(40060)" onMouseOut="lolite()" href="../../_variables/aggregateoutcomes.html">aggregateoutcomes</a>   != <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregateoutcomes')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregateoutcomes.html">aggregateoutcomes</a>;
<a name="l407"><span class="linenum"> 407</span></a>  
<a name="l408"><span class="linenum"> 408</span></a>          return (<a class="var it33670" onMouseOver="hilite(33670)" onMouseOut="lolite()" onClick="logVariable('aggregationdiff')" href="../../_variables/aggregationdiff.html">$aggregationdiff</a> || <a class="var it33671" onMouseOver="hilite(33671)" onMouseOut="lolite()" onClick="logVariable('keephighdiff')" href="../../_variables/keephighdiff.html">$keephighdiff</a> || <a class="var it33672" onMouseOver="hilite(33672)" onMouseOut="lolite()" onClick="logVariable('droplowdiff')" href="../../_variables/droplowdiff.html">$droplowdiff</a> || <a class="var it33673" onMouseOver="hilite(33673)" onMouseOut="lolite()" onClick="logVariable('aggonlygrddiff')" href="../../_variables/aggonlygrddiff.html">$aggonlygrddiff</a> || <a class="var it33674" onMouseOver="hilite(33674)" onMouseOut="lolite()" onClick="logVariable('aggoutcomesdiff')" href="../../_variables/aggoutcomesdiff.html">$aggoutcomesdiff</a>);
<a name="l409"><span class="linenum"> 409</span></a>      }
<a name="l410"><span class="linenum"> 410</span></a>  
<a name="l411"><span class="linenum"> 411</span></a>      <span class="comment">/**</span>
<a name="l412"><span class="linenum"> 412</span></a>  <span class="comment">     * Marks this grade categories' associated grade item as needing regrading</span>
<a name="l413"><span class="linenum"> 413</span></a>  <span class="comment">     */</span>
<a name="l414"><span class="linenum"> 414</span></a>      public function <a class="function" onClick="logFunction('force_regrading')" href="../../_functions/force_regrading.html" onMouseOver="funcPopup(event,'force_regrading')">force_regrading</a>() {
<a name="l415"><span class="linenum"> 415</span></a>          <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l416"><span class="linenum"> 416</span></a>          <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>-&gt;<a class="function" onClick="logFunction('force_regrading')" href="../../_functions/force_regrading.html" onMouseOver="funcPopup(event,'force_regrading')">force_regrading</a>();
<a name="l417"><span class="linenum"> 417</span></a>      }
<a name="l418"><span class="linenum"> 418</span></a>  
<a name="l419"><span class="linenum"> 419</span></a>      <span class="comment">/**</span>
<a name="l420"><span class="linenum"> 420</span></a>  <span class="comment">     * Something that should be called before we start regrading the whole course.</span>
<a name="l421"><span class="linenum"> 421</span></a>  <span class="comment">     *</span>
<a name="l422"><span class="linenum"> 422</span></a>  <span class="comment">     * @return void</span>
<a name="l423"><span class="linenum"> 423</span></a>  <span class="comment">     */</span>
<a name="l424"><span class="linenum"> 424</span></a>      public function <a class="function" onClick="logFunction('pre_regrade_final_grades')" href="../../_functions/pre_regrade_final_grades.html" onMouseOver="funcPopup(event,'pre_regrade_final_grades')">pre_regrade_final_grades</a>() {
<a name="l425"><span class="linenum"> 425</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('auto_update_weights')" href="../../_functions/auto_update_weights.html" onMouseOver="funcPopup(event,'auto_update_weights')">auto_update_weights</a>();
<a name="l426"><span class="linenum"> 426</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('auto_update_max')" href="../../_functions/auto_update_max.html" onMouseOver="funcPopup(event,'auto_update_max')">auto_update_max</a>();
<a name="l427"><span class="linenum"> 427</span></a>      }
<a name="l428"><span class="linenum"> 428</span></a>  
<a name="l429"><span class="linenum"> 429</span></a>      <span class="comment">/**</span>
<a name="l430"><span class="linenum"> 430</span></a>  <span class="comment">     * Generates and saves final grades in associated category grade item.</span>
<a name="l431"><span class="linenum"> 431</span></a>  <span class="comment">     * These immediate children must already have their own final grades.</span>
<a name="l432"><span class="linenum"> 432</span></a>  <span class="comment">     * The category's aggregation method is used to generate final grades.</span>
<a name="l433"><span class="linenum"> 433</span></a>  <span class="comment">     *</span>
<a name="l434"><span class="linenum"> 434</span></a>  <span class="comment">     * Please note that category grade is either calculated or aggregated, not both at the same time.</span>
<a name="l435"><span class="linenum"> 435</span></a>  <span class="comment">     *</span>
<a name="l436"><span class="linenum"> 436</span></a>  <span class="comment">     * This method must be used ONLY from grade_item::regrade_final_grades(),</span>
<a name="l437"><span class="linenum"> 437</span></a>  <span class="comment">     * because the calculation must be done in correct order!</span>
<a name="l438"><span class="linenum"> 438</span></a>  <span class="comment">     *</span>
<a name="l439"><span class="linenum"> 439</span></a>  <span class="comment">     * Steps to follow:</span>
<a name="l440"><span class="linenum"> 440</span></a>  <span class="comment">     *  1. Get final grades from immediate children</span>
<a name="l441"><span class="linenum"> 441</span></a>  <span class="comment">     *  3. Aggregate these grades</span>
<a name="l442"><span class="linenum"> 442</span></a>  <span class="comment">     *  4. Save them in final grades of associated category grade item</span>
<a name="l443"><span class="linenum"> 443</span></a>  <span class="comment">     *</span>
<a name="l444"><span class="linenum"> 444</span></a>  <span class="comment">     * @param int $userid The user ID if final grade generation should be limited to a single user</span>
<a name="l445"><span class="linenum"> 445</span></a>  <span class="comment">     * @return bool</span>
<a name="l446"><span class="linenum"> 446</span></a>  <span class="comment">     */</span>
<a name="l447"><span class="linenum"> 447</span></a>      public function <a class="function" onClick="logFunction('generate_grades')" href="../../_functions/generate_grades.html" onMouseOver="funcPopup(event,'generate_grades')">generate_grades</a>(<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>=null) {
<a name="l448"><span class="linenum"> 448</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l449"><span class="linenum"> 449</span></a>  
<a name="l450"><span class="linenum"> 450</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l451"><span class="linenum"> 451</span></a>  
<a name="l452"><span class="linenum"> 452</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('is_locked')" href="../../_functions/is_locked.html" onMouseOver="funcPopup(event,'is_locked')">is_locked</a>()) {
<a name="l453"><span class="linenum"> 453</span></a>              return true; <span class="comment">// no need to recalculate locked items</span>
<a name="l454"><span class="linenum"> 454</span></a>          }
<a name="l455"><span class="linenum"> 455</span></a>  
<a name="l456"><span class="linenum"> 456</span></a>  <span class="comment">        // find grade items of immediate children (category or grade items) and force site settings</span>
<a name="l457"><span class="linenum"> 457</span></a>          <a class="var it33675" onMouseOver="hilite(33675)" onMouseOut="lolite()" onClick="logVariable('depends_on')" href="../../_variables/depends_on.html">$depends_on</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('depends_on')" href="../../_functions/depends_on.html" onMouseOver="funcPopup(event,'depends_on')">depends_on</a>();
<a name="l458"><span class="linenum"> 458</span></a>  
<a name="l459"><span class="linenum"> 459</span></a>          if (empty(<a class="var it33675" onMouseOver="hilite(33675)" onMouseOut="lolite()" onClick="logVariable('depends_on')" href="../../_variables/depends_on.html">$depends_on</a>)) {
<a name="l460"><span class="linenum"> 460</span></a>              <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a> = false;
<a name="l461"><span class="linenum"> 461</span></a>  
<a name="l462"><span class="linenum"> 462</span></a>          } else {
<a name="l463"><span class="linenum"> 463</span></a>              <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it2909" onMouseOver="hilite(2909)" onMouseOut="lolite()" onClick="logVariable('usql')" href="../../_variables/usql.html">$usql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it33675" onMouseOver="hilite(33675)" onMouseOut="lolite()" onClick="logVariable('depends_on')" href="../../_variables/depends_on.html">$depends_on</a>);
<a name="l464"><span class="linenum"> 464</span></a>              <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT *
<a name="l465"><span class="linenum"> 465</span></a>                        FROM {grade_items}
<a name="l466"><span class="linenum"> 466</span></a>                       WHERE id <a class="var it2909" onMouseOver="hilite(2909)" onMouseOut="lolite()" onClick="logVariable('usql')" href="../../_variables/usql.html">$usql</a>&quot;;
<a name="l467"><span class="linenum"> 467</span></a>              <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l468"><span class="linenum"> 468</span></a>          }
<a name="l469"><span class="linenum"> 469</span></a>  
<a name="l470"><span class="linenum"> 470</span></a>          <a class="var it10004" onMouseOver="hilite(10004)" onMouseOut="lolite()" onClick="logVariable('grade_inst')" href="../../_variables/grade_inst.html">$grade_inst</a> = <span class="keyword">new </span><a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>();
<a name="l471"><span class="linenum"> 471</span></a>          <a class="var it399" onMouseOver="hilite(399)" onMouseOut="lolite()" onClick="logVariable('fields')" href="../../_variables/fields.html">$fields</a> = 'g.'.<a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(',g.', <a class="var it10004" onMouseOver="hilite(10004)" onMouseOut="lolite()" onClick="logVariable('grade_inst')" href="../../_variables/grade_inst.html">$grade_inst</a>-&gt;<a onClick="logVariable('required_fields')" class="var it40061" onMouseOver="hilite(40061)" onMouseOut="lolite()" href="../../_variables/required_fields.html">required_fields</a>);
<a name="l472"><span class="linenum"> 472</span></a>  
<a name="l473"><span class="linenum"> 473</span></a>  <span class="comment">        // where to look for final grades - include grade of this item too, we will store the results there</span>
<a name="l474"><span class="linenum"> 474</span></a>          <a class="var it10029" onMouseOver="hilite(10029)" onMouseOut="lolite()" onClick="logVariable('gis')" href="../../_variables/gis.html">$gis</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it33675" onMouseOver="hilite(33675)" onMouseOut="lolite()" onClick="logVariable('depends_on')" href="../../_variables/depends_on.html">$depends_on</a>, array(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;id));
<a name="l475"><span class="linenum"> 475</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it2909" onMouseOver="hilite(2909)" onMouseOut="lolite()" onClick="logVariable('usql')" href="../../_variables/usql.html">$usql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it10029" onMouseOver="hilite(10029)" onMouseOut="lolite()" onClick="logVariable('gis')" href="../../_variables/gis.html">$gis</a>);
<a name="l476"><span class="linenum"> 476</span></a>  
<a name="l477"><span class="linenum"> 477</span></a>          if (<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>) {
<a name="l478"><span class="linenum"> 478</span></a>              <a class="var it2971" onMouseOver="hilite(2971)" onMouseOut="lolite()" onClick="logVariable('usersql')" href="../../_variables/usersql.html">$usersql</a> = &quot;AND g.userid=?&quot;;
<a name="l479"><span class="linenum"> 479</span></a>              <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>[] = <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>;
<a name="l480"><span class="linenum"> 480</span></a>  
<a name="l481"><span class="linenum"> 481</span></a>          } else {
<a name="l482"><span class="linenum"> 482</span></a>              <a class="var it2971" onMouseOver="hilite(2971)" onMouseOut="lolite()" onClick="logVariable('usersql')" href="../../_variables/usersql.html">$usersql</a> = &quot;&quot;;
<a name="l483"><span class="linenum"> 483</span></a>          }
<a name="l484"><span class="linenum"> 484</span></a>  
<a name="l485"><span class="linenum"> 485</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT <a class="var it399" onMouseOver="hilite(399)" onMouseOut="lolite()" onClick="logVariable('fields')" href="../../_variables/fields.html">$fields</a>
<a name="l486"><span class="linenum"> 486</span></a>                    FROM {grade_grades} g, {grade_items} gi
<a name="l487"><span class="linenum"> 487</span></a>                   WHERE gi.id = g.itemid AND gi.id <a class="var it2909" onMouseOver="hilite(2909)" onMouseOut="lolite()" onClick="logVariable('usql')" href="../../_variables/usql.html">$usql</a> <a class="var it2971" onMouseOver="hilite(2971)" onMouseOut="lolite()" onClick="logVariable('usersql')" href="../../_variables/usersql.html">$usersql</a>
<a name="l488"><span class="linenum"> 488</span></a>                ORDER BY g.userid&quot;;
<a name="l489"><span class="linenum"> 489</span></a>  
<a name="l490"><span class="linenum"> 490</span></a>  <span class="comment">        // group the results by userid and aggregate the grades for this user</span>
<a name="l491"><span class="linenum"> 491</span></a>          <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../_variables/rs.html">$rs</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset_sql')" href="../../_functions/get_recordset_sql.html" onMouseOver="funcPopup(event,'get_recordset_sql')">get_recordset_sql</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l492"><span class="linenum"> 492</span></a>          if (<a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../_variables/rs.html">$rs</a>-&gt;<a class="function" onClick="logFunction('valid')" href="../../_functions/valid.html" onMouseOver="funcPopup(event,'valid')">valid</a>()) {
<a name="l493"><span class="linenum"> 493</span></a>              <a class="var it10030" onMouseOver="hilite(10030)" onMouseOut="lolite()" onClick="logVariable('prevuser')" href="../../_variables/prevuser.html">$prevuser</a> = 0;
<a name="l494"><span class="linenum"> 494</span></a>              <a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> = array();
<a name="l495"><span class="linenum"> 495</span></a>              <a class="var it9475" onMouseOver="hilite(9475)" onMouseOut="lolite()" onClick="logVariable('excluded')" href="../../_variables/excluded.html">$excluded</a>     = array();
<a name="l496"><span class="linenum"> 496</span></a>              <a class="var it9477" onMouseOver="hilite(9477)" onMouseOut="lolite()" onClick="logVariable('oldgrade')" href="../../_variables/oldgrade.html">$oldgrade</a>     = null;
<a name="l497"><span class="linenum"> 497</span></a>              <a class="var it33677" onMouseOver="hilite(33677)" onMouseOut="lolite()" onClick="logVariable('grademaxoverrides')" href="../../_variables/grademaxoverrides.html">$grademaxoverrides</a> = array();
<a name="l498"><span class="linenum"> 498</span></a>              <a class="var it33678" onMouseOver="hilite(33678)" onMouseOut="lolite()" onClick="logVariable('grademinoverrides')" href="../../_variables/grademinoverrides.html">$grademinoverrides</a> = array();
<a name="l499"><span class="linenum"> 499</span></a>  
<a name="l500"><span class="linenum"> 500</span></a>              foreach (<a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../_variables/rs.html">$rs</a> as <a class="var it4449" onMouseOver="hilite(4449)" onMouseOut="lolite()" onClick="logVariable('used')" href="../../_variables/used.html">$used</a>) {
<a name="l501"><span class="linenum"> 501</span></a>  
<a name="l502"><span class="linenum"> 502</span></a>                  if (<a class="var it4449" onMouseOver="hilite(4449)" onMouseOut="lolite()" onClick="logVariable('used')" href="../../_variables/used.html">$used</a>-&gt;<a onClick="logVariable('userid')" class="var it40062" onMouseOver="hilite(40062)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> != <a class="var it10030" onMouseOver="hilite(10030)" onMouseOut="lolite()" onClick="logVariable('prevuser')" href="../../_variables/prevuser.html">$prevuser</a>) {
<a name="l503"><span class="linenum"> 503</span></a>                      <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('aggregate_grades')" href="../../_functions/aggregate_grades.html" onMouseOver="funcPopup(event,'aggregate_grades')">aggregate_grades</a>(<a class="var it10030" onMouseOver="hilite(10030)" onMouseOut="lolite()" onClick="logVariable('prevuser')" href="../../_variables/prevuser.html">$prevuser</a>,
<a name="l504"><span class="linenum"> 504</span></a>                                              <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>,
<a name="l505"><span class="linenum"> 505</span></a>                                              <a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>,
<a name="l506"><span class="linenum"> 506</span></a>                                              <a class="var it9477" onMouseOver="hilite(9477)" onMouseOut="lolite()" onClick="logVariable('oldgrade')" href="../../_variables/oldgrade.html">$oldgrade</a>,
<a name="l507"><span class="linenum"> 507</span></a>                                              <a class="var it9475" onMouseOver="hilite(9475)" onMouseOut="lolite()" onClick="logVariable('excluded')" href="../../_variables/excluded.html">$excluded</a>,
<a name="l508"><span class="linenum"> 508</span></a>                                              <a class="var it33678" onMouseOver="hilite(33678)" onMouseOut="lolite()" onClick="logVariable('grademinoverrides')" href="../../_variables/grademinoverrides.html">$grademinoverrides</a>,
<a name="l509"><span class="linenum"> 509</span></a>                                              <a class="var it33677" onMouseOver="hilite(33677)" onMouseOut="lolite()" onClick="logVariable('grademaxoverrides')" href="../../_variables/grademaxoverrides.html">$grademaxoverrides</a>);
<a name="l510"><span class="linenum"> 510</span></a>                      <a class="var it10030" onMouseOver="hilite(10030)" onMouseOut="lolite()" onClick="logVariable('prevuser')" href="../../_variables/prevuser.html">$prevuser</a> = <a class="var it4449" onMouseOver="hilite(4449)" onMouseOut="lolite()" onClick="logVariable('used')" href="../../_variables/used.html">$used</a>-&gt;<a onClick="logVariable('userid')" class="var it40062" onMouseOver="hilite(40062)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>;
<a name="l511"><span class="linenum"> 511</span></a>                      <a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> = array();
<a name="l512"><span class="linenum"> 512</span></a>                      <a class="var it9475" onMouseOver="hilite(9475)" onMouseOut="lolite()" onClick="logVariable('excluded')" href="../../_variables/excluded.html">$excluded</a>     = array();
<a name="l513"><span class="linenum"> 513</span></a>                      <a class="var it9477" onMouseOver="hilite(9477)" onMouseOut="lolite()" onClick="logVariable('oldgrade')" href="../../_variables/oldgrade.html">$oldgrade</a>     = null;
<a name="l514"><span class="linenum"> 514</span></a>                      <a class="var it33677" onMouseOver="hilite(33677)" onMouseOut="lolite()" onClick="logVariable('grademaxoverrides')" href="../../_variables/grademaxoverrides.html">$grademaxoverrides</a> = array();
<a name="l515"><span class="linenum"> 515</span></a>                      <a class="var it33678" onMouseOver="hilite(33678)" onMouseOut="lolite()" onClick="logVariable('grademinoverrides')" href="../../_variables/grademinoverrides.html">$grademinoverrides</a> = array();
<a name="l516"><span class="linenum"> 516</span></a>                  }
<a name="l517"><span class="linenum"> 517</span></a>                  <a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>[<a class="var it4449" onMouseOver="hilite(4449)" onMouseOut="lolite()" onClick="logVariable('used')" href="../../_variables/used.html">$used</a>-&gt;<a onClick="logVariable('itemid')" class="var it40062" onMouseOver="hilite(40062)" onMouseOut="lolite()" href="../../_variables/itemid.html">itemid</a>] = <a class="var it4449" onMouseOver="hilite(4449)" onMouseOut="lolite()" onClick="logVariable('used')" href="../../_variables/used.html">$used</a>-&gt;<a onClick="logVariable('finalgrade')" class="var it40062" onMouseOver="hilite(40062)" onMouseOut="lolite()" href="../../_variables/finalgrade.html">finalgrade</a>;
<a name="l518"><span class="linenum"> 518</span></a>                  <a class="var it33677" onMouseOver="hilite(33677)" onMouseOut="lolite()" onClick="logVariable('grademaxoverrides')" href="../../_variables/grademaxoverrides.html">$grademaxoverrides</a>[<a class="var it4449" onMouseOver="hilite(4449)" onMouseOut="lolite()" onClick="logVariable('used')" href="../../_variables/used.html">$used</a>-&gt;<a onClick="logVariable('itemid')" class="var it40062" onMouseOver="hilite(40062)" onMouseOut="lolite()" href="../../_variables/itemid.html">itemid</a>] = <a class="var it4449" onMouseOver="hilite(4449)" onMouseOut="lolite()" onClick="logVariable('used')" href="../../_variables/used.html">$used</a>-&gt;<a onClick="logVariable('rawgrademax')" class="var it40062" onMouseOver="hilite(40062)" onMouseOut="lolite()" href="../../_variables/rawgrademax.html">rawgrademax</a>;
<a name="l519"><span class="linenum"> 519</span></a>                  <a class="var it33678" onMouseOver="hilite(33678)" onMouseOut="lolite()" onClick="logVariable('grademinoverrides')" href="../../_variables/grademinoverrides.html">$grademinoverrides</a>[<a class="var it4449" onMouseOver="hilite(4449)" onMouseOut="lolite()" onClick="logVariable('used')" href="../../_variables/used.html">$used</a>-&gt;<a onClick="logVariable('itemid')" class="var it40062" onMouseOver="hilite(40062)" onMouseOut="lolite()" href="../../_variables/itemid.html">itemid</a>] = <a class="var it4449" onMouseOver="hilite(4449)" onMouseOut="lolite()" onClick="logVariable('used')" href="../../_variables/used.html">$used</a>-&gt;<a onClick="logVariable('rawgrademin')" class="var it40062" onMouseOver="hilite(40062)" onMouseOut="lolite()" href="../../_variables/rawgrademin.html">rawgrademin</a>;
<a name="l520"><span class="linenum"> 520</span></a>  
<a name="l521"><span class="linenum"> 521</span></a>                  if (<a class="var it4449" onMouseOver="hilite(4449)" onMouseOut="lolite()" onClick="logVariable('used')" href="../../_variables/used.html">$used</a>-&gt;<a onClick="logVariable('excluded')" class="var it40062" onMouseOver="hilite(40062)" onMouseOut="lolite()" href="../../_variables/excluded.html">excluded</a>) {
<a name="l522"><span class="linenum"> 522</span></a>                      <a class="var it9475" onMouseOver="hilite(9475)" onMouseOut="lolite()" onClick="logVariable('excluded')" href="../../_variables/excluded.html">$excluded</a>[] = <a class="var it4449" onMouseOver="hilite(4449)" onMouseOut="lolite()" onClick="logVariable('used')" href="../../_variables/used.html">$used</a>-&gt;<a onClick="logVariable('itemid')" class="var it40062" onMouseOver="hilite(40062)" onMouseOut="lolite()" href="../../_variables/itemid.html">itemid</a>;
<a name="l523"><span class="linenum"> 523</span></a>                  }
<a name="l524"><span class="linenum"> 524</span></a>  
<a name="l525"><span class="linenum"> 525</span></a>                  if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;id == <a class="var it4449" onMouseOver="hilite(4449)" onMouseOut="lolite()" onClick="logVariable('used')" href="../../_variables/used.html">$used</a>-&gt;<a onClick="logVariable('itemid')" class="var it40062" onMouseOver="hilite(40062)" onMouseOut="lolite()" href="../../_variables/itemid.html">itemid</a>) {
<a name="l526"><span class="linenum"> 526</span></a>                      <a class="var it9477" onMouseOver="hilite(9477)" onMouseOut="lolite()" onClick="logVariable('oldgrade')" href="../../_variables/oldgrade.html">$oldgrade</a> = <a class="var it4449" onMouseOver="hilite(4449)" onMouseOut="lolite()" onClick="logVariable('used')" href="../../_variables/used.html">$used</a>;
<a name="l527"><span class="linenum"> 527</span></a>                  }
<a name="l528"><span class="linenum"> 528</span></a>              }
<a name="l529"><span class="linenum"> 529</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('aggregate_grades')" href="../../_functions/aggregate_grades.html" onMouseOver="funcPopup(event,'aggregate_grades')">aggregate_grades</a>(<a class="var it10030" onMouseOver="hilite(10030)" onMouseOut="lolite()" onClick="logVariable('prevuser')" href="../../_variables/prevuser.html">$prevuser</a>,
<a name="l530"><span class="linenum"> 530</span></a>                                      <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>,
<a name="l531"><span class="linenum"> 531</span></a>                                      <a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>,
<a name="l532"><span class="linenum"> 532</span></a>                                      <a class="var it9477" onMouseOver="hilite(9477)" onMouseOut="lolite()" onClick="logVariable('oldgrade')" href="../../_variables/oldgrade.html">$oldgrade</a>,
<a name="l533"><span class="linenum"> 533</span></a>                                      <a class="var it9475" onMouseOver="hilite(9475)" onMouseOut="lolite()" onClick="logVariable('excluded')" href="../../_variables/excluded.html">$excluded</a>,
<a name="l534"><span class="linenum"> 534</span></a>                                      <a class="var it33678" onMouseOver="hilite(33678)" onMouseOut="lolite()" onClick="logVariable('grademinoverrides')" href="../../_variables/grademinoverrides.html">$grademinoverrides</a>,
<a name="l535"><span class="linenum"> 535</span></a>                                      <a class="var it33677" onMouseOver="hilite(33677)" onMouseOut="lolite()" onClick="logVariable('grademaxoverrides')" href="../../_variables/grademaxoverrides.html">$grademaxoverrides</a>);<span class="comment">//the last one</span>
<a name="l536"><span class="linenum"> 536</span></a>          }
<a name="l537"><span class="linenum"> 537</span></a>          <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../_variables/rs.html">$rs</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l538"><span class="linenum"> 538</span></a>  
<a name="l539"><span class="linenum"> 539</span></a>          return true;
<a name="l540"><span class="linenum"> 540</span></a>      }
<a name="l541"><span class="linenum"> 541</span></a>  
<a name="l542"><span class="linenum"> 542</span></a>      <span class="comment">/**</span>
<a name="l543"><span class="linenum"> 543</span></a>  <span class="comment">     * Internal function for grade category grade aggregation</span>
<a name="l544"><span class="linenum"> 544</span></a>  <span class="comment">     *</span>
<a name="l545"><span class="linenum"> 545</span></a>  <span class="comment">     * @param int    $userid The User ID</span>
<a name="l546"><span class="linenum"> 546</span></a>  <span class="comment">     * @param array  $items Grade items</span>
<a name="l547"><span class="linenum"> 547</span></a>  <span class="comment">     * @param array  $grade_values Array of grade values</span>
<a name="l548"><span class="linenum"> 548</span></a>  <span class="comment">     * @param object $oldgrade Old grade</span>
<a name="l549"><span class="linenum"> 549</span></a>  <span class="comment">     * @param array  $excluded Excluded</span>
<a name="l550"><span class="linenum"> 550</span></a>  <span class="comment">     * @param array  $grademinoverrides User specific grademin values if different to the grade_item grademin (key is itemid)</span>
<a name="l551"><span class="linenum"> 551</span></a>  <span class="comment">     * @param array  $grademaxoverrides User specific grademax values if different to the grade_item grademax (key is itemid)</span>
<a name="l552"><span class="linenum"> 552</span></a>  <span class="comment">     */</span>
<a name="l553"><span class="linenum"> 553</span></a>      private function <a class="function" onClick="logFunction('aggregate_grades')" href="../../_functions/aggregate_grades.html" onMouseOver="funcPopup(event,'aggregate_grades')">aggregate_grades</a>(<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>,
<a name="l554"><span class="linenum"> 554</span></a>                                        <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>,
<a name="l555"><span class="linenum"> 555</span></a>                                        <a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>,
<a name="l556"><span class="linenum"> 556</span></a>                                        <a class="var it9477" onMouseOver="hilite(9477)" onMouseOut="lolite()" onClick="logVariable('oldgrade')" href="../../_variables/oldgrade.html">$oldgrade</a>,
<a name="l557"><span class="linenum"> 557</span></a>                                        <a class="var it9475" onMouseOver="hilite(9475)" onMouseOut="lolite()" onClick="logVariable('excluded')" href="../../_variables/excluded.html">$excluded</a>,
<a name="l558"><span class="linenum"> 558</span></a>                                        <a class="var it33678" onMouseOver="hilite(33678)" onMouseOut="lolite()" onClick="logVariable('grademinoverrides')" href="../../_variables/grademinoverrides.html">$grademinoverrides</a>,
<a name="l559"><span class="linenum"> 559</span></a>                                        <a class="var it33677" onMouseOver="hilite(33677)" onMouseOut="lolite()" onClick="logVariable('grademaxoverrides')" href="../../_variables/grademaxoverrides.html">$grademaxoverrides</a>) {
<a name="l560"><span class="linenum"> 560</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l561"><span class="linenum"> 561</span></a>  
<a name="l562"><span class="linenum"> 562</span></a>  <span class="comment">        // Remember these so we can set flags on them to describe how they were used in the aggregation.</span>
<a name="l563"><span class="linenum"> 563</span></a>          <a class="var it33679" onMouseOver="hilite(33679)" onMouseOut="lolite()" onClick="logVariable('novalue')" href="../../_variables/novalue.html">$novalue</a> = array();
<a name="l564"><span class="linenum"> 564</span></a>          <a class="var it33680" onMouseOver="hilite(33680)" onMouseOut="lolite()" onClick="logVariable('dropped')" href="../../_variables/dropped.html">$dropped</a> = array();
<a name="l565"><span class="linenum"> 565</span></a>          <a class="var it33681" onMouseOver="hilite(33681)" onMouseOut="lolite()" onClick="logVariable('extracredit')" href="../../_variables/extracredit.html">$extracredit</a> = array();
<a name="l566"><span class="linenum"> 566</span></a>          <a class="var it26718" onMouseOver="hilite(26718)" onMouseOut="lolite()" onClick="logVariable('usedweights')" href="../../_variables/usedweights.html">$usedweights</a> = array();
<a name="l567"><span class="linenum"> 567</span></a>  
<a name="l568"><span class="linenum"> 568</span></a>          if (empty(<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>)) {
<a name="l569"><span class="linenum"> 569</span></a>  <span class="comment">            //ignore first call</span>
<a name="l570"><span class="linenum"> 570</span></a>              return;
<a name="l571"><span class="linenum"> 571</span></a>          }
<a name="l572"><span class="linenum"> 572</span></a>  
<a name="l573"><span class="linenum"> 573</span></a>          if (<a class="var it9477" onMouseOver="hilite(9477)" onMouseOut="lolite()" onClick="logVariable('oldgrade')" href="../../_variables/oldgrade.html">$oldgrade</a>) {
<a name="l574"><span class="linenum"> 574</span></a>              <a class="var it10034" onMouseOver="hilite(10034)" onMouseOut="lolite()" onClick="logVariable('oldfinalgrade')" href="../../_variables/oldfinalgrade.html">$oldfinalgrade</a> = <a class="var it9477" onMouseOver="hilite(9477)" onMouseOut="lolite()" onClick="logVariable('oldgrade')" href="../../_variables/oldgrade.html">$oldgrade</a>-&gt;<a onClick="logVariable('finalgrade')" class="var it40063" onMouseOver="hilite(40063)" onMouseOut="lolite()" href="../../_variables/finalgrade.html">finalgrade</a>;
<a name="l575"><span class="linenum"> 575</span></a>              <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a> = <span class="keyword">new </span><a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>(<a class="var it9477" onMouseOver="hilite(9477)" onMouseOut="lolite()" onClick="logVariable('oldgrade')" href="../../_variables/oldgrade.html">$oldgrade</a>, false);
<a name="l576"><span class="linenum"> 576</span></a>              <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a> =&amp; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>;
<a name="l577"><span class="linenum"> 577</span></a>  
<a name="l578"><span class="linenum"> 578</span></a>          } else {
<a name="l579"><span class="linenum"> 579</span></a>  <span class="comment">            // insert final grade - it will be needed later anyway</span>
<a name="l580"><span class="linenum"> 580</span></a>              <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a> = <span class="keyword">new </span><a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>(array('itemid'=&gt;<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;id, 'userid'=&gt;<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>), false);
<a name="l581"><span class="linenum"> 581</span></a>              <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a> =&amp; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>;
<a name="l582"><span class="linenum"> 582</span></a>              <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a class="function" onClick="logFunction('insert')" href="../../_functions/insert.html" onMouseOver="funcPopup(event,'insert')">insert</a>('system');
<a name="l583"><span class="linenum"> 583</span></a>              <a class="var it10034" onMouseOver="hilite(10034)" onMouseOut="lolite()" onClick="logVariable('oldfinalgrade')" href="../../_variables/oldfinalgrade.html">$oldfinalgrade</a> = null;
<a name="l584"><span class="linenum"> 584</span></a>          }
<a name="l585"><span class="linenum"> 585</span></a>  
<a name="l586"><span class="linenum"> 586</span></a>  <span class="comment">        // no need to recalculate locked or overridden grades</span>
<a name="l587"><span class="linenum"> 587</span></a>          if (<a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a class="function" onClick="logFunction('is_locked')" href="../../_functions/is_locked.html" onMouseOver="funcPopup(event,'is_locked')">is_locked</a>() or <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a class="function" onClick="logFunction('is_overridden')" href="../../_functions/is_overridden.html" onMouseOver="funcPopup(event,'is_overridden')">is_overridden</a>()) {
<a name="l588"><span class="linenum"> 588</span></a>              return;
<a name="l589"><span class="linenum"> 589</span></a>          }
<a name="l590"><span class="linenum"> 590</span></a>  
<a name="l591"><span class="linenum"> 591</span></a>  <span class="comment">        // can not use own final category grade in calculation</span>
<a name="l592"><span class="linenum"> 592</span></a>          unset(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>[<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;id]);
<a name="l593"><span class="linenum"> 593</span></a>  
<a name="l594"><span class="linenum"> 594</span></a>  <span class="comment">        // Make sure a grade_grade exists for every grade_item.</span>
<a name="l595"><span class="linenum"> 595</span></a>  <span class="comment">        // We need to do this so we can set the aggregationstatus</span>
<a name="l596"><span class="linenum"> 596</span></a>  <span class="comment">        // with a set_field call instead of checking if each one exists and creating/updating.</span>
<a name="l597"><span class="linenum"> 597</span></a>          if (!empty(<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>)) {
<a name="l598"><span class="linenum"> 598</span></a>              <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it33682" onMouseOver="hilite(33682)" onMouseOut="lolite()" onClick="logVariable('ggsql')" href="../../_variables/ggsql.html">$ggsql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>), <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'g');
<a name="l599"><span class="linenum"> 599</span></a>  
<a name="l600"><span class="linenum"> 600</span></a>  
<a name="l601"><span class="linenum"> 601</span></a>              <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['userid'] = <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>;
<a name="l602"><span class="linenum"> 602</span></a>              <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT itemid
<a name="l603"><span class="linenum"> 603</span></a>                        FROM {grade_grades}
<a name="l604"><span class="linenum"> 604</span></a>                       WHERE itemid <a class="var it33682" onMouseOver="hilite(33682)" onMouseOut="lolite()" onClick="logVariable('ggsql')" href="../../_variables/ggsql.html">$ggsql</a> AND userid = :userid&quot;;
<a name="l605"><span class="linenum"> 605</span></a>              <a class="var it33683" onMouseOver="hilite(33683)" onMouseOut="lolite()" onClick="logVariable('existingitems')" href="../../_variables/existingitems.html">$existingitems</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l606"><span class="linenum"> 606</span></a>  
<a name="l607"><span class="linenum"> 607</span></a>              <a class="var it33684" onMouseOver="hilite(33684)" onMouseOut="lolite()" onClick="logVariable('notexisting')" href="../../_variables/notexisting.html">$notexisting</a> = <a class="phpfunction" onClick="logFunction('array_diff')" href="../../_functions/array_diff.html" onMouseOver="phpfuncPopup(event,'array_diff')">array_diff</a>(<a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>), <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it33683" onMouseOver="hilite(33683)" onMouseOut="lolite()" onClick="logVariable('existingitems')" href="../../_variables/existingitems.html">$existingitems</a>));
<a name="l608"><span class="linenum"> 608</span></a>              foreach (<a class="var it33684" onMouseOver="hilite(33684)" onMouseOut="lolite()" onClick="logVariable('notexisting')" href="../../_variables/notexisting.html">$notexisting</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>) {
<a name="l609"><span class="linenum"> 609</span></a>                  <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a> = <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>];
<a name="l610"><span class="linenum"> 610</span></a>                  <a class="var it20537" onMouseOver="hilite(20537)" onMouseOut="lolite()" onClick="logVariable('gradegrade')" href="../../_variables/gradegrade.html">$gradegrade</a> = <span class="keyword">new </span><a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>(array('itemid' =&gt; <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>,
<a name="l611"><span class="linenum"> 611</span></a>                                                      'userid' =&gt; <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>,
<a name="l612"><span class="linenum"> 612</span></a>                                                      'rawgrademin' =&gt; <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('grademin')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/grademin.html">grademin</a>,
<a name="l613"><span class="linenum"> 613</span></a>                                                      'rawgrademax' =&gt; <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('grademax')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/grademax.html">grademax</a>), false);
<a name="l614"><span class="linenum"> 614</span></a>                  <a class="var it20537" onMouseOver="hilite(20537)" onMouseOut="lolite()" onClick="logVariable('gradegrade')" href="../../_variables/gradegrade.html">$gradegrade</a>-&gt;<a onClick="logVariable('grade_item')" class="var it40064" onMouseOver="hilite(40064)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a> = <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>;
<a name="l615"><span class="linenum"> 615</span></a>                  <a class="var it20537" onMouseOver="hilite(20537)" onMouseOut="lolite()" onClick="logVariable('gradegrade')" href="../../_variables/gradegrade.html">$gradegrade</a>-&gt;<a class="function" onClick="logFunction('insert')" href="../../_functions/insert.html" onMouseOver="funcPopup(event,'insert')">insert</a>('system');
<a name="l616"><span class="linenum"> 616</span></a>              }
<a name="l617"><span class="linenum"> 617</span></a>          }
<a name="l618"><span class="linenum"> 618</span></a>  
<a name="l619"><span class="linenum"> 619</span></a>  <span class="comment">        // if no grades calculation possible or grading not allowed clear final grade</span>
<a name="l620"><span class="linenum"> 620</span></a>          if (empty(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>) or empty(<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>) <a class="function" onClick="logFunction('or')" href="../../_functions/or.html" onMouseOver="funcPopup(event,'or')">or</a> (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;gradetype != <a class="constant" onClick="logConstant('GRADE_TYPE_VALUE')" href="../../_constants/GRADE_TYPE_VALUE.html" onMouseOver="constPopup(event,'GRADE_TYPE_VALUE')">GRADE_TYPE_VALUE</a> and <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;gradetype != <a class="constant" onClick="logConstant('GRADE_TYPE_SCALE')" href="../../_constants/GRADE_TYPE_SCALE.html" onMouseOver="constPopup(event,'GRADE_TYPE_SCALE')">GRADE_TYPE_SCALE</a>)) {
<a name="l621"><span class="linenum"> 621</span></a>              <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('finalgrade')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/finalgrade.html">finalgrade</a> = null;
<a name="l622"><span class="linenum"> 622</span></a>  
<a name="l623"><span class="linenum"> 623</span></a>              if (!<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it10034" onMouseOver="hilite(10034)" onMouseOut="lolite()" onClick="logVariable('oldfinalgrade')" href="../../_variables/oldfinalgrade.html">$oldfinalgrade</a>)) {
<a name="l624"><span class="linenum"> 624</span></a>                  <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('timemodified')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l625"><span class="linenum"> 625</span></a>                  <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('success')" href="../../_variables/success.html">$success</a> = <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>('aggregation');
<a name="l626"><span class="linenum"> 626</span></a>  
<a name="l627"><span class="linenum"> 627</span></a>  <span class="comment">                // If successful trigger a user_graded event.</span>
<a name="l628"><span class="linenum"> 628</span></a>                  if (<a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('success')" href="../../_variables/success.html">$success</a>) {
<a name="l629"><span class="linenum"> 629</span></a>                      \core\event\<a class="class" onClick="logClass('user_graded')" href="../../_classes/user_graded.html" onMouseOver="classPopup(event,'user_graded')">user_graded</a>::<a class="function" onClick="logFunction('create_from_grade')" href="../../_functions/create_from_grade.html" onMouseOver="funcPopup(event,'create_from_grade')">create_from_grade</a>(<a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>)-&gt;<a class="function" onClick="logFunction('trigger')" href="../../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l630"><span class="linenum"> 630</span></a>                  }
<a name="l631"><span class="linenum"> 631</span></a>              }
<a name="l632"><span class="linenum"> 632</span></a>              <a class="var it33680" onMouseOver="hilite(33680)" onMouseOut="lolite()" onClick="logVariable('dropped')" href="../../_variables/dropped.html">$dropped</a> = <a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>;
<a name="l633"><span class="linenum"> 633</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('set_usedinaggregation')" href="../../_functions/set_usedinaggregation.html" onMouseOver="funcPopup(event,'set_usedinaggregation')">set_usedinaggregation</a>(<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, <a class="var it26718" onMouseOver="hilite(26718)" onMouseOut="lolite()" onClick="logVariable('usedweights')" href="../../_variables/usedweights.html">$usedweights</a>, <a class="var it33679" onMouseOver="hilite(33679)" onMouseOut="lolite()" onClick="logVariable('novalue')" href="../../_variables/novalue.html">$novalue</a>, <a class="var it33680" onMouseOver="hilite(33680)" onMouseOut="lolite()" onClick="logVariable('dropped')" href="../../_variables/dropped.html">$dropped</a>, <a class="var it33681" onMouseOver="hilite(33681)" onMouseOut="lolite()" onClick="logVariable('extracredit')" href="../../_variables/extracredit.html">$extracredit</a>);
<a name="l634"><span class="linenum"> 634</span></a>              return;
<a name="l635"><span class="linenum"> 635</span></a>          }
<a name="l636"><span class="linenum"> 636</span></a>  
<a name="l637"><span class="linenum"> 637</span></a>  <span class="comment">        // Normalize the grades first - all will have value 0...1</span>
<a name="l638"><span class="linenum"> 638</span></a>  <span class="comment">        // ungraded items are not used in aggregation.</span>
<a name="l639"><span class="linenum"> 639</span></a>          foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>=&gt;<a class="var it44" onMouseOver="hilite(44)" onMouseOut="lolite()" onClick="logVariable('v')" href="../../_variables/v.html">$v</a>) {
<a name="l640"><span class="linenum"> 640</span></a>              if (<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it44" onMouseOver="hilite(44)" onMouseOut="lolite()" onClick="logVariable('v')" href="../../_variables/v.html">$v</a>)) {
<a name="l641"><span class="linenum"> 641</span></a>  <span class="comment">                // If null, it means no grade.</span>
<a name="l642"><span class="linenum"> 642</span></a>                  if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregateonlygraded')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregateonlygraded.html">aggregateonlygraded</a>) {
<a name="l643"><span class="linenum"> 643</span></a>                      unset(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]);
<a name="l644"><span class="linenum"> 644</span></a>  <span class="comment">                    // Mark this item as &quot;excluded empty&quot; because it has no grade.</span>
<a name="l645"><span class="linenum"> 645</span></a>                      <a class="var it33679" onMouseOver="hilite(33679)" onMouseOut="lolite()" onClick="logVariable('novalue')" href="../../_variables/novalue.html">$novalue</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 0;
<a name="l646"><span class="linenum"> 646</span></a>                      continue;
<a name="l647"><span class="linenum"> 647</span></a>                  }
<a name="l648"><span class="linenum"> 648</span></a>              }
<a name="l649"><span class="linenum"> 649</span></a>              if (<a class="phpfunction" onClick="logFunction('in_array')" href="../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>, <a class="var it9475" onMouseOver="hilite(9475)" onMouseOut="lolite()" onClick="logVariable('excluded')" href="../../_variables/excluded.html">$excluded</a>)) {
<a name="l650"><span class="linenum"> 650</span></a>                  unset(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]);
<a name="l651"><span class="linenum"> 651</span></a>                  <a class="var it33680" onMouseOver="hilite(33680)" onMouseOut="lolite()" onClick="logVariable('dropped')" href="../../_variables/dropped.html">$dropped</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 0;
<a name="l652"><span class="linenum"> 652</span></a>                  continue;
<a name="l653"><span class="linenum"> 653</span></a>              }
<a name="l654"><span class="linenum"> 654</span></a>  <span class="comment">            // Check for user specific grade min/max overrides.</span>
<a name="l655"><span class="linenum"> 655</span></a>              <a class="var it33685" onMouseOver="hilite(33685)" onMouseOut="lolite()" onClick="logVariable('usergrademin')" href="../../_variables/usergrademin.html">$usergrademin</a> = <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;grademin;
<a name="l656"><span class="linenum"> 656</span></a>              <a class="var it33686" onMouseOver="hilite(33686)" onMouseOut="lolite()" onClick="logVariable('usergrademax')" href="../../_variables/usergrademax.html">$usergrademax</a> = <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;grademax;
<a name="l657"><span class="linenum"> 657</span></a>              if (isset(<a class="var it33678" onMouseOver="hilite(33678)" onMouseOut="lolite()" onClick="logVariable('grademinoverrides')" href="../../_variables/grademinoverrides.html">$grademinoverrides</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>])) {
<a name="l658"><span class="linenum"> 658</span></a>                  <a class="var it33685" onMouseOver="hilite(33685)" onMouseOut="lolite()" onClick="logVariable('usergrademin')" href="../../_variables/usergrademin.html">$usergrademin</a> = <a class="var it33678" onMouseOver="hilite(33678)" onMouseOut="lolite()" onClick="logVariable('grademinoverrides')" href="../../_variables/grademinoverrides.html">$grademinoverrides</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>];
<a name="l659"><span class="linenum"> 659</span></a>              }
<a name="l660"><span class="linenum"> 660</span></a>              if (isset(<a class="var it33677" onMouseOver="hilite(33677)" onMouseOut="lolite()" onClick="logVariable('grademaxoverrides')" href="../../_variables/grademaxoverrides.html">$grademaxoverrides</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>])) {
<a name="l661"><span class="linenum"> 661</span></a>                  <a class="var it33686" onMouseOver="hilite(33686)" onMouseOut="lolite()" onClick="logVariable('usergrademax')" href="../../_variables/usergrademax.html">$usergrademax</a> = <a class="var it33677" onMouseOver="hilite(33677)" onMouseOut="lolite()" onClick="logVariable('grademaxoverrides')" href="../../_variables/grademaxoverrides.html">$grademaxoverrides</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>];
<a name="l662"><span class="linenum"> 662</span></a>              }
<a name="l663"><span class="linenum"> 663</span></a>              if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregation')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregation.html">aggregation</a> == <a class="constant" onClick="logConstant('GRADE_AGGREGATE_SUM')" href="../../_constants/GRADE_AGGREGATE_SUM.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_SUM')">GRADE_AGGREGATE_SUM</a>) {
<a name="l664"><span class="linenum"> 664</span></a>  <span class="comment">                // Assume that the grademin is 0 when standardising the score, to preserve negative grades.</span>
<a name="l665"><span class="linenum"> 665</span></a>                  <a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = <a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>::<a class="function" onClick="logFunction('standardise_score')" href="../../_functions/standardise_score.html" onMouseOver="funcPopup(event,'standardise_score')">standardise_score</a>(<a class="var it44" onMouseOver="hilite(44)" onMouseOut="lolite()" onClick="logVariable('v')" href="../../_variables/v.html">$v</a>, 0, <a class="var it33686" onMouseOver="hilite(33686)" onMouseOut="lolite()" onClick="logVariable('usergrademax')" href="../../_variables/usergrademax.html">$usergrademax</a>, 0, 1);
<a name="l666"><span class="linenum"> 666</span></a>              } else {
<a name="l667"><span class="linenum"> 667</span></a>                  <a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = <a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>::<a class="function" onClick="logFunction('standardise_score')" href="../../_functions/standardise_score.html" onMouseOver="funcPopup(event,'standardise_score')">standardise_score</a>(<a class="var it44" onMouseOver="hilite(44)" onMouseOut="lolite()" onClick="logVariable('v')" href="../../_variables/v.html">$v</a>, <a class="var it33685" onMouseOver="hilite(33685)" onMouseOut="lolite()" onClick="logVariable('usergrademin')" href="../../_variables/usergrademin.html">$usergrademin</a>, <a class="var it33686" onMouseOver="hilite(33686)" onMouseOut="lolite()" onClick="logVariable('usergrademax')" href="../../_variables/usergrademax.html">$usergrademax</a>, 0, 1);
<a name="l668"><span class="linenum"> 668</span></a>              }
<a name="l669"><span class="linenum"> 669</span></a>  
<a name="l670"><span class="linenum"> 670</span></a>          }
<a name="l671"><span class="linenum"> 671</span></a>  
<a name="l672"><span class="linenum"> 672</span></a>  <span class="comment">        // For items with no value, and not excluded - either set their grade to 0 or exclude them.</span>
<a name="l673"><span class="linenum"> 673</span></a>          foreach (<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>=&gt;<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l674"><span class="linenum"> 674</span></a>              if (!isset(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]) and !<a class="phpfunction" onClick="logFunction('in_array')" href="../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>, <a class="var it9475" onMouseOver="hilite(9475)" onMouseOut="lolite()" onClick="logVariable('excluded')" href="../../_variables/excluded.html">$excluded</a>)) {
<a name="l675"><span class="linenum"> 675</span></a>                  if (!<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregateonlygraded')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregateonlygraded.html">aggregateonlygraded</a>) {
<a name="l676"><span class="linenum"> 676</span></a>                      <a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 0;
<a name="l677"><span class="linenum"> 677</span></a>                  } else {
<a name="l678"><span class="linenum"> 678</span></a>  <span class="comment">                    // We are specifically marking these items as &quot;excluded empty&quot;.</span>
<a name="l679"><span class="linenum"> 679</span></a>                      <a class="var it33679" onMouseOver="hilite(33679)" onMouseOut="lolite()" onClick="logVariable('novalue')" href="../../_variables/novalue.html">$novalue</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 0;
<a name="l680"><span class="linenum"> 680</span></a>                  }
<a name="l681"><span class="linenum"> 681</span></a>              }
<a name="l682"><span class="linenum"> 682</span></a>          }
<a name="l683"><span class="linenum"> 683</span></a>  
<a name="l684"><span class="linenum"> 684</span></a>  <span class="comment">        // limit and sort</span>
<a name="l685"><span class="linenum"> 685</span></a>          <a class="var it30697" onMouseOver="hilite(30697)" onMouseOut="lolite()" onClick="logVariable('allvalues')" href="../../_variables/allvalues.html">$allvalues</a> = <a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>;
<a name="l686"><span class="linenum"> 686</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('can_apply_limit_rules')" href="../../_functions/can_apply_limit_rules.html" onMouseOver="funcPopup(event,'can_apply_limit_rules')">can_apply_limit_rules</a>()) {
<a name="l687"><span class="linenum"> 687</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('apply_limit_rules')" href="../../_functions/apply_limit_rules.html" onMouseOver="funcPopup(event,'apply_limit_rules')">apply_limit_rules</a>(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>, <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>);
<a name="l688"><span class="linenum"> 688</span></a>          }
<a name="l689"><span class="linenum"> 689</span></a>  
<a name="l690"><span class="linenum"> 690</span></a>          <a class="var it30698" onMouseOver="hilite(30698)" onMouseOut="lolite()" onClick="logVariable('moredropped')" href="../../_variables/moredropped.html">$moredropped</a> = <a class="phpfunction" onClick="logFunction('array_diff')" href="../../_functions/array_diff.html" onMouseOver="phpfuncPopup(event,'array_diff')">array_diff</a>(<a class="var it30697" onMouseOver="hilite(30697)" onMouseOut="lolite()" onClick="logVariable('allvalues')" href="../../_variables/allvalues.html">$allvalues</a>, <a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>);
<a name="l691"><span class="linenum"> 691</span></a>          foreach (<a class="var it30698" onMouseOver="hilite(30698)" onMouseOut="lolite()" onClick="logVariable('moredropped')" href="../../_variables/moredropped.html">$moredropped</a> as <a class="var it9383" onMouseOver="hilite(9383)" onMouseOut="lolite()" onClick="logVariable('drop')" href="../../_variables/drop.html">$drop</a> =&gt; <a class="var it1136" onMouseOver="hilite(1136)" onMouseOut="lolite()" onClick="logVariable('unused')" href="../../_variables/unused.html">$unused</a>) {
<a name="l692"><span class="linenum"> 692</span></a>              <a class="var it33680" onMouseOver="hilite(33680)" onMouseOut="lolite()" onClick="logVariable('dropped')" href="../../_variables/dropped.html">$dropped</a>[<a class="var it9383" onMouseOver="hilite(9383)" onMouseOut="lolite()" onClick="logVariable('drop')" href="../../_variables/drop.html">$drop</a>] = 0;
<a name="l693"><span class="linenum"> 693</span></a>          }
<a name="l694"><span class="linenum"> 694</span></a>  
<a name="l695"><span class="linenum"> 695</span></a>          foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a> =&gt; <a class="var it1140" onMouseOver="hilite(1140)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>) {
<a name="l696"><span class="linenum"> 696</span></a>              if (self::<a class="function" onClick="logFunction('is_extracredit_used')" href="../../_functions/is_extracredit_used.html" onMouseOver="funcPopup(event,'is_extracredit_used')">is_extracredit_used</a>() &amp;&amp; (<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;aggregationcoef &gt; 0)) {
<a name="l697"><span class="linenum"> 697</span></a>                  <a class="var it33681" onMouseOver="hilite(33681)" onMouseOut="lolite()" onClick="logVariable('extracredit')" href="../../_variables/extracredit.html">$extracredit</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 0;
<a name="l698"><span class="linenum"> 698</span></a>              }
<a name="l699"><span class="linenum"> 699</span></a>          }
<a name="l700"><span class="linenum"> 700</span></a>  
<a name="l701"><span class="linenum"> 701</span></a>          <a class="phpfunction" onClick="logFunction('asort')" href="../../_functions/asort.html" onMouseOver="phpfuncPopup(event,'asort')">asort</a>(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>, SORT_NUMERIC);
<a name="l702"><span class="linenum"> 702</span></a>  
<a name="l703"><span class="linenum"> 703</span></a>  <span class="comment">        // let's see we have still enough grades to do any statistics</span>
<a name="l704"><span class="linenum"> 704</span></a>          if (<a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>) == 0) {
<a name="l705"><span class="linenum"> 705</span></a>  <span class="comment">            // not enough attempts yet</span>
<a name="l706"><span class="linenum"> 706</span></a>              <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('finalgrade')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/finalgrade.html">finalgrade</a> = null;
<a name="l707"><span class="linenum"> 707</span></a>  
<a name="l708"><span class="linenum"> 708</span></a>              if (!<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it10034" onMouseOver="hilite(10034)" onMouseOut="lolite()" onClick="logVariable('oldfinalgrade')" href="../../_variables/oldfinalgrade.html">$oldfinalgrade</a>)) {
<a name="l709"><span class="linenum"> 709</span></a>                  <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('timemodified')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l710"><span class="linenum"> 710</span></a>                  <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('success')" href="../../_variables/success.html">$success</a> = <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>('aggregation');
<a name="l711"><span class="linenum"> 711</span></a>  
<a name="l712"><span class="linenum"> 712</span></a>  <span class="comment">                // If successful trigger a user_graded event.</span>
<a name="l713"><span class="linenum"> 713</span></a>                  if (<a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('success')" href="../../_variables/success.html">$success</a>) {
<a name="l714"><span class="linenum"> 714</span></a>                      \core\event\<a class="class" onClick="logClass('user_graded')" href="../../_classes/user_graded.html" onMouseOver="classPopup(event,'user_graded')">user_graded</a>::<a class="function" onClick="logFunction('create_from_grade')" href="../../_functions/create_from_grade.html" onMouseOver="funcPopup(event,'create_from_grade')">create_from_grade</a>(<a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>)-&gt;<a class="function" onClick="logFunction('trigger')" href="../../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l715"><span class="linenum"> 715</span></a>                  }
<a name="l716"><span class="linenum"> 716</span></a>              }
<a name="l717"><span class="linenum"> 717</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('set_usedinaggregation')" href="../../_functions/set_usedinaggregation.html" onMouseOver="funcPopup(event,'set_usedinaggregation')">set_usedinaggregation</a>(<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, <a class="var it26718" onMouseOver="hilite(26718)" onMouseOut="lolite()" onClick="logVariable('usedweights')" href="../../_variables/usedweights.html">$usedweights</a>, <a class="var it33679" onMouseOver="hilite(33679)" onMouseOut="lolite()" onClick="logVariable('novalue')" href="../../_variables/novalue.html">$novalue</a>, <a class="var it33680" onMouseOver="hilite(33680)" onMouseOut="lolite()" onClick="logVariable('dropped')" href="../../_variables/dropped.html">$dropped</a>, <a class="var it33681" onMouseOver="hilite(33681)" onMouseOut="lolite()" onClick="logVariable('extracredit')" href="../../_variables/extracredit.html">$extracredit</a>);
<a name="l718"><span class="linenum"> 718</span></a>              return;
<a name="l719"><span class="linenum"> 719</span></a>          }
<a name="l720"><span class="linenum"> 720</span></a>  
<a name="l721"><span class="linenum"> 721</span></a>  <span class="comment">        // do the maths</span>
<a name="l722"><span class="linenum"> 722</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('aggregate_values_and_adjust_bounds')" href="../../_functions/aggregate_values_and_adjust_bounds.html" onMouseOver="funcPopup(event,'aggregate_values_and_adjust_bounds')">aggregate_values_and_adjust_bounds</a>(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>,
<a name="l723"><span class="linenum"> 723</span></a>                                                              <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>,
<a name="l724"><span class="linenum"> 724</span></a>                                                              <a class="var it26718" onMouseOver="hilite(26718)" onMouseOut="lolite()" onClick="logVariable('usedweights')" href="../../_variables/usedweights.html">$usedweights</a>,
<a name="l725"><span class="linenum"> 725</span></a>                                                              <a class="var it33678" onMouseOver="hilite(33678)" onMouseOut="lolite()" onClick="logVariable('grademinoverrides')" href="../../_variables/grademinoverrides.html">$grademinoverrides</a>,
<a name="l726"><span class="linenum"> 726</span></a>                                                              <a class="var it33677" onMouseOver="hilite(33677)" onMouseOut="lolite()" onClick="logVariable('grademaxoverrides')" href="../../_variables/grademaxoverrides.html">$grademaxoverrides</a>);
<a name="l727"><span class="linenum"> 727</span></a>          <a class="var it33687" onMouseOver="hilite(33687)" onMouseOut="lolite()" onClick="logVariable('agg_grade')" href="../../_variables/agg_grade.html">$agg_grade</a> = <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>['grade'];
<a name="l728"><span class="linenum"> 728</span></a>  
<a name="l729"><span class="linenum"> 729</span></a>  <span class="comment">        // Set the actual grademin and max to bind the grade properly.</span>
<a name="l730"><span class="linenum"> 730</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;grademin = <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>['grademin'];
<a name="l731"><span class="linenum"> 731</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;grademax = <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>['grademax'];
<a name="l732"><span class="linenum"> 732</span></a>  
<a name="l733"><span class="linenum"> 733</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregation')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregation.html">aggregation</a> == <a class="constant" onClick="logConstant('GRADE_AGGREGATE_SUM')" href="../../_constants/GRADE_AGGREGATE_SUM.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_SUM')">GRADE_AGGREGATE_SUM</a>) {
<a name="l734"><span class="linenum"> 734</span></a>  <span class="comment">            // The natural aggregation always displays the range as coming from 0 for categories.</span>
<a name="l735"><span class="linenum"> 735</span></a>  <span class="comment">            // However, when we bind the grade we allow for negative values.</span>
<a name="l736"><span class="linenum"> 736</span></a>              <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>['grademin'] = 0;
<a name="l737"><span class="linenum"> 737</span></a>          }
<a name="l738"><span class="linenum"> 738</span></a>  
<a name="l739"><span class="linenum"> 739</span></a>  <span class="comment">        // Recalculate the grade back to requested range.</span>
<a name="l740"><span class="linenum"> 740</span></a>          <a class="var it4888" onMouseOver="hilite(4888)" onMouseOut="lolite()" onClick="logVariable('finalgrade')" href="../../_variables/finalgrade.html">$finalgrade</a> = <a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>::<a class="function" onClick="logFunction('standardise_score')" href="../../_functions/standardise_score.html" onMouseOver="funcPopup(event,'standardise_score')">standardise_score</a>(<a class="var it33687" onMouseOver="hilite(33687)" onMouseOut="lolite()" onClick="logVariable('agg_grade')" href="../../_variables/agg_grade.html">$agg_grade</a>, 0, 1, <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>['grademin'], <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>['grademax']);
<a name="l741"><span class="linenum"> 741</span></a>          <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('finalgrade')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/finalgrade.html">finalgrade</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('bounded_grade')" href="../../_functions/bounded_grade.html" onMouseOver="funcPopup(event,'bounded_grade')">bounded_grade</a>(<a class="var it4888" onMouseOver="hilite(4888)" onMouseOut="lolite()" onClick="logVariable('finalgrade')" href="../../_variables/finalgrade.html">$finalgrade</a>);
<a name="l742"><span class="linenum"> 742</span></a>  
<a name="l743"><span class="linenum"> 743</span></a>          <a class="var it33688" onMouseOver="hilite(33688)" onMouseOut="lolite()" onClick="logVariable('oldrawgrademin')" href="../../_variables/oldrawgrademin.html">$oldrawgrademin</a> = <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('rawgrademin')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/rawgrademin.html">rawgrademin</a>;
<a name="l744"><span class="linenum"> 744</span></a>          <a class="var it33689" onMouseOver="hilite(33689)" onMouseOut="lolite()" onClick="logVariable('oldrawgrademax')" href="../../_variables/oldrawgrademax.html">$oldrawgrademax</a> = <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('rawgrademax')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/rawgrademax.html">rawgrademax</a>;
<a name="l745"><span class="linenum"> 745</span></a>          <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('rawgrademin')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/rawgrademin.html">rawgrademin</a> = <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>['grademin'];
<a name="l746"><span class="linenum"> 746</span></a>          <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('rawgrademax')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/rawgrademax.html">rawgrademax</a> = <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>['grademax'];
<a name="l747"><span class="linenum"> 747</span></a>  
<a name="l748"><span class="linenum"> 748</span></a>  <span class="comment">        // Update in db if changed.</span>
<a name="l749"><span class="linenum"> 749</span></a>          if (<a class="function" onClick="logFunction('grade_floats_different')" href="../../_functions/grade_floats_different.html" onMouseOver="funcPopup(event,'grade_floats_different')">grade_floats_different</a>(<a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('finalgrade')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/finalgrade.html">finalgrade</a>, <a class="var it10034" onMouseOver="hilite(10034)" onMouseOut="lolite()" onClick="logVariable('oldfinalgrade')" href="../../_variables/oldfinalgrade.html">$oldfinalgrade</a>) ||
<a name="l750"><span class="linenum"> 750</span></a>                  <a class="function" onClick="logFunction('grade_floats_different')" href="../../_functions/grade_floats_different.html" onMouseOver="funcPopup(event,'grade_floats_different')">grade_floats_different</a>(<a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('rawgrademax')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/rawgrademax.html">rawgrademax</a>, <a class="var it33689" onMouseOver="hilite(33689)" onMouseOut="lolite()" onClick="logVariable('oldrawgrademax')" href="../../_variables/oldrawgrademax.html">$oldrawgrademax</a>) ||
<a name="l751"><span class="linenum"> 751</span></a>                  <a class="function" onClick="logFunction('grade_floats_different')" href="../../_functions/grade_floats_different.html" onMouseOver="funcPopup(event,'grade_floats_different')">grade_floats_different</a>(<a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('rawgrademin')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/rawgrademin.html">rawgrademin</a>, <a class="var it33688" onMouseOver="hilite(33688)" onMouseOut="lolite()" onClick="logVariable('oldrawgrademin')" href="../../_variables/oldrawgrademin.html">$oldrawgrademin</a>)) {
<a name="l752"><span class="linenum"> 752</span></a>              <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('timemodified')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l753"><span class="linenum"> 753</span></a>              <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('success')" href="../../_variables/success.html">$success</a> = <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>('aggregation');
<a name="l754"><span class="linenum"> 754</span></a>  
<a name="l755"><span class="linenum"> 755</span></a>  <span class="comment">            // If successful trigger a user_graded event.</span>
<a name="l756"><span class="linenum"> 756</span></a>              if (<a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('success')" href="../../_variables/success.html">$success</a>) {
<a name="l757"><span class="linenum"> 757</span></a>                  \core\event\<a class="class" onClick="logClass('user_graded')" href="../../_classes/user_graded.html" onMouseOver="classPopup(event,'user_graded')">user_graded</a>::<a class="function" onClick="logFunction('create_from_grade')" href="../../_functions/create_from_grade.html" onMouseOver="funcPopup(event,'create_from_grade')">create_from_grade</a>(<a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>)-&gt;<a class="function" onClick="logFunction('trigger')" href="../../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l758"><span class="linenum"> 758</span></a>              }
<a name="l759"><span class="linenum"> 759</span></a>          }
<a name="l760"><span class="linenum"> 760</span></a>  
<a name="l761"><span class="linenum"> 761</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('set_usedinaggregation')" href="../../_functions/set_usedinaggregation.html" onMouseOver="funcPopup(event,'set_usedinaggregation')">set_usedinaggregation</a>(<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, <a class="var it26718" onMouseOver="hilite(26718)" onMouseOut="lolite()" onClick="logVariable('usedweights')" href="../../_variables/usedweights.html">$usedweights</a>, <a class="var it33679" onMouseOver="hilite(33679)" onMouseOut="lolite()" onClick="logVariable('novalue')" href="../../_variables/novalue.html">$novalue</a>, <a class="var it33680" onMouseOver="hilite(33680)" onMouseOut="lolite()" onClick="logVariable('dropped')" href="../../_variables/dropped.html">$dropped</a>, <a class="var it33681" onMouseOver="hilite(33681)" onMouseOut="lolite()" onClick="logVariable('extracredit')" href="../../_variables/extracredit.html">$extracredit</a>);
<a name="l762"><span class="linenum"> 762</span></a>  
<a name="l763"><span class="linenum"> 763</span></a>          return;
<a name="l764"><span class="linenum"> 764</span></a>      }
<a name="l765"><span class="linenum"> 765</span></a>  
<a name="l766"><span class="linenum"> 766</span></a>      <span class="comment">/**</span>
<a name="l767"><span class="linenum"> 767</span></a>  <span class="comment">     * Set the flags on the grade_grade items to indicate how individual grades are used</span>
<a name="l768"><span class="linenum"> 768</span></a>  <span class="comment">     * in the aggregation.</span>
<a name="l769"><span class="linenum"> 769</span></a>  <span class="comment">     *</span>
<a name="l770"><span class="linenum"> 770</span></a>  <span class="comment">     * WARNING: This function is called a lot during gradebook recalculation, be very performance considerate.</span>
<a name="l771"><span class="linenum"> 771</span></a>  <span class="comment">     *</span>
<a name="l772"><span class="linenum"> 772</span></a>  <span class="comment">     * @param int $userid The user we have aggregated the grades for.</span>
<a name="l773"><span class="linenum"> 773</span></a>  <span class="comment">     * @param array $usedweights An array with keys for each of the grade_item columns included in the aggregation. The value are the relative weight.</span>
<a name="l774"><span class="linenum"> 774</span></a>  <span class="comment">     * @param array $novalue An array with keys for each of the grade_item columns skipped because</span>
<a name="l775"><span class="linenum"> 775</span></a>  <span class="comment">     *                       they had no value in the aggregation.</span>
<a name="l776"><span class="linenum"> 776</span></a>  <span class="comment">     * @param array $dropped An array with keys for each of the grade_item columns dropped</span>
<a name="l777"><span class="linenum"> 777</span></a>  <span class="comment">     *                       because of any drop lowest/highest settings in the aggregation.</span>
<a name="l778"><span class="linenum"> 778</span></a>  <span class="comment">     * @param array $extracredit An array with keys for each of the grade_item columns</span>
<a name="l779"><span class="linenum"> 779</span></a>  <span class="comment">     *                       considered extra credit by the aggregation.</span>
<a name="l780"><span class="linenum"> 780</span></a>  <span class="comment">     */</span>
<a name="l781"><span class="linenum"> 781</span></a>      private function <a class="function" onClick="logFunction('set_usedinaggregation')" href="../../_functions/set_usedinaggregation.html" onMouseOver="funcPopup(event,'set_usedinaggregation')">set_usedinaggregation</a>(<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, <a class="var it26718" onMouseOver="hilite(26718)" onMouseOut="lolite()" onClick="logVariable('usedweights')" href="../../_variables/usedweights.html">$usedweights</a>, <a class="var it33679" onMouseOver="hilite(33679)" onMouseOut="lolite()" onClick="logVariable('novalue')" href="../../_variables/novalue.html">$novalue</a>, <a class="var it33680" onMouseOver="hilite(33680)" onMouseOut="lolite()" onClick="logVariable('dropped')" href="../../_variables/dropped.html">$dropped</a>, <a class="var it33681" onMouseOver="hilite(33681)" onMouseOut="lolite()" onClick="logVariable('extracredit')" href="../../_variables/extracredit.html">$extracredit</a>) {
<a name="l782"><span class="linenum"> 782</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l783"><span class="linenum"> 783</span></a>  
<a name="l784"><span class="linenum"> 784</span></a>  <span class="comment">        // Reset aggregation to unknown and 0 for all grade items for this user and category.</span>
<a name="l785"><span class="linenum"> 785</span></a>          <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('categoryid' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('id')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'userid' =&gt; <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>);
<a name="l786"><span class="linenum"> 786</span></a>          <a class="var it33690" onMouseOver="hilite(33690)" onMouseOut="lolite()" onClick="logVariable('itemssql')" href="../../_variables/itemssql.html">$itemssql</a> = &quot;SELECT id
<a name="l787"><span class="linenum"> 787</span></a>                         FROM {grade_items}
<a name="l788"><span class="linenum"> 788</span></a>                        WHERE categoryid = :categoryid&quot;;
<a name="l789"><span class="linenum"> 789</span></a>  
<a name="l790"><span class="linenum"> 790</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;UPDATE {grade_grades}
<a name="l791"><span class="linenum"> 791</span></a>                     SET aggregationstatus = 'unknown',
<a name="l792"><span class="linenum"> 792</span></a>                         aggregationweight = 0
<a name="l793"><span class="linenum"> 793</span></a>                   WHERE userid = :userid
<a name="l794"><span class="linenum"> 794</span></a>                     AND itemid IN (<a class="var it33690" onMouseOver="hilite(33690)" onMouseOut="lolite()" onClick="logVariable('itemssql')" href="../../_variables/itemssql.html">$itemssql</a>)&quot;;
<a name="l795"><span class="linenum"> 795</span></a>  
<a name="l796"><span class="linenum"> 796</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l797"><span class="linenum"> 797</span></a>  
<a name="l798"><span class="linenum"> 798</span></a>  <span class="comment">        // Included with weights.</span>
<a name="l799"><span class="linenum"> 799</span></a>          if (!empty(<a class="var it26718" onMouseOver="hilite(26718)" onMouseOut="lolite()" onClick="logVariable('usedweights')" href="../../_variables/usedweights.html">$usedweights</a>)) {
<a name="l800"><span class="linenum"> 800</span></a>  <span class="comment">            // The usedweights items are updated individually to record the weights.</span>
<a name="l801"><span class="linenum"> 801</span></a>              foreach (<a class="var it26718" onMouseOver="hilite(26718)" onMouseOut="lolite()" onClick="logVariable('usedweights')" href="../../_variables/usedweights.html">$usedweights</a> as <a class="var it5042" onMouseOver="hilite(5042)" onMouseOut="lolite()" onClick="logVariable('gradeitemid')" href="../../_variables/gradeitemid.html">$gradeitemid</a> =&gt; <a class="var it33691" onMouseOver="hilite(33691)" onMouseOut="lolite()" onClick="logVariable('contribution')" href="../../_variables/contribution.html">$contribution</a>) {
<a name="l802"><span class="linenum"> 802</span></a>                  <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;UPDATE {grade_grades}
<a name="l803"><span class="linenum"> 803</span></a>                             SET aggregationstatus = 'used',
<a name="l804"><span class="linenum"> 804</span></a>                                 aggregationweight = :contribution
<a name="l805"><span class="linenum"> 805</span></a>                           WHERE itemid = :itemid AND userid = :userid&quot;;
<a name="l806"><span class="linenum"> 806</span></a>  
<a name="l807"><span class="linenum"> 807</span></a>                  <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('contribution' =&gt; <a class="var it33691" onMouseOver="hilite(33691)" onMouseOut="lolite()" onClick="logVariable('contribution')" href="../../_variables/contribution.html">$contribution</a>, 'itemid' =&gt; <a class="var it5042" onMouseOver="hilite(5042)" onMouseOut="lolite()" onClick="logVariable('gradeitemid')" href="../../_variables/gradeitemid.html">$gradeitemid</a>, 'userid' =&gt; <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>);
<a name="l808"><span class="linenum"> 808</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l809"><span class="linenum"> 809</span></a>              }
<a name="l810"><span class="linenum"> 810</span></a>          }
<a name="l811"><span class="linenum"> 811</span></a>  
<a name="l812"><span class="linenum"> 812</span></a>  <span class="comment">        // No value.</span>
<a name="l813"><span class="linenum"> 813</span></a>          if (!empty(<a class="var it33679" onMouseOver="hilite(33679)" onMouseOut="lolite()" onClick="logVariable('novalue')" href="../../_variables/novalue.html">$novalue</a>)) {
<a name="l814"><span class="linenum"> 814</span></a>              <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it33692" onMouseOver="hilite(33692)" onMouseOut="lolite()" onClick="logVariable('itemsql')" href="../../_variables/itemsql.html">$itemsql</a>, <a class="var it23897" onMouseOver="hilite(23897)" onMouseOut="lolite()" onClick="logVariable('itemlist')" href="../../_variables/itemlist.html">$itemlist</a>) = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it33679" onMouseOver="hilite(33679)" onMouseOut="lolite()" onClick="logVariable('novalue')" href="../../_variables/novalue.html">$novalue</a>), <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'g');
<a name="l815"><span class="linenum"> 815</span></a>  
<a name="l816"><span class="linenum"> 816</span></a>              <a class="var it23897" onMouseOver="hilite(23897)" onMouseOut="lolite()" onClick="logVariable('itemlist')" href="../../_variables/itemlist.html">$itemlist</a>['userid'] = <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>;
<a name="l817"><span class="linenum"> 817</span></a>  
<a name="l818"><span class="linenum"> 818</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field_select')" href="../../_functions/set_field_select.html" onMouseOver="funcPopup(event,'set_field_select')">set_field_select</a>('grade_grades',
<a name="l819"><span class="linenum"> 819</span></a>                                    'aggregationstatus',
<a name="l820"><span class="linenum"> 820</span></a>                                    'novalue',
<a name="l821"><span class="linenum"> 821</span></a>                                    &quot;itemid <a class="var it33692" onMouseOver="hilite(33692)" onMouseOut="lolite()" onClick="logVariable('itemsql')" href="../../_variables/itemsql.html">$itemsql</a> AND userid = :userid&quot;,
<a name="l822"><span class="linenum"> 822</span></a>                                    <a class="var it23897" onMouseOver="hilite(23897)" onMouseOut="lolite()" onClick="logVariable('itemlist')" href="../../_variables/itemlist.html">$itemlist</a>);
<a name="l823"><span class="linenum"> 823</span></a>          }
<a name="l824"><span class="linenum"> 824</span></a>  
<a name="l825"><span class="linenum"> 825</span></a>  <span class="comment">        // Dropped.</span>
<a name="l826"><span class="linenum"> 826</span></a>          if (!empty(<a class="var it33680" onMouseOver="hilite(33680)" onMouseOut="lolite()" onClick="logVariable('dropped')" href="../../_variables/dropped.html">$dropped</a>)) {
<a name="l827"><span class="linenum"> 827</span></a>              <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it33692" onMouseOver="hilite(33692)" onMouseOut="lolite()" onClick="logVariable('itemsql')" href="../../_variables/itemsql.html">$itemsql</a>, <a class="var it23897" onMouseOver="hilite(23897)" onMouseOut="lolite()" onClick="logVariable('itemlist')" href="../../_variables/itemlist.html">$itemlist</a>) = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it33680" onMouseOver="hilite(33680)" onMouseOut="lolite()" onClick="logVariable('dropped')" href="../../_variables/dropped.html">$dropped</a>), <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'g');
<a name="l828"><span class="linenum"> 828</span></a>  
<a name="l829"><span class="linenum"> 829</span></a>              <a class="var it23897" onMouseOver="hilite(23897)" onMouseOut="lolite()" onClick="logVariable('itemlist')" href="../../_variables/itemlist.html">$itemlist</a>['userid'] = <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>;
<a name="l830"><span class="linenum"> 830</span></a>  
<a name="l831"><span class="linenum"> 831</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field_select')" href="../../_functions/set_field_select.html" onMouseOver="funcPopup(event,'set_field_select')">set_field_select</a>('grade_grades',
<a name="l832"><span class="linenum"> 832</span></a>                                    'aggregationstatus',
<a name="l833"><span class="linenum"> 833</span></a>                                    'dropped',
<a name="l834"><span class="linenum"> 834</span></a>                                    &quot;itemid <a class="var it33692" onMouseOver="hilite(33692)" onMouseOut="lolite()" onClick="logVariable('itemsql')" href="../../_variables/itemsql.html">$itemsql</a> AND userid = :userid&quot;,
<a name="l835"><span class="linenum"> 835</span></a>                                    <a class="var it23897" onMouseOver="hilite(23897)" onMouseOut="lolite()" onClick="logVariable('itemlist')" href="../../_variables/itemlist.html">$itemlist</a>);
<a name="l836"><span class="linenum"> 836</span></a>          }
<a name="l837"><span class="linenum"> 837</span></a>  
<a name="l838"><span class="linenum"> 838</span></a>  <span class="comment">        // Extra credit.</span>
<a name="l839"><span class="linenum"> 839</span></a>          if (!empty(<a class="var it33681" onMouseOver="hilite(33681)" onMouseOut="lolite()" onClick="logVariable('extracredit')" href="../../_variables/extracredit.html">$extracredit</a>)) {
<a name="l840"><span class="linenum"> 840</span></a>              <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it33692" onMouseOver="hilite(33692)" onMouseOut="lolite()" onClick="logVariable('itemsql')" href="../../_variables/itemsql.html">$itemsql</a>, <a class="var it23897" onMouseOver="hilite(23897)" onMouseOut="lolite()" onClick="logVariable('itemlist')" href="../../_variables/itemlist.html">$itemlist</a>) = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it33681" onMouseOver="hilite(33681)" onMouseOut="lolite()" onClick="logVariable('extracredit')" href="../../_variables/extracredit.html">$extracredit</a>), <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'g');
<a name="l841"><span class="linenum"> 841</span></a>  
<a name="l842"><span class="linenum"> 842</span></a>              <a class="var it23897" onMouseOver="hilite(23897)" onMouseOut="lolite()" onClick="logVariable('itemlist')" href="../../_variables/itemlist.html">$itemlist</a>['userid'] = <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>;
<a name="l843"><span class="linenum"> 843</span></a>  
<a name="l844"><span class="linenum"> 844</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field_select')" href="../../_functions/set_field_select.html" onMouseOver="funcPopup(event,'set_field_select')">set_field_select</a>('grade_grades',
<a name="l845"><span class="linenum"> 845</span></a>                                    'aggregationstatus',
<a name="l846"><span class="linenum"> 846</span></a>                                    'extra',
<a name="l847"><span class="linenum"> 847</span></a>                                    &quot;itemid <a class="var it33692" onMouseOver="hilite(33692)" onMouseOut="lolite()" onClick="logVariable('itemsql')" href="../../_variables/itemsql.html">$itemsql</a> AND userid = :userid&quot;,
<a name="l848"><span class="linenum"> 848</span></a>                                    <a class="var it23897" onMouseOver="hilite(23897)" onMouseOut="lolite()" onClick="logVariable('itemlist')" href="../../_variables/itemlist.html">$itemlist</a>);
<a name="l849"><span class="linenum"> 849</span></a>          }
<a name="l850"><span class="linenum"> 850</span></a>      }
<a name="l851"><span class="linenum"> 851</span></a>  
<a name="l852"><span class="linenum"> 852</span></a>      <span class="comment">/**</span>
<a name="l853"><span class="linenum"> 853</span></a>  <span class="comment">     * Internal function that calculates the aggregated grade and new min/max for this grade category</span>
<a name="l854"><span class="linenum"> 854</span></a>  <span class="comment">     *</span>
<a name="l855"><span class="linenum"> 855</span></a>  <span class="comment">     * Must be public as it is used by grade_grade::get_hiding_affected()</span>
<a name="l856"><span class="linenum"> 856</span></a>  <span class="comment">     *</span>
<a name="l857"><span class="linenum"> 857</span></a>  <span class="comment">     * @param array $grade_values An array of values to be aggregated</span>
<a name="l858"><span class="linenum"> 858</span></a>  <span class="comment">     * @param array $items The array of grade_items</span>
<a name="l859"><span class="linenum"> 859</span></a>  <span class="comment">     * @since Moodle 2.6.5, 2.7.2</span>
<a name="l860"><span class="linenum"> 860</span></a>  <span class="comment">     * @param array &amp; $weights If provided, will be filled with the normalized weights</span>
<a name="l861"><span class="linenum"> 861</span></a>  <span class="comment">     *                         for each grade_item as used in the aggregation.</span>
<a name="l862"><span class="linenum"> 862</span></a>  <span class="comment">     *                         Some rules for the weights are:</span>
<a name="l863"><span class="linenum"> 863</span></a>  <span class="comment">     *                         1. The weights must add up to 1 (unless there are extra credit)</span>
<a name="l864"><span class="linenum"> 864</span></a>  <span class="comment">     *                         2. The contributed points column must add up to the course</span>
<a name="l865"><span class="linenum"> 865</span></a>  <span class="comment">     *                         final grade and this column is calculated from these weights.</span>
<a name="l866"><span class="linenum"> 866</span></a>  <span class="comment">     * @param array  $grademinoverrides User specific grademin values if different to the grade_item grademin (key is itemid)</span>
<a name="l867"><span class="linenum"> 867</span></a>  <span class="comment">     * @param array  $grademaxoverrides User specific grademax values if different to the grade_item grademax (key is itemid)</span>
<a name="l868"><span class="linenum"> 868</span></a>  <span class="comment">     * @return array containing values for:</span>
<a name="l869"><span class="linenum"> 869</span></a>  <span class="comment">     *                'grade' =&gt; the new calculated grade</span>
<a name="l870"><span class="linenum"> 870</span></a>  <span class="comment">     *                'grademin' =&gt; the new calculated min grade for the category</span>
<a name="l871"><span class="linenum"> 871</span></a>  <span class="comment">     *                'grademax' =&gt; the new calculated max grade for the category</span>
<a name="l872"><span class="linenum"> 872</span></a>  <span class="comment">     */</span>
<a name="l873"><span class="linenum"> 873</span></a>      public function <a class="function" onClick="logFunction('aggregate_values_and_adjust_bounds')" href="../../_functions/aggregate_values_and_adjust_bounds.html" onMouseOver="funcPopup(event,'aggregate_values_and_adjust_bounds')">aggregate_values_and_adjust_bounds</a>(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>,
<a name="l874"><span class="linenum"> 874</span></a>                                                         <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>,
<a name="l875"><span class="linenum"> 875</span></a>                                                         &amp; <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a> = null,
<a name="l876"><span class="linenum"> 876</span></a>                                                         <a class="var it33678" onMouseOver="hilite(33678)" onMouseOut="lolite()" onClick="logVariable('grademinoverrides')" href="../../_variables/grademinoverrides.html">$grademinoverrides</a> = array(),
<a name="l877"><span class="linenum"> 877</span></a>                                                         <a class="var it33677" onMouseOver="hilite(33677)" onMouseOut="lolite()" onClick="logVariable('grademaxoverrides')" href="../../_variables/grademaxoverrides.html">$grademaxoverrides</a> = array()) {
<a name="l878"><span class="linenum"> 878</span></a>          <a class="var it30134" onMouseOver="hilite(30134)" onMouseOut="lolite()" onClick="logVariable('category_item')" href="../../_variables/category_item.html">$category_item</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_grade_item')" href="../../_functions/get_grade_item.html" onMouseOver="funcPopup(event,'get_grade_item')">get_grade_item</a>();
<a name="l879"><span class="linenum"> 879</span></a>          <a class="var it5024" onMouseOver="hilite(5024)" onMouseOut="lolite()" onClick="logVariable('grademin')" href="../../_variables/grademin.html">$grademin</a> = <a class="var it30134" onMouseOver="hilite(30134)" onMouseOut="lolite()" onClick="logVariable('category_item')" href="../../_variables/category_item.html">$category_item</a>-&gt;<a onClick="logVariable('grademin')" class="var it40065" onMouseOver="hilite(40065)" onMouseOut="lolite()" href="../../_variables/grademin.html">grademin</a>;
<a name="l880"><span class="linenum"> 880</span></a>          <a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a> = <a class="var it30134" onMouseOver="hilite(30134)" onMouseOut="lolite()" onClick="logVariable('category_item')" href="../../_variables/category_item.html">$category_item</a>-&gt;<a onClick="logVariable('grademax')" class="var it40065" onMouseOver="hilite(40065)" onMouseOut="lolite()" href="../../_variables/grademax.html">grademax</a>;
<a name="l881"><span class="linenum"> 881</span></a>  
<a name="l882"><span class="linenum"> 882</span></a>          switch (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregation')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregation.html">aggregation</a>) {
<a name="l883"><span class="linenum"> 883</span></a>  
<a name="l884"><span class="linenum"> 884</span></a>              case <a class="constant" onClick="logConstant('GRADE_AGGREGATE_MEDIAN')" href="../../_constants/GRADE_AGGREGATE_MEDIAN.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_MEDIAN')">GRADE_AGGREGATE_MEDIAN</a>: // Middle point value in the set: ignores frequencies
<a name="l885"><span class="linenum"> 885</span></a>                  <a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a> = <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>);
<a name="l886"><span class="linenum"> 886</span></a>                  <a class="var it663" onMouseOver="hilite(663)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a> = <a class="phpfunction" onClick="logFunction('array_values')" href="../../_functions/array_values.html" onMouseOver="phpfuncPopup(event,'array_values')">array_values</a>(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>);
<a name="l887"><span class="linenum"> 887</span></a>  
<a name="l888"><span class="linenum"> 888</span></a>  <span class="comment">                // The median gets 100% - others get 0.</span>
<a name="l889"><span class="linenum"> 889</span></a>                  if (<a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a> !== null &amp;&amp; <a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a> &gt; 0) {
<a name="l890"><span class="linenum"> 890</span></a>                      <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a> = 0;
<a name="l891"><span class="linenum"> 891</span></a>                      foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>=&gt;<a class="var it33358" onMouseOver="hilite(33358)" onMouseOut="lolite()" onClick="logVariable('grade_value')" href="../../_variables/grade_value.html">$grade_value</a>) {
<a name="l892"><span class="linenum"> 892</span></a>                          if ((<a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a> % 2 == 0) &amp;&amp; (<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a> == <a class="phpfunction" onClick="logFunction('intval')" href="../../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>(<a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a>/2)-1 || <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a> == <a class="phpfunction" onClick="logFunction('intval')" href="../../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>(<a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a>/2))) {
<a name="l893"><span class="linenum"> 893</span></a>                              <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 0.5;
<a name="l894"><span class="linenum"> 894</span></a>                          } else if ((<a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a> % 2 != 0) &amp;&amp; (<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a> == <a class="phpfunction" onClick="logFunction('intval')" href="../../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>((<a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a>/2)-0.5))) {
<a name="l895"><span class="linenum"> 895</span></a>                              <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 1.0;
<a name="l896"><span class="linenum"> 896</span></a>                          } else {
<a name="l897"><span class="linenum"> 897</span></a>                              <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 0;
<a name="l898"><span class="linenum"> 898</span></a>                          }
<a name="l899"><span class="linenum"> 899</span></a>                          <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a>++;
<a name="l900"><span class="linenum"> 900</span></a>                      }
<a name="l901"><span class="linenum"> 901</span></a>                  }
<a name="l902"><span class="linenum"> 902</span></a>                  if (<a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a> % 2 == 0) {
<a name="l903"><span class="linenum"> 903</span></a>                      <a class="var it33687" onMouseOver="hilite(33687)" onMouseOut="lolite()" onClick="logVariable('agg_grade')" href="../../_variables/agg_grade.html">$agg_grade</a> = (<a class="var it663" onMouseOver="hilite(663)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>[<a class="phpfunction" onClick="logFunction('intval')" href="../../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>(<a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a>/2)-1] + <a class="var it663" onMouseOver="hilite(663)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>[<a class="phpfunction" onClick="logFunction('intval')" href="../../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>(<a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a>/2)]) / 2;
<a name="l904"><span class="linenum"> 904</span></a>                  } else {
<a name="l905"><span class="linenum"> 905</span></a>                      <a class="var it33687" onMouseOver="hilite(33687)" onMouseOut="lolite()" onClick="logVariable('agg_grade')" href="../../_variables/agg_grade.html">$agg_grade</a> = <a class="var it663" onMouseOver="hilite(663)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>[<a class="phpfunction" onClick="logFunction('intval')" href="../../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>((<a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a>/2)-0.5)];
<a name="l906"><span class="linenum"> 906</span></a>                  }
<a name="l907"><span class="linenum"> 907</span></a>  
<a name="l908"><span class="linenum"> 908</span></a>                  break;
<a name="l909"><span class="linenum"> 909</span></a>  
<a name="l910"><span class="linenum"> 910</span></a>              case <a class="constant" onClick="logConstant('GRADE_AGGREGATE_MIN')" href="../../_constants/GRADE_AGGREGATE_MIN.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_MIN')">GRADE_AGGREGATE_MIN</a>:
<a name="l911"><span class="linenum"> 911</span></a>                  <a class="var it33687" onMouseOver="hilite(33687)" onMouseOut="lolite()" onClick="logVariable('agg_grade')" href="../../_variables/agg_grade.html">$agg_grade</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>);
<a name="l912"><span class="linenum"> 912</span></a>  <span class="comment">                // Record the weights as used.</span>
<a name="l913"><span class="linenum"> 913</span></a>                  if (<a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a> !== null) {
<a name="l914"><span class="linenum"> 914</span></a>                      foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>=&gt;<a class="var it33358" onMouseOver="hilite(33358)" onMouseOut="lolite()" onClick="logVariable('grade_value')" href="../../_variables/grade_value.html">$grade_value</a>) {
<a name="l915"><span class="linenum"> 915</span></a>                          <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 0;
<a name="l916"><span class="linenum"> 916</span></a>                      }
<a name="l917"><span class="linenum"> 917</span></a>                  }
<a name="l918"><span class="linenum"> 918</span></a>  <span class="comment">                // Set the first item to 1.</span>
<a name="l919"><span class="linenum"> 919</span></a>                  <a class="var it15371" onMouseOver="hilite(15371)" onMouseOut="lolite()" onClick="logVariable('itemids')" href="../../_variables/itemids.html">$itemids</a> = <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>);
<a name="l920"><span class="linenum"> 920</span></a>                  <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="phpfunction" onClick="logFunction('reset')" href="../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it15371" onMouseOver="hilite(15371)" onMouseOut="lolite()" onClick="logVariable('itemids')" href="../../_variables/itemids.html">$itemids</a>)] = 1;
<a name="l921"><span class="linenum"> 921</span></a>                  break;
<a name="l922"><span class="linenum"> 922</span></a>  
<a name="l923"><span class="linenum"> 923</span></a>              case <a class="constant" onClick="logConstant('GRADE_AGGREGATE_MAX')" href="../../_constants/GRADE_AGGREGATE_MAX.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_MAX')">GRADE_AGGREGATE_MAX</a>:
<a name="l924"><span class="linenum"> 924</span></a>  <span class="comment">                // Record the weights as used.</span>
<a name="l925"><span class="linenum"> 925</span></a>                  if (<a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a> !== null) {
<a name="l926"><span class="linenum"> 926</span></a>                      foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>=&gt;<a class="var it33358" onMouseOver="hilite(33358)" onMouseOut="lolite()" onClick="logVariable('grade_value')" href="../../_variables/grade_value.html">$grade_value</a>) {
<a name="l927"><span class="linenum"> 927</span></a>                          <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 0;
<a name="l928"><span class="linenum"> 928</span></a>                      }
<a name="l929"><span class="linenum"> 929</span></a>                  }
<a name="l930"><span class="linenum"> 930</span></a>  <span class="comment">                // Set the last item to 1.</span>
<a name="l931"><span class="linenum"> 931</span></a>                  <a class="var it15371" onMouseOver="hilite(15371)" onMouseOut="lolite()" onClick="logVariable('itemids')" href="../../_variables/itemids.html">$itemids</a> = <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>);
<a name="l932"><span class="linenum"> 932</span></a>                  <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="phpfunction" onClick="logFunction('end')" href="../../_functions/end.html" onMouseOver="phpfuncPopup(event,'end')">end</a>(<a class="var it15371" onMouseOver="hilite(15371)" onMouseOut="lolite()" onClick="logVariable('itemids')" href="../../_variables/itemids.html">$itemids</a>)] = 1;
<a name="l933"><span class="linenum"> 933</span></a>                  <a class="var it33687" onMouseOver="hilite(33687)" onMouseOut="lolite()" onClick="logVariable('agg_grade')" href="../../_variables/agg_grade.html">$agg_grade</a> = <a class="phpfunction" onClick="logFunction('end')" href="../../_functions/end.html" onMouseOver="phpfuncPopup(event,'end')">end</a>(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>);
<a name="l934"><span class="linenum"> 934</span></a>                  break;
<a name="l935"><span class="linenum"> 935</span></a>  
<a name="l936"><span class="linenum"> 936</span></a>              case <a class="constant" onClick="logConstant('GRADE_AGGREGATE_MODE')" href="../../_constants/GRADE_AGGREGATE_MODE.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_MODE')">GRADE_AGGREGATE_MODE</a>:       // the most common value
<a name="l937"><span class="linenum"> 937</span></a>  <span class="comment">                // array_count_values only counts INT and STRING, so if grades are floats we must convert them to string</span>
<a name="l938"><span class="linenum"> 938</span></a>                  <a class="var it33693" onMouseOver="hilite(33693)" onMouseOut="lolite()" onClick="logVariable('converted_grade_values')" href="../../_variables/converted_grade_values.html">$converted_grade_values</a> = array();
<a name="l939"><span class="linenum"> 939</span></a>  
<a name="l940"><span class="linenum"> 940</span></a>                  foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it50" onMouseOver="hilite(50)" onMouseOut="lolite()" onClick="logVariable('k')" href="../../_variables/k.html">$k</a> =&gt; <a class="var it33694" onMouseOver="hilite(33694)" onMouseOut="lolite()" onClick="logVariable('gv')" href="../../_variables/gv.html">$gv</a>) {
<a name="l941"><span class="linenum"> 941</span></a>  
<a name="l942"><span class="linenum"> 942</span></a>                      if (!is_int(<a class="var it33694" onMouseOver="hilite(33694)" onMouseOut="lolite()" onClick="logVariable('gv')" href="../../_variables/gv.html">$gv</a>) &amp;&amp; !<a class="phpfunction" onClick="logFunction('is_string')" href="../../_functions/is_string.html" onMouseOver="phpfuncPopup(event,'is_string')">is_string</a>(<a class="var it33694" onMouseOver="hilite(33694)" onMouseOut="lolite()" onClick="logVariable('gv')" href="../../_variables/gv.html">$gv</a>)) {
<a name="l943"><span class="linenum"> 943</span></a>                          <a class="var it33693" onMouseOver="hilite(33693)" onMouseOut="lolite()" onClick="logVariable('converted_grade_values')" href="../../_variables/converted_grade_values.html">$converted_grade_values</a>[<a class="var it50" onMouseOver="hilite(50)" onMouseOut="lolite()" onClick="logVariable('k')" href="../../_variables/k.html">$k</a>] = (string) <a class="var it33694" onMouseOver="hilite(33694)" onMouseOut="lolite()" onClick="logVariable('gv')" href="../../_variables/gv.html">$gv</a>;
<a name="l944"><span class="linenum"> 944</span></a>  
<a name="l945"><span class="linenum"> 945</span></a>                      } else {
<a name="l946"><span class="linenum"> 946</span></a>                          <a class="var it33693" onMouseOver="hilite(33693)" onMouseOut="lolite()" onClick="logVariable('converted_grade_values')" href="../../_variables/converted_grade_values.html">$converted_grade_values</a>[<a class="var it50" onMouseOver="hilite(50)" onMouseOut="lolite()" onClick="logVariable('k')" href="../../_variables/k.html">$k</a>] = <a class="var it33694" onMouseOver="hilite(33694)" onMouseOut="lolite()" onClick="logVariable('gv')" href="../../_variables/gv.html">$gv</a>;
<a name="l947"><span class="linenum"> 947</span></a>                      }
<a name="l948"><span class="linenum"> 948</span></a>                      if (<a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a> !== null) {
<a name="l949"><span class="linenum"> 949</span></a>                          <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it50" onMouseOver="hilite(50)" onMouseOut="lolite()" onClick="logVariable('k')" href="../../_variables/k.html">$k</a>] = 0;
<a name="l950"><span class="linenum"> 950</span></a>                      }
<a name="l951"><span class="linenum"> 951</span></a>                  }
<a name="l952"><span class="linenum"> 952</span></a>  
<a name="l953"><span class="linenum"> 953</span></a>                  <a class="var it13400" onMouseOver="hilite(13400)" onMouseOut="lolite()" onClick="logVariable('freq')" href="../../_variables/freq.html">$freq</a> = <a class="phpfunction" onClick="logFunction('array_count_values')" href="../../_functions/array_count_values.html" onMouseOver="phpfuncPopup(event,'array_count_values')">array_count_values</a>(<a class="var it33693" onMouseOver="hilite(33693)" onMouseOut="lolite()" onClick="logVariable('converted_grade_values')" href="../../_variables/converted_grade_values.html">$converted_grade_values</a>);
<a name="l954"><span class="linenum"> 954</span></a>                  <a class="phpfunction" onClick="logFunction('arsort')" href="../../_functions/arsort.html" onMouseOver="phpfuncPopup(event,'arsort')">arsort</a>(<a class="var it13400" onMouseOver="hilite(13400)" onMouseOut="lolite()" onClick="logVariable('freq')" href="../../_variables/freq.html">$freq</a>);                      <span class="comment">// sort by frequency keeping keys</span>
<a name="l955"><span class="linenum"> 955</span></a>                  <a class="var it11686" onMouseOver="hilite(11686)" onMouseOut="lolite()" onClick="logVariable('top')" href="../../_variables/top.html">$top</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it13400" onMouseOver="hilite(13400)" onMouseOut="lolite()" onClick="logVariable('freq')" href="../../_variables/freq.html">$freq</a>);               <span class="comment">// highest frequency count</span>
<a name="l956"><span class="linenum"> 956</span></a>                  <a class="var it5934" onMouseOver="hilite(5934)" onMouseOut="lolite()" onClick="logVariable('modes')" href="../../_variables/modes.html">$modes</a> = <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it13400" onMouseOver="hilite(13400)" onMouseOut="lolite()" onClick="logVariable('freq')" href="../../_variables/freq.html">$freq</a>, <a class="var it11686" onMouseOver="hilite(11686)" onMouseOut="lolite()" onClick="logVariable('top')" href="../../_variables/top.html">$top</a>);  <span class="comment">// search for all modes (have the same highest count)</span>
<a name="l957"><span class="linenum"> 957</span></a>                  <a class="phpfunction" onClick="logFunction('rsort')" href="../../_functions/rsort.html" onMouseOver="phpfuncPopup(event,'rsort')">rsort</a>(<a class="var it5934" onMouseOver="hilite(5934)" onMouseOut="lolite()" onClick="logVariable('modes')" href="../../_variables/modes.html">$modes</a>, SORT_NUMERIC);       <span class="comment">// get highest mode</span>
<a name="l958"><span class="linenum"> 958</span></a>                  <a class="var it33687" onMouseOver="hilite(33687)" onMouseOut="lolite()" onClick="logVariable('agg_grade')" href="../../_variables/agg_grade.html">$agg_grade</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it5934" onMouseOver="hilite(5934)" onMouseOut="lolite()" onClick="logVariable('modes')" href="../../_variables/modes.html">$modes</a>);
<a name="l959"><span class="linenum"> 959</span></a>  <span class="comment">                // Record the weights as used.</span>
<a name="l960"><span class="linenum"> 960</span></a>                  if (<a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a> !== null &amp;&amp; <a class="var it11686" onMouseOver="hilite(11686)" onMouseOut="lolite()" onClick="logVariable('top')" href="../../_variables/top.html">$top</a> &gt; 0) {
<a name="l961"><span class="linenum"> 961</span></a>                      foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it50" onMouseOver="hilite(50)" onMouseOut="lolite()" onClick="logVariable('k')" href="../../_variables/k.html">$k</a> =&gt; <a class="var it33694" onMouseOver="hilite(33694)" onMouseOut="lolite()" onClick="logVariable('gv')" href="../../_variables/gv.html">$gv</a>) {
<a name="l962"><span class="linenum"> 962</span></a>                          if (<a class="var it33694" onMouseOver="hilite(33694)" onMouseOut="lolite()" onClick="logVariable('gv')" href="../../_variables/gv.html">$gv</a> == <a class="var it33687" onMouseOver="hilite(33687)" onMouseOut="lolite()" onClick="logVariable('agg_grade')" href="../../_variables/agg_grade.html">$agg_grade</a>) {
<a name="l963"><span class="linenum"> 963</span></a>                              <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it50" onMouseOver="hilite(50)" onMouseOut="lolite()" onClick="logVariable('k')" href="../../_variables/k.html">$k</a>] = 1.0 / <a class="var it11686" onMouseOver="hilite(11686)" onMouseOut="lolite()" onClick="logVariable('top')" href="../../_variables/top.html">$top</a>;
<a name="l964"><span class="linenum"> 964</span></a>                          }
<a name="l965"><span class="linenum"> 965</span></a>                      }
<a name="l966"><span class="linenum"> 966</span></a>                  }
<a name="l967"><span class="linenum"> 967</span></a>                  break;
<a name="l968"><span class="linenum"> 968</span></a>  
<a name="l969"><span class="linenum"> 969</span></a>              case <a class="constant" onClick="logConstant('GRADE_AGGREGATE_WEIGHTED_MEAN')" href="../../_constants/GRADE_AGGREGATE_WEIGHTED_MEAN.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_WEIGHTED_MEAN')">GRADE_AGGREGATE_WEIGHTED_MEAN</a>: // Weighted average of all existing final grades, weight specified in coef
<a name="l970"><span class="linenum"> 970</span></a>                  <a class="var it33695" onMouseOver="hilite(33695)" onMouseOut="lolite()" onClick="logVariable('weightsum')" href="../../_variables/weightsum.html">$weightsum</a> = 0;
<a name="l971"><span class="linenum"> 971</span></a>                  <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a>       = 0;
<a name="l972"><span class="linenum"> 972</span></a>  
<a name="l973"><span class="linenum"> 973</span></a>                  foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>=&gt;<a class="var it33358" onMouseOver="hilite(33358)" onMouseOut="lolite()" onClick="logVariable('grade_value')" href="../../_variables/grade_value.html">$grade_value</a>) {
<a name="l974"><span class="linenum"> 974</span></a>                      if (<a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a> !== null) {
<a name="l975"><span class="linenum"> 975</span></a>                          <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;aggregationcoef;
<a name="l976"><span class="linenum"> 976</span></a>                      }
<a name="l977"><span class="linenum"> 977</span></a>                      if (<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;aggregationcoef &lt;= 0) {
<a name="l978"><span class="linenum"> 978</span></a>                          continue;
<a name="l979"><span class="linenum"> 979</span></a>                      }
<a name="l980"><span class="linenum"> 980</span></a>                      <a class="var it33695" onMouseOver="hilite(33695)" onMouseOut="lolite()" onClick="logVariable('weightsum')" href="../../_variables/weightsum.html">$weightsum</a> += <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;aggregationcoef;
<a name="l981"><span class="linenum"> 981</span></a>                      <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a>       += <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;aggregationcoef * <a class="var it33358" onMouseOver="hilite(33358)" onMouseOut="lolite()" onClick="logVariable('grade_value')" href="../../_variables/grade_value.html">$grade_value</a>;
<a name="l982"><span class="linenum"> 982</span></a>                  }
<a name="l983"><span class="linenum"> 983</span></a>                  if (<a class="var it33695" onMouseOver="hilite(33695)" onMouseOut="lolite()" onClick="logVariable('weightsum')" href="../../_variables/weightsum.html">$weightsum</a> == 0) {
<a name="l984"><span class="linenum"> 984</span></a>                      <a class="var it33687" onMouseOver="hilite(33687)" onMouseOut="lolite()" onClick="logVariable('agg_grade')" href="../../_variables/agg_grade.html">$agg_grade</a> = null;
<a name="l985"><span class="linenum"> 985</span></a>  
<a name="l986"><span class="linenum"> 986</span></a>                  } else {
<a name="l987"><span class="linenum"> 987</span></a>                      <a class="var it33687" onMouseOver="hilite(33687)" onMouseOut="lolite()" onClick="logVariable('agg_grade')" href="../../_variables/agg_grade.html">$agg_grade</a> = <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a> / <a class="var it33695" onMouseOver="hilite(33695)" onMouseOut="lolite()" onClick="logVariable('weightsum')" href="../../_variables/weightsum.html">$weightsum</a>;
<a name="l988"><span class="linenum"> 988</span></a>                      if (<a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a> !== null) {
<a name="l989"><span class="linenum"> 989</span></a>  <span class="comment">                        // Normalise the weights.</span>
<a name="l990"><span class="linenum"> 990</span></a>                          foreach (<a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a> =&gt; <a class="var it5702" onMouseOver="hilite(5702)" onMouseOut="lolite()" onClick="logVariable('weight')" href="../../_variables/weight.html">$weight</a>) {
<a name="l991"><span class="linenum"> 991</span></a>                              <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = <a class="var it5702" onMouseOver="hilite(5702)" onMouseOut="lolite()" onClick="logVariable('weight')" href="../../_variables/weight.html">$weight</a> / <a class="var it33695" onMouseOver="hilite(33695)" onMouseOut="lolite()" onClick="logVariable('weightsum')" href="../../_variables/weightsum.html">$weightsum</a>;
<a name="l992"><span class="linenum"> 992</span></a>                          }
<a name="l993"><span class="linenum"> 993</span></a>                      }
<a name="l994"><span class="linenum"> 994</span></a>  
<a name="l995"><span class="linenum"> 995</span></a>                  }
<a name="l996"><span class="linenum"> 996</span></a>                  break;
<a name="l997"><span class="linenum"> 997</span></a>  
<a name="l998"><span class="linenum"> 998</span></a>              case <a class="constant" onClick="logConstant('GRADE_AGGREGATE_WEIGHTED_MEAN2')" href="../../_constants/GRADE_AGGREGATE_WEIGHTED_MEAN2.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_WEIGHTED_MEAN2')">GRADE_AGGREGATE_WEIGHTED_MEAN2</a>:
<a name="l999"><span class="linenum"> 999</span></a>  <span class="comment">                // Weighted average of all existing final grades with optional extra credit flag,</span>
<a name="l1000"><span class="linenum">1000</span></a>  <span class="comment">                // weight is the range of grade (usually grademax)</span>
<a name="l1001"><span class="linenum">1001</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l1002"><span class="linenum">1002</span></a>                  <a class="var it33695" onMouseOver="hilite(33695)" onMouseOut="lolite()" onClick="logVariable('weightsum')" href="../../_variables/weightsum.html">$weightsum</a> = 0;
<a name="l1003"><span class="linenum">1003</span></a>                  <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a>       = null;
<a name="l1004"><span class="linenum">1004</span></a>  
<a name="l1005"><span class="linenum">1005</span></a>                  foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>=&gt;<a class="var it33358" onMouseOver="hilite(33358)" onMouseOut="lolite()" onClick="logVariable('grade_value')" href="../../_variables/grade_value.html">$grade_value</a>) {
<a name="l1006"><span class="linenum">1006</span></a>                      if (<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;aggregationcoef &gt; 0) {
<a name="l1007"><span class="linenum">1007</span></a>                          continue;
<a name="l1008"><span class="linenum">1008</span></a>                      }
<a name="l1009"><span class="linenum">1009</span></a>  
<a name="l1010"><span class="linenum">1010</span></a>                      <a class="var it5702" onMouseOver="hilite(5702)" onMouseOut="lolite()" onClick="logVariable('weight')" href="../../_variables/weight.html">$weight</a> = <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;grademax - <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;grademin;
<a name="l1011"><span class="linenum">1011</span></a>                      if (<a class="var it5702" onMouseOver="hilite(5702)" onMouseOut="lolite()" onClick="logVariable('weight')" href="../../_variables/weight.html">$weight</a> &lt;= 0) {
<a name="l1012"><span class="linenum">1012</span></a>                          continue;
<a name="l1013"><span class="linenum">1013</span></a>                      }
<a name="l1014"><span class="linenum">1014</span></a>  
<a name="l1015"><span class="linenum">1015</span></a>                      <a class="var it33695" onMouseOver="hilite(33695)" onMouseOut="lolite()" onClick="logVariable('weightsum')" href="../../_variables/weightsum.html">$weightsum</a> += <a class="var it5702" onMouseOver="hilite(5702)" onMouseOut="lolite()" onClick="logVariable('weight')" href="../../_variables/weight.html">$weight</a>;
<a name="l1016"><span class="linenum">1016</span></a>                      <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a> += <a class="var it5702" onMouseOver="hilite(5702)" onMouseOut="lolite()" onClick="logVariable('weight')" href="../../_variables/weight.html">$weight</a> * <a class="var it33358" onMouseOver="hilite(33358)" onMouseOut="lolite()" onClick="logVariable('grade_value')" href="../../_variables/grade_value.html">$grade_value</a>;
<a name="l1017"><span class="linenum">1017</span></a>                  }
<a name="l1018"><span class="linenum">1018</span></a>  
<a name="l1019"><span class="linenum">1019</span></a>  <span class="comment">                // Handle the extra credit items separately to calculate their weight accurately.</span>
<a name="l1020"><span class="linenum">1020</span></a>                  foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a> =&gt; <a class="var it33358" onMouseOver="hilite(33358)" onMouseOut="lolite()" onClick="logVariable('grade_value')" href="../../_variables/grade_value.html">$grade_value</a>) {
<a name="l1021"><span class="linenum">1021</span></a>                      if (<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;aggregationcoef &lt;= 0) {
<a name="l1022"><span class="linenum">1022</span></a>                          continue;
<a name="l1023"><span class="linenum">1023</span></a>                      }
<a name="l1024"><span class="linenum">1024</span></a>  
<a name="l1025"><span class="linenum">1025</span></a>                      <a class="var it5702" onMouseOver="hilite(5702)" onMouseOut="lolite()" onClick="logVariable('weight')" href="../../_variables/weight.html">$weight</a> = <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;grademax - <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;grademin;
<a name="l1026"><span class="linenum">1026</span></a>                      if (<a class="var it5702" onMouseOver="hilite(5702)" onMouseOut="lolite()" onClick="logVariable('weight')" href="../../_variables/weight.html">$weight</a> &lt;= 0) {
<a name="l1027"><span class="linenum">1027</span></a>                          <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 0;
<a name="l1028"><span class="linenum">1028</span></a>                          continue;
<a name="l1029"><span class="linenum">1029</span></a>                      }
<a name="l1030"><span class="linenum">1030</span></a>  
<a name="l1031"><span class="linenum">1031</span></a>                      <a class="var it33696" onMouseOver="hilite(33696)" onMouseOut="lolite()" onClick="logVariable('oldsum')" href="../../_variables/oldsum.html">$oldsum</a> = <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a>;
<a name="l1032"><span class="linenum">1032</span></a>                      <a class="var it33697" onMouseOver="hilite(33697)" onMouseOut="lolite()" onClick="logVariable('weightedgrade')" href="../../_variables/weightedgrade.html">$weightedgrade</a> = <a class="var it5702" onMouseOver="hilite(5702)" onMouseOut="lolite()" onClick="logVariable('weight')" href="../../_variables/weight.html">$weight</a> * <a class="var it33358" onMouseOver="hilite(33358)" onMouseOut="lolite()" onClick="logVariable('grade_value')" href="../../_variables/grade_value.html">$grade_value</a>;
<a name="l1033"><span class="linenum">1033</span></a>                      <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a> += <a class="var it33697" onMouseOver="hilite(33697)" onMouseOut="lolite()" onClick="logVariable('weightedgrade')" href="../../_variables/weightedgrade.html">$weightedgrade</a>;
<a name="l1034"><span class="linenum">1034</span></a>  
<a name="l1035"><span class="linenum">1035</span></a>                      if (<a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a> !== null) {
<a name="l1036"><span class="linenum">1036</span></a>                          if (<a class="var it33695" onMouseOver="hilite(33695)" onMouseOut="lolite()" onClick="logVariable('weightsum')" href="../../_variables/weightsum.html">$weightsum</a> &lt;= 0) {
<a name="l1037"><span class="linenum">1037</span></a>                              <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 0;
<a name="l1038"><span class="linenum">1038</span></a>                              continue;
<a name="l1039"><span class="linenum">1039</span></a>                          }
<a name="l1040"><span class="linenum">1040</span></a>  
<a name="l1041"><span class="linenum">1041</span></a>                          <a class="var it9477" onMouseOver="hilite(9477)" onMouseOut="lolite()" onClick="logVariable('oldgrade')" href="../../_variables/oldgrade.html">$oldgrade</a> = <a class="var it33696" onMouseOver="hilite(33696)" onMouseOut="lolite()" onClick="logVariable('oldsum')" href="../../_variables/oldsum.html">$oldsum</a> / <a class="var it33695" onMouseOver="hilite(33695)" onMouseOut="lolite()" onClick="logVariable('weightsum')" href="../../_variables/weightsum.html">$weightsum</a>;
<a name="l1042"><span class="linenum">1042</span></a>                          <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a> = <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a> / <a class="var it33695" onMouseOver="hilite(33695)" onMouseOut="lolite()" onClick="logVariable('weightsum')" href="../../_variables/weightsum.html">$weightsum</a>;
<a name="l1043"><span class="linenum">1043</span></a>                          <a class="var it33698" onMouseOver="hilite(33698)" onMouseOut="lolite()" onClick="logVariable('normoldgrade')" href="../../_variables/normoldgrade.html">$normoldgrade</a> = <a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>::<a class="function" onClick="logFunction('standardise_score')" href="../../_functions/standardise_score.html" onMouseOver="funcPopup(event,'standardise_score')">standardise_score</a>(<a class="var it9477" onMouseOver="hilite(9477)" onMouseOut="lolite()" onClick="logVariable('oldgrade')" href="../../_variables/oldgrade.html">$oldgrade</a>, 0, 1, <a class="var it5024" onMouseOver="hilite(5024)" onMouseOut="lolite()" onClick="logVariable('grademin')" href="../../_variables/grademin.html">$grademin</a>, <a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a>);
<a name="l1044"><span class="linenum">1044</span></a>                          <a class="var it33699" onMouseOver="hilite(33699)" onMouseOut="lolite()" onClick="logVariable('normgrade')" href="../../_variables/normgrade.html">$normgrade</a> = <a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>::<a class="function" onClick="logFunction('standardise_score')" href="../../_functions/standardise_score.html" onMouseOver="funcPopup(event,'standardise_score')">standardise_score</a>(<a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>, 0, 1, <a class="var it5024" onMouseOver="hilite(5024)" onMouseOut="lolite()" onClick="logVariable('grademin')" href="../../_variables/grademin.html">$grademin</a>, <a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a>);
<a name="l1045"><span class="linenum">1045</span></a>                          <a class="var it33700" onMouseOver="hilite(33700)" onMouseOut="lolite()" onClick="logVariable('boundedoldgrade')" href="../../_variables/boundedoldgrade.html">$boundedoldgrade</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('bounded_grade')" href="../../_functions/bounded_grade.html" onMouseOver="funcPopup(event,'bounded_grade')">bounded_grade</a>(<a class="var it33698" onMouseOver="hilite(33698)" onMouseOut="lolite()" onClick="logVariable('normoldgrade')" href="../../_variables/normoldgrade.html">$normoldgrade</a>);
<a name="l1046"><span class="linenum">1046</span></a>                          <a class="var it33701" onMouseOver="hilite(33701)" onMouseOut="lolite()" onClick="logVariable('boundedgrade')" href="../../_variables/boundedgrade.html">$boundedgrade</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('bounded_grade')" href="../../_functions/bounded_grade.html" onMouseOver="funcPopup(event,'bounded_grade')">bounded_grade</a>(<a class="var it33699" onMouseOver="hilite(33699)" onMouseOut="lolite()" onClick="logVariable('normgrade')" href="../../_variables/normgrade.html">$normgrade</a>);
<a name="l1047"><span class="linenum">1047</span></a>  
<a name="l1048"><span class="linenum">1048</span></a>                          if (<a class="var it33701" onMouseOver="hilite(33701)" onMouseOut="lolite()" onClick="logVariable('boundedgrade')" href="../../_variables/boundedgrade.html">$boundedgrade</a> - <a class="var it33700" onMouseOver="hilite(33700)" onMouseOut="lolite()" onClick="logVariable('boundedoldgrade')" href="../../_variables/boundedoldgrade.html">$boundedoldgrade</a> &lt;= 0) {
<a name="l1049"><span class="linenum">1049</span></a>  <span class="comment">                            // Nothing new was added to the grade.</span>
<a name="l1050"><span class="linenum">1050</span></a>                              <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 0;
<a name="l1051"><span class="linenum">1051</span></a>                          } else if (<a class="var it33701" onMouseOver="hilite(33701)" onMouseOut="lolite()" onClick="logVariable('boundedgrade')" href="../../_variables/boundedgrade.html">$boundedgrade</a> &lt; <a class="var it33699" onMouseOver="hilite(33699)" onMouseOut="lolite()" onClick="logVariable('normgrade')" href="../../_variables/normgrade.html">$normgrade</a>) {
<a name="l1052"><span class="linenum">1052</span></a>  <span class="comment">                            // The grade has been bounded, the extra credit item needs to have a different weight.</span>
<a name="l1053"><span class="linenum">1053</span></a>                              <a class="var it33702" onMouseOver="hilite(33702)" onMouseOut="lolite()" onClick="logVariable('gradediff')" href="../../_variables/gradediff.html">$gradediff</a> = <a class="var it33701" onMouseOver="hilite(33701)" onMouseOut="lolite()" onClick="logVariable('boundedgrade')" href="../../_variables/boundedgrade.html">$boundedgrade</a> - <a class="var it33698" onMouseOver="hilite(33698)" onMouseOut="lolite()" onClick="logVariable('normoldgrade')" href="../../_variables/normoldgrade.html">$normoldgrade</a>;
<a name="l1054"><span class="linenum">1054</span></a>                              <a class="var it33703" onMouseOver="hilite(33703)" onMouseOut="lolite()" onClick="logVariable('gradediffnorm')" href="../../_variables/gradediffnorm.html">$gradediffnorm</a> = <a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>::<a class="function" onClick="logFunction('standardise_score')" href="../../_functions/standardise_score.html" onMouseOver="funcPopup(event,'standardise_score')">standardise_score</a>(<a class="var it33702" onMouseOver="hilite(33702)" onMouseOut="lolite()" onClick="logVariable('gradediff')" href="../../_variables/gradediff.html">$gradediff</a>, <a class="var it5024" onMouseOver="hilite(5024)" onMouseOut="lolite()" onClick="logVariable('grademin')" href="../../_variables/grademin.html">$grademin</a>, <a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a>, 0, 1);
<a name="l1055"><span class="linenum">1055</span></a>                              <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = <a class="var it33703" onMouseOver="hilite(33703)" onMouseOut="lolite()" onClick="logVariable('gradediffnorm')" href="../../_variables/gradediffnorm.html">$gradediffnorm</a> / <a class="var it33358" onMouseOver="hilite(33358)" onMouseOut="lolite()" onClick="logVariable('grade_value')" href="../../_variables/grade_value.html">$grade_value</a>;
<a name="l1056"><span class="linenum">1056</span></a>                          } else {
<a name="l1057"><span class="linenum">1057</span></a>  <span class="comment">                            // Default weighting.</span>
<a name="l1058"><span class="linenum">1058</span></a>                              <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = <a class="var it5702" onMouseOver="hilite(5702)" onMouseOut="lolite()" onClick="logVariable('weight')" href="../../_variables/weight.html">$weight</a> / <a class="var it33695" onMouseOver="hilite(33695)" onMouseOut="lolite()" onClick="logVariable('weightsum')" href="../../_variables/weightsum.html">$weightsum</a>;
<a name="l1059"><span class="linenum">1059</span></a>                          }
<a name="l1060"><span class="linenum">1060</span></a>                      }
<a name="l1061"><span class="linenum">1061</span></a>                  }
<a name="l1062"><span class="linenum">1062</span></a>  
<a name="l1063"><span class="linenum">1063</span></a>                  if (<a class="var it33695" onMouseOver="hilite(33695)" onMouseOut="lolite()" onClick="logVariable('weightsum')" href="../../_variables/weightsum.html">$weightsum</a> == 0) {
<a name="l1064"><span class="linenum">1064</span></a>                      <a class="var it33687" onMouseOver="hilite(33687)" onMouseOut="lolite()" onClick="logVariable('agg_grade')" href="../../_variables/agg_grade.html">$agg_grade</a> = <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a>; <span class="comment">// only extra credits</span>
<a name="l1065"><span class="linenum">1065</span></a>  
<a name="l1066"><span class="linenum">1066</span></a>                  } else {
<a name="l1067"><span class="linenum">1067</span></a>                      <a class="var it33687" onMouseOver="hilite(33687)" onMouseOut="lolite()" onClick="logVariable('agg_grade')" href="../../_variables/agg_grade.html">$agg_grade</a> = <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a> / <a class="var it33695" onMouseOver="hilite(33695)" onMouseOut="lolite()" onClick="logVariable('weightsum')" href="../../_variables/weightsum.html">$weightsum</a>;
<a name="l1068"><span class="linenum">1068</span></a>                  }
<a name="l1069"><span class="linenum">1069</span></a>  
<a name="l1070"><span class="linenum">1070</span></a>  <span class="comment">                // Record the weights as used.</span>
<a name="l1071"><span class="linenum">1071</span></a>                  if (<a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a> !== null) {
<a name="l1072"><span class="linenum">1072</span></a>                      foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>=&gt;<a class="var it33358" onMouseOver="hilite(33358)" onMouseOut="lolite()" onClick="logVariable('grade_value')" href="../../_variables/grade_value.html">$grade_value</a>) {
<a name="l1073"><span class="linenum">1073</span></a>                          if (<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;aggregationcoef &gt; 0) {
<a name="l1074"><span class="linenum">1074</span></a>  <span class="comment">                            // Ignore extra credit items, the weights have already been computed.</span>
<a name="l1075"><span class="linenum">1075</span></a>                              continue;
<a name="l1076"><span class="linenum">1076</span></a>                          }
<a name="l1077"><span class="linenum">1077</span></a>                          if (<a class="var it33695" onMouseOver="hilite(33695)" onMouseOut="lolite()" onClick="logVariable('weightsum')" href="../../_variables/weightsum.html">$weightsum</a> &gt; 0) {
<a name="l1078"><span class="linenum">1078</span></a>                              <a class="var it5702" onMouseOver="hilite(5702)" onMouseOut="lolite()" onClick="logVariable('weight')" href="../../_variables/weight.html">$weight</a> = <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;grademax - <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;grademin;
<a name="l1079"><span class="linenum">1079</span></a>                              <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = <a class="var it5702" onMouseOver="hilite(5702)" onMouseOut="lolite()" onClick="logVariable('weight')" href="../../_variables/weight.html">$weight</a> / <a class="var it33695" onMouseOver="hilite(33695)" onMouseOut="lolite()" onClick="logVariable('weightsum')" href="../../_variables/weightsum.html">$weightsum</a>;
<a name="l1080"><span class="linenum">1080</span></a>                          } else {
<a name="l1081"><span class="linenum">1081</span></a>                              <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 0;
<a name="l1082"><span class="linenum">1082</span></a>                          }
<a name="l1083"><span class="linenum">1083</span></a>                      }
<a name="l1084"><span class="linenum">1084</span></a>                  }
<a name="l1085"><span class="linenum">1085</span></a>                  break;
<a name="l1086"><span class="linenum">1086</span></a>  
<a name="l1087"><span class="linenum">1087</span></a>              case <a class="constant" onClick="logConstant('GRADE_AGGREGATE_EXTRACREDIT_MEAN')" href="../../_constants/GRADE_AGGREGATE_EXTRACREDIT_MEAN.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_EXTRACREDIT_MEAN')">GRADE_AGGREGATE_EXTRACREDIT_MEAN</a>: // special average
<a name="l1088"><span class="linenum">1088</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l1089"><span class="linenum">1089</span></a>                  <a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a> = 0;
<a name="l1090"><span class="linenum">1090</span></a>                  <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a> = null;
<a name="l1091"><span class="linenum">1091</span></a>  
<a name="l1092"><span class="linenum">1092</span></a>                  foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>=&gt;<a class="var it33358" onMouseOver="hilite(33358)" onMouseOut="lolite()" onClick="logVariable('grade_value')" href="../../_variables/grade_value.html">$grade_value</a>) {
<a name="l1093"><span class="linenum">1093</span></a>                      if (<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;aggregationcoef == 0) {
<a name="l1094"><span class="linenum">1094</span></a>                          <a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a> += 1;
<a name="l1095"><span class="linenum">1095</span></a>                          <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a> += <a class="var it33358" onMouseOver="hilite(33358)" onMouseOut="lolite()" onClick="logVariable('grade_value')" href="../../_variables/grade_value.html">$grade_value</a>;
<a name="l1096"><span class="linenum">1096</span></a>                          if (<a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a> !== null) {
<a name="l1097"><span class="linenum">1097</span></a>                              <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 1;
<a name="l1098"><span class="linenum">1098</span></a>                          }
<a name="l1099"><span class="linenum">1099</span></a>                      }
<a name="l1100"><span class="linenum">1100</span></a>                  }
<a name="l1101"><span class="linenum">1101</span></a>  
<a name="l1102"><span class="linenum">1102</span></a>  <span class="comment">                // Treating the extra credit items separately to get a chance to calculate their effective weights.</span>
<a name="l1103"><span class="linenum">1103</span></a>                  foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>=&gt;<a class="var it33358" onMouseOver="hilite(33358)" onMouseOut="lolite()" onClick="logVariable('grade_value')" href="../../_variables/grade_value.html">$grade_value</a>) {
<a name="l1104"><span class="linenum">1104</span></a>                      if (<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;aggregationcoef &gt; 0) {
<a name="l1105"><span class="linenum">1105</span></a>                          <a class="var it33696" onMouseOver="hilite(33696)" onMouseOut="lolite()" onClick="logVariable('oldsum')" href="../../_variables/oldsum.html">$oldsum</a> = <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a>;
<a name="l1106"><span class="linenum">1106</span></a>                          <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a> += <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;aggregationcoef * <a class="var it33358" onMouseOver="hilite(33358)" onMouseOut="lolite()" onClick="logVariable('grade_value')" href="../../_variables/grade_value.html">$grade_value</a>;
<a name="l1107"><span class="linenum">1107</span></a>  
<a name="l1108"><span class="linenum">1108</span></a>                          if (<a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a> !== null) {
<a name="l1109"><span class="linenum">1109</span></a>                              if (<a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a> &lt;= 0) {
<a name="l1110"><span class="linenum">1110</span></a>  <span class="comment">                                // The category only contains extra credit items, not setting the weight.</span>
<a name="l1111"><span class="linenum">1111</span></a>                                  continue;
<a name="l1112"><span class="linenum">1112</span></a>                              }
<a name="l1113"><span class="linenum">1113</span></a>  
<a name="l1114"><span class="linenum">1114</span></a>                              <a class="var it9477" onMouseOver="hilite(9477)" onMouseOut="lolite()" onClick="logVariable('oldgrade')" href="../../_variables/oldgrade.html">$oldgrade</a> = <a class="var it33696" onMouseOver="hilite(33696)" onMouseOut="lolite()" onClick="logVariable('oldsum')" href="../../_variables/oldsum.html">$oldsum</a> / <a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a>;
<a name="l1115"><span class="linenum">1115</span></a>                              <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a> = <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a> / <a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a>;
<a name="l1116"><span class="linenum">1116</span></a>                              <a class="var it33698" onMouseOver="hilite(33698)" onMouseOut="lolite()" onClick="logVariable('normoldgrade')" href="../../_variables/normoldgrade.html">$normoldgrade</a> = <a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>::<a class="function" onClick="logFunction('standardise_score')" href="../../_functions/standardise_score.html" onMouseOver="funcPopup(event,'standardise_score')">standardise_score</a>(<a class="var it9477" onMouseOver="hilite(9477)" onMouseOut="lolite()" onClick="logVariable('oldgrade')" href="../../_variables/oldgrade.html">$oldgrade</a>, 0, 1, <a class="var it5024" onMouseOver="hilite(5024)" onMouseOut="lolite()" onClick="logVariable('grademin')" href="../../_variables/grademin.html">$grademin</a>, <a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a>);
<a name="l1117"><span class="linenum">1117</span></a>                              <a class="var it33699" onMouseOver="hilite(33699)" onMouseOut="lolite()" onClick="logVariable('normgrade')" href="../../_variables/normgrade.html">$normgrade</a> = <a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>::<a class="function" onClick="logFunction('standardise_score')" href="../../_functions/standardise_score.html" onMouseOver="funcPopup(event,'standardise_score')">standardise_score</a>(<a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>, 0, 1, <a class="var it5024" onMouseOver="hilite(5024)" onMouseOut="lolite()" onClick="logVariable('grademin')" href="../../_variables/grademin.html">$grademin</a>, <a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a>);
<a name="l1118"><span class="linenum">1118</span></a>                              <a class="var it33700" onMouseOver="hilite(33700)" onMouseOut="lolite()" onClick="logVariable('boundedoldgrade')" href="../../_variables/boundedoldgrade.html">$boundedoldgrade</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('bounded_grade')" href="../../_functions/bounded_grade.html" onMouseOver="funcPopup(event,'bounded_grade')">bounded_grade</a>(<a class="var it33698" onMouseOver="hilite(33698)" onMouseOut="lolite()" onClick="logVariable('normoldgrade')" href="../../_variables/normoldgrade.html">$normoldgrade</a>);
<a name="l1119"><span class="linenum">1119</span></a>                              <a class="var it33701" onMouseOver="hilite(33701)" onMouseOut="lolite()" onClick="logVariable('boundedgrade')" href="../../_variables/boundedgrade.html">$boundedgrade</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('bounded_grade')" href="../../_functions/bounded_grade.html" onMouseOver="funcPopup(event,'bounded_grade')">bounded_grade</a>(<a class="var it33699" onMouseOver="hilite(33699)" onMouseOut="lolite()" onClick="logVariable('normgrade')" href="../../_variables/normgrade.html">$normgrade</a>);
<a name="l1120"><span class="linenum">1120</span></a>  
<a name="l1121"><span class="linenum">1121</span></a>                              if (<a class="var it33701" onMouseOver="hilite(33701)" onMouseOut="lolite()" onClick="logVariable('boundedgrade')" href="../../_variables/boundedgrade.html">$boundedgrade</a> - <a class="var it33700" onMouseOver="hilite(33700)" onMouseOut="lolite()" onClick="logVariable('boundedoldgrade')" href="../../_variables/boundedoldgrade.html">$boundedoldgrade</a> &lt;= 0) {
<a name="l1122"><span class="linenum">1122</span></a>  <span class="comment">                                // Nothing new was added to the grade.</span>
<a name="l1123"><span class="linenum">1123</span></a>                                  <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 0;
<a name="l1124"><span class="linenum">1124</span></a>                              } else if (<a class="var it33701" onMouseOver="hilite(33701)" onMouseOut="lolite()" onClick="logVariable('boundedgrade')" href="../../_variables/boundedgrade.html">$boundedgrade</a> &lt; <a class="var it33699" onMouseOver="hilite(33699)" onMouseOut="lolite()" onClick="logVariable('normgrade')" href="../../_variables/normgrade.html">$normgrade</a>) {
<a name="l1125"><span class="linenum">1125</span></a>  <span class="comment">                                // The grade has been bounded, the extra credit item needs to have a different weight.</span>
<a name="l1126"><span class="linenum">1126</span></a>                                  <a class="var it33702" onMouseOver="hilite(33702)" onMouseOut="lolite()" onClick="logVariable('gradediff')" href="../../_variables/gradediff.html">$gradediff</a> = <a class="var it33701" onMouseOver="hilite(33701)" onMouseOut="lolite()" onClick="logVariable('boundedgrade')" href="../../_variables/boundedgrade.html">$boundedgrade</a> - <a class="var it33698" onMouseOver="hilite(33698)" onMouseOut="lolite()" onClick="logVariable('normoldgrade')" href="../../_variables/normoldgrade.html">$normoldgrade</a>;
<a name="l1127"><span class="linenum">1127</span></a>                                  <a class="var it33703" onMouseOver="hilite(33703)" onMouseOut="lolite()" onClick="logVariable('gradediffnorm')" href="../../_variables/gradediffnorm.html">$gradediffnorm</a> = <a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>::<a class="function" onClick="logFunction('standardise_score')" href="../../_functions/standardise_score.html" onMouseOver="funcPopup(event,'standardise_score')">standardise_score</a>(<a class="var it33702" onMouseOver="hilite(33702)" onMouseOut="lolite()" onClick="logVariable('gradediff')" href="../../_variables/gradediff.html">$gradediff</a>, <a class="var it5024" onMouseOver="hilite(5024)" onMouseOut="lolite()" onClick="logVariable('grademin')" href="../../_variables/grademin.html">$grademin</a>, <a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a>, 0, 1);
<a name="l1128"><span class="linenum">1128</span></a>                                  <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = <a class="var it33703" onMouseOver="hilite(33703)" onMouseOut="lolite()" onClick="logVariable('gradediffnorm')" href="../../_variables/gradediffnorm.html">$gradediffnorm</a> / <a class="var it33358" onMouseOver="hilite(33358)" onMouseOut="lolite()" onClick="logVariable('grade_value')" href="../../_variables/grade_value.html">$grade_value</a>;
<a name="l1129"><span class="linenum">1129</span></a>                              } else {
<a name="l1130"><span class="linenum">1130</span></a>  <span class="comment">                                // Default weighting.</span>
<a name="l1131"><span class="linenum">1131</span></a>                                  <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 1.0 / <a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a>;
<a name="l1132"><span class="linenum">1132</span></a>                              }
<a name="l1133"><span class="linenum">1133</span></a>                          }
<a name="l1134"><span class="linenum">1134</span></a>                      }
<a name="l1135"><span class="linenum">1135</span></a>                  }
<a name="l1136"><span class="linenum">1136</span></a>  
<a name="l1137"><span class="linenum">1137</span></a>                  if (<a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a> !== null &amp;&amp; <a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a> &gt; 0) {
<a name="l1138"><span class="linenum">1138</span></a>                      foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>=&gt;<a class="var it33358" onMouseOver="hilite(33358)" onMouseOut="lolite()" onClick="logVariable('grade_value')" href="../../_variables/grade_value.html">$grade_value</a>) {
<a name="l1139"><span class="linenum">1139</span></a>                          if (<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;aggregationcoef &gt; 0) {
<a name="l1140"><span class="linenum">1140</span></a>  <span class="comment">                            // Extra credit weights were already calculated.</span>
<a name="l1141"><span class="linenum">1141</span></a>                              continue;
<a name="l1142"><span class="linenum">1142</span></a>                          }
<a name="l1143"><span class="linenum">1143</span></a>                          if (<a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]) {
<a name="l1144"><span class="linenum">1144</span></a>                              <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 1.0 / <a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a>;
<a name="l1145"><span class="linenum">1145</span></a>                          }
<a name="l1146"><span class="linenum">1146</span></a>                      }
<a name="l1147"><span class="linenum">1147</span></a>                  }
<a name="l1148"><span class="linenum">1148</span></a>  
<a name="l1149"><span class="linenum">1149</span></a>                  if (<a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a> == 0) {
<a name="l1150"><span class="linenum">1150</span></a>                      <a class="var it33687" onMouseOver="hilite(33687)" onMouseOut="lolite()" onClick="logVariable('agg_grade')" href="../../_variables/agg_grade.html">$agg_grade</a> = <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a>; <span class="comment">// only extra credits or wrong coefs</span>
<a name="l1151"><span class="linenum">1151</span></a>  
<a name="l1152"><span class="linenum">1152</span></a>                  } else {
<a name="l1153"><span class="linenum">1153</span></a>                      <a class="var it33687" onMouseOver="hilite(33687)" onMouseOut="lolite()" onClick="logVariable('agg_grade')" href="../../_variables/agg_grade.html">$agg_grade</a> = <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a> / <a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a>;
<a name="l1154"><span class="linenum">1154</span></a>                  }
<a name="l1155"><span class="linenum">1155</span></a>  
<a name="l1156"><span class="linenum">1156</span></a>                  break;
<a name="l1157"><span class="linenum">1157</span></a>  
<a name="l1158"><span class="linenum">1158</span></a>              case <a class="constant" onClick="logConstant('GRADE_AGGREGATE_SUM')" href="../../_constants/GRADE_AGGREGATE_SUM.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_SUM')">GRADE_AGGREGATE_SUM</a>:    // Add up all the items.
<a name="l1159"><span class="linenum">1159</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l1160"><span class="linenum">1160</span></a>                  <a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a> = <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>);
<a name="l1161"><span class="linenum">1161</span></a>                  <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a> = 0;
<a name="l1162"><span class="linenum">1162</span></a>                  <a class="var it12822" onMouseOver="hilite(12822)" onMouseOut="lolite()" onClick="logVariable('sumweights')" href="../../_variables/sumweights.html">$sumweights</a> = 0;
<a name="l1163"><span class="linenum">1163</span></a>                  <a class="var it5024" onMouseOver="hilite(5024)" onMouseOut="lolite()" onClick="logVariable('grademin')" href="../../_variables/grademin.html">$grademin</a> = 0;
<a name="l1164"><span class="linenum">1164</span></a>                  <a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a> = 0;
<a name="l1165"><span class="linenum">1165</span></a>                  <a class="var it33704" onMouseOver="hilite(33704)" onMouseOut="lolite()" onClick="logVariable('extracredititems')" href="../../_variables/extracredititems.html">$extracredititems</a> = array();
<a name="l1166"><span class="linenum">1166</span></a>                  foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a> =&gt; <a class="var it10017" onMouseOver="hilite(10017)" onMouseOut="lolite()" onClick="logVariable('gradevalue')" href="../../_variables/gradevalue.html">$gradevalue</a>) {
<a name="l1167"><span class="linenum">1167</span></a>  <span class="comment">                    // We need to check if the grademax/min was adjusted per user because of excluded items.</span>
<a name="l1168"><span class="linenum">1168</span></a>                      <a class="var it33685" onMouseOver="hilite(33685)" onMouseOut="lolite()" onClick="logVariable('usergrademin')" href="../../_variables/usergrademin.html">$usergrademin</a> = <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;grademin;
<a name="l1169"><span class="linenum">1169</span></a>                      <a class="var it33686" onMouseOver="hilite(33686)" onMouseOut="lolite()" onClick="logVariable('usergrademax')" href="../../_variables/usergrademax.html">$usergrademax</a> = <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;grademax;
<a name="l1170"><span class="linenum">1170</span></a>                      if (isset(<a class="var it33678" onMouseOver="hilite(33678)" onMouseOut="lolite()" onClick="logVariable('grademinoverrides')" href="../../_variables/grademinoverrides.html">$grademinoverrides</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>])) {
<a name="l1171"><span class="linenum">1171</span></a>                          <a class="var it33685" onMouseOver="hilite(33685)" onMouseOut="lolite()" onClick="logVariable('usergrademin')" href="../../_variables/usergrademin.html">$usergrademin</a> = <a class="var it33678" onMouseOver="hilite(33678)" onMouseOut="lolite()" onClick="logVariable('grademinoverrides')" href="../../_variables/grademinoverrides.html">$grademinoverrides</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>];
<a name="l1172"><span class="linenum">1172</span></a>                      }
<a name="l1173"><span class="linenum">1173</span></a>                      if (isset(<a class="var it33677" onMouseOver="hilite(33677)" onMouseOut="lolite()" onClick="logVariable('grademaxoverrides')" href="../../_variables/grademaxoverrides.html">$grademaxoverrides</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>])) {
<a name="l1174"><span class="linenum">1174</span></a>                          <a class="var it33686" onMouseOver="hilite(33686)" onMouseOut="lolite()" onClick="logVariable('usergrademax')" href="../../_variables/usergrademax.html">$usergrademax</a> = <a class="var it33677" onMouseOver="hilite(33677)" onMouseOut="lolite()" onClick="logVariable('grademaxoverrides')" href="../../_variables/grademaxoverrides.html">$grademaxoverrides</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>];
<a name="l1175"><span class="linenum">1175</span></a>                      }
<a name="l1176"><span class="linenum">1176</span></a>  
<a name="l1177"><span class="linenum">1177</span></a>  <span class="comment">                    // Keep track of the extra credit items, we will need them later on.</span>
<a name="l1178"><span class="linenum">1178</span></a>                      if (<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;aggregationcoef &gt; 0) {
<a name="l1179"><span class="linenum">1179</span></a>                          <a class="var it33704" onMouseOver="hilite(33704)" onMouseOut="lolite()" onClick="logVariable('extracredititems')" href="../../_variables/extracredititems.html">$extracredititems</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>];
<a name="l1180"><span class="linenum">1180</span></a>                      }
<a name="l1181"><span class="linenum">1181</span></a>  
<a name="l1182"><span class="linenum">1182</span></a>  <span class="comment">                    // Ignore extra credit and items with a weight of 0.</span>
<a name="l1183"><span class="linenum">1183</span></a>                      if (!isset(<a class="var it33704" onMouseOver="hilite(33704)" onMouseOut="lolite()" onClick="logVariable('extracredititems')" href="../../_variables/extracredititems.html">$extracredititems</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]) &amp;&amp; <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;aggregationcoef2 &gt; 0) {
<a name="l1184"><span class="linenum">1184</span></a>                          <a class="var it5024" onMouseOver="hilite(5024)" onMouseOut="lolite()" onClick="logVariable('grademin')" href="../../_variables/grademin.html">$grademin</a> += <a class="var it33685" onMouseOver="hilite(33685)" onMouseOut="lolite()" onClick="logVariable('usergrademin')" href="../../_variables/usergrademin.html">$usergrademin</a>;
<a name="l1185"><span class="linenum">1185</span></a>                          <a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a> += <a class="var it33686" onMouseOver="hilite(33686)" onMouseOut="lolite()" onClick="logVariable('usergrademax')" href="../../_variables/usergrademax.html">$usergrademax</a>;
<a name="l1186"><span class="linenum">1186</span></a>                          <a class="var it12822" onMouseOver="hilite(12822)" onMouseOut="lolite()" onClick="logVariable('sumweights')" href="../../_variables/sumweights.html">$sumweights</a> += <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;aggregationcoef2;
<a name="l1187"><span class="linenum">1187</span></a>                      }
<a name="l1188"><span class="linenum">1188</span></a>                  }
<a name="l1189"><span class="linenum">1189</span></a>                  <a class="var it33705" onMouseOver="hilite(33705)" onMouseOut="lolite()" onClick="logVariable('userweights')" href="../../_variables/userweights.html">$userweights</a> = array();
<a name="l1190"><span class="linenum">1190</span></a>                  <a class="var it33706" onMouseOver="hilite(33706)" onMouseOut="lolite()" onClick="logVariable('totaloverriddenweight')" href="../../_variables/totaloverriddenweight.html">$totaloverriddenweight</a> = 0;
<a name="l1191"><span class="linenum">1191</span></a>                  <a class="var it33707" onMouseOver="hilite(33707)" onMouseOut="lolite()" onClick="logVariable('totaloverriddengrademax')" href="../../_variables/totaloverriddengrademax.html">$totaloverriddengrademax</a> = 0;
<a name="l1192"><span class="linenum">1192</span></a>  <span class="comment">                // We first need to rescale all manually assigned weights down by the</span>
<a name="l1193"><span class="linenum">1193</span></a>  <span class="comment">                // percentage of weights missing from the category.</span>
<a name="l1194"><span class="linenum">1194</span></a>                  foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a> =&gt; <a class="var it10017" onMouseOver="hilite(10017)" onMouseOut="lolite()" onClick="logVariable('gradevalue')" href="../../_variables/gradevalue.html">$gradevalue</a>) {
<a name="l1195"><span class="linenum">1195</span></a>                      if (<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;weightoverride) {
<a name="l1196"><span class="linenum">1196</span></a>                          if (<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;aggregationcoef2 &lt;= 0) {
<a name="l1197"><span class="linenum">1197</span></a>  <span class="comment">                            // Records the weight of 0 and continue.</span>
<a name="l1198"><span class="linenum">1198</span></a>                              <a class="var it33705" onMouseOver="hilite(33705)" onMouseOut="lolite()" onClick="logVariable('userweights')" href="../../_variables/userweights.html">$userweights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 0;
<a name="l1199"><span class="linenum">1199</span></a>                              continue;
<a name="l1200"><span class="linenum">1200</span></a>                          }
<a name="l1201"><span class="linenum">1201</span></a>                          <a class="var it33705" onMouseOver="hilite(33705)" onMouseOut="lolite()" onClick="logVariable('userweights')" href="../../_variables/userweights.html">$userweights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;aggregationcoef2 / <a class="var it12822" onMouseOver="hilite(12822)" onMouseOut="lolite()" onClick="logVariable('sumweights')" href="../../_variables/sumweights.html">$sumweights</a>;
<a name="l1202"><span class="linenum">1202</span></a>                          <a class="var it33706" onMouseOver="hilite(33706)" onMouseOut="lolite()" onClick="logVariable('totaloverriddenweight')" href="../../_variables/totaloverriddenweight.html">$totaloverriddenweight</a> += <a class="var it33705" onMouseOver="hilite(33705)" onMouseOut="lolite()" onClick="logVariable('userweights')" href="../../_variables/userweights.html">$userweights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>];
<a name="l1203"><span class="linenum">1203</span></a>                          <a class="var it33686" onMouseOver="hilite(33686)" onMouseOut="lolite()" onClick="logVariable('usergrademax')" href="../../_variables/usergrademax.html">$usergrademax</a> = <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;grademax;
<a name="l1204"><span class="linenum">1204</span></a>                          if (isset(<a class="var it33677" onMouseOver="hilite(33677)" onMouseOut="lolite()" onClick="logVariable('grademaxoverrides')" href="../../_variables/grademaxoverrides.html">$grademaxoverrides</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>])) {
<a name="l1205"><span class="linenum">1205</span></a>                              <a class="var it33686" onMouseOver="hilite(33686)" onMouseOut="lolite()" onClick="logVariable('usergrademax')" href="../../_variables/usergrademax.html">$usergrademax</a> = <a class="var it33677" onMouseOver="hilite(33677)" onMouseOut="lolite()" onClick="logVariable('grademaxoverrides')" href="../../_variables/grademaxoverrides.html">$grademaxoverrides</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>];
<a name="l1206"><span class="linenum">1206</span></a>                          }
<a name="l1207"><span class="linenum">1207</span></a>                          <a class="var it33707" onMouseOver="hilite(33707)" onMouseOut="lolite()" onClick="logVariable('totaloverriddengrademax')" href="../../_variables/totaloverriddengrademax.html">$totaloverriddengrademax</a> += <a class="var it33686" onMouseOver="hilite(33686)" onMouseOut="lolite()" onClick="logVariable('usergrademax')" href="../../_variables/usergrademax.html">$usergrademax</a>;
<a name="l1208"><span class="linenum">1208</span></a>                      }
<a name="l1209"><span class="linenum">1209</span></a>                  }
<a name="l1210"><span class="linenum">1210</span></a>                  <a class="var it33708" onMouseOver="hilite(33708)" onMouseOut="lolite()" onClick="logVariable('nonoverriddenpoints')" href="../../_variables/nonoverriddenpoints.html">$nonoverriddenpoints</a> = <a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a> - <a class="var it33707" onMouseOver="hilite(33707)" onMouseOut="lolite()" onClick="logVariable('totaloverriddengrademax')" href="../../_variables/totaloverriddengrademax.html">$totaloverriddengrademax</a>;
<a name="l1211"><span class="linenum">1211</span></a>  
<a name="l1212"><span class="linenum">1212</span></a>  <span class="comment">                // Then we need to recalculate the automatic weights.</span>
<a name="l1213"><span class="linenum">1213</span></a>                  foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a> =&gt; <a class="var it10017" onMouseOver="hilite(10017)" onMouseOut="lolite()" onClick="logVariable('gradevalue')" href="../../_variables/gradevalue.html">$gradevalue</a>) {
<a name="l1214"><span class="linenum">1214</span></a>                      if (!<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;weightoverride) {
<a name="l1215"><span class="linenum">1215</span></a>                          <a class="var it33686" onMouseOver="hilite(33686)" onMouseOut="lolite()" onClick="logVariable('usergrademax')" href="../../_variables/usergrademax.html">$usergrademax</a> = <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;grademax;
<a name="l1216"><span class="linenum">1216</span></a>                          if (isset(<a class="var it33677" onMouseOver="hilite(33677)" onMouseOut="lolite()" onClick="logVariable('grademaxoverrides')" href="../../_variables/grademaxoverrides.html">$grademaxoverrides</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>])) {
<a name="l1217"><span class="linenum">1217</span></a>                              <a class="var it33686" onMouseOver="hilite(33686)" onMouseOut="lolite()" onClick="logVariable('usergrademax')" href="../../_variables/usergrademax.html">$usergrademax</a> = <a class="var it33677" onMouseOver="hilite(33677)" onMouseOut="lolite()" onClick="logVariable('grademaxoverrides')" href="../../_variables/grademaxoverrides.html">$grademaxoverrides</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>];
<a name="l1218"><span class="linenum">1218</span></a>                          }
<a name="l1219"><span class="linenum">1219</span></a>                          if (<a class="var it33708" onMouseOver="hilite(33708)" onMouseOut="lolite()" onClick="logVariable('nonoverriddenpoints')" href="../../_variables/nonoverriddenpoints.html">$nonoverriddenpoints</a> &gt; 0) {
<a name="l1220"><span class="linenum">1220</span></a>                              <a class="var it33705" onMouseOver="hilite(33705)" onMouseOut="lolite()" onClick="logVariable('userweights')" href="../../_variables/userweights.html">$userweights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = (<a class="var it33686" onMouseOver="hilite(33686)" onMouseOut="lolite()" onClick="logVariable('usergrademax')" href="../../_variables/usergrademax.html">$usergrademax</a>/<a class="var it33708" onMouseOver="hilite(33708)" onMouseOut="lolite()" onClick="logVariable('nonoverriddenpoints')" href="../../_variables/nonoverriddenpoints.html">$nonoverriddenpoints</a>) * (1 - <a class="var it33706" onMouseOver="hilite(33706)" onMouseOut="lolite()" onClick="logVariable('totaloverriddenweight')" href="../../_variables/totaloverriddenweight.html">$totaloverriddenweight</a>);
<a name="l1221"><span class="linenum">1221</span></a>                          } else {
<a name="l1222"><span class="linenum">1222</span></a>                              <a class="var it33705" onMouseOver="hilite(33705)" onMouseOut="lolite()" onClick="logVariable('userweights')" href="../../_variables/userweights.html">$userweights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 0;
<a name="l1223"><span class="linenum">1223</span></a>                              if (<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;aggregationcoef2 &gt; 0) {
<a name="l1224"><span class="linenum">1224</span></a>  <span class="comment">                                // Items with a weight of 0 should not count for the grade max,</span>
<a name="l1225"><span class="linenum">1225</span></a>  <span class="comment">                                // though this only applies if the weight was changed to 0.</span>
<a name="l1226"><span class="linenum">1226</span></a>                                  <a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a> -= <a class="var it33686" onMouseOver="hilite(33686)" onMouseOut="lolite()" onClick="logVariable('usergrademax')" href="../../_variables/usergrademax.html">$usergrademax</a>;
<a name="l1227"><span class="linenum">1227</span></a>                              }
<a name="l1228"><span class="linenum">1228</span></a>                          }
<a name="l1229"><span class="linenum">1229</span></a>                      }
<a name="l1230"><span class="linenum">1230</span></a>                  }
<a name="l1231"><span class="linenum">1231</span></a>  
<a name="l1232"><span class="linenum">1232</span></a>  <span class="comment">                // We can use our freshly corrected weights below.</span>
<a name="l1233"><span class="linenum">1233</span></a>                  foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a> =&gt; <a class="var it10017" onMouseOver="hilite(10017)" onMouseOut="lolite()" onClick="logVariable('gradevalue')" href="../../_variables/gradevalue.html">$gradevalue</a>) {
<a name="l1234"><span class="linenum">1234</span></a>                      if (isset(<a class="var it33704" onMouseOver="hilite(33704)" onMouseOut="lolite()" onClick="logVariable('extracredititems')" href="../../_variables/extracredititems.html">$extracredititems</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>])) {
<a name="l1235"><span class="linenum">1235</span></a>  <span class="comment">                        // We skip the extra credit items first.</span>
<a name="l1236"><span class="linenum">1236</span></a>                          continue;
<a name="l1237"><span class="linenum">1237</span></a>                      }
<a name="l1238"><span class="linenum">1238</span></a>                      <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a> += <a class="var it10017" onMouseOver="hilite(10017)" onMouseOut="lolite()" onClick="logVariable('gradevalue')" href="../../_variables/gradevalue.html">$gradevalue</a> * <a class="var it33705" onMouseOver="hilite(33705)" onMouseOut="lolite()" onClick="logVariable('userweights')" href="../../_variables/userweights.html">$userweights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] * <a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a>;
<a name="l1239"><span class="linenum">1239</span></a>                      if (<a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a> !== null) {
<a name="l1240"><span class="linenum">1240</span></a>                          <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = <a class="var it33705" onMouseOver="hilite(33705)" onMouseOut="lolite()" onClick="logVariable('userweights')" href="../../_variables/userweights.html">$userweights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>];
<a name="l1241"><span class="linenum">1241</span></a>                      }
<a name="l1242"><span class="linenum">1242</span></a>                  }
<a name="l1243"><span class="linenum">1243</span></a>  
<a name="l1244"><span class="linenum">1244</span></a>  <span class="comment">                // No we proceed with the extra credit items. They might have a different final</span>
<a name="l1245"><span class="linenum">1245</span></a>  <span class="comment">                // weight in case the final grade was bounded. So we need to treat them different.</span>
<a name="l1246"><span class="linenum">1246</span></a>  <span class="comment">                // Also, as we need to use the bounded_grade() method, we have to inject the</span>
<a name="l1247"><span class="linenum">1247</span></a>  <span class="comment">                // right values there, and restore them afterwards.</span>
<a name="l1248"><span class="linenum">1248</span></a>                  <a class="var it33709" onMouseOver="hilite(33709)" onMouseOut="lolite()" onClick="logVariable('oldgrademax')" href="../../_variables/oldgrademax.html">$oldgrademax</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;grademax;
<a name="l1249"><span class="linenum">1249</span></a>                  <a class="var it33710" onMouseOver="hilite(33710)" onMouseOut="lolite()" onClick="logVariable('oldgrademin')" href="../../_variables/oldgrademin.html">$oldgrademin</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;grademin;
<a name="l1250"><span class="linenum">1250</span></a>                  foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a> =&gt; <a class="var it10017" onMouseOver="hilite(10017)" onMouseOut="lolite()" onClick="logVariable('gradevalue')" href="../../_variables/gradevalue.html">$gradevalue</a>) {
<a name="l1251"><span class="linenum">1251</span></a>                      if (!isset(<a class="var it33704" onMouseOver="hilite(33704)" onMouseOut="lolite()" onClick="logVariable('extracredititems')" href="../../_variables/extracredititems.html">$extracredititems</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>])) {
<a name="l1252"><span class="linenum">1252</span></a>                          continue;
<a name="l1253"><span class="linenum">1253</span></a>                      }
<a name="l1254"><span class="linenum">1254</span></a>                      <a class="var it33696" onMouseOver="hilite(33696)" onMouseOut="lolite()" onClick="logVariable('oldsum')" href="../../_variables/oldsum.html">$oldsum</a> = <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a>;
<a name="l1255"><span class="linenum">1255</span></a>                      <a class="var it33697" onMouseOver="hilite(33697)" onMouseOut="lolite()" onClick="logVariable('weightedgrade')" href="../../_variables/weightedgrade.html">$weightedgrade</a> = <a class="var it10017" onMouseOver="hilite(10017)" onMouseOut="lolite()" onClick="logVariable('gradevalue')" href="../../_variables/gradevalue.html">$gradevalue</a> * <a class="var it33705" onMouseOver="hilite(33705)" onMouseOut="lolite()" onClick="logVariable('userweights')" href="../../_variables/userweights.html">$userweights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] * <a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a>;
<a name="l1256"><span class="linenum">1256</span></a>                      <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a> += <a class="var it33697" onMouseOver="hilite(33697)" onMouseOut="lolite()" onClick="logVariable('weightedgrade')" href="../../_variables/weightedgrade.html">$weightedgrade</a>;
<a name="l1257"><span class="linenum">1257</span></a>  
<a name="l1258"><span class="linenum">1258</span></a>  <span class="comment">                    // Only go through this when we need to record the weights.</span>
<a name="l1259"><span class="linenum">1259</span></a>                      if (<a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a> !== null) {
<a name="l1260"><span class="linenum">1260</span></a>                          if (<a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a> &lt;= 0) {
<a name="l1261"><span class="linenum">1261</span></a>  <span class="comment">                            // There are only extra credit items in this category,</span>
<a name="l1262"><span class="linenum">1262</span></a>  <span class="comment">                            // all the weights should be accurate (and be 0).</span>
<a name="l1263"><span class="linenum">1263</span></a>                              <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = <a class="var it33705" onMouseOver="hilite(33705)" onMouseOut="lolite()" onClick="logVariable('userweights')" href="../../_variables/userweights.html">$userweights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>];
<a name="l1264"><span class="linenum">1264</span></a>                              continue;
<a name="l1265"><span class="linenum">1265</span></a>                          }
<a name="l1266"><span class="linenum">1266</span></a>  
<a name="l1267"><span class="linenum">1267</span></a>                          <a class="var it10034" onMouseOver="hilite(10034)" onMouseOut="lolite()" onClick="logVariable('oldfinalgrade')" href="../../_variables/oldfinalgrade.html">$oldfinalgrade</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('bounded_grade')" href="../../_functions/bounded_grade.html" onMouseOver="funcPopup(event,'bounded_grade')">bounded_grade</a>(<a class="var it33696" onMouseOver="hilite(33696)" onMouseOut="lolite()" onClick="logVariable('oldsum')" href="../../_variables/oldsum.html">$oldsum</a>);
<a name="l1268"><span class="linenum">1268</span></a>                          <a class="var it33711" onMouseOver="hilite(33711)" onMouseOut="lolite()" onClick="logVariable('newfinalgrade')" href="../../_variables/newfinalgrade.html">$newfinalgrade</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('bounded_grade')" href="../../_functions/bounded_grade.html" onMouseOver="funcPopup(event,'bounded_grade')">bounded_grade</a>(<a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a>);
<a name="l1269"><span class="linenum">1269</span></a>                          <a class="var it33712" onMouseOver="hilite(33712)" onMouseOut="lolite()" onClick="logVariable('finalgradediff')" href="../../_variables/finalgradediff.html">$finalgradediff</a> = <a class="var it33711" onMouseOver="hilite(33711)" onMouseOut="lolite()" onClick="logVariable('newfinalgrade')" href="../../_variables/newfinalgrade.html">$newfinalgrade</a> - <a class="var it10034" onMouseOver="hilite(10034)" onMouseOut="lolite()" onClick="logVariable('oldfinalgrade')" href="../../_variables/oldfinalgrade.html">$oldfinalgrade</a>;
<a name="l1270"><span class="linenum">1270</span></a>                          if (<a class="var it33712" onMouseOver="hilite(33712)" onMouseOut="lolite()" onClick="logVariable('finalgradediff')" href="../../_variables/finalgradediff.html">$finalgradediff</a> &lt;= 0) {
<a name="l1271"><span class="linenum">1271</span></a>  <span class="comment">                            // This item did not contribute to the category total at all.</span>
<a name="l1272"><span class="linenum">1272</span></a>                              <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 0;
<a name="l1273"><span class="linenum">1273</span></a>                          } else if (<a class="var it33712" onMouseOver="hilite(33712)" onMouseOut="lolite()" onClick="logVariable('finalgradediff')" href="../../_variables/finalgradediff.html">$finalgradediff</a> &lt; <a class="var it33697" onMouseOver="hilite(33697)" onMouseOut="lolite()" onClick="logVariable('weightedgrade')" href="../../_variables/weightedgrade.html">$weightedgrade</a>) {
<a name="l1274"><span class="linenum">1274</span></a>  <span class="comment">                            // The weight needs to be adjusted because only a portion of the</span>
<a name="l1275"><span class="linenum">1275</span></a>  <span class="comment">                            // extra credit item contributed to the category total.</span>
<a name="l1276"><span class="linenum">1276</span></a>                              <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = <a class="var it33712" onMouseOver="hilite(33712)" onMouseOut="lolite()" onClick="logVariable('finalgradediff')" href="../../_variables/finalgradediff.html">$finalgradediff</a> / (<a class="var it10017" onMouseOver="hilite(10017)" onMouseOut="lolite()" onClick="logVariable('gradevalue')" href="../../_variables/gradevalue.html">$gradevalue</a> * <a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a>);
<a name="l1277"><span class="linenum">1277</span></a>                          } else {
<a name="l1278"><span class="linenum">1278</span></a>  <span class="comment">                            // The weight was accurate.</span>
<a name="l1279"><span class="linenum">1279</span></a>                              <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = <a class="var it33705" onMouseOver="hilite(33705)" onMouseOut="lolite()" onClick="logVariable('userweights')" href="../../_variables/userweights.html">$userweights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>];
<a name="l1280"><span class="linenum">1280</span></a>                          }
<a name="l1281"><span class="linenum">1281</span></a>                      }
<a name="l1282"><span class="linenum">1282</span></a>                  }
<a name="l1283"><span class="linenum">1283</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;grademax = <a class="var it33709" onMouseOver="hilite(33709)" onMouseOut="lolite()" onClick="logVariable('oldgrademax')" href="../../_variables/oldgrademax.html">$oldgrademax</a>;
<a name="l1284"><span class="linenum">1284</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;grademin = <a class="var it33710" onMouseOver="hilite(33710)" onMouseOut="lolite()" onClick="logVariable('oldgrademin')" href="../../_variables/oldgrademin.html">$oldgrademin</a>;
<a name="l1285"><span class="linenum">1285</span></a>  
<a name="l1286"><span class="linenum">1286</span></a>                  if (<a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a> &gt; 0) {
<a name="l1287"><span class="linenum">1287</span></a>                      <a class="var it33687" onMouseOver="hilite(33687)" onMouseOut="lolite()" onClick="logVariable('agg_grade')" href="../../_variables/agg_grade.html">$agg_grade</a> = <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a> / <a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a>; <span class="comment">// Re-normalize score.</span>
<a name="l1288"><span class="linenum">1288</span></a>                  } else {
<a name="l1289"><span class="linenum">1289</span></a>  <span class="comment">                    // Every item in the category is extra credit.</span>
<a name="l1290"><span class="linenum">1290</span></a>                      <a class="var it33687" onMouseOver="hilite(33687)" onMouseOut="lolite()" onClick="logVariable('agg_grade')" href="../../_variables/agg_grade.html">$agg_grade</a> = <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a>;
<a name="l1291"><span class="linenum">1291</span></a>                      <a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a> = <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a>;
<a name="l1292"><span class="linenum">1292</span></a>                  }
<a name="l1293"><span class="linenum">1293</span></a>  
<a name="l1294"><span class="linenum">1294</span></a>                  break;
<a name="l1295"><span class="linenum">1295</span></a>  
<a name="l1296"><span class="linenum">1296</span></a>              case <a class="constant" onClick="logConstant('GRADE_AGGREGATE_MEAN')" href="../../_constants/GRADE_AGGREGATE_MEAN.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_MEAN')">GRADE_AGGREGATE_MEAN</a>:    // Arithmetic average of all grade items (if ungraded aggregated, NULL counted as minimum)
<a name="l1297"><span class="linenum">1297</span></a>              default:
<a name="l1298"><span class="linenum">1298</span></a>                  <a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a> = <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>);
<a name="l1299"><span class="linenum">1299</span></a>                  <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a> = <a class="phpfunction" onClick="logFunction('array_sum')" href="../../_functions/array_sum.html" onMouseOver="phpfuncPopup(event,'array_sum')">array_sum</a>(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>);
<a name="l1300"><span class="linenum">1300</span></a>                  <a class="var it33687" onMouseOver="hilite(33687)" onMouseOut="lolite()" onClick="logVariable('agg_grade')" href="../../_variables/agg_grade.html">$agg_grade</a> = <a class="var it2394" onMouseOver="hilite(2394)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a> / <a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a>;
<a name="l1301"><span class="linenum">1301</span></a>  <span class="comment">                // Record the weights evenly.</span>
<a name="l1302"><span class="linenum">1302</span></a>                  if (<a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a> !== null &amp;&amp; <a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a> &gt; 0) {
<a name="l1303"><span class="linenum">1303</span></a>                      foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>=&gt;<a class="var it33358" onMouseOver="hilite(33358)" onMouseOut="lolite()" onClick="logVariable('grade_value')" href="../../_variables/grade_value.html">$grade_value</a>) {
<a name="l1304"><span class="linenum">1304</span></a>                          <a class="var it26493" onMouseOver="hilite(26493)" onMouseOut="lolite()" onClick="logVariable('weights')" href="../../_variables/weights.html">$weights</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 1.0 / <a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a>;
<a name="l1305"><span class="linenum">1305</span></a>                      }
<a name="l1306"><span class="linenum">1306</span></a>                  }
<a name="l1307"><span class="linenum">1307</span></a>                  break;
<a name="l1308"><span class="linenum">1308</span></a>          }
<a name="l1309"><span class="linenum">1309</span></a>  
<a name="l1310"><span class="linenum">1310</span></a>          return array('grade' =&gt; <a class="var it33687" onMouseOver="hilite(33687)" onMouseOut="lolite()" onClick="logVariable('agg_grade')" href="../../_variables/agg_grade.html">$agg_grade</a>, 'grademin' =&gt; <a class="var it5024" onMouseOver="hilite(5024)" onMouseOut="lolite()" onClick="logVariable('grademin')" href="../../_variables/grademin.html">$grademin</a>, 'grademax' =&gt; <a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a>);
<a name="l1311"><span class="linenum">1311</span></a>      }
<a name="l1312"><span class="linenum">1312</span></a>  
<a name="l1313"><span class="linenum">1313</span></a>      <span class="comment">/**</span>
<a name="l1314"><span class="linenum">1314</span></a>  <span class="comment">     * Internal function that calculates the aggregated grade for this grade category</span>
<a name="l1315"><span class="linenum">1315</span></a>  <span class="comment">     *</span>
<a name="l1316"><span class="linenum">1316</span></a>  <span class="comment">     * Must be public as it is used by grade_grade::get_hiding_affected()</span>
<a name="l1317"><span class="linenum">1317</span></a>  <span class="comment">     *</span>
<a name="l1318"><span class="linenum">1318</span></a>  <span class="comment">     * @deprecated since Moodle 2.8</span>
<a name="l1319"><span class="linenum">1319</span></a>  <span class="comment">     * @param array $grade_values An array of values to be aggregated</span>
<a name="l1320"><span class="linenum">1320</span></a>  <span class="comment">     * @param array $items The array of grade_items</span>
<a name="l1321"><span class="linenum">1321</span></a>  <span class="comment">     * @return float The aggregate grade for this grade category</span>
<a name="l1322"><span class="linenum">1322</span></a>  <span class="comment">     */</span>
<a name="l1323"><span class="linenum">1323</span></a>      public function <a class="function" onClick="logFunction('aggregate_values')" href="../../_functions/aggregate_values.html" onMouseOver="funcPopup(event,'aggregate_values')">aggregate_values</a>(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>, <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>) {
<a name="l1324"><span class="linenum">1324</span></a>          <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('<a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>::<a class="function" onClick="logFunction('aggregate_values')" href="../../_functions/aggregate_values.html" onMouseOver="funcPopup(event,'aggregate_values')">aggregate_values</a>() is deprecated.
<a name="l1325"><span class="linenum">1325</span></a>                     Call <a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>::<a class="function" onClick="logFunction('aggregate_values_and_adjust_bounds')" href="../../_functions/aggregate_values_and_adjust_bounds.html" onMouseOver="funcPopup(event,'aggregate_values_and_adjust_bounds')">aggregate_values_and_adjust_bounds</a>() instead.', <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l1326"><span class="linenum">1326</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('aggregate_values_and_adjust_bounds')" href="../../_functions/aggregate_values_and_adjust_bounds.html" onMouseOver="funcPopup(event,'aggregate_values_and_adjust_bounds')">aggregate_values_and_adjust_bounds</a>(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>, <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>);
<a name="l1327"><span class="linenum">1327</span></a>          return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>['grade'];
<a name="l1328"><span class="linenum">1328</span></a>      }
<a name="l1329"><span class="linenum">1329</span></a>  
<a name="l1330"><span class="linenum">1330</span></a>      <span class="comment">/**</span>
<a name="l1331"><span class="linenum">1331</span></a>  <span class="comment">     * Some aggregation types may need to update their max grade.</span>
<a name="l1332"><span class="linenum">1332</span></a>  <span class="comment">     *</span>
<a name="l1333"><span class="linenum">1333</span></a>  <span class="comment">     * This must be executed after updating the weights as it relies on them.</span>
<a name="l1334"><span class="linenum">1334</span></a>  <span class="comment">     *</span>
<a name="l1335"><span class="linenum">1335</span></a>  <span class="comment">     * @return void</span>
<a name="l1336"><span class="linenum">1336</span></a>  <span class="comment">     */</span>
<a name="l1337"><span class="linenum">1337</span></a>      private function <a class="function" onClick="logFunction('auto_update_max')" href="../../_functions/auto_update_max.html" onMouseOver="funcPopup(event,'auto_update_max')">auto_update_max</a>() {
<a name="l1338"><span class="linenum">1338</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1339"><span class="linenum">1339</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregation')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregation.html">aggregation</a> != <a class="constant" onClick="logConstant('GRADE_AGGREGATE_SUM')" href="../../_constants/GRADE_AGGREGATE_SUM.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_SUM')">GRADE_AGGREGATE_SUM</a>) {
<a name="l1340"><span class="linenum">1340</span></a>  <span class="comment">            // not needed at all</span>
<a name="l1341"><span class="linenum">1341</span></a>              return;
<a name="l1342"><span class="linenum">1342</span></a>          }
<a name="l1343"><span class="linenum">1343</span></a>  
<a name="l1344"><span class="linenum">1344</span></a>  <span class="comment">        // Find grade items of immediate children (category or grade items) and force site settings.</span>
<a name="l1345"><span class="linenum">1345</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l1346"><span class="linenum">1346</span></a>          <a class="var it33675" onMouseOver="hilite(33675)" onMouseOut="lolite()" onClick="logVariable('depends_on')" href="../../_variables/depends_on.html">$depends_on</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('depends_on')" href="../../_functions/depends_on.html" onMouseOver="funcPopup(event,'depends_on')">depends_on</a>();
<a name="l1347"><span class="linenum">1347</span></a>  
<a name="l1348"><span class="linenum">1348</span></a>          <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a> = false;
<a name="l1349"><span class="linenum">1349</span></a>          if (!empty(<a class="var it33675" onMouseOver="hilite(33675)" onMouseOut="lolite()" onClick="logVariable('depends_on')" href="../../_variables/depends_on.html">$depends_on</a>)) {
<a name="l1350"><span class="linenum">1350</span></a>              <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it2909" onMouseOver="hilite(2909)" onMouseOut="lolite()" onClick="logVariable('usql')" href="../../_variables/usql.html">$usql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it33675" onMouseOver="hilite(33675)" onMouseOut="lolite()" onClick="logVariable('depends_on')" href="../../_variables/depends_on.html">$depends_on</a>);
<a name="l1351"><span class="linenum">1351</span></a>              <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT *
<a name="l1352"><span class="linenum">1352</span></a>                        FROM {grade_items}
<a name="l1353"><span class="linenum">1353</span></a>                       WHERE id <a class="var it2909" onMouseOver="hilite(2909)" onMouseOut="lolite()" onClick="logVariable('usql')" href="../../_variables/usql.html">$usql</a>&quot;;
<a name="l1354"><span class="linenum">1354</span></a>              <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l1355"><span class="linenum">1355</span></a>          }
<a name="l1356"><span class="linenum">1356</span></a>  
<a name="l1357"><span class="linenum">1357</span></a>          if (!<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>) {
<a name="l1358"><span class="linenum">1358</span></a>  
<a name="l1359"><span class="linenum">1359</span></a>              if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;grademax != 0 or <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;gradetype != <a class="constant" onClick="logConstant('GRADE_TYPE_VALUE')" href="../../_constants/GRADE_TYPE_VALUE.html" onMouseOver="constPopup(event,'GRADE_TYPE_VALUE')">GRADE_TYPE_VALUE</a>) {
<a name="l1360"><span class="linenum">1360</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;grademax  = 0;
<a name="l1361"><span class="linenum">1361</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;grademin  = 0;
<a name="l1362"><span class="linenum">1362</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;gradetype = <a class="constant" onClick="logConstant('GRADE_TYPE_VALUE')" href="../../_constants/GRADE_TYPE_VALUE.html" onMouseOver="constPopup(event,'GRADE_TYPE_VALUE')">GRADE_TYPE_VALUE</a>;
<a name="l1363"><span class="linenum">1363</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>('aggregation');
<a name="l1364"><span class="linenum">1364</span></a>              }
<a name="l1365"><span class="linenum">1365</span></a>              return;
<a name="l1366"><span class="linenum">1366</span></a>          }
<a name="l1367"><span class="linenum">1367</span></a>  
<a name="l1368"><span class="linenum">1368</span></a>  <span class="comment">        //find max grade possible</span>
<a name="l1369"><span class="linenum">1369</span></a>          <a class="var it33713" onMouseOver="hilite(33713)" onMouseOut="lolite()" onClick="logVariable('maxes')" href="../../_variables/maxes.html">$maxes</a> = array();
<a name="l1370"><span class="linenum">1370</span></a>  
<a name="l1371"><span class="linenum">1371</span></a>          foreach (<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a> as <a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>) {
<a name="l1372"><span class="linenum">1372</span></a>  
<a name="l1373"><span class="linenum">1373</span></a>              if (<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>-&gt;<a onClick="logVariable('aggregationcoef')" class="var it39599" onMouseOver="hilite(39599)" onMouseOut="lolite()" href="../../_variables/aggregationcoef.html">aggregationcoef</a> &gt; 0) {
<a name="l1374"><span class="linenum">1374</span></a>  <span class="comment">                // extra credit from this activity - does not affect total</span>
<a name="l1375"><span class="linenum">1375</span></a>                  continue;
<a name="l1376"><span class="linenum">1376</span></a>              } else if (<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>-&gt;<a onClick="logVariable('aggregationcoef2')" class="var it39599" onMouseOver="hilite(39599)" onMouseOut="lolite()" href="../../_variables/aggregationcoef2.html">aggregationcoef2</a> &lt;= 0) {
<a name="l1377"><span class="linenum">1377</span></a>  <span class="comment">                // Items with a weight of 0 do not affect the total.</span>
<a name="l1378"><span class="linenum">1378</span></a>                  continue;
<a name="l1379"><span class="linenum">1379</span></a>              }
<a name="l1380"><span class="linenum">1380</span></a>  
<a name="l1381"><span class="linenum">1381</span></a>              if (<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>-&gt;<a onClick="logVariable('gradetype')" class="var it39599" onMouseOver="hilite(39599)" onMouseOut="lolite()" href="../../_variables/gradetype.html">gradetype</a> == <a class="constant" onClick="logConstant('GRADE_TYPE_VALUE')" href="../../_constants/GRADE_TYPE_VALUE.html" onMouseOver="constPopup(event,'GRADE_TYPE_VALUE')">GRADE_TYPE_VALUE</a>) {
<a name="l1382"><span class="linenum">1382</span></a>                  <a class="var it33713" onMouseOver="hilite(33713)" onMouseOut="lolite()" onClick="logVariable('maxes')" href="../../_variables/maxes.html">$maxes</a>[<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>-&gt;<a onClick="logVariable('id')" class="var it39599" onMouseOver="hilite(39599)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>] = <a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>-&gt;<a onClick="logVariable('grademax')" class="var it39599" onMouseOver="hilite(39599)" onMouseOut="lolite()" href="../../_variables/grademax.html">grademax</a>;
<a name="l1383"><span class="linenum">1383</span></a>  
<a name="l1384"><span class="linenum">1384</span></a>              } else if (<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>-&gt;<a onClick="logVariable('gradetype')" class="var it39599" onMouseOver="hilite(39599)" onMouseOut="lolite()" href="../../_variables/gradetype.html">gradetype</a> == <a class="constant" onClick="logConstant('GRADE_TYPE_SCALE')" href="../../_constants/GRADE_TYPE_SCALE.html" onMouseOver="constPopup(event,'GRADE_TYPE_SCALE')">GRADE_TYPE_SCALE</a>) {
<a name="l1385"><span class="linenum">1385</span></a>                  <a class="var it33713" onMouseOver="hilite(33713)" onMouseOut="lolite()" onClick="logVariable('maxes')" href="../../_variables/maxes.html">$maxes</a>[<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>-&gt;<a onClick="logVariable('id')" class="var it39599" onMouseOver="hilite(39599)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>] = <a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>-&gt;<a onClick="logVariable('grademax')" class="var it39599" onMouseOver="hilite(39599)" onMouseOut="lolite()" href="../../_variables/grademax.html">grademax</a>; <span class="comment">// 0 = nograde, 1 = first scale item, 2 = second scale item</span>
<a name="l1386"><span class="linenum">1386</span></a>              }
<a name="l1387"><span class="linenum">1387</span></a>          }
<a name="l1388"><span class="linenum">1388</span></a>  
<a name="l1389"><span class="linenum">1389</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('can_apply_limit_rules')" href="../../_functions/can_apply_limit_rules.html" onMouseOver="funcPopup(event,'can_apply_limit_rules')">can_apply_limit_rules</a>()) {
<a name="l1390"><span class="linenum">1390</span></a>  <span class="comment">            // Apply droplow and keephigh.</span>
<a name="l1391"><span class="linenum">1391</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('apply_limit_rules')" href="../../_functions/apply_limit_rules.html" onMouseOver="funcPopup(event,'apply_limit_rules')">apply_limit_rules</a>(<a class="var it33713" onMouseOver="hilite(33713)" onMouseOut="lolite()" onClick="logVariable('maxes')" href="../../_variables/maxes.html">$maxes</a>, <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>);
<a name="l1392"><span class="linenum">1392</span></a>          }
<a name="l1393"><span class="linenum">1393</span></a>          <a class="var it588" onMouseOver="hilite(588)" onMouseOut="lolite()" onClick="logVariable('max')" href="../../_variables/max.html">$max</a> = <a class="phpfunction" onClick="logFunction('array_sum')" href="../../_functions/array_sum.html" onMouseOver="phpfuncPopup(event,'array_sum')">array_sum</a>(<a class="var it33713" onMouseOver="hilite(33713)" onMouseOut="lolite()" onClick="logVariable('maxes')" href="../../_variables/maxes.html">$maxes</a>);
<a name="l1394"><span class="linenum">1394</span></a>  
<a name="l1395"><span class="linenum">1395</span></a>  <span class="comment">        // update db if anything changed</span>
<a name="l1396"><span class="linenum">1396</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;grademax != <a class="var it588" onMouseOver="hilite(588)" onMouseOut="lolite()" onClick="logVariable('max')" href="../../_variables/max.html">$max</a> or <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;grademin != 0 or <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;gradetype != <a class="constant" onClick="logConstant('GRADE_TYPE_VALUE')" href="../../_constants/GRADE_TYPE_VALUE.html" onMouseOver="constPopup(event,'GRADE_TYPE_VALUE')">GRADE_TYPE_VALUE</a>) {
<a name="l1397"><span class="linenum">1397</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;grademax  = <a class="var it588" onMouseOver="hilite(588)" onMouseOut="lolite()" onClick="logVariable('max')" href="../../_variables/max.html">$max</a>;
<a name="l1398"><span class="linenum">1398</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;grademin  = 0;
<a name="l1399"><span class="linenum">1399</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;gradetype = <a class="constant" onClick="logConstant('GRADE_TYPE_VALUE')" href="../../_constants/GRADE_TYPE_VALUE.html" onMouseOver="constPopup(event,'GRADE_TYPE_VALUE')">GRADE_TYPE_VALUE</a>;
<a name="l1400"><span class="linenum">1400</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>('aggregation');
<a name="l1401"><span class="linenum">1401</span></a>          }
<a name="l1402"><span class="linenum">1402</span></a>      }
<a name="l1403"><span class="linenum">1403</span></a>  
<a name="l1404"><span class="linenum">1404</span></a>      <span class="comment">/**</span>
<a name="l1405"><span class="linenum">1405</span></a>  <span class="comment">     * Recalculate the weights of the grade items in this category.</span>
<a name="l1406"><span class="linenum">1406</span></a>  <span class="comment">     *</span>
<a name="l1407"><span class="linenum">1407</span></a>  <span class="comment">     * The category total is not updated here, a further call to</span>
<a name="l1408"><span class="linenum">1408</span></a>  <span class="comment">     * {@link self::auto_update_max()} is required.</span>
<a name="l1409"><span class="linenum">1409</span></a>  <span class="comment">     *</span>
<a name="l1410"><span class="linenum">1410</span></a>  <span class="comment">     * @return void</span>
<a name="l1411"><span class="linenum">1411</span></a>  <span class="comment">     */</span>
<a name="l1412"><span class="linenum">1412</span></a>      private function <a class="function" onClick="logFunction('auto_update_weights')" href="../../_functions/auto_update_weights.html" onMouseOver="funcPopup(event,'auto_update_weights')">auto_update_weights</a>() {
<a name="l1413"><span class="linenum">1413</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l1414"><span class="linenum">1414</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregation')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregation.html">aggregation</a> != <a class="constant" onClick="logConstant('GRADE_AGGREGATE_SUM')" href="../../_constants/GRADE_AGGREGATE_SUM.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_SUM')">GRADE_AGGREGATE_SUM</a>) {
<a name="l1415"><span class="linenum">1415</span></a>  <span class="comment">            // This is only required if we are using natural weights.</span>
<a name="l1416"><span class="linenum">1416</span></a>              return;
<a name="l1417"><span class="linenum">1417</span></a>          }
<a name="l1418"><span class="linenum">1418</span></a>          <a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_children')" href="../../_functions/get_children.html" onMouseOver="funcPopup(event,'get_children')">get_children</a>();
<a name="l1419"><span class="linenum">1419</span></a>  
<a name="l1420"><span class="linenum">1420</span></a>          <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a> = null;
<a name="l1421"><span class="linenum">1421</span></a>  
<a name="l1422"><span class="linenum">1422</span></a>  <span class="comment">        // Calculate the sum of the grademax's of all the items within this category.</span>
<a name="l1423"><span class="linenum">1423</span></a>          <a class="var it33714" onMouseOver="hilite(33714)" onMouseOut="lolite()" onClick="logVariable('totalnonoverriddengrademax')" href="../../_variables/totalnonoverriddengrademax.html">$totalnonoverriddengrademax</a> = 0;
<a name="l1424"><span class="linenum">1424</span></a>          <a class="var it33715" onMouseOver="hilite(33715)" onMouseOut="lolite()" onClick="logVariable('totalgrademax')" href="../../_variables/totalgrademax.html">$totalgrademax</a> = 0;
<a name="l1425"><span class="linenum">1425</span></a>  
<a name="l1426"><span class="linenum">1426</span></a>  <span class="comment">        // Out of 1, how much weight has been manually overriden by a user?</span>
<a name="l1427"><span class="linenum">1427</span></a>          <a class="var it33706" onMouseOver="hilite(33706)" onMouseOut="lolite()" onClick="logVariable('totaloverriddenweight')" href="../../_variables/totaloverriddenweight.html">$totaloverriddenweight</a>  = 0;
<a name="l1428"><span class="linenum">1428</span></a>          <a class="var it33707" onMouseOver="hilite(33707)" onMouseOut="lolite()" onClick="logVariable('totaloverriddengrademax')" href="../../_variables/totaloverriddengrademax.html">$totaloverriddengrademax</a>  = 0;
<a name="l1429"><span class="linenum">1429</span></a>  
<a name="l1430"><span class="linenum">1430</span></a>  <span class="comment">        // Has every assessment in this category been overridden?</span>
<a name="l1431"><span class="linenum">1431</span></a>          <a class="var it33716" onMouseOver="hilite(33716)" onMouseOut="lolite()" onClick="logVariable('automaticgradeitemspresent')" href="../../_variables/automaticgradeitemspresent.html">$automaticgradeitemspresent</a> = false;
<a name="l1432"><span class="linenum">1432</span></a>  <span class="comment">        // Does the grade item require normalising?</span>
<a name="l1433"><span class="linenum">1433</span></a>          <a class="var it33717" onMouseOver="hilite(33717)" onMouseOut="lolite()" onClick="logVariable('requiresnormalising')" href="../../_variables/requiresnormalising.html">$requiresnormalising</a> = false;
<a name="l1434"><span class="linenum">1434</span></a>  
<a name="l1435"><span class="linenum">1435</span></a>  <span class="comment">        // This array keeps track of the id and weight of every grade item that has been overridden.</span>
<a name="l1436"><span class="linenum">1436</span></a>          <a class="var it33718" onMouseOver="hilite(33718)" onMouseOut="lolite()" onClick="logVariable('overridearray')" href="../../_variables/overridearray.html">$overridearray</a> = array();
<a name="l1437"><span class="linenum">1437</span></a>          foreach (<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a> as <a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a> =&gt; <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>) {
<a name="l1438"><span class="linenum">1438</span></a>              <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a> = null;
<a name="l1439"><span class="linenum">1439</span></a>  
<a name="l1440"><span class="linenum">1440</span></a>              if (<a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>['type'] == 'item') {
<a name="l1441"><span class="linenum">1441</span></a>                  <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a> = <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>['object'];
<a name="l1442"><span class="linenum">1442</span></a>              } else if (<a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>['type'] == 'category') {
<a name="l1443"><span class="linenum">1443</span></a>                  <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a> = <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>['object']-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l1444"><span class="linenum">1444</span></a>              }
<a name="l1445"><span class="linenum">1445</span></a>  
<a name="l1446"><span class="linenum">1446</span></a>              if (<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('gradetype')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/gradetype.html">gradetype</a> == <a class="constant" onClick="logConstant('GRADE_TYPE_NONE')" href="../../_constants/GRADE_TYPE_NONE.html" onMouseOver="constPopup(event,'GRADE_TYPE_NONE')">GRADE_TYPE_NONE</a> || <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('gradetype')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/gradetype.html">gradetype</a> == <a class="constant" onClick="logConstant('GRADE_TYPE_TEXT')" href="../../_constants/GRADE_TYPE_TEXT.html" onMouseOver="constPopup(event,'GRADE_TYPE_TEXT')">GRADE_TYPE_TEXT</a>) {
<a name="l1447"><span class="linenum">1447</span></a>  <span class="comment">                // Text items and none items do not have a weight.</span>
<a name="l1448"><span class="linenum">1448</span></a>                  continue;
<a name="l1449"><span class="linenum">1449</span></a>              } else if (!<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregateoutcomes')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregateoutcomes.html">aggregateoutcomes</a> &amp;&amp; <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a class="function" onClick="logFunction('is_outcome_item')" href="../../_functions/is_outcome_item.html" onMouseOver="funcPopup(event,'is_outcome_item')">is_outcome_item</a>()) {
<a name="l1450"><span class="linenum">1450</span></a>  <span class="comment">                // We will not aggregate outcome items, so we can ignore them.</span>
<a name="l1451"><span class="linenum">1451</span></a>                  continue;
<a name="l1452"><span class="linenum">1452</span></a>              } else if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('grade_includescalesinaggregation')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/grade_includescalesinaggregation.html">grade_includescalesinaggregation</a>) &amp;&amp; <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('gradetype')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/gradetype.html">gradetype</a> == <a class="constant" onClick="logConstant('GRADE_TYPE_SCALE')" href="../../_constants/GRADE_TYPE_SCALE.html" onMouseOver="constPopup(event,'GRADE_TYPE_SCALE')">GRADE_TYPE_SCALE</a>) {
<a name="l1453"><span class="linenum">1453</span></a>  <span class="comment">                // The scales are not included in the aggregation, ignore them.</span>
<a name="l1454"><span class="linenum">1454</span></a>                  continue;
<a name="l1455"><span class="linenum">1455</span></a>              }
<a name="l1456"><span class="linenum">1456</span></a>  
<a name="l1457"><span class="linenum">1457</span></a>  <span class="comment">            // Record the ID and the weight for this grade item.</span>
<a name="l1458"><span class="linenum">1458</span></a>              <a class="var it33718" onMouseOver="hilite(33718)" onMouseOut="lolite()" onClick="logVariable('overridearray')" href="../../_variables/overridearray.html">$overridearray</a>[<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('id')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>] = array();
<a name="l1459"><span class="linenum">1459</span></a>              <a class="var it33718" onMouseOver="hilite(33718)" onMouseOut="lolite()" onClick="logVariable('overridearray')" href="../../_variables/overridearray.html">$overridearray</a>[<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('id')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>]['extracredit'] = <a class="phpfunction" onClick="logFunction('intval')" href="../../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>(<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('aggregationcoef')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/aggregationcoef.html">aggregationcoef</a>);
<a name="l1460"><span class="linenum">1460</span></a>              <a class="var it33718" onMouseOver="hilite(33718)" onMouseOut="lolite()" onClick="logVariable('overridearray')" href="../../_variables/overridearray.html">$overridearray</a>[<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('id')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>]['weight'] = <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('aggregationcoef2')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/aggregationcoef2.html">aggregationcoef2</a>;
<a name="l1461"><span class="linenum">1461</span></a>              <a class="var it33718" onMouseOver="hilite(33718)" onMouseOut="lolite()" onClick="logVariable('overridearray')" href="../../_variables/overridearray.html">$overridearray</a>[<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('id')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>]['weightoverride'] = <a class="phpfunction" onClick="logFunction('intval')" href="../../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>(<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('weightoverride')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/weightoverride.html">weightoverride</a>);
<a name="l1462"><span class="linenum">1462</span></a>  <span class="comment">            // If this item has had its weight overridden then set the flag to true, but</span>
<a name="l1463"><span class="linenum">1463</span></a>  <span class="comment">            // only if all previous items were also overridden. Note that extra credit items</span>
<a name="l1464"><span class="linenum">1464</span></a>  <span class="comment">            // are counted as overridden grade items.</span>
<a name="l1465"><span class="linenum">1465</span></a>              if (!<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('weightoverride')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/weightoverride.html">weightoverride</a> &amp;&amp; <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('aggregationcoef')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/aggregationcoef.html">aggregationcoef</a> == 0) {
<a name="l1466"><span class="linenum">1466</span></a>                  <a class="var it33716" onMouseOver="hilite(33716)" onMouseOut="lolite()" onClick="logVariable('automaticgradeitemspresent')" href="../../_variables/automaticgradeitemspresent.html">$automaticgradeitemspresent</a> = true;
<a name="l1467"><span class="linenum">1467</span></a>              }
<a name="l1468"><span class="linenum">1468</span></a>  
<a name="l1469"><span class="linenum">1469</span></a>              if (<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('aggregationcoef')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/aggregationcoef.html">aggregationcoef</a> &gt; 0) {
<a name="l1470"><span class="linenum">1470</span></a>  <span class="comment">                // An extra credit grade item doesn't contribute to $totaloverriddengrademax.</span>
<a name="l1471"><span class="linenum">1471</span></a>                  continue;
<a name="l1472"><span class="linenum">1472</span></a>              } else if (<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('weightoverride')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/weightoverride.html">weightoverride</a> &gt; 0 &amp;&amp; <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('aggregationcoef2')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/aggregationcoef2.html">aggregationcoef2</a> &lt;= 0) {
<a name="l1473"><span class="linenum">1473</span></a>  <span class="comment">                // An overriden item that defines a weight of 0 does not contribute to $totaloverriddengrademax.</span>
<a name="l1474"><span class="linenum">1474</span></a>                  continue;
<a name="l1475"><span class="linenum">1475</span></a>              }
<a name="l1476"><span class="linenum">1476</span></a>  
<a name="l1477"><span class="linenum">1477</span></a>              <a class="var it33715" onMouseOver="hilite(33715)" onMouseOut="lolite()" onClick="logVariable('totalgrademax')" href="../../_variables/totalgrademax.html">$totalgrademax</a> += <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('grademax')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/grademax.html">grademax</a>;
<a name="l1478"><span class="linenum">1478</span></a>              if (<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('weightoverride')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/weightoverride.html">weightoverride</a> &gt; 0) {
<a name="l1479"><span class="linenum">1479</span></a>                  <a class="var it33706" onMouseOver="hilite(33706)" onMouseOut="lolite()" onClick="logVariable('totaloverriddenweight')" href="../../_variables/totaloverriddenweight.html">$totaloverriddenweight</a> += <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('aggregationcoef2')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/aggregationcoef2.html">aggregationcoef2</a>;
<a name="l1480"><span class="linenum">1480</span></a>                  <a class="var it33707" onMouseOver="hilite(33707)" onMouseOut="lolite()" onClick="logVariable('totaloverriddengrademax')" href="../../_variables/totaloverriddengrademax.html">$totaloverriddengrademax</a> += <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('grademax')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/grademax.html">grademax</a>;
<a name="l1481"><span class="linenum">1481</span></a>              }
<a name="l1482"><span class="linenum">1482</span></a>          }
<a name="l1483"><span class="linenum">1483</span></a>  
<a name="l1484"><span class="linenum">1484</span></a>  <span class="comment">        // Initialise this variable (used to keep track of the weight override total).</span>
<a name="l1485"><span class="linenum">1485</span></a>          <a class="var it33719" onMouseOver="hilite(33719)" onMouseOut="lolite()" onClick="logVariable('normalisetotal')" href="../../_variables/normalisetotal.html">$normalisetotal</a> = 0;
<a name="l1486"><span class="linenum">1486</span></a>  <span class="comment">        // Keep a record of how much the override total is to see if it is above 100. It it is then we need to set the</span>
<a name="l1487"><span class="linenum">1487</span></a>  <span class="comment">        // other weights to zero and normalise the others.</span>
<a name="l1488"><span class="linenum">1488</span></a>          <a class="var it33720" onMouseOver="hilite(33720)" onMouseOut="lolite()" onClick="logVariable('overriddentotal')" href="../../_variables/overriddentotal.html">$overriddentotal</a> = 0;
<a name="l1489"><span class="linenum">1489</span></a>  <span class="comment">        // If the overridden weight total is higher than 1 then set the other untouched weights to zero.</span>
<a name="l1490"><span class="linenum">1490</span></a>          <a class="var it33721" onMouseOver="hilite(33721)" onMouseOut="lolite()" onClick="logVariable('setotherweightstozero')" href="../../_variables/setotherweightstozero.html">$setotherweightstozero</a> = false;
<a name="l1491"><span class="linenum">1491</span></a>  <span class="comment">        // Total up all of the weights.</span>
<a name="l1492"><span class="linenum">1492</span></a>          foreach (<a class="var it33718" onMouseOver="hilite(33718)" onMouseOut="lolite()" onClick="logVariable('overridearray')" href="../../_variables/overridearray.html">$overridearray</a> as <a class="var it33722" onMouseOver="hilite(33722)" onMouseOut="lolite()" onClick="logVariable('gradeitemdetail')" href="../../_variables/gradeitemdetail.html">$gradeitemdetail</a>) {
<a name="l1493"><span class="linenum">1493</span></a>  <span class="comment">            // If the grade item has extra credit, then don't add it to the normalisetotal.</span>
<a name="l1494"><span class="linenum">1494</span></a>              if (!<a class="var it33722" onMouseOver="hilite(33722)" onMouseOut="lolite()" onClick="logVariable('gradeitemdetail')" href="../../_variables/gradeitemdetail.html">$gradeitemdetail</a>['extracredit']) {
<a name="l1495"><span class="linenum">1495</span></a>                  <a class="var it33719" onMouseOver="hilite(33719)" onMouseOut="lolite()" onClick="logVariable('normalisetotal')" href="../../_variables/normalisetotal.html">$normalisetotal</a> += <a class="var it33722" onMouseOver="hilite(33722)" onMouseOut="lolite()" onClick="logVariable('gradeitemdetail')" href="../../_variables/gradeitemdetail.html">$gradeitemdetail</a>['weight'];
<a name="l1496"><span class="linenum">1496</span></a>              }
<a name="l1497"><span class="linenum">1497</span></a>  <span class="comment">            // The overridden total comprises of items that are set as overridden, that aren't extra credit and have a value</span>
<a name="l1498"><span class="linenum">1498</span></a>  <span class="comment">            // greater than zero.</span>
<a name="l1499"><span class="linenum">1499</span></a>              if (<a class="var it33722" onMouseOver="hilite(33722)" onMouseOut="lolite()" onClick="logVariable('gradeitemdetail')" href="../../_variables/gradeitemdetail.html">$gradeitemdetail</a>['weightoverride'] &amp;&amp; !<a class="var it33722" onMouseOver="hilite(33722)" onMouseOut="lolite()" onClick="logVariable('gradeitemdetail')" href="../../_variables/gradeitemdetail.html">$gradeitemdetail</a>['extracredit'] &amp;&amp; <a class="var it33722" onMouseOver="hilite(33722)" onMouseOut="lolite()" onClick="logVariable('gradeitemdetail')" href="../../_variables/gradeitemdetail.html">$gradeitemdetail</a>['weight'] &gt; 0) {
<a name="l1500"><span class="linenum">1500</span></a>  <span class="comment">                // Add overriden weights up to see if they are greater than 1.</span>
<a name="l1501"><span class="linenum">1501</span></a>                  <a class="var it33720" onMouseOver="hilite(33720)" onMouseOut="lolite()" onClick="logVariable('overriddentotal')" href="../../_variables/overriddentotal.html">$overriddentotal</a> += <a class="var it33722" onMouseOver="hilite(33722)" onMouseOut="lolite()" onClick="logVariable('gradeitemdetail')" href="../../_variables/gradeitemdetail.html">$gradeitemdetail</a>['weight'];
<a name="l1502"><span class="linenum">1502</span></a>              }
<a name="l1503"><span class="linenum">1503</span></a>          }
<a name="l1504"><span class="linenum">1504</span></a>          if (<a class="var it33720" onMouseOver="hilite(33720)" onMouseOut="lolite()" onClick="logVariable('overriddentotal')" href="../../_variables/overriddentotal.html">$overriddentotal</a> &gt; 1) {
<a name="l1505"><span class="linenum">1505</span></a>  <span class="comment">            // Make sure that this catergory of weights gets normalised.</span>
<a name="l1506"><span class="linenum">1506</span></a>              <a class="var it33717" onMouseOver="hilite(33717)" onMouseOut="lolite()" onClick="logVariable('requiresnormalising')" href="../../_variables/requiresnormalising.html">$requiresnormalising</a> = true;
<a name="l1507"><span class="linenum">1507</span></a>  <span class="comment">            // The normalised weights are only the overridden weights, so we just use the total of those.</span>
<a name="l1508"><span class="linenum">1508</span></a>              <a class="var it33719" onMouseOver="hilite(33719)" onMouseOut="lolite()" onClick="logVariable('normalisetotal')" href="../../_variables/normalisetotal.html">$normalisetotal</a> = <a class="var it33720" onMouseOver="hilite(33720)" onMouseOut="lolite()" onClick="logVariable('overriddentotal')" href="../../_variables/overriddentotal.html">$overriddentotal</a>;
<a name="l1509"><span class="linenum">1509</span></a>          }
<a name="l1510"><span class="linenum">1510</span></a>  
<a name="l1511"><span class="linenum">1511</span></a>          <a class="var it33714" onMouseOver="hilite(33714)" onMouseOut="lolite()" onClick="logVariable('totalnonoverriddengrademax')" href="../../_variables/totalnonoverriddengrademax.html">$totalnonoverriddengrademax</a> = <a class="var it33715" onMouseOver="hilite(33715)" onMouseOut="lolite()" onClick="logVariable('totalgrademax')" href="../../_variables/totalgrademax.html">$totalgrademax</a> - <a class="var it33707" onMouseOver="hilite(33707)" onMouseOut="lolite()" onClick="logVariable('totaloverriddengrademax')" href="../../_variables/totaloverriddengrademax.html">$totaloverriddengrademax</a>;
<a name="l1512"><span class="linenum">1512</span></a>  
<a name="l1513"><span class="linenum">1513</span></a>          <a class="phpfunction" onClick="logFunction('reset')" href="../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a>);
<a name="l1514"><span class="linenum">1514</span></a>          foreach (<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a> as <a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a> =&gt; <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>) {
<a name="l1515"><span class="linenum">1515</span></a>              <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a> = null;
<a name="l1516"><span class="linenum">1516</span></a>  
<a name="l1517"><span class="linenum">1517</span></a>              if (<a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>['type'] == 'item') {
<a name="l1518"><span class="linenum">1518</span></a>                  <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a> = <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>['object'];
<a name="l1519"><span class="linenum">1519</span></a>              } else if (<a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>['type'] == 'category') {
<a name="l1520"><span class="linenum">1520</span></a>                  <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a> = <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>['object']-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l1521"><span class="linenum">1521</span></a>              }
<a name="l1522"><span class="linenum">1522</span></a>  
<a name="l1523"><span class="linenum">1523</span></a>              if (<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('gradetype')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/gradetype.html">gradetype</a> == <a class="constant" onClick="logConstant('GRADE_TYPE_NONE')" href="../../_constants/GRADE_TYPE_NONE.html" onMouseOver="constPopup(event,'GRADE_TYPE_NONE')">GRADE_TYPE_NONE</a> || <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('gradetype')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/gradetype.html">gradetype</a> == <a class="constant" onClick="logConstant('GRADE_TYPE_TEXT')" href="../../_constants/GRADE_TYPE_TEXT.html" onMouseOver="constPopup(event,'GRADE_TYPE_TEXT')">GRADE_TYPE_TEXT</a>) {
<a name="l1524"><span class="linenum">1524</span></a>  <span class="comment">                // Text items and none items do not have a weight, no need to set their weight to</span>
<a name="l1525"><span class="linenum">1525</span></a>  <span class="comment">                // zero as they must never be used during aggregation.</span>
<a name="l1526"><span class="linenum">1526</span></a>                  continue;
<a name="l1527"><span class="linenum">1527</span></a>              } else if (!<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregateoutcomes')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregateoutcomes.html">aggregateoutcomes</a> &amp;&amp; <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a class="function" onClick="logFunction('is_outcome_item')" href="../../_functions/is_outcome_item.html" onMouseOver="funcPopup(event,'is_outcome_item')">is_outcome_item</a>()) {
<a name="l1528"><span class="linenum">1528</span></a>  <span class="comment">                // We will not aggregate outcome items, so we can ignore updating their weights.</span>
<a name="l1529"><span class="linenum">1529</span></a>                  continue;
<a name="l1530"><span class="linenum">1530</span></a>              } else if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('grade_includescalesinaggregation')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/grade_includescalesinaggregation.html">grade_includescalesinaggregation</a>) &amp;&amp; <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('gradetype')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/gradetype.html">gradetype</a> == <a class="constant" onClick="logConstant('GRADE_TYPE_SCALE')" href="../../_constants/GRADE_TYPE_SCALE.html" onMouseOver="constPopup(event,'GRADE_TYPE_SCALE')">GRADE_TYPE_SCALE</a>) {
<a name="l1531"><span class="linenum">1531</span></a>  <span class="comment">                // We will not aggregate the scales, so we can ignore upating their weights.</span>
<a name="l1532"><span class="linenum">1532</span></a>                  continue;
<a name="l1533"><span class="linenum">1533</span></a>              }
<a name="l1534"><span class="linenum">1534</span></a>  
<a name="l1535"><span class="linenum">1535</span></a>              if (!<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('weightoverride')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/weightoverride.html">weightoverride</a>) {
<a name="l1536"><span class="linenum">1536</span></a>  <span class="comment">                // Calculations with a grade maximum of zero will cause problems. Just set the weight to zero.</span>
<a name="l1537"><span class="linenum">1537</span></a>                  if (<a class="var it33706" onMouseOver="hilite(33706)" onMouseOut="lolite()" onClick="logVariable('totaloverriddenweight')" href="../../_variables/totaloverriddenweight.html">$totaloverriddenweight</a> &gt;= 1 || <a class="var it33714" onMouseOver="hilite(33714)" onMouseOut="lolite()" onClick="logVariable('totalnonoverriddengrademax')" href="../../_variables/totalnonoverriddengrademax.html">$totalnonoverriddengrademax</a> == 0 || <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('grademax')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/grademax.html">grademax</a> == 0) {
<a name="l1538"><span class="linenum">1538</span></a>  <span class="comment">                    // There is no more weight to distribute.</span>
<a name="l1539"><span class="linenum">1539</span></a>                      <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('aggregationcoef2')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/aggregationcoef2.html">aggregationcoef2</a> = 0;
<a name="l1540"><span class="linenum">1540</span></a>                  } else {
<a name="l1541"><span class="linenum">1541</span></a>  <span class="comment">                    // Calculate this item's weight as a percentage of the non-overridden total grade maxes</span>
<a name="l1542"><span class="linenum">1542</span></a>  <span class="comment">                    // then convert it to a proportion of the available non-overriden weight.</span>
<a name="l1543"><span class="linenum">1543</span></a>                      <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('aggregationcoef2')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/aggregationcoef2.html">aggregationcoef2</a> = (<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('grademax')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/grademax.html">grademax</a>/<a class="var it33714" onMouseOver="hilite(33714)" onMouseOut="lolite()" onClick="logVariable('totalnonoverriddengrademax')" href="../../_variables/totalnonoverriddengrademax.html">$totalnonoverriddengrademax</a>) *
<a name="l1544"><span class="linenum">1544</span></a>                              (1 - <a class="var it33706" onMouseOver="hilite(33706)" onMouseOut="lolite()" onClick="logVariable('totaloverriddenweight')" href="../../_variables/totaloverriddenweight.html">$totaloverriddenweight</a>);
<a name="l1545"><span class="linenum">1545</span></a>                  }
<a name="l1546"><span class="linenum">1546</span></a>                  <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>();
<a name="l1547"><span class="linenum">1547</span></a>              } else if ((!<a class="var it33716" onMouseOver="hilite(33716)" onMouseOut="lolite()" onClick="logVariable('automaticgradeitemspresent')" href="../../_variables/automaticgradeitemspresent.html">$automaticgradeitemspresent</a> &amp;&amp; <a class="var it33719" onMouseOver="hilite(33719)" onMouseOut="lolite()" onClick="logVariable('normalisetotal')" href="../../_variables/normalisetotal.html">$normalisetotal</a> != 1) || (<a class="var it33717" onMouseOver="hilite(33717)" onMouseOut="lolite()" onClick="logVariable('requiresnormalising')" href="../../_variables/requiresnormalising.html">$requiresnormalising</a>)
<a name="l1548"><span class="linenum">1548</span></a>                      || <a class="var it33718" onMouseOver="hilite(33718)" onMouseOut="lolite()" onClick="logVariable('overridearray')" href="../../_variables/overridearray.html">$overridearray</a>[<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('id')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>]['weight'] &lt; 0) {
<a name="l1549"><span class="linenum">1549</span></a>  <span class="comment">                // Just divide the overriden weight for this item against the total weight override of all</span>
<a name="l1550"><span class="linenum">1550</span></a>  <span class="comment">                // items in this category.</span>
<a name="l1551"><span class="linenum">1551</span></a>                  if (<a class="var it33719" onMouseOver="hilite(33719)" onMouseOut="lolite()" onClick="logVariable('normalisetotal')" href="../../_variables/normalisetotal.html">$normalisetotal</a> == 0 || <a class="var it33718" onMouseOver="hilite(33718)" onMouseOut="lolite()" onClick="logVariable('overridearray')" href="../../_variables/overridearray.html">$overridearray</a>[<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('id')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>]['weight'] &lt; 0) {
<a name="l1552"><span class="linenum">1552</span></a>  <span class="comment">                    // If the normalised total equals zero, or the weight value is less than zero,</span>
<a name="l1553"><span class="linenum">1553</span></a>  <span class="comment">                    // set the weight for the grade item to zero.</span>
<a name="l1554"><span class="linenum">1554</span></a>                      <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('aggregationcoef2')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/aggregationcoef2.html">aggregationcoef2</a> = 0;
<a name="l1555"><span class="linenum">1555</span></a>                  } else {
<a name="l1556"><span class="linenum">1556</span></a>                      <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('aggregationcoef2')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/aggregationcoef2.html">aggregationcoef2</a> = <a class="var it33718" onMouseOver="hilite(33718)" onMouseOut="lolite()" onClick="logVariable('overridearray')" href="../../_variables/overridearray.html">$overridearray</a>[<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('id')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>]['weight'] / <a class="var it33719" onMouseOver="hilite(33719)" onMouseOut="lolite()" onClick="logVariable('normalisetotal')" href="../../_variables/normalisetotal.html">$normalisetotal</a>;
<a name="l1557"><span class="linenum">1557</span></a>                  }
<a name="l1558"><span class="linenum">1558</span></a>  <span class="comment">                // Update the grade item to reflect these changes.</span>
<a name="l1559"><span class="linenum">1559</span></a>                  <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>();
<a name="l1560"><span class="linenum">1560</span></a>              }
<a name="l1561"><span class="linenum">1561</span></a>          }
<a name="l1562"><span class="linenum">1562</span></a>      }
<a name="l1563"><span class="linenum">1563</span></a>  
<a name="l1564"><span class="linenum">1564</span></a>      <span class="comment">/**</span>
<a name="l1565"><span class="linenum">1565</span></a>  <span class="comment">     * Given an array of grade values (numerical indices) applies droplow or keephigh rules to limit the final array.</span>
<a name="l1566"><span class="linenum">1566</span></a>  <span class="comment">     *</span>
<a name="l1567"><span class="linenum">1567</span></a>  <span class="comment">     * @param array $grade_values itemid=&gt;$grade_value float</span>
<a name="l1568"><span class="linenum">1568</span></a>  <span class="comment">     * @param array $items grade item objects</span>
<a name="l1569"><span class="linenum">1569</span></a>  <span class="comment">     * @return array Limited grades.</span>
<a name="l1570"><span class="linenum">1570</span></a>  <span class="comment">     */</span>
<a name="l1571"><span class="linenum">1571</span></a>      public function <a class="function" onClick="logFunction('apply_limit_rules')" href="../../_functions/apply_limit_rules.html" onMouseOver="funcPopup(event,'apply_limit_rules')">apply_limit_rules</a>(&amp;<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>, <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>) {
<a name="l1572"><span class="linenum">1572</span></a>          <a class="var it33723" onMouseOver="hilite(33723)" onMouseOut="lolite()" onClick="logVariable('extraused')" href="../../_variables/extraused.html">$extraused</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_extracredit_used')" href="../../_functions/is_extracredit_used.html" onMouseOver="funcPopup(event,'is_extracredit_used')">is_extracredit_used</a>();
<a name="l1573"><span class="linenum">1573</span></a>  
<a name="l1574"><span class="linenum">1574</span></a>          if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('droplow')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/droplow.html">droplow</a>)) {
<a name="l1575"><span class="linenum">1575</span></a>              <a class="phpfunction" onClick="logFunction('asort')" href="../../_functions/asort.html" onMouseOver="phpfuncPopup(event,'asort')">asort</a>(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>, SORT_NUMERIC);
<a name="l1576"><span class="linenum">1576</span></a>              <a class="var it33680" onMouseOver="hilite(33680)" onMouseOut="lolite()" onClick="logVariable('dropped')" href="../../_variables/dropped.html">$dropped</a> = 0;
<a name="l1577"><span class="linenum">1577</span></a>  
<a name="l1578"><span class="linenum">1578</span></a>  <span class="comment">            // If we have fewer grade items available to drop than $this-&gt;droplow, use this flag to escape the loop</span>
<a name="l1579"><span class="linenum">1579</span></a>  <span class="comment">            // May occur because of &quot;extra credit&quot; or if droplow is higher than the number of grade items</span>
<a name="l1580"><span class="linenum">1580</span></a>              <a class="var it33724" onMouseOver="hilite(33724)" onMouseOut="lolite()" onClick="logVariable('droppedsomething')" href="../../_variables/droppedsomething.html">$droppedsomething</a> = true;
<a name="l1581"><span class="linenum">1581</span></a>  
<a name="l1582"><span class="linenum">1582</span></a>              while (<a class="var it33680" onMouseOver="hilite(33680)" onMouseOut="lolite()" onClick="logVariable('dropped')" href="../../_variables/dropped.html">$dropped</a> &lt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('droplow')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/droplow.html">droplow</a> &amp;&amp; <a class="var it33724" onMouseOver="hilite(33724)" onMouseOut="lolite()" onClick="logVariable('droppedsomething')" href="../../_variables/droppedsomething.html">$droppedsomething</a>) {
<a name="l1583"><span class="linenum">1583</span></a>                  <a class="var it33724" onMouseOver="hilite(33724)" onMouseOut="lolite()" onClick="logVariable('droppedsomething')" href="../../_variables/droppedsomething.html">$droppedsomething</a> = false;
<a name="l1584"><span class="linenum">1584</span></a>  
<a name="l1585"><span class="linenum">1585</span></a>                  <a class="var it33725" onMouseOver="hilite(33725)" onMouseOut="lolite()" onClick="logVariable('grade_keys')" href="../../_variables/grade_keys.html">$grade_keys</a> = <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>);
<a name="l1586"><span class="linenum">1586</span></a>                  <a class="var it33726" onMouseOver="hilite(33726)" onMouseOut="lolite()" onClick="logVariable('gradekeycount')" href="../../_variables/gradekeycount.html">$gradekeycount</a> = <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it33725" onMouseOver="hilite(33725)" onMouseOut="lolite()" onClick="logVariable('grade_keys')" href="../../_variables/grade_keys.html">$grade_keys</a>);
<a name="l1587"><span class="linenum">1587</span></a>  
<a name="l1588"><span class="linenum">1588</span></a>                  if (<a class="var it33726" onMouseOver="hilite(33726)" onMouseOut="lolite()" onClick="logVariable('gradekeycount')" href="../../_variables/gradekeycount.html">$gradekeycount</a> === 0) {
<a name="l1589"><span class="linenum">1589</span></a>  <span class="comment">                    //We've dropped all grade items</span>
<a name="l1590"><span class="linenum">1590</span></a>                      break;
<a name="l1591"><span class="linenum">1591</span></a>                  }
<a name="l1592"><span class="linenum">1592</span></a>  
<a name="l1593"><span class="linenum">1593</span></a>                  <a class="var it33727" onMouseOver="hilite(33727)" onMouseOut="lolite()" onClick="logVariable('originalindex')" href="../../_variables/originalindex.html">$originalindex</a> = <a class="var it33728" onMouseOver="hilite(33728)" onMouseOut="lolite()" onClick="logVariable('founditemid')" href="../../_variables/founditemid.html">$founditemid</a> = <a class="var it33729" onMouseOver="hilite(33729)" onMouseOut="lolite()" onClick="logVariable('foundmax')" href="../../_variables/foundmax.html">$foundmax</a> = null;
<a name="l1594"><span class="linenum">1594</span></a>  
<a name="l1595"><span class="linenum">1595</span></a>  <span class="comment">                // Find the first remaining grade item that is available to be dropped</span>
<a name="l1596"><span class="linenum">1596</span></a>                  foreach (<a class="var it33725" onMouseOver="hilite(33725)" onMouseOut="lolite()" onClick="logVariable('grade_keys')" href="../../_variables/grade_keys.html">$grade_keys</a> as <a class="var it33730" onMouseOver="hilite(33730)" onMouseOut="lolite()" onClick="logVariable('gradekeyindex')" href="../../_variables/gradekeyindex.html">$gradekeyindex</a>=&gt;<a class="var it33731" onMouseOver="hilite(33731)" onMouseOut="lolite()" onClick="logVariable('gradekey')" href="../../_variables/gradekey.html">$gradekey</a>) {
<a name="l1597"><span class="linenum">1597</span></a>                      if (!<a class="var it33723" onMouseOver="hilite(33723)" onMouseOut="lolite()" onClick="logVariable('extraused')" href="../../_variables/extraused.html">$extraused</a> || <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it33731" onMouseOver="hilite(33731)" onMouseOut="lolite()" onClick="logVariable('gradekey')" href="../../_variables/gradekey.html">$gradekey</a>]-&gt;aggregationcoef &lt;= 0) {
<a name="l1598"><span class="linenum">1598</span></a>  <span class="comment">                        // Found a non-extra credit grade item that is eligible to be dropped</span>
<a name="l1599"><span class="linenum">1599</span></a>                          <a class="var it33727" onMouseOver="hilite(33727)" onMouseOut="lolite()" onClick="logVariable('originalindex')" href="../../_variables/originalindex.html">$originalindex</a> = <a class="var it33730" onMouseOver="hilite(33730)" onMouseOut="lolite()" onClick="logVariable('gradekeyindex')" href="../../_variables/gradekeyindex.html">$gradekeyindex</a>;
<a name="l1600"><span class="linenum">1600</span></a>                          <a class="var it33728" onMouseOver="hilite(33728)" onMouseOut="lolite()" onClick="logVariable('founditemid')" href="../../_variables/founditemid.html">$founditemid</a> = <a class="var it33725" onMouseOver="hilite(33725)" onMouseOut="lolite()" onClick="logVariable('grade_keys')" href="../../_variables/grade_keys.html">$grade_keys</a>[<a class="var it33727" onMouseOver="hilite(33727)" onMouseOut="lolite()" onClick="logVariable('originalindex')" href="../../_variables/originalindex.html">$originalindex</a>];
<a name="l1601"><span class="linenum">1601</span></a>                          <a class="var it33729" onMouseOver="hilite(33729)" onMouseOut="lolite()" onClick="logVariable('foundmax')" href="../../_variables/foundmax.html">$foundmax</a> = <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it33728" onMouseOver="hilite(33728)" onMouseOut="lolite()" onClick="logVariable('founditemid')" href="../../_variables/founditemid.html">$founditemid</a>]-&gt;grademax;
<a name="l1602"><span class="linenum">1602</span></a>                          break;
<a name="l1603"><span class="linenum">1603</span></a>                      }
<a name="l1604"><span class="linenum">1604</span></a>                  }
<a name="l1605"><span class="linenum">1605</span></a>  
<a name="l1606"><span class="linenum">1606</span></a>                  if (empty(<a class="var it33728" onMouseOver="hilite(33728)" onMouseOut="lolite()" onClick="logVariable('founditemid')" href="../../_variables/founditemid.html">$founditemid</a>)) {
<a name="l1607"><span class="linenum">1607</span></a>  <span class="comment">                    // No grade items available to drop</span>
<a name="l1608"><span class="linenum">1608</span></a>                      break;
<a name="l1609"><span class="linenum">1609</span></a>                  }
<a name="l1610"><span class="linenum">1610</span></a>  
<a name="l1611"><span class="linenum">1611</span></a>  <span class="comment">                // Now iterate over the remaining grade items</span>
<a name="l1612"><span class="linenum">1612</span></a>  <span class="comment">                // We're looking for other grade items with the same grade value but a higher grademax</span>
<a name="l1613"><span class="linenum">1613</span></a>                  <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> = 1;
<a name="l1614"><span class="linenum">1614</span></a>                  while (<a class="var it33727" onMouseOver="hilite(33727)" onMouseOut="lolite()" onClick="logVariable('originalindex')" href="../../_variables/originalindex.html">$originalindex</a> + <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> &lt; <a class="var it33726" onMouseOver="hilite(33726)" onMouseOut="lolite()" onClick="logVariable('gradekeycount')" href="../../_variables/gradekeycount.html">$gradekeycount</a>) {
<a name="l1615"><span class="linenum">1615</span></a>  
<a name="l1616"><span class="linenum">1616</span></a>                      <a class="var it33732" onMouseOver="hilite(33732)" onMouseOut="lolite()" onClick="logVariable('possibleitemid')" href="../../_variables/possibleitemid.html">$possibleitemid</a> = <a class="var it33725" onMouseOver="hilite(33725)" onMouseOut="lolite()" onClick="logVariable('grade_keys')" href="../../_variables/grade_keys.html">$grade_keys</a>[<a class="var it33727" onMouseOver="hilite(33727)" onMouseOut="lolite()" onClick="logVariable('originalindex')" href="../../_variables/originalindex.html">$originalindex</a>+<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>];
<a name="l1617"><span class="linenum">1617</span></a>                      <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>++;
<a name="l1618"><span class="linenum">1618</span></a>  
<a name="l1619"><span class="linenum">1619</span></a>                      if (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>[<a class="var it33728" onMouseOver="hilite(33728)" onMouseOut="lolite()" onClick="logVariable('founditemid')" href="../../_variables/founditemid.html">$founditemid</a>] != <a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>[<a class="var it33732" onMouseOver="hilite(33732)" onMouseOut="lolite()" onClick="logVariable('possibleitemid')" href="../../_variables/possibleitemid.html">$possibleitemid</a>]) {
<a name="l1620"><span class="linenum">1620</span></a>  <span class="comment">                        // The next grade item has a different grade value. Stop looking.</span>
<a name="l1621"><span class="linenum">1621</span></a>                          break;
<a name="l1622"><span class="linenum">1622</span></a>                      }
<a name="l1623"><span class="linenum">1623</span></a>  
<a name="l1624"><span class="linenum">1624</span></a>                      if (<a class="var it33723" onMouseOver="hilite(33723)" onMouseOut="lolite()" onClick="logVariable('extraused')" href="../../_variables/extraused.html">$extraused</a> &amp;&amp; <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it33732" onMouseOver="hilite(33732)" onMouseOut="lolite()" onClick="logVariable('possibleitemid')" href="../../_variables/possibleitemid.html">$possibleitemid</a>]-&gt;aggregationcoef &gt; 0) {
<a name="l1625"><span class="linenum">1625</span></a>  <span class="comment">                        // Don't drop extra credit grade items. Continue the search.</span>
<a name="l1626"><span class="linenum">1626</span></a>                          continue;
<a name="l1627"><span class="linenum">1627</span></a>                      }
<a name="l1628"><span class="linenum">1628</span></a>  
<a name="l1629"><span class="linenum">1629</span></a>                      if (<a class="var it33729" onMouseOver="hilite(33729)" onMouseOut="lolite()" onClick="logVariable('foundmax')" href="../../_variables/foundmax.html">$foundmax</a> &lt; <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it33732" onMouseOver="hilite(33732)" onMouseOut="lolite()" onClick="logVariable('possibleitemid')" href="../../_variables/possibleitemid.html">$possibleitemid</a>]-&gt;grademax) {
<a name="l1630"><span class="linenum">1630</span></a>  <span class="comment">                        // Found a grade item with the same grade value and a higher grademax</span>
<a name="l1631"><span class="linenum">1631</span></a>                          <a class="var it33729" onMouseOver="hilite(33729)" onMouseOut="lolite()" onClick="logVariable('foundmax')" href="../../_variables/foundmax.html">$foundmax</a> = <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it33732" onMouseOver="hilite(33732)" onMouseOut="lolite()" onClick="logVariable('possibleitemid')" href="../../_variables/possibleitemid.html">$possibleitemid</a>]-&gt;grademax;
<a name="l1632"><span class="linenum">1632</span></a>                          <a class="var it33728" onMouseOver="hilite(33728)" onMouseOut="lolite()" onClick="logVariable('founditemid')" href="../../_variables/founditemid.html">$founditemid</a> = <a class="var it33732" onMouseOver="hilite(33732)" onMouseOut="lolite()" onClick="logVariable('possibleitemid')" href="../../_variables/possibleitemid.html">$possibleitemid</a>;
<a name="l1633"><span class="linenum">1633</span></a>  <span class="comment">                        // Continue searching to see if there is an even higher grademax</span>
<a name="l1634"><span class="linenum">1634</span></a>                      }
<a name="l1635"><span class="linenum">1635</span></a>                  }
<a name="l1636"><span class="linenum">1636</span></a>  
<a name="l1637"><span class="linenum">1637</span></a>  <span class="comment">                // Now drop whatever grade item we have found</span>
<a name="l1638"><span class="linenum">1638</span></a>                  unset(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>[<a class="var it33728" onMouseOver="hilite(33728)" onMouseOut="lolite()" onClick="logVariable('founditemid')" href="../../_variables/founditemid.html">$founditemid</a>]);
<a name="l1639"><span class="linenum">1639</span></a>                  <a class="var it33680" onMouseOver="hilite(33680)" onMouseOut="lolite()" onClick="logVariable('dropped')" href="../../_variables/dropped.html">$dropped</a>++;
<a name="l1640"><span class="linenum">1640</span></a>                  <a class="var it33724" onMouseOver="hilite(33724)" onMouseOut="lolite()" onClick="logVariable('droppedsomething')" href="../../_variables/droppedsomething.html">$droppedsomething</a> = true;
<a name="l1641"><span class="linenum">1641</span></a>              }
<a name="l1642"><span class="linenum">1642</span></a>  
<a name="l1643"><span class="linenum">1643</span></a>          } else if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('keephigh')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/keephigh.html">keephigh</a>)) {
<a name="l1644"><span class="linenum">1644</span></a>              <a class="phpfunction" onClick="logFunction('arsort')" href="../../_functions/arsort.html" onMouseOver="phpfuncPopup(event,'arsort')">arsort</a>(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>, SORT_NUMERIC);
<a name="l1645"><span class="linenum">1645</span></a>              <a class="var it33733" onMouseOver="hilite(33733)" onMouseOut="lolite()" onClick="logVariable('kept')" href="../../_variables/kept.html">$kept</a> = 0;
<a name="l1646"><span class="linenum">1646</span></a>  
<a name="l1647"><span class="linenum">1647</span></a>              foreach (<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>=&gt;<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l1648"><span class="linenum">1648</span></a>  
<a name="l1649"><span class="linenum">1649</span></a>                  if (<a class="var it33723" onMouseOver="hilite(33723)" onMouseOut="lolite()" onClick="logVariable('extraused')" href="../../_variables/extraused.html">$extraused</a> and <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;aggregationcoef &gt; 0) {
<a name="l1650"><span class="linenum">1650</span></a>  <span class="comment">                    // we keep all extra credits</span>
<a name="l1651"><span class="linenum">1651</span></a>  
<a name="l1652"><span class="linenum">1652</span></a>                  } else if (<a class="var it33733" onMouseOver="hilite(33733)" onMouseOut="lolite()" onClick="logVariable('kept')" href="../../_variables/kept.html">$kept</a> &lt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('keephigh')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/keephigh.html">keephigh</a>) {
<a name="l1653"><span class="linenum">1653</span></a>                      <a class="var it33733" onMouseOver="hilite(33733)" onMouseOut="lolite()" onClick="logVariable('kept')" href="../../_variables/kept.html">$kept</a>++;
<a name="l1654"><span class="linenum">1654</span></a>  
<a name="l1655"><span class="linenum">1655</span></a>                  } else {
<a name="l1656"><span class="linenum">1656</span></a>                      unset(<a class="var it33676" onMouseOver="hilite(33676)" onMouseOut="lolite()" onClick="logVariable('grade_values')" href="../../_variables/grade_values.html">$grade_values</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]);
<a name="l1657"><span class="linenum">1657</span></a>                  }
<a name="l1658"><span class="linenum">1658</span></a>              }
<a name="l1659"><span class="linenum">1659</span></a>          }
<a name="l1660"><span class="linenum">1660</span></a>      }
<a name="l1661"><span class="linenum">1661</span></a>  
<a name="l1662"><span class="linenum">1662</span></a>      <span class="comment">/**</span>
<a name="l1663"><span class="linenum">1663</span></a>  <span class="comment">     * Returns whether or not we can apply the limit rules.</span>
<a name="l1664"><span class="linenum">1664</span></a>  <span class="comment">     *</span>
<a name="l1665"><span class="linenum">1665</span></a>  <span class="comment">     * There are cases where drop lowest or keep highest should not be used</span>
<a name="l1666"><span class="linenum">1666</span></a>  <span class="comment">     * at all. This method will determine whether or not this logic can be</span>
<a name="l1667"><span class="linenum">1667</span></a>  <span class="comment">     * applied considering the current setup of the category.</span>
<a name="l1668"><span class="linenum">1668</span></a>  <span class="comment">     *</span>
<a name="l1669"><span class="linenum">1669</span></a>  <span class="comment">     * @return bool</span>
<a name="l1670"><span class="linenum">1670</span></a>  <span class="comment">     */</span>
<a name="l1671"><span class="linenum">1671</span></a>      public function <a class="function" onClick="logFunction('can_apply_limit_rules')" href="../../_functions/can_apply_limit_rules.html" onMouseOver="funcPopup(event,'can_apply_limit_rules')">can_apply_limit_rules</a>() {
<a name="l1672"><span class="linenum">1672</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('canapplylimitrules')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/canapplylimitrules.html">canapplylimitrules</a> !== null) {
<a name="l1673"><span class="linenum">1673</span></a>              return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('canapplylimitrules')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/canapplylimitrules.html">canapplylimitrules</a>;
<a name="l1674"><span class="linenum">1674</span></a>          }
<a name="l1675"><span class="linenum">1675</span></a>  
<a name="l1676"><span class="linenum">1676</span></a>  <span class="comment">        // Set it to be supported by default.</span>
<a name="l1677"><span class="linenum">1677</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('canapplylimitrules')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/canapplylimitrules.html">canapplylimitrules</a> = true;
<a name="l1678"><span class="linenum">1678</span></a>  
<a name="l1679"><span class="linenum">1679</span></a>  <span class="comment">        // Natural aggregation.</span>
<a name="l1680"><span class="linenum">1680</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregation')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregation.html">aggregation</a> == <a class="constant" onClick="logConstant('GRADE_AGGREGATE_SUM')" href="../../_constants/GRADE_AGGREGATE_SUM.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_SUM')">GRADE_AGGREGATE_SUM</a>) {
<a name="l1681"><span class="linenum">1681</span></a>              <a class="var it33734" onMouseOver="hilite(33734)" onMouseOut="lolite()" onClick="logVariable('canapply')" href="../../_variables/canapply.html">$canapply</a> = true;
<a name="l1682"><span class="linenum">1682</span></a>  
<a name="l1683"><span class="linenum">1683</span></a>  <span class="comment">            // Check until one child breaks the rules.</span>
<a name="l1684"><span class="linenum">1684</span></a>              <a class="var it11504" onMouseOver="hilite(11504)" onMouseOut="lolite()" onClick="logVariable('gradeitems')" href="../../_variables/gradeitems.html">$gradeitems</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_children')" href="../../_functions/get_children.html" onMouseOver="funcPopup(event,'get_children')">get_children</a>();
<a name="l1685"><span class="linenum">1685</span></a>              <a class="var it33735" onMouseOver="hilite(33735)" onMouseOut="lolite()" onClick="logVariable('validitems')" href="../../_variables/validitems.html">$validitems</a> = 0;
<a name="l1686"><span class="linenum">1686</span></a>              <a class="var it26693" onMouseOver="hilite(26693)" onMouseOut="lolite()" onClick="logVariable('lastweight')" href="../../_variables/lastweight.html">$lastweight</a> = null;
<a name="l1687"><span class="linenum">1687</span></a>              <a class="var it33736" onMouseOver="hilite(33736)" onMouseOut="lolite()" onClick="logVariable('lastmaxgrade')" href="../../_variables/lastmaxgrade.html">$lastmaxgrade</a> = null;
<a name="l1688"><span class="linenum">1688</span></a>              foreach (<a class="var it11504" onMouseOver="hilite(11504)" onMouseOut="lolite()" onClick="logVariable('gradeitems')" href="../../_variables/gradeitems.html">$gradeitems</a> as <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>) {
<a name="l1689"><span class="linenum">1689</span></a>                  <a class="var it10033" onMouseOver="hilite(10033)" onMouseOut="lolite()" onClick="logVariable('gi')" href="../../_variables/gi.html">$gi</a> = <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>['object'];
<a name="l1690"><span class="linenum">1690</span></a>  
<a name="l1691"><span class="linenum">1691</span></a>                  if (<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>['type'] == 'category') {
<a name="l1692"><span class="linenum">1692</span></a>  <span class="comment">                    // Sub categories are not allowed because they can have dynamic weights/maxgrades.</span>
<a name="l1693"><span class="linenum">1693</span></a>                      <a class="var it33734" onMouseOver="hilite(33734)" onMouseOut="lolite()" onClick="logVariable('canapply')" href="../../_variables/canapply.html">$canapply</a> = false;
<a name="l1694"><span class="linenum">1694</span></a>                      break;
<a name="l1695"><span class="linenum">1695</span></a>                  }
<a name="l1696"><span class="linenum">1696</span></a>  
<a name="l1697"><span class="linenum">1697</span></a>                  if (<a class="var it10033" onMouseOver="hilite(10033)" onMouseOut="lolite()" onClick="logVariable('gi')" href="../../_variables/gi.html">$gi</a>-&gt;<a onClick="logVariable('aggregationcoef')" class="var it39548" onMouseOver="hilite(39548)" onMouseOut="lolite()" href="../../_variables/aggregationcoef.html">aggregationcoef</a> &gt; 0) {
<a name="l1698"><span class="linenum">1698</span></a>  <span class="comment">                    // Extra credit items are not allowed.</span>
<a name="l1699"><span class="linenum">1699</span></a>                      <a class="var it33734" onMouseOver="hilite(33734)" onMouseOut="lolite()" onClick="logVariable('canapply')" href="../../_variables/canapply.html">$canapply</a> = false;
<a name="l1700"><span class="linenum">1700</span></a>                      break;
<a name="l1701"><span class="linenum">1701</span></a>                  }
<a name="l1702"><span class="linenum">1702</span></a>  
<a name="l1703"><span class="linenum">1703</span></a>                  if (<a class="var it26693" onMouseOver="hilite(26693)" onMouseOut="lolite()" onClick="logVariable('lastweight')" href="../../_variables/lastweight.html">$lastweight</a> !== null &amp;&amp; <a class="var it26693" onMouseOver="hilite(26693)" onMouseOut="lolite()" onClick="logVariable('lastweight')" href="../../_variables/lastweight.html">$lastweight</a> != <a class="var it10033" onMouseOver="hilite(10033)" onMouseOut="lolite()" onClick="logVariable('gi')" href="../../_variables/gi.html">$gi</a>-&gt;<a onClick="logVariable('aggregationcoef2')" class="var it39548" onMouseOver="hilite(39548)" onMouseOut="lolite()" href="../../_variables/aggregationcoef2.html">aggregationcoef2</a>) {
<a name="l1704"><span class="linenum">1704</span></a>  <span class="comment">                    // One of the weight differs from another item.</span>
<a name="l1705"><span class="linenum">1705</span></a>                      <a class="var it33734" onMouseOver="hilite(33734)" onMouseOut="lolite()" onClick="logVariable('canapply')" href="../../_variables/canapply.html">$canapply</a> = false;
<a name="l1706"><span class="linenum">1706</span></a>                      break;
<a name="l1707"><span class="linenum">1707</span></a>                  }
<a name="l1708"><span class="linenum">1708</span></a>  
<a name="l1709"><span class="linenum">1709</span></a>                  if (<a class="var it33736" onMouseOver="hilite(33736)" onMouseOut="lolite()" onClick="logVariable('lastmaxgrade')" href="../../_variables/lastmaxgrade.html">$lastmaxgrade</a> !== null &amp;&amp; <a class="var it33736" onMouseOver="hilite(33736)" onMouseOut="lolite()" onClick="logVariable('lastmaxgrade')" href="../../_variables/lastmaxgrade.html">$lastmaxgrade</a> != <a class="var it10033" onMouseOver="hilite(10033)" onMouseOut="lolite()" onClick="logVariable('gi')" href="../../_variables/gi.html">$gi</a>-&gt;<a onClick="logVariable('grademax')" class="var it39548" onMouseOver="hilite(39548)" onMouseOut="lolite()" href="../../_variables/grademax.html">grademax</a>) {
<a name="l1710"><span class="linenum">1710</span></a>  <span class="comment">                    // One of the max grade differ from another item. This is not allowed for now</span>
<a name="l1711"><span class="linenum">1711</span></a>  <span class="comment">                    // because we could be end up with different max grade between users for this category.</span>
<a name="l1712"><span class="linenum">1712</span></a>                      <a class="var it33734" onMouseOver="hilite(33734)" onMouseOut="lolite()" onClick="logVariable('canapply')" href="../../_variables/canapply.html">$canapply</a> = false;
<a name="l1713"><span class="linenum">1713</span></a>                      break;
<a name="l1714"><span class="linenum">1714</span></a>                  }
<a name="l1715"><span class="linenum">1715</span></a>  
<a name="l1716"><span class="linenum">1716</span></a>                  <a class="var it26693" onMouseOver="hilite(26693)" onMouseOut="lolite()" onClick="logVariable('lastweight')" href="../../_variables/lastweight.html">$lastweight</a> = <a class="var it10033" onMouseOver="hilite(10033)" onMouseOut="lolite()" onClick="logVariable('gi')" href="../../_variables/gi.html">$gi</a>-&gt;<a onClick="logVariable('aggregationcoef2')" class="var it39548" onMouseOver="hilite(39548)" onMouseOut="lolite()" href="../../_variables/aggregationcoef2.html">aggregationcoef2</a>;
<a name="l1717"><span class="linenum">1717</span></a>                  <a class="var it33736" onMouseOver="hilite(33736)" onMouseOut="lolite()" onClick="logVariable('lastmaxgrade')" href="../../_variables/lastmaxgrade.html">$lastmaxgrade</a> = <a class="var it10033" onMouseOver="hilite(10033)" onMouseOut="lolite()" onClick="logVariable('gi')" href="../../_variables/gi.html">$gi</a>-&gt;<a onClick="logVariable('grademax')" class="var it39548" onMouseOver="hilite(39548)" onMouseOut="lolite()" href="../../_variables/grademax.html">grademax</a>;
<a name="l1718"><span class="linenum">1718</span></a>              }
<a name="l1719"><span class="linenum">1719</span></a>  
<a name="l1720"><span class="linenum">1720</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('canapplylimitrules')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/canapplylimitrules.html">canapplylimitrules</a> = <a class="var it33734" onMouseOver="hilite(33734)" onMouseOut="lolite()" onClick="logVariable('canapply')" href="../../_variables/canapply.html">$canapply</a>;
<a name="l1721"><span class="linenum">1721</span></a>          }
<a name="l1722"><span class="linenum">1722</span></a>  
<a name="l1723"><span class="linenum">1723</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('canapplylimitrules')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/canapplylimitrules.html">canapplylimitrules</a>;
<a name="l1724"><span class="linenum">1724</span></a>      }
<a name="l1725"><span class="linenum">1725</span></a>  
<a name="l1726"><span class="linenum">1726</span></a>      <span class="comment">/**</span>
<a name="l1727"><span class="linenum">1727</span></a>  <span class="comment">     * Returns true if category uses extra credit of any kind</span>
<a name="l1728"><span class="linenum">1728</span></a>  <span class="comment">     *</span>
<a name="l1729"><span class="linenum">1729</span></a>  <span class="comment">     * @return bool True if extra credit used</span>
<a name="l1730"><span class="linenum">1730</span></a>  <span class="comment">     */</span>
<a name="l1731"><span class="linenum">1731</span></a>      public function <a class="function" onClick="logFunction('is_extracredit_used')" href="../../_functions/is_extracredit_used.html" onMouseOver="funcPopup(event,'is_extracredit_used')">is_extracredit_used</a>() {
<a name="l1732"><span class="linenum">1732</span></a>          return self::<a class="function" onClick="logFunction('aggregation_uses_extracredit')" href="../../_functions/aggregation_uses_extracredit.html" onMouseOver="funcPopup(event,'aggregation_uses_extracredit')">aggregation_uses_extracredit</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregation')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregation.html">aggregation</a>);
<a name="l1733"><span class="linenum">1733</span></a>      }
<a name="l1734"><span class="linenum">1734</span></a>  
<a name="l1735"><span class="linenum">1735</span></a>      <span class="comment">/**</span>
<a name="l1736"><span class="linenum">1736</span></a>  <span class="comment">     * Returns true if aggregation passed is using extracredit.</span>
<a name="l1737"><span class="linenum">1737</span></a>  <span class="comment">     *</span>
<a name="l1738"><span class="linenum">1738</span></a>  <span class="comment">     * @param int $aggregation Aggregation const.</span>
<a name="l1739"><span class="linenum">1739</span></a>  <span class="comment">     * @return bool True if extra credit used</span>
<a name="l1740"><span class="linenum">1740</span></a>  <span class="comment">     */</span>
<a name="l1741"><span class="linenum">1741</span></a>      public static function <a class="function" onClick="logFunction('aggregation_uses_extracredit')" href="../../_functions/aggregation_uses_extracredit.html" onMouseOver="funcPopup(event,'aggregation_uses_extracredit')">aggregation_uses_extracredit</a>(<a class="var it10016" onMouseOver="hilite(10016)" onMouseOut="lolite()" onClick="logVariable('aggregation')" href="../../_variables/aggregation.html">$aggregation</a>) {
<a name="l1742"><span class="linenum">1742</span></a>          return (<a class="var it10016" onMouseOver="hilite(10016)" onMouseOut="lolite()" onClick="logVariable('aggregation')" href="../../_variables/aggregation.html">$aggregation</a> == <a class="constant" onClick="logConstant('GRADE_AGGREGATE_WEIGHTED_MEAN2')" href="../../_constants/GRADE_AGGREGATE_WEIGHTED_MEAN2.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_WEIGHTED_MEAN2')">GRADE_AGGREGATE_WEIGHTED_MEAN2</a>
<a name="l1743"><span class="linenum">1743</span></a>               or <a class="var it10016" onMouseOver="hilite(10016)" onMouseOut="lolite()" onClick="logVariable('aggregation')" href="../../_variables/aggregation.html">$aggregation</a> == <a class="constant" onClick="logConstant('GRADE_AGGREGATE_EXTRACREDIT_MEAN')" href="../../_constants/GRADE_AGGREGATE_EXTRACREDIT_MEAN.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_EXTRACREDIT_MEAN')">GRADE_AGGREGATE_EXTRACREDIT_MEAN</a>
<a name="l1744"><span class="linenum">1744</span></a>               or <a class="var it10016" onMouseOver="hilite(10016)" onMouseOut="lolite()" onClick="logVariable('aggregation')" href="../../_variables/aggregation.html">$aggregation</a> == <a class="constant" onClick="logConstant('GRADE_AGGREGATE_SUM')" href="../../_constants/GRADE_AGGREGATE_SUM.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_SUM')">GRADE_AGGREGATE_SUM</a>);
<a name="l1745"><span class="linenum">1745</span></a>      }
<a name="l1746"><span class="linenum">1746</span></a>  
<a name="l1747"><span class="linenum">1747</span></a>      <span class="comment">/**</span>
<a name="l1748"><span class="linenum">1748</span></a>  <span class="comment">     * Returns true if category uses special aggregation coefficient</span>
<a name="l1749"><span class="linenum">1749</span></a>  <span class="comment">     *</span>
<a name="l1750"><span class="linenum">1750</span></a>  <span class="comment">     * @return bool True if an aggregation coefficient is being used</span>
<a name="l1751"><span class="linenum">1751</span></a>  <span class="comment">     */</span>
<a name="l1752"><span class="linenum">1752</span></a>      public function <a class="function" onClick="logFunction('is_aggregationcoef_used')" href="../../_functions/is_aggregationcoef_used.html" onMouseOver="funcPopup(event,'is_aggregationcoef_used')">is_aggregationcoef_used</a>() {
<a name="l1753"><span class="linenum">1753</span></a>          return self::<a class="function" onClick="logFunction('aggregation_uses_aggregationcoef')" href="../../_functions/aggregation_uses_aggregationcoef.html" onMouseOver="funcPopup(event,'aggregation_uses_aggregationcoef')">aggregation_uses_aggregationcoef</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregation')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregation.html">aggregation</a>);
<a name="l1754"><span class="linenum">1754</span></a>  
<a name="l1755"><span class="linenum">1755</span></a>      }
<a name="l1756"><span class="linenum">1756</span></a>  
<a name="l1757"><span class="linenum">1757</span></a>      <span class="comment">/**</span>
<a name="l1758"><span class="linenum">1758</span></a>  <span class="comment">     * Returns true if aggregation uses aggregationcoef</span>
<a name="l1759"><span class="linenum">1759</span></a>  <span class="comment">     *</span>
<a name="l1760"><span class="linenum">1760</span></a>  <span class="comment">     * @param int $aggregation Aggregation const.</span>
<a name="l1761"><span class="linenum">1761</span></a>  <span class="comment">     * @return bool True if an aggregation coefficient is being used</span>
<a name="l1762"><span class="linenum">1762</span></a>  <span class="comment">     */</span>
<a name="l1763"><span class="linenum">1763</span></a>      public static function <a class="function" onClick="logFunction('aggregation_uses_aggregationcoef')" href="../../_functions/aggregation_uses_aggregationcoef.html" onMouseOver="funcPopup(event,'aggregation_uses_aggregationcoef')">aggregation_uses_aggregationcoef</a>(<a class="var it10016" onMouseOver="hilite(10016)" onMouseOut="lolite()" onClick="logVariable('aggregation')" href="../../_variables/aggregation.html">$aggregation</a>) {
<a name="l1764"><span class="linenum">1764</span></a>          return (<a class="var it10016" onMouseOver="hilite(10016)" onMouseOut="lolite()" onClick="logVariable('aggregation')" href="../../_variables/aggregation.html">$aggregation</a> == <a class="constant" onClick="logConstant('GRADE_AGGREGATE_WEIGHTED_MEAN')" href="../../_constants/GRADE_AGGREGATE_WEIGHTED_MEAN.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_WEIGHTED_MEAN')">GRADE_AGGREGATE_WEIGHTED_MEAN</a>
<a name="l1765"><span class="linenum">1765</span></a>               or <a class="var it10016" onMouseOver="hilite(10016)" onMouseOut="lolite()" onClick="logVariable('aggregation')" href="../../_variables/aggregation.html">$aggregation</a> == <a class="constant" onClick="logConstant('GRADE_AGGREGATE_WEIGHTED_MEAN2')" href="../../_constants/GRADE_AGGREGATE_WEIGHTED_MEAN2.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_WEIGHTED_MEAN2')">GRADE_AGGREGATE_WEIGHTED_MEAN2</a>
<a name="l1766"><span class="linenum">1766</span></a>               or <a class="var it10016" onMouseOver="hilite(10016)" onMouseOut="lolite()" onClick="logVariable('aggregation')" href="../../_variables/aggregation.html">$aggregation</a> == <a class="constant" onClick="logConstant('GRADE_AGGREGATE_EXTRACREDIT_MEAN')" href="../../_constants/GRADE_AGGREGATE_EXTRACREDIT_MEAN.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_EXTRACREDIT_MEAN')">GRADE_AGGREGATE_EXTRACREDIT_MEAN</a>
<a name="l1767"><span class="linenum">1767</span></a>               or <a class="var it10016" onMouseOver="hilite(10016)" onMouseOut="lolite()" onClick="logVariable('aggregation')" href="../../_variables/aggregation.html">$aggregation</a> == <a class="constant" onClick="logConstant('GRADE_AGGREGATE_SUM')" href="../../_constants/GRADE_AGGREGATE_SUM.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_SUM')">GRADE_AGGREGATE_SUM</a>);
<a name="l1768"><span class="linenum">1768</span></a>  
<a name="l1769"><span class="linenum">1769</span></a>      }
<a name="l1770"><span class="linenum">1770</span></a>  
<a name="l1771"><span class="linenum">1771</span></a>      <span class="comment">/**</span>
<a name="l1772"><span class="linenum">1772</span></a>  <span class="comment">     * Recursive function to find which weight/extra credit field to use in the grade item form.</span>
<a name="l1773"><span class="linenum">1773</span></a>  <span class="comment">     *</span>
<a name="l1774"><span class="linenum">1774</span></a>  <span class="comment">     * @param string $first Whether or not this is the first item in the recursion</span>
<a name="l1775"><span class="linenum">1775</span></a>  <span class="comment">     * @return string</span>
<a name="l1776"><span class="linenum">1776</span></a>  <span class="comment">     */</span>
<a name="l1777"><span class="linenum">1777</span></a>      public function <a class="function" onClick="logFunction('get_coefstring')" href="../../_functions/get_coefstring.html" onMouseOver="funcPopup(event,'get_coefstring')">get_coefstring</a>(<a class="var it389" onMouseOver="hilite(389)" onMouseOut="lolite()" onClick="logVariable('first')" href="../../_variables/first.html">$first</a>=true) {
<a name="l1778"><span class="linenum">1778</span></a>          if (!<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('coefstring')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/coefstring.html">coefstring</a>)) {
<a name="l1779"><span class="linenum">1779</span></a>              return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('coefstring')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/coefstring.html">coefstring</a>;
<a name="l1780"><span class="linenum">1780</span></a>          }
<a name="l1781"><span class="linenum">1781</span></a>  
<a name="l1782"><span class="linenum">1782</span></a>          <a class="var it33737" onMouseOver="hilite(33737)" onMouseOut="lolite()" onClick="logVariable('overriding_coefstring')" href="../../_variables/overriding_coefstring.html">$overriding_coefstring</a> = null;
<a name="l1783"><span class="linenum">1783</span></a>  
<a name="l1784"><span class="linenum">1784</span></a>  <span class="comment">        // Stop recursing upwards if this category has no parent</span>
<a name="l1785"><span class="linenum">1785</span></a>          if (!<a class="var it389" onMouseOver="hilite(389)" onMouseOut="lolite()" onClick="logVariable('first')" href="../../_variables/first.html">$first</a>) {
<a name="l1786"><span class="linenum">1786</span></a>  
<a name="l1787"><span class="linenum">1787</span></a>              if (<a class="var it6486" onMouseOver="hilite(6486)" onMouseOut="lolite()" onClick="logVariable('parent_category')" href="../../_variables/parent_category.html">$parent_category</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_parent_category')" href="../../_functions/load_parent_category.html" onMouseOver="funcPopup(event,'load_parent_category')">load_parent_category</a>()) {
<a name="l1788"><span class="linenum">1788</span></a>                  return <a class="var it6486" onMouseOver="hilite(6486)" onMouseOut="lolite()" onClick="logVariable('parent_category')" href="../../_variables/parent_category.html">$parent_category</a>-&gt;<a class="function" onClick="logFunction('get_coefstring')" href="../../_functions/get_coefstring.html" onMouseOver="funcPopup(event,'get_coefstring')">get_coefstring</a>(false);
<a name="l1789"><span class="linenum">1789</span></a>  
<a name="l1790"><span class="linenum">1790</span></a>              } else {
<a name="l1791"><span class="linenum">1791</span></a>                  return null;
<a name="l1792"><span class="linenum">1792</span></a>              }
<a name="l1793"><span class="linenum">1793</span></a>  
<a name="l1794"><span class="linenum">1794</span></a>          } else if (<a class="var it389" onMouseOver="hilite(389)" onMouseOut="lolite()" onClick="logVariable('first')" href="../../_variables/first.html">$first</a>) {
<a name="l1795"><span class="linenum">1795</span></a>  
<a name="l1796"><span class="linenum">1796</span></a>              if (<a class="var it6486" onMouseOver="hilite(6486)" onMouseOut="lolite()" onClick="logVariable('parent_category')" href="../../_variables/parent_category.html">$parent_category</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_parent_category')" href="../../_functions/load_parent_category.html" onMouseOver="funcPopup(event,'load_parent_category')">load_parent_category</a>()) {
<a name="l1797"><span class="linenum">1797</span></a>                  <a class="var it33737" onMouseOver="hilite(33737)" onMouseOut="lolite()" onClick="logVariable('overriding_coefstring')" href="../../_variables/overriding_coefstring.html">$overriding_coefstring</a> = <a class="var it6486" onMouseOver="hilite(6486)" onMouseOut="lolite()" onClick="logVariable('parent_category')" href="../../_variables/parent_category.html">$parent_category</a>-&gt;<a class="function" onClick="logFunction('get_coefstring')" href="../../_functions/get_coefstring.html" onMouseOver="funcPopup(event,'get_coefstring')">get_coefstring</a>(false);
<a name="l1798"><span class="linenum">1798</span></a>              }
<a name="l1799"><span class="linenum">1799</span></a>          }
<a name="l1800"><span class="linenum">1800</span></a>  
<a name="l1801"><span class="linenum">1801</span></a>  <span class="comment">        // If an overriding coefstring has trickled down from one of the parent categories, return it. Otherwise, return self.</span>
<a name="l1802"><span class="linenum">1802</span></a>          if (!<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it33737" onMouseOver="hilite(33737)" onMouseOut="lolite()" onClick="logVariable('overriding_coefstring')" href="../../_variables/overriding_coefstring.html">$overriding_coefstring</a>)) {
<a name="l1803"><span class="linenum">1803</span></a>              return <a class="var it33737" onMouseOver="hilite(33737)" onMouseOut="lolite()" onClick="logVariable('overriding_coefstring')" href="../../_variables/overriding_coefstring.html">$overriding_coefstring</a>;
<a name="l1804"><span class="linenum">1804</span></a>          }
<a name="l1805"><span class="linenum">1805</span></a>  
<a name="l1806"><span class="linenum">1806</span></a>  <span class="comment">        // No parent category is overriding this category's aggregation, return its string</span>
<a name="l1807"><span class="linenum">1807</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregation')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregation.html">aggregation</a> == <a class="constant" onClick="logConstant('GRADE_AGGREGATE_WEIGHTED_MEAN')" href="../../_constants/GRADE_AGGREGATE_WEIGHTED_MEAN.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_WEIGHTED_MEAN')">GRADE_AGGREGATE_WEIGHTED_MEAN</a>) {
<a name="l1808"><span class="linenum">1808</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('coefstring')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/coefstring.html">coefstring</a> = 'aggregationcoefweight';
<a name="l1809"><span class="linenum">1809</span></a>  
<a name="l1810"><span class="linenum">1810</span></a>          } else if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregation')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregation.html">aggregation</a> == <a class="constant" onClick="logConstant('GRADE_AGGREGATE_WEIGHTED_MEAN2')" href="../../_constants/GRADE_AGGREGATE_WEIGHTED_MEAN2.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_WEIGHTED_MEAN2')">GRADE_AGGREGATE_WEIGHTED_MEAN2</a>) {
<a name="l1811"><span class="linenum">1811</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('coefstring')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/coefstring.html">coefstring</a> = 'aggregationcoefextrasum';
<a name="l1812"><span class="linenum">1812</span></a>  
<a name="l1813"><span class="linenum">1813</span></a>          } else if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregation')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregation.html">aggregation</a> == <a class="constant" onClick="logConstant('GRADE_AGGREGATE_EXTRACREDIT_MEAN')" href="../../_constants/GRADE_AGGREGATE_EXTRACREDIT_MEAN.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_EXTRACREDIT_MEAN')">GRADE_AGGREGATE_EXTRACREDIT_MEAN</a>) {
<a name="l1814"><span class="linenum">1814</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('coefstring')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/coefstring.html">coefstring</a> = 'aggregationcoefextraweight';
<a name="l1815"><span class="linenum">1815</span></a>  
<a name="l1816"><span class="linenum">1816</span></a>          } else if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregation')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregation.html">aggregation</a> == <a class="constant" onClick="logConstant('GRADE_AGGREGATE_SUM')" href="../../_constants/GRADE_AGGREGATE_SUM.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_SUM')">GRADE_AGGREGATE_SUM</a>) {
<a name="l1817"><span class="linenum">1817</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('coefstring')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/coefstring.html">coefstring</a> = 'aggregationcoefextraweightsum';
<a name="l1818"><span class="linenum">1818</span></a>  
<a name="l1819"><span class="linenum">1819</span></a>          } else {
<a name="l1820"><span class="linenum">1820</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('coefstring')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/coefstring.html">coefstring</a> = 'aggregationcoef';
<a name="l1821"><span class="linenum">1821</span></a>          }
<a name="l1822"><span class="linenum">1822</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('coefstring')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/coefstring.html">coefstring</a>;
<a name="l1823"><span class="linenum">1823</span></a>      }
<a name="l1824"><span class="linenum">1824</span></a>  
<a name="l1825"><span class="linenum">1825</span></a>      <span class="comment">/**</span>
<a name="l1826"><span class="linenum">1826</span></a>  <span class="comment">     * Returns tree with all grade_items and categories as elements</span>
<a name="l1827"><span class="linenum">1827</span></a>  <span class="comment">     *</span>
<a name="l1828"><span class="linenum">1828</span></a>  <span class="comment">     * @param int $courseid The course ID</span>
<a name="l1829"><span class="linenum">1829</span></a>  <span class="comment">     * @param bool $include_category_items as category children</span>
<a name="l1830"><span class="linenum">1830</span></a>  <span class="comment">     * @return array</span>
<a name="l1831"><span class="linenum">1831</span></a>  <span class="comment">     */</span>
<a name="l1832"><span class="linenum">1832</span></a>      public static function <a class="function" onClick="logFunction('fetch_course_tree')" href="../../_functions/fetch_course_tree.html" onMouseOver="funcPopup(event,'fetch_course_tree')">fetch_course_tree</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>, <a class="var it33738" onMouseOver="hilite(33738)" onMouseOut="lolite()" onClick="logVariable('include_category_items')" href="../../_variables/include_category_items.html">$include_category_items</a>=false) {
<a name="l1833"><span class="linenum">1833</span></a>          <a class="var it9997" onMouseOver="hilite(9997)" onMouseOut="lolite()" onClick="logVariable('course_category')" href="../../_variables/course_category.html">$course_category</a> = <a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>::<a class="function" onClick="logFunction('fetch_course_category')" href="../../_functions/fetch_course_category.html" onMouseOver="funcPopup(event,'fetch_course_category')">fetch_course_category</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>);
<a name="l1834"><span class="linenum">1834</span></a>          <a class="var it10001" onMouseOver="hilite(10001)" onMouseOut="lolite()" onClick="logVariable('category_array')" href="../../_variables/category_array.html">$category_array</a> = array('object'=&gt;<a class="var it9997" onMouseOver="hilite(9997)" onMouseOut="lolite()" onClick="logVariable('course_category')" href="../../_variables/course_category.html">$course_category</a>, 'type'=&gt;'category', 'depth'=&gt;1,
<a name="l1835"><span class="linenum">1835</span></a>                                  'children'=&gt;<a class="var it9997" onMouseOver="hilite(9997)" onMouseOut="lolite()" onClick="logVariable('course_category')" href="../../_variables/course_category.html">$course_category</a>-&gt;<a class="function" onClick="logFunction('get_children')" href="../../_functions/get_children.html" onMouseOver="funcPopup(event,'get_children')">get_children</a>(<a class="var it33738" onMouseOver="hilite(33738)" onMouseOut="lolite()" onClick="logVariable('include_category_items')" href="../../_variables/include_category_items.html">$include_category_items</a>));
<a name="l1836"><span class="linenum">1836</span></a>  
<a name="l1837"><span class="linenum">1837</span></a>          <a class="var it9997" onMouseOver="hilite(9997)" onMouseOut="lolite()" onClick="logVariable('course_category')" href="../../_variables/course_category.html">$course_category</a>-&gt;<a onClick="logVariable('sortorder')" class="var it40059" onMouseOver="hilite(40059)" onMouseOut="lolite()" href="../../_variables/sortorder.html">sortorder</a> = <a class="var it9997" onMouseOver="hilite(9997)" onMouseOut="lolite()" onClick="logVariable('course_category')" href="../../_variables/course_category.html">$course_category</a>-&gt;<a class="function" onClick="logFunction('get_sortorder')" href="../../_functions/get_sortorder.html" onMouseOver="funcPopup(event,'get_sortorder')">get_sortorder</a>();
<a name="l1838"><span class="linenum">1838</span></a>          <a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a> = <a class="var it9997" onMouseOver="hilite(9997)" onMouseOut="lolite()" onClick="logVariable('course_category')" href="../../_variables/course_category.html">$course_category</a>-&gt;<a class="function" onClick="logFunction('get_sortorder')" href="../../_functions/get_sortorder.html" onMouseOver="funcPopup(event,'get_sortorder')">get_sortorder</a>();
<a name="l1839"><span class="linenum">1839</span></a>          return <a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>::<a class="function" onClick="logFunction('_fetch_course_tree_recursion')" href="../../_functions/_fetch_course_tree_recursion.html" onMouseOver="funcPopup(event,'_fetch_course_tree_recursion')">_fetch_course_tree_recursion</a>(<a class="var it10001" onMouseOver="hilite(10001)" onMouseOut="lolite()" onClick="logVariable('category_array')" href="../../_variables/category_array.html">$category_array</a>, <a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a>);
<a name="l1840"><span class="linenum">1840</span></a>      }
<a name="l1841"><span class="linenum">1841</span></a>  
<a name="l1842"><span class="linenum">1842</span></a>      <span class="comment">/**</span>
<a name="l1843"><span class="linenum">1843</span></a>  <span class="comment">     * An internal function that recursively sorts grade categories within a course</span>
<a name="l1844"><span class="linenum">1844</span></a>  <span class="comment">     *</span>
<a name="l1845"><span class="linenum">1845</span></a>  <span class="comment">     * @param array $category_array The seed of the recursion</span>
<a name="l1846"><span class="linenum">1846</span></a>  <span class="comment">     * @param int   $sortorder The current sortorder</span>
<a name="l1847"><span class="linenum">1847</span></a>  <span class="comment">     * @return array An array containing 'object', 'type', 'depth' and optionally 'children'</span>
<a name="l1848"><span class="linenum">1848</span></a>  <span class="comment">     */</span>
<a name="l1849"><span class="linenum">1849</span></a>      static private function <a class="function" onClick="logFunction('_fetch_course_tree_recursion')" href="../../_functions/_fetch_course_tree_recursion.html" onMouseOver="funcPopup(event,'_fetch_course_tree_recursion')">_fetch_course_tree_recursion</a>(<a class="var it10001" onMouseOver="hilite(10001)" onMouseOut="lolite()" onClick="logVariable('category_array')" href="../../_variables/category_array.html">$category_array</a>, &amp;<a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a>) {
<a name="l1850"><span class="linenum">1850</span></a>  <span class="comment">        // update the sortorder in db if needed</span>
<a name="l1851"><span class="linenum">1851</span></a>  <span class="comment">        //NOTE: This leads to us resetting sort orders every time the categories and items page is viewed :(</span>
<a name="l1852"><span class="linenum">1852</span></a>  <span class="comment">        //if ($category_array['object']-&gt;sortorder != $sortorder) {</span>
<a name="l1853"><span class="linenum">1853</span></a>  <span class="comment">            //$category_array['object']-&gt;set_sortorder($sortorder);</span>
<a name="l1854"><span class="linenum">1854</span></a>  <span class="comment">        //}</span>
<a name="l1855"><span class="linenum">1855</span></a>  
<a name="l1856"><span class="linenum">1856</span></a>          if (isset(<a class="var it10001" onMouseOver="hilite(10001)" onMouseOut="lolite()" onClick="logVariable('category_array')" href="../../_variables/category_array.html">$category_array</a>['object']-&gt;gradetype) &amp;&amp; <a class="var it10001" onMouseOver="hilite(10001)" onMouseOut="lolite()" onClick="logVariable('category_array')" href="../../_variables/category_array.html">$category_array</a>['object']-&gt;gradetype==<a class="constant" onClick="logConstant('GRADE_TYPE_NONE')" href="../../_constants/GRADE_TYPE_NONE.html" onMouseOver="constPopup(event,'GRADE_TYPE_NONE')">GRADE_TYPE_NONE</a>) {
<a name="l1857"><span class="linenum">1857</span></a>              return null;
<a name="l1858"><span class="linenum">1858</span></a>          }
<a name="l1859"><span class="linenum">1859</span></a>  
<a name="l1860"><span class="linenum">1860</span></a>  <span class="comment">        // store the grade_item or grade_category instance with extra info</span>
<a name="l1861"><span class="linenum">1861</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = array('object'=&gt;<a class="var it10001" onMouseOver="hilite(10001)" onMouseOut="lolite()" onClick="logVariable('category_array')" href="../../_variables/category_array.html">$category_array</a>['object'], 'type'=&gt;<a class="var it10001" onMouseOver="hilite(10001)" onMouseOut="lolite()" onClick="logVariable('category_array')" href="../../_variables/category_array.html">$category_array</a>['type'], 'depth'=&gt;<a class="var it10001" onMouseOver="hilite(10001)" onMouseOut="lolite()" onClick="logVariable('category_array')" href="../../_variables/category_array.html">$category_array</a>['depth']);
<a name="l1862"><span class="linenum">1862</span></a>  
<a name="l1863"><span class="linenum">1863</span></a>  <span class="comment">        // reuse final grades if there</span>
<a name="l1864"><span class="linenum">1864</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>('finalgrades', <a class="var it10001" onMouseOver="hilite(10001)" onMouseOut="lolite()" onClick="logVariable('category_array')" href="../../_variables/category_array.html">$category_array</a>)) {
<a name="l1865"><span class="linenum">1865</span></a>              <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>['finalgrades'] = <a class="var it10001" onMouseOver="hilite(10001)" onMouseOut="lolite()" onClick="logVariable('category_array')" href="../../_variables/category_array.html">$category_array</a>['finalgrades'];
<a name="l1866"><span class="linenum">1866</span></a>          }
<a name="l1867"><span class="linenum">1867</span></a>  
<a name="l1868"><span class="linenum">1868</span></a>  <span class="comment">        // recursively resort children</span>
<a name="l1869"><span class="linenum">1869</span></a>          if (!empty(<a class="var it10001" onMouseOver="hilite(10001)" onMouseOut="lolite()" onClick="logVariable('category_array')" href="../../_variables/category_array.html">$category_array</a>['children'])) {
<a name="l1870"><span class="linenum">1870</span></a>              <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>['children'] = array();
<a name="l1871"><span class="linenum">1871</span></a>  <span class="comment">            //process the category item first</span>
<a name="l1872"><span class="linenum">1872</span></a>              <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a> = null;
<a name="l1873"><span class="linenum">1873</span></a>  
<a name="l1874"><span class="linenum">1874</span></a>              foreach (<a class="var it10001" onMouseOver="hilite(10001)" onMouseOut="lolite()" onClick="logVariable('category_array')" href="../../_variables/category_array.html">$category_array</a>['children'] as <a class="var it32492" onMouseOver="hilite(32492)" onMouseOut="lolite()" onClick="logVariable('oldorder')" href="../../_variables/oldorder.html">$oldorder</a>=&gt;<a class="var it33739" onMouseOver="hilite(33739)" onMouseOut="lolite()" onClick="logVariable('child_array')" href="../../_variables/child_array.html">$child_array</a>) {
<a name="l1875"><span class="linenum">1875</span></a>  
<a name="l1876"><span class="linenum">1876</span></a>                  if (<a class="var it33739" onMouseOver="hilite(33739)" onMouseOut="lolite()" onClick="logVariable('child_array')" href="../../_variables/child_array.html">$child_array</a>['type'] == 'courseitem' or <a class="var it33739" onMouseOver="hilite(33739)" onMouseOut="lolite()" onClick="logVariable('child_array')" href="../../_variables/child_array.html">$child_array</a>['type'] == 'categoryitem') {
<a name="l1877"><span class="linenum">1877</span></a>                      <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a> = <a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>::<a class="function" onClick="logFunction('_fetch_course_tree_recursion')" href="../../_functions/_fetch_course_tree_recursion.html" onMouseOver="funcPopup(event,'_fetch_course_tree_recursion')">_fetch_course_tree_recursion</a>(<a class="var it33739" onMouseOver="hilite(33739)" onMouseOut="lolite()" onClick="logVariable('child_array')" href="../../_variables/child_array.html">$child_array</a>, <a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a>);
<a name="l1878"><span class="linenum">1878</span></a>                      if (!empty(<a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>)) {
<a name="l1879"><span class="linenum">1879</span></a>                          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>['children'][<a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a>] = <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>;
<a name="l1880"><span class="linenum">1880</span></a>                      }
<a name="l1881"><span class="linenum">1881</span></a>                  }
<a name="l1882"><span class="linenum">1882</span></a>              }
<a name="l1883"><span class="linenum">1883</span></a>  
<a name="l1884"><span class="linenum">1884</span></a>              foreach (<a class="var it10001" onMouseOver="hilite(10001)" onMouseOut="lolite()" onClick="logVariable('category_array')" href="../../_variables/category_array.html">$category_array</a>['children'] as <a class="var it32492" onMouseOver="hilite(32492)" onMouseOut="lolite()" onClick="logVariable('oldorder')" href="../../_variables/oldorder.html">$oldorder</a>=&gt;<a class="var it33739" onMouseOver="hilite(33739)" onMouseOut="lolite()" onClick="logVariable('child_array')" href="../../_variables/child_array.html">$child_array</a>) {
<a name="l1885"><span class="linenum">1885</span></a>  
<a name="l1886"><span class="linenum">1886</span></a>                  if (<a class="var it33739" onMouseOver="hilite(33739)" onMouseOut="lolite()" onClick="logVariable('child_array')" href="../../_variables/child_array.html">$child_array</a>['type'] != 'courseitem' and <a class="var it33739" onMouseOver="hilite(33739)" onMouseOut="lolite()" onClick="logVariable('child_array')" href="../../_variables/child_array.html">$child_array</a>['type'] != 'categoryitem') {
<a name="l1887"><span class="linenum">1887</span></a>                      <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a> = <a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>::<a class="function" onClick="logFunction('_fetch_course_tree_recursion')" href="../../_functions/_fetch_course_tree_recursion.html" onMouseOver="funcPopup(event,'_fetch_course_tree_recursion')">_fetch_course_tree_recursion</a>(<a class="var it33739" onMouseOver="hilite(33739)" onMouseOut="lolite()" onClick="logVariable('child_array')" href="../../_variables/child_array.html">$child_array</a>, <a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a>);
<a name="l1888"><span class="linenum">1888</span></a>                      if (!empty(<a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>)) {
<a name="l1889"><span class="linenum">1889</span></a>                          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>['children'][++<a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a>] = <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>;
<a name="l1890"><span class="linenum">1890</span></a>                      }
<a name="l1891"><span class="linenum">1891</span></a>                  }
<a name="l1892"><span class="linenum">1892</span></a>              }
<a name="l1893"><span class="linenum">1893</span></a>          }
<a name="l1894"><span class="linenum">1894</span></a>  
<a name="l1895"><span class="linenum">1895</span></a>          return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l1896"><span class="linenum">1896</span></a>      }
<a name="l1897"><span class="linenum">1897</span></a>  
<a name="l1898"><span class="linenum">1898</span></a>      <span class="comment">/**</span>
<a name="l1899"><span class="linenum">1899</span></a>  <span class="comment">     * Fetches and returns all the children categories and/or grade_items belonging to this category.</span>
<a name="l1900"><span class="linenum">1900</span></a>  <span class="comment">     * By default only returns the immediate children (depth=1), but deeper levels can be requested,</span>
<a name="l1901"><span class="linenum">1901</span></a>  <span class="comment">     * as well as all levels (0). The elements are indexed by sort order.</span>
<a name="l1902"><span class="linenum">1902</span></a>  <span class="comment">     *</span>
<a name="l1903"><span class="linenum">1903</span></a>  <span class="comment">     * @param bool $include_category_items Whether or not to include category grade_items in the children array</span>
<a name="l1904"><span class="linenum">1904</span></a>  <span class="comment">     * @return array Array of child objects (grade_category and grade_item).</span>
<a name="l1905"><span class="linenum">1905</span></a>  <span class="comment">     */</span>
<a name="l1906"><span class="linenum">1906</span></a>      public function <a class="function" onClick="logFunction('get_children')" href="../../_functions/get_children.html" onMouseOver="funcPopup(event,'get_children')">get_children</a>(<a class="var it33738" onMouseOver="hilite(33738)" onMouseOut="lolite()" onClick="logVariable('include_category_items')" href="../../_variables/include_category_items.html">$include_category_items</a>=false) {
<a name="l1907"><span class="linenum">1907</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1908"><span class="linenum">1908</span></a>  
<a name="l1909"><span class="linenum">1909</span></a>  <span class="comment">        // This function must be as fast as possible ;-)</span>
<a name="l1910"><span class="linenum">1910</span></a>  <span class="comment">        // fetch all course grade items and categories into memory - we do not expect hundreds of these in course</span>
<a name="l1911"><span class="linenum">1911</span></a>  <span class="comment">        // we have to limit the number of queries though, because it will be used often in grade reports</span>
<a name="l1912"><span class="linenum">1912</span></a>  
<a name="l1913"><span class="linenum">1913</span></a>          <a class="var it10802" onMouseOver="hilite(10802)" onMouseOut="lolite()" onClick="logVariable('cats')" href="../../_variables/cats.html">$cats</a>  = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('grade_categories', array('courseid' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('courseid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>));
<a name="l1914"><span class="linenum">1914</span></a>          <a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('grade_items', array('courseid' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('courseid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>));
<a name="l1915"><span class="linenum">1915</span></a>  
<a name="l1916"><span class="linenum">1916</span></a>  <span class="comment">        // init children array first</span>
<a name="l1917"><span class="linenum">1917</span></a>          foreach (<a class="var it10802" onMouseOver="hilite(10802)" onMouseOut="lolite()" onClick="logVariable('cats')" href="../../_variables/cats.html">$cats</a> as <a class="var it5174" onMouseOver="hilite(5174)" onMouseOut="lolite()" onClick="logVariable('catid')" href="../../_variables/catid.html">$catid</a>=&gt;<a class="var it4945" onMouseOver="hilite(4945)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a>) {
<a name="l1918"><span class="linenum">1918</span></a>              <a class="var it10802" onMouseOver="hilite(10802)" onMouseOut="lolite()" onClick="logVariable('cats')" href="../../_variables/cats.html">$cats</a>[<a class="var it5174" onMouseOver="hilite(5174)" onMouseOut="lolite()" onClick="logVariable('catid')" href="../../_variables/catid.html">$catid</a>]-&gt;children = array();
<a name="l1919"><span class="linenum">1919</span></a>          }
<a name="l1920"><span class="linenum">1920</span></a>  
<a name="l1921"><span class="linenum">1921</span></a>  <span class="comment">        //first attach items to cats and add category sortorder</span>
<a name="l1922"><span class="linenum">1922</span></a>          foreach (<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a> as <a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>) {
<a name="l1923"><span class="linenum">1923</span></a>  
<a name="l1924"><span class="linenum">1924</span></a>              if (<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>-&gt;<a onClick="logVariable('itemtype')" class="var it39599" onMouseOver="hilite(39599)" onMouseOut="lolite()" href="../../_variables/itemtype.html">itemtype</a> == 'course' or <a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>-&gt;<a onClick="logVariable('itemtype')" class="var it39599" onMouseOver="hilite(39599)" onMouseOut="lolite()" href="../../_variables/itemtype.html">itemtype</a> == 'category') {
<a name="l1925"><span class="linenum">1925</span></a>                  <a class="var it10802" onMouseOver="hilite(10802)" onMouseOut="lolite()" onClick="logVariable('cats')" href="../../_variables/cats.html">$cats</a>[<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>-&gt;<a onClick="logVariable('iteminstance')" class="var it39599" onMouseOver="hilite(39599)" onMouseOut="lolite()" href="../../_variables/iteminstance.html">iteminstance</a>]-&gt;sortorder = <a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>-&gt;<a onClick="logVariable('sortorder')" class="var it39599" onMouseOver="hilite(39599)" onMouseOut="lolite()" href="../../_variables/sortorder.html">sortorder</a>;
<a name="l1926"><span class="linenum">1926</span></a>  
<a name="l1927"><span class="linenum">1927</span></a>                  if (!<a class="var it33738" onMouseOver="hilite(33738)" onMouseOut="lolite()" onClick="logVariable('include_category_items')" href="../../_variables/include_category_items.html">$include_category_items</a>) {
<a name="l1928"><span class="linenum">1928</span></a>                      continue;
<a name="l1929"><span class="linenum">1929</span></a>                  }
<a name="l1930"><span class="linenum">1930</span></a>                  <a class="var it1252" onMouseOver="hilite(1252)" onMouseOut="lolite()" onClick="logVariable('categoryid')" href="../../_variables/categoryid.html">$categoryid</a> = <a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>-&gt;<a onClick="logVariable('iteminstance')" class="var it39599" onMouseOver="hilite(39599)" onMouseOut="lolite()" href="../../_variables/iteminstance.html">iteminstance</a>;
<a name="l1931"><span class="linenum">1931</span></a>  
<a name="l1932"><span class="linenum">1932</span></a>              } else {
<a name="l1933"><span class="linenum">1933</span></a>                  <a class="var it1252" onMouseOver="hilite(1252)" onMouseOut="lolite()" onClick="logVariable('categoryid')" href="../../_variables/categoryid.html">$categoryid</a> = <a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>-&gt;<a onClick="logVariable('categoryid')" class="var it39599" onMouseOver="hilite(39599)" onMouseOut="lolite()" href="../../_variables/categoryid.html">categoryid</a>;
<a name="l1934"><span class="linenum">1934</span></a>                  if (empty(<a class="var it1252" onMouseOver="hilite(1252)" onMouseOut="lolite()" onClick="logVariable('categoryid')" href="../../_variables/categoryid.html">$categoryid</a>)) {
<a name="l1935"><span class="linenum">1935</span></a>                      <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Found a grade item that isnt in a category');
<a name="l1936"><span class="linenum">1936</span></a>                  }
<a name="l1937"><span class="linenum">1937</span></a>              }
<a name="l1938"><span class="linenum">1938</span></a>  
<a name="l1939"><span class="linenum">1939</span></a>  <span class="comment">            // prevent problems with duplicate sortorders in db</span>
<a name="l1940"><span class="linenum">1940</span></a>              <a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a> = <a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>-&gt;<a onClick="logVariable('sortorder')" class="var it39599" onMouseOver="hilite(39599)" onMouseOut="lolite()" href="../../_variables/sortorder.html">sortorder</a>;
<a name="l1941"><span class="linenum">1941</span></a>  
<a name="l1942"><span class="linenum">1942</span></a>              while (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it1252" onMouseOver="hilite(1252)" onMouseOut="lolite()" onClick="logVariable('categoryid')" href="../../_variables/categoryid.html">$categoryid</a>, <a class="var it10802" onMouseOver="hilite(10802)" onMouseOut="lolite()" onClick="logVariable('cats')" href="../../_variables/cats.html">$cats</a>)
<a name="l1943"><span class="linenum">1943</span></a>                  &amp;&amp; <a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a>, <a class="var it10802" onMouseOver="hilite(10802)" onMouseOut="lolite()" onClick="logVariable('cats')" href="../../_variables/cats.html">$cats</a>[<a class="var it1252" onMouseOver="hilite(1252)" onMouseOut="lolite()" onClick="logVariable('categoryid')" href="../../_variables/categoryid.html">$categoryid</a>]-&gt;children)) {
<a name="l1944"><span class="linenum">1944</span></a>  
<a name="l1945"><span class="linenum">1945</span></a>                  <a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a>++;
<a name="l1946"><span class="linenum">1946</span></a>              }
<a name="l1947"><span class="linenum">1947</span></a>  
<a name="l1948"><span class="linenum">1948</span></a>              <a class="var it10802" onMouseOver="hilite(10802)" onMouseOut="lolite()" onClick="logVariable('cats')" href="../../_variables/cats.html">$cats</a>[<a class="var it1252" onMouseOver="hilite(1252)" onMouseOut="lolite()" onClick="logVariable('categoryid')" href="../../_variables/categoryid.html">$categoryid</a>]-&gt;children[<a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a>] = <a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>;
<a name="l1949"><span class="linenum">1949</span></a>  
<a name="l1950"><span class="linenum">1950</span></a>          }
<a name="l1951"><span class="linenum">1951</span></a>  
<a name="l1952"><span class="linenum">1952</span></a>  <span class="comment">        // now find the requested category and connect categories as children</span>
<a name="l1953"><span class="linenum">1953</span></a>          <a class="var it2246" onMouseOver="hilite(2246)" onMouseOut="lolite()" onClick="logVariable('category')" href="../../_variables/category.html">$category</a> = false;
<a name="l1954"><span class="linenum">1954</span></a>  
<a name="l1955"><span class="linenum">1955</span></a>          foreach (<a class="var it10802" onMouseOver="hilite(10802)" onMouseOut="lolite()" onClick="logVariable('cats')" href="../../_variables/cats.html">$cats</a> as <a class="var it5174" onMouseOver="hilite(5174)" onMouseOut="lolite()" onClick="logVariable('catid')" href="../../_variables/catid.html">$catid</a>=&gt;<a class="var it4945" onMouseOver="hilite(4945)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a>) {
<a name="l1956"><span class="linenum">1956</span></a>  
<a name="l1957"><span class="linenum">1957</span></a>              if (empty(<a class="var it4945" onMouseOver="hilite(4945)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a>-&gt;<a onClick="logVariable('parent')" class="var it39557" onMouseOver="hilite(39557)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>)) {
<a name="l1958"><span class="linenum">1958</span></a>  
<a name="l1959"><span class="linenum">1959</span></a>                  if (<a class="var it4945" onMouseOver="hilite(4945)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a>-&gt;<a onClick="logVariable('path')" class="var it39557" onMouseOver="hilite(39557)" onMouseOut="lolite()" href="../../_variables/path.html">path</a> !== '/'.<a class="var it4945" onMouseOver="hilite(4945)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a>-&gt;<a onClick="logVariable('id')" class="var it39557" onMouseOver="hilite(39557)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>.'/') {
<a name="l1960"><span class="linenum">1960</span></a>                      <a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a> = <span class="keyword">new </span><a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>(<a class="var it4945" onMouseOver="hilite(4945)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a>, false);
<a name="l1961"><span class="linenum">1961</span></a>                      <a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a>-&gt;<a onClick="logVariable('path')" class="var it40058" onMouseOver="hilite(40058)" onMouseOut="lolite()" href="../../_variables/path.html">path</a>  = '/'.<a class="var it4945" onMouseOver="hilite(4945)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a>-&gt;<a onClick="logVariable('id')" class="var it39557" onMouseOver="hilite(39557)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>.'/';
<a name="l1962"><span class="linenum">1962</span></a>                      <a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a>-&gt;<a onClick="logVariable('depth')" class="var it40058" onMouseOver="hilite(40058)" onMouseOut="lolite()" href="../../_variables/depth.html">depth</a> = 1;
<a name="l1963"><span class="linenum">1963</span></a>                      <a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>('system');
<a name="l1964"><span class="linenum">1964</span></a>                      return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_children')" href="../../_functions/get_children.html" onMouseOver="funcPopup(event,'get_children')">get_children</a>(<a class="var it33738" onMouseOver="hilite(33738)" onMouseOut="lolite()" onClick="logVariable('include_category_items')" href="../../_variables/include_category_items.html">$include_category_items</a>);
<a name="l1965"><span class="linenum">1965</span></a>                  }
<a name="l1966"><span class="linenum">1966</span></a>  
<a name="l1967"><span class="linenum">1967</span></a>              } else {
<a name="l1968"><span class="linenum">1968</span></a>  
<a name="l1969"><span class="linenum">1969</span></a>                  if (empty(<a class="var it4945" onMouseOver="hilite(4945)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a>-&gt;<a onClick="logVariable('path')" class="var it39557" onMouseOver="hilite(39557)" onMouseOut="lolite()" href="../../_variables/path.html">path</a>) or !<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('|/'.<a class="var it4945" onMouseOver="hilite(4945)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a>-&gt;<a onClick="logVariable('parent')" class="var it39557" onMouseOver="hilite(39557)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>.'/'.<a class="var it4945" onMouseOver="hilite(4945)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a>-&gt;<a onClick="logVariable('id')" class="var it39557" onMouseOver="hilite(39557)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>.'/$|', <a class="var it4945" onMouseOver="hilite(4945)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a>-&gt;<a onClick="logVariable('path')" class="var it39557" onMouseOver="hilite(39557)" onMouseOut="lolite()" href="../../_variables/path.html">path</a>)) {
<a name="l1970"><span class="linenum">1970</span></a>  <span class="comment">                    //fix paths and depts</span>
<a name="l1971"><span class="linenum">1971</span></a>                      static <a class="var it33740" onMouseOver="hilite(33740)" onMouseOut="lolite()" onClick="logVariable('recursioncounter')" href="../../_variables/recursioncounter.html">$recursioncounter</a> = 0; <span class="comment">// prevents infinite recursion</span>
<a name="l1972"><span class="linenum">1972</span></a>                      <a class="var it33740" onMouseOver="hilite(33740)" onMouseOut="lolite()" onClick="logVariable('recursioncounter')" href="../../_variables/recursioncounter.html">$recursioncounter</a>++;
<a name="l1973"><span class="linenum">1973</span></a>  
<a name="l1974"><span class="linenum">1974</span></a>                      if (<a class="var it33740" onMouseOver="hilite(33740)" onMouseOut="lolite()" onClick="logVariable('recursioncounter')" href="../../_variables/recursioncounter.html">$recursioncounter</a> &lt; 5) {
<a name="l1975"><span class="linenum">1975</span></a>  <span class="comment">                        // fix paths and depths!</span>
<a name="l1976"><span class="linenum">1976</span></a>                          <a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a> = <span class="keyword">new </span><a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>(<a class="var it4945" onMouseOver="hilite(4945)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a>, false);
<a name="l1977"><span class="linenum">1977</span></a>                          <a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a>-&gt;<a onClick="logVariable('depth')" class="var it40058" onMouseOver="hilite(40058)" onMouseOut="lolite()" href="../../_variables/depth.html">depth</a> = 0;
<a name="l1978"><span class="linenum">1978</span></a>                          <a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a>-&gt;<a onClick="logVariable('path')" class="var it40058" onMouseOver="hilite(40058)" onMouseOut="lolite()" href="../../_variables/path.html">path</a>  = null;
<a name="l1979"><span class="linenum">1979</span></a>                          <a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>('system');
<a name="l1980"><span class="linenum">1980</span></a>                          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_children')" href="../../_functions/get_children.html" onMouseOver="funcPopup(event,'get_children')">get_children</a>(<a class="var it33738" onMouseOver="hilite(33738)" onMouseOut="lolite()" onClick="logVariable('include_category_items')" href="../../_variables/include_category_items.html">$include_category_items</a>);
<a name="l1981"><span class="linenum">1981</span></a>                      }
<a name="l1982"><span class="linenum">1982</span></a>                  }
<a name="l1983"><span class="linenum">1983</span></a>  <span class="comment">                // prevent problems with duplicate sortorders in db</span>
<a name="l1984"><span class="linenum">1984</span></a>                  <a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a> = <a class="var it4945" onMouseOver="hilite(4945)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a>-&gt;<a onClick="logVariable('sortorder')" class="var it39557" onMouseOver="hilite(39557)" onMouseOut="lolite()" href="../../_variables/sortorder.html">sortorder</a>;
<a name="l1985"><span class="linenum">1985</span></a>  
<a name="l1986"><span class="linenum">1986</span></a>                  while (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a>, <a class="var it10802" onMouseOver="hilite(10802)" onMouseOut="lolite()" onClick="logVariable('cats')" href="../../_variables/cats.html">$cats</a>[<a class="var it4945" onMouseOver="hilite(4945)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a>-&gt;<a onClick="logVariable('parent')" class="var it39557" onMouseOver="hilite(39557)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>]-&gt;children)) {
<a name="l1987"><span class="linenum">1987</span></a>  <span class="comment">                    //debugging(&quot;$sortorder exists in cat loop&quot;);</span>
<a name="l1988"><span class="linenum">1988</span></a>                      <a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a>++;
<a name="l1989"><span class="linenum">1989</span></a>                  }
<a name="l1990"><span class="linenum">1990</span></a>  
<a name="l1991"><span class="linenum">1991</span></a>                  <a class="var it10802" onMouseOver="hilite(10802)" onMouseOut="lolite()" onClick="logVariable('cats')" href="../../_variables/cats.html">$cats</a>[<a class="var it4945" onMouseOver="hilite(4945)" onMouseOut="lolite()" onClick="logVariable('cat')" href="../../_variables/cat.html">$cat</a>-&gt;<a onClick="logVariable('parent')" class="var it39557" onMouseOver="hilite(39557)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>]-&gt;children[<a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a>] = &amp;<a class="var it10802" onMouseOver="hilite(10802)" onMouseOut="lolite()" onClick="logVariable('cats')" href="../../_variables/cats.html">$cats</a>[<a class="var it5174" onMouseOver="hilite(5174)" onMouseOut="lolite()" onClick="logVariable('catid')" href="../../_variables/catid.html">$catid</a>];
<a name="l1992"><span class="linenum">1992</span></a>              }
<a name="l1993"><span class="linenum">1993</span></a>  
<a name="l1994"><span class="linenum">1994</span></a>              if (<a class="var it5174" onMouseOver="hilite(5174)" onMouseOut="lolite()" onClick="logVariable('catid')" href="../../_variables/catid.html">$catid</a> == <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('id')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>) {
<a name="l1995"><span class="linenum">1995</span></a>                  <a class="var it2246" onMouseOver="hilite(2246)" onMouseOut="lolite()" onClick="logVariable('category')" href="../../_variables/category.html">$category</a> = &amp;<a class="var it10802" onMouseOver="hilite(10802)" onMouseOut="lolite()" onClick="logVariable('cats')" href="../../_variables/cats.html">$cats</a>[<a class="var it5174" onMouseOver="hilite(5174)" onMouseOut="lolite()" onClick="logVariable('catid')" href="../../_variables/catid.html">$catid</a>];
<a name="l1996"><span class="linenum">1996</span></a>              }
<a name="l1997"><span class="linenum">1997</span></a>          }
<a name="l1998"><span class="linenum">1998</span></a>  
<a name="l1999"><span class="linenum">1999</span></a>          unset(<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>); <span class="comment">// not needed</span>
<a name="l2000"><span class="linenum">2000</span></a>          unset(<a class="var it10802" onMouseOver="hilite(10802)" onMouseOut="lolite()" onClick="logVariable('cats')" href="../../_variables/cats.html">$cats</a>); <span class="comment">// not needed</span>
<a name="l2001"><span class="linenum">2001</span></a>  
<a name="l2002"><span class="linenum">2002</span></a>          <a class="var it24189" onMouseOver="hilite(24189)" onMouseOut="lolite()" onClick="logVariable('children_array')" href="../../_variables/children_array.html">$children_array</a> = <a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>::<a class="function" onClick="logFunction('_get_children_recursion')" href="../../_functions/_get_children_recursion.html" onMouseOver="funcPopup(event,'_get_children_recursion')">_get_children_recursion</a>(<a class="var it2246" onMouseOver="hilite(2246)" onMouseOut="lolite()" onClick="logVariable('category')" href="../../_variables/category.html">$category</a>);
<a name="l2003"><span class="linenum">2003</span></a>  
<a name="l2004"><span class="linenum">2004</span></a>          <a class="phpfunction" onClick="logFunction('ksort')" href="../../_functions/ksort.html" onMouseOver="phpfuncPopup(event,'ksort')">ksort</a>(<a class="var it24189" onMouseOver="hilite(24189)" onMouseOut="lolite()" onClick="logVariable('children_array')" href="../../_variables/children_array.html">$children_array</a>);
<a name="l2005"><span class="linenum">2005</span></a>  
<a name="l2006"><span class="linenum">2006</span></a>          return <a class="var it24189" onMouseOver="hilite(24189)" onMouseOut="lolite()" onClick="logVariable('children_array')" href="../../_variables/children_array.html">$children_array</a>;
<a name="l2007"><span class="linenum">2007</span></a>  
<a name="l2008"><span class="linenum">2008</span></a>      }
<a name="l2009"><span class="linenum">2009</span></a>  
<a name="l2010"><span class="linenum">2010</span></a>      <span class="comment">/**</span>
<a name="l2011"><span class="linenum">2011</span></a>  <span class="comment">     * Private method used to retrieve all children of this category recursively</span>
<a name="l2012"><span class="linenum">2012</span></a>  <span class="comment">     *</span>
<a name="l2013"><span class="linenum">2013</span></a>  <span class="comment">     * @param grade_category $category Source of current recursion</span>
<a name="l2014"><span class="linenum">2014</span></a>  <span class="comment">     * @return array An array of child grade categories</span>
<a name="l2015"><span class="linenum">2015</span></a>  <span class="comment">     */</span>
<a name="l2016"><span class="linenum">2016</span></a>      private static function <a class="function" onClick="logFunction('_get_children_recursion')" href="../../_functions/_get_children_recursion.html" onMouseOver="funcPopup(event,'_get_children_recursion')">_get_children_recursion</a>(<a class="var it2246" onMouseOver="hilite(2246)" onMouseOut="lolite()" onClick="logVariable('category')" href="../../_variables/category.html">$category</a>) {
<a name="l2017"><span class="linenum">2017</span></a>  
<a name="l2018"><span class="linenum">2018</span></a>          <a class="var it24189" onMouseOver="hilite(24189)" onMouseOut="lolite()" onClick="logVariable('children_array')" href="../../_variables/children_array.html">$children_array</a> = array();
<a name="l2019"><span class="linenum">2019</span></a>          foreach (<a class="var it2246" onMouseOver="hilite(2246)" onMouseOut="lolite()" onClick="logVariable('category')" href="../../_variables/category.html">$category</a>-&gt;<a onClick="logVariable('children')" class="var it39558" onMouseOver="hilite(39558)" onMouseOut="lolite()" href="../../_variables/children.html">children</a> as <a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a>=&gt;<a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>) {
<a name="l2020"><span class="linenum">2020</span></a>  
<a name="l2021"><span class="linenum">2021</span></a>              if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>('itemtype', <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>)) {
<a name="l2022"><span class="linenum">2022</span></a>                  <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a> = <span class="keyword">new </span><a class="class" onClick="logClass('grade_item')" href="../../_classes/grade_item.html" onMouseOver="classPopup(event,'grade_item')">grade_item</a>(<a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>, false);
<a name="l2023"><span class="linenum">2023</span></a>  
<a name="l2024"><span class="linenum">2024</span></a>                  if (<a class="phpfunction" onClick="logFunction('in_array')" href="../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>-&gt;<a onClick="logVariable('itemtype')" class="var it39507" onMouseOver="hilite(39507)" onMouseOut="lolite()" href="../../_variables/itemtype.html">itemtype</a>, array('course', 'category'))) {
<a name="l2025"><span class="linenum">2025</span></a>                      <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>  = <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>-&gt;<a onClick="logVariable('itemtype')" class="var it39507" onMouseOver="hilite(39507)" onMouseOut="lolite()" href="../../_variables/itemtype.html">itemtype</a>.'item';
<a name="l2026"><span class="linenum">2026</span></a>                      <a class="var it250" onMouseOver="hilite(250)" onMouseOut="lolite()" onClick="logVariable('depth')" href="../../_variables/depth.html">$depth</a> = <a class="var it2246" onMouseOver="hilite(2246)" onMouseOut="lolite()" onClick="logVariable('category')" href="../../_variables/category.html">$category</a>-&gt;<a onClick="logVariable('depth')" class="var it39558" onMouseOver="hilite(39558)" onMouseOut="lolite()" href="../../_variables/depth.html">depth</a>;
<a name="l2027"><span class="linenum">2027</span></a>  
<a name="l2028"><span class="linenum">2028</span></a>                  } else {
<a name="l2029"><span class="linenum">2029</span></a>                      <a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>  = 'item';
<a name="l2030"><span class="linenum">2030</span></a>                      <a class="var it250" onMouseOver="hilite(250)" onMouseOut="lolite()" onClick="logVariable('depth')" href="../../_variables/depth.html">$depth</a> = <a class="var it2246" onMouseOver="hilite(2246)" onMouseOut="lolite()" onClick="logVariable('category')" href="../../_variables/category.html">$category</a>-&gt;<a onClick="logVariable('depth')" class="var it39558" onMouseOver="hilite(39558)" onMouseOut="lolite()" href="../../_variables/depth.html">depth</a>; <span class="comment">// we use this to set the same colour</span>
<a name="l2031"><span class="linenum">2031</span></a>                  }
<a name="l2032"><span class="linenum">2032</span></a>                  <a class="var it24189" onMouseOver="hilite(24189)" onMouseOut="lolite()" onClick="logVariable('children_array')" href="../../_variables/children_array.html">$children_array</a>[<a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a>] = array('object'=&gt;<a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>, 'type'=&gt;<a class="var it494" onMouseOver="hilite(494)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>, 'depth'=&gt;<a class="var it250" onMouseOver="hilite(250)" onMouseOut="lolite()" onClick="logVariable('depth')" href="../../_variables/depth.html">$depth</a>);
<a name="l2033"><span class="linenum">2033</span></a>  
<a name="l2034"><span class="linenum">2034</span></a>              } else {
<a name="l2035"><span class="linenum">2035</span></a>                  <a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a> = <a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>::<a class="function" onClick="logFunction('_get_children_recursion')" href="../../_functions/_get_children_recursion.html" onMouseOver="funcPopup(event,'_get_children_recursion')">_get_children_recursion</a>(<a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>);
<a name="l2036"><span class="linenum">2036</span></a>                  <a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a> = <span class="keyword">new </span><a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>(<a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>, false);
<a name="l2037"><span class="linenum">2037</span></a>  
<a name="l2038"><span class="linenum">2038</span></a>                  if (empty(<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a>)) {
<a name="l2039"><span class="linenum">2039</span></a>                      <a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a> = array();
<a name="l2040"><span class="linenum">2040</span></a>                  }
<a name="l2041"><span class="linenum">2041</span></a>                  <a class="var it24189" onMouseOver="hilite(24189)" onMouseOut="lolite()" onClick="logVariable('children_array')" href="../../_variables/children_array.html">$children_array</a>[<a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a>] = array('object'=&gt;<a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a>, 'type'=&gt;'category', 'depth'=&gt;<a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a>-&gt;<a onClick="logVariable('depth')" class="var it40058" onMouseOver="hilite(40058)" onMouseOut="lolite()" href="../../_variables/depth.html">depth</a>, 'children'=&gt;<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a>);
<a name="l2042"><span class="linenum">2042</span></a>              }
<a name="l2043"><span class="linenum">2043</span></a>          }
<a name="l2044"><span class="linenum">2044</span></a>  
<a name="l2045"><span class="linenum">2045</span></a>  <span class="comment">        // sort the array</span>
<a name="l2046"><span class="linenum">2046</span></a>          <a class="phpfunction" onClick="logFunction('ksort')" href="../../_functions/ksort.html" onMouseOver="phpfuncPopup(event,'ksort')">ksort</a>(<a class="var it24189" onMouseOver="hilite(24189)" onMouseOut="lolite()" onClick="logVariable('children_array')" href="../../_variables/children_array.html">$children_array</a>);
<a name="l2047"><span class="linenum">2047</span></a>  
<a name="l2048"><span class="linenum">2048</span></a>          return <a class="var it24189" onMouseOver="hilite(24189)" onMouseOut="lolite()" onClick="logVariable('children_array')" href="../../_variables/children_array.html">$children_array</a>;
<a name="l2049"><span class="linenum">2049</span></a>      }
<a name="l2050"><span class="linenum">2050</span></a>  
<a name="l2051"><span class="linenum">2051</span></a>      <span class="comment">/**</span>
<a name="l2052"><span class="linenum">2052</span></a>  <span class="comment">     * Uses {@link get_grade_item()} to load or create a grade_item, then saves it as $this-&gt;grade_item.</span>
<a name="l2053"><span class="linenum">2053</span></a>  <span class="comment">     *</span>
<a name="l2054"><span class="linenum">2054</span></a>  <span class="comment">     * @return grade_item</span>
<a name="l2055"><span class="linenum">2055</span></a>  <span class="comment">     */</span>
<a name="l2056"><span class="linenum">2056</span></a>      public function <a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>() {
<a name="l2057"><span class="linenum">2057</span></a>          if (empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>)) {
<a name="l2058"><span class="linenum">2058</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_grade_item')" href="../../_functions/get_grade_item.html" onMouseOver="funcPopup(event,'get_grade_item')">get_grade_item</a>();
<a name="l2059"><span class="linenum">2059</span></a>          }
<a name="l2060"><span class="linenum">2060</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>;
<a name="l2061"><span class="linenum">2061</span></a>      }
<a name="l2062"><span class="linenum">2062</span></a>  
<a name="l2063"><span class="linenum">2063</span></a>      <span class="comment">/**</span>
<a name="l2064"><span class="linenum">2064</span></a>  <span class="comment">     * Retrieves this grade categories' associated grade_item from the database</span>
<a name="l2065"><span class="linenum">2065</span></a>  <span class="comment">     *</span>
<a name="l2066"><span class="linenum">2066</span></a>  <span class="comment">     * If no grade_item exists yet, creates one.</span>
<a name="l2067"><span class="linenum">2067</span></a>  <span class="comment">     *</span>
<a name="l2068"><span class="linenum">2068</span></a>  <span class="comment">     * @return grade_item</span>
<a name="l2069"><span class="linenum">2069</span></a>  <span class="comment">     */</span>
<a name="l2070"><span class="linenum">2070</span></a>      public function <a class="function" onClick="logFunction('get_grade_item')" href="../../_functions/get_grade_item.html" onMouseOver="funcPopup(event,'get_grade_item')">get_grade_item</a>() {
<a name="l2071"><span class="linenum">2071</span></a>          if (empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('id')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>)) {
<a name="l2072"><span class="linenum">2072</span></a>              <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(&quot;Attempt to obtain a grade_category's associated grade_item without the category's ID being set.&quot;);
<a name="l2073"><span class="linenum">2073</span></a>              return false;
<a name="l2074"><span class="linenum">2074</span></a>          }
<a name="l2075"><span class="linenum">2075</span></a>  
<a name="l2076"><span class="linenum">2076</span></a>          if (empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('parent')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>)) {
<a name="l2077"><span class="linenum">2077</span></a>              <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('courseid'=&gt;<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('courseid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>, 'itemtype'=&gt;'course', 'iteminstance'=&gt;<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('id')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l2078"><span class="linenum">2078</span></a>  
<a name="l2079"><span class="linenum">2079</span></a>          } else {
<a name="l2080"><span class="linenum">2080</span></a>              <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('courseid'=&gt;<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('courseid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>, 'itemtype'=&gt;'category', 'iteminstance'=&gt;<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('id')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l2081"><span class="linenum">2081</span></a>          }
<a name="l2082"><span class="linenum">2082</span></a>  
<a name="l2083"><span class="linenum">2083</span></a>          if (!<a class="var it6045" onMouseOver="hilite(6045)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../_variables/grade_items.html">$grade_items</a> = <a class="class" onClick="logClass('grade_item')" href="../../_classes/grade_item.html" onMouseOver="classPopup(event,'grade_item')">grade_item</a>::<a class="function" onClick="logFunction('fetch_all')" href="../../_functions/fetch_all.html" onMouseOver="funcPopup(event,'fetch_all')">fetch_all</a>(<a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>)) {
<a name="l2084"><span class="linenum">2084</span></a>  <span class="comment">            // create a new one</span>
<a name="l2085"><span class="linenum">2085</span></a>              <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a> = <span class="keyword">new </span><a class="class" onClick="logClass('grade_item')" href="../../_classes/grade_item.html" onMouseOver="classPopup(event,'grade_item')">grade_item</a>(<a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, false);
<a name="l2086"><span class="linenum">2086</span></a>              <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>-&gt;<a onClick="logVariable('gradetype')" class="var it39507" onMouseOver="hilite(39507)" onMouseOut="lolite()" href="../../_variables/gradetype.html">gradetype</a> = <a class="constant" onClick="logConstant('GRADE_TYPE_VALUE')" href="../../_constants/GRADE_TYPE_VALUE.html" onMouseOver="constPopup(event,'GRADE_TYPE_VALUE')">GRADE_TYPE_VALUE</a>;
<a name="l2087"><span class="linenum">2087</span></a>              <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>-&gt;<a class="function" onClick="logFunction('insert')" href="../../_functions/insert.html" onMouseOver="funcPopup(event,'insert')">insert</a>('system');
<a name="l2088"><span class="linenum">2088</span></a>  
<a name="l2089"><span class="linenum">2089</span></a>          } else if (<a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it6045" onMouseOver="hilite(6045)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../_variables/grade_items.html">$grade_items</a>) == 1) {
<a name="l2090"><span class="linenum">2090</span></a>  <span class="comment">            // found existing one</span>
<a name="l2091"><span class="linenum">2091</span></a>              <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it6045" onMouseOver="hilite(6045)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../_variables/grade_items.html">$grade_items</a>);
<a name="l2092"><span class="linenum">2092</span></a>  
<a name="l2093"><span class="linenum">2093</span></a>          } else {
<a name="l2094"><span class="linenum">2094</span></a>              <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(&quot;Found more than one grade_item attached to category id:&quot;.<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('id')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l2095"><span class="linenum">2095</span></a>  <span class="comment">            // return first one</span>
<a name="l2096"><span class="linenum">2096</span></a>              <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it6045" onMouseOver="hilite(6045)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../_variables/grade_items.html">$grade_items</a>);
<a name="l2097"><span class="linenum">2097</span></a>          }
<a name="l2098"><span class="linenum">2098</span></a>  
<a name="l2099"><span class="linenum">2099</span></a>          return <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>;
<a name="l2100"><span class="linenum">2100</span></a>      }
<a name="l2101"><span class="linenum">2101</span></a>  
<a name="l2102"><span class="linenum">2102</span></a>      <span class="comment">/**</span>
<a name="l2103"><span class="linenum">2103</span></a>  <span class="comment">     * Uses $this-&gt;parent to instantiate $this-&gt;parent_category based on the referenced record in the DB</span>
<a name="l2104"><span class="linenum">2104</span></a>  <span class="comment">     *</span>
<a name="l2105"><span class="linenum">2105</span></a>  <span class="comment">     * @return grade_category The parent category</span>
<a name="l2106"><span class="linenum">2106</span></a>  <span class="comment">     */</span>
<a name="l2107"><span class="linenum">2107</span></a>      public function <a class="function" onClick="logFunction('load_parent_category')" href="../../_functions/load_parent_category.html" onMouseOver="funcPopup(event,'load_parent_category')">load_parent_category</a>() {
<a name="l2108"><span class="linenum">2108</span></a>          if (empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('parent_category')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/parent_category.html">parent_category</a>) &amp;&amp; !empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('parent')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>)) {
<a name="l2109"><span class="linenum">2109</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('parent_category')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/parent_category.html">parent_category</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_parent_category')" href="../../_functions/get_parent_category.html" onMouseOver="funcPopup(event,'get_parent_category')">get_parent_category</a>();
<a name="l2110"><span class="linenum">2110</span></a>          }
<a name="l2111"><span class="linenum">2111</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('parent_category')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/parent_category.html">parent_category</a>;
<a name="l2112"><span class="linenum">2112</span></a>      }
<a name="l2113"><span class="linenum">2113</span></a>  
<a name="l2114"><span class="linenum">2114</span></a>      <span class="comment">/**</span>
<a name="l2115"><span class="linenum">2115</span></a>  <span class="comment">     * Uses $this-&gt;parent to instantiate and return a grade_category object</span>
<a name="l2116"><span class="linenum">2116</span></a>  <span class="comment">     *</span>
<a name="l2117"><span class="linenum">2117</span></a>  <span class="comment">     * @return grade_category Returns the parent category or null if this category has no parent</span>
<a name="l2118"><span class="linenum">2118</span></a>  <span class="comment">     */</span>
<a name="l2119"><span class="linenum">2119</span></a>      public function <a class="function" onClick="logFunction('get_parent_category')" href="../../_functions/get_parent_category.html" onMouseOver="funcPopup(event,'get_parent_category')">get_parent_category</a>() {
<a name="l2120"><span class="linenum">2120</span></a>          if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('parent')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>)) {
<a name="l2121"><span class="linenum">2121</span></a>              <a class="var it6486" onMouseOver="hilite(6486)" onMouseOut="lolite()" onClick="logVariable('parent_category')" href="../../_variables/parent_category.html">$parent_category</a> = <span class="keyword">new </span><a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>(array('id' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('parent')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>));
<a name="l2122"><span class="linenum">2122</span></a>              return <a class="var it6486" onMouseOver="hilite(6486)" onMouseOut="lolite()" onClick="logVariable('parent_category')" href="../../_variables/parent_category.html">$parent_category</a>;
<a name="l2123"><span class="linenum">2123</span></a>          } else {
<a name="l2124"><span class="linenum">2124</span></a>              return null;
<a name="l2125"><span class="linenum">2125</span></a>          }
<a name="l2126"><span class="linenum">2126</span></a>      }
<a name="l2127"><span class="linenum">2127</span></a>  
<a name="l2128"><span class="linenum">2128</span></a>      <span class="comment">/**</span>
<a name="l2129"><span class="linenum">2129</span></a>  <span class="comment">     * Returns the most descriptive field for this grade category</span>
<a name="l2130"><span class="linenum">2130</span></a>  <span class="comment">     *</span>
<a name="l2131"><span class="linenum">2131</span></a>  <span class="comment">     * @return string name</span>
<a name="l2132"><span class="linenum">2132</span></a>  <span class="comment">     */</span>
<a name="l2133"><span class="linenum">2133</span></a>      public function <a class="function" onClick="logFunction('get_name')" href="../../_functions/get_name.html" onMouseOver="funcPopup(event,'get_name')">get_name</a>() {
<a name="l2134"><span class="linenum">2134</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l2135"><span class="linenum">2135</span></a>  <span class="comment">        // For a course category, we return the course name if the fullname is set to '?' in the DB (empty in the category edit form)</span>
<a name="l2136"><span class="linenum">2136</span></a>          if (empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('parent')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>) &amp;&amp; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('fullname')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/fullname.html">fullname</a> == '?') {
<a name="l2137"><span class="linenum">2137</span></a>              <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('course', array('id'=&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('courseid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>));
<a name="l2138"><span class="linenum">2138</span></a>              return <a class="function" onClick="logFunction('format_string')" href="../../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('fullname')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../../_variables/fullname.html">fullname</a>);
<a name="l2139"><span class="linenum">2139</span></a>  
<a name="l2140"><span class="linenum">2140</span></a>          } else {
<a name="l2141"><span class="linenum">2141</span></a>              return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('fullname')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/fullname.html">fullname</a>;
<a name="l2142"><span class="linenum">2142</span></a>          }
<a name="l2143"><span class="linenum">2143</span></a>      }
<a name="l2144"><span class="linenum">2144</span></a>  
<a name="l2145"><span class="linenum">2145</span></a>      <span class="comment">/**</span>
<a name="l2146"><span class="linenum">2146</span></a>  <span class="comment">     * Describe the aggregation settings for this category so the reports make more sense.</span>
<a name="l2147"><span class="linenum">2147</span></a>  <span class="comment">     *</span>
<a name="l2148"><span class="linenum">2148</span></a>  <span class="comment">     * @return string description</span>
<a name="l2149"><span class="linenum">2149</span></a>  <span class="comment">     */</span>
<a name="l2150"><span class="linenum">2150</span></a>      public function <a class="function" onClick="logFunction('get_description')" href="../../_functions/get_description.html" onMouseOver="funcPopup(event,'get_description')">get_description</a>() {
<a name="l2151"><span class="linenum">2151</span></a>          <a class="var it33741" onMouseOver="hilite(33741)" onMouseOut="lolite()" onClick="logVariable('allhelp')" href="../../_variables/allhelp.html">$allhelp</a> = array();
<a name="l2152"><span class="linenum">2152</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregation')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregation.html">aggregation</a> != <a class="constant" onClick="logConstant('GRADE_AGGREGATE_SUM')" href="../../_constants/GRADE_AGGREGATE_SUM.html" onMouseOver="constPopup(event,'GRADE_AGGREGATE_SUM')">GRADE_AGGREGATE_SUM</a>) {
<a name="l2153"><span class="linenum">2153</span></a>              <a class="var it30119" onMouseOver="hilite(30119)" onMouseOut="lolite()" onClick="logVariable('aggrstrings')" href="../../_variables/aggrstrings.html">$aggrstrings</a> = grade_helper::<a class="function" onClick="logFunction('get_aggregation_strings')" href="../../_functions/get_aggregation_strings.html" onMouseOver="funcPopup(event,'get_aggregation_strings')">get_aggregation_strings</a>();
<a name="l2154"><span class="linenum">2154</span></a>              <a class="var it33741" onMouseOver="hilite(33741)" onMouseOut="lolite()" onClick="logVariable('allhelp')" href="../../_variables/allhelp.html">$allhelp</a>[] = <a class="var it30119" onMouseOver="hilite(30119)" onMouseOut="lolite()" onClick="logVariable('aggrstrings')" href="../../_variables/aggrstrings.html">$aggrstrings</a>[<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregation')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregation.html">aggregation</a>];
<a name="l2155"><span class="linenum">2155</span></a>          }
<a name="l2156"><span class="linenum">2156</span></a>  
<a name="l2157"><span class="linenum">2157</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('droplow')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/droplow.html">droplow</a> &amp;&amp; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('can_apply_limit_rules')" href="../../_functions/can_apply_limit_rules.html" onMouseOver="funcPopup(event,'can_apply_limit_rules')">can_apply_limit_rules</a>()) {
<a name="l2158"><span class="linenum">2158</span></a>              <a class="var it33741" onMouseOver="hilite(33741)" onMouseOut="lolite()" onClick="logVariable('allhelp')" href="../../_variables/allhelp.html">$allhelp</a>[] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('droplowestvalues', 'grades', <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('droplow')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/droplow.html">droplow</a>);
<a name="l2159"><span class="linenum">2159</span></a>          }
<a name="l2160"><span class="linenum">2160</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('keephigh')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/keephigh.html">keephigh</a> &amp;&amp; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('can_apply_limit_rules')" href="../../_functions/can_apply_limit_rules.html" onMouseOver="funcPopup(event,'can_apply_limit_rules')">can_apply_limit_rules</a>()) {
<a name="l2161"><span class="linenum">2161</span></a>              <a class="var it33741" onMouseOver="hilite(33741)" onMouseOut="lolite()" onClick="logVariable('allhelp')" href="../../_variables/allhelp.html">$allhelp</a>[] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('keephighestvalues', 'grades', <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('keephigh')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/keephigh.html">keephigh</a>);
<a name="l2162"><span class="linenum">2162</span></a>          }
<a name="l2163"><span class="linenum">2163</span></a>          if (!<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregateonlygraded')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregateonlygraded.html">aggregateonlygraded</a>) {
<a name="l2164"><span class="linenum">2164</span></a>              <a class="var it33741" onMouseOver="hilite(33741)" onMouseOut="lolite()" onClick="logVariable('allhelp')" href="../../_variables/allhelp.html">$allhelp</a>[] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('aggregatenotonlygraded', 'grades');
<a name="l2165"><span class="linenum">2165</span></a>          }
<a name="l2166"><span class="linenum">2166</span></a>          if (<a class="var it33741" onMouseOver="hilite(33741)" onMouseOut="lolite()" onClick="logVariable('allhelp')" href="../../_variables/allhelp.html">$allhelp</a>) {
<a name="l2167"><span class="linenum">2167</span></a>              return <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>('. ', <a class="var it33741" onMouseOver="hilite(33741)" onMouseOut="lolite()" onClick="logVariable('allhelp')" href="../../_variables/allhelp.html">$allhelp</a>) . '.';
<a name="l2168"><span class="linenum">2168</span></a>          }
<a name="l2169"><span class="linenum">2169</span></a>          return '';
<a name="l2170"><span class="linenum">2170</span></a>      }
<a name="l2171"><span class="linenum">2171</span></a>  
<a name="l2172"><span class="linenum">2172</span></a>      <span class="comment">/**</span>
<a name="l2173"><span class="linenum">2173</span></a>  <span class="comment">     * Sets this category's parent id</span>
<a name="l2174"><span class="linenum">2174</span></a>  <span class="comment">     *</span>
<a name="l2175"><span class="linenum">2175</span></a>  <span class="comment">     * @param int $parentid The ID of the category that is the new parent to $this</span>
<a name="l2176"><span class="linenum">2176</span></a>  <span class="comment">     * @param string $source From where was the object updated (mod/forum, manual, etc.)</span>
<a name="l2177"><span class="linenum">2177</span></a>  <span class="comment">     * @return bool success</span>
<a name="l2178"><span class="linenum">2178</span></a>  <span class="comment">     */</span>
<a name="l2179"><span class="linenum">2179</span></a>      public function <a class="function" onClick="logFunction('set_parent')" href="../../_functions/set_parent.html" onMouseOver="funcPopup(event,'set_parent')">set_parent</a>(<a class="var it9801" onMouseOver="hilite(9801)" onMouseOut="lolite()" onClick="logVariable('parentid')" href="../../_variables/parentid.html">$parentid</a>, <a class="var it1344" onMouseOver="hilite(1344)" onMouseOut="lolite()" onClick="logVariable('source')" href="../../_variables/source.html">$source</a>=null) {
<a name="l2180"><span class="linenum">2180</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('parent')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a> == <a class="var it9801" onMouseOver="hilite(9801)" onMouseOut="lolite()" onClick="logVariable('parentid')" href="../../_variables/parentid.html">$parentid</a>) {
<a name="l2181"><span class="linenum">2181</span></a>              return true;
<a name="l2182"><span class="linenum">2182</span></a>          }
<a name="l2183"><span class="linenum">2183</span></a>  
<a name="l2184"><span class="linenum">2184</span></a>          if (<a class="var it9801" onMouseOver="hilite(9801)" onMouseOut="lolite()" onClick="logVariable('parentid')" href="../../_variables/parentid.html">$parentid</a> == <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('id')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>) {
<a name="l2185"><span class="linenum">2185</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('cannotassignselfasparent');
<a name="l2186"><span class="linenum">2186</span></a>          }
<a name="l2187"><span class="linenum">2187</span></a>  
<a name="l2188"><span class="linenum">2188</span></a>          if (empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('parent')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>) and <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_course_category')" href="../../_functions/is_course_category.html" onMouseOver="funcPopup(event,'is_course_category')">is_course_category</a>()) {
<a name="l2189"><span class="linenum">2189</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('cannothaveparentcate');
<a name="l2190"><span class="linenum">2190</span></a>          }
<a name="l2191"><span class="linenum">2191</span></a>  
<a name="l2192"><span class="linenum">2192</span></a>  <span class="comment">        // find parent and check course id</span>
<a name="l2193"><span class="linenum">2193</span></a>          if (!<a class="var it6486" onMouseOver="hilite(6486)" onMouseOut="lolite()" onClick="logVariable('parent_category')" href="../../_variables/parent_category.html">$parent_category</a> = <a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>::<a class="function" onClick="logFunction('fetch')" href="../../_functions/fetch.html" onMouseOver="funcPopup(event,'fetch')">fetch</a>(array('id'=&gt;<a class="var it9801" onMouseOver="hilite(9801)" onMouseOut="lolite()" onClick="logVariable('parentid')" href="../../_variables/parentid.html">$parentid</a>, 'courseid'=&gt;<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('courseid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>))) {
<a name="l2194"><span class="linenum">2194</span></a>              return false;
<a name="l2195"><span class="linenum">2195</span></a>          }
<a name="l2196"><span class="linenum">2196</span></a>  
<a name="l2197"><span class="linenum">2197</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('force_regrading')" href="../../_functions/force_regrading.html" onMouseOver="funcPopup(event,'force_regrading')">force_regrading</a>();
<a name="l2198"><span class="linenum">2198</span></a>  
<a name="l2199"><span class="linenum">2199</span></a>  <span class="comment">        // set new parent category</span>
<a name="l2200"><span class="linenum">2200</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('parent')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>          = <a class="var it6486" onMouseOver="hilite(6486)" onMouseOut="lolite()" onClick="logVariable('parent_category')" href="../../_variables/parent_category.html">$parent_category</a>-&gt;<a onClick="logVariable('id')" class="var it40066" onMouseOver="hilite(40066)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l2201"><span class="linenum">2201</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('parent_category')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/parent_category.html">parent_category</a> =&amp; <a class="var it6486" onMouseOver="hilite(6486)" onMouseOut="lolite()" onClick="logVariable('parent_category')" href="../../_variables/parent_category.html">$parent_category</a>;
<a name="l2202"><span class="linenum">2202</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('path')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/path.html">path</a>            = null;       <span class="comment">// remove old path and depth - will be recalculated in update()</span>
<a name="l2203"><span class="linenum">2203</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('depth')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/depth.html">depth</a>           = 0;          <span class="comment">// remove old path and depth - will be recalculated in update()</span>
<a name="l2204"><span class="linenum">2204</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>(<a class="var it1344" onMouseOver="hilite(1344)" onMouseOut="lolite()" onClick="logVariable('source')" href="../../_variables/source.html">$source</a>);
<a name="l2205"><span class="linenum">2205</span></a>  
<a name="l2206"><span class="linenum">2206</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>(<a class="var it1344" onMouseOver="hilite(1344)" onMouseOut="lolite()" onClick="logVariable('source')" href="../../_variables/source.html">$source</a>);
<a name="l2207"><span class="linenum">2207</span></a>      }
<a name="l2208"><span class="linenum">2208</span></a>  
<a name="l2209"><span class="linenum">2209</span></a>      <span class="comment">/**</span>
<a name="l2210"><span class="linenum">2210</span></a>  <span class="comment">     * Returns the final grade values for this grade category.</span>
<a name="l2211"><span class="linenum">2211</span></a>  <span class="comment">     *</span>
<a name="l2212"><span class="linenum">2212</span></a>  <span class="comment">     * @param int $userid Optional user ID to retrieve a single user's final grade</span>
<a name="l2213"><span class="linenum">2213</span></a>  <span class="comment">     * @return mixed An array of all final_grades (stdClass objects) for this grade_item, or a single final_grade.</span>
<a name="l2214"><span class="linenum">2214</span></a>  <span class="comment">     */</span>
<a name="l2215"><span class="linenum">2215</span></a>      public function <a class="function" onClick="logFunction('get_final')" href="../../_functions/get_final.html" onMouseOver="funcPopup(event,'get_final')">get_final</a>(<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>=null) {
<a name="l2216"><span class="linenum">2216</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l2217"><span class="linenum">2217</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('get_final')" href="../../_functions/get_final.html" onMouseOver="funcPopup(event,'get_final')">get_final</a>(<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>);
<a name="l2218"><span class="linenum">2218</span></a>      }
<a name="l2219"><span class="linenum">2219</span></a>  
<a name="l2220"><span class="linenum">2220</span></a>      <span class="comment">/**</span>
<a name="l2221"><span class="linenum">2221</span></a>  <span class="comment">     * Returns the sortorder of the grade categories' associated grade_item</span>
<a name="l2222"><span class="linenum">2222</span></a>  <span class="comment">     *</span>
<a name="l2223"><span class="linenum">2223</span></a>  <span class="comment">     * This method is also available in grade_item for cases where the object type is not known.</span>
<a name="l2224"><span class="linenum">2224</span></a>  <span class="comment">     *</span>
<a name="l2225"><span class="linenum">2225</span></a>  <span class="comment">     * @return int Sort order</span>
<a name="l2226"><span class="linenum">2226</span></a>  <span class="comment">     */</span>
<a name="l2227"><span class="linenum">2227</span></a>      public function <a class="function" onClick="logFunction('get_sortorder')" href="../../_functions/get_sortorder.html" onMouseOver="funcPopup(event,'get_sortorder')">get_sortorder</a>() {
<a name="l2228"><span class="linenum">2228</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l2229"><span class="linenum">2229</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('get_sortorder')" href="../../_functions/get_sortorder.html" onMouseOver="funcPopup(event,'get_sortorder')">get_sortorder</a>();
<a name="l2230"><span class="linenum">2230</span></a>      }
<a name="l2231"><span class="linenum">2231</span></a>  
<a name="l2232"><span class="linenum">2232</span></a>      <span class="comment">/**</span>
<a name="l2233"><span class="linenum">2233</span></a>  <span class="comment">     * Returns the idnumber of the grade categories' associated grade_item.</span>
<a name="l2234"><span class="linenum">2234</span></a>  <span class="comment">     *</span>
<a name="l2235"><span class="linenum">2235</span></a>  <span class="comment">     * This method is also available in grade_item for cases where the object type is not known.</span>
<a name="l2236"><span class="linenum">2236</span></a>  <span class="comment">     *</span>
<a name="l2237"><span class="linenum">2237</span></a>  <span class="comment">     * @return string idnumber</span>
<a name="l2238"><span class="linenum">2238</span></a>  <span class="comment">     */</span>
<a name="l2239"><span class="linenum">2239</span></a>      public function <a class="function" onClick="logFunction('get_idnumber')" href="../../_functions/get_idnumber.html" onMouseOver="funcPopup(event,'get_idnumber')">get_idnumber</a>() {
<a name="l2240"><span class="linenum">2240</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l2241"><span class="linenum">2241</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('get_idnumber')" href="../../_functions/get_idnumber.html" onMouseOver="funcPopup(event,'get_idnumber')">get_idnumber</a>();
<a name="l2242"><span class="linenum">2242</span></a>      }
<a name="l2243"><span class="linenum">2243</span></a>  
<a name="l2244"><span class="linenum">2244</span></a>      <span class="comment">/**</span>
<a name="l2245"><span class="linenum">2245</span></a>  <span class="comment">     * Sets the sortorder variable for this category.</span>
<a name="l2246"><span class="linenum">2246</span></a>  <span class="comment">     *</span>
<a name="l2247"><span class="linenum">2247</span></a>  <span class="comment">     * This method is also available in grade_item, for cases where the object type is not know.</span>
<a name="l2248"><span class="linenum">2248</span></a>  <span class="comment">     *</span>
<a name="l2249"><span class="linenum">2249</span></a>  <span class="comment">     * @param int $sortorder The sortorder to assign to this category</span>
<a name="l2250"><span class="linenum">2250</span></a>  <span class="comment">     */</span>
<a name="l2251"><span class="linenum">2251</span></a>      public function <a class="function" onClick="logFunction('set_sortorder')" href="../../_functions/set_sortorder.html" onMouseOver="funcPopup(event,'set_sortorder')">set_sortorder</a>(<a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a>) {
<a name="l2252"><span class="linenum">2252</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l2253"><span class="linenum">2253</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('set_sortorder')" href="../../_functions/set_sortorder.html" onMouseOver="funcPopup(event,'set_sortorder')">set_sortorder</a>(<a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a>);
<a name="l2254"><span class="linenum">2254</span></a>      }
<a name="l2255"><span class="linenum">2255</span></a>  
<a name="l2256"><span class="linenum">2256</span></a>      <span class="comment">/**</span>
<a name="l2257"><span class="linenum">2257</span></a>  <span class="comment">     * Move this category after the given sortorder</span>
<a name="l2258"><span class="linenum">2258</span></a>  <span class="comment">     *</span>
<a name="l2259"><span class="linenum">2259</span></a>  <span class="comment">     * Does not change the parent</span>
<a name="l2260"><span class="linenum">2260</span></a>  <span class="comment">     *</span>
<a name="l2261"><span class="linenum">2261</span></a>  <span class="comment">     * @param int $sortorder to place after.</span>
<a name="l2262"><span class="linenum">2262</span></a>  <span class="comment">     * @return void</span>
<a name="l2263"><span class="linenum">2263</span></a>  <span class="comment">     */</span>
<a name="l2264"><span class="linenum">2264</span></a>      public function <a class="function" onClick="logFunction('move_after_sortorder')" href="../../_functions/move_after_sortorder.html" onMouseOver="funcPopup(event,'move_after_sortorder')">move_after_sortorder</a>(<a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a>) {
<a name="l2265"><span class="linenum">2265</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l2266"><span class="linenum">2266</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('move_after_sortorder')" href="../../_functions/move_after_sortorder.html" onMouseOver="funcPopup(event,'move_after_sortorder')">move_after_sortorder</a>(<a class="var it4036" onMouseOver="hilite(4036)" onMouseOut="lolite()" onClick="logVariable('sortorder')" href="../../_variables/sortorder.html">$sortorder</a>);
<a name="l2267"><span class="linenum">2267</span></a>      }
<a name="l2268"><span class="linenum">2268</span></a>  
<a name="l2269"><span class="linenum">2269</span></a>      <span class="comment">/**</span>
<a name="l2270"><span class="linenum">2270</span></a>  <span class="comment">     * Return true if this is the top most category that represents the total course grade.</span>
<a name="l2271"><span class="linenum">2271</span></a>  <span class="comment">     *</span>
<a name="l2272"><span class="linenum">2272</span></a>  <span class="comment">     * @return bool</span>
<a name="l2273"><span class="linenum">2273</span></a>  <span class="comment">     */</span>
<a name="l2274"><span class="linenum">2274</span></a>      public function <a class="function" onClick="logFunction('is_course_category')" href="../../_functions/is_course_category.html" onMouseOver="funcPopup(event,'is_course_category')">is_course_category</a>() {
<a name="l2275"><span class="linenum">2275</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l2276"><span class="linenum">2276</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('is_course_item')" href="../../_functions/is_course_item.html" onMouseOver="funcPopup(event,'is_course_item')">is_course_item</a>();
<a name="l2277"><span class="linenum">2277</span></a>      }
<a name="l2278"><span class="linenum">2278</span></a>  
<a name="l2279"><span class="linenum">2279</span></a>      <span class="comment">/**</span>
<a name="l2280"><span class="linenum">2280</span></a>  <span class="comment">     * Return the course level grade_category object</span>
<a name="l2281"><span class="linenum">2281</span></a>  <span class="comment">     *</span>
<a name="l2282"><span class="linenum">2282</span></a>  <span class="comment">     * @param int $courseid The Course ID</span>
<a name="l2283"><span class="linenum">2283</span></a>  <span class="comment">     * @return grade_category Returns the course level grade_category instance</span>
<a name="l2284"><span class="linenum">2284</span></a>  <span class="comment">     */</span>
<a name="l2285"><span class="linenum">2285</span></a>      public static function <a class="function" onClick="logFunction('fetch_course_category')" href="../../_functions/fetch_course_category.html" onMouseOver="funcPopup(event,'fetch_course_category')">fetch_course_category</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>) {
<a name="l2286"><span class="linenum">2286</span></a>          if (empty(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>)) {
<a name="l2287"><span class="linenum">2287</span></a>              <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Missing course id!');
<a name="l2288"><span class="linenum">2288</span></a>              return false;
<a name="l2289"><span class="linenum">2289</span></a>          }
<a name="l2290"><span class="linenum">2290</span></a>  
<a name="l2291"><span class="linenum">2291</span></a>  <span class="comment">        // course category has no parent</span>
<a name="l2292"><span class="linenum">2292</span></a>          if (<a class="var it9997" onMouseOver="hilite(9997)" onMouseOut="lolite()" onClick="logVariable('course_category')" href="../../_variables/course_category.html">$course_category</a> = <a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>::<a class="function" onClick="logFunction('fetch')" href="../../_functions/fetch.html" onMouseOver="funcPopup(event,'fetch')">fetch</a>(array('courseid'=&gt;<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>, 'parent'=&gt;null))) {
<a name="l2293"><span class="linenum">2293</span></a>              return <a class="var it9997" onMouseOver="hilite(9997)" onMouseOut="lolite()" onClick="logVariable('course_category')" href="../../_variables/course_category.html">$course_category</a>;
<a name="l2294"><span class="linenum">2294</span></a>          }
<a name="l2295"><span class="linenum">2295</span></a>  
<a name="l2296"><span class="linenum">2296</span></a>  <span class="comment">        // create a new one</span>
<a name="l2297"><span class="linenum">2297</span></a>          <a class="var it9997" onMouseOver="hilite(9997)" onMouseOut="lolite()" onClick="logVariable('course_category')" href="../../_variables/course_category.html">$course_category</a> = <span class="keyword">new </span><a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>();
<a name="l2298"><span class="linenum">2298</span></a>          <a class="var it9997" onMouseOver="hilite(9997)" onMouseOut="lolite()" onClick="logVariable('course_category')" href="../../_variables/course_category.html">$course_category</a>-&gt;<a class="function" onClick="logFunction('insert_course_category')" href="../../_functions/insert_course_category.html" onMouseOver="funcPopup(event,'insert_course_category')">insert_course_category</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>);
<a name="l2299"><span class="linenum">2299</span></a>  
<a name="l2300"><span class="linenum">2300</span></a>          return <a class="var it9997" onMouseOver="hilite(9997)" onMouseOut="lolite()" onClick="logVariable('course_category')" href="../../_variables/course_category.html">$course_category</a>;
<a name="l2301"><span class="linenum">2301</span></a>      }
<a name="l2302"><span class="linenum">2302</span></a>  
<a name="l2303"><span class="linenum">2303</span></a>      <span class="comment">/**</span>
<a name="l2304"><span class="linenum">2304</span></a>  <span class="comment">     * Is grading object editable?</span>
<a name="l2305"><span class="linenum">2305</span></a>  <span class="comment">     *</span>
<a name="l2306"><span class="linenum">2306</span></a>  <span class="comment">     * @return bool</span>
<a name="l2307"><span class="linenum">2307</span></a>  <span class="comment">     */</span>
<a name="l2308"><span class="linenum">2308</span></a>      public function <a class="function" onClick="logFunction('is_editable')" href="../../_functions/is_editable.html" onMouseOver="funcPopup(event,'is_editable')">is_editable</a>() {
<a name="l2309"><span class="linenum">2309</span></a>          return true;
<a name="l2310"><span class="linenum">2310</span></a>      }
<a name="l2311"><span class="linenum">2311</span></a>  
<a name="l2312"><span class="linenum">2312</span></a>      <span class="comment">/**</span>
<a name="l2313"><span class="linenum">2313</span></a>  <span class="comment">     * Returns the locked state/date of the grade categories' associated grade_item.</span>
<a name="l2314"><span class="linenum">2314</span></a>  <span class="comment">     *</span>
<a name="l2315"><span class="linenum">2315</span></a>  <span class="comment">     * This method is also available in grade_item, for cases where the object type is not known.</span>
<a name="l2316"><span class="linenum">2316</span></a>  <span class="comment">     *</span>
<a name="l2317"><span class="linenum">2317</span></a>  <span class="comment">     * @return bool</span>
<a name="l2318"><span class="linenum">2318</span></a>  <span class="comment">     */</span>
<a name="l2319"><span class="linenum">2319</span></a>      public function <a class="function" onClick="logFunction('is_locked')" href="../../_functions/is_locked.html" onMouseOver="funcPopup(event,'is_locked')">is_locked</a>() {
<a name="l2320"><span class="linenum">2320</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l2321"><span class="linenum">2321</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('is_locked')" href="../../_functions/is_locked.html" onMouseOver="funcPopup(event,'is_locked')">is_locked</a>();
<a name="l2322"><span class="linenum">2322</span></a>      }
<a name="l2323"><span class="linenum">2323</span></a>  
<a name="l2324"><span class="linenum">2324</span></a>      <span class="comment">/**</span>
<a name="l2325"><span class="linenum">2325</span></a>  <span class="comment">     * Sets the grade_item's locked variable and updates the grade_item.</span>
<a name="l2326"><span class="linenum">2326</span></a>  <span class="comment">     *</span>
<a name="l2327"><span class="linenum">2327</span></a>  <span class="comment">     * Calls set_locked() on the categories' grade_item</span>
<a name="l2328"><span class="linenum">2328</span></a>  <span class="comment">     *</span>
<a name="l2329"><span class="linenum">2329</span></a>  <span class="comment">     * @param int  $lockedstate 0, 1 or a timestamp int(10) after which date the item will be locked.</span>
<a name="l2330"><span class="linenum">2330</span></a>  <span class="comment">     * @param bool $cascade lock/unlock child objects too</span>
<a name="l2331"><span class="linenum">2331</span></a>  <span class="comment">     * @param bool $refresh refresh grades when unlocking</span>
<a name="l2332"><span class="linenum">2332</span></a>  <span class="comment">     * @return bool success if category locked (not all children mayb be locked though)</span>
<a name="l2333"><span class="linenum">2333</span></a>  <span class="comment">     */</span>
<a name="l2334"><span class="linenum">2334</span></a>      public function <a class="function" onClick="logFunction('set_locked')" href="../../_functions/set_locked.html" onMouseOver="funcPopup(event,'set_locked')">set_locked</a>(<a class="var it9999" onMouseOver="hilite(9999)" onMouseOut="lolite()" onClick="logVariable('lockedstate')" href="../../_variables/lockedstate.html">$lockedstate</a>, <a class="var it3056" onMouseOver="hilite(3056)" onMouseOut="lolite()" onClick="logVariable('cascade')" href="../../_variables/cascade.html">$cascade</a>=false, <a class="var it10000" onMouseOver="hilite(10000)" onMouseOut="lolite()" onClick="logVariable('refresh')" href="../../_variables/refresh.html">$refresh</a>=true) {
<a name="l2335"><span class="linenum">2335</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l2336"><span class="linenum">2336</span></a>  
<a name="l2337"><span class="linenum">2337</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('set_locked')" href="../../_functions/set_locked.html" onMouseOver="funcPopup(event,'set_locked')">set_locked</a>(<a class="var it9999" onMouseOver="hilite(9999)" onMouseOut="lolite()" onClick="logVariable('lockedstate')" href="../../_variables/lockedstate.html">$lockedstate</a>, <a class="var it3056" onMouseOver="hilite(3056)" onMouseOut="lolite()" onClick="logVariable('cascade')" href="../../_variables/cascade.html">$cascade</a>, true);
<a name="l2338"><span class="linenum">2338</span></a>  
<a name="l2339"><span class="linenum">2339</span></a>          if (<a class="var it3056" onMouseOver="hilite(3056)" onMouseOut="lolite()" onClick="logVariable('cascade')" href="../../_variables/cascade.html">$cascade</a>) {
<a name="l2340"><span class="linenum">2340</span></a>  <span class="comment">            //process all children - items and categories</span>
<a name="l2341"><span class="linenum">2341</span></a>              if (<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a> = <a class="class" onClick="logClass('grade_item')" href="../../_classes/grade_item.html" onMouseOver="classPopup(event,'grade_item')">grade_item</a>::<a class="function" onClick="logFunction('fetch_all')" href="../../_functions/fetch_all.html" onMouseOver="funcPopup(event,'fetch_all')">fetch_all</a>(array('categoryid'=&gt;<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('id')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l2342"><span class="linenum">2342</span></a>  
<a name="l2343"><span class="linenum">2343</span></a>                  foreach (<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a> as <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>) {
<a name="l2344"><span class="linenum">2344</span></a>                      <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>-&gt;<a class="function" onClick="logFunction('set_locked')" href="../../_functions/set_locked.html" onMouseOver="funcPopup(event,'set_locked')">set_locked</a>(<a class="var it9999" onMouseOver="hilite(9999)" onMouseOut="lolite()" onClick="logVariable('lockedstate')" href="../../_variables/lockedstate.html">$lockedstate</a>, true, false);
<a name="l2345"><span class="linenum">2345</span></a>  
<a name="l2346"><span class="linenum">2346</span></a>                      if (empty(<a class="var it9999" onMouseOver="hilite(9999)" onMouseOut="lolite()" onClick="logVariable('lockedstate')" href="../../_variables/lockedstate.html">$lockedstate</a>) and <a class="var it10000" onMouseOver="hilite(10000)" onMouseOut="lolite()" onClick="logVariable('refresh')" href="../../_variables/refresh.html">$refresh</a>) {
<a name="l2347"><span class="linenum">2347</span></a>  <span class="comment">                        //refresh when unlocking</span>
<a name="l2348"><span class="linenum">2348</span></a>                          <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>-&gt;<a class="function" onClick="logFunction('refresh_grades')" href="../../_functions/refresh_grades.html" onMouseOver="funcPopup(event,'refresh_grades')">refresh_grades</a>();
<a name="l2349"><span class="linenum">2349</span></a>                      }
<a name="l2350"><span class="linenum">2350</span></a>                  }
<a name="l2351"><span class="linenum">2351</span></a>              }
<a name="l2352"><span class="linenum">2352</span></a>  
<a name="l2353"><span class="linenum">2353</span></a>              if (<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a> = <a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>::<a class="function" onClick="logFunction('fetch_all')" href="../../_functions/fetch_all.html" onMouseOver="funcPopup(event,'fetch_all')">fetch_all</a>(array('parent'=&gt;<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('id')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l2354"><span class="linenum">2354</span></a>  
<a name="l2355"><span class="linenum">2355</span></a>                  foreach (<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a> as <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>) {
<a name="l2356"><span class="linenum">2356</span></a>                      <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>-&gt;<a class="function" onClick="logFunction('set_locked')" href="../../_functions/set_locked.html" onMouseOver="funcPopup(event,'set_locked')">set_locked</a>(<a class="var it9999" onMouseOver="hilite(9999)" onMouseOut="lolite()" onClick="logVariable('lockedstate')" href="../../_variables/lockedstate.html">$lockedstate</a>, true, true);
<a name="l2357"><span class="linenum">2357</span></a>                  }
<a name="l2358"><span class="linenum">2358</span></a>              }
<a name="l2359"><span class="linenum">2359</span></a>          }
<a name="l2360"><span class="linenum">2360</span></a>  
<a name="l2361"><span class="linenum">2361</span></a>          return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l2362"><span class="linenum">2362</span></a>      }
<a name="l2363"><span class="linenum">2363</span></a>  
<a name="l2364"><span class="linenum">2364</span></a>      <span class="comment">/**</span>
<a name="l2365"><span class="linenum">2365</span></a>  <span class="comment">     * Overrides grade_object::set_properties() to add special handling for changes to category aggregation types</span>
<a name="l2366"><span class="linenum">2366</span></a>  <span class="comment">     *</span>
<a name="l2367"><span class="linenum">2367</span></a>  <span class="comment">     * @param stdClass $instance the object to set the properties on</span>
<a name="l2368"><span class="linenum">2368</span></a>  <span class="comment">     * @param array|stdClass $params Either an associative array or an object containing property name, property value pairs</span>
<a name="l2369"><span class="linenum">2369</span></a>  <span class="comment">     */</span>
<a name="l2370"><span class="linenum">2370</span></a>      public static function <a class="function" onClick="logFunction('set_properties')" href="../../_functions/set_properties.html" onMouseOver="funcPopup(event,'set_properties')">set_properties</a>(&amp;<a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) {
<a name="l2371"><span class="linenum">2371</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l2372"><span class="linenum">2372</span></a>  
<a name="l2373"><span class="linenum">2373</span></a>          parent::<a class="function" onClick="logFunction('set_properties')" href="../../_functions/set_properties.html" onMouseOver="funcPopup(event,'set_properties')">set_properties</a>(<a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l2374"><span class="linenum">2374</span></a>  
<a name="l2375"><span class="linenum">2375</span></a>  <span class="comment">        //if they've changed aggregation type we made need to do some fiddling to provide appropriate defaults</span>
<a name="l2376"><span class="linenum">2376</span></a>          if (!empty(<a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>-&gt;<a onClick="logVariable('aggregation')" class="var it39554" onMouseOver="hilite(39554)" onMouseOut="lolite()" href="../../_variables/aggregation.html">aggregation</a>)) {
<a name="l2377"><span class="linenum">2377</span></a>  
<a name="l2378"><span class="linenum">2378</span></a>  <span class="comment">            //weight and extra credit share a column :( Would like a default of 1 for weight and 0 for extra credit</span>
<a name="l2379"><span class="linenum">2379</span></a>  <span class="comment">            //Flip from the default of 0 to 1 (or vice versa) if ALL items in the category are still set to the old default.</span>
<a name="l2380"><span class="linenum">2380</span></a>              if (self::<a class="function" onClick="logFunction('aggregation_uses_aggregationcoef')" href="../../_functions/aggregation_uses_aggregationcoef.html" onMouseOver="funcPopup(event,'aggregation_uses_aggregationcoef')">aggregation_uses_aggregationcoef</a>(<a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>-&gt;<a onClick="logVariable('aggregation')" class="var it39554" onMouseOver="hilite(39554)" onMouseOut="lolite()" href="../../_variables/aggregation.html">aggregation</a>)) {
<a name="l2381"><span class="linenum">2381</span></a>                  <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = <a class="var it33742" onMouseOver="hilite(33742)" onMouseOut="lolite()" onClick="logVariable('defaultaggregationcoef')" href="../../_variables/defaultaggregationcoef.html">$defaultaggregationcoef</a> = null;
<a name="l2382"><span class="linenum">2382</span></a>  
<a name="l2383"><span class="linenum">2383</span></a>                  if (!self::<a class="function" onClick="logFunction('aggregation_uses_extracredit')" href="../../_functions/aggregation_uses_extracredit.html" onMouseOver="funcPopup(event,'aggregation_uses_extracredit')">aggregation_uses_extracredit</a>(<a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>-&gt;<a onClick="logVariable('aggregation')" class="var it39554" onMouseOver="hilite(39554)" onMouseOut="lolite()" href="../../_variables/aggregation.html">aggregation</a>)) {
<a name="l2384"><span class="linenum">2384</span></a>  <span class="comment">                    //if all items in this category have aggregation coefficient of 0 we can change it to 1 ie evenly weighted</span>
<a name="l2385"><span class="linenum">2385</span></a>                      <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;select <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(id) from {grade_items} where categoryid=:categoryid and aggregationcoef!=0&quot;;
<a name="l2386"><span class="linenum">2386</span></a>                      <a class="var it33742" onMouseOver="hilite(33742)" onMouseOut="lolite()" onClick="logVariable('defaultaggregationcoef')" href="../../_variables/defaultaggregationcoef.html">$defaultaggregationcoef</a> = 1;
<a name="l2387"><span class="linenum">2387</span></a>                  } else {
<a name="l2388"><span class="linenum">2388</span></a>  <span class="comment">                    //if all items in this category have aggregation coefficient of 1 we can change it to 0 ie no extra credit</span>
<a name="l2389"><span class="linenum">2389</span></a>                      <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;select <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(id) from {grade_items} where categoryid=:categoryid and aggregationcoef!=1&quot;;
<a name="l2390"><span class="linenum">2390</span></a>                      <a class="var it33742" onMouseOver="hilite(33742)" onMouseOut="lolite()" onClick="logVariable('defaultaggregationcoef')" href="../../_variables/defaultaggregationcoef.html">$defaultaggregationcoef</a> = 0;
<a name="l2391"><span class="linenum">2391</span></a>                  }
<a name="l2392"><span class="linenum">2392</span></a>  
<a name="l2393"><span class="linenum">2393</span></a>                  <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('categoryid'=&gt;<a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('id')" class="var it39530" onMouseOver="hilite(39530)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l2394"><span class="linenum">2394</span></a>                  <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records_sql')" href="../../_functions/count_records_sql.html" onMouseOver="funcPopup(event,'count_records_sql')">count_records_sql</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l2395"><span class="linenum">2395</span></a>                  if (<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a>===0) { //category is either empty or all items are set to a default value so we can switch defaults
<a name="l2396"><span class="linenum">2396</span></a>                      <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['aggregationcoef'] = <a class="var it33742" onMouseOver="hilite(33742)" onMouseOut="lolite()" onClick="logVariable('defaultaggregationcoef')" href="../../_variables/defaultaggregationcoef.html">$defaultaggregationcoef</a>;
<a name="l2397"><span class="linenum">2397</span></a>                      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>(&quot;update {grade_items} set aggregationcoef=:aggregationcoef where categoryid=:categoryid&quot;,<a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l2398"><span class="linenum">2398</span></a>                  }
<a name="l2399"><span class="linenum">2399</span></a>              }
<a name="l2400"><span class="linenum">2400</span></a>          }
<a name="l2401"><span class="linenum">2401</span></a>      }
<a name="l2402"><span class="linenum">2402</span></a>  
<a name="l2403"><span class="linenum">2403</span></a>      <span class="comment">/**</span>
<a name="l2404"><span class="linenum">2404</span></a>  <span class="comment">     * Sets the grade_item's hidden variable and updates the grade_item.</span>
<a name="l2405"><span class="linenum">2405</span></a>  <span class="comment">     *</span>
<a name="l2406"><span class="linenum">2406</span></a>  <span class="comment">     * Overrides grade_item::set_hidden() to add cascading of the hidden value to grade items in this grade category</span>
<a name="l2407"><span class="linenum">2407</span></a>  <span class="comment">     *</span>
<a name="l2408"><span class="linenum">2408</span></a>  <span class="comment">     * @param int $hidden 0 mean always visible, 1 means always hidden and a number &gt; 1 is a timestamp to hide until</span>
<a name="l2409"><span class="linenum">2409</span></a>  <span class="comment">     * @param bool $cascade apply to child objects too</span>
<a name="l2410"><span class="linenum">2410</span></a>  <span class="comment">     */</span>
<a name="l2411"><span class="linenum">2411</span></a>      public function <a class="function" onClick="logFunction('set_hidden')" href="../../_functions/set_hidden.html" onMouseOver="funcPopup(event,'set_hidden')">set_hidden</a>(<a class="var it1532" onMouseOver="hilite(1532)" onMouseOut="lolite()" onClick="logVariable('hidden')" href="../../_variables/hidden.html">$hidden</a>, <a class="var it3056" onMouseOver="hilite(3056)" onMouseOut="lolite()" onClick="logVariable('cascade')" href="../../_variables/cascade.html">$cascade</a>=false) {
<a name="l2412"><span class="linenum">2412</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l2413"><span class="linenum">2413</span></a>  <span class="comment">        //this hides the associated grade item (the course total)</span>
<a name="l2414"><span class="linenum">2414</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('set_hidden')" href="../../_functions/set_hidden.html" onMouseOver="funcPopup(event,'set_hidden')">set_hidden</a>(<a class="var it1532" onMouseOver="hilite(1532)" onMouseOut="lolite()" onClick="logVariable('hidden')" href="../../_variables/hidden.html">$hidden</a>, <a class="var it3056" onMouseOver="hilite(3056)" onMouseOut="lolite()" onClick="logVariable('cascade')" href="../../_variables/cascade.html">$cascade</a>);
<a name="l2415"><span class="linenum">2415</span></a>  <span class="comment">        //this hides the category itself and everything it contains</span>
<a name="l2416"><span class="linenum">2416</span></a>          parent::<a class="function" onClick="logFunction('set_hidden')" href="../../_functions/set_hidden.html" onMouseOver="funcPopup(event,'set_hidden')">set_hidden</a>(<a class="var it1532" onMouseOver="hilite(1532)" onMouseOut="lolite()" onClick="logVariable('hidden')" href="../../_variables/hidden.html">$hidden</a>, <a class="var it3056" onMouseOver="hilite(3056)" onMouseOut="lolite()" onClick="logVariable('cascade')" href="../../_variables/cascade.html">$cascade</a>);
<a name="l2417"><span class="linenum">2417</span></a>  
<a name="l2418"><span class="linenum">2418</span></a>          if (<a class="var it3056" onMouseOver="hilite(3056)" onMouseOut="lolite()" onClick="logVariable('cascade')" href="../../_variables/cascade.html">$cascade</a>) {
<a name="l2419"><span class="linenum">2419</span></a>  
<a name="l2420"><span class="linenum">2420</span></a>              if (<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a> = <a class="class" onClick="logClass('grade_item')" href="../../_classes/grade_item.html" onMouseOver="classPopup(event,'grade_item')">grade_item</a>::<a class="function" onClick="logFunction('fetch_all')" href="../../_functions/fetch_all.html" onMouseOver="funcPopup(event,'fetch_all')">fetch_all</a>(array('categoryid'=&gt;<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('id')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l2421"><span class="linenum">2421</span></a>  
<a name="l2422"><span class="linenum">2422</span></a>                  foreach (<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a> as <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>) {
<a name="l2423"><span class="linenum">2423</span></a>                      if (<a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>-&gt;<a class="function" onClick="logFunction('can_control_visibility')" href="../../_functions/can_control_visibility.html" onMouseOver="funcPopup(event,'can_control_visibility')">can_control_visibility</a>()) {
<a name="l2424"><span class="linenum">2424</span></a>                          <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>-&gt;<a class="function" onClick="logFunction('set_hidden')" href="../../_functions/set_hidden.html" onMouseOver="funcPopup(event,'set_hidden')">set_hidden</a>(<a class="var it1532" onMouseOver="hilite(1532)" onMouseOut="lolite()" onClick="logVariable('hidden')" href="../../_variables/hidden.html">$hidden</a>, <a class="var it3056" onMouseOver="hilite(3056)" onMouseOut="lolite()" onClick="logVariable('cascade')" href="../../_variables/cascade.html">$cascade</a>);
<a name="l2425"><span class="linenum">2425</span></a>                      }
<a name="l2426"><span class="linenum">2426</span></a>                  }
<a name="l2427"><span class="linenum">2427</span></a>              }
<a name="l2428"><span class="linenum">2428</span></a>  
<a name="l2429"><span class="linenum">2429</span></a>              if (<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a> = <a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>::<a class="function" onClick="logFunction('fetch_all')" href="../../_functions/fetch_all.html" onMouseOver="funcPopup(event,'fetch_all')">fetch_all</a>(array('parent'=&gt;<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('id')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l2430"><span class="linenum">2430</span></a>  
<a name="l2431"><span class="linenum">2431</span></a>                  foreach (<a class="var it1701" onMouseOver="hilite(1701)" onMouseOut="lolite()" onClick="logVariable('children')" href="../../_variables/children.html">$children</a> as <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>) {
<a name="l2432"><span class="linenum">2432</span></a>                      <a class="var it579" onMouseOver="hilite(579)" onMouseOut="lolite()" onClick="logVariable('child')" href="../../_variables/child.html">$child</a>-&gt;<a class="function" onClick="logFunction('set_hidden')" href="../../_functions/set_hidden.html" onMouseOver="funcPopup(event,'set_hidden')">set_hidden</a>(<a class="var it1532" onMouseOver="hilite(1532)" onMouseOut="lolite()" onClick="logVariable('hidden')" href="../../_variables/hidden.html">$hidden</a>, <a class="var it3056" onMouseOver="hilite(3056)" onMouseOut="lolite()" onClick="logVariable('cascade')" href="../../_variables/cascade.html">$cascade</a>);
<a name="l2433"><span class="linenum">2433</span></a>                  }
<a name="l2434"><span class="linenum">2434</span></a>              }
<a name="l2435"><span class="linenum">2435</span></a>          }
<a name="l2436"><span class="linenum">2436</span></a>  
<a name="l2437"><span class="linenum">2437</span></a>  <span class="comment">        //if marking category visible make sure parent category is visible MDL-21367</span>
<a name="l2438"><span class="linenum">2438</span></a>          if( !<a class="var it1532" onMouseOver="hilite(1532)" onMouseOut="lolite()" onClick="logVariable('hidden')" href="../../_variables/hidden.html">$hidden</a> ) {
<a name="l2439"><span class="linenum">2439</span></a>              <a class="var it10001" onMouseOver="hilite(10001)" onMouseOut="lolite()" onClick="logVariable('category_array')" href="../../_variables/category_array.html">$category_array</a> = <a class="class" onClick="logClass('grade_category')" href="../../_classes/grade_category.html" onMouseOver="classPopup(event,'grade_category')">grade_category</a>::<a class="function" onClick="logFunction('fetch_all')" href="../../_functions/fetch_all.html" onMouseOver="funcPopup(event,'fetch_all')">fetch_all</a>(array('id'=&gt;<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('parent')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>));
<a name="l2440"><span class="linenum">2440</span></a>              if (<a class="var it10001" onMouseOver="hilite(10001)" onMouseOut="lolite()" onClick="logVariable('category_array')" href="../../_variables/category_array.html">$category_array</a> &amp;&amp; <a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('parent')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>, <a class="var it10001" onMouseOver="hilite(10001)" onMouseOut="lolite()" onClick="logVariable('category_array')" href="../../_variables/category_array.html">$category_array</a>)) {
<a name="l2441"><span class="linenum">2441</span></a>                  <a class="var it2246" onMouseOver="hilite(2246)" onMouseOut="lolite()" onClick="logVariable('category')" href="../../_variables/category.html">$category</a> = <a class="var it10001" onMouseOver="hilite(10001)" onMouseOut="lolite()" onClick="logVariable('category_array')" href="../../_variables/category_array.html">$category_array</a>[<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('parent')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>];
<a name="l2442"><span class="linenum">2442</span></a>  <span class="comment">                //call set_hidden on the category regardless of whether it is hidden as its parent might be hidden</span>
<a name="l2443"><span class="linenum">2443</span></a>  <span class="comment">                //if($category-&gt;is_hidden()) {</span>
<a name="l2444"><span class="linenum">2444</span></a>                      <a class="var it2246" onMouseOver="hilite(2246)" onMouseOut="lolite()" onClick="logVariable('category')" href="../../_variables/category.html">$category</a>-&gt;<a class="function" onClick="logFunction('set_hidden')" href="../../_functions/set_hidden.html" onMouseOver="funcPopup(event,'set_hidden')">set_hidden</a>(<a class="var it1532" onMouseOver="hilite(1532)" onMouseOut="lolite()" onClick="logVariable('hidden')" href="../../_variables/hidden.html">$hidden</a>, false);
<a name="l2445"><span class="linenum">2445</span></a>  <span class="comment">                //}</span>
<a name="l2446"><span class="linenum">2446</span></a>              }
<a name="l2447"><span class="linenum">2447</span></a>          }
<a name="l2448"><span class="linenum">2448</span></a>      }
<a name="l2449"><span class="linenum">2449</span></a>  
<a name="l2450"><span class="linenum">2450</span></a>      <span class="comment">/**</span>
<a name="l2451"><span class="linenum">2451</span></a>  <span class="comment">     * Applies default settings on this category</span>
<a name="l2452"><span class="linenum">2452</span></a>  <span class="comment">     *</span>
<a name="l2453"><span class="linenum">2453</span></a>  <span class="comment">     * @return bool True if anything changed</span>
<a name="l2454"><span class="linenum">2454</span></a>  <span class="comment">     */</span>
<a name="l2455"><span class="linenum">2455</span></a>      public function <a class="function" onClick="logFunction('apply_default_settings')" href="../../_functions/apply_default_settings.html" onMouseOver="funcPopup(event,'apply_default_settings')">apply_default_settings</a>() {
<a name="l2456"><span class="linenum">2456</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l2457"><span class="linenum">2457</span></a>  
<a name="l2458"><span class="linenum">2458</span></a>          foreach (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('forceable')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/forceable.html">forceable</a> as <a class="var it1682" onMouseOver="hilite(1682)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a>) {
<a name="l2459"><span class="linenum">2459</span></a>  
<a name="l2460"><span class="linenum">2460</span></a>              if (isset(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;{&quot;grade_<a class="var it1682" onMouseOver="hilite(1682)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a>&quot;})) {
<a name="l2461"><span class="linenum">2461</span></a>  
<a name="l2462"><span class="linenum">2462</span></a>                  if (<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;{&quot;grade_<a class="var it1682" onMouseOver="hilite(1682)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a>&quot;} == -1) {
<a name="l2463"><span class="linenum">2463</span></a>                      continue; <span class="comment">//temporary bc before version bump</span>
<a name="l2464"><span class="linenum">2464</span></a>                  }
<a name="l2465"><span class="linenum">2465</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="var it1682" onMouseOver="hilite(1682)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;{&quot;grade_<a class="var it1682" onMouseOver="hilite(1682)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a>&quot;};
<a name="l2466"><span class="linenum">2466</span></a>              }
<a name="l2467"><span class="linenum">2467</span></a>          }
<a name="l2468"><span class="linenum">2468</span></a>      }
<a name="l2469"><span class="linenum">2469</span></a>  
<a name="l2470"><span class="linenum">2470</span></a>      <span class="comment">/**</span>
<a name="l2471"><span class="linenum">2471</span></a>  <span class="comment">     * Applies forced settings on this category</span>
<a name="l2472"><span class="linenum">2472</span></a>  <span class="comment">     *</span>
<a name="l2473"><span class="linenum">2473</span></a>  <span class="comment">     * @return bool True if anything changed</span>
<a name="l2474"><span class="linenum">2474</span></a>  <span class="comment">     */</span>
<a name="l2475"><span class="linenum">2475</span></a>      public function <a class="function" onClick="logFunction('apply_forced_settings')" href="../../_functions/apply_forced_settings.html" onMouseOver="funcPopup(event,'apply_forced_settings')">apply_forced_settings</a>() {
<a name="l2476"><span class="linenum">2476</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l2477"><span class="linenum">2477</span></a>  
<a name="l2478"><span class="linenum">2478</span></a>          <a class="var it8164" onMouseOver="hilite(8164)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../_variables/updated.html">$updated</a> = false;
<a name="l2479"><span class="linenum">2479</span></a>  
<a name="l2480"><span class="linenum">2480</span></a>          foreach (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('forceable')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/forceable.html">forceable</a> as <a class="var it1682" onMouseOver="hilite(1682)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a>) {
<a name="l2481"><span class="linenum">2481</span></a>  
<a name="l2482"><span class="linenum">2482</span></a>              if (isset(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;{&quot;grade_<a class="var it1682" onMouseOver="hilite(1682)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a>&quot;}) and isset(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;{&quot;grade_{<a class="var it1682" onMouseOver="hilite(1682)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a>}_flag&quot;}) and
<a name="l2483"><span class="linenum">2483</span></a>                                                      ((int) <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;{&quot;grade_{<a class="var it1682" onMouseOver="hilite(1682)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a>}_flag&quot;} &amp; 1)) {
<a name="l2484"><span class="linenum">2484</span></a>  
<a name="l2485"><span class="linenum">2485</span></a>                  if (<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;{&quot;grade_<a class="var it1682" onMouseOver="hilite(1682)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a>&quot;} == -1) {
<a name="l2486"><span class="linenum">2486</span></a>                      continue; <span class="comment">//temporary bc before version bump</span>
<a name="l2487"><span class="linenum">2487</span></a>                  }
<a name="l2488"><span class="linenum">2488</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="var it1682" onMouseOver="hilite(1682)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;{&quot;grade_<a class="var it1682" onMouseOver="hilite(1682)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a>&quot;};
<a name="l2489"><span class="linenum">2489</span></a>                  <a class="var it8164" onMouseOver="hilite(8164)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../_variables/updated.html">$updated</a> = true;
<a name="l2490"><span class="linenum">2490</span></a>              }
<a name="l2491"><span class="linenum">2491</span></a>          }
<a name="l2492"><span class="linenum">2492</span></a>  
<a name="l2493"><span class="linenum">2493</span></a>          return <a class="var it8164" onMouseOver="hilite(8164)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../_variables/updated.html">$updated</a>;
<a name="l2494"><span class="linenum">2494</span></a>      }
<a name="l2495"><span class="linenum">2495</span></a>  
<a name="l2496"><span class="linenum">2496</span></a>      <span class="comment">/**</span>
<a name="l2497"><span class="linenum">2497</span></a>  <span class="comment">     * Notification of change in forced category settings.</span>
<a name="l2498"><span class="linenum">2498</span></a>  <span class="comment">     *</span>
<a name="l2499"><span class="linenum">2499</span></a>  <span class="comment">     * Causes all course and category grade items to be marked as needing to be updated</span>
<a name="l2500"><span class="linenum">2500</span></a>  <span class="comment">     */</span>
<a name="l2501"><span class="linenum">2501</span></a>      public static function <a class="function" onClick="logFunction('updated_forced_settings')" href="../../_functions/updated_forced_settings.html" onMouseOver="funcPopup(event,'updated_forced_settings')">updated_forced_settings</a>() {
<a name="l2502"><span class="linenum">2502</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l2503"><span class="linenum">2503</span></a>          <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array(1, 'course', 'category');
<a name="l2504"><span class="linenum">2504</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;UPDATE {grade_items} SET needsupdate=? WHERE itemtype=? or itemtype=?&quot;;
<a name="l2505"><span class="linenum">2505</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l2506"><span class="linenum">2506</span></a>      }
<a name="l2507"><span class="linenum">2507</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'is_aggregationcoef_used': ['is_aggregationcoef_used', 'Returns true if category uses special aggregation coefficient ', [['lib/grade','grade_category.php',1747]], 14],
'get_aggregation_strings': ['get_aggregation_strings', 'Gets strings describing the available aggregation methods. ', [['grade','lib.php',2659]], 3],
'set_locked': ['set_locked', 'Locks or unlocks this grade_item and (optionally) all its associated final grades. ', [['lib/grade','grade_item.php',499],['lib/grade','grade_grade.php',412],['lib/grade','grade_category.php',2324]], 17],
'is_locked': ['is_locked', 'Returns the locked state of this grade_item (if the grade_item is locked OR no specific $userid is given) or the locked state of a specific grade within this item if a specific $userid is given and the grade_item is unlocked. ', [['lib/grade','grade_item.php',476],['backup/util/settings','setting_dependency.class.php',187],['backup/util/settings','setting_dependency.class.php',340],['backup/util/settings','setting_dependency.class.php',534],['backup/util/settings','setting_dependency.class.php',598],['user/profile','lib.php',354],['lib/grade','grade_grade.php',265],['lib/grade','grade_category.php',2312],['lib','badgeslib.php',317]], 57],
'get_coefstring': ['get_coefstring', 'Queries parent categories recursively to find the aggregationcoef type that applies to this grade item. ', [['lib/grade','grade_item.php',2162],['lib/grade','grade_category.php',1771]], 8],
'format_string': ['format_string', 'Given a simple string, this function returns the string processed by enabled string filters if $CFG->filterall is enabled ', [['lib','weblib.php',1318]], 854],
'insert_course_category': ['insert_course_category', 'Internal function - used only from fetch_course_category() Normal insert() can not be used for course category ', [['lib/grade','grade_category.php',357]], 2],
'create_from_grade': ['create_from_grade', 'Create instance of event. ', [['mod/assign/classes/event','feedback_viewed.php',44],['lib/classes/event','grade_deleted.php',61],['lib/classes/event','user_graded.php',52],['mod/assign/classes/event','submission_graded.php',44]], 15],
'trigger': ['trigger', '', [['lib/evalmath','evalmath.class.php',438],['lib/classes/event','base.php',682]], 778],
'fetch_all_helper': ['fetch_all_helper', 'Factory method which uses the parameters to retrieve all matching instances from the database ', [['lib/grade','grade_object.php',171],['completion','data_object.php',199]], 11],
'can_control_visibility': ['can_control_visibility', 'Returns whether the grade object can control the visibility of the grades. ', [['lib/grade','grade_object.php',455],['lib/grade','grade_item.php',2180]], 9],
'get_description': ['get_description', 'Returns description of what happened. ', [['report/log/classes/event','user_report_viewed.php',63],['mod/wiki/classes/event','page_deleted.php',63],['mod/forum/classes/message/inbound','reply_handler.php',41],['mod/chat/classes/event','sessions_viewed.php',45],['mod/glossary/classes/event','category_deleted.php',55],['mod/workshop/classes/event','assessment_evaluations_reset.php',55],['lib/classes/event','tag_updated.php',67],['lib/classes/event','course_resources_list_viewed.php',51],['mod/lesson/classes/event','content_page_viewed.php',66],['lib/classes/event','blog_association_created.php',65],['lib/classes/event','user_profile_viewed.php',65],['mod/feedback/classes/event','response_submitted.php',69],['lib/classes/event','badge_awarded.php',63],['report/outline/classes/event','report_viewed.php',63],['mod/assign/classes/event','extension_granted.php',67],['admin/tool/capability/classes/event','report_viewed.php',56],['lib/classes/event','message_viewed.php',72],['lib/classes/event','course_category_created.php',66],['mod/quiz/classes/event','group_override_updated.php',63],['mod/survey/classes/event','response_submitted.php',62],['lib/classes/event','blog_comment_created.php',47],['mod/book/tool/exportimscp/classes/event','book_exported.php',57],['report/loglive/classes/event','report_viewed.php',57],['mod/forum/classes/event','post_deleted.php',57],['mod/assign/classes/event','submission_duplicated.php',67],['mod/chat/classes/event','message_sent.php',38],['mod/workshop/classes/event','submission_created.php',53],['lib/classes/event','note_updated.php',65],['mod/lesson/classes/event','group_override_deleted.php',63],['mod/feedback/classes/event','response_deleted.php',66],['lib/classes/event','course_module_instance_list_viewed.php',65],['mod/assign/classes/event','submission_locked.php',68],['mod/lesson/classes/event','page_updated.php',90],['mod/forum/classes/event','discussion_subscription_deleted.php',56],['mod/quiz/classes/event','attempt_preview_started.php',63],['mod/assign/classes/event','batch_set_workflow_state_viewed.php',88],['mod/lesson/classes/event','user_override_updated.php',63],['mod/quiz/classes/event','report_viewed.php',65],['mod/lesson/classes/event','question_answered.php',72],['lib','authlib.php',519],['mod/forum/classes/event','discussion_viewed.php',50],['mod/workshop/classes/event','submission_viewed.php',53],['mod/data/classes/event','comment_created.php',46],['mod/workshop/classes/event','submission_reassessed.php',57],['mod/assign/submission/onlinetext/classes/event','submission_created.php',53],['mod/glossary/classes/event','entry_deleted.php',63],['mod/glossary/classes/event','comment_created.php',46],['lib/classes/event','user_created.php',57],['mod/data/classes/event','field_updated.php',66],['mod/data/classes/event','template_updated.php',65],['lib/classes/event','comment_created.php',67],['lib/classes/event','cohort_deleted.php',58],['lib/grade','grade_item.php',1305],['mod/scorm/classes/event','tracks_viewed.php',54],['lib/classes/event','course_viewed.php',56],['lib/classes/event','course_content_deleted.php',63],['mod/quiz/classes/event','attempt_abandoned.php',53],['mod/workshop/classes/event','phase_switched.php',55],['lib/classes/event','base.php',298],['lib/classes/event','content_viewed.php',89],['lib/classes/event','course_completion_updated.php',56],['report/completion/classes/event','report_viewed.php',58],['mod/forum/classes/event','discussion_updated.php',55],['lib/classes/event','course_reset_ended.php',44],['mod/choice/classes/event','answer_submitted.php',46],['mod/forum/classes/event','assessable_uploaded.php',46],['mod/wiki/classes/event','page_diff_viewed.php',64],['lib/classes/event','course_category_updated.php',69],['admin/tool/langimport/classes/event','langpack_updated.php',71],['lib/classes/event','webservice_service_created.php',44],['lib/classes/event','course_created.php',64],['mod/lesson/classes/event','lesson_started.php',66],['mod/assign/classes/event','grading_table_viewed.php',88],['lib/classes/event','calendar_event_deleted.php',67],['lib/classes/event','group_created.php',38],['mod/quiz/classes/event','user_override_created.php',62],['mod/glossary/classes/event','category_updated.php',55],['mod/assign/classes/event','submission_viewed.php',85],['mod/glossary/classes/event','entry_disapproved.php',55],['lib/classes/event','user_password_updated.php',79],['mod/assign/classes/event','all_submissions_downloaded.php',65],['lib/classes/event','role_deleted.php',64],['admin/tool/log/store/legacy/tests/fixtures','event.php',35],['lib/classes/event','user_loggedinas.php',66],['mod/assign/classes/event','submission_confirmation_form_viewed.php',88],['mod/lesson/classes/event','essay_attempt_viewed.php',67],['mod/forum/classes/event','discussion_moved.php',56],['mod/assign/submission/onlinetext/classes/event','assessable_uploaded.php',45],['mod/assign/classes/event','reveal_identities_confirmation_page_viewed.php',88],['mod/survey/classes/event','report_downloaded.php',64],['mod/wiki/classes/event','page_updated.php',63],['admin/tool/log/store/standard/tests/fixtures','event.php',35],['mod/assign/classes/event','submission_unlocked.php',68],['lib/classes/event','user_list_viewed.php',65],['mod/forum/classes/event','readtracking_disabled.php',54],['lib/classes/event','comments_viewed.php',60],['lib/classes/event','cohort_member_added.php',58],['lib/classes/event','grouping_created.php',38],['lib/classes/event','recent_activity_viewed.php',58],['lib/classes/event','role_allow_switch_updated.php',56],['mod/assign/submission/comments/classes/event','comment_deleted.php',46],['admin/tool/messageinbound/classes/message/inbound','invalid_recipient_handler.php',51],['lib/classes/event','user_login_failed.php',65],['lib/classes/event','message_contact_added.php',66],['mod/assign/submission/file/classes/event','submission_updated.php',53],['lib/classes/event','role_allow_assign_updated.php',56],['mod/quiz/classes/event','user_override_deleted.php',62],['mod/quiz/classes/event','edit_page_viewed.php',62],['lib/classes/event','email_failed.php',57],['lib/classes/event','tag_removed.php',67],['mod/lesson/classes/event','highscores_viewed.php',66],['report/stats/classes/event','user_report_viewed.php',57],['mod/quiz/classes/event','group_override_deleted.php',63],['mod/book/classes/event','chapter_updated.php',59],['lib/simplepie/library/SimplePie','Enclosure.php',434],['lib/classes/log','reader.php',39],['mod/lesson/classes/event','question_viewed.php',72],['lib/simplepie/library','SimplePie.php',2407],['mod/scorm/classes/event','interactions_viewed.php',53],['lib/classes/event','course_module_updated.php',66],['mod/forum/classes/event','discussion_subscription_created.php',56],['mod/quiz/classes/event','question_manually_graded.php',64],['lib/classes/event','mnet_access_control_created.php',75],['lib/classes/event','role_assigned.php',65],['calendar','lib.php',2116],['lib/classes/event','unknown_logged.php',47],['availability/condition/profile/classes','condition.php',187],['mod/scorm/classes/event','user_report_viewed.php',53],['admin/tool/monitor/classes/event','subscription_criteria_met.php',64],['report/participation/classes/event','report_viewed.php',67],['mod/data/classes/event','comment_deleted.php',46],['lib/classes/event','user_updated.php',57],['lib/classes/event','course_section_updated.php',65],['lib/classes/event','comment_deleted.php',67],['mod/assign/classes/event','marker_updated.php',79],['lib/classes/event','webservice_login_failed.php',53],['mod/assign/submission/file/classes/event','assessable_uploaded.php',46],['admin/tool/log/store/database/tests/fixtures','event.php',35],['mod/lti/classes/event','unknown_service_api_called.php',73],['lib/classes/event','cohort_updated.php',58],['mod/forum/classes/event','post_updated.php',57],['mod/book/classes/event','chapter_viewed.php',59],['lib/classes/event','note_deleted.php',65],['lib/classes/event','user_loggedout.php',63],['lib/classes/event','grade_report_viewed.php',63],['mod/assign/submission/onlinetext/classes/event','submission_updated.php',53],['mod/assign/classes/event','workflow_state_updated.php',78],['mod/book/classes/event','chapter_deleted.php',59],['lib/classes/event','course_deleted.php',65],['lib/classes/event','blog_entry_deleted.php',84],['admin/tool/log/store/legacy/classes/event','legacy_logged.php',39],['lib/classes/event','webservice_token_created.php',44],['mod/forum/classes/event','course_searched.php',55],['lib/classes/event','group_updated.php',38],['mod/quiz/classes/event','attempt_started.php',46],['mod/lesson/classes/event','group_override_updated.php',63],['lib/classes/event','course_module_viewed.php',52],['availability/condition/completion/classes','condition.php',154],['lib/classes/event','mnet_access_control_updated.php',75],['mod/wiki/classes/event','comments_viewed.php',48],['lib/classes/message/inbound','private_files_handler.php',47],['lib/tests/fixtures','event_fixtures.php',38],['lib/tests/fixtures','event_fixtures.php',263],['mod/assign/submission/file/classes/event','submission_created.php',53],['lib/simplepie/library/SimplePie','Item.php',308],['mod/quiz/classes/event','attempt_submitted.php',53],['mod/data/classes/event','field_created.php',67],['lib/classes/event','question_category_created.php',57],['admin/tool/monitor/classes/event','rule_deleted.php',59],['lib/classes/event','blog_comment_deleted.php',47],['mod/lesson/classes/event','group_override_created.php',64],['mod/workshop/classes/event','assessments_reset.php',54],['mod/wiki/classes/event','comment_created.php',47],['mod/lesson/classes/event','lesson_resumed.php',66],['mod/assign/classes/event','feedback_viewed.php',85],['lib/classes/event','blog_entry_updated.php',83],['report/questioninstances/classes/event','report_viewed.php',64],['mod/assign/classes/event','submission_form_viewed.php',91],['mod/folder/classes/event','folder_updated.php',57],['mod/assign/classes/event','statement_accepted.php',67],['lib/classes/event','grade_deleted.php',103],['lib/classes/event','role_capabilities_updated.php',60],['lib/classes/event','blog_entries_viewed.php',71],['lib/tests','messageinbound_test.php',172],['mod/wiki/classes/event','page_viewed.php',57],['lib/classes/event','group_deleted.php',38],['lib/classes/event','webservice_token_sent.php',38],['mod/quiz/classes/event','attempt_becameoverdue.php',56],['mod/quiz/classes/event','attempt_viewed.php',63],['mod/assign/classes/event','submission_status_updated.php',69],['mod/assign/classes/event','grading_form_viewed.php',91],['lib/classes/event','course_module_completion_updated.php',57],['mod/workshop/classes/event','assessment_evaluated.php',56],['report/log/classes/event','report_viewed.php',67],['lib/classes/event','course_module_deleted.php',65],['mod/book/classes/event','chapter_created.php',59],['mod/workshop/classes/event','submission_assessed.php',56],['lib/classes/event','cohort_created.php',58],['lib/classes/event','webservice_function_called.php',49],['mod/scorm/classes/event','sco_launched.php',54],['mod/wiki/classes/event','comment_deleted.php',47],['lib/classes/event','blog_entry_created.php',85],['lib/classes/event','user_enrolment_created.php',62],['mod/data/classes/event','record_created.php',65],['mod/quiz/classes/event','attempt_summary_viewed.php',65],['lib/classes/event','user_enrolment_updated.php',62],['mod/quiz/classes/event','attempt_reviewed.php',62],['mod/glossary/classes/event','comment_deleted.php',46],['mod/lesson/classes/event','page_moved.php',74],['mod/glossary/classes/event','category_created.php',55],['availability/condition/grouping/classes','condition.php',124],['mod/lesson/classes/event','page_created.php',72],['lib/classes/event','cohort_member_removed.php',59],['mod/wiki/classes/event','page_version_viewed.php',63],['lib/classes/event','role_allow_override_updated.php',56],['mod/workshop/classes/event','assessable_uploaded.php',46],['lib/classes/event','grouping_updated.php',38],['admin/tool/monitor/classes/event','rule_updated.php',59],['lib/classes/event','course_module_created.php',95],['lib/classes/event','tag_added.php',67],['admin/tool/langimport/classes/event','langpack_removed.php',71],['mod/assign/classes/event','assessable_submitted.php',74],['mod/workshop/classes/event','submission_updated.php',53],['mod/lesson/classes/event','page_deleted.php',72],['availability/condition/date/classes','condition.php',136],['lib/classes/event','grouping_deleted.php',45],['mod/assign/submission/comments/classes/event','comment_created.php',46],['lib/classes/event','tag_flagged.php',64],['mod/wiki/classes/event','page_history_viewed.php',57],['mod/survey/classes/event','report_viewed.php',64],['lib/classes/event','tag_created.php',64],['report/stats/classes/event','report_viewed.php',65],['lib/classes/event','note_created.php',65],['lib/classes/event','course_reset_started.php',44],['admin/tool/monitor/classes/event','subscription_created.php',59],['mod/book/tool/print/classes/event','book_printed.php',57],['lib/classes/event','webservice_service_user_removed.php',38],['mod/data/classes/event','record_deleted.php',65],['mod/choice/classes/event','answer_updated.php',46],['message/tests/fixtures','inbound_fixtures.php',35],['lib/classes/event','group_member_removed.php',38],['mod/glossary/classes/event','entry_viewed.php',57],['mod/forum/classes/event','user_report_viewed.php',55],['lib/classes/event','course_category_deleted.php',68],['mod/forum/classes/event','subscription_created.php',55],['lib/classes/event','calendar_event_created.php',67],['lib/classes/event','message_contact_blocked.php',66],['lib/classes/event','webservice_service_updated.php',38],['mod/wiki/classes/event','page_version_restored.php',63],['mod/data/classes/event','template_viewed.php',64],['lib/classes/event','course_user_report_viewed.php',56],['mod/data/classes/event','record_updated.php',65],['mod/wiki/classes/event','page_map_viewed.php',63],['mod/wiki/classes/event','page_locks_deleted.php',63],['lib/classes/event','webservice_service_deleted.php',38],['lib/grade','grade_category.php',2145],['mod/forum/classes/event','readtracking_enabled.php',54],['lib/classes/event','role_unassigned.php',62],['lib/classes/event','course_restored.php',67],['mod/choice/classes/event','report_viewed.php',56],['lib/classes/event','user_deleted.php',66],['lib/classes/event','user_enrolment_deleted.php',63],['mod/book/tool/print/classes/event','chapter_printed.php',59],['mod/assign/classes/event','identities_revealed.php',65],['lib/classes/event','user_graded.php',105],['lib/classes/event','course_updated.php',67],['admin/tool/log/classes/helper','reader.php',53],['mod/forum/classes/event','post_created.php',57],['mod/data/classes/event','field_deleted.php',66],['lib/classes/event','tag_deleted.php',64],['availability/condition/grade/classes','condition.php',123],['mod/glossary/classes/event','entry_created.php',61],['mod/forum/classes/event','discussion_created.php',55],['mod/forum/classes/event','discussion_deleted.php',56],['mod/scorm/classes/event','attempt_deleted.php',52],['mod/lesson/classes/event','lesson_ended.php',67],['lib/grade','grade_scale.php',331],['admin/tool/monitor/classes','subscription.php',133],['mod/forum/classes/event','subscribers_viewed.php',55],['mod/scorm/classes/event','report_viewed.php',53],['availability/tests/fixtures','mock_condition.php',82],['mod/lesson/classes/event','user_override_deleted.php',62],['report/completion/classes/event','user_report_viewed.php',58],['admin/tool/langimport/classes/event','langpack_imported.php',71],['mod/forum/classes/event','subscription_deleted.php',55],['mod/lesson/classes/event','highscore_added.php',74],['mod/lesson/classes/event','essay_assessed.php',57],['availability/condition/group/classes','condition.php',93],['lib/classes/event','message_sent.php',100],['lib/classes/event','message_contact_removed.php',66],['lib/classes/event','tag_unflagged.php',64],['mod/assign/classes/event','submission_graded.php',68],['mod/assign/classes/event','batch_set_marker_allocation_viewed.php',88],['report/outline/classes/event','activity_report_viewed.php',57],['lib/classes/event','calendar_event_updated.php',67],['mod/lesson/classes/event','user_override_created.php',62],['mod/workshop/classes/event','assessment_reevaluated.php',56],['lib/simplepie/library/SimplePie','Source.php',459],['mod/quiz/classes/event','user_override_updated.php',63],['lib/classes/event','webservice_service_user_added.php',38],['admin/tool/monitor/classes/event','subscription_deleted.php',59],['lib/classes/event','notes_viewed.php',58],['mod/glossary/classes/event','entry_updated.php',61],['admin/tool/monitor/classes/event','rule_created.php',59],['mod/wiki/classes/event','page_version_deleted.php',63],['lib/classes/event','course_completed.php',82],['mod/assign/classes/event','submission_status_viewed.php',90],['mod/glossary/classes/event','entry_approved.php',55],['mod/wiki/classes/event','page_created.php',57],['mod/quiz/classes/event','group_override_created.php',64],['lib/classes/event','group_member_added.php',45],['lib/classes/event','message_contact_unblocked.php',66],['mod/quiz/classes/event','attempt_deleted.php',56],['lib/classes/event','user_loggedin.php',45],['admin/tool/monitor/classes','rule.php',249],['mod/lesson/classes/event','lesson_restarted.php',66],['lib/grade','grade_outcome.php',291]], 70],
'qualifies_for_regrading': ['qualifies_for_regrading', 'Compares the values held by this object with those of the matching record in DB, and returns whether or not these differences are sufficient to justify an update of all parent objects. This assumes that this object has an id number and a matching record in DB. If not, it will return false. ', [['lib/grade','grade_item.php',296],['lib/grade','grade_category.php',387]], 10],
'debugging': ['debugging', 'Standard Debugging Function ', [['lib','weblib.php',2854]], 853],
'fetch_helper': ['fetch_helper', 'Factory method which uses the parameters to retrieve matching instances from the database ', [['lib/grade','grade_object.php',151],['completion','data_object.php',178]], 16],
'auto_update_max': ['auto_update_max', 'Some aggregation types may need to update their max grade. ', [['lib/grade','grade_category.php',1330]], 1],
'aggregate_values_and_adjust_bounds': ['aggregate_values_and_adjust_bounds', 'Internal function that calculates the aggregated grade and new min/max for this grade category ', [['lib/grade','grade_category.php',852]], 4],
'_fetch_course_tree_recursion': ['_fetch_course_tree_recursion', 'An internal function that recursively sorts grade categories within a course ', [['lib/grade','grade_category.php',1842]], 3],
'get_string': ['get_string', 'Return a core get_string() call ', [['lib/external','externallib.php',112],['lib','moodlelib.php',6538],['lib','moodlelib.php',9417],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38],['lib/classes','string_manager_install.php',95],['question/behaviour','behaviourbase.php',756]], 19235],
'get_recordset_sql': ['get_recordset_sql', 'Get a number of records as a moodle_recordset using a SQL statement. ', [['lib/dml','pgsql_native_moodle_database.php',688],['lib/dml','oci_native_moodle_database.php',1065],['lib/dml','sqlsrv_native_moodle_database.php',761],['lib/dml','mssql_native_moodle_database.php',687],['lib/dml','mysqli_native_moodle_database.php',985],['lib/dml/tests','dml_test.php',5423],['lib/dml','pdo_moodle_database.php',251]], 279],
'aggregation_uses_aggregationcoef': ['aggregation_uses_aggregationcoef', 'Returns true if aggregation uses aggregationcoef ', [['lib/grade','grade_category.php',1757]], 14],
'delete': ['delete', 'Deletes a key pair ', [['lib/zend/Zend/Service/Amazon/Ec2','Keypair.php',110],['lib/google/src/Google/Service','Reseller.php',440],['lib/phpexcel/PHPExcel/Shared/PCLZip','pclzip.lib.php',1006],['lib/adodb','adodb-active-recordx.inc.php',949],['lib/zend/Zend/Service/Delicious','Post.php',236],['lib/grade','grade_object.php',270],['lib/zend/Zend/Gdata','Gapps.php',258],['lib/google/src/Google/Service','Fusiontables.php',644],['lib/google/src/Google/Service','Fusiontables.php',809],['lib/google/src/Google/Service','Fusiontables.php',934],['lib/google/src/Google/Service','Fusiontables.php',1127],['lib/google/src/Google/Service','Fusiontables.php',1188],['blog','locallib.php',325],['lib/google/src/Google/Service','Blogger.php',1051],['lib/google/src/Google/Service','Blogger.php',1212],['lib/google/src/Google/Service','Blogger.php',1434],['lib/portfolio','plugin.php',692],['lib/google/src/Google/Service','AdExchangeBuyer.php',605],['lib/google/src/Google/Service','Manager.php',240],['lib/google/src/Google/Service','Manager.php',320],['lib/zend/Zend/Service/Amazon/Ec2','Securitygroups.php',137],['lib','webdavlib.php',691],['lib/grade','grade_item.php',354],['lib/google/src/Google/Service','Gmail.php',686],['lib/google/src/Google/Service','Gmail.php',843],['lib/google/src/Google/Service','Gmail.php',936],['lib/google/src/Google/Service','Gmail.php',1146],['course','lib.php',3133],['lib/google/src/Google/Service','Mirror.php',424],['lib/google/src/Google/Service','Mirror.php',592],['lib/google/src/Google/Service','Mirror.php',660],['lib/google/src/Google/Service','Mirror.php',771],['lib/google/src/Google/Service','Genomics.php',632],['lib/google/src/Google/Service','Genomics.php',731],['lib/google/src/Google/Service','Genomics.php',963],['lib/google/src/Google/Service','Genomics.php',1327],['lib/google/src/Google/Service','Genomics.php',1399],['cache/classes','interfaces.php',161],['lib/google/src/Google/Service','Dfareporting.php',470],['lib/zend/Zend/Gdata/Gbase','ItemEntry.php',133],['lib/google/src/Google/Service','Licensing.php',221],['lib/google/src/Google/Service','Drive.php',1462],['lib/google/src/Google/Service','Drive.php',1536],['lib/google/src/Google/Service','Drive.php',1681],['lib/google/src/Google/Service','Drive.php',1932],['lib/google/src/Google/Service','Drive.php',2002],['lib/google/src/Google/Service','Drive.php',2131],['lib/google/src/Google/Service','Drive.php',2294],['lib/google/src/Google/Service','Drive.php',2414],['completion','data_object.php',272],['lib/google/src/Google/Service','Books.php',1804],['lib/zend/Zend/Gdata','App.php',914],['lib/google/src/Google/Cache','Memcache.php',142],['lib/google/src/Google/Service','Bigquery.php',512],['lib/google/src/Google/Service','Bigquery.php',822],['cache','disabledlib.php',102],['lib/zend/Zend/Server','Cache.php',132],['lib/zend/Zend/Gdata/App','Entry.php',212],['cache/stores/memcached','lib.php',368],['lib/google/src/Google/Service','YouTube.php',1470],['lib/google/src/Google/Service','YouTube.php',1979],['lib/google/src/Google/Service','YouTube.php',2277],['lib/google/src/Google/Service','YouTube.php',2510],['lib/google/src/Google/Service','YouTube.php',2657],['lib/google/src/Google/Service','YouTube.php',2998],['lib/google/src/Google/Service','YouTube.php',3196],['lib/google/src/Google/Service','Webmasters.php',298],['lib/google/src/Google/Service','Webmasters.php',388],['lib/google/src/Google/Service','Autoscaler.php',314],['lib/google/src/Google/Service','Autoscaler.php',428],['calendar','lib.php',2388],['lib/zend/Zend/Service/Amazon','Sqs.php',129],['lib/google/src/Google/Service','ShoppingContent.php',553],['lib/google/src/Google/Service','ShoppingContent.php',735],['lib/google/src/Google/Service','ShoppingContent.php',969],['mod/lesson','locallib.php',1039],['mod/lesson','locallib.php',2274],['lib/google/src/Google/Service','SQLAdmin.php',628],['lib/google/src/Google/Service','SQLAdmin.php',923],['lib/google/src/Google/Service','Fitness.php',458],['lib/google/src/Google/Service','Fitness.php',563],['lib/google/src/Google/Service','TagManager.php',1049],['lib/google/src/Google/Service','TagManager.php',1140],['lib/google/src/Google/Service','TagManager.php',1233],['lib/google/src/Google/Service','TagManager.php',1326],['lib/google/src/Google/Service','TagManager.php',1419],['lib/google/src/Google/Service','TagManager.php',1513],['lib/google/src/Google/Service','TagManager.php',1607],['lib/google/src/Google/Service','TagManager.php',1757],['lib/google/src/Google/Service','Directory.php',1300],['lib/google/src/Google/Service','Directory.php',1477],['lib/google/src/Google/Service','Directory.php',1587],['lib/google/src/Google/Service','Directory.php',1642],['lib/google/src/Google/Service','Directory.php',1769],['lib/google/src/Google/Service','Directory.php',1838],['lib/google/src/Google/Service','Directory.php',1935],['lib/google/src/Google/Service','Directory.php',2042],['lib/google/src/Google/Service','Directory.php',2144],['lib/google/src/Google/Service','Directory.php',2205],['lib/google/src/Google/Service','Directory.php',2405],['lib/google/src/Google/Service','Directory.php',2480],['cache/stores/static','lib.php',374],['lib/google/src/Google/Service','AppState.php',153],['lib/google/src/Google/Service','Taskqueue.php',292],['lib/google/src/Google/Service','Container.php',343],['lib/google/src/Google/Service','AndroidPublisher.php',1177],['lib/google/src/Google/Service','AndroidPublisher.php',1257],['lib/google/src/Google/Service','AndroidPublisher.php',1595],['lib/google/src/Google/Service','AndroidPublisher.php',1690],['lib/google/src/Google/Service','AndroidPublisher.php',1972],['repository','lib.php',427],['repository','lib.php',2012],['lib','accesslib.php',5529],['lib/google/src/Google/Service','AdSenseHost.php',733],['lib/google/src/Google/Service','AdSenseHost.php',1009],['lib/google/src/Google/Service','AdSenseHost.php',1167],['cache/stores/memcache','lib.php',401],['lib','filelib.php',3440],['lib/google/src/Google/Service','MapsEngine.php',1692],['lib/google/src/Google/Service','MapsEngine.php',1990],['lib/google/src/Google/Service','MapsEngine.php',2343],['lib/google/src/Google/Service','MapsEngine.php',2650],['lib/google/src/Google/Service','MapsEngine.php',2911],['lib/grade','grade_grade.php',955],['comment','lib.php',786],['lib/google/src/Google/Service','SiteVerification.php',138],['lib/google/src/Google/Service','Prediction.php',261],['cache/stores/session','lib.php',417],['cache/classes','dummystore.php',198],['lib/google/src/Google/Service','Compute.php',2812],['lib/google/src/Google/Service','Compute.php',2896],['lib/google/src/Google/Service','Compute.php',3139],['lib/google/src/Google/Service','Compute.php',3225],['lib/google/src/Google/Service','Compute.php',3361],['lib/google/src/Google/Service','Compute.php',3463],['lib/google/src/Google/Service','Compute.php',3543],['lib/google/src/Google/Service','Compute.php',3662],['lib/google/src/Google/Service','Compute.php',3725],['lib/google/src/Google/Service','Compute.php',3844],['lib/google/src/Google/Service','Compute.php',3941],['lib/google/src/Google/Service','Compute.php',4080],['lib/google/src/Google/Service','Compute.php',4406],['lib/google/src/Google/Service','Compute.php',4543],['lib/google/src/Google/Service','Compute.php',4660],['lib/google/src/Google/Service','Compute.php',4740],['lib/google/src/Google/Service','Compute.php',4806],['lib/google/src/Google/Service','Compute.php',4927],['lib/google/src/Google/Service','Compute.php',5069],['lib/google/src/Google/Service','Compute.php',5229],['lib/google/src/Google/Service','Compute.php',5360],['badges/criteria','award_criteria.php',330],['badges/criteria','award_criteria_manual.php',220],['lib/google/src/Google/Service','Calendar.php',886],['lib/google/src/Google/Service','Calendar.php',1040],['lib/google/src/Google/Service','Calendar.php',1228],['lib/google/src/Google/Service','Calendar.php',1362],['lib/google/src/Google/Service','Analytics.php',2068],['lib/google/src/Google/Service','Analytics.php',2211],['lib/google/src/Google/Service','Analytics.php',2293],['lib/google/src/Google/Service','Analytics.php',2414],['lib/google/src/Google/Service','Analytics.php',2631],['lib/google/src/Google/Service','Analytics.php',2760],['lib/google/src/Google/Service','Analytics.php',2851],['lib/google/src/Google/Service','Analytics.php',3181],['lib/google/src/Google/Service','Analytics.php',3406],['lib/google/src/Google/Service','Tasks.php',309],['lib/google/src/Google/Service','Tasks.php',427],['cache/classes','loaders.php',777],['cache/classes','loaders.php',1491],['cache/classes','loaders.php',1859],['cache/stores/mongodb','lib.php',361],['lib/grade','grade_category.php',259],['cache/stores/file','lib.php',392],['lib/google/src/Google/Service','Storage.php',945],['lib/google/src/Google/Service','Storage.php',1060],['lib/google/src/Google/Service','Storage.php',1227],['lib/google/src/Google/Service','Storage.php',1349],['lib/google/src/Google/Service','Storage.php',1565],['admin/tool/uploadcourse/classes','course.php',226],['lib/google/src/Google/Cache','Null.php',51],['lib/filestorage','stored_file.php',323],['lib/filebrowser','virtual_root_file.php',69],['lib/google/src/Google/Service','AdSense.php',1257],['lib/google/src/Google/Service','AdSense.php',1729],['lib/google/src/Google/Service','Pubsub.php',239],['lib/google/src/Google/Service','Pubsub.php',378],['lib/grade','grade_scale.php',136],['lib/filebrowser','file_info.php',418],['lib/google/src/Google/Cache','File.php',106],['lib/htmlpurifier/HTMLPurifier','Zipper.php',89],['lib/google/src/Google/Service','Dns.php',370],['lib/filebrowser','file_info_stored.php',631],['lib/google/src/Google/Service','Replicapool.php',374],['lib/google/src/Google/Service','Resourceviews.php',419],['lib','badgeslib.php',620],['lib/google/src/Google/Cache','Apc.php',103],['lib/adodb','adodb-active-record.inc.php',792],['mnet','peer.php',122],['lib/grade','grade_outcome.php',97]], 260],
'set_field_select': ['set_field_select', 'Set a single field in every table record which match a particular WHERE clause. ', [['lib/dml','pgsql_native_moodle_database.php',1192],['lib/dml','oci_native_moodle_database.php',1387],['lib/dml','sqlsrv_native_moodle_database.php',1111],['lib/dml','mssql_native_moodle_database.php',1033],['lib/dml','mysqli_native_moodle_database.php',1427],['lib/dml/tests','dml_test.php',5431],['lib/dml','pdo_moodle_database.php',491]], 78],
'get_records': ['get_records', 'Get a number of records as an array of objects where all the given conditions met. ', [['lib/dml','moodle_database.php',1236],['lib','coursecatlib.php',654],['question','category_class.php',63]], 860],
'update': ['update', 'Update a customer resource if one it exists and is owned by the reseller. (customers.update) ', [['lib/google/src/Google/Service','Reseller.php',343],['mod/lesson/pagetypes','matching.php',308],['lib/adodb','adodb-active-recordx.inc.php',1047],['lib/grade','grade_object.php',238],['lib/google/src/Google/Service','Fusiontables.php',726],['lib/google/src/Google/Service','Fusiontables.php',889],['lib/google/src/Google/Service','Fusiontables.php',1095],['lib/google/src/Google/Service','Fusiontables.php',1269],['grade/grading/form','lib.php',905],['lib/google/src/Google/Service','Blogger.php',1332],['lib/google/src/Google/Service','Blogger.php',1630],['lib/google/src/Google/Service','Doubleclicksearch.php',325],['lib/google/src/Google/Service','AdExchangeBuyer.php',392],['lib/google/src/Google/Service','AdExchangeBuyer.php',684],['lib/grade','grade_item.php',260],['lib/google/src/Google/Service','Gmail.php',756],['lib/google/src/Google/Service','Gmail.php',908],['lib/google/src/Google/Service','Mirror.php',495],['lib/google/src/Google/Service','Mirror.php',633],['lib/google/src/Google/Service','Mirror.php',744],['lib/google/src/Google/Service','Genomics.php',690],['lib/google/src/Google/Service','Genomics.php',811],['lib/google/src/Google/Service','Genomics.php',1064],['lib/google/src/Google/Service','Genomics.php',1370],['lib/google/src/Google/Service','Genomics.php',1521],['lib/google/src/Google/Service','Dfareporting.php',570],['lib/google/src/Google/Service','PlusDomains.php',691],['lib/google/src/Google/Service','Licensing.php',332],['lib/google/src/Google/Service','Drive.php',1624],['lib/google/src/Google/Service','Drive.php',1859],['lib/google/src/Google/Service','Drive.php',2100],['lib/google/src/Google/Service','Drive.php',2211],['lib/google/src/Google/Service','Drive.php',2261],['lib/google/src/Google/Service','Drive.php',2385],['lib/google/src/Google/Service','Drive.php',2473],['completion','data_object.php',251],['lib/google/src/Google/Service','Books.php',1901],['lib/google/src/Google/Service','Bigquery.php',603],['lib/google/src/Google/Service','Bigquery.php',911],['lib/google/src/Google/Service','Groupssettings.php',137],['lib/google/src/Google/Service','YouTube.php',1596],['lib/google/src/Google/Service','YouTube.php',1697],['lib/google/src/Google/Service','YouTube.php',2201],['lib/google/src/Google/Service','YouTube.php',2439],['lib/google/src/Google/Service','YouTube.php',2613],['lib/google/src/Google/Service','YouTube.php',2809],['lib/google/src/Google/Service','YouTube.php',3419],['lib/google/src/Google/Service','Coordinate.php',568],['lib/google/src/Google/Service','Coordinate.php',680],['lib/google/src/Google/Service','Autoscaler.php',399],['calendar','lib.php',2171],['lib/google/src/Google/Service','ShoppingContent.php',633],['lib/google/src/Google/Service','ShoppingContent.php',815],['lib','weblib.php',3154],['mod/lesson','locallib.php',2682],['lib/google/src/Google/Service','SQLAdmin.php',843],['lib/google/src/Google/Service','Fitness.php',424],['lib/google/src/Google/Service','Fitness.php',607],['lib/google/src/Google/Service','TagManager.php',1004],['lib/google/src/Google/Service','TagManager.php',1093],['lib/google/src/Google/Service','TagManager.php',1186],['lib/google/src/Google/Service','TagManager.php',1279],['lib/google/src/Google/Service','TagManager.php',1372],['lib/google/src/Google/Service','TagManager.php',1466],['lib/google/src/Google/Service','TagManager.php',1560],['lib/google/src/Google/Service','TagManager.php',1711],['lib/google/src/Google/Service','TagManager.php',1804],['mod/lesson/pagetypes','truefalse.php',163],['lib/google/src/Google/Service','Directory.php',1446],['lib/google/src/Google/Service','Directory.php',1559],['lib/google/src/Google/Service','Directory.php',1724],['lib/google/src/Google/Service','Directory.php',1907],['lib/google/src/Google/Service','Directory.php',2014],['lib/google/src/Google/Service','Directory.php',2116],['lib/google/src/Google/Service','Directory.php',2337],['lib/google/src/Google/Service','Directory.php',2523],['lib/xhprof/xhprof_html/jquery','jquery.tooltip.js',200],['lib/google/src/Google/Service','AppState.php',201],['lib/google/src/Google/Service','Taskqueue.php',397],['lib/google/src/Google/Service','AndroidPublisher.php',1360],['lib/google/src/Google/Service','AndroidPublisher.php',1472],['lib/google/src/Google/Service','AndroidPublisher.php',1542],['lib/google/src/Google/Service','AndroidPublisher.php',1780],['lib/google/src/Google/Service','AndroidPublisher.php',1846],['lib/google/src/Google/Service','AndroidPublisher.php',1928],['lib/google/src/Google/Service','AndroidPublisher.php',2066],['mod/lesson/pagetypes','essay.php',158],['lib/google/src/Google/Service','AdSenseHost.php',845],['lib/google/src/Google/Service','AdSenseHost.php',1096],['lib/google/src/Google/Service','Games.php',1507],['lib/grade','grade_grade.php',940],['lib/google/src/Google/Service','SiteVerification.php',226],['lib/horde/framework/Horde/Support','Array.php',70],['lib/google/src/Google/Service','Prediction.php',338],['lib/google/src/Google/Service','Compute.php',2999],['lib/google/src/Google/Service','Compute.php',3310],['lib/google/src/Google/Service','Compute.php',3814],['lib/google/src/Google/Service','Compute.php',5314],['lib/google/src/Google/Service','Calendar.php',979],['lib/google/src/Google/Service','Calendar.php',1144],['lib/google/src/Google/Service','Calendar.php',1285],['lib/google/src/Google/Service','Calendar.php',1633],['lib/google/src/Google/Service','Analytics.php',2118],['lib/google/src/Google/Service','Analytics.php',2385],['lib/google/src/Google/Service','Analytics.php',2495],['lib/google/src/Google/Service','Analytics.php',2602],['lib/google/src/Google/Service','Analytics.php',2730],['lib/google/src/Google/Service','Analytics.php',2821],['lib/google/src/Google/Service','Analytics.php',2944],['lib/google/src/Google/Service','Analytics.php',3277],['lib/google/src/Google/Service','Analytics.php',3379],['lib/google/src/Google/Service','Analytics.php',3461],['lib/google/src/Google/Service','Tasks.php',385],['lib/google/src/Google/Service','Tasks.php',555],['lib/horde/framework/Horde/Imap/Client/Ids','Map.php',72],['grade/grading/form/guide','lib.php',826],['lib/grade','grade_category.php',204],['lib/google/src/Google/Service','Storage.php',1030],['lib/google/src/Google/Service','Storage.php',1165],['lib/google/src/Google/Service','Storage.php',1318],['lib/google/src/Google/Service','Storage.php',1454],['lib/google/src/Google/Service','Storage.php',1718],['lib/filestorage','stored_file.php',103],['grade/grading/form/rubric','lib.php',828],['lib/grade','grade_scale.php',125],['lib','coursecatlib.php',441],['lib/adodb','adodb-active-record.inc.php',878],['lib/grade','grade_outcome.php',144],['mod/lesson/pagetypes','branchtable.php',262]], 290],
'bounded_grade': ['bounded_grade', 'Makes sure value is a valid grade value. ', [['lib/grade','grade_item.php',1354]], 18],
'fetch': ['fetch', 'Fetches the available update status from the remote site ', [['lib/classes/update','checker.php',113],['lib/minify/lib/Minify/Cache','XCache.php',86],['lib/grade','grade_object.php',126],['completion/criteria','completion_criteria_unenrol.php',43],['completion/criteria','completion_criteria_grade.php',45],['lib/grade','grade_item.php',332],['lib/minify/lib/Minify/Cache','Memcache.php',97],['lib/minify/lib/Minify/Cache','APC.php',91],['completion/criteria','completion_criteria_activity.php',45],['lib/horde/framework/Horde/Imap/Client','Base.php',2373],['completion','data_object.php',152],['completion/criteria','completion_criteria_course.php',46],['completion','completion_completion.php',70],['completion/criteria','completion_criteria_role.php',43],['completion','completion_criteria_completion.php',74],['lib/grade','grade_grade.php',576],['lib/minify/lib/Minify/Cache','ZendPlatform.php',97],['completion/criteria','completion_criteria_date.php',43],['lib/grade','grade_category.php',184],['completion/criteria','completion_criteria_self.php',43],['lib/grade','grade_scale.php',89],['lib/minify/lib/Minify/Cache','File.php',90],['completion','completion_aggregation.php',68],['completion/criteria','completion_criteria_duration.php',43],['lib/grade','grade_outcome.php',182]], 192],
'aggregate_values': ['aggregate_values', 'Internal function that calculates the aggregated grade for this grade category ', [['lib/grade','grade_category.php',1313]], 2],
'set_parent': ['set_parent', 'Set the parent of the optigroup and, at the same time, process all the condition params in all the childs ', [['backup/util/structure','base_optigroup.class.php',118],['lib/grade','grade_item.php',1318],['lib','listlib.php',183],['lib','listlib.php',624],['backup/util/structure','base_final_element.class.php',62],['backup/util/structure','backup_optigroup_element.class.php',184],['lib/grade','grade_category.php',2172],['lib','navigationlib.php',679]], 28],
'move_after_sortorder': ['move_after_sortorder', 'Update this grade item\'s sortorder so that it will appear after $sortorder ', [['lib/grade','grade_item.php',1220],['lib/grade','grade_category.php',2256]], 9],
'grade_floats_different': ['grade_floats_different', 'Compare two float numbers safely. Uses 5 decimals php precision using {@link grade_floatval()}. Nulls accepted too. Used for determining if a database update is required ', [['lib','gradelib.php',1450]], 26],
'apply_limit_rules': ['apply_limit_rules', 'Given an array of grade values (numerical indices) applies droplow or keephigh rules to limit the final array. ', [['lib/grade','grade_category.php',1564]], 12],
'get_parent_category': ['get_parent_category', 'Returns the grade_category object this grade_item belongs to (referenced by categoryid) or category attached to category item. ', [['lib/grade','grade_item.php',868],['lib/grade','grade_category.php',2114]], 28],
'get_record': ['get_record', 'Get a single database record as an object where all the given conditions met. ', [['lib/dml','moodle_database.php',1413]], 2960],
'load_grade_item': ['load_grade_item', 'Loads the grade_item object referenced by $this->itemid and saves it as $this->grade_item for easy access ', [['lib/grade','grade_grade.php',219],['lib/grade','grade_category.php',2051]], 52],
'is_outcome_item': ['is_outcome_item', 'Is this an outcome item? ', [['lib/grade','grade_item.php',948]], 15],
'or': ['or', '', [['lib/tcpdf','LICENSE.TXT',69]], 552],
'get_children': ['get_children', 'Returns list of children. ', [['lib/filebrowser','file_info_context_course.php',381],['lib/filebrowser','file_info_context_course.php',530],['lib/filebrowser','file_info_context_course.php',666],['lib/filebrowser','file_info_context_course.php',812],['lib/filebrowser','file_info_context_system.php',92],['mod/book','locallib.php',462],['lib/filebrowser','file_info_context_coursecat.php',152],['mod/forum','locallib.php',481],['lib','outputcomponents.php',2767],['backup/util/structure','base_nested_element.class.php',127],['lib/filebrowser','file_info_context_module.php',258],['lib/filebrowser','file_info_context_user.php',274],['mod/data','locallib.php',493],['mod/workshop','fileinfolib.php',91],['mod/workshop','fileinfolib.php',251],['mod/imscp','locallib.php',336],['mod/lesson/classes','file_info.php',102],['mod/glossary','locallib.php',543],['lib/grade','grade_category.php',1898],['lib','adminlib.php',1036],['lib/filebrowser','file_info_stored.php',330],['lib','coursecatlib.php',981]], 79],
'set_properties': ['set_properties', 'Given an associated array or object, cycles through each key/variable and assigns the value to the corresponding variable in this object. ', [['lib/grade','grade_object.php',388],['completion','data_object.php',366],['lib/grade','grade_category.php',2364]], 29],
'can_apply_limit_rules': ['can_apply_limit_rules', 'Returns whether or not we can apply the limit rules. ', [['lib/grade','grade_category.php',1662]], 5],
'get_final': ['get_final', 'Returns the final values for this grade item (as imported by module or other source). ', [['lib/grade','grade_item.php',1128],['lib/grade','grade_category.php',2209]], 12],
'is_course_item': ['is_course_item', 'Is the grade item associated with course? ', [['lib/grade','grade_item.php',930]], 29],
'generate_grades': ['generate_grades', 'Generates and saves final grades in associated category grade item. These immediate children must already have their own final grades. The category\'s aggregation method is used to generate final grades. ', [['lib/grade','grade_category.php',429]], 1],
'_get_children_recursion': ['_get_children_recursion', 'Private method used to retrieve all children of this category recursively ', [['lib/grade','grade_category.php',2010]], 2],
'aggregation_uses_extracredit': ['aggregation_uses_extracredit', 'Returns true if aggregation passed is using extracredit. ', [['lib/grade','grade_category.php',1735]], 11],
'count_records_sql': ['count_records_sql', 'Get the result of a SQL SELECT COUNT(...) query. ', [['lib/dml','moodle_database.php',1747]], 132],
'fetch_all': ['fetch_all', 'Finds and returns all grade_object instances based on $params. ', [['lib/grade','grade_object.php',138],['lib/grade','grade_item.php',343],['completion/criteria','completion_criteria.php',153],['completion','data_object.php',165],['completion','completion_criteria_completion.php',84],['lib/grade','grade_grade.php',586],['lib/grade','grade_category.php',194],['lib/grade','grade_scale.php',100],['completion','completion_aggregation.php',79],['lib/grade','grade_outcome.php',193]], 65],
'depends_on': ['depends_on', 'Finds out on which other items does this depend directly when doing calculation or category aggregation ', [['lib/grade','grade_item.php',1392]], 12],
'set_usedinaggregation': ['set_usedinaggregation', 'Set the flags on the grade_grade items to indicate how individual grades are used in the aggregation. ', [['lib/grade','grade_category.php',766]], 3],
'get_idnumber': ['get_idnumber', 'Returns the idnumber of this grade_item. This method is also available in grade_category, for cases where the object type is not know. ', [['lib/grade','grade_item.php',1186],['lib/grade','grade_category.php',2232]], 2],
'get_name': ['get_name', 'Return localised event name. ', [['report/log/classes/event','user_report_viewed.php',54],['mod/wiki/classes/event','page_deleted.php',54],['mod/forum/classes/message/inbound','reply_handler.php',50],['mod/chat/classes/event','sessions_viewed.php',65],['mod/glossary/classes/event','category_deleted.php',46],['mod/workshop/classes/event','assessment_evaluations_reset.php',75],['lib/classes/event','tag_updated.php',58],['lib/classes/event','course_resources_list_viewed.php',60],['mod/lesson/classes/event','content_page_viewed.php',48],['lib/classes/event','blog_association_created.php',56],['lib/classes/event','user_profile_viewed.php',56],['mod/feedback/classes/event','response_submitted.php',60],['backup/util/plan','base_plan.class.php',50],['lib/classes/event','badge_awarded.php',54],['report/outline/classes/event','report_viewed.php',54],['question/classes/bank','checkbox_column.php',32],['mod/assign/classes/event','extension_granted.php',77],['admin/tool/capability/classes/event','report_viewed.php',47],['portfolio/picasa','lib.php',33],['lib/classes/event','message_viewed.php',54],['lib/classes/event','course_category_created.php',48],['mod/quiz/classes/event','group_override_updated.php',54],['lib/classes/task','context_cleanup_task.php',32],['mod/survey/classes/event','response_submitted.php',53],['mod/book/tool/exportimscp/classes/event','book_exported.php',76],['cache/classes','definition.php',604],['report/loglive/classes/event','report_viewed.php',48],['mod/forum/classes/event','post_deleted.php',67],['mod/assign/classes/event','submission_duplicated.php',77],['mod/chat/classes/event','message_sent.php',59],['mod/workshop/classes/event','submission_created.php',63],['lib/classes/event','note_updated.php',56],['mod/lesson/classes/event','group_override_deleted.php',54],['mod/feedback/classes/event','response_deleted.php',57],['lib/classes/event','course_module_instance_list_viewed.php',75],['mod/assign/classes/event','submission_locked.php',78],['enrol/imsenterprise/classes/task','cron_task.php',34],['mod/lesson/classes/event','page_updated.php',72],['admin/tool/messageinbound/classes/task','cleanup_task.php',38],['mod/forum/classes/event','discussion_subscription_deleted.php',66],['mod/quiz/classes/event','attempt_preview_started.php',54],['mod/assign/classes/event','batch_set_workflow_state_viewed.php',79],['mod/lesson/classes/event','user_override_updated.php',54],['lib/classes/task','calendar_cron_task.php',31],['mod/quiz/classes/event','report_viewed.php',56],['mod/lesson/classes/event','question_answered.php',54],['lib/portfolio','plugin.php',120],['mod/forum/classes/event','discussion_viewed.php',60],['mod/workshop/classes/event','submission_viewed.php',63],['lib/classes/task','registration_cron_task.php',31],['mod/assign/submission/file','locallib.php',44],['mod/assign/classes/event','submission_updated.php',57],['mod/workshop/classes/event','submission_reassessed.php',77],['mod/glossary/classes/event','entry_deleted.php',54],['lib/classes/task','portfolio_cron_task.php',31],['lib/classes/event','user_created.php',48],['question/classes/bank','preview_action_column.php',26],['mod/data/classes/event','field_updated.php',57],['mod/assign/submission/onlinetext','locallib.php',40],['mod/data/classes/event','template_updated.php',56],['lib/classes/event','comment_created.php',58],['lib/classes/event','cohort_deleted.php',49],['lib/grade','grade_item.php',1274],['mod/scorm/classes/event','tracks_viewed.php',64],['lib/classes/task','file_temp_cleanup_task.php',31],['lib/classes/event','course_viewed.php',75],['grade/report/overview/classes/event','grade_report_viewed.php',48],['lib/classes/task','stats_cron_task.php',31],['grade/report/user/classes/event','grade_report_viewed.php',48],['lib/classes/event','course_content_deleted.php',54],['lib/classes/task','backup_cleanup_task.php',31],['grade/report/singleview/classes/event','grade_report_viewed.php',39],['mod/quiz/classes/event','attempt_abandoned.php',63],['admin/tool/log/store/legacy/classes/task','cleanup_task.php',31],['mod/workshop/classes/event','phase_switched.php',75],['lib/classes/event','base.php',282],['grade/report/history/classes/event','grade_report_viewed.php',39],['lib/classes/event','content_viewed.php',80],['backup/util/ui','backup_ui.class.php',194],['lib/classes/event','course_completion_updated.php',47],['report/completion/classes/event','report_viewed.php',49],['lib/dml','pgsql_native_moodle_database.php',88],['backup/util/settings','base_setting.class.php',145],['lib/classes/task','messaging_cleanup_task.php',31],['question/classes/bank','modifier_name_column.php',27],['mod/forum/classes/event','discussion_updated.php',65],['lib/classes/event','course_reset_ended.php',53],['mod/choice/classes/event','answer_submitted.php',72],['mod/forum/classes/event','assessable_uploaded.php',86],['mod/wiki/classes/event','page_diff_viewed.php',55],['lib/classes/event','course_category_updated.php',51],['admin/tool/langimport/classes/event','langpack_updated.php',80],['lib/classes/task','session_cleanup_task.php',31],['lib/classes/task','completion_cron_task.php',31],['lib/classes/event','webservice_service_created.php',65],['lib/classes/event','course_created.php',55],['lib/dml','oci_native_moodle_database.php',94],['mod/lesson/classes/event','lesson_started.php',48],['mod/assign/classes/event','grading_table_viewed.php',79],['lib/classes/event','calendar_event_deleted.php',58],['backup/util/plan','base_task.class.php',58],['lib/classes/event','group_created.php',65],['mod/quiz/classes/event','user_override_created.php',53],['mod/glossary/classes/event','category_updated.php',46],['repository/coursefiles','lib.php',183],['mod/assign/classes/event','submission_viewed.php',76],['mod/glossary/classes/event','entry_disapproved.php',46],['lib/classes/event','user_password_updated.php',70],['mod/assign/classes/event','all_submissions_downloaded.php',75],['lib/dml','mariadb_native_moodle_database.php',41],['lib/classes/event','role_deleted.php',55],['admin/tool/log/store/legacy/tests/fixtures','event.php',31],['backup/util/ui','restore_ui.class.php',349],['lib/classes/event','user_loggedinas.php',57],['mod/assign/classes/event','submission_confirmation_form_viewed.php',79],['mod/assign/tests/fixtures','event_mod_assign_fixtures.php',62],['lib','modinfolib.php',1285],['mod/lesson/classes/event','essay_attempt_viewed.php',48],['mod/forum/classes/event','discussion_moved.php',66],['mod/assign/submission/onlinetext/classes/event','assessable_uploaded.php',83],['mod/assign/classes/event','reveal_identities_confirmation_page_viewed.php',79],['mod/survey/classes/event','report_downloaded.php',55],['mod/wiki/classes/event','page_updated.php',54],['admin/tool/log/store/standard/tests/fixtures','event.php',31],['mod/assign/classes/event','submission_unlocked.php',78],['lib/classes/event','user_list_viewed.php',56],['mod/forum/classes/event','readtracking_disabled.php',64],['lib/classes/event','comments_viewed.php',51],['lib/classes/event','cohort_member_added.php',49],['lib/classes/event','grouping_created.php',65],['lib/classes/event','recent_activity_viewed.php',49],['lib/classes/event','role_allow_switch_updated.php',47],['lib/dml','sqlsrv_native_moodle_database.php',102],['admin/tool/messageinbound/classes/message/inbound','invalid_recipient_handler.php',60],['mod/lti','OAuth.php',122],['mod/lti','OAuth.php',149],['mod/lti','OAuth.php',173],['question/classes/bank','question_name_column.php',28],['lib/classes/event','user_login_failed.php',56],['lib/classes/event','message_contact_added.php',48],['lib','enrollib.php',1075],['question/classes/bank','question_text_row.php',35],['lib/classes/event','role_allow_assign_updated.php',47],['mod/quiz/classes/event','user_override_deleted.php',53],['user/selector','lib.php',309],['mod/quiz/classes/event','edit_page_viewed.php',53],['lib/classes/event','email_failed.php',48],['portfolio/flickr','lib.php',41],['admin/tool/langimport/classes/task','update_langpacks_task.php',35],['lib/classes/event','tag_removed.php',58],['mod/lesson/classes/event','highscores_viewed.php',48],['report/stats/classes/event','user_report_viewed.php',48],['mod/quiz/classes/event','group_override_deleted.php',54],['mod/book/classes/event','chapter_updated.php',79],['lib/classes/log','reader.php',30],['mod/lesson/classes/event','question_viewed.php',54],['mod/scorm/classes/event','interactions_viewed.php',63],['lib/classes/event','course_module_updated.php',57],['mod/forum/classes/event','discussion_subscription_created.php',66],['lib/classes/task','plagiarism_cron_task.php',31],['mod/quiz/classes/event','question_manually_graded.php',55],['lib/classes/event','mnet_access_control_created.php',57],['lib/classes/event','role_assigned.php',56],['admin/tool/messageinbound/classes/task','pickup_task.php',38],['mod/lti/classes/local/ltiservice','service_base.php',87],['lib/classes/event','unknown_logged.php',43],['lib/simplepie/library/SimplePie','Author.php',106],['mod/scorm/classes/event','user_report_viewed.php',62],['admin/tool/monitor/classes/event','subscription_criteria_met.php',55],['mod/forum/classes/task','cron_task.php',30],['report/participation/classes/event','report_viewed.php',58],['lib/classes/event','user_updated.php',48],['backup/util/plan','base_step.class.php',49],['lib/classes/event','course_section_updated.php',56],['lib/classes/event','comment_deleted.php',58],['mod/assign/classes/event','marker_updated.php',89],['lib/classes/event','webservice_login_failed.php',71],['mod/assign/submission/file/classes/event','assessable_uploaded.php',85],['admin/tool/log/store/database/tests/fixtures','event.php',31],['mod/lti/classes/event','unknown_service_api_called.php',82],['lib/classes/event','cohort_updated.php',49],['mod/assign/submission/comments','locallib.php',39],['lib/editor/tinymce/classes','plugin.php',101],['mod/forum/classes/event','post_updated.php',67],['mod/book/classes/event','chapter_viewed.php',79],['portfolio/download','lib.php',9],['lib/classes/event','note_deleted.php',56],['lib/classes/event','user_loggedout.php',54],['lib/classes/event','grade_report_viewed.php',54],['lib/classes/task','file_trash_cleanup_task.php',31],['mod/assign/classes/event','workflow_state_updated.php',88],['mod/book/classes/event','chapter_deleted.php',79],['lib/classes/event','course_deleted.php',56],['lib/classes/event','blog_entry_deleted.php',53],['admin/tool/log/store/legacy/classes/event','legacy_logged.php',35],['question/classes/bank','copy_action_column.php',35],['mod/assign/feedback/editpdf','locallib.php',43],['lib/classes/event','webservice_token_created.php',65],['lib/tests/fixtures','task_fixtures.php',35],['lib/tests/fixtures','task_fixtures.php',44],['lib/tests/fixtures','task_fixtures.php',53],['mod/forum/classes/event','course_searched.php',66],['lib/classes/event','group_updated.php',65],['mod/quiz/classes/event','attempt_started.php',56],['mod/lesson/classes/event','group_override_updated.php',54],['lib/classes/event','course_module_viewed.php',62],['lib/classes/event','mnet_access_control_updated.php',57],['mod/quiz/classes/question/bank','add_action_column.php',45],['question/classes/bank','edit_action_column.php',35],['lib/classes/message/inbound','private_files_handler.php',56],['lib/tests/fixtures','event_fixtures.php',34],['lib/classes/task','password_reset_cleanup_task.php',31],['mod/quiz/classes/event','attempt_submitted.php',63],['mod/data/classes/event','field_created.php',58],['lib/classes/task','automated_backup_task.php',31],['lib/classes/event','question_category_created.php',48],['admin/tool/monitor/classes/event','rule_deleted.php',50],['backup/util/ui','restore_ui_stage.class.php',75],['backup/converter/moodle1','lib.php',1033],['mod/lesson/classes/event','group_override_created.php',55],['mod/workshop/classes/event','assessments_reset.php',74],['mod/lesson/classes/event','lesson_resumed.php',48],['mod/assign/classes/event','feedback_viewed.php',76],['grade/report/outcomes/classes/event','grade_report_viewed.php',39],['lib/classes/event','blog_entry_updated.php',74],['report/questioninstances/classes/event','report_viewed.php',55],['mod/assign/classes/event','submission_form_viewed.php',82],['mod/folder/classes/event','folder_updated.php',48],['mod/assign/classes/event','submission_created.php',57],['mod/assign/classes/event','statement_accepted.php',77],['lib/classes/event','grade_deleted.php',94],['lib/classes/event','role_capabilities_updated.php',51],['lib/classes/event','blog_entries_viewed.php',62],['lib/tests','messageinbound_test.php',170],['mod/wiki/classes/event','page_viewed.php',48],['lib/classes/event','group_deleted.php',65],['question/classes/bank','delete_action_column.php',36],['lib/classes/event','webservice_token_sent.php',56],['mod/quiz/classes/event','attempt_becameoverdue.php',66],['lib/classes/task','create_contexts_task.php',31],['mod/quiz/classes/event','attempt_viewed.php',54],['mod/assign/classes/event','submission_status_updated.php',79],['mod/assign/classes/event','grading_form_viewed.php',82],['calendar/tests','calendartype_test_example.php',32],['lib/classes/event','course_module_completion_updated.php',48],['mod/assign/feedback/file','locallib.php',45],['mod/workshop/classes/event','assessment_evaluated.php',66],['report/log/classes/event','report_viewed.php',58],['lib/classes/event','course_module_deleted.php',56],['lib/dml','mssql_native_moodle_database.php',83],['repository','lib.php',1884],['mod/book/classes/event','chapter_created.php',79],['mod/quiz/classes/question/bank','question_name_text_column.php',37],['mod/workshop/classes/event','submission_assessed.php',76],['lib/classes/event','cohort_created.php',49],['lib/classes/event','webservice_function_called.php',67],['mod/scorm/classes/event','sco_launched.php',64],['lib/classes/event','blog_entry_created.php',76],['lib/classes/event','user_enrolment_created.php',53],['mod/data/classes/event','record_created.php',56],['mod/quiz/classes/event','attempt_summary_viewed.php',56],['lib/classes/event','user_enrolment_updated.php',53],['admin/tool/log/store/standard/classes/task','cleanup_task.php',31],['mod/quiz/classes/event','attempt_reviewed.php',53],['lib/classes/task','cache_cleanup_task.php',31],['mod/lesson/classes/event','page_moved.php',56],['mod/glossary/classes/event','category_created.php',46],['mod/lesson/classes/event','page_created.php',54],['lib/classes/event','cohort_member_removed.php',50],['grade/report/singleview/classes/local/ui','unique_name.php',38],['mod/wiki/classes/event','page_version_viewed.php',54],['lib/classes/task','badges_cron_task.php',31],['lib/classes/event','role_allow_override_updated.php',47],['lib/classes/task','cache_cron_task.php',31],['mod/workshop/classes/event','assessable_uploaded.php',93],['lib/classes/event','grouping_updated.php',65],['admin/tool/monitor/classes/event','rule_updated.php',50],['lib/classes/event','course_module_created.php',86],['lib/classes/event','tag_added.php',58],['admin/tool/langimport/classes/event','langpack_removed.php',89],['mod/assign/classes/event','assessable_submitted.php',109],['mod/workshop/classes/event','submission_updated.php',63],['mod/lesson/classes/event','page_deleted.php',54],['lib/classes/event','grouping_deleted.php',72],['backup/util/ui','backup_ui_setting.class.php',86],['grade/report/singleview/classes/local/ui','grade_attribute_format.php',56],['backup/converter','convertlib.php',109],['lib/classes/event','tag_flagged.php',55],['mod/wiki/classes/event','page_history_viewed.php',48],['lib/classes/task','question_cron_task.php',31],['mod/survey/classes/event','report_viewed.php',55],['lib/classes/event','tag_created.php',55],['report/stats/classes/event','report_viewed.php',56],['lib/classes/event','note_created.php',56],['lib/simplepie/library/SimplePie','Credit.php',139],['lib/bennu','iCalendar_components.php',37],['lib/dml','mysqli_native_moodle_database.php',352],['lib/classes/event','course_reset_started.php',53],['admin/tool/monitor/classes/event','subscription_created.php',50],['mod/book/tool/print/classes/event','book_printed.php',76],['lib/classes/event','webservice_service_user_removed.php',59],['mod/data/classes/event','record_deleted.php',56],['mod/choice/classes/event','answer_updated.php',72],['message/tests/fixtures','inbound_fixtures.php',41],['lib/classes/event','group_member_removed.php',69],['mod/glossary/classes/event','entry_viewed.php',48],['mod/forum/classes/event','user_report_viewed.php',65],['lib/classes/event','course_category_deleted.php',59],['lib/classes/task','events_cron_task.php',31],['mod/forum/classes/event','subscription_created.php',65],['lib/classes/event','calendar_event_created.php',58],['lib/classes/event','message_contact_blocked.php',48],['lib/classes/event','webservice_service_updated.php',59],['backup/util/ui','base_ui_stage.class.php',110],['mod/wiki/classes/event','page_version_restored.php',54],['lib/classes/task','delete_unconfirmed_users_task.php',31],['mod/data/classes/event','template_viewed.php',55],['lib/classes/event','course_user_report_viewed.php',66],['mod/data/classes/event','record_updated.php',56],['mod/wiki/classes/event','page_map_viewed.php',54],['mod/wiki/classes/event','page_locks_deleted.php',54],['lib/classes/event','webservice_service_deleted.php',59],['lib/grade','grade_category.php',2128],['mod/forum/classes/event','readtracking_enabled.php',64],['mod/assign/feedback/comments','locallib.php',36],['question/behaviour','behaviourbase.php',83],['calendar/type/gregorian/classes','structure.php',29],['lib/classes/event','role_unassigned.php',53],['lib/classes/task','tag_cron_task.php',31],['lib/classes/task','blog_cron_task.php',31],['lib/classes/event','course_restored.php',58],['backup/util/structure','base_atom.class.php',71],['portfolio/boxnet','lib.php',14],['mod/choice/classes/event','report_viewed.php',47],['lib/classes/event','user_deleted.php',57],['lib/classes/event','user_enrolment_deleted.php',54],['lib/classes/task','send_failed_login_notifications_task.php',34],['mod/book/tool/print/classes/event','chapter_printed.php',79],['mod/assign/classes/event','identities_revealed.php',75],['lib/classes/event','user_graded.php',96],['lib/classes/event','course_updated.php',58],['admin/tool/log/classes/helper','reader.php',41],['mod/forum/classes/event','post_created.php',67],['mod/data/classes/event','field_deleted.php',57],['lib/classes/event','tag_deleted.php',55],['mod/glossary/classes/event','entry_created.php',52],['mod/forum/classes/event','discussion_created.php',65],['mod/forum/classes/event','discussion_deleted.php',66],['mod/scorm/classes/event','attempt_deleted.php',62],['mod/lesson/classes/event','lesson_ended.php',49],['lib/grade','grade_scale.php',156],['admin/tool/monitor/classes','subscription.php',123],['mod/forum/classes/event','subscribers_viewed.php',65],['backup/util/structure','restore_path_element.class.php',98],['mod/scorm/classes/event','report_viewed.php',63],['lib/classes/task','grade_cron_task.php',31],['grade/report/grader/classes/event','grade_report_viewed.php',39],['lib/dml/tests','dml_test.php',5409],['mod/lesson/classes/event','user_override_deleted.php',53],['report/completion/classes/event','user_report_viewed.php',49],['admin/tool/langimport/classes/event','langpack_imported.php',80],['mod/forum/classes/event','subscription_deleted.php',65],['mod/assign/feedback/offline','locallib.php',42],['mod/lesson/classes/event','highscore_added.php',56],['mod/lesson/classes/event','essay_assessed.php',78],['lib/classes/event','message_sent.php',82],['lib/classes/event','message_contact_removed.php',48],['lib/classes/event','tag_unflagged.php',55],['mod/assign/classes/event','submission_graded.php',78],['lib','csslib.php',2155],['lib','csslib.php',2283],['mod/assign/classes/event','batch_set_marker_allocation_viewed.php',79],['report/outline/classes/event','activity_report_viewed.php',48],['lib/classes/event','calendar_event_updated.php',58],['mod/lesson/classes/event','user_override_created.php',53],['lib/classes/task','legacy_plugin_cron_task.php',33],['portfolio/googledocs','lib.php',54],['mod/workshop/classes/event','assessment_reevaluated.php',76],['lib/dml','pdo_moodle_database.php',113],['lib','medialib.php',345],['mod/quiz/classes/event','user_override_updated.php',54],['lib/classes/event','webservice_service_user_added.php',59],['admin/tool/monitor/classes/event','subscription_deleted.php',50],['lib/classes/event','notes_viewed.php',49],['mod/glossary/classes/event','entry_updated.php',52],['admin/tool/monitor/classes/event','rule_created.php',50],['lib/classes/task','check_for_updates_task.php',31],['mod/wiki/classes/event','page_version_deleted.php',54],['lib/classes/event','course_completed.php',73],['mod/assign/classes/event','submission_status_viewed.php',81],['portfolio/mahara','lib.php',61],['mod/glossary/classes/event','entry_approved.php',46],['mod/wiki/classes/event','page_created.php',48],['mod/quiz/classes/event','group_override_created.php',55],['lib/classes/task','delete_incomplete_users_task.php',31],['question/classes/bank','creator_name_column.php',28],['lib/classes/event','group_member_added.php',78],['lib/classes/event','message_contact_unblocked.php',48],['mod/quiz/classes/event','attempt_deleted.php',47],['lib/classes/task','send_new_user_passwords_task.php',31],['lib/classes/event','user_loggedin.php',64],['admin/tool/monitor/classes/task','clean_events.php',32],['question/classes/bank','question_type_column.php',26],['admin/tool/monitor/classes','rule.php',239],['mod/lesson/classes/event','lesson_restarted.php',48],['lib/grade','grade_outcome.php',272]], 409],
'fetch_course_tree': ['fetch_course_tree', 'Returns tree with all grade_items and categories as elements ', [['lib/grade','grade_category.php',1825]], 2],
'list': ['list', '', [['mod/data/preset/imagegallery','jstemplate.js',9]], 1891],
'is_course_category': ['is_course_category', 'Return true if this is the top most category that represents the total course grade. ', [['lib/grade','grade_category.php',2269]], 9],
'set_sortorder': ['set_sortorder', 'Sets the sortorder of this grade_item. This method is also available in grade_category, for cases where the object type is not know. ', [['lib/grade','grade_item.php',1206],['lib/grade','grade_category.php',2244],['lib/filestorage','stored_file.php',884]], 7],
'fetch_course_category': ['fetch_course_category', 'Return the course level grade_category object ', [['lib/grade','grade_category.php',2279]], 20],
'force_regrading': ['force_regrading', 'Sets this grade_item\'s needsupdate to true. Also marks the course item as needing update. ', [['lib/grade','grade_item.php',808],['lib/grade','grade_category.php',411]], 29],
'get_sortorder': ['get_sortorder', 'Returns the sortorder of this grade_item. This method is also available in grade_category, for cases where the object type is not know. ', [['lib/grade','grade_item.php',1176],['repository','lib.php',197],['lib/grade','grade_category.php',2220],['lib/filestorage','stored_file.php',875],['lib/filebrowser','virtual_root_file.php',344],['lib/filebrowser','file_info.php',330],['lib/filebrowser','file_info_stored.php',303]], 22],
'build_path': ['build_path', 'Builds this category\'s path string based on its parents (if any) and its own id number. This is typically done just before inserting this object in the DB for the first time, or when a new parent is added or changed. It is a recursive function: once the calling object no longer has a parent, the path is complete. ', [['lib/grade','grade_category.php',163]], 4],
'refresh_grades': ['refresh_grades', 'Refetch grades from modules, plugins. ', [['lib/grade','grade_item.php',1488]], 6],
'load_parent_category': ['load_parent_category', 'Calls upon the get_parent_category method to retrieve the grade_category object from the DB and assigns it to $this->parent_category. It also returns the object. ', [['lib/grade','grade_item.php',883],['lib/grade','grade_category.php',2102]], 13],
'apply_default_settings': ['apply_default_settings', 'Applies default settings on this category ', [['lib/grade','grade_category.php',2450]], 4],
'insert': ['insert', 'Creates a customer resource if one does not already exist. (customers.insert) ', [['lib/google/src/Google/Service','Reseller.php',309],['lib/google/src/Google/Service','Reseller.php',473],['lib/adodb','adodb-active-recordx.inc.php',899],['lib/grade','grade_object.php',325],['lib/google/src/Google/Service','Replicapoolupdater.php',294],['lib/google/src/Google/Service','Fusiontables.php',674],['lib/google/src/Google/Service','Fusiontables.php',838],['lib/google/src/Google/Service','Fusiontables.php',1012],['lib/google/src/Google/Service','Fusiontables.php',1217],['lib/google/src/Google/Service','Blogger.php',1243],['lib/google/src/Google/Service','Blogger.php',1493],['lib/google/src/Google/Service','Doubleclicksearch.php',285],['lib/google/src/Google/Service','AdExchangeBuyer.php',476],['lib/google/src/Google/Service','AdExchangeBuyer.php',635],['lib/google/src/Google/Service','Manager.php',271],['lib/google/src/Google/Service','Manager.php',349],['lib/grade','grade_item.php',385],['lib/google/src/Google/Service','Gmail.php',993],['lib/google/src/Google/Service','Plus.php',475],['lib/google/src/Google/Service','Mirror.php',393],['lib/google/src/Google/Service','Mirror.php',451],['lib/google/src/Google/Service','Mirror.php',605],['lib/google/src/Google/Service','Mirror.php',687],['lib/google/src/Google/Service','Mirror.php',801],['lib/google/src/Google/Service','Urlshortener.php',124],['lib/google/src/Google/Service','Dfareporting.php',499],['lib/google/src/Google/Service','PlusDomains.php',481],['lib/google/src/Google/Service','PlusDomains.php',606],['lib/google/src/Google/Service','PlusDomains.php',732],['lib/google/src/Google/Service','PlusDomains.php',781],['lib/google/src/Google/Service','GroupsMigration.php',85],['lib/google/src/Google/Service','Licensing.php',253],['lib/google/src/Google/Service','Drive.php',1491],['lib/google/src/Google/Service','Drive.php',1568],['lib/google/src/Google/Service','Drive.php',1727],['lib/google/src/Google/Service','Drive.php',1961],['lib/google/src/Google/Service','Drive.php',2045],['lib/google/src/Google/Service','Drive.php',2164],['lib/google/src/Google/Service','Drive.php',2328],['completion','data_object.php',316],['lib/google/src/Google/Service','Books.php',1835],['lib/google/src/Google/Service','Bigquery.php',548],['lib/google/src/Google/Service','Bigquery.php',672],['lib/google/src/Google/Service','Bigquery.php',856],['lib/google/src/Google/Service','YouTube.php',1323],['lib/google/src/Google/Service','YouTube.php',1423],['lib/google/src/Google/Service','YouTube.php',1498],['lib/google/src/Google/Service','YouTube.php',2025],['lib/google/src/Google/Service','YouTube.php',2323],['lib/google/src/Google/Service','YouTube.php',2525],['lib/google/src/Google/Service','YouTube.php',2685],['lib/google/src/Google/Service','YouTube.php',3013],['lib/google/src/Google/Service','YouTube.php',3254],['lib/google/src/Google/Service','Coordinate.php',491],['lib/google/src/Google/Service','Autoscaler.php',346],['lib/google/src/Google/Service','ShoppingContent.php',582],['lib/google/src/Google/Service','ShoppingContent.php',764],['lib/google/src/Google/Service','ShoppingContent.php',1000],['lib/google/src/Google/Service','SQLAdmin.php',698],['lib/google/src/Google/Service','SQLAdmin.php',959],['lib/google/src/Google/Service','Directory.php',1504],['lib/google/src/Google/Service','Directory.php',1601],['lib/google/src/Google/Service','Directory.php',1671],['lib/google/src/Google/Service','Directory.php',1964],['lib/google/src/Google/Service','Directory.php',2071],['lib/google/src/Google/Service','Directory.php',2239],['lib/google/src/Google/Service','Directory.php',2419],['lib/google/src/Google/Service','Taskqueue.php',323],['lib/google/src/Google/Service','AndroidPublisher.php',1211],['lib/google/src/Google/Service','AndroidPublisher.php',2002],['lib/google/src/Google/Service','AdSenseHost.php',786],['lib/google/src/Google/Service','AdSenseHost.php',1041],['lib/google/src/Google/Service','AdSenseHost.php',1182],['lib/google/src/Google/Service','MapsEngine.php',2780],['lib/google/src/Google/Service','MapsEngine.php',3184],['lib/grade','grade_grade.php',928],['lib/google/src/Google/Service','SiteVerification.php',180],['lib/google/src/Google/Service','Prediction.php',290],['lib/google/src/Google/Service','Compute.php',2844],['lib/google/src/Google/Service','Compute.php',2944],['lib/google/src/Google/Service','Compute.php',3171],['lib/google/src/Google/Service','Compute.php',3255],['lib/google/src/Google/Service','Compute.php',3393],['lib/google/src/Google/Service','Compute.php',3493],['lib/google/src/Google/Service','Compute.php',3573],['lib/google/src/Google/Service','Compute.php',3757],['lib/google/src/Google/Service','Compute.php',3891],['lib/google/src/Google/Service','Compute.php',3973],['lib/google/src/Google/Service','Compute.php',4165],['lib/google/src/Google/Service','Compute.php',4436],['lib/google/src/Google/Service','Compute.php',4690],['lib/google/src/Google/Service','Compute.php',4838],['lib/google/src/Google/Service','Compute.php',4959],['lib/google/src/Google/Service','Compute.php',5120],['lib/google/src/Google/Service','Compute.php',5259],['lib/google/src/Google/Service','Calendar.php',915],['lib/google/src/Google/Service','Calendar.php',1067],['lib/google/src/Google/Service','Calendar.php',1255],['lib/google/src/Google/Service','Calendar.php',1422],['lib/google/src/Google/Service','Analytics.php',2082],['lib/google/src/Google/Service','Analytics.php',2326],['lib/google/src/Google/Service','Analytics.php',2444],['lib/google/src/Google/Service','Analytics.php',2539],['lib/google/src/Google/Service','Analytics.php',2666],['lib/google/src/Google/Service','Analytics.php',2776],['lib/google/src/Google/Service','Analytics.php',2883],['lib/google/src/Google/Service','Analytics.php',3022],['lib/google/src/Google/Service','Analytics.php',3216],['lib/google/src/Google/Service','Analytics.php',3323],['lib/google/src/Google/Service','Analytics.php',3421],['lib/google/src/Google/Service','Tasks.php',336],['lib/google/src/Google/Service','Tasks.php',456],['lib/grade','grade_category.php',318],['lib/google/src/Google/Service','Storage.php',980],['lib/google/src/Google/Service','Storage.php',1100],['lib/google/src/Google/Service','Storage.php',1262],['lib/google/src/Google/Service','Storage.php',1392],['lib/google/src/Google/Service','Storage.php',1619],['lib/grade','grade_scale.php',111],['lib/google/src/Google/Service','Admin.php',87],['lib/google/src/Google/Service','Replicapool.php',434],['lib/google/src/Google/Service','Resourceviews.php',471],['lib/adodb','adodb-active-record.inc.php',742],['lib/grade','grade_outcome.php',120]], 459],
'valid': ['valid', '', [['lib/tests','completionlib_test.php',884],['lib/adodb','adodb.inc.php',2798],['lib/adodb','adodb.inc.php',2874],['lib/google/src/Google','Collection.php',43],['lib/zend/Zend/Server','Definition.php',258],['lib/horde/framework/Horde/Imap/Client/Fetch','Query.php',378],['lib/horde/framework/Horde','Domhtml.php',331],['question/engine','questionusage.php',999],['lib/horde/framework/Horde/Imap/Client','Ids.php',419],['lib/dml','oci_native_moodle_recordset.php',76],['lib/horde/framework/Horde/Imap/Client','Tokenize.php',329],['lib/classes/dml','recordset_walk.php',127],['lib/horde/framework/Horde/Mail/Rfc822','List.php',439],['lib/zend/Zend/Service/Delicious','PostList.php',217],['backup/util/helper','backup_array_iterator.class.php',59],['lib/dml','mssql_native_moodle_recordset.php',83],['lib/dml','pgsql_native_moodle_recordset.php',100],['backup/cc/cc_lib','cc_version11.php',47],['lib/filestorage','zip_archive.php',514],['lib/zend/Zend/Service/Amazon','ResultSet.php',161],['lib/phpexcel/PHPExcel','WorksheetIterator.php',109],['question/engine/tests','helpers.php',1221],['lib/dml','mysqli_native_moodle_recordset.php',82],['lib/zend/Zend/Gdata/App','Feed.php',177],['lib/phpexcel/PHPExcel/Worksheet','RowIterator.php',140],['lib/zend/Zend/Service/Technorati','ResultSet.php',240],['lib/zend/Zend/Service/Flickr','ResultSet.php',178],['lib/zend/Zend/Uri','Http.php',270],['backup/cc/cc_lib','cc_asssesment.php',58],['backup/cc/cc_lib','cc_version1.php',47],['lib/horde/framework/Horde/Imap/Client/Data','AclRights.php',182],['lib/dml','sqlsrv_native_moodle_recordset.php',129],['question/engine','questionattempt.php',1624],['question/engine','questionattempt.php',1743],['lib/zend/Zend/Service/Yahoo','ResultSet.php',186],['backup/util/helper','backup_null_iterator.class.php',49],['lib/phpexcel/PHPExcel/Worksheet','CellIterator.php',119],['lib/dml','pdo_moodle_recordset.php',75]], 69],
'get_records_sql': ['get_records_sql', 'Get a number of records as an array of objects using a SQL statement. ', [['lib/dml','pgsql_native_moodle_database.php',732],['lib/dml','oci_native_moodle_database.php',1102],['lib/dml','sqlsrv_native_moodle_database.php',823],['lib/dml','mssql_native_moodle_database.php',741],['lib/dml','mysqli_native_moodle_database.php',1049],['lib/dml/tests','dml_test.php',5424],['lib/dml','pdo_moodle_database.php',308]], 678],
'get_grade_item': ['get_grade_item', 'Returns this grade_item. This method is also available in grade_category, for cases where the object type is not know. ', [['lib/grade','grade_item.php',1196],['mod/assign','locallib.php',1185],['lib/classes','grades_external.php',284],['lib/grade','grade_category.php',2063]], 23],
'is_overridden': ['is_overridden', 'Checks if grade overridden ', [['lib/grade','grade_grade.php',281]], 12],
'execute': ['execute', 'Exceptionally override the execute method, so, based in the activity_included setting, we are able to skip the execution of one task completely ', [['backup/moodle2','backup_activity_task.class.php',205],['backup/converter/moodle1','backuplib.php',10],['filter/tex','latex.php',60],['backup/util/plan','base_plan.class.php',158],['mod/lti/service/toolsettings/classes/local/resource','systemsettings.php',61],['mod/lti/service/toolsettings/classes/local/resource','linksettings.php',63],['mod/lti/service/profile/classes/local/resource','profile.php',76],['webservice','lib.php',1772],['lib/classes/task','context_cleanup_task.php',41],['lib/adodb','adodb.inc.php',967],['enrol/imsenterprise/classes/task','cron_task.php',43],['admin/tool/messageinbound/classes/task','cleanup_task.php',47],['lib/classes/task','calendar_cron_task.php',40],['mod/workshop/allocation/random','lib.php',83],['lib/classes/task','registration_cron_task.php',40],['lib/classes/task','portfolio_cron_task.php',40],['lib/htmlpurifier/HTMLPurifier/Strategy','Composite.php',21],['lib/google/src/Google/Http','Batch.php',56],['backup/converter/imscc11','lib.php',85],['lib/classes/task','file_temp_cleanup_task.php',40],['filter/tex','texdebug.php',287],['admin/tool/monitor/classes','notification_task.php',39],['lib/classes/task','stats_cron_task.php',40],['lib/classes/task','backup_cleanup_task.php',40],['admin/tool/log/store/legacy/classes/task','cleanup_task.php',40],['backup/util/ui','backup_ui.class.php',122],['lib/dml','pgsql_native_moodle_database.php',665],['lib/classes/task','messaging_cleanup_task.php',40],['lib/zend/Zend/Service/WindowsAzure/RetryPolicy','RetryN.php',68],['lib/classes/task','session_cleanup_task.php',40],['lib/classes/task','completion_cron_task.php',40],['lib/dml','oci_native_moodle_database.php',1009],['backup/util/plan','base_task.class.php',162],['lib/adodb/drivers','adodb-pdo.inc.php',464],['backup/util/plan','backup_plan.class.php',112],['backup/util/ui','restore_ui.class.php',206],['backup/converter/imscc11','backuplib.php',42],['backup/moodle2','restore_activity_task.class.php',183],['','mdeploy.php',743],['lib/dml','sqlsrv_native_moodle_database.php',745],['lib/htmlpurifier/HTMLPurifier/Strategy','MakeWellFormed.php',66],['lib/google/src/Google/Http','REST.php',28],['admin/tool/langimport/classes/task','update_langpacks_task.php',44],['mod/lti/service/toolproxy/classes/local/resource','toolproxy.php',62],['lib/classes/task','plagiarism_cron_task.php',40],['admin/tool/messageinbound/classes/task','pickup_task.php',47],['backup/util/plan','backup_structure_step.class.php',50],['mod/forum/classes/task','cron_task.php',39],['mod/workshop/allocation/scheduled','lib.php',128],['lib/classes/task','file_trash_cleanup_task.php',40],['backup/util/plan','restore_execution_step.class.php',25],['lib/tests/fixtures','task_fixtures.php',30],['lib/tests/fixtures','task_fixtures.php',39],['lib/tests/fixtures','task_fixtures.php',48],['lib/tests/fixtures','task_fixtures.php',57],['admin/tool/installaddon/classes','validator.php',114],['backup/util/plan','backup_execution_step.class.php',25],['lib/classes/task','password_reset_cleanup_task.php',40],['lib/classes/task','automated_backup_task.php',40],['backup/converter/moodle1','lib.php',142],['lib/htmlpurifier/HTMLPurifier/Strategy','ValidateAttributes.php',16],['lib/classes/task','create_contexts_task.php',40],['backup/util/plan','restore_plan.class.php',159],['backup/converter/imscc1','lib.php',84],['lib/dml','mssql_native_moodle_database.php',662],['admin/tool/log/store/standard/classes/task','cleanup_task.php',40],['lib/classes/task','cache_cleanup_task.php',40],['lib/classes/task','badges_cron_task.php',40],['lib/classes/task','cache_cron_task.php',40],['backup/util/interfaces','executable.class.php',32],['lib/htmlpurifier/HTMLPurifier/Strategy','FixNesting.php',41],['lib/adodb/drivers','adodb-oci8po.inc.php',52],['lib/classes/task','question_cron_task.php',40],['lib/zend/Zend/Service/WindowsAzure/RetryPolicy','NoRetry.php',37],['lib/dml','mysqli_native_moodle_database.php',955],['lib/htmlpurifier/HTMLPurifier/Strategy','RemoveForeignElements.php',20],['backup/util/plan/tests/fixtures','plan_fixtures.php',47],['backup/util/plan/tests/fixtures','plan_fixtures.php',55],['lib/classes/task','events_cron_task.php',40],['lib/classes/task','delete_unconfirmed_users_task.php',40],['lib/adodb/drivers','adodb-oci8.inc.php',786],['backup/converter/imscc1','backuplib.php',10],['lib/classes/task','tag_cron_task.php',40],['lib/classes/task','blog_cron_task.php',40],['lib/classes/task','send_failed_login_notifications_task.php',43],['lib/classes/task','grade_cron_task.php',40],['lib/dml/tests','dml_test.php',5422],['admin/tool/uploadcourse/classes','processor.php',174],['backup/moodle2','restore_section_task.class.php',87],['mod/lti/service/toolsettings/classes/local/resource','contextsettings.php',62],['lib/google/src/Google','Client.php',545],['backup/util/plan','restore_structure_step.class.php',62],['lib/classes/task','legacy_plugin_cron_task.php',42],['lib/dml','pdo_moodle_database.php',226],['lib/classes/task','check_for_updates_task.php',40],['backup/util/helper','restore_decode_processor.class.php',73],['backup/moodle2','backup_section_task.class.php',97],['webservice/amf/testclient','AMFTester.mxml',282],['lib/classes/task','delete_incomplete_users_task.php',40],['mod/assign','adminlib.php',342],['lib/classes/task','send_new_user_passwords_task.php',40],['admin/tool/monitor/classes/task','clean_events.php',41]], 733],
'auto_update_weights': ['auto_update_weights', 'Recalculate the weights of the grade items in this category. ', [['lib/grade','grade_category.php',1404]], 1],
'is_extracredit_used': ['is_extracredit_used', 'Returns true if category uses extra credit of any kind ', [['lib/grade','grade_category.php',1726]], 14],
'standardise_score': ['standardise_score', 'Given a float value situated between a source minimum and a source maximum, converts it to the corresponding value situated between a target minimum and a target maximum. Thanks to Darlene for the formula :-) ', [['lib/grade','grade_grade.php',596]], 17],
'close': ['close', 'Close the connection to the server ', [['lib/zend/Zend/Http/Client/Adapter','Socket.php',486],['lib/tests','completionlib_test.php',888],['lib/adodb','adodb.inc.php',2164],['lib/adodb','adodb.inc.php',2844],['lib/adodb','adodb.inc.php',3536],['lib','webdavlib.php',176],['admin/tool/uploaduser','locallib.php',149],['lib/dml','oci_native_moodle_recordset.php',80],['lib/tcpdf','tcpdf.php',2943],['lib/horde/framework/Horde/Imap/Client','Base.php',1846],['lib','excellib.class.php',93],['lib/zend/Zend/Http/Client/Adapter','Test.php',187],['lib/classes/dml','recordset_walk.php',153],['mod/assign/feedback/offline','importgradeslib.php',178],['lib/pear/Net','GeoIP.php',556],['backup/util/helper','backup_array_iterator.class.php',63],['lib/zend/Zend/Gdata/App','LoggingHttpClientAdapterSocket.php',109],['lib/zend/Zend/Http/Client/Adapter','Proxy.php',266],['lib/dml','mssql_native_moodle_recordset.php',87],['lib/pear/Auth','RADIUS.php',542],['lib/pear/Auth','RADIUS.php',703],['lib/pear/Auth','RADIUS.php',824],['lib/phpmailer','class.smtp.php',507],['lib/phpexcel/PHPExcel/Shared','ZipArchive.php',80],['lib/phpunit/classes','event_sink.php',39],['lib/zend/Zend/Http/Client/Adapter','Interface.php',73],['lib/dml','pgsql_native_moodle_recordset.php',104],['auth/fc','fcFPP.php',72],['lib/filestorage','zip_archive.php',183],['lib','odslib.class.php',71],['lib/horde/framework/Horde/Socket','Client.php',135],['question/engine/tests','helpers.php',1225],['grade','lib.php',323],['lib/dml','mysqli_native_moodle_recordset.php',86],['lib','csvlib.class.php',256],['lib/google/src/Google/Logger','File.php',130],['lib/horde/framework/Horde','Stream.php',585],['lib/phpunit/classes','phpmailer_sink.php',41],['lib/phpunit/classes','message_sink.php',39],['lib/zend/Zend/Http/Client/Adapter','Curl.php',460],['lib/dml','sqlsrv_native_moodle_recordset.php',133],['lib/zend/Zend/Service/WindowsAzure','SessionHandler.php',109],['backup/util/helper','backup_null_iterator.class.php',53],['grade/export','lib.php',662],['lib/dml','pdo_moodle_recordset.php',79]], 1036],
'apply_forced_settings': ['apply_forced_settings', 'Applies forced settings on this category ', [['lib/grade','grade_category.php',2470]], 14],
'set_hidden': ['set_hidden', 'Set a grade object hidden status ', [['lib/grade','grade_object.php',444],['lib/grade','grade_item.php',590],['lib/grade','grade_grade.php',565],['lib/grade','grade_category.php',2403]], 32],
'pre_regrade_final_grades': ['pre_regrade_final_grades', 'Something that should be called before we start regrading the whole course. ', [['lib/grade','grade_category.php',419]], 1],
'aggregate_grades': ['aggregate_grades', 'Internal function for grade category grade aggregation ', [['lib/grade','grade_category.php',542]], 2],
'updated_forced_settings': ['updated_forced_settings', 'Notification of change in forced category settings. ', [['lib/grade','grade_category.php',2496]], 1],
'get_in_or_equal': ['get_in_or_equal', 'Constructs \'IN()\' or \'=\' sql fragment ', [['lib/dml','oci_native_moodle_database.php',1583],['lib/dml','moodle_database.php',678]], 375],
'print_error': ['print_error', 'Abort execution by throwing of a general exception, default exception handler displays the error message in most cases. ', [['lib','setuplib.php',449]], 1560],
'is_editable': ['is_editable', 'Is grading object editable? ', [['lib/grade','grade_item.php',1015],['mod/workshop/form','assessment_form.php',115],['lib/grade','grade_grade.php',242],['lib/grade','grade_category.php',2303]], 6],
'array_key_exists': ['array_key_exists', '', [], 1539],
'arsort': ['arsort', '', [], 15],
'ksort': ['ksort', '', [], 158],
'substr_count': ['substr_count', '', [], 78],
'array_merge': ['array_merge', '', [], 2320],
'count': ['count', '', [], 3984],
'array_count_values': ['array_count_values', '', [], 8],
'defined': ['defined', '', [], 4098],
'preg_match': ['preg_match', '', [], 1317],
'is_string': ['is_string', '', [], 680],
'end': ['end', '', [], 432],
'in_array': ['in_array', '', [], 1173],
'array_sum': ['array_sum', '', [], 29],
'is_null': ['is_null', '', [], 1992],
'array_values': ['array_values', '', [], 283],
'print_r': ['print_r', '', [], 51],
'time': ['time', '', [], 1768],
'intval': ['intval', '', [], 484],
'reset': ['reset', '', [], 1070],
'array_keys': ['array_keys', '', [], 1152],
'rsort': ['rsort', '', [], 6],
'implode': ['implode', '', [], 1259],
'array_diff': ['array_diff', '', [], 93],
'asort': ['asort', '', [], 109]};
CLASS_DATA={
'grade_item': ['grade_item', 'Class representing a grade item. ', [['lib/grade','grade_item.php',29]], 206],
'grade_grade': ['grade_grade', 'grade_grades is an object mapped to DB table {prefix}grade_grades ', [['lib/grade','grade_grade.php',30]], 129],
'user_graded': ['user_graded', 'Event triggered after teacher edits manual grade or overrides activity/aggregated grade. ', [['lib/classes/event','user_graded.php',28]], 10],
'grade_category': ['grade_category', 'grade_category is an object mapped to DB table {prefix}grade_categories ', [['lib/grade','grade_category.php',29]], 144]};
CONST_DATA={
'DEBUG_DEVELOPER': ['DEBUG_DEVELOPER', '', [['lib','setuplib.php',40]], 554],
'GRADE_AGGREGATE_MEAN': ['GRADE_AGGREGATE_MEAN', '', [['lib/grade','constants.php',33]], 20],
'GRADE_AGGREGATE_SUM': ['GRADE_AGGREGATE_SUM', '', [['lib/grade','constants.php',73]], 47],
'GRADE_AGGREGATE_WEIGHTED_MEAN': ['GRADE_AGGREGATE_WEIGHTED_MEAN', '', [['lib/grade','constants.php',58]], 19],
'GRADE_AGGREGATE_EXTRACREDIT_MEAN': ['GRADE_AGGREGATE_EXTRACREDIT_MEAN', '', [['lib/grade','constants.php',68]], 16],
'SQL_PARAMS_NAMED': ['SQL_PARAMS_NAMED', '', [['lib/dml','moodle_database.php',32]], 271],
'GRADE_AGGREGATE_WEIGHTED_MEAN2': ['GRADE_AGGREGATE_WEIGHTED_MEAN2', '', [['lib/grade','constants.php',63]], 27],
'GRADE_AGGREGATE_MAX': ['GRADE_AGGREGATE_MAX', '', [['lib/grade','constants.php',48]], 12],
'GRADE_AGGREGATE_MODE': ['GRADE_AGGREGATE_MODE', '', [['lib/grade','constants.php',53]], 10],
'GRADE_AGGREGATE_MEDIAN': ['GRADE_AGGREGATE_MEDIAN', '', [['lib/grade','constants.php',38]], 13],
'GRADE_TYPE_NONE': ['GRADE_TYPE_NONE', '', [['lib/grade','constants.php',80]], 41],
'GRADE_TYPE_SCALE': ['GRADE_TYPE_SCALE', '', [['lib/grade','constants.php',90]], 63],
'GRADE_AGGREGATE_MIN': ['GRADE_AGGREGATE_MIN', '', [['lib/grade','constants.php',43]], 10],
'GRADE_TYPE_VALUE': ['GRADE_TYPE_VALUE', '', [['lib/grade','constants.php',85]], 71],
'GRADE_TYPE_TEXT': ['GRADE_TYPE_TEXT', '', [['lib/grade','constants.php',95]], 25],
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',138],['','install.php',93],['lib','setup.php',386]], 3532]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu May 28 19:17:31 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
