<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /lib/grade/grade_grade.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu May 28 19:17:31 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='lib/grade';
filename='grade_grade.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/lib/grade/</a> -> <a href="grade_grade.php.html">grade_grade.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="grade_grade.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="grade_grade.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * Definition of a class to represent an individual user's grade</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * @package   core_grades</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @category  grade</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @copyright 2006 Nicolas Connault</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> */</span>
<a name="l25"><span class="linenum">  25</span></a>  
<a name="l26"><span class="linenum">  26</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die();
<a name="l27"><span class="linenum">  27</span></a>  
<a name="l28"><span class="linenum">  28</span></a>  <span class="keyword">require_once</span> <a class="filename" href="../../lib/grade/grade_object.php.html" onMouseOver="reqPopup(event, 'grade_object.php', '../../lib/grade/grade_object.php')">('grade_object.php')</a>;
<a name="l29"><span class="linenum">  29</span></a>  
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment">/**</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment"> * grade_grades is an object mapped to DB table {prefix}grade_grades</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> *</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> * @package   core_grades</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> * @category  grade</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> * @copyright 2006 Nicolas Connault</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment"> * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment"> */</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a> extends grade_object {
<a name="l39"><span class="linenum">  39</span></a>  
<a name="l40"><span class="linenum">  40</span></a>      <span class="comment">/**</span>
<a name="l41"><span class="linenum">  41</span></a>  <span class="comment">     * The DB table.</span>
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment">     * @var string $table</span>
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment">     */</span>
<a name="l44"><span class="linenum">  44</span></a>      public <a class="var it127" onMouseOver="hilite(127)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = 'grade_grades';
<a name="l45"><span class="linenum">  45</span></a>  
<a name="l46"><span class="linenum">  46</span></a>      <span class="comment">/**</span>
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment">     * Array of required table fields, must start with 'id'.</span>
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment">     * @var array $required_fields</span>
<a name="l49"><span class="linenum">  49</span></a>  <span class="comment">     */</span>
<a name="l50"><span class="linenum">  50</span></a>      public <a class="var it3047" onMouseOver="hilite(3047)" onMouseOut="lolite()" onClick="logVariable('required_fields')" href="../../_variables/required_fields.html">$required_fields</a> = array('id', 'itemid', 'userid', 'rawgrade', 'rawgrademax', 'rawgrademin',
<a name="l51"><span class="linenum">  51</span></a>                                   'rawscaleid', 'usermodified', 'finalgrade', 'hidden', 'locked',
<a name="l52"><span class="linenum">  52</span></a>                                   'locktime', 'exported', 'overridden', 'excluded', 'timecreated',
<a name="l53"><span class="linenum">  53</span></a>                                   'timemodified', 'aggregationstatus', 'aggregationweight');
<a name="l54"><span class="linenum">  54</span></a>  
<a name="l55"><span class="linenum">  55</span></a>      <span class="comment">/**</span>
<a name="l56"><span class="linenum">  56</span></a>  <span class="comment">     * Array of optional fields with default values (these should match db defaults)</span>
<a name="l57"><span class="linenum">  57</span></a>  <span class="comment">     * @var array $optional_fields</span>
<a name="l58"><span class="linenum">  58</span></a>  <span class="comment">     */</span>
<a name="l59"><span class="linenum">  59</span></a>      public <a class="var it3048" onMouseOver="hilite(3048)" onMouseOut="lolite()" onClick="logVariable('optional_fields')" href="../../_variables/optional_fields.html">$optional_fields</a> = array('feedback'=&gt;null, 'feedbackformat'=&gt;0, 'information'=&gt;null, 'informationformat'=&gt;0);
<a name="l60"><span class="linenum">  60</span></a>  
<a name="l61"><span class="linenum">  61</span></a>      <span class="comment">/**</span>
<a name="l62"><span class="linenum">  62</span></a>  <span class="comment">     * The id of the grade_item this grade belongs to.</span>
<a name="l63"><span class="linenum">  63</span></a>  <span class="comment">     * @var int $itemid</span>
<a name="l64"><span class="linenum">  64</span></a>  <span class="comment">     */</span>
<a name="l65"><span class="linenum">  65</span></a>      public <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>;
<a name="l66"><span class="linenum">  66</span></a>  
<a name="l67"><span class="linenum">  67</span></a>      <span class="comment">/**</span>
<a name="l68"><span class="linenum">  68</span></a>  <span class="comment">     * The grade_item object referenced by $this-&gt;itemid.</span>
<a name="l69"><span class="linenum">  69</span></a>  <span class="comment">     * @var grade_item $grade_item</span>
<a name="l70"><span class="linenum">  70</span></a>  <span class="comment">     */</span>
<a name="l71"><span class="linenum">  71</span></a>      public <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>;
<a name="l72"><span class="linenum">  72</span></a>  
<a name="l73"><span class="linenum">  73</span></a>      <span class="comment">/**</span>
<a name="l74"><span class="linenum">  74</span></a>  <span class="comment">     * The id of the user this grade belongs to.</span>
<a name="l75"><span class="linenum">  75</span></a>  <span class="comment">     * @var int $userid</span>
<a name="l76"><span class="linenum">  76</span></a>  <span class="comment">     */</span>
<a name="l77"><span class="linenum">  77</span></a>      public <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>;
<a name="l78"><span class="linenum">  78</span></a>  
<a name="l79"><span class="linenum">  79</span></a>      <span class="comment">/**</span>
<a name="l80"><span class="linenum">  80</span></a>  <span class="comment">     * The grade value of this raw grade, if such was provided by the module.</span>
<a name="l81"><span class="linenum">  81</span></a>  <span class="comment">     * @var float $rawgrade</span>
<a name="l82"><span class="linenum">  82</span></a>  <span class="comment">     */</span>
<a name="l83"><span class="linenum">  83</span></a>      public <a class="var it4887" onMouseOver="hilite(4887)" onMouseOut="lolite()" onClick="logVariable('rawgrade')" href="../../_variables/rawgrade.html">$rawgrade</a>;
<a name="l84"><span class="linenum">  84</span></a>  
<a name="l85"><span class="linenum">  85</span></a>      <span class="comment">/**</span>
<a name="l86"><span class="linenum">  86</span></a>  <span class="comment">     * The maximum allowable grade when this grade was created.</span>
<a name="l87"><span class="linenum">  87</span></a>  <span class="comment">     * @var float $rawgrademax</span>
<a name="l88"><span class="linenum">  88</span></a>  <span class="comment">     */</span>
<a name="l89"><span class="linenum">  89</span></a>      public <a class="var it6502" onMouseOver="hilite(6502)" onMouseOut="lolite()" onClick="logVariable('rawgrademax')" href="../../_variables/rawgrademax.html">$rawgrademax</a> = 100;
<a name="l90"><span class="linenum">  90</span></a>  
<a name="l91"><span class="linenum">  91</span></a>      <span class="comment">/**</span>
<a name="l92"><span class="linenum">  92</span></a>  <span class="comment">     * The minimum allowable grade when this grade was created.</span>
<a name="l93"><span class="linenum">  93</span></a>  <span class="comment">     * @var float $rawgrademin</span>
<a name="l94"><span class="linenum">  94</span></a>  <span class="comment">     */</span>
<a name="l95"><span class="linenum">  95</span></a>      public <a class="var it6501" onMouseOver="hilite(6501)" onMouseOut="lolite()" onClick="logVariable('rawgrademin')" href="../../_variables/rawgrademin.html">$rawgrademin</a> = 0;
<a name="l96"><span class="linenum">  96</span></a>  
<a name="l97"><span class="linenum">  97</span></a>      <span class="comment">/**</span>
<a name="l98"><span class="linenum">  98</span></a>  <span class="comment">     * id of the scale, if this grade is based on a scale.</span>
<a name="l99"><span class="linenum">  99</span></a>  <span class="comment">     * @var int $rawscaleid</span>
<a name="l100"><span class="linenum"> 100</span></a>  <span class="comment">     */</span>
<a name="l101"><span class="linenum"> 101</span></a>      public <a class="var it10025" onMouseOver="hilite(10025)" onMouseOut="lolite()" onClick="logVariable('rawscaleid')" href="../../_variables/rawscaleid.html">$rawscaleid</a>;
<a name="l102"><span class="linenum"> 102</span></a>  
<a name="l103"><span class="linenum"> 103</span></a>      <span class="comment">/**</span>
<a name="l104"><span class="linenum"> 104</span></a>  <span class="comment">     * The userid of the person who last modified this grade.</span>
<a name="l105"><span class="linenum"> 105</span></a>  <span class="comment">     * @var int $usermodified</span>
<a name="l106"><span class="linenum"> 106</span></a>  <span class="comment">     */</span>
<a name="l107"><span class="linenum"> 107</span></a>      public <a class="var it5799" onMouseOver="hilite(5799)" onMouseOut="lolite()" onClick="logVariable('usermodified')" href="../../_variables/usermodified.html">$usermodified</a>;
<a name="l108"><span class="linenum"> 108</span></a>  
<a name="l109"><span class="linenum"> 109</span></a>      <span class="comment">/**</span>
<a name="l110"><span class="linenum"> 110</span></a>  <span class="comment">     * The final value of this grade.</span>
<a name="l111"><span class="linenum"> 111</span></a>  <span class="comment">     * @var float $finalgrade</span>
<a name="l112"><span class="linenum"> 112</span></a>  <span class="comment">     */</span>
<a name="l113"><span class="linenum"> 113</span></a>      public <a class="var it4888" onMouseOver="hilite(4888)" onMouseOut="lolite()" onClick="logVariable('finalgrade')" href="../../_variables/finalgrade.html">$finalgrade</a>;
<a name="l114"><span class="linenum"> 114</span></a>  
<a name="l115"><span class="linenum"> 115</span></a>      <span class="comment">/**</span>
<a name="l116"><span class="linenum"> 116</span></a>  <span class="comment">     * 0 if visible, 1 always hidden or date not visible until</span>
<a name="l117"><span class="linenum"> 117</span></a>  <span class="comment">     * @var float $hidden</span>
<a name="l118"><span class="linenum"> 118</span></a>  <span class="comment">     */</span>
<a name="l119"><span class="linenum"> 119</span></a>      public <a class="var it1532" onMouseOver="hilite(1532)" onMouseOut="lolite()" onClick="logVariable('hidden')" href="../../_variables/hidden.html">$hidden</a> = 0;
<a name="l120"><span class="linenum"> 120</span></a>  
<a name="l121"><span class="linenum"> 121</span></a>      <span class="comment">/**</span>
<a name="l122"><span class="linenum"> 122</span></a>  <span class="comment">     * 0 not locked, date when the item was locked</span>
<a name="l123"><span class="linenum"> 123</span></a>  <span class="comment">     * @var float locked</span>
<a name="l124"><span class="linenum"> 124</span></a>  <span class="comment">     */</span>
<a name="l125"><span class="linenum"> 125</span></a>      public <a class="var it996" onMouseOver="hilite(996)" onMouseOut="lolite()" onClick="logVariable('locked')" href="../../_variables/locked.html">$locked</a> = 0;
<a name="l126"><span class="linenum"> 126</span></a>  
<a name="l127"><span class="linenum"> 127</span></a>      <span class="comment">/**</span>
<a name="l128"><span class="linenum"> 128</span></a>  <span class="comment">     * 0 no automatic locking, date when to lock the grade automatically</span>
<a name="l129"><span class="linenum"> 129</span></a>  <span class="comment">     * @var float $locktime</span>
<a name="l130"><span class="linenum"> 130</span></a>  <span class="comment">     */</span>
<a name="l131"><span class="linenum"> 131</span></a>      public <a class="var it9479" onMouseOver="hilite(9479)" onMouseOut="lolite()" onClick="logVariable('locktime')" href="../../_variables/locktime.html">$locktime</a> = 0;
<a name="l132"><span class="linenum"> 132</span></a>  
<a name="l133"><span class="linenum"> 133</span></a>      <span class="comment">/**</span>
<a name="l134"><span class="linenum"> 134</span></a>  <span class="comment">     * Exported flag</span>
<a name="l135"><span class="linenum"> 135</span></a>  <span class="comment">     * @var bool $exported</span>
<a name="l136"><span class="linenum"> 136</span></a>  <span class="comment">     */</span>
<a name="l137"><span class="linenum"> 137</span></a>      public <a class="var it30671" onMouseOver="hilite(30671)" onMouseOut="lolite()" onClick="logVariable('exported')" href="../../_variables/exported.html">$exported</a> = 0;
<a name="l138"><span class="linenum"> 138</span></a>  
<a name="l139"><span class="linenum"> 139</span></a>      <span class="comment">/**</span>
<a name="l140"><span class="linenum"> 140</span></a>  <span class="comment">     * Overridden flag</span>
<a name="l141"><span class="linenum"> 141</span></a>  <span class="comment">     * @var bool $overridden</span>
<a name="l142"><span class="linenum"> 142</span></a>  <span class="comment">     */</span>
<a name="l143"><span class="linenum"> 143</span></a>      public <a class="var it9474" onMouseOver="hilite(9474)" onMouseOut="lolite()" onClick="logVariable('overridden')" href="../../_variables/overridden.html">$overridden</a> = 0;
<a name="l144"><span class="linenum"> 144</span></a>  
<a name="l145"><span class="linenum"> 145</span></a>      <span class="comment">/**</span>
<a name="l146"><span class="linenum"> 146</span></a>  <span class="comment">     * Grade excluded from aggregation functions</span>
<a name="l147"><span class="linenum"> 147</span></a>  <span class="comment">     * @var bool $excluded</span>
<a name="l148"><span class="linenum"> 148</span></a>  <span class="comment">     */</span>
<a name="l149"><span class="linenum"> 149</span></a>      public <a class="var it9475" onMouseOver="hilite(9475)" onMouseOut="lolite()" onClick="logVariable('excluded')" href="../../_variables/excluded.html">$excluded</a> = 0;
<a name="l150"><span class="linenum"> 150</span></a>  
<a name="l151"><span class="linenum"> 151</span></a>      <span class="comment">/**</span>
<a name="l152"><span class="linenum"> 152</span></a>  <span class="comment">     * TODO: HACK: create a new field datesubmitted - the date of submission if any (MDL-31377)</span>
<a name="l153"><span class="linenum"> 153</span></a>  <span class="comment">     * @var bool $timecreated</span>
<a name="l154"><span class="linenum"> 154</span></a>  <span class="comment">     */</span>
<a name="l155"><span class="linenum"> 155</span></a>      public <a class="var it1614" onMouseOver="hilite(1614)" onMouseOut="lolite()" onClick="logVariable('timecreated')" href="../../_variables/timecreated.html">$timecreated</a> = null;
<a name="l156"><span class="linenum"> 156</span></a>  
<a name="l157"><span class="linenum"> 157</span></a>      <span class="comment">/**</span>
<a name="l158"><span class="linenum"> 158</span></a>  <span class="comment">     * TODO: HACK: create a new field dategraded - the date of grading (MDL-31378)</span>
<a name="l159"><span class="linenum"> 159</span></a>  <span class="comment">     * @var bool $timemodified</span>
<a name="l160"><span class="linenum"> 160</span></a>  <span class="comment">     */</span>
<a name="l161"><span class="linenum"> 161</span></a>      public <a class="var it91" onMouseOver="hilite(91)" onMouseOut="lolite()" onClick="logVariable('timemodified')" href="../../_variables/timemodified.html">$timemodified</a> = null;
<a name="l162"><span class="linenum"> 162</span></a>  
<a name="l163"><span class="linenum"> 163</span></a>      <span class="comment">/**</span>
<a name="l164"><span class="linenum"> 164</span></a>  <span class="comment">     * Aggregation status flag. Can be one of 'unknown', 'dropped', 'novalue' or 'used'.</span>
<a name="l165"><span class="linenum"> 165</span></a>  <span class="comment">     * @var string $aggregationstatus</span>
<a name="l166"><span class="linenum"> 166</span></a>  <span class="comment">     */</span>
<a name="l167"><span class="linenum"> 167</span></a>      public <a class="var it30672" onMouseOver="hilite(30672)" onMouseOut="lolite()" onClick="logVariable('aggregationstatus')" href="../../_variables/aggregationstatus.html">$aggregationstatus</a> = 'unknown';
<a name="l168"><span class="linenum"> 168</span></a>  
<a name="l169"><span class="linenum"> 169</span></a>      <span class="comment">/**</span>
<a name="l170"><span class="linenum"> 170</span></a>  <span class="comment">     * Aggregation weight is the specific weight used in the aggregation calculation for this grade.</span>
<a name="l171"><span class="linenum"> 171</span></a>  <span class="comment">     * @var float $aggregationweight</span>
<a name="l172"><span class="linenum"> 172</span></a>  <span class="comment">     */</span>
<a name="l173"><span class="linenum"> 173</span></a>      public <a class="var it30673" onMouseOver="hilite(30673)" onMouseOut="lolite()" onClick="logVariable('aggregationweight')" href="../../_variables/aggregationweight.html">$aggregationweight</a> = null;
<a name="l174"><span class="linenum"> 174</span></a>  
<a name="l175"><span class="linenum"> 175</span></a>      <span class="comment">/**</span>
<a name="l176"><span class="linenum"> 176</span></a>  <span class="comment">     * Returns array of grades for given grade_item+users</span>
<a name="l177"><span class="linenum"> 177</span></a>  <span class="comment">     *</span>
<a name="l178"><span class="linenum"> 178</span></a>  <span class="comment">     * @param grade_item $grade_item</span>
<a name="l179"><span class="linenum"> 179</span></a>  <span class="comment">     * @param array $userids</span>
<a name="l180"><span class="linenum"> 180</span></a>  <span class="comment">     * @param bool $include_missing include grades that do not exist yet</span>
<a name="l181"><span class="linenum"> 181</span></a>  <span class="comment">     * @return array userid=&gt;grade_grade array</span>
<a name="l182"><span class="linenum"> 182</span></a>  <span class="comment">     */</span>
<a name="l183"><span class="linenum"> 183</span></a>      public static function <a class="function" onClick="logFunction('fetch_users_grades')" href="../../_functions/fetch_users_grades.html" onMouseOver="funcPopup(event,'fetch_users_grades')">fetch_users_grades</a>(<a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>, <a class="var it2955" onMouseOver="hilite(2955)" onMouseOut="lolite()" onClick="logVariable('userids')" href="../../_variables/userids.html">$userids</a>, <a class="var it30674" onMouseOver="hilite(30674)" onMouseOut="lolite()" onClick="logVariable('include_missing')" href="../../_variables/include_missing.html">$include_missing</a>=true) {
<a name="l184"><span class="linenum"> 184</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l185"><span class="linenum"> 185</span></a>  
<a name="l186"><span class="linenum"> 186</span></a>  <span class="comment">        // hmm, there might be a problem with length of sql query</span>
<a name="l187"><span class="linenum"> 187</span></a>  <span class="comment">        // if there are too many users requested - we might run out of memory anyway</span>
<a name="l188"><span class="linenum"> 188</span></a>          <a class="var it589" onMouseOver="hilite(589)" onMouseOut="lolite()" onClick="logVariable('limit')" href="../../_variables/limit.html">$limit</a> = 2000;
<a name="l189"><span class="linenum"> 189</span></a>          <a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a> = <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it2955" onMouseOver="hilite(2955)" onMouseOut="lolite()" onClick="logVariable('userids')" href="../../_variables/userids.html">$userids</a>);
<a name="l190"><span class="linenum"> 190</span></a>          if (<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a> &gt; <a class="var it589" onMouseOver="hilite(589)" onMouseOut="lolite()" onClick="logVariable('limit')" href="../../_variables/limit.html">$limit</a>) {
<a name="l191"><span class="linenum"> 191</span></a>              <a class="var it30675" onMouseOver="hilite(30675)" onMouseOut="lolite()" onClick="logVariable('half')" href="../../_variables/half.html">$half</a> = (int)(<a class="var it441" onMouseOver="hilite(441)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a>/2);
<a name="l192"><span class="linenum"> 192</span></a>              <a class="var it389" onMouseOver="hilite(389)" onMouseOut="lolite()" onClick="logVariable('first')" href="../../_variables/first.html">$first</a>  = <a class="phpfunction" onClick="logFunction('array_slice')" href="../../_functions/array_slice.html" onMouseOver="phpfuncPopup(event,'array_slice')">array_slice</a>(<a class="var it2955" onMouseOver="hilite(2955)" onMouseOut="lolite()" onClick="logVariable('userids')" href="../../_variables/userids.html">$userids</a>, 0, <a class="var it30675" onMouseOver="hilite(30675)" onMouseOut="lolite()" onClick="logVariable('half')" href="../../_variables/half.html">$half</a>);
<a name="l193"><span class="linenum"> 193</span></a>              <a class="var it1280" onMouseOver="hilite(1280)" onMouseOut="lolite()" onClick="logVariable('second')" href="../../_variables/second.html">$second</a> = <a class="phpfunction" onClick="logFunction('array_slice')" href="../../_functions/array_slice.html" onMouseOver="phpfuncPopup(event,'array_slice')">array_slice</a>(<a class="var it2955" onMouseOver="hilite(2955)" onMouseOut="lolite()" onClick="logVariable('userids')" href="../../_variables/userids.html">$userids</a>, <a class="var it30675" onMouseOver="hilite(30675)" onMouseOut="lolite()" onClick="logVariable('half')" href="../../_variables/half.html">$half</a>);
<a name="l194"><span class="linenum"> 194</span></a>              return <a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>::<a class="function" onClick="logFunction('fetch_users_grades')" href="../../_functions/fetch_users_grades.html" onMouseOver="funcPopup(event,'fetch_users_grades')">fetch_users_grades</a>(<a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>, <a class="var it389" onMouseOver="hilite(389)" onMouseOut="lolite()" onClick="logVariable('first')" href="../../_variables/first.html">$first</a>, <a class="var it30674" onMouseOver="hilite(30674)" onMouseOut="lolite()" onClick="logVariable('include_missing')" href="../../_variables/include_missing.html">$include_missing</a>) + <a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>::<a class="function" onClick="logFunction('fetch_users_grades')" href="../../_functions/fetch_users_grades.html" onMouseOver="funcPopup(event,'fetch_users_grades')">fetch_users_grades</a>(<a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>, <a class="var it1280" onMouseOver="hilite(1280)" onMouseOut="lolite()" onClick="logVariable('second')" href="../../_variables/second.html">$second</a>, <a class="var it30674" onMouseOver="hilite(30674)" onMouseOut="lolite()" onClick="logVariable('include_missing')" href="../../_variables/include_missing.html">$include_missing</a>);
<a name="l195"><span class="linenum"> 195</span></a>          }
<a name="l196"><span class="linenum"> 196</span></a>  
<a name="l197"><span class="linenum"> 197</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it30676" onMouseOver="hilite(30676)" onMouseOut="lolite()" onClick="logVariable('user_ids_cvs')" href="../../_variables/user_ids_cvs.html">$user_ids_cvs</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it2955" onMouseOver="hilite(2955)" onMouseOut="lolite()" onClick="logVariable('userids')" href="../../_variables/userids.html">$userids</a>, <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'uid0');
<a name="l198"><span class="linenum"> 198</span></a>          <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['giid'] = <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>-&gt;<a onClick="logVariable('id')" class="var it39507" onMouseOver="hilite(39507)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l199"><span class="linenum"> 199</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = array();
<a name="l200"><span class="linenum"> 200</span></a>          if (<a class="var it10031" onMouseOver="hilite(10031)" onMouseOut="lolite()" onClick="logVariable('grade_records')" href="../../_variables/grade_records.html">$grade_records</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_select')" href="../../_functions/get_records_select.html" onMouseOver="funcPopup(event,'get_records_select')">get_records_select</a>('grade_grades', &quot;itemid=:giid AND userid <a class="var it30676" onMouseOver="hilite(30676)" onMouseOut="lolite()" onClick="logVariable('user_ids_cvs')" href="../../_variables/user_ids_cvs.html">$user_ids_cvs</a>&quot;, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>)) {
<a name="l201"><span class="linenum"> 201</span></a>              foreach (<a class="var it10031" onMouseOver="hilite(10031)" onMouseOut="lolite()" onClick="logVariable('grade_records')" href="../../_variables/grade_records.html">$grade_records</a> as <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>) {
<a name="l202"><span class="linenum"> 202</span></a>                  <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>[<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('userid')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>] = <span class="keyword">new </span><a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>, false);
<a name="l203"><span class="linenum"> 203</span></a>              }
<a name="l204"><span class="linenum"> 204</span></a>          }
<a name="l205"><span class="linenum"> 205</span></a>          if (<a class="var it30674" onMouseOver="hilite(30674)" onMouseOut="lolite()" onClick="logVariable('include_missing')" href="../../_variables/include_missing.html">$include_missing</a>) {
<a name="l206"><span class="linenum"> 206</span></a>              foreach (<a class="var it2955" onMouseOver="hilite(2955)" onMouseOut="lolite()" onClick="logVariable('userids')" href="../../_variables/userids.html">$userids</a> as <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>) {
<a name="l207"><span class="linenum"> 207</span></a>                  if (!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>)) {
<a name="l208"><span class="linenum"> 208</span></a>                      <a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../_variables/grade_grade.html">$grade_grade</a> = <span class="keyword">new </span><a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>();
<a name="l209"><span class="linenum"> 209</span></a>                      <a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../_variables/grade_grade.html">$grade_grade</a>-&gt;<a onClick="logVariable('userid')" class="var it39508" onMouseOver="hilite(39508)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> = <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>;
<a name="l210"><span class="linenum"> 210</span></a>                      <a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../_variables/grade_grade.html">$grade_grade</a>-&gt;<a onClick="logVariable('itemid')" class="var it39508" onMouseOver="hilite(39508)" onMouseOut="lolite()" href="../../_variables/itemid.html">itemid</a> = <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>-&gt;<a onClick="logVariable('id')" class="var it39507" onMouseOver="hilite(39507)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l211"><span class="linenum"> 211</span></a>                      <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>[<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>] = <a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../_variables/grade_grade.html">$grade_grade</a>;
<a name="l212"><span class="linenum"> 212</span></a>                  }
<a name="l213"><span class="linenum"> 213</span></a>              }
<a name="l214"><span class="linenum"> 214</span></a>          }
<a name="l215"><span class="linenum"> 215</span></a>  
<a name="l216"><span class="linenum"> 216</span></a>          return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l217"><span class="linenum"> 217</span></a>      }
<a name="l218"><span class="linenum"> 218</span></a>  
<a name="l219"><span class="linenum"> 219</span></a>      <span class="comment">/**</span>
<a name="l220"><span class="linenum"> 220</span></a>  <span class="comment">     * Loads the grade_item object referenced by $this-&gt;itemid and saves it as $this-&gt;grade_item for easy access</span>
<a name="l221"><span class="linenum"> 221</span></a>  <span class="comment">     *</span>
<a name="l222"><span class="linenum"> 222</span></a>  <span class="comment">     * @return grade_item The grade_item instance referenced by $this-&gt;itemid</span>
<a name="l223"><span class="linenum"> 223</span></a>  <span class="comment">     */</span>
<a name="l224"><span class="linenum"> 224</span></a>      public function <a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>() {
<a name="l225"><span class="linenum"> 225</span></a>          if (empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('itemid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/itemid.html">itemid</a>)) {
<a name="l226"><span class="linenum"> 226</span></a>              <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Missing itemid');
<a name="l227"><span class="linenum"> 227</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a> = null;
<a name="l228"><span class="linenum"> 228</span></a>              return null;
<a name="l229"><span class="linenum"> 229</span></a>          }
<a name="l230"><span class="linenum"> 230</span></a>  
<a name="l231"><span class="linenum"> 231</span></a>          if (empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>)) {
<a name="l232"><span class="linenum"> 232</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a> = <a class="class" onClick="logClass('grade_item')" href="../../_classes/grade_item.html" onMouseOver="classPopup(event,'grade_item')">grade_item</a>::<a class="function" onClick="logFunction('fetch')" href="../../_functions/fetch.html" onMouseOver="funcPopup(event,'fetch')">fetch</a>(array('id'=&gt;<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('itemid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/itemid.html">itemid</a>));
<a name="l233"><span class="linenum"> 233</span></a>  
<a name="l234"><span class="linenum"> 234</span></a>          } else if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;id != <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('itemid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/itemid.html">itemid</a>) {
<a name="l235"><span class="linenum"> 235</span></a>              <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Itemid mismatch');
<a name="l236"><span class="linenum"> 236</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a> = <a class="class" onClick="logClass('grade_item')" href="../../_classes/grade_item.html" onMouseOver="classPopup(event,'grade_item')">grade_item</a>::<a class="function" onClick="logFunction('fetch')" href="../../_functions/fetch.html" onMouseOver="funcPopup(event,'fetch')">fetch</a>(array('id'=&gt;<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('itemid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/itemid.html">itemid</a>));
<a name="l237"><span class="linenum"> 237</span></a>          }
<a name="l238"><span class="linenum"> 238</span></a>  
<a name="l239"><span class="linenum"> 239</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>;
<a name="l240"><span class="linenum"> 240</span></a>      }
<a name="l241"><span class="linenum"> 241</span></a>  
<a name="l242"><span class="linenum"> 242</span></a>      <span class="comment">/**</span>
<a name="l243"><span class="linenum"> 243</span></a>  <span class="comment">     * Is grading object editable?</span>
<a name="l244"><span class="linenum"> 244</span></a>  <span class="comment">     *</span>
<a name="l245"><span class="linenum"> 245</span></a>  <span class="comment">     * @return bool</span>
<a name="l246"><span class="linenum"> 246</span></a>  <span class="comment">     */</span>
<a name="l247"><span class="linenum"> 247</span></a>      public function <a class="function" onClick="logFunction('is_editable')" href="../../_functions/is_editable.html" onMouseOver="funcPopup(event,'is_editable')">is_editable</a>() {
<a name="l248"><span class="linenum"> 248</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_locked')" href="../../_functions/is_locked.html" onMouseOver="funcPopup(event,'is_locked')">is_locked</a>()) {
<a name="l249"><span class="linenum"> 249</span></a>              return false;
<a name="l250"><span class="linenum"> 250</span></a>          }
<a name="l251"><span class="linenum"> 251</span></a>  
<a name="l252"><span class="linenum"> 252</span></a>          <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l253"><span class="linenum"> 253</span></a>  
<a name="l254"><span class="linenum"> 254</span></a>          if (<a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>-&gt;<a onClick="logVariable('gradetype')" class="var it39507" onMouseOver="hilite(39507)" onMouseOut="lolite()" href="../../_variables/gradetype.html">gradetype</a> == <a class="constant" onClick="logConstant('GRADE_TYPE_NONE')" href="../../_constants/GRADE_TYPE_NONE.html" onMouseOver="constPopup(event,'GRADE_TYPE_NONE')">GRADE_TYPE_NONE</a>) {
<a name="l255"><span class="linenum"> 255</span></a>              return false;
<a name="l256"><span class="linenum"> 256</span></a>          }
<a name="l257"><span class="linenum"> 257</span></a>  
<a name="l258"><span class="linenum"> 258</span></a>          if (<a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>-&gt;<a class="function" onClick="logFunction('is_course_item')" href="../../_functions/is_course_item.html" onMouseOver="funcPopup(event,'is_course_item')">is_course_item</a>() or <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>-&gt;<a class="function" onClick="logFunction('is_category_item')" href="../../_functions/is_category_item.html" onMouseOver="funcPopup(event,'is_category_item')">is_category_item</a>()) {
<a name="l259"><span class="linenum"> 259</span></a>              return (bool)<a class="function" onClick="logFunction('get_config')" href="../../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>('moodle', 'grade_overridecat');
<a name="l260"><span class="linenum"> 260</span></a>          }
<a name="l261"><span class="linenum"> 261</span></a>  
<a name="l262"><span class="linenum"> 262</span></a>          return true;
<a name="l263"><span class="linenum"> 263</span></a>      }
<a name="l264"><span class="linenum"> 264</span></a>  
<a name="l265"><span class="linenum"> 265</span></a>      <span class="comment">/**</span>
<a name="l266"><span class="linenum"> 266</span></a>  <span class="comment">     * Check grade lock status. Uses both grade item lock and grade lock.</span>
<a name="l267"><span class="linenum"> 267</span></a>  <span class="comment">     * Internally any date in locked field (including future ones) means locked,</span>
<a name="l268"><span class="linenum"> 268</span></a>  <span class="comment">     * the date is stored for logging purposes only.</span>
<a name="l269"><span class="linenum"> 269</span></a>  <span class="comment">     *</span>
<a name="l270"><span class="linenum"> 270</span></a>  <span class="comment">     * @return bool True if locked, false if not</span>
<a name="l271"><span class="linenum"> 271</span></a>  <span class="comment">     */</span>
<a name="l272"><span class="linenum"> 272</span></a>      public function <a class="function" onClick="logFunction('is_locked')" href="../../_functions/is_locked.html" onMouseOver="funcPopup(event,'is_locked')">is_locked</a>() {
<a name="l273"><span class="linenum"> 273</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l274"><span class="linenum"> 274</span></a>          if (empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>)) {
<a name="l275"><span class="linenum"> 275</span></a>              return !empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('locked')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/locked.html">locked</a>);
<a name="l276"><span class="linenum"> 276</span></a>          } else {
<a name="l277"><span class="linenum"> 277</span></a>              return !empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('locked')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/locked.html">locked</a>) or <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('is_locked')" href="../../_functions/is_locked.html" onMouseOver="funcPopup(event,'is_locked')">is_locked</a>();
<a name="l278"><span class="linenum"> 278</span></a>          }
<a name="l279"><span class="linenum"> 279</span></a>      }
<a name="l280"><span class="linenum"> 280</span></a>  
<a name="l281"><span class="linenum"> 281</span></a>      <span class="comment">/**</span>
<a name="l282"><span class="linenum"> 282</span></a>  <span class="comment">     * Checks if grade overridden</span>
<a name="l283"><span class="linenum"> 283</span></a>  <span class="comment">     *</span>
<a name="l284"><span class="linenum"> 284</span></a>  <span class="comment">     * @return bool True if grade is overriden</span>
<a name="l285"><span class="linenum"> 285</span></a>  <span class="comment">     */</span>
<a name="l286"><span class="linenum"> 286</span></a>      public function <a class="function" onClick="logFunction('is_overridden')" href="../../_functions/is_overridden.html" onMouseOver="funcPopup(event,'is_overridden')">is_overridden</a>() {
<a name="l287"><span class="linenum"> 287</span></a>          return !empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('overridden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/overridden.html">overridden</a>);
<a name="l288"><span class="linenum"> 288</span></a>      }
<a name="l289"><span class="linenum"> 289</span></a>  
<a name="l290"><span class="linenum"> 290</span></a>      <span class="comment">/**</span>
<a name="l291"><span class="linenum"> 291</span></a>  <span class="comment">     * Returns timestamp of submission related to this grade, null if not submitted.</span>
<a name="l292"><span class="linenum"> 292</span></a>  <span class="comment">     *</span>
<a name="l293"><span class="linenum"> 293</span></a>  <span class="comment">     * @return int Timestamp</span>
<a name="l294"><span class="linenum"> 294</span></a>  <span class="comment">     */</span>
<a name="l295"><span class="linenum"> 295</span></a>      public function <a class="function" onClick="logFunction('get_datesubmitted')" href="../../_functions/get_datesubmitted.html" onMouseOver="funcPopup(event,'get_datesubmitted')">get_datesubmitted</a>() {
<a name="l296"><span class="linenum"> 296</span></a>  <span class="comment">        //TODO: HACK - create new fields (MDL-31379)</span>
<a name="l297"><span class="linenum"> 297</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('timecreated')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a>;
<a name="l298"><span class="linenum"> 298</span></a>      }
<a name="l299"><span class="linenum"> 299</span></a>  
<a name="l300"><span class="linenum"> 300</span></a>      <span class="comment">/**</span>
<a name="l301"><span class="linenum"> 301</span></a>  <span class="comment">     * Returns the weight this grade contributed to the aggregated grade</span>
<a name="l302"><span class="linenum"> 302</span></a>  <span class="comment">     *</span>
<a name="l303"><span class="linenum"> 303</span></a>  <span class="comment">     * @return float|null</span>
<a name="l304"><span class="linenum"> 304</span></a>  <span class="comment">     */</span>
<a name="l305"><span class="linenum"> 305</span></a>      public function <a class="function" onClick="logFunction('get_aggregationweight')" href="../../_functions/get_aggregationweight.html" onMouseOver="funcPopup(event,'get_aggregationweight')">get_aggregationweight</a>() {
<a name="l306"><span class="linenum"> 306</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregationweight')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregationweight.html">aggregationweight</a>;
<a name="l307"><span class="linenum"> 307</span></a>      }
<a name="l308"><span class="linenum"> 308</span></a>  
<a name="l309"><span class="linenum"> 309</span></a>      <span class="comment">/**</span>
<a name="l310"><span class="linenum"> 310</span></a>  <span class="comment">     * Set aggregationweight.</span>
<a name="l311"><span class="linenum"> 311</span></a>  <span class="comment">     *</span>
<a name="l312"><span class="linenum"> 312</span></a>  <span class="comment">     * @param float $aggregationweight</span>
<a name="l313"><span class="linenum"> 313</span></a>  <span class="comment">     * @return void</span>
<a name="l314"><span class="linenum"> 314</span></a>  <span class="comment">     */</span>
<a name="l315"><span class="linenum"> 315</span></a>      public function <a class="function" onClick="logFunction('set_aggregationweight')" href="../../_functions/set_aggregationweight.html" onMouseOver="funcPopup(event,'set_aggregationweight')">set_aggregationweight</a>(<a class="var it30673" onMouseOver="hilite(30673)" onMouseOut="lolite()" onClick="logVariable('aggregationweight')" href="../../_variables/aggregationweight.html">$aggregationweight</a>) {
<a name="l316"><span class="linenum"> 316</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregationweight')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregationweight.html">aggregationweight</a> = <a class="var it30673" onMouseOver="hilite(30673)" onMouseOut="lolite()" onClick="logVariable('aggregationweight')" href="../../_variables/aggregationweight.html">$aggregationweight</a>;
<a name="l317"><span class="linenum"> 317</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>();
<a name="l318"><span class="linenum"> 318</span></a>      }
<a name="l319"><span class="linenum"> 319</span></a>  
<a name="l320"><span class="linenum"> 320</span></a>      <span class="comment">/**</span>
<a name="l321"><span class="linenum"> 321</span></a>  <span class="comment">     * Returns the info on how this value was used in the aggregated grade</span>
<a name="l322"><span class="linenum"> 322</span></a>  <span class="comment">     *</span>
<a name="l323"><span class="linenum"> 323</span></a>  <span class="comment">     * @return string One of 'dropped', 'excluded', 'novalue', 'used' or 'extra'</span>
<a name="l324"><span class="linenum"> 324</span></a>  <span class="comment">     */</span>
<a name="l325"><span class="linenum"> 325</span></a>      public function <a class="function" onClick="logFunction('get_aggregationstatus')" href="../../_functions/get_aggregationstatus.html" onMouseOver="funcPopup(event,'get_aggregationstatus')">get_aggregationstatus</a>() {
<a name="l326"><span class="linenum"> 326</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregationstatus')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregationstatus.html">aggregationstatus</a>;
<a name="l327"><span class="linenum"> 327</span></a>      }
<a name="l328"><span class="linenum"> 328</span></a>  
<a name="l329"><span class="linenum"> 329</span></a>      <span class="comment">/**</span>
<a name="l330"><span class="linenum"> 330</span></a>  <span class="comment">     * Set aggregationstatus flag</span>
<a name="l331"><span class="linenum"> 331</span></a>  <span class="comment">     *</span>
<a name="l332"><span class="linenum"> 332</span></a>  <span class="comment">     * @param string $aggregationstatus</span>
<a name="l333"><span class="linenum"> 333</span></a>  <span class="comment">     * @return void</span>
<a name="l334"><span class="linenum"> 334</span></a>  <span class="comment">     */</span>
<a name="l335"><span class="linenum"> 335</span></a>      public function <a class="function" onClick="logFunction('set_aggregationstatus')" href="../../_functions/set_aggregationstatus.html" onMouseOver="funcPopup(event,'set_aggregationstatus')">set_aggregationstatus</a>(<a class="var it30672" onMouseOver="hilite(30672)" onMouseOut="lolite()" onClick="logVariable('aggregationstatus')" href="../../_variables/aggregationstatus.html">$aggregationstatus</a>) {
<a name="l336"><span class="linenum"> 336</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('aggregationstatus')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/aggregationstatus.html">aggregationstatus</a> = <a class="var it30672" onMouseOver="hilite(30672)" onMouseOut="lolite()" onClick="logVariable('aggregationstatus')" href="../../_variables/aggregationstatus.html">$aggregationstatus</a>;
<a name="l337"><span class="linenum"> 337</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>();
<a name="l338"><span class="linenum"> 338</span></a>      }
<a name="l339"><span class="linenum"> 339</span></a>  
<a name="l340"><span class="linenum"> 340</span></a>      <span class="comment">/**</span>
<a name="l341"><span class="linenum"> 341</span></a>  <span class="comment">     * Returns timestamp when last graded, null if no grade present</span>
<a name="l342"><span class="linenum"> 342</span></a>  <span class="comment">     *</span>
<a name="l343"><span class="linenum"> 343</span></a>  <span class="comment">     * @return int</span>
<a name="l344"><span class="linenum"> 344</span></a>  <span class="comment">     */</span>
<a name="l345"><span class="linenum"> 345</span></a>      public function <a class="function" onClick="logFunction('get_dategraded')" href="../../_functions/get_dategraded.html" onMouseOver="funcPopup(event,'get_dategraded')">get_dategraded</a>() {
<a name="l346"><span class="linenum"> 346</span></a>  <span class="comment">        //TODO: HACK - create new fields (MDL-31379)</span>
<a name="l347"><span class="linenum"> 347</span></a>          if (<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('finalgrade')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/finalgrade.html">finalgrade</a>) and <a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('feedback')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/feedback.html">feedback</a>)) {
<a name="l348"><span class="linenum"> 348</span></a>              return null; <span class="comment">// no grade == no date</span>
<a name="l349"><span class="linenum"> 349</span></a>          } else if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('overridden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/overridden.html">overridden</a>) {
<a name="l350"><span class="linenum"> 350</span></a>              return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('overridden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/overridden.html">overridden</a>;
<a name="l351"><span class="linenum"> 351</span></a>          } else {
<a name="l352"><span class="linenum"> 352</span></a>              return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('timemodified')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a>;
<a name="l353"><span class="linenum"> 353</span></a>          }
<a name="l354"><span class="linenum"> 354</span></a>      }
<a name="l355"><span class="linenum"> 355</span></a>  
<a name="l356"><span class="linenum"> 356</span></a>      <span class="comment">/**</span>
<a name="l357"><span class="linenum"> 357</span></a>  <span class="comment">     * Set the overridden status of grade</span>
<a name="l358"><span class="linenum"> 358</span></a>  <span class="comment">     *</span>
<a name="l359"><span class="linenum"> 359</span></a>  <span class="comment">     * @param bool $state requested overridden state</span>
<a name="l360"><span class="linenum"> 360</span></a>  <span class="comment">     * @param bool $refresh refresh grades from external activities if needed</span>
<a name="l361"><span class="linenum"> 361</span></a>  <span class="comment">     * @return bool true is db state changed</span>
<a name="l362"><span class="linenum"> 362</span></a>  <span class="comment">     */</span>
<a name="l363"><span class="linenum"> 363</span></a>      public function <a class="function" onClick="logFunction('set_overridden')" href="../../_functions/set_overridden.html" onMouseOver="funcPopup(event,'set_overridden')">set_overridden</a>(<a class="var it1082" onMouseOver="hilite(1082)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>, <a class="var it10000" onMouseOver="hilite(10000)" onMouseOut="lolite()" onClick="logVariable('refresh')" href="../../_variables/refresh.html">$refresh</a> = true) {
<a name="l364"><span class="linenum"> 364</span></a>          if (empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('overridden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/overridden.html">overridden</a>) and <a class="var it1082" onMouseOver="hilite(1082)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>) {
<a name="l365"><span class="linenum"> 365</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('overridden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/overridden.html">overridden</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l366"><span class="linenum"> 366</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>();
<a name="l367"><span class="linenum"> 367</span></a>              return true;
<a name="l368"><span class="linenum"> 368</span></a>  
<a name="l369"><span class="linenum"> 369</span></a>          } else if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('overridden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/overridden.html">overridden</a>) and !<a class="var it1082" onMouseOver="hilite(1082)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>) {
<a name="l370"><span class="linenum"> 370</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('overridden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/overridden.html">overridden</a> = 0;
<a name="l371"><span class="linenum"> 371</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>();
<a name="l372"><span class="linenum"> 372</span></a>  
<a name="l373"><span class="linenum"> 373</span></a>              if (<a class="var it10000" onMouseOver="hilite(10000)" onMouseOut="lolite()" onClick="logVariable('refresh')" href="../../_variables/refresh.html">$refresh</a>) {
<a name="l374"><span class="linenum"> 374</span></a>  <span class="comment">                //refresh when unlocking</span>
<a name="l375"><span class="linenum"> 375</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('refresh_grades')" href="../../_functions/refresh_grades.html" onMouseOver="funcPopup(event,'refresh_grades')">refresh_grades</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('userid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>);
<a name="l376"><span class="linenum"> 376</span></a>              }
<a name="l377"><span class="linenum"> 377</span></a>  
<a name="l378"><span class="linenum"> 378</span></a>              return true;
<a name="l379"><span class="linenum"> 379</span></a>          }
<a name="l380"><span class="linenum"> 380</span></a>          return false;
<a name="l381"><span class="linenum"> 381</span></a>      }
<a name="l382"><span class="linenum"> 382</span></a>  
<a name="l383"><span class="linenum"> 383</span></a>      <span class="comment">/**</span>
<a name="l384"><span class="linenum"> 384</span></a>  <span class="comment">     * Checks if grade excluded from aggregation functions</span>
<a name="l385"><span class="linenum"> 385</span></a>  <span class="comment">     *</span>
<a name="l386"><span class="linenum"> 386</span></a>  <span class="comment">     * @return bool True if grade is excluded from aggregation</span>
<a name="l387"><span class="linenum"> 387</span></a>  <span class="comment">     */</span>
<a name="l388"><span class="linenum"> 388</span></a>      public function <a class="function" onClick="logFunction('is_excluded')" href="../../_functions/is_excluded.html" onMouseOver="funcPopup(event,'is_excluded')">is_excluded</a>() {
<a name="l389"><span class="linenum"> 389</span></a>          return !empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('excluded')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/excluded.html">excluded</a>);
<a name="l390"><span class="linenum"> 390</span></a>      }
<a name="l391"><span class="linenum"> 391</span></a>  
<a name="l392"><span class="linenum"> 392</span></a>      <span class="comment">/**</span>
<a name="l393"><span class="linenum"> 393</span></a>  <span class="comment">     * Set the excluded status of grade</span>
<a name="l394"><span class="linenum"> 394</span></a>  <span class="comment">     *</span>
<a name="l395"><span class="linenum"> 395</span></a>  <span class="comment">     * @param bool $state requested excluded state</span>
<a name="l396"><span class="linenum"> 396</span></a>  <span class="comment">     * @return bool True is database state changed</span>
<a name="l397"><span class="linenum"> 397</span></a>  <span class="comment">     */</span>
<a name="l398"><span class="linenum"> 398</span></a>      public function <a class="function" onClick="logFunction('set_excluded')" href="../../_functions/set_excluded.html" onMouseOver="funcPopup(event,'set_excluded')">set_excluded</a>(<a class="var it1082" onMouseOver="hilite(1082)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>) {
<a name="l399"><span class="linenum"> 399</span></a>          if (empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('excluded')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/excluded.html">excluded</a>) and <a class="var it1082" onMouseOver="hilite(1082)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>) {
<a name="l400"><span class="linenum"> 400</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('excluded')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/excluded.html">excluded</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l401"><span class="linenum"> 401</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>();
<a name="l402"><span class="linenum"> 402</span></a>              return true;
<a name="l403"><span class="linenum"> 403</span></a>  
<a name="l404"><span class="linenum"> 404</span></a>          } else if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('excluded')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/excluded.html">excluded</a>) and !<a class="var it1082" onMouseOver="hilite(1082)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>) {
<a name="l405"><span class="linenum"> 405</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('excluded')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/excluded.html">excluded</a> = 0;
<a name="l406"><span class="linenum"> 406</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>();
<a name="l407"><span class="linenum"> 407</span></a>              return true;
<a name="l408"><span class="linenum"> 408</span></a>          }
<a name="l409"><span class="linenum"> 409</span></a>          return false;
<a name="l410"><span class="linenum"> 410</span></a>      }
<a name="l411"><span class="linenum"> 411</span></a>  
<a name="l412"><span class="linenum"> 412</span></a>      <span class="comment">/**</span>
<a name="l413"><span class="linenum"> 413</span></a>  <span class="comment">     * Lock/unlock this grade.</span>
<a name="l414"><span class="linenum"> 414</span></a>  <span class="comment">     *</span>
<a name="l415"><span class="linenum"> 415</span></a>  <span class="comment">     * @param int $lockedstate 0, 1 or a timestamp int(10) after which date the item will be locked.</span>
<a name="l416"><span class="linenum"> 416</span></a>  <span class="comment">     * @param bool $cascade Ignored param</span>
<a name="l417"><span class="linenum"> 417</span></a>  <span class="comment">     * @param bool $refresh Refresh grades when unlocking</span>
<a name="l418"><span class="linenum"> 418</span></a>  <span class="comment">     * @return bool True if successful, false if can not set new lock state for grade</span>
<a name="l419"><span class="linenum"> 419</span></a>  <span class="comment">     */</span>
<a name="l420"><span class="linenum"> 420</span></a>      public function <a class="function" onClick="logFunction('set_locked')" href="../../_functions/set_locked.html" onMouseOver="funcPopup(event,'set_locked')">set_locked</a>(<a class="var it9999" onMouseOver="hilite(9999)" onMouseOut="lolite()" onClick="logVariable('lockedstate')" href="../../_variables/lockedstate.html">$lockedstate</a>, <a class="var it3056" onMouseOver="hilite(3056)" onMouseOut="lolite()" onClick="logVariable('cascade')" href="../../_variables/cascade.html">$cascade</a>=false, <a class="var it10000" onMouseOver="hilite(10000)" onMouseOut="lolite()" onClick="logVariable('refresh')" href="../../_variables/refresh.html">$refresh</a>=true) {
<a name="l421"><span class="linenum"> 421</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l422"><span class="linenum"> 422</span></a>  
<a name="l423"><span class="linenum"> 423</span></a>          if (<a class="var it9999" onMouseOver="hilite(9999)" onMouseOut="lolite()" onClick="logVariable('lockedstate')" href="../../_variables/lockedstate.html">$lockedstate</a>) {
<a name="l424"><span class="linenum"> 424</span></a>              if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;needsupdate) {
<a name="l425"><span class="linenum"> 425</span></a>  <span class="comment">                //can not lock grade if final not calculated!</span>
<a name="l426"><span class="linenum"> 426</span></a>                  return false;
<a name="l427"><span class="linenum"> 427</span></a>              }
<a name="l428"><span class="linenum"> 428</span></a>  
<a name="l429"><span class="linenum"> 429</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('locked')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/locked.html">locked</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l430"><span class="linenum"> 430</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>();
<a name="l431"><span class="linenum"> 431</span></a>  
<a name="l432"><span class="linenum"> 432</span></a>              return true;
<a name="l433"><span class="linenum"> 433</span></a>  
<a name="l434"><span class="linenum"> 434</span></a>          } else {
<a name="l435"><span class="linenum"> 435</span></a>              if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('locked')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/locked.html">locked</a>) and <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('locktime')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/locktime.html">locktime</a> &lt; <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>()) {
<a name="l436"><span class="linenum"> 436</span></a>  <span class="comment">                //we have to reset locktime or else it would lock up again</span>
<a name="l437"><span class="linenum"> 437</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('locktime')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/locktime.html">locktime</a> = 0;
<a name="l438"><span class="linenum"> 438</span></a>              }
<a name="l439"><span class="linenum"> 439</span></a>  
<a name="l440"><span class="linenum"> 440</span></a>  <span class="comment">            // remove the locked flag</span>
<a name="l441"><span class="linenum"> 441</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('locked')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/locked.html">locked</a> = 0;
<a name="l442"><span class="linenum"> 442</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>();
<a name="l443"><span class="linenum"> 443</span></a>  
<a name="l444"><span class="linenum"> 444</span></a>              if (<a class="var it10000" onMouseOver="hilite(10000)" onMouseOut="lolite()" onClick="logVariable('refresh')" href="../../_variables/refresh.html">$refresh</a> and !<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_overridden')" href="../../_functions/is_overridden.html" onMouseOver="funcPopup(event,'is_overridden')">is_overridden</a>()) {
<a name="l445"><span class="linenum"> 445</span></a>  <span class="comment">                //refresh when unlocking and not overridden</span>
<a name="l446"><span class="linenum"> 446</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('refresh_grades')" href="../../_functions/refresh_grades.html" onMouseOver="funcPopup(event,'refresh_grades')">refresh_grades</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('userid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>);
<a name="l447"><span class="linenum"> 447</span></a>              }
<a name="l448"><span class="linenum"> 448</span></a>  
<a name="l449"><span class="linenum"> 449</span></a>              return true;
<a name="l450"><span class="linenum"> 450</span></a>          }
<a name="l451"><span class="linenum"> 451</span></a>      }
<a name="l452"><span class="linenum"> 452</span></a>  
<a name="l453"><span class="linenum"> 453</span></a>      <span class="comment">/**</span>
<a name="l454"><span class="linenum"> 454</span></a>  <span class="comment">     * Lock the grade if needed. Make sure this is called only when final grades are valid</span>
<a name="l455"><span class="linenum"> 455</span></a>  <span class="comment">     *</span>
<a name="l456"><span class="linenum"> 456</span></a>  <span class="comment">     * @param array $items array of all grade item ids</span>
<a name="l457"><span class="linenum"> 457</span></a>  <span class="comment">     * @return void</span>
<a name="l458"><span class="linenum"> 458</span></a>  <span class="comment">     */</span>
<a name="l459"><span class="linenum"> 459</span></a>      public static function <a class="function" onClick="logFunction('check_locktime_all')" href="../../_functions/check_locktime_all.html" onMouseOver="funcPopup(event,'check_locktime_all')">check_locktime_all</a>(<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>) {
<a name="l460"><span class="linenum"> 460</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l461"><span class="linenum"> 461</span></a>  
<a name="l462"><span class="linenum"> 462</span></a>          <a class="var it345" onMouseOver="hilite(345)" onMouseOut="lolite()" onClick="logVariable('now')" href="../../_variables/now.html">$now</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>(); <span class="comment">// no rounding needed, this is not supposed to be called every 10 seconds</span>
<a name="l463"><span class="linenum"> 463</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it2909" onMouseOver="hilite(2909)" onMouseOut="lolite()" onClick="logVariable('usql')" href="../../_variables/usql.html">$usql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it135" onMouseOver="hilite(135)" onMouseOut="lolite()" onClick="logVariable('items')" href="../../_variables/items.html">$items</a>);
<a name="l464"><span class="linenum"> 464</span></a>          <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>[] = <a class="var it345" onMouseOver="hilite(345)" onMouseOut="lolite()" onClick="logVariable('now')" href="../../_variables/now.html">$now</a>;
<a name="l465"><span class="linenum"> 465</span></a>          <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../_variables/rs.html">$rs</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset_select')" href="../../_functions/get_recordset_select.html" onMouseOver="funcPopup(event,'get_recordset_select')">get_recordset_select</a>('grade_grades', &quot;itemid <a class="var it2909" onMouseOver="hilite(2909)" onMouseOut="lolite()" onClick="logVariable('usql')" href="../../_variables/usql.html">$usql</a> AND locked = 0 AND locktime &gt; 0 AND locktime &lt; ?&quot;, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l466"><span class="linenum"> 466</span></a>          foreach (<a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../_variables/rs.html">$rs</a> as <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>) {
<a name="l467"><span class="linenum"> 467</span></a>              <a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../_variables/grade_grade.html">$grade_grade</a> = <span class="keyword">new </span><a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>(<a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>, false);
<a name="l468"><span class="linenum"> 468</span></a>              <a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../_variables/grade_grade.html">$grade_grade</a>-&gt;<a onClick="logVariable('locked')" class="var it39508" onMouseOver="hilite(39508)" onMouseOut="lolite()" href="../../_variables/locked.html">locked</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l469"><span class="linenum"> 469</span></a>              <a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../_variables/grade_grade.html">$grade_grade</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>('locktime');
<a name="l470"><span class="linenum"> 470</span></a>          }
<a name="l471"><span class="linenum"> 471</span></a>          <a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../_variables/rs.html">$rs</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l472"><span class="linenum"> 472</span></a>      }
<a name="l473"><span class="linenum"> 473</span></a>  
<a name="l474"><span class="linenum"> 474</span></a>      <span class="comment">/**</span>
<a name="l475"><span class="linenum"> 475</span></a>  <span class="comment">     * Set the locktime for this grade.</span>
<a name="l476"><span class="linenum"> 476</span></a>  <span class="comment">     *</span>
<a name="l477"><span class="linenum"> 477</span></a>  <span class="comment">     * @param int $locktime timestamp for lock to activate</span>
<a name="l478"><span class="linenum"> 478</span></a>  <span class="comment">     * @return void</span>
<a name="l479"><span class="linenum"> 479</span></a>  <span class="comment">     */</span>
<a name="l480"><span class="linenum"> 480</span></a>      public function <a class="function" onClick="logFunction('set_locktime')" href="../../_functions/set_locktime.html" onMouseOver="funcPopup(event,'set_locktime')">set_locktime</a>(<a class="var it9479" onMouseOver="hilite(9479)" onMouseOut="lolite()" onClick="logVariable('locktime')" href="../../_variables/locktime.html">$locktime</a>) {
<a name="l481"><span class="linenum"> 481</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('locktime')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/locktime.html">locktime</a> = <a class="var it9479" onMouseOver="hilite(9479)" onMouseOut="lolite()" onClick="logVariable('locktime')" href="../../_variables/locktime.html">$locktime</a>;
<a name="l482"><span class="linenum"> 482</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>();
<a name="l483"><span class="linenum"> 483</span></a>      }
<a name="l484"><span class="linenum"> 484</span></a>  
<a name="l485"><span class="linenum"> 485</span></a>      <span class="comment">/**</span>
<a name="l486"><span class="linenum"> 486</span></a>  <span class="comment">     * Get the locktime for this grade.</span>
<a name="l487"><span class="linenum"> 487</span></a>  <span class="comment">     *</span>
<a name="l488"><span class="linenum"> 488</span></a>  <span class="comment">     * @return int $locktime timestamp for lock to activate</span>
<a name="l489"><span class="linenum"> 489</span></a>  <span class="comment">     */</span>
<a name="l490"><span class="linenum"> 490</span></a>      public function <a class="function" onClick="logFunction('get_locktime')" href="../../_functions/get_locktime.html" onMouseOver="funcPopup(event,'get_locktime')">get_locktime</a>() {
<a name="l491"><span class="linenum"> 491</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l492"><span class="linenum"> 492</span></a>  
<a name="l493"><span class="linenum"> 493</span></a>          <a class="var it30677" onMouseOver="hilite(30677)" onMouseOut="lolite()" onClick="logVariable('item_locktime')" href="../../_variables/item_locktime.html">$item_locktime</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('get_locktime')" href="../../_functions/get_locktime.html" onMouseOver="funcPopup(event,'get_locktime')">get_locktime</a>();
<a name="l494"><span class="linenum"> 494</span></a>  
<a name="l495"><span class="linenum"> 495</span></a>          if (empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('locktime')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/locktime.html">locktime</a>) <a class="function" onClick="logFunction('or')" href="../../_functions/or.html" onMouseOver="funcPopup(event,'or')">or</a> (<a class="var it30677" onMouseOver="hilite(30677)" onMouseOut="lolite()" onClick="logVariable('item_locktime')" href="../../_variables/item_locktime.html">$item_locktime</a> and <a class="var it30677" onMouseOver="hilite(30677)" onMouseOut="lolite()" onClick="logVariable('item_locktime')" href="../../_variables/item_locktime.html">$item_locktime</a> &lt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('locktime')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/locktime.html">locktime</a>)) {
<a name="l496"><span class="linenum"> 496</span></a>              return <a class="var it30677" onMouseOver="hilite(30677)" onMouseOut="lolite()" onClick="logVariable('item_locktime')" href="../../_variables/item_locktime.html">$item_locktime</a>;
<a name="l497"><span class="linenum"> 497</span></a>  
<a name="l498"><span class="linenum"> 498</span></a>          } else {
<a name="l499"><span class="linenum"> 499</span></a>              return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('locktime')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/locktime.html">locktime</a>;
<a name="l500"><span class="linenum"> 500</span></a>          }
<a name="l501"><span class="linenum"> 501</span></a>      }
<a name="l502"><span class="linenum"> 502</span></a>  
<a name="l503"><span class="linenum"> 503</span></a>      <span class="comment">/**</span>
<a name="l504"><span class="linenum"> 504</span></a>  <span class="comment">     * Check grade hidden status. Uses data from both grade item and grade.</span>
<a name="l505"><span class="linenum"> 505</span></a>  <span class="comment">     *</span>
<a name="l506"><span class="linenum"> 506</span></a>  <span class="comment">     * @return bool true if hidden, false if not</span>
<a name="l507"><span class="linenum"> 507</span></a>  <span class="comment">     */</span>
<a name="l508"><span class="linenum"> 508</span></a>      public function <a class="function" onClick="logFunction('is_hidden')" href="../../_functions/is_hidden.html" onMouseOver="funcPopup(event,'is_hidden')">is_hidden</a>() {
<a name="l509"><span class="linenum"> 509</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l510"><span class="linenum"> 510</span></a>          if (empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>)) {
<a name="l511"><span class="linenum"> 511</span></a>              return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hidden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/hidden.html">hidden</a> == 1 <a class="function" onClick="logFunction('or')" href="../../_functions/or.html" onMouseOver="funcPopup(event,'or')">or</a> (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hidden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/hidden.html">hidden</a> != 0 and <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hidden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/hidden.html">hidden</a> &gt; <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>());
<a name="l512"><span class="linenum"> 512</span></a>          } else {
<a name="l513"><span class="linenum"> 513</span></a>              return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hidden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/hidden.html">hidden</a> == 1 <a class="function" onClick="logFunction('or')" href="../../_functions/or.html" onMouseOver="funcPopup(event,'or')">or</a> (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hidden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/hidden.html">hidden</a> != 0 and <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hidden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/hidden.html">hidden</a> &gt; <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>()) or <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('is_hidden')" href="../../_functions/is_hidden.html" onMouseOver="funcPopup(event,'is_hidden')">is_hidden</a>();
<a name="l514"><span class="linenum"> 514</span></a>          }
<a name="l515"><span class="linenum"> 515</span></a>      }
<a name="l516"><span class="linenum"> 516</span></a>  
<a name="l517"><span class="linenum"> 517</span></a>      <span class="comment">/**</span>
<a name="l518"><span class="linenum"> 518</span></a>  <span class="comment">     * Check grade hidden status. Uses data from both grade item and grade.</span>
<a name="l519"><span class="linenum"> 519</span></a>  <span class="comment">     *</span>
<a name="l520"><span class="linenum"> 520</span></a>  <span class="comment">     * @return bool true if hiddenuntil, false if not</span>
<a name="l521"><span class="linenum"> 521</span></a>  <span class="comment">     */</span>
<a name="l522"><span class="linenum"> 522</span></a>      public function <a class="function" onClick="logFunction('is_hiddenuntil')" href="../../_functions/is_hiddenuntil.html" onMouseOver="funcPopup(event,'is_hiddenuntil')">is_hiddenuntil</a>() {
<a name="l523"><span class="linenum"> 523</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l524"><span class="linenum"> 524</span></a>  
<a name="l525"><span class="linenum"> 525</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hidden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/hidden.html">hidden</a> == 1 or <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;hidden == 1) {
<a name="l526"><span class="linenum"> 526</span></a>              return false; <span class="comment">//always hidden</span>
<a name="l527"><span class="linenum"> 527</span></a>          }
<a name="l528"><span class="linenum"> 528</span></a>  
<a name="l529"><span class="linenum"> 529</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hidden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/hidden.html">hidden</a> &gt; 1 or <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;hidden &gt; 1) {
<a name="l530"><span class="linenum"> 530</span></a>              return true;
<a name="l531"><span class="linenum"> 531</span></a>          }
<a name="l532"><span class="linenum"> 532</span></a>  
<a name="l533"><span class="linenum"> 533</span></a>          return false;
<a name="l534"><span class="linenum"> 534</span></a>      }
<a name="l535"><span class="linenum"> 535</span></a>  
<a name="l536"><span class="linenum"> 536</span></a>      <span class="comment">/**</span>
<a name="l537"><span class="linenum"> 537</span></a>  <span class="comment">     * Check grade hidden status. Uses data from both grade item and grade.</span>
<a name="l538"><span class="linenum"> 538</span></a>  <span class="comment">     *</span>
<a name="l539"><span class="linenum"> 539</span></a>  <span class="comment">     * @return int 0 means visible, 1 hidden always, timestamp hidden until</span>
<a name="l540"><span class="linenum"> 540</span></a>  <span class="comment">     */</span>
<a name="l541"><span class="linenum"> 541</span></a>      public function <a class="function" onClick="logFunction('get_hidden')" href="../../_functions/get_hidden.html" onMouseOver="funcPopup(event,'get_hidden')">get_hidden</a>() {
<a name="l542"><span class="linenum"> 542</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l543"><span class="linenum"> 543</span></a>  
<a name="l544"><span class="linenum"> 544</span></a>          <a class="var it30678" onMouseOver="hilite(30678)" onMouseOut="lolite()" onClick="logVariable('item_hidden')" href="../../_variables/item_hidden.html">$item_hidden</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;<a class="function" onClick="logFunction('get_hidden')" href="../../_functions/get_hidden.html" onMouseOver="funcPopup(event,'get_hidden')">get_hidden</a>();
<a name="l545"><span class="linenum"> 545</span></a>  
<a name="l546"><span class="linenum"> 546</span></a>          if (<a class="var it30678" onMouseOver="hilite(30678)" onMouseOut="lolite()" onClick="logVariable('item_hidden')" href="../../_variables/item_hidden.html">$item_hidden</a> == 1) {
<a name="l547"><span class="linenum"> 547</span></a>              return 1;
<a name="l548"><span class="linenum"> 548</span></a>  
<a name="l549"><span class="linenum"> 549</span></a>          } else if (<a class="var it30678" onMouseOver="hilite(30678)" onMouseOut="lolite()" onClick="logVariable('item_hidden')" href="../../_variables/item_hidden.html">$item_hidden</a> == 0) {
<a name="l550"><span class="linenum"> 550</span></a>              return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hidden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/hidden.html">hidden</a>;
<a name="l551"><span class="linenum"> 551</span></a>  
<a name="l552"><span class="linenum"> 552</span></a>          } else {
<a name="l553"><span class="linenum"> 553</span></a>              if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hidden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/hidden.html">hidden</a> == 0) {
<a name="l554"><span class="linenum"> 554</span></a>                  return <a class="var it30678" onMouseOver="hilite(30678)" onMouseOut="lolite()" onClick="logVariable('item_hidden')" href="../../_variables/item_hidden.html">$item_hidden</a>;
<a name="l555"><span class="linenum"> 555</span></a>              } else if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hidden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/hidden.html">hidden</a> == 1) {
<a name="l556"><span class="linenum"> 556</span></a>                  return 1;
<a name="l557"><span class="linenum"> 557</span></a>              } else if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hidden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/hidden.html">hidden</a> &gt; <a class="var it30678" onMouseOver="hilite(30678)" onMouseOut="lolite()" onClick="logVariable('item_hidden')" href="../../_variables/item_hidden.html">$item_hidden</a>) {
<a name="l558"><span class="linenum"> 558</span></a>                  return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hidden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/hidden.html">hidden</a>;
<a name="l559"><span class="linenum"> 559</span></a>              } else {
<a name="l560"><span class="linenum"> 560</span></a>                  return <a class="var it30678" onMouseOver="hilite(30678)" onMouseOut="lolite()" onClick="logVariable('item_hidden')" href="../../_variables/item_hidden.html">$item_hidden</a>;
<a name="l561"><span class="linenum"> 561</span></a>              }
<a name="l562"><span class="linenum"> 562</span></a>          }
<a name="l563"><span class="linenum"> 563</span></a>      }
<a name="l564"><span class="linenum"> 564</span></a>  
<a name="l565"><span class="linenum"> 565</span></a>      <span class="comment">/**</span>
<a name="l566"><span class="linenum"> 566</span></a>  <span class="comment">     * Set the hidden status of grade, 0 mean visible, 1 always hidden, number means date to hide until.</span>
<a name="l567"><span class="linenum"> 567</span></a>  <span class="comment">     *</span>
<a name="l568"><span class="linenum"> 568</span></a>  <span class="comment">     * @param int $hidden new hidden status</span>
<a name="l569"><span class="linenum"> 569</span></a>  <span class="comment">     * @param bool $cascade ignored</span>
<a name="l570"><span class="linenum"> 570</span></a>  <span class="comment">     */</span>
<a name="l571"><span class="linenum"> 571</span></a>      public function <a class="function" onClick="logFunction('set_hidden')" href="../../_functions/set_hidden.html" onMouseOver="funcPopup(event,'set_hidden')">set_hidden</a>(<a class="var it1532" onMouseOver="hilite(1532)" onMouseOut="lolite()" onClick="logVariable('hidden')" href="../../_variables/hidden.html">$hidden</a>, <a class="var it3056" onMouseOver="hilite(3056)" onMouseOut="lolite()" onClick="logVariable('cascade')" href="../../_variables/cascade.html">$cascade</a>=false) {
<a name="l572"><span class="linenum"> 572</span></a>         <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hidden')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/hidden.html">hidden</a> = <a class="var it1532" onMouseOver="hilite(1532)" onMouseOut="lolite()" onClick="logVariable('hidden')" href="../../_variables/hidden.html">$hidden</a>;
<a name="l573"><span class="linenum"> 573</span></a>         <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>();
<a name="l574"><span class="linenum"> 574</span></a>      }
<a name="l575"><span class="linenum"> 575</span></a>  
<a name="l576"><span class="linenum"> 576</span></a>      <span class="comment">/**</span>
<a name="l577"><span class="linenum"> 577</span></a>  <span class="comment">     * Finds and returns a grade_grade instance based on params.</span>
<a name="l578"><span class="linenum"> 578</span></a>  <span class="comment">     *</span>
<a name="l579"><span class="linenum"> 579</span></a>  <span class="comment">     * @param array $params associative arrays varname=&gt;value</span>
<a name="l580"><span class="linenum"> 580</span></a>  <span class="comment">     * @return grade_grade Returns a grade_grade instance or false if none found</span>
<a name="l581"><span class="linenum"> 581</span></a>  <span class="comment">     */</span>
<a name="l582"><span class="linenum"> 582</span></a>      public static function <a class="function" onClick="logFunction('fetch')" href="../../_functions/fetch.html" onMouseOver="funcPopup(event,'fetch')">fetch</a>(<a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) {
<a name="l583"><span class="linenum"> 583</span></a>          return grade_object::<a class="function" onClick="logFunction('fetch_helper')" href="../../_functions/fetch_helper.html" onMouseOver="funcPopup(event,'fetch_helper')">fetch_helper</a>('grade_grades', 'grade_grade', <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l584"><span class="linenum"> 584</span></a>      }
<a name="l585"><span class="linenum"> 585</span></a>  
<a name="l586"><span class="linenum"> 586</span></a>      <span class="comment">/**</span>
<a name="l587"><span class="linenum"> 587</span></a>  <span class="comment">     * Finds and returns all grade_grade instances based on params.</span>
<a name="l588"><span class="linenum"> 588</span></a>  <span class="comment">     *</span>
<a name="l589"><span class="linenum"> 589</span></a>  <span class="comment">     * @param array $params associative arrays varname=&gt;value</span>
<a name="l590"><span class="linenum"> 590</span></a>  <span class="comment">     * @return array array of grade_grade instances or false if none found.</span>
<a name="l591"><span class="linenum"> 591</span></a>  <span class="comment">     */</span>
<a name="l592"><span class="linenum"> 592</span></a>      public static function <a class="function" onClick="logFunction('fetch_all')" href="../../_functions/fetch_all.html" onMouseOver="funcPopup(event,'fetch_all')">fetch_all</a>(<a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) {
<a name="l593"><span class="linenum"> 593</span></a>          return grade_object::<a class="function" onClick="logFunction('fetch_all_helper')" href="../../_functions/fetch_all_helper.html" onMouseOver="funcPopup(event,'fetch_all_helper')">fetch_all_helper</a>('grade_grades', 'grade_grade', <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l594"><span class="linenum"> 594</span></a>      }
<a name="l595"><span class="linenum"> 595</span></a>  
<a name="l596"><span class="linenum"> 596</span></a>      <span class="comment">/**</span>
<a name="l597"><span class="linenum"> 597</span></a>  <span class="comment">     * Given a float value situated between a source minimum and a source maximum, converts it to the</span>
<a name="l598"><span class="linenum"> 598</span></a>  <span class="comment">     * corresponding value situated between a target minimum and a target maximum. Thanks to Darlene</span>
<a name="l599"><span class="linenum"> 599</span></a>  <span class="comment">     * for the formula :-)</span>
<a name="l600"><span class="linenum"> 600</span></a>  <span class="comment">     *</span>
<a name="l601"><span class="linenum"> 601</span></a>  <span class="comment">     * @param float $rawgrade</span>
<a name="l602"><span class="linenum"> 602</span></a>  <span class="comment">     * @param float $source_min</span>
<a name="l603"><span class="linenum"> 603</span></a>  <span class="comment">     * @param float $source_max</span>
<a name="l604"><span class="linenum"> 604</span></a>  <span class="comment">     * @param float $target_min</span>
<a name="l605"><span class="linenum"> 605</span></a>  <span class="comment">     * @param float $target_max</span>
<a name="l606"><span class="linenum"> 606</span></a>  <span class="comment">     * @return float Converted value</span>
<a name="l607"><span class="linenum"> 607</span></a>  <span class="comment">     */</span>
<a name="l608"><span class="linenum"> 608</span></a>      public static function <a class="function" onClick="logFunction('standardise_score')" href="../../_functions/standardise_score.html" onMouseOver="funcPopup(event,'standardise_score')">standardise_score</a>(<a class="var it4887" onMouseOver="hilite(4887)" onMouseOut="lolite()" onClick="logVariable('rawgrade')" href="../../_variables/rawgrade.html">$rawgrade</a>, <a class="var it30679" onMouseOver="hilite(30679)" onMouseOut="lolite()" onClick="logVariable('source_min')" href="../../_variables/source_min.html">$source_min</a>, <a class="var it30680" onMouseOver="hilite(30680)" onMouseOut="lolite()" onClick="logVariable('source_max')" href="../../_variables/source_max.html">$source_max</a>, <a class="var it30681" onMouseOver="hilite(30681)" onMouseOut="lolite()" onClick="logVariable('target_min')" href="../../_variables/target_min.html">$target_min</a>, <a class="var it30682" onMouseOver="hilite(30682)" onMouseOut="lolite()" onClick="logVariable('target_max')" href="../../_variables/target_max.html">$target_max</a>) {
<a name="l609"><span class="linenum"> 609</span></a>          if (<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it4887" onMouseOver="hilite(4887)" onMouseOut="lolite()" onClick="logVariable('rawgrade')" href="../../_variables/rawgrade.html">$rawgrade</a>)) {
<a name="l610"><span class="linenum"> 610</span></a>            return null;
<a name="l611"><span class="linenum"> 611</span></a>          }
<a name="l612"><span class="linenum"> 612</span></a>  
<a name="l613"><span class="linenum"> 613</span></a>          if (<a class="var it30680" onMouseOver="hilite(30680)" onMouseOut="lolite()" onClick="logVariable('source_max')" href="../../_variables/source_max.html">$source_max</a> == <a class="var it30679" onMouseOver="hilite(30679)" onMouseOut="lolite()" onClick="logVariable('source_min')" href="../../_variables/source_min.html">$source_min</a> or <a class="var it30681" onMouseOver="hilite(30681)" onMouseOut="lolite()" onClick="logVariable('target_min')" href="../../_variables/target_min.html">$target_min</a> == <a class="var it30682" onMouseOver="hilite(30682)" onMouseOut="lolite()" onClick="logVariable('target_max')" href="../../_variables/target_max.html">$target_max</a>) {
<a name="l614"><span class="linenum"> 614</span></a>  <span class="comment">            // prevent division by 0</span>
<a name="l615"><span class="linenum"> 615</span></a>              return <a class="var it30682" onMouseOver="hilite(30682)" onMouseOut="lolite()" onClick="logVariable('target_max')" href="../../_variables/target_max.html">$target_max</a>;
<a name="l616"><span class="linenum"> 616</span></a>          }
<a name="l617"><span class="linenum"> 617</span></a>  
<a name="l618"><span class="linenum"> 618</span></a>          <a class="var it8404" onMouseOver="hilite(8404)" onMouseOut="lolite()" onClick="logVariable('factor')" href="../../_variables/factor.html">$factor</a> = (<a class="var it4887" onMouseOver="hilite(4887)" onMouseOut="lolite()" onClick="logVariable('rawgrade')" href="../../_variables/rawgrade.html">$rawgrade</a> - <a class="var it30679" onMouseOver="hilite(30679)" onMouseOut="lolite()" onClick="logVariable('source_min')" href="../../_variables/source_min.html">$source_min</a>) / (<a class="var it30680" onMouseOver="hilite(30680)" onMouseOut="lolite()" onClick="logVariable('source_max')" href="../../_variables/source_max.html">$source_max</a> - <a class="var it30679" onMouseOver="hilite(30679)" onMouseOut="lolite()" onClick="logVariable('source_min')" href="../../_variables/source_min.html">$source_min</a>);
<a name="l619"><span class="linenum"> 619</span></a>          <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('diff')" href="../../_variables/diff.html">$diff</a> = <a class="var it30682" onMouseOver="hilite(30682)" onMouseOut="lolite()" onClick="logVariable('target_max')" href="../../_variables/target_max.html">$target_max</a> - <a class="var it30681" onMouseOver="hilite(30681)" onMouseOut="lolite()" onClick="logVariable('target_min')" href="../../_variables/target_min.html">$target_min</a>;
<a name="l620"><span class="linenum"> 620</span></a>          <a class="var it30683" onMouseOver="hilite(30683)" onMouseOut="lolite()" onClick="logVariable('standardised_value')" href="../../_variables/standardised_value.html">$standardised_value</a> = <a class="var it8404" onMouseOver="hilite(8404)" onMouseOut="lolite()" onClick="logVariable('factor')" href="../../_variables/factor.html">$factor</a> * <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('diff')" href="../../_variables/diff.html">$diff</a> + <a class="var it30681" onMouseOver="hilite(30681)" onMouseOut="lolite()" onClick="logVariable('target_min')" href="../../_variables/target_min.html">$target_min</a>;
<a name="l621"><span class="linenum"> 621</span></a>          return <a class="var it30683" onMouseOver="hilite(30683)" onMouseOut="lolite()" onClick="logVariable('standardised_value')" href="../../_variables/standardised_value.html">$standardised_value</a>;
<a name="l622"><span class="linenum"> 622</span></a>      }
<a name="l623"><span class="linenum"> 623</span></a>  
<a name="l624"><span class="linenum"> 624</span></a>      <span class="comment">/**</span>
<a name="l625"><span class="linenum"> 625</span></a>  <span class="comment">     * Given an array like this:</span>
<a name="l626"><span class="linenum"> 626</span></a>  <span class="comment">     * $a = array(1=&gt;array(2, 3),</span>
<a name="l627"><span class="linenum"> 627</span></a>  <span class="comment">     *            2=&gt;array(4),</span>
<a name="l628"><span class="linenum"> 628</span></a>  <span class="comment">     *            3=&gt;array(1),</span>
<a name="l629"><span class="linenum"> 629</span></a>  <span class="comment">     *            4=&gt;array())</span>
<a name="l630"><span class="linenum"> 630</span></a>  <span class="comment">     * this function fully resolves the dependencies so each value will be an array of</span>
<a name="l631"><span class="linenum"> 631</span></a>  <span class="comment">     * the all items this item depends on and their dependencies (and their dependencies...).</span>
<a name="l632"><span class="linenum"> 632</span></a>  <span class="comment">     * It should not explode if there are circular dependencies.</span>
<a name="l633"><span class="linenum"> 633</span></a>  <span class="comment">     * The dependency depth array will list the number of branches in the tree above each leaf.</span>
<a name="l634"><span class="linenum"> 634</span></a>  <span class="comment">     *</span>
<a name="l635"><span class="linenum"> 635</span></a>  <span class="comment">     * @param array $dependson Array to flatten</span>
<a name="l636"><span class="linenum"> 636</span></a>  <span class="comment">     * @param array $dependencydepth Array of itemids =&gt; depth. Initially these should be all set to 1.</span>
<a name="l637"><span class="linenum"> 637</span></a>  <span class="comment">     * @return array Flattened array</span>
<a name="l638"><span class="linenum"> 638</span></a>  <span class="comment">     */</span>
<a name="l639"><span class="linenum"> 639</span></a>      protected static function <a class="function" onClick="logFunction('flatten_dependencies_array')" href="../../_functions/flatten_dependencies_array.html" onMouseOver="funcPopup(event,'flatten_dependencies_array')">flatten_dependencies_array</a>(&amp;<a class="var it30684" onMouseOver="hilite(30684)" onMouseOut="lolite()" onClick="logVariable('dependson')" href="../../_variables/dependson.html">$dependson</a>, &amp;<a class="var it30685" onMouseOver="hilite(30685)" onMouseOut="lolite()" onClick="logVariable('dependencydepth')" href="../../_variables/dependencydepth.html">$dependencydepth</a>) {
<a name="l640"><span class="linenum"> 640</span></a>  <span class="comment">        // Flatten the nested dependencies - this will handle recursion bombs because it removes duplicates.</span>
<a name="l641"><span class="linenum"> 641</span></a>          <a class="var it30686" onMouseOver="hilite(30686)" onMouseOut="lolite()" onClick="logVariable('somethingchanged')" href="../../_variables/somethingchanged.html">$somethingchanged</a> = true;
<a name="l642"><span class="linenum"> 642</span></a>          while (<a class="var it30686" onMouseOver="hilite(30686)" onMouseOut="lolite()" onClick="logVariable('somethingchanged')" href="../../_variables/somethingchanged.html">$somethingchanged</a>) {
<a name="l643"><span class="linenum"> 643</span></a>              <a class="var it30686" onMouseOver="hilite(30686)" onMouseOut="lolite()" onClick="logVariable('somethingchanged')" href="../../_variables/somethingchanged.html">$somethingchanged</a> = false;
<a name="l644"><span class="linenum"> 644</span></a>  
<a name="l645"><span class="linenum"> 645</span></a>              foreach (<a class="var it30684" onMouseOver="hilite(30684)" onMouseOut="lolite()" onClick="logVariable('dependson')" href="../../_variables/dependson.html">$dependson</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a> =&gt; <a class="var it30687" onMouseOver="hilite(30687)" onMouseOut="lolite()" onClick="logVariable('depends')" href="../../_variables/depends.html">$depends</a>) {
<a name="l646"><span class="linenum"> 646</span></a>  <span class="comment">                // Make a copy so we can tell if it changed.</span>
<a name="l647"><span class="linenum"> 647</span></a>                  <a class="var it1662" onMouseOver="hilite(1662)" onMouseOut="lolite()" onClick="logVariable('before')" href="../../_variables/before.html">$before</a> = <a class="var it30684" onMouseOver="hilite(30684)" onMouseOut="lolite()" onClick="logVariable('dependson')" href="../../_variables/dependson.html">$dependson</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>];
<a name="l648"><span class="linenum"> 648</span></a>                  foreach (<a class="var it30687" onMouseOver="hilite(30687)" onMouseOut="lolite()" onClick="logVariable('depends')" href="../../_variables/depends.html">$depends</a> as <a class="var it30688" onMouseOver="hilite(30688)" onMouseOut="lolite()" onClick="logVariable('subitemid')" href="../../_variables/subitemid.html">$subitemid</a> =&gt; <a class="var it30689" onMouseOver="hilite(30689)" onMouseOut="lolite()" onClick="logVariable('subdepends')" href="../../_variables/subdepends.html">$subdepends</a>) {
<a name="l649"><span class="linenum"> 649</span></a>                      <a class="var it30684" onMouseOver="hilite(30684)" onMouseOut="lolite()" onClick="logVariable('dependson')" href="../../_variables/dependson.html">$dependson</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = <a class="phpfunction" onClick="logFunction('array_unique')" href="../../_functions/array_unique.html" onMouseOver="phpfuncPopup(event,'array_unique')">array_unique</a>(<a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it30687" onMouseOver="hilite(30687)" onMouseOut="lolite()" onClick="logVariable('depends')" href="../../_variables/depends.html">$depends</a>, <a class="var it30684" onMouseOver="hilite(30684)" onMouseOut="lolite()" onClick="logVariable('dependson')" href="../../_variables/dependson.html">$dependson</a>[<a class="var it30689" onMouseOver="hilite(30689)" onMouseOut="lolite()" onClick="logVariable('subdepends')" href="../../_variables/subdepends.html">$subdepends</a>]));
<a name="l650"><span class="linenum"> 650</span></a>                      <a class="phpfunction" onClick="logFunction('sort')" href="../../_functions/sort.html" onMouseOver="phpfuncPopup(event,'sort')">sort</a>(<a class="var it30684" onMouseOver="hilite(30684)" onMouseOut="lolite()" onClick="logVariable('dependson')" href="../../_variables/dependson.html">$dependson</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>], SORT_NUMERIC);
<a name="l651"><span class="linenum"> 651</span></a>                  }
<a name="l652"><span class="linenum"> 652</span></a>                  if (<a class="var it1662" onMouseOver="hilite(1662)" onMouseOut="lolite()" onClick="logVariable('before')" href="../../_variables/before.html">$before</a> != <a class="var it30684" onMouseOver="hilite(30684)" onMouseOut="lolite()" onClick="logVariable('dependson')" href="../../_variables/dependson.html">$dependson</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]) {
<a name="l653"><span class="linenum"> 653</span></a>                      <a class="var it30686" onMouseOver="hilite(30686)" onMouseOut="lolite()" onClick="logVariable('somethingchanged')" href="../../_variables/somethingchanged.html">$somethingchanged</a> = true;
<a name="l654"><span class="linenum"> 654</span></a>                      if (!isset(<a class="var it30685" onMouseOver="hilite(30685)" onMouseOut="lolite()" onClick="logVariable('dependencydepth')" href="../../_variables/dependencydepth.html">$dependencydepth</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>])) {
<a name="l655"><span class="linenum"> 655</span></a>                          <a class="var it30685" onMouseOver="hilite(30685)" onMouseOut="lolite()" onClick="logVariable('dependencydepth')" href="../../_variables/dependencydepth.html">$dependencydepth</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 1;
<a name="l656"><span class="linenum"> 656</span></a>                      } else {
<a name="l657"><span class="linenum"> 657</span></a>                          <a class="var it30685" onMouseOver="hilite(30685)" onMouseOut="lolite()" onClick="logVariable('dependencydepth')" href="../../_variables/dependencydepth.html">$dependencydepth</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]++;
<a name="l658"><span class="linenum"> 658</span></a>                      }
<a name="l659"><span class="linenum"> 659</span></a>                  }
<a name="l660"><span class="linenum"> 660</span></a>              }
<a name="l661"><span class="linenum"> 661</span></a>          }
<a name="l662"><span class="linenum"> 662</span></a>      }
<a name="l663"><span class="linenum"> 663</span></a>  
<a name="l664"><span class="linenum"> 664</span></a>      <span class="comment">/**</span>
<a name="l665"><span class="linenum"> 665</span></a>  <span class="comment">     * Return array of grade item ids that are either hidden or indirectly depend</span>
<a name="l666"><span class="linenum"> 666</span></a>  <span class="comment">     * on hidden grades, excluded grades are not returned.</span>
<a name="l667"><span class="linenum"> 667</span></a>  <span class="comment">     * THIS IS A REALLY BIG HACK! to be replaced by conditional aggregation of hidden grades in 2.0</span>
<a name="l668"><span class="linenum"> 668</span></a>  <span class="comment">     *</span>
<a name="l669"><span class="linenum"> 669</span></a>  <span class="comment">     * @param array $grade_grades all course grades of one user, &amp; used for better internal caching</span>
<a name="l670"><span class="linenum"> 670</span></a>  <span class="comment">     * @param array $grade_items array of grade items, &amp; used for better internal caching</span>
<a name="l671"><span class="linenum"> 671</span></a>  <span class="comment">     * @return array This is an array of 3 arrays:</span>
<a name="l672"><span class="linenum"> 672</span></a>  <span class="comment">     *      unknown =&gt; list of item ids that may be affected by hiding (with the calculated grade as the value)</span>
<a name="l673"><span class="linenum"> 673</span></a>  <span class="comment">     *      altered =&gt; list of item ids that are definitely affected by hiding (with the calculated grade as the value)</span>
<a name="l674"><span class="linenum"> 674</span></a>  <span class="comment">     *      alteredgrademax =&gt; for each item in altered or unknown, the new value of the grademax</span>
<a name="l675"><span class="linenum"> 675</span></a>  <span class="comment">     *      alteredgrademin =&gt; for each item in altered or unknown, the new value of the grademin</span>
<a name="l676"><span class="linenum"> 676</span></a>  <span class="comment">     *      alteredgradestatus =&gt; for each item with a modified status - the value of the new status</span>
<a name="l677"><span class="linenum"> 677</span></a>  <span class="comment">     *      alteredgradeweight =&gt; for each item with a modified weight - the value of the new weight</span>
<a name="l678"><span class="linenum"> 678</span></a>  <span class="comment">     */</span>
<a name="l679"><span class="linenum"> 679</span></a>      public static function <a class="function" onClick="logFunction('get_hiding_affected')" href="../../_functions/get_hiding_affected.html" onMouseOver="funcPopup(event,'get_hiding_affected')">get_hiding_affected</a>(&amp;<a class="var it6047" onMouseOver="hilite(6047)" onMouseOut="lolite()" onClick="logVariable('grade_grades')" href="../../_variables/grade_grades.html">$grade_grades</a>, &amp;<a class="var it6045" onMouseOver="hilite(6045)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../_variables/grade_items.html">$grade_items</a>) {
<a name="l680"><span class="linenum"> 680</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l681"><span class="linenum"> 681</span></a>  
<a name="l682"><span class="linenum"> 682</span></a>          if (<a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it6047" onMouseOver="hilite(6047)" onMouseOut="lolite()" onClick="logVariable('grade_grades')" href="../../_variables/grade_grades.html">$grade_grades</a>) !== <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it6045" onMouseOver="hilite(6045)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../_variables/grade_items.html">$grade_items</a>)) {
<a name="l683"><span class="linenum"> 683</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('invalidarraysize', 'debug', '', '<a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>::<a class="function" onClick="logFunction('get_hiding_affected')" href="../../_functions/get_hiding_affected.html" onMouseOver="funcPopup(event,'get_hiding_affected')">get_hiding_affected</a>()!');
<a name="l684"><span class="linenum"> 684</span></a>          }
<a name="l685"><span class="linenum"> 685</span></a>  
<a name="l686"><span class="linenum"> 686</span></a>          <a class="var it30684" onMouseOver="hilite(30684)" onMouseOut="lolite()" onClick="logVariable('dependson')" href="../../_variables/dependson.html">$dependson</a> = array();
<a name="l687"><span class="linenum"> 687</span></a>          <a class="var it728" onMouseOver="hilite(728)" onMouseOut="lolite()" onClick="logVariable('todo')" href="../../_variables/todo.html">$todo</a> = array();
<a name="l688"><span class="linenum"> 688</span></a>          <a class="var it26679" onMouseOver="hilite(26679)" onMouseOut="lolite()" onClick="logVariable('unknown')" href="../../_variables/unknown.html">$unknown</a> = array();  <span class="comment">// can not find altered</span>
<a name="l689"><span class="linenum"> 689</span></a>          <a class="var it23827" onMouseOver="hilite(23827)" onMouseOut="lolite()" onClick="logVariable('altered')" href="../../_variables/altered.html">$altered</a> = array();  <span class="comment">// altered grades</span>
<a name="l690"><span class="linenum"> 690</span></a>          <a class="var it30690" onMouseOver="hilite(30690)" onMouseOut="lolite()" onClick="logVariable('alteredgrademax')" href="../../_variables/alteredgrademax.html">$alteredgrademax</a> = array();  <span class="comment">// Altered grade max values.</span>
<a name="l691"><span class="linenum"> 691</span></a>          <a class="var it30691" onMouseOver="hilite(30691)" onMouseOut="lolite()" onClick="logVariable('alteredgrademin')" href="../../_variables/alteredgrademin.html">$alteredgrademin</a> = array();  <span class="comment">// Altered grade min values.</span>
<a name="l692"><span class="linenum"> 692</span></a>          <a class="var it30692" onMouseOver="hilite(30692)" onMouseOut="lolite()" onClick="logVariable('alteredaggregationstatus')" href="../../_variables/alteredaggregationstatus.html">$alteredaggregationstatus</a> = array();  <span class="comment">// Altered aggregation status.</span>
<a name="l693"><span class="linenum"> 693</span></a>          <a class="var it30693" onMouseOver="hilite(30693)" onMouseOut="lolite()" onClick="logVariable('alteredaggregationweight')" href="../../_variables/alteredaggregationweight.html">$alteredaggregationweight</a> = array();  <span class="comment">// Altered aggregation weight.</span>
<a name="l694"><span class="linenum"> 694</span></a>          <a class="var it30685" onMouseOver="hilite(30685)" onMouseOut="lolite()" onClick="logVariable('dependencydepth')" href="../../_variables/dependencydepth.html">$dependencydepth</a> = array();
<a name="l695"><span class="linenum"> 695</span></a>  
<a name="l696"><span class="linenum"> 696</span></a>          <a class="var it30694" onMouseOver="hilite(30694)" onMouseOut="lolite()" onClick="logVariable('hiddenfound')" href="../../_variables/hiddenfound.html">$hiddenfound</a> = false;
<a name="l697"><span class="linenum"> 697</span></a>          foreach(<a class="var it6047" onMouseOver="hilite(6047)" onMouseOut="lolite()" onClick="logVariable('grade_grades')" href="../../_variables/grade_grades.html">$grade_grades</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>=&gt;<a class="var it1136" onMouseOver="hilite(1136)" onMouseOut="lolite()" onClick="logVariable('unused')" href="../../_variables/unused.html">$unused</a>) {
<a name="l698"><span class="linenum"> 698</span></a>              <a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../_variables/grade_grade.html">$grade_grade</a> =&amp; <a class="var it6047" onMouseOver="hilite(6047)" onMouseOut="lolite()" onClick="logVariable('grade_grades')" href="../../_variables/grade_grades.html">$grade_grades</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>];
<a name="l699"><span class="linenum"> 699</span></a>  <span class="comment">            // We need the immediate dependencies of all every grade_item so we can calculate nested dependencies.</span>
<a name="l700"><span class="linenum"> 700</span></a>              <a class="var it30684" onMouseOver="hilite(30684)" onMouseOut="lolite()" onClick="logVariable('dependson')" href="../../_variables/dependson.html">$dependson</a>[<a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../_variables/grade_grade.html">$grade_grade</a>-&gt;<a onClick="logVariable('itemid')" class="var it39508" onMouseOver="hilite(39508)" onMouseOut="lolite()" href="../../_variables/itemid.html">itemid</a>] = <a class="var it6045" onMouseOver="hilite(6045)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../_variables/grade_items.html">$grade_items</a>[<a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../_variables/grade_grade.html">$grade_grade</a>-&gt;<a onClick="logVariable('itemid')" class="var it39508" onMouseOver="hilite(39508)" onMouseOut="lolite()" href="../../_variables/itemid.html">itemid</a>]-&gt;<a class="function" onClick="logFunction('depends_on')" href="../../_functions/depends_on.html" onMouseOver="funcPopup(event,'depends_on')">depends_on</a>();
<a name="l701"><span class="linenum"> 701</span></a>              if (<a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../_variables/grade_grade.html">$grade_grade</a>-&gt;<a class="function" onClick="logFunction('is_excluded')" href="../../_functions/is_excluded.html" onMouseOver="funcPopup(event,'is_excluded')">is_excluded</a>()) {
<a name="l702"><span class="linenum"> 702</span></a>  <span class="comment">                //nothing to do, aggregation is ok</span>
<a name="l703"><span class="linenum"> 703</span></a>              } else if (<a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../_variables/grade_grade.html">$grade_grade</a>-&gt;<a class="function" onClick="logFunction('is_hidden')" href="../../_functions/is_hidden.html" onMouseOver="funcPopup(event,'is_hidden')">is_hidden</a>()) {
<a name="l704"><span class="linenum"> 704</span></a>                  <a class="var it30694" onMouseOver="hilite(30694)" onMouseOut="lolite()" onClick="logVariable('hiddenfound')" href="../../_variables/hiddenfound.html">$hiddenfound</a> = true;
<a name="l705"><span class="linenum"> 705</span></a>                  <a class="var it23827" onMouseOver="hilite(23827)" onMouseOut="lolite()" onClick="logVariable('altered')" href="../../_variables/altered.html">$altered</a>[<a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../_variables/grade_grade.html">$grade_grade</a>-&gt;<a onClick="logVariable('itemid')" class="var it39508" onMouseOver="hilite(39508)" onMouseOut="lolite()" href="../../_variables/itemid.html">itemid</a>] = null;
<a name="l706"><span class="linenum"> 706</span></a>                  <a class="var it30692" onMouseOver="hilite(30692)" onMouseOut="lolite()" onClick="logVariable('alteredaggregationstatus')" href="../../_variables/alteredaggregationstatus.html">$alteredaggregationstatus</a>[<a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../_variables/grade_grade.html">$grade_grade</a>-&gt;<a onClick="logVariable('itemid')" class="var it39508" onMouseOver="hilite(39508)" onMouseOut="lolite()" href="../../_variables/itemid.html">itemid</a>] = 'dropped';
<a name="l707"><span class="linenum"> 707</span></a>                  <a class="var it30693" onMouseOver="hilite(30693)" onMouseOut="lolite()" onClick="logVariable('alteredaggregationweight')" href="../../_variables/alteredaggregationweight.html">$alteredaggregationweight</a>[<a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../_variables/grade_grade.html">$grade_grade</a>-&gt;<a onClick="logVariable('itemid')" class="var it39508" onMouseOver="hilite(39508)" onMouseOut="lolite()" href="../../_variables/itemid.html">itemid</a>] = 0;
<a name="l708"><span class="linenum"> 708</span></a>              } else if (<a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../_variables/grade_grade.html">$grade_grade</a>-&gt;<a class="function" onClick="logFunction('is_locked')" href="../../_functions/is_locked.html" onMouseOver="funcPopup(event,'is_locked')">is_locked</a>() or <a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../_variables/grade_grade.html">$grade_grade</a>-&gt;<a class="function" onClick="logFunction('is_overridden')" href="../../_functions/is_overridden.html" onMouseOver="funcPopup(event,'is_overridden')">is_overridden</a>()) {
<a name="l709"><span class="linenum"> 709</span></a>  <span class="comment">                // no need to recalculate locked or overridden grades</span>
<a name="l710"><span class="linenum"> 710</span></a>              } else {
<a name="l711"><span class="linenum"> 711</span></a>                  if (!empty(<a class="var it30684" onMouseOver="hilite(30684)" onMouseOut="lolite()" onClick="logVariable('dependson')" href="../../_variables/dependson.html">$dependson</a>[<a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../_variables/grade_grade.html">$grade_grade</a>-&gt;<a onClick="logVariable('itemid')" class="var it39508" onMouseOver="hilite(39508)" onMouseOut="lolite()" href="../../_variables/itemid.html">itemid</a>])) {
<a name="l712"><span class="linenum"> 712</span></a>                      <a class="var it30685" onMouseOver="hilite(30685)" onMouseOut="lolite()" onClick="logVariable('dependencydepth')" href="../../_variables/dependencydepth.html">$dependencydepth</a>[<a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../_variables/grade_grade.html">$grade_grade</a>-&gt;<a onClick="logVariable('itemid')" class="var it39508" onMouseOver="hilite(39508)" onMouseOut="lolite()" href="../../_variables/itemid.html">itemid</a>] = 1;
<a name="l713"><span class="linenum"> 713</span></a>                      <a class="var it728" onMouseOver="hilite(728)" onMouseOut="lolite()" onClick="logVariable('todo')" href="../../_variables/todo.html">$todo</a>[] = <a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../_variables/grade_grade.html">$grade_grade</a>-&gt;<a onClick="logVariable('itemid')" class="var it39508" onMouseOver="hilite(39508)" onMouseOut="lolite()" href="../../_variables/itemid.html">itemid</a>;
<a name="l714"><span class="linenum"> 714</span></a>                  }
<a name="l715"><span class="linenum"> 715</span></a>              }
<a name="l716"><span class="linenum"> 716</span></a>          }
<a name="l717"><span class="linenum"> 717</span></a>  
<a name="l718"><span class="linenum"> 718</span></a>  <span class="comment">        // Flatten the dependency tree and count number of branches to each leaf.</span>
<a name="l719"><span class="linenum"> 719</span></a>          self::<a class="function" onClick="logFunction('flatten_dependencies_array')" href="../../_functions/flatten_dependencies_array.html" onMouseOver="funcPopup(event,'flatten_dependencies_array')">flatten_dependencies_array</a>(<a class="var it30684" onMouseOver="hilite(30684)" onMouseOut="lolite()" onClick="logVariable('dependson')" href="../../_variables/dependson.html">$dependson</a>, <a class="var it30685" onMouseOver="hilite(30685)" onMouseOut="lolite()" onClick="logVariable('dependencydepth')" href="../../_variables/dependencydepth.html">$dependencydepth</a>);
<a name="l720"><span class="linenum"> 720</span></a>  
<a name="l721"><span class="linenum"> 721</span></a>          if (!<a class="var it30694" onMouseOver="hilite(30694)" onMouseOut="lolite()" onClick="logVariable('hiddenfound')" href="../../_variables/hiddenfound.html">$hiddenfound</a>) {
<a name="l722"><span class="linenum"> 722</span></a>              return array('unknown' =&gt; array(),
<a name="l723"><span class="linenum"> 723</span></a>                           'altered' =&gt; array(),
<a name="l724"><span class="linenum"> 724</span></a>                           'alteredgrademax' =&gt; array(),
<a name="l725"><span class="linenum"> 725</span></a>                           'alteredgrademin' =&gt; array(),
<a name="l726"><span class="linenum"> 726</span></a>                           'alteredaggregationstatus' =&gt; array(),
<a name="l727"><span class="linenum"> 727</span></a>                           'alteredaggregationweight' =&gt; array());
<a name="l728"><span class="linenum"> 728</span></a>          }
<a name="l729"><span class="linenum"> 729</span></a>  <span class="comment">        // This line ensures that $dependencydepth has the same number of items as $todo.</span>
<a name="l730"><span class="linenum"> 730</span></a>          <a class="var it30685" onMouseOver="hilite(30685)" onMouseOut="lolite()" onClick="logVariable('dependencydepth')" href="../../_variables/dependencydepth.html">$dependencydepth</a> = array_intersect_key(<a class="var it30685" onMouseOver="hilite(30685)" onMouseOut="lolite()" onClick="logVariable('dependencydepth')" href="../../_variables/dependencydepth.html">$dependencydepth</a>, <a class="phpfunction" onClick="logFunction('array_flip')" href="../../_functions/array_flip.html" onMouseOver="phpfuncPopup(event,'array_flip')">array_flip</a>(<a class="var it728" onMouseOver="hilite(728)" onMouseOut="lolite()" onClick="logVariable('todo')" href="../../_variables/todo.html">$todo</a>));
<a name="l731"><span class="linenum"> 731</span></a>  <span class="comment">        // We need to resort the todo list by the dependency depth. This guarantees we process the leaves, then the branches.</span>
<a name="l732"><span class="linenum"> 732</span></a>          <a class="phpfunction" onClick="logFunction('array_multisort')" href="../../_functions/array_multisort.html" onMouseOver="phpfuncPopup(event,'array_multisort')">array_multisort</a>(<a class="var it30685" onMouseOver="hilite(30685)" onMouseOut="lolite()" onClick="logVariable('dependencydepth')" href="../../_variables/dependencydepth.html">$dependencydepth</a>, <a class="var it728" onMouseOver="hilite(728)" onMouseOut="lolite()" onClick="logVariable('todo')" href="../../_variables/todo.html">$todo</a>);
<a name="l733"><span class="linenum"> 733</span></a>  
<a name="l734"><span class="linenum"> 734</span></a>          <a class="var it588" onMouseOver="hilite(588)" onMouseOut="lolite()" onClick="logVariable('max')" href="../../_variables/max.html">$max</a> = <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it728" onMouseOver="hilite(728)" onMouseOut="lolite()" onClick="logVariable('todo')" href="../../_variables/todo.html">$todo</a>);
<a name="l735"><span class="linenum"> 735</span></a>          <a class="var it30695" onMouseOver="hilite(30695)" onMouseOut="lolite()" onClick="logVariable('hidden_precursors')" href="../../_variables/hidden_precursors.html">$hidden_precursors</a> = null;
<a name="l736"><span class="linenum"> 736</span></a>          for(<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>=0; <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>&lt;<a class="var it588" onMouseOver="hilite(588)" onMouseOut="lolite()" onClick="logVariable('max')" href="../../_variables/max.html">$max</a>; <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>++) {
<a name="l737"><span class="linenum"> 737</span></a>              <a class="var it1608" onMouseOver="hilite(1608)" onMouseOut="lolite()" onClick="logVariable('found')" href="../../_variables/found.html">$found</a> = false;
<a name="l738"><span class="linenum"> 738</span></a>              foreach(<a class="var it728" onMouseOver="hilite(728)" onMouseOut="lolite()" onClick="logVariable('todo')" href="../../_variables/todo.html">$todo</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>=&gt;<a class="var it9885" onMouseOver="hilite(9885)" onMouseOut="lolite()" onClick="logVariable('do')" href="../../_variables/do.html">$do</a>) {
<a name="l739"><span class="linenum"> 739</span></a>                  <a class="var it30695" onMouseOver="hilite(30695)" onMouseOut="lolite()" onClick="logVariable('hidden_precursors')" href="../../_variables/hidden_precursors.html">$hidden_precursors</a> = <a class="phpfunction" onClick="logFunction('array_intersect')" href="../../_functions/array_intersect.html" onMouseOver="phpfuncPopup(event,'array_intersect')">array_intersect</a>(<a class="var it30684" onMouseOver="hilite(30684)" onMouseOut="lolite()" onClick="logVariable('dependson')" href="../../_variables/dependson.html">$dependson</a>[<a class="var it9885" onMouseOver="hilite(9885)" onMouseOut="lolite()" onClick="logVariable('do')" href="../../_variables/do.html">$do</a>], <a class="var it26679" onMouseOver="hilite(26679)" onMouseOut="lolite()" onClick="logVariable('unknown')" href="../../_variables/unknown.html">$unknown</a>);
<a name="l740"><span class="linenum"> 740</span></a>                  if (<a class="var it30695" onMouseOver="hilite(30695)" onMouseOut="lolite()" onClick="logVariable('hidden_precursors')" href="../../_variables/hidden_precursors.html">$hidden_precursors</a>) {
<a name="l741"><span class="linenum"> 741</span></a>  <span class="comment">                    // this item depends on hidden grade indirectly</span>
<a name="l742"><span class="linenum"> 742</span></a>                      <a class="var it26679" onMouseOver="hilite(26679)" onMouseOut="lolite()" onClick="logVariable('unknown')" href="../../_variables/unknown.html">$unknown</a>[<a class="var it9885" onMouseOver="hilite(9885)" onMouseOut="lolite()" onClick="logVariable('do')" href="../../_variables/do.html">$do</a>] = <a class="var it9885" onMouseOver="hilite(9885)" onMouseOut="lolite()" onClick="logVariable('do')" href="../../_variables/do.html">$do</a>;
<a name="l743"><span class="linenum"> 743</span></a>                      unset(<a class="var it728" onMouseOver="hilite(728)" onMouseOut="lolite()" onClick="logVariable('todo')" href="../../_variables/todo.html">$todo</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>]);
<a name="l744"><span class="linenum"> 744</span></a>                      <a class="var it1608" onMouseOver="hilite(1608)" onMouseOut="lolite()" onClick="logVariable('found')" href="../../_variables/found.html">$found</a> = true;
<a name="l745"><span class="linenum"> 745</span></a>                      continue;
<a name="l746"><span class="linenum"> 746</span></a>  
<a name="l747"><span class="linenum"> 747</span></a>                  } else if (!<a class="phpfunction" onClick="logFunction('array_intersect')" href="../../_functions/array_intersect.html" onMouseOver="phpfuncPopup(event,'array_intersect')">array_intersect</a>(<a class="var it30684" onMouseOver="hilite(30684)" onMouseOut="lolite()" onClick="logVariable('dependson')" href="../../_variables/dependson.html">$dependson</a>[<a class="var it9885" onMouseOver="hilite(9885)" onMouseOut="lolite()" onClick="logVariable('do')" href="../../_variables/do.html">$do</a>], <a class="var it728" onMouseOver="hilite(728)" onMouseOut="lolite()" onClick="logVariable('todo')" href="../../_variables/todo.html">$todo</a>)) {
<a name="l748"><span class="linenum"> 748</span></a>                      <a class="var it30695" onMouseOver="hilite(30695)" onMouseOut="lolite()" onClick="logVariable('hidden_precursors')" href="../../_variables/hidden_precursors.html">$hidden_precursors</a> = <a class="phpfunction" onClick="logFunction('array_intersect')" href="../../_functions/array_intersect.html" onMouseOver="phpfuncPopup(event,'array_intersect')">array_intersect</a>(<a class="var it30684" onMouseOver="hilite(30684)" onMouseOut="lolite()" onClick="logVariable('dependson')" href="../../_variables/dependson.html">$dependson</a>[<a class="var it9885" onMouseOver="hilite(9885)" onMouseOut="lolite()" onClick="logVariable('do')" href="../../_variables/do.html">$do</a>], <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it23827" onMouseOver="hilite(23827)" onMouseOut="lolite()" onClick="logVariable('altered')" href="../../_variables/altered.html">$altered</a>));
<a name="l749"><span class="linenum"> 749</span></a>                      if (!<a class="var it30695" onMouseOver="hilite(30695)" onMouseOut="lolite()" onClick="logVariable('hidden_precursors')" href="../../_variables/hidden_precursors.html">$hidden_precursors</a>) {
<a name="l750"><span class="linenum"> 750</span></a>  <span class="comment">                        // hiding does not affect this grade</span>
<a name="l751"><span class="linenum"> 751</span></a>                          unset(<a class="var it728" onMouseOver="hilite(728)" onMouseOut="lolite()" onClick="logVariable('todo')" href="../../_variables/todo.html">$todo</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>]);
<a name="l752"><span class="linenum"> 752</span></a>                          <a class="var it1608" onMouseOver="hilite(1608)" onMouseOut="lolite()" onClick="logVariable('found')" href="../../_variables/found.html">$found</a> = true;
<a name="l753"><span class="linenum"> 753</span></a>                          continue;
<a name="l754"><span class="linenum"> 754</span></a>  
<a name="l755"><span class="linenum"> 755</span></a>                      } else {
<a name="l756"><span class="linenum"> 756</span></a>  <span class="comment">                        // depends on altered grades - we should try to recalculate if possible</span>
<a name="l757"><span class="linenum"> 757</span></a>                          if (<a class="var it6045" onMouseOver="hilite(6045)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../_variables/grade_items.html">$grade_items</a>[<a class="var it9885" onMouseOver="hilite(9885)" onMouseOut="lolite()" onClick="logVariable('do')" href="../../_variables/do.html">$do</a>]-&gt;<a class="function" onClick="logFunction('is_calculated')" href="../../_functions/is_calculated.html" onMouseOver="funcPopup(event,'is_calculated')">is_calculated</a>() or
<a name="l758"><span class="linenum"> 758</span></a>                              (!<a class="var it6045" onMouseOver="hilite(6045)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../_variables/grade_items.html">$grade_items</a>[<a class="var it9885" onMouseOver="hilite(9885)" onMouseOut="lolite()" onClick="logVariable('do')" href="../../_variables/do.html">$do</a>]-&gt;<a class="function" onClick="logFunction('is_category_item')" href="../../_functions/is_category_item.html" onMouseOver="funcPopup(event,'is_category_item')">is_category_item</a>() and !<a class="var it6045" onMouseOver="hilite(6045)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../_variables/grade_items.html">$grade_items</a>[<a class="var it9885" onMouseOver="hilite(9885)" onMouseOut="lolite()" onClick="logVariable('do')" href="../../_variables/do.html">$do</a>]-&gt;<a class="function" onClick="logFunction('is_course_item')" href="../../_functions/is_course_item.html" onMouseOver="funcPopup(event,'is_course_item')">is_course_item</a>())
<a name="l759"><span class="linenum"> 759</span></a>                          ) {
<a name="l760"><span class="linenum"> 760</span></a>  <span class="comment">                            // This is a grade item that is not a category or course and has been affected by grade hiding.</span>
<a name="l761"><span class="linenum"> 761</span></a>  <span class="comment">                            // I guess this means it is a calculation that needs to be recalculated.</span>
<a name="l762"><span class="linenum"> 762</span></a>                              <a class="var it26679" onMouseOver="hilite(26679)" onMouseOut="lolite()" onClick="logVariable('unknown')" href="../../_variables/unknown.html">$unknown</a>[<a class="var it9885" onMouseOver="hilite(9885)" onMouseOut="lolite()" onClick="logVariable('do')" href="../../_variables/do.html">$do</a>] = <a class="var it9885" onMouseOver="hilite(9885)" onMouseOut="lolite()" onClick="logVariable('do')" href="../../_variables/do.html">$do</a>;
<a name="l763"><span class="linenum"> 763</span></a>                              unset(<a class="var it728" onMouseOver="hilite(728)" onMouseOut="lolite()" onClick="logVariable('todo')" href="../../_variables/todo.html">$todo</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>]);
<a name="l764"><span class="linenum"> 764</span></a>                              <a class="var it1608" onMouseOver="hilite(1608)" onMouseOut="lolite()" onClick="logVariable('found')" href="../../_variables/found.html">$found</a> = true;
<a name="l765"><span class="linenum"> 765</span></a>                              continue;
<a name="l766"><span class="linenum"> 766</span></a>  
<a name="l767"><span class="linenum"> 767</span></a>                          } else {
<a name="l768"><span class="linenum"> 768</span></a>  <span class="comment">                            // This is a grade category (or course).</span>
<a name="l769"><span class="linenum"> 769</span></a>                              <a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a> = <a class="var it6045" onMouseOver="hilite(6045)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../_variables/grade_items.html">$grade_items</a>[<a class="var it9885" onMouseOver="hilite(9885)" onMouseOut="lolite()" onClick="logVariable('do')" href="../../_variables/do.html">$do</a>]-&gt;<a class="function" onClick="logFunction('load_item_category')" href="../../_functions/load_item_category.html" onMouseOver="funcPopup(event,'load_item_category')">load_item_category</a>();
<a name="l770"><span class="linenum"> 770</span></a>  
<a name="l771"><span class="linenum"> 771</span></a>  <span class="comment">                            // Build a new list of the grades in this category.</span>
<a name="l772"><span class="linenum"> 772</span></a>                              <a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a> = array();
<a name="l773"><span class="linenum"> 773</span></a>                              <a class="var it30696" onMouseOver="hilite(30696)" onMouseOut="lolite()" onClick="logVariable('immediatedepends')" href="../../_variables/immediatedepends.html">$immediatedepends</a> = <a class="var it6045" onMouseOver="hilite(6045)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../_variables/grade_items.html">$grade_items</a>[<a class="var it9885" onMouseOver="hilite(9885)" onMouseOut="lolite()" onClick="logVariable('do')" href="../../_variables/do.html">$do</a>]-&gt;<a class="function" onClick="logFunction('depends_on')" href="../../_functions/depends_on.html" onMouseOver="funcPopup(event,'depends_on')">depends_on</a>();
<a name="l774"><span class="linenum"> 774</span></a>                              foreach (<a class="var it30696" onMouseOver="hilite(30696)" onMouseOut="lolite()" onClick="logVariable('immediatedepends')" href="../../_variables/immediatedepends.html">$immediatedepends</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>) {
<a name="l775"><span class="linenum"> 775</span></a>                                  if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>, <a class="var it23827" onMouseOver="hilite(23827)" onMouseOut="lolite()" onClick="logVariable('altered')" href="../../_variables/altered.html">$altered</a>)) {
<a name="l776"><span class="linenum"> 776</span></a>  <span class="comment">                                    //nulling an altered precursor</span>
<a name="l777"><span class="linenum"> 777</span></a>                                      <a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = <a class="var it23827" onMouseOver="hilite(23827)" onMouseOut="lolite()" onClick="logVariable('altered')" href="../../_variables/altered.html">$altered</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>];
<a name="l778"><span class="linenum"> 778</span></a>                                      if (<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>])) {
<a name="l779"><span class="linenum"> 779</span></a>  <span class="comment">                                        // This means this was a hidden grade item removed from the result.</span>
<a name="l780"><span class="linenum"> 780</span></a>                                          unset(<a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]);
<a name="l781"><span class="linenum"> 781</span></a>                                      }
<a name="l782"><span class="linenum"> 782</span></a>                                  } elseif (empty(<a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>])) {
<a name="l783"><span class="linenum"> 783</span></a>                                      <a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = <a class="var it6047" onMouseOver="hilite(6047)" onMouseOut="lolite()" onClick="logVariable('grade_grades')" href="../../_variables/grade_grades.html">$grade_grades</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;finalgrade;
<a name="l784"><span class="linenum"> 784</span></a>                                  }
<a name="l785"><span class="linenum"> 785</span></a>                              }
<a name="l786"><span class="linenum"> 786</span></a>  
<a name="l787"><span class="linenum"> 787</span></a>                              foreach (<a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>=&gt;<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l788"><span class="linenum"> 788</span></a>                                  if (<a class="var it6047" onMouseOver="hilite(6047)" onMouseOut="lolite()" onClick="logVariable('grade_grades')" href="../../_variables/grade_grades.html">$grade_grades</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;<a class="function" onClick="logFunction('is_excluded')" href="../../_functions/is_excluded.html" onMouseOver="funcPopup(event,'is_excluded')">is_excluded</a>()) {
<a name="l789"><span class="linenum"> 789</span></a>                                      unset(<a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]);
<a name="l790"><span class="linenum"> 790</span></a>                                      <a class="var it30692" onMouseOver="hilite(30692)" onMouseOut="lolite()" onClick="logVariable('alteredaggregationstatus')" href="../../_variables/alteredaggregationstatus.html">$alteredaggregationstatus</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 'excluded';
<a name="l791"><span class="linenum"> 791</span></a>                                      <a class="var it30693" onMouseOver="hilite(30693)" onMouseOut="lolite()" onClick="logVariable('alteredaggregationweight')" href="../../_variables/alteredaggregationweight.html">$alteredaggregationweight</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = null;
<a name="l792"><span class="linenum"> 792</span></a>                                      continue;
<a name="l793"><span class="linenum"> 793</span></a>                                  }
<a name="l794"><span class="linenum"> 794</span></a>  <span class="comment">                                // The grade min/max may have been altered by hiding.</span>
<a name="l795"><span class="linenum"> 795</span></a>                                  <a class="var it5024" onMouseOver="hilite(5024)" onMouseOut="lolite()" onClick="logVariable('grademin')" href="../../_variables/grademin.html">$grademin</a> = <a class="var it6045" onMouseOver="hilite(6045)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../_variables/grade_items.html">$grade_items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;grademin;
<a name="l796"><span class="linenum"> 796</span></a>                                  if (isset(<a class="var it30691" onMouseOver="hilite(30691)" onMouseOut="lolite()" onClick="logVariable('alteredgrademin')" href="../../_variables/alteredgrademin.html">$alteredgrademin</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>])) {
<a name="l797"><span class="linenum"> 797</span></a>                                      <a class="var it5024" onMouseOver="hilite(5024)" onMouseOut="lolite()" onClick="logVariable('grademin')" href="../../_variables/grademin.html">$grademin</a> = <a class="var it30691" onMouseOver="hilite(30691)" onMouseOut="lolite()" onClick="logVariable('alteredgrademin')" href="../../_variables/alteredgrademin.html">$alteredgrademin</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>];
<a name="l798"><span class="linenum"> 798</span></a>                                  }
<a name="l799"><span class="linenum"> 799</span></a>                                  <a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a> = <a class="var it6045" onMouseOver="hilite(6045)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../_variables/grade_items.html">$grade_items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;grademax;
<a name="l800"><span class="linenum"> 800</span></a>                                  if (isset(<a class="var it30690" onMouseOver="hilite(30690)" onMouseOut="lolite()" onClick="logVariable('alteredgrademax')" href="../../_variables/alteredgrademax.html">$alteredgrademax</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>])) {
<a name="l801"><span class="linenum"> 801</span></a>                                      <a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a> = <a class="var it30690" onMouseOver="hilite(30690)" onMouseOut="lolite()" onClick="logVariable('alteredgrademax')" href="../../_variables/alteredgrademax.html">$alteredgrademax</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>];
<a name="l802"><span class="linenum"> 802</span></a>                                  }
<a name="l803"><span class="linenum"> 803</span></a>                                  <a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = <a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>::<a class="function" onClick="logFunction('standardise_score')" href="../../_functions/standardise_score.html" onMouseOver="funcPopup(event,'standardise_score')">standardise_score</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>, <a class="var it5024" onMouseOver="hilite(5024)" onMouseOut="lolite()" onClick="logVariable('grademin')" href="../../_variables/grademin.html">$grademin</a>, <a class="var it5025" onMouseOver="hilite(5025)" onMouseOut="lolite()" onClick="logVariable('grademax')" href="../../_variables/grademax.html">$grademax</a>, 0, 1);
<a name="l804"><span class="linenum"> 804</span></a>                              }
<a name="l805"><span class="linenum"> 805</span></a>  
<a name="l806"><span class="linenum"> 806</span></a>                              if (<a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a>-&gt;<a onClick="logVariable('aggregateonlygraded')" class="var it40058" onMouseOver="hilite(40058)" onMouseOut="lolite()" href="../../_variables/aggregateonlygraded.html">aggregateonlygraded</a>) {
<a name="l807"><span class="linenum"> 807</span></a>                                  foreach (<a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>=&gt;<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l808"><span class="linenum"> 808</span></a>                                      if (<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>)) {
<a name="l809"><span class="linenum"> 809</span></a>                                          unset(<a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]);
<a name="l810"><span class="linenum"> 810</span></a>                                          <a class="var it30692" onMouseOver="hilite(30692)" onMouseOut="lolite()" onClick="logVariable('alteredaggregationstatus')" href="../../_variables/alteredaggregationstatus.html">$alteredaggregationstatus</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 'novalue';
<a name="l811"><span class="linenum"> 811</span></a>                                          <a class="var it30693" onMouseOver="hilite(30693)" onMouseOut="lolite()" onClick="logVariable('alteredaggregationweight')" href="../../_variables/alteredaggregationweight.html">$alteredaggregationweight</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = null;
<a name="l812"><span class="linenum"> 812</span></a>                                      }
<a name="l813"><span class="linenum"> 813</span></a>                                  }
<a name="l814"><span class="linenum"> 814</span></a>                              } else {
<a name="l815"><span class="linenum"> 815</span></a>                                  foreach (<a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>=&gt;<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l816"><span class="linenum"> 816</span></a>                                      if (<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>)) {
<a name="l817"><span class="linenum"> 817</span></a>                                          <a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 0;
<a name="l818"><span class="linenum"> 818</span></a>                                      }
<a name="l819"><span class="linenum"> 819</span></a>                                  }
<a name="l820"><span class="linenum"> 820</span></a>                              }
<a name="l821"><span class="linenum"> 821</span></a>  
<a name="l822"><span class="linenum"> 822</span></a>  <span class="comment">                            // limit and sort</span>
<a name="l823"><span class="linenum"> 823</span></a>                              <a class="var it30697" onMouseOver="hilite(30697)" onMouseOut="lolite()" onClick="logVariable('allvalues')" href="../../_variables/allvalues.html">$allvalues</a> = <a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>;
<a name="l824"><span class="linenum"> 824</span></a>                              <a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a>-&gt;<a class="function" onClick="logFunction('apply_limit_rules')" href="../../_functions/apply_limit_rules.html" onMouseOver="funcPopup(event,'apply_limit_rules')">apply_limit_rules</a>(<a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>, <a class="var it6045" onMouseOver="hilite(6045)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../_variables/grade_items.html">$grade_items</a>);
<a name="l825"><span class="linenum"> 825</span></a>  
<a name="l826"><span class="linenum"> 826</span></a>                              <a class="var it30698" onMouseOver="hilite(30698)" onMouseOut="lolite()" onClick="logVariable('moredropped')" href="../../_variables/moredropped.html">$moredropped</a> = <a class="phpfunction" onClick="logFunction('array_diff')" href="../../_functions/array_diff.html" onMouseOver="phpfuncPopup(event,'array_diff')">array_diff</a>(<a class="var it30697" onMouseOver="hilite(30697)" onMouseOut="lolite()" onClick="logVariable('allvalues')" href="../../_variables/allvalues.html">$allvalues</a>, <a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>);
<a name="l827"><span class="linenum"> 827</span></a>                              foreach (<a class="var it30698" onMouseOver="hilite(30698)" onMouseOut="lolite()" onClick="logVariable('moredropped')" href="../../_variables/moredropped.html">$moredropped</a> as <a class="var it9383" onMouseOver="hilite(9383)" onMouseOut="lolite()" onClick="logVariable('drop')" href="../../_variables/drop.html">$drop</a> =&gt; <a class="var it1136" onMouseOver="hilite(1136)" onMouseOut="lolite()" onClick="logVariable('unused')" href="../../_variables/unused.html">$unused</a>) {
<a name="l828"><span class="linenum"> 828</span></a>                                  <a class="var it30692" onMouseOver="hilite(30692)" onMouseOut="lolite()" onClick="logVariable('alteredaggregationstatus')" href="../../_variables/alteredaggregationstatus.html">$alteredaggregationstatus</a>[<a class="var it9383" onMouseOver="hilite(9383)" onMouseOut="lolite()" onClick="logVariable('drop')" href="../../_variables/drop.html">$drop</a>] = 'dropped';
<a name="l829"><span class="linenum"> 829</span></a>                                  <a class="var it30693" onMouseOver="hilite(30693)" onMouseOut="lolite()" onClick="logVariable('alteredaggregationweight')" href="../../_variables/alteredaggregationweight.html">$alteredaggregationweight</a>[<a class="var it9383" onMouseOver="hilite(9383)" onMouseOut="lolite()" onClick="logVariable('drop')" href="../../_variables/drop.html">$drop</a>] = null;
<a name="l830"><span class="linenum"> 830</span></a>                              }
<a name="l831"><span class="linenum"> 831</span></a>  
<a name="l832"><span class="linenum"> 832</span></a>                              foreach (<a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a> =&gt; <a class="var it1140" onMouseOver="hilite(1140)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>) {
<a name="l833"><span class="linenum"> 833</span></a>                                  if (<a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a>-&gt;<a class="function" onClick="logFunction('is_extracredit_used')" href="../../_functions/is_extracredit_used.html" onMouseOver="funcPopup(event,'is_extracredit_used')">is_extracredit_used</a>() &amp;&amp; (<a class="var it6045" onMouseOver="hilite(6045)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../_variables/grade_items.html">$grade_items</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>]-&gt;aggregationcoef &gt; 0)) {
<a name="l834"><span class="linenum"> 834</span></a>                                      <a class="var it30692" onMouseOver="hilite(30692)" onMouseOut="lolite()" onClick="logVariable('alteredaggregationstatus')" href="../../_variables/alteredaggregationstatus.html">$alteredaggregationstatus</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 'extra';
<a name="l835"><span class="linenum"> 835</span></a>                                  }
<a name="l836"><span class="linenum"> 836</span></a>                              }
<a name="l837"><span class="linenum"> 837</span></a>  
<a name="l838"><span class="linenum"> 838</span></a>                              <a class="phpfunction" onClick="logFunction('asort')" href="../../_functions/asort.html" onMouseOver="phpfuncPopup(event,'asort')">asort</a>(<a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>, SORT_NUMERIC);
<a name="l839"><span class="linenum"> 839</span></a>  
<a name="l840"><span class="linenum"> 840</span></a>  <span class="comment">                            // let's see we have still enough grades to do any statistics</span>
<a name="l841"><span class="linenum"> 841</span></a>                              if (<a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>) == 0) {
<a name="l842"><span class="linenum"> 842</span></a>  <span class="comment">                                // not enough attempts yet</span>
<a name="l843"><span class="linenum"> 843</span></a>                                  <a class="var it23827" onMouseOver="hilite(23827)" onMouseOut="lolite()" onClick="logVariable('altered')" href="../../_variables/altered.html">$altered</a>[<a class="var it9885" onMouseOver="hilite(9885)" onMouseOut="lolite()" onClick="logVariable('do')" href="../../_variables/do.html">$do</a>] = null;
<a name="l844"><span class="linenum"> 844</span></a>                                  unset(<a class="var it728" onMouseOver="hilite(728)" onMouseOut="lolite()" onClick="logVariable('todo')" href="../../_variables/todo.html">$todo</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>]);
<a name="l845"><span class="linenum"> 845</span></a>                                  <a class="var it1608" onMouseOver="hilite(1608)" onMouseOut="lolite()" onClick="logVariable('found')" href="../../_variables/found.html">$found</a> = true;
<a name="l846"><span class="linenum"> 846</span></a>                                  continue;
<a name="l847"><span class="linenum"> 847</span></a>                              }
<a name="l848"><span class="linenum"> 848</span></a>  
<a name="l849"><span class="linenum"> 849</span></a>                              <a class="var it26718" onMouseOver="hilite(26718)" onMouseOut="lolite()" onClick="logVariable('usedweights')" href="../../_variables/usedweights.html">$usedweights</a> = array();
<a name="l850"><span class="linenum"> 850</span></a>                              <a class="var it20591" onMouseOver="hilite(20591)" onMouseOut="lolite()" onClick="logVariable('adjustedgrade')" href="../../_variables/adjustedgrade.html">$adjustedgrade</a> = <a class="var it6050" onMouseOver="hilite(6050)" onMouseOut="lolite()" onClick="logVariable('grade_category')" href="../../_variables/grade_category.html">$grade_category</a>-&gt;<a class="function" onClick="logFunction('aggregate_values_and_adjust_bounds')" href="../../_functions/aggregate_values_and_adjust_bounds.html" onMouseOver="funcPopup(event,'aggregate_values_and_adjust_bounds')">aggregate_values_and_adjust_bounds</a>(<a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>, <a class="var it6045" onMouseOver="hilite(6045)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../_variables/grade_items.html">$grade_items</a>, <a class="var it26718" onMouseOver="hilite(26718)" onMouseOut="lolite()" onClick="logVariable('usedweights')" href="../../_variables/usedweights.html">$usedweights</a>);
<a name="l851"><span class="linenum"> 851</span></a>  
<a name="l852"><span class="linenum"> 852</span></a>  <span class="comment">                            // recalculate the rawgrade back to requested range</span>
<a name="l853"><span class="linenum"> 853</span></a>                              <a class="var it4888" onMouseOver="hilite(4888)" onMouseOut="lolite()" onClick="logVariable('finalgrade')" href="../../_variables/finalgrade.html">$finalgrade</a> = <a class="class" onClick="logClass('grade_grade')" href="../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>::<a class="function" onClick="logFunction('standardise_score')" href="../../_functions/standardise_score.html" onMouseOver="funcPopup(event,'standardise_score')">standardise_score</a>(<a class="var it20591" onMouseOver="hilite(20591)" onMouseOut="lolite()" onClick="logVariable('adjustedgrade')" href="../../_variables/adjustedgrade.html">$adjustedgrade</a>['grade'],
<a name="l854"><span class="linenum"> 854</span></a>                                                                           0,
<a name="l855"><span class="linenum"> 855</span></a>                                                                           1,
<a name="l856"><span class="linenum"> 856</span></a>                                                                           <a class="var it20591" onMouseOver="hilite(20591)" onMouseOut="lolite()" onClick="logVariable('adjustedgrade')" href="../../_variables/adjustedgrade.html">$adjustedgrade</a>['grademin'],
<a name="l857"><span class="linenum"> 857</span></a>                                                                           <a class="var it20591" onMouseOver="hilite(20591)" onMouseOut="lolite()" onClick="logVariable('adjustedgrade')" href="../../_variables/adjustedgrade.html">$adjustedgrade</a>['grademax']);
<a name="l858"><span class="linenum"> 858</span></a>  
<a name="l859"><span class="linenum"> 859</span></a>                              foreach (<a class="var it26718" onMouseOver="hilite(26718)" onMouseOut="lolite()" onClick="logVariable('usedweights')" href="../../_variables/usedweights.html">$usedweights</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a> =&gt; <a class="var it5702" onMouseOver="hilite(5702)" onMouseOut="lolite()" onClick="logVariable('weight')" href="../../_variables/weight.html">$weight</a>) {
<a name="l860"><span class="linenum"> 860</span></a>                                  if (!isset(<a class="var it30692" onMouseOver="hilite(30692)" onMouseOut="lolite()" onClick="logVariable('alteredaggregationstatus')" href="../../_variables/alteredaggregationstatus.html">$alteredaggregationstatus</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>])) {
<a name="l861"><span class="linenum"> 861</span></a>                                      <a class="var it30692" onMouseOver="hilite(30692)" onMouseOut="lolite()" onClick="logVariable('alteredaggregationstatus')" href="../../_variables/alteredaggregationstatus.html">$alteredaggregationstatus</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = 'used';
<a name="l862"><span class="linenum"> 862</span></a>                                  }
<a name="l863"><span class="linenum"> 863</span></a>                                  <a class="var it30693" onMouseOver="hilite(30693)" onMouseOut="lolite()" onClick="logVariable('alteredaggregationweight')" href="../../_variables/alteredaggregationweight.html">$alteredaggregationweight</a>[<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>] = <a class="var it5702" onMouseOver="hilite(5702)" onMouseOut="lolite()" onClick="logVariable('weight')" href="../../_variables/weight.html">$weight</a>;
<a name="l864"><span class="linenum"> 864</span></a>                              }
<a name="l865"><span class="linenum"> 865</span></a>  
<a name="l866"><span class="linenum"> 866</span></a>                              <a class="var it4888" onMouseOver="hilite(4888)" onMouseOut="lolite()" onClick="logVariable('finalgrade')" href="../../_variables/finalgrade.html">$finalgrade</a> = <a class="var it6045" onMouseOver="hilite(6045)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../_variables/grade_items.html">$grade_items</a>[<a class="var it9885" onMouseOver="hilite(9885)" onMouseOut="lolite()" onClick="logVariable('do')" href="../../_variables/do.html">$do</a>]-&gt;<a class="function" onClick="logFunction('bounded_grade')" href="../../_functions/bounded_grade.html" onMouseOver="funcPopup(event,'bounded_grade')">bounded_grade</a>(<a class="var it4888" onMouseOver="hilite(4888)" onMouseOut="lolite()" onClick="logVariable('finalgrade')" href="../../_variables/finalgrade.html">$finalgrade</a>);
<a name="l867"><span class="linenum"> 867</span></a>                              <a class="var it30691" onMouseOver="hilite(30691)" onMouseOut="lolite()" onClick="logVariable('alteredgrademin')" href="../../_variables/alteredgrademin.html">$alteredgrademin</a>[<a class="var it9885" onMouseOver="hilite(9885)" onMouseOut="lolite()" onClick="logVariable('do')" href="../../_variables/do.html">$do</a>] = <a class="var it20591" onMouseOver="hilite(20591)" onMouseOut="lolite()" onClick="logVariable('adjustedgrade')" href="../../_variables/adjustedgrade.html">$adjustedgrade</a>['grademin'];
<a name="l868"><span class="linenum"> 868</span></a>                              <a class="var it30690" onMouseOver="hilite(30690)" onMouseOut="lolite()" onClick="logVariable('alteredgrademax')" href="../../_variables/alteredgrademax.html">$alteredgrademax</a>[<a class="var it9885" onMouseOver="hilite(9885)" onMouseOut="lolite()" onClick="logVariable('do')" href="../../_variables/do.html">$do</a>] = <a class="var it20591" onMouseOver="hilite(20591)" onMouseOut="lolite()" onClick="logVariable('adjustedgrade')" href="../../_variables/adjustedgrade.html">$adjustedgrade</a>['grademax'];
<a name="l869"><span class="linenum"> 869</span></a>  <span class="comment">                            // We need to muck with the &quot;in-memory&quot; grade_items records so</span>
<a name="l870"><span class="linenum"> 870</span></a>  <span class="comment">                            // that subsequent calculations will use the adjusted grademin and grademax.</span>
<a name="l871"><span class="linenum"> 871</span></a>                              <a class="var it6045" onMouseOver="hilite(6045)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../_variables/grade_items.html">$grade_items</a>[<a class="var it9885" onMouseOver="hilite(9885)" onMouseOut="lolite()" onClick="logVariable('do')" href="../../_variables/do.html">$do</a>]-&gt;grademin = <a class="var it20591" onMouseOver="hilite(20591)" onMouseOut="lolite()" onClick="logVariable('adjustedgrade')" href="../../_variables/adjustedgrade.html">$adjustedgrade</a>['grademin'];
<a name="l872"><span class="linenum"> 872</span></a>                              <a class="var it6045" onMouseOver="hilite(6045)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../_variables/grade_items.html">$grade_items</a>[<a class="var it9885" onMouseOver="hilite(9885)" onMouseOut="lolite()" onClick="logVariable('do')" href="../../_variables/do.html">$do</a>]-&gt;grademax = <a class="var it20591" onMouseOver="hilite(20591)" onMouseOut="lolite()" onClick="logVariable('adjustedgrade')" href="../../_variables/adjustedgrade.html">$adjustedgrade</a>['grademax'];
<a name="l873"><span class="linenum"> 873</span></a>  
<a name="l874"><span class="linenum"> 874</span></a>                              <a class="var it23827" onMouseOver="hilite(23827)" onMouseOut="lolite()" onClick="logVariable('altered')" href="../../_variables/altered.html">$altered</a>[<a class="var it9885" onMouseOver="hilite(9885)" onMouseOut="lolite()" onClick="logVariable('do')" href="../../_variables/do.html">$do</a>] = <a class="var it4888" onMouseOver="hilite(4888)" onMouseOut="lolite()" onClick="logVariable('finalgrade')" href="../../_variables/finalgrade.html">$finalgrade</a>;
<a name="l875"><span class="linenum"> 875</span></a>                              unset(<a class="var it728" onMouseOver="hilite(728)" onMouseOut="lolite()" onClick="logVariable('todo')" href="../../_variables/todo.html">$todo</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>]);
<a name="l876"><span class="linenum"> 876</span></a>                              <a class="var it1608" onMouseOver="hilite(1608)" onMouseOut="lolite()" onClick="logVariable('found')" href="../../_variables/found.html">$found</a> = true;
<a name="l877"><span class="linenum"> 877</span></a>                              continue;
<a name="l878"><span class="linenum"> 878</span></a>                          }
<a name="l879"><span class="linenum"> 879</span></a>                      }
<a name="l880"><span class="linenum"> 880</span></a>                  }
<a name="l881"><span class="linenum"> 881</span></a>              }
<a name="l882"><span class="linenum"> 882</span></a>              if (!<a class="var it1608" onMouseOver="hilite(1608)" onMouseOut="lolite()" onClick="logVariable('found')" href="../../_variables/found.html">$found</a>) {
<a name="l883"><span class="linenum"> 883</span></a>                  break;
<a name="l884"><span class="linenum"> 884</span></a>              }
<a name="l885"><span class="linenum"> 885</span></a>          }
<a name="l886"><span class="linenum"> 886</span></a>  
<a name="l887"><span class="linenum"> 887</span></a>          return array('unknown' =&gt; <a class="var it26679" onMouseOver="hilite(26679)" onMouseOut="lolite()" onClick="logVariable('unknown')" href="../../_variables/unknown.html">$unknown</a>,
<a name="l888"><span class="linenum"> 888</span></a>                       'altered' =&gt; <a class="var it23827" onMouseOver="hilite(23827)" onMouseOut="lolite()" onClick="logVariable('altered')" href="../../_variables/altered.html">$altered</a>,
<a name="l889"><span class="linenum"> 889</span></a>                       'alteredgrademax' =&gt; <a class="var it30690" onMouseOver="hilite(30690)" onMouseOut="lolite()" onClick="logVariable('alteredgrademax')" href="../../_variables/alteredgrademax.html">$alteredgrademax</a>,
<a name="l890"><span class="linenum"> 890</span></a>                       'alteredgrademin' =&gt; <a class="var it30691" onMouseOver="hilite(30691)" onMouseOut="lolite()" onClick="logVariable('alteredgrademin')" href="../../_variables/alteredgrademin.html">$alteredgrademin</a>,
<a name="l891"><span class="linenum"> 891</span></a>                       'alteredaggregationstatus' =&gt; <a class="var it30692" onMouseOver="hilite(30692)" onMouseOut="lolite()" onClick="logVariable('alteredaggregationstatus')" href="../../_variables/alteredaggregationstatus.html">$alteredaggregationstatus</a>,
<a name="l892"><span class="linenum"> 892</span></a>                       'alteredaggregationweight' =&gt; <a class="var it30693" onMouseOver="hilite(30693)" onMouseOut="lolite()" onClick="logVariable('alteredaggregationweight')" href="../../_variables/alteredaggregationweight.html">$alteredaggregationweight</a>);
<a name="l893"><span class="linenum"> 893</span></a>      }
<a name="l894"><span class="linenum"> 894</span></a>  
<a name="l895"><span class="linenum"> 895</span></a>      <span class="comment">/**</span>
<a name="l896"><span class="linenum"> 896</span></a>  <span class="comment">     * Returns true if the grade's value is superior or equal to the grade item's gradepass value, false otherwise.</span>
<a name="l897"><span class="linenum"> 897</span></a>  <span class="comment">     *</span>
<a name="l898"><span class="linenum"> 898</span></a>  <span class="comment">     * @param grade_item $grade_item An optional grade_item of which gradepass value we can use, saves having to load the grade_grade's grade_item</span>
<a name="l899"><span class="linenum"> 899</span></a>  <span class="comment">     * @return bool</span>
<a name="l900"><span class="linenum"> 900</span></a>  <span class="comment">     */</span>
<a name="l901"><span class="linenum"> 901</span></a>      public function <a class="function" onClick="logFunction('is_passed')" href="../../_functions/is_passed.html" onMouseOver="funcPopup(event,'is_passed')">is_passed</a>(<a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a> = null) {
<a name="l902"><span class="linenum"> 902</span></a>          if (empty(<a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>)) {
<a name="l903"><span class="linenum"> 903</span></a>              if (!isset(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>)) {
<a name="l904"><span class="linenum"> 904</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l905"><span class="linenum"> 905</span></a>              }
<a name="l906"><span class="linenum"> 906</span></a>          } else {
<a name="l907"><span class="linenum"> 907</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a> = <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>;
<a name="l908"><span class="linenum"> 908</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('itemid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/itemid.html">itemid</a> = <a class="var it6046" onMouseOver="hilite(6046)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../_variables/grade_item.html">$grade_item</a>-&gt;<a onClick="logVariable('id')" class="var it39507" onMouseOver="hilite(39507)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l909"><span class="linenum"> 909</span></a>          }
<a name="l910"><span class="linenum"> 910</span></a>  
<a name="l911"><span class="linenum"> 911</span></a>  <span class="comment">        // Return null if finalgrade is null</span>
<a name="l912"><span class="linenum"> 912</span></a>          if (<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('finalgrade')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/finalgrade.html">finalgrade</a>)) {
<a name="l913"><span class="linenum"> 913</span></a>              return null;
<a name="l914"><span class="linenum"> 914</span></a>          }
<a name="l915"><span class="linenum"> 915</span></a>  
<a name="l916"><span class="linenum"> 916</span></a>  <span class="comment">        // Return null if gradepass == grademin, gradepass is null, or grade item is a scale and gradepass is 0.</span>
<a name="l917"><span class="linenum"> 917</span></a>          if (<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;gradepass)) {
<a name="l918"><span class="linenum"> 918</span></a>              return null;
<a name="l919"><span class="linenum"> 919</span></a>          } else if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;gradepass == <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;grademin) {
<a name="l920"><span class="linenum"> 920</span></a>              return null;
<a name="l921"><span class="linenum"> 921</span></a>          } else if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;gradetype == <a class="constant" onClick="logConstant('GRADE_TYPE_SCALE')" href="../../_constants/GRADE_TYPE_SCALE.html" onMouseOver="constPopup(event,'GRADE_TYPE_SCALE')">GRADE_TYPE_SCALE</a> &amp;&amp; !<a class="function" onClick="logFunction('grade_floats_different')" href="../../_functions/grade_floats_different.html" onMouseOver="funcPopup(event,'grade_floats_different')">grade_floats_different</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;gradepass, 0.0)) {
<a name="l922"><span class="linenum"> 922</span></a>              return null;
<a name="l923"><span class="linenum"> 923</span></a>          }
<a name="l924"><span class="linenum"> 924</span></a>  
<a name="l925"><span class="linenum"> 925</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('finalgrade')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/finalgrade.html">finalgrade</a> &gt;= <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;gradepass;
<a name="l926"><span class="linenum"> 926</span></a>      }
<a name="l927"><span class="linenum"> 927</span></a>  
<a name="l928"><span class="linenum"> 928</span></a>      <span class="comment">/**</span>
<a name="l929"><span class="linenum"> 929</span></a>  <span class="comment">     * Insert the grade_grade instance into the database.</span>
<a name="l930"><span class="linenum"> 930</span></a>  <span class="comment">     *</span>
<a name="l931"><span class="linenum"> 931</span></a>  <span class="comment">     * @param string $source From where was the object inserted (mod/forum, manual, etc.)</span>
<a name="l932"><span class="linenum"> 932</span></a>  <span class="comment">     * @return int The new grade_grade ID if successful, false otherwise</span>
<a name="l933"><span class="linenum"> 933</span></a>  <span class="comment">     */</span>
<a name="l934"><span class="linenum"> 934</span></a>      public function <a class="function" onClick="logFunction('insert')" href="../../_functions/insert.html" onMouseOver="funcPopup(event,'insert')">insert</a>(<a class="var it1344" onMouseOver="hilite(1344)" onMouseOut="lolite()" onClick="logVariable('source')" href="../../_variables/source.html">$source</a>=null) {
<a name="l935"><span class="linenum"> 935</span></a>  <span class="comment">        // TODO: dategraded hack - do not update times, they are used for submission and grading (MDL-31379)</span>
<a name="l936"><span class="linenum"> 936</span></a>  <span class="comment">        //$this-&gt;timecreated = $this-&gt;timemodified = time();</span>
<a name="l937"><span class="linenum"> 937</span></a>          return parent::<a class="function" onClick="logFunction('insert')" href="../../_functions/insert.html" onMouseOver="funcPopup(event,'insert')">insert</a>(<a class="var it1344" onMouseOver="hilite(1344)" onMouseOut="lolite()" onClick="logVariable('source')" href="../../_variables/source.html">$source</a>);
<a name="l938"><span class="linenum"> 938</span></a>      }
<a name="l939"><span class="linenum"> 939</span></a>  
<a name="l940"><span class="linenum"> 940</span></a>      <span class="comment">/**</span>
<a name="l941"><span class="linenum"> 941</span></a>  <span class="comment">     * In addition to update() as defined in grade_object rounds the float numbers using php function,</span>
<a name="l942"><span class="linenum"> 942</span></a>  <span class="comment">     * the reason is we need to compare the db value with computed number to skip updates if possible.</span>
<a name="l943"><span class="linenum"> 943</span></a>  <span class="comment">     *</span>
<a name="l944"><span class="linenum"> 944</span></a>  <span class="comment">     * @param string $source from where was the object inserted (mod/forum, manual, etc.)</span>
<a name="l945"><span class="linenum"> 945</span></a>  <span class="comment">     * @return bool success</span>
<a name="l946"><span class="linenum"> 946</span></a>  <span class="comment">     */</span>
<a name="l947"><span class="linenum"> 947</span></a>      public function <a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>(<a class="var it1344" onMouseOver="hilite(1344)" onMouseOut="lolite()" onClick="logVariable('source')" href="../../_variables/source.html">$source</a>=null) {
<a name="l948"><span class="linenum"> 948</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('rawgrade')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/rawgrade.html">rawgrade</a>    = <a class="function" onClick="logFunction('grade_floatval')" href="../../_functions/grade_floatval.html" onMouseOver="funcPopup(event,'grade_floatval')">grade_floatval</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('rawgrade')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/rawgrade.html">rawgrade</a>);
<a name="l949"><span class="linenum"> 949</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('finalgrade')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/finalgrade.html">finalgrade</a>  = <a class="function" onClick="logFunction('grade_floatval')" href="../../_functions/grade_floatval.html" onMouseOver="funcPopup(event,'grade_floatval')">grade_floatval</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('finalgrade')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/finalgrade.html">finalgrade</a>);
<a name="l950"><span class="linenum"> 950</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('rawgrademin')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/rawgrademin.html">rawgrademin</a> = <a class="function" onClick="logFunction('grade_floatval')" href="../../_functions/grade_floatval.html" onMouseOver="funcPopup(event,'grade_floatval')">grade_floatval</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('rawgrademin')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/rawgrademin.html">rawgrademin</a>);
<a name="l951"><span class="linenum"> 951</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('rawgrademax')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/rawgrademax.html">rawgrademax</a> = <a class="function" onClick="logFunction('grade_floatval')" href="../../_functions/grade_floatval.html" onMouseOver="funcPopup(event,'grade_floatval')">grade_floatval</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('rawgrademax')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/rawgrademax.html">rawgrademax</a>);
<a name="l952"><span class="linenum"> 952</span></a>          return parent::<a class="function" onClick="logFunction('update')" href="../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>(<a class="var it1344" onMouseOver="hilite(1344)" onMouseOut="lolite()" onClick="logVariable('source')" href="../../_variables/source.html">$source</a>);
<a name="l953"><span class="linenum"> 953</span></a>      }
<a name="l954"><span class="linenum"> 954</span></a>  
<a name="l955"><span class="linenum"> 955</span></a>      <span class="comment">/**</span>
<a name="l956"><span class="linenum"> 956</span></a>  <span class="comment">     * Deletes the grade_grade instance from the database.</span>
<a name="l957"><span class="linenum"> 957</span></a>  <span class="comment">     *</span>
<a name="l958"><span class="linenum"> 958</span></a>  <span class="comment">     * @param string $source The location the deletion occurred (mod/forum, manual, etc.).</span>
<a name="l959"><span class="linenum"> 959</span></a>  <span class="comment">     * @return bool Returns true if the deletion was successful, false otherwise.</span>
<a name="l960"><span class="linenum"> 960</span></a>  <span class="comment">     */</span>
<a name="l961"><span class="linenum"> 961</span></a>      public function <a class="function" onClick="logFunction('delete')" href="../../_functions/delete.html" onMouseOver="funcPopup(event,'delete')">delete</a>(<a class="var it1344" onMouseOver="hilite(1344)" onMouseOut="lolite()" onClick="logVariable('source')" href="../../_variables/source.html">$source</a> = null) {
<a name="l962"><span class="linenum"> 962</span></a>          <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('success')" href="../../_variables/success.html">$success</a> = parent::<a class="function" onClick="logFunction('delete')" href="../../_functions/delete.html" onMouseOver="funcPopup(event,'delete')">delete</a>(<a class="var it1344" onMouseOver="hilite(1344)" onMouseOut="lolite()" onClick="logVariable('source')" href="../../_variables/source.html">$source</a>);
<a name="l963"><span class="linenum"> 963</span></a>  
<a name="l964"><span class="linenum"> 964</span></a>  <span class="comment">        // If the grade was deleted successfully trigger a grade_deleted event.</span>
<a name="l965"><span class="linenum"> 965</span></a>          if (<a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('success')" href="../../_variables/success.html">$success</a>) {
<a name="l966"><span class="linenum"> 966</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l967"><span class="linenum"> 967</span></a>              \core\event\<a class="class" onClick="logClass('grade_deleted')" href="../../_classes/grade_deleted.html" onMouseOver="classPopup(event,'grade_deleted')">grade_deleted</a>::<a class="function" onClick="logFunction('create_from_grade')" href="../../_functions/create_from_grade.html" onMouseOver="funcPopup(event,'create_from_grade')">create_from_grade</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>)-&gt;<a class="function" onClick="logFunction('trigger')" href="../../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l968"><span class="linenum"> 968</span></a>          }
<a name="l969"><span class="linenum"> 969</span></a>  
<a name="l970"><span class="linenum"> 970</span></a>          return <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('success')" href="../../_variables/success.html">$success</a>;
<a name="l971"><span class="linenum"> 971</span></a>      }
<a name="l972"><span class="linenum"> 972</span></a>  
<a name="l973"><span class="linenum"> 973</span></a>      <span class="comment">/**</span>
<a name="l974"><span class="linenum"> 974</span></a>  <span class="comment">     * Used to notify the completion system (if necessary) that a user's grade</span>
<a name="l975"><span class="linenum"> 975</span></a>  <span class="comment">     * has changed, and clear up a possible score cache.</span>
<a name="l976"><span class="linenum"> 976</span></a>  <span class="comment">     *</span>
<a name="l977"><span class="linenum"> 977</span></a>  <span class="comment">     * @param bool $deleted True if grade was actually deleted</span>
<a name="l978"><span class="linenum"> 978</span></a>  <span class="comment">     */</span>
<a name="l979"><span class="linenum"> 979</span></a>      protected function <a class="function" onClick="logFunction('notify_changed')" href="../../_functions/notify_changed.html" onMouseOver="funcPopup(event,'notify_changed')">notify_changed</a>(<a class="var it2973" onMouseOver="hilite(2973)" onMouseOut="lolite()" onClick="logVariable('deleted')" href="../../_variables/deleted.html">$deleted</a>) {
<a name="l980"><span class="linenum"> 980</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l981"><span class="linenum"> 981</span></a>  
<a name="l982"><span class="linenum"> 982</span></a>  <span class="comment">        // Condition code may cache the grades for conditional availability of</span>
<a name="l983"><span class="linenum"> 983</span></a>  <span class="comment">        // modules or sections. (This code should use a hook for communication</span>
<a name="l984"><span class="linenum"> 984</span></a>  <span class="comment">        // with plugin, but hooks are not implemented at time of writing.)</span>
<a name="l985"><span class="linenum"> 985</span></a>          if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('enableavailability')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/enableavailability.html">enableavailability</a>) &amp;&amp; <a class="phpfunction" onClick="logFunction('class_exists')" href="../../_functions/class_exists.html" onMouseOver="phpfuncPopup(event,'class_exists')">class_exists</a>('\availability_grade\callbacks')) {
<a name="l986"><span class="linenum"> 986</span></a>              \availability_grade\<a class="class" onClick="logClass('callbacks')" href="../../_classes/callbacks.html" onMouseOver="classPopup(event,'callbacks')">callbacks</a>::<a class="function" onClick="logFunction('grade_changed')" href="../../_functions/grade_changed.html" onMouseOver="funcPopup(event,'grade_changed')">grade_changed</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('userid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>);
<a name="l987"><span class="linenum"> 987</span></a>          }
<a name="l988"><span class="linenum"> 988</span></a>  
<a name="l989"><span class="linenum"> 989</span></a>          require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a>.'/completionlib.php');
<a name="l990"><span class="linenum"> 990</span></a>  
<a name="l991"><span class="linenum"> 991</span></a>  <span class="comment">        // Bail out immediately if completion is not enabled for site (saves loading</span>
<a name="l992"><span class="linenum"> 992</span></a>  <span class="comment">        // grade item &amp; requiring the restore stuff).</span>
<a name="l993"><span class="linenum"> 993</span></a>          if (!<a class="class" onClick="logClass('completion_info')" href="../../_classes/completion_info.html" onMouseOver="classPopup(event,'completion_info')">completion_info</a>::<a class="function" onClick="logFunction('is_enabled_for_site')" href="../../_functions/is_enabled_for_site.html" onMouseOver="funcPopup(event,'is_enabled_for_site')">is_enabled_for_site</a>()) {
<a name="l994"><span class="linenum"> 994</span></a>              return;
<a name="l995"><span class="linenum"> 995</span></a>          }
<a name="l996"><span class="linenum"> 996</span></a>  
<a name="l997"><span class="linenum"> 997</span></a>  <span class="comment">        // Ignore during restore, as completion data will be updated anyway and</span>
<a name="l998"><span class="linenum"> 998</span></a>  <span class="comment">        // doing it now will result in incorrect dates (it will say they got the</span>
<a name="l999"><span class="linenum"> 999</span></a>  <span class="comment">        // grade completion now, instead of the correct time).</span>
<a name="l1000"><span class="linenum">1000</span></a>          if (<a class="phpfunction" onClick="logFunction('class_exists')" href="../../_functions/class_exists.html" onMouseOver="phpfuncPopup(event,'class_exists')">class_exists</a>('restore_controller', false) &amp;&amp; <a class="class" onClick="logClass('restore_controller')" href="../../_classes/restore_controller.html" onMouseOver="classPopup(event,'restore_controller')">restore_controller</a>::<a class="function" onClick="logFunction('is_executing')" href="../../_functions/is_executing.html" onMouseOver="funcPopup(event,'is_executing')">is_executing</a>()) {
<a name="l1001"><span class="linenum">1001</span></a>              return;
<a name="l1002"><span class="linenum">1002</span></a>          }
<a name="l1003"><span class="linenum">1003</span></a>  
<a name="l1004"><span class="linenum">1004</span></a>  <span class="comment">        // Load information about grade item</span>
<a name="l1005"><span class="linenum">1005</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_grade_item')" href="../../_functions/load_grade_item.html" onMouseOver="funcPopup(event,'load_grade_item')">load_grade_item</a>();
<a name="l1006"><span class="linenum">1006</span></a>  
<a name="l1007"><span class="linenum">1007</span></a>  <span class="comment">        // Only course-modules have completion data</span>
<a name="l1008"><span class="linenum">1008</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;itemtype!='mod') {
<a name="l1009"><span class="linenum">1009</span></a>              return;
<a name="l1010"><span class="linenum">1010</span></a>          }
<a name="l1011"><span class="linenum">1011</span></a>  
<a name="l1012"><span class="linenum">1012</span></a>  <span class="comment">        // Use $COURSE if available otherwise get it via item fields</span>
<a name="l1013"><span class="linenum">1013</span></a>          <a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a> = <a class="function" onClick="logFunction('get_course')" href="../../_functions/get_course.html" onMouseOver="funcPopup(event,'get_course')">get_course</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;courseid, false);
<a name="l1014"><span class="linenum">1014</span></a>  
<a name="l1015"><span class="linenum">1015</span></a>  <span class="comment">        // Bail out if completion is not enabled for course</span>
<a name="l1016"><span class="linenum">1016</span></a>          <a class="var it3863" onMouseOver="hilite(3863)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a> = <span class="keyword">new </span><a class="class" onClick="logClass('completion_info')" href="../../_classes/completion_info.html" onMouseOver="classPopup(event,'completion_info')">completion_info</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>);
<a name="l1017"><span class="linenum">1017</span></a>          if (!<a class="var it3863" onMouseOver="hilite(3863)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a>-&gt;<a class="function" onClick="logFunction('is_enabled')" href="../../_functions/is_enabled.html" onMouseOver="funcPopup(event,'is_enabled')">is_enabled</a>()) {
<a name="l1018"><span class="linenum">1018</span></a>              return;
<a name="l1019"><span class="linenum">1019</span></a>          }
<a name="l1020"><span class="linenum">1020</span></a>  
<a name="l1021"><span class="linenum">1021</span></a>  <span class="comment">        // Get course-module</span>
<a name="l1022"><span class="linenum">1022</span></a>          <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a> = <a class="function" onClick="logFunction('get_coursemodule_from_instance')" href="../../_functions/get_coursemodule_from_instance.html" onMouseOver="funcPopup(event,'get_coursemodule_from_instance')">get_coursemodule_from_instance</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;itemmodule,
<a name="l1023"><span class="linenum">1023</span></a>                <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;iteminstance, <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;courseid);
<a name="l1024"><span class="linenum">1024</span></a>  <span class="comment">        // If the course-module doesn't exist, display a warning...</span>
<a name="l1025"><span class="linenum">1025</span></a>          if (!<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>) {
<a name="l1026"><span class="linenum">1026</span></a>  <span class="comment">            // ...unless the grade is being deleted in which case it's likely</span>
<a name="l1027"><span class="linenum">1027</span></a>  <span class="comment">            // that the course-module was just deleted too, so that's okay.</span>
<a name="l1028"><span class="linenum">1028</span></a>              if (!<a class="var it2973" onMouseOver="hilite(2973)" onMouseOut="lolite()" onClick="logVariable('deleted')" href="../../_variables/deleted.html">$deleted</a>) {
<a name="l1029"><span class="linenum">1029</span></a>                  <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(&quot;Couldn't find course-module for module '&quot; .
<a name="l1030"><span class="linenum">1030</span></a>                          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;itemmodule . &quot;', instance '&quot; .
<a name="l1031"><span class="linenum">1031</span></a>                          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;iteminstance . &quot;', course '&quot; .
<a name="l1032"><span class="linenum">1032</span></a>                          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>-&gt;courseid . &quot;'&quot;);
<a name="l1033"><span class="linenum">1033</span></a>              }
<a name="l1034"><span class="linenum">1034</span></a>              return;
<a name="l1035"><span class="linenum">1035</span></a>          }
<a name="l1036"><span class="linenum">1036</span></a>  
<a name="l1037"><span class="linenum">1037</span></a>  <span class="comment">        // Pass information on to completion system</span>
<a name="l1038"><span class="linenum">1038</span></a>          <a class="var it3863" onMouseOver="hilite(3863)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a>-&gt;<a class="function" onClick="logFunction('inform_grade_changed')" href="../../_functions/inform_grade_changed.html" onMouseOver="funcPopup(event,'inform_grade_changed')">inform_grade_changed</a>(<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('grade_item')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/grade_item.html">grade_item</a>, <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, <a class="var it2973" onMouseOver="hilite(2973)" onMouseOut="lolite()" onClick="logVariable('deleted')" href="../../_variables/deleted.html">$deleted</a>);
<a name="l1039"><span class="linenum">1039</span></a>      }
<a name="l1040"><span class="linenum">1040</span></a>  
<a name="l1041"><span class="linenum">1041</span></a>      <span class="comment">/**</span>
<a name="l1042"><span class="linenum">1042</span></a>  <span class="comment">     * Get some useful information about how this grade_grade is reflected in the aggregation</span>
<a name="l1043"><span class="linenum">1043</span></a>  <span class="comment">     * for the grade_category. For example this could be an extra credit item, and it could be</span>
<a name="l1044"><span class="linenum">1044</span></a>  <span class="comment">     * dropped because it's in the X lowest or highest.</span>
<a name="l1045"><span class="linenum">1045</span></a>  <span class="comment">     *</span>
<a name="l1046"><span class="linenum">1046</span></a>  <span class="comment">     * @return array(status, weight) - A keyword and a numerical weight that represents how this grade was included in the aggregation.</span>
<a name="l1047"><span class="linenum">1047</span></a>  <span class="comment">     */</span>
<a name="l1048"><span class="linenum">1048</span></a>      function <a class="function" onClick="logFunction('get_aggregation_hint')" href="../../_functions/get_aggregation_hint.html" onMouseOver="funcPopup(event,'get_aggregation_hint')">get_aggregation_hint</a>() {
<a name="l1049"><span class="linenum">1049</span></a>          return array('status' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_aggregationstatus')" href="../../_functions/get_aggregationstatus.html" onMouseOver="funcPopup(event,'get_aggregationstatus')">get_aggregationstatus</a>(),
<a name="l1050"><span class="linenum">1050</span></a>                       'weight' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_aggregationweight')" href="../../_functions/get_aggregationweight.html" onMouseOver="funcPopup(event,'get_aggregationweight')">get_aggregationweight</a>());
<a name="l1051"><span class="linenum">1051</span></a>      }
<a name="l1052"><span class="linenum">1052</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'set_locked': ['set_locked', 'Locks or unlocks this grade_item and (optionally) all its associated final grades. ', [['lib/grade','grade_item.php',499],['lib/grade','grade_grade.php',412],['lib/grade','grade_category.php',2324]], 17],
'get_config': ['get_config', 'Get a configuration value for this plugin ', [['mod/assign','assignmentplugin.php',345],['lib/portfolio','plugin.php',546],['question/engine','bank.php',109],['lib','moodlelib.php',1404],['lib','enrollib.php',1141],['lib/editor/tinymce/classes','plugin.php',73],['admin/tool/log/classes/helper','store.php',63]], 847],
'is_locked': ['is_locked', 'Returns the locked state of this grade_item (if the grade_item is locked OR no specific $userid is given) or the locked state of a specific grade within this item if a specific $userid is given and the grade_item is unlocked. ', [['lib/grade','grade_item.php',476],['backup/util/settings','setting_dependency.class.php',187],['backup/util/settings','setting_dependency.class.php',340],['backup/util/settings','setting_dependency.class.php',534],['backup/util/settings','setting_dependency.class.php',598],['user/profile','lib.php',354],['lib/grade','grade_grade.php',265],['lib/grade','grade_category.php',2312],['lib','badgeslib.php',317]], 57],
'create_from_grade': ['create_from_grade', 'Create instance of event. ', [['mod/assign/classes/event','feedback_viewed.php',44],['lib/classes/event','grade_deleted.php',61],['lib/classes/event','user_graded.php',52],['mod/assign/classes/event','submission_graded.php',44]], 15],
'trigger': ['trigger', '', [['lib/evalmath','evalmath.class.php',438],['lib/classes/event','base.php',682]], 778],
'fetch_all_helper': ['fetch_all_helper', 'Factory method which uses the parameters to retrieve all matching instances from the database ', [['lib/grade','grade_object.php',171],['completion','data_object.php',199]], 11],
'set_excluded': ['set_excluded', 'Set the excluded status of grade ', [['lib/grade','grade_grade.php',392]], 2],
'get_aggregationstatus': ['get_aggregationstatus', 'Returns the info on how this value was used in the aggregated grade ', [['lib/grade','grade_grade.php',320]], 1],
'debugging': ['debugging', 'Standard Debugging Function ', [['lib','weblib.php',2854]], 853],
'fetch_helper': ['fetch_helper', 'Factory method which uses the parameters to retrieve matching instances from the database ', [['lib/grade','grade_object.php',151],['completion','data_object.php',178]], 16],
'load_item_category': ['load_item_category', 'Calls upon the get_item_category method to retrieve the grade_category object from the DB and assigns it to $this->item_category. It also returns the object. ', [['lib/grade','grade_item.php',908]], 5],
'aggregate_values_and_adjust_bounds': ['aggregate_values_and_adjust_bounds', 'Internal function that calculates the aggregated grade and new min/max for this grade category ', [['lib/grade','grade_category.php',852]], 4],
'is_hiddenuntil': ['is_hiddenuntil', 'Check grade object hidden status ', [['lib/grade','grade_object.php',426],['lib/grade','grade_grade.php',517]], 3],
'get_datesubmitted': ['get_datesubmitted', 'Returns timestamp of submission related to this grade, null if not submitted. ', [['lib/grade','grade_grade.php',290]], 6],
'get_dategraded': ['get_dategraded', 'Returns timestamp when last graded, null if no grade present ', [['lib/grade','grade_grade.php',340]], 5],
'delete': ['delete', 'Deletes a key pair ', [['lib/zend/Zend/Service/Amazon/Ec2','Keypair.php',110],['lib/google/src/Google/Service','Reseller.php',440],['lib/phpexcel/PHPExcel/Shared/PCLZip','pclzip.lib.php',1006],['lib/adodb','adodb-active-recordx.inc.php',949],['lib/zend/Zend/Service/Delicious','Post.php',236],['lib/grade','grade_object.php',270],['lib/zend/Zend/Gdata','Gapps.php',258],['lib/google/src/Google/Service','Fusiontables.php',644],['lib/google/src/Google/Service','Fusiontables.php',809],['lib/google/src/Google/Service','Fusiontables.php',934],['lib/google/src/Google/Service','Fusiontables.php',1127],['lib/google/src/Google/Service','Fusiontables.php',1188],['blog','locallib.php',325],['lib/google/src/Google/Service','Blogger.php',1051],['lib/google/src/Google/Service','Blogger.php',1212],['lib/google/src/Google/Service','Blogger.php',1434],['lib/portfolio','plugin.php',692],['lib/google/src/Google/Service','AdExchangeBuyer.php',605],['lib/google/src/Google/Service','Manager.php',240],['lib/google/src/Google/Service','Manager.php',320],['lib/zend/Zend/Service/Amazon/Ec2','Securitygroups.php',137],['lib','webdavlib.php',691],['lib/grade','grade_item.php',354],['lib/google/src/Google/Service','Gmail.php',686],['lib/google/src/Google/Service','Gmail.php',843],['lib/google/src/Google/Service','Gmail.php',936],['lib/google/src/Google/Service','Gmail.php',1146],['course','lib.php',3133],['lib/google/src/Google/Service','Mirror.php',424],['lib/google/src/Google/Service','Mirror.php',592],['lib/google/src/Google/Service','Mirror.php',660],['lib/google/src/Google/Service','Mirror.php',771],['lib/google/src/Google/Service','Genomics.php',632],['lib/google/src/Google/Service','Genomics.php',731],['lib/google/src/Google/Service','Genomics.php',963],['lib/google/src/Google/Service','Genomics.php',1327],['lib/google/src/Google/Service','Genomics.php',1399],['cache/classes','interfaces.php',161],['lib/google/src/Google/Service','Dfareporting.php',470],['lib/zend/Zend/Gdata/Gbase','ItemEntry.php',133],['lib/google/src/Google/Service','Licensing.php',221],['lib/google/src/Google/Service','Drive.php',1462],['lib/google/src/Google/Service','Drive.php',1536],['lib/google/src/Google/Service','Drive.php',1681],['lib/google/src/Google/Service','Drive.php',1932],['lib/google/src/Google/Service','Drive.php',2002],['lib/google/src/Google/Service','Drive.php',2131],['lib/google/src/Google/Service','Drive.php',2294],['lib/google/src/Google/Service','Drive.php',2414],['completion','data_object.php',272],['lib/google/src/Google/Service','Books.php',1804],['lib/zend/Zend/Gdata','App.php',914],['lib/google/src/Google/Cache','Memcache.php',142],['lib/google/src/Google/Service','Bigquery.php',512],['lib/google/src/Google/Service','Bigquery.php',822],['cache','disabledlib.php',102],['lib/zend/Zend/Server','Cache.php',132],['lib/zend/Zend/Gdata/App','Entry.php',212],['cache/stores/memcached','lib.php',368],['lib/google/src/Google/Service','YouTube.php',1470],['lib/google/src/Google/Service','YouTube.php',1979],['lib/google/src/Google/Service','YouTube.php',2277],['lib/google/src/Google/Service','YouTube.php',2510],['lib/google/src/Google/Service','YouTube.php',2657],['lib/google/src/Google/Service','YouTube.php',2998],['lib/google/src/Google/Service','YouTube.php',3196],['lib/google/src/Google/Service','Webmasters.php',298],['lib/google/src/Google/Service','Webmasters.php',388],['lib/google/src/Google/Service','Autoscaler.php',314],['lib/google/src/Google/Service','Autoscaler.php',428],['calendar','lib.php',2388],['lib/zend/Zend/Service/Amazon','Sqs.php',129],['lib/google/src/Google/Service','ShoppingContent.php',553],['lib/google/src/Google/Service','ShoppingContent.php',735],['lib/google/src/Google/Service','ShoppingContent.php',969],['mod/lesson','locallib.php',1039],['mod/lesson','locallib.php',2274],['lib/google/src/Google/Service','SQLAdmin.php',628],['lib/google/src/Google/Service','SQLAdmin.php',923],['lib/google/src/Google/Service','Fitness.php',458],['lib/google/src/Google/Service','Fitness.php',563],['lib/google/src/Google/Service','TagManager.php',1049],['lib/google/src/Google/Service','TagManager.php',1140],['lib/google/src/Google/Service','TagManager.php',1233],['lib/google/src/Google/Service','TagManager.php',1326],['lib/google/src/Google/Service','TagManager.php',1419],['lib/google/src/Google/Service','TagManager.php',1513],['lib/google/src/Google/Service','TagManager.php',1607],['lib/google/src/Google/Service','TagManager.php',1757],['lib/google/src/Google/Service','Directory.php',1300],['lib/google/src/Google/Service','Directory.php',1477],['lib/google/src/Google/Service','Directory.php',1587],['lib/google/src/Google/Service','Directory.php',1642],['lib/google/src/Google/Service','Directory.php',1769],['lib/google/src/Google/Service','Directory.php',1838],['lib/google/src/Google/Service','Directory.php',1935],['lib/google/src/Google/Service','Directory.php',2042],['lib/google/src/Google/Service','Directory.php',2144],['lib/google/src/Google/Service','Directory.php',2205],['lib/google/src/Google/Service','Directory.php',2405],['lib/google/src/Google/Service','Directory.php',2480],['cache/stores/static','lib.php',374],['lib/google/src/Google/Service','AppState.php',153],['lib/google/src/Google/Service','Taskqueue.php',292],['lib/google/src/Google/Service','Container.php',343],['lib/google/src/Google/Service','AndroidPublisher.php',1177],['lib/google/src/Google/Service','AndroidPublisher.php',1257],['lib/google/src/Google/Service','AndroidPublisher.php',1595],['lib/google/src/Google/Service','AndroidPublisher.php',1690],['lib/google/src/Google/Service','AndroidPublisher.php',1972],['repository','lib.php',427],['repository','lib.php',2012],['lib','accesslib.php',5529],['lib/google/src/Google/Service','AdSenseHost.php',733],['lib/google/src/Google/Service','AdSenseHost.php',1009],['lib/google/src/Google/Service','AdSenseHost.php',1167],['cache/stores/memcache','lib.php',401],['lib','filelib.php',3440],['lib/google/src/Google/Service','MapsEngine.php',1692],['lib/google/src/Google/Service','MapsEngine.php',1990],['lib/google/src/Google/Service','MapsEngine.php',2343],['lib/google/src/Google/Service','MapsEngine.php',2650],['lib/google/src/Google/Service','MapsEngine.php',2911],['lib/grade','grade_grade.php',955],['comment','lib.php',786],['lib/google/src/Google/Service','SiteVerification.php',138],['lib/google/src/Google/Service','Prediction.php',261],['cache/stores/session','lib.php',417],['cache/classes','dummystore.php',198],['lib/google/src/Google/Service','Compute.php',2812],['lib/google/src/Google/Service','Compute.php',2896],['lib/google/src/Google/Service','Compute.php',3139],['lib/google/src/Google/Service','Compute.php',3225],['lib/google/src/Google/Service','Compute.php',3361],['lib/google/src/Google/Service','Compute.php',3463],['lib/google/src/Google/Service','Compute.php',3543],['lib/google/src/Google/Service','Compute.php',3662],['lib/google/src/Google/Service','Compute.php',3725],['lib/google/src/Google/Service','Compute.php',3844],['lib/google/src/Google/Service','Compute.php',3941],['lib/google/src/Google/Service','Compute.php',4080],['lib/google/src/Google/Service','Compute.php',4406],['lib/google/src/Google/Service','Compute.php',4543],['lib/google/src/Google/Service','Compute.php',4660],['lib/google/src/Google/Service','Compute.php',4740],['lib/google/src/Google/Service','Compute.php',4806],['lib/google/src/Google/Service','Compute.php',4927],['lib/google/src/Google/Service','Compute.php',5069],['lib/google/src/Google/Service','Compute.php',5229],['lib/google/src/Google/Service','Compute.php',5360],['badges/criteria','award_criteria.php',330],['badges/criteria','award_criteria_manual.php',220],['lib/google/src/Google/Service','Calendar.php',886],['lib/google/src/Google/Service','Calendar.php',1040],['lib/google/src/Google/Service','Calendar.php',1228],['lib/google/src/Google/Service','Calendar.php',1362],['lib/google/src/Google/Service','Analytics.php',2068],['lib/google/src/Google/Service','Analytics.php',2211],['lib/google/src/Google/Service','Analytics.php',2293],['lib/google/src/Google/Service','Analytics.php',2414],['lib/google/src/Google/Service','Analytics.php',2631],['lib/google/src/Google/Service','Analytics.php',2760],['lib/google/src/Google/Service','Analytics.php',2851],['lib/google/src/Google/Service','Analytics.php',3181],['lib/google/src/Google/Service','Analytics.php',3406],['lib/google/src/Google/Service','Tasks.php',309],['lib/google/src/Google/Service','Tasks.php',427],['cache/classes','loaders.php',777],['cache/classes','loaders.php',1491],['cache/classes','loaders.php',1859],['cache/stores/mongodb','lib.php',361],['lib/grade','grade_category.php',259],['cache/stores/file','lib.php',392],['lib/google/src/Google/Service','Storage.php',945],['lib/google/src/Google/Service','Storage.php',1060],['lib/google/src/Google/Service','Storage.php',1227],['lib/google/src/Google/Service','Storage.php',1349],['lib/google/src/Google/Service','Storage.php',1565],['admin/tool/uploadcourse/classes','course.php',226],['lib/google/src/Google/Cache','Null.php',51],['lib/filestorage','stored_file.php',323],['lib/filebrowser','virtual_root_file.php',69],['lib/google/src/Google/Service','AdSense.php',1257],['lib/google/src/Google/Service','AdSense.php',1729],['lib/google/src/Google/Service','Pubsub.php',239],['lib/google/src/Google/Service','Pubsub.php',378],['lib/grade','grade_scale.php',136],['lib/filebrowser','file_info.php',418],['lib/google/src/Google/Cache','File.php',106],['lib/htmlpurifier/HTMLPurifier','Zipper.php',89],['lib/google/src/Google/Service','Dns.php',370],['lib/filebrowser','file_info_stored.php',631],['lib/google/src/Google/Service','Replicapool.php',374],['lib/google/src/Google/Service','Resourceviews.php',419],['lib','badgeslib.php',620],['lib/google/src/Google/Cache','Apc.php',103],['lib/adodb','adodb-active-record.inc.php',792],['mnet','peer.php',122],['lib/grade','grade_outcome.php',97]], 260],
'get_records_select': ['get_records_select', 'Get a number of records as an array of objects which match a particular WHERE clause. ', [['lib/dml','moodle_database.php',1283]], 163],
'set_overridden': ['set_overridden', 'Set the overridden status of grade ', [['lib/grade','grade_grade.php',356]], 3],
'update': ['update', 'Update a customer resource if one it exists and is owned by the reseller. (customers.update) ', [['lib/google/src/Google/Service','Reseller.php',343],['mod/lesson/pagetypes','matching.php',308],['lib/adodb','adodb-active-recordx.inc.php',1047],['lib/grade','grade_object.php',238],['lib/google/src/Google/Service','Fusiontables.php',726],['lib/google/src/Google/Service','Fusiontables.php',889],['lib/google/src/Google/Service','Fusiontables.php',1095],['lib/google/src/Google/Service','Fusiontables.php',1269],['grade/grading/form','lib.php',905],['lib/google/src/Google/Service','Blogger.php',1332],['lib/google/src/Google/Service','Blogger.php',1630],['lib/google/src/Google/Service','Doubleclicksearch.php',325],['lib/google/src/Google/Service','AdExchangeBuyer.php',392],['lib/google/src/Google/Service','AdExchangeBuyer.php',684],['lib/grade','grade_item.php',260],['lib/google/src/Google/Service','Gmail.php',756],['lib/google/src/Google/Service','Gmail.php',908],['lib/google/src/Google/Service','Mirror.php',495],['lib/google/src/Google/Service','Mirror.php',633],['lib/google/src/Google/Service','Mirror.php',744],['lib/google/src/Google/Service','Genomics.php',690],['lib/google/src/Google/Service','Genomics.php',811],['lib/google/src/Google/Service','Genomics.php',1064],['lib/google/src/Google/Service','Genomics.php',1370],['lib/google/src/Google/Service','Genomics.php',1521],['lib/google/src/Google/Service','Dfareporting.php',570],['lib/google/src/Google/Service','PlusDomains.php',691],['lib/google/src/Google/Service','Licensing.php',332],['lib/google/src/Google/Service','Drive.php',1624],['lib/google/src/Google/Service','Drive.php',1859],['lib/google/src/Google/Service','Drive.php',2100],['lib/google/src/Google/Service','Drive.php',2211],['lib/google/src/Google/Service','Drive.php',2261],['lib/google/src/Google/Service','Drive.php',2385],['lib/google/src/Google/Service','Drive.php',2473],['completion','data_object.php',251],['lib/google/src/Google/Service','Books.php',1901],['lib/google/src/Google/Service','Bigquery.php',603],['lib/google/src/Google/Service','Bigquery.php',911],['lib/google/src/Google/Service','Groupssettings.php',137],['lib/google/src/Google/Service','YouTube.php',1596],['lib/google/src/Google/Service','YouTube.php',1697],['lib/google/src/Google/Service','YouTube.php',2201],['lib/google/src/Google/Service','YouTube.php',2439],['lib/google/src/Google/Service','YouTube.php',2613],['lib/google/src/Google/Service','YouTube.php',2809],['lib/google/src/Google/Service','YouTube.php',3419],['lib/google/src/Google/Service','Coordinate.php',568],['lib/google/src/Google/Service','Coordinate.php',680],['lib/google/src/Google/Service','Autoscaler.php',399],['calendar','lib.php',2171],['lib/google/src/Google/Service','ShoppingContent.php',633],['lib/google/src/Google/Service','ShoppingContent.php',815],['lib','weblib.php',3154],['mod/lesson','locallib.php',2682],['lib/google/src/Google/Service','SQLAdmin.php',843],['lib/google/src/Google/Service','Fitness.php',424],['lib/google/src/Google/Service','Fitness.php',607],['lib/google/src/Google/Service','TagManager.php',1004],['lib/google/src/Google/Service','TagManager.php',1093],['lib/google/src/Google/Service','TagManager.php',1186],['lib/google/src/Google/Service','TagManager.php',1279],['lib/google/src/Google/Service','TagManager.php',1372],['lib/google/src/Google/Service','TagManager.php',1466],['lib/google/src/Google/Service','TagManager.php',1560],['lib/google/src/Google/Service','TagManager.php',1711],['lib/google/src/Google/Service','TagManager.php',1804],['mod/lesson/pagetypes','truefalse.php',163],['lib/google/src/Google/Service','Directory.php',1446],['lib/google/src/Google/Service','Directory.php',1559],['lib/google/src/Google/Service','Directory.php',1724],['lib/google/src/Google/Service','Directory.php',1907],['lib/google/src/Google/Service','Directory.php',2014],['lib/google/src/Google/Service','Directory.php',2116],['lib/google/src/Google/Service','Directory.php',2337],['lib/google/src/Google/Service','Directory.php',2523],['lib/xhprof/xhprof_html/jquery','jquery.tooltip.js',200],['lib/google/src/Google/Service','AppState.php',201],['lib/google/src/Google/Service','Taskqueue.php',397],['lib/google/src/Google/Service','AndroidPublisher.php',1360],['lib/google/src/Google/Service','AndroidPublisher.php',1472],['lib/google/src/Google/Service','AndroidPublisher.php',1542],['lib/google/src/Google/Service','AndroidPublisher.php',1780],['lib/google/src/Google/Service','AndroidPublisher.php',1846],['lib/google/src/Google/Service','AndroidPublisher.php',1928],['lib/google/src/Google/Service','AndroidPublisher.php',2066],['mod/lesson/pagetypes','essay.php',158],['lib/google/src/Google/Service','AdSenseHost.php',845],['lib/google/src/Google/Service','AdSenseHost.php',1096],['lib/google/src/Google/Service','Games.php',1507],['lib/grade','grade_grade.php',940],['lib/google/src/Google/Service','SiteVerification.php',226],['lib/horde/framework/Horde/Support','Array.php',70],['lib/google/src/Google/Service','Prediction.php',338],['lib/google/src/Google/Service','Compute.php',2999],['lib/google/src/Google/Service','Compute.php',3310],['lib/google/src/Google/Service','Compute.php',3814],['lib/google/src/Google/Service','Compute.php',5314],['lib/google/src/Google/Service','Calendar.php',979],['lib/google/src/Google/Service','Calendar.php',1144],['lib/google/src/Google/Service','Calendar.php',1285],['lib/google/src/Google/Service','Calendar.php',1633],['lib/google/src/Google/Service','Analytics.php',2118],['lib/google/src/Google/Service','Analytics.php',2385],['lib/google/src/Google/Service','Analytics.php',2495],['lib/google/src/Google/Service','Analytics.php',2602],['lib/google/src/Google/Service','Analytics.php',2730],['lib/google/src/Google/Service','Analytics.php',2821],['lib/google/src/Google/Service','Analytics.php',2944],['lib/google/src/Google/Service','Analytics.php',3277],['lib/google/src/Google/Service','Analytics.php',3379],['lib/google/src/Google/Service','Analytics.php',3461],['lib/google/src/Google/Service','Tasks.php',385],['lib/google/src/Google/Service','Tasks.php',555],['lib/horde/framework/Horde/Imap/Client/Ids','Map.php',72],['grade/grading/form/guide','lib.php',826],['lib/grade','grade_category.php',204],['lib/google/src/Google/Service','Storage.php',1030],['lib/google/src/Google/Service','Storage.php',1165],['lib/google/src/Google/Service','Storage.php',1318],['lib/google/src/Google/Service','Storage.php',1454],['lib/google/src/Google/Service','Storage.php',1718],['lib/filestorage','stored_file.php',103],['grade/grading/form/rubric','lib.php',828],['lib/grade','grade_scale.php',125],['lib','coursecatlib.php',441],['lib/adodb','adodb-active-record.inc.php',878],['lib/grade','grade_outcome.php',144],['mod/lesson/pagetypes','branchtable.php',262]], 290],
'set_aggregationweight': ['set_aggregationweight', 'Set aggregationweight. ', [['lib/grade','grade_grade.php',309]], 0],
'bounded_grade': ['bounded_grade', 'Makes sure value is a valid grade value. ', [['lib/grade','grade_item.php',1354]], 18],
'fetch': ['fetch', 'Fetches the available update status from the remote site ', [['lib/classes/update','checker.php',113],['lib/minify/lib/Minify/Cache','XCache.php',86],['lib/grade','grade_object.php',126],['completion/criteria','completion_criteria_unenrol.php',43],['completion/criteria','completion_criteria_grade.php',45],['lib/grade','grade_item.php',332],['lib/minify/lib/Minify/Cache','Memcache.php',97],['lib/minify/lib/Minify/Cache','APC.php',91],['completion/criteria','completion_criteria_activity.php',45],['lib/horde/framework/Horde/Imap/Client','Base.php',2373],['completion','data_object.php',152],['completion/criteria','completion_criteria_course.php',46],['completion','completion_completion.php',70],['completion/criteria','completion_criteria_role.php',43],['completion','completion_criteria_completion.php',74],['lib/grade','grade_grade.php',576],['lib/minify/lib/Minify/Cache','ZendPlatform.php',97],['completion/criteria','completion_criteria_date.php',43],['lib/grade','grade_category.php',184],['completion/criteria','completion_criteria_self.php',43],['lib/grade','grade_scale.php',89],['lib/minify/lib/Minify/Cache','File.php',90],['completion','completion_aggregation.php',68],['completion/criteria','completion_criteria_duration.php',43],['lib/grade','grade_outcome.php',182]], 192],
'get_hidden': ['get_hidden', 'Check a grade item hidden status. ', [['lib/grade','grade_object.php',435],['lib/grade','grade_grade.php',536]], 3],
'fetch_users_grades': ['fetch_users_grades', 'Returns array of grades for given grade_item+users ', [['lib/grade','grade_grade.php',175]], 7],
'is_passed': ['is_passed', 'Returns true if the grade\'s value is superior or equal to the grade item\'s gradepass value, false otherwise. ', [['lib/grade','grade_grade.php',895]], 4],
'grade_floats_different': ['grade_floats_different', 'Compare two float numbers safely. Uses 5 decimals php precision using {@link grade_floatval()}. Nulls accepted too. Used for determining if a database update is required ', [['lib','gradelib.php',1450]], 26],
'apply_limit_rules': ['apply_limit_rules', 'Given an array of grade values (numerical indices) applies droplow or keephigh rules to limit the final array. ', [['lib/grade','grade_category.php',1564]], 12],
'load_grade_item': ['load_grade_item', 'Loads the grade_item object referenced by $this->itemid and saves it as $this->grade_item for easy access ', [['lib/grade','grade_grade.php',219],['lib/grade','grade_category.php',2051]], 52],
'or': ['or', '', [['lib/tcpdf','LICENSE.TXT',69]], 552],
'is_enabled': ['is_enabled', 'Allows hiding this plugin from the submission/feedback screen if it is not enabled. ', [['mod/assign','assignmentplugin.php',223],['lib/classes/plugininfo','orphaned.php',37],['lib','completionlib.php',269],['mod/assign/submission/comments','locallib.php',172],['mod/assign/feedback/editpdf','locallib.php',276],['lib/classes/plugininfo','base.php',371],['lib/classes/plugininfo','tool.php',39],['admin/tool/health','index.php',393],['admin/tool/log/classes/plugininfo','logstore.php',35],['lib/classes/message/inbound','manager.php',37],['lib/classes/plugininfo','mnetservice.php',33],['mod/assignment/classes/plugininfo','assignment.php',32],['lib','adminlib.php',1952],['mod/assign/feedback/offline','locallib.php',365],['lib','medialib.php',318],['lib','medialib.php',634],['lib','medialib.php',1265]], 200],
'get_aggregationweight': ['get_aggregationweight', 'Returns the weight this grade contributed to the aggregated grade ', [['lib/grade','grade_grade.php',300]], 1],
'grade_changed': ['grade_changed', 'A user grade has been updated in gradebook. ', [['availability/condition/grade/classes','callbacks.php',40]], 1],
'is_course_item': ['is_course_item', 'Is the grade item associated with course? ', [['lib/grade','grade_item.php',930]], 29],
'inform_grade_changed': ['inform_grade_changed', 'Called by grade code to inform the completion system when a grade has been changed. If the changed grade is used to determine completion for the course-module, then the completion status will be updated. ', [['lib','completionlib.php',1227]], 6],
'is_executing': ['is_executing', 'Checks whether restore is currently executing. Certain parts of code that is called during restore, but not directly part of the restore system, may need to behave differently during restore (e.g. do not bother resetting a cache because we know it will be reset at end of operation). ', [['backup/controller','restore_controller.class.php',341]], 5],
'set_locktime': ['set_locktime', 'Set the locktime for this grade item. ', [['lib/grade','grade_item.php',570],['lib/grade','grade_grade.php',474]], 4],
'fetch_all': ['fetch_all', 'Finds and returns all grade_object instances based on $params. ', [['lib/grade','grade_object.php',138],['lib/grade','grade_item.php',343],['completion/criteria','completion_criteria.php',153],['completion','data_object.php',165],['completion','completion_criteria_completion.php',84],['lib/grade','grade_grade.php',586],['lib/grade','grade_category.php',194],['lib/grade','grade_scale.php',100],['completion','completion_aggregation.php',79],['lib/grade','grade_outcome.php',193]], 65],
'get_locktime': ['get_locktime', 'Set the locktime for this grade item. ', [['lib/grade','grade_item.php',581],['lib/grade','grade_grade.php',485]], 5],
'depends_on': ['depends_on', 'Finds out on which other items does this depend directly when doing calculation or category aggregation ', [['lib/grade','grade_item.php',1392]], 12],
'get_hiding_affected': ['get_hiding_affected', 'Return array of grade item ids that are either hidden or indirectly depend on hidden grades, excluded grades are not returned. THIS IS A REALLY BIG HACK! to be replaced by conditional aggregation of hidden grades in 2.0 ', [['lib/grade','grade_grade.php',664]], 3],
'list': ['list', '', [['mod/data/preset/imagegallery','jstemplate.js',9]], 1891],
'is_hidden': ['is_hidden', 'Returns the current hidden state of this grade_item ', [['lib/grade','grade_object.php',415],['lib/grade','grade_grade.php',503],['lib','adminlib.php',709],['lib','adminlib.php',996],['lib','adminlib.php',1306],['lib','adminlib.php',1503]], 55],
'get_coursemodule_from_instance': ['get_coursemodule_from_instance', 'Given an instance number of a module, finds the coursemodule description ', [['lib','datalib.php',1331]], 365],
'get_recordset_select': ['get_recordset_select', 'Get a number of records as a moodle_recordset which match a particular WHERE clause. ', [['lib/dml','moodle_database.php',1175]], 35],
'set_aggregationstatus': ['set_aggregationstatus', 'Set aggregationstatus flag ', [['lib/grade','grade_grade.php',329]], 0],
'grade_floatval': ['grade_floatval', 'Convert a number to 5 decimal point float, an empty string or a null db compatible format (we need this to decide if db value changed) ', [['lib','gradelib.php',1434]], 53],
'is_category_item': ['is_category_item', 'Is the grade item associated with category? ', [['lib/grade','grade_item.php',921]], 28],
'refresh_grades': ['refresh_grades', 'Refetch grades from modules, plugins. ', [['lib/grade','grade_item.php',1488]], 6],
'flatten_dependencies_array': ['flatten_dependencies_array', 'Given an array like this: $a = array(1=>array(2, 3), 2=>array(4), 3=>array(1), 4=>array()) this function fully resolves the dependencies so each value will be an array of the all items this item depends on and their dependencies (and their dependencies...). It should not explode if there are circular dependencies. The dependency depth array will list the number of branches in the tree above each leaf. ', [['lib/grade','grade_grade.php',624]], 2],
'insert': ['insert', 'Creates a customer resource if one does not already exist. (customers.insert) ', [['lib/google/src/Google/Service','Reseller.php',309],['lib/google/src/Google/Service','Reseller.php',473],['lib/adodb','adodb-active-recordx.inc.php',899],['lib/grade','grade_object.php',325],['lib/google/src/Google/Service','Replicapoolupdater.php',294],['lib/google/src/Google/Service','Fusiontables.php',674],['lib/google/src/Google/Service','Fusiontables.php',838],['lib/google/src/Google/Service','Fusiontables.php',1012],['lib/google/src/Google/Service','Fusiontables.php',1217],['lib/google/src/Google/Service','Blogger.php',1243],['lib/google/src/Google/Service','Blogger.php',1493],['lib/google/src/Google/Service','Doubleclicksearch.php',285],['lib/google/src/Google/Service','AdExchangeBuyer.php',476],['lib/google/src/Google/Service','AdExchangeBuyer.php',635],['lib/google/src/Google/Service','Manager.php',271],['lib/google/src/Google/Service','Manager.php',349],['lib/grade','grade_item.php',385],['lib/google/src/Google/Service','Gmail.php',993],['lib/google/src/Google/Service','Plus.php',475],['lib/google/src/Google/Service','Mirror.php',393],['lib/google/src/Google/Service','Mirror.php',451],['lib/google/src/Google/Service','Mirror.php',605],['lib/google/src/Google/Service','Mirror.php',687],['lib/google/src/Google/Service','Mirror.php',801],['lib/google/src/Google/Service','Urlshortener.php',124],['lib/google/src/Google/Service','Dfareporting.php',499],['lib/google/src/Google/Service','PlusDomains.php',481],['lib/google/src/Google/Service','PlusDomains.php',606],['lib/google/src/Google/Service','PlusDomains.php',732],['lib/google/src/Google/Service','PlusDomains.php',781],['lib/google/src/Google/Service','GroupsMigration.php',85],['lib/google/src/Google/Service','Licensing.php',253],['lib/google/src/Google/Service','Drive.php',1491],['lib/google/src/Google/Service','Drive.php',1568],['lib/google/src/Google/Service','Drive.php',1727],['lib/google/src/Google/Service','Drive.php',1961],['lib/google/src/Google/Service','Drive.php',2045],['lib/google/src/Google/Service','Drive.php',2164],['lib/google/src/Google/Service','Drive.php',2328],['completion','data_object.php',316],['lib/google/src/Google/Service','Books.php',1835],['lib/google/src/Google/Service','Bigquery.php',548],['lib/google/src/Google/Service','Bigquery.php',672],['lib/google/src/Google/Service','Bigquery.php',856],['lib/google/src/Google/Service','YouTube.php',1323],['lib/google/src/Google/Service','YouTube.php',1423],['lib/google/src/Google/Service','YouTube.php',1498],['lib/google/src/Google/Service','YouTube.php',2025],['lib/google/src/Google/Service','YouTube.php',2323],['lib/google/src/Google/Service','YouTube.php',2525],['lib/google/src/Google/Service','YouTube.php',2685],['lib/google/src/Google/Service','YouTube.php',3013],['lib/google/src/Google/Service','YouTube.php',3254],['lib/google/src/Google/Service','Coordinate.php',491],['lib/google/src/Google/Service','Autoscaler.php',346],['lib/google/src/Google/Service','ShoppingContent.php',582],['lib/google/src/Google/Service','ShoppingContent.php',764],['lib/google/src/Google/Service','ShoppingContent.php',1000],['lib/google/src/Google/Service','SQLAdmin.php',698],['lib/google/src/Google/Service','SQLAdmin.php',959],['lib/google/src/Google/Service','Directory.php',1504],['lib/google/src/Google/Service','Directory.php',1601],['lib/google/src/Google/Service','Directory.php',1671],['lib/google/src/Google/Service','Directory.php',1964],['lib/google/src/Google/Service','Directory.php',2071],['lib/google/src/Google/Service','Directory.php',2239],['lib/google/src/Google/Service','Directory.php',2419],['lib/google/src/Google/Service','Taskqueue.php',323],['lib/google/src/Google/Service','AndroidPublisher.php',1211],['lib/google/src/Google/Service','AndroidPublisher.php',2002],['lib/google/src/Google/Service','AdSenseHost.php',786],['lib/google/src/Google/Service','AdSenseHost.php',1041],['lib/google/src/Google/Service','AdSenseHost.php',1182],['lib/google/src/Google/Service','MapsEngine.php',2780],['lib/google/src/Google/Service','MapsEngine.php',3184],['lib/grade','grade_grade.php',928],['lib/google/src/Google/Service','SiteVerification.php',180],['lib/google/src/Google/Service','Prediction.php',290],['lib/google/src/Google/Service','Compute.php',2844],['lib/google/src/Google/Service','Compute.php',2944],['lib/google/src/Google/Service','Compute.php',3171],['lib/google/src/Google/Service','Compute.php',3255],['lib/google/src/Google/Service','Compute.php',3393],['lib/google/src/Google/Service','Compute.php',3493],['lib/google/src/Google/Service','Compute.php',3573],['lib/google/src/Google/Service','Compute.php',3757],['lib/google/src/Google/Service','Compute.php',3891],['lib/google/src/Google/Service','Compute.php',3973],['lib/google/src/Google/Service','Compute.php',4165],['lib/google/src/Google/Service','Compute.php',4436],['lib/google/src/Google/Service','Compute.php',4690],['lib/google/src/Google/Service','Compute.php',4838],['lib/google/src/Google/Service','Compute.php',4959],['lib/google/src/Google/Service','Compute.php',5120],['lib/google/src/Google/Service','Compute.php',5259],['lib/google/src/Google/Service','Calendar.php',915],['lib/google/src/Google/Service','Calendar.php',1067],['lib/google/src/Google/Service','Calendar.php',1255],['lib/google/src/Google/Service','Calendar.php',1422],['lib/google/src/Google/Service','Analytics.php',2082],['lib/google/src/Google/Service','Analytics.php',2326],['lib/google/src/Google/Service','Analytics.php',2444],['lib/google/src/Google/Service','Analytics.php',2539],['lib/google/src/Google/Service','Analytics.php',2666],['lib/google/src/Google/Service','Analytics.php',2776],['lib/google/src/Google/Service','Analytics.php',2883],['lib/google/src/Google/Service','Analytics.php',3022],['lib/google/src/Google/Service','Analytics.php',3216],['lib/google/src/Google/Service','Analytics.php',3323],['lib/google/src/Google/Service','Analytics.php',3421],['lib/google/src/Google/Service','Tasks.php',336],['lib/google/src/Google/Service','Tasks.php',456],['lib/grade','grade_category.php',318],['lib/google/src/Google/Service','Storage.php',980],['lib/google/src/Google/Service','Storage.php',1100],['lib/google/src/Google/Service','Storage.php',1262],['lib/google/src/Google/Service','Storage.php',1392],['lib/google/src/Google/Service','Storage.php',1619],['lib/grade','grade_scale.php',111],['lib/google/src/Google/Service','Admin.php',87],['lib/google/src/Google/Service','Replicapool.php',434],['lib/google/src/Google/Service','Resourceviews.php',471],['lib/adodb','adodb-active-record.inc.php',742],['lib/grade','grade_outcome.php',120]], 459],
'check_locktime_all': ['check_locktime_all', 'Lock the grade if needed. Make sure this is called only when final grades are valid ', [['lib/grade','grade_grade.php',453]], 1],
'is_calculated': ['is_calculated', 'Checks if grade calculated. Returns this object\'s calculation. ', [['lib/grade','grade_item.php',1024]], 14],
'is_overridden': ['is_overridden', 'Checks if grade overridden ', [['lib/grade','grade_grade.php',281]], 12],
'get_aggregation_hint': ['get_aggregation_hint', 'Get some useful information about how this grade_grade is reflected in the aggregation for the grade_category. For example this could be an extra credit item, and it could be dropped because it\'s in the X lowest or highest. ', [['lib/grade','grade_grade.php',1041]], 2],
'notify_changed': ['notify_changed', 'Called immediately after the object data has been inserted, updated, or deleted in the database. Default does nothing, can be overridden to hook in special behaviour. ', [['lib/grade','grade_object.php',405],['lib/grade','grade_item.php',2192],['completion','data_object.php',383],['lib/grade','grade_grade.php',973]], 6],
'is_extracredit_used': ['is_extracredit_used', 'Returns true if category uses extra credit of any kind ', [['lib/grade','grade_category.php',1726]], 14],
'standardise_score': ['standardise_score', 'Given a float value situated between a source minimum and a source maximum, converts it to the corresponding value situated between a target minimum and a target maximum. Thanks to Darlene for the formula :-) ', [['lib/grade','grade_grade.php',596]], 17],
'close': ['close', 'Close the connection to the server ', [['lib/zend/Zend/Http/Client/Adapter','Socket.php',486],['lib/tests','completionlib_test.php',888],['lib/adodb','adodb.inc.php',2164],['lib/adodb','adodb.inc.php',2844],['lib/adodb','adodb.inc.php',3536],['lib','webdavlib.php',176],['admin/tool/uploaduser','locallib.php',149],['lib/dml','oci_native_moodle_recordset.php',80],['lib/tcpdf','tcpdf.php',2943],['lib/horde/framework/Horde/Imap/Client','Base.php',1846],['lib','excellib.class.php',93],['lib/zend/Zend/Http/Client/Adapter','Test.php',187],['lib/classes/dml','recordset_walk.php',153],['mod/assign/feedback/offline','importgradeslib.php',178],['lib/pear/Net','GeoIP.php',556],['backup/util/helper','backup_array_iterator.class.php',63],['lib/zend/Zend/Gdata/App','LoggingHttpClientAdapterSocket.php',109],['lib/zend/Zend/Http/Client/Adapter','Proxy.php',266],['lib/dml','mssql_native_moodle_recordset.php',87],['lib/pear/Auth','RADIUS.php',542],['lib/pear/Auth','RADIUS.php',703],['lib/pear/Auth','RADIUS.php',824],['lib/phpmailer','class.smtp.php',507],['lib/phpexcel/PHPExcel/Shared','ZipArchive.php',80],['lib/phpunit/classes','event_sink.php',39],['lib/zend/Zend/Http/Client/Adapter','Interface.php',73],['lib/dml','pgsql_native_moodle_recordset.php',104],['auth/fc','fcFPP.php',72],['lib/filestorage','zip_archive.php',183],['lib','odslib.class.php',71],['lib/horde/framework/Horde/Socket','Client.php',135],['question/engine/tests','helpers.php',1225],['grade','lib.php',323],['lib/dml','mysqli_native_moodle_recordset.php',86],['lib','csvlib.class.php',256],['lib/google/src/Google/Logger','File.php',130],['lib/horde/framework/Horde','Stream.php',585],['lib/phpunit/classes','phpmailer_sink.php',41],['lib/phpunit/classes','message_sink.php',39],['lib/zend/Zend/Http/Client/Adapter','Curl.php',460],['lib/dml','sqlsrv_native_moodle_recordset.php',133],['lib/zend/Zend/Service/WindowsAzure','SessionHandler.php',109],['backup/util/helper','backup_null_iterator.class.php',53],['grade/export','lib.php',662],['lib/dml','pdo_moodle_recordset.php',79]], 1036],
'set_hidden': ['set_hidden', 'Set a grade object hidden status ', [['lib/grade','grade_object.php',444],['lib/grade','grade_item.php',590],['lib/grade','grade_grade.php',565],['lib/grade','grade_category.php',2403]], 32],
'is_excluded': ['is_excluded', 'Checks if grade excluded from aggregation functions ', [['lib/grade','grade_grade.php',383]], 4],
'get_in_or_equal': ['get_in_or_equal', 'Constructs \'IN()\' or \'=\' sql fragment ', [['lib/dml','oci_native_moodle_database.php',1583],['lib/dml','moodle_database.php',678]], 375],
'get_course': ['get_course', 'Gets a course object from database. If the course id corresponds to an already-loaded $COURSE or $SITE object, then the loaded object will be used, saving a database query. ', [['lib','datalib.php',568],['lib','modinfolib.php',180],['lib','modinfolib.php',1439],['lib','modinfolib.php',2730],['availability/classes','info.php',70],['mod/assign','locallib.php',1256],['enrol','locallib.php',897],['course/format','lib.php',231],['mod/quiz','attemptlib.php',180],['mod/quiz','attemptlib.php',681],['admin/tool/uploadcourse/classes','processor.php',232]], 268],
'print_error': ['print_error', 'Abort execution by throwing of a general exception, default exception handler displays the error message in most cases. ', [['lib','setuplib.php',449]], 1560],
'is_editable': ['is_editable', 'Is grading object editable? ', [['lib/grade','grade_item.php',1015],['mod/workshop/form','assessment_form.php',115],['lib/grade','grade_grade.php',242],['lib/grade','grade_category.php',2303]], 6],
'is_enabled_for_site': ['is_enabled_for_site', 'Determines whether completion is enabled across entire site. ', [['lib','completionlib.php',258]], 10],
'array_key_exists': ['array_key_exists', '', [], 1539],
'array_multisort': ['array_multisort', '', [], 4],
'array_intersect': ['array_intersect', '', [], 51],
'array_merge': ['array_merge', '', [], 2320],
'count': ['count', '', [], 3984],
'class_exists': ['class_exists', '', [], 273],
'defined': ['defined', '', [], 4098],
'is_null': ['is_null', '', [], 1992],
'time': ['time', '', [], 1768],
'array_keys': ['array_keys', '', [], 1152],
'array_diff': ['array_diff', '', [], 93],
'array_unique': ['array_unique', '', [], 173],
'array_slice': ['array_slice', '', [], 169],
'sort': ['sort', '', [], 224],
'array_flip': ['array_flip', '', [], 118],
'asort': ['asort', '', [], 109]};
CLASS_DATA={
'grade_item': ['grade_item', 'Class representing a grade item. ', [['lib/grade','grade_item.php',29]], 206],
'grade_deleted': ['grade_deleted', 'Grade deleted event class. ', [['lib/classes/event','grade_deleted.php',29]], 1],
'callbacks': ['callbacks', 'Callbacks handling grade changes (to clear cache). ', [['availability/condition/grade/classes','callbacks.php',29]], 2],
'restore_controller': ['restore_controller', 'Class implementing the controller of any restore process ', [['backup/controller','restore_controller.class.php',25]], 29],
'grade_grade': ['grade_grade', 'grade_grades is an object mapped to DB table {prefix}grade_grades ', [['lib/grade','grade_grade.php',30]], 129],
'completion_info': ['completion_info', 'Class represents completion information for a course. ', [['lib','completionlib.php',210]], 119]};
CONST_DATA={
'SQL_PARAMS_NAMED': ['SQL_PARAMS_NAMED', '', [['lib/dml','moodle_database.php',32]], 271],
'GRADE_TYPE_NONE': ['GRADE_TYPE_NONE', '', [['lib/grade','constants.php',80]], 41],
'GRADE_TYPE_SCALE': ['GRADE_TYPE_SCALE', '', [['lib/grade','constants.php',90]], 63],
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',138],['','install.php',93],['lib','setup.php',386]], 3532]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu May 28 19:17:31 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
