<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /backup/moodle2/restore_qtype_plugin.class.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu May 28 19:17:31 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='backup/moodle2';
filename='restore_qtype_plugin.class.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/backup/moodle2/</a> -> <a href="restore_qtype_plugin.class.php.html">restore_qtype_plugin.class.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="restore_qtype_plugin.class.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="restore_qtype_plugin.class.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">//</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">//</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">//</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l16"><span class="linenum">  16</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l17"><span class="linenum">  17</span></a>  
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment">/**</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> * Defines restore_qtype_plugin class</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> *</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @package     core_backup</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @subpackage  moodle2</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * @category    backup</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> * @copyright   2010 onwards Eloy Lafuente (stronk7) {@link http://stronk7.com}</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment"> * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l26"><span class="linenum">  26</span></a>  <span class="comment"> */</span>
<a name="l27"><span class="linenum">  27</span></a>  
<a name="l28"><span class="linenum">  28</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die();
<a name="l29"><span class="linenum">  29</span></a>  
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment">/**</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment"> * Class extending standard restore_plugin in order to implement some</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> * helper methods related with the questions (qtype plugin)</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> *</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> * TODO: Finish phpdocs</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> */</span>
<a name="l36"><span class="linenum">  36</span></a>  abstract class restore_qtype_plugin extends restore_plugin {
<a name="l37"><span class="linenum">  37</span></a>  
<a name="l38"><span class="linenum">  38</span></a>      <span class="comment">/*</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="comment">     * A simple answer to id cache for a single questions answers.</span>
<a name="l40"><span class="linenum">  40</span></a>  <span class="comment">     * @var array</span>
<a name="l41"><span class="linenum">  41</span></a>  <span class="comment">     */</span>
<a name="l42"><span class="linenum">  42</span></a>      private <a class="var it14957" onMouseOver="hilite(14957)" onMouseOut="lolite()" onClick="logVariable('questionanswercache')" href="../../_variables/questionanswercache.html">$questionanswercache</a> = array();
<a name="l43"><span class="linenum">  43</span></a>  
<a name="l44"><span class="linenum">  44</span></a>      <span class="comment">/*</span>
<a name="l45"><span class="linenum">  45</span></a>  <span class="comment">     * The id of the current question in the questionanswercache.</span>
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment">     * @var int</span>
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment">     */</span>
<a name="l48"><span class="linenum">  48</span></a>      private <a class="var it14958" onMouseOver="hilite(14958)" onMouseOut="lolite()" onClick="logVariable('questionanswercacheid')" href="../../_variables/questionanswercacheid.html">$questionanswercacheid</a> = null;
<a name="l49"><span class="linenum">  49</span></a>  
<a name="l50"><span class="linenum">  50</span></a>      <span class="comment">/**</span>
<a name="l51"><span class="linenum">  51</span></a>  <span class="comment">     * Add to $paths the restore_path_elements needed</span>
<a name="l52"><span class="linenum">  52</span></a>  <span class="comment">     * to handle question_answers for a given question</span>
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment">     * Used by various qtypes (calculated, essay, multianswer,</span>
<a name="l54"><span class="linenum">  54</span></a>  <span class="comment">     * multichoice, numerical, shortanswer, truefalse)</span>
<a name="l55"><span class="linenum">  55</span></a>  <span class="comment">     */</span>
<a name="l56"><span class="linenum">  56</span></a>      protected function <a class="function" onClick="logFunction('add_question_question_answers')" href="../../_functions/add_question_question_answers.html" onMouseOver="funcPopup(event,'add_question_question_answers')">add_question_question_answers</a>(&amp;<a class="var it599" onMouseOver="hilite(599)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../_variables/paths.html">$paths</a>) {
<a name="l57"><span class="linenum">  57</span></a>  <span class="comment">        // Check $paths is one array</span>
<a name="l58"><span class="linenum">  58</span></a>          if (!<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it599" onMouseOver="hilite(599)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../_variables/paths.html">$paths</a>)) {
<a name="l59"><span class="linenum">  59</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('restore_step_exception')" href="../../_classes/restore_step_exception.html" onMouseOver="classPopup(event,'restore_step_exception')">restore_step_exception</a>('paths_must_be_array', <a class="var it599" onMouseOver="hilite(599)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../_variables/paths.html">$paths</a>);
<a name="l60"><span class="linenum">  60</span></a>          }
<a name="l61"><span class="linenum">  61</span></a>  
<a name="l62"><span class="linenum">  62</span></a>          <a class="var it600" onMouseOver="hilite(600)" onMouseOut="lolite()" onClick="logVariable('elename')" href="../../_variables/elename.html">$elename</a> = 'question_answer';
<a name="l63"><span class="linenum">  63</span></a>          <a class="var it601" onMouseOver="hilite(601)" onMouseOut="lolite()" onClick="logVariable('elepath')" href="../../_variables/elepath.html">$elepath</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_pathfor')" href="../../_functions/get_pathfor.html" onMouseOver="funcPopup(event,'get_pathfor')">get_pathfor</a>('/answers/answer'); <span class="comment">// we used get_recommended_name() so this works</span>
<a name="l64"><span class="linenum">  64</span></a>          <a class="var it599" onMouseOver="hilite(599)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../_variables/paths.html">$paths</a>[] = <span class="keyword">new </span><a class="class" onClick="logClass('restore_path_element')" href="../../_classes/restore_path_element.html" onMouseOver="classPopup(event,'restore_path_element')">restore_path_element</a>(<a class="var it600" onMouseOver="hilite(600)" onMouseOut="lolite()" onClick="logVariable('elename')" href="../../_variables/elename.html">$elename</a>, <a class="var it601" onMouseOver="hilite(601)" onMouseOut="lolite()" onClick="logVariable('elepath')" href="../../_variables/elepath.html">$elepath</a>);
<a name="l65"><span class="linenum">  65</span></a>      }
<a name="l66"><span class="linenum">  66</span></a>  
<a name="l67"><span class="linenum">  67</span></a>      <span class="comment">/**</span>
<a name="l68"><span class="linenum">  68</span></a>  <span class="comment">     * Add to $paths the restore_path_elements needed</span>
<a name="l69"><span class="linenum">  69</span></a>  <span class="comment">     * to handle question_numerical_units for a given question</span>
<a name="l70"><span class="linenum">  70</span></a>  <span class="comment">     * Used by various qtypes (calculated, numerical)</span>
<a name="l71"><span class="linenum">  71</span></a>  <span class="comment">     */</span>
<a name="l72"><span class="linenum">  72</span></a>      protected function <a class="function" onClick="logFunction('add_question_numerical_units')" href="../../_functions/add_question_numerical_units.html" onMouseOver="funcPopup(event,'add_question_numerical_units')">add_question_numerical_units</a>(&amp;<a class="var it599" onMouseOver="hilite(599)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../_variables/paths.html">$paths</a>) {
<a name="l73"><span class="linenum">  73</span></a>  <span class="comment">        // Check $paths is one array</span>
<a name="l74"><span class="linenum">  74</span></a>          if (!<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it599" onMouseOver="hilite(599)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../_variables/paths.html">$paths</a>)) {
<a name="l75"><span class="linenum">  75</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('restore_step_exception')" href="../../_classes/restore_step_exception.html" onMouseOver="classPopup(event,'restore_step_exception')">restore_step_exception</a>('paths_must_be_array', <a class="var it599" onMouseOver="hilite(599)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../_variables/paths.html">$paths</a>);
<a name="l76"><span class="linenum">  76</span></a>          }
<a name="l77"><span class="linenum">  77</span></a>  
<a name="l78"><span class="linenum">  78</span></a>          <a class="var it600" onMouseOver="hilite(600)" onMouseOut="lolite()" onClick="logVariable('elename')" href="../../_variables/elename.html">$elename</a> = 'question_numerical_unit';
<a name="l79"><span class="linenum">  79</span></a>          <a class="var it601" onMouseOver="hilite(601)" onMouseOut="lolite()" onClick="logVariable('elepath')" href="../../_variables/elepath.html">$elepath</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_pathfor')" href="../../_functions/get_pathfor.html" onMouseOver="funcPopup(event,'get_pathfor')">get_pathfor</a>('/numerical_units/numerical_unit'); <span class="comment">// we used get_recommended_name() so this works</span>
<a name="l80"><span class="linenum">  80</span></a>          <a class="var it599" onMouseOver="hilite(599)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../_variables/paths.html">$paths</a>[] = <span class="keyword">new </span><a class="class" onClick="logClass('restore_path_element')" href="../../_classes/restore_path_element.html" onMouseOver="classPopup(event,'restore_path_element')">restore_path_element</a>(<a class="var it600" onMouseOver="hilite(600)" onMouseOut="lolite()" onClick="logVariable('elename')" href="../../_variables/elename.html">$elename</a>, <a class="var it601" onMouseOver="hilite(601)" onMouseOut="lolite()" onClick="logVariable('elepath')" href="../../_variables/elepath.html">$elepath</a>);
<a name="l81"><span class="linenum">  81</span></a>      }
<a name="l82"><span class="linenum">  82</span></a>  
<a name="l83"><span class="linenum">  83</span></a>      <span class="comment">/**</span>
<a name="l84"><span class="linenum">  84</span></a>  <span class="comment">     * Add to $paths the restore_path_elements needed</span>
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment">     * to handle question_numerical_options for a given question</span>
<a name="l86"><span class="linenum">  86</span></a>  <span class="comment">     * Used by various qtypes (calculated, numerical)</span>
<a name="l87"><span class="linenum">  87</span></a>  <span class="comment">     */</span>
<a name="l88"><span class="linenum">  88</span></a>      protected function <a class="function" onClick="logFunction('add_question_numerical_options')" href="../../_functions/add_question_numerical_options.html" onMouseOver="funcPopup(event,'add_question_numerical_options')">add_question_numerical_options</a>(&amp;<a class="var it599" onMouseOver="hilite(599)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../_variables/paths.html">$paths</a>) {
<a name="l89"><span class="linenum">  89</span></a>  <span class="comment">        // Check $paths is one array</span>
<a name="l90"><span class="linenum">  90</span></a>          if (!<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it599" onMouseOver="hilite(599)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../_variables/paths.html">$paths</a>)) {
<a name="l91"><span class="linenum">  91</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('restore_step_exception')" href="../../_classes/restore_step_exception.html" onMouseOver="classPopup(event,'restore_step_exception')">restore_step_exception</a>('paths_must_be_array', <a class="var it599" onMouseOver="hilite(599)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../_variables/paths.html">$paths</a>);
<a name="l92"><span class="linenum">  92</span></a>          }
<a name="l93"><span class="linenum">  93</span></a>  
<a name="l94"><span class="linenum">  94</span></a>          <a class="var it600" onMouseOver="hilite(600)" onMouseOut="lolite()" onClick="logVariable('elename')" href="../../_variables/elename.html">$elename</a> = 'question_numerical_option';
<a name="l95"><span class="linenum">  95</span></a>          <a class="var it601" onMouseOver="hilite(601)" onMouseOut="lolite()" onClick="logVariable('elepath')" href="../../_variables/elepath.html">$elepath</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_pathfor')" href="../../_functions/get_pathfor.html" onMouseOver="funcPopup(event,'get_pathfor')">get_pathfor</a>('/numerical_options/numerical_option'); <span class="comment">// we used get_recommended_name() so this works</span>
<a name="l96"><span class="linenum">  96</span></a>          <a class="var it599" onMouseOver="hilite(599)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../_variables/paths.html">$paths</a>[] = <span class="keyword">new </span><a class="class" onClick="logClass('restore_path_element')" href="../../_classes/restore_path_element.html" onMouseOver="classPopup(event,'restore_path_element')">restore_path_element</a>(<a class="var it600" onMouseOver="hilite(600)" onMouseOut="lolite()" onClick="logVariable('elename')" href="../../_variables/elename.html">$elename</a>, <a class="var it601" onMouseOver="hilite(601)" onMouseOut="lolite()" onClick="logVariable('elepath')" href="../../_variables/elepath.html">$elepath</a>);
<a name="l97"><span class="linenum">  97</span></a>      }
<a name="l98"><span class="linenum">  98</span></a>  
<a name="l99"><span class="linenum">  99</span></a>      <span class="comment">/**</span>
<a name="l100"><span class="linenum"> 100</span></a>  <span class="comment">     * Add to $paths the restore_path_elements needed</span>
<a name="l101"><span class="linenum"> 101</span></a>  <span class="comment">     * to handle question_datasets (defs and items) for a given question</span>
<a name="l102"><span class="linenum"> 102</span></a>  <span class="comment">     * Used by various qtypes (calculated, numerical)</span>
<a name="l103"><span class="linenum"> 103</span></a>  <span class="comment">     */</span>
<a name="l104"><span class="linenum"> 104</span></a>      protected function <a class="function" onClick="logFunction('add_question_datasets')" href="../../_functions/add_question_datasets.html" onMouseOver="funcPopup(event,'add_question_datasets')">add_question_datasets</a>(&amp;<a class="var it599" onMouseOver="hilite(599)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../_variables/paths.html">$paths</a>) {
<a name="l105"><span class="linenum"> 105</span></a>  <span class="comment">        // Check $paths is one array</span>
<a name="l106"><span class="linenum"> 106</span></a>          if (!<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it599" onMouseOver="hilite(599)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../_variables/paths.html">$paths</a>)) {
<a name="l107"><span class="linenum"> 107</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('restore_step_exception')" href="../../_classes/restore_step_exception.html" onMouseOver="classPopup(event,'restore_step_exception')">restore_step_exception</a>('paths_must_be_array', <a class="var it599" onMouseOver="hilite(599)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../_variables/paths.html">$paths</a>);
<a name="l108"><span class="linenum"> 108</span></a>          }
<a name="l109"><span class="linenum"> 109</span></a>  
<a name="l110"><span class="linenum"> 110</span></a>          <a class="var it600" onMouseOver="hilite(600)" onMouseOut="lolite()" onClick="logVariable('elename')" href="../../_variables/elename.html">$elename</a> = 'question_dataset_definition';
<a name="l111"><span class="linenum"> 111</span></a>          <a class="var it601" onMouseOver="hilite(601)" onMouseOut="lolite()" onClick="logVariable('elepath')" href="../../_variables/elepath.html">$elepath</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_pathfor')" href="../../_functions/get_pathfor.html" onMouseOver="funcPopup(event,'get_pathfor')">get_pathfor</a>('/dataset_definitions/dataset_definition'); <span class="comment">// we used get_recommended_name() so this works</span>
<a name="l112"><span class="linenum"> 112</span></a>          <a class="var it599" onMouseOver="hilite(599)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../_variables/paths.html">$paths</a>[] = <span class="keyword">new </span><a class="class" onClick="logClass('restore_path_element')" href="../../_classes/restore_path_element.html" onMouseOver="classPopup(event,'restore_path_element')">restore_path_element</a>(<a class="var it600" onMouseOver="hilite(600)" onMouseOut="lolite()" onClick="logVariable('elename')" href="../../_variables/elename.html">$elename</a>, <a class="var it601" onMouseOver="hilite(601)" onMouseOut="lolite()" onClick="logVariable('elepath')" href="../../_variables/elepath.html">$elepath</a>);
<a name="l113"><span class="linenum"> 113</span></a>  
<a name="l114"><span class="linenum"> 114</span></a>          <a class="var it600" onMouseOver="hilite(600)" onMouseOut="lolite()" onClick="logVariable('elename')" href="../../_variables/elename.html">$elename</a> = 'question_dataset_item';
<a name="l115"><span class="linenum"> 115</span></a>          <a class="var it601" onMouseOver="hilite(601)" onMouseOut="lolite()" onClick="logVariable('elepath')" href="../../_variables/elepath.html">$elepath</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_pathfor')" href="../../_functions/get_pathfor.html" onMouseOver="funcPopup(event,'get_pathfor')">get_pathfor</a>('/dataset_definitions/dataset_definition/dataset_items/dataset_item');
<a name="l116"><span class="linenum"> 116</span></a>          <a class="var it599" onMouseOver="hilite(599)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../_variables/paths.html">$paths</a>[] = <span class="keyword">new </span><a class="class" onClick="logClass('restore_path_element')" href="../../_classes/restore_path_element.html" onMouseOver="classPopup(event,'restore_path_element')">restore_path_element</a>(<a class="var it600" onMouseOver="hilite(600)" onMouseOut="lolite()" onClick="logVariable('elename')" href="../../_variables/elename.html">$elename</a>, <a class="var it601" onMouseOver="hilite(601)" onMouseOut="lolite()" onClick="logVariable('elepath')" href="../../_variables/elepath.html">$elepath</a>);
<a name="l117"><span class="linenum"> 117</span></a>      }
<a name="l118"><span class="linenum"> 118</span></a>  
<a name="l119"><span class="linenum"> 119</span></a>      <span class="comment">/**</span>
<a name="l120"><span class="linenum"> 120</span></a>  <span class="comment">     * Processes the answer element (question answers). Common for various qtypes.</span>
<a name="l121"><span class="linenum"> 121</span></a>  <span class="comment">     * It handles both creation (if the question is being created) and mapping</span>
<a name="l122"><span class="linenum"> 122</span></a>  <span class="comment">     * (if the question already existed and is being reused)</span>
<a name="l123"><span class="linenum"> 123</span></a>  <span class="comment">     */</span>
<a name="l124"><span class="linenum"> 124</span></a>      public function <a class="function" onClick="logFunction('process_question_answer')" href="../../_functions/process_question_answer.html" onMouseOver="funcPopup(event,'process_question_answer')">process_question_answer</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>) {
<a name="l125"><span class="linenum"> 125</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l126"><span class="linenum"> 126</span></a>  
<a name="l127"><span class="linenum"> 127</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a> = (object)<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>;
<a name="l128"><span class="linenum"> 128</span></a>          <a class="var it602" onMouseOver="hilite(602)" onMouseOut="lolite()" onClick="logVariable('oldid')" href="../../_variables/oldid.html">$oldid</a> = <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('id')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l129"><span class="linenum"> 129</span></a>  
<a name="l130"><span class="linenum"> 130</span></a>  <span class="comment">        // Detect if the question is created or mapped</span>
<a name="l131"><span class="linenum"> 131</span></a>          <a class="var it2876" onMouseOver="hilite(2876)" onMouseOut="lolite()" onClick="logVariable('oldquestionid')" href="../../_variables/oldquestionid.html">$oldquestionid</a>   = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_old_parentid')" href="../../_functions/get_old_parentid.html" onMouseOver="funcPopup(event,'get_old_parentid')">get_old_parentid</a>('question');
<a name="l132"><span class="linenum"> 132</span></a>          <a class="var it2877" onMouseOver="hilite(2877)" onMouseOut="lolite()" onClick="logVariable('newquestionid')" href="../../_variables/newquestionid.html">$newquestionid</a>   = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_new_parentid')" href="../../_functions/get_new_parentid.html" onMouseOver="funcPopup(event,'get_new_parentid')">get_new_parentid</a>('question');
<a name="l133"><span class="linenum"> 133</span></a>          <a class="var it2878" onMouseOver="hilite(2878)" onMouseOut="lolite()" onClick="logVariable('questioncreated')" href="../../_variables/questioncreated.html">$questioncreated</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_mappingid')" href="../../_functions/get_mappingid.html" onMouseOver="funcPopup(event,'get_mappingid')">get_mappingid</a>('question_created', <a class="var it2876" onMouseOver="hilite(2876)" onMouseOut="lolite()" onClick="logVariable('oldquestionid')" href="../../_variables/oldquestionid.html">$oldquestionid</a>) ? true : false;
<a name="l134"><span class="linenum"> 134</span></a>  
<a name="l135"><span class="linenum"> 135</span></a>  <span class="comment">        // In the past, there were some sloppily rounded fractions around. Fix them up.</span>
<a name="l136"><span class="linenum"> 136</span></a>          <a class="var it1822" onMouseOver="hilite(1822)" onMouseOut="lolite()" onClick="logVariable('changes')" href="../../_variables/changes.html">$changes</a> = array(
<a name="l137"><span class="linenum"> 137</span></a>              '-0.66666'  =&gt; '-0.6666667',
<a name="l138"><span class="linenum"> 138</span></a>              '-0.33333'  =&gt; '-0.3333333',
<a name="l139"><span class="linenum"> 139</span></a>              '-0.16666'  =&gt; '-0.1666667',
<a name="l140"><span class="linenum"> 140</span></a>              '-0.142857' =&gt; '-0.1428571',
<a name="l141"><span class="linenum"> 141</span></a>               '0.11111'  =&gt;  '0.1111111',
<a name="l142"><span class="linenum"> 142</span></a>               '0.142857' =&gt;  '0.1428571',
<a name="l143"><span class="linenum"> 143</span></a>               '0.16666'  =&gt;  '0.1666667',
<a name="l144"><span class="linenum"> 144</span></a>               '0.33333'  =&gt;  '0.3333333',
<a name="l145"><span class="linenum"> 145</span></a>               '0.333333' =&gt;  '0.3333333',
<a name="l146"><span class="linenum"> 146</span></a>               '0.66666'  =&gt;  '0.6666667',
<a name="l147"><span class="linenum"> 147</span></a>          );
<a name="l148"><span class="linenum"> 148</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('fraction')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/fraction.html">fraction</a>, <a class="var it1822" onMouseOver="hilite(1822)" onMouseOut="lolite()" onClick="logVariable('changes')" href="../../_variables/changes.html">$changes</a>)) {
<a name="l149"><span class="linenum"> 149</span></a>              <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('fraction')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/fraction.html">fraction</a> = <a class="var it1822" onMouseOver="hilite(1822)" onMouseOut="lolite()" onClick="logVariable('changes')" href="../../_variables/changes.html">$changes</a>[<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('fraction')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/fraction.html">fraction</a>];
<a name="l150"><span class="linenum"> 150</span></a>          }
<a name="l151"><span class="linenum"> 151</span></a>  
<a name="l152"><span class="linenum"> 152</span></a>  <span class="comment">        // If the question has been created by restore, we need to create its question_answers too</span>
<a name="l153"><span class="linenum"> 153</span></a>          if (<a class="var it2878" onMouseOver="hilite(2878)" onMouseOut="lolite()" onClick="logVariable('questioncreated')" href="../../_variables/questioncreated.html">$questioncreated</a>) {
<a name="l154"><span class="linenum"> 154</span></a>  <span class="comment">            // Adjust some columns</span>
<a name="l155"><span class="linenum"> 155</span></a>              <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('question')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/question.html">question</a> = <a class="var it2877" onMouseOver="hilite(2877)" onMouseOut="lolite()" onClick="logVariable('newquestionid')" href="../../_variables/newquestionid.html">$newquestionid</a>;
<a name="l156"><span class="linenum"> 156</span></a>              <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('answer')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/answer.html">answer</a> = <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('answertext')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/answertext.html">answertext</a>;
<a name="l157"><span class="linenum"> 157</span></a>  <span class="comment">            // Insert record</span>
<a name="l158"><span class="linenum"> 158</span></a>              <a class="var it190" onMouseOver="hilite(190)" onMouseOut="lolite()" onClick="logVariable('newitemid')" href="../../_variables/newitemid.html">$newitemid</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('question_answers', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>);
<a name="l159"><span class="linenum"> 159</span></a>  
<a name="l160"><span class="linenum"> 160</span></a>  <span class="comment">        // The question existed, we need to map the existing question_answers</span>
<a name="l161"><span class="linenum"> 161</span></a>          } else {
<a name="l162"><span class="linenum"> 162</span></a>  <span class="comment">            // Have we cached the current question?</span>
<a name="l163"><span class="linenum"> 163</span></a>              if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('questionanswercacheid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/questionanswercacheid.html">questionanswercacheid</a> !== <a class="var it2877" onMouseOver="hilite(2877)" onMouseOut="lolite()" onClick="logVariable('newquestionid')" href="../../_variables/newquestionid.html">$newquestionid</a>) {
<a name="l164"><span class="linenum"> 164</span></a>  <span class="comment">                // The question changed, purge and start again!</span>
<a name="l165"><span class="linenum"> 165</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('questionanswercache')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/questionanswercache.html">questionanswercache</a> = array();
<a name="l166"><span class="linenum"> 166</span></a>                  <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('question' =&gt; <a class="var it2877" onMouseOver="hilite(2877)" onMouseOut="lolite()" onClick="logVariable('newquestionid')" href="../../_variables/newquestionid.html">$newquestionid</a>);
<a name="l167"><span class="linenum"> 167</span></a>                  <a class="var it489" onMouseOver="hilite(489)" onMouseOut="lolite()" onClick="logVariable('answers')" href="../../_variables/answers.html">$answers</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('question_answers', <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, '', 'id, answer');
<a name="l168"><span class="linenum"> 168</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('questionanswercacheid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/questionanswercacheid.html">questionanswercacheid</a> = <a class="var it2877" onMouseOver="hilite(2877)" onMouseOut="lolite()" onClick="logVariable('newquestionid')" href="../../_variables/newquestionid.html">$newquestionid</a>;
<a name="l169"><span class="linenum"> 169</span></a>  <span class="comment">                // Cache all cleaned answers for a simple text match.</span>
<a name="l170"><span class="linenum"> 170</span></a>                  foreach (<a class="var it489" onMouseOver="hilite(489)" onMouseOut="lolite()" onClick="logVariable('answers')" href="../../_variables/answers.html">$answers</a> as <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../_variables/answer.html">$answer</a>) {
<a name="l171"><span class="linenum"> 171</span></a>  <span class="comment">                    // MDL-30018: Clean in the same way as {@link xml_writer::xml_safe_utf8()}.</span>
<a name="l172"><span class="linenum"> 172</span></a>                      <a class="var it1893" onMouseOver="hilite(1893)" onMouseOut="lolite()" onClick="logVariable('clean')" href="../../_variables/clean.html">$clean</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/[\x-\x8\xb-\xc\xe-\x1f\x7f]/is','', <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../_variables/answer.html">$answer</a>-&gt;<a onClick="logVariable('answer')" class="var it39604" onMouseOver="hilite(39604)" onMouseOut="lolite()" href="../../_variables/answer.html">answer</a>); <span class="comment">// Clean CTRL chars.</span>
<a name="l173"><span class="linenum"> 173</span></a>                      <a class="var it1893" onMouseOver="hilite(1893)" onMouseOut="lolite()" onClick="logVariable('clean')" href="../../_variables/clean.html">$clean</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>(&quot;/\r\n|\r/&quot;, &quot;\n&quot;, <a class="var it1893" onMouseOver="hilite(1893)" onMouseOut="lolite()" onClick="logVariable('clean')" href="../../_variables/clean.html">$clean</a>); <span class="comment">// Normalize line ending.</span>
<a name="l174"><span class="linenum"> 174</span></a>                      <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('questionanswercache')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/questionanswercache.html">questionanswercache</a>[<a class="var it1893" onMouseOver="hilite(1893)" onMouseOut="lolite()" onClick="logVariable('clean')" href="../../_variables/clean.html">$clean</a>] = <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../_variables/answer.html">$answer</a>-&gt;<a onClick="logVariable('id')" class="var it39604" onMouseOver="hilite(39604)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l175"><span class="linenum"> 175</span></a>                  }
<a name="l176"><span class="linenum"> 176</span></a>              }
<a name="l177"><span class="linenum"> 177</span></a>  
<a name="l178"><span class="linenum"> 178</span></a>              if (!isset(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('questionanswercache')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/questionanswercache.html">questionanswercache</a>[<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('answertext')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/answertext.html">answertext</a>])) {
<a name="l179"><span class="linenum"> 179</span></a>  <span class="comment">                // If we haven't found the matching answer, something has gone really wrong, the question in the DB</span>
<a name="l180"><span class="linenum"> 180</span></a>  <span class="comment">                // is missing answers, throw an exception.</span>
<a name="l181"><span class="linenum"> 181</span></a>                  <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a> = new stdClass();
<a name="l182"><span class="linenum"> 182</span></a>                  <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>-&gt;<a onClick="logVariable('filequestionid')" class="var it39470" onMouseOver="hilite(39470)" onMouseOut="lolite()" href="../../_variables/filequestionid.html">filequestionid</a> = <a class="var it2876" onMouseOver="hilite(2876)" onMouseOut="lolite()" onClick="logVariable('oldquestionid')" href="../../_variables/oldquestionid.html">$oldquestionid</a>;
<a name="l183"><span class="linenum"> 183</span></a>                  <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>-&gt;<a onClick="logVariable('dbquestionid')" class="var it39470" onMouseOver="hilite(39470)" onMouseOut="lolite()" href="../../_variables/dbquestionid.html">dbquestionid</a>   = <a class="var it2877" onMouseOver="hilite(2877)" onMouseOut="lolite()" onClick="logVariable('newquestionid')" href="../../_variables/newquestionid.html">$newquestionid</a>;
<a name="l184"><span class="linenum"> 184</span></a>                  <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>-&gt;<a onClick="logVariable('answer')" class="var it39470" onMouseOver="hilite(39470)" onMouseOut="lolite()" href="../../_variables/answer.html">answer</a>         = <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('answertext')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/answertext.html">answertext</a>;
<a name="l185"><span class="linenum"> 185</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('restore_step_exception')" href="../../_classes/restore_step_exception.html" onMouseOver="classPopup(event,'restore_step_exception')">restore_step_exception</a>('error_question_answers_missing_in_db', <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>);
<a name="l186"><span class="linenum"> 186</span></a>              }
<a name="l187"><span class="linenum"> 187</span></a>              <a class="var it190" onMouseOver="hilite(190)" onMouseOut="lolite()" onClick="logVariable('newitemid')" href="../../_variables/newitemid.html">$newitemid</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('questionanswercache')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../_variables/questionanswercache.html">questionanswercache</a>[<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('answertext')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/answertext.html">answertext</a>];
<a name="l188"><span class="linenum"> 188</span></a>          }
<a name="l189"><span class="linenum"> 189</span></a>  <span class="comment">        // Create mapping (we'll use this intensively when restoring question_states. And also answerfeedback files)</span>
<a name="l190"><span class="linenum"> 190</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('set_mapping')" href="../../_functions/set_mapping.html" onMouseOver="funcPopup(event,'set_mapping')">set_mapping</a>('question_answer', <a class="var it602" onMouseOver="hilite(602)" onMouseOut="lolite()" onClick="logVariable('oldid')" href="../../_variables/oldid.html">$oldid</a>, <a class="var it190" onMouseOver="hilite(190)" onMouseOut="lolite()" onClick="logVariable('newitemid')" href="../../_variables/newitemid.html">$newitemid</a>);
<a name="l191"><span class="linenum"> 191</span></a>      }
<a name="l192"><span class="linenum"> 192</span></a>  
<a name="l193"><span class="linenum"> 193</span></a>      <span class="comment">/**</span>
<a name="l194"><span class="linenum"> 194</span></a>  <span class="comment">     * Processes the numerical_unit element (question numerical units). Common for various qtypes.</span>
<a name="l195"><span class="linenum"> 195</span></a>  <span class="comment">     * It handles both creation (if the question is being created) and mapping</span>
<a name="l196"><span class="linenum"> 196</span></a>  <span class="comment">     * (if the question already existed and is being reused)</span>
<a name="l197"><span class="linenum"> 197</span></a>  <span class="comment">     */</span>
<a name="l198"><span class="linenum"> 198</span></a>      public function <a class="function" onClick="logFunction('process_question_numerical_unit')" href="../../_functions/process_question_numerical_unit.html" onMouseOver="funcPopup(event,'process_question_numerical_unit')">process_question_numerical_unit</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>) {
<a name="l199"><span class="linenum"> 199</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l200"><span class="linenum"> 200</span></a>  
<a name="l201"><span class="linenum"> 201</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a> = (object)<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>;
<a name="l202"><span class="linenum"> 202</span></a>          <a class="var it602" onMouseOver="hilite(602)" onMouseOut="lolite()" onClick="logVariable('oldid')" href="../../_variables/oldid.html">$oldid</a> = <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('id')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l203"><span class="linenum"> 203</span></a>  
<a name="l204"><span class="linenum"> 204</span></a>  <span class="comment">        // Detect if the question is created or mapped</span>
<a name="l205"><span class="linenum"> 205</span></a>          <a class="var it2876" onMouseOver="hilite(2876)" onMouseOut="lolite()" onClick="logVariable('oldquestionid')" href="../../_variables/oldquestionid.html">$oldquestionid</a>   = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_old_parentid')" href="../../_functions/get_old_parentid.html" onMouseOver="funcPopup(event,'get_old_parentid')">get_old_parentid</a>('question');
<a name="l206"><span class="linenum"> 206</span></a>          <a class="var it2877" onMouseOver="hilite(2877)" onMouseOut="lolite()" onClick="logVariable('newquestionid')" href="../../_variables/newquestionid.html">$newquestionid</a>   = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_new_parentid')" href="../../_functions/get_new_parentid.html" onMouseOver="funcPopup(event,'get_new_parentid')">get_new_parentid</a>('question');
<a name="l207"><span class="linenum"> 207</span></a>          <a class="var it2878" onMouseOver="hilite(2878)" onMouseOut="lolite()" onClick="logVariable('questioncreated')" href="../../_variables/questioncreated.html">$questioncreated</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_mappingid')" href="../../_functions/get_mappingid.html" onMouseOver="funcPopup(event,'get_mappingid')">get_mappingid</a>('question_created', <a class="var it2876" onMouseOver="hilite(2876)" onMouseOut="lolite()" onClick="logVariable('oldquestionid')" href="../../_variables/oldquestionid.html">$oldquestionid</a>) ? true : false;
<a name="l208"><span class="linenum"> 208</span></a>  
<a name="l209"><span class="linenum"> 209</span></a>  <span class="comment">        // If the question has been created by restore, we need to create its question_numerical_units too</span>
<a name="l210"><span class="linenum"> 210</span></a>          if (<a class="var it2878" onMouseOver="hilite(2878)" onMouseOut="lolite()" onClick="logVariable('questioncreated')" href="../../_variables/questioncreated.html">$questioncreated</a>) {
<a name="l211"><span class="linenum"> 211</span></a>  <span class="comment">            // Adjust some columns</span>
<a name="l212"><span class="linenum"> 212</span></a>              <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('question')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/question.html">question</a> = <a class="var it2877" onMouseOver="hilite(2877)" onMouseOut="lolite()" onClick="logVariable('newquestionid')" href="../../_variables/newquestionid.html">$newquestionid</a>;
<a name="l213"><span class="linenum"> 213</span></a>  <span class="comment">            // Insert record</span>
<a name="l214"><span class="linenum"> 214</span></a>              <a class="var it190" onMouseOver="hilite(190)" onMouseOut="lolite()" onClick="logVariable('newitemid')" href="../../_variables/newitemid.html">$newitemid</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('question_numerical_units', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>);
<a name="l215"><span class="linenum"> 215</span></a>          }
<a name="l216"><span class="linenum"> 216</span></a>      }
<a name="l217"><span class="linenum"> 217</span></a>  
<a name="l218"><span class="linenum"> 218</span></a>      <span class="comment">/**</span>
<a name="l219"><span class="linenum"> 219</span></a>  <span class="comment">     * Processes the numerical_option element (question numerical options). Common for various qtypes.</span>
<a name="l220"><span class="linenum"> 220</span></a>  <span class="comment">     * It handles both creation (if the question is being created) and mapping</span>
<a name="l221"><span class="linenum"> 221</span></a>  <span class="comment">     * (if the question already existed and is being reused)</span>
<a name="l222"><span class="linenum"> 222</span></a>  <span class="comment">     */</span>
<a name="l223"><span class="linenum"> 223</span></a>      public function <a class="function" onClick="logFunction('process_question_numerical_option')" href="../../_functions/process_question_numerical_option.html" onMouseOver="funcPopup(event,'process_question_numerical_option')">process_question_numerical_option</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>) {
<a name="l224"><span class="linenum"> 224</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l225"><span class="linenum"> 225</span></a>  
<a name="l226"><span class="linenum"> 226</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a> = (object)<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>;
<a name="l227"><span class="linenum"> 227</span></a>          <a class="var it602" onMouseOver="hilite(602)" onMouseOut="lolite()" onClick="logVariable('oldid')" href="../../_variables/oldid.html">$oldid</a> = <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('id')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l228"><span class="linenum"> 228</span></a>  
<a name="l229"><span class="linenum"> 229</span></a>  <span class="comment">        // Detect if the question is created or mapped</span>
<a name="l230"><span class="linenum"> 230</span></a>          <a class="var it2876" onMouseOver="hilite(2876)" onMouseOut="lolite()" onClick="logVariable('oldquestionid')" href="../../_variables/oldquestionid.html">$oldquestionid</a>   = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_old_parentid')" href="../../_functions/get_old_parentid.html" onMouseOver="funcPopup(event,'get_old_parentid')">get_old_parentid</a>('question');
<a name="l231"><span class="linenum"> 231</span></a>          <a class="var it2877" onMouseOver="hilite(2877)" onMouseOut="lolite()" onClick="logVariable('newquestionid')" href="../../_variables/newquestionid.html">$newquestionid</a>   = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_new_parentid')" href="../../_functions/get_new_parentid.html" onMouseOver="funcPopup(event,'get_new_parentid')">get_new_parentid</a>('question');
<a name="l232"><span class="linenum"> 232</span></a>          <a class="var it2878" onMouseOver="hilite(2878)" onMouseOut="lolite()" onClick="logVariable('questioncreated')" href="../../_variables/questioncreated.html">$questioncreated</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_mappingid')" href="../../_functions/get_mappingid.html" onMouseOver="funcPopup(event,'get_mappingid')">get_mappingid</a>('question_created', <a class="var it2876" onMouseOver="hilite(2876)" onMouseOut="lolite()" onClick="logVariable('oldquestionid')" href="../../_variables/oldquestionid.html">$oldquestionid</a>) ? true : false;
<a name="l233"><span class="linenum"> 233</span></a>  
<a name="l234"><span class="linenum"> 234</span></a>  <span class="comment">        // If the question has been created by restore, we need to create its question_numerical_options too</span>
<a name="l235"><span class="linenum"> 235</span></a>          if (<a class="var it2878" onMouseOver="hilite(2878)" onMouseOut="lolite()" onClick="logVariable('questioncreated')" href="../../_variables/questioncreated.html">$questioncreated</a>) {
<a name="l236"><span class="linenum"> 236</span></a>  <span class="comment">            // Adjust some columns</span>
<a name="l237"><span class="linenum"> 237</span></a>              <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('question')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/question.html">question</a> = <a class="var it2877" onMouseOver="hilite(2877)" onMouseOut="lolite()" onClick="logVariable('newquestionid')" href="../../_variables/newquestionid.html">$newquestionid</a>;
<a name="l238"><span class="linenum"> 238</span></a>  <span class="comment">            // Insert record</span>
<a name="l239"><span class="linenum"> 239</span></a>              <a class="var it190" onMouseOver="hilite(190)" onMouseOut="lolite()" onClick="logVariable('newitemid')" href="../../_variables/newitemid.html">$newitemid</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('question_numerical_options', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>);
<a name="l240"><span class="linenum"> 240</span></a>  <span class="comment">            // Create mapping (not needed, no files nor childs nor states here)</span>
<a name="l241"><span class="linenum"> 241</span></a>  <span class="comment">            //$this-&gt;set_mapping('question_numerical_option', $oldid, $newitemid);</span>
<a name="l242"><span class="linenum"> 242</span></a>          }
<a name="l243"><span class="linenum"> 243</span></a>      }
<a name="l244"><span class="linenum"> 244</span></a>  
<a name="l245"><span class="linenum"> 245</span></a>      <span class="comment">/**</span>
<a name="l246"><span class="linenum"> 246</span></a>  <span class="comment">     * Processes the dataset_definition element (question dataset definitions). Common for various qtypes.</span>
<a name="l247"><span class="linenum"> 247</span></a>  <span class="comment">     * It handles both creation (if the question is being created) and mapping</span>
<a name="l248"><span class="linenum"> 248</span></a>  <span class="comment">     * (if the question already existed and is being reused)</span>
<a name="l249"><span class="linenum"> 249</span></a>  <span class="comment">     */</span>
<a name="l250"><span class="linenum"> 250</span></a>      public function <a class="function" onClick="logFunction('process_question_dataset_definition')" href="../../_functions/process_question_dataset_definition.html" onMouseOver="funcPopup(event,'process_question_dataset_definition')">process_question_dataset_definition</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>) {
<a name="l251"><span class="linenum"> 251</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l252"><span class="linenum"> 252</span></a>  
<a name="l253"><span class="linenum"> 253</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a> = (object)<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>;
<a name="l254"><span class="linenum"> 254</span></a>          <a class="var it602" onMouseOver="hilite(602)" onMouseOut="lolite()" onClick="logVariable('oldid')" href="../../_variables/oldid.html">$oldid</a> = <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('id')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l255"><span class="linenum"> 255</span></a>  
<a name="l256"><span class="linenum"> 256</span></a>  <span class="comment">        // Detect if the question is created or mapped</span>
<a name="l257"><span class="linenum"> 257</span></a>          <a class="var it2876" onMouseOver="hilite(2876)" onMouseOut="lolite()" onClick="logVariable('oldquestionid')" href="../../_variables/oldquestionid.html">$oldquestionid</a>   = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_old_parentid')" href="../../_functions/get_old_parentid.html" onMouseOver="funcPopup(event,'get_old_parentid')">get_old_parentid</a>('question');
<a name="l258"><span class="linenum"> 258</span></a>          <a class="var it2877" onMouseOver="hilite(2877)" onMouseOut="lolite()" onClick="logVariable('newquestionid')" href="../../_variables/newquestionid.html">$newquestionid</a>   = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_new_parentid')" href="../../_functions/get_new_parentid.html" onMouseOver="funcPopup(event,'get_new_parentid')">get_new_parentid</a>('question');
<a name="l259"><span class="linenum"> 259</span></a>          <a class="var it2878" onMouseOver="hilite(2878)" onMouseOut="lolite()" onClick="logVariable('questioncreated')" href="../../_variables/questioncreated.html">$questioncreated</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_mappingid')" href="../../_functions/get_mappingid.html" onMouseOver="funcPopup(event,'get_mappingid')">get_mappingid</a>('question_created', <a class="var it2876" onMouseOver="hilite(2876)" onMouseOut="lolite()" onClick="logVariable('oldquestionid')" href="../../_variables/oldquestionid.html">$oldquestionid</a>) ? true : false;
<a name="l260"><span class="linenum"> 260</span></a>  
<a name="l261"><span class="linenum"> 261</span></a>  <span class="comment">        // If the question is mapped, nothing to do</span>
<a name="l262"><span class="linenum"> 262</span></a>          if (!<a class="var it2878" onMouseOver="hilite(2878)" onMouseOut="lolite()" onClick="logVariable('questioncreated')" href="../../_variables/questioncreated.html">$questioncreated</a>) {
<a name="l263"><span class="linenum"> 263</span></a>              return;
<a name="l264"><span class="linenum"> 264</span></a>          }
<a name="l265"><span class="linenum"> 265</span></a>  
<a name="l266"><span class="linenum"> 266</span></a>  <span class="comment">        // Arrived here, let's see if the question_dataset_definition already exists in category or no</span>
<a name="l267"><span class="linenum"> 267</span></a>  <span class="comment">        // (by category, name, type and enough items). Only for &quot;shared&quot; definitions (category != 0).</span>
<a name="l268"><span class="linenum"> 268</span></a>  <span class="comment">        // If exists, reuse it, else, create it as &quot;not shared&quot; (category = 0)</span>
<a name="l269"><span class="linenum"> 269</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('category')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/category.html">category</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_mappingid')" href="../../_functions/get_mappingid.html" onMouseOver="funcPopup(event,'get_mappingid')">get_mappingid</a>('question_category', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('category')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/category.html">category</a>);
<a name="l270"><span class="linenum"> 270</span></a>  <span class="comment">        // If category is shared, look for definitions</span>
<a name="l271"><span class="linenum"> 271</span></a>          <a class="var it14961" onMouseOver="hilite(14961)" onMouseOut="lolite()" onClick="logVariable('founddefid')" href="../../_variables/founddefid.html">$founddefid</a> = null;
<a name="l272"><span class="linenum"> 272</span></a>          if (<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('category')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/category.html">category</a>) {
<a name="l273"><span class="linenum"> 273</span></a>              <a class="var it14962" onMouseOver="hilite(14962)" onMouseOut="lolite()" onClick="logVariable('candidatedefs')" href="../../_variables/candidatedefs.html">$candidatedefs</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(&quot;SELECT id, itemcount
<a name="l274"><span class="linenum"> 274</span></a>                                                       FROM {question_dataset_definitions}
<a name="l275"><span class="linenum"> 275</span></a>                                                      WHERE category = ?
<a name="l276"><span class="linenum"> 276</span></a>                                                        AND name = ?
<a name="l277"><span class="linenum"> 277</span></a>                                                        AND type = ?&quot;, array(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('category')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/category.html">category</a>, <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('name')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>, <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('type')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/type.html">type</a>));
<a name="l278"><span class="linenum"> 278</span></a>              foreach (<a class="var it14962" onMouseOver="hilite(14962)" onMouseOut="lolite()" onClick="logVariable('candidatedefs')" href="../../_variables/candidatedefs.html">$candidatedefs</a> as <a class="var it14963" onMouseOver="hilite(14963)" onMouseOut="lolite()" onClick="logVariable('candidatedef')" href="../../_variables/candidatedef.html">$candidatedef</a>) {
<a name="l279"><span class="linenum"> 279</span></a>                  if (<a class="var it14963" onMouseOver="hilite(14963)" onMouseOut="lolite()" onClick="logVariable('candidatedef')" href="../../_variables/candidatedef.html">$candidatedef</a>-&gt;<a onClick="logVariable('itemcount')" class="var it41352" onMouseOver="hilite(41352)" onMouseOut="lolite()" href="../../_variables/itemcount.html">itemcount</a> &gt;= <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('itemcount')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/itemcount.html">itemcount</a>) { // Check it has enough items
<a name="l280"><span class="linenum"> 280</span></a>                      <a class="var it14961" onMouseOver="hilite(14961)" onMouseOut="lolite()" onClick="logVariable('founddefid')" href="../../_variables/founddefid.html">$founddefid</a> = <a class="var it14963" onMouseOver="hilite(14963)" onMouseOut="lolite()" onClick="logVariable('candidatedef')" href="../../_variables/candidatedef.html">$candidatedef</a>-&gt;<a onClick="logVariable('id')" class="var it41352" onMouseOver="hilite(41352)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l281"><span class="linenum"> 281</span></a>                      break; <span class="comment">// end loop, shared definition match found</span>
<a name="l282"><span class="linenum"> 282</span></a>                  }
<a name="l283"><span class="linenum"> 283</span></a>              }
<a name="l284"><span class="linenum"> 284</span></a>  <span class="comment">            // If there were candidates but none fulfilled the itemcount condition, create definition as not shared</span>
<a name="l285"><span class="linenum"> 285</span></a>              if (<a class="var it14962" onMouseOver="hilite(14962)" onMouseOut="lolite()" onClick="logVariable('candidatedefs')" href="../../_variables/candidatedefs.html">$candidatedefs</a> &amp;&amp; !<a class="var it14961" onMouseOver="hilite(14961)" onMouseOut="lolite()" onClick="logVariable('founddefid')" href="../../_variables/founddefid.html">$founddefid</a>) {
<a name="l286"><span class="linenum"> 286</span></a>                  <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('category')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/category.html">category</a> = 0;
<a name="l287"><span class="linenum"> 287</span></a>              }
<a name="l288"><span class="linenum"> 288</span></a>          }
<a name="l289"><span class="linenum"> 289</span></a>  <span class="comment">        // If haven't found any shared definition match, let's create it</span>
<a name="l290"><span class="linenum"> 290</span></a>          if (!<a class="var it14961" onMouseOver="hilite(14961)" onMouseOut="lolite()" onClick="logVariable('founddefid')" href="../../_variables/founddefid.html">$founddefid</a>) {
<a name="l291"><span class="linenum"> 291</span></a>              <a class="var it190" onMouseOver="hilite(190)" onMouseOut="lolite()" onClick="logVariable('newitemid')" href="../../_variables/newitemid.html">$newitemid</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('question_dataset_definitions', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>);
<a name="l292"><span class="linenum"> 292</span></a>  <span class="comment">            // Set mapping, so dataset items will know if they must be created</span>
<a name="l293"><span class="linenum"> 293</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('set_mapping')" href="../../_functions/set_mapping.html" onMouseOver="funcPopup(event,'set_mapping')">set_mapping</a>('question_dataset_definition', <a class="var it602" onMouseOver="hilite(602)" onMouseOut="lolite()" onClick="logVariable('oldid')" href="../../_variables/oldid.html">$oldid</a>, <a class="var it190" onMouseOver="hilite(190)" onMouseOut="lolite()" onClick="logVariable('newitemid')" href="../../_variables/newitemid.html">$newitemid</a>);
<a name="l294"><span class="linenum"> 294</span></a>  
<a name="l295"><span class="linenum"> 295</span></a>  <span class="comment">        // If we have found one shared definition match, use it</span>
<a name="l296"><span class="linenum"> 296</span></a>          } else {
<a name="l297"><span class="linenum"> 297</span></a>              <a class="var it190" onMouseOver="hilite(190)" onMouseOut="lolite()" onClick="logVariable('newitemid')" href="../../_variables/newitemid.html">$newitemid</a> = <a class="var it14961" onMouseOver="hilite(14961)" onMouseOut="lolite()" onClick="logVariable('founddefid')" href="../../_variables/founddefid.html">$founddefid</a>;
<a name="l298"><span class="linenum"> 298</span></a>  <span class="comment">            // Set mapping to 0, so dataset items will know they don't need to be created</span>
<a name="l299"><span class="linenum"> 299</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('set_mapping')" href="../../_functions/set_mapping.html" onMouseOver="funcPopup(event,'set_mapping')">set_mapping</a>('question_dataset_definition', <a class="var it602" onMouseOver="hilite(602)" onMouseOut="lolite()" onClick="logVariable('oldid')" href="../../_variables/oldid.html">$oldid</a>, 0);
<a name="l300"><span class="linenum"> 300</span></a>          }
<a name="l301"><span class="linenum"> 301</span></a>  
<a name="l302"><span class="linenum"> 302</span></a>  <span class="comment">        // Arrived here, we have one $newitemid (create or reused). Create the question_datasets record</span>
<a name="l303"><span class="linenum"> 303</span></a>          <a class="var it14964" onMouseOver="hilite(14964)" onMouseOut="lolite()" onClick="logVariable('questiondataset')" href="../../_variables/questiondataset.html">$questiondataset</a> = new stdClass();
<a name="l304"><span class="linenum"> 304</span></a>          <a class="var it14964" onMouseOver="hilite(14964)" onMouseOut="lolite()" onClick="logVariable('questiondataset')" href="../../_variables/questiondataset.html">$questiondataset</a>-&gt;<a onClick="logVariable('question')" class="var it39863" onMouseOver="hilite(39863)" onMouseOut="lolite()" href="../../_variables/question.html">question</a> = <a class="var it2877" onMouseOver="hilite(2877)" onMouseOut="lolite()" onClick="logVariable('newquestionid')" href="../../_variables/newquestionid.html">$newquestionid</a>;
<a name="l305"><span class="linenum"> 305</span></a>          <a class="var it14964" onMouseOver="hilite(14964)" onMouseOut="lolite()" onClick="logVariable('questiondataset')" href="../../_variables/questiondataset.html">$questiondataset</a>-&gt;<a onClick="logVariable('datasetdefinition')" class="var it39863" onMouseOver="hilite(39863)" onMouseOut="lolite()" href="../../_variables/datasetdefinition.html">datasetdefinition</a> = <a class="var it190" onMouseOver="hilite(190)" onMouseOut="lolite()" onClick="logVariable('newitemid')" href="../../_variables/newitemid.html">$newitemid</a>;
<a name="l306"><span class="linenum"> 306</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('question_datasets', <a class="var it14964" onMouseOver="hilite(14964)" onMouseOut="lolite()" onClick="logVariable('questiondataset')" href="../../_variables/questiondataset.html">$questiondataset</a>);
<a name="l307"><span class="linenum"> 307</span></a>      }
<a name="l308"><span class="linenum"> 308</span></a>  
<a name="l309"><span class="linenum"> 309</span></a>      <span class="comment">/**</span>
<a name="l310"><span class="linenum"> 310</span></a>  <span class="comment">     * Processes the dataset_item element (question dataset items). Common for various qtypes.</span>
<a name="l311"><span class="linenum"> 311</span></a>  <span class="comment">     * It handles both creation (if the question is being created) and mapping</span>
<a name="l312"><span class="linenum"> 312</span></a>  <span class="comment">     * (if the question already existed and is being reused)</span>
<a name="l313"><span class="linenum"> 313</span></a>  <span class="comment">     */</span>
<a name="l314"><span class="linenum"> 314</span></a>      public function <a class="function" onClick="logFunction('process_question_dataset_item')" href="../../_functions/process_question_dataset_item.html" onMouseOver="funcPopup(event,'process_question_dataset_item')">process_question_dataset_item</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>) {
<a name="l315"><span class="linenum"> 315</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l316"><span class="linenum"> 316</span></a>  
<a name="l317"><span class="linenum"> 317</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a> = (object)<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>;
<a name="l318"><span class="linenum"> 318</span></a>          <a class="var it602" onMouseOver="hilite(602)" onMouseOut="lolite()" onClick="logVariable('oldid')" href="../../_variables/oldid.html">$oldid</a> = <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('id')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l319"><span class="linenum"> 319</span></a>  
<a name="l320"><span class="linenum"> 320</span></a>  <span class="comment">        // Detect if the question is created or mapped</span>
<a name="l321"><span class="linenum"> 321</span></a>          <a class="var it2876" onMouseOver="hilite(2876)" onMouseOut="lolite()" onClick="logVariable('oldquestionid')" href="../../_variables/oldquestionid.html">$oldquestionid</a>   = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_old_parentid')" href="../../_functions/get_old_parentid.html" onMouseOver="funcPopup(event,'get_old_parentid')">get_old_parentid</a>('question');
<a name="l322"><span class="linenum"> 322</span></a>          <a class="var it2877" onMouseOver="hilite(2877)" onMouseOut="lolite()" onClick="logVariable('newquestionid')" href="../../_variables/newquestionid.html">$newquestionid</a>   = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_new_parentid')" href="../../_functions/get_new_parentid.html" onMouseOver="funcPopup(event,'get_new_parentid')">get_new_parentid</a>('question');
<a name="l323"><span class="linenum"> 323</span></a>          <a class="var it2878" onMouseOver="hilite(2878)" onMouseOut="lolite()" onClick="logVariable('questioncreated')" href="../../_variables/questioncreated.html">$questioncreated</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_mappingid')" href="../../_functions/get_mappingid.html" onMouseOver="funcPopup(event,'get_mappingid')">get_mappingid</a>('question_created', <a class="var it2876" onMouseOver="hilite(2876)" onMouseOut="lolite()" onClick="logVariable('oldquestionid')" href="../../_variables/oldquestionid.html">$oldquestionid</a>) ? true : false;
<a name="l324"><span class="linenum"> 324</span></a>  
<a name="l325"><span class="linenum"> 325</span></a>  <span class="comment">        // If the question is mapped, nothing to do</span>
<a name="l326"><span class="linenum"> 326</span></a>          if (!<a class="var it2878" onMouseOver="hilite(2878)" onMouseOut="lolite()" onClick="logVariable('questioncreated')" href="../../_variables/questioncreated.html">$questioncreated</a>) {
<a name="l327"><span class="linenum"> 327</span></a>              return;
<a name="l328"><span class="linenum"> 328</span></a>          }
<a name="l329"><span class="linenum"> 329</span></a>  
<a name="l330"><span class="linenum"> 330</span></a>  <span class="comment">        // Detect if the question_dataset_definition is being created</span>
<a name="l331"><span class="linenum"> 331</span></a>          <a class="var it14966" onMouseOver="hilite(14966)" onMouseOut="lolite()" onClick="logVariable('newdefinitionid')" href="../../_variables/newdefinitionid.html">$newdefinitionid</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_new_parentid')" href="../../_functions/get_new_parentid.html" onMouseOver="funcPopup(event,'get_new_parentid')">get_new_parentid</a>('question_dataset_definition');
<a name="l332"><span class="linenum"> 332</span></a>  
<a name="l333"><span class="linenum"> 333</span></a>  <span class="comment">        // If the definition is reused, nothing to do</span>
<a name="l334"><span class="linenum"> 334</span></a>          if (!<a class="var it14966" onMouseOver="hilite(14966)" onMouseOut="lolite()" onClick="logVariable('newdefinitionid')" href="../../_variables/newdefinitionid.html">$newdefinitionid</a>) {
<a name="l335"><span class="linenum"> 335</span></a>              return;
<a name="l336"><span class="linenum"> 336</span></a>          }
<a name="l337"><span class="linenum"> 337</span></a>  
<a name="l338"><span class="linenum"> 338</span></a>  <span class="comment">        // let's create the question_dataset_items</span>
<a name="l339"><span class="linenum"> 339</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('definition')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/definition.html">definition</a> = <a class="var it14966" onMouseOver="hilite(14966)" onMouseOut="lolite()" onClick="logVariable('newdefinitionid')" href="../../_variables/newdefinitionid.html">$newdefinitionid</a>;
<a name="l340"><span class="linenum"> 340</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('itemnumber')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/itemnumber.html">itemnumber</a> = <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('number')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/number.html">number</a>;
<a name="l341"><span class="linenum"> 341</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('question_dataset_items', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>);
<a name="l342"><span class="linenum"> 342</span></a>      }
<a name="l343"><span class="linenum"> 343</span></a>  
<a name="l344"><span class="linenum"> 344</span></a>      <span class="comment">/**</span>
<a name="l345"><span class="linenum"> 345</span></a>  <span class="comment">     * Do any re-coding necessary in the student response.</span>
<a name="l346"><span class="linenum"> 346</span></a>  <span class="comment">     * @param int $questionid the new id of the question</span>
<a name="l347"><span class="linenum"> 347</span></a>  <span class="comment">     * @param int $sequencenumber of the step within the qusetion attempt.</span>
<a name="l348"><span class="linenum"> 348</span></a>  <span class="comment">     * @param array the response data from the backup.</span>
<a name="l349"><span class="linenum"> 349</span></a>  <span class="comment">     * @return array the recoded response.</span>
<a name="l350"><span class="linenum"> 350</span></a>  <span class="comment">     */</span>
<a name="l351"><span class="linenum"> 351</span></a>      public function <a class="function" onClick="logFunction('recode_response')" href="../../_functions/recode_response.html" onMouseOver="funcPopup(event,'recode_response')">recode_response</a>(<a class="var it1004" onMouseOver="hilite(1004)" onMouseOut="lolite()" onClick="logVariable('questionid')" href="../../_variables/questionid.html">$questionid</a>, <a class="var it6173" onMouseOver="hilite(6173)" onMouseOut="lolite()" onClick="logVariable('sequencenumber')" href="../../_variables/sequencenumber.html">$sequencenumber</a>, array <a class="var it47" onMouseOver="hilite(47)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../_variables/response.html">$response</a>) {
<a name="l352"><span class="linenum"> 352</span></a>          return <a class="var it47" onMouseOver="hilite(47)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../_variables/response.html">$response</a>;
<a name="l353"><span class="linenum"> 353</span></a>      }
<a name="l354"><span class="linenum"> 354</span></a>  
<a name="l355"><span class="linenum"> 355</span></a>      <span class="comment">/**</span>
<a name="l356"><span class="linenum"> 356</span></a>  <span class="comment">     * Decode legacy question_states.answer for this qtype. Used when restoring</span>
<a name="l357"><span class="linenum"> 357</span></a>  <span class="comment">     * 2.0 attempt data.</span>
<a name="l358"><span class="linenum"> 358</span></a>  <span class="comment">     */</span>
<a name="l359"><span class="linenum"> 359</span></a>      public function <a class="function" onClick="logFunction('recode_legacy_state_answer')" href="../../_functions/recode_legacy_state_answer.html" onMouseOver="funcPopup(event,'recode_legacy_state_answer')">recode_legacy_state_answer</a>(<a class="var it1082" onMouseOver="hilite(1082)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>) {
<a name="l360"><span class="linenum"> 360</span></a>  <span class="comment">        // By default, return answer unmodified, qtypes needing recode will override this</span>
<a name="l361"><span class="linenum"> 361</span></a>          return <a class="var it1082" onMouseOver="hilite(1082)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>-&gt;<a onClick="logVariable('answer')" class="var it39691" onMouseOver="hilite(39691)" onMouseOut="lolite()" href="../../_variables/answer.html">answer</a>;
<a name="l362"><span class="linenum"> 362</span></a>      }
<a name="l363"><span class="linenum"> 363</span></a>  
<a name="l364"><span class="linenum"> 364</span></a>      <span class="comment">/**</span>
<a name="l365"><span class="linenum"> 365</span></a>  <span class="comment">     * Return the contents of the questions stuff that must be processed by the links decoder</span>
<a name="l366"><span class="linenum"> 366</span></a>  <span class="comment">     *</span>
<a name="l367"><span class="linenum"> 367</span></a>  <span class="comment">     * Only common stuff to all plugins, in this case:</span>
<a name="l368"><span class="linenum"> 368</span></a>  <span class="comment">     * - question: text and feedback</span>
<a name="l369"><span class="linenum"> 369</span></a>  <span class="comment">     * - question_answers: text and feedbak</span>
<a name="l370"><span class="linenum"> 370</span></a>  <span class="comment">     *</span>
<a name="l371"><span class="linenum"> 371</span></a>  <span class="comment">     * Note each qtype will have, if needed, its own define_decode_contents method</span>
<a name="l372"><span class="linenum"> 372</span></a>  <span class="comment">     */</span>
<a name="l373"><span class="linenum"> 373</span></a>      static public function <a class="function" onClick="logFunction('define_plugin_decode_contents')" href="../../_functions/define_plugin_decode_contents.html" onMouseOver="funcPopup(event,'define_plugin_decode_contents')">define_plugin_decode_contents</a>() {
<a name="l374"><span class="linenum"> 374</span></a>  
<a name="l375"><span class="linenum"> 375</span></a>          <a class="var it1144" onMouseOver="hilite(1144)" onMouseOut="lolite()" onClick="logVariable('contents')" href="../../_variables/contents.html">$contents</a> = array();
<a name="l376"><span class="linenum"> 376</span></a>  
<a name="l377"><span class="linenum"> 377</span></a>          <a class="var it1144" onMouseOver="hilite(1144)" onMouseOut="lolite()" onClick="logVariable('contents')" href="../../_variables/contents.html">$contents</a>[] = <span class="keyword">new </span><a class="class" onClick="logClass('restore_decode_content')" href="../../_classes/restore_decode_content.html" onMouseOver="classPopup(event,'restore_decode_content')">restore_decode_content</a>('question', array('questiontext', 'generalfeedback'), 'question_created');
<a name="l378"><span class="linenum"> 378</span></a>          <a class="var it1144" onMouseOver="hilite(1144)" onMouseOut="lolite()" onClick="logVariable('contents')" href="../../_variables/contents.html">$contents</a>[] = <span class="keyword">new </span><a class="class" onClick="logClass('restore_decode_content')" href="../../_classes/restore_decode_content.html" onMouseOver="classPopup(event,'restore_decode_content')">restore_decode_content</a>('question_answers', array('answer', 'feedback'), 'question_answer');
<a name="l379"><span class="linenum"> 379</span></a>  
<a name="l380"><span class="linenum"> 380</span></a>          return <a class="var it1144" onMouseOver="hilite(1144)" onMouseOut="lolite()" onClick="logVariable('contents')" href="../../_variables/contents.html">$contents</a>;
<a name="l381"><span class="linenum"> 381</span></a>      }
<a name="l382"><span class="linenum"> 382</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'get_old_parentid': ['get_old_parentid', 'Returns the latest (parent) old id mapped by one pathelement ', [['backup/moodle2','restore_subplugin.class.php',114],['backup/moodle2','restore_plugin.class.php',182],['backup/util/plan','restore_structure_step.class.php',189]], 24],
'add_question_numerical_options': ['add_question_numerical_options', 'Add to $paths the restore_path_elements needed to handle question_numerical_options for a given question Used by various qtypes (calculated, numerical) ', [['backup/moodle2','restore_qtype_plugin.class.php',83],['backup/moodle2','backup_qtype_plugin.class.php',95]], 4],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required. ', [['lib/dml','pgsql_native_moodle_database.php',883],['lib/dml','oci_native_moodle_database.php',1249],['lib/dml','sqlsrv_native_moodle_database.php',978],['lib/dml','mssql_native_moodle_database.php',898],['lib/dml','mysqli_native_moodle_database.php',1177],['lib/dml/tests','dml_test.php',5427],['lib/dml','pdo_moodle_database.php',386],['question/engine/upgrade','upgradelib.php',121]], 1512],
'recode_legacy_state_answer': ['recode_legacy_state_answer', 'Given one question_states record, return the answer recoded pointing to all the restored stuff for random questions ', [['question/type/random/backup/moodle2','restore_qtype_random_plugin.class.php',63],['question/type/multianswer/backup/moodle2','restore_qtype_multianswer_plugin.class.php',142],['question/type/calculatedmulti/backup/moodle2','restore_qtype_calculatedmulti_plugin.class.php',45],['backup/moodle2','restore_qtype_plugin.class.php',355],['question/type/match/backup/moodle2','restore_qtype_match_plugin.class.php',193],['question/type/truefalse/backup/moodle2','restore_qtype_truefalse_plugin.class.php',82],['question/type/multichoice/backup/moodle2','restore_qtype_multichoice_plugin.class.php',106],['question/type/randomsamatch/backup/moodle2','restore_qtype_randomsamatch_plugin.class.php',100]], 1],
'get_records': ['get_records', 'Get a number of records as an array of objects where all the given conditions met. ', [['lib/dml','moodle_database.php',1236],['lib','coursecatlib.php',654],['question','category_class.php',63]], 860],
'set_mapping': ['set_mapping', 'To send ids pairs to backup_ids_table and to store them into paths ', [['backup/moodle2','restore_subplugin.class.php',101],['backup/moodle2','restore_plugin.class.php',169],['backup/util/plan','restore_structure_step.class.php',158]], 117],
'process_question_numerical_option': ['process_question_numerical_option', 'Processes the numerical_option element (question numerical options). Common for various qtypes. It handles both creation (if the question is being created) and mapping (if the question already existed and is being reused) ', [['backup/moodle2','restore_qtype_plugin.class.php',218]], 0],
'process_question_numerical_unit': ['process_question_numerical_unit', 'Processes the numerical_unit element (question numerical units). Common for various qtypes. It handles both creation (if the question is being created) and mapping (if the question already existed and is being reused) ', [['backup/moodle2','restore_qtype_plugin.class.php',193]], 0],
'recode_response': ['recode_response', '', [['question/type/multianswer/backup/moodle2','restore_qtype_multianswer_plugin.class.php',116],['question/type/calculatedmulti/backup/moodle2','restore_qtype_calculatedmulti_plugin.class.php',40],['backup/moodle2','restore_qtype_plugin.class.php',344],['question/type/match/backup/moodle2','restore_qtype_match_plugin.class.php',183],['question/type/multichoice/backup/moodle2','restore_qtype_multichoice_plugin.class.php',84]], 1],
'define_plugin_decode_contents': ['define_plugin_decode_contents', 'Return the contents of the questions stuff that must be processed by the links decoder ', [['backup/moodle2','restore_qtype_plugin.class.php',364],['backup/moodle2','restore_plugin.class.php',150]], 1],
'add_question_datasets': ['add_question_datasets', 'Add to $paths the restore_path_elements needed to handle question_datasets (defs and items) for a given question Used by various qtypes (calculated, numerical) ', [['backup/moodle2','restore_qtype_plugin.class.php',99],['backup/moodle2','backup_qtype_plugin.class.php',121]], 2],
'get_new_parentid': ['get_new_parentid', 'Returns the latest (parent) new id mapped by one pathelement ', [['backup/moodle2','restore_subplugin.class.php',121],['backup/moodle2','restore_plugin.class.php',189],['backup/util/plan','restore_structure_step.class.php',196]], 142],
'add_question_question_answers': ['add_question_question_answers', 'Add to $paths the restore_path_elements needed to handle question_answers for a given question Used by various qtypes (calculated, essay, multianswer, multichoice, numerical, shortanswer, truefalse) ', [['backup/moodle2','restore_qtype_plugin.class.php',50],['backup/moodle2','backup_qtype_plugin.class.php',38]], 12],
'get_records_sql': ['get_records_sql', 'Get a number of records as an array of objects using a SQL statement. ', [['lib/dml','pgsql_native_moodle_database.php',732],['lib/dml','oci_native_moodle_database.php',1102],['lib/dml','sqlsrv_native_moodle_database.php',823],['lib/dml','mssql_native_moodle_database.php',741],['lib/dml','mysqli_native_moodle_database.php',1049],['lib/dml/tests','dml_test.php',5424],['lib/dml','pdo_moodle_database.php',308]], 678],
'add_question_numerical_units': ['add_question_numerical_units', 'Add to $paths the restore_path_elements needed to handle question_numerical_units for a given question Used by various qtypes (calculated, numerical) ', [['backup/moodle2','restore_qtype_plugin.class.php',67],['backup/moodle2','backup_qtype_plugin.class.php',69]], 4],
'process_question_dataset_definition': ['process_question_dataset_definition', 'Processes the dataset_definition element (question dataset definitions). Common for various qtypes. It handles both creation (if the question is being created) and mapping (if the question already existed and is being reused) ', [['backup/moodle2','restore_qtype_plugin.class.php',245]], 0],
'get_mappingid': ['get_mappingid', 'Return the new id of a mapping for the given itemname ', [['backup/moodle2','restore_subplugin.class.php',128],['backup/moodle2','restore_plugin.class.php',196],['backup/util/plan','restore_structure_step.class.php',203]], 208],
'get_pathfor': ['get_pathfor', 'Simple helper function that returns the base (prefix) of the path for the restore_path_element Useful if we used get_recommended_name() in backup. It\'s not mandatory to use it but recommended ;-) ', [['backup/moodle2','restore_subplugin.class.php',183],['backup/moodle2','restore_plugin.class.php',251]], 53],
'process_question_dataset_item': ['process_question_dataset_item', 'Processes the dataset_item element (question dataset items). Common for various qtypes. It handles both creation (if the question is being created) and mapping (if the question already existed and is being reused) ', [['backup/moodle2','restore_qtype_plugin.class.php',309]], 0],
'process_question_answer': ['process_question_answer', 'Processes the answer element (question answers). Common for various qtypes. It handles both creation (if the question is being created) and mapping (if the question already existed and is being reused) ', [['backup/moodle2','restore_qtype_plugin.class.php',119]], 0],
'is_array': ['is_array', '', [], 1820],
'array_key_exists': ['array_key_exists', '', [], 1539],
'defined': ['defined', '', [], 4098],
'preg_replace': ['preg_replace', '', [], 903]};
CLASS_DATA={
'restore_step_exception': ['restore_step_exception', '', [['backup/util/plan','restore_step.class.php',102]], 39],
'restore_decode_content': ['restore_decode_content', 'Helper class in charge of providing the contents to be processed by restore_decode_rules ', [['backup/util/helper','restore_decode_content.class.php',27]], 48],
'restore_path_element': ['restore_path_element', 'Class representing one path to be restored from XML file ', [['backup/util/structure','restore_path_element.class.php',27]], 210]};
CONST_DATA={
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',138],['','install.php',93],['lib','setup.php',386]], 3532]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu May 28 19:17:31 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
