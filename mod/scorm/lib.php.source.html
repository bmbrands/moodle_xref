<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /mod/scorm/lib.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Aug 11 10:00:09 2016 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='mod/scorm';
filename='lib.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/mod/scorm/</a> -> <a href="lib.php.html">lib.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="lib.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="lib.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * @package   mod_scorm</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> * @copyright 1999 onwards Martin Dougiamas  {@link http://moodle.com}</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> */</span>
<a name="l22"><span class="linenum">  22</span></a>  
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment">/** SCORM_TYPE_LOCAL = local */</span>
<a name="l24"><span class="linenum">  24</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SCORM_TYPE_LOCAL')" href="../../_constants/SCORM_TYPE_LOCAL.html" onMouseOver="constPopup(event,'SCORM_TYPE_LOCAL')">SCORM_TYPE_LOCAL</a>', 'local');
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment">/** SCORM_TYPE_LOCALSYNC = localsync */</span>
<a name="l26"><span class="linenum">  26</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SCORM_TYPE_LOCALSYNC')" href="../../_constants/SCORM_TYPE_LOCALSYNC.html" onMouseOver="constPopup(event,'SCORM_TYPE_LOCALSYNC')">SCORM_TYPE_LOCALSYNC</a>', 'localsync');
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment">/** SCORM_TYPE_EXTERNAL = external */</span>
<a name="l28"><span class="linenum">  28</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SCORM_TYPE_EXTERNAL')" href="../../_constants/SCORM_TYPE_EXTERNAL.html" onMouseOver="constPopup(event,'SCORM_TYPE_EXTERNAL')">SCORM_TYPE_EXTERNAL</a>', 'external');
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment">/** SCORM_TYPE_AICCURL = external AICC url */</span>
<a name="l30"><span class="linenum">  30</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SCORM_TYPE_AICCURL')" href="../../_constants/SCORM_TYPE_AICCURL.html" onMouseOver="constPopup(event,'SCORM_TYPE_AICCURL')">SCORM_TYPE_AICCURL</a>', 'aiccurl');
<a name="l31"><span class="linenum">  31</span></a>  
<a name="l32"><span class="linenum">  32</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SCORM_TOC_SIDE')" href="../../_constants/SCORM_TOC_SIDE.html" onMouseOver="constPopup(event,'SCORM_TOC_SIDE')">SCORM_TOC_SIDE</a>', 0);
<a name="l33"><span class="linenum">  33</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SCORM_TOC_HIDDEN')" href="../../_constants/SCORM_TOC_HIDDEN.html" onMouseOver="constPopup(event,'SCORM_TOC_HIDDEN')">SCORM_TOC_HIDDEN</a>', 1);
<a name="l34"><span class="linenum">  34</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SCORM_TOC_POPUP')" href="../../_constants/SCORM_TOC_POPUP.html" onMouseOver="constPopup(event,'SCORM_TOC_POPUP')">SCORM_TOC_POPUP</a>', 2);
<a name="l35"><span class="linenum">  35</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SCORM_TOC_DISABLED')" href="../../_constants/SCORM_TOC_DISABLED.html" onMouseOver="constPopup(event,'SCORM_TOC_DISABLED')">SCORM_TOC_DISABLED</a>', 3);
<a name="l36"><span class="linenum">  36</span></a>  
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment">// Used to show/hide navigation buttons and set their position.</span>
<a name="l38"><span class="linenum">  38</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SCORM_NAV_DISABLED')" href="../../_constants/SCORM_NAV_DISABLED.html" onMouseOver="constPopup(event,'SCORM_NAV_DISABLED')">SCORM_NAV_DISABLED</a>', 0);
<a name="l39"><span class="linenum">  39</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SCORM_NAV_UNDER_CONTENT')" href="../../_constants/SCORM_NAV_UNDER_CONTENT.html" onMouseOver="constPopup(event,'SCORM_NAV_UNDER_CONTENT')">SCORM_NAV_UNDER_CONTENT</a>', 1);
<a name="l40"><span class="linenum">  40</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SCORM_NAV_FLOATING')" href="../../_constants/SCORM_NAV_FLOATING.html" onMouseOver="constPopup(event,'SCORM_NAV_FLOATING')">SCORM_NAV_FLOATING</a>', 2);
<a name="l41"><span class="linenum">  41</span></a>  
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment">// Used to check what SCORM version is being used.</span>
<a name="l43"><span class="linenum">  43</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SCORM_12')" href="../../_constants/SCORM_12.html" onMouseOver="constPopup(event,'SCORM_12')">SCORM_12</a>', 1);
<a name="l44"><span class="linenum">  44</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SCORM_13')" href="../../_constants/SCORM_13.html" onMouseOver="constPopup(event,'SCORM_13')">SCORM_13</a>', 2);
<a name="l45"><span class="linenum">  45</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SCORM_AICC')" href="../../_constants/SCORM_AICC.html" onMouseOver="constPopup(event,'SCORM_AICC')">SCORM_AICC</a>', 3);
<a name="l46"><span class="linenum">  46</span></a>  
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment">// List of possible attemptstatusdisplay options.</span>
<a name="l48"><span class="linenum">  48</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SCORM_DISPLAY_ATTEMPTSTATUS_NO')" href="../../_constants/SCORM_DISPLAY_ATTEMPTSTATUS_NO.html" onMouseOver="constPopup(event,'SCORM_DISPLAY_ATTEMPTSTATUS_NO')">SCORM_DISPLAY_ATTEMPTSTATUS_NO</a>', 0);
<a name="l49"><span class="linenum">  49</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SCORM_DISPLAY_ATTEMPTSTATUS_ALL')" href="../../_constants/SCORM_DISPLAY_ATTEMPTSTATUS_ALL.html" onMouseOver="constPopup(event,'SCORM_DISPLAY_ATTEMPTSTATUS_ALL')">SCORM_DISPLAY_ATTEMPTSTATUS_ALL</a>', 1);
<a name="l50"><span class="linenum">  50</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SCORM_DISPLAY_ATTEMPTSTATUS_MY')" href="../../_constants/SCORM_DISPLAY_ATTEMPTSTATUS_MY.html" onMouseOver="constPopup(event,'SCORM_DISPLAY_ATTEMPTSTATUS_MY')">SCORM_DISPLAY_ATTEMPTSTATUS_MY</a>', 2);
<a name="l51"><span class="linenum">  51</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SCORM_DISPLAY_ATTEMPTSTATUS_ENTRY')" href="../../_constants/SCORM_DISPLAY_ATTEMPTSTATUS_ENTRY.html" onMouseOver="constPopup(event,'SCORM_DISPLAY_ATTEMPTSTATUS_ENTRY')">SCORM_DISPLAY_ATTEMPTSTATUS_ENTRY</a>', 3);
<a name="l52"><span class="linenum">  52</span></a>  
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment">/**</span>
<a name="l54"><span class="linenum">  54</span></a>  <span class="comment"> * Return an array of status options</span>
<a name="l55"><span class="linenum">  55</span></a>  <span class="comment"> *</span>
<a name="l56"><span class="linenum">  56</span></a>  <span class="comment"> * Optionally with translated strings</span>
<a name="l57"><span class="linenum">  57</span></a>  <span class="comment"> *</span>
<a name="l58"><span class="linenum">  58</span></a>  <span class="comment"> * @param   bool    $with_strings   (optional)</span>
<a name="l59"><span class="linenum">  59</span></a>  <span class="comment"> * @return  array</span>
<a name="l60"><span class="linenum">  60</span></a>  <span class="comment"> */</span>
<a name="l61"><span class="linenum">  61</span></a>  function <a class="function" onClick="logFunction('scorm_status_options')" href="../../_functions/scorm_status_options.html" onMouseOver="funcPopup(event,'scorm_status_options')">scorm_status_options</a>(<a class="var it11908" onMouseOver="hilite(11908)" onMouseOut="lolite()" onClick="logVariable('withstrings')" href="../../_variables/withstrings.html">$withstrings</a> = false) {
<a name="l62"><span class="linenum">  62</span></a>  <span class="comment">    // Id's are important as they are bits.</span>
<a name="l63"><span class="linenum">  63</span></a>      <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a> = array(
<a name="l64"><span class="linenum">  64</span></a>          2 =&gt; 'passed',
<a name="l65"><span class="linenum">  65</span></a>          4 =&gt; 'completed'
<a name="l66"><span class="linenum">  66</span></a>      );
<a name="l67"><span class="linenum">  67</span></a>  
<a name="l68"><span class="linenum">  68</span></a>      if (<a class="var it11908" onMouseOver="hilite(11908)" onMouseOut="lolite()" onClick="logVariable('withstrings')" href="../../_variables/withstrings.html">$withstrings</a>) {
<a name="l69"><span class="linenum">  69</span></a>          foreach (<a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l70"><span class="linenum">  70</span></a>              <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('completionstatus_'.<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>, 'scorm');
<a name="l71"><span class="linenum">  71</span></a>          }
<a name="l72"><span class="linenum">  72</span></a>      }
<a name="l73"><span class="linenum">  73</span></a>  
<a name="l74"><span class="linenum">  74</span></a>      return <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>;
<a name="l75"><span class="linenum">  75</span></a>  }
<a name="l76"><span class="linenum">  76</span></a>  
<a name="l77"><span class="linenum">  77</span></a>  
<a name="l78"><span class="linenum">  78</span></a>  <span class="comment">/**</span>
<a name="l79"><span class="linenum">  79</span></a>  <span class="comment"> * Given an object containing all the necessary data,</span>
<a name="l80"><span class="linenum">  80</span></a>  <span class="comment"> * (defined by the form in mod_form.php) this function</span>
<a name="l81"><span class="linenum">  81</span></a>  <span class="comment"> * will create a new instance and return the id number</span>
<a name="l82"><span class="linenum">  82</span></a>  <span class="comment"> * of the new instance.</span>
<a name="l83"><span class="linenum">  83</span></a>  <span class="comment"> *</span>
<a name="l84"><span class="linenum">  84</span></a>  <span class="comment"> * @global stdClass</span>
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment"> * @global object</span>
<a name="l86"><span class="linenum">  86</span></a>  <span class="comment"> * @uses CONTEXT_MODULE</span>
<a name="l87"><span class="linenum">  87</span></a>  <span class="comment"> * @uses SCORM_TYPE_LOCAL</span>
<a name="l88"><span class="linenum">  88</span></a>  <span class="comment"> * @uses SCORM_TYPE_LOCALSYNC</span>
<a name="l89"><span class="linenum">  89</span></a>  <span class="comment"> * @uses SCORM_TYPE_EXTERNAL</span>
<a name="l90"><span class="linenum">  90</span></a>  <span class="comment"> * @param object $scorm Form data</span>
<a name="l91"><span class="linenum">  91</span></a>  <span class="comment"> * @param object $mform</span>
<a name="l92"><span class="linenum">  92</span></a>  <span class="comment"> * @return int new instance id</span>
<a name="l93"><span class="linenum">  93</span></a>  <span class="comment"> */</span>
<a name="l94"><span class="linenum">  94</span></a>  function <a class="function" onClick="logFunction('scorm_add_instance')" href="../../_functions/scorm_add_instance.html" onMouseOver="funcPopup(event,'scorm_add_instance')">scorm_add_instance</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>, <a class="var it219" onMouseOver="hilite(219)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../../_variables/mform.html">$mform</a>=null) {
<a name="l95"><span class="linenum">  95</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l96"><span class="linenum">  96</span></a>  
<a name="l97"><span class="linenum">  97</span></a>      require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../mod/scorm/locallib.php.html">/mod/scorm/locallib.php</a>');
<a name="l98"><span class="linenum">  98</span></a>  
<a name="l99"><span class="linenum">  99</span></a>      if (empty(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('timeopen')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/timeopen.html">timeopen</a>)) {
<a name="l100"><span class="linenum"> 100</span></a>          <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('timeopen')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/timeopen.html">timeopen</a> = 0;
<a name="l101"><span class="linenum"> 101</span></a>      }
<a name="l102"><span class="linenum"> 102</span></a>      if (empty(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('timeclose')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/timeclose.html">timeclose</a>)) {
<a name="l103"><span class="linenum"> 103</span></a>          <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('timeclose')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/timeclose.html">timeclose</a> = 0;
<a name="l104"><span class="linenum"> 104</span></a>      }
<a name="l105"><span class="linenum"> 105</span></a>      <a class="var it1077" onMouseOver="hilite(1077)" onMouseOut="lolite()" onClick="logVariable('cmid')" href="../../_variables/cmid.html">$cmid</a>       = <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('coursemodule')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/coursemodule.html">coursemodule</a>;
<a name="l106"><span class="linenum"> 106</span></a>      <a class="var it5322" onMouseOver="hilite(5322)" onMouseOut="lolite()" onClick="logVariable('cmidnumber')" href="../../_variables/cmidnumber.html">$cmidnumber</a> = <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('cmidnumber')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/cmidnumber.html">cmidnumber</a>;
<a name="l107"><span class="linenum"> 107</span></a>      <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>   = <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('course')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>;
<a name="l108"><span class="linenum"> 108</span></a>  
<a name="l109"><span class="linenum"> 109</span></a>      <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_module')" href="../../_classes/context_module.html" onMouseOver="classPopup(event,'context_module')">context_module</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it1077" onMouseOver="hilite(1077)" onMouseOut="lolite()" onClick="logVariable('cmid')" href="../../_variables/cmid.html">$cmid</a>);
<a name="l110"><span class="linenum"> 110</span></a>  
<a name="l111"><span class="linenum"> 111</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a> = <a class="function" onClick="logFunction('scorm_option2text')" href="../../_functions/scorm_option2text.html" onMouseOver="funcPopup(event,'scorm_option2text')">scorm_option2text</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>);
<a name="l112"><span class="linenum"> 112</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('width')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/width.html">width</a>  = (int)<a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('%', '', <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('width')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/width.html">width</a>);
<a name="l113"><span class="linenum"> 113</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('height')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/height.html">height</a> = (int)<a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('%', '', <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('height')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/height.html">height</a>);
<a name="l114"><span class="linenum"> 114</span></a>  
<a name="l115"><span class="linenum"> 115</span></a>      if (!isset(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('whatgrade')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/whatgrade.html">whatgrade</a>)) {
<a name="l116"><span class="linenum"> 116</span></a>          <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('whatgrade')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/whatgrade.html">whatgrade</a> = 0;
<a name="l117"><span class="linenum"> 117</span></a>      }
<a name="l118"><span class="linenum"> 118</span></a>  
<a name="l119"><span class="linenum"> 119</span></a>      <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('scorm', <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>);
<a name="l120"><span class="linenum"> 120</span></a>  
<a name="l121"><span class="linenum"> 121</span></a>  <span class="comment">    // Update course module record - from now on this instance properly exists and all function may be used.</span>
<a name="l122"><span class="linenum"> 122</span></a>      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('course_modules', 'instance', <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>, array('id' =&gt; <a class="var it1077" onMouseOver="hilite(1077)" onMouseOut="lolite()" onClick="logVariable('cmid')" href="../../_variables/cmid.html">$cmid</a>));
<a name="l123"><span class="linenum"> 123</span></a>  
<a name="l124"><span class="linenum"> 124</span></a>  <span class="comment">    // Reload scorm instance.</span>
<a name="l125"><span class="linenum"> 125</span></a>      <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('scorm', array('id' =&gt; <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>));
<a name="l126"><span class="linenum"> 126</span></a>  
<a name="l127"><span class="linenum"> 127</span></a>  <span class="comment">    // Store the package and verify.</span>
<a name="l128"><span class="linenum"> 128</span></a>      if (<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('scormtype')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/scormtype.html">scormtype</a> === <a class="constant" onClick="logConstant('SCORM_TYPE_LOCAL')" href="../../_constants/SCORM_TYPE_LOCAL.html" onMouseOver="constPopup(event,'SCORM_TYPE_LOCAL')">SCORM_TYPE_LOCAL</a>) {
<a name="l129"><span class="linenum"> 129</span></a>          if (!empty(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('packagefile')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/packagefile.html">packagefile</a>)) {
<a name="l130"><span class="linenum"> 130</span></a>              <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a> = <a class="function" onClick="logFunction('get_file_storage')" href="../../_functions/get_file_storage.html" onMouseOver="funcPopup(event,'get_file_storage')">get_file_storage</a>();
<a name="l131"><span class="linenum"> 131</span></a>              <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('delete_area_files')" href="../../_functions/delete_area_files.html" onMouseOver="funcPopup(event,'delete_area_files')">delete_area_files</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'mod_scorm', 'package');
<a name="l132"><span class="linenum"> 132</span></a>              <a class="function" onClick="logFunction('file_save_draft_area_files')" href="../../_functions/file_save_draft_area_files.html" onMouseOver="funcPopup(event,'file_save_draft_area_files')">file_save_draft_area_files</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('packagefile')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/packagefile.html">packagefile</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'mod_scorm', 'package',
<a name="l133"><span class="linenum"> 133</span></a>                  0, array('subdirs' =&gt; 0, 'maxfiles' =&gt; 1));
<a name="l134"><span class="linenum"> 134</span></a>  <span class="comment">            // Get filename of zip that was uploaded.</span>
<a name="l135"><span class="linenum"> 135</span></a>              <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('files')" href="../../_variables/files.html">$files</a> = <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('get_area_files')" href="../../_functions/get_area_files.html" onMouseOver="funcPopup(event,'get_area_files')">get_area_files</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'mod_scorm', 'package', 0, '', false);
<a name="l136"><span class="linenum"> 136</span></a>              <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('files')" href="../../_variables/files.html">$files</a>);
<a name="l137"><span class="linenum"> 137</span></a>              <a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../_variables/filename.html">$filename</a> = <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a>-&gt;<a class="function" onClick="logFunction('get_filename')" href="../../_functions/get_filename.html" onMouseOver="funcPopup(event,'get_filename')">get_filename</a>();
<a name="l138"><span class="linenum"> 138</span></a>              if (<a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../_variables/filename.html">$filename</a> !== false) {
<a name="l139"><span class="linenum"> 139</span></a>                  <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('reference')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/reference.html">reference</a> = <a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../_variables/filename.html">$filename</a>;
<a name="l140"><span class="linenum"> 140</span></a>              }
<a name="l141"><span class="linenum"> 141</span></a>          }
<a name="l142"><span class="linenum"> 142</span></a>  
<a name="l143"><span class="linenum"> 143</span></a>      } else if (<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('scormtype')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/scormtype.html">scormtype</a> === <a class="constant" onClick="logConstant('SCORM_TYPE_LOCALSYNC')" href="../../_constants/SCORM_TYPE_LOCALSYNC.html" onMouseOver="constPopup(event,'SCORM_TYPE_LOCALSYNC')">SCORM_TYPE_LOCALSYNC</a>) {
<a name="l144"><span class="linenum"> 144</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('reference')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/reference.html">reference</a> = <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('packageurl')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/packageurl.html">packageurl</a>;
<a name="l145"><span class="linenum"> 145</span></a>      } else if (<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('scormtype')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/scormtype.html">scormtype</a> === <a class="constant" onClick="logConstant('SCORM_TYPE_EXTERNAL')" href="../../_constants/SCORM_TYPE_EXTERNAL.html" onMouseOver="constPopup(event,'SCORM_TYPE_EXTERNAL')">SCORM_TYPE_EXTERNAL</a>) {
<a name="l146"><span class="linenum"> 146</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('reference')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/reference.html">reference</a> = <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('packageurl')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/packageurl.html">packageurl</a>;
<a name="l147"><span class="linenum"> 147</span></a>      } else if (<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('scormtype')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/scormtype.html">scormtype</a> === <a class="constant" onClick="logConstant('SCORM_TYPE_AICCURL')" href="../../_constants/SCORM_TYPE_AICCURL.html" onMouseOver="constPopup(event,'SCORM_TYPE_AICCURL')">SCORM_TYPE_AICCURL</a>) {
<a name="l148"><span class="linenum"> 148</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('reference')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/reference.html">reference</a> = <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('packageurl')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/packageurl.html">packageurl</a>;
<a name="l149"><span class="linenum"> 149</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('hidetoc')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/hidetoc.html">hidetoc</a> = <a class="constant" onClick="logConstant('SCORM_TOC_DISABLED')" href="../../_constants/SCORM_TOC_DISABLED.html" onMouseOver="constPopup(event,'SCORM_TOC_DISABLED')">SCORM_TOC_DISABLED</a>; <span class="comment">// TOC is useless for direct AICCURL so disable it.</span>
<a name="l150"><span class="linenum"> 150</span></a>      } else {
<a name="l151"><span class="linenum"> 151</span></a>          return false;
<a name="l152"><span class="linenum"> 152</span></a>      }
<a name="l153"><span class="linenum"> 153</span></a>  
<a name="l154"><span class="linenum"> 154</span></a>  <span class="comment">    // Save reference.</span>
<a name="l155"><span class="linenum"> 155</span></a>      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('scorm', <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>);
<a name="l156"><span class="linenum"> 156</span></a>  
<a name="l157"><span class="linenum"> 157</span></a>  <span class="comment">    // Extra fields required in grade related functions.</span>
<a name="l158"><span class="linenum"> 158</span></a>      <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('course')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>     = <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>;
<a name="l159"><span class="linenum"> 159</span></a>      <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('cmidnumber')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/cmidnumber.html">cmidnumber</a> = <a class="var it5322" onMouseOver="hilite(5322)" onMouseOut="lolite()" onClick="logVariable('cmidnumber')" href="../../_variables/cmidnumber.html">$cmidnumber</a>;
<a name="l160"><span class="linenum"> 160</span></a>      <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('cmid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/cmid.html">cmid</a>       = <a class="var it1077" onMouseOver="hilite(1077)" onMouseOut="lolite()" onClick="logVariable('cmid')" href="../../_variables/cmid.html">$cmid</a>;
<a name="l161"><span class="linenum"> 161</span></a>  
<a name="l162"><span class="linenum"> 162</span></a>      <a class="function" onClick="logFunction('scorm_parse')" href="../../_functions/scorm_parse.html" onMouseOver="funcPopup(event,'scorm_parse')">scorm_parse</a>(<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>, true);
<a name="l163"><span class="linenum"> 163</span></a>  
<a name="l164"><span class="linenum"> 164</span></a>      <a class="function" onClick="logFunction('scorm_grade_item_update')" href="../../_functions/scorm_grade_item_update.html" onMouseOver="funcPopup(event,'scorm_grade_item_update')">scorm_grade_item_update</a>(<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>);
<a name="l165"><span class="linenum"> 165</span></a>  
<a name="l166"><span class="linenum"> 166</span></a>      return <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l167"><span class="linenum"> 167</span></a>  }
<a name="l168"><span class="linenum"> 168</span></a>  
<a name="l169"><span class="linenum"> 169</span></a>  <span class="comment">/**</span>
<a name="l170"><span class="linenum"> 170</span></a>  <span class="comment"> * Given an object containing all the necessary data,</span>
<a name="l171"><span class="linenum"> 171</span></a>  <span class="comment"> * (defined by the form in mod_form.php) this function</span>
<a name="l172"><span class="linenum"> 172</span></a>  <span class="comment"> * will update an existing instance with new data.</span>
<a name="l173"><span class="linenum"> 173</span></a>  <span class="comment"> *</span>
<a name="l174"><span class="linenum"> 174</span></a>  <span class="comment"> * @global stdClass</span>
<a name="l175"><span class="linenum"> 175</span></a>  <span class="comment"> * @global object</span>
<a name="l176"><span class="linenum"> 176</span></a>  <span class="comment"> * @uses CONTEXT_MODULE</span>
<a name="l177"><span class="linenum"> 177</span></a>  <span class="comment"> * @uses SCORM_TYPE_LOCAL</span>
<a name="l178"><span class="linenum"> 178</span></a>  <span class="comment"> * @uses SCORM_TYPE_LOCALSYNC</span>
<a name="l179"><span class="linenum"> 179</span></a>  <span class="comment"> * @uses SCORM_TYPE_EXTERNAL</span>
<a name="l180"><span class="linenum"> 180</span></a>  <span class="comment"> * @param object $scorm Form data</span>
<a name="l181"><span class="linenum"> 181</span></a>  <span class="comment"> * @param object $mform</span>
<a name="l182"><span class="linenum"> 182</span></a>  <span class="comment"> * @return bool</span>
<a name="l183"><span class="linenum"> 183</span></a>  <span class="comment"> */</span>
<a name="l184"><span class="linenum"> 184</span></a>  function <a class="function" onClick="logFunction('scorm_update_instance')" href="../../_functions/scorm_update_instance.html" onMouseOver="funcPopup(event,'scorm_update_instance')">scorm_update_instance</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>, <a class="var it219" onMouseOver="hilite(219)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../../_variables/mform.html">$mform</a>=null) {
<a name="l185"><span class="linenum"> 185</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l186"><span class="linenum"> 186</span></a>  
<a name="l187"><span class="linenum"> 187</span></a>      require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../mod/scorm/locallib.php.html">/mod/scorm/locallib.php</a>');
<a name="l188"><span class="linenum"> 188</span></a>  
<a name="l189"><span class="linenum"> 189</span></a>      if (empty(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('timeopen')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/timeopen.html">timeopen</a>)) {
<a name="l190"><span class="linenum"> 190</span></a>          <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('timeopen')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/timeopen.html">timeopen</a> = 0;
<a name="l191"><span class="linenum"> 191</span></a>      }
<a name="l192"><span class="linenum"> 192</span></a>      if (empty(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('timeclose')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/timeclose.html">timeclose</a>)) {
<a name="l193"><span class="linenum"> 193</span></a>          <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('timeclose')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/timeclose.html">timeclose</a> = 0;
<a name="l194"><span class="linenum"> 194</span></a>      }
<a name="l195"><span class="linenum"> 195</span></a>  
<a name="l196"><span class="linenum"> 196</span></a>      <a class="var it1077" onMouseOver="hilite(1077)" onMouseOut="lolite()" onClick="logVariable('cmid')" href="../../_variables/cmid.html">$cmid</a>       = <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('coursemodule')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/coursemodule.html">coursemodule</a>;
<a name="l197"><span class="linenum"> 197</span></a>      <a class="var it5322" onMouseOver="hilite(5322)" onMouseOut="lolite()" onClick="logVariable('cmidnumber')" href="../../_variables/cmidnumber.html">$cmidnumber</a> = <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('cmidnumber')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/cmidnumber.html">cmidnumber</a>;
<a name="l198"><span class="linenum"> 198</span></a>      <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>   = <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('course')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>;
<a name="l199"><span class="linenum"> 199</span></a>  
<a name="l200"><span class="linenum"> 200</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('id')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('instance')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/instance.html">instance</a>;
<a name="l201"><span class="linenum"> 201</span></a>  
<a name="l202"><span class="linenum"> 202</span></a>      <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_module')" href="../../_classes/context_module.html" onMouseOver="classPopup(event,'context_module')">context_module</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it1077" onMouseOver="hilite(1077)" onMouseOut="lolite()" onClick="logVariable('cmid')" href="../../_variables/cmid.html">$cmid</a>);
<a name="l203"><span class="linenum"> 203</span></a>  
<a name="l204"><span class="linenum"> 204</span></a>      if (<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('scormtype')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/scormtype.html">scormtype</a> === <a class="constant" onClick="logConstant('SCORM_TYPE_LOCAL')" href="../../_constants/SCORM_TYPE_LOCAL.html" onMouseOver="constPopup(event,'SCORM_TYPE_LOCAL')">SCORM_TYPE_LOCAL</a>) {
<a name="l205"><span class="linenum"> 205</span></a>          if (!empty(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('packagefile')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/packagefile.html">packagefile</a>)) {
<a name="l206"><span class="linenum"> 206</span></a>              <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a> = <a class="function" onClick="logFunction('get_file_storage')" href="../../_functions/get_file_storage.html" onMouseOver="funcPopup(event,'get_file_storage')">get_file_storage</a>();
<a name="l207"><span class="linenum"> 207</span></a>              <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('delete_area_files')" href="../../_functions/delete_area_files.html" onMouseOver="funcPopup(event,'delete_area_files')">delete_area_files</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'mod_scorm', 'package');
<a name="l208"><span class="linenum"> 208</span></a>              <a class="function" onClick="logFunction('file_save_draft_area_files')" href="../../_functions/file_save_draft_area_files.html" onMouseOver="funcPopup(event,'file_save_draft_area_files')">file_save_draft_area_files</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('packagefile')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/packagefile.html">packagefile</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'mod_scorm', 'package',
<a name="l209"><span class="linenum"> 209</span></a>                  0, array('subdirs' =&gt; 0, 'maxfiles' =&gt; 1));
<a name="l210"><span class="linenum"> 210</span></a>  <span class="comment">            // Get filename of zip that was uploaded.</span>
<a name="l211"><span class="linenum"> 211</span></a>              <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('files')" href="../../_variables/files.html">$files</a> = <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('get_area_files')" href="../../_functions/get_area_files.html" onMouseOver="funcPopup(event,'get_area_files')">get_area_files</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'mod_scorm', 'package', 0, '', false);
<a name="l212"><span class="linenum"> 212</span></a>              <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('files')" href="../../_variables/files.html">$files</a>);
<a name="l213"><span class="linenum"> 213</span></a>              <a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../_variables/filename.html">$filename</a> = <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a>-&gt;<a class="function" onClick="logFunction('get_filename')" href="../../_functions/get_filename.html" onMouseOver="funcPopup(event,'get_filename')">get_filename</a>();
<a name="l214"><span class="linenum"> 214</span></a>              if (<a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../_variables/filename.html">$filename</a> !== false) {
<a name="l215"><span class="linenum"> 215</span></a>                  <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('reference')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/reference.html">reference</a> = <a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../_variables/filename.html">$filename</a>;
<a name="l216"><span class="linenum"> 216</span></a>              }
<a name="l217"><span class="linenum"> 217</span></a>          }
<a name="l218"><span class="linenum"> 218</span></a>  
<a name="l219"><span class="linenum"> 219</span></a>      } else if (<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('scormtype')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/scormtype.html">scormtype</a> === <a class="constant" onClick="logConstant('SCORM_TYPE_LOCALSYNC')" href="../../_constants/SCORM_TYPE_LOCALSYNC.html" onMouseOver="constPopup(event,'SCORM_TYPE_LOCALSYNC')">SCORM_TYPE_LOCALSYNC</a>) {
<a name="l220"><span class="linenum"> 220</span></a>          <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('reference')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/reference.html">reference</a> = <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('packageurl')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/packageurl.html">packageurl</a>;
<a name="l221"><span class="linenum"> 221</span></a>      } else if (<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('scormtype')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/scormtype.html">scormtype</a> === <a class="constant" onClick="logConstant('SCORM_TYPE_EXTERNAL')" href="../../_constants/SCORM_TYPE_EXTERNAL.html" onMouseOver="constPopup(event,'SCORM_TYPE_EXTERNAL')">SCORM_TYPE_EXTERNAL</a>) {
<a name="l222"><span class="linenum"> 222</span></a>          <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('reference')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/reference.html">reference</a> = <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('packageurl')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/packageurl.html">packageurl</a>;
<a name="l223"><span class="linenum"> 223</span></a>      } else if (<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('scormtype')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/scormtype.html">scormtype</a> === <a class="constant" onClick="logConstant('SCORM_TYPE_AICCURL')" href="../../_constants/SCORM_TYPE_AICCURL.html" onMouseOver="constPopup(event,'SCORM_TYPE_AICCURL')">SCORM_TYPE_AICCURL</a>) {
<a name="l224"><span class="linenum"> 224</span></a>          <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('reference')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/reference.html">reference</a> = <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('packageurl')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/packageurl.html">packageurl</a>;
<a name="l225"><span class="linenum"> 225</span></a>          <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('hidetoc')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/hidetoc.html">hidetoc</a> = <a class="constant" onClick="logConstant('SCORM_TOC_DISABLED')" href="../../_constants/SCORM_TOC_DISABLED.html" onMouseOver="constPopup(event,'SCORM_TOC_DISABLED')">SCORM_TOC_DISABLED</a>; <span class="comment">// TOC is useless for direct AICCURL so disable it.</span>
<a name="l226"><span class="linenum"> 226</span></a>      } else {
<a name="l227"><span class="linenum"> 227</span></a>          return false;
<a name="l228"><span class="linenum"> 228</span></a>      }
<a name="l229"><span class="linenum"> 229</span></a>  
<a name="l230"><span class="linenum"> 230</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a> = <a class="function" onClick="logFunction('scorm_option2text')" href="../../_functions/scorm_option2text.html" onMouseOver="funcPopup(event,'scorm_option2text')">scorm_option2text</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>);
<a name="l231"><span class="linenum"> 231</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('width')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/width.html">width</a>        = (int)<a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('%', '', <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('width')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/width.html">width</a>);
<a name="l232"><span class="linenum"> 232</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('height')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/height.html">height</a>       = (int)<a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('%', '', <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('height')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/height.html">height</a>);
<a name="l233"><span class="linenum"> 233</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('timemodified')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l234"><span class="linenum"> 234</span></a>  
<a name="l235"><span class="linenum"> 235</span></a>      if (!isset(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('whatgrade')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/whatgrade.html">whatgrade</a>)) {
<a name="l236"><span class="linenum"> 236</span></a>          <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('whatgrade')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/whatgrade.html">whatgrade</a> = 0;
<a name="l237"><span class="linenum"> 237</span></a>      }
<a name="l238"><span class="linenum"> 238</span></a>  
<a name="l239"><span class="linenum"> 239</span></a>      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('scorm', <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>);
<a name="l240"><span class="linenum"> 240</span></a>  
<a name="l241"><span class="linenum"> 241</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('scorm', array('id' =&gt; <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('id')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l242"><span class="linenum"> 242</span></a>  
<a name="l243"><span class="linenum"> 243</span></a>  <span class="comment">    // Extra fields required in grade related functions.</span>
<a name="l244"><span class="linenum"> 244</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('course')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>   = <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>;
<a name="l245"><span class="linenum"> 245</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('idnumber')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/idnumber.html">idnumber</a> = <a class="var it5322" onMouseOver="hilite(5322)" onMouseOut="lolite()" onClick="logVariable('cmidnumber')" href="../../_variables/cmidnumber.html">$cmidnumber</a>;
<a name="l246"><span class="linenum"> 246</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('cmid')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/cmid.html">cmid</a>     = <a class="var it1077" onMouseOver="hilite(1077)" onMouseOut="lolite()" onClick="logVariable('cmid')" href="../../_variables/cmid.html">$cmid</a>;
<a name="l247"><span class="linenum"> 247</span></a>  
<a name="l248"><span class="linenum"> 248</span></a>      <a class="function" onClick="logFunction('scorm_parse')" href="../../_functions/scorm_parse.html" onMouseOver="funcPopup(event,'scorm_parse')">scorm_parse</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>, (bool)<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('updatefreq')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/updatefreq.html">updatefreq</a>);
<a name="l249"><span class="linenum"> 249</span></a>  
<a name="l250"><span class="linenum"> 250</span></a>      <a class="function" onClick="logFunction('scorm_grade_item_update')" href="../../_functions/scorm_grade_item_update.html" onMouseOver="funcPopup(event,'scorm_grade_item_update')">scorm_grade_item_update</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>);
<a name="l251"><span class="linenum"> 251</span></a>      <a class="function" onClick="logFunction('scorm_update_grades')" href="../../_functions/scorm_update_grades.html" onMouseOver="funcPopup(event,'scorm_update_grades')">scorm_update_grades</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>);
<a name="l252"><span class="linenum"> 252</span></a>  
<a name="l253"><span class="linenum"> 253</span></a>      return true;
<a name="l254"><span class="linenum"> 254</span></a>  }
<a name="l255"><span class="linenum"> 255</span></a>  
<a name="l256"><span class="linenum"> 256</span></a>  <span class="comment">/**</span>
<a name="l257"><span class="linenum"> 257</span></a>  <span class="comment"> * Given an ID of an instance of this module,</span>
<a name="l258"><span class="linenum"> 258</span></a>  <span class="comment"> * this function will permanently delete the instance</span>
<a name="l259"><span class="linenum"> 259</span></a>  <span class="comment"> * and any data that depends on it.</span>
<a name="l260"><span class="linenum"> 260</span></a>  <span class="comment"> *</span>
<a name="l261"><span class="linenum"> 261</span></a>  <span class="comment"> * @global stdClass</span>
<a name="l262"><span class="linenum"> 262</span></a>  <span class="comment"> * @global object</span>
<a name="l263"><span class="linenum"> 263</span></a>  <span class="comment"> * @param int $id Scorm instance id</span>
<a name="l264"><span class="linenum"> 264</span></a>  <span class="comment"> * @return boolean</span>
<a name="l265"><span class="linenum"> 265</span></a>  <span class="comment"> */</span>
<a name="l266"><span class="linenum"> 266</span></a>  function <a class="function" onClick="logFunction('scorm_delete_instance')" href="../../_functions/scorm_delete_instance.html" onMouseOver="funcPopup(event,'scorm_delete_instance')">scorm_delete_instance</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>) {
<a name="l267"><span class="linenum"> 267</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l268"><span class="linenum"> 268</span></a>  
<a name="l269"><span class="linenum"> 269</span></a>      if (! <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('scorm', array('id' =&gt; <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>))) {
<a name="l270"><span class="linenum"> 270</span></a>          return false;
<a name="l271"><span class="linenum"> 271</span></a>      }
<a name="l272"><span class="linenum"> 272</span></a>  
<a name="l273"><span class="linenum"> 273</span></a>      <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = true;
<a name="l274"><span class="linenum"> 274</span></a>  
<a name="l275"><span class="linenum"> 275</span></a>  <span class="comment">    // Delete any dependent records.</span>
<a name="l276"><span class="linenum"> 276</span></a>      if (! <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('scorm_scoes_track', array('scormid' =&gt; <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('id')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l277"><span class="linenum"> 277</span></a>          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = false;
<a name="l278"><span class="linenum"> 278</span></a>      }
<a name="l279"><span class="linenum"> 279</span></a>      if (<a class="var it5526" onMouseOver="hilite(5526)" onMouseOut="lolite()" onClick="logVariable('scoes')" href="../../_variables/scoes.html">$scoes</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('scorm_scoes', array('scorm' =&gt; <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('id')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l280"><span class="linenum"> 280</span></a>          foreach (<a class="var it5526" onMouseOver="hilite(5526)" onMouseOut="lolite()" onClick="logVariable('scoes')" href="../../_variables/scoes.html">$scoes</a> as <a class="var it5527" onMouseOver="hilite(5527)" onMouseOut="lolite()" onClick="logVariable('sco')" href="../../_variables/sco.html">$sco</a>) {
<a name="l281"><span class="linenum"> 281</span></a>              if (! <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('scorm_scoes_data', array('scoid' =&gt; <a class="var it5527" onMouseOver="hilite(5527)" onMouseOut="lolite()" onClick="logVariable('sco')" href="../../_variables/sco.html">$sco</a>-&gt;<a onClick="logVariable('id')" class="var it44009" onMouseOver="hilite(44009)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l282"><span class="linenum"> 282</span></a>                  <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = false;
<a name="l283"><span class="linenum"> 283</span></a>              }
<a name="l284"><span class="linenum"> 284</span></a>          }
<a name="l285"><span class="linenum"> 285</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('scorm_scoes', array('scorm' =&gt; <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('id')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l286"><span class="linenum"> 286</span></a>      }
<a name="l287"><span class="linenum"> 287</span></a>      if (! <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('scorm', array('id' =&gt; <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('id')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l288"><span class="linenum"> 288</span></a>          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = false;
<a name="l289"><span class="linenum"> 289</span></a>      }
<a name="l290"><span class="linenum"> 290</span></a>  
<a name="l291"><span class="linenum"> 291</span></a>      <span class="comment">/*if (! $DB-&gt;delete_records('scorm_sequencing_controlmode', array('scormid'=&gt;$scorm-&gt;id))) {</span>
<a name="l292"><span class="linenum"> 292</span></a>  <span class="comment">        $result = false;</span>
<a name="l293"><span class="linenum"> 293</span></a>  <span class="comment">    }</span>
<a name="l294"><span class="linenum"> 294</span></a>  <span class="comment">    if (! $DB-&gt;delete_records('scorm_sequencing_rolluprules', array('scormid'=&gt;$scorm-&gt;id))) {</span>
<a name="l295"><span class="linenum"> 295</span></a>  <span class="comment">        $result = false;</span>
<a name="l296"><span class="linenum"> 296</span></a>  <span class="comment">    }</span>
<a name="l297"><span class="linenum"> 297</span></a>  <span class="comment">    if (! $DB-&gt;delete_records('scorm_sequencing_rolluprule', array('scormid'=&gt;$scorm-&gt;id))) {</span>
<a name="l298"><span class="linenum"> 298</span></a>  <span class="comment">        $result = false;</span>
<a name="l299"><span class="linenum"> 299</span></a>  <span class="comment">    }</span>
<a name="l300"><span class="linenum"> 300</span></a>  <span class="comment">    if (! $DB-&gt;delete_records('scorm_sequencing_rollupruleconditions', array('scormid'=&gt;$scorm-&gt;id))) {</span>
<a name="l301"><span class="linenum"> 301</span></a>  <span class="comment">        $result = false;</span>
<a name="l302"><span class="linenum"> 302</span></a>  <span class="comment">    }</span>
<a name="l303"><span class="linenum"> 303</span></a>  <span class="comment">    if (! $DB-&gt;delete_records('scorm_sequencing_rolluprulecondition', array('scormid'=&gt;$scorm-&gt;id))) {</span>
<a name="l304"><span class="linenum"> 304</span></a>  <span class="comment">        $result = false;</span>
<a name="l305"><span class="linenum"> 305</span></a>  <span class="comment">    }</span>
<a name="l306"><span class="linenum"> 306</span></a>  <span class="comment">    if (! $DB-&gt;delete_records('scorm_sequencing_rulecondition', array('scormid'=&gt;$scorm-&gt;id))) {</span>
<a name="l307"><span class="linenum"> 307</span></a>  <span class="comment">        $result = false;</span>
<a name="l308"><span class="linenum"> 308</span></a>  <span class="comment">    }</span>
<a name="l309"><span class="linenum"> 309</span></a>  <span class="comment">    if (! $DB-&gt;delete_records('scorm_sequencing_ruleconditions', array('scormid'=&gt;$scorm-&gt;id))) {</span>
<a name="l310"><span class="linenum"> 310</span></a>  <span class="comment">        $result = false;</span>
<a name="l311"><span class="linenum"> 311</span></a>  <span class="comment">    }*/</span>
<a name="l312"><span class="linenum"> 312</span></a>  
<a name="l313"><span class="linenum"> 313</span></a>      <a class="function" onClick="logFunction('scorm_grade_item_delete')" href="../../_functions/scorm_grade_item_delete.html" onMouseOver="funcPopup(event,'scorm_grade_item_delete')">scorm_grade_item_delete</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>);
<a name="l314"><span class="linenum"> 314</span></a>  
<a name="l315"><span class="linenum"> 315</span></a>      return <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l316"><span class="linenum"> 316</span></a>  }
<a name="l317"><span class="linenum"> 317</span></a>  
<a name="l318"><span class="linenum"> 318</span></a>  <span class="comment">/**</span>
<a name="l319"><span class="linenum"> 319</span></a>  <span class="comment"> * Return a small object with summary information about what a</span>
<a name="l320"><span class="linenum"> 320</span></a>  <span class="comment"> * user has done with a given particular instance of this module</span>
<a name="l321"><span class="linenum"> 321</span></a>  <span class="comment"> * Used for user activity reports.</span>
<a name="l322"><span class="linenum"> 322</span></a>  <span class="comment"> *</span>
<a name="l323"><span class="linenum"> 323</span></a>  <span class="comment"> * @global stdClass</span>
<a name="l324"><span class="linenum"> 324</span></a>  <span class="comment"> * @param int $course Course id</span>
<a name="l325"><span class="linenum"> 325</span></a>  <span class="comment"> * @param int $user User id</span>
<a name="l326"><span class="linenum"> 326</span></a>  <span class="comment"> * @param int $mod</span>
<a name="l327"><span class="linenum"> 327</span></a>  <span class="comment"> * @param int $scorm The scorm id</span>
<a name="l328"><span class="linenum"> 328</span></a>  <span class="comment"> * @return mixed</span>
<a name="l329"><span class="linenum"> 329</span></a>  <span class="comment"> */</span>
<a name="l330"><span class="linenum"> 330</span></a>  function <a class="function" onClick="logFunction('scorm_user_outline')" href="../../_functions/scorm_user_outline.html" onMouseOver="funcPopup(event,'scorm_user_outline')">scorm_user_outline</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>, <a class="var it2586" onMouseOver="hilite(2586)" onMouseOut="lolite()" onClick="logVariable('mod')" href="../../_variables/mod.html">$mod</a>, <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>) {
<a name="l331"><span class="linenum"> 331</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l332"><span class="linenum"> 332</span></a>      require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../mod/scorm/locallib.php.html">/mod/scorm/locallib.php</a>');
<a name="l333"><span class="linenum"> 333</span></a>  
<a name="l334"><span class="linenum"> 334</span></a>      require_once(&quot;<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a>/gradelib.php&quot;);
<a name="l335"><span class="linenum"> 335</span></a>      <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a> = <a class="function" onClick="logFunction('grade_get_grades')" href="../../_functions/grade_get_grades.html" onMouseOver="funcPopup(event,'grade_get_grades')">grade_get_grades</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'mod', 'scorm', <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('id')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l336"><span class="linenum"> 336</span></a>      if (!empty(<a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>-&gt;<a onClick="logVariable('items')" class="var it43825" onMouseOver="hilite(43825)" onMouseOut="lolite()" href="../../_variables/items.html">items</a>[0]-&gt;grades)) {
<a name="l337"><span class="linenum"> 337</span></a>          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>-&gt;<a onClick="logVariable('items')" class="var it43825" onMouseOver="hilite(43825)" onMouseOut="lolite()" href="../../_variables/items.html">items</a>[0]-&gt;grades);
<a name="l338"><span class="linenum"> 338</span></a>          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = new stdClass();
<a name="l339"><span class="linenum"> 339</span></a>          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it43057" onMouseOver="hilite(43057)" onMouseOut="lolite()" href="../../_variables/info.html">info</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('grade') . ': '. <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('str_long_grade')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/str_long_grade.html">str_long_grade</a>;
<a name="l340"><span class="linenum"> 340</span></a>  
<a name="l341"><span class="linenum"> 341</span></a>  <span class="comment">        // Datesubmitted == time created. dategraded == time modified or time overridden</span>
<a name="l342"><span class="linenum"> 342</span></a>  <span class="comment">        // if grade was last modified by the user themselves use date graded. Otherwise use date submitted.</span>
<a name="l343"><span class="linenum"> 343</span></a>  <span class="comment">        // TODO: move this copied &amp; pasted code somewhere in the grades API. See MDL-26704.</span>
<a name="l344"><span class="linenum"> 344</span></a>          if (<a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('usermodified')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/usermodified.html">usermodified</a> == <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> || empty(<a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('datesubmitted')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/datesubmitted.html">datesubmitted</a>)) {
<a name="l345"><span class="linenum"> 345</span></a>              <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('time')" class="var it43057" onMouseOver="hilite(43057)" onMouseOut="lolite()" href="../../_variables/time.html">time</a> = <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('dategraded')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/dategraded.html">dategraded</a>;
<a name="l346"><span class="linenum"> 346</span></a>          } else {
<a name="l347"><span class="linenum"> 347</span></a>              <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('time')" class="var it43057" onMouseOver="hilite(43057)" onMouseOut="lolite()" href="../../_variables/time.html">time</a> = <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('datesubmitted')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/datesubmitted.html">datesubmitted</a>;
<a name="l348"><span class="linenum"> 348</span></a>          }
<a name="l349"><span class="linenum"> 349</span></a>  
<a name="l350"><span class="linenum"> 350</span></a>          return <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l351"><span class="linenum"> 351</span></a>      }
<a name="l352"><span class="linenum"> 352</span></a>      return null;
<a name="l353"><span class="linenum"> 353</span></a>  }
<a name="l354"><span class="linenum"> 354</span></a>  
<a name="l355"><span class="linenum"> 355</span></a>  <span class="comment">/**</span>
<a name="l356"><span class="linenum"> 356</span></a>  <span class="comment"> * Print a detailed representation of what a user has done with</span>
<a name="l357"><span class="linenum"> 357</span></a>  <span class="comment"> * a given particular instance of this module, for user activity reports.</span>
<a name="l358"><span class="linenum"> 358</span></a>  <span class="comment"> *</span>
<a name="l359"><span class="linenum"> 359</span></a>  <span class="comment"> * @global stdClass</span>
<a name="l360"><span class="linenum"> 360</span></a>  <span class="comment"> * @global object</span>
<a name="l361"><span class="linenum"> 361</span></a>  <span class="comment"> * @param object $course</span>
<a name="l362"><span class="linenum"> 362</span></a>  <span class="comment"> * @param object $user</span>
<a name="l363"><span class="linenum"> 363</span></a>  <span class="comment"> * @param object $mod</span>
<a name="l364"><span class="linenum"> 364</span></a>  <span class="comment"> * @param object $scorm</span>
<a name="l365"><span class="linenum"> 365</span></a>  <span class="comment"> * @return boolean</span>
<a name="l366"><span class="linenum"> 366</span></a>  <span class="comment"> */</span>
<a name="l367"><span class="linenum"> 367</span></a>  function <a class="function" onClick="logFunction('scorm_user_complete')" href="../../_functions/scorm_user_complete.html" onMouseOver="funcPopup(event,'scorm_user_complete')">scorm_user_complete</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>, <a class="var it2586" onMouseOver="hilite(2586)" onMouseOut="lolite()" onClick="logVariable('mod')" href="../../_variables/mod.html">$mod</a>, <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>) {
<a name="l368"><span class="linenum"> 368</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>;
<a name="l369"><span class="linenum"> 369</span></a>      require_once(&quot;<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a>/gradelib.php&quot;);
<a name="l370"><span class="linenum"> 370</span></a>  
<a name="l371"><span class="linenum"> 371</span></a>      <a class="var it11910" onMouseOver="hilite(11910)" onMouseOut="lolite()" onClick="logVariable('liststyle')" href="../../_variables/liststyle.html">$liststyle</a> = 'structlist';
<a name="l372"><span class="linenum"> 372</span></a>      <a class="var it3027" onMouseOver="hilite(3027)" onMouseOut="lolite()" onClick="logVariable('now')" href="../../_variables/now.html">$now</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l373"><span class="linenum"> 373</span></a>      <a class="var it11911" onMouseOver="hilite(11911)" onMouseOut="lolite()" onClick="logVariable('firstmodify')" href="../../_variables/firstmodify.html">$firstmodify</a> = <a class="var it3027" onMouseOver="hilite(3027)" onMouseOut="lolite()" onClick="logVariable('now')" href="../../_variables/now.html">$now</a>;
<a name="l374"><span class="linenum"> 374</span></a>      <a class="var it10756" onMouseOver="hilite(10756)" onMouseOut="lolite()" onClick="logVariable('lastmodify')" href="../../_variables/lastmodify.html">$lastmodify</a> = 0;
<a name="l375"><span class="linenum"> 375</span></a>      <a class="var it11912" onMouseOver="hilite(11912)" onMouseOut="lolite()" onClick="logVariable('sometoreport')" href="../../_variables/sometoreport.html">$sometoreport</a> = false;
<a name="l376"><span class="linenum"> 376</span></a>      <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> = '';
<a name="l377"><span class="linenum"> 377</span></a>  
<a name="l378"><span class="linenum"> 378</span></a>  <span class="comment">    // First Access and Last Access dates for SCOs.</span>
<a name="l379"><span class="linenum"> 379</span></a>      require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../mod/scorm/locallib.php.html">/mod/scorm/locallib.php</a>');
<a name="l380"><span class="linenum"> 380</span></a>      <a class="var it5549" onMouseOver="hilite(5549)" onMouseOut="lolite()" onClick="logVariable('timetracks')" href="../../_variables/timetracks.html">$timetracks</a> = <a class="function" onClick="logFunction('scorm_get_sco_runtime')" href="../../_functions/scorm_get_sco_runtime.html" onMouseOver="funcPopup(event,'scorm_get_sco_runtime')">scorm_get_sco_runtime</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('id')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, false, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l381"><span class="linenum"> 381</span></a>      <a class="var it11911" onMouseOver="hilite(11911)" onMouseOut="lolite()" onClick="logVariable('firstmodify')" href="../../_variables/firstmodify.html">$firstmodify</a> = <a class="var it5549" onMouseOver="hilite(5549)" onMouseOut="lolite()" onClick="logVariable('timetracks')" href="../../_variables/timetracks.html">$timetracks</a>-&gt;<a onClick="logVariable('start')" class="var it44691" onMouseOver="hilite(44691)" onMouseOut="lolite()" href="../../_variables/start.html">start</a>;
<a name="l382"><span class="linenum"> 382</span></a>      <a class="var it10756" onMouseOver="hilite(10756)" onMouseOut="lolite()" onClick="logVariable('lastmodify')" href="../../_variables/lastmodify.html">$lastmodify</a> = <a class="var it5549" onMouseOver="hilite(5549)" onMouseOut="lolite()" onClick="logVariable('timetracks')" href="../../_variables/timetracks.html">$timetracks</a>-&gt;<a onClick="logVariable('finish')" class="var it44691" onMouseOver="hilite(44691)" onMouseOut="lolite()" href="../../_variables/finish.html">finish</a>;
<a name="l383"><span class="linenum"> 383</span></a>  
<a name="l384"><span class="linenum"> 384</span></a>      <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a> = <a class="function" onClick="logFunction('grade_get_grades')" href="../../_functions/grade_get_grades.html" onMouseOver="funcPopup(event,'grade_get_grades')">grade_get_grades</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'mod', 'scorm', <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('id')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l385"><span class="linenum"> 385</span></a>      if (!empty(<a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>-&gt;<a onClick="logVariable('items')" class="var it43825" onMouseOver="hilite(43825)" onMouseOut="lolite()" href="../../_variables/items.html">items</a>[0]-&gt;grades)) {
<a name="l386"><span class="linenum"> 386</span></a>          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>-&gt;<a onClick="logVariable('items')" class="var it43825" onMouseOver="hilite(43825)" onMouseOut="lolite()" href="../../_variables/items.html">items</a>[0]-&gt;grades);
<a name="l387"><span class="linenum"> 387</span></a>          echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('container')" href="../../_functions/container.html" onMouseOver="funcPopup(event,'container')">container</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('grade').': '.<a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('str_long_grade')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/str_long_grade.html">str_long_grade</a>);
<a name="l388"><span class="linenum"> 388</span></a>          if (<a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('str_feedback')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/str_feedback.html">str_feedback</a>) {
<a name="l389"><span class="linenum"> 389</span></a>              echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('container')" href="../../_functions/container.html" onMouseOver="funcPopup(event,'container')">container</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('feedback').': '.<a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('str_feedback')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/str_feedback.html">str_feedback</a>);
<a name="l390"><span class="linenum"> 390</span></a>          }
<a name="l391"><span class="linenum"> 391</span></a>      }
<a name="l392"><span class="linenum"> 392</span></a>  
<a name="l393"><span class="linenum"> 393</span></a>      if (<a class="var it10760" onMouseOver="hilite(10760)" onMouseOut="lolite()" onClick="logVariable('orgs')" href="../../_variables/orgs.html">$orgs</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_select')" href="../../_functions/get_records_select.html" onMouseOver="funcPopup(event,'get_records_select')">get_records_select</a>('scorm_scoes', 'scorm = ? AND '.
<a name="l394"><span class="linenum"> 394</span></a>                                           <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_isempty')" href="../../_functions/sql_isempty.html" onMouseOver="funcPopup(event,'sql_isempty')">sql_isempty</a>('scorm_scoes', 'launch', false, true).' AND '.
<a name="l395"><span class="linenum"> 395</span></a>                                           <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_isempty')" href="../../_functions/sql_isempty.html" onMouseOver="funcPopup(event,'sql_isempty')">sql_isempty</a>('scorm_scoes', 'organization', false, false),
<a name="l396"><span class="linenum"> 396</span></a>                                           array(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('id')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>), 'sortorder, id', 'id, identifier, title')) {
<a name="l397"><span class="linenum"> 397</span></a>          if (<a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it10760" onMouseOver="hilite(10760)" onMouseOut="lolite()" onClick="logVariable('orgs')" href="../../_variables/orgs.html">$orgs</a>) &lt;= 1) {
<a name="l398"><span class="linenum"> 398</span></a>              unset(<a class="var it10760" onMouseOver="hilite(10760)" onMouseOut="lolite()" onClick="logVariable('orgs')" href="../../_variables/orgs.html">$orgs</a>);
<a name="l399"><span class="linenum"> 399</span></a>              <a class="var it10760" onMouseOver="hilite(10760)" onMouseOut="lolite()" onClick="logVariable('orgs')" href="../../_variables/orgs.html">$orgs</a> = array();
<a name="l400"><span class="linenum"> 400</span></a>              <a class="var it7990" onMouseOver="hilite(7990)" onMouseOut="lolite()" onClick="logVariable('org')" href="../../_variables/org.html">$org</a> = new stdClass();
<a name="l401"><span class="linenum"> 401</span></a>              <a class="var it7990" onMouseOver="hilite(7990)" onMouseOut="lolite()" onClick="logVariable('org')" href="../../_variables/org.html">$org</a>-&gt;<a onClick="logVariable('identifier')" class="var it43052" onMouseOver="hilite(43052)" onMouseOut="lolite()" href="../../_variables/identifier.html">identifier</a> = '';
<a name="l402"><span class="linenum"> 402</span></a>              <a class="var it10760" onMouseOver="hilite(10760)" onMouseOut="lolite()" onClick="logVariable('orgs')" href="../../_variables/orgs.html">$orgs</a>[] = <a class="var it7990" onMouseOver="hilite(7990)" onMouseOut="lolite()" onClick="logVariable('org')" href="../../_variables/org.html">$org</a>;
<a name="l403"><span class="linenum"> 403</span></a>          }
<a name="l404"><span class="linenum"> 404</span></a>          <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('start_div')" href="../../_functions/start_div.html" onMouseOver="funcPopup(event,'start_div')">start_div</a>('mod-scorm');
<a name="l405"><span class="linenum"> 405</span></a>          foreach (<a class="var it10760" onMouseOver="hilite(10760)" onMouseOut="lolite()" onClick="logVariable('orgs')" href="../../_variables/orgs.html">$orgs</a> as <a class="var it7990" onMouseOver="hilite(7990)" onMouseOut="lolite()" onClick="logVariable('org')" href="../../_variables/org.html">$org</a>) {
<a name="l406"><span class="linenum"> 406</span></a>              <a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a> = array();
<a name="l407"><span class="linenum"> 407</span></a>              <a class="var it10788" onMouseOver="hilite(10788)" onMouseOut="lolite()" onClick="logVariable('currentorg')" href="../../_variables/currentorg.html">$currentorg</a> = '';
<a name="l408"><span class="linenum"> 408</span></a>              if (!empty(<a class="var it7990" onMouseOver="hilite(7990)" onMouseOut="lolite()" onClick="logVariable('org')" href="../../_variables/org.html">$org</a>-&gt;<a onClick="logVariable('identifier')" class="var it43052" onMouseOver="hilite(43052)" onMouseOut="lolite()" href="../../_variables/identifier.html">identifier</a>)) {
<a name="l409"><span class="linenum"> 409</span></a>                  <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('div')" href="../../_functions/div.html" onMouseOver="funcPopup(event,'div')">div</a>(<a class="var it7990" onMouseOver="hilite(7990)" onMouseOut="lolite()" onClick="logVariable('org')" href="../../_variables/org.html">$org</a>-&gt;<a onClick="logVariable('title')" class="var it43052" onMouseOver="hilite(43052)" onMouseOut="lolite()" href="../../_variables/title.html">title</a>, 'orgtitle');
<a name="l410"><span class="linenum"> 410</span></a>                  <a class="var it10788" onMouseOver="hilite(10788)" onMouseOut="lolite()" onClick="logVariable('currentorg')" href="../../_variables/currentorg.html">$currentorg</a> = <a class="var it7990" onMouseOver="hilite(7990)" onMouseOut="lolite()" onClick="logVariable('org')" href="../../_variables/org.html">$org</a>-&gt;<a onClick="logVariable('identifier')" class="var it43052" onMouseOver="hilite(43052)" onMouseOut="lolite()" href="../../_variables/identifier.html">identifier</a>;
<a name="l411"><span class="linenum"> 411</span></a>                  <a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>['organization'] = <a class="var it10788" onMouseOver="hilite(10788)" onMouseOut="lolite()" onClick="logVariable('currentorg')" href="../../_variables/currentorg.html">$currentorg</a>;
<a name="l412"><span class="linenum"> 412</span></a>              }
<a name="l413"><span class="linenum"> 413</span></a>              <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('start_tag')" href="../../_functions/start_tag.html" onMouseOver="funcPopup(event,'start_tag')">start_tag</a>('ul', array('id' =&gt; '0', 'class' =&gt; <a class="var it11910" onMouseOver="hilite(11910)" onMouseOut="lolite()" onClick="logVariable('liststyle')" href="../../_variables/liststyle.html">$liststyle</a>));
<a name="l414"><span class="linenum"> 414</span></a>                  <a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>['scorm'] = <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('id')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l415"><span class="linenum"> 415</span></a>              if (<a class="var it5526" onMouseOver="hilite(5526)" onMouseOut="lolite()" onClick="logVariable('scoes')" href="../../_variables/scoes.html">$scoes</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('scorm_scoes', <a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>, &quot;sortorder, id&quot;)) {
<a name="l416"><span class="linenum"> 416</span></a>  <span class="comment">                // Drop keys so that we can access array sequentially.</span>
<a name="l417"><span class="linenum"> 417</span></a>                  <a class="var it5526" onMouseOver="hilite(5526)" onMouseOut="lolite()" onClick="logVariable('scoes')" href="../../_variables/scoes.html">$scoes</a> = <a class="phpfunction" onClick="logFunction('array_values')" href="../../_functions/array_values.html" onMouseOver="phpfuncPopup(event,'array_values')">array_values</a>(<a class="var it5526" onMouseOver="hilite(5526)" onMouseOut="lolite()" onClick="logVariable('scoes')" href="../../_variables/scoes.html">$scoes</a>);
<a name="l418"><span class="linenum"> 418</span></a>                  <a class="var it482" onMouseOver="hilite(482)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a> = 0;
<a name="l419"><span class="linenum"> 419</span></a>                  <a class="var it11913" onMouseOver="hilite(11913)" onMouseOut="lolite()" onClick="logVariable('sublist')" href="../../_variables/sublist.html">$sublist</a> = 1;
<a name="l420"><span class="linenum"> 420</span></a>                  <a class="var it2400" onMouseOver="hilite(2400)" onMouseOut="lolite()" onClick="logVariable('parents')" href="../../_variables/parents.html">$parents</a>[<a class="var it482" onMouseOver="hilite(482)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a>] = '/';
<a name="l421"><span class="linenum"> 421</span></a>                  foreach (<a class="var it5526" onMouseOver="hilite(5526)" onMouseOut="lolite()" onClick="logVariable('scoes')" href="../../_variables/scoes.html">$scoes</a> as <a class="var it791" onMouseOver="hilite(791)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../../_variables/pos.html">$pos</a> =&gt; <a class="var it5527" onMouseOver="hilite(5527)" onMouseOut="lolite()" onClick="logVariable('sco')" href="../../_variables/sco.html">$sco</a>) {
<a name="l422"><span class="linenum"> 422</span></a>                      if (<a class="var it2400" onMouseOver="hilite(2400)" onMouseOut="lolite()" onClick="logVariable('parents')" href="../../_variables/parents.html">$parents</a>[<a class="var it482" onMouseOver="hilite(482)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a>] != <a class="var it5527" onMouseOver="hilite(5527)" onMouseOut="lolite()" onClick="logVariable('sco')" href="../../_variables/sco.html">$sco</a>-&gt;<a onClick="logVariable('parent')" class="var it44009" onMouseOver="hilite(44009)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>) {
<a name="l423"><span class="linenum"> 423</span></a>                          if (<a class="var it482" onMouseOver="hilite(482)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a> &gt; 0 &amp;&amp; <a class="var it2400" onMouseOver="hilite(2400)" onMouseOut="lolite()" onClick="logVariable('parents')" href="../../_variables/parents.html">$parents</a>[<a class="var it482" onMouseOver="hilite(482)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a> - 1] == <a class="var it5527" onMouseOver="hilite(5527)" onMouseOut="lolite()" onClick="logVariable('sco')" href="../../_variables/sco.html">$sco</a>-&gt;<a onClick="logVariable('parent')" class="var it44009" onMouseOver="hilite(44009)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>) {
<a name="l424"><span class="linenum"> 424</span></a>                              <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('end_tag')" href="../../_functions/end_tag.html" onMouseOver="funcPopup(event,'end_tag')">end_tag</a>('ul').<a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('end_tag')" href="../../_functions/end_tag.html" onMouseOver="funcPopup(event,'end_tag')">end_tag</a>('li');
<a name="l425"><span class="linenum"> 425</span></a>                              <a class="var it482" onMouseOver="hilite(482)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a>--;
<a name="l426"><span class="linenum"> 426</span></a>                          } else {
<a name="l427"><span class="linenum"> 427</span></a>                              <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> = <a class="var it482" onMouseOver="hilite(482)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a>;
<a name="l428"><span class="linenum"> 428</span></a>                              <a class="var it11914" onMouseOver="hilite(11914)" onMouseOut="lolite()" onClick="logVariable('closelist')" href="../../_variables/closelist.html">$closelist</a> = '';
<a name="l429"><span class="linenum"> 429</span></a>                              while ((<a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> &gt; 0) &amp;&amp; (<a class="var it2400" onMouseOver="hilite(2400)" onMouseOut="lolite()" onClick="logVariable('parents')" href="../../_variables/parents.html">$parents</a>[<a class="var it482" onMouseOver="hilite(482)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a>] != <a class="var it5527" onMouseOver="hilite(5527)" onMouseOut="lolite()" onClick="logVariable('sco')" href="../../_variables/sco.html">$sco</a>-&gt;<a onClick="logVariable('parent')" class="var it44009" onMouseOver="hilite(44009)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>)) {
<a name="l430"><span class="linenum"> 430</span></a>                                  <a class="var it11914" onMouseOver="hilite(11914)" onMouseOut="lolite()" onClick="logVariable('closelist')" href="../../_variables/closelist.html">$closelist</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('end_tag')" href="../../_functions/end_tag.html" onMouseOver="funcPopup(event,'end_tag')">end_tag</a>('ul').<a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('end_tag')" href="../../_functions/end_tag.html" onMouseOver="funcPopup(event,'end_tag')">end_tag</a>('li');
<a name="l431"><span class="linenum"> 431</span></a>                                  <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>--;
<a name="l432"><span class="linenum"> 432</span></a>                              }
<a name="l433"><span class="linenum"> 433</span></a>                              if ((<a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> == 0) &amp;&amp; (<a class="var it5527" onMouseOver="hilite(5527)" onMouseOut="lolite()" onClick="logVariable('sco')" href="../../_variables/sco.html">$sco</a>-&gt;<a onClick="logVariable('parent')" class="var it44009" onMouseOver="hilite(44009)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a> != <a class="var it10788" onMouseOver="hilite(10788)" onMouseOut="lolite()" onClick="logVariable('currentorg')" href="../../_variables/currentorg.html">$currentorg</a>)) {
<a name="l434"><span class="linenum"> 434</span></a>                                  <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('start_tag')" href="../../_functions/start_tag.html" onMouseOver="funcPopup(event,'start_tag')">start_tag</a>('li');
<a name="l435"><span class="linenum"> 435</span></a>                                  <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('start_tag')" href="../../_functions/start_tag.html" onMouseOver="funcPopup(event,'start_tag')">start_tag</a>('ul', array('id' =&gt; <a class="var it11913" onMouseOver="hilite(11913)" onMouseOut="lolite()" onClick="logVariable('sublist')" href="../../_variables/sublist.html">$sublist</a>, 'class' =&gt; <a class="var it11910" onMouseOver="hilite(11910)" onMouseOut="lolite()" onClick="logVariable('liststyle')" href="../../_variables/liststyle.html">$liststyle</a>));
<a name="l436"><span class="linenum"> 436</span></a>                                  <a class="var it482" onMouseOver="hilite(482)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a>++;
<a name="l437"><span class="linenum"> 437</span></a>                              } else {
<a name="l438"><span class="linenum"> 438</span></a>                                  <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> .= <a class="var it11914" onMouseOver="hilite(11914)" onMouseOut="lolite()" onClick="logVariable('closelist')" href="../../_variables/closelist.html">$closelist</a>;
<a name="l439"><span class="linenum"> 439</span></a>                                  <a class="var it482" onMouseOver="hilite(482)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a> = <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>;
<a name="l440"><span class="linenum"> 440</span></a>                              }
<a name="l441"><span class="linenum"> 441</span></a>                              <a class="var it2400" onMouseOver="hilite(2400)" onMouseOut="lolite()" onClick="logVariable('parents')" href="../../_variables/parents.html">$parents</a>[<a class="var it482" onMouseOver="hilite(482)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a>] = <a class="var it5527" onMouseOver="hilite(5527)" onMouseOut="lolite()" onClick="logVariable('sco')" href="../../_variables/sco.html">$sco</a>-&gt;<a onClick="logVariable('parent')" class="var it44009" onMouseOver="hilite(44009)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>;
<a name="l442"><span class="linenum"> 442</span></a>                          }
<a name="l443"><span class="linenum"> 443</span></a>                      }
<a name="l444"><span class="linenum"> 444</span></a>                      <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('start_tag')" href="../../_functions/start_tag.html" onMouseOver="funcPopup(event,'start_tag')">start_tag</a>('li');
<a name="l445"><span class="linenum"> 445</span></a>                      if (isset(<a class="var it5526" onMouseOver="hilite(5526)" onMouseOut="lolite()" onClick="logVariable('scoes')" href="../../_variables/scoes.html">$scoes</a>[<a class="var it791" onMouseOver="hilite(791)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../../_variables/pos.html">$pos</a> + 1])) {
<a name="l446"><span class="linenum"> 446</span></a>                          <a class="var it11915" onMouseOver="hilite(11915)" onMouseOut="lolite()" onClick="logVariable('nextsco')" href="../../_variables/nextsco.html">$nextsco</a> = <a class="var it5526" onMouseOver="hilite(5526)" onMouseOut="lolite()" onClick="logVariable('scoes')" href="../../_variables/scoes.html">$scoes</a>[<a class="var it791" onMouseOver="hilite(791)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../../_variables/pos.html">$pos</a> + 1];
<a name="l447"><span class="linenum"> 447</span></a>                      } else {
<a name="l448"><span class="linenum"> 448</span></a>                          <a class="var it11915" onMouseOver="hilite(11915)" onMouseOut="lolite()" onClick="logVariable('nextsco')" href="../../_variables/nextsco.html">$nextsco</a> = false;
<a name="l449"><span class="linenum"> 449</span></a>                      }
<a name="l450"><span class="linenum"> 450</span></a>                      if ((<a class="var it11915" onMouseOver="hilite(11915)" onMouseOut="lolite()" onClick="logVariable('nextsco')" href="../../_variables/nextsco.html">$nextsco</a> !== false) &amp;&amp; (<a class="var it5527" onMouseOver="hilite(5527)" onMouseOut="lolite()" onClick="logVariable('sco')" href="../../_variables/sco.html">$sco</a>-&gt;<a onClick="logVariable('parent')" class="var it44009" onMouseOver="hilite(44009)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a> != <a class="var it11915" onMouseOver="hilite(11915)" onMouseOut="lolite()" onClick="logVariable('nextsco')" href="../../_variables/nextsco.html">$nextsco</a>-&gt;<a onClick="logVariable('parent')" class="var it45073" onMouseOver="hilite(45073)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a>) &amp;&amp;
<a name="l451"><span class="linenum"> 451</span></a>                              ((<a class="var it482" onMouseOver="hilite(482)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a> == 0) || ((<a class="var it482" onMouseOver="hilite(482)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a> &gt; 0) &amp;&amp; (<a class="var it11915" onMouseOver="hilite(11915)" onMouseOut="lolite()" onClick="logVariable('nextsco')" href="../../_variables/nextsco.html">$nextsco</a>-&gt;<a onClick="logVariable('parent')" class="var it45073" onMouseOver="hilite(45073)" onMouseOut="lolite()" href="../../_variables/parent.html">parent</a> == <a class="var it5527" onMouseOver="hilite(5527)" onMouseOut="lolite()" onClick="logVariable('sco')" href="../../_variables/sco.html">$sco</a>-&gt;<a onClick="logVariable('identifier')" class="var it44009" onMouseOver="hilite(44009)" onMouseOut="lolite()" href="../../_variables/identifier.html">identifier</a>)))) {
<a name="l452"><span class="linenum"> 452</span></a>                          <a class="var it11913" onMouseOver="hilite(11913)" onMouseOut="lolite()" onClick="logVariable('sublist')" href="../../_variables/sublist.html">$sublist</a>++;
<a name="l453"><span class="linenum"> 453</span></a>                      } else {
<a name="l454"><span class="linenum"> 454</span></a>                          <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> .= <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('spacer')" href="../../_functions/spacer.html" onMouseOver="funcPopup(event,'spacer')">spacer</a>(array(&quot;height&quot; =&gt; &quot;12&quot;, &quot;width&quot; =&gt; &quot;13&quot;));
<a name="l455"><span class="linenum"> 455</span></a>                      }
<a name="l456"><span class="linenum"> 456</span></a>  
<a name="l457"><span class="linenum"> 457</span></a>                      if (<a class="var it5527" onMouseOver="hilite(5527)" onMouseOut="lolite()" onClick="logVariable('sco')" href="../../_variables/sco.html">$sco</a>-&gt;<a onClick="logVariable('launch')" class="var it44009" onMouseOver="hilite(44009)" onMouseOut="lolite()" href="../../_variables/launch.html">launch</a>) {
<a name="l458"><span class="linenum"> 458</span></a>                          <a class="var it647" onMouseOver="hilite(647)" onMouseOut="lolite()" onClick="logVariable('score')" href="../../_variables/score.html">$score</a> = '';
<a name="l459"><span class="linenum"> 459</span></a>                          <a class="var it11916" onMouseOver="hilite(11916)" onMouseOut="lolite()" onClick="logVariable('totaltime')" href="../../_variables/totaltime.html">$totaltime</a> = '';
<a name="l460"><span class="linenum"> 460</span></a>                          if (<a class="var it10750" onMouseOver="hilite(10750)" onMouseOut="lolite()" onClick="logVariable('usertrack')" href="../../_variables/usertrack.html">$usertrack</a> = <a class="function" onClick="logFunction('scorm_get_tracks')" href="../../_functions/scorm_get_tracks.html" onMouseOver="funcPopup(event,'scorm_get_tracks')">scorm_get_tracks</a>(<a class="var it5527" onMouseOver="hilite(5527)" onMouseOut="lolite()" onClick="logVariable('sco')" href="../../_variables/sco.html">$sco</a>-&gt;<a onClick="logVariable('id')" class="var it44009" onMouseOver="hilite(44009)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>)) {
<a name="l461"><span class="linenum"> 461</span></a>                              if (<a class="var it10750" onMouseOver="hilite(10750)" onMouseOut="lolite()" onClick="logVariable('usertrack')" href="../../_variables/usertrack.html">$usertrack</a>-&gt;<a onClick="logVariable('status')" class="var it45074" onMouseOver="hilite(45074)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> == '') {
<a name="l462"><span class="linenum"> 462</span></a>                                  <a class="var it10750" onMouseOver="hilite(10750)" onMouseOut="lolite()" onClick="logVariable('usertrack')" href="../../_variables/usertrack.html">$usertrack</a>-&gt;<a onClick="logVariable('status')" class="var it45074" onMouseOver="hilite(45074)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = 'notattempted';
<a name="l463"><span class="linenum"> 463</span></a>                              }
<a name="l464"><span class="linenum"> 464</span></a>                              <a class="var it5552" onMouseOver="hilite(5552)" onMouseOut="lolite()" onClick="logVariable('strstatus')" href="../../_variables/strstatus.html">$strstatus</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(<a class="var it10750" onMouseOver="hilite(10750)" onMouseOut="lolite()" onClick="logVariable('usertrack')" href="../../_variables/usertrack.html">$usertrack</a>-&gt;<a onClick="logVariable('status')" class="var it45074" onMouseOver="hilite(45074)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>, 'scorm');
<a name="l465"><span class="linenum"> 465</span></a>                              <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('img')" href="../../_functions/img.html" onMouseOver="funcPopup(event,'img')">img</a>(<a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('pix_url')" href="../../_functions/pix_url.html" onMouseOver="funcPopup(event,'pix_url')">pix_url</a>(<a class="var it10750" onMouseOver="hilite(10750)" onMouseOut="lolite()" onClick="logVariable('usertrack')" href="../../_variables/usertrack.html">$usertrack</a>-&gt;<a onClick="logVariable('status')" class="var it45074" onMouseOver="hilite(45074)" onMouseOut="lolite()" href="../../_variables/status.html">status</a>, 'scorm'),
<a name="l466"><span class="linenum"> 466</span></a>                                                          <a class="var it5552" onMouseOver="hilite(5552)" onMouseOut="lolite()" onClick="logVariable('strstatus')" href="../../_variables/strstatus.html">$strstatus</a>, array('title' =&gt; <a class="var it5552" onMouseOver="hilite(5552)" onMouseOut="lolite()" onClick="logVariable('strstatus')" href="../../_variables/strstatus.html">$strstatus</a>));
<a name="l467"><span class="linenum"> 467</span></a>                          } else {
<a name="l468"><span class="linenum"> 468</span></a>                              if (<a class="var it5527" onMouseOver="hilite(5527)" onMouseOut="lolite()" onClick="logVariable('sco')" href="../../_variables/sco.html">$sco</a>-&gt;<a onClick="logVariable('scormtype')" class="var it44009" onMouseOver="hilite(44009)" onMouseOut="lolite()" href="../../_variables/scormtype.html">scormtype</a> == 'sco') {
<a name="l469"><span class="linenum"> 469</span></a>                                  <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('img')" href="../../_functions/img.html" onMouseOver="funcPopup(event,'img')">img</a>(<a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('pix_url')" href="../../_functions/pix_url.html" onMouseOver="funcPopup(event,'pix_url')">pix_url</a>('notattempted', 'scorm'),
<a name="l470"><span class="linenum"> 470</span></a>                                                              <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('notattempted', 'scorm'),
<a name="l471"><span class="linenum"> 471</span></a>                                                              array('title' =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('notattempted', 'scorm')));
<a name="l472"><span class="linenum"> 472</span></a>                              } else {
<a name="l473"><span class="linenum"> 473</span></a>                                  <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('img')" href="../../_functions/img.html" onMouseOver="funcPopup(event,'img')">img</a>(<a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('pix_url')" href="../../_functions/pix_url.html" onMouseOver="funcPopup(event,'pix_url')">pix_url</a>('asset', 'scorm'), <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('asset', 'scorm'),
<a name="l474"><span class="linenum"> 474</span></a>                                                              array('title' =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('asset', 'scorm')));
<a name="l475"><span class="linenum"> 475</span></a>                              }
<a name="l476"><span class="linenum"> 476</span></a>                          }
<a name="l477"><span class="linenum"> 477</span></a>                          <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> .= &quot;&amp;nbsp;<a class="var it5527" onMouseOver="hilite(5527)" onMouseOut="lolite()" onClick="logVariable('sco')" href="../../_variables/sco.html">$sco</a>-&gt;<a onClick="logVariable('title')" class="var it44009" onMouseOver="hilite(44009)" onMouseOut="lolite()" href="../../_variables/title.html">title</a> <a class="var it647" onMouseOver="hilite(647)" onMouseOut="lolite()" onClick="logVariable('score')" href="../../_variables/score.html">$score</a><a class="var it11916" onMouseOver="hilite(11916)" onMouseOut="lolite()" onClick="logVariable('totaltime')" href="../../_variables/totaltime.html">$totaltime</a>&quot;.<a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('end_tag')" href="../../_functions/end_tag.html" onMouseOver="funcPopup(event,'end_tag')">end_tag</a>('li');
<a name="l478"><span class="linenum"> 478</span></a>                          if (<a class="var it10750" onMouseOver="hilite(10750)" onMouseOut="lolite()" onClick="logVariable('usertrack')" href="../../_variables/usertrack.html">$usertrack</a> !== false) {
<a name="l479"><span class="linenum"> 479</span></a>                              <a class="var it11912" onMouseOver="hilite(11912)" onMouseOut="lolite()" onClick="logVariable('sometoreport')" href="../../_variables/sometoreport.html">$sometoreport</a> = true;
<a name="l480"><span class="linenum"> 480</span></a>                              <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('start_tag')" href="../../_functions/start_tag.html" onMouseOver="funcPopup(event,'start_tag')">start_tag</a>('li').<a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('start_tag')" href="../../_functions/start_tag.html" onMouseOver="funcPopup(event,'start_tag')">start_tag</a>('ul', array('class' =&gt; <a class="var it11910" onMouseOver="hilite(11910)" onMouseOut="lolite()" onClick="logVariable('liststyle')" href="../../_variables/liststyle.html">$liststyle</a>));
<a name="l481"><span class="linenum"> 481</span></a>                              foreach (<a class="var it10750" onMouseOver="hilite(10750)" onMouseOut="lolite()" onClick="logVariable('usertrack')" href="../../_variables/usertrack.html">$usertrack</a> as <a class="var it634" onMouseOver="hilite(634)" onMouseOut="lolite()" onClick="logVariable('element')" href="../../_variables/element.html">$element</a> =&gt; <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l482"><span class="linenum"> 482</span></a>                                  if (<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it634" onMouseOver="hilite(634)" onMouseOut="lolite()" onClick="logVariable('element')" href="../../_variables/element.html">$element</a>, 0, 3) == 'cmi') {
<a name="l483"><span class="linenum"> 483</span></a>                                      <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('tag')" href="../../_functions/tag.html" onMouseOver="funcPopup(event,'tag')">tag</a>('li', <a class="var it634" onMouseOver="hilite(634)" onMouseOut="lolite()" onClick="logVariable('element')" href="../../_variables/element.html">$element</a>.' =&gt; '.<a class="function" onClick="logFunction('s')" href="../../_functions/s.html" onMouseOver="funcPopup(event,'s')">s</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>));
<a name="l484"><span class="linenum"> 484</span></a>                                  }
<a name="l485"><span class="linenum"> 485</span></a>                              }
<a name="l486"><span class="linenum"> 486</span></a>                              <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('end_tag')" href="../../_functions/end_tag.html" onMouseOver="funcPopup(event,'end_tag')">end_tag</a>('ul').<a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('end_tag')" href="../../_functions/end_tag.html" onMouseOver="funcPopup(event,'end_tag')">end_tag</a>('li');
<a name="l487"><span class="linenum"> 487</span></a>                          }
<a name="l488"><span class="linenum"> 488</span></a>                      } else {
<a name="l489"><span class="linenum"> 489</span></a>                          <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> .= &quot;&amp;nbsp;<a class="var it5527" onMouseOver="hilite(5527)" onMouseOut="lolite()" onClick="logVariable('sco')" href="../../_variables/sco.html">$sco</a>-&gt;<a onClick="logVariable('title')" class="var it44009" onMouseOver="hilite(44009)" onMouseOut="lolite()" href="../../_variables/title.html">title</a>&quot;.<a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('end_tag')" href="../../_functions/end_tag.html" onMouseOver="funcPopup(event,'end_tag')">end_tag</a>('li');
<a name="l490"><span class="linenum"> 490</span></a>                      }
<a name="l491"><span class="linenum"> 491</span></a>                  }
<a name="l492"><span class="linenum"> 492</span></a>                  for (<a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> = 0; <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> &lt; <a class="var it482" onMouseOver="hilite(482)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a>; <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>++) {
<a name="l493"><span class="linenum"> 493</span></a>                      <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('end_tag')" href="../../_functions/end_tag.html" onMouseOver="funcPopup(event,'end_tag')">end_tag</a>('ul').<a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('end_tag')" href="../../_functions/end_tag.html" onMouseOver="funcPopup(event,'end_tag')">end_tag</a>('li');
<a name="l494"><span class="linenum"> 494</span></a>                  }
<a name="l495"><span class="linenum"> 495</span></a>              }
<a name="l496"><span class="linenum"> 496</span></a>              <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('end_tag')" href="../../_functions/end_tag.html" onMouseOver="funcPopup(event,'end_tag')">end_tag</a>('ul').<a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('empty_tag')" href="../../_functions/empty_tag.html" onMouseOver="funcPopup(event,'empty_tag')">empty_tag</a>('br');
<a name="l497"><span class="linenum"> 497</span></a>          }
<a name="l498"><span class="linenum"> 498</span></a>          <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('end_div')" href="../../_functions/end_div.html" onMouseOver="funcPopup(event,'end_div')">end_div</a>();
<a name="l499"><span class="linenum"> 499</span></a>      }
<a name="l500"><span class="linenum"> 500</span></a>      if (<a class="var it11912" onMouseOver="hilite(11912)" onMouseOut="lolite()" onClick="logVariable('sometoreport')" href="../../_variables/sometoreport.html">$sometoreport</a>) {
<a name="l501"><span class="linenum"> 501</span></a>          if (<a class="var it11911" onMouseOver="hilite(11911)" onMouseOut="lolite()" onClick="logVariable('firstmodify')" href="../../_variables/firstmodify.html">$firstmodify</a> &lt; <a class="var it3027" onMouseOver="hilite(3027)" onMouseOut="lolite()" onClick="logVariable('now')" href="../../_variables/now.html">$now</a>) {
<a name="l502"><span class="linenum"> 502</span></a>              <a class="var it11917" onMouseOver="hilite(11917)" onMouseOut="lolite()" onClick="logVariable('timeago')" href="../../_variables/timeago.html">$timeago</a> = <a class="function" onClick="logFunction('format_time')" href="../../_functions/format_time.html" onMouseOver="funcPopup(event,'format_time')">format_time</a>(<a class="var it3027" onMouseOver="hilite(3027)" onMouseOut="lolite()" onClick="logVariable('now')" href="../../_variables/now.html">$now</a> - <a class="var it11911" onMouseOver="hilite(11911)" onMouseOut="lolite()" onClick="logVariable('firstmodify')" href="../../_variables/firstmodify.html">$firstmodify</a>);
<a name="l503"><span class="linenum"> 503</span></a>              echo <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('firstaccess', 'scorm').': '.<a class="function" onClick="logFunction('userdate')" href="../../_functions/userdate.html" onMouseOver="funcPopup(event,'userdate')">userdate</a>(<a class="var it11911" onMouseOver="hilite(11911)" onMouseOut="lolite()" onClick="logVariable('firstmodify')" href="../../_variables/firstmodify.html">$firstmodify</a>).' ('.<a class="var it11917" onMouseOver="hilite(11917)" onMouseOut="lolite()" onClick="logVariable('timeago')" href="../../_variables/timeago.html">$timeago</a>.&quot;)&quot;.<a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('empty_tag')" href="../../_functions/empty_tag.html" onMouseOver="funcPopup(event,'empty_tag')">empty_tag</a>('br');
<a name="l504"><span class="linenum"> 504</span></a>          }
<a name="l505"><span class="linenum"> 505</span></a>          if (<a class="var it10756" onMouseOver="hilite(10756)" onMouseOut="lolite()" onClick="logVariable('lastmodify')" href="../../_variables/lastmodify.html">$lastmodify</a> &gt; 0) {
<a name="l506"><span class="linenum"> 506</span></a>              <a class="var it11917" onMouseOver="hilite(11917)" onMouseOut="lolite()" onClick="logVariable('timeago')" href="../../_variables/timeago.html">$timeago</a> = <a class="function" onClick="logFunction('format_time')" href="../../_functions/format_time.html" onMouseOver="funcPopup(event,'format_time')">format_time</a>(<a class="var it3027" onMouseOver="hilite(3027)" onMouseOut="lolite()" onClick="logVariable('now')" href="../../_variables/now.html">$now</a> - <a class="var it10756" onMouseOver="hilite(10756)" onMouseOut="lolite()" onClick="logVariable('lastmodify')" href="../../_variables/lastmodify.html">$lastmodify</a>);
<a name="l507"><span class="linenum"> 507</span></a>              echo <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('lastaccess', 'scorm').': '.<a class="function" onClick="logFunction('userdate')" href="../../_functions/userdate.html" onMouseOver="funcPopup(event,'userdate')">userdate</a>(<a class="var it10756" onMouseOver="hilite(10756)" onMouseOut="lolite()" onClick="logVariable('lastmodify')" href="../../_variables/lastmodify.html">$lastmodify</a>).' ('.<a class="var it11917" onMouseOver="hilite(11917)" onMouseOut="lolite()" onClick="logVariable('timeago')" href="../../_variables/timeago.html">$timeago</a>.&quot;)&quot;.<a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('empty_tag')" href="../../_functions/empty_tag.html" onMouseOver="funcPopup(event,'empty_tag')">empty_tag</a>('br');
<a name="l508"><span class="linenum"> 508</span></a>          }
<a name="l509"><span class="linenum"> 509</span></a>          echo <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('report', 'scorm').&quot;:&quot;.<a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('empty_tag')" href="../../_functions/empty_tag.html" onMouseOver="funcPopup(event,'empty_tag')">empty_tag</a>('br');
<a name="l510"><span class="linenum"> 510</span></a>          echo <a class="var it3795" onMouseOver="hilite(3795)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a>;
<a name="l511"><span class="linenum"> 511</span></a>      } else {
<a name="l512"><span class="linenum"> 512</span></a>          <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>('noactivity', 'scorm');
<a name="l513"><span class="linenum"> 513</span></a>      }
<a name="l514"><span class="linenum"> 514</span></a>  
<a name="l515"><span class="linenum"> 515</span></a>      return true;
<a name="l516"><span class="linenum"> 516</span></a>  }
<a name="l517"><span class="linenum"> 517</span></a>  
<a name="l518"><span class="linenum"> 518</span></a>  <span class="comment">/**</span>
<a name="l519"><span class="linenum"> 519</span></a>  <span class="comment"> * Function to be run periodically according to the moodle cron</span>
<a name="l520"><span class="linenum"> 520</span></a>  <span class="comment"> * This function searches for things that need to be done, such</span>
<a name="l521"><span class="linenum"> 521</span></a>  <span class="comment"> * as sending out mail, toggling flags etc ...</span>
<a name="l522"><span class="linenum"> 522</span></a>  <span class="comment"> *</span>
<a name="l523"><span class="linenum"> 523</span></a>  <span class="comment"> * @global stdClass</span>
<a name="l524"><span class="linenum"> 524</span></a>  <span class="comment"> * @global object</span>
<a name="l525"><span class="linenum"> 525</span></a>  <span class="comment"> * @return boolean</span>
<a name="l526"><span class="linenum"> 526</span></a>  <span class="comment"> */</span>
<a name="l527"><span class="linenum"> 527</span></a>  function <a class="function" onClick="logFunction('scorm_cron')" href="../../_functions/scorm_cron.html" onMouseOver="funcPopup(event,'scorm_cron')">scorm_cron</a> () {
<a name="l528"><span class="linenum"> 528</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l529"><span class="linenum"> 529</span></a>  
<a name="l530"><span class="linenum"> 530</span></a>      require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../mod/scorm/locallib.php.html">/mod/scorm/locallib.php</a>');
<a name="l531"><span class="linenum"> 531</span></a>  
<a name="l532"><span class="linenum"> 532</span></a>      <a class="var it11918" onMouseOver="hilite(11918)" onMouseOut="lolite()" onClick="logVariable('sitetimezone')" href="../../_variables/sitetimezone.html">$sitetimezone</a> = <a class="class" onClick="logClass('core_date')" href="../../_classes/core_date.html" onMouseOver="classPopup(event,'core_date')">core_date</a>::<a class="function" onClick="logFunction('get_server_timezone')" href="../../_functions/get_server_timezone.html" onMouseOver="funcPopup(event,'get_server_timezone')">get_server_timezone</a>();
<a name="l533"><span class="linenum"> 533</span></a>  <span class="comment">    // Now see if there are any scorm updates to be done.</span>
<a name="l534"><span class="linenum"> 534</span></a>  
<a name="l535"><span class="linenum"> 535</span></a>      if (!isset(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('scorm_updatetimelast')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/scorm_updatetimelast.html">scorm_updatetimelast</a>)) {    // To catch the first time.
<a name="l536"><span class="linenum"> 536</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('scorm_updatetimelast', 0);
<a name="l537"><span class="linenum"> 537</span></a>      }
<a name="l538"><span class="linenum"> 538</span></a>  
<a name="l539"><span class="linenum"> 539</span></a>      <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l540"><span class="linenum"> 540</span></a>      <a class="var it11920" onMouseOver="hilite(11920)" onMouseOut="lolite()" onClick="logVariable('updatetime')" href="../../_variables/updatetime.html">$updatetime</a> = <a class="function" onClick="logFunction('usergetmidnight')" href="../../_functions/usergetmidnight.html" onMouseOver="funcPopup(event,'usergetmidnight')">usergetmidnight</a>(<a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a>, <a class="var it11918" onMouseOver="hilite(11918)" onMouseOut="lolite()" onClick="logVariable('sitetimezone')" href="../../_variables/sitetimezone.html">$sitetimezone</a>);
<a name="l541"><span class="linenum"> 541</span></a>  
<a name="l542"><span class="linenum"> 542</span></a>      if (<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('scorm_updatetimelast')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/scorm_updatetimelast.html">scorm_updatetimelast</a> &lt; <a class="var it11920" onMouseOver="hilite(11920)" onMouseOut="lolite()" onClick="logVariable('updatetime')" href="../../_variables/updatetime.html">$updatetime</a> and <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a> &gt; <a class="var it11920" onMouseOver="hilite(11920)" onMouseOut="lolite()" onClick="logVariable('updatetime')" href="../../_variables/updatetime.html">$updatetime</a>) {
<a name="l543"><span class="linenum"> 543</span></a>  
<a name="l544"><span class="linenum"> 544</span></a>          <a class="function" onClick="logFunction('set_config')" href="../../_functions/set_config.html" onMouseOver="funcPopup(event,'set_config')">set_config</a>('scorm_updatetimelast', <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a>);
<a name="l545"><span class="linenum"> 545</span></a>  
<a name="l546"><span class="linenum"> 546</span></a>          <a class="function" onClick="logFunction('mtrace')" href="../../_functions/mtrace.html" onMouseOver="funcPopup(event,'mtrace')">mtrace</a>('Updating scorm packages which require daily update');<span class="comment">// We are updating.</span>
<a name="l547"><span class="linenum"> 547</span></a>  
<a name="l548"><span class="linenum"> 548</span></a>          <a class="var it11921" onMouseOver="hilite(11921)" onMouseOut="lolite()" onClick="logVariable('scormsupdate')" href="../../_variables/scormsupdate.html">$scormsupdate</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('scorm', array('updatefreq' =&gt; <a class="constant" onClick="logConstant('SCORM_UPDATE_EVERYDAY')" href="../../_constants/SCORM_UPDATE_EVERYDAY.html" onMouseOver="constPopup(event,'SCORM_UPDATE_EVERYDAY')">SCORM_UPDATE_EVERYDAY</a>));
<a name="l549"><span class="linenum"> 549</span></a>          foreach (<a class="var it11921" onMouseOver="hilite(11921)" onMouseOut="lolite()" onClick="logVariable('scormsupdate')" href="../../_variables/scormsupdate.html">$scormsupdate</a> as <a class="var it11922" onMouseOver="hilite(11922)" onMouseOut="lolite()" onClick="logVariable('scormupdate')" href="../../_variables/scormupdate.html">$scormupdate</a>) {
<a name="l550"><span class="linenum"> 550</span></a>              <a class="function" onClick="logFunction('scorm_parse')" href="../../_functions/scorm_parse.html" onMouseOver="funcPopup(event,'scorm_parse')">scorm_parse</a>(<a class="var it11922" onMouseOver="hilite(11922)" onMouseOut="lolite()" onClick="logVariable('scormupdate')" href="../../_variables/scormupdate.html">$scormupdate</a>, true);
<a name="l551"><span class="linenum"> 551</span></a>          }
<a name="l552"><span class="linenum"> 552</span></a>  
<a name="l553"><span class="linenum"> 553</span></a>  <span class="comment">        // Now clear out AICC session table with old session data.</span>
<a name="l554"><span class="linenum"> 554</span></a>          <a class="var it587" onMouseOver="hilite(587)" onMouseOut="lolite()" onClick="logVariable('cfgscorm')" href="../../_variables/cfgscorm.html">$cfgscorm</a> = <a class="function" onClick="logFunction('get_config')" href="../../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>('scorm');
<a name="l555"><span class="linenum"> 555</span></a>          if (!empty(<a class="var it587" onMouseOver="hilite(587)" onMouseOut="lolite()" onClick="logVariable('cfgscorm')" href="../../_variables/cfgscorm.html">$cfgscorm</a>-&gt;<a onClick="logVariable('allowaicchacp')" class="var it43741" onMouseOver="hilite(43741)" onMouseOut="lolite()" href="../../_variables/allowaicchacp.html">allowaicchacp</a>)) {
<a name="l556"><span class="linenum"> 556</span></a>              <a class="var it11924" onMouseOver="hilite(11924)" onMouseOut="lolite()" onClick="logVariable('expiretime')" href="../../_variables/expiretime.html">$expiretime</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() - (<a class="var it587" onMouseOver="hilite(587)" onMouseOut="lolite()" onClick="logVariable('cfgscorm')" href="../../_variables/cfgscorm.html">$cfgscorm</a>-&gt;<a onClick="logVariable('aicchacpkeepsessiondata')" class="var it43741" onMouseOver="hilite(43741)" onMouseOut="lolite()" href="../../_variables/aicchacpkeepsessiondata.html">aicchacpkeepsessiondata</a> * 24 * 60 * 60);
<a name="l557"><span class="linenum"> 557</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records_select')" href="../../_functions/delete_records_select.html" onMouseOver="funcPopup(event,'delete_records_select')">delete_records_select</a>('scorm_aicc_session', 'timemodified &lt; ?', array(<a class="var it11924" onMouseOver="hilite(11924)" onMouseOut="lolite()" onClick="logVariable('expiretime')" href="../../_variables/expiretime.html">$expiretime</a>));
<a name="l558"><span class="linenum"> 558</span></a>          }
<a name="l559"><span class="linenum"> 559</span></a>      }
<a name="l560"><span class="linenum"> 560</span></a>  
<a name="l561"><span class="linenum"> 561</span></a>      return true;
<a name="l562"><span class="linenum"> 562</span></a>  }
<a name="l563"><span class="linenum"> 563</span></a>  
<a name="l564"><span class="linenum"> 564</span></a>  <span class="comment">/**</span>
<a name="l565"><span class="linenum"> 565</span></a>  <span class="comment"> * Return grade for given user or all users.</span>
<a name="l566"><span class="linenum"> 566</span></a>  <span class="comment"> *</span>
<a name="l567"><span class="linenum"> 567</span></a>  <span class="comment"> * @global stdClass</span>
<a name="l568"><span class="linenum"> 568</span></a>  <span class="comment"> * @global object</span>
<a name="l569"><span class="linenum"> 569</span></a>  <span class="comment"> * @param int $scormid id of scorm</span>
<a name="l570"><span class="linenum"> 570</span></a>  <span class="comment"> * @param int $userid optional user id, 0 means all users</span>
<a name="l571"><span class="linenum"> 571</span></a>  <span class="comment"> * @return array array of grades, false if none</span>
<a name="l572"><span class="linenum"> 572</span></a>  <span class="comment"> */</span>
<a name="l573"><span class="linenum"> 573</span></a>  function <a class="function" onClick="logFunction('scorm_get_user_grades')" href="../../_functions/scorm_get_user_grades.html" onMouseOver="funcPopup(event,'scorm_get_user_grades')">scorm_get_user_grades</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>=0) {
<a name="l574"><span class="linenum"> 574</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l575"><span class="linenum"> 575</span></a>      require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../mod/scorm/locallib.php.html">/mod/scorm/locallib.php</a>');
<a name="l576"><span class="linenum"> 576</span></a>  
<a name="l577"><span class="linenum"> 577</span></a>      <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a> = array();
<a name="l578"><span class="linenum"> 578</span></a>      if (empty(<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>)) {
<a name="l579"><span class="linenum"> 579</span></a>          <a class="var it11926" onMouseOver="hilite(11926)" onMouseOut="lolite()" onClick="logVariable('scousers')" href="../../_variables/scousers.html">$scousers</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_select')" href="../../_functions/get_records_select.html" onMouseOver="funcPopup(event,'get_records_select')">get_records_select</a>('scorm_scoes_track', &quot;scormid=? GROUP BY userid&quot;,
<a name="l580"><span class="linenum"> 580</span></a>                                              array(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('id')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>), &quot;&quot;, &quot;userid,null&quot;);
<a name="l581"><span class="linenum"> 581</span></a>          if (<a class="var it11926" onMouseOver="hilite(11926)" onMouseOut="lolite()" onClick="logVariable('scousers')" href="../../_variables/scousers.html">$scousers</a>) {
<a name="l582"><span class="linenum"> 582</span></a>              foreach (<a class="var it11926" onMouseOver="hilite(11926)" onMouseOut="lolite()" onClick="logVariable('scousers')" href="../../_variables/scousers.html">$scousers</a> as <a class="var it5548" onMouseOver="hilite(5548)" onMouseOut="lolite()" onClick="logVariable('scouser')" href="../../_variables/scouser.html">$scouser</a>) {
<a name="l583"><span class="linenum"> 583</span></a>                  <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>[<a class="var it5548" onMouseOver="hilite(5548)" onMouseOut="lolite()" onClick="logVariable('scouser')" href="../../_variables/scouser.html">$scouser</a>-&gt;<a onClick="logVariable('userid')" class="var it44690" onMouseOver="hilite(44690)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>] = new stdClass();
<a name="l584"><span class="linenum"> 584</span></a>                  <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>[<a class="var it5548" onMouseOver="hilite(5548)" onMouseOut="lolite()" onClick="logVariable('scouser')" href="../../_variables/scouser.html">$scouser</a>-&gt;<a onClick="logVariable('userid')" class="var it44690" onMouseOver="hilite(44690)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>]-&gt;id         = <a class="var it5548" onMouseOver="hilite(5548)" onMouseOut="lolite()" onClick="logVariable('scouser')" href="../../_variables/scouser.html">$scouser</a>-&gt;<a onClick="logVariable('userid')" class="var it44690" onMouseOver="hilite(44690)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>;
<a name="l585"><span class="linenum"> 585</span></a>                  <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>[<a class="var it5548" onMouseOver="hilite(5548)" onMouseOut="lolite()" onClick="logVariable('scouser')" href="../../_variables/scouser.html">$scouser</a>-&gt;<a onClick="logVariable('userid')" class="var it44690" onMouseOver="hilite(44690)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>]-&gt;userid     = <a class="var it5548" onMouseOver="hilite(5548)" onMouseOut="lolite()" onClick="logVariable('scouser')" href="../../_variables/scouser.html">$scouser</a>-&gt;<a onClick="logVariable('userid')" class="var it44690" onMouseOver="hilite(44690)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>;
<a name="l586"><span class="linenum"> 586</span></a>                  <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>[<a class="var it5548" onMouseOver="hilite(5548)" onMouseOut="lolite()" onClick="logVariable('scouser')" href="../../_variables/scouser.html">$scouser</a>-&gt;<a onClick="logVariable('userid')" class="var it44690" onMouseOver="hilite(44690)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>]-&gt;rawgrade = <a class="function" onClick="logFunction('scorm_grade_user')" href="../../_functions/scorm_grade_user.html" onMouseOver="funcPopup(event,'scorm_grade_user')">scorm_grade_user</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>, <a class="var it5548" onMouseOver="hilite(5548)" onMouseOut="lolite()" onClick="logVariable('scouser')" href="../../_variables/scouser.html">$scouser</a>-&gt;<a onClick="logVariable('userid')" class="var it44690" onMouseOver="hilite(44690)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>);
<a name="l587"><span class="linenum"> 587</span></a>              }
<a name="l588"><span class="linenum"> 588</span></a>          } else {
<a name="l589"><span class="linenum"> 589</span></a>              return false;
<a name="l590"><span class="linenum"> 590</span></a>          }
<a name="l591"><span class="linenum"> 591</span></a>  
<a name="l592"><span class="linenum"> 592</span></a>      } else {
<a name="l593"><span class="linenum"> 593</span></a>          <a class="var it11927" onMouseOver="hilite(11927)" onMouseOut="lolite()" onClick="logVariable('preattempt')" href="../../_variables/preattempt.html">$preattempt</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_select')" href="../../_functions/get_records_select.html" onMouseOver="funcPopup(event,'get_records_select')">get_records_select</a>('scorm_scoes_track', &quot;scormid=? AND userid=? GROUP BY userid&quot;,
<a name="l594"><span class="linenum"> 594</span></a>                                                  array(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('id')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>), &quot;&quot;, &quot;userid,null&quot;);
<a name="l595"><span class="linenum"> 595</span></a>          if (!<a class="var it11927" onMouseOver="hilite(11927)" onMouseOut="lolite()" onClick="logVariable('preattempt')" href="../../_variables/preattempt.html">$preattempt</a>) {
<a name="l596"><span class="linenum"> 596</span></a>              return false; <span class="comment">// No attempt yet.</span>
<a name="l597"><span class="linenum"> 597</span></a>          }
<a name="l598"><span class="linenum"> 598</span></a>          <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>[<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>] = new stdClass();
<a name="l599"><span class="linenum"> 599</span></a>          <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>[<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>]-&gt;id         = <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>;
<a name="l600"><span class="linenum"> 600</span></a>          <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>[<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>]-&gt;userid     = <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>;
<a name="l601"><span class="linenum"> 601</span></a>          <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>[<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>]-&gt;rawgrade = <a class="function" onClick="logFunction('scorm_grade_user')" href="../../_functions/scorm_grade_user.html" onMouseOver="funcPopup(event,'scorm_grade_user')">scorm_grade_user</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>);
<a name="l602"><span class="linenum"> 602</span></a>      }
<a name="l603"><span class="linenum"> 603</span></a>  
<a name="l604"><span class="linenum"> 604</span></a>      return <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>;
<a name="l605"><span class="linenum"> 605</span></a>  }
<a name="l606"><span class="linenum"> 606</span></a>  
<a name="l607"><span class="linenum"> 607</span></a>  <span class="comment">/**</span>
<a name="l608"><span class="linenum"> 608</span></a>  <span class="comment"> * Update grades in central gradebook</span>
<a name="l609"><span class="linenum"> 609</span></a>  <span class="comment"> *</span>
<a name="l610"><span class="linenum"> 610</span></a>  <span class="comment"> * @category grade</span>
<a name="l611"><span class="linenum"> 611</span></a>  <span class="comment"> * @param object $scorm</span>
<a name="l612"><span class="linenum"> 612</span></a>  <span class="comment"> * @param int $userid specific user only, 0 mean all</span>
<a name="l613"><span class="linenum"> 613</span></a>  <span class="comment"> * @param bool $nullifnone</span>
<a name="l614"><span class="linenum"> 614</span></a>  <span class="comment"> */</span>
<a name="l615"><span class="linenum"> 615</span></a>  function <a class="function" onClick="logFunction('scorm_update_grades')" href="../../_functions/scorm_update_grades.html" onMouseOver="funcPopup(event,'scorm_update_grades')">scorm_update_grades</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>=0, <a class="var it9796" onMouseOver="hilite(9796)" onMouseOut="lolite()" onClick="logVariable('nullifnone')" href="../../_variables/nullifnone.html">$nullifnone</a>=true) {
<a name="l616"><span class="linenum"> 616</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l617"><span class="linenum"> 617</span></a>      require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a>.'/gradelib.php');
<a name="l618"><span class="linenum"> 618</span></a>      require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a>.'/completionlib.php');
<a name="l619"><span class="linenum"> 619</span></a>  
<a name="l620"><span class="linenum"> 620</span></a>      if (<a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a> = <a class="function" onClick="logFunction('scorm_get_user_grades')" href="../../_functions/scorm_get_user_grades.html" onMouseOver="funcPopup(event,'scorm_get_user_grades')">scorm_get_user_grades</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>)) {
<a name="l621"><span class="linenum"> 621</span></a>          <a class="function" onClick="logFunction('scorm_grade_item_update')" href="../../_functions/scorm_grade_item_update.html" onMouseOver="funcPopup(event,'scorm_grade_item_update')">scorm_grade_item_update</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>, <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>);
<a name="l622"><span class="linenum"> 622</span></a>  <span class="comment">        // Set complete.</span>
<a name="l623"><span class="linenum"> 623</span></a>          <a class="function" onClick="logFunction('scorm_set_completion')" href="../../_functions/scorm_set_completion.html" onMouseOver="funcPopup(event,'scorm_set_completion')">scorm_set_completion</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, <a class="constant" onClick="logConstant('COMPLETION_COMPLETE')" href="../../_constants/COMPLETION_COMPLETE.html" onMouseOver="constPopup(event,'COMPLETION_COMPLETE')">COMPLETION_COMPLETE</a>, <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>);
<a name="l624"><span class="linenum"> 624</span></a>      } else if (<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a> and <a class="var it9796" onMouseOver="hilite(9796)" onMouseOut="lolite()" onClick="logVariable('nullifnone')" href="../../_variables/nullifnone.html">$nullifnone</a>) {
<a name="l625"><span class="linenum"> 625</span></a>          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a> = new stdClass();
<a name="l626"><span class="linenum"> 626</span></a>          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('userid')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>   = <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>;
<a name="l627"><span class="linenum"> 627</span></a>          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('rawgrade')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/rawgrade.html">rawgrade</a> = null;
<a name="l628"><span class="linenum"> 628</span></a>          <a class="function" onClick="logFunction('scorm_grade_item_update')" href="../../_functions/scorm_grade_item_update.html" onMouseOver="funcPopup(event,'scorm_grade_item_update')">scorm_grade_item_update</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>, <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>);
<a name="l629"><span class="linenum"> 629</span></a>  <span class="comment">        // Set incomplete.</span>
<a name="l630"><span class="linenum"> 630</span></a>          <a class="function" onClick="logFunction('scorm_set_completion')" href="../../_functions/scorm_set_completion.html" onMouseOver="funcPopup(event,'scorm_set_completion')">scorm_set_completion</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, <a class="constant" onClick="logConstant('COMPLETION_INCOMPLETE')" href="../../_constants/COMPLETION_INCOMPLETE.html" onMouseOver="constPopup(event,'COMPLETION_INCOMPLETE')">COMPLETION_INCOMPLETE</a>);
<a name="l631"><span class="linenum"> 631</span></a>      } else {
<a name="l632"><span class="linenum"> 632</span></a>          <a class="function" onClick="logFunction('scorm_grade_item_update')" href="../../_functions/scorm_grade_item_update.html" onMouseOver="funcPopup(event,'scorm_grade_item_update')">scorm_grade_item_update</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>);
<a name="l633"><span class="linenum"> 633</span></a>      }
<a name="l634"><span class="linenum"> 634</span></a>  }
<a name="l635"><span class="linenum"> 635</span></a>  
<a name="l636"><span class="linenum"> 636</span></a>  <span class="comment">/**</span>
<a name="l637"><span class="linenum"> 637</span></a>  <span class="comment"> * Update/create grade item for given scorm</span>
<a name="l638"><span class="linenum"> 638</span></a>  <span class="comment"> *</span>
<a name="l639"><span class="linenum"> 639</span></a>  <span class="comment"> * @category grade</span>
<a name="l640"><span class="linenum"> 640</span></a>  <span class="comment"> * @uses GRADE_TYPE_VALUE</span>
<a name="l641"><span class="linenum"> 641</span></a>  <span class="comment"> * @uses GRADE_TYPE_NONE</span>
<a name="l642"><span class="linenum"> 642</span></a>  <span class="comment"> * @param object $scorm object with extra cmidnumber</span>
<a name="l643"><span class="linenum"> 643</span></a>  <span class="comment"> * @param mixed $grades optional array/object of grade(s); 'reset' means reset grades in gradebook</span>
<a name="l644"><span class="linenum"> 644</span></a>  <span class="comment"> * @return object grade_item</span>
<a name="l645"><span class="linenum"> 645</span></a>  <span class="comment"> */</span>
<a name="l646"><span class="linenum"> 646</span></a>  function <a class="function" onClick="logFunction('scorm_grade_item_update')" href="../../_functions/scorm_grade_item_update.html" onMouseOver="funcPopup(event,'scorm_grade_item_update')">scorm_grade_item_update</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>, <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>=null) {
<a name="l647"><span class="linenum"> 647</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l648"><span class="linenum"> 648</span></a>      require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../mod/scorm/locallib.php.html">/mod/scorm/locallib.php</a>');
<a name="l649"><span class="linenum"> 649</span></a>      if (!<a class="phpfunction" onClick="logFunction('function_exists')" href="../../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>('grade_update')) { // Workaround for buggy PHP versions.
<a name="l650"><span class="linenum"> 650</span></a>          require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a>.'/gradelib.php');
<a name="l651"><span class="linenum"> 651</span></a>      }
<a name="l652"><span class="linenum"> 652</span></a>  
<a name="l653"><span class="linenum"> 653</span></a>      <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('itemname' =&gt; <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('name')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>);
<a name="l654"><span class="linenum"> 654</span></a>      if (isset(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('cmidnumber')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/cmidnumber.html">cmidnumber</a>)) {
<a name="l655"><span class="linenum"> 655</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['idnumber'] = <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('cmidnumber')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/cmidnumber.html">cmidnumber</a>;
<a name="l656"><span class="linenum"> 656</span></a>      }
<a name="l657"><span class="linenum"> 657</span></a>  
<a name="l658"><span class="linenum"> 658</span></a>      if (<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('grademethod')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/grademethod.html">grademethod</a> == <a class="constant" onClick="logConstant('GRADESCOES')" href="../../_constants/GRADESCOES.html" onMouseOver="constPopup(event,'GRADESCOES')">GRADESCOES</a>) {
<a name="l659"><span class="linenum"> 659</span></a>          <a class="var it542" onMouseOver="hilite(542)" onMouseOut="lolite()" onClick="logVariable('maxgrade')" href="../../_variables/maxgrade.html">$maxgrade</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records_select')" href="../../_functions/count_records_select.html" onMouseOver="funcPopup(event,'count_records_select')">count_records_select</a>('scorm_scoes', 'scorm = ? AND '.
<a name="l660"><span class="linenum"> 660</span></a>                                                  <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_isnotempty')" href="../../_functions/sql_isnotempty.html" onMouseOver="funcPopup(event,'sql_isnotempty')">sql_isnotempty</a>('scorm_scoes', 'launch', false, true), array(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('id')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l661"><span class="linenum"> 661</span></a>          if (<a class="var it542" onMouseOver="hilite(542)" onMouseOut="lolite()" onClick="logVariable('maxgrade')" href="../../_variables/maxgrade.html">$maxgrade</a>) {
<a name="l662"><span class="linenum"> 662</span></a>              <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['gradetype'] = <a class="constant" onClick="logConstant('GRADE_TYPE_VALUE')" href="../../_constants/GRADE_TYPE_VALUE.html" onMouseOver="constPopup(event,'GRADE_TYPE_VALUE')">GRADE_TYPE_VALUE</a>;
<a name="l663"><span class="linenum"> 663</span></a>              <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['grademax']  = <a class="var it542" onMouseOver="hilite(542)" onMouseOut="lolite()" onClick="logVariable('maxgrade')" href="../../_variables/maxgrade.html">$maxgrade</a>;
<a name="l664"><span class="linenum"> 664</span></a>              <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['grademin']  = 0;
<a name="l665"><span class="linenum"> 665</span></a>          } else {
<a name="l666"><span class="linenum"> 666</span></a>              <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['gradetype'] = <a class="constant" onClick="logConstant('GRADE_TYPE_NONE')" href="../../_constants/GRADE_TYPE_NONE.html" onMouseOver="constPopup(event,'GRADE_TYPE_NONE')">GRADE_TYPE_NONE</a>;
<a name="l667"><span class="linenum"> 667</span></a>          }
<a name="l668"><span class="linenum"> 668</span></a>      } else {
<a name="l669"><span class="linenum"> 669</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['gradetype'] = <a class="constant" onClick="logConstant('GRADE_TYPE_VALUE')" href="../../_constants/GRADE_TYPE_VALUE.html" onMouseOver="constPopup(event,'GRADE_TYPE_VALUE')">GRADE_TYPE_VALUE</a>;
<a name="l670"><span class="linenum"> 670</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['grademax']  = <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('maxgrade')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/maxgrade.html">maxgrade</a>;
<a name="l671"><span class="linenum"> 671</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['grademin']  = 0;
<a name="l672"><span class="linenum"> 672</span></a>      }
<a name="l673"><span class="linenum"> 673</span></a>  
<a name="l674"><span class="linenum"> 674</span></a>      if (<a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a> === 'reset') {
<a name="l675"><span class="linenum"> 675</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['reset'] = true;
<a name="l676"><span class="linenum"> 676</span></a>          <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a> = null;
<a name="l677"><span class="linenum"> 677</span></a>      }
<a name="l678"><span class="linenum"> 678</span></a>  
<a name="l679"><span class="linenum"> 679</span></a>      return <a class="function" onClick="logFunction('grade_update')" href="../../_functions/grade_update.html" onMouseOver="funcPopup(event,'grade_update')">grade_update</a>('mod/scorm', <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('course')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>, 'mod', 'scorm', <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('id')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 0, <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l680"><span class="linenum"> 680</span></a>  }
<a name="l681"><span class="linenum"> 681</span></a>  
<a name="l682"><span class="linenum"> 682</span></a>  <span class="comment">/**</span>
<a name="l683"><span class="linenum"> 683</span></a>  <span class="comment"> * Delete grade item for given scorm</span>
<a name="l684"><span class="linenum"> 684</span></a>  <span class="comment"> *</span>
<a name="l685"><span class="linenum"> 685</span></a>  <span class="comment"> * @category grade</span>
<a name="l686"><span class="linenum"> 686</span></a>  <span class="comment"> * @param object $scorm object</span>
<a name="l687"><span class="linenum"> 687</span></a>  <span class="comment"> * @return object grade_item</span>
<a name="l688"><span class="linenum"> 688</span></a>  <span class="comment"> */</span>
<a name="l689"><span class="linenum"> 689</span></a>  function <a class="function" onClick="logFunction('scorm_grade_item_delete')" href="../../_functions/scorm_grade_item_delete.html" onMouseOver="funcPopup(event,'scorm_grade_item_delete')">scorm_grade_item_delete</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>) {
<a name="l690"><span class="linenum"> 690</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l691"><span class="linenum"> 691</span></a>      require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a>.'/gradelib.php');
<a name="l692"><span class="linenum"> 692</span></a>  
<a name="l693"><span class="linenum"> 693</span></a>      return <a class="function" onClick="logFunction('grade_update')" href="../../_functions/grade_update.html" onMouseOver="funcPopup(event,'grade_update')">grade_update</a>('mod/scorm', <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('course')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>, 'mod', 'scorm', <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('id')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 0, null, array('deleted' =&gt; 1));
<a name="l694"><span class="linenum"> 694</span></a>  }
<a name="l695"><span class="linenum"> 695</span></a>  
<a name="l696"><span class="linenum"> 696</span></a>  <span class="comment">/**</span>
<a name="l697"><span class="linenum"> 697</span></a>  <span class="comment"> * List the actions that correspond to a view of this module.</span>
<a name="l698"><span class="linenum"> 698</span></a>  <span class="comment"> * This is used by the participation report.</span>
<a name="l699"><span class="linenum"> 699</span></a>  <span class="comment"> *</span>
<a name="l700"><span class="linenum"> 700</span></a>  <span class="comment"> * Note: This is not used by new logging system. Event with</span>
<a name="l701"><span class="linenum"> 701</span></a>  <span class="comment"> *       crud = 'r' and edulevel = LEVEL_PARTICIPATING will</span>
<a name="l702"><span class="linenum"> 702</span></a>  <span class="comment"> *       be considered as view action.</span>
<a name="l703"><span class="linenum"> 703</span></a>  <span class="comment"> *</span>
<a name="l704"><span class="linenum"> 704</span></a>  <span class="comment"> * @return array</span>
<a name="l705"><span class="linenum"> 705</span></a>  <span class="comment"> */</span>
<a name="l706"><span class="linenum"> 706</span></a>  function <a class="function" onClick="logFunction('scorm_get_view_actions')" href="../../_functions/scorm_get_view_actions.html" onMouseOver="funcPopup(event,'scorm_get_view_actions')">scorm_get_view_actions</a>() {
<a name="l707"><span class="linenum"> 707</span></a>      return array('pre-view', 'view', 'view all', 'report');
<a name="l708"><span class="linenum"> 708</span></a>  }
<a name="l709"><span class="linenum"> 709</span></a>  
<a name="l710"><span class="linenum"> 710</span></a>  <span class="comment">/**</span>
<a name="l711"><span class="linenum"> 711</span></a>  <span class="comment"> * List the actions that correspond to a post of this module.</span>
<a name="l712"><span class="linenum"> 712</span></a>  <span class="comment"> * This is used by the participation report.</span>
<a name="l713"><span class="linenum"> 713</span></a>  <span class="comment"> *</span>
<a name="l714"><span class="linenum"> 714</span></a>  <span class="comment"> * Note: This is not used by new logging system. Event with</span>
<a name="l715"><span class="linenum"> 715</span></a>  <span class="comment"> *       crud = ('c' || 'u' || 'd') and edulevel = LEVEL_PARTICIPATING</span>
<a name="l716"><span class="linenum"> 716</span></a>  <span class="comment"> *       will be considered as post action.</span>
<a name="l717"><span class="linenum"> 717</span></a>  <span class="comment"> *</span>
<a name="l718"><span class="linenum"> 718</span></a>  <span class="comment"> * @return array</span>
<a name="l719"><span class="linenum"> 719</span></a>  <span class="comment"> */</span>
<a name="l720"><span class="linenum"> 720</span></a>  function <a class="function" onClick="logFunction('scorm_get_post_actions')" href="../../_functions/scorm_get_post_actions.html" onMouseOver="funcPopup(event,'scorm_get_post_actions')">scorm_get_post_actions</a>() {
<a name="l721"><span class="linenum"> 721</span></a>      return array();
<a name="l722"><span class="linenum"> 722</span></a>  }
<a name="l723"><span class="linenum"> 723</span></a>  
<a name="l724"><span class="linenum"> 724</span></a>  <span class="comment">/**</span>
<a name="l725"><span class="linenum"> 725</span></a>  <span class="comment"> * @param object $scorm</span>
<a name="l726"><span class="linenum"> 726</span></a>  <span class="comment"> * @return object $scorm</span>
<a name="l727"><span class="linenum"> 727</span></a>  <span class="comment"> */</span>
<a name="l728"><span class="linenum"> 728</span></a>  function <a class="function" onClick="logFunction('scorm_option2text')" href="../../_functions/scorm_option2text.html" onMouseOver="funcPopup(event,'scorm_option2text')">scorm_option2text</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>) {
<a name="l729"><span class="linenum"> 729</span></a>      <a class="var it11928" onMouseOver="hilite(11928)" onMouseOut="lolite()" onClick="logVariable('scormpopoupoptions')" href="../../_variables/scormpopoupoptions.html">$scormpopoupoptions</a> = <a class="function" onClick="logFunction('scorm_get_popup_options_array')" href="../../_functions/scorm_get_popup_options_array.html" onMouseOver="funcPopup(event,'scorm_get_popup_options_array')">scorm_get_popup_options_array</a>();
<a name="l730"><span class="linenum"> 730</span></a>  
<a name="l731"><span class="linenum"> 731</span></a>      if (isset(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('popup')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/popup.html">popup</a>)) {
<a name="l732"><span class="linenum"> 732</span></a>          if (<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('popup')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/popup.html">popup</a> == 1) {
<a name="l733"><span class="linenum"> 733</span></a>              <a class="var it11929" onMouseOver="hilite(11929)" onMouseOut="lolite()" onClick="logVariable('optionlist')" href="../../_variables/optionlist.html">$optionlist</a> = array();
<a name="l734"><span class="linenum"> 734</span></a>              foreach (<a class="var it11928" onMouseOver="hilite(11928)" onMouseOut="lolite()" onClick="logVariable('scormpopoupoptions')" href="../../_variables/scormpopoupoptions.html">$scormpopoupoptions</a> as <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a> =&gt; <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>) {
<a name="l735"><span class="linenum"> 735</span></a>                  if (isset(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>)) {
<a name="l736"><span class="linenum"> 736</span></a>                      <a class="var it11929" onMouseOver="hilite(11929)" onMouseOut="lolite()" onClick="logVariable('optionlist')" href="../../_variables/optionlist.html">$optionlist</a>[] = <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>.'='.<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>;
<a name="l737"><span class="linenum"> 737</span></a>                  } else {
<a name="l738"><span class="linenum"> 738</span></a>                      <a class="var it11929" onMouseOver="hilite(11929)" onMouseOut="lolite()" onClick="logVariable('optionlist')" href="../../_variables/optionlist.html">$optionlist</a>[] = <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>.'=0';
<a name="l739"><span class="linenum"> 739</span></a>                  }
<a name="l740"><span class="linenum"> 740</span></a>              }
<a name="l741"><span class="linenum"> 741</span></a>              <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('options')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/options.html">options</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(',', <a class="var it11929" onMouseOver="hilite(11929)" onMouseOut="lolite()" onClick="logVariable('optionlist')" href="../../_variables/optionlist.html">$optionlist</a>);
<a name="l742"><span class="linenum"> 742</span></a>          } else {
<a name="l743"><span class="linenum"> 743</span></a>              <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('options')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/options.html">options</a> = '';
<a name="l744"><span class="linenum"> 744</span></a>          }
<a name="l745"><span class="linenum"> 745</span></a>      } else {
<a name="l746"><span class="linenum"> 746</span></a>          <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('popup')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/popup.html">popup</a> = 0;
<a name="l747"><span class="linenum"> 747</span></a>          <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('options')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/options.html">options</a> = '';
<a name="l748"><span class="linenum"> 748</span></a>      }
<a name="l749"><span class="linenum"> 749</span></a>      return <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>;
<a name="l750"><span class="linenum"> 750</span></a>  }
<a name="l751"><span class="linenum"> 751</span></a>  
<a name="l752"><span class="linenum"> 752</span></a>  <span class="comment">/**</span>
<a name="l753"><span class="linenum"> 753</span></a>  <span class="comment"> * Implementation of the function for printing the form elements that control</span>
<a name="l754"><span class="linenum"> 754</span></a>  <span class="comment"> * whether the course reset functionality affects the scorm.</span>
<a name="l755"><span class="linenum"> 755</span></a>  <span class="comment"> *</span>
<a name="l756"><span class="linenum"> 756</span></a>  <span class="comment"> * @param object $mform form passed by reference</span>
<a name="l757"><span class="linenum"> 757</span></a>  <span class="comment"> */</span>
<a name="l758"><span class="linenum"> 758</span></a>  function <a class="function" onClick="logFunction('scorm_reset_course_form_definition')" href="../../_functions/scorm_reset_course_form_definition.html" onMouseOver="funcPopup(event,'scorm_reset_course_form_definition')">scorm_reset_course_form_definition</a>(&amp;<a class="var it219" onMouseOver="hilite(219)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../../_variables/mform.html">$mform</a>) {
<a name="l759"><span class="linenum"> 759</span></a>      <a class="var it219" onMouseOver="hilite(219)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../../_variables/mform.html">$mform</a>-&gt;<a class="function" onClick="logFunction('addElement')" href="../../_functions/addelement.html" onMouseOver="funcPopup(event,'addelement')">addElement</a>('header', 'scormheader', <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('modulenameplural', 'scorm'));
<a name="l760"><span class="linenum"> 760</span></a>      <a class="var it219" onMouseOver="hilite(219)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../../_variables/mform.html">$mform</a>-&gt;<a class="function" onClick="logFunction('addElement')" href="../../_functions/addelement.html" onMouseOver="funcPopup(event,'addelement')">addElement</a>('advcheckbox', 'reset_scorm', <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('deleteallattempts', 'scorm'));
<a name="l761"><span class="linenum"> 761</span></a>  }
<a name="l762"><span class="linenum"> 762</span></a>  
<a name="l763"><span class="linenum"> 763</span></a>  <span class="comment">/**</span>
<a name="l764"><span class="linenum"> 764</span></a>  <span class="comment"> * Course reset form defaults.</span>
<a name="l765"><span class="linenum"> 765</span></a>  <span class="comment"> *</span>
<a name="l766"><span class="linenum"> 766</span></a>  <span class="comment"> * @return array</span>
<a name="l767"><span class="linenum"> 767</span></a>  <span class="comment"> */</span>
<a name="l768"><span class="linenum"> 768</span></a>  function <a class="function" onClick="logFunction('scorm_reset_course_form_defaults')" href="../../_functions/scorm_reset_course_form_defaults.html" onMouseOver="funcPopup(event,'scorm_reset_course_form_defaults')">scorm_reset_course_form_defaults</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>) {
<a name="l769"><span class="linenum"> 769</span></a>      return array('reset_scorm' =&gt; 1);
<a name="l770"><span class="linenum"> 770</span></a>  }
<a name="l771"><span class="linenum"> 771</span></a>  
<a name="l772"><span class="linenum"> 772</span></a>  <span class="comment">/**</span>
<a name="l773"><span class="linenum"> 773</span></a>  <span class="comment"> * Removes all grades from gradebook</span>
<a name="l774"><span class="linenum"> 774</span></a>  <span class="comment"> *</span>
<a name="l775"><span class="linenum"> 775</span></a>  <span class="comment"> * @global stdClass</span>
<a name="l776"><span class="linenum"> 776</span></a>  <span class="comment"> * @global object</span>
<a name="l777"><span class="linenum"> 777</span></a>  <span class="comment"> * @param int $courseid</span>
<a name="l778"><span class="linenum"> 778</span></a>  <span class="comment"> * @param string optional type</span>
<a name="l779"><span class="linenum"> 779</span></a>  <span class="comment"> */</span>
<a name="l780"><span class="linenum"> 780</span></a>  function <a class="function" onClick="logFunction('scorm_reset_gradebook')" href="../../_functions/scorm_reset_gradebook.html" onMouseOver="funcPopup(event,'scorm_reset_gradebook')">scorm_reset_gradebook</a>(<a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>, <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>='') {
<a name="l781"><span class="linenum"> 781</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l782"><span class="linenum"> 782</span></a>  
<a name="l783"><span class="linenum"> 783</span></a>      <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT s.*, cm.idnumber as cmidnumber, s.course as courseid
<a name="l784"><span class="linenum"> 784</span></a>                FROM {scorm} s, {course_modules} cm, {modules} m
<a name="l785"><span class="linenum"> 785</span></a>               WHERE m.name='scorm' AND m.id=cm.module AND cm.instance=s.id AND s.course=?&quot;;
<a name="l786"><span class="linenum"> 786</span></a>  
<a name="l787"><span class="linenum"> 787</span></a>      if (<a class="var it635" onMouseOver="hilite(635)" onMouseOut="lolite()" onClick="logVariable('scorms')" href="../../_variables/scorms.html">$scorms</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, array(<a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>))) {
<a name="l788"><span class="linenum"> 788</span></a>          foreach (<a class="var it635" onMouseOver="hilite(635)" onMouseOut="lolite()" onClick="logVariable('scorms')" href="../../_variables/scorms.html">$scorms</a> as <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>) {
<a name="l789"><span class="linenum"> 789</span></a>              <a class="function" onClick="logFunction('scorm_grade_item_update')" href="../../_functions/scorm_grade_item_update.html" onMouseOver="funcPopup(event,'scorm_grade_item_update')">scorm_grade_item_update</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>, 'reset');
<a name="l790"><span class="linenum"> 790</span></a>          }
<a name="l791"><span class="linenum"> 791</span></a>      }
<a name="l792"><span class="linenum"> 792</span></a>  }
<a name="l793"><span class="linenum"> 793</span></a>  
<a name="l794"><span class="linenum"> 794</span></a>  <span class="comment">/**</span>
<a name="l795"><span class="linenum"> 795</span></a>  <span class="comment"> * Actual implementation of the reset course functionality, delete all the</span>
<a name="l796"><span class="linenum"> 796</span></a>  <span class="comment"> * scorm attempts for course $data-&gt;courseid.</span>
<a name="l797"><span class="linenum"> 797</span></a>  <span class="comment"> *</span>
<a name="l798"><span class="linenum"> 798</span></a>  <span class="comment"> * @global stdClass</span>
<a name="l799"><span class="linenum"> 799</span></a>  <span class="comment"> * @global object</span>
<a name="l800"><span class="linenum"> 800</span></a>  <span class="comment"> * @param object $data the data submitted from the reset course.</span>
<a name="l801"><span class="linenum"> 801</span></a>  <span class="comment"> * @return array status array</span>
<a name="l802"><span class="linenum"> 802</span></a>  <span class="comment"> */</span>
<a name="l803"><span class="linenum"> 803</span></a>  function <a class="function" onClick="logFunction('scorm_reset_userdata')" href="../../_functions/scorm_reset_userdata.html" onMouseOver="funcPopup(event,'scorm_reset_userdata')">scorm_reset_userdata</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>) {
<a name="l804"><span class="linenum"> 804</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l805"><span class="linenum"> 805</span></a>  
<a name="l806"><span class="linenum"> 806</span></a>      <a class="var it9827" onMouseOver="hilite(9827)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../../_variables/componentstr.html">$componentstr</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('modulenameplural', 'scorm');
<a name="l807"><span class="linenum"> 807</span></a>      <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../_variables/status.html">$status</a> = array();
<a name="l808"><span class="linenum"> 808</span></a>  
<a name="l809"><span class="linenum"> 809</span></a>      if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('reset_scorm')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/reset_scorm.html">reset_scorm</a>)) {
<a name="l810"><span class="linenum"> 810</span></a>          <a class="var it11931" onMouseOver="hilite(11931)" onMouseOut="lolite()" onClick="logVariable('scormssql')" href="../../_variables/scormssql.html">$scormssql</a> = &quot;SELECT s.id
<a name="l811"><span class="linenum"> 811</span></a>                           FROM {scorm} s
<a name="l812"><span class="linenum"> 812</span></a>                          WHERE s.course=?&quot;;
<a name="l813"><span class="linenum"> 813</span></a>  
<a name="l814"><span class="linenum"> 814</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records_select')" href="../../_functions/delete_records_select.html" onMouseOver="funcPopup(event,'delete_records_select')">delete_records_select</a>('scorm_scoes_track', &quot;scormid IN (<a class="var it11931" onMouseOver="hilite(11931)" onMouseOut="lolite()" onClick="logVariable('scormssql')" href="../../_variables/scormssql.html">$scormssql</a>)&quot;, array(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>));
<a name="l815"><span class="linenum"> 815</span></a>  
<a name="l816"><span class="linenum"> 816</span></a>  <span class="comment">        // Remove all grades from gradebook.</span>
<a name="l817"><span class="linenum"> 817</span></a>          if (empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('reset_gradebook_grades')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/reset_gradebook_grades.html">reset_gradebook_grades</a>)) {
<a name="l818"><span class="linenum"> 818</span></a>              <a class="function" onClick="logFunction('scorm_reset_gradebook')" href="../../_functions/scorm_reset_gradebook.html" onMouseOver="funcPopup(event,'scorm_reset_gradebook')">scorm_reset_gradebook</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>);
<a name="l819"><span class="linenum"> 819</span></a>          }
<a name="l820"><span class="linenum"> 820</span></a>  
<a name="l821"><span class="linenum"> 821</span></a>          <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../_variables/status.html">$status</a>[] = array('component' =&gt; <a class="var it9827" onMouseOver="hilite(9827)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../../_variables/componentstr.html">$componentstr</a>, 'item' =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('deleteallattempts', 'scorm'), 'error' =&gt; false);
<a name="l822"><span class="linenum"> 822</span></a>      }
<a name="l823"><span class="linenum"> 823</span></a>  
<a name="l824"><span class="linenum"> 824</span></a>  <span class="comment">    // No dates to shift here.</span>
<a name="l825"><span class="linenum"> 825</span></a>  
<a name="l826"><span class="linenum"> 826</span></a>      return <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../_variables/status.html">$status</a>;
<a name="l827"><span class="linenum"> 827</span></a>  }
<a name="l828"><span class="linenum"> 828</span></a>  
<a name="l829"><span class="linenum"> 829</span></a>  <span class="comment">/**</span>
<a name="l830"><span class="linenum"> 830</span></a>  <span class="comment"> * Returns all other caps used in module</span>
<a name="l831"><span class="linenum"> 831</span></a>  <span class="comment"> *</span>
<a name="l832"><span class="linenum"> 832</span></a>  <span class="comment"> * @return array</span>
<a name="l833"><span class="linenum"> 833</span></a>  <span class="comment"> */</span>
<a name="l834"><span class="linenum"> 834</span></a>  function <a class="function" onClick="logFunction('scorm_get_extra_capabilities')" href="../../_functions/scorm_get_extra_capabilities.html" onMouseOver="funcPopup(event,'scorm_get_extra_capabilities')">scorm_get_extra_capabilities</a>() {
<a name="l835"><span class="linenum"> 835</span></a>      return array('moodle/site:accessallgroups');
<a name="l836"><span class="linenum"> 836</span></a>  }
<a name="l837"><span class="linenum"> 837</span></a>  
<a name="l838"><span class="linenum"> 838</span></a>  <span class="comment">/**</span>
<a name="l839"><span class="linenum"> 839</span></a>  <span class="comment"> * Lists all file areas current user may browse</span>
<a name="l840"><span class="linenum"> 840</span></a>  <span class="comment"> *</span>
<a name="l841"><span class="linenum"> 841</span></a>  <span class="comment"> * @param object $course</span>
<a name="l842"><span class="linenum"> 842</span></a>  <span class="comment"> * @param object $cm</span>
<a name="l843"><span class="linenum"> 843</span></a>  <span class="comment"> * @param object $context</span>
<a name="l844"><span class="linenum"> 844</span></a>  <span class="comment"> * @return array</span>
<a name="l845"><span class="linenum"> 845</span></a>  <span class="comment"> */</span>
<a name="l846"><span class="linenum"> 846</span></a>  function <a class="function" onClick="logFunction('scorm_get_file_areas')" href="../../_functions/scorm_get_file_areas.html" onMouseOver="funcPopup(event,'scorm_get_file_areas')">scorm_get_file_areas</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>) {
<a name="l847"><span class="linenum"> 847</span></a>      <a class="var it2274" onMouseOver="hilite(2274)" onMouseOut="lolite()" onClick="logVariable('areas')" href="../../_variables/areas.html">$areas</a> = array();
<a name="l848"><span class="linenum"> 848</span></a>      <a class="var it2274" onMouseOver="hilite(2274)" onMouseOut="lolite()" onClick="logVariable('areas')" href="../../_variables/areas.html">$areas</a>['content'] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('areacontent', 'scorm');
<a name="l849"><span class="linenum"> 849</span></a>      <a class="var it2274" onMouseOver="hilite(2274)" onMouseOut="lolite()" onClick="logVariable('areas')" href="../../_variables/areas.html">$areas</a>['package'] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('areapackage', 'scorm');
<a name="l850"><span class="linenum"> 850</span></a>      return <a class="var it2274" onMouseOver="hilite(2274)" onMouseOut="lolite()" onClick="logVariable('areas')" href="../../_variables/areas.html">$areas</a>;
<a name="l851"><span class="linenum"> 851</span></a>  }
<a name="l852"><span class="linenum"> 852</span></a>  
<a name="l853"><span class="linenum"> 853</span></a>  <span class="comment">/**</span>
<a name="l854"><span class="linenum"> 854</span></a>  <span class="comment"> * File browsing support for SCORM file areas</span>
<a name="l855"><span class="linenum"> 855</span></a>  <span class="comment"> *</span>
<a name="l856"><span class="linenum"> 856</span></a>  <span class="comment"> * @package  mod_scorm</span>
<a name="l857"><span class="linenum"> 857</span></a>  <span class="comment"> * @category files</span>
<a name="l858"><span class="linenum"> 858</span></a>  <span class="comment"> * @param file_browser $browser file browser instance</span>
<a name="l859"><span class="linenum"> 859</span></a>  <span class="comment"> * @param array $areas file areas</span>
<a name="l860"><span class="linenum"> 860</span></a>  <span class="comment"> * @param stdClass $course course object</span>
<a name="l861"><span class="linenum"> 861</span></a>  <span class="comment"> * @param stdClass $cm course module object</span>
<a name="l862"><span class="linenum"> 862</span></a>  <span class="comment"> * @param stdClass $context context object</span>
<a name="l863"><span class="linenum"> 863</span></a>  <span class="comment"> * @param string $filearea file area</span>
<a name="l864"><span class="linenum"> 864</span></a>  <span class="comment"> * @param int $itemid item ID</span>
<a name="l865"><span class="linenum"> 865</span></a>  <span class="comment"> * @param string $filepath file path</span>
<a name="l866"><span class="linenum"> 866</span></a>  <span class="comment"> * @param string $filename file name</span>
<a name="l867"><span class="linenum"> 867</span></a>  <span class="comment"> * @return file_info instance or null if not found</span>
<a name="l868"><span class="linenum"> 868</span></a>  <span class="comment"> */</span>
<a name="l869"><span class="linenum"> 869</span></a>  function <a class="function" onClick="logFunction('scorm_get_file_info')" href="../../_functions/scorm_get_file_info.html" onMouseOver="funcPopup(event,'scorm_get_file_info')">scorm_get_file_info</a>(<a class="var it1462" onMouseOver="hilite(1462)" onMouseOut="lolite()" onClick="logVariable('browser')" href="../../_variables/browser.html">$browser</a>, <a class="var it2274" onMouseOver="hilite(2274)" onMouseOut="lolite()" onClick="logVariable('areas')" href="../../_variables/areas.html">$areas</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>, <a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('filearea')" href="../../_variables/filearea.html">$filearea</a>, <a class="var it868" onMouseOver="hilite(868)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>, <a class="var it886" onMouseOver="hilite(886)" onMouseOut="lolite()" onClick="logVariable('filepath')" href="../../_variables/filepath.html">$filepath</a>, <a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../_variables/filename.html">$filename</a>) {
<a name="l870"><span class="linenum"> 870</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l871"><span class="linenum"> 871</span></a>  
<a name="l872"><span class="linenum"> 872</span></a>      if (!<a class="function" onClick="logFunction('has_capability')" href="../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/course:managefiles', <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>)) {
<a name="l873"><span class="linenum"> 873</span></a>          return null;
<a name="l874"><span class="linenum"> 874</span></a>      }
<a name="l875"><span class="linenum"> 875</span></a>  
<a name="l876"><span class="linenum"> 876</span></a>  <span class="comment">    // No writing for now!</span>
<a name="l877"><span class="linenum"> 877</span></a>  
<a name="l878"><span class="linenum"> 878</span></a>      <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a> = <a class="function" onClick="logFunction('get_file_storage')" href="../../_functions/get_file_storage.html" onMouseOver="funcPopup(event,'get_file_storage')">get_file_storage</a>();
<a name="l879"><span class="linenum"> 879</span></a>  
<a name="l880"><span class="linenum"> 880</span></a>      if (<a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('filearea')" href="../../_variables/filearea.html">$filearea</a> === 'content') {
<a name="l881"><span class="linenum"> 881</span></a>  
<a name="l882"><span class="linenum"> 882</span></a>          <a class="var it886" onMouseOver="hilite(886)" onMouseOut="lolite()" onClick="logVariable('filepath')" href="../../_variables/filepath.html">$filepath</a> = <a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it886" onMouseOver="hilite(886)" onMouseOut="lolite()" onClick="logVariable('filepath')" href="../../_variables/filepath.html">$filepath</a>) ? '/' : <a class="var it886" onMouseOver="hilite(886)" onMouseOut="lolite()" onClick="logVariable('filepath')" href="../../_variables/filepath.html">$filepath</a>;
<a name="l883"><span class="linenum"> 883</span></a>          <a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../_variables/filename.html">$filename</a> = <a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../_variables/filename.html">$filename</a>) ? '.' : <a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../_variables/filename.html">$filename</a>;
<a name="l884"><span class="linenum"> 884</span></a>  
<a name="l885"><span class="linenum"> 885</span></a>          <a class="var it2276" onMouseOver="hilite(2276)" onMouseOut="lolite()" onClick="logVariable('urlbase')" href="../../_variables/urlbase.html">$urlbase</a> = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>.'<a class="filename" href="../../pluginfile.php.html">/pluginfile.php</a>';
<a name="l886"><span class="linenum"> 886</span></a>          if (!<a class="var it2275" onMouseOver="hilite(2275)" onMouseOut="lolite()" onClick="logVariable('storedfile')" href="../../_variables/storedfile.html">$storedfile</a> = <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('get_file')" href="../../_functions/get_file.html" onMouseOver="funcPopup(event,'get_file')">get_file</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'mod_scorm', 'content', 0, <a class="var it886" onMouseOver="hilite(886)" onMouseOut="lolite()" onClick="logVariable('filepath')" href="../../_variables/filepath.html">$filepath</a>, <a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../_variables/filename.html">$filename</a>)) {
<a name="l887"><span class="linenum"> 887</span></a>              if (<a class="var it886" onMouseOver="hilite(886)" onMouseOut="lolite()" onClick="logVariable('filepath')" href="../../_variables/filepath.html">$filepath</a> === '/' and <a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../_variables/filename.html">$filename</a> === '.') {
<a name="l888"><span class="linenum"> 888</span></a>                  <a class="var it2275" onMouseOver="hilite(2275)" onMouseOut="lolite()" onClick="logVariable('storedfile')" href="../../_variables/storedfile.html">$storedfile</a> = <span class="keyword">new </span><a class="class" onClick="logClass('virtual_root_file')" href="../../_classes/virtual_root_file.html" onMouseOver="classPopup(event,'virtual_root_file')">virtual_root_file</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'mod_scorm', 'content', 0);
<a name="l889"><span class="linenum"> 889</span></a>              } else {
<a name="l890"><span class="linenum"> 890</span></a>  <span class="comment">                // Not found.</span>
<a name="l891"><span class="linenum"> 891</span></a>                  return null;
<a name="l892"><span class="linenum"> 892</span></a>              }
<a name="l893"><span class="linenum"> 893</span></a>          }
<a name="l894"><span class="linenum"> 894</span></a>          require_once(&quot;<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>/mod/scorm/locallib.php&quot;);
<a name="l895"><span class="linenum"> 895</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('scorm_package_file_info')" href="../../_classes/scorm_package_file_info.html" onMouseOver="classPopup(event,'scorm_package_file_info')">scorm_package_file_info</a>(<a class="var it1462" onMouseOver="hilite(1462)" onMouseOut="lolite()" onClick="logVariable('browser')" href="../../_variables/browser.html">$browser</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>, <a class="var it2275" onMouseOver="hilite(2275)" onMouseOut="lolite()" onClick="logVariable('storedfile')" href="../../_variables/storedfile.html">$storedfile</a>, <a class="var it2276" onMouseOver="hilite(2276)" onMouseOut="lolite()" onClick="logVariable('urlbase')" href="../../_variables/urlbase.html">$urlbase</a>, <a class="var it2274" onMouseOver="hilite(2274)" onMouseOut="lolite()" onClick="logVariable('areas')" href="../../_variables/areas.html">$areas</a>[<a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('filearea')" href="../../_variables/filearea.html">$filearea</a>], true, true, false, false);
<a name="l896"><span class="linenum"> 896</span></a>  
<a name="l897"><span class="linenum"> 897</span></a>      } else if (<a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('filearea')" href="../../_variables/filearea.html">$filearea</a> === 'package') {
<a name="l898"><span class="linenum"> 898</span></a>          <a class="var it886" onMouseOver="hilite(886)" onMouseOut="lolite()" onClick="logVariable('filepath')" href="../../_variables/filepath.html">$filepath</a> = <a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it886" onMouseOver="hilite(886)" onMouseOut="lolite()" onClick="logVariable('filepath')" href="../../_variables/filepath.html">$filepath</a>) ? '/' : <a class="var it886" onMouseOver="hilite(886)" onMouseOut="lolite()" onClick="logVariable('filepath')" href="../../_variables/filepath.html">$filepath</a>;
<a name="l899"><span class="linenum"> 899</span></a>          <a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../_variables/filename.html">$filename</a> = <a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../_variables/filename.html">$filename</a>) ? '.' : <a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../_variables/filename.html">$filename</a>;
<a name="l900"><span class="linenum"> 900</span></a>  
<a name="l901"><span class="linenum"> 901</span></a>          <a class="var it2276" onMouseOver="hilite(2276)" onMouseOut="lolite()" onClick="logVariable('urlbase')" href="../../_variables/urlbase.html">$urlbase</a> = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>.'<a class="filename" href="../../pluginfile.php.html">/pluginfile.php</a>';
<a name="l902"><span class="linenum"> 902</span></a>          if (!<a class="var it2275" onMouseOver="hilite(2275)" onMouseOut="lolite()" onClick="logVariable('storedfile')" href="../../_variables/storedfile.html">$storedfile</a> = <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('get_file')" href="../../_functions/get_file.html" onMouseOver="funcPopup(event,'get_file')">get_file</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'mod_scorm', 'package', 0, <a class="var it886" onMouseOver="hilite(886)" onMouseOut="lolite()" onClick="logVariable('filepath')" href="../../_variables/filepath.html">$filepath</a>, <a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../_variables/filename.html">$filename</a>)) {
<a name="l903"><span class="linenum"> 903</span></a>              if (<a class="var it886" onMouseOver="hilite(886)" onMouseOut="lolite()" onClick="logVariable('filepath')" href="../../_variables/filepath.html">$filepath</a> === '/' and <a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../_variables/filename.html">$filename</a> === '.') {
<a name="l904"><span class="linenum"> 904</span></a>                  <a class="var it2275" onMouseOver="hilite(2275)" onMouseOut="lolite()" onClick="logVariable('storedfile')" href="../../_variables/storedfile.html">$storedfile</a> = <span class="keyword">new </span><a class="class" onClick="logClass('virtual_root_file')" href="../../_classes/virtual_root_file.html" onMouseOver="classPopup(event,'virtual_root_file')">virtual_root_file</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'mod_scorm', 'package', 0);
<a name="l905"><span class="linenum"> 905</span></a>              } else {
<a name="l906"><span class="linenum"> 906</span></a>  <span class="comment">                // Not found.</span>
<a name="l907"><span class="linenum"> 907</span></a>                  return null;
<a name="l908"><span class="linenum"> 908</span></a>              }
<a name="l909"><span class="linenum"> 909</span></a>          }
<a name="l910"><span class="linenum"> 910</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('file_info_stored')" href="../../_classes/file_info_stored.html" onMouseOver="classPopup(event,'file_info_stored')">file_info_stored</a>(<a class="var it1462" onMouseOver="hilite(1462)" onMouseOut="lolite()" onClick="logVariable('browser')" href="../../_variables/browser.html">$browser</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>, <a class="var it2275" onMouseOver="hilite(2275)" onMouseOut="lolite()" onClick="logVariable('storedfile')" href="../../_variables/storedfile.html">$storedfile</a>, <a class="var it2276" onMouseOver="hilite(2276)" onMouseOut="lolite()" onClick="logVariable('urlbase')" href="../../_variables/urlbase.html">$urlbase</a>, <a class="var it2274" onMouseOver="hilite(2274)" onMouseOut="lolite()" onClick="logVariable('areas')" href="../../_variables/areas.html">$areas</a>[<a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('filearea')" href="../../_variables/filearea.html">$filearea</a>], false, true, false, false);
<a name="l911"><span class="linenum"> 911</span></a>      }
<a name="l912"><span class="linenum"> 912</span></a>  
<a name="l913"><span class="linenum"> 913</span></a>  <span class="comment">    // Scorm_intro handled in file_browser.</span>
<a name="l914"><span class="linenum"> 914</span></a>  
<a name="l915"><span class="linenum"> 915</span></a>      return false;
<a name="l916"><span class="linenum"> 916</span></a>  }
<a name="l917"><span class="linenum"> 917</span></a>  
<a name="l918"><span class="linenum"> 918</span></a>  <span class="comment">/**</span>
<a name="l919"><span class="linenum"> 919</span></a>  <span class="comment"> * Serves scorm content, introduction images and packages. Implements needed access control ;-)</span>
<a name="l920"><span class="linenum"> 920</span></a>  <span class="comment"> *</span>
<a name="l921"><span class="linenum"> 921</span></a>  <span class="comment"> * @package  mod_scorm</span>
<a name="l922"><span class="linenum"> 922</span></a>  <span class="comment"> * @category files</span>
<a name="l923"><span class="linenum"> 923</span></a>  <span class="comment"> * @param stdClass $course course object</span>
<a name="l924"><span class="linenum"> 924</span></a>  <span class="comment"> * @param stdClass $cm course module object</span>
<a name="l925"><span class="linenum"> 925</span></a>  <span class="comment"> * @param stdClass $context context object</span>
<a name="l926"><span class="linenum"> 926</span></a>  <span class="comment"> * @param string $filearea file area</span>
<a name="l927"><span class="linenum"> 927</span></a>  <span class="comment"> * @param array $args extra arguments</span>
<a name="l928"><span class="linenum"> 928</span></a>  <span class="comment"> * @param bool $forcedownload whether or not force download</span>
<a name="l929"><span class="linenum"> 929</span></a>  <span class="comment"> * @param array $options additional options affecting the file serving</span>
<a name="l930"><span class="linenum"> 930</span></a>  <span class="comment"> * @return bool false if file not found, does not return if found - just send the file</span>
<a name="l931"><span class="linenum"> 931</span></a>  <span class="comment"> */</span>
<a name="l932"><span class="linenum"> 932</span></a>  function <a class="function" onClick="logFunction('scorm_pluginfile')" href="../../_functions/scorm_pluginfile.html" onMouseOver="funcPopup(event,'scorm_pluginfile')">scorm_pluginfile</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>, <a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('filearea')" href="../../_variables/filearea.html">$filearea</a>, <a class="var it25" onMouseOver="hilite(25)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../_variables/args.html">$args</a>, <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('forcedownload')" href="../../_variables/forcedownload.html">$forcedownload</a>, array <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>=array()) {
<a name="l933"><span class="linenum"> 933</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l934"><span class="linenum"> 934</span></a>  
<a name="l935"><span class="linenum"> 935</span></a>      if (<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('contextlevel')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/contextlevel.html">contextlevel</a> != <a class="constant" onClick="logConstant('CONTEXT_MODULE')" href="../../_constants/CONTEXT_MODULE.html" onMouseOver="constPopup(event,'CONTEXT_MODULE')">CONTEXT_MODULE</a>) {
<a name="l936"><span class="linenum"> 936</span></a>          return false;
<a name="l937"><span class="linenum"> 937</span></a>      }
<a name="l938"><span class="linenum"> 938</span></a>  
<a name="l939"><span class="linenum"> 939</span></a>      <a class="function" onClick="logFunction('require_login')" href="../../_functions/require_login.html" onMouseOver="funcPopup(event,'require_login')">require_login</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, true, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>);
<a name="l940"><span class="linenum"> 940</span></a>  
<a name="l941"><span class="linenum"> 941</span></a>      <a class="var it11932" onMouseOver="hilite(11932)" onMouseOut="lolite()" onClick="logVariable('canmanageactivity')" href="../../_variables/canmanageactivity.html">$canmanageactivity</a> = <a class="function" onClick="logFunction('has_capability')" href="../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/course:manageactivities', <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l942"><span class="linenum"> 942</span></a>      <a class="var it3341" onMouseOver="hilite(3341)" onMouseOut="lolite()" onClick="logVariable('lifetime')" href="../../_variables/lifetime.html">$lifetime</a> = null;
<a name="l943"><span class="linenum"> 943</span></a>  
<a name="l944"><span class="linenum"> 944</span></a>  <span class="comment">    // Check SCORM availability.</span>
<a name="l945"><span class="linenum"> 945</span></a>      if (!<a class="var it11932" onMouseOver="hilite(11932)" onMouseOut="lolite()" onClick="logVariable('canmanageactivity')" href="../../_variables/canmanageactivity.html">$canmanageactivity</a>) {
<a name="l946"><span class="linenum"> 946</span></a>          require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../mod/scorm/locallib.php.html">/mod/scorm/locallib.php</a>');
<a name="l947"><span class="linenum"> 947</span></a>  
<a name="l948"><span class="linenum"> 948</span></a>          <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('scorm', array('id' =&gt; <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('instance')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/instance.html">instance</a>), 'id, timeopen, timeclose', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l949"><span class="linenum"> 949</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it1211" onMouseOver="hilite(1211)" onMouseOut="lolite()" onClick="logVariable('available')" href="../../_variables/available.html">$available</a>, <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../../_variables/warnings.html">$warnings</a>) = <a class="function" onClick="logFunction('scorm_get_availability_status')" href="../../_functions/scorm_get_availability_status.html" onMouseOver="funcPopup(event,'scorm_get_availability_status')">scorm_get_availability_status</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>);
<a name="l950"><span class="linenum"> 950</span></a>          if (!<a class="var it1211" onMouseOver="hilite(1211)" onMouseOut="lolite()" onClick="logVariable('available')" href="../../_variables/available.html">$available</a>) {
<a name="l951"><span class="linenum"> 951</span></a>              return false;
<a name="l952"><span class="linenum"> 952</span></a>          }
<a name="l953"><span class="linenum"> 953</span></a>      }
<a name="l954"><span class="linenum"> 954</span></a>  
<a name="l955"><span class="linenum"> 955</span></a>      if (<a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('filearea')" href="../../_variables/filearea.html">$filearea</a> === 'content') {
<a name="l956"><span class="linenum"> 956</span></a>          <a class="var it2268" onMouseOver="hilite(2268)" onMouseOut="lolite()" onClick="logVariable('revision')" href="../../_variables/revision.html">$revision</a> = (int)<a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it25" onMouseOver="hilite(25)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../_variables/args.html">$args</a>); <span class="comment">// Prevents caching problems - ignored here.</span>
<a name="l957"><span class="linenum"> 957</span></a>          <a class="var it2277" onMouseOver="hilite(2277)" onMouseOut="lolite()" onClick="logVariable('relativepath')" href="../../_variables/relativepath.html">$relativepath</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>('/', <a class="var it25" onMouseOver="hilite(25)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../_variables/args.html">$args</a>);
<a name="l958"><span class="linenum"> 958</span></a>          <a class="var it241" onMouseOver="hilite(241)" onMouseOut="lolite()" onClick="logVariable('fullpath')" href="../../_variables/fullpath.html">$fullpath</a> = &quot;/<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>/mod_scorm/content/0/<a class="var it2277" onMouseOver="hilite(2277)" onMouseOut="lolite()" onClick="logVariable('relativepath')" href="../../_variables/relativepath.html">$relativepath</a>&quot;;
<a name="l959"><span class="linenum"> 959</span></a>  <span class="comment">        // TODO: add any other access restrictions here if needed!</span>
<a name="l960"><span class="linenum"> 960</span></a>  
<a name="l961"><span class="linenum"> 961</span></a>      } else if (<a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('filearea')" href="../../_variables/filearea.html">$filearea</a> === 'package') {
<a name="l962"><span class="linenum"> 962</span></a>  <span class="comment">        // Check if the global setting for disabling package downloads is enabled.</span>
<a name="l963"><span class="linenum"> 963</span></a>          <a class="var it11933" onMouseOver="hilite(11933)" onMouseOut="lolite()" onClick="logVariable('protectpackagedownloads')" href="../../_variables/protectpackagedownloads.html">$protectpackagedownloads</a> = <a class="function" onClick="logFunction('get_config')" href="../../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>('scorm', 'protectpackagedownloads');
<a name="l964"><span class="linenum"> 964</span></a>          if (<a class="var it11933" onMouseOver="hilite(11933)" onMouseOut="lolite()" onClick="logVariable('protectpackagedownloads')" href="../../_variables/protectpackagedownloads.html">$protectpackagedownloads</a> and !<a class="var it11932" onMouseOver="hilite(11932)" onMouseOut="lolite()" onClick="logVariable('canmanageactivity')" href="../../_variables/canmanageactivity.html">$canmanageactivity</a>) {
<a name="l965"><span class="linenum"> 965</span></a>              return false;
<a name="l966"><span class="linenum"> 966</span></a>          }
<a name="l967"><span class="linenum"> 967</span></a>          <a class="var it2268" onMouseOver="hilite(2268)" onMouseOut="lolite()" onClick="logVariable('revision')" href="../../_variables/revision.html">$revision</a> = (int)<a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it25" onMouseOver="hilite(25)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../_variables/args.html">$args</a>); <span class="comment">// Prevents caching problems - ignored here.</span>
<a name="l968"><span class="linenum"> 968</span></a>          <a class="var it2277" onMouseOver="hilite(2277)" onMouseOut="lolite()" onClick="logVariable('relativepath')" href="../../_variables/relativepath.html">$relativepath</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>('/', <a class="var it25" onMouseOver="hilite(25)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../_variables/args.html">$args</a>);
<a name="l969"><span class="linenum"> 969</span></a>          <a class="var it241" onMouseOver="hilite(241)" onMouseOut="lolite()" onClick="logVariable('fullpath')" href="../../_variables/fullpath.html">$fullpath</a> = &quot;/<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>/mod_scorm/package/0/<a class="var it2277" onMouseOver="hilite(2277)" onMouseOut="lolite()" onClick="logVariable('relativepath')" href="../../_variables/relativepath.html">$relativepath</a>&quot;;
<a name="l970"><span class="linenum"> 970</span></a>          <a class="var it3341" onMouseOver="hilite(3341)" onMouseOut="lolite()" onClick="logVariable('lifetime')" href="../../_variables/lifetime.html">$lifetime</a> = 0; <span class="comment">// No caching here.</span>
<a name="l971"><span class="linenum"> 971</span></a>  
<a name="l972"><span class="linenum"> 972</span></a>      } else if (<a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('filearea')" href="../../_variables/filearea.html">$filearea</a> === 'imsmanifest') { // This isn't a real filearea, it's a url parameter for this type of package.
<a name="l973"><span class="linenum"> 973</span></a>          <a class="var it2268" onMouseOver="hilite(2268)" onMouseOut="lolite()" onClick="logVariable('revision')" href="../../_variables/revision.html">$revision</a> = (int)<a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it25" onMouseOver="hilite(25)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../_variables/args.html">$args</a>); <span class="comment">// Prevents caching problems - ignored here.</span>
<a name="l974"><span class="linenum"> 974</span></a>          <a class="var it2277" onMouseOver="hilite(2277)" onMouseOut="lolite()" onClick="logVariable('relativepath')" href="../../_variables/relativepath.html">$relativepath</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>('/', <a class="var it25" onMouseOver="hilite(25)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../_variables/args.html">$args</a>);
<a name="l975"><span class="linenum"> 975</span></a>  
<a name="l976"><span class="linenum"> 976</span></a>  <span class="comment">        // Get imsmanifest file.</span>
<a name="l977"><span class="linenum"> 977</span></a>          <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a> = <a class="function" onClick="logFunction('get_file_storage')" href="../../_functions/get_file_storage.html" onMouseOver="funcPopup(event,'get_file_storage')">get_file_storage</a>();
<a name="l978"><span class="linenum"> 978</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('files')" href="../../_variables/files.html">$files</a> = <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('get_area_files')" href="../../_functions/get_area_files.html" onMouseOver="funcPopup(event,'get_area_files')">get_area_files</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'mod_scorm', 'package', 0, '', false);
<a name="l979"><span class="linenum"> 979</span></a>          <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('files')" href="../../_variables/files.html">$files</a>);
<a name="l980"><span class="linenum"> 980</span></a>  
<a name="l981"><span class="linenum"> 981</span></a>  <span class="comment">        // Check that the package file is an imsmanifest.xml file - if not then this method is not allowed.</span>
<a name="l982"><span class="linenum"> 982</span></a>          <a class="var it11934" onMouseOver="hilite(11934)" onMouseOut="lolite()" onClick="logVariable('packagefilename')" href="../../_variables/packagefilename.html">$packagefilename</a> = <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a>-&gt;<a class="function" onClick="logFunction('get_filename')" href="../../_functions/get_filename.html" onMouseOver="funcPopup(event,'get_filename')">get_filename</a>();
<a name="l983"><span class="linenum"> 983</span></a>          if (<a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it11934" onMouseOver="hilite(11934)" onMouseOut="lolite()" onClick="logVariable('packagefilename')" href="../../_variables/packagefilename.html">$packagefilename</a>) !== 'imsmanifest.xml') {
<a name="l984"><span class="linenum"> 984</span></a>              return false;
<a name="l985"><span class="linenum"> 985</span></a>          }
<a name="l986"><span class="linenum"> 986</span></a>  
<a name="l987"><span class="linenum"> 987</span></a>          <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a>-&gt;<a class="function" onClick="logFunction('send_relative_file')" href="../../_functions/send_relative_file.html" onMouseOver="funcPopup(event,'send_relative_file')">send_relative_file</a>(<a class="var it2277" onMouseOver="hilite(2277)" onMouseOut="lolite()" onClick="logVariable('relativepath')" href="../../_variables/relativepath.html">$relativepath</a>);
<a name="l988"><span class="linenum"> 988</span></a>      } else {
<a name="l989"><span class="linenum"> 989</span></a>          return false;
<a name="l990"><span class="linenum"> 990</span></a>      }
<a name="l991"><span class="linenum"> 991</span></a>  
<a name="l992"><span class="linenum"> 992</span></a>      <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a> = <a class="function" onClick="logFunction('get_file_storage')" href="../../_functions/get_file_storage.html" onMouseOver="funcPopup(event,'get_file_storage')">get_file_storage</a>();
<a name="l993"><span class="linenum"> 993</span></a>      if (!<a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a> = <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('get_file_by_hash')" href="../../_functions/get_file_by_hash.html" onMouseOver="funcPopup(event,'get_file_by_hash')">get_file_by_hash</a>(<a class="phpfunction" onClick="logFunction('sha1')" href="../../_functions/sha1.html" onMouseOver="phpfuncPopup(event,'sha1')">sha1</a>(<a class="var it241" onMouseOver="hilite(241)" onMouseOut="lolite()" onClick="logVariable('fullpath')" href="../../_variables/fullpath.html">$fullpath</a>)) or <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a>-&gt;<a class="function" onClick="logFunction('is_directory')" href="../../_functions/is_directory.html" onMouseOver="funcPopup(event,'is_directory')">is_directory</a>()) {
<a name="l994"><span class="linenum"> 994</span></a>          if (<a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('filearea')" href="../../_variables/filearea.html">$filearea</a> === 'content') { // Return file not found straight away to improve performance.
<a name="l995"><span class="linenum"> 995</span></a>              <a class="function" onClick="logFunction('send_header_404')" href="../../_functions/send_header_404.html" onMouseOver="funcPopup(event,'send_header_404')">send_header_404</a>();
<a name="l996"><span class="linenum"> 996</span></a>              die;
<a name="l997"><span class="linenum"> 997</span></a>          }
<a name="l998"><span class="linenum"> 998</span></a>          return false;
<a name="l999"><span class="linenum"> 999</span></a>      }
<a name="l1000"><span class="linenum">1000</span></a>  
<a name="l1001"><span class="linenum">1001</span></a>  <span class="comment">    // Finally send the file.</span>
<a name="l1002"><span class="linenum">1002</span></a>      <a class="function" onClick="logFunction('send_stored_file')" href="../../_functions/send_stored_file.html" onMouseOver="funcPopup(event,'send_stored_file')">send_stored_file</a>(<a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a>, <a class="var it3341" onMouseOver="hilite(3341)" onMouseOut="lolite()" onClick="logVariable('lifetime')" href="../../_variables/lifetime.html">$lifetime</a>, 0, false, <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>);
<a name="l1003"><span class="linenum">1003</span></a>  }
<a name="l1004"><span class="linenum">1004</span></a>  
<a name="l1005"><span class="linenum">1005</span></a>  <span class="comment">/**</span>
<a name="l1006"><span class="linenum">1006</span></a>  <span class="comment"> * @uses FEATURE_GROUPS</span>
<a name="l1007"><span class="linenum">1007</span></a>  <span class="comment"> * @uses FEATURE_GROUPINGS</span>
<a name="l1008"><span class="linenum">1008</span></a>  <span class="comment"> * @uses FEATURE_MOD_INTRO</span>
<a name="l1009"><span class="linenum">1009</span></a>  <span class="comment"> * @uses FEATURE_COMPLETION_TRACKS_VIEWS</span>
<a name="l1010"><span class="linenum">1010</span></a>  <span class="comment"> * @uses FEATURE_COMPLETION_HAS_RULES</span>
<a name="l1011"><span class="linenum">1011</span></a>  <span class="comment"> * @uses FEATURE_GRADE_HAS_GRADE</span>
<a name="l1012"><span class="linenum">1012</span></a>  <span class="comment"> * @uses FEATURE_GRADE_OUTCOMES</span>
<a name="l1013"><span class="linenum">1013</span></a>  <span class="comment"> * @param string $feature FEATURE_xx constant for requested feature</span>
<a name="l1014"><span class="linenum">1014</span></a>  <span class="comment"> * @return mixed True if module supports feature, false if not, null if doesn't know</span>
<a name="l1015"><span class="linenum">1015</span></a>  <span class="comment"> */</span>
<a name="l1016"><span class="linenum">1016</span></a>  function <a class="function" onClick="logFunction('scorm_supports')" href="../../_functions/scorm_supports.html" onMouseOver="funcPopup(event,'scorm_supports')">scorm_supports</a>(<a class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" onClick="logVariable('feature')" href="../../_variables/feature.html">$feature</a>) {
<a name="l1017"><span class="linenum">1017</span></a>      switch(<a class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" onClick="logVariable('feature')" href="../../_variables/feature.html">$feature</a>) {
<a name="l1018"><span class="linenum">1018</span></a>          case <a class="constant" onClick="logConstant('FEATURE_GROUPS')" href="../../_constants/FEATURE_GROUPS.html" onMouseOver="constPopup(event,'FEATURE_GROUPS')">FEATURE_GROUPS</a>:                  return true;
<a name="l1019"><span class="linenum">1019</span></a>          case <a class="constant" onClick="logConstant('FEATURE_GROUPINGS')" href="../../_constants/FEATURE_GROUPINGS.html" onMouseOver="constPopup(event,'FEATURE_GROUPINGS')">FEATURE_GROUPINGS</a>:               return true;
<a name="l1020"><span class="linenum">1020</span></a>          case <a class="constant" onClick="logConstant('FEATURE_MOD_INTRO')" href="../../_constants/FEATURE_MOD_INTRO.html" onMouseOver="constPopup(event,'FEATURE_MOD_INTRO')">FEATURE_MOD_INTRO</a>:               return true;
<a name="l1021"><span class="linenum">1021</span></a>          case <a class="constant" onClick="logConstant('FEATURE_COMPLETION_TRACKS_VIEWS')" href="../../_constants/FEATURE_COMPLETION_TRACKS_VIEWS.html" onMouseOver="constPopup(event,'FEATURE_COMPLETION_TRACKS_VIEWS')">FEATURE_COMPLETION_TRACKS_VIEWS</a>: return true;
<a name="l1022"><span class="linenum">1022</span></a>          case <a class="constant" onClick="logConstant('FEATURE_COMPLETION_HAS_RULES')" href="../../_constants/FEATURE_COMPLETION_HAS_RULES.html" onMouseOver="constPopup(event,'FEATURE_COMPLETION_HAS_RULES')">FEATURE_COMPLETION_HAS_RULES</a>:    return true;
<a name="l1023"><span class="linenum">1023</span></a>          case <a class="constant" onClick="logConstant('FEATURE_GRADE_HAS_GRADE')" href="../../_constants/FEATURE_GRADE_HAS_GRADE.html" onMouseOver="constPopup(event,'FEATURE_GRADE_HAS_GRADE')">FEATURE_GRADE_HAS_GRADE</a>:         return true;
<a name="l1024"><span class="linenum">1024</span></a>          case <a class="constant" onClick="logConstant('FEATURE_GRADE_OUTCOMES')" href="../../_constants/FEATURE_GRADE_OUTCOMES.html" onMouseOver="constPopup(event,'FEATURE_GRADE_OUTCOMES')">FEATURE_GRADE_OUTCOMES</a>:          return true;
<a name="l1025"><span class="linenum">1025</span></a>          case <a class="constant" onClick="logConstant('FEATURE_BACKUP_MOODLE2')" href="../../_constants/FEATURE_BACKUP_MOODLE2.html" onMouseOver="constPopup(event,'FEATURE_BACKUP_MOODLE2')">FEATURE_BACKUP_MOODLE2</a>:          return true;
<a name="l1026"><span class="linenum">1026</span></a>          case <a class="constant" onClick="logConstant('FEATURE_SHOW_DESCRIPTION')" href="../../_constants/FEATURE_SHOW_DESCRIPTION.html" onMouseOver="constPopup(event,'FEATURE_SHOW_DESCRIPTION')">FEATURE_SHOW_DESCRIPTION</a>:        return true;
<a name="l1027"><span class="linenum">1027</span></a>  
<a name="l1028"><span class="linenum">1028</span></a>          default: return null;
<a name="l1029"><span class="linenum">1029</span></a>      }
<a name="l1030"><span class="linenum">1030</span></a>  }
<a name="l1031"><span class="linenum">1031</span></a>  
<a name="l1032"><span class="linenum">1032</span></a>  <span class="comment">/**</span>
<a name="l1033"><span class="linenum">1033</span></a>  <span class="comment"> * Get the filename for a temp log file</span>
<a name="l1034"><span class="linenum">1034</span></a>  <span class="comment"> *</span>
<a name="l1035"><span class="linenum">1035</span></a>  <span class="comment"> * @param string $type - type of log(aicc,scorm12,scorm13) used as prefix for filename</span>
<a name="l1036"><span class="linenum">1036</span></a>  <span class="comment"> * @param integer $scoid - scoid of object this log entry is for</span>
<a name="l1037"><span class="linenum">1037</span></a>  <span class="comment"> * @return string The filename as an absolute path</span>
<a name="l1038"><span class="linenum">1038</span></a>  <span class="comment"> */</span>
<a name="l1039"><span class="linenum">1039</span></a>  function <a class="function" onClick="logFunction('scorm_debug_log_filename')" href="../../_functions/scorm_debug_log_filename.html" onMouseOver="funcPopup(event,'scorm_debug_log_filename')">scorm_debug_log_filename</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>, <a class="var it7856" onMouseOver="hilite(7856)" onMouseOut="lolite()" onClick="logVariable('scoid')" href="../../_variables/scoid.html">$scoid</a>) {
<a name="l1040"><span class="linenum">1040</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>;
<a name="l1041"><span class="linenum">1041</span></a>  
<a name="l1042"><span class="linenum">1042</span></a>      <a class="var it11935" onMouseOver="hilite(11935)" onMouseOut="lolite()" onClick="logVariable('logpath')" href="../../_variables/logpath.html">$logpath</a> = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('tempdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/tempdir.html">tempdir</a>.'/scormlogs';
<a name="l1043"><span class="linenum">1043</span></a>      <a class="var it11936" onMouseOver="hilite(11936)" onMouseOut="lolite()" onClick="logVariable('logfile')" href="../../_variables/logfile.html">$logfile</a> = <a class="var it11935" onMouseOver="hilite(11935)" onMouseOut="lolite()" onClick="logVariable('logpath')" href="../../_variables/logpath.html">$logpath</a>.'/'.<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>.'debug_'.<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>.'_'.<a class="var it7856" onMouseOver="hilite(7856)" onMouseOut="lolite()" onClick="logVariable('scoid')" href="../../_variables/scoid.html">$scoid</a>.'.log';
<a name="l1044"><span class="linenum">1044</span></a>      return <a class="var it11936" onMouseOver="hilite(11936)" onMouseOut="lolite()" onClick="logVariable('logfile')" href="../../_variables/logfile.html">$logfile</a>;
<a name="l1045"><span class="linenum">1045</span></a>  }
<a name="l1046"><span class="linenum">1046</span></a>  
<a name="l1047"><span class="linenum">1047</span></a>  <span class="comment">/**</span>
<a name="l1048"><span class="linenum">1048</span></a>  <span class="comment"> * writes log output to a temp log file</span>
<a name="l1049"><span class="linenum">1049</span></a>  <span class="comment"> *</span>
<a name="l1050"><span class="linenum">1050</span></a>  <span class="comment"> * @param string $type - type of log(aicc,scorm12,scorm13) used as prefix for filename</span>
<a name="l1051"><span class="linenum">1051</span></a>  <span class="comment"> * @param string $text - text to be written to file.</span>
<a name="l1052"><span class="linenum">1052</span></a>  <span class="comment"> * @param integer $scoid - scoid of object this log entry is for.</span>
<a name="l1053"><span class="linenum">1053</span></a>  <span class="comment"> */</span>
<a name="l1054"><span class="linenum">1054</span></a>  function <a class="function" onClick="logFunction('scorm_debug_log_write')" href="../../_functions/scorm_debug_log_write.html" onMouseOver="funcPopup(event,'scorm_debug_log_write')">scorm_debug_log_write</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>, <a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, <a class="var it7856" onMouseOver="hilite(7856)" onMouseOut="lolite()" onClick="logVariable('scoid')" href="../../_variables/scoid.html">$scoid</a>) {
<a name="l1055"><span class="linenum">1055</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l1056"><span class="linenum">1056</span></a>  
<a name="l1057"><span class="linenum">1057</span></a>      <a class="var it11937" onMouseOver="hilite(11937)" onMouseOut="lolite()" onClick="logVariable('debugenablelog')" href="../../_variables/debugenablelog.html">$debugenablelog</a> = <a class="function" onClick="logFunction('get_config')" href="../../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>('scorm', 'allowapidebug');
<a name="l1058"><span class="linenum">1058</span></a>      if (!<a class="var it11937" onMouseOver="hilite(11937)" onMouseOut="lolite()" onClick="logVariable('debugenablelog')" href="../../_variables/debugenablelog.html">$debugenablelog</a> || empty(<a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>)) {
<a name="l1059"><span class="linenum">1059</span></a>          return;
<a name="l1060"><span class="linenum">1060</span></a>      }
<a name="l1061"><span class="linenum">1061</span></a>      if (<a class="function" onClick="logFunction('make_temp_directory')" href="../../_functions/make_temp_directory.html" onMouseOver="funcPopup(event,'make_temp_directory')">make_temp_directory</a>('scormlogs/')) {
<a name="l1062"><span class="linenum">1062</span></a>          <a class="var it11936" onMouseOver="hilite(11936)" onMouseOut="lolite()" onClick="logVariable('logfile')" href="../../_variables/logfile.html">$logfile</a> = <a class="function" onClick="logFunction('scorm_debug_log_filename')" href="../../_functions/scorm_debug_log_filename.html" onMouseOver="funcPopup(event,'scorm_debug_log_filename')">scorm_debug_log_filename</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>, <a class="var it7856" onMouseOver="hilite(7856)" onMouseOut="lolite()" onClick="logVariable('scoid')" href="../../_variables/scoid.html">$scoid</a>);
<a name="l1063"><span class="linenum">1063</span></a>          @<a class="phpfunction" onClick="logFunction('file_put_contents')" href="../../_functions/file_put_contents.html" onMouseOver="phpfuncPopup(event,'file_put_contents')">file_put_contents</a>(<a class="var it11936" onMouseOver="hilite(11936)" onMouseOut="lolite()" onClick="logVariable('logfile')" href="../../_variables/logfile.html">$logfile</a>, <a class="phpfunction" onClick="logFunction('date')" href="../../_functions/date.html" onMouseOver="phpfuncPopup(event,'date')">date</a>('Y/m/d H:i:s O').&quot; DEBUG <a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>\r\n&quot;, FILE_APPEND);
<a name="l1064"><span class="linenum">1064</span></a>          @<a class="phpfunction" onClick="logFunction('chmod')" href="../../_functions/chmod.html" onMouseOver="phpfuncPopup(event,'chmod')">chmod</a>(<a class="var it11936" onMouseOver="hilite(11936)" onMouseOut="lolite()" onClick="logVariable('logfile')" href="../../_variables/logfile.html">$logfile</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('filepermissions')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/filepermissions.html">filepermissions</a>);
<a name="l1065"><span class="linenum">1065</span></a>      }
<a name="l1066"><span class="linenum">1066</span></a>  }
<a name="l1067"><span class="linenum">1067</span></a>  
<a name="l1068"><span class="linenum">1068</span></a>  <span class="comment">/**</span>
<a name="l1069"><span class="linenum">1069</span></a>  <span class="comment"> * Remove debug log file</span>
<a name="l1070"><span class="linenum">1070</span></a>  <span class="comment"> *</span>
<a name="l1071"><span class="linenum">1071</span></a>  <span class="comment"> * @param string $type - type of log(aicc,scorm12,scorm13) used as prefix for filename</span>
<a name="l1072"><span class="linenum">1072</span></a>  <span class="comment"> * @param integer $scoid - scoid of object this log entry is for</span>
<a name="l1073"><span class="linenum">1073</span></a>  <span class="comment"> * @return boolean True if the file is successfully deleted, false otherwise</span>
<a name="l1074"><span class="linenum">1074</span></a>  <span class="comment"> */</span>
<a name="l1075"><span class="linenum">1075</span></a>  function <a class="function" onClick="logFunction('scorm_debug_log_remove')" href="../../_functions/scorm_debug_log_remove.html" onMouseOver="funcPopup(event,'scorm_debug_log_remove')">scorm_debug_log_remove</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>, <a class="var it7856" onMouseOver="hilite(7856)" onMouseOut="lolite()" onClick="logVariable('scoid')" href="../../_variables/scoid.html">$scoid</a>) {
<a name="l1076"><span class="linenum">1076</span></a>  
<a name="l1077"><span class="linenum">1077</span></a>      <a class="var it11937" onMouseOver="hilite(11937)" onMouseOut="lolite()" onClick="logVariable('debugenablelog')" href="../../_variables/debugenablelog.html">$debugenablelog</a> = <a class="function" onClick="logFunction('get_config')" href="../../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>('scorm', 'allowapidebug');
<a name="l1078"><span class="linenum">1078</span></a>      <a class="var it11936" onMouseOver="hilite(11936)" onMouseOut="lolite()" onClick="logVariable('logfile')" href="../../_variables/logfile.html">$logfile</a> = <a class="function" onClick="logFunction('scorm_debug_log_filename')" href="../../_functions/scorm_debug_log_filename.html" onMouseOver="funcPopup(event,'scorm_debug_log_filename')">scorm_debug_log_filename</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>, <a class="var it7856" onMouseOver="hilite(7856)" onMouseOut="lolite()" onClick="logVariable('scoid')" href="../../_variables/scoid.html">$scoid</a>);
<a name="l1079"><span class="linenum">1079</span></a>      if (!<a class="var it11937" onMouseOver="hilite(11937)" onMouseOut="lolite()" onClick="logVariable('debugenablelog')" href="../../_variables/debugenablelog.html">$debugenablelog</a> || !<a class="phpfunction" onClick="logFunction('file_exists')" href="../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it11936" onMouseOver="hilite(11936)" onMouseOut="lolite()" onClick="logVariable('logfile')" href="../../_variables/logfile.html">$logfile</a>)) {
<a name="l1080"><span class="linenum">1080</span></a>          return false;
<a name="l1081"><span class="linenum">1081</span></a>      }
<a name="l1082"><span class="linenum">1082</span></a>  
<a name="l1083"><span class="linenum">1083</span></a>      return @<a class="phpfunction" onClick="logFunction('unlink')" href="../../_functions/unlink.html" onMouseOver="phpfuncPopup(event,'unlink')">unlink</a>(<a class="var it11936" onMouseOver="hilite(11936)" onMouseOut="lolite()" onClick="logVariable('logfile')" href="../../_variables/logfile.html">$logfile</a>);
<a name="l1084"><span class="linenum">1084</span></a>  }
<a name="l1085"><span class="linenum">1085</span></a>  
<a name="l1086"><span class="linenum">1086</span></a>  <span class="comment">/**</span>
<a name="l1087"><span class="linenum">1087</span></a>  <span class="comment"> * writes overview info for course_overview block - displays upcoming scorm objects that have a due date</span>
<a name="l1088"><span class="linenum">1088</span></a>  <span class="comment"> *</span>
<a name="l1089"><span class="linenum">1089</span></a>  <span class="comment"> * @param object $type - type of log(aicc,scorm12,scorm13) used as prefix for filename</span>
<a name="l1090"><span class="linenum">1090</span></a>  <span class="comment"> * @param array $htmlarray</span>
<a name="l1091"><span class="linenum">1091</span></a>  <span class="comment"> * @return mixed</span>
<a name="l1092"><span class="linenum">1092</span></a>  <span class="comment"> */</span>
<a name="l1093"><span class="linenum">1093</span></a>  function <a class="function" onClick="logFunction('scorm_print_overview')" href="../../_functions/scorm_print_overview.html" onMouseOver="funcPopup(event,'scorm_print_overview')">scorm_print_overview</a>(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>, &amp;<a class="var it9833" onMouseOver="hilite(9833)" onMouseOut="lolite()" onClick="logVariable('htmlarray')" href="../../_variables/htmlarray.html">$htmlarray</a>) {
<a name="l1094"><span class="linenum">1094</span></a>      global <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l1095"><span class="linenum">1095</span></a>  
<a name="l1096"><span class="linenum">1096</span></a>      if (empty(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>) || !<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>) || <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>) == 0) {
<a name="l1097"><span class="linenum">1097</span></a>          return array();
<a name="l1098"><span class="linenum">1098</span></a>      }
<a name="l1099"><span class="linenum">1099</span></a>  
<a name="l1100"><span class="linenum">1100</span></a>      if (!<a class="var it635" onMouseOver="hilite(635)" onMouseOut="lolite()" onClick="logVariable('scorms')" href="../../_variables/scorms.html">$scorms</a> = <a class="function" onClick="logFunction('get_all_instances_in_courses')" href="../../_functions/get_all_instances_in_courses.html" onMouseOver="funcPopup(event,'get_all_instances_in_courses')">get_all_instances_in_courses</a>('scorm', <a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>)) {
<a name="l1101"><span class="linenum">1101</span></a>          return;
<a name="l1102"><span class="linenum">1102</span></a>      }
<a name="l1103"><span class="linenum">1103</span></a>  
<a name="l1104"><span class="linenum">1104</span></a>      <a class="var it11938" onMouseOver="hilite(11938)" onMouseOut="lolite()" onClick="logVariable('strscorm')" href="../../_variables/strscorm.html">$strscorm</a>   = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('modulename', 'scorm');
<a name="l1105"><span class="linenum">1105</span></a>      <a class="var it11939" onMouseOver="hilite(11939)" onMouseOut="lolite()" onClick="logVariable('strduedate')" href="../../_variables/strduedate.html">$strduedate</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('duedate', 'scorm');
<a name="l1106"><span class="linenum">1106</span></a>  
<a name="l1107"><span class="linenum">1107</span></a>      foreach (<a class="var it635" onMouseOver="hilite(635)" onMouseOut="lolite()" onClick="logVariable('scorms')" href="../../_variables/scorms.html">$scorms</a> as <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>) {
<a name="l1108"><span class="linenum">1108</span></a>          <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('time')" href="../../_variables/time.html">$time</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l1109"><span class="linenum">1109</span></a>          <a class="var it11940" onMouseOver="hilite(11940)" onMouseOut="lolite()" onClick="logVariable('showattemptstatus')" href="../../_variables/showattemptstatus.html">$showattemptstatus</a> = false;
<a name="l1110"><span class="linenum">1110</span></a>          if (<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('timeopen')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/timeopen.html">timeopen</a>) {
<a name="l1111"><span class="linenum">1111</span></a>              <a class="var it11941" onMouseOver="hilite(11941)" onMouseOut="lolite()" onClick="logVariable('isopen')" href="../../_variables/isopen.html">$isopen</a> = (<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('timeopen')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/timeopen.html">timeopen</a> &lt;= <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('time')" href="../../_variables/time.html">$time</a> &amp;&amp; <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('time')" href="../../_variables/time.html">$time</a> &lt;= <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('timeclose')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/timeclose.html">timeclose</a>);
<a name="l1112"><span class="linenum">1112</span></a>          }
<a name="l1113"><span class="linenum">1113</span></a>          if (<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('displayattemptstatus')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/displayattemptstatus.html">displayattemptstatus</a> == <a class="constant" onClick="logConstant('SCORM_DISPLAY_ATTEMPTSTATUS_ALL')" href="../../_constants/SCORM_DISPLAY_ATTEMPTSTATUS_ALL.html" onMouseOver="constPopup(event,'SCORM_DISPLAY_ATTEMPTSTATUS_ALL')">SCORM_DISPLAY_ATTEMPTSTATUS_ALL</a> ||
<a name="l1114"><span class="linenum">1114</span></a>                  <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('displayattemptstatus')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/displayattemptstatus.html">displayattemptstatus</a> == <a class="constant" onClick="logConstant('SCORM_DISPLAY_ATTEMPTSTATUS_MY')" href="../../_constants/SCORM_DISPLAY_ATTEMPTSTATUS_MY.html" onMouseOver="constPopup(event,'SCORM_DISPLAY_ATTEMPTSTATUS_MY')">SCORM_DISPLAY_ATTEMPTSTATUS_MY</a>) {
<a name="l1115"><span class="linenum">1115</span></a>              <a class="var it11940" onMouseOver="hilite(11940)" onMouseOut="lolite()" onClick="logVariable('showattemptstatus')" href="../../_variables/showattemptstatus.html">$showattemptstatus</a> = true;
<a name="l1116"><span class="linenum">1116</span></a>          }
<a name="l1117"><span class="linenum">1117</span></a>          if (<a class="var it11940" onMouseOver="hilite(11940)" onMouseOut="lolite()" onClick="logVariable('showattemptstatus')" href="../../_variables/showattemptstatus.html">$showattemptstatus</a> || !empty(<a class="var it11941" onMouseOver="hilite(11941)" onMouseOut="lolite()" onClick="logVariable('isopen')" href="../../_variables/isopen.html">$isopen</a>) || !empty(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('timeclose')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/timeclose.html">timeclose</a>)) {
<a name="l1118"><span class="linenum">1118</span></a>              <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a> = <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('start_div')" href="../../_functions/start_div.html" onMouseOver="funcPopup(event,'start_div')">start_div</a>('scorm overview').<a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('div')" href="../../_functions/div.html" onMouseOver="funcPopup(event,'div')">div</a>(<a class="var it11938" onMouseOver="hilite(11938)" onMouseOut="lolite()" onClick="logVariable('strscorm')" href="../../_variables/strscorm.html">$strscorm</a>. ': '.
<a name="l1119"><span class="linenum">1119</span></a>                      <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="phpfunction" onClick="logFunction('link')" href="../../_functions/link.html" onMouseOver="phpfuncPopup(event,'link')">link</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>.'/mod/scorm/view.php?id='.<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('coursemodule')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/coursemodule.html">coursemodule</a>, <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('name')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>,
<a name="l1120"><span class="linenum">1120</span></a>                                          array('title' =&gt; <a class="var it11938" onMouseOver="hilite(11938)" onMouseOut="lolite()" onClick="logVariable('strscorm')" href="../../_variables/strscorm.html">$strscorm</a>, 'class' =&gt; <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('visible')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/visible.html">visible</a> ? '' : 'dimmed')), 'name');
<a name="l1121"><span class="linenum">1121</span></a>              if (<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('timeclose')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/timeclose.html">timeclose</a>) {
<a name="l1122"><span class="linenum">1122</span></a>                  <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('div')" href="../../_functions/div.html" onMouseOver="funcPopup(event,'div')">div</a>(<a class="var it11939" onMouseOver="hilite(11939)" onMouseOut="lolite()" onClick="logVariable('strduedate')" href="../../_variables/strduedate.html">$strduedate</a>.': '.<a class="function" onClick="logFunction('userdate')" href="../../_functions/userdate.html" onMouseOver="funcPopup(event,'userdate')">userdate</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('timeclose')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/timeclose.html">timeclose</a>), 'info');
<a name="l1123"><span class="linenum">1123</span></a>              }
<a name="l1124"><span class="linenum">1124</span></a>              if (<a class="var it11940" onMouseOver="hilite(11940)" onMouseOut="lolite()" onClick="logVariable('showattemptstatus')" href="../../_variables/showattemptstatus.html">$showattemptstatus</a>) {
<a name="l1125"><span class="linenum">1125</span></a>                  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../mod/scorm/locallib.php.html">/mod/scorm/locallib.php</a>');
<a name="l1126"><span class="linenum">1126</span></a>                  <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('div')" href="../../_functions/div.html" onMouseOver="funcPopup(event,'div')">div</a>(<a class="function" onClick="logFunction('scorm_get_attempt_status')" href="../../_functions/scorm_get_attempt_status.html" onMouseOver="funcPopup(event,'scorm_get_attempt_status')">scorm_get_attempt_status</a>(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>), 'details');
<a name="l1127"><span class="linenum">1127</span></a>              }
<a name="l1128"><span class="linenum">1128</span></a>              <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('end_div')" href="../../_functions/end_div.html" onMouseOver="funcPopup(event,'end_div')">end_div</a>();
<a name="l1129"><span class="linenum">1129</span></a>              if (empty(<a class="var it9833" onMouseOver="hilite(9833)" onMouseOut="lolite()" onClick="logVariable('htmlarray')" href="../../_variables/htmlarray.html">$htmlarray</a>[<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('course')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>]['scorm'])) {
<a name="l1130"><span class="linenum">1130</span></a>                  <a class="var it9833" onMouseOver="hilite(9833)" onMouseOut="lolite()" onClick="logVariable('htmlarray')" href="../../_variables/htmlarray.html">$htmlarray</a>[<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('course')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>]['scorm'] = <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a>;
<a name="l1131"><span class="linenum">1131</span></a>              } else {
<a name="l1132"><span class="linenum">1132</span></a>                  <a class="var it9833" onMouseOver="hilite(9833)" onMouseOut="lolite()" onClick="logVariable('htmlarray')" href="../../_variables/htmlarray.html">$htmlarray</a>[<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('course')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>]['scorm'] .= <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a>;
<a name="l1133"><span class="linenum">1133</span></a>              }
<a name="l1134"><span class="linenum">1134</span></a>          }
<a name="l1135"><span class="linenum">1135</span></a>      }
<a name="l1136"><span class="linenum">1136</span></a>  }
<a name="l1137"><span class="linenum">1137</span></a>  
<a name="l1138"><span class="linenum">1138</span></a>  <span class="comment">/**</span>
<a name="l1139"><span class="linenum">1139</span></a>  <span class="comment"> * Return a list of page types</span>
<a name="l1140"><span class="linenum">1140</span></a>  <span class="comment"> * @param string $pagetype current page type</span>
<a name="l1141"><span class="linenum">1141</span></a>  <span class="comment"> * @param stdClass $parentcontext Block's parent context</span>
<a name="l1142"><span class="linenum">1142</span></a>  <span class="comment"> * @param stdClass $currentcontext Current context of block</span>
<a name="l1143"><span class="linenum">1143</span></a>  <span class="comment"> */</span>
<a name="l1144"><span class="linenum">1144</span></a>  function <a class="function" onClick="logFunction('scorm_page_type_list')" href="../../_functions/scorm_page_type_list.html" onMouseOver="funcPopup(event,'scorm_page_type_list')">scorm_page_type_list</a>(<a class="var it2278" onMouseOver="hilite(2278)" onMouseOut="lolite()" onClick="logVariable('pagetype')" href="../../_variables/pagetype.html">$pagetype</a>, <a class="var it2279" onMouseOver="hilite(2279)" onMouseOut="lolite()" onClick="logVariable('parentcontext')" href="../../_variables/parentcontext.html">$parentcontext</a>, <a class="var it2280" onMouseOver="hilite(2280)" onMouseOut="lolite()" onClick="logVariable('currentcontext')" href="../../_variables/currentcontext.html">$currentcontext</a>) {
<a name="l1145"><span class="linenum">1145</span></a>      <a class="var it2281" onMouseOver="hilite(2281)" onMouseOut="lolite()" onClick="logVariable('modulepagetype')" href="../../_variables/modulepagetype.html">$modulepagetype</a> = array('mod-scorm-*' =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('page-mod-scorm-x', 'scorm'));
<a name="l1146"><span class="linenum">1146</span></a>      return <a class="var it2281" onMouseOver="hilite(2281)" onMouseOut="lolite()" onClick="logVariable('modulepagetype')" href="../../_variables/modulepagetype.html">$modulepagetype</a>;
<a name="l1147"><span class="linenum">1147</span></a>  }
<a name="l1148"><span class="linenum">1148</span></a>  
<a name="l1149"><span class="linenum">1149</span></a>  <span class="comment">/**</span>
<a name="l1150"><span class="linenum">1150</span></a>  <span class="comment"> * Returns the SCORM version used.</span>
<a name="l1151"><span class="linenum">1151</span></a>  <span class="comment"> * @param string $scormversion comes from $scorm-&gt;version</span>
<a name="l1152"><span class="linenum">1152</span></a>  <span class="comment"> * @param string $version one of the defined vars SCORM_12, SCORM_13, SCORM_AICC (or empty)</span>
<a name="l1153"><span class="linenum">1153</span></a>  <span class="comment"> * @return Scorm version.</span>
<a name="l1154"><span class="linenum">1154</span></a>  <span class="comment"> */</span>
<a name="l1155"><span class="linenum">1155</span></a>  function <a class="function" onClick="logFunction('scorm_version_check')" href="../../_functions/scorm_version_check.html" onMouseOver="funcPopup(event,'scorm_version_check')">scorm_version_check</a>(<a class="var it11942" onMouseOver="hilite(11942)" onMouseOut="lolite()" onClick="logVariable('scormversion')" href="../../_variables/scormversion.html">$scormversion</a>, <a class="var it347" onMouseOver="hilite(347)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../_variables/version.html">$version</a>='') {
<a name="l1156"><span class="linenum">1156</span></a>      <a class="var it11942" onMouseOver="hilite(11942)" onMouseOut="lolite()" onClick="logVariable('scormversion')" href="../../_variables/scormversion.html">$scormversion</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it11942" onMouseOver="hilite(11942)" onMouseOut="lolite()" onClick="logVariable('scormversion')" href="../../_variables/scormversion.html">$scormversion</a>));
<a name="l1157"><span class="linenum">1157</span></a>      if (empty(<a class="var it347" onMouseOver="hilite(347)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../_variables/version.html">$version</a>) || <a class="var it347" onMouseOver="hilite(347)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../_variables/version.html">$version</a> == <a class="constant" onClick="logConstant('SCORM_12')" href="../../_constants/SCORM_12.html" onMouseOver="constPopup(event,'SCORM_12')">SCORM_12</a>) {
<a name="l1158"><span class="linenum">1158</span></a>          if (<a class="var it11942" onMouseOver="hilite(11942)" onMouseOut="lolite()" onClick="logVariable('scormversion')" href="../../_variables/scormversion.html">$scormversion</a> == 'scorm_12' || <a class="var it11942" onMouseOver="hilite(11942)" onMouseOut="lolite()" onClick="logVariable('scormversion')" href="../../_variables/scormversion.html">$scormversion</a> == 'scorm_1.2') {
<a name="l1159"><span class="linenum">1159</span></a>              return <a class="constant" onClick="logConstant('SCORM_12')" href="../../_constants/SCORM_12.html" onMouseOver="constPopup(event,'SCORM_12')">SCORM_12</a>;
<a name="l1160"><span class="linenum">1160</span></a>          }
<a name="l1161"><span class="linenum">1161</span></a>          if (!empty(<a class="var it347" onMouseOver="hilite(347)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../_variables/version.html">$version</a>)) {
<a name="l1162"><span class="linenum">1162</span></a>              return false;
<a name="l1163"><span class="linenum">1163</span></a>          }
<a name="l1164"><span class="linenum">1164</span></a>      }
<a name="l1165"><span class="linenum">1165</span></a>      if (empty(<a class="var it347" onMouseOver="hilite(347)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../_variables/version.html">$version</a>) || <a class="var it347" onMouseOver="hilite(347)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../_variables/version.html">$version</a> == <a class="constant" onClick="logConstant('SCORM_13')" href="../../_constants/SCORM_13.html" onMouseOver="constPopup(event,'SCORM_13')">SCORM_13</a>) {
<a name="l1166"><span class="linenum">1166</span></a>          if (<a class="var it11942" onMouseOver="hilite(11942)" onMouseOut="lolite()" onClick="logVariable('scormversion')" href="../../_variables/scormversion.html">$scormversion</a> == 'scorm_13' || <a class="var it11942" onMouseOver="hilite(11942)" onMouseOut="lolite()" onClick="logVariable('scormversion')" href="../../_variables/scormversion.html">$scormversion</a> == 'scorm_1.3') {
<a name="l1167"><span class="linenum">1167</span></a>              return <a class="constant" onClick="logConstant('SCORM_13')" href="../../_constants/SCORM_13.html" onMouseOver="constPopup(event,'SCORM_13')">SCORM_13</a>;
<a name="l1168"><span class="linenum">1168</span></a>          }
<a name="l1169"><span class="linenum">1169</span></a>          if (!empty(<a class="var it347" onMouseOver="hilite(347)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../_variables/version.html">$version</a>)) {
<a name="l1170"><span class="linenum">1170</span></a>              return false;
<a name="l1171"><span class="linenum">1171</span></a>          }
<a name="l1172"><span class="linenum">1172</span></a>      }
<a name="l1173"><span class="linenum">1173</span></a>      if (empty(<a class="var it347" onMouseOver="hilite(347)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../_variables/version.html">$version</a>) || <a class="var it347" onMouseOver="hilite(347)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../_variables/version.html">$version</a> == <a class="constant" onClick="logConstant('SCORM_AICC')" href="../../_constants/SCORM_AICC.html" onMouseOver="constPopup(event,'SCORM_AICC')">SCORM_AICC</a>) {
<a name="l1174"><span class="linenum">1174</span></a>          if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it11942" onMouseOver="hilite(11942)" onMouseOut="lolite()" onClick="logVariable('scormversion')" href="../../_variables/scormversion.html">$scormversion</a>, 'aicc')) {
<a name="l1175"><span class="linenum">1175</span></a>              return <a class="constant" onClick="logConstant('SCORM_AICC')" href="../../_constants/SCORM_AICC.html" onMouseOver="constPopup(event,'SCORM_AICC')">SCORM_AICC</a>;
<a name="l1176"><span class="linenum">1176</span></a>          }
<a name="l1177"><span class="linenum">1177</span></a>          if (!empty(<a class="var it347" onMouseOver="hilite(347)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../_variables/version.html">$version</a>)) {
<a name="l1178"><span class="linenum">1178</span></a>              return false;
<a name="l1179"><span class="linenum">1179</span></a>          }
<a name="l1180"><span class="linenum">1180</span></a>      }
<a name="l1181"><span class="linenum">1181</span></a>      return false;
<a name="l1182"><span class="linenum">1182</span></a>  }
<a name="l1183"><span class="linenum">1183</span></a>  
<a name="l1184"><span class="linenum">1184</span></a>  <span class="comment">/**</span>
<a name="l1185"><span class="linenum">1185</span></a>  <span class="comment"> * Obtains the automatic completion state for this scorm based on any conditions</span>
<a name="l1186"><span class="linenum">1186</span></a>  <span class="comment"> * in scorm settings.</span>
<a name="l1187"><span class="linenum">1187</span></a>  <span class="comment"> *</span>
<a name="l1188"><span class="linenum">1188</span></a>  <span class="comment"> * @param object $course Course</span>
<a name="l1189"><span class="linenum">1189</span></a>  <span class="comment"> * @param object $cm Course-module</span>
<a name="l1190"><span class="linenum">1190</span></a>  <span class="comment"> * @param int $userid User ID</span>
<a name="l1191"><span class="linenum">1191</span></a>  <span class="comment"> * @param bool $type Type of comparison (or/and; can be used as return value if no conditions)</span>
<a name="l1192"><span class="linenum">1192</span></a>  <span class="comment"> * @return bool True if completed, false if not. (If no conditions, then return</span>
<a name="l1193"><span class="linenum">1193</span></a>  <span class="comment"> *   value depends on comparison type)</span>
<a name="l1194"><span class="linenum">1194</span></a>  <span class="comment"> */</span>
<a name="l1195"><span class="linenum">1195</span></a>  function <a class="function" onClick="logFunction('scorm_get_completion_state')" href="../../_functions/scorm_get_completion_state.html" onMouseOver="funcPopup(event,'scorm_get_completion_state')">scorm_get_completion_state</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>) {
<a name="l1196"><span class="linenum">1196</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1197"><span class="linenum">1197</span></a>  
<a name="l1198"><span class="linenum">1198</span></a>      <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>;
<a name="l1199"><span class="linenum">1199</span></a>  
<a name="l1200"><span class="linenum">1200</span></a>  <span class="comment">    // Get scorm.</span>
<a name="l1201"><span class="linenum">1201</span></a>      if (!<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('scorm', array('id' =&gt; <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('instance')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/instance.html">instance</a>))) {
<a name="l1202"><span class="linenum">1202</span></a>          <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('cannotfindscorm');
<a name="l1203"><span class="linenum">1203</span></a>      }
<a name="l1204"><span class="linenum">1204</span></a>  <span class="comment">    // Only check for existence of tracks and return false if completionstatusrequired or completionscorerequired</span>
<a name="l1205"><span class="linenum">1205</span></a>  <span class="comment">    // this means that if only view is required we don't end up with a false state.</span>
<a name="l1206"><span class="linenum">1206</span></a>      if (<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('completionstatusrequired')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/completionstatusrequired.html">completionstatusrequired</a> !== null ||
<a name="l1207"><span class="linenum">1207</span></a>          <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('completionscorerequired')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/completionscorerequired.html">completionscorerequired</a> !== null) {
<a name="l1208"><span class="linenum">1208</span></a>  <span class="comment">        // Get user's tracks data.</span>
<a name="l1209"><span class="linenum">1209</span></a>          <a class="var it6825" onMouseOver="hilite(6825)" onMouseOut="lolite()" onClick="logVariable('tracks')" href="../../_variables/tracks.html">$tracks</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(
<a name="l1210"><span class="linenum">1210</span></a>              &quot;
<a name="l1211"><span class="linenum">1211</span></a>              SELECT
<a name="l1212"><span class="linenum">1212</span></a>                  id,
<a name="l1213"><span class="linenum">1213</span></a>                  element,
<a name="l1214"><span class="linenum">1214</span></a>                  value
<a name="l1215"><span class="linenum">1215</span></a>              FROM
<a name="l1216"><span class="linenum">1216</span></a>                  {scorm_scoes_track}
<a name="l1217"><span class="linenum">1217</span></a>              WHERE
<a name="l1218"><span class="linenum">1218</span></a>                  scormid = ?
<a name="l1219"><span class="linenum">1219</span></a>              AND userid = ?
<a name="l1220"><span class="linenum">1220</span></a>              AND element IN
<a name="l1221"><span class="linenum">1221</span></a>              (
<a name="l1222"><span class="linenum">1222</span></a>                  'cmi.core.lesson_status',
<a name="l1223"><span class="linenum">1223</span></a>                  'cmi.completion_status',
<a name="l1224"><span class="linenum">1224</span></a>                  'cmi.success_status',
<a name="l1225"><span class="linenum">1225</span></a>                  'cmi.core.score.raw',
<a name="l1226"><span class="linenum">1226</span></a>                  'cmi.score.raw'
<a name="l1227"><span class="linenum">1227</span></a>              )
<a name="l1228"><span class="linenum">1228</span></a>              &quot;,
<a name="l1229"><span class="linenum">1229</span></a>              array(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('id')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>)
<a name="l1230"><span class="linenum">1230</span></a>          );
<a name="l1231"><span class="linenum">1231</span></a>  
<a name="l1232"><span class="linenum">1232</span></a>          if (!<a class="var it6825" onMouseOver="hilite(6825)" onMouseOut="lolite()" onClick="logVariable('tracks')" href="../../_variables/tracks.html">$tracks</a>) {
<a name="l1233"><span class="linenum">1233</span></a>              return <a class="class" onClick="logClass('completion_info')" href="../../_classes/completion_info.html" onMouseOver="classPopup(event,'completion_info')">completion_info</a>::<a class="function" onClick="logFunction('aggregate_completion_states')" href="../../_functions/aggregate_completion_states.html" onMouseOver="funcPopup(event,'aggregate_completion_states')">aggregate_completion_states</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>, <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>, false);
<a name="l1234"><span class="linenum">1234</span></a>          }
<a name="l1235"><span class="linenum">1235</span></a>      }
<a name="l1236"><span class="linenum">1236</span></a>  
<a name="l1237"><span class="linenum">1237</span></a>  <span class="comment">    // Check for status.</span>
<a name="l1238"><span class="linenum">1238</span></a>      if (<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('completionstatusrequired')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/completionstatusrequired.html">completionstatusrequired</a> !== null) {
<a name="l1239"><span class="linenum">1239</span></a>  
<a name="l1240"><span class="linenum">1240</span></a>  <span class="comment">        // Get status.</span>
<a name="l1241"><span class="linenum">1241</span></a>          <a class="var it11943" onMouseOver="hilite(11943)" onMouseOut="lolite()" onClick="logVariable('statuses')" href="../../_variables/statuses.html">$statuses</a> = <a class="phpfunction" onClick="logFunction('array_flip')" href="../../_functions/array_flip.html" onMouseOver="phpfuncPopup(event,'array_flip')">array_flip</a>(<a class="function" onClick="logFunction('scorm_status_options')" href="../../_functions/scorm_status_options.html" onMouseOver="funcPopup(event,'scorm_status_options')">scorm_status_options</a>());
<a name="l1242"><span class="linenum">1242</span></a>          <a class="var it11944" onMouseOver="hilite(11944)" onMouseOut="lolite()" onClick="logVariable('nstatus')" href="../../_variables/nstatus.html">$nstatus</a> = 0;
<a name="l1243"><span class="linenum">1243</span></a>  
<a name="l1244"><span class="linenum">1244</span></a>          foreach (<a class="var it6825" onMouseOver="hilite(6825)" onMouseOut="lolite()" onClick="logVariable('tracks')" href="../../_variables/tracks.html">$tracks</a> as <a class="var it6706" onMouseOver="hilite(6706)" onMouseOut="lolite()" onClick="logVariable('track')" href="../../_variables/track.html">$track</a>) {
<a name="l1245"><span class="linenum">1245</span></a>              if (!<a class="phpfunction" onClick="logFunction('in_array')" href="../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it6706" onMouseOver="hilite(6706)" onMouseOut="lolite()" onClick="logVariable('track')" href="../../_variables/track.html">$track</a>-&gt;<a onClick="logVariable('element')" class="var it44620" onMouseOver="hilite(44620)" onMouseOut="lolite()" href="../../_variables/element.html">element</a>, array('cmi.core.lesson_status', 'cmi.completion_status', 'cmi.success_status'))) {
<a name="l1246"><span class="linenum">1246</span></a>                  continue;
<a name="l1247"><span class="linenum">1247</span></a>              }
<a name="l1248"><span class="linenum">1248</span></a>  
<a name="l1249"><span class="linenum">1249</span></a>              if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it6706" onMouseOver="hilite(6706)" onMouseOut="lolite()" onClick="logVariable('track')" href="../../_variables/track.html">$track</a>-&gt;<a onClick="logVariable('value')" class="var it44620" onMouseOver="hilite(44620)" onMouseOut="lolite()" href="../../_variables/value.html">value</a>, <a class="var it11943" onMouseOver="hilite(11943)" onMouseOut="lolite()" onClick="logVariable('statuses')" href="../../_variables/statuses.html">$statuses</a>)) {
<a name="l1250"><span class="linenum">1250</span></a>                  <a class="var it11944" onMouseOver="hilite(11944)" onMouseOut="lolite()" onClick="logVariable('nstatus')" href="../../_variables/nstatus.html">$nstatus</a> |= <a class="var it11943" onMouseOver="hilite(11943)" onMouseOut="lolite()" onClick="logVariable('statuses')" href="../../_variables/statuses.html">$statuses</a>[<a class="var it6706" onMouseOver="hilite(6706)" onMouseOut="lolite()" onClick="logVariable('track')" href="../../_variables/track.html">$track</a>-&gt;<a onClick="logVariable('value')" class="var it44620" onMouseOver="hilite(44620)" onMouseOut="lolite()" href="../../_variables/value.html">value</a>];
<a name="l1251"><span class="linenum">1251</span></a>              }
<a name="l1252"><span class="linenum">1252</span></a>          }
<a name="l1253"><span class="linenum">1253</span></a>  
<a name="l1254"><span class="linenum">1254</span></a>          if (<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('completionstatusrequired')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/completionstatusrequired.html">completionstatusrequired</a> &amp; <a class="var it11944" onMouseOver="hilite(11944)" onMouseOut="lolite()" onClick="logVariable('nstatus')" href="../../_variables/nstatus.html">$nstatus</a>) {
<a name="l1255"><span class="linenum">1255</span></a>              return <a class="class" onClick="logClass('completion_info')" href="../../_classes/completion_info.html" onMouseOver="classPopup(event,'completion_info')">completion_info</a>::<a class="function" onClick="logFunction('aggregate_completion_states')" href="../../_functions/aggregate_completion_states.html" onMouseOver="funcPopup(event,'aggregate_completion_states')">aggregate_completion_states</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>, <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>, true);
<a name="l1256"><span class="linenum">1256</span></a>          } else {
<a name="l1257"><span class="linenum">1257</span></a>              return <a class="class" onClick="logClass('completion_info')" href="../../_classes/completion_info.html" onMouseOver="classPopup(event,'completion_info')">completion_info</a>::<a class="function" onClick="logFunction('aggregate_completion_states')" href="../../_functions/aggregate_completion_states.html" onMouseOver="funcPopup(event,'aggregate_completion_states')">aggregate_completion_states</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>, <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>, false);
<a name="l1258"><span class="linenum">1258</span></a>          }
<a name="l1259"><span class="linenum">1259</span></a>  
<a name="l1260"><span class="linenum">1260</span></a>      }
<a name="l1261"><span class="linenum">1261</span></a>  
<a name="l1262"><span class="linenum">1262</span></a>  <span class="comment">    // Check for score.</span>
<a name="l1263"><span class="linenum">1263</span></a>      if (<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('completionscorerequired')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/completionscorerequired.html">completionscorerequired</a> !== null) {
<a name="l1264"><span class="linenum">1264</span></a>          <a class="var it3860" onMouseOver="hilite(3860)" onMouseOut="lolite()" onClick="logVariable('maxscore')" href="../../_variables/maxscore.html">$maxscore</a> = -1;
<a name="l1265"><span class="linenum">1265</span></a>  
<a name="l1266"><span class="linenum">1266</span></a>          foreach (<a class="var it6825" onMouseOver="hilite(6825)" onMouseOut="lolite()" onClick="logVariable('tracks')" href="../../_variables/tracks.html">$tracks</a> as <a class="var it6706" onMouseOver="hilite(6706)" onMouseOut="lolite()" onClick="logVariable('track')" href="../../_variables/track.html">$track</a>) {
<a name="l1267"><span class="linenum">1267</span></a>              if (!<a class="phpfunction" onClick="logFunction('in_array')" href="../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it6706" onMouseOver="hilite(6706)" onMouseOut="lolite()" onClick="logVariable('track')" href="../../_variables/track.html">$track</a>-&gt;<a onClick="logVariable('element')" class="var it44620" onMouseOver="hilite(44620)" onMouseOut="lolite()" href="../../_variables/element.html">element</a>, array('cmi.core.score.raw', 'cmi.score.raw'))) {
<a name="l1268"><span class="linenum">1268</span></a>                  continue;
<a name="l1269"><span class="linenum">1269</span></a>              }
<a name="l1270"><span class="linenum">1270</span></a>  
<a name="l1271"><span class="linenum">1271</span></a>              if (<a class="function" onClick="logFunction('strlen')" href="../../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it6706" onMouseOver="hilite(6706)" onMouseOut="lolite()" onClick="logVariable('track')" href="../../_variables/track.html">$track</a>-&gt;<a onClick="logVariable('value')" class="var it44620" onMouseOver="hilite(44620)" onMouseOut="lolite()" href="../../_variables/value.html">value</a>) &amp;&amp; <a class="phpfunction" onClick="logFunction('floatval')" href="../../_functions/floatval.html" onMouseOver="phpfuncPopup(event,'floatval')">floatval</a>(<a class="var it6706" onMouseOver="hilite(6706)" onMouseOut="lolite()" onClick="logVariable('track')" href="../../_variables/track.html">$track</a>-&gt;<a onClick="logVariable('value')" class="var it44620" onMouseOver="hilite(44620)" onMouseOut="lolite()" href="../../_variables/value.html">value</a>) &gt;= <a class="var it3860" onMouseOver="hilite(3860)" onMouseOut="lolite()" onClick="logVariable('maxscore')" href="../../_variables/maxscore.html">$maxscore</a>) {
<a name="l1272"><span class="linenum">1272</span></a>                  <a class="var it3860" onMouseOver="hilite(3860)" onMouseOut="lolite()" onClick="logVariable('maxscore')" href="../../_variables/maxscore.html">$maxscore</a> = <a class="phpfunction" onClick="logFunction('floatval')" href="../../_functions/floatval.html" onMouseOver="phpfuncPopup(event,'floatval')">floatval</a>(<a class="var it6706" onMouseOver="hilite(6706)" onMouseOut="lolite()" onClick="logVariable('track')" href="../../_variables/track.html">$track</a>-&gt;<a onClick="logVariable('value')" class="var it44620" onMouseOver="hilite(44620)" onMouseOut="lolite()" href="../../_variables/value.html">value</a>);
<a name="l1273"><span class="linenum">1273</span></a>              }
<a name="l1274"><span class="linenum">1274</span></a>          }
<a name="l1275"><span class="linenum">1275</span></a>  
<a name="l1276"><span class="linenum">1276</span></a>          if (<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('completionscorerequired')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/completionscorerequired.html">completionscorerequired</a> &lt;= <a class="var it3860" onMouseOver="hilite(3860)" onMouseOut="lolite()" onClick="logVariable('maxscore')" href="../../_variables/maxscore.html">$maxscore</a>) {
<a name="l1277"><span class="linenum">1277</span></a>              return <a class="class" onClick="logClass('completion_info')" href="../../_classes/completion_info.html" onMouseOver="classPopup(event,'completion_info')">completion_info</a>::<a class="function" onClick="logFunction('aggregate_completion_states')" href="../../_functions/aggregate_completion_states.html" onMouseOver="funcPopup(event,'aggregate_completion_states')">aggregate_completion_states</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>, <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>, true);
<a name="l1278"><span class="linenum">1278</span></a>          } else {
<a name="l1279"><span class="linenum">1279</span></a>              return <a class="class" onClick="logClass('completion_info')" href="../../_classes/completion_info.html" onMouseOver="classPopup(event,'completion_info')">completion_info</a>::<a class="function" onClick="logFunction('aggregate_completion_states')" href="../../_functions/aggregate_completion_states.html" onMouseOver="funcPopup(event,'aggregate_completion_states')">aggregate_completion_states</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>, <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>, false);
<a name="l1280"><span class="linenum">1280</span></a>          }
<a name="l1281"><span class="linenum">1281</span></a>      }
<a name="l1282"><span class="linenum">1282</span></a>  
<a name="l1283"><span class="linenum">1283</span></a>      return <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l1284"><span class="linenum">1284</span></a>  }
<a name="l1285"><span class="linenum">1285</span></a>  
<a name="l1286"><span class="linenum">1286</span></a>  <span class="comment">/**</span>
<a name="l1287"><span class="linenum">1287</span></a>  <span class="comment"> * Register the ability to handle drag and drop file uploads</span>
<a name="l1288"><span class="linenum">1288</span></a>  <span class="comment"> * @return array containing details of the files / types the mod can handle</span>
<a name="l1289"><span class="linenum">1289</span></a>  <span class="comment"> */</span>
<a name="l1290"><span class="linenum">1290</span></a>  function <a class="function" onClick="logFunction('scorm_dndupload_register')" href="../../_functions/scorm_dndupload_register.html" onMouseOver="funcPopup(event,'scorm_dndupload_register')">scorm_dndupload_register</a>() {
<a name="l1291"><span class="linenum">1291</span></a>      return array('files' =&gt; array(
<a name="l1292"><span class="linenum">1292</span></a>          array('extension' =&gt; 'zip', 'message' =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('dnduploadscorm', 'scorm'))
<a name="l1293"><span class="linenum">1293</span></a>      ));
<a name="l1294"><span class="linenum">1294</span></a>  }
<a name="l1295"><span class="linenum">1295</span></a>  
<a name="l1296"><span class="linenum">1296</span></a>  <span class="comment">/**</span>
<a name="l1297"><span class="linenum">1297</span></a>  <span class="comment"> * Handle a file that has been uploaded</span>
<a name="l1298"><span class="linenum">1298</span></a>  <span class="comment"> * @param object $uploadinfo details of the file / content that has been uploaded</span>
<a name="l1299"><span class="linenum">1299</span></a>  <span class="comment"> * @return int instance id of the newly created mod</span>
<a name="l1300"><span class="linenum">1300</span></a>  <span class="comment"> */</span>
<a name="l1301"><span class="linenum">1301</span></a>  function <a class="function" onClick="logFunction('scorm_dndupload_handle')" href="../../_functions/scorm_dndupload_handle.html" onMouseOver="funcPopup(event,'scorm_dndupload_handle')">scorm_dndupload_handle</a>(<a class="var it11945" onMouseOver="hilite(11945)" onMouseOut="lolite()" onClick="logVariable('uploadinfo')" href="../../_variables/uploadinfo.html">$uploadinfo</a>) {
<a name="l1302"><span class="linenum">1302</span></a>  
<a name="l1303"><span class="linenum">1303</span></a>      <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_module')" href="../../_classes/context_module.html" onMouseOver="classPopup(event,'context_module')">context_module</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it11945" onMouseOver="hilite(11945)" onMouseOut="lolite()" onClick="logVariable('uploadinfo')" href="../../_variables/uploadinfo.html">$uploadinfo</a>-&gt;<a onClick="logVariable('coursemodule')" class="var it43094" onMouseOver="hilite(43094)" onMouseOut="lolite()" href="../../_variables/coursemodule.html">coursemodule</a>);
<a name="l1304"><span class="linenum">1304</span></a>      <a class="function" onClick="logFunction('file_save_draft_area_files')" href="../../_functions/file_save_draft_area_files.html" onMouseOver="funcPopup(event,'file_save_draft_area_files')">file_save_draft_area_files</a>(<a class="var it11945" onMouseOver="hilite(11945)" onMouseOut="lolite()" onClick="logVariable('uploadinfo')" href="../../_variables/uploadinfo.html">$uploadinfo</a>-&gt;<a onClick="logVariable('draftitemid')" class="var it43094" onMouseOver="hilite(43094)" onMouseOut="lolite()" href="../../_variables/draftitemid.html">draftitemid</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'mod_scorm', 'package', 0);
<a name="l1305"><span class="linenum">1305</span></a>      <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a> = <a class="function" onClick="logFunction('get_file_storage')" href="../../_functions/get_file_storage.html" onMouseOver="funcPopup(event,'get_file_storage')">get_file_storage</a>();
<a name="l1306"><span class="linenum">1306</span></a>      <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('files')" href="../../_variables/files.html">$files</a> = <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('get_area_files')" href="../../_functions/get_area_files.html" onMouseOver="funcPopup(event,'get_area_files')">get_area_files</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'mod_scorm', 'package', 0, 'sortorder, itemid, filepath, filename', false);
<a name="l1307"><span class="linenum">1307</span></a>      <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('files')" href="../../_variables/files.html">$files</a>);
<a name="l1308"><span class="linenum">1308</span></a>  
<a name="l1309"><span class="linenum">1309</span></a>  <span class="comment">    // Validate the file, make sure it's a valid SCORM package!</span>
<a name="l1310"><span class="linenum">1310</span></a>      <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('errors')" href="../../_variables/errors.html">$errors</a> = <a class="function" onClick="logFunction('scorm_validate_package')" href="../../_functions/scorm_validate_package.html" onMouseOver="funcPopup(event,'scorm_validate_package')">scorm_validate_package</a>(<a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a>);
<a name="l1311"><span class="linenum">1311</span></a>      if (!empty(<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('errors')" href="../../_variables/errors.html">$errors</a>)) {
<a name="l1312"><span class="linenum">1312</span></a>          return false;
<a name="l1313"><span class="linenum">1313</span></a>      }
<a name="l1314"><span class="linenum">1314</span></a>  <span class="comment">    // Create a default scorm object to pass to scorm_add_instance()!</span>
<a name="l1315"><span class="linenum">1315</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a> = <a class="function" onClick="logFunction('get_config')" href="../../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>('scorm');
<a name="l1316"><span class="linenum">1316</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('course')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/course.html">course</a> = <a class="var it11945" onMouseOver="hilite(11945)" onMouseOut="lolite()" onClick="logVariable('uploadinfo')" href="../../_variables/uploadinfo.html">$uploadinfo</a>-&gt;<a onClick="logVariable('course')" class="var it43094" onMouseOver="hilite(43094)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>-&gt;id;
<a name="l1317"><span class="linenum">1317</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('coursemodule')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/coursemodule.html">coursemodule</a> = <a class="var it11945" onMouseOver="hilite(11945)" onMouseOut="lolite()" onClick="logVariable('uploadinfo')" href="../../_variables/uploadinfo.html">$uploadinfo</a>-&gt;<a onClick="logVariable('coursemodule')" class="var it43094" onMouseOver="hilite(43094)" onMouseOut="lolite()" href="../../_variables/coursemodule.html">coursemodule</a>;
<a name="l1318"><span class="linenum">1318</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('cmidnumber')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/cmidnumber.html">cmidnumber</a> = '';
<a name="l1319"><span class="linenum">1319</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('name')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/name.html">name</a> = <a class="var it11945" onMouseOver="hilite(11945)" onMouseOut="lolite()" onClick="logVariable('uploadinfo')" href="../../_variables/uploadinfo.html">$uploadinfo</a>-&gt;<a onClick="logVariable('displayname')" class="var it43094" onMouseOver="hilite(43094)" onMouseOut="lolite()" href="../../_variables/displayname.html">displayname</a>;
<a name="l1320"><span class="linenum">1320</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('scormtype')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/scormtype.html">scormtype</a> = <a class="constant" onClick="logConstant('SCORM_TYPE_LOCAL')" href="../../_constants/SCORM_TYPE_LOCAL.html" onMouseOver="constPopup(event,'SCORM_TYPE_LOCAL')">SCORM_TYPE_LOCAL</a>;
<a name="l1321"><span class="linenum">1321</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('reference')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/reference.html">reference</a> = <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a>-&gt;<a class="function" onClick="logFunction('get_filename')" href="../../_functions/get_filename.html" onMouseOver="funcPopup(event,'get_filename')">get_filename</a>();
<a name="l1322"><span class="linenum">1322</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('intro')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/intro.html">intro</a> = '';
<a name="l1323"><span class="linenum">1323</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('width')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/width.html">width</a> = <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('framewidth')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/framewidth.html">framewidth</a>;
<a name="l1324"><span class="linenum">1324</span></a>      <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('height')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/height.html">height</a> = <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('frameheight')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/frameheight.html">frameheight</a>;
<a name="l1325"><span class="linenum">1325</span></a>  
<a name="l1326"><span class="linenum">1326</span></a>      return <a class="function" onClick="logFunction('scorm_add_instance')" href="../../_functions/scorm_add_instance.html" onMouseOver="funcPopup(event,'scorm_add_instance')">scorm_add_instance</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>, null);
<a name="l1327"><span class="linenum">1327</span></a>  }
<a name="l1328"><span class="linenum">1328</span></a>  
<a name="l1329"><span class="linenum">1329</span></a>  <span class="comment">/**</span>
<a name="l1330"><span class="linenum">1330</span></a>  <span class="comment"> * Sets activity completion state</span>
<a name="l1331"><span class="linenum">1331</span></a>  <span class="comment"> *</span>
<a name="l1332"><span class="linenum">1332</span></a>  <span class="comment"> * @param object $scorm object</span>
<a name="l1333"><span class="linenum">1333</span></a>  <span class="comment"> * @param int $userid User ID</span>
<a name="l1334"><span class="linenum">1334</span></a>  <span class="comment"> * @param int $completionstate Completion state</span>
<a name="l1335"><span class="linenum">1335</span></a>  <span class="comment"> * @param array $grades grades array of users with grades - used when $userid = 0</span>
<a name="l1336"><span class="linenum">1336</span></a>  <span class="comment"> */</span>
<a name="l1337"><span class="linenum">1337</span></a>  function <a class="function" onClick="logFunction('scorm_set_completion')" href="../../_functions/scorm_set_completion.html" onMouseOver="funcPopup(event,'scorm_set_completion')">scorm_set_completion</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, <a class="var it1890" onMouseOver="hilite(1890)" onMouseOut="lolite()" onClick="logVariable('completionstate')" href="../../_variables/completionstate.html">$completionstate</a> = <a class="constant" onClick="logConstant('COMPLETION_COMPLETE')" href="../../_constants/COMPLETION_COMPLETE.html" onMouseOver="constPopup(event,'COMPLETION_COMPLETE')">COMPLETION_COMPLETE</a>, <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a> = array()) {
<a name="l1338"><span class="linenum">1338</span></a>      <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a> = new stdClass();
<a name="l1339"><span class="linenum">1339</span></a>      <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('course')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>;
<a name="l1340"><span class="linenum">1340</span></a>      <a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a> = <span class="keyword">new </span><a class="class" onClick="logClass('completion_info')" href="../../_classes/completion_info.html" onMouseOver="classPopup(event,'completion_info')">completion_info</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>);
<a name="l1341"><span class="linenum">1341</span></a>  
<a name="l1342"><span class="linenum">1342</span></a>  <span class="comment">    // Check if completion is enabled site-wide, or for the course.</span>
<a name="l1343"><span class="linenum">1343</span></a>      if (!<a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a>-&gt;<a class="function" onClick="logFunction('is_enabled')" href="../../_functions/is_enabled.html" onMouseOver="funcPopup(event,'is_enabled')">is_enabled</a>()) {
<a name="l1344"><span class="linenum">1344</span></a>          return;
<a name="l1345"><span class="linenum">1345</span></a>      }
<a name="l1346"><span class="linenum">1346</span></a>  
<a name="l1347"><span class="linenum">1347</span></a>      <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a> = <a class="function" onClick="logFunction('get_coursemodule_from_instance')" href="../../_functions/get_coursemodule_from_instance.html" onMouseOver="funcPopup(event,'get_coursemodule_from_instance')">get_coursemodule_from_instance</a>('scorm', <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('id')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('course')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>);
<a name="l1348"><span class="linenum">1348</span></a>      if (empty(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>) || !<a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a>-&gt;<a class="function" onClick="logFunction('is_enabled')" href="../../_functions/is_enabled.html" onMouseOver="funcPopup(event,'is_enabled')">is_enabled</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>)) {
<a name="l1349"><span class="linenum">1349</span></a>              return;
<a name="l1350"><span class="linenum">1350</span></a>      }
<a name="l1351"><span class="linenum">1351</span></a>  
<a name="l1352"><span class="linenum">1352</span></a>      if (empty(<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>)) { // We need to get all the relevant users from <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a> param.
<a name="l1353"><span class="linenum">1353</span></a>          foreach (<a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a> as <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>) {
<a name="l1354"><span class="linenum">1354</span></a>              <a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a>-&gt;<a class="function" onClick="logFunction('update_state')" href="../../_functions/update_state.html" onMouseOver="funcPopup(event,'update_state')">update_state</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="var it1890" onMouseOver="hilite(1890)" onMouseOut="lolite()" onClick="logVariable('completionstate')" href="../../_variables/completionstate.html">$completionstate</a>, <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('userid')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>);
<a name="l1355"><span class="linenum">1355</span></a>          }
<a name="l1356"><span class="linenum">1356</span></a>      } else {
<a name="l1357"><span class="linenum">1357</span></a>          <a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a>-&gt;<a class="function" onClick="logFunction('update_state')" href="../../_functions/update_state.html" onMouseOver="funcPopup(event,'update_state')">update_state</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="var it1890" onMouseOver="hilite(1890)" onMouseOut="lolite()" onClick="logVariable('completionstate')" href="../../_variables/completionstate.html">$completionstate</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>);
<a name="l1358"><span class="linenum">1358</span></a>      }
<a name="l1359"><span class="linenum">1359</span></a>  }
<a name="l1360"><span class="linenum">1360</span></a>  
<a name="l1361"><span class="linenum">1361</span></a>  <span class="comment">/**</span>
<a name="l1362"><span class="linenum">1362</span></a>  <span class="comment"> * Check that a Zip file contains a valid SCORM package</span>
<a name="l1363"><span class="linenum">1363</span></a>  <span class="comment"> *</span>
<a name="l1364"><span class="linenum">1364</span></a>  <span class="comment"> * @param $file stored_file a Zip file.</span>
<a name="l1365"><span class="linenum">1365</span></a>  <span class="comment"> * @return array empty if no issue is found. Array of error message otherwise</span>
<a name="l1366"><span class="linenum">1366</span></a>  <span class="comment"> */</span>
<a name="l1367"><span class="linenum">1367</span></a>  function <a class="function" onClick="logFunction('scorm_validate_package')" href="../../_functions/scorm_validate_package.html" onMouseOver="funcPopup(event,'scorm_validate_package')">scorm_validate_package</a>(<a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a>) {
<a name="l1368"><span class="linenum">1368</span></a>      <a class="var it246" onMouseOver="hilite(246)" onMouseOut="lolite()" onClick="logVariable('packer')" href="../../_variables/packer.html">$packer</a> = <a class="function" onClick="logFunction('get_file_packer')" href="../../_functions/get_file_packer.html" onMouseOver="funcPopup(event,'get_file_packer')">get_file_packer</a>('application/zip');
<a name="l1369"><span class="linenum">1369</span></a>      <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('errors')" href="../../_variables/errors.html">$errors</a> = array();
<a name="l1370"><span class="linenum">1370</span></a>      if (<a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a>-&gt;<a class="function" onClick="logFunction('is_external_file')" href="../../_functions/is_external_file.html" onMouseOver="funcPopup(event,'is_external_file')">is_external_file</a>()) { // Get zip file so we can check it is correct.
<a name="l1371"><span class="linenum">1371</span></a>          <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a>-&gt;<a class="function" onClick="logFunction('import_external_file_contents')" href="../../_functions/import_external_file_contents.html" onMouseOver="funcPopup(event,'import_external_file_contents')">import_external_file_contents</a>();
<a name="l1372"><span class="linenum">1372</span></a>      }
<a name="l1373"><span class="linenum">1373</span></a>      <a class="var it3633" onMouseOver="hilite(3633)" onMouseOut="lolite()" onClick="logVariable('filelist')" href="../../_variables/filelist.html">$filelist</a> = <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a>-&gt;<a class="function" onClick="logFunction('list_files')" href="../../_functions/list_files.html" onMouseOver="funcPopup(event,'list_files')">list_files</a>(<a class="var it246" onMouseOver="hilite(246)" onMouseOut="lolite()" onClick="logVariable('packer')" href="../../_variables/packer.html">$packer</a>);
<a name="l1374"><span class="linenum">1374</span></a>  
<a name="l1375"><span class="linenum">1375</span></a>      if (!<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it3633" onMouseOver="hilite(3633)" onMouseOut="lolite()" onClick="logVariable('filelist')" href="../../_variables/filelist.html">$filelist</a>)) {
<a name="l1376"><span class="linenum">1376</span></a>          <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('errors')" href="../../_variables/errors.html">$errors</a>['packagefile'] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('badarchive', 'scorm');
<a name="l1377"><span class="linenum">1377</span></a>      } else {
<a name="l1378"><span class="linenum">1378</span></a>          <a class="var it11946" onMouseOver="hilite(11946)" onMouseOut="lolite()" onClick="logVariable('aiccfound')" href="../../_variables/aiccfound.html">$aiccfound</a> = false;
<a name="l1379"><span class="linenum">1379</span></a>          <a class="var it11947" onMouseOver="hilite(11947)" onMouseOut="lolite()" onClick="logVariable('badmanifestpresent')" href="../../_variables/badmanifestpresent.html">$badmanifestpresent</a> = false;
<a name="l1380"><span class="linenum">1380</span></a>          foreach (<a class="var it3633" onMouseOver="hilite(3633)" onMouseOut="lolite()" onClick="logVariable('filelist')" href="../../_variables/filelist.html">$filelist</a> as <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>) {
<a name="l1381"><span class="linenum">1381</span></a>              if (<a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>-&gt;<a onClick="logVariable('pathname')" class="var it42982" onMouseOver="hilite(42982)" onMouseOut="lolite()" href="../../_variables/pathname.html">pathname</a> == 'imsmanifest.xml') {
<a name="l1382"><span class="linenum">1382</span></a>                  return array();
<a name="l1383"><span class="linenum">1383</span></a>              } else if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>-&gt;<a onClick="logVariable('pathname')" class="var it42982" onMouseOver="hilite(42982)" onMouseOut="lolite()" href="../../_variables/pathname.html">pathname</a>, 'imsmanifest.xml') !== false) {
<a name="l1384"><span class="linenum">1384</span></a>  <span class="comment">                // This package has an imsmanifest file inside a folder of the package.</span>
<a name="l1385"><span class="linenum">1385</span></a>                  <a class="var it11947" onMouseOver="hilite(11947)" onMouseOut="lolite()" onClick="logVariable('badmanifestpresent')" href="../../_variables/badmanifestpresent.html">$badmanifestpresent</a> = true;
<a name="l1386"><span class="linenum">1386</span></a>              }
<a name="l1387"><span class="linenum">1387</span></a>              if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/\.cst$/', <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>-&gt;<a onClick="logVariable('pathname')" class="var it42982" onMouseOver="hilite(42982)" onMouseOut="lolite()" href="../../_variables/pathname.html">pathname</a>)) {
<a name="l1388"><span class="linenum">1388</span></a>                  return array();
<a name="l1389"><span class="linenum">1389</span></a>              }
<a name="l1390"><span class="linenum">1390</span></a>          }
<a name="l1391"><span class="linenum">1391</span></a>          if (!<a class="var it11946" onMouseOver="hilite(11946)" onMouseOut="lolite()" onClick="logVariable('aiccfound')" href="../../_variables/aiccfound.html">$aiccfound</a>) {
<a name="l1392"><span class="linenum">1392</span></a>              if (<a class="var it11947" onMouseOver="hilite(11947)" onMouseOut="lolite()" onClick="logVariable('badmanifestpresent')" href="../../_variables/badmanifestpresent.html">$badmanifestpresent</a>) {
<a name="l1393"><span class="linenum">1393</span></a>                  <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('errors')" href="../../_variables/errors.html">$errors</a>['packagefile'] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('badimsmanifestlocation', 'scorm');
<a name="l1394"><span class="linenum">1394</span></a>              } else {
<a name="l1395"><span class="linenum">1395</span></a>                  <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('errors')" href="../../_variables/errors.html">$errors</a>['packagefile'] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('nomanifest', 'scorm');
<a name="l1396"><span class="linenum">1396</span></a>              }
<a name="l1397"><span class="linenum">1397</span></a>          }
<a name="l1398"><span class="linenum">1398</span></a>      }
<a name="l1399"><span class="linenum">1399</span></a>      return <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('errors')" href="../../_variables/errors.html">$errors</a>;
<a name="l1400"><span class="linenum">1400</span></a>  }
<a name="l1401"><span class="linenum">1401</span></a>  
<a name="l1402"><span class="linenum">1402</span></a>  <span class="comment">/**</span>
<a name="l1403"><span class="linenum">1403</span></a>  <span class="comment"> * Check and set the correct mode and attempt when entering a SCORM package.</span>
<a name="l1404"><span class="linenum">1404</span></a>  <span class="comment"> *</span>
<a name="l1405"><span class="linenum">1405</span></a>  <span class="comment"> * @param object $scorm object</span>
<a name="l1406"><span class="linenum">1406</span></a>  <span class="comment"> * @param string $newattempt should a new attempt be generated here.</span>
<a name="l1407"><span class="linenum">1407</span></a>  <span class="comment"> * @param int $attempt the attempt number this is for.</span>
<a name="l1408"><span class="linenum">1408</span></a>  <span class="comment"> * @param int $userid the userid of the user.</span>
<a name="l1409"><span class="linenum">1409</span></a>  <span class="comment"> * @param string $mode the current mode that has been selected.</span>
<a name="l1410"><span class="linenum">1410</span></a>  <span class="comment"> */</span>
<a name="l1411"><span class="linenum">1411</span></a>  function <a class="function" onClick="logFunction('scorm_check_mode')" href="../../_functions/scorm_check_mode.html" onMouseOver="funcPopup(event,'scorm_check_mode')">scorm_check_mode</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>, &amp;<a class="var it11948" onMouseOver="hilite(11948)" onMouseOut="lolite()" onClick="logVariable('newattempt')" href="../../_variables/newattempt.html">$newattempt</a>, &amp;<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, &amp;<a class="var it109" onMouseOver="hilite(109)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../_variables/mode.html">$mode</a>) {
<a name="l1412"><span class="linenum">1412</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1413"><span class="linenum">1413</span></a>  
<a name="l1414"><span class="linenum">1414</span></a>      if ((<a class="var it109" onMouseOver="hilite(109)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../_variables/mode.html">$mode</a> == 'browse')) {
<a name="l1415"><span class="linenum">1415</span></a>          if (<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('hidebrowse')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/hidebrowse.html">hidebrowse</a> == 1) {
<a name="l1416"><span class="linenum">1416</span></a>  <span class="comment">            // Prevent Browse mode if hidebrowse is set.</span>
<a name="l1417"><span class="linenum">1417</span></a>              <a class="var it109" onMouseOver="hilite(109)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../_variables/mode.html">$mode</a> = 'normal';
<a name="l1418"><span class="linenum">1418</span></a>          } else {
<a name="l1419"><span class="linenum">1419</span></a>  <span class="comment">            // We don't need to check attempts as browse mode is set.</span>
<a name="l1420"><span class="linenum">1420</span></a>              return;
<a name="l1421"><span class="linenum">1421</span></a>          }
<a name="l1422"><span class="linenum">1422</span></a>      }
<a name="l1423"><span class="linenum">1423</span></a>  <span class="comment">    // Check if the scorm module is incomplete (used to validate user request to start a new attempt).</span>
<a name="l1424"><span class="linenum">1424</span></a>      <a class="var it10762" onMouseOver="hilite(10762)" onMouseOut="lolite()" onClick="logVariable('incomplete')" href="../../_variables/incomplete.html">$incomplete</a> = true;
<a name="l1425"><span class="linenum">1425</span></a>      <a class="var it6825" onMouseOver="hilite(6825)" onMouseOut="lolite()" onClick="logVariable('tracks')" href="../../_variables/tracks.html">$tracks</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset')" href="../../_functions/get_recordset.html" onMouseOver="funcPopup(event,'get_recordset')">get_recordset</a>('scorm_scoes_track', array('scormid' =&gt; <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('id')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'userid' =&gt; <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>,
<a name="l1426"><span class="linenum">1426</span></a>          'attempt' =&gt; <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>, 'element' =&gt; 'cmi.core.lesson_status'));
<a name="l1427"><span class="linenum">1427</span></a>      foreach (<a class="var it6825" onMouseOver="hilite(6825)" onMouseOut="lolite()" onClick="logVariable('tracks')" href="../../_variables/tracks.html">$tracks</a> as <a class="var it6706" onMouseOver="hilite(6706)" onMouseOut="lolite()" onClick="logVariable('track')" href="../../_variables/track.html">$track</a>) {
<a name="l1428"><span class="linenum">1428</span></a>          if ((<a class="var it6706" onMouseOver="hilite(6706)" onMouseOut="lolite()" onClick="logVariable('track')" href="../../_variables/track.html">$track</a>-&gt;<a onClick="logVariable('value')" class="var it44620" onMouseOver="hilite(44620)" onMouseOut="lolite()" href="../../_variables/value.html">value</a> == 'completed') || (<a class="var it6706" onMouseOver="hilite(6706)" onMouseOut="lolite()" onClick="logVariable('track')" href="../../_variables/track.html">$track</a>-&gt;<a onClick="logVariable('value')" class="var it44620" onMouseOver="hilite(44620)" onMouseOut="lolite()" href="../../_variables/value.html">value</a> == 'passed') || (<a class="var it6706" onMouseOver="hilite(6706)" onMouseOut="lolite()" onClick="logVariable('track')" href="../../_variables/track.html">$track</a>-&gt;<a onClick="logVariable('value')" class="var it44620" onMouseOver="hilite(44620)" onMouseOut="lolite()" href="../../_variables/value.html">value</a> == 'failed')) {
<a name="l1429"><span class="linenum">1429</span></a>              <a class="var it10762" onMouseOver="hilite(10762)" onMouseOut="lolite()" onClick="logVariable('incomplete')" href="../../_variables/incomplete.html">$incomplete</a> = false;
<a name="l1430"><span class="linenum">1430</span></a>          } else {
<a name="l1431"><span class="linenum">1431</span></a>              <a class="var it10762" onMouseOver="hilite(10762)" onMouseOut="lolite()" onClick="logVariable('incomplete')" href="../../_variables/incomplete.html">$incomplete</a> = true;
<a name="l1432"><span class="linenum">1432</span></a>              break; <span class="comment">// Found an incomplete sco, so the result as a whole is incomplete.</span>
<a name="l1433"><span class="linenum">1433</span></a>          }
<a name="l1434"><span class="linenum">1434</span></a>      }
<a name="l1435"><span class="linenum">1435</span></a>      <a class="var it6825" onMouseOver="hilite(6825)" onMouseOut="lolite()" onClick="logVariable('tracks')" href="../../_variables/tracks.html">$tracks</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l1436"><span class="linenum">1436</span></a>  
<a name="l1437"><span class="linenum">1437</span></a>  <span class="comment">    // Validate user request to start a new attempt.</span>
<a name="l1438"><span class="linenum">1438</span></a>      if (<a class="var it10762" onMouseOver="hilite(10762)" onMouseOut="lolite()" onClick="logVariable('incomplete')" href="../../_variables/incomplete.html">$incomplete</a> === true) {
<a name="l1439"><span class="linenum">1439</span></a>  <span class="comment">        // The option to start a new attempt should never have been presented. Force false.</span>
<a name="l1440"><span class="linenum">1440</span></a>          <a class="var it11948" onMouseOver="hilite(11948)" onMouseOut="lolite()" onClick="logVariable('newattempt')" href="../../_variables/newattempt.html">$newattempt</a> = 'off';
<a name="l1441"><span class="linenum">1441</span></a>      } else if (!empty(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('forcenewattempt')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/forcenewattempt.html">forcenewattempt</a>)) {
<a name="l1442"><span class="linenum">1442</span></a>  <span class="comment">        // A new attempt should be forced for already completed attempts.</span>
<a name="l1443"><span class="linenum">1443</span></a>          <a class="var it11948" onMouseOver="hilite(11948)" onMouseOut="lolite()" onClick="logVariable('newattempt')" href="../../_variables/newattempt.html">$newattempt</a> = 'on';
<a name="l1444"><span class="linenum">1444</span></a>      }
<a name="l1445"><span class="linenum">1445</span></a>  
<a name="l1446"><span class="linenum">1446</span></a>      if ((<a class="var it11948" onMouseOver="hilite(11948)" onMouseOut="lolite()" onClick="logVariable('newattempt')" href="../../_variables/newattempt.html">$newattempt</a> == 'on') &amp;&amp; ((<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a> &lt; <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('maxattempt')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/maxattempt.html">maxattempt</a>) || (<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;<a onClick="logVariable('maxattempt')" class="var it44007" onMouseOver="hilite(44007)" onMouseOut="lolite()" href="../../_variables/maxattempt.html">maxattempt</a> == 0))) {
<a name="l1447"><span class="linenum">1447</span></a>          <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>++;
<a name="l1448"><span class="linenum">1448</span></a>          <a class="var it109" onMouseOver="hilite(109)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../_variables/mode.html">$mode</a> = 'normal';
<a name="l1449"><span class="linenum">1449</span></a>      } else { // Check if review mode should be set.
<a name="l1450"><span class="linenum">1450</span></a>          if (<a class="var it10762" onMouseOver="hilite(10762)" onMouseOut="lolite()" onClick="logVariable('incomplete')" href="../../_variables/incomplete.html">$incomplete</a> === true) {
<a name="l1451"><span class="linenum">1451</span></a>              <a class="var it109" onMouseOver="hilite(109)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../_variables/mode.html">$mode</a> = 'normal';
<a name="l1452"><span class="linenum">1452</span></a>          } else {
<a name="l1453"><span class="linenum">1453</span></a>              <a class="var it109" onMouseOver="hilite(109)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../_variables/mode.html">$mode</a> = 'review';
<a name="l1454"><span class="linenum">1454</span></a>          }
<a name="l1455"><span class="linenum">1455</span></a>      }
<a name="l1456"><span class="linenum">1456</span></a>  }
<a name="l1457"><span class="linenum">1457</span></a>  
<a name="l1458"><span class="linenum">1458</span></a>  <span class="comment">/**</span>
<a name="l1459"><span class="linenum">1459</span></a>  <span class="comment"> * Trigger the course_module_viewed event.</span>
<a name="l1460"><span class="linenum">1460</span></a>  <span class="comment"> *</span>
<a name="l1461"><span class="linenum">1461</span></a>  <span class="comment"> * @param  stdClass $scorm        scorm object</span>
<a name="l1462"><span class="linenum">1462</span></a>  <span class="comment"> * @param  stdClass $course     course object</span>
<a name="l1463"><span class="linenum">1463</span></a>  <span class="comment"> * @param  stdClass $cm         course module object</span>
<a name="l1464"><span class="linenum">1464</span></a>  <span class="comment"> * @param  stdClass $context    context object</span>
<a name="l1465"><span class="linenum">1465</span></a>  <span class="comment"> * @since Moodle 3.0</span>
<a name="l1466"><span class="linenum">1466</span></a>  <span class="comment"> */</span>
<a name="l1467"><span class="linenum">1467</span></a>  function <a class="function" onClick="logFunction('scorm_view')" href="../../_functions/scorm_view.html" onMouseOver="funcPopup(event,'scorm_view')">scorm_view</a>(<a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>) {
<a name="l1468"><span class="linenum">1468</span></a>  
<a name="l1469"><span class="linenum">1469</span></a>  <span class="comment">    // Trigger course_module_viewed event.</span>
<a name="l1470"><span class="linenum">1470</span></a>      <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array(
<a name="l1471"><span class="linenum">1471</span></a>          'context' =&gt; <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>,
<a name="l1472"><span class="linenum">1472</span></a>          'objectid' =&gt; <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>-&gt;id
<a name="l1473"><span class="linenum">1473</span></a>      );
<a name="l1474"><span class="linenum">1474</span></a>  
<a name="l1475"><span class="linenum">1475</span></a>      <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a> = \mod_scorm\event\<a class="class" onClick="logClass('course_module_viewed')" href="../../_classes/course_module_viewed.html" onMouseOver="classPopup(event,'course_module_viewed')">course_module_viewed</a>::<a class="function" onClick="logFunction('create')" href="../../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l1476"><span class="linenum">1476</span></a>      <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('course_modules', <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>);
<a name="l1477"><span class="linenum">1477</span></a>      <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('course', <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>);
<a name="l1478"><span class="linenum">1478</span></a>      <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('scorm', <a class="var it5512" onMouseOver="hilite(5512)" onMouseOut="lolite()" onClick="logVariable('scorm')" href="../../_variables/scorm.html">$scorm</a>);
<a name="l1479"><span class="linenum">1479</span></a>      <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l1480"><span class="linenum">1480</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'scorm_user_complete': ['scorm_user_complete', 'Print a detailed representation of what a user has done with a given particular instance of this module, for user activity reports. ', [['mod/scorm','lib.php',355]], 0],
'is_enabled': ['is_enabled', 'Tools cannot be disabled. ', [['lib/classes/plugininfo','tool.php',39],['admin/tool/recyclebin/classes','category_bin.php',54],['admin/tool/log/classes/plugininfo','logstore.php',35],['admin/tool/recyclebin/classes','course_bin.php',54],['mod/assign/feedback/offline','locallib.php',380],['admin/tool/recyclebin/classes','base_bin.php',38],['lib','adminlib.php',1955],['search/classes','base.php',190],['lib','medialib.php',318],['lib','medialib.php',635],['lib','medialib.php',1268],['admin/tool/health','index.php',393],['lib/classes/plugininfo','mnetservice.php',33],['lib/classes/message/inbound','manager.php',37],['mod/assignment/classes/plugininfo','assignment.php',32],['competency/classes','api.php',49],['mod/assign','assignmentplugin.php',223],['lib/classes/plugininfo','orphaned.php',37],['search/tests/fixtures','mock_search_area.php',38],['tag/classes','area.php',106],['lib/classes/plugininfo','base.php',383],['mod/assign/feedback/editpdf','locallib.php',340],['tag/classes','tag.php',1269],['mod/assign/submission/comments','locallib.php',172],['lib','completionlib.php',269]], 276],
'addelement': ['addelement', 'Adds a custom element to your HTML definition ', [['lib/htmlpurifier/HTMLPurifier','HTMLDefinition.php',124],['lib/htmlpurifier/HTMLPurifier','HTMLModule.php',130],['lib/pear/HTML','QuickForm.php',592]], 3302],
'sql_isnotempty': ['sql_isnotempty', 'Returns the proper SQL to know if one field is not empty. ', [['lib/dml','moodle_database.php',2228]], 21],
'scorm_user_outline': ['scorm_user_outline', 'Return a small object with summary information about what a user has done with a given particular instance of this module Used for user activity reports. ', [['mod/scorm','lib.php',318]], 0],
'scorm_set_completion': ['scorm_set_completion', 'Sets activity completion state ', [['mod/scorm','lib.php',1329]], 2],
'delete_records': ['delete_records', 'Delete the records from a table where all the given conditions met. If conditions not specified, table is truncated. ', [['lib/dml','sqlite3_pdo_moodle_database.php',345],['lib/dml','moodle_database.php',1864]], 773],
'list': ['list', '', [['mod/data/preset/imagegallery','jstemplate.js',9]], 2229],
'scorm_get_view_actions': ['scorm_get_view_actions', 'List the actions that correspond to a view of this module. This is used by the participation report. ', [['mod/scorm','lib.php',696]], 0],
'get_file_by_hash': ['get_file_by_hash', 'Fetch file using local file full pathname hash ', [['lib/filestorage','file_storage.php',679]], 73],
'scorm_debug_log_filename': ['scorm_debug_log_filename', 'Get the filename for a temp log file ', [['mod/scorm','lib.php',1032]], 2],
'set_config': ['set_config', 'Set a key in global configuration ', [['lib','moodlelib.php',1336],['lib','enrollib.php',1153],['lib/editor/tinymce/classes','plugin.php',84],['mod/assign','assignmentplugin.php',314],['lib/portfolio','plugin.php',515]], 1119],
'scorm_get_tracks': ['scorm_get_tracks', '', [['mod/scorm','locallib.php',599]], 14],
'get_recordset': ['get_recordset', 'Get the recordset. ', [['mod/glossary/classes','entry_query_builder.php',305],['lib/dml','moodle_database.php',1162]], 92],
'get_records_sql': ['get_records_sql', 'Get a number of records as an array of objects. ', [['lib/dml','pdo_moodle_database.php',309],['lib/dml','oci_native_moodle_database.php',1145],['lib/dml','pgsql_native_moodle_database.php',732],['lib/dml','mssql_native_moodle_database.php',805],['lib/dml','mysqli_native_moodle_database.php',1057],['lib/dml','sqlsrv_native_moodle_database.php',890],['lib/dml/tests','dml_test.php',5545]], 700],
'update_record': ['update_record', 'Update a record in a table ', [['lib/dml','pdo_moodle_database.php',461],['lib/dml','oci_native_moodle_database.php',1404],['lib/dml','pgsql_native_moodle_database.php',1089],['lib/dml','mssql_native_moodle_database.php',1067],['lib/dml','mysqli_native_moodle_database.php',1405],['lib/dml','sqlsrv_native_moodle_database.php',1148],['lib/dml/tests','dml_test.php',5551]], 650],
'scorm_get_file_areas': ['scorm_get_file_areas', 'Lists all file areas current user may browse ', [['mod/scorm','lib.php',838]], 0],
'scorm_pluginfile': ['scorm_pluginfile', 'Serves scorm content, introduction images and packages. Implements needed access control ;-) ', [['mod/scorm','lib.php',918]], 0],
'file_save_draft_area_files': ['file_save_draft_area_files', 'Saves files from a draft file area to a real one (merging the list of files). Can rewrite URLs in some content at the same time if desired. ', [['lib','filelib.php',778]], 61],
'is_directory': ['is_directory', 'Whether or not this is a directory ', [['lib/filebrowser','file_info_context_system.php',133],['mod/lesson/classes','file_info.php',94],['mod/imscp','locallib.php',328],['lib/filebrowser','file_info_context_coursecat.php',146],['mod/book','locallib.php',463],['lib/filebrowser','file_info_context_user.php',265],['lib/filebrowser','virtual_root_file.php',60],['mod/data','locallib.php',477],['lib/filebrowser','file_info_stored.php',267],['lib/filestorage','stored_file.php',310],['mod/workshop','fileinfolib.php',82],['mod/workshop','fileinfolib.php',241],['lib/filebrowser','file_info_context_module.php',249],['mod/glossary','locallib.php',525],['lib/filebrowser','file_info_context_course.php',372],['lib/filebrowser','file_info_context_course.php',657],['lib/filebrowser','file_info_context_course.php',803],['mod/forum','locallib.php',463]], 140],
'scorm_reset_userdata': ['scorm_reset_userdata', 'Actual implementation of the reset course functionality, delete all the scorm attempts for course $data->courseid. ', [['mod/scorm','lib.php',794]], 0],
'count_records_select': ['count_records_select', 'Count a list of records. ', [['competency/classes','persistent.php',828],['lib/dml','moodle_database.php',1779]], 73],
's': ['s', 'Count of attempts selected by $this->whichattempts ', [['mod/quiz/report/statistics/classes','calculated.php',91],['lib','weblib.php',84]], 1072],
'start_div': ['start_div', 'Starts a <div> tag. (Shortcut function.) ', [['lib','outputcomponents.php',1826]], 107],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required, Some conversions and safety checks are carried out. Lobs are supported. If the return ID isn\'t required, then this just reports success as true/false. $data is an object containing needed data ', [['lib/dml','pdo_moodle_database.php',387],['lib/dml','oci_native_moodle_database.php',1297],['lib/dml','pgsql_native_moodle_database.php',889],['lib/dml','mssql_native_moodle_database.php',962],['lib/dml','mysqli_native_moodle_database.php',1185],['question/engine/upgrade','upgradelib.php',124],['lib/dml','sqlsrv_native_moodle_database.php',1045],['lib/dml/tests','dml_test.php',5548]], 1611],
'scorm_get_file_info': ['scorm_get_file_info', 'File browsing support for SCORM file areas ', [['mod/scorm','lib.php',853]], 0],
'is_external_file': ['is_external_file', 'Whether or not this is a external resource ', [['lib/filebrowser','file_info.php',339],['lib/filebrowser','file_info_stored.php',312],['lib/filestorage','stored_file.php',94]], 35],
'start_tag': ['start_tag', 'Outputs an opening tag with attributes ', [['lib','outputcomponents.php',1085],['backup/util/xml/parser','progressive_parser.class.php',215]], 701],
'scorm_reset_gradebook': ['scorm_reset_gradebook', 'Removes all grades from gradebook ', [['mod/scorm','lib.php',772]], 1],
'trigger': ['trigger', '', [['lib/evalmath','evalmath.class.php',448],['lib/classes/event','base.php',765]], 964],
'get_file_storage': ['get_file_storage', 'Returns local file storage instance ', [['lib','moodlelib.php',6144]], 546],
'get_records_select': ['get_records_select', 'Load a list of records based on a select query. ', [['competency/classes','persistent.php',751],['lib/dml','moodle_database.php',1332]], 166],
'grade_update': ['grade_update', 'Submit new or update grade; update/create grade_item definition. Grade must have userid specified, rawgrade and feedback with format are optional. rawgrade NULL means \'Not graded\'. Missing property or key means does not change the existing value. ', [['lib','gradelib.php',40]], 27],
'delete_area_files': ['delete_area_files', 'Delete all area files (optionally limited by itemid). ', [['lib/filestorage','file_storage.php',992]], 123],
'div': ['div', 'Creates a <div> tag. (Shortcut function.) ', [['lib','outputcomponents.php',1814],['lib/htmlpurifier/HTMLPurifier','UnitConverter.php',239]], 207],
'get_all_instances_in_courses': ['get_all_instances_in_courses', 'Returns an array of all the active instances of a particular module in given courses, sorted in the order they are defined ', [['lib','datalib.php',1382]], 23],
'format_time': ['format_time', 'Format a date/time (seconds) as weeks, days, hours etc as needed ', [['lib','moodlelib.php',2065]], 70],
'scorm_get_popup_options_array': ['scorm_get_popup_options_array', 'Returns an array of the popup options for SCORM and each options default value ', [['mod/scorm','locallib.php',76]], 3],
'scorm_validate_package': ['scorm_validate_package', 'Check that a Zip file contains a valid SCORM package ', [['mod/scorm','lib.php',1361]], 6],
'scorm_update_instance': ['scorm_update_instance', 'Given an object containing all the necessary data, (defined by the form in mod_form.php) this function will update an existing instance with new data. ', [['mod/scorm','lib.php',169]], 0],
'scorm_grade_item_update': ['scorm_grade_item_update', 'Update/create grade item for given scorm ', [['mod/scorm','lib.php',636]], 6],
'print_error': ['print_error', 'Abort execution by throwing of a general exception, default exception handler displays the error message in most cases. ', [['lib','setuplib.php',481]], 1488],
'set_field': ['set_field', 'Set a single field in every table record where all the given conditions met. ', [['lib/dml','moodle_database.php',1737],['availability/condition/profile/tests','condition_test.php',349]], 485],
'userdate': ['userdate', 'Returns a formatted string that represents a date in user time. ', [['lib','moodlelib.php',2155],['lib/adodb','adodb.inc.php',2842],['lib/adodb','adodb.inc.php',3569]], 525],
'make_temp_directory': ['make_temp_directory', 'Create a directory under tempdir and make sure it is writable. ', [['lib','setuplib.php',1642]], 50],
'mtrace': ['mtrace', 'Outputs the given message via {@link mtrace()}. ', [['lib/classes','plugin_manager.php',1376],['lib','moodlelib.php',8509]], 406],
'scorm_parse': ['scorm_parse', 'Extracts scrom package, sets up all variables. Called whenever scorm changes ', [['mod/scorm','locallib.php',199]], 5],
'get_config': ['get_config', 'Config get method. ', [['lib/classes/antivirus','scanner.php',54],['competency/classes','competency_rule.php',59],['question/engine','bank.php',109],['admin/tool/log/classes/helper','store.php',63],['lib','moodlelib.php',1409],['lib','enrollib.php',1142],['lib/editor/tinymce/classes','plugin.php',73],['competency/classes','competency_rule_points.php',43],['search/classes','base.php',169],['mod/assign','assignmentplugin.php',345],['lib/portfolio','plugin.php',546]], 934],
'empty_tag': ['empty_tag', 'Outputs an empty tag with attributes ', [['lib','outputcomponents.php',1106]], 522],
'scorm_page_type_list': ['scorm_page_type_list', 'Return a list of page types ', [['mod/scorm','lib.php',1138]], 0],
'scorm_dndupload_handle': ['scorm_dndupload_handle', 'Handle a file that has been uploaded ', [['mod/scorm','lib.php',1296]], 0],
'scorm_get_user_grades': ['scorm_get_user_grades', 'Return grade for given user or all users. ', [['mod/scorm','lib.php',564]], 1],
'scorm_get_post_actions': ['scorm_get_post_actions', 'List the actions that correspond to a post of this module. This is used by the participation report. ', [['mod/scorm','lib.php',710]], 0],
'strlen': ['strlen', 'Counts the number of characters. Unit-tested by Kasper (single byte charsets only) ', [['lib/typo3','class.t3lib_cs.php',1520],['lib/classes','text.php',305]], 1649],
'get_file_packer': ['get_file_packer', 'Returns file packer ', [['lib','moodlelib.php',6198]], 74],
'import_external_file_contents': ['import_external_file_contents', 'Downloads the file from external repository and saves it in moodle filepool. This function is different from {@link repository::sync_reference()} because it has bigger request timeout and always downloads the content. ', [['repository','lib.php',1682],['lib/filestorage','stored_file.php',1011]], 7],
'get_area_files': ['get_area_files', 'Returns all area files (optionally limited by itemid) ', [['lib/filestorage','file_storage.php',782],['lib','externallib.php',1134]], 216],
'get_file': ['get_file', 'Downloads a repository file and saves to a path. ', [['repository/boxnet','lib.php',179],['repository/flickr_public','lib.php',453],['repository/dropbox','lib.php',410],['repository/skydrive','lib.php',130],['repository','lib.php',1647],['repository/s3','lib.php',227],['repository/equella','lib.php',166],['mod/data/field/picture','field.class.php',126],['mod/data/field/file','field.class.php',123],['repository/googledocs','lib.php',408],['lib/filestorage','file_storage.php',700],['repository/webdav','lib.php',73],['repository/filesystem','lib.php',398],['repository/flickr','lib.php',277],['lib','externallib.php',1076],['repository/dropbox','locallib.php',114],['lib','webdavlib.php',391]], 169],
'scorm_debug_log_remove': ['scorm_debug_log_remove', 'Remove debug log file ', [['mod/scorm','lib.php',1068]], 0],
'scorm_grade_item_delete': ['scorm_grade_item_delete', 'Delete grade item for given scorm ', [['mod/scorm','lib.php',682]], 1],
'scorm_update_grades': ['scorm_update_grades', 'Update grades in central gradebook ', [['mod/scorm','lib.php',607]], 6],
'grade_get_grades': ['grade_get_grades', 'Returns grading information for given activity, optionally with user grades Manual, course or category items can not be queried. ', [['lib','gradelib.php',408]], 53],
'scorm_cron': ['scorm_cron', 'Function to be run periodically according to the moodle cron This function searches for things that need to be done, such as sending out mail, toggling flags etc ... ', [['mod/scorm','lib.php',518]], 0],
'print_string': ['print_string', 'Prints out a translated string. ', [['lib','moodlelib.php',6877]], 458],
'send_stored_file': ['send_stored_file', 'Handles the sending of file data to the user\'s browser, including support for byteranges etc. ', [['lib','filelib.php',2192]], 75],
'scorm_get_completion_state': ['scorm_get_completion_state', 'Obtains the automatic completion state for this scorm based on any conditions in scorm settings. ', [['mod/scorm','lib.php',1184]], 0],
'scorm_check_mode': ['scorm_check_mode', 'Check and set the correct mode and attempt when entering a SCORM package. ', [['mod/scorm','lib.php',1402]], 1],
'end_tag': ['end_tag', 'Outputs a closing tag ', [['lib','outputcomponents.php',1096],['backup/util/xml/parser','progressive_parser.class.php',261],['backup/util/xml','xml_writer.class.php',177]], 867],
'scorm_option2text': ['scorm_option2text', '', [['mod/scorm','lib.php',728]], 2],
'scorm_get_availability_status': ['scorm_get_availability_status', 'Check if a SCORM is available for the current user. ', [['mod/scorm','locallib.php',2068]], 15],
'get_server_timezone': ['get_server_timezone', 'Returns server timezone. ', [['lib/classes','date.php',166]], 14],
'create': ['create', 'Auto-scan an incoming line to determine the response type. ', [['lib/horde/framework/Horde/Imap/Client/Interaction','Server.php',65],['lib/google/src/Google/Service','Partners.php',492],['lib/simplepie/library/SimplePie','Cache.php',95],['lib/google/src/Google/Service','YouTubeReporting.php',237],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',81],['lib/google/src/Google/Service','MapsEngine.php',1677],['lib/google/src/Google/Service','MapsEngine.php',1977],['lib/google/src/Google/Service','MapsEngine.php',2253],['lib/google/src/Google/Service','MapsEngine.php',2330],['lib/google/src/Google/Service','MapsEngine.php',2898],['lib/spout/src/Spout/Writer','WriterFactory.php',18],['lib/google/src/Google/Service','Dns.php',290],['lib/google/src/Google/Service','Dns.php',363],['lib/google/src/Google/Service','Appengine.php',438],['tag/classes','collection.php',188],['lib/adodb','adodb-xmlschema.inc.php',152],['lib/adodb','adodb-xmlschema.inc.php',473],['lib/adodb','adodb-xmlschema.inc.php',738],['lib/adodb','adodb-xmlschema.inc.php',884],['lib/adodb','adodb-xmlschema.inc.php',1129],['mod/quiz','attemptlib.php',100],['mod/quiz','attemptlib.php',596],['lib','weblib.php',3206],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',58],['lib/google/src/Google/Service','Dataflow.php',273],['lib/simplepie/library/SimplePie','Registry.php',153],['competency/classes','persistent.php',387],['lib/google/src/Google/Service','Cloudresourcemanager.php',373],['lib/phpexcel/PHPExcel/Shared/PCLZip','pclzip.lib.php',270],['lib/google/src/Google/Service','TagManager.php',1007],['lib/google/src/Google/Service','TagManager.php',1097],['lib/google/src/Google/Service','TagManager.php',1249],['lib/google/src/Google/Service','TagManager.php',1342],['lib/google/src/Google/Service','TagManager.php',1436],['lib/google/src/Google/Service','TagManager.php',1530],['lib/google/src/Google/Service','TagManager.php',1681],['mod/lesson','locallib.php',1011],['mod/lesson','locallib.php',2163],['mod/lesson','locallib.php',3212],['lib','modinfolib.php',1732],['repository','lib.php',206],['repository','lib.php',1910],['lib','navigationlib.php',268],['lib/htmlpurifier/HTMLPurifier','Config.php',114],['lib/google/src/Google/Service','Container.php',284],['lib/google/src/Google/Service','Genomics.php',632],['lib/google/src/Google/Service','Genomics.php',721],['lib/google/src/Google/Service','Genomics.php',1312],['lib/google/src/Google/Service','Genomics.php',1427],['lib/google/src/Google/Service','Games.php',1649],['lib/google/src/Google/Service','Games.php',2013],['lib/google/src/Google/Service','Fitness.php',377],['lib/google/src/Google/Service','Gmail.php',747],['lib/google/src/Google/Service','Gmail.php',905],['mod/quiz/classes','structure.php',65],['lib/htmlpurifier/HTMLPurifier','ElementDef.php',135],['lib/adodb','adodb-xmlschema03.inc.php',170],['lib/adodb','adodb-xmlschema03.inc.php',514],['lib/adodb','adodb-xmlschema03.inc.php',779],['lib/adodb','adodb-xmlschema03.inc.php',930],['lib/adodb','adodb-xmlschema03.inc.php',1228],['lib/google/src/Google/Service','Proximitybeacon.php',500],['tag/classes','area.php',205],['course','lib.php',3003],['question/type/ddmarker','shapes.php',170],['lib/classes/event','base.php',149],['lib','coursecatlib.php',325],['repository/filesystem','lib.php',498],['lib/google/src/Google/Service','Storagetransfer.php',281],['calendar','lib.php',2686],['lib/htmlpurifier/HTMLPurifier','Lexer.php',53],['lib/google/src/Google/Service','Classroom.php',445],['lib/google/src/Google/Service','Classroom.php',596],['lib/google/src/Google/Service','Classroom.php',673],['lib/google/src/Google/Service','Classroom.php',783],['lib/google/src/Google/Service','Classroom.php',912],['lib/spout/src/Spout/Reader','ReaderFactory.php',18],['lib/google/src/Google/Service','Pubsub.php',220],['lib/google/src/Google/Service','Pubsub.php',365],['lib/google/src/Google/Service','CloudMonitoring.php',258]], 3276],
'list_files': ['list_files', 'Returns array of info about all files in archive. ', [['lib/filestorage','zip_archive.php',296],['lib/filebrowser','virtual_root_file.php',125],['lib/filestorage','tgz_packer.php',694],['lib/filestorage','tgz_extractor.php',239],['lib/filestorage','stored_file.php',505],['lib/filestorage','zip_packer.php',546],['lib/filestorage','mbz_packer.php',131]], 24],
'update_state': ['update_state', 'Updates (if necessary) the completion state of activity $cm for the given user. ', [['lib','completionlib.php',507]], 40],
'get_record': ['get_record', 'Load a single record. ', [['competency/classes','persistent.php',738],['lib/dml','moodle_database.php',1462]], 3224],
'usergetmidnight': ['usergetmidnight', 'Given a time, return the GMT timestamp of the most recent midnight for the current user. ', [['lib','moodlelib.php',2252]], 24],
'scorm_dndupload_register': ['scorm_dndupload_register', 'Register the ability to handle drag and drop file uploads ', [['mod/scorm','lib.php',1286]], 0],
'get_records': ['get_records', 'Load a list of records. ', [['competency/classes','persistent.php',709],['mod/glossary/classes','entry_query_builder.php',295],['lib/dml','moodle_database.php',1285],['lib','coursecatlib.php',651],['question','category_class.php',63]], 965],
'aggregate_completion_states': ['aggregate_completion_states', 'Aggregate activity completion state ', [['lib','completionlib.php',1290]], 5],
'scorm_get_sco_runtime': ['scorm_get_sco_runtime', '', [['mod/scorm','locallib.php',678]], 4],
'instance': ['instance', 'Returns an instance of the cache_factor method. ', [['cache','disabledlib.php',171],['cache','disabledlib.php',296],['lib/classes','useragent.php',101],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',80],['lib/htmlpurifier/HTMLPurifier','URISchemeRegistry.php',9],['search/classes','manager.php',109],['cache','locallib.php',52],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',53],['lib/classes','plugin_manager.php',103],['lib/htmlpurifier','HTMLPurifier.php',251],['course/format','lib.php',156],['lib/classes/update','checker.php',62],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',31],['admin/tool/installaddon/classes','installer.php',40],['lib','modinfolib.php',373],['cache/classes','helper.php',76],['lib/tests','string_manager_standard_test.php',124],['lib/portfolio','exporter.php',251],['lib/classes/update','validator.php',88],['search/classes','document_factory.php',49],['lib','accesslib.php',6235],['lib','accesslib.php',6487],['lib','accesslib.php',6665],['lib','accesslib.php',6919],['lib','accesslib.php',7180],['lib','accesslib.php',7392],['backup/cc/cc_lib','cc_utils.php',387],['backup/cc/cc_lib','cc_utils.php',443],['lib','filterlib.php',80],['search/tests/fixtures','testable_core_search.php',43],['lib/tests/fixtures','testable_update_checker.php',45],['backup/cc','validator.php',35],['cache/classes','config.php',87],['cache/classes','factory.php',114],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',29]], 4647],
'tag': ['tag', 'Outputs a tag with attributes and contents ', [['lib','outputcomponents.php',1073]], 1292],
'spacer': ['spacer', 'Creates and returns a spacer image with optional line break. ', [['lib','outputrenderers.php',2427]], 29],
'scorm_get_extra_capabilities': ['scorm_get_extra_capabilities', 'Returns all other caps used in module ', [['mod/scorm','lib.php',829]], 0],
'scorm_supports': ['scorm_supports', '', [['mod/scorm','lib.php',1016]], 0],
'end_div': ['end_div', 'Ends a <div> tag. (Shortcut function.) ', [['lib','outputcomponents.php',1837]], 100],
'get_coursemodule_from_instance': ['get_coursemodule_from_instance', 'Given an instance number of a module, finds the coursemodule description ', [['lib','datalib.php',1300]], 441],
'add_record_snapshot': ['add_record_snapshot', 'Add cached data that will be most probably used in event observers. ', [['lib/classes/event','base.php',840]], 332],
'scorm_print_overview': ['scorm_print_overview', 'writes overview info for course_overview block - displays upcoming scorm objects that have a due date ', [['mod/scorm','lib.php',1086]], 0],
'scorm_debug_log_write': ['scorm_debug_log_write', 'writes log output to a temp log file ', [['mod/scorm','lib.php',1047]], 2],
'scorm_reset_course_form_definition': ['scorm_reset_course_form_definition', 'Implementation of the function for printing the form elements that control whether the course reset functionality affects the scorm. ', [['mod/scorm','lib.php',752]], 0],
'send_header_404': ['send_header_404', 'Helper function to send correct 404 for server. ', [['lib','filelib.php',1805]], 4],
'scorm_add_instance': ['scorm_add_instance', 'Given an object containing all the necessary data, (defined by the form in mod_form.php) this function will create a new instance and return the id number of the new instance. ', [['mod/scorm','lib.php',78]], 1],
'scorm_version_check': ['scorm_version_check', 'Returns the SCORM version used. ', [['mod/scorm','lib.php',1149]], 11],
'delete_records_select': ['delete_records_select', '', [['lib/dml','pdo_moodle_database.php',208],['lib/dml','oci_native_moodle_database.php',1495],['lib/dml','pgsql_native_moodle_database.php',1162],['lib/dml','mssql_native_moodle_database.php',1146],['lib/dml','mysqli_native_moodle_database.php',1477],['lib/dml','sqlsrv_native_moodle_database.php',1220],['lib/dml/tests','dml_test.php',5553]], 163],
'has_capability': ['has_capability', 'Wrapper round the has_capability funciton that automatically passes in the quiz context. ', [['mod/quiz','attemptlib.php',299],['mod/quiz','attemptlib.php',922],['lib','accesslib.php',344]], 2064],
'require_login': ['require_login', 'This function checks that the current user is logged in and has the required privileges ', [['lib','moodlelib.php',2449]], 636],
'get_filename': ['get_filename', 'Returns file name ', [['lib/filebrowser','virtual_root_file.php',227],['lib/filestorage','stored_file.php',699],['lib','medialib.php',169]], 248],
'sql_isempty': ['sql_isempty', 'Returns the SQL to know if one field is empty. ', [['lib/dml','oci_native_moodle_database.php',1729],['lib/dml','mssql_native_moodle_database.php',1277],['lib/dml','moodle_database.php',2191],['lib/dml','sqlsrv_native_moodle_database.php',1345]], 11],
'scorm_delete_instance': ['scorm_delete_instance', 'Given an ID of an instance of this module, this function will permanently delete the instance and any data that depends on it. ', [['mod/scorm','lib.php',256]], 0],
'get_string': ['get_string', 'Get String returns a requested string ', [['lib/classes','string_manager_install.php',95],['lib','moodlelib.php',6735],['lib','moodlelib.php',9695],['lib/external','externallib.php',102],['question/behaviour','behaviourbase.php',770],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38]], 20134],
'scorm_get_attempt_status': ['scorm_get_attempt_status', 'Generate the user attempt status string ', [['mod/scorm','locallib.php',1195]], 2],
'scorm_view': ['scorm_view', 'Trigger the course_module_viewed event. ', [['mod/scorm','lib.php',1458]], 3],
'container': ['container', 'Outputs a container. ', [['lib','outputrenderers.php',3126]], 195],
'img': ['img', 'Generates a simple image tag with attributes. ', [['lib','outputcomponents.php',1169]], 54],
'scorm_reset_course_form_defaults': ['scorm_reset_course_form_defaults', 'Course reset form defaults. ', [['mod/scorm','lib.php',763]], 0],
'close': ['close', 'Close archive, write changes to disk. ', [['lib/filestorage','zip_archive.php',183],['lib/dml','mssql_native_moodle_recordset.php',87],['auth/fc','fcFPP.php',78],['lib/dml','mysqli_native_moodle_recordset.php',86],['lib/spout/src/Spout/Reader','ReaderInterface.php',30],['lib/spout/src/Spout/Writer/ODS/Internal','Workbook.php',81],['lib/dml','pdo_moodle_recordset.php',79],['lib','csvlib.class.php',256],['lib/horde/framework/Horde/Socket','Client.php',135],['backup/util/helper','backup_null_iterator.class.php',53],['admin/tool/uploaduser','locallib.php',149],['lib/tcpdf','tcpdf.php',2943],['lib/phpunit/classes','phpmailer_sink.php',41],['lib/phpmailer','class.smtp.php',582],['lib/dml','sqlsrv_native_moodle_recordset.php',133],['lib/classes/dml','recordset_walk.php',153],['lib/spout/src/Spout/Writer/XLSX/Helper','SharedStringsHelper.php',84],['grade/export','lib.php',689],['lib','excellib.class.php',93],['backup/util/loggers','file_logger.class.php',69],['grade','lib.php',324],['backup/util/helper','backup_array_iterator.class.php',63],['lib/horde/framework/Horde/Imap/Client','Base.php',1846],['mod/assign/feedback/offline','importgradeslib.php',204],['lib/dml','oci_native_moodle_recordset.php',80],['lib/adodb','adodb.inc.php',2361],['lib/adodb','adodb.inc.php',3090],['lib/adodb','adodb.inc.php',3870],['lib/google/src/Google/Logger','File.php',132],['lib/phpunit/classes','event_sink.php',39],['lib/horde/framework/Horde','Stream.php',585],['backup/util/loggers','base_logger.class.php',89],['lib/phpexcel/PHPExcel/Shared','ZipArchive.php',71],['question/engine/tests','helpers.php',1241],['lib/spout/src/Spout/Writer','AbstractWriter.php',312],['lib','odslib.class.php',71],['lib/spout/src/Spout/Writer/Common/Internal','WorksheetInterface.php',34],['lib/spout/src/Spout/Writer/ODS/Internal','Worksheet.php',214],['lib/spout/src/Spout/Writer','WriterInterface.php',84],['lib/spout/src/Spout/Writer/XLSX/Internal','Worksheet.php',174],['lib/spout/src/Spout/Reader','AbstractReader.php',183],['lib/phpunit/classes','message_sink.php',39],['lib/spout/src/Spout/Writer/Common/Internal','WorkbookInterface.php',65],['lib/spout/src/Spout/Writer/XLSX/Internal','Workbook.php',95],['lib/pear/Net','GeoIP.php',556],['lib/tests','completionlib_test.php',907],['lib/pear/Auth','RADIUS.php',550],['lib/pear/Auth','RADIUS.php',710],['lib/pear/Auth','RADIUS.php',829],['lib','webdavlib.php',176],['lib/dml','pgsql_native_moodle_recordset.php',107]], 1128],
'send_relative_file': ['send_relative_file', 'Gets a file relative to this file in the repository and sends it to the browser. Used to allow relative file linking within a repository without creating file records for linked files ', [['repository','lib.php',2757],['lib/filestorage','stored_file.php',1023],['repository/filesystem','lib.php',777]], 3],
'pix_url': ['pix_url', 'Return the moodle_url for an image. ', [['lib','outputrenderers.php',237],['lib','outputlib.php',1394]], 367],
'scorm_grade_user': ['scorm_grade_user', '', [['mod/scorm','locallib.php',758]], 4],
'scorm_status_options': ['scorm_status_options', 'Return an array of status options ', [['mod/scorm','lib.php',53]], 3],
'trim': ['trim', '', [], 1948],
'array_values': ['array_values', '', [], 342],
'array_flip': ['array_flip', '', [], 131],
'file_put_contents': ['file_put_contents', '', [], 94],
'time': ['time', '', [], 1959],
'define': ['define', '', [], 2373],
'file_exists': ['file_exists', '', [], 867],
'count': ['count', '', [], 4095],
'is_array': ['is_array', '', [], 1608],
'strpos': ['strpos', '', [], 1604],
'implode': ['implode', '', [], 1281],
'is_null': ['is_null', '', [], 2003],
'in_array': ['in_array', '', [], 1234],
'array_shift': ['array_shift', '', [], 700],
'substr': ['substr', '', [], 2823],
'link': ['link', '', [], 695],
'chmod': ['chmod', '', [], 50],
'unlink': ['unlink', '', [], 256],
'strtolower': ['strtolower', '', [], 817],
'date': ['date', '', [], 693],
'function_exists': ['function_exists', '', [], 419],
'preg_match': ['preg_match', '', [], 1286],
'str_replace': ['str_replace', '', [], 1648],
'floatval': ['floatval', '', [], 101],
'sha1': ['sha1', '', [], 186],
'array_key_exists': ['array_key_exists', '', [], 1445],
'reset': ['reset', '', [], 1213]};
CLASS_DATA={
'context_module': ['context_module', 'Course module context class ', [['lib','accesslib.php',7039]], 1106],
'virtual_root_file': ['virtual_root_file', 'Represents the root directory of an empty file area in the tree navigated by {@link file_browser}. ', [['lib/filebrowser','virtual_root_file.php',28]], 23],
'html_writer': ['html_writer', 'Simple html output class ', [['lib','outputcomponents.php',1062]], 5120],
'file_info_stored': ['file_info_stored', 'Represents an actual file or folder - a row in the file table in the tree navigated by {@link file_browser}. ', [['lib/filebrowser','file_info_stored.php',28]], 33],
'completion_info': ['completion_info', 'Class represents completion information for a course. ', [['lib','completionlib.php',210]], 141],
'scorm_package_file_info': ['scorm_package_file_info', '', [['mod/scorm','locallib.php',61]], 1],
'core_date': ['core_date', 'Core date and time related code. ', [['lib/classes','date.php',26]], 192],
'course_module_viewed': ['course_module_viewed', 'The mod_page course module viewed event class. ', [['mod/page/classes/event','course_module_viewed.php',28],['mod/chat/classes/event','course_module_viewed.php',29],['mod/quiz/classes/event','course_module_viewed.php',29],['mod/data/classes/event','course_module_viewed.php',30],['mod/choice/classes/event','course_module_viewed.php',28],['mod/forum/classes/event','course_module_viewed.php',29],['mod/resource/classes/event','course_module_viewed.php',29],['mod/book/classes/event','course_module_viewed.php',28],['mod/imscp/classes/event','course_module_viewed.php',30],['mod/lti/classes/event','course_module_viewed.php',29],['mod/feedback/classes/event','course_module_viewed.php',28],['mod/survey/classes/event','course_module_viewed.php',29],['mod/folder/classes/event','course_module_viewed.php',29],['mod/glossary/classes/event','course_module_viewed.php',28],['mod/scorm/classes/event','course_module_viewed.php',28],['mod/url/classes/event','course_module_viewed.php',29],['mod/wiki/classes/event','course_module_viewed.php',28],['lib/tests/fixtures','event_fixtures.php',232],['mod/lesson/classes/event','course_module_viewed.php',30],['mod/workshop/classes/event','course_module_viewed.php',32]], 37]};
CONST_DATA={
'GRADE_TYPE_NONE': ['GRADE_TYPE_NONE', '', [['lib/grade','constants.php',80]], 47],
'SCORM_TYPE_EXTERNAL': ['SCORM_TYPE_EXTERNAL', '', [['mod/scorm','lib.php',28]], 8],
'SCORM_TYPE_LOCAL': ['SCORM_TYPE_LOCAL', '', [['mod/scorm','lib.php',24]], 16],
'FEATURE_GRADE_HAS_GRADE': ['FEATURE_GRADE_HAS_GRADE', '', [['lib','moodlelib.php',394]], 29],
'FEATURE_COMPLETION_TRACKS_VIEWS': ['FEATURE_COMPLETION_TRACKS_VIEWS', '', [['lib','moodlelib.php',405]], 23],
'COMPLETION_INCOMPLETE': ['COMPLETION_INCOMPLETE', '', [['lib','completionlib.php',70]], 53],
'FEATURE_GRADE_OUTCOMES': ['FEATURE_GRADE_OUTCOMES', '', [['lib','moodlelib.php',396]], 23],
'CONTEXT_MODULE': ['CONTEXT_MODULE', '', [['lib','accesslib.php',150]], 466],
'SCORM_NAV_FLOATING': ['SCORM_NAV_FLOATING', '', [['mod/scorm','lib.php',40]], 4],
'SCORM_DISPLAY_ATTEMPTSTATUS_NO': ['SCORM_DISPLAY_ATTEMPTSTATUS_NO', '', [['mod/scorm','lib.php',48]], 2],
'SCORM_12': ['SCORM_12', '', [['mod/scorm','lib.php',43]], 5],
'FEATURE_BACKUP_MOODLE2': ['FEATURE_BACKUP_MOODLE2', '', [['lib','moodlelib.php',434]], 35],
'SCORM_AICC': ['SCORM_AICC', '', [['mod/scorm','lib.php',45]], 4],
'FEATURE_SHOW_DESCRIPTION': ['FEATURE_SHOW_DESCRIPTION', '', [['lib','moodlelib.php',437]], 22],
'SCORM_TOC_HIDDEN': ['SCORM_TOC_HIDDEN', '', [['mod/scorm','lib.php',33]], 2],
'SCORM_13': ['SCORM_13', '', [['mod/scorm','lib.php',44]], 14],
'SCORM_TYPE_LOCALSYNC': ['SCORM_TYPE_LOCALSYNC', '', [['mod/scorm','lib.php',26]], 8],
'FEATURE_MOD_INTRO': ['FEATURE_MOD_INTRO', '', [['lib','moodlelib.php',426]], 31],
'SCORM_TOC_SIDE': ['SCORM_TOC_SIDE', '', [['mod/scorm','lib.php',32]], 5],
'SCORM_DISPLAY_ATTEMPTSTATUS_MY': ['SCORM_DISPLAY_ATTEMPTSTATUS_MY', '', [['mod/scorm','lib.php',50]], 3],
'COMPLETION_COMPLETE': ['COMPLETION_COMPLETE', '', [['lib','completionlib.php',76]], 90],
'FEATURE_COMPLETION_HAS_RULES': ['FEATURE_COMPLETION_HAS_RULES', '', [['lib','moodlelib.php',407]], 12],
'FEATURE_GROUPINGS': ['FEATURE_GROUPINGS', '', [['lib','moodlelib.php',416]], 23],
'FEATURE_GROUPS': ['FEATURE_GROUPS', '', [['lib','moodlelib.php',414]], 25],
'GRADE_TYPE_VALUE': ['GRADE_TYPE_VALUE', '', [['lib/grade','constants.php',85]], 80],
'SCORM_DISPLAY_ATTEMPTSTATUS_ALL': ['SCORM_DISPLAY_ATTEMPTSTATUS_ALL', '', [['mod/scorm','lib.php',49]], 4],
'SCORM_TYPE_AICCURL': ['SCORM_TYPE_AICCURL', '', [['mod/scorm','lib.php',30]], 9],
'SCORM_TOC_POPUP': ['SCORM_TOC_POPUP', '', [['mod/scorm','lib.php',34]], 5],
'SCORM_DISPLAY_ATTEMPTSTATUS_ENTRY': ['SCORM_DISPLAY_ATTEMPTSTATUS_ENTRY', '', [['mod/scorm','lib.php',51]], 3],
'SCORM_UPDATE_EVERYDAY': ['SCORM_UPDATE_EVERYDAY', '', [['mod/scorm','locallib.php',30]], 3],
'SCORM_NAV_UNDER_CONTENT': ['SCORM_NAV_UNDER_CONTENT', '', [['mod/scorm','lib.php',39]], 3],
'SCORM_TOC_DISABLED': ['SCORM_TOC_DISABLED', '', [['mod/scorm','lib.php',35]], 4],
'GRADESCOES': ['GRADESCOES', '', [['mod/scorm','locallib.php',41]], 10],
'MUST_EXIST': ['MUST_EXIST', '', [['lib','dmllib.php',52]], 1384],
'SCORM_NAV_DISABLED': ['SCORM_NAV_DISABLED', '', [['mod/scorm','lib.php',38]], 2]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Aug 11 10:00:09 2016</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
