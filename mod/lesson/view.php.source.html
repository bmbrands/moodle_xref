<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /mod/lesson/view.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Aug 11 10:00:09 2016 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='mod/lesson';
filename='view.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/mod/lesson/</a> -> <a href="view.php.html">view.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="view.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="view.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">//</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">//</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">//</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l16"><span class="linenum">  16</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l17"><span class="linenum">  17</span></a>  
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment">/**</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> * This page prints a particular instance of lesson</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> *</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @package mod_lesson</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @copyright  1999 onwards Martin Dougiamas  {@link http://moodle.com}</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or late</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> **/</span>
<a name="l25"><span class="linenum">  25</span></a>  
<a name="l26"><span class="linenum">  26</span></a>  require_once(__DIR__ . '/../../config.php');
<a name="l27"><span class="linenum">  27</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../mod/lesson/locallib.php.html">/mod/lesson/locallib.php</a>');
<a name="l28"><span class="linenum">  28</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../mod/lesson/view_form.php.html">/mod/lesson/view_form.php</a>');
<a name="l29"><span class="linenum">  29</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a> . '/completionlib.php');
<a name="l30"><span class="linenum">  30</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a> . '/grade/constants.php');
<a name="l31"><span class="linenum">  31</span></a>  
<a name="l32"><span class="linenum">  32</span></a>  <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>      = <a class="function" onClick="logFunction('required_param')" href="../../_functions/required_param.html" onMouseOver="funcPopup(event,'required_param')">required_param</a>('id', <a class="constant" onClick="logConstant('PARAM_INT')" href="../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>);             <span class="comment">// Course Module ID</span>
<a name="l33"><span class="linenum">  33</span></a>  <a class="var it987" onMouseOver="hilite(987)" onMouseOut="lolite()" onClick="logVariable('pageid')" href="../../_variables/pageid.html">$pageid</a>  = <a class="function" onClick="logFunction('optional_param')" href="../../_functions/optional_param.html" onMouseOver="funcPopup(event,'optional_param')">optional_param</a>('pageid', null, <a class="constant" onClick="logConstant('PARAM_INT')" href="../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>);   <span class="comment">// Lesson Page ID</span>
<a name="l34"><span class="linenum">  34</span></a>  <a class="var it417" onMouseOver="hilite(417)" onMouseOut="lolite()" onClick="logVariable('edit')" href="../../_variables/edit.html">$edit</a>    = <a class="function" onClick="logFunction('optional_param')" href="../../_functions/optional_param.html" onMouseOver="funcPopup(event,'optional_param')">optional_param</a>('edit', -1, <a class="constant" onClick="logConstant('PARAM_BOOL')" href="../../_constants/PARAM_BOOL.html" onMouseOver="constPopup(event,'PARAM_BOOL')">PARAM_BOOL</a>);
<a name="l35"><span class="linenum">  35</span></a>  <a class="var it1202" onMouseOver="hilite(1202)" onMouseOut="lolite()" onClick="logVariable('userpassword')" href="../../_variables/userpassword.html">$userpassword</a> = <a class="function" onClick="logFunction('optional_param')" href="../../_functions/optional_param.html" onMouseOver="funcPopup(event,'optional_param')">optional_param</a>('userpassword','',<a class="constant" onClick="logConstant('PARAM_RAW')" href="../../_constants/PARAM_RAW.html" onMouseOver="constPopup(event,'PARAM_RAW')">PARAM_RAW</a>);
<a name="l36"><span class="linenum">  36</span></a>  <a class="var it1203" onMouseOver="hilite(1203)" onMouseOut="lolite()" onClick="logVariable('backtocourse')" href="../../_variables/backtocourse.html">$backtocourse</a> = <a class="function" onClick="logFunction('optional_param')" href="../../_functions/optional_param.html" onMouseOver="funcPopup(event,'optional_param')">optional_param</a>('backtocourse', false, <a class="constant" onClick="logConstant('PARAM_RAW')" href="../../_constants/PARAM_RAW.html" onMouseOver="constPopup(event,'PARAM_RAW')">PARAM_RAW</a>);
<a name="l37"><span class="linenum">  37</span></a>  
<a name="l38"><span class="linenum">  38</span></a>  <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a> = <a class="function" onClick="logFunction('get_coursemodule_from_id')" href="../../_functions/get_coursemodule_from_id.html" onMouseOver="funcPopup(event,'get_coursemodule_from_id')">get_coursemodule_from_id</a>('lesson', <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>, 0, false, <a class="constant" onClick="logConstant('MUST_EXIST')" href="../../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l39"><span class="linenum">  39</span></a>  <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('course', array('id' =&gt; <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('course')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>), '*', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l40"><span class="linenum">  40</span></a>  <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a> = <span class="keyword">new </span><a class="class" onClick="logClass('lesson')" href="../../_classes/lesson.html" onMouseOver="classPopup(event,'lesson')">lesson</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('lesson', array('id' =&gt; <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('instance')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/instance.html">instance</a>), '*', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>));
<a name="l41"><span class="linenum">  41</span></a>  
<a name="l42"><span class="linenum">  42</span></a>  <a class="function" onClick="logFunction('require_login')" href="../../_functions/require_login.html" onMouseOver="funcPopup(event,'require_login')">require_login</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, false, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>);
<a name="l43"><span class="linenum">  43</span></a>  
<a name="l44"><span class="linenum">  44</span></a>  if (<a class="var it1203" onMouseOver="hilite(1203)" onMouseOut="lolite()" onClick="logVariable('backtocourse')" href="../../_variables/backtocourse.html">$backtocourse</a>) {
<a name="l45"><span class="linenum">  45</span></a>      <a class="function" onClick="logFunction('redirect')" href="../../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../course/view.php.html">/course/view.php</a>', array('id'=&gt;<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>)));
<a name="l46"><span class="linenum">  46</span></a>  }
<a name="l47"><span class="linenum">  47</span></a>  
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment">// Apply overrides.</span>
<a name="l49"><span class="linenum">  49</span></a>  <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('update_effective_access')" href="../../_functions/update_effective_access.html" onMouseOver="funcPopup(event,'update_effective_access')">update_effective_access</a>(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l50"><span class="linenum">  50</span></a>  
<a name="l51"><span class="linenum">  51</span></a>  <span class="comment">// Mark as viewed</span>
<a name="l52"><span class="linenum">  52</span></a>  <a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a> = <span class="keyword">new </span><a class="class" onClick="logClass('completion_info')" href="../../_classes/completion_info.html" onMouseOver="classPopup(event,'completion_info')">completion_info</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>);
<a name="l53"><span class="linenum">  53</span></a>  <a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a>-&gt;<a class="function" onClick="logFunction('set_module_viewed')" href="../../_functions/set_module_viewed.html" onMouseOver="funcPopup(event,'set_module_viewed')">set_module_viewed</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>);
<a name="l54"><span class="linenum">  54</span></a>  
<a name="l55"><span class="linenum">  55</span></a>  <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../mod/lesson/view.php.html">/mod/lesson/view.php</a>', array('id'=&gt;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>));
<a name="l56"><span class="linenum">  56</span></a>  if (<a class="var it987" onMouseOver="hilite(987)" onMouseOut="lolite()" onClick="logVariable('pageid')" href="../../_variables/pageid.html">$pageid</a> !== null) {
<a name="l57"><span class="linenum">  57</span></a>      <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>-&gt;<a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>('pageid', <a class="var it987" onMouseOver="hilite(987)" onMouseOut="lolite()" onClick="logVariable('pageid')" href="../../_variables/pageid.html">$pageid</a>);
<a name="l58"><span class="linenum">  58</span></a>  }
<a name="l59"><span class="linenum">  59</span></a>  <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('set_url')" href="../../_functions/set_url.html" onMouseOver="funcPopup(event,'set_url')">set_url</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>);
<a name="l60"><span class="linenum">  60</span></a>  
<a name="l61"><span class="linenum">  61</span></a>  <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_module')" href="../../_classes/context_module.html" onMouseOver="classPopup(event,'context_module')">context_module</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l62"><span class="linenum">  62</span></a>  <a class="var it1205" onMouseOver="hilite(1205)" onMouseOut="lolite()" onClick="logVariable('canmanage')" href="../../_variables/canmanage.html">$canmanage</a> = <a class="function" onClick="logFunction('has_capability')" href="../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('mod/lesson:manage', <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l63"><span class="linenum">  63</span></a>  
<a name="l64"><span class="linenum">  64</span></a>  <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a> = <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('get_renderer')" href="../../_functions/get_renderer.html" onMouseOver="funcPopup(event,'get_renderer')">get_renderer</a>('mod_lesson');
<a name="l65"><span class="linenum">  65</span></a>  
<a name="l66"><span class="linenum">  66</span></a>  <a class="var it1207" onMouseOver="hilite(1207)" onMouseOut="lolite()" onClick="logVariable('reviewmode')" href="../../_variables/reviewmode.html">$reviewmode</a> = false;
<a name="l67"><span class="linenum">  67</span></a>  <a class="var it1208" onMouseOver="hilite(1208)" onMouseOut="lolite()" onClick="logVariable('userhasgrade')" href="../../_variables/userhasgrade.html">$userhasgrade</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records')" href="../../_functions/count_records.html" onMouseOver="funcPopup(event,'count_records')">count_records</a>(&quot;lesson_grades&quot;, array(&quot;lessonid&quot;=&gt;<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, &quot;userid&quot;=&gt;<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l68"><span class="linenum">  68</span></a>  if (<a class="var it1208" onMouseOver="hilite(1208)" onMouseOut="lolite()" onClick="logVariable('userhasgrade')" href="../../_variables/userhasgrade.html">$userhasgrade</a> &amp;&amp; !<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('retake')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/retake.html">retake</a>) {
<a name="l69"><span class="linenum">  69</span></a>      <a class="var it1207" onMouseOver="hilite(1207)" onMouseOut="lolite()" onClick="logVariable('reviewmode')" href="../../_variables/reviewmode.html">$reviewmode</a> = true;
<a name="l70"><span class="linenum">  70</span></a>  }
<a name="l71"><span class="linenum">  71</span></a>  
<a name="l72"><span class="linenum">  72</span></a>  <span class="comment">/// Check these for students only TODO: Find a better method for doing this!</span>
<a name="l73"><span class="linenum">  73</span></a>  <span class="comment">///     Check lesson availability</span>
<a name="l74"><span class="linenum">  74</span></a>  <span class="comment">///     Check for password</span>
<a name="l75"><span class="linenum">  75</span></a>  <span class="comment">///     Check dependencies</span>
<a name="l76"><span class="linenum">  76</span></a>  if (!<a class="var it1205" onMouseOver="hilite(1205)" onMouseOut="lolite()" onClick="logVariable('canmanage')" href="../../_variables/canmanage.html">$canmanage</a>) {
<a name="l77"><span class="linenum">  77</span></a>      if (!<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('is_accessible')" href="../../_functions/is_accessible.html" onMouseOver="funcPopup(event,'is_accessible')">is_accessible</a>()) {  // Deadline restrictions
<a name="l78"><span class="linenum">  78</span></a>          echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="phpfunction" onClick="logFunction('header')" href="../../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, '', false, null, <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('notavailable'));
<a name="l79"><span class="linenum">  79</span></a>          if (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('deadline')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/deadline.html">deadline</a> != 0 &amp;&amp; <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() &gt; <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('deadline')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/deadline.html">deadline</a>) {
<a name="l80"><span class="linenum">  80</span></a>              echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('lesson_inaccessible')" href="../../_functions/lesson_inaccessible.html" onMouseOver="funcPopup(event,'lesson_inaccessible')">lesson_inaccessible</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('lessonclosed', 'lesson', <a class="function" onClick="logFunction('userdate')" href="../../_functions/userdate.html" onMouseOver="funcPopup(event,'userdate')">userdate</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('deadline')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/deadline.html">deadline</a>)));
<a name="l81"><span class="linenum">  81</span></a>          } else {
<a name="l82"><span class="linenum">  82</span></a>              echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('lesson_inaccessible')" href="../../_functions/lesson_inaccessible.html" onMouseOver="funcPopup(event,'lesson_inaccessible')">lesson_inaccessible</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('lessonopen', 'lesson', <a class="function" onClick="logFunction('userdate')" href="../../_functions/userdate.html" onMouseOver="funcPopup(event,'userdate')">userdate</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('available')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/available.html">available</a>)));
<a name="l83"><span class="linenum">  83</span></a>          }
<a name="l84"><span class="linenum">  84</span></a>          echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('footer')" href="../../_functions/footer.html" onMouseOver="funcPopup(event,'footer')">footer</a>();
<a name="l85"><span class="linenum">  85</span></a>          exit();
<a name="l86"><span class="linenum">  86</span></a>      } else if (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('usepassword')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/usepassword.html">usepassword</a> &amp;&amp; empty(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('lessonloggedin')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/lessonloggedin.html">lessonloggedin</a>[<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>])) { // Password protected lesson code
<a name="l87"><span class="linenum">  87</span></a>          <a class="var it1214" onMouseOver="hilite(1214)" onMouseOut="lolite()" onClick="logVariable('correctpass')" href="../../_variables/correctpass.html">$correctpass</a> = false;
<a name="l88"><span class="linenum">  88</span></a>          if (!empty(<a class="var it1202" onMouseOver="hilite(1202)" onMouseOut="lolite()" onClick="logVariable('userpassword')" href="../../_variables/userpassword.html">$userpassword</a>) &amp;&amp; ((<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('password')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/password.html">password</a> == md5(<a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it1202" onMouseOver="hilite(1202)" onMouseOut="lolite()" onClick="logVariable('userpassword')" href="../../_variables/userpassword.html">$userpassword</a>))) || (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('password')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/password.html">password</a> == <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it1202" onMouseOver="hilite(1202)" onMouseOut="lolite()" onClick="logVariable('userpassword')" href="../../_variables/userpassword.html">$userpassword</a>)))) {
<a name="l89"><span class="linenum">  89</span></a>              <a class="function" onClick="logFunction('require_sesskey')" href="../../_functions/require_sesskey.html" onMouseOver="funcPopup(event,'require_sesskey')">require_sesskey</a>();
<a name="l90"><span class="linenum">  90</span></a>  <span class="comment">            // with or without md5 for backward compatibility (MDL-11090)</span>
<a name="l91"><span class="linenum">  91</span></a>              <a class="var it1214" onMouseOver="hilite(1214)" onMouseOut="lolite()" onClick="logVariable('correctpass')" href="../../_variables/correctpass.html">$correctpass</a> = true;
<a name="l92"><span class="linenum">  92</span></a>              <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('lessonloggedin')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/lessonloggedin.html">lessonloggedin</a>[<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>] = true;
<a name="l93"><span class="linenum">  93</span></a>  
<a name="l94"><span class="linenum">  94</span></a>          } else if (isset(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('extrapasswords')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/extrapasswords.html">extrapasswords</a>)) {
<a name="l95"><span class="linenum">  95</span></a>  
<a name="l96"><span class="linenum">  96</span></a>  <span class="comment">            // Group overrides may have additional passwords.</span>
<a name="l97"><span class="linenum">  97</span></a>              foreach (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('extrapasswords')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/extrapasswords.html">extrapasswords</a> as <a class="var it201" onMouseOver="hilite(201)" onMouseOut="lolite()" onClick="logVariable('password')" href="../../_variables/password.html">$password</a>) {
<a name="l98"><span class="linenum">  98</span></a>                  if (<a class="phpfunction" onClick="logFunction('strcmp')" href="../../_functions/strcmp.html" onMouseOver="phpfuncPopup(event,'strcmp')">strcmp</a>(<a class="var it201" onMouseOver="hilite(201)" onMouseOut="lolite()" onClick="logVariable('password')" href="../../_variables/password.html">$password</a>, md5(<a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it1202" onMouseOver="hilite(1202)" onMouseOut="lolite()" onClick="logVariable('userpassword')" href="../../_variables/userpassword.html">$userpassword</a>))) === 0 || <a class="phpfunction" onClick="logFunction('strcmp')" href="../../_functions/strcmp.html" onMouseOver="phpfuncPopup(event,'strcmp')">strcmp</a>(<a class="var it201" onMouseOver="hilite(201)" onMouseOut="lolite()" onClick="logVariable('password')" href="../../_variables/password.html">$password</a>, <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it1202" onMouseOver="hilite(1202)" onMouseOut="lolite()" onClick="logVariable('userpassword')" href="../../_variables/userpassword.html">$userpassword</a>)) === 0) {
<a name="l99"><span class="linenum">  99</span></a>                      <a class="function" onClick="logFunction('require_sesskey')" href="../../_functions/require_sesskey.html" onMouseOver="funcPopup(event,'require_sesskey')">require_sesskey</a>();
<a name="l100"><span class="linenum"> 100</span></a>                      <a class="var it1214" onMouseOver="hilite(1214)" onMouseOut="lolite()" onClick="logVariable('correctpass')" href="../../_variables/correctpass.html">$correctpass</a> = true;
<a name="l101"><span class="linenum"> 101</span></a>                      <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('lessonloggedin')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/lessonloggedin.html">lessonloggedin</a>[<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>] = true;
<a name="l102"><span class="linenum"> 102</span></a>                  }
<a name="l103"><span class="linenum"> 103</span></a>              }
<a name="l104"><span class="linenum"> 104</span></a>          }
<a name="l105"><span class="linenum"> 105</span></a>          if (!<a class="var it1214" onMouseOver="hilite(1214)" onMouseOut="lolite()" onClick="logVariable('correctpass')" href="../../_variables/correctpass.html">$correctpass</a>) {
<a name="l106"><span class="linenum"> 106</span></a>              echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="phpfunction" onClick="logFunction('header')" href="../../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, '', false, null, <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('passwordprotectedlesson', 'lesson', <a class="function" onClick="logFunction('format_string')" href="../../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('name')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>)));
<a name="l107"><span class="linenum"> 107</span></a>              echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('login_prompt')" href="../../_functions/login_prompt.html" onMouseOver="funcPopup(event,'login_prompt')">login_prompt</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>, <a class="var it1202" onMouseOver="hilite(1202)" onMouseOut="lolite()" onClick="logVariable('userpassword')" href="../../_variables/userpassword.html">$userpassword</a> !== '');
<a name="l108"><span class="linenum"> 108</span></a>              echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('footer')" href="../../_functions/footer.html" onMouseOver="funcPopup(event,'footer')">footer</a>();
<a name="l109"><span class="linenum"> 109</span></a>              exit();
<a name="l110"><span class="linenum"> 110</span></a>          }
<a name="l111"><span class="linenum"> 111</span></a>      } else if (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('dependency')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/dependency.html">dependency</a>) { // check for dependencies
<a name="l112"><span class="linenum"> 112</span></a>          if (<a class="var it1216" onMouseOver="hilite(1216)" onMouseOut="lolite()" onClick="logVariable('dependentlesson')" href="../../_variables/dependentlesson.html">$dependentlesson</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('lesson', array('id' =&gt; <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('dependency')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/dependency.html">dependency</a>))) {
<a name="l113"><span class="linenum"> 113</span></a>  <span class="comment">            // lesson exists, so we can proceed</span>
<a name="l114"><span class="linenum"> 114</span></a>              <a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a> = <a class="phpfunction" onClick="logFunction('unserialize')" href="../../_functions/unserialize.html" onMouseOver="phpfuncPopup(event,'unserialize')">unserialize</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('conditions')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/conditions.html">conditions</a>);
<a name="l115"><span class="linenum"> 115</span></a>  <span class="comment">            // assume false for all</span>
<a name="l116"><span class="linenum"> 116</span></a>              <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('errors')" href="../../_variables/errors.html">$errors</a> = array();
<a name="l117"><span class="linenum"> 117</span></a>  
<a name="l118"><span class="linenum"> 118</span></a>  <span class="comment">            // check for the timespent condition</span>
<a name="l119"><span class="linenum"> 119</span></a>              if (<a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>-&gt;<a onClick="logVariable('timespent')" class="var it44774" onMouseOver="hilite(44774)" onMouseOut="lolite()" href="../../_variables/timespent.html">timespent</a>) {
<a name="l120"><span class="linenum"> 120</span></a>                  <a class="var it1218" onMouseOver="hilite(1218)" onMouseOut="lolite()" onClick="logVariable('timespent')" href="../../_variables/timespent.html">$timespent</a> = false;
<a name="l121"><span class="linenum"> 121</span></a>                  if (<a class="var it1219" onMouseOver="hilite(1219)" onMouseOut="lolite()" onClick="logVariable('attempttimes')" href="../../_variables/attempttimes.html">$attempttimes</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('lesson_timer', array(&quot;userid&quot;=&gt;<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, &quot;lessonid&quot;=&gt;<a class="var it1216" onMouseOver="hilite(1216)" onMouseOut="lolite()" onClick="logVariable('dependentlesson')" href="../../_variables/dependentlesson.html">$dependentlesson</a>-&gt;<a onClick="logVariable('id')" class="var it44798" onMouseOver="hilite(44798)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l122"><span class="linenum"> 122</span></a>  <span class="comment">                    // go through all the times and test to see if any of them satisfy the condition</span>
<a name="l123"><span class="linenum"> 123</span></a>                      foreach(<a class="var it1219" onMouseOver="hilite(1219)" onMouseOut="lolite()" onClick="logVariable('attempttimes')" href="../../_variables/attempttimes.html">$attempttimes</a> as <a class="var it1220" onMouseOver="hilite(1220)" onMouseOut="lolite()" onClick="logVariable('attempttime')" href="../../_variables/attempttime.html">$attempttime</a>) {
<a name="l124"><span class="linenum"> 124</span></a>                          <a class="var it1221" onMouseOver="hilite(1221)" onMouseOut="lolite()" onClick="logVariable('duration')" href="../../_variables/duration.html">$duration</a> = <a class="var it1220" onMouseOver="hilite(1220)" onMouseOut="lolite()" onClick="logVariable('attempttime')" href="../../_variables/attempttime.html">$attempttime</a>-&gt;<a onClick="logVariable('lessontime')" class="var it44806" onMouseOver="hilite(44806)" onMouseOut="lolite()" href="../../_variables/lessontime.html">lessontime</a> - <a class="var it1220" onMouseOver="hilite(1220)" onMouseOut="lolite()" onClick="logVariable('attempttime')" href="../../_variables/attempttime.html">$attempttime</a>-&gt;<a onClick="logVariable('starttime')" class="var it44806" onMouseOver="hilite(44806)" onMouseOut="lolite()" href="../../_variables/starttime.html">starttime</a>;
<a name="l125"><span class="linenum"> 125</span></a>                          if (<a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>-&gt;<a onClick="logVariable('timespent')" class="var it44774" onMouseOver="hilite(44774)" onMouseOut="lolite()" href="../../_variables/timespent.html">timespent</a> &lt; <a class="var it1221" onMouseOver="hilite(1221)" onMouseOut="lolite()" onClick="logVariable('duration')" href="../../_variables/duration.html">$duration</a>/60) {
<a name="l126"><span class="linenum"> 126</span></a>                              <a class="var it1218" onMouseOver="hilite(1218)" onMouseOut="lolite()" onClick="logVariable('timespent')" href="../../_variables/timespent.html">$timespent</a> = true;
<a name="l127"><span class="linenum"> 127</span></a>                          }
<a name="l128"><span class="linenum"> 128</span></a>                      }
<a name="l129"><span class="linenum"> 129</span></a>                  }
<a name="l130"><span class="linenum"> 130</span></a>                  if (!<a class="var it1218" onMouseOver="hilite(1218)" onMouseOut="lolite()" onClick="logVariable('timespent')" href="../../_variables/timespent.html">$timespent</a>) {
<a name="l131"><span class="linenum"> 131</span></a>                      <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('errors')" href="../../_variables/errors.html">$errors</a>[] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('timespenterror', 'lesson', <a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>-&gt;<a onClick="logVariable('timespent')" class="var it44774" onMouseOver="hilite(44774)" onMouseOut="lolite()" href="../../_variables/timespent.html">timespent</a>);
<a name="l132"><span class="linenum"> 132</span></a>                  }
<a name="l133"><span class="linenum"> 133</span></a>              }
<a name="l134"><span class="linenum"> 134</span></a>  
<a name="l135"><span class="linenum"> 135</span></a>  <span class="comment">            // check for the gradebetterthan condition</span>
<a name="l136"><span class="linenum"> 136</span></a>              if(<a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>-&gt;<a onClick="logVariable('gradebetterthan')" class="var it44774" onMouseOver="hilite(44774)" onMouseOut="lolite()" href="../../_variables/gradebetterthan.html">gradebetterthan</a>) {
<a name="l137"><span class="linenum"> 137</span></a>                  <a class="var it1224" onMouseOver="hilite(1224)" onMouseOut="lolite()" onClick="logVariable('gradebetterthan')" href="../../_variables/gradebetterthan.html">$gradebetterthan</a> = false;
<a name="l138"><span class="linenum"> 138</span></a>                  if (<a class="var it1225" onMouseOver="hilite(1225)" onMouseOut="lolite()" onClick="logVariable('studentgrades')" href="../../_variables/studentgrades.html">$studentgrades</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('lesson_grades', array(&quot;userid&quot;=&gt;<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, &quot;lessonid&quot;=&gt;<a class="var it1216" onMouseOver="hilite(1216)" onMouseOut="lolite()" onClick="logVariable('dependentlesson')" href="../../_variables/dependentlesson.html">$dependentlesson</a>-&gt;<a onClick="logVariable('id')" class="var it44798" onMouseOver="hilite(44798)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l139"><span class="linenum"> 139</span></a>  <span class="comment">                    // go through all the grades and test to see if any of them satisfy the condition</span>
<a name="l140"><span class="linenum"> 140</span></a>                      foreach(<a class="var it1225" onMouseOver="hilite(1225)" onMouseOut="lolite()" onClick="logVariable('studentgrades')" href="../../_variables/studentgrades.html">$studentgrades</a> as <a class="var it1226" onMouseOver="hilite(1226)" onMouseOut="lolite()" onClick="logVariable('studentgrade')" href="../../_variables/studentgrade.html">$studentgrade</a>) {
<a name="l141"><span class="linenum"> 141</span></a>                          if (<a class="var it1226" onMouseOver="hilite(1226)" onMouseOut="lolite()" onClick="logVariable('studentgrade')" href="../../_variables/studentgrade.html">$studentgrade</a>-&gt;<a onClick="logVariable('grade')" class="var it44807" onMouseOver="hilite(44807)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> &gt;= <a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>-&gt;<a onClick="logVariable('gradebetterthan')" class="var it44774" onMouseOver="hilite(44774)" onMouseOut="lolite()" href="../../_variables/gradebetterthan.html">gradebetterthan</a>) {
<a name="l142"><span class="linenum"> 142</span></a>                              <a class="var it1224" onMouseOver="hilite(1224)" onMouseOut="lolite()" onClick="logVariable('gradebetterthan')" href="../../_variables/gradebetterthan.html">$gradebetterthan</a> = true;
<a name="l143"><span class="linenum"> 143</span></a>                          }
<a name="l144"><span class="linenum"> 144</span></a>                      }
<a name="l145"><span class="linenum"> 145</span></a>                  }
<a name="l146"><span class="linenum"> 146</span></a>                  if (!<a class="var it1224" onMouseOver="hilite(1224)" onMouseOut="lolite()" onClick="logVariable('gradebetterthan')" href="../../_variables/gradebetterthan.html">$gradebetterthan</a>) {
<a name="l147"><span class="linenum"> 147</span></a>                      <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('errors')" href="../../_variables/errors.html">$errors</a>[] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('gradebetterthanerror', 'lesson', <a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>-&gt;<a onClick="logVariable('gradebetterthan')" class="var it44774" onMouseOver="hilite(44774)" onMouseOut="lolite()" href="../../_variables/gradebetterthan.html">gradebetterthan</a>);
<a name="l148"><span class="linenum"> 148</span></a>                  }
<a name="l149"><span class="linenum"> 149</span></a>              }
<a name="l150"><span class="linenum"> 150</span></a>  
<a name="l151"><span class="linenum"> 151</span></a>  <span class="comment">            // check for the completed condition</span>
<a name="l152"><span class="linenum"> 152</span></a>              if (<a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>-&gt;<a onClick="logVariable('completed')" class="var it44774" onMouseOver="hilite(44774)" onMouseOut="lolite()" href="../../_variables/completed.html">completed</a>) {
<a name="l153"><span class="linenum"> 153</span></a>                  if (!<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records')" href="../../_functions/count_records.html" onMouseOver="funcPopup(event,'count_records')">count_records</a>('lesson_grades', array('userid'=&gt;<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'lessonid'=&gt;<a class="var it1216" onMouseOver="hilite(1216)" onMouseOut="lolite()" onClick="logVariable('dependentlesson')" href="../../_variables/dependentlesson.html">$dependentlesson</a>-&gt;<a onClick="logVariable('id')" class="var it44798" onMouseOver="hilite(44798)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l154"><span class="linenum"> 154</span></a>                      <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('errors')" href="../../_variables/errors.html">$errors</a>[] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('completederror', 'lesson');
<a name="l155"><span class="linenum"> 155</span></a>                  }
<a name="l156"><span class="linenum"> 156</span></a>              }
<a name="l157"><span class="linenum"> 157</span></a>  
<a name="l158"><span class="linenum"> 158</span></a>              if (!empty(<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('errors')" href="../../_variables/errors.html">$errors</a>)) {  // print out the errors if any
<a name="l159"><span class="linenum"> 159</span></a>                  echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="phpfunction" onClick="logFunction('header')" href="../../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, '', false, null, <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('completethefollowingconditions', 'lesson', <a class="function" onClick="logFunction('format_string')" href="../../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('name')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>)));
<a name="l160"><span class="linenum"> 160</span></a>                  echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('dependancy_errors')" href="../../_functions/dependancy_errors.html" onMouseOver="funcPopup(event,'dependancy_errors')">dependancy_errors</a>(<a class="var it1216" onMouseOver="hilite(1216)" onMouseOut="lolite()" onClick="logVariable('dependentlesson')" href="../../_variables/dependentlesson.html">$dependentlesson</a>, <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('errors')" href="../../_variables/errors.html">$errors</a>);
<a name="l161"><span class="linenum"> 161</span></a>                  echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('footer')" href="../../_functions/footer.html" onMouseOver="funcPopup(event,'footer')">footer</a>();
<a name="l162"><span class="linenum"> 162</span></a>                  exit();
<a name="l163"><span class="linenum"> 163</span></a>              }
<a name="l164"><span class="linenum"> 164</span></a>          }
<a name="l165"><span class="linenum"> 165</span></a>      }
<a name="l166"><span class="linenum"> 166</span></a>  }
<a name="l167"><span class="linenum"> 167</span></a>  
<a name="l168"><span class="linenum"> 168</span></a>  <span class="comment">    // this is called if a student leaves during a lesson</span>
<a name="l169"><span class="linenum"> 169</span></a>  if (<a class="var it987" onMouseOver="hilite(987)" onMouseOut="lolite()" onClick="logVariable('pageid')" href="../../_variables/pageid.html">$pageid</a> == <a class="constant" onClick="logConstant('LESSON_UNSEENBRANCHPAGE')" href="../../_constants/LESSON_UNSEENBRANCHPAGE.html" onMouseOver="constPopup(event,'LESSON_UNSEENBRANCHPAGE')">LESSON_UNSEENBRANCHPAGE</a>) {
<a name="l170"><span class="linenum"> 170</span></a>      <a class="var it987" onMouseOver="hilite(987)" onMouseOut="lolite()" onClick="logVariable('pageid')" href="../../_variables/pageid.html">$pageid</a> = <a class="function" onClick="logFunction('lesson_unseen_question_jump')" href="../../_functions/lesson_unseen_question_jump.html" onMouseOver="funcPopup(event,'lesson_unseen_question_jump')">lesson_unseen_question_jump</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it987" onMouseOver="hilite(987)" onMouseOut="lolite()" onClick="logVariable('pageid')" href="../../_variables/pageid.html">$pageid</a>);
<a name="l171"><span class="linenum"> 171</span></a>  }
<a name="l172"><span class="linenum"> 172</span></a>  
<a name="l173"><span class="linenum"> 173</span></a>  <span class="comment">// display individual pages and their sets of answers</span>
<a name="l174"><span class="linenum"> 174</span></a>  <span class="comment">// if pageid is EOL then the end of the lesson has been reached</span>
<a name="l175"><span class="linenum"> 175</span></a>  <span class="comment">// for flow, changed to simple echo for flow styles, michaelp, moved lesson name and page title down</span>
<a name="l176"><span class="linenum"> 176</span></a>  <a class="var it1228" onMouseOver="hilite(1228)" onMouseOut="lolite()" onClick="logVariable('attemptflag')" href="../../_variables/attemptflag.html">$attemptflag</a> = false;
<a name="l177"><span class="linenum"> 177</span></a>  if (empty(<a class="var it987" onMouseOver="hilite(987)" onMouseOut="lolite()" onClick="logVariable('pageid')" href="../../_variables/pageid.html">$pageid</a>)) {
<a name="l178"><span class="linenum"> 178</span></a>  <span class="comment">    // make sure there are pages to view</span>
<a name="l179"><span class="linenum"> 179</span></a>      if (!<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_field')" href="../../_functions/get_field.html" onMouseOver="funcPopup(event,'get_field')">get_field</a>('lesson_pages', 'id', array('lessonid' =&gt; <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'prevpageid' =&gt; 0))) {
<a name="l180"><span class="linenum"> 180</span></a>          if (!<a class="var it1205" onMouseOver="hilite(1205)" onMouseOut="lolite()" onClick="logVariable('canmanage')" href="../../_variables/canmanage.html">$canmanage</a>) {
<a name="l181"><span class="linenum"> 181</span></a>              <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('add_message')" href="../../_functions/add_message.html" onMouseOver="funcPopup(event,'add_message')">add_message</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('lessonnotready2', 'lesson')); <span class="comment">// a nice message to the student</span>
<a name="l182"><span class="linenum"> 182</span></a>          } else {
<a name="l183"><span class="linenum"> 183</span></a>              if (!<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records')" href="../../_functions/count_records.html" onMouseOver="funcPopup(event,'count_records')">count_records</a>('lesson_pages', array('lessonid'=&gt;<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l184"><span class="linenum"> 184</span></a>                  <a class="function" onClick="logFunction('redirect')" href="../../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(&quot;<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>/mod/lesson/edit.php?id=<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>&quot;); <span class="comment">// no pages - redirect to add pages</span>
<a name="l185"><span class="linenum"> 185</span></a>              } else {
<a name="l186"><span class="linenum"> 186</span></a>                  <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('add_message')" href="../../_functions/add_message.html" onMouseOver="funcPopup(event,'add_message')">add_message</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('lessonpagelinkingbroken', 'lesson'));  <span class="comment">// ok, bad mojo</span>
<a name="l187"><span class="linenum"> 187</span></a>              }
<a name="l188"><span class="linenum"> 188</span></a>          }
<a name="l189"><span class="linenum"> 189</span></a>      }
<a name="l190"><span class="linenum"> 190</span></a>  
<a name="l191"><span class="linenum"> 191</span></a>  <span class="comment">    // if no pageid given see if the lesson has been started</span>
<a name="l192"><span class="linenum"> 192</span></a>      <a class="var it1229" onMouseOver="hilite(1229)" onMouseOut="lolite()" onClick="logVariable('retries')" href="../../_variables/retries.html">$retries</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records')" href="../../_functions/count_records.html" onMouseOver="funcPopup(event,'count_records')">count_records</a>('lesson_grades', array(&quot;lessonid&quot; =&gt; <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, &quot;userid&quot; =&gt; <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l193"><span class="linenum"> 193</span></a>      if (<a class="var it1229" onMouseOver="hilite(1229)" onMouseOut="lolite()" onClick="logVariable('retries')" href="../../_variables/retries.html">$retries</a> &gt; 0) {
<a name="l194"><span class="linenum"> 194</span></a>          <a class="var it1228" onMouseOver="hilite(1228)" onMouseOut="lolite()" onClick="logVariable('attemptflag')" href="../../_variables/attemptflag.html">$attemptflag</a> = true;
<a name="l195"><span class="linenum"> 195</span></a>      }
<a name="l196"><span class="linenum"> 196</span></a>  
<a name="l197"><span class="linenum"> 197</span></a>      if (isset(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('modattempts')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/modattempts.html">modattempts</a>[<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>])) {
<a name="l198"><span class="linenum"> 198</span></a>          unset(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('modattempts')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/modattempts.html">modattempts</a>[<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>]);  <span class="comment">// if no pageid, then student is NOT reviewing</span>
<a name="l199"><span class="linenum"> 199</span></a>      }
<a name="l200"><span class="linenum"> 200</span></a>  
<a name="l201"><span class="linenum"> 201</span></a>  <span class="comment">    // If there are any questions that have been answered correctly (or not) in this attempt.</span>
<a name="l202"><span class="linenum"> 202</span></a>      <a class="var it1231" onMouseOver="hilite(1231)" onMouseOut="lolite()" onClick="logVariable('allattempts')" href="../../_variables/allattempts.html">$allattempts</a> = <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('get_attempts')" href="../../_functions/get_attempts.html" onMouseOver="funcPopup(event,'get_attempts')">get_attempts</a>(<a class="var it1229" onMouseOver="hilite(1229)" onMouseOut="lolite()" onClick="logVariable('retries')" href="../../_variables/retries.html">$retries</a>);
<a name="l203"><span class="linenum"> 203</span></a>      if (!empty(<a class="var it1231" onMouseOver="hilite(1231)" onMouseOut="lolite()" onClick="logVariable('allattempts')" href="../../_variables/allattempts.html">$allattempts</a>)) {
<a name="l204"><span class="linenum"> 204</span></a>          <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a> = <a class="phpfunction" onClick="logFunction('end')" href="../../_functions/end.html" onMouseOver="phpfuncPopup(event,'end')">end</a>(<a class="var it1231" onMouseOver="hilite(1231)" onMouseOut="lolite()" onClick="logVariable('allattempts')" href="../../_variables/allattempts.html">$allattempts</a>);
<a name="l205"><span class="linenum"> 205</span></a>          <a class="var it1232" onMouseOver="hilite(1232)" onMouseOut="lolite()" onClick="logVariable('attemptpage')" href="../../_variables/attemptpage.html">$attemptpage</a> = <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('load_page')" href="../../_functions/load_page.html" onMouseOver="funcPopup(event,'load_page')">load_page</a>(<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('pageid')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/pageid.html">pageid</a>);
<a name="l206"><span class="linenum"> 206</span></a>          <a class="var it1233" onMouseOver="hilite(1233)" onMouseOut="lolite()" onClick="logVariable('jumpto')" href="../../_variables/jumpto.html">$jumpto</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_field')" href="../../_functions/get_field.html" onMouseOver="funcPopup(event,'get_field')">get_field</a>('lesson_answers', 'jumpto', array('id' =&gt; <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('answerid')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/answerid.html">answerid</a>));
<a name="l207"><span class="linenum"> 207</span></a>  <span class="comment">        // convert the jumpto to a proper page id</span>
<a name="l208"><span class="linenum"> 208</span></a>          if (<a class="var it1233" onMouseOver="hilite(1233)" onMouseOut="lolite()" onClick="logVariable('jumpto')" href="../../_variables/jumpto.html">$jumpto</a> == 0) {
<a name="l209"><span class="linenum"> 209</span></a>  <span class="comment">            // Check if a question has been incorrectly answered AND no more attempts at it are left.</span>
<a name="l210"><span class="linenum"> 210</span></a>              <a class="var it1235" onMouseOver="hilite(1235)" onMouseOut="lolite()" onClick="logVariable('nattempts')" href="../../_variables/nattempts.html">$nattempts</a> = <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('get_attempts')" href="../../_functions/get_attempts.html" onMouseOver="funcPopup(event,'get_attempts')">get_attempts</a>(<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('retry')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/retry.html">retry</a>, false, <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('pageid')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/pageid.html">pageid</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l211"><span class="linenum"> 211</span></a>              if (<a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it1235" onMouseOver="hilite(1235)" onMouseOut="lolite()" onClick="logVariable('nattempts')" href="../../_variables/nattempts.html">$nattempts</a>) &gt;= <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('maxattempts')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/maxattempts.html">maxattempts</a>) {
<a name="l212"><span class="linenum"> 212</span></a>                  <a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('lastpageseen')" href="../../_variables/lastpageseen.html">$lastpageseen</a> = <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('get_next_page')" href="../../_functions/get_next_page.html" onMouseOver="funcPopup(event,'get_next_page')">get_next_page</a>(<a class="var it1232" onMouseOver="hilite(1232)" onMouseOut="lolite()" onClick="logVariable('attemptpage')" href="../../_variables/attemptpage.html">$attemptpage</a>-&gt;<a onClick="logVariable('nextpageid')" class="var it44808" onMouseOver="hilite(44808)" onMouseOut="lolite()" href="../../_variables/nextpageid.html">nextpageid</a>);
<a name="l213"><span class="linenum"> 213</span></a>              } else {
<a name="l214"><span class="linenum"> 214</span></a>                  <a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('lastpageseen')" href="../../_variables/lastpageseen.html">$lastpageseen</a> = <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('pageid')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/pageid.html">pageid</a>;
<a name="l215"><span class="linenum"> 215</span></a>              }
<a name="l216"><span class="linenum"> 216</span></a>          } elseif (<a class="var it1233" onMouseOver="hilite(1233)" onMouseOut="lolite()" onClick="logVariable('jumpto')" href="../../_variables/jumpto.html">$jumpto</a> == <a class="constant" onClick="logConstant('LESSON_NEXTPAGE')" href="../../_constants/LESSON_NEXTPAGE.html" onMouseOver="constPopup(event,'LESSON_NEXTPAGE')">LESSON_NEXTPAGE</a>) {
<a name="l217"><span class="linenum"> 217</span></a>              <a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('lastpageseen')" href="../../_variables/lastpageseen.html">$lastpageseen</a> = <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('get_next_page')" href="../../_functions/get_next_page.html" onMouseOver="funcPopup(event,'get_next_page')">get_next_page</a>(<a class="var it1232" onMouseOver="hilite(1232)" onMouseOut="lolite()" onClick="logVariable('attemptpage')" href="../../_variables/attemptpage.html">$attemptpage</a>-&gt;<a onClick="logVariable('nextpageid')" class="var it44808" onMouseOver="hilite(44808)" onMouseOut="lolite()" href="../../_variables/nextpageid.html">nextpageid</a>);
<a name="l218"><span class="linenum"> 218</span></a>          } else if (<a class="var it1233" onMouseOver="hilite(1233)" onMouseOut="lolite()" onClick="logVariable('jumpto')" href="../../_variables/jumpto.html">$jumpto</a> == <a class="constant" onClick="logConstant('LESSON_CLUSTERJUMP')" href="../../_constants/LESSON_CLUSTERJUMP.html" onMouseOver="constPopup(event,'LESSON_CLUSTERJUMP')">LESSON_CLUSTERJUMP</a>) {
<a name="l219"><span class="linenum"> 219</span></a>              <a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('lastpageseen')" href="../../_variables/lastpageseen.html">$lastpageseen</a> = <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('cluster_jump')" href="../../_functions/cluster_jump.html" onMouseOver="funcPopup(event,'cluster_jump')">cluster_jump</a>(<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('pageid')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/pageid.html">pageid</a>);
<a name="l220"><span class="linenum"> 220</span></a>          } else {
<a name="l221"><span class="linenum"> 221</span></a>              <a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('lastpageseen')" href="../../_variables/lastpageseen.html">$lastpageseen</a> = <a class="var it1233" onMouseOver="hilite(1233)" onMouseOut="lolite()" onClick="logVariable('jumpto')" href="../../_variables/jumpto.html">$jumpto</a>;
<a name="l222"><span class="linenum"> 222</span></a>          }
<a name="l223"><span class="linenum"> 223</span></a>      }
<a name="l224"><span class="linenum"> 224</span></a>  
<a name="l225"><span class="linenum"> 225</span></a>      if (<a class="var it1240" onMouseOver="hilite(1240)" onMouseOut="lolite()" onClick="logVariable('branchtables')" href="../../_variables/branchtables.html">$branchtables</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('lesson_branch', array(&quot;lessonid&quot; =&gt; <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, &quot;userid&quot; =&gt; <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, &quot;retry&quot; =&gt; <a class="var it1229" onMouseOver="hilite(1229)" onMouseOut="lolite()" onClick="logVariable('retries')" href="../../_variables/retries.html">$retries</a>), 'timeseen DESC')) {
<a name="l226"><span class="linenum"> 226</span></a>  <span class="comment">        // in here, user has viewed a branch table</span>
<a name="l227"><span class="linenum"> 227</span></a>          <a class="var it1241" onMouseOver="hilite(1241)" onMouseOut="lolite()" onClick="logVariable('lastbranchtable')" href="../../_variables/lastbranchtable.html">$lastbranchtable</a> = <a class="phpfunction" onClick="logFunction('current')" href="../../_functions/current.html" onMouseOver="phpfuncPopup(event,'current')">current</a>(<a class="var it1240" onMouseOver="hilite(1240)" onMouseOut="lolite()" onClick="logVariable('branchtables')" href="../../_variables/branchtables.html">$branchtables</a>);
<a name="l228"><span class="linenum"> 228</span></a>          if (<a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it1231" onMouseOver="hilite(1231)" onMouseOut="lolite()" onClick="logVariable('allattempts')" href="../../_variables/allattempts.html">$allattempts</a>) &gt; 0) {
<a name="l229"><span class="linenum"> 229</span></a>              if (<a class="var it1241" onMouseOver="hilite(1241)" onMouseOut="lolite()" onClick="logVariable('lastbranchtable')" href="../../_variables/lastbranchtable.html">$lastbranchtable</a>-&gt;<a onClick="logVariable('timeseen')" class="var it44809" onMouseOver="hilite(44809)" onMouseOut="lolite()" href="../../_variables/timeseen.html">timeseen</a> &gt; <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('timeseen')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/timeseen.html">timeseen</a>) {
<a name="l230"><span class="linenum"> 230</span></a>  <span class="comment">                // This branch table was viewed more recently than the question page.</span>
<a name="l231"><span class="linenum"> 231</span></a>                  if (!empty(<a class="var it1241" onMouseOver="hilite(1241)" onMouseOut="lolite()" onClick="logVariable('lastbranchtable')" href="../../_variables/lastbranchtable.html">$lastbranchtable</a>-&gt;<a onClick="logVariable('nextpageid')" class="var it44809" onMouseOver="hilite(44809)" onMouseOut="lolite()" href="../../_variables/nextpageid.html">nextpageid</a>)) {
<a name="l232"><span class="linenum"> 232</span></a>                      <a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('lastpageseen')" href="../../_variables/lastpageseen.html">$lastpageseen</a> = <a class="var it1241" onMouseOver="hilite(1241)" onMouseOut="lolite()" onClick="logVariable('lastbranchtable')" href="../../_variables/lastbranchtable.html">$lastbranchtable</a>-&gt;<a onClick="logVariable('nextpageid')" class="var it44809" onMouseOver="hilite(44809)" onMouseOut="lolite()" href="../../_variables/nextpageid.html">nextpageid</a>;
<a name="l233"><span class="linenum"> 233</span></a>                  } else {
<a name="l234"><span class="linenum"> 234</span></a>  <span class="comment">                    // Next page ID did not exist prior to MDL-34006.</span>
<a name="l235"><span class="linenum"> 235</span></a>                      <a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('lastpageseen')" href="../../_variables/lastpageseen.html">$lastpageseen</a> = <a class="var it1241" onMouseOver="hilite(1241)" onMouseOut="lolite()" onClick="logVariable('lastbranchtable')" href="../../_variables/lastbranchtable.html">$lastbranchtable</a>-&gt;<a onClick="logVariable('pageid')" class="var it44809" onMouseOver="hilite(44809)" onMouseOut="lolite()" href="../../_variables/pageid.html">pageid</a>;
<a name="l236"><span class="linenum"> 236</span></a>                  }
<a name="l237"><span class="linenum"> 237</span></a>              }
<a name="l238"><span class="linenum"> 238</span></a>          } else {
<a name="l239"><span class="linenum"> 239</span></a>  <span class="comment">            // Has not answered any questions but has viewed a branch table.</span>
<a name="l240"><span class="linenum"> 240</span></a>              if (!empty(<a class="var it1241" onMouseOver="hilite(1241)" onMouseOut="lolite()" onClick="logVariable('lastbranchtable')" href="../../_variables/lastbranchtable.html">$lastbranchtable</a>-&gt;<a onClick="logVariable('nextpageid')" class="var it44809" onMouseOver="hilite(44809)" onMouseOut="lolite()" href="../../_variables/nextpageid.html">nextpageid</a>)) {
<a name="l241"><span class="linenum"> 241</span></a>                  <a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('lastpageseen')" href="../../_variables/lastpageseen.html">$lastpageseen</a> = <a class="var it1241" onMouseOver="hilite(1241)" onMouseOut="lolite()" onClick="logVariable('lastbranchtable')" href="../../_variables/lastbranchtable.html">$lastbranchtable</a>-&gt;<a onClick="logVariable('nextpageid')" class="var it44809" onMouseOver="hilite(44809)" onMouseOut="lolite()" href="../../_variables/nextpageid.html">nextpageid</a>;
<a name="l242"><span class="linenum"> 242</span></a>              } else {
<a name="l243"><span class="linenum"> 243</span></a>  <span class="comment">                // Next page ID did not exist prior to MDL-34006.</span>
<a name="l244"><span class="linenum"> 244</span></a>                  <a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('lastpageseen')" href="../../_variables/lastpageseen.html">$lastpageseen</a> = <a class="var it1241" onMouseOver="hilite(1241)" onMouseOut="lolite()" onClick="logVariable('lastbranchtable')" href="../../_variables/lastbranchtable.html">$lastbranchtable</a>-&gt;<a onClick="logVariable('pageid')" class="var it44809" onMouseOver="hilite(44809)" onMouseOut="lolite()" href="../../_variables/pageid.html">pageid</a>;
<a name="l245"><span class="linenum"> 245</span></a>              }
<a name="l246"><span class="linenum"> 246</span></a>          }
<a name="l247"><span class="linenum"> 247</span></a>      }
<a name="l248"><span class="linenum"> 248</span></a>  <span class="comment">    // Check to see if end of lesson was reached.</span>
<a name="l249"><span class="linenum"> 249</span></a>      if ((isset(<a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('lastpageseen')" href="../../_variables/lastpageseen.html">$lastpageseen</a>) &amp;&amp; (<a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('lastpageseen')" href="../../_variables/lastpageseen.html">$lastpageseen</a> != <a class="constant" onClick="logConstant('LESSON_EOL')" href="../../_constants/LESSON_EOL.html" onMouseOver="constPopup(event,'LESSON_EOL')">LESSON_EOL</a>))) {
<a name="l250"><span class="linenum"> 250</span></a>          if ((<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records')" href="../../_functions/count_records.html" onMouseOver="funcPopup(event,'count_records')">count_records</a>('lesson_attempts', array('lessonid' =&gt; <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'userid' =&gt; <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'retry' =&gt; <a class="var it1229" onMouseOver="hilite(1229)" onMouseOut="lolite()" onClick="logVariable('retries')" href="../../_variables/retries.html">$retries</a>)) &gt; 0)
<a name="l251"><span class="linenum"> 251</span></a>                  || <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records')" href="../../_functions/count_records.html" onMouseOver="funcPopup(event,'count_records')">count_records</a>('lesson_branch', array(&quot;lessonid&quot; =&gt; <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, &quot;userid&quot; =&gt; <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, &quot;retry&quot; =&gt; <a class="var it1229" onMouseOver="hilite(1229)" onMouseOut="lolite()" onClick="logVariable('retries')" href="../../_variables/retries.html">$retries</a>)) &gt; 0) {
<a name="l252"><span class="linenum"> 252</span></a>  
<a name="l253"><span class="linenum"> 253</span></a>              echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="phpfunction" onClick="logFunction('header')" href="../../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, '', false, null, <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('leftduringtimedsession', 'lesson'));
<a name="l254"><span class="linenum"> 254</span></a>              if (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('timelimit')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/timelimit.html">timelimit</a>) {
<a name="l255"><span class="linenum"> 255</span></a>                  if (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('retake')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/retake.html">retake</a>) {
<a name="l256"><span class="linenum"> 256</span></a>                      <a class="var it1244" onMouseOver="hilite(1244)" onMouseOut="lolite()" onClick="logVariable('continuelink')" href="../../_variables/continuelink.html">$continuelink</a> = <span class="keyword">new </span><a class="class" onClick="logClass('single_button')" href="../../_classes/single_button.html" onMouseOver="classPopup(event,'single_button')">single_button</a>(<span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../mod/lesson/view.php.html">/mod/lesson/view.php</a>',
<a name="l257"><span class="linenum"> 257</span></a>                              array('id' =&gt; <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'pageid' =&gt; <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('firstpageid')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/firstpageid.html">firstpageid</a>, 'startlastseen' =&gt; 'no')),
<a name="l258"><span class="linenum"> 258</span></a>                              <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('continue', 'lesson'), 'get');
<a name="l259"><span class="linenum"> 259</span></a>  
<a name="l260"><span class="linenum"> 260</span></a>                      echo <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('div')" href="../../_functions/div.html" onMouseOver="funcPopup(event,'div')">div</a>(<a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('message')" href="../../_functions/message.html" onMouseOver="funcPopup(event,'message')">message</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('leftduringtimed', 'lesson'), <a class="var it1244" onMouseOver="hilite(1244)" onMouseOut="lolite()" onClick="logVariable('continuelink')" href="../../_variables/continuelink.html">$continuelink</a>),
<a name="l261"><span class="linenum"> 261</span></a>                              'center leftduring');
<a name="l262"><span class="linenum"> 262</span></a>  
<a name="l263"><span class="linenum"> 263</span></a>                  } else {
<a name="l264"><span class="linenum"> 264</span></a>                      <a class="var it1246" onMouseOver="hilite(1246)" onMouseOut="lolite()" onClick="logVariable('courselink')" href="../../_variables/courselink.html">$courselink</a> = <span class="keyword">new </span><a class="class" onClick="logClass('single_button')" href="../../_classes/single_button.html" onMouseOver="classPopup(event,'single_button')">single_button</a>(<span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../course/view.php.html">/course/view.php</a>',
<a name="l265"><span class="linenum"> 265</span></a>                              array('id' =&gt; <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a onClick="logVariable('course')" class="var it42916" onMouseOver="hilite(42916)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>-&gt;id)), <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('returntocourse', 'lesson'), 'get');
<a name="l266"><span class="linenum"> 266</span></a>  
<a name="l267"><span class="linenum"> 267</span></a>                      echo <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('div')" href="../../_functions/div.html" onMouseOver="funcPopup(event,'div')">div</a>(<a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('message')" href="../../_functions/message.html" onMouseOver="funcPopup(event,'message')">message</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('leftduringtimednoretake', 'lesson'), <a class="var it1246" onMouseOver="hilite(1246)" onMouseOut="lolite()" onClick="logVariable('courselink')" href="../../_variables/courselink.html">$courselink</a>),
<a name="l268"><span class="linenum"> 268</span></a>                              'center leftduring');
<a name="l269"><span class="linenum"> 269</span></a>                  }
<a name="l270"><span class="linenum"> 270</span></a>              } else {
<a name="l271"><span class="linenum"> 271</span></a>                  echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('continue_links')" href="../../_functions/continue_links.html" onMouseOver="funcPopup(event,'continue_links')">continue_links</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>, <a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('lastpageseen')" href="../../_variables/lastpageseen.html">$lastpageseen</a>);
<a name="l272"><span class="linenum"> 272</span></a>              }
<a name="l273"><span class="linenum"> 273</span></a>              echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('footer')" href="../../_functions/footer.html" onMouseOver="funcPopup(event,'footer')">footer</a>();
<a name="l274"><span class="linenum"> 274</span></a>              exit();
<a name="l275"><span class="linenum"> 275</span></a>          }
<a name="l276"><span class="linenum"> 276</span></a>      }
<a name="l277"><span class="linenum"> 277</span></a>  
<a name="l278"><span class="linenum"> 278</span></a>      if (<a class="var it1228" onMouseOver="hilite(1228)" onMouseOut="lolite()" onClick="logVariable('attemptflag')" href="../../_variables/attemptflag.html">$attemptflag</a>) {
<a name="l279"><span class="linenum"> 279</span></a>          if (!<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('retake')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/retake.html">retake</a>) {
<a name="l280"><span class="linenum"> 280</span></a>              echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="phpfunction" onClick="logFunction('header')" href="../../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, 'view', '', null, <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;noretake&quot;, &quot;lesson&quot;));
<a name="l281"><span class="linenum"> 281</span></a>              <a class="var it1246" onMouseOver="hilite(1246)" onMouseOut="lolite()" onClick="logVariable('courselink')" href="../../_variables/courselink.html">$courselink</a> = <span class="keyword">new </span><a class="class" onClick="logClass('single_button')" href="../../_classes/single_button.html" onMouseOver="classPopup(event,'single_button')">single_button</a>(<span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../course/view.php.html">/course/view.php</a>', array('id'=&gt;<a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a onClick="logVariable('course')" class="var it42916" onMouseOver="hilite(42916)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>-&gt;id)), <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('returntocourse', 'lesson'), 'get');
<a name="l282"><span class="linenum"> 282</span></a>              echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('message')" href="../../_functions/message.html" onMouseOver="funcPopup(event,'message')">message</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;noretake&quot;, &quot;lesson&quot;), <a class="var it1246" onMouseOver="hilite(1246)" onMouseOut="lolite()" onClick="logVariable('courselink')" href="../../_variables/courselink.html">$courselink</a>);
<a name="l283"><span class="linenum"> 283</span></a>              echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('footer')" href="../../_functions/footer.html" onMouseOver="funcPopup(event,'footer')">footer</a>();
<a name="l284"><span class="linenum"> 284</span></a>              exit();
<a name="l285"><span class="linenum"> 285</span></a>          }
<a name="l286"><span class="linenum"> 286</span></a>      }
<a name="l287"><span class="linenum"> 287</span></a>  <span class="comment">    // start at the first page</span>
<a name="l288"><span class="linenum"> 288</span></a>      if (!<a class="var it987" onMouseOver="hilite(987)" onMouseOut="lolite()" onClick="logVariable('pageid')" href="../../_variables/pageid.html">$pageid</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_field')" href="../../_functions/get_field.html" onMouseOver="funcPopup(event,'get_field')">get_field</a>('lesson_pages', 'id', array('lessonid' =&gt; <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'prevpageid' =&gt; 0))) {
<a name="l289"><span class="linenum"> 289</span></a>          echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="phpfunction" onClick="logFunction('header')" href="../../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, 'view', '', null);
<a name="l290"><span class="linenum"> 290</span></a>  <span class="comment">        // Lesson currently has no content. A message for display has been prepared and will be displayed by the header method</span>
<a name="l291"><span class="linenum"> 291</span></a>  <span class="comment">        // of the lesson renderer.</span>
<a name="l292"><span class="linenum"> 292</span></a>          echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('footer')" href="../../_functions/footer.html" onMouseOver="funcPopup(event,'footer')">footer</a>();
<a name="l293"><span class="linenum"> 293</span></a>          exit();
<a name="l294"><span class="linenum"> 294</span></a>      }
<a name="l295"><span class="linenum"> 295</span></a>  <span class="comment">    /// This is the code for starting a timed test</span>
<a name="l296"><span class="linenum"> 296</span></a>      if(!isset(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('startlesson')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/startlesson.html">startlesson</a>[<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>]) &amp;&amp; !<a class="var it1205" onMouseOver="hilite(1205)" onMouseOut="lolite()" onClick="logVariable('canmanage')" href="../../_variables/canmanage.html">$canmanage</a>) {
<a name="l297"><span class="linenum"> 297</span></a>          <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('start_timer')" href="../../_functions/start_timer.html" onMouseOver="funcPopup(event,'start_timer')">start_timer</a>();
<a name="l298"><span class="linenum"> 298</span></a>      }
<a name="l299"><span class="linenum"> 299</span></a>  }
<a name="l300"><span class="linenum"> 300</span></a>  
<a name="l301"><span class="linenum"> 301</span></a>  <a class="var it1248" onMouseOver="hilite(1248)" onMouseOut="lolite()" onClick="logVariable('currenttab')" href="../../_variables/currenttab.html">$currenttab</a> = 'view';
<a name="l302"><span class="linenum"> 302</span></a>  <a class="var it1249" onMouseOver="hilite(1249)" onMouseOut="lolite()" onClick="logVariable('extraeditbuttons')" href="../../_variables/extraeditbuttons.html">$extraeditbuttons</a> = false;
<a name="l303"><span class="linenum"> 303</span></a>  <a class="var it1250" onMouseOver="hilite(1250)" onMouseOut="lolite()" onClick="logVariable('lessonpageid')" href="../../_variables/lessonpageid.html">$lessonpageid</a> = null;
<a name="l304"><span class="linenum"> 304</span></a>  <a class="var it1251" onMouseOver="hilite(1251)" onMouseOut="lolite()" onClick="logVariable('timer')" href="../../_variables/timer.html">$timer</a> = null;
<a name="l305"><span class="linenum"> 305</span></a>  
<a name="l306"><span class="linenum"> 306</span></a>  if (<a class="var it987" onMouseOver="hilite(987)" onMouseOut="lolite()" onClick="logVariable('pageid')" href="../../_variables/pageid.html">$pageid</a> != <a class="constant" onClick="logConstant('LESSON_EOL')" href="../../_constants/LESSON_EOL.html" onMouseOver="constPopup(event,'LESSON_EOL')">LESSON_EOL</a>) {
<a name="l307"><span class="linenum"> 307</span></a>  <span class="comment">    /// This is the code updates the lessontime for a timed test</span>
<a name="l308"><span class="linenum"> 308</span></a>      <a class="var it1252" onMouseOver="hilite(1252)" onMouseOut="lolite()" onClick="logVariable('startlastseen')" href="../../_variables/startlastseen.html">$startlastseen</a> = <a class="function" onClick="logFunction('optional_param')" href="../../_functions/optional_param.html" onMouseOver="funcPopup(event,'optional_param')">optional_param</a>('startlastseen', '', <a class="constant" onClick="logConstant('PARAM_ALPHA')" href="../../_constants/PARAM_ALPHA.html" onMouseOver="constPopup(event,'PARAM_ALPHA')">PARAM_ALPHA</a>);
<a name="l309"><span class="linenum"> 309</span></a>  
<a name="l310"><span class="linenum"> 310</span></a>      <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a> = <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('load_page')" href="../../_functions/load_page.html" onMouseOver="funcPopup(event,'load_page')">load_page</a>(<a class="var it987" onMouseOver="hilite(987)" onMouseOut="lolite()" onClick="logVariable('pageid')" href="../../_variables/pageid.html">$pageid</a>);
<a name="l311"><span class="linenum"> 311</span></a>  <span class="comment">    // Check if the page is of a special type and if so take any nessecary action</span>
<a name="l312"><span class="linenum"> 312</span></a>      <a class="var it1253" onMouseOver="hilite(1253)" onMouseOut="lolite()" onClick="logVariable('newpageid')" href="../../_variables/newpageid.html">$newpageid</a> = <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>-&gt;<a class="function" onClick="logFunction('callback_on_view')" href="../../_functions/callback_on_view.html" onMouseOver="funcPopup(event,'callback_on_view')">callback_on_view</a>(<a class="var it1205" onMouseOver="hilite(1205)" onMouseOut="lolite()" onClick="logVariable('canmanage')" href="../../_variables/canmanage.html">$canmanage</a>);
<a name="l313"><span class="linenum"> 313</span></a>      if (<a class="phpfunction" onClick="logFunction('is_numeric')" href="../../_functions/is_numeric.html" onMouseOver="phpfuncPopup(event,'is_numeric')">is_numeric</a>(<a class="var it1253" onMouseOver="hilite(1253)" onMouseOut="lolite()" onClick="logVariable('newpageid')" href="../../_variables/newpageid.html">$newpageid</a>)) {
<a name="l314"><span class="linenum"> 314</span></a>          <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a> = <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('load_page')" href="../../_functions/load_page.html" onMouseOver="funcPopup(event,'load_page')">load_page</a>(<a class="var it1253" onMouseOver="hilite(1253)" onMouseOut="lolite()" onClick="logVariable('newpageid')" href="../../_variables/newpageid.html">$newpageid</a>);
<a name="l315"><span class="linenum"> 315</span></a>      }
<a name="l316"><span class="linenum"> 316</span></a>  
<a name="l317"><span class="linenum"> 317</span></a>  <span class="comment">    // Trigger module viewed event.</span>
<a name="l318"><span class="linenum"> 318</span></a>      <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a> = \mod_lesson\event\<a class="class" onClick="logClass('course_module_viewed')" href="../../_classes/course_module_viewed.html" onMouseOver="classPopup(event,'course_module_viewed')">course_module_viewed</a>::<a class="function" onClick="logFunction('create')" href="../../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(array(
<a name="l319"><span class="linenum"> 319</span></a>          'objectid' =&gt; <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l320"><span class="linenum"> 320</span></a>          'context' =&gt; <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>
<a name="l321"><span class="linenum"> 321</span></a>      ));
<a name="l322"><span class="linenum"> 322</span></a>      <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('course_modules', <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>);
<a name="l323"><span class="linenum"> 323</span></a>      <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('course', <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>);
<a name="l324"><span class="linenum"> 324</span></a>      <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l325"><span class="linenum"> 325</span></a>  
<a name="l326"><span class="linenum"> 326</span></a>  <span class="comment">    // This is where several messages (usually warnings) are displayed</span>
<a name="l327"><span class="linenum"> 327</span></a>  <span class="comment">    // all of this is displayed above the actual page</span>
<a name="l328"><span class="linenum"> 328</span></a>  
<a name="l329"><span class="linenum"> 329</span></a>  <span class="comment">    // check to see if the user can see the left menu</span>
<a name="l330"><span class="linenum"> 330</span></a>      if (!<a class="var it1205" onMouseOver="hilite(1205)" onMouseOut="lolite()" onClick="logVariable('canmanage')" href="../../_variables/canmanage.html">$canmanage</a>) {
<a name="l331"><span class="linenum"> 331</span></a>          <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('displayleft')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/displayleft.html">displayleft</a> = <a class="function" onClick="logFunction('lesson_displayleftif')" href="../../_functions/lesson_displayleftif.html" onMouseOver="funcPopup(event,'lesson_displayleftif')">lesson_displayleftif</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>);
<a name="l332"><span class="linenum"> 332</span></a>  
<a name="l333"><span class="linenum"> 333</span></a>          <a class="var it392" onMouseOver="hilite(392)" onMouseOut="lolite()" onClick="logVariable('continue')" href="../../_variables/continue.html">$continue</a> = (<a class="var it1252" onMouseOver="hilite(1252)" onMouseOut="lolite()" onClick="logVariable('startlastseen')" href="../../_variables/startlastseen.html">$startlastseen</a> !== '');
<a name="l334"><span class="linenum"> 334</span></a>          <a class="var it1255" onMouseOver="hilite(1255)" onMouseOut="lolite()" onClick="logVariable('restart')" href="../../_variables/restart.html">$restart</a>  = (<a class="var it392" onMouseOver="hilite(392)" onMouseOut="lolite()" onClick="logVariable('continue')" href="../../_variables/continue.html">$continue</a> &amp;&amp; <a class="var it1252" onMouseOver="hilite(1252)" onMouseOut="lolite()" onClick="logVariable('startlastseen')" href="../../_variables/startlastseen.html">$startlastseen</a> == 'yes');
<a name="l335"><span class="linenum"> 335</span></a>          <a class="var it1251" onMouseOver="hilite(1251)" onMouseOut="lolite()" onClick="logVariable('timer')" href="../../_variables/timer.html">$timer</a> = <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('update_timer')" href="../../_functions/update_timer.html" onMouseOver="funcPopup(event,'update_timer')">update_timer</a>(<a class="var it392" onMouseOver="hilite(392)" onMouseOut="lolite()" onClick="logVariable('continue')" href="../../_variables/continue.html">$continue</a>, <a class="var it1255" onMouseOver="hilite(1255)" onMouseOut="lolite()" onClick="logVariable('restart')" href="../../_variables/restart.html">$restart</a>);
<a name="l336"><span class="linenum"> 336</span></a>  
<a name="l337"><span class="linenum"> 337</span></a>          if (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('timelimit')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/timelimit.html">timelimit</a>) {
<a name="l338"><span class="linenum"> 338</span></a>              <a class="var it1256" onMouseOver="hilite(1256)" onMouseOut="lolite()" onClick="logVariable('timeleft')" href="../../_variables/timeleft.html">$timeleft</a> = <a class="var it1251" onMouseOver="hilite(1251)" onMouseOut="lolite()" onClick="logVariable('timer')" href="../../_variables/timer.html">$timer</a>-&gt;<a onClick="logVariable('starttime')" class="var it44758" onMouseOver="hilite(44758)" onMouseOut="lolite()" href="../../_variables/starttime.html">starttime</a> + <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('timelimit')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/timelimit.html">timelimit</a> - <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l339"><span class="linenum"> 339</span></a>              if (<a class="var it1256" onMouseOver="hilite(1256)" onMouseOut="lolite()" onClick="logVariable('timeleft')" href="../../_variables/timeleft.html">$timeleft</a> &lt;= 0) {
<a name="l340"><span class="linenum"> 340</span></a>  <span class="comment">                // Out of time</span>
<a name="l341"><span class="linenum"> 341</span></a>                  <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('add_message')" href="../../_functions/add_message.html" onMouseOver="funcPopup(event,'add_message')">add_message</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('eolstudentoutoftime', 'lesson'));
<a name="l342"><span class="linenum"> 342</span></a>                  <a class="function" onClick="logFunction('redirect')" href="../../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../mod/lesson/view.php.html">/mod/lesson/view.php</a>', array('id'=&gt;<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,'pageid'=&gt;<a class="constant" onClick="logConstant('LESSON_EOL')" href="../../_constants/LESSON_EOL.html" onMouseOver="constPopup(event,'LESSON_EOL')">LESSON_EOL</a>, 'outoftime'=&gt;'normal')));
<a name="l343"><span class="linenum"> 343</span></a>                  die; <span class="comment">// Shouldn't be reached, but make sure</span>
<a name="l344"><span class="linenum"> 344</span></a>              } else if (<a class="var it1256" onMouseOver="hilite(1256)" onMouseOut="lolite()" onClick="logVariable('timeleft')" href="../../_variables/timeleft.html">$timeleft</a> &lt; 60) {
<a name="l345"><span class="linenum"> 345</span></a>  <span class="comment">                // One minute warning</span>
<a name="l346"><span class="linenum"> 346</span></a>                  <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('add_message')" href="../../_functions/add_message.html" onMouseOver="funcPopup(event,'add_message')">add_message</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('studentoneminwarning', 'lesson'));
<a name="l347"><span class="linenum"> 347</span></a>              }
<a name="l348"><span class="linenum"> 348</span></a>          }
<a name="l349"><span class="linenum"> 349</span></a>  
<a name="l350"><span class="linenum"> 350</span></a>          if (<a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>-&gt;<a onClick="logVariable('qtype')" class="var it42985" onMouseOver="hilite(42985)" onMouseOut="lolite()" href="../../_variables/qtype.html">qtype</a> == <a class="constant" onClick="logConstant('LESSON_PAGE_BRANCHTABLE')" href="../../_constants/LESSON_PAGE_BRANCHTABLE.html" onMouseOver="constPopup(event,'LESSON_PAGE_BRANCHTABLE')">LESSON_PAGE_BRANCHTABLE</a> &amp;&amp; <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('minquestions')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/minquestions.html">minquestions</a>) {
<a name="l351"><span class="linenum"> 351</span></a>  <span class="comment">            // tell student how many questions they have seen, how many are required and their grade</span>
<a name="l352"><span class="linenum"> 352</span></a>              <a class="var it1258" onMouseOver="hilite(1258)" onMouseOut="lolite()" onClick="logVariable('ntries')" href="../../_variables/ntries.html">$ntries</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records')" href="../../_functions/count_records.html" onMouseOver="funcPopup(event,'count_records')">count_records</a>(&quot;lesson_grades&quot;, array(&quot;lessonid&quot;=&gt;<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, &quot;userid&quot;=&gt;<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l353"><span class="linenum"> 353</span></a>              <a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a> = <a class="function" onClick="logFunction('lesson_grade')" href="../../_functions/lesson_grade.html" onMouseOver="funcPopup(event,'lesson_grade')">lesson_grade</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>, <a class="var it1258" onMouseOver="hilite(1258)" onMouseOut="lolite()" onClick="logVariable('ntries')" href="../../_variables/ntries.html">$ntries</a>);
<a name="l354"><span class="linenum"> 354</span></a>              if (<a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a>-&gt;<a onClick="logVariable('attempts')" class="var it44764" onMouseOver="hilite(44764)" onMouseOut="lolite()" href="../../_variables/attempts.html">attempts</a>) {
<a name="l355"><span class="linenum"> 355</span></a>                  if (<a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a>-&gt;<a onClick="logVariable('nquestions')" class="var it44764" onMouseOver="hilite(44764)" onMouseOut="lolite()" href="../../_variables/nquestions.html">nquestions</a> &lt; <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('minquestions')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/minquestions.html">minquestions</a>) {
<a name="l356"><span class="linenum"> 356</span></a>                      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a> = new stdClass;
<a name="l357"><span class="linenum"> 357</span></a>                      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('nquestions')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/nquestions.html">nquestions</a>   = <a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a>-&gt;<a onClick="logVariable('nquestions')" class="var it44764" onMouseOver="hilite(44764)" onMouseOut="lolite()" href="../../_variables/nquestions.html">nquestions</a>;
<a name="l358"><span class="linenum"> 358</span></a>                      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('minquestions')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/minquestions.html">minquestions</a> = <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('minquestions')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/minquestions.html">minquestions</a>;
<a name="l359"><span class="linenum"> 359</span></a>                      <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('add_message')" href="../../_functions/add_message.html" onMouseOver="funcPopup(event,'add_message')">add_message</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('numberofpagesviewednotice', 'lesson', <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>));
<a name="l360"><span class="linenum"> 360</span></a>                  }
<a name="l361"><span class="linenum"> 361</span></a>  
<a name="l362"><span class="linenum"> 362</span></a>                  if (!<a class="var it1207" onMouseOver="hilite(1207)" onMouseOut="lolite()" onClick="logVariable('reviewmode')" href="../../_variables/reviewmode.html">$reviewmode</a> &amp;&amp; !<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('retake')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/retake.html">retake</a>){
<a name="l363"><span class="linenum"> 363</span></a>                      <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('add_message')" href="../../_functions/add_message.html" onMouseOver="funcPopup(event,'add_message')">add_message</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;numberofcorrectanswers&quot;, &quot;lesson&quot;, <a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a>-&gt;<a onClick="logVariable('earned')" class="var it44764" onMouseOver="hilite(44764)" onMouseOut="lolite()" href="../../_variables/earned.html">earned</a>), 'notify');
<a name="l364"><span class="linenum"> 364</span></a>                      if (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('grade')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> != <a class="constant" onClick="logConstant('GRADE_TYPE_NONE')" href="../../_constants/GRADE_TYPE_NONE.html" onMouseOver="constPopup(event,'GRADE_TYPE_NONE')">GRADE_TYPE_NONE</a>) {
<a name="l365"><span class="linenum"> 365</span></a>                          <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a> = new stdClass;
<a name="l366"><span class="linenum"> 366</span></a>                          <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('grade')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> = <a class="phpfunction" onClick="logFunction('number_format')" href="../../_functions/number_format.html" onMouseOver="phpfuncPopup(event,'number_format')">number_format</a>(<a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a>-&gt;<a onClick="logVariable('grade')" class="var it44764" onMouseOver="hilite(44764)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> * <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('grade')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> / 100, 1);
<a name="l367"><span class="linenum"> 367</span></a>                          <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('total')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/total.html">total</a> = <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('grade')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a>;
<a name="l368"><span class="linenum"> 368</span></a>                          <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('add_message')" href="../../_functions/add_message.html" onMouseOver="funcPopup(event,'add_message')">add_message</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('yourcurrentgradeisoutof', 'lesson', <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>), 'notify');
<a name="l369"><span class="linenum"> 369</span></a>                      }
<a name="l370"><span class="linenum"> 370</span></a>                  }
<a name="l371"><span class="linenum"> 371</span></a>              }
<a name="l372"><span class="linenum"> 372</span></a>          }
<a name="l373"><span class="linenum"> 373</span></a>      } else {
<a name="l374"><span class="linenum"> 374</span></a>          <a class="var it1251" onMouseOver="hilite(1251)" onMouseOut="lolite()" onClick="logVariable('timer')" href="../../_variables/timer.html">$timer</a> = null;
<a name="l375"><span class="linenum"> 375</span></a>          if (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('timelimit')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/timelimit.html">timelimit</a>) {
<a name="l376"><span class="linenum"> 376</span></a>              <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('add_message')" href="../../_functions/add_message.html" onMouseOver="funcPopup(event,'add_message')">add_message</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('teachertimerwarning', 'lesson'));
<a name="l377"><span class="linenum"> 377</span></a>          }
<a name="l378"><span class="linenum"> 378</span></a>          if (<a class="function" onClick="logFunction('lesson_display_teacher_warning')" href="../../_functions/lesson_display_teacher_warning.html" onMouseOver="funcPopup(event,'lesson_display_teacher_warning')">lesson_display_teacher_warning</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>)) {
<a name="l379"><span class="linenum"> 379</span></a>  <span class="comment">            // This is the warning msg for teachers to inform them that cluster</span>
<a name="l380"><span class="linenum"> 380</span></a>  <span class="comment">            // and unseen does not work while logged in as a teacher</span>
<a name="l381"><span class="linenum"> 381</span></a>              <a class="var it1262" onMouseOver="hilite(1262)" onMouseOut="lolite()" onClick="logVariable('warningvars')" href="../../_variables/warningvars.html">$warningvars</a> = new stdClass();
<a name="l382"><span class="linenum"> 382</span></a>              <a class="var it1262" onMouseOver="hilite(1262)" onMouseOut="lolite()" onClick="logVariable('warningvars')" href="../../_variables/warningvars.html">$warningvars</a>-&gt;<a onClick="logVariable('cluster')" class="var it44759" onMouseOver="hilite(44759)" onMouseOut="lolite()" href="../../_variables/cluster.html">cluster</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('clusterjump', 'lesson');
<a name="l383"><span class="linenum"> 383</span></a>              <a class="var it1262" onMouseOver="hilite(1262)" onMouseOut="lolite()" onClick="logVariable('warningvars')" href="../../_variables/warningvars.html">$warningvars</a>-&gt;<a onClick="logVariable('unseen')" class="var it44759" onMouseOver="hilite(44759)" onMouseOut="lolite()" href="../../_variables/unseen.html">unseen</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('unseenpageinbranch', 'lesson');
<a name="l384"><span class="linenum"> 384</span></a>              <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('add_message')" href="../../_functions/add_message.html" onMouseOver="funcPopup(event,'add_message')">add_message</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('teacherjumpwarning', 'lesson', <a class="var it1262" onMouseOver="hilite(1262)" onMouseOut="lolite()" onClick="logVariable('warningvars')" href="../../_variables/warningvars.html">$warningvars</a>));
<a name="l385"><span class="linenum"> 385</span></a>          }
<a name="l386"><span class="linenum"> 386</span></a>      }
<a name="l387"><span class="linenum"> 387</span></a>  
<a name="l388"><span class="linenum"> 388</span></a>      <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('set_subpage')" href="../../_functions/set_subpage.html" onMouseOver="funcPopup(event,'set_subpage')">set_subpage</a>(<a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>-&gt;<a onClick="logVariable('id')" class="var it42985" onMouseOver="hilite(42985)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l389"><span class="linenum"> 389</span></a>      <a class="var it1248" onMouseOver="hilite(1248)" onMouseOut="lolite()" onClick="logVariable('currenttab')" href="../../_variables/currenttab.html">$currenttab</a> = 'view';
<a name="l390"><span class="linenum"> 390</span></a>      <a class="var it1249" onMouseOver="hilite(1249)" onMouseOut="lolite()" onClick="logVariable('extraeditbuttons')" href="../../_variables/extraeditbuttons.html">$extraeditbuttons</a> = true;
<a name="l391"><span class="linenum"> 391</span></a>      <a class="var it1250" onMouseOver="hilite(1250)" onMouseOut="lolite()" onClick="logVariable('lessonpageid')" href="../../_variables/lessonpageid.html">$lessonpageid</a> = <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>-&gt;<a onClick="logVariable('id')" class="var it42985" onMouseOver="hilite(42985)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l392"><span class="linenum"> 392</span></a>      <a class="var it1265" onMouseOver="hilite(1265)" onMouseOut="lolite()" onClick="logVariable('extrapagetitle')" href="../../_variables/extrapagetitle.html">$extrapagetitle</a> = <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>-&gt;<a onClick="logVariable('title')" class="var it42985" onMouseOver="hilite(42985)" onMouseOut="lolite()" href="../../_variables/title.html">title</a>;
<a name="l393"><span class="linenum"> 393</span></a>  
<a name="l394"><span class="linenum"> 394</span></a>      if ((<a class="var it417" onMouseOver="hilite(417)" onMouseOut="lolite()" onClick="logVariable('edit')" href="../../_variables/edit.html">$edit</a> != -1) &amp;&amp; <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('user_allowed_editing')" href="../../_functions/user_allowed_editing.html" onMouseOver="funcPopup(event,'user_allowed_editing')">user_allowed_editing</a>()) {
<a name="l395"><span class="linenum"> 395</span></a>          <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('editing')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/editing.html">editing</a> = <a class="var it417" onMouseOver="hilite(417)" onMouseOut="lolite()" onClick="logVariable('edit')" href="../../_variables/edit.html">$edit</a>;
<a name="l396"><span class="linenum"> 396</span></a>      }
<a name="l397"><span class="linenum"> 397</span></a>  
<a name="l398"><span class="linenum"> 398</span></a>      if (<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>-&gt;<a onClick="logVariable('answers')" class="var it42985" onMouseOver="hilite(42985)" onMouseOut="lolite()" href="../../_variables/answers.html">answers</a>) &amp;&amp; <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>-&gt;<a onClick="logVariable('answers')" class="var it42985" onMouseOver="hilite(42985)" onMouseOut="lolite()" href="../../_variables/answers.html">answers</a>)&gt;0) {
<a name="l399"><span class="linenum"> 399</span></a>  <span class="comment">        // this is for modattempts option.  Find the users previous answer to this page,</span>
<a name="l400"><span class="linenum"> 400</span></a>  <span class="comment">        //   and then display it below in answer processing</span>
<a name="l401"><span class="linenum"> 401</span></a>          if (isset(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('modattempts')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/modattempts.html">modattempts</a>[<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>])) {
<a name="l402"><span class="linenum"> 402</span></a>              <a class="var it1229" onMouseOver="hilite(1229)" onMouseOut="lolite()" onClick="logVariable('retries')" href="../../_variables/retries.html">$retries</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records')" href="../../_functions/count_records.html" onMouseOver="funcPopup(event,'count_records')">count_records</a>('lesson_grades', array(&quot;lessonid&quot;=&gt;<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, &quot;userid&quot;=&gt;<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l403"><span class="linenum"> 403</span></a>              if (!<a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a> = <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('get_attempts')" href="../../_functions/get_attempts.html" onMouseOver="funcPopup(event,'get_attempts')">get_attempts</a>(<a class="var it1229" onMouseOver="hilite(1229)" onMouseOut="lolite()" onClick="logVariable('retries')" href="../../_variables/retries.html">$retries</a>-1, false, <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>-&gt;<a onClick="logVariable('id')" class="var it42985" onMouseOver="hilite(42985)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>)) {
<a name="l404"><span class="linenum"> 404</span></a>                  <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('cannotfindpreattempt', 'lesson');
<a name="l405"><span class="linenum"> 405</span></a>              }
<a name="l406"><span class="linenum"> 406</span></a>              <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a> = <a class="phpfunction" onClick="logFunction('end')" href="../../_functions/end.html" onMouseOver="phpfuncPopup(event,'end')">end</a>(<a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a>);
<a name="l407"><span class="linenum"> 407</span></a>              <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('modattempts')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/modattempts.html">modattempts</a>[<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>] = <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>;
<a name="l408"><span class="linenum"> 408</span></a>          } else {
<a name="l409"><span class="linenum"> 409</span></a>              <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a> = false;
<a name="l410"><span class="linenum"> 410</span></a>          }
<a name="l411"><span class="linenum"> 411</span></a>          <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> = <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('display_page')" href="../../_functions/display_page.html" onMouseOver="funcPopup(event,'display_page')">display_page</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>, <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>, <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>);
<a name="l412"><span class="linenum"> 412</span></a>      } else {
<a name="l413"><span class="linenum"> 413</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a> = new stdClass;
<a name="l414"><span class="linenum"> 414</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('id')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a onClick="logVariable('cm')" class="var it42916" onMouseOver="hilite(42916)" onMouseOut="lolite()" href="../../_variables/cm.html">cm</a>-&gt;id;
<a name="l415"><span class="linenum"> 415</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('pageid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/pageid.html">pageid</a> = <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>-&gt;<a onClick="logVariable('id')" class="var it42985" onMouseOver="hilite(42985)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l416"><span class="linenum"> 416</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('newpageid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/newpageid.html">newpageid</a> = <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('get_next_page')" href="../../_functions/get_next_page.html" onMouseOver="funcPopup(event,'get_next_page')">get_next_page</a>(<a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>-&gt;<a onClick="logVariable('nextpageid')" class="var it42985" onMouseOver="hilite(42985)" onMouseOut="lolite()" href="../../_variables/nextpageid.html">nextpageid</a>);
<a name="l417"><span class="linenum"> 417</span></a>  
<a name="l418"><span class="linenum"> 418</span></a>          <a class="var it436" onMouseOver="hilite(436)" onMouseOut="lolite()" onClick="logVariable('customdata')" href="../../_variables/customdata.html">$customdata</a> = array(
<a name="l419"><span class="linenum"> 419</span></a>              'title'     =&gt; <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>-&gt;<a onClick="logVariable('title')" class="var it42985" onMouseOver="hilite(42985)" onMouseOut="lolite()" href="../../_variables/title.html">title</a>,
<a name="l420"><span class="linenum"> 420</span></a>              'contents'  =&gt; <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>-&gt;<a class="function" onClick="logFunction('get_contents')" href="../../_functions/get_contents.html" onMouseOver="funcPopup(event,'get_contents')">get_contents</a>()
<a name="l421"><span class="linenum"> 421</span></a>          );
<a name="l422"><span class="linenum"> 422</span></a>          <a class="var it219" onMouseOver="hilite(219)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../../_variables/mform.html">$mform</a> = <span class="keyword">new </span><a class="class" onClick="logClass('lesson_page_without_answers')" href="../../_classes/lesson_page_without_answers.html" onMouseOver="classPopup(event,'lesson_page_without_answers')">lesson_page_without_answers</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>.'<a class="filename" href="../../mod/lesson/continue.php.html">/mod/lesson/continue.php</a>', <a class="var it436" onMouseOver="hilite(436)" onMouseOut="lolite()" onClick="logVariable('customdata')" href="../../_variables/customdata.html">$customdata</a>);
<a name="l423"><span class="linenum"> 423</span></a>          <a class="var it219" onMouseOver="hilite(219)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../../_variables/mform.html">$mform</a>-&gt;<a class="function" onClick="logFunction('set_data')" href="../../_functions/set_data.html" onMouseOver="funcPopup(event,'set_data')">set_data</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>);
<a name="l424"><span class="linenum"> 424</span></a>          <a class="phpfunction" onClick="logFunction('ob_start')" href="../../_functions/ob_start.html" onMouseOver="phpfuncPopup(event,'ob_start')">ob_start</a>();
<a name="l425"><span class="linenum"> 425</span></a>          <a class="var it219" onMouseOver="hilite(219)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../../_variables/mform.html">$mform</a>-&gt;<a class="function" onClick="logFunction('display')" href="../../_functions/display.html" onMouseOver="funcPopup(event,'display')">display</a>();
<a name="l426"><span class="linenum"> 426</span></a>          <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> = <a class="phpfunction" onClick="logFunction('ob_get_contents')" href="../../_functions/ob_get_contents.html" onMouseOver="phpfuncPopup(event,'ob_get_contents')">ob_get_contents</a>();
<a name="l427"><span class="linenum"> 427</span></a>          <a class="phpfunction" onClick="logFunction('ob_end_clean')" href="../../_functions/ob_end_clean.html" onMouseOver="phpfuncPopup(event,'ob_end_clean')">ob_end_clean</a>();
<a name="l428"><span class="linenum"> 428</span></a>      }
<a name="l429"><span class="linenum"> 429</span></a>  
<a name="l430"><span class="linenum"> 430</span></a>      <a class="function" onClick="logFunction('lesson_add_fake_blocks')" href="../../_functions/lesson_add_fake_blocks.html" onMouseOver="funcPopup(event,'lesson_add_fake_blocks')">lesson_add_fake_blocks</a>(<a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>, <a class="var it1251" onMouseOver="hilite(1251)" onMouseOut="lolite()" onClick="logVariable('timer')" href="../../_variables/timer.html">$timer</a>);
<a name="l431"><span class="linenum"> 431</span></a>      echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="phpfunction" onClick="logFunction('header')" href="../../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="var it1248" onMouseOver="hilite(1248)" onMouseOut="lolite()" onClick="logVariable('currenttab')" href="../../_variables/currenttab.html">$currenttab</a>, <a class="var it1249" onMouseOver="hilite(1249)" onMouseOut="lolite()" onClick="logVariable('extraeditbuttons')" href="../../_variables/extraeditbuttons.html">$extraeditbuttons</a>, <a class="var it1250" onMouseOver="hilite(1250)" onMouseOut="lolite()" onClick="logVariable('lessonpageid')" href="../../_variables/lessonpageid.html">$lessonpageid</a>, <a class="var it1265" onMouseOver="hilite(1265)" onMouseOut="lolite()" onClick="logVariable('extrapagetitle')" href="../../_variables/extrapagetitle.html">$extrapagetitle</a>);
<a name="l432"><span class="linenum"> 432</span></a>      if (<a class="var it1228" onMouseOver="hilite(1228)" onMouseOut="lolite()" onClick="logVariable('attemptflag')" href="../../_variables/attemptflag.html">$attemptflag</a>) {
<a name="l433"><span class="linenum"> 433</span></a>  <span class="comment">        // We are using level 3 header because attempt heading is a sub-heading of lesson title (MDL-30911).</span>
<a name="l434"><span class="linenum"> 434</span></a>          echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('heading')" href="../../_functions/heading.html" onMouseOver="funcPopup(event,'heading')">heading</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('attempt', 'lesson', <a class="var it1229" onMouseOver="hilite(1229)" onMouseOut="lolite()" onClick="logVariable('retries')" href="../../_variables/retries.html">$retries</a>), 3);
<a name="l435"><span class="linenum"> 435</span></a>      }
<a name="l436"><span class="linenum"> 436</span></a>  <span class="comment">    /// This calculates and prints the ongoing score</span>
<a name="l437"><span class="linenum"> 437</span></a>      if (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('ongoing')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/ongoing.html">ongoing</a> &amp;&amp; !empty(<a class="var it987" onMouseOver="hilite(987)" onMouseOut="lolite()" onClick="logVariable('pageid')" href="../../_variables/pageid.html">$pageid</a>) &amp;&amp; !<a class="var it1207" onMouseOver="hilite(1207)" onMouseOut="lolite()" onClick="logVariable('reviewmode')" href="../../_variables/reviewmode.html">$reviewmode</a>) {
<a name="l438"><span class="linenum"> 438</span></a>          echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('ongoing_score')" href="../../_functions/ongoing_score.html" onMouseOver="funcPopup(event,'ongoing_score')">ongoing_score</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>);
<a name="l439"><span class="linenum"> 439</span></a>      }
<a name="l440"><span class="linenum"> 440</span></a>      if (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('displayleft')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/displayleft.html">displayleft</a>) {
<a name="l441"><span class="linenum"> 441</span></a>          echo '&lt;a name=&quot;maincontent&quot; id=&quot;maincontent&quot; title=&quot;' . <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('anchortitle', 'lesson') . '&quot;&gt;&lt;/a&gt;';
<a name="l442"><span class="linenum"> 442</span></a>      }
<a name="l443"><span class="linenum"> 443</span></a>      echo <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a>;
<a name="l444"><span class="linenum"> 444</span></a>      echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('progress_bar')" href="../../_functions/progress_bar.html" onMouseOver="funcPopup(event,'progress_bar')">progress_bar</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>);
<a name="l445"><span class="linenum"> 445</span></a>      echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('footer')" href="../../_functions/footer.html" onMouseOver="funcPopup(event,'footer')">footer</a>();
<a name="l446"><span class="linenum"> 446</span></a>  
<a name="l447"><span class="linenum"> 447</span></a>  } else {
<a name="l448"><span class="linenum"> 448</span></a>  
<a name="l449"><span class="linenum"> 449</span></a>      <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> = '';
<a name="l450"><span class="linenum"> 450</span></a>  <span class="comment">    // end of lesson reached work out grade</span>
<a name="l451"><span class="linenum"> 451</span></a>  <span class="comment">    // Used to check to see if the student ran out of time</span>
<a name="l452"><span class="linenum"> 452</span></a>      <a class="var it1269" onMouseOver="hilite(1269)" onMouseOut="lolite()" onClick="logVariable('outoftime')" href="../../_variables/outoftime.html">$outoftime</a> = <a class="function" onClick="logFunction('optional_param')" href="../../_functions/optional_param.html" onMouseOver="funcPopup(event,'optional_param')">optional_param</a>('outoftime', '', <a class="constant" onClick="logConstant('PARAM_ALPHA')" href="../../_constants/PARAM_ALPHA.html" onMouseOver="constPopup(event,'PARAM_ALPHA')">PARAM_ALPHA</a>);
<a name="l453"><span class="linenum"> 453</span></a>  
<a name="l454"><span class="linenum"> 454</span></a>      <a class="var it1258" onMouseOver="hilite(1258)" onMouseOut="lolite()" onClick="logVariable('ntries')" href="../../_variables/ntries.html">$ntries</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records')" href="../../_functions/count_records.html" onMouseOver="funcPopup(event,'count_records')">count_records</a>(&quot;lesson_grades&quot;, array(&quot;lessonid&quot;=&gt;<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, &quot;userid&quot;=&gt;<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l455"><span class="linenum"> 455</span></a>      if (isset(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('modattempts')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/modattempts.html">modattempts</a>[<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>])) {
<a name="l456"><span class="linenum"> 456</span></a>          <a class="var it1258" onMouseOver="hilite(1258)" onMouseOut="lolite()" onClick="logVariable('ntries')" href="../../_variables/ntries.html">$ntries</a>--;  <span class="comment">// need to look at the old attempts :)</span>
<a name="l457"><span class="linenum"> 457</span></a>      }
<a name="l458"><span class="linenum"> 458</span></a>      <a class="var it1270" onMouseOver="hilite(1270)" onMouseOut="lolite()" onClick="logVariable('gradelesson')" href="../../_variables/gradelesson.html">$gradelesson</a> = true;
<a name="l459"><span class="linenum"> 459</span></a>      <a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a> = <a class="function" onClick="logFunction('lesson_grade')" href="../../_functions/lesson_grade.html" onMouseOver="funcPopup(event,'lesson_grade')">lesson_grade</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>, <a class="var it1258" onMouseOver="hilite(1258)" onMouseOut="lolite()" onClick="logVariable('ntries')" href="../../_variables/ntries.html">$ntries</a>);
<a name="l460"><span class="linenum"> 460</span></a>      if (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('custom')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/custom.html">custom</a> &amp;&amp; !<a class="var it1205" onMouseOver="hilite(1205)" onMouseOut="lolite()" onClick="logVariable('canmanage')" href="../../_variables/canmanage.html">$canmanage</a>) {
<a name="l461"><span class="linenum"> 461</span></a>  <span class="comment">        // Before we calculate the custom score make sure they answered the minimum</span>
<a name="l462"><span class="linenum"> 462</span></a>  <span class="comment">        // number of questions. We only need to do this for custom scoring as we can</span>
<a name="l463"><span class="linenum"> 463</span></a>  <span class="comment">        // not get the miniumum score the user should achieve. If we are not using</span>
<a name="l464"><span class="linenum"> 464</span></a>  <span class="comment">        // custom scoring (so all questions are valued as 1) then we simply check if</span>
<a name="l465"><span class="linenum"> 465</span></a>  <span class="comment">        // they answered more than the minimum questions, if not, we mark it out of the</span>
<a name="l466"><span class="linenum"> 466</span></a>  <span class="comment">        // number specified in the minimum questions setting - which is done in lesson_grade().</span>
<a name="l467"><span class="linenum"> 467</span></a>  <span class="comment">        // Get the number of answers given.</span>
<a name="l468"><span class="linenum"> 468</span></a>          if (<a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a>-&gt;<a onClick="logVariable('nquestions')" class="var it44764" onMouseOver="hilite(44764)" onMouseOut="lolite()" href="../../_variables/nquestions.html">nquestions</a> &lt; <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('minquestions')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/minquestions.html">minquestions</a>) {
<a name="l469"><span class="linenum"> 469</span></a>              <a class="var it1270" onMouseOver="hilite(1270)" onMouseOut="lolite()" onClick="logVariable('gradelesson')" href="../../_variables/gradelesson.html">$gradelesson</a> = false;
<a name="l470"><span class="linenum"> 470</span></a>              <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a> = new stdClass;
<a name="l471"><span class="linenum"> 471</span></a>              <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('nquestions')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/nquestions.html">nquestions</a> = <a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a>-&gt;<a onClick="logVariable('nquestions')" class="var it44764" onMouseOver="hilite(44764)" onMouseOut="lolite()" href="../../_variables/nquestions.html">nquestions</a>;
<a name="l472"><span class="linenum"> 472</span></a>              <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('minquestions')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/minquestions.html">minquestions</a> = <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('minquestions')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/minquestions.html">minquestions</a>;
<a name="l473"><span class="linenum"> 473</span></a>              <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> .= <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box_start')" href="../../_functions/box_start.html" onMouseOver="funcPopup(event,'box_start')">box_start</a>('generalbox boxaligncenter');
<a name="l474"><span class="linenum"> 474</span></a>              <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('add_message')" href="../../_functions/add_message.html" onMouseOver="funcPopup(event,'add_message')">add_message</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('numberofpagesviewednotice', 'lesson', <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>));
<a name="l475"><span class="linenum"> 475</span></a>          }
<a name="l476"><span class="linenum"> 476</span></a>      }
<a name="l477"><span class="linenum"> 477</span></a>      if (<a class="var it1270" onMouseOver="hilite(1270)" onMouseOut="lolite()" onClick="logVariable('gradelesson')" href="../../_variables/gradelesson.html">$gradelesson</a>) {
<a name="l478"><span class="linenum"> 478</span></a>  <span class="comment">        // We are using level 3 header because the page title is a sub-heading of lesson title (MDL-30911).</span>
<a name="l479"><span class="linenum"> 479</span></a>          <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> .= <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('heading')" href="../../_functions/heading.html" onMouseOver="funcPopup(event,'heading')">heading</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;congratulations&quot;, &quot;lesson&quot;), 3);
<a name="l480"><span class="linenum"> 480</span></a>          <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> .= <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box_start')" href="../../_functions/box_start.html" onMouseOver="funcPopup(event,'box_start')">box_start</a>('generalbox boxaligncenter');
<a name="l481"><span class="linenum"> 481</span></a>      }
<a name="l482"><span class="linenum"> 482</span></a>      if (!<a class="var it1205" onMouseOver="hilite(1205)" onMouseOut="lolite()" onClick="logVariable('canmanage')" href="../../_variables/canmanage.html">$canmanage</a>) {
<a name="l483"><span class="linenum"> 483</span></a>          if (<a class="var it1270" onMouseOver="hilite(1270)" onMouseOut="lolite()" onClick="logVariable('gradelesson')" href="../../_variables/gradelesson.html">$gradelesson</a>) {
<a name="l484"><span class="linenum"> 484</span></a>  <span class="comment">            // Store this now before any modifications to pages viewed.</span>
<a name="l485"><span class="linenum"> 485</span></a>              <a class="var it1272" onMouseOver="hilite(1272)" onMouseOut="lolite()" onClick="logVariable('progressbar')" href="../../_variables/progressbar.html">$progressbar</a> = <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('progress_bar')" href="../../_functions/progress_bar.html" onMouseOver="funcPopup(event,'progress_bar')">progress_bar</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>);
<a name="l486"><span class="linenum"> 486</span></a>  <span class="comment">            // Update the clock / get time information for this user.</span>
<a name="l487"><span class="linenum"> 487</span></a>              <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('stop_timer')" href="../../_functions/stop_timer.html" onMouseOver="funcPopup(event,'stop_timer')">stop_timer</a>();
<a name="l488"><span class="linenum"> 488</span></a>  
<a name="l489"><span class="linenum"> 489</span></a>  <span class="comment">            // Update completion state.</span>
<a name="l490"><span class="linenum"> 490</span></a>              <a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a> = <span class="keyword">new </span><a class="class" onClick="logClass('completion_info')" href="../../_classes/completion_info.html" onMouseOver="classPopup(event,'completion_info')">completion_info</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>);
<a name="l491"><span class="linenum"> 491</span></a>              if (<a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a>-&gt;<a class="function" onClick="logFunction('is_enabled')" href="../../_functions/is_enabled.html" onMouseOver="funcPopup(event,'is_enabled')">is_enabled</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>) &amp;&amp; <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('completionendreached')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/completionendreached.html">completionendreached</a>) {
<a name="l492"><span class="linenum"> 492</span></a>                  <a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a>-&gt;<a class="function" onClick="logFunction('update_state')" href="../../_functions/update_state.html" onMouseOver="funcPopup(event,'update_state')">update_state</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="constant" onClick="logConstant('COMPLETION_COMPLETE')" href="../../_constants/COMPLETION_COMPLETE.html" onMouseOver="constPopup(event,'COMPLETION_COMPLETE')">COMPLETION_COMPLETE</a>);
<a name="l493"><span class="linenum"> 493</span></a>              }
<a name="l494"><span class="linenum"> 494</span></a>  
<a name="l495"><span class="linenum"> 495</span></a>              if (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('completiontimespent')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/completiontimespent.html">completiontimespent</a> &gt; 0) {
<a name="l496"><span class="linenum"> 496</span></a>                  <a class="var it1221" onMouseOver="hilite(1221)" onMouseOut="lolite()" onClick="logVariable('duration')" href="../../_variables/duration.html">$duration</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_field_sql')" href="../../_functions/get_field_sql.html" onMouseOver="funcPopup(event,'get_field_sql')">get_field_sql</a>(
<a name="l497"><span class="linenum"> 497</span></a>                      &quot;SELECT <a class="function" onClick="logFunction('SUM')" href="../../_functions/sum.html" onMouseOver="funcPopup(event,'sum')">SUM</a>(lessontime - starttime)
<a name="l498"><span class="linenum"> 498</span></a>                                     FROM {lesson_timer}
<a name="l499"><span class="linenum"> 499</span></a>                                    WHERE lessonid = :lessonid
<a name="l500"><span class="linenum"> 500</span></a>                                      AND userid = :userid&quot;,
<a name="l501"><span class="linenum"> 501</span></a>                      array('userid' =&gt; <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'lessonid' =&gt; <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l502"><span class="linenum"> 502</span></a>                  if (!<a class="var it1221" onMouseOver="hilite(1221)" onMouseOut="lolite()" onClick="logVariable('duration')" href="../../_variables/duration.html">$duration</a>) {
<a name="l503"><span class="linenum"> 503</span></a>                      <a class="var it1221" onMouseOver="hilite(1221)" onMouseOut="lolite()" onClick="logVariable('duration')" href="../../_variables/duration.html">$duration</a> = 0;
<a name="l504"><span class="linenum"> 504</span></a>                  }
<a name="l505"><span class="linenum"> 505</span></a>  
<a name="l506"><span class="linenum"> 506</span></a>  <span class="comment">                // If student has not spend enough time in the lesson, display a message.</span>
<a name="l507"><span class="linenum"> 507</span></a>                  if (<a class="var it1221" onMouseOver="hilite(1221)" onMouseOut="lolite()" onClick="logVariable('duration')" href="../../_variables/duration.html">$duration</a> &lt; <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('completiontimespent')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/completiontimespent.html">completiontimespent</a>) {
<a name="l508"><span class="linenum"> 508</span></a>                      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a> = new stdClass;
<a name="l509"><span class="linenum"> 509</span></a>                      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('timespent')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/timespent.html">timespent</a> = <a class="function" onClick="logFunction('format_time')" href="../../_functions/format_time.html" onMouseOver="funcPopup(event,'format_time')">format_time</a>(<a class="var it1221" onMouseOver="hilite(1221)" onMouseOut="lolite()" onClick="logVariable('duration')" href="../../_variables/duration.html">$duration</a>);
<a name="l510"><span class="linenum"> 510</span></a>                      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('timerequired')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/timerequired.html">timerequired</a> = <a class="function" onClick="logFunction('format_time')" href="../../_functions/format_time.html" onMouseOver="funcPopup(event,'format_time')">format_time</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('completiontimespent')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/completiontimespent.html">completiontimespent</a>);
<a name="l511"><span class="linenum"> 511</span></a>                      <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> .= <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('paragraph')" href="../../_functions/paragraph.html" onMouseOver="funcPopup(event,'paragraph')">paragraph</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;notenoughtimespent&quot;, &quot;lesson&quot;, <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>), 'center');
<a name="l512"><span class="linenum"> 512</span></a>                  }
<a name="l513"><span class="linenum"> 513</span></a>              }
<a name="l514"><span class="linenum"> 514</span></a>  
<a name="l515"><span class="linenum"> 515</span></a>  
<a name="l516"><span class="linenum"> 516</span></a>              if (<a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a>-&gt;<a onClick="logVariable('attempts')" class="var it44764" onMouseOver="hilite(44764)" onMouseOut="lolite()" href="../../_variables/attempts.html">attempts</a>) {
<a name="l517"><span class="linenum"> 517</span></a>                  if (!<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('custom')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/custom.html">custom</a>) {
<a name="l518"><span class="linenum"> 518</span></a>                      <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> .= <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('paragraph')" href="../../_functions/paragraph.html" onMouseOver="funcPopup(event,'paragraph')">paragraph</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;numberofpagesviewed&quot;, &quot;lesson&quot;, <a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a>-&gt;<a onClick="logVariable('nquestions')" class="var it44764" onMouseOver="hilite(44764)" onMouseOut="lolite()" href="../../_variables/nquestions.html">nquestions</a>), 'center');
<a name="l519"><span class="linenum"> 519</span></a>                      if (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('minquestions')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/minquestions.html">minquestions</a>) {
<a name="l520"><span class="linenum"> 520</span></a>                          if (<a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a>-&gt;<a onClick="logVariable('nquestions')" class="var it44764" onMouseOver="hilite(44764)" onMouseOut="lolite()" href="../../_variables/nquestions.html">nquestions</a> &lt; <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('minquestions')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/minquestions.html">minquestions</a>) {
<a name="l521"><span class="linenum"> 521</span></a>  <span class="comment">                            // print a warning and set nviewed to minquestions</span>
<a name="l522"><span class="linenum"> 522</span></a>                              <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> .= <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('paragraph')" href="../../_functions/paragraph.html" onMouseOver="funcPopup(event,'paragraph')">paragraph</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;youshouldview&quot;, &quot;lesson&quot;, <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('minquestions')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/minquestions.html">minquestions</a>), 'center');
<a name="l523"><span class="linenum"> 523</span></a>                          }
<a name="l524"><span class="linenum"> 524</span></a>                      }
<a name="l525"><span class="linenum"> 525</span></a>                      <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> .= <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('paragraph')" href="../../_functions/paragraph.html" onMouseOver="funcPopup(event,'paragraph')">paragraph</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;numberofcorrectanswers&quot;, &quot;lesson&quot;, <a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a>-&gt;<a onClick="logVariable('earned')" class="var it44764" onMouseOver="hilite(44764)" onMouseOut="lolite()" href="../../_variables/earned.html">earned</a>), 'center');
<a name="l526"><span class="linenum"> 526</span></a>                  }
<a name="l527"><span class="linenum"> 527</span></a>                  <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a> = new stdClass;
<a name="l528"><span class="linenum"> 528</span></a>                  <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('score')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/score.html">score</a> = <a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a>-&gt;<a onClick="logVariable('earned')" class="var it44764" onMouseOver="hilite(44764)" onMouseOut="lolite()" href="../../_variables/earned.html">earned</a>;
<a name="l529"><span class="linenum"> 529</span></a>                  <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('grade')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> = <a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a>-&gt;<a onClick="logVariable('total')" class="var it44764" onMouseOver="hilite(44764)" onMouseOut="lolite()" href="../../_variables/total.html">total</a>;
<a name="l530"><span class="linenum"> 530</span></a>                  if (<a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a>-&gt;<a onClick="logVariable('nmanual')" class="var it44764" onMouseOver="hilite(44764)" onMouseOut="lolite()" href="../../_variables/nmanual.html">nmanual</a>) {
<a name="l531"><span class="linenum"> 531</span></a>                      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('tempmaxgrade')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/tempmaxgrade.html">tempmaxgrade</a> = <a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a>-&gt;<a onClick="logVariable('total')" class="var it44764" onMouseOver="hilite(44764)" onMouseOut="lolite()" href="../../_variables/total.html">total</a> - <a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a>-&gt;<a onClick="logVariable('manualpoints')" class="var it44764" onMouseOver="hilite(44764)" onMouseOut="lolite()" href="../../_variables/manualpoints.html">manualpoints</a>;
<a name="l532"><span class="linenum"> 532</span></a>                      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('essayquestions')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/essayquestions.html">essayquestions</a> = <a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a>-&gt;<a onClick="logVariable('nmanual')" class="var it44764" onMouseOver="hilite(44764)" onMouseOut="lolite()" href="../../_variables/nmanual.html">nmanual</a>;
<a name="l533"><span class="linenum"> 533</span></a>                      <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> .= <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box')" href="../../_functions/box.html" onMouseOver="funcPopup(event,'box')">box</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;displayscorewithessays&quot;, &quot;lesson&quot;, <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>), 'center');
<a name="l534"><span class="linenum"> 534</span></a>                  } else {
<a name="l535"><span class="linenum"> 535</span></a>                      <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> .= <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box')" href="../../_functions/box.html" onMouseOver="funcPopup(event,'box')">box</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;displayscorewithoutessays&quot;, &quot;lesson&quot;, <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>), 'center');
<a name="l536"><span class="linenum"> 536</span></a>                  }
<a name="l537"><span class="linenum"> 537</span></a>                  if (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('grade')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> != <a class="constant" onClick="logConstant('GRADE_TYPE_NONE')" href="../../_constants/GRADE_TYPE_NONE.html" onMouseOver="constPopup(event,'GRADE_TYPE_NONE')">GRADE_TYPE_NONE</a>) {
<a name="l538"><span class="linenum"> 538</span></a>                      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a> = new stdClass;
<a name="l539"><span class="linenum"> 539</span></a>                      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('grade')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> = <a class="phpfunction" onClick="logFunction('number_format')" href="../../_functions/number_format.html" onMouseOver="phpfuncPopup(event,'number_format')">number_format</a>(<a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a>-&gt;<a onClick="logVariable('grade')" class="var it44764" onMouseOver="hilite(44764)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> * <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('grade')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> / 100, 1);
<a name="l540"><span class="linenum"> 540</span></a>                      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('total')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/total.html">total</a> = <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('grade')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a>;
<a name="l541"><span class="linenum"> 541</span></a>                      <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> .= <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('paragraph')" href="../../_functions/paragraph.html" onMouseOver="funcPopup(event,'paragraph')">paragraph</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;yourcurrentgradeisoutof&quot;, &quot;lesson&quot;, <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>), 'center');
<a name="l542"><span class="linenum"> 542</span></a>                  }
<a name="l543"><span class="linenum"> 543</span></a>  
<a name="l544"><span class="linenum"> 544</span></a>                  <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a> = new stdClass();
<a name="l545"><span class="linenum"> 545</span></a>                  <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('lessonid')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/lessonid.html">lessonid</a> = <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l546"><span class="linenum"> 546</span></a>                  <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('userid')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> = <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l547"><span class="linenum"> 547</span></a>                  <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('grade')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> = <a class="var it1259" onMouseOver="hilite(1259)" onMouseOut="lolite()" onClick="logVariable('gradeinfo')" href="../../_variables/gradeinfo.html">$gradeinfo</a>-&gt;<a onClick="logVariable('grade')" class="var it44764" onMouseOver="hilite(44764)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a>;
<a name="l548"><span class="linenum"> 548</span></a>                  <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('completed')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/completed.html">completed</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l549"><span class="linenum"> 549</span></a>                  if (isset(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('modattempts')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/modattempts.html">modattempts</a>[<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>])) { // If reviewing, make sure update old grade record.
<a name="l550"><span class="linenum"> 550</span></a>                      if (!<a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>(&quot;lesson_grades&quot;,
<a name="l551"><span class="linenum"> 551</span></a>                          array(&quot;lessonid&quot; =&gt; <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, &quot;userid&quot; =&gt; <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>), &quot;completed DESC&quot;, '*', 0, 1)) {
<a name="l552"><span class="linenum"> 552</span></a>                          <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('cannotfindgrade', 'lesson');
<a name="l553"><span class="linenum"> 553</span></a>                      }
<a name="l554"><span class="linenum"> 554</span></a>                      <a class="var it1281" onMouseOver="hilite(1281)" onMouseOut="lolite()" onClick="logVariable('oldgrade')" href="../../_variables/oldgrade.html">$oldgrade</a> = <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a>);
<a name="l555"><span class="linenum"> 555</span></a>                      <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('id')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it1281" onMouseOver="hilite(1281)" onMouseOut="lolite()" onClick="logVariable('oldgrade')" href="../../_variables/oldgrade.html">$oldgrade</a>-&gt;<a onClick="logVariable('id')" class="var it43453" onMouseOver="hilite(43453)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l556"><span class="linenum"> 556</span></a>                      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>(&quot;lesson_grades&quot;, <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>);
<a name="l557"><span class="linenum"> 557</span></a>                  } else {
<a name="l558"><span class="linenum"> 558</span></a>                      <a class="var it1282" onMouseOver="hilite(1282)" onMouseOut="lolite()" onClick="logVariable('newgradeid')" href="../../_variables/newgradeid.html">$newgradeid</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>(&quot;lesson_grades&quot;, <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>);
<a name="l559"><span class="linenum"> 559</span></a>                  }
<a name="l560"><span class="linenum"> 560</span></a>              } else {
<a name="l561"><span class="linenum"> 561</span></a>                  if (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('timelimit')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/timelimit.html">timelimit</a>) {
<a name="l562"><span class="linenum"> 562</span></a>                      if (<a class="var it1269" onMouseOver="hilite(1269)" onMouseOut="lolite()" onClick="logVariable('outoftime')" href="../../_variables/outoftime.html">$outoftime</a> == 'normal') {
<a name="l563"><span class="linenum"> 563</span></a>                          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a> = new stdClass();
<a name="l564"><span class="linenum"> 564</span></a>                          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('lessonid')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/lessonid.html">lessonid</a> = <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l565"><span class="linenum"> 565</span></a>                          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('userid')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> = <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l566"><span class="linenum"> 566</span></a>                          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('grade')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> = 0;
<a name="l567"><span class="linenum"> 567</span></a>                          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('completed')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/completed.html">completed</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l568"><span class="linenum"> 568</span></a>                          <a class="var it1282" onMouseOver="hilite(1282)" onMouseOut="lolite()" onClick="logVariable('newgradeid')" href="../../_variables/newgradeid.html">$newgradeid</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>(&quot;lesson_grades&quot;, <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>);
<a name="l569"><span class="linenum"> 569</span></a>                          <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> .= <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('paragraph')" href="../../_functions/paragraph.html" onMouseOver="funcPopup(event,'paragraph')">paragraph</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;eolstudentoutoftimenoanswers&quot;, &quot;lesson&quot;));
<a name="l570"><span class="linenum"> 570</span></a>                      }
<a name="l571"><span class="linenum"> 571</span></a>                  } else {
<a name="l572"><span class="linenum"> 572</span></a>                      <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> .= <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('paragraph')" href="../../_functions/paragraph.html" onMouseOver="funcPopup(event,'paragraph')">paragraph</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;welldone&quot;, &quot;lesson&quot;));
<a name="l573"><span class="linenum"> 573</span></a>                  }
<a name="l574"><span class="linenum"> 574</span></a>              }
<a name="l575"><span class="linenum"> 575</span></a>  
<a name="l576"><span class="linenum"> 576</span></a>  <span class="comment">            // update central gradebook</span>
<a name="l577"><span class="linenum"> 577</span></a>              <a class="function" onClick="logFunction('lesson_update_grades')" href="../../_functions/lesson_update_grades.html" onMouseOver="funcPopup(event,'lesson_update_grades')">lesson_update_grades</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l578"><span class="linenum"> 578</span></a>              <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> .= <a class="var it1272" onMouseOver="hilite(1272)" onMouseOut="lolite()" onClick="logVariable('progressbar')" href="../../_variables/progressbar.html">$progressbar</a>;
<a name="l579"><span class="linenum"> 579</span></a>          }
<a name="l580"><span class="linenum"> 580</span></a>      } else {
<a name="l581"><span class="linenum"> 581</span></a>  <span class="comment">        // display for teacher</span>
<a name="l582"><span class="linenum"> 582</span></a>          if (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('grade')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> != <a class="constant" onClick="logConstant('GRADE_TYPE_NONE')" href="../../_constants/GRADE_TYPE_NONE.html" onMouseOver="constPopup(event,'GRADE_TYPE_NONE')">GRADE_TYPE_NONE</a>) {
<a name="l583"><span class="linenum"> 583</span></a>              <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> .= <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('paragraph')" href="../../_functions/paragraph.html" onMouseOver="funcPopup(event,'paragraph')">paragraph</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;displayofgrade&quot;, &quot;lesson&quot;), 'center');
<a name="l584"><span class="linenum"> 584</span></a>          }
<a name="l585"><span class="linenum"> 585</span></a>      }
<a name="l586"><span class="linenum"> 586</span></a>      <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> .= <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box_end')" href="../../_functions/box_end.html" onMouseOver="funcPopup(event,'box_end')">box_end</a>(); <span class="comment">//End of Lesson button to Continue.</span>
<a name="l587"><span class="linenum"> 587</span></a>  
<a name="l588"><span class="linenum"> 588</span></a>      if (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('modattempts')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/modattempts.html">modattempts</a> &amp;&amp; !<a class="var it1205" onMouseOver="hilite(1205)" onMouseOut="lolite()" onClick="logVariable('canmanage')" href="../../_variables/canmanage.html">$canmanage</a>) {
<a name="l589"><span class="linenum"> 589</span></a>  <span class="comment">        // make sure if the student is reviewing, that he/she sees the same pages/page path that he/she saw the first time</span>
<a name="l590"><span class="linenum"> 590</span></a>  <span class="comment">        // look at the attempt records to find the first QUESTION page that the user answered, then use that page id</span>
<a name="l591"><span class="linenum"> 591</span></a>  <span class="comment">        // to pass to view again.  This is slick cause it wont call the empty($pageid) code</span>
<a name="l592"><span class="linenum"> 592</span></a>  <span class="comment">        // $ntries is decremented above</span>
<a name="l593"><span class="linenum"> 593</span></a>          if (!<a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a> = <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('get_attempts')" href="../../_functions/get_attempts.html" onMouseOver="funcPopup(event,'get_attempts')">get_attempts</a>(<a class="var it1258" onMouseOver="hilite(1258)" onMouseOut="lolite()" onClick="logVariable('ntries')" href="../../_variables/ntries.html">$ntries</a>)) {
<a name="l594"><span class="linenum"> 594</span></a>              <a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a> = array();
<a name="l595"><span class="linenum"> 595</span></a>              <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../mod/lesson/view.php.html">/mod/lesson/view.php</a>', array('id'=&gt;<a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a onClick="logVariable('cm')" class="var it42916" onMouseOver="hilite(42916)" onMouseOut="lolite()" href="../../_variables/cm.html">cm</a>-&gt;id));
<a name="l596"><span class="linenum"> 596</span></a>          } else {
<a name="l597"><span class="linenum"> 597</span></a>              <a class="var it1283" onMouseOver="hilite(1283)" onMouseOut="lolite()" onClick="logVariable('firstattempt')" href="../../_variables/firstattempt.html">$firstattempt</a> = <a class="phpfunction" onClick="logFunction('current')" href="../../_functions/current.html" onMouseOver="phpfuncPopup(event,'current')">current</a>(<a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a>);
<a name="l598"><span class="linenum"> 598</span></a>              <a class="var it987" onMouseOver="hilite(987)" onMouseOut="lolite()" onClick="logVariable('pageid')" href="../../_variables/pageid.html">$pageid</a> = <a class="var it1283" onMouseOver="hilite(1283)" onMouseOut="lolite()" onClick="logVariable('firstattempt')" href="../../_variables/firstattempt.html">$firstattempt</a>-&gt;<a onClick="logVariable('pageid')" class="var it43580" onMouseOver="hilite(43580)" onMouseOut="lolite()" href="../../_variables/pageid.html">pageid</a>;
<a name="l599"><span class="linenum"> 599</span></a>  <span class="comment">            // IF the student wishes to review, need to know the last question page that the student answered.  This will help to make</span>
<a name="l600"><span class="linenum"> 600</span></a>  <span class="comment">            // sure that the student can leave the lesson via pushing the continue button.</span>
<a name="l601"><span class="linenum"> 601</span></a>              <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a> = <a class="phpfunction" onClick="logFunction('end')" href="../../_functions/end.html" onMouseOver="phpfuncPopup(event,'end')">end</a>(<a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a>);
<a name="l602"><span class="linenum"> 602</span></a>              <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('modattempts')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/modattempts.html">modattempts</a>[<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('id')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>] = <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>-&gt;<a onClick="logVariable('pageid')" class="var it43541" onMouseOver="hilite(43541)" onMouseOut="lolite()" href="../../_variables/pageid.html">pageid</a>;
<a name="l603"><span class="linenum"> 603</span></a>  
<a name="l604"><span class="linenum"> 604</span></a>              <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../mod/lesson/view.php.html">/mod/lesson/view.php</a>', array('id'=&gt;<a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a onClick="logVariable('cm')" class="var it42916" onMouseOver="hilite(42916)" onMouseOut="lolite()" href="../../_variables/cm.html">cm</a>-&gt;id, 'pageid'=&gt;<a class="var it987" onMouseOver="hilite(987)" onMouseOut="lolite()" onClick="logVariable('pageid')" href="../../_variables/pageid.html">$pageid</a>));
<a name="l605"><span class="linenum"> 605</span></a>          }
<a name="l606"><span class="linenum"> 606</span></a>          <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="phpfunction" onClick="logFunction('link')" href="../../_functions/link.html" onMouseOver="phpfuncPopup(event,'link')">link</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>, <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('reviewlesson', 'lesson'), array('class' =&gt; 'centerpadded lessonbutton standardbutton'));
<a name="l607"><span class="linenum"> 607</span></a>      } elseif (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('modattempts')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/modattempts.html">modattempts</a> &amp;&amp; <a class="var it1205" onMouseOver="hilite(1205)" onMouseOut="lolite()" onClick="logVariable('canmanage')" href="../../_variables/canmanage.html">$canmanage</a>) {
<a name="l608"><span class="linenum"> 608</span></a>          <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> .= <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('paragraph')" href="../../_functions/paragraph.html" onMouseOver="funcPopup(event,'paragraph')">paragraph</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;modattemptsnoteacher&quot;, &quot;lesson&quot;), 'centerpadded');
<a name="l609"><span class="linenum"> 609</span></a>      }
<a name="l610"><span class="linenum"> 610</span></a>  
<a name="l611"><span class="linenum"> 611</span></a>      if (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('activitylink')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/activitylink.html">activitylink</a>) {
<a name="l612"><span class="linenum"> 612</span></a>          <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> .= <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a class="function" onClick="logFunction('link_for_activitylink')" href="../../_functions/link_for_activitylink.html" onMouseOver="funcPopup(event,'link_for_activitylink')">link_for_activitylink</a>();
<a name="l613"><span class="linenum"> 613</span></a>      }
<a name="l614"><span class="linenum"> 614</span></a>  
<a name="l615"><span class="linenum"> 615</span></a>      <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../course/view.php.html">/course/view.php</a>', array('id'=&gt;<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l616"><span class="linenum"> 616</span></a>      <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="phpfunction" onClick="logFunction('link')" href="../../_functions/link.html" onMouseOver="phpfuncPopup(event,'link')">link</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>, <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('returnto', 'lesson', <a class="function" onClick="logFunction('format_string')" href="../../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('fullname')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/fullname.html">fullname</a>, true)), array('class'=&gt;'centerpadded lessonbutton standardbutton'));
<a name="l617"><span class="linenum"> 617</span></a>  
<a name="l618"><span class="linenum"> 618</span></a>      if (<a class="function" onClick="logFunction('has_capability')" href="../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('gradereport/user:view', <a class="class" onClick="logClass('context_course')" href="../../_classes/context_course.html" onMouseOver="classPopup(event,'context_course')">context_course</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))
<a name="l619"><span class="linenum"> 619</span></a>              &amp;&amp; <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('showgrades')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/showgrades.html">showgrades</a> &amp;&amp; <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('grade')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> != 0 &amp;&amp; !<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>-&gt;<a onClick="logVariable('practice')" class="var it43331" onMouseOver="hilite(43331)" onMouseOut="lolite()" href="../../_variables/practice.html">practice</a>) {
<a name="l620"><span class="linenum"> 620</span></a>          <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../grade/index.php.html">/grade/index.php</a>', array('id' =&gt; <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l621"><span class="linenum"> 621</span></a>          <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="phpfunction" onClick="logFunction('link')" href="../../_functions/link.html" onMouseOver="phpfuncPopup(event,'link')">link</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>, <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('viewgrades', 'lesson'),
<a name="l622"><span class="linenum"> 622</span></a>              array('class' =&gt; 'centerpadded lessonbutton standardbutton'));
<a name="l623"><span class="linenum"> 623</span></a>      }
<a name="l624"><span class="linenum"> 624</span></a>  
<a name="l625"><span class="linenum"> 625</span></a>      <a class="function" onClick="logFunction('lesson_add_fake_blocks')" href="../../_functions/lesson_add_fake_blocks.html" onMouseOver="funcPopup(event,'lesson_add_fake_blocks')">lesson_add_fake_blocks</a>(<a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>, <a class="var it1251" onMouseOver="hilite(1251)" onMouseOut="lolite()" onClick="logVariable('timer')" href="../../_variables/timer.html">$timer</a>);
<a name="l626"><span class="linenum"> 626</span></a>      echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="phpfunction" onClick="logFunction('header')" href="../../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>(<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('lesson')" href="../../_variables/lesson.html">$lesson</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="var it1248" onMouseOver="hilite(1248)" onMouseOut="lolite()" onClick="logVariable('currenttab')" href="../../_variables/currenttab.html">$currenttab</a>, <a class="var it1249" onMouseOver="hilite(1249)" onMouseOut="lolite()" onClick="logVariable('extraeditbuttons')" href="../../_variables/extraeditbuttons.html">$extraeditbuttons</a>, <a class="var it1250" onMouseOver="hilite(1250)" onMouseOut="lolite()" onClick="logVariable('lessonpageid')" href="../../_variables/lessonpageid.html">$lessonpageid</a>, <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;congratulations&quot;, &quot;lesson&quot;));
<a name="l627"><span class="linenum"> 627</span></a>      echo <a class="var it1267" onMouseOver="hilite(1267)" onMouseOut="lolite()" onClick="logVariable('lessoncontent')" href="../../_variables/lessoncontent.html">$lessoncontent</a>;
<a name="l628"><span class="linenum"> 628</span></a>      echo <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('lessonoutput')" href="../../_variables/lessonoutput.html">$lessonoutput</a>-&gt;<a class="function" onClick="logFunction('footer')" href="../../_functions/footer.html" onMouseOver="funcPopup(event,'footer')">footer</a>();
<a name="l629"><span class="linenum"> 629</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'start_timer': ['start_timer', 'Starts the lesson time for the current user ', [['mod/lesson','locallib.php',1485]], 5],
'heading': ['heading', 'Outputs a heading ', [['lib','outputrenderers.php',3072],['lib','outputrenderers.php',4364],['lib','outputrenderers.php',4552],['grade/report/singleview/classes/local/screen','screen.php',197],['grade/report/singleview/classes/local/screen','user.php',264],['grade/report/singleview/classes/local/screen','grade.php',283]], 796],
'get_field_sql': ['get_field_sql', 'Get a single field value (first field) using a SQL statement. ', [['lib/dml','moodle_database.php',1588]], 138],
'require_sesskey': ['require_sesskey', 'Check the session key using {@link confirm_sesskey()}, and cause a fatal error if it does not match. ', [['lib','sessionlib.php',79]], 229],
'load_page': ['load_page', 'Loads the requested page. ', [['mod/lesson','locallib.php',1632],['mod/lesson','locallib.php',3323]], 24],
'sum': ['sum', 'SUM ', [['lib/phpexcel/PHPExcel/Calculation','MathTrig.php',1152],['lib/evalmath','evalmath.class.php',530]], 91],
'instance': ['instance', 'Returns an instance of the cache_factor method. ', [['cache','disabledlib.php',171],['cache','disabledlib.php',296],['lib/classes','useragent.php',101],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',80],['lib/htmlpurifier/HTMLPurifier','URISchemeRegistry.php',9],['search/classes','manager.php',109],['cache','locallib.php',52],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',53],['lib/classes','plugin_manager.php',103],['lib/htmlpurifier','HTMLPurifier.php',251],['course/format','lib.php',156],['lib/classes/update','checker.php',62],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',31],['admin/tool/installaddon/classes','installer.php',40],['lib','modinfolib.php',373],['cache/classes','helper.php',76],['lib/tests','string_manager_standard_test.php',124],['lib/portfolio','exporter.php',251],['lib/classes/update','validator.php',88],['search/classes','document_factory.php',49],['lib','accesslib.php',6235],['lib','accesslib.php',6487],['lib','accesslib.php',6665],['lib','accesslib.php',6919],['lib','accesslib.php',7180],['lib','accesslib.php',7392],['backup/cc/cc_lib','cc_utils.php',387],['backup/cc/cc_lib','cc_utils.php',443],['lib','filterlib.php',80],['search/tests/fixtures','testable_core_search.php',43],['lib/tests/fixtures','testable_update_checker.php',45],['backup/cc','validator.php',35],['cache/classes','config.php',87],['cache/classes','factory.php',114],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',29]], 4647],
'get_records': ['get_records', 'Load a list of records. ', [['competency/classes','persistent.php',709],['mod/glossary/classes','entry_query_builder.php',295],['lib/dml','moodle_database.php',1285],['lib','coursecatlib.php',651],['question','category_class.php',63]], 965],
'link_for_activitylink': ['link_for_activitylink', 'Returns the link for the related activity ', [['mod/lesson','locallib.php',1611]], 1],
'add_record_snapshot': ['add_record_snapshot', 'Add cached data that will be most probably used in event observers. ', [['lib/classes/event','base.php',840]], 332],
'lesson_inaccessible': ['lesson_inaccessible', 'Returns HTML for a lesson inaccessible message ', [['mod/lesson','renderer.php',86]], 4],
'stop_timer': ['stop_timer', 'Updates the timer to the current time then stops it by unsetting the user var ', [['mod/lesson','locallib.php',1580]], 2],
'require_login': ['require_login', 'This function checks that the current user is logged in and has the required privileges ', [['lib','moodlelib.php',2449]], 636],
'has_capability': ['has_capability', 'Wrapper round the has_capability funciton that automatically passes in the quiz context. ', [['mod/quiz','attemptlib.php',299],['mod/quiz','attemptlib.php',922],['lib','accesslib.php',344]], 2064],
'is_accessible': ['is_accessible', 'Check if the lesson is accessible at the present time ', [['mod/lesson','locallib.php',1475]], 2],
'lesson_display_teacher_warning': ['lesson_display_teacher_warning', 'Checks to see if a LESSON_CLUSTERJUMP or a LESSON_UNSEENBRANCHPAGE is used in a lesson. ', [['mod/lesson','locallib.php',68]], 2],
'lesson_unseen_question_jump': ['lesson_unseen_question_jump', 'Interprets the LESSON_UNSEENBRANCHPAGE jump. ', [['mod/lesson','locallib.php',98]], 3],
'continue_links': ['continue_links', 'Returns HTML to display a continue button ', [['mod/lesson','renderer.php',161]], 1],
'get_string': ['get_string', 'Get String returns a requested string ', [['lib/classes','string_manager_install.php',95],['lib','moodlelib.php',6735],['lib','moodlelib.php',9695],['lib/external','externallib.php',102],['question/behaviour','behaviourbase.php',770],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38]], 20134],
'get_field': ['get_field', 'Gets an instance of the form field. ', [['lib/behat','behat_field_manager.php',248],['mod/quiz/report/statistics/classes','calculated.php',109],['lib/dml','moodle_database.php',1546],['user/filters','lib.php',124]], 536],
'box_end': ['box_end', 'Outputs the closing section of a box. ', [['lib','outputrenderers.php',3117]], 257],
'login_prompt': ['login_prompt', 'Returns HTML to prompt the user to log in ', [['mod/lesson','renderer.php',103]], 2],
'get_attempts': ['get_attempts', 'Get all of the attempts for the current user. ', [['mod/lesson','locallib.php',1293]], 6],
'set_module_viewed': ['set_module_viewed', 'Update the module completion status (set it viewed). ', [['mod/assign','locallib.php',8075],['lib','completionlib.php',657]], 29],
'get_record': ['get_record', 'Load a single record. ', [['competency/classes','persistent.php',738],['lib/dml','moodle_database.php',1462]], 3224],
'update_state': ['update_state', 'Updates (if necessary) the completion state of activity $cm for the given user. ', [['lib','completionlib.php',507]], 40],
'set_data': ['set_data', '', [['mod/scorm','mod_form.php',456],['mod/feedback/item/multichoicerated','multichoicerated_form.php',84],['backup/util/structure','restore_path_element.class.php',95],['course','moodleform_mod.php',458],['blocks/html','edit_form.php',53],['question/type','edit_question_form.php',450],['question/type/random','edit_random_form.php',68],['lib','formslib.php',456],['question/type/missingtype','edit_missingtype_form.php',52],['badges','edit_form.php',137],['blocks','edit_form.php',255],['course','editsection_form.php',88],['admin/tool/filetypes','edit_form.php',83],['question','category_form.php',73],['lib/classes/message/inbound','address_manager.php',146],['question/type/multianswer','edit_multianswer_form.php',262],['cache','forms.php',242],['question/type/calculated','datasetitems_form.php',360],['mod/feedback/item/multichoice','multichoice_form.php',79]], 235],
'box': ['box', 'Outputs a box. ', [['lib','outputrenderers.php',3089]], 288],
'display_page': ['display_page', 'Returns HTML to display a page to the user ', [['mod/lesson','renderer.php',183]], 3],
'create': ['create', 'Auto-scan an incoming line to determine the response type. ', [['lib/horde/framework/Horde/Imap/Client/Interaction','Server.php',65],['lib/google/src/Google/Service','Partners.php',492],['lib/simplepie/library/SimplePie','Cache.php',95],['lib/google/src/Google/Service','YouTubeReporting.php',237],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',81],['lib/google/src/Google/Service','MapsEngine.php',1677],['lib/google/src/Google/Service','MapsEngine.php',1977],['lib/google/src/Google/Service','MapsEngine.php',2253],['lib/google/src/Google/Service','MapsEngine.php',2330],['lib/google/src/Google/Service','MapsEngine.php',2898],['lib/spout/src/Spout/Writer','WriterFactory.php',18],['lib/google/src/Google/Service','Dns.php',290],['lib/google/src/Google/Service','Dns.php',363],['lib/google/src/Google/Service','Appengine.php',438],['tag/classes','collection.php',188],['lib/adodb','adodb-xmlschema.inc.php',152],['lib/adodb','adodb-xmlschema.inc.php',473],['lib/adodb','adodb-xmlschema.inc.php',738],['lib/adodb','adodb-xmlschema.inc.php',884],['lib/adodb','adodb-xmlschema.inc.php',1129],['mod/quiz','attemptlib.php',100],['mod/quiz','attemptlib.php',596],['lib','weblib.php',3206],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',58],['lib/google/src/Google/Service','Dataflow.php',273],['lib/simplepie/library/SimplePie','Registry.php',153],['competency/classes','persistent.php',387],['lib/google/src/Google/Service','Cloudresourcemanager.php',373],['lib/phpexcel/PHPExcel/Shared/PCLZip','pclzip.lib.php',270],['lib/google/src/Google/Service','TagManager.php',1007],['lib/google/src/Google/Service','TagManager.php',1097],['lib/google/src/Google/Service','TagManager.php',1249],['lib/google/src/Google/Service','TagManager.php',1342],['lib/google/src/Google/Service','TagManager.php',1436],['lib/google/src/Google/Service','TagManager.php',1530],['lib/google/src/Google/Service','TagManager.php',1681],['mod/lesson','locallib.php',1011],['mod/lesson','locallib.php',2163],['mod/lesson','locallib.php',3212],['lib','modinfolib.php',1732],['repository','lib.php',206],['repository','lib.php',1910],['lib','navigationlib.php',268],['lib/htmlpurifier/HTMLPurifier','Config.php',114],['lib/google/src/Google/Service','Container.php',284],['lib/google/src/Google/Service','Genomics.php',632],['lib/google/src/Google/Service','Genomics.php',721],['lib/google/src/Google/Service','Genomics.php',1312],['lib/google/src/Google/Service','Genomics.php',1427],['lib/google/src/Google/Service','Games.php',1649],['lib/google/src/Google/Service','Games.php',2013],['lib/google/src/Google/Service','Fitness.php',377],['lib/google/src/Google/Service','Gmail.php',747],['lib/google/src/Google/Service','Gmail.php',905],['mod/quiz/classes','structure.php',65],['lib/htmlpurifier/HTMLPurifier','ElementDef.php',135],['lib/adodb','adodb-xmlschema03.inc.php',170],['lib/adodb','adodb-xmlschema03.inc.php',514],['lib/adodb','adodb-xmlschema03.inc.php',779],['lib/adodb','adodb-xmlschema03.inc.php',930],['lib/adodb','adodb-xmlschema03.inc.php',1228],['lib/google/src/Google/Service','Proximitybeacon.php',500],['tag/classes','area.php',205],['course','lib.php',3003],['question/type/ddmarker','shapes.php',170],['lib/classes/event','base.php',149],['lib','coursecatlib.php',325],['repository/filesystem','lib.php',498],['lib/google/src/Google/Service','Storagetransfer.php',281],['calendar','lib.php',2686],['lib/htmlpurifier/HTMLPurifier','Lexer.php',53],['lib/google/src/Google/Service','Classroom.php',445],['lib/google/src/Google/Service','Classroom.php',596],['lib/google/src/Google/Service','Classroom.php',673],['lib/google/src/Google/Service','Classroom.php',783],['lib/google/src/Google/Service','Classroom.php',912],['lib/spout/src/Spout/Reader','ReaderFactory.php',18],['lib/google/src/Google/Service','Pubsub.php',220],['lib/google/src/Google/Service','Pubsub.php',365],['lib/google/src/Google/Service','CloudMonitoring.php',258]], 3276],
'callback_on_view': ['callback_on_view', '', [['mod/lesson/pagetypes','endofcluster.php',54],['mod/lesson','locallib.php',2632],['mod/lesson/pagetypes','endofbranch.php',54],['mod/lesson/pagetypes','cluster.php',58]], 1],
'get_contents': ['get_contents', 'Returns the contents field for the page properly formatted and with plugin file url\'s converted ', [['mod/lesson','locallib.php',3029]], 14],
'update_timer': ['update_timer', 'Updates the timer to the current time and returns the new timer object ', [['mod/lesson','locallib.php',1516]], 5],
'cluster_jump': ['cluster_jump', 'Interprets LESSON_CLUSTERJUMP jumpto value. ', [['mod/lesson','locallib.php',1731]], 5],
'lesson_displayleftif': ['lesson_displayleftif', 'Determines if a user can view the left menu.  The determining factor is whether a user has a grade greater than or equal to the lesson setting of displayleftif ', [['mod/lesson','locallib.php',386]], 2],
'count_records': ['count_records', 'Count a list of records. ', [['competency/classes','persistent.php',815],['mod/glossary/classes','entry_query_builder.php',152],['lib/dml','moodle_database.php',1766]], 1630],
'progress_bar': ['progress_bar', 'Renderers a progress bar for the backup or restore given the items that make it up. ', [['backup/util/ui','renderer.php',39],['mod/lesson','renderer.php',497]], 19],
'div': ['div', 'Creates a <div> tag. (Shortcut function.) ', [['lib','outputcomponents.php',1814],['lib/htmlpurifier/HTMLPurifier','UnitConverter.php',239]], 207],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required, Some conversions and safety checks are carried out. Lobs are supported. If the return ID isn\'t required, then this just reports success as true/false. $data is an object containing needed data ', [['lib/dml','pdo_moodle_database.php',387],['lib/dml','oci_native_moodle_database.php',1297],['lib/dml','pgsql_native_moodle_database.php',889],['lib/dml','mssql_native_moodle_database.php',962],['lib/dml','mysqli_native_moodle_database.php',1185],['question/engine/upgrade','upgradelib.php',124],['lib/dml','sqlsrv_native_moodle_database.php',1045],['lib/dml/tests','dml_test.php',5548]], 1611],
'dependancy_errors': ['dependancy_errors', 'Returns HTML to display dependancy errors ', [['mod/lesson','renderer.php',130]], 1],
'required_param': ['required_param', 'Returns a particular value for the named variable, taken from POST or GET.  If the parameter doesn\'t exist then an error is thrown because we require this variable. ', [['lib','moodlelib.php',525]], 815],
'param': ['param', '', [['lib/adodb/drivers','adodb-postgres64.inc.php',609],['lib','weblib.php',453],['lib/adodb/drivers','adodb-oci8po.inc.php',39],['lib/adodb','adodb.inc.php',934],['lib/adodb/drivers','adodb-oci8.inc.php',1179],['lib/adodb/drivers','adodb-db2oci.inc.php',163]], 640],
'trigger': ['trigger', '', [['lib/evalmath','evalmath.class.php',448],['lib/classes/event','base.php',765]], 964],
'user_allowed_editing': ['user_allowed_editing', 'Does the user have permission to see this page in editing mode. ', [['lib','pagelib.php',874]], 21],
'optional_param': ['optional_param', 'Returns a particular value for the named variable, taken from POST or GET, otherwise returning a given default. ', [['lib','moodlelib.php',609]], 2210],
'update_effective_access': ['update_effective_access', 'Updates the lesson properties with override information for a user. ', [['mod/lesson','locallib.php',1139]], 5],
'set_subpage': ['set_subpage', 'If context->id and pagetype are not enough to uniquely identify this page, then you can set a subpage id as well. For example, the tags page sets ', [['lib','pagelib.php',1118]], 13],
'get_renderer': ['get_renderer', 'Returns instance of page renderer used by this plugin ', [['course/format','lib.php',905],['question/type/multichoice','question.php',156],['question/type/multichoice','question.php',278],['question/behaviour','behaviourbase.php',135],['question/type','questionbase.php',275],['lib','pagelib.php',802],['lib','outputlib.php',1828],['lib','outputfactories.php',70],['lib','outputfactories.php',292],['lib','outputfactories.php',377],['mod/assign','locallib.php',2987],['grade/grading/form/rubric','lib.php',486],['lib/tests/fixtures','test_renderer_factory.php',49],['grade/grading/form/guide','lib.php',492]], 452],
'userdate': ['userdate', 'Returns a formatted string that represents a date in user time. ', [['lib','moodlelib.php',2155],['lib/adodb','adodb.inc.php',2842],['lib/adodb','adodb.inc.php',3569]], 525],
'format_string': ['format_string', 'Given a simple string, this function returns the string processed by enabled string filters if $CFG->filterall is enabled ', [['lib','weblib.php',1379]], 880],
'footer': ['footer', 'This method is used to render the page footer. It is automatically called by AddPage() and could be overwritten in your own inherited class. ', [['lib/tcpdf','tcpdf.php',3464],['lib','outputrenderers.php',1034],['lib','outputrenderers.php',4427],['lib','outputrenderers.php',4546],['mod/lesson','renderer.php',78]], 810],
'lesson_grade': ['lesson_grade', 'Calculates a user\'s grade for a lesson. ', [['mod/lesson','locallib.php',262]], 5],
'format_time': ['format_time', 'Format a date/time (seconds) as weeks, days, hours etc as needed ', [['lib','moodlelib.php',2065]], 70],
'print_error': ['print_error', 'Abort execution by throwing of a general exception, default exception handler displays the error message in most cases. ', [['lib','setuplib.php',481]], 1488],
'ongoing_score': ['ongoing_score', 'Prints the on going message to the user. ', [['mod/lesson','renderer.php',461]], 2],
'get_coursemodule_from_id': ['get_coursemodule_from_id', 'Given an id of a course module, finds the coursemodule description ', [['lib','datalib.php',1238]], 212],
'box_start': ['box_start', 'Outputs the opening section of a box. ', [['lib','outputrenderers.php',3102]], 259],
'is_enabled': ['is_enabled', 'Tools cannot be disabled. ', [['lib/classes/plugininfo','tool.php',39],['admin/tool/recyclebin/classes','category_bin.php',54],['admin/tool/log/classes/plugininfo','logstore.php',35],['admin/tool/recyclebin/classes','course_bin.php',54],['mod/assign/feedback/offline','locallib.php',380],['admin/tool/recyclebin/classes','base_bin.php',38],['lib','adminlib.php',1955],['search/classes','base.php',190],['lib','medialib.php',318],['lib','medialib.php',635],['lib','medialib.php',1268],['admin/tool/health','index.php',393],['lib/classes/plugininfo','mnetservice.php',33],['lib/classes/message/inbound','manager.php',37],['mod/assignment/classes/plugininfo','assignment.php',32],['competency/classes','api.php',49],['mod/assign','assignmentplugin.php',223],['lib/classes/plugininfo','orphaned.php',37],['search/tests/fixtures','mock_search_area.php',38],['tag/classes','area.php',106],['lib/classes/plugininfo','base.php',383],['mod/assign/feedback/editpdf','locallib.php',340],['tag/classes','tag.php',1269],['mod/assign/submission/comments','locallib.php',172],['lib','completionlib.php',269]], 276],
'paragraph': ['paragraph', 'Returns a P tag containing contents ', [['mod/lesson','renderer.php',592]], 9],
'lesson_update_grades': ['lesson_update_grades', 'Update grades in central gradebook ', [['mod/lesson','lib.php',711]], 4],
'display': ['display', 'Displays the form ', [['backup/util/ui','base_moodleform.class.php',365],['mod/feedback/classes','complete_form.php',536],['lib/minify/lib/Minify/Cache','APC.php',79],['mod/lesson/pagetypes','numerical.php',50],['mod/scorm/report/interactions/classes','report.php',31],['mod/scorm/report/basic/classes','report.php',30],['backup/util/ui','restore_ui.class.php',375],['mod/scorm/report/objectives/classes','report.php',37],['mod/lesson/pagetypes','endofcluster.php',39],['mod/lesson/pagetypes','matching.php',50],['mod/feedback/classes','responses_table.php',344],['user/selector','lib.php',205],['lib/minify/lib/Minify/Cache','File.php',72],['lib','formslib.php',935],['backup/util/ui','base_ui.class.php',169],['mod/lesson/pagetypes','multichoice.php',87],['question/classes/bank','column_base.php',164],['cohort','upload_form.php',316],['mod/quiz/report/statistics','report.php',51],['admin/roles/classes','capability_table_with_risks.php',131],['mod/lesson/pagetypes','truefalse.php',50],['admin/roles/classes','capability_table_base.php',71],['mod/quiz/report/overview','report.php',42],['mod/feedback/classes','templates_table.php',62],['lib/minify/lib/Minify/Cache','ZendPlatform.php',84],['mod/lesson/pagetypes','endofbranch.php',39],['mod/scorm/classes','report.php',39],['backup/util/ui','import_extensions.php',154],['question/classes/bank','view.php',451],['backup/util/ui','backup_ui_stage.class.php',545],['backup/util/ui','backup_ui_stage.class.php',588],['mod/quiz/report/grading','report.php',51],['mod/lesson/pagetypes','shortanswer.php',50],['lib/pear/HTML','Common.php',438],['mod/lesson/pagetypes','essay.php',67],['lib/minify/lib/Minify/Cache','Memcache.php',85],['backup/util/ui','base_ui_stage.class.php',126],['mod/scorm/report/graphs/classes','report.php',127],['mod/lesson/pagetypes','branchtable.php',105],['repository/flickr_public','image.php',149],['admin/roles/classes','define_role_table_advanced.php',612],['mod/quiz/report/responses','report.php',51],['mod/lesson/pagetypes','cluster.php',39],['lib/minify/lib/Minify/Cache','WinCache.php',79],['lib/minify/lib/Minify/Cache','XCache.php',74],['course/format/singleactivity','renderer.php',36],['backup/util/ui','restore_ui_stage.class.php',355],['backup/util/ui','restore_ui_stage.class.php',497],['backup/util/ui','restore_ui_stage.class.php',1025],['backup/util/ui','restore_ui_stage.class.php',1112]], 320],
'message': ['message', 'Send XMPP Message ', [['lib/jabber/XMPP','XMPP.php',156],['mod/lesson','renderer.php',145]], 31],
'get_next_page': ['get_next_page', 'Gets the next page id to display after the one that is provided. ', [['mod/lesson','locallib.php',1404],['mod/feedback/classes','completion.php',300]], 7],
'update_record': ['update_record', 'Update a record in a table ', [['lib/dml','pdo_moodle_database.php',461],['lib/dml','oci_native_moodle_database.php',1404],['lib/dml','pgsql_native_moodle_database.php',1089],['lib/dml','mssql_native_moodle_database.php',1067],['lib/dml','mysqli_native_moodle_database.php',1405],['lib/dml','sqlsrv_native_moodle_database.php',1148],['lib/dml/tests','dml_test.php',5551]], 650],
'lesson_add_fake_blocks': ['lesson_add_fake_blocks', '', [['mod/lesson','locallib.php',420]], 3],
'set_url': ['set_url', 'Convenience method handling moodle_urls. ', [['competency/classes','evidence.php',151],['lib','outputcomponents.php',2828],['backup/cc/cc_lib','cc_weblink.php',50],['lib','pagelib.php',1227],['blocks/rss_client/classes/output','channel_image.php',89],['backup/util/ui','restore_ui_components.php',141],['mod/wiki','pagelib.php',245],['mod/wiki','pagelib.php',333],['mod/wiki','pagelib.php',425],['mod/wiki','pagelib.php',696],['mod/wiki','pagelib.php',721],['mod/wiki','pagelib.php',835],['mod/wiki','pagelib.php',879],['mod/wiki','pagelib.php',1008],['mod/wiki','pagelib.php',1112],['mod/wiki','pagelib.php',1219],['mod/wiki','pagelib.php',1462],['mod/wiki','pagelib.php',1864],['mod/wiki','pagelib.php',1932],['mod/wiki','pagelib.php',2104],['mod/wiki','pagelib.php',2165],['mod/wiki','pagelib.php',2221],['mod/wiki','pagelib.php',2286],['mod/wiki','pagelib.php',2334],['mod/wiki','pagelib.php',2382],['mod/wiki','pagelib.php',2486]], 596],
'redirect': ['redirect', '', [['enrol/lti/ims-blti','blti.php',230],['lib','weblib.php',2659]], 999],
'add_message': ['add_message', 'To be called from phpunit_util only! ', [['lib/phpunit/classes','phpmailer_sink.php',50],['mod/lesson','locallib.php',1451],['lib/classes/update','validator.php',548],['lib/phpunit/classes','message_sink.php',48]], 62],
'strcmp': ['strcmp', '', [], 82],
'ob_get_contents': ['ob_get_contents', '', [], 62],
'ob_start': ['ob_start', '', [], 101],
'header': ['header', '', [], 1355],
'ob_end_clean': ['ob_end_clean', '', [], 76],
'unserialize': ['unserialize', '', [], 192],
'is_array': ['is_array', '', [], 1608],
'trim': ['trim', '', [], 1948],
'count': ['count', '', [], 4095],
'is_numeric': ['is_numeric', '', [], 672],
'time': ['time', '', [], 1959],
'number_format': ['number_format', '', [], 37],
'link': ['link', '', [], 695],
'array_shift': ['array_shift', '', [], 700],
'end': ['end', '', [], 433],
'current': ['current', '', [], 155]};
CLASS_DATA={
'lesson_page_without_answers': ['lesson_page_without_answers', 'Lesson page without answers ', [['mod/lesson','view_form.php',34]], 1],
'single_button': ['single_button', 'Data structure representing a simple form with only one button. ', [['lib','outputcomponents.php',604]], 121],
'course_module_viewed': ['course_module_viewed', 'The mod_page course module viewed event class. ', [['mod/page/classes/event','course_module_viewed.php',28],['mod/chat/classes/event','course_module_viewed.php',29],['mod/quiz/classes/event','course_module_viewed.php',29],['mod/data/classes/event','course_module_viewed.php',30],['mod/choice/classes/event','course_module_viewed.php',28],['mod/forum/classes/event','course_module_viewed.php',29],['mod/resource/classes/event','course_module_viewed.php',29],['mod/book/classes/event','course_module_viewed.php',28],['mod/imscp/classes/event','course_module_viewed.php',30],['mod/lti/classes/event','course_module_viewed.php',29],['mod/feedback/classes/event','course_module_viewed.php',28],['mod/survey/classes/event','course_module_viewed.php',29],['mod/folder/classes/event','course_module_viewed.php',29],['mod/glossary/classes/event','course_module_viewed.php',28],['mod/scorm/classes/event','course_module_viewed.php',28],['mod/url/classes/event','course_module_viewed.php',29],['mod/wiki/classes/event','course_module_viewed.php',28],['lib/tests/fixtures','event_fixtures.php',232],['mod/lesson/classes/event','course_module_viewed.php',30],['mod/workshop/classes/event','course_module_viewed.php',32]], 37],
'lesson': ['lesson', 'Class representation of a lesson ', [['mod/lesson','locallib.php',921]], 28],
'moodle_url': ['moodle_url', 'Class for creating and manipulating urls. ', [['lib','weblib.php',238]], 3088],
'completion_info': ['completion_info', 'Class represents completion information for a course. ', [['lib','completionlib.php',210]], 141],
'context_course': ['context_course', 'Course context class ', [['lib','accesslib.php',6817]], 1323],
'html_writer': ['html_writer', 'Simple html output class ', [['lib','outputcomponents.php',1062]], 5120],
'context_module': ['context_module', 'Course module context class ', [['lib','accesslib.php',7039]], 1106]};
CONST_DATA={
'LESSON_CLUSTERJUMP': ['LESSON_CLUSTERJUMP', '', [['mod/lesson','locallib.php',54]], 10],
'PARAM_ALPHA': ['PARAM_ALPHA', '', [['lib','moodlelib.php',77]], 398],
'PARAM_INT': ['PARAM_INT', '', [['lib','moodlelib.php',156]], 3812],
'GRADE_TYPE_NONE': ['GRADE_TYPE_NONE', '', [['lib/grade','constants.php',80]], 47],
'MUST_EXIST': ['MUST_EXIST', '', [['lib','dmllib.php',52]], 1384],
'LESSON_UNSEENBRANCHPAGE': ['LESSON_UNSEENBRANCHPAGE', '', [['mod/lesson','locallib.php',46]], 10],
'LESSON_PAGE_BRANCHTABLE': ['LESSON_PAGE_BRANCHTABLE', '', [['mod/lesson/pagetypes','branchtable.php',29]], 25],
'PARAM_RAW': ['PARAM_RAW', '', [['lib','moodlelib.php',193]], 921],
'PARAM_BOOL': ['PARAM_BOOL', '', [['lib','moodlelib.php',108]], 802],
'LESSON_NEXTPAGE': ['LESSON_NEXTPAGE', '', [['mod/lesson','locallib.php',42]], 36],
'LESSON_EOL': ['LESSON_EOL', '', [['mod/lesson','locallib.php',44]], 29],
'COMPLETION_COMPLETE': ['COMPLETION_COMPLETE', '', [['lib','completionlib.php',76]], 90]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Aug 11 10:00:09 2016</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
