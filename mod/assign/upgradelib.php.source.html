<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /mod/assign/upgradelib.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu May 28 19:17:31 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='mod/assign';
filename='upgradelib.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/mod/assign/</a> -> <a href="upgradelib.php.html">upgradelib.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="upgradelib.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="upgradelib.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * This file contains the upgrade code to upgrade from mod_assignment to mod_assign</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * @package   mod_assign</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @copyright 2012 NetSpot {@link http://www.netspot.com.au}</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> */</span>
<a name="l24"><span class="linenum">  24</span></a>  
<a name="l25"><span class="linenum">  25</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die();
<a name="l26"><span class="linenum">  26</span></a>  
<a name="l27"><span class="linenum">  27</span></a>  require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../mod/assign/locallib.php.html">/mod/assign/locallib.php</a>');
<a name="l28"><span class="linenum">  28</span></a>  require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a>.'/accesslib.php');
<a name="l29"><span class="linenum">  29</span></a>  require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../course/lib.php.html">/course/lib.php</a>');
<a name="l30"><span class="linenum">  30</span></a>  
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment">/*</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> * The maximum amount of time to spend upgrading a single assignment.</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> * This is intentionally generous (5 mins) as the effect of a timeout</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> * for a legitimate upgrade would be quite harsh (roll back code will not run)</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> */</span>
<a name="l36"><span class="linenum">  36</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('ASSIGN_MAX_UPGRADE_TIME_SECS')" href="../../_constants/ASSIGN_MAX_UPGRADE_TIME_SECS.html" onMouseOver="constPopup(event,'ASSIGN_MAX_UPGRADE_TIME_SECS')">ASSIGN_MAX_UPGRADE_TIME_SECS</a>', 300);
<a name="l37"><span class="linenum">  37</span></a>  
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment">/**</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="comment"> * Class to manage upgrades from mod_assignment to mod_assign</span>
<a name="l40"><span class="linenum">  40</span></a>  <span class="comment"> *</span>
<a name="l41"><span class="linenum">  41</span></a>  <span class="comment"> * @package   mod_assign</span>
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment"> * @copyright 2012 NetSpot {@link http://www.netspot.com.au}</span>
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment"> * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l44"><span class="linenum">  44</span></a>  <span class="comment"> */</span>
<a name="l45"><span class="linenum">  45</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('assign_upgrade_manager')" href="../../_classes/assign_upgrade_manager.html" onMouseOver="classPopup(event,'assign_upgrade_manager')">assign_upgrade_manager</a> {
<a name="l46"><span class="linenum">  46</span></a>  
<a name="l47"><span class="linenum">  47</span></a>      <span class="comment">/**</span>
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment">     * This function converts all of the base settings for an instance of</span>
<a name="l49"><span class="linenum">  49</span></a>  <span class="comment">     * the old assignment to the new format. Then it calls each of the plugins</span>
<a name="l50"><span class="linenum">  50</span></a>  <span class="comment">     * to see if they can help upgrade this assignment.</span>
<a name="l51"><span class="linenum">  51</span></a>  <span class="comment">     * @param int $oldassignmentid (don't rely on the old assignment type even being installed)</span>
<a name="l52"><span class="linenum">  52</span></a>  <span class="comment">     * @param string $log This string gets appended to during the conversion process</span>
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment">     * @return bool true or false</span>
<a name="l54"><span class="linenum">  54</span></a>  <span class="comment">     */</span>
<a name="l55"><span class="linenum">  55</span></a>      public function <a class="function" onClick="logFunction('upgrade_assignment')" href="../../_functions/upgrade_assignment.html" onMouseOver="funcPopup(event,'upgrade_assignment')">upgrade_assignment</a>(<a class="var it19816" onMouseOver="hilite(19816)" onMouseOut="lolite()" onClick="logVariable('oldassignmentid')" href="../../_variables/oldassignmentid.html">$oldassignmentid</a>, &amp; <a class="var it1193" onMouseOver="hilite(1193)" onMouseOut="lolite()" onClick="logVariable('log')" href="../../_variables/log.html">$log</a>) {
<a name="l56"><span class="linenum">  56</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>;
<a name="l57"><span class="linenum">  57</span></a>  <span class="comment">        // Steps to upgrade an assignment.</span>
<a name="l58"><span class="linenum">  58</span></a>  
<a name="l59"><span class="linenum">  59</span></a>          <a class="class" onClick="logClass('core_php_time_limit')" href="../../_classes/core_php_time_limit.html" onMouseOver="classPopup(event,'core_php_time_limit')">core_php_time_limit</a>::<a class="function" onClick="logFunction('raise')" href="../../_functions/raise.html" onMouseOver="funcPopup(event,'raise')">raise</a>(<a class="constant" onClick="logConstant('ASSIGN_MAX_UPGRADE_TIME_SECS')" href="../../_constants/ASSIGN_MAX_UPGRADE_TIME_SECS.html" onMouseOver="constPopup(event,'ASSIGN_MAX_UPGRADE_TIME_SECS')">ASSIGN_MAX_UPGRADE_TIME_SECS</a>);
<a name="l60"><span class="linenum">  60</span></a>  
<a name="l61"><span class="linenum">  61</span></a>  <span class="comment">        // Get the module details.</span>
<a name="l62"><span class="linenum">  62</span></a>          <a class="var it19817" onMouseOver="hilite(19817)" onMouseOut="lolite()" onClick="logVariable('oldmodule')" href="../../_variables/oldmodule.html">$oldmodule</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('modules', array('name'=&gt;'assignment'), '*', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l63"><span class="linenum">  63</span></a>          <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('module'=&gt;<a class="var it19817" onMouseOver="hilite(19817)" onMouseOut="lolite()" onClick="logVariable('oldmodule')" href="../../_variables/oldmodule.html">$oldmodule</a>-&gt;<a onClick="logVariable('id')" class="var it41178" onMouseOver="hilite(41178)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'instance'=&gt;<a class="var it19816" onMouseOver="hilite(19816)" onMouseOut="lolite()" onClick="logVariable('oldassignmentid')" href="../../_variables/oldassignmentid.html">$oldassignmentid</a>);
<a name="l64"><span class="linenum">  64</span></a>          <a class="var it19818" onMouseOver="hilite(19818)" onMouseOut="lolite()" onClick="logVariable('oldcoursemodule')" href="../../_variables/oldcoursemodule.html">$oldcoursemodule</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('course_modules',
<a name="l65"><span class="linenum">  65</span></a>                                             <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>,
<a name="l66"><span class="linenum">  66</span></a>                                             '*',
<a name="l67"><span class="linenum">  67</span></a>                                             <a class="constant" onClick="logConstant('MUST_EXIST')" href="../../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l68"><span class="linenum">  68</span></a>          <a class="var it4359" onMouseOver="hilite(4359)" onMouseOut="lolite()" onClick="logVariable('oldcontext')" href="../../_variables/oldcontext.html">$oldcontext</a> = <a class="class" onClick="logClass('context_module')" href="../../_classes/context_module.html" onMouseOver="classPopup(event,'context_module')">context_module</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it19818" onMouseOver="hilite(19818)" onMouseOut="lolite()" onClick="logVariable('oldcoursemodule')" href="../../_variables/oldcoursemodule.html">$oldcoursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it41179" onMouseOver="hilite(41179)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l69"><span class="linenum">  69</span></a>  <span class="comment">        // We used to check for admin capability, but since Moodle 2.7 this is called</span>
<a name="l70"><span class="linenum">  70</span></a>  <span class="comment">        // during restore of a mod_assignment module.</span>
<a name="l71"><span class="linenum">  71</span></a>  <span class="comment">        // Also note that we do not check for any mod_assignment capabilities, because they can</span>
<a name="l72"><span class="linenum">  72</span></a>  <span class="comment">        // be removed so that users don't add new instances of the broken old thing.</span>
<a name="l73"><span class="linenum">  73</span></a>          if (!<a class="function" onClick="logFunction('has_capability')" href="../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('mod/assign:addinstance', <a class="var it4359" onMouseOver="hilite(4359)" onMouseOut="lolite()" onClick="logVariable('oldcontext')" href="../../_variables/oldcontext.html">$oldcontext</a>)) {
<a name="l74"><span class="linenum">  74</span></a>              <a class="var it1193" onMouseOver="hilite(1193)" onMouseOut="lolite()" onClick="logVariable('log')" href="../../_variables/log.html">$log</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('couldnotcreatenewassignmentinstance', 'mod_assign');
<a name="l75"><span class="linenum">  75</span></a>              return false;
<a name="l76"><span class="linenum">  76</span></a>          }
<a name="l77"><span class="linenum">  77</span></a>  
<a name="l78"><span class="linenum">  78</span></a>  <span class="comment">        // First insert an assign instance to get the id.</span>
<a name="l79"><span class="linenum">  79</span></a>          <a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('assignment', array('id'=&gt;<a class="var it19816" onMouseOver="hilite(19816)" onMouseOut="lolite()" onClick="logVariable('oldassignmentid')" href="../../_variables/oldassignmentid.html">$oldassignmentid</a>), '*', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l80"><span class="linenum">  80</span></a>  
<a name="l81"><span class="linenum">  81</span></a>          <a class="var it671" onMouseOver="hilite(671)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a> = <a class="function" onClick="logFunction('get_config')" href="../../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>('assignment_' . <a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>-&gt;<a onClick="logVariable('assignmenttype')" class="var it39628" onMouseOver="hilite(39628)" onMouseOut="lolite()" href="../../_variables/assignmenttype.html">assignmenttype</a>, 'version');
<a name="l82"><span class="linenum">  82</span></a>  
<a name="l83"><span class="linenum">  83</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a> = new stdClass();
<a name="l84"><span class="linenum">  84</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('course')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/course.html">course</a> = <a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>-&gt;<a onClick="logVariable('course')" class="var it39628" onMouseOver="hilite(39628)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>;
<a name="l85"><span class="linenum">  85</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('name')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/name.html">name</a> = <a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>-&gt;<a onClick="logVariable('name')" class="var it39628" onMouseOver="hilite(39628)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>;
<a name="l86"><span class="linenum">  86</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('intro')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/intro.html">intro</a> = <a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>-&gt;<a onClick="logVariable('intro')" class="var it39628" onMouseOver="hilite(39628)" onMouseOut="lolite()" href="../../_variables/intro.html">intro</a>;
<a name="l87"><span class="linenum">  87</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('introformat')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/introformat.html">introformat</a> = <a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>-&gt;<a onClick="logVariable('introformat')" class="var it39628" onMouseOver="hilite(39628)" onMouseOut="lolite()" href="../../_variables/introformat.html">introformat</a>;
<a name="l88"><span class="linenum">  88</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('alwaysshowdescription')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/alwaysshowdescription.html">alwaysshowdescription</a> = 1;
<a name="l89"><span class="linenum">  89</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('sendnotifications')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/sendnotifications.html">sendnotifications</a> = <a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>-&gt;<a onClick="logVariable('emailteachers')" class="var it39628" onMouseOver="hilite(39628)" onMouseOut="lolite()" href="../../_variables/emailteachers.html">emailteachers</a>;
<a name="l90"><span class="linenum">  90</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('sendlatenotifications')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/sendlatenotifications.html">sendlatenotifications</a> = <a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>-&gt;<a onClick="logVariable('emailteachers')" class="var it39628" onMouseOver="hilite(39628)" onMouseOut="lolite()" href="../../_variables/emailteachers.html">emailteachers</a>;
<a name="l91"><span class="linenum">  91</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('duedate')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/duedate.html">duedate</a> = <a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>-&gt;<a onClick="logVariable('timedue')" class="var it39628" onMouseOver="hilite(39628)" onMouseOut="lolite()" href="../../_variables/timedue.html">timedue</a>;
<a name="l92"><span class="linenum">  92</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('allowsubmissionsfromdate')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/allowsubmissionsfromdate.html">allowsubmissionsfromdate</a> = <a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>-&gt;<a onClick="logVariable('timeavailable')" class="var it39628" onMouseOver="hilite(39628)" onMouseOut="lolite()" href="../../_variables/timeavailable.html">timeavailable</a>;
<a name="l93"><span class="linenum">  93</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('grade')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> = <a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>-&gt;<a onClick="logVariable('grade')" class="var it39628" onMouseOver="hilite(39628)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a>;
<a name="l94"><span class="linenum">  94</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('submissiondrafts')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/submissiondrafts.html">submissiondrafts</a> = <a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>-&gt;<a onClick="logVariable('resubmit')" class="var it39628" onMouseOver="hilite(39628)" onMouseOut="lolite()" href="../../_variables/resubmit.html">resubmit</a>;
<a name="l95"><span class="linenum">  95</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('requiresubmissionstatement')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/requiresubmissionstatement.html">requiresubmissionstatement</a> = 0;
<a name="l96"><span class="linenum">  96</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('markingworkflow')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/markingworkflow.html">markingworkflow</a> = 0;
<a name="l97"><span class="linenum">  97</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('markingallocation')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/markingallocation.html">markingallocation</a> = 0;
<a name="l98"><span class="linenum">  98</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('cutoffdate')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/cutoffdate.html">cutoffdate</a> = 0;
<a name="l99"><span class="linenum">  99</span></a>  <span class="comment">        // New way to specify no late submissions.</span>
<a name="l100"><span class="linenum"> 100</span></a>          if (<a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>-&gt;<a onClick="logVariable('preventlate')" class="var it39628" onMouseOver="hilite(39628)" onMouseOut="lolite()" href="../../_variables/preventlate.html">preventlate</a>) {
<a name="l101"><span class="linenum"> 101</span></a>              <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('cutoffdate')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/cutoffdate.html">cutoffdate</a> = <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('duedate')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/duedate.html">duedate</a>;
<a name="l102"><span class="linenum"> 102</span></a>          }
<a name="l103"><span class="linenum"> 103</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('teamsubmission')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/teamsubmission.html">teamsubmission</a> = 0;
<a name="l104"><span class="linenum"> 104</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('requireallteammemberssubmit')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/requireallteammemberssubmit.html">requireallteammemberssubmit</a> = 0;
<a name="l105"><span class="linenum"> 105</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('teamsubmissiongroupingid')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/teamsubmissiongroupingid.html">teamsubmissiongroupingid</a> = 0;
<a name="l106"><span class="linenum"> 106</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('blindmarking')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/blindmarking.html">blindmarking</a> = 0;
<a name="l107"><span class="linenum"> 107</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('attemptreopenmethod')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/attemptreopenmethod.html">attemptreopenmethod</a> = 'none';
<a name="l108"><span class="linenum"> 108</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('maxattempts')" class="var it39495" onMouseOver="hilite(39495)" onMouseOut="lolite()" href="../../_variables/maxattempts.html">maxattempts</a> = <a class="constant" onClick="logConstant('ASSIGN_UNLIMITED_ATTEMPTS')" href="../../_constants/ASSIGN_UNLIMITED_ATTEMPTS.html" onMouseOver="constPopup(event,'ASSIGN_UNLIMITED_ATTEMPTS')">ASSIGN_UNLIMITED_ATTEMPTS</a>;
<a name="l109"><span class="linenum"> 109</span></a>  
<a name="l110"><span class="linenum"> 110</span></a>          <a class="var it19823" onMouseOver="hilite(19823)" onMouseOut="lolite()" onClick="logVariable('newassignment')" href="../../_variables/newassignment.html">$newassignment</a> = <span class="keyword">new </span><a class="class" onClick="logClass('assign')" href="../../_classes/assign.html" onMouseOver="classPopup(event,'assign')">assign</a>(null, null, null);
<a name="l111"><span class="linenum"> 111</span></a>  
<a name="l112"><span class="linenum"> 112</span></a>          if (!<a class="var it19823" onMouseOver="hilite(19823)" onMouseOut="lolite()" onClick="logVariable('newassignment')" href="../../_variables/newassignment.html">$newassignment</a>-&gt;<a class="function" onClick="logFunction('add_instance')" href="../../_functions/add_instance.html" onMouseOver="funcPopup(event,'add_instance')">add_instance</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>, false)) {
<a name="l113"><span class="linenum"> 113</span></a>              <a class="var it1193" onMouseOver="hilite(1193)" onMouseOut="lolite()" onClick="logVariable('log')" href="../../_variables/log.html">$log</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('couldnotcreatenewassignmentinstance', 'mod_assign');
<a name="l114"><span class="linenum"> 114</span></a>              return false;
<a name="l115"><span class="linenum"> 115</span></a>          }
<a name="l116"><span class="linenum"> 116</span></a>  
<a name="l117"><span class="linenum"> 117</span></a>  <span class="comment">        // Now create a new coursemodule from the old one.</span>
<a name="l118"><span class="linenum"> 118</span></a>          <a class="var it19824" onMouseOver="hilite(19824)" onMouseOut="lolite()" onClick="logVariable('newmodule')" href="../../_variables/newmodule.html">$newmodule</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('modules', array('name'=&gt;'assign'), '*', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l119"><span class="linenum"> 119</span></a>          <a class="var it19825" onMouseOver="hilite(19825)" onMouseOut="lolite()" onClick="logVariable('newcoursemodule')" href="../../_variables/newcoursemodule.html">$newcoursemodule</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('duplicate_course_module')" href="../../_functions/duplicate_course_module.html" onMouseOver="funcPopup(event,'duplicate_course_module')">duplicate_course_module</a>(<a class="var it19818" onMouseOver="hilite(19818)" onMouseOut="lolite()" onClick="logVariable('oldcoursemodule')" href="../../_variables/oldcoursemodule.html">$oldcoursemodule</a>,
<a name="l120"><span class="linenum"> 120</span></a>                                                            <a class="var it19824" onMouseOver="hilite(19824)" onMouseOut="lolite()" onClick="logVariable('newmodule')" href="../../_variables/newmodule.html">$newmodule</a>-&gt;<a onClick="logVariable('id')" class="var it41180" onMouseOver="hilite(41180)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l121"><span class="linenum"> 121</span></a>                                                            <a class="var it19823" onMouseOver="hilite(19823)" onMouseOut="lolite()" onClick="logVariable('newassignment')" href="../../_variables/newassignment.html">$newassignment</a>-&gt;<a class="function" onClick="logFunction('get_instance')" href="../../_functions/get_instance.html" onMouseOver="funcPopup(event,'get_instance')">get_instance</a>()-&gt;id);
<a name="l122"><span class="linenum"> 122</span></a>          if (!<a class="var it19825" onMouseOver="hilite(19825)" onMouseOut="lolite()" onClick="logVariable('newcoursemodule')" href="../../_variables/newcoursemodule.html">$newcoursemodule</a>) {
<a name="l123"><span class="linenum"> 123</span></a>              <a class="var it1193" onMouseOver="hilite(1193)" onMouseOut="lolite()" onClick="logVariable('log')" href="../../_variables/log.html">$log</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('couldnotcreatenewcoursemodule', 'mod_assign');
<a name="l124"><span class="linenum"> 124</span></a>              return false;
<a name="l125"><span class="linenum"> 125</span></a>          }
<a name="l126"><span class="linenum"> 126</span></a>  
<a name="l127"><span class="linenum"> 127</span></a>  <span class="comment">        // Convert the base database tables (assignment, submission, grade).</span>
<a name="l128"><span class="linenum"> 128</span></a>  
<a name="l129"><span class="linenum"> 129</span></a>  <span class="comment">        // These are used to store information in case a rollback is required.</span>
<a name="l130"><span class="linenum"> 130</span></a>          <a class="var it1593" onMouseOver="hilite(1593)" onMouseOut="lolite()" onClick="logVariable('gradingarea')" href="../../_variables/gradingarea.html">$gradingarea</a> = null;
<a name="l131"><span class="linenum"> 131</span></a>          <a class="var it19826" onMouseOver="hilite(19826)" onMouseOut="lolite()" onClick="logVariable('gradingdefinitions')" href="../../_variables/gradingdefinitions.html">$gradingdefinitions</a> = null;
<a name="l132"><span class="linenum"> 132</span></a>          <a class="var it19827" onMouseOver="hilite(19827)" onMouseOut="lolite()" onClick="logVariable('gradeidmap')" href="../../_variables/gradeidmap.html">$gradeidmap</a> = array();
<a name="l133"><span class="linenum"> 133</span></a>          <a class="var it19828" onMouseOver="hilite(19828)" onMouseOut="lolite()" onClick="logVariable('completiondone')" href="../../_variables/completiondone.html">$completiondone</a> = false;
<a name="l134"><span class="linenum"> 134</span></a>          <a class="var it19829" onMouseOver="hilite(19829)" onMouseOut="lolite()" onClick="logVariable('gradesdone')" href="../../_variables/gradesdone.html">$gradesdone</a> = false;
<a name="l135"><span class="linenum"> 135</span></a>  
<a name="l136"><span class="linenum"> 136</span></a>  <span class="comment">        // From this point we want to rollback on failure.</span>
<a name="l137"><span class="linenum"> 137</span></a>          <a class="var it19830" onMouseOver="hilite(19830)" onMouseOut="lolite()" onClick="logVariable('rollback')" href="../../_variables/rollback.html">$rollback</a> = false;
<a name="l138"><span class="linenum"> 138</span></a>          try {
<a name="l139"><span class="linenum"> 139</span></a>              <a class="var it19823" onMouseOver="hilite(19823)" onMouseOut="lolite()" onClick="logVariable('newassignment')" href="../../_variables/newassignment.html">$newassignment</a>-&gt;<a class="function" onClick="logFunction('set_context')" href="../../_functions/set_context.html" onMouseOver="funcPopup(event,'set_context')">set_context</a>(<a class="class" onClick="logClass('context_module')" href="../../_classes/context_module.html" onMouseOver="classPopup(event,'context_module')">context_module</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it19825" onMouseOver="hilite(19825)" onMouseOut="lolite()" onClick="logVariable('newcoursemodule')" href="../../_variables/newcoursemodule.html">$newcoursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it41181" onMouseOver="hilite(41181)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l140"><span class="linenum"> 140</span></a>  
<a name="l141"><span class="linenum"> 141</span></a>  <span class="comment">            // The course module has now been created - time to update the core tables.</span>
<a name="l142"><span class="linenum"> 142</span></a>  
<a name="l143"><span class="linenum"> 143</span></a>  <span class="comment">            // Copy intro files.</span>
<a name="l144"><span class="linenum"> 144</span></a>              <a class="var it19823" onMouseOver="hilite(19823)" onMouseOut="lolite()" onClick="logVariable('newassignment')" href="../../_variables/newassignment.html">$newassignment</a>-&gt;<a class="function" onClick="logFunction('copy_area_files_for_upgrade')" href="../../_functions/copy_area_files_for_upgrade.html" onMouseOver="funcPopup(event,'copy_area_files_for_upgrade')">copy_area_files_for_upgrade</a>(<a class="var it4359" onMouseOver="hilite(4359)" onMouseOut="lolite()" onClick="logVariable('oldcontext')" href="../../_variables/oldcontext.html">$oldcontext</a>-&gt;<a onClick="logVariable('id')" class="var it39630" onMouseOver="hilite(39630)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'mod_assignment', 'intro', 0,
<a name="l145"><span class="linenum"> 145</span></a>                                              <a class="var it19823" onMouseOver="hilite(19823)" onMouseOut="lolite()" onClick="logVariable('newassignment')" href="../../_variables/newassignment.html">$newassignment</a>-&gt;<a class="function" onClick="logFunction('get_context')" href="../../_functions/get_context.html" onMouseOver="funcPopup(event,'get_context')">get_context</a>()-&gt;id, 'mod_assign', 'intro', 0);
<a name="l146"><span class="linenum"> 146</span></a>  
<a name="l147"><span class="linenum"> 147</span></a>  <span class="comment">            // Get the plugins to do their bit.</span>
<a name="l148"><span class="linenum"> 148</span></a>              foreach (<a class="var it19823" onMouseOver="hilite(19823)" onMouseOut="lolite()" onClick="logVariable('newassignment')" href="../../_variables/newassignment.html">$newassignment</a>-&gt;<a class="function" onClick="logFunction('get_submission_plugins')" href="../../_functions/get_submission_plugins.html" onMouseOver="funcPopup(event,'get_submission_plugins')">get_submission_plugins</a>() as <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>) {
<a name="l149"><span class="linenum"> 149</span></a>                  if (<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>-&gt;<a class="function" onClick="logFunction('can_upgrade')" href="../../_functions/can_upgrade.html" onMouseOver="funcPopup(event,'can_upgrade')">can_upgrade</a>(<a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>-&gt;<a onClick="logVariable('assignmenttype')" class="var it39628" onMouseOver="hilite(39628)" onMouseOut="lolite()" href="../../_variables/assignmenttype.html">assignmenttype</a>, <a class="var it671" onMouseOver="hilite(671)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a>)) {
<a name="l150"><span class="linenum"> 150</span></a>                      <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>-&gt;<a class="function" onClick="logFunction('enable')" href="../../_functions/enable.html" onMouseOver="funcPopup(event,'enable')">enable</a>();
<a name="l151"><span class="linenum"> 151</span></a>                      if (!<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>-&gt;<a class="function" onClick="logFunction('upgrade_settings')" href="../../_functions/upgrade_settings.html" onMouseOver="funcPopup(event,'upgrade_settings')">upgrade_settings</a>(<a class="var it4359" onMouseOver="hilite(4359)" onMouseOut="lolite()" onClick="logVariable('oldcontext')" href="../../_variables/oldcontext.html">$oldcontext</a>, <a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>, <a class="var it1193" onMouseOver="hilite(1193)" onMouseOut="lolite()" onClick="logVariable('log')" href="../../_variables/log.html">$log</a>)) {
<a name="l152"><span class="linenum"> 152</span></a>                          <a class="var it19830" onMouseOver="hilite(19830)" onMouseOut="lolite()" onClick="logVariable('rollback')" href="../../_variables/rollback.html">$rollback</a> = true;
<a name="l153"><span class="linenum"> 153</span></a>                      }
<a name="l154"><span class="linenum"> 154</span></a>                  } else {
<a name="l155"><span class="linenum"> 155</span></a>                      <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>-&gt;<a class="function" onClick="logFunction('disable')" href="../../_functions/disable.html" onMouseOver="funcPopup(event,'disable')">disable</a>();
<a name="l156"><span class="linenum"> 156</span></a>                  }
<a name="l157"><span class="linenum"> 157</span></a>              }
<a name="l158"><span class="linenum"> 158</span></a>              foreach (<a class="var it19823" onMouseOver="hilite(19823)" onMouseOut="lolite()" onClick="logVariable('newassignment')" href="../../_variables/newassignment.html">$newassignment</a>-&gt;<a class="function" onClick="logFunction('get_feedback_plugins')" href="../../_functions/get_feedback_plugins.html" onMouseOver="funcPopup(event,'get_feedback_plugins')">get_feedback_plugins</a>() as <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>) {
<a name="l159"><span class="linenum"> 159</span></a>                  if (<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>-&gt;<a class="function" onClick="logFunction('can_upgrade')" href="../../_functions/can_upgrade.html" onMouseOver="funcPopup(event,'can_upgrade')">can_upgrade</a>(<a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>-&gt;<a onClick="logVariable('assignmenttype')" class="var it39628" onMouseOver="hilite(39628)" onMouseOut="lolite()" href="../../_variables/assignmenttype.html">assignmenttype</a>, <a class="var it671" onMouseOver="hilite(671)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a>)) {
<a name="l160"><span class="linenum"> 160</span></a>                      <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>-&gt;<a class="function" onClick="logFunction('enable')" href="../../_functions/enable.html" onMouseOver="funcPopup(event,'enable')">enable</a>();
<a name="l161"><span class="linenum"> 161</span></a>                      if (!<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>-&gt;<a class="function" onClick="logFunction('upgrade_settings')" href="../../_functions/upgrade_settings.html" onMouseOver="funcPopup(event,'upgrade_settings')">upgrade_settings</a>(<a class="var it4359" onMouseOver="hilite(4359)" onMouseOut="lolite()" onClick="logVariable('oldcontext')" href="../../_variables/oldcontext.html">$oldcontext</a>, <a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>, <a class="var it1193" onMouseOver="hilite(1193)" onMouseOut="lolite()" onClick="logVariable('log')" href="../../_variables/log.html">$log</a>)) {
<a name="l162"><span class="linenum"> 162</span></a>                          <a class="var it19830" onMouseOver="hilite(19830)" onMouseOut="lolite()" onClick="logVariable('rollback')" href="../../_variables/rollback.html">$rollback</a> = true;
<a name="l163"><span class="linenum"> 163</span></a>                      }
<a name="l164"><span class="linenum"> 164</span></a>                  } else {
<a name="l165"><span class="linenum"> 165</span></a>                      <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>-&gt;<a class="function" onClick="logFunction('disable')" href="../../_functions/disable.html" onMouseOver="funcPopup(event,'disable')">disable</a>();
<a name="l166"><span class="linenum"> 166</span></a>                  }
<a name="l167"><span class="linenum"> 167</span></a>              }
<a name="l168"><span class="linenum"> 168</span></a>  
<a name="l169"><span class="linenum"> 169</span></a>  <span class="comment">            // See if there is advanced grading upgrades required.</span>
<a name="l170"><span class="linenum"> 170</span></a>              <a class="var it1593" onMouseOver="hilite(1593)" onMouseOut="lolite()" onClick="logVariable('gradingarea')" href="../../_variables/gradingarea.html">$gradingarea</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('grading_areas',
<a name="l171"><span class="linenum"> 171</span></a>                                             array('contextid'=&gt;<a class="var it4359" onMouseOver="hilite(4359)" onMouseOut="lolite()" onClick="logVariable('oldcontext')" href="../../_variables/oldcontext.html">$oldcontext</a>-&gt;<a onClick="logVariable('id')" class="var it39630" onMouseOver="hilite(39630)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'areaname'=&gt;'submission'),
<a name="l172"><span class="linenum"> 172</span></a>                                             '*',
<a name="l173"><span class="linenum"> 173</span></a>                                             <a class="constant" onClick="logConstant('IGNORE_MISSING')" href="../../_constants/IGNORE_MISSING.html" onMouseOver="constPopup(event,'IGNORE_MISSING')">IGNORE_MISSING</a>);
<a name="l174"><span class="linenum"> 174</span></a>              if (<a class="var it1593" onMouseOver="hilite(1593)" onMouseOut="lolite()" onClick="logVariable('gradingarea')" href="../../_variables/gradingarea.html">$gradingarea</a>) {
<a name="l175"><span class="linenum"> 175</span></a>                  <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('id'=&gt;<a class="var it1593" onMouseOver="hilite(1593)" onMouseOut="lolite()" onClick="logVariable('gradingarea')" href="../../_variables/gradingarea.html">$gradingarea</a>-&gt;<a onClick="logVariable('id')" class="var it41182" onMouseOver="hilite(41182)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l176"><span class="linenum"> 176</span></a>                                  'contextid'=&gt;<a class="var it19823" onMouseOver="hilite(19823)" onMouseOut="lolite()" onClick="logVariable('newassignment')" href="../../_variables/newassignment.html">$newassignment</a>-&gt;<a class="function" onClick="logFunction('get_context')" href="../../_functions/get_context.html" onMouseOver="funcPopup(event,'get_context')">get_context</a>()-&gt;id,
<a name="l177"><span class="linenum"> 177</span></a>                                  'component'=&gt;'mod_assign',
<a name="l178"><span class="linenum"> 178</span></a>                                  'areaname'=&gt;'submissions');
<a name="l179"><span class="linenum"> 179</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('grading_areas', <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l180"><span class="linenum"> 180</span></a>                  <a class="var it19826" onMouseOver="hilite(19826)" onMouseOut="lolite()" onClick="logVariable('gradingdefinitions')" href="../../_variables/gradingdefinitions.html">$gradingdefinitions</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('grading_definitions',
<a name="l181"><span class="linenum"> 181</span></a>                                                         array('areaid'=&gt;<a class="var it1593" onMouseOver="hilite(1593)" onMouseOut="lolite()" onClick="logVariable('gradingarea')" href="../../_variables/gradingarea.html">$gradingarea</a>-&gt;<a onClick="logVariable('id')" class="var it41182" onMouseOver="hilite(41182)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l182"><span class="linenum"> 182</span></a>              }
<a name="l183"><span class="linenum"> 183</span></a>  
<a name="l184"><span class="linenum"> 184</span></a>  <span class="comment">            // Upgrade availability data.</span>
<a name="l185"><span class="linenum"> 185</span></a>              \core_availability\<a class="class" onClick="logClass('info')" href="../../_classes/info.html" onMouseOver="classPopup(event,'info')">info</a>::<a class="function" onClick="logFunction('update_dependency_id_across_course')" href="../../_functions/update_dependency_id_across_course.html" onMouseOver="funcPopup(event,'update_dependency_id_across_course')">update_dependency_id_across_course</a>(
<a name="l186"><span class="linenum"> 186</span></a>                      <a class="var it19825" onMouseOver="hilite(19825)" onMouseOut="lolite()" onClick="logVariable('newcoursemodule')" href="../../_variables/newcoursemodule.html">$newcoursemodule</a>-&gt;<a onClick="logVariable('course')" class="var it41181" onMouseOver="hilite(41181)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>, 'course_modules', <a class="var it19818" onMouseOver="hilite(19818)" onMouseOut="lolite()" onClick="logVariable('oldcoursemodule')" href="../../_variables/oldcoursemodule.html">$oldcoursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it41179" onMouseOver="hilite(41179)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it19825" onMouseOver="hilite(19825)" onMouseOut="lolite()" onClick="logVariable('newcoursemodule')" href="../../_variables/newcoursemodule.html">$newcoursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it41181" onMouseOver="hilite(41181)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l187"><span class="linenum"> 187</span></a>  
<a name="l188"><span class="linenum"> 188</span></a>  <span class="comment">            // Upgrade completion data.</span>
<a name="l189"><span class="linenum"> 189</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('course_modules_completion',
<a name="l190"><span class="linenum"> 190</span></a>                             'coursemoduleid',
<a name="l191"><span class="linenum"> 191</span></a>                             <a class="var it19825" onMouseOver="hilite(19825)" onMouseOut="lolite()" onClick="logVariable('newcoursemodule')" href="../../_variables/newcoursemodule.html">$newcoursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it41181" onMouseOver="hilite(41181)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l192"><span class="linenum"> 192</span></a>                             array('coursemoduleid'=&gt;<a class="var it19818" onMouseOver="hilite(19818)" onMouseOut="lolite()" onClick="logVariable('oldcoursemodule')" href="../../_variables/oldcoursemodule.html">$oldcoursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it41179" onMouseOver="hilite(41179)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l193"><span class="linenum"> 193</span></a>              <a class="var it19831" onMouseOver="hilite(19831)" onMouseOut="lolite()" onClick="logVariable('allcriteria')" href="../../_variables/allcriteria.html">$allcriteria</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('course_completion_criteria',
<a name="l194"><span class="linenum"> 194</span></a>                                              array('moduleinstance'=&gt;<a class="var it19818" onMouseOver="hilite(19818)" onMouseOut="lolite()" onClick="logVariable('oldcoursemodule')" href="../../_variables/oldcoursemodule.html">$oldcoursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it41179" onMouseOver="hilite(41179)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l195"><span class="linenum"> 195</span></a>              foreach (<a class="var it19831" onMouseOver="hilite(19831)" onMouseOut="lolite()" onClick="logVariable('allcriteria')" href="../../_variables/allcriteria.html">$allcriteria</a> as <a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../_variables/criteria.html">$criteria</a>) {
<a name="l196"><span class="linenum"> 196</span></a>                  <a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../_variables/criteria.html">$criteria</a>-&gt;<a onClick="logVariable('module')" class="var it40246" onMouseOver="hilite(40246)" onMouseOut="lolite()" href="../../_variables/module.html">module</a> = 'assign';
<a name="l197"><span class="linenum"> 197</span></a>                  <a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../_variables/criteria.html">$criteria</a>-&gt;<a onClick="logVariable('moduleinstance')" class="var it40246" onMouseOver="hilite(40246)" onMouseOut="lolite()" href="../../_variables/moduleinstance.html">moduleinstance</a> = <a class="var it19825" onMouseOver="hilite(19825)" onMouseOut="lolite()" onClick="logVariable('newcoursemodule')" href="../../_variables/newcoursemodule.html">$newcoursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it41181" onMouseOver="hilite(41181)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l198"><span class="linenum"> 198</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('course_completion_criteria', <a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../_variables/criteria.html">$criteria</a>);
<a name="l199"><span class="linenum"> 199</span></a>              }
<a name="l200"><span class="linenum"> 200</span></a>              <a class="var it19828" onMouseOver="hilite(19828)" onMouseOut="lolite()" onClick="logVariable('completiondone')" href="../../_variables/completiondone.html">$completiondone</a> = true;
<a name="l201"><span class="linenum"> 201</span></a>  
<a name="l202"><span class="linenum"> 202</span></a>  <span class="comment">            // Migrate log entries so we don't lose them.</span>
<a name="l203"><span class="linenum"> 203</span></a>              <a class="var it19832" onMouseOver="hilite(19832)" onMouseOut="lolite()" onClick="logVariable('logparams')" href="../../_variables/logparams.html">$logparams</a> = array('cmid' =&gt; <a class="var it19818" onMouseOver="hilite(19818)" onMouseOut="lolite()" onClick="logVariable('oldcoursemodule')" href="../../_variables/oldcoursemodule.html">$oldcoursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it41179" onMouseOver="hilite(41179)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'course' =&gt; <a class="var it19818" onMouseOver="hilite(19818)" onMouseOut="lolite()" onClick="logVariable('oldcoursemodule')" href="../../_variables/oldcoursemodule.html">$oldcoursemodule</a>-&gt;<a onClick="logVariable('course')" class="var it41179" onMouseOver="hilite(41179)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>);
<a name="l204"><span class="linenum"> 204</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('log', 'module', 'assign', <a class="var it19832" onMouseOver="hilite(19832)" onMouseOut="lolite()" onClick="logVariable('logparams')" href="../../_variables/logparams.html">$logparams</a>);
<a name="l205"><span class="linenum"> 205</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('log', 'cmid', <a class="var it19825" onMouseOver="hilite(19825)" onMouseOut="lolite()" onClick="logVariable('newcoursemodule')" href="../../_variables/newcoursemodule.html">$newcoursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it41181" onMouseOver="hilite(41181)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it19832" onMouseOver="hilite(19832)" onMouseOut="lolite()" onClick="logVariable('logparams')" href="../../_variables/logparams.html">$logparams</a>);
<a name="l206"><span class="linenum"> 206</span></a>  
<a name="l207"><span class="linenum"> 207</span></a>  <span class="comment">            // Copy all the submission data (and get plugins to do their bit).</span>
<a name="l208"><span class="linenum"> 208</span></a>              <a class="var it19833" onMouseOver="hilite(19833)" onMouseOut="lolite()" onClick="logVariable('oldsubmissions')" href="../../_variables/oldsubmissions.html">$oldsubmissions</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('assignment_submissions',
<a name="l209"><span class="linenum"> 209</span></a>                                                 array('assignment'=&gt;<a class="var it19816" onMouseOver="hilite(19816)" onMouseOut="lolite()" onClick="logVariable('oldassignmentid')" href="../../_variables/oldassignmentid.html">$oldassignmentid</a>));
<a name="l210"><span class="linenum"> 210</span></a>  
<a name="l211"><span class="linenum"> 211</span></a>              foreach (<a class="var it19833" onMouseOver="hilite(19833)" onMouseOut="lolite()" onClick="logVariable('oldsubmissions')" href="../../_variables/oldsubmissions.html">$oldsubmissions</a> as <a class="var it8761" onMouseOver="hilite(8761)" onMouseOut="lolite()" onClick="logVariable('oldsubmission')" href="../../_variables/oldsubmission.html">$oldsubmission</a>) {
<a name="l212"><span class="linenum"> 212</span></a>                  <a class="var it4364" onMouseOver="hilite(4364)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../_variables/submission.html">$submission</a> = new stdClass();
<a name="l213"><span class="linenum"> 213</span></a>                  <a class="var it4364" onMouseOver="hilite(4364)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../_variables/submission.html">$submission</a>-&gt;<a onClick="logVariable('assignment')" class="var it39626" onMouseOver="hilite(39626)" onMouseOut="lolite()" href="../../_variables/assignment.html">assignment</a> = <a class="var it19823" onMouseOver="hilite(19823)" onMouseOut="lolite()" onClick="logVariable('newassignment')" href="../../_variables/newassignment.html">$newassignment</a>-&gt;<a class="function" onClick="logFunction('get_instance')" href="../../_functions/get_instance.html" onMouseOver="funcPopup(event,'get_instance')">get_instance</a>()-&gt;id;
<a name="l214"><span class="linenum"> 214</span></a>                  <a class="var it4364" onMouseOver="hilite(4364)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../_variables/submission.html">$submission</a>-&gt;<a onClick="logVariable('userid')" class="var it39626" onMouseOver="hilite(39626)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> = <a class="var it8761" onMouseOver="hilite(8761)" onMouseOut="lolite()" onClick="logVariable('oldsubmission')" href="../../_variables/oldsubmission.html">$oldsubmission</a>-&gt;<a onClick="logVariable('userid')" class="var it39629" onMouseOver="hilite(39629)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>;
<a name="l215"><span class="linenum"> 215</span></a>                  <a class="var it4364" onMouseOver="hilite(4364)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../_variables/submission.html">$submission</a>-&gt;<a onClick="logVariable('timecreated')" class="var it39626" onMouseOver="hilite(39626)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a> = <a class="var it8761" onMouseOver="hilite(8761)" onMouseOut="lolite()" onClick="logVariable('oldsubmission')" href="../../_variables/oldsubmission.html">$oldsubmission</a>-&gt;<a onClick="logVariable('timecreated')" class="var it39629" onMouseOver="hilite(39629)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a>;
<a name="l216"><span class="linenum"> 216</span></a>                  <a class="var it4364" onMouseOver="hilite(4364)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../_variables/submission.html">$submission</a>-&gt;<a onClick="logVariable('timemodified')" class="var it39626" onMouseOver="hilite(39626)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="var it8761" onMouseOver="hilite(8761)" onMouseOut="lolite()" onClick="logVariable('oldsubmission')" href="../../_variables/oldsubmission.html">$oldsubmission</a>-&gt;<a onClick="logVariable('timemodified')" class="var it39629" onMouseOver="hilite(39629)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a>;
<a name="l217"><span class="linenum"> 217</span></a>                  <a class="var it4364" onMouseOver="hilite(4364)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../_variables/submission.html">$submission</a>-&gt;<a onClick="logVariable('status')" class="var it39626" onMouseOver="hilite(39626)" onMouseOut="lolite()" href="../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('ASSIGN_SUBMISSION_STATUS_SUBMITTED')" href="../../_constants/ASSIGN_SUBMISSION_STATUS_SUBMITTED.html" onMouseOver="constPopup(event,'ASSIGN_SUBMISSION_STATUS_SUBMITTED')">ASSIGN_SUBMISSION_STATUS_SUBMITTED</a>;
<a name="l218"><span class="linenum"> 218</span></a>  <span class="comment">                // Because in mod_assignment there could only be one submission per student, it is always the latest.</span>
<a name="l219"><span class="linenum"> 219</span></a>                  <a class="var it4364" onMouseOver="hilite(4364)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../_variables/submission.html">$submission</a>-&gt;<a onClick="logVariable('latest')" class="var it39626" onMouseOver="hilite(39626)" onMouseOut="lolite()" href="../../_variables/latest.html">latest</a> = 1;
<a name="l220"><span class="linenum"> 220</span></a>                  <a class="var it4364" onMouseOver="hilite(4364)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../_variables/submission.html">$submission</a>-&gt;<a onClick="logVariable('id')" class="var it39626" onMouseOver="hilite(39626)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('assign_submission', <a class="var it4364" onMouseOver="hilite(4364)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../_variables/submission.html">$submission</a>);
<a name="l221"><span class="linenum"> 221</span></a>                  if (!<a class="var it4364" onMouseOver="hilite(4364)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../_variables/submission.html">$submission</a>-&gt;<a onClick="logVariable('id')" class="var it39626" onMouseOver="hilite(39626)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>) {
<a name="l222"><span class="linenum"> 222</span></a>                      <a class="var it1193" onMouseOver="hilite(1193)" onMouseOut="lolite()" onClick="logVariable('log')" href="../../_variables/log.html">$log</a> .= <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('couldnotinsertsubmission', 'mod_assign', <a class="var it4364" onMouseOver="hilite(4364)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../_variables/submission.html">$submission</a>-&gt;<a onClick="logVariable('userid')" class="var it39626" onMouseOver="hilite(39626)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>);
<a name="l223"><span class="linenum"> 223</span></a>                      <a class="var it19830" onMouseOver="hilite(19830)" onMouseOut="lolite()" onClick="logVariable('rollback')" href="../../_variables/rollback.html">$rollback</a> = true;
<a name="l224"><span class="linenum"> 224</span></a>                  }
<a name="l225"><span class="linenum"> 225</span></a>                  foreach (<a class="var it19823" onMouseOver="hilite(19823)" onMouseOut="lolite()" onClick="logVariable('newassignment')" href="../../_variables/newassignment.html">$newassignment</a>-&gt;<a class="function" onClick="logFunction('get_submission_plugins')" href="../../_functions/get_submission_plugins.html" onMouseOver="funcPopup(event,'get_submission_plugins')">get_submission_plugins</a>() as <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>) {
<a name="l226"><span class="linenum"> 226</span></a>                      if (<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>-&gt;<a class="function" onClick="logFunction('can_upgrade')" href="../../_functions/can_upgrade.html" onMouseOver="funcPopup(event,'can_upgrade')">can_upgrade</a>(<a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>-&gt;<a onClick="logVariable('assignmenttype')" class="var it39628" onMouseOver="hilite(39628)" onMouseOut="lolite()" href="../../_variables/assignmenttype.html">assignmenttype</a>, <a class="var it671" onMouseOver="hilite(671)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a>)) {
<a name="l227"><span class="linenum"> 227</span></a>                          if (!<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>-&gt;<a class="function" onClick="logFunction('upgrade')" href="../../_functions/upgrade.html" onMouseOver="funcPopup(event,'upgrade')">upgrade</a>(<a class="var it4359" onMouseOver="hilite(4359)" onMouseOut="lolite()" onClick="logVariable('oldcontext')" href="../../_variables/oldcontext.html">$oldcontext</a>,
<a name="l228"><span class="linenum"> 228</span></a>                                                <a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>,
<a name="l229"><span class="linenum"> 229</span></a>                                                <a class="var it8761" onMouseOver="hilite(8761)" onMouseOut="lolite()" onClick="logVariable('oldsubmission')" href="../../_variables/oldsubmission.html">$oldsubmission</a>,
<a name="l230"><span class="linenum"> 230</span></a>                                                <a class="var it4364" onMouseOver="hilite(4364)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../_variables/submission.html">$submission</a>,
<a name="l231"><span class="linenum"> 231</span></a>                                                <a class="var it1193" onMouseOver="hilite(1193)" onMouseOut="lolite()" onClick="logVariable('log')" href="../../_variables/log.html">$log</a>)) {
<a name="l232"><span class="linenum"> 232</span></a>                              <a class="var it19830" onMouseOver="hilite(19830)" onMouseOut="lolite()" onClick="logVariable('rollback')" href="../../_variables/rollback.html">$rollback</a> = true;
<a name="l233"><span class="linenum"> 233</span></a>                          }
<a name="l234"><span class="linenum"> 234</span></a>                      }
<a name="l235"><span class="linenum"> 235</span></a>                  }
<a name="l236"><span class="linenum"> 236</span></a>                  if (<a class="var it8761" onMouseOver="hilite(8761)" onMouseOut="lolite()" onClick="logVariable('oldsubmission')" href="../../_variables/oldsubmission.html">$oldsubmission</a>-&gt;<a onClick="logVariable('timemarked')" class="var it39629" onMouseOver="hilite(39629)" onMouseOut="lolite()" href="../../_variables/timemarked.html">timemarked</a>) {
<a name="l237"><span class="linenum"> 237</span></a>  <span class="comment">                    // Submission has been graded - create a grade record.</span>
<a name="l238"><span class="linenum"> 238</span></a>                      <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a> = new stdClass();
<a name="l239"><span class="linenum"> 239</span></a>                      <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('assignment')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/assignment.html">assignment</a> = <a class="var it19823" onMouseOver="hilite(19823)" onMouseOut="lolite()" onClick="logVariable('newassignment')" href="../../_variables/newassignment.html">$newassignment</a>-&gt;<a class="function" onClick="logFunction('get_instance')" href="../../_functions/get_instance.html" onMouseOver="funcPopup(event,'get_instance')">get_instance</a>()-&gt;id;
<a name="l240"><span class="linenum"> 240</span></a>                      <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('userid')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> = <a class="var it8761" onMouseOver="hilite(8761)" onMouseOut="lolite()" onClick="logVariable('oldsubmission')" href="../../_variables/oldsubmission.html">$oldsubmission</a>-&gt;<a onClick="logVariable('userid')" class="var it39629" onMouseOver="hilite(39629)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>;
<a name="l241"><span class="linenum"> 241</span></a>                      <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('grader')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/grader.html">grader</a> = <a class="var it8761" onMouseOver="hilite(8761)" onMouseOut="lolite()" onClick="logVariable('oldsubmission')" href="../../_variables/oldsubmission.html">$oldsubmission</a>-&gt;<a onClick="logVariable('teacher')" class="var it39629" onMouseOver="hilite(39629)" onMouseOut="lolite()" href="../../_variables/teacher.html">teacher</a>;
<a name="l242"><span class="linenum"> 242</span></a>                      <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('timemodified')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="var it8761" onMouseOver="hilite(8761)" onMouseOut="lolite()" onClick="logVariable('oldsubmission')" href="../../_variables/oldsubmission.html">$oldsubmission</a>-&gt;<a onClick="logVariable('timemarked')" class="var it39629" onMouseOver="hilite(39629)" onMouseOut="lolite()" href="../../_variables/timemarked.html">timemarked</a>;
<a name="l243"><span class="linenum"> 243</span></a>                      <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('timecreated')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a> = <a class="var it8761" onMouseOver="hilite(8761)" onMouseOut="lolite()" onClick="logVariable('oldsubmission')" href="../../_variables/oldsubmission.html">$oldsubmission</a>-&gt;<a onClick="logVariable('timecreated')" class="var it39629" onMouseOver="hilite(39629)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a>;
<a name="l244"><span class="linenum"> 244</span></a>                      <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('grade')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> = <a class="var it8761" onMouseOver="hilite(8761)" onMouseOut="lolite()" onClick="logVariable('oldsubmission')" href="../../_variables/oldsubmission.html">$oldsubmission</a>-&gt;<a onClick="logVariable('grade')" class="var it39629" onMouseOver="hilite(39629)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a>;
<a name="l245"><span class="linenum"> 245</span></a>                      if (<a class="var it8761" onMouseOver="hilite(8761)" onMouseOut="lolite()" onClick="logVariable('oldsubmission')" href="../../_variables/oldsubmission.html">$oldsubmission</a>-&gt;<a onClick="logVariable('mailed')" class="var it39629" onMouseOver="hilite(39629)" onMouseOut="lolite()" href="../../_variables/mailed.html">mailed</a>) {
<a name="l246"><span class="linenum"> 246</span></a>  <span class="comment">                        // The mailed flag goes in the flags table.</span>
<a name="l247"><span class="linenum"> 247</span></a>                          <a class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" onClick="logVariable('flags')" href="../../_variables/flags.html">$flags</a> = new stdClass();
<a name="l248"><span class="linenum"> 248</span></a>                          <a class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" onClick="logVariable('flags')" href="../../_variables/flags.html">$flags</a>-&gt;<a onClick="logVariable('userid')" class="var it40734" onMouseOver="hilite(40734)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> = <a class="var it8761" onMouseOver="hilite(8761)" onMouseOut="lolite()" onClick="logVariable('oldsubmission')" href="../../_variables/oldsubmission.html">$oldsubmission</a>-&gt;<a onClick="logVariable('userid')" class="var it39629" onMouseOver="hilite(39629)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>;
<a name="l249"><span class="linenum"> 249</span></a>                          <a class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" onClick="logVariable('flags')" href="../../_variables/flags.html">$flags</a>-&gt;<a onClick="logVariable('assignment')" class="var it40734" onMouseOver="hilite(40734)" onMouseOut="lolite()" href="../../_variables/assignment.html">assignment</a> = <a class="var it19823" onMouseOver="hilite(19823)" onMouseOut="lolite()" onClick="logVariable('newassignment')" href="../../_variables/newassignment.html">$newassignment</a>-&gt;<a class="function" onClick="logFunction('get_instance')" href="../../_functions/get_instance.html" onMouseOver="funcPopup(event,'get_instance')">get_instance</a>()-&gt;id;
<a name="l250"><span class="linenum"> 250</span></a>                          <a class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" onClick="logVariable('flags')" href="../../_variables/flags.html">$flags</a>-&gt;<a onClick="logVariable('mailed')" class="var it40734" onMouseOver="hilite(40734)" onMouseOut="lolite()" href="../../_variables/mailed.html">mailed</a> = 1;
<a name="l251"><span class="linenum"> 251</span></a>                          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('assign_user_flags', <a class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" onClick="logVariable('flags')" href="../../_variables/flags.html">$flags</a>);
<a name="l252"><span class="linenum"> 252</span></a>                      }
<a name="l253"><span class="linenum"> 253</span></a>                      <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('id')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('assign_grades', <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>);
<a name="l254"><span class="linenum"> 254</span></a>                      if (!<a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('id')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>) {
<a name="l255"><span class="linenum"> 255</span></a>                          <a class="var it1193" onMouseOver="hilite(1193)" onMouseOut="lolite()" onClick="logVariable('log')" href="../../_variables/log.html">$log</a> .= <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('couldnotinsertgrade', 'mod_assign', <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('userid')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>);
<a name="l256"><span class="linenum"> 256</span></a>                          <a class="var it19830" onMouseOver="hilite(19830)" onMouseOut="lolite()" onClick="logVariable('rollback')" href="../../_variables/rollback.html">$rollback</a> = true;
<a name="l257"><span class="linenum"> 257</span></a>                      }
<a name="l258"><span class="linenum"> 258</span></a>  
<a name="l259"><span class="linenum"> 259</span></a>  <span class="comment">                    // Copy any grading instances.</span>
<a name="l260"><span class="linenum"> 260</span></a>                      if (<a class="var it1593" onMouseOver="hilite(1593)" onMouseOut="lolite()" onClick="logVariable('gradingarea')" href="../../_variables/gradingarea.html">$gradingarea</a>) {
<a name="l261"><span class="linenum"> 261</span></a>  
<a name="l262"><span class="linenum"> 262</span></a>                          <a class="var it19827" onMouseOver="hilite(19827)" onMouseOut="lolite()" onClick="logVariable('gradeidmap')" href="../../_variables/gradeidmap.html">$gradeidmap</a>[<a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('id')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>] = <a class="var it8761" onMouseOver="hilite(8761)" onMouseOut="lolite()" onClick="logVariable('oldsubmission')" href="../../_variables/oldsubmission.html">$oldsubmission</a>-&gt;<a onClick="logVariable('id')" class="var it39629" onMouseOver="hilite(39629)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l263"><span class="linenum"> 263</span></a>  
<a name="l264"><span class="linenum"> 264</span></a>                          foreach (<a class="var it19826" onMouseOver="hilite(19826)" onMouseOut="lolite()" onClick="logVariable('gradingdefinitions')" href="../../_variables/gradingdefinitions.html">$gradingdefinitions</a> as <a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('definition')" href="../../_variables/definition.html">$definition</a>) {
<a name="l265"><span class="linenum"> 265</span></a>                              <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('definitionid'=&gt;<a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('definition')" href="../../_variables/definition.html">$definition</a>-&gt;<a onClick="logVariable('id')" class="var it39451" onMouseOver="hilite(39451)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l266"><span class="linenum"> 266</span></a>                                              'itemid'=&gt;<a class="var it8761" onMouseOver="hilite(8761)" onMouseOut="lolite()" onClick="logVariable('oldsubmission')" href="../../_variables/oldsubmission.html">$oldsubmission</a>-&gt;<a onClick="logVariable('id')" class="var it39629" onMouseOver="hilite(39629)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l267"><span class="linenum"> 267</span></a>                              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('grading_instances', 'itemid', <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('id')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l268"><span class="linenum"> 268</span></a>                          }
<a name="l269"><span class="linenum"> 269</span></a>  
<a name="l270"><span class="linenum"> 270</span></a>                      }
<a name="l271"><span class="linenum"> 271</span></a>                      foreach (<a class="var it19823" onMouseOver="hilite(19823)" onMouseOut="lolite()" onClick="logVariable('newassignment')" href="../../_variables/newassignment.html">$newassignment</a>-&gt;<a class="function" onClick="logFunction('get_feedback_plugins')" href="../../_functions/get_feedback_plugins.html" onMouseOver="funcPopup(event,'get_feedback_plugins')">get_feedback_plugins</a>() as <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>) {
<a name="l272"><span class="linenum"> 272</span></a>                          if (<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>-&gt;<a class="function" onClick="logFunction('can_upgrade')" href="../../_functions/can_upgrade.html" onMouseOver="funcPopup(event,'can_upgrade')">can_upgrade</a>(<a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>-&gt;<a onClick="logVariable('assignmenttype')" class="var it39628" onMouseOver="hilite(39628)" onMouseOut="lolite()" href="../../_variables/assignmenttype.html">assignmenttype</a>, <a class="var it671" onMouseOver="hilite(671)" onMouseOut="lolite()" onClick="logVariable('oldversion')" href="../../_variables/oldversion.html">$oldversion</a>)) {
<a name="l273"><span class="linenum"> 273</span></a>                              if (!<a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>-&gt;<a class="function" onClick="logFunction('upgrade')" href="../../_functions/upgrade.html" onMouseOver="funcPopup(event,'upgrade')">upgrade</a>(<a class="var it4359" onMouseOver="hilite(4359)" onMouseOut="lolite()" onClick="logVariable('oldcontext')" href="../../_variables/oldcontext.html">$oldcontext</a>,
<a name="l274"><span class="linenum"> 274</span></a>                                                    <a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>,
<a name="l275"><span class="linenum"> 275</span></a>                                                    <a class="var it8761" onMouseOver="hilite(8761)" onMouseOut="lolite()" onClick="logVariable('oldsubmission')" href="../../_variables/oldsubmission.html">$oldsubmission</a>,
<a name="l276"><span class="linenum"> 276</span></a>                                                    <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>,
<a name="l277"><span class="linenum"> 277</span></a>                                                    <a class="var it1193" onMouseOver="hilite(1193)" onMouseOut="lolite()" onClick="logVariable('log')" href="../../_variables/log.html">$log</a>)) {
<a name="l278"><span class="linenum"> 278</span></a>                                  <a class="var it19830" onMouseOver="hilite(19830)" onMouseOut="lolite()" onClick="logVariable('rollback')" href="../../_variables/rollback.html">$rollback</a> = true;
<a name="l279"><span class="linenum"> 279</span></a>                              }
<a name="l280"><span class="linenum"> 280</span></a>                          }
<a name="l281"><span class="linenum"> 281</span></a>                      }
<a name="l282"><span class="linenum"> 282</span></a>                  }
<a name="l283"><span class="linenum"> 283</span></a>              }
<a name="l284"><span class="linenum"> 284</span></a>  
<a name="l285"><span class="linenum"> 285</span></a>              <a class="var it19823" onMouseOver="hilite(19823)" onMouseOut="lolite()" onClick="logVariable('newassignment')" href="../../_variables/newassignment.html">$newassignment</a>-&gt;<a class="function" onClick="logFunction('update_calendar')" href="../../_functions/update_calendar.html" onMouseOver="funcPopup(event,'update_calendar')">update_calendar</a>(<a class="var it19825" onMouseOver="hilite(19825)" onMouseOut="lolite()" onClick="logVariable('newcoursemodule')" href="../../_variables/newcoursemodule.html">$newcoursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it41181" onMouseOver="hilite(41181)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l286"><span class="linenum"> 286</span></a>  
<a name="l287"><span class="linenum"> 287</span></a>  <span class="comment">            // Reassociate grade_items from the old assignment instance to the new assign instance.</span>
<a name="l288"><span class="linenum"> 288</span></a>  <span class="comment">            // This includes outcome linked grade_items.</span>
<a name="l289"><span class="linenum"> 289</span></a>              <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('assign', <a class="var it19823" onMouseOver="hilite(19823)" onMouseOut="lolite()" onClick="logVariable('newassignment')" href="../../_variables/newassignment.html">$newassignment</a>-&gt;<a class="function" onClick="logFunction('get_instance')" href="../../_functions/get_instance.html" onMouseOver="funcPopup(event,'get_instance')">get_instance</a>()-&gt;id, 'assignment', <a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>-&gt;<a onClick="logVariable('id')" class="var it39628" onMouseOver="hilite(39628)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l290"><span class="linenum"> 290</span></a>              <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = 'UPDATE {grade_items} SET itemmodule = ?, iteminstance = ? WHERE itemmodule = ? AND iteminstance = ?';
<a name="l291"><span class="linenum"> 291</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l292"><span class="linenum"> 292</span></a>  
<a name="l293"><span class="linenum"> 293</span></a>  <span class="comment">            // Create a mapping record to map urls from the old to the new assignment.</span>
<a name="l294"><span class="linenum"> 294</span></a>              <a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('mapping')" href="../../_variables/mapping.html">$mapping</a> = new stdClass();
<a name="l295"><span class="linenum"> 295</span></a>              <a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('mapping')" href="../../_variables/mapping.html">$mapping</a>-&gt;<a onClick="logVariable('oldcmid')" class="var it39579" onMouseOver="hilite(39579)" onMouseOut="lolite()" href="../../_variables/oldcmid.html">oldcmid</a> = <a class="var it19818" onMouseOver="hilite(19818)" onMouseOut="lolite()" onClick="logVariable('oldcoursemodule')" href="../../_variables/oldcoursemodule.html">$oldcoursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it41179" onMouseOver="hilite(41179)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l296"><span class="linenum"> 296</span></a>              <a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('mapping')" href="../../_variables/mapping.html">$mapping</a>-&gt;<a onClick="logVariable('oldinstance')" class="var it39579" onMouseOver="hilite(39579)" onMouseOut="lolite()" href="../../_variables/oldinstance.html">oldinstance</a> = <a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>-&gt;<a onClick="logVariable('id')" class="var it39628" onMouseOver="hilite(39628)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l297"><span class="linenum"> 297</span></a>              <a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('mapping')" href="../../_variables/mapping.html">$mapping</a>-&gt;<a onClick="logVariable('newcmid')" class="var it39579" onMouseOver="hilite(39579)" onMouseOut="lolite()" href="../../_variables/newcmid.html">newcmid</a> = <a class="var it19825" onMouseOver="hilite(19825)" onMouseOut="lolite()" onClick="logVariable('newcoursemodule')" href="../../_variables/newcoursemodule.html">$newcoursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it41181" onMouseOver="hilite(41181)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l298"><span class="linenum"> 298</span></a>              <a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('mapping')" href="../../_variables/mapping.html">$mapping</a>-&gt;<a onClick="logVariable('newinstance')" class="var it39579" onMouseOver="hilite(39579)" onMouseOut="lolite()" href="../../_variables/newinstance.html">newinstance</a> = <a class="var it19823" onMouseOver="hilite(19823)" onMouseOut="lolite()" onClick="logVariable('newassignment')" href="../../_variables/newassignment.html">$newassignment</a>-&gt;<a class="function" onClick="logFunction('get_instance')" href="../../_functions/get_instance.html" onMouseOver="funcPopup(event,'get_instance')">get_instance</a>()-&gt;id;
<a name="l299"><span class="linenum"> 299</span></a>              <a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('mapping')" href="../../_variables/mapping.html">$mapping</a>-&gt;<a onClick="logVariable('timecreated')" class="var it39579" onMouseOver="hilite(39579)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l300"><span class="linenum"> 300</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('assignment_upgrade', <a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('mapping')" href="../../_variables/mapping.html">$mapping</a>);
<a name="l301"><span class="linenum"> 301</span></a>  
<a name="l302"><span class="linenum"> 302</span></a>              <a class="var it19829" onMouseOver="hilite(19829)" onMouseOut="lolite()" onClick="logVariable('gradesdone')" href="../../_variables/gradesdone.html">$gradesdone</a> = true;
<a name="l303"><span class="linenum"> 303</span></a>  
<a name="l304"><span class="linenum"> 304</span></a>          } catch (Exception <a class="var it4697" onMouseOver="hilite(4697)" onMouseOut="lolite()" onClick="logVariable('exception')" href="../../_variables/exception.html">$exception</a>) {
<a name="l305"><span class="linenum"> 305</span></a>              <a class="var it19830" onMouseOver="hilite(19830)" onMouseOut="lolite()" onClick="logVariable('rollback')" href="../../_variables/rollback.html">$rollback</a> = true;
<a name="l306"><span class="linenum"> 306</span></a>              <a class="var it1193" onMouseOver="hilite(1193)" onMouseOut="lolite()" onClick="logVariable('log')" href="../../_variables/log.html">$log</a> .= <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('conversionexception', 'mod_assign', <a class="var it4697" onMouseOver="hilite(4697)" onMouseOut="lolite()" onClick="logVariable('exception')" href="../../_variables/exception.html">$exception</a>-&gt;<a class="function" onClick="logFunction('getMessage')" href="../../_functions/getmessage.html" onMouseOver="funcPopup(event,'getmessage')">getMessage</a>());
<a name="l307"><span class="linenum"> 307</span></a>          }
<a name="l308"><span class="linenum"> 308</span></a>  
<a name="l309"><span class="linenum"> 309</span></a>          if (<a class="var it19830" onMouseOver="hilite(19830)" onMouseOut="lolite()" onClick="logVariable('rollback')" href="../../_variables/rollback.html">$rollback</a>) {
<a name="l310"><span class="linenum"> 310</span></a>  <span class="comment">            // Roll back the grades changes.</span>
<a name="l311"><span class="linenum"> 311</span></a>              if (<a class="var it19829" onMouseOver="hilite(19829)" onMouseOut="lolite()" onClick="logVariable('gradesdone')" href="../../_variables/gradesdone.html">$gradesdone</a>) {
<a name="l312"><span class="linenum"> 312</span></a>  <span class="comment">                // Reassociate grade_items from the new assign instance to the old assignment instance.</span>
<a name="l313"><span class="linenum"> 313</span></a>                  <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('assignment', <a class="var it4360" onMouseOver="hilite(4360)" onMouseOut="lolite()" onClick="logVariable('oldassignment')" href="../../_variables/oldassignment.html">$oldassignment</a>-&gt;<a onClick="logVariable('id')" class="var it39628" onMouseOver="hilite(39628)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'assign', <a class="var it19823" onMouseOver="hilite(19823)" onMouseOut="lolite()" onClick="logVariable('newassignment')" href="../../_variables/newassignment.html">$newassignment</a>-&gt;<a class="function" onClick="logFunction('get_instance')" href="../../_functions/get_instance.html" onMouseOver="funcPopup(event,'get_instance')">get_instance</a>()-&gt;id);
<a name="l314"><span class="linenum"> 314</span></a>                  <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = 'UPDATE {grade_items} SET itemmodule = ?, iteminstance = ? WHERE itemmodule = ? AND iteminstance = ?';
<a name="l315"><span class="linenum"> 315</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l316"><span class="linenum"> 316</span></a>              }
<a name="l317"><span class="linenum"> 317</span></a>  <span class="comment">            // Roll back the completion changes.</span>
<a name="l318"><span class="linenum"> 318</span></a>              if (<a class="var it19828" onMouseOver="hilite(19828)" onMouseOut="lolite()" onClick="logVariable('completiondone')" href="../../_variables/completiondone.html">$completiondone</a>) {
<a name="l319"><span class="linenum"> 319</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('course_modules_completion',
<a name="l320"><span class="linenum"> 320</span></a>                                 'coursemoduleid',
<a name="l321"><span class="linenum"> 321</span></a>                                 <a class="var it19818" onMouseOver="hilite(19818)" onMouseOut="lolite()" onClick="logVariable('oldcoursemodule')" href="../../_variables/oldcoursemodule.html">$oldcoursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it41179" onMouseOver="hilite(41179)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l322"><span class="linenum"> 322</span></a>                                 array('coursemoduleid'=&gt;<a class="var it19825" onMouseOver="hilite(19825)" onMouseOut="lolite()" onClick="logVariable('newcoursemodule')" href="../../_variables/newcoursemodule.html">$newcoursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it41181" onMouseOver="hilite(41181)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l323"><span class="linenum"> 323</span></a>  
<a name="l324"><span class="linenum"> 324</span></a>                  <a class="var it19831" onMouseOver="hilite(19831)" onMouseOut="lolite()" onClick="logVariable('allcriteria')" href="../../_variables/allcriteria.html">$allcriteria</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('course_completion_criteria',
<a name="l325"><span class="linenum"> 325</span></a>                                                  array('moduleinstance'=&gt;<a class="var it19825" onMouseOver="hilite(19825)" onMouseOut="lolite()" onClick="logVariable('newcoursemodule')" href="../../_variables/newcoursemodule.html">$newcoursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it41181" onMouseOver="hilite(41181)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l326"><span class="linenum"> 326</span></a>                  foreach (<a class="var it19831" onMouseOver="hilite(19831)" onMouseOut="lolite()" onClick="logVariable('allcriteria')" href="../../_variables/allcriteria.html">$allcriteria</a> as <a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../_variables/criteria.html">$criteria</a>) {
<a name="l327"><span class="linenum"> 327</span></a>                      <a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../_variables/criteria.html">$criteria</a>-&gt;<a onClick="logVariable('module')" class="var it40246" onMouseOver="hilite(40246)" onMouseOut="lolite()" href="../../_variables/module.html">module</a> = 'assignment';
<a name="l328"><span class="linenum"> 328</span></a>                      <a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../_variables/criteria.html">$criteria</a>-&gt;<a onClick="logVariable('moduleinstance')" class="var it40246" onMouseOver="hilite(40246)" onMouseOut="lolite()" href="../../_variables/moduleinstance.html">moduleinstance</a> = <a class="var it19818" onMouseOver="hilite(19818)" onMouseOut="lolite()" onClick="logVariable('oldcoursemodule')" href="../../_variables/oldcoursemodule.html">$oldcoursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it41179" onMouseOver="hilite(41179)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l329"><span class="linenum"> 329</span></a>                      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('course_completion_criteria', <a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../_variables/criteria.html">$criteria</a>);
<a name="l330"><span class="linenum"> 330</span></a>                  }
<a name="l331"><span class="linenum"> 331</span></a>              }
<a name="l332"><span class="linenum"> 332</span></a>  <span class="comment">            // Roll back the log changes.</span>
<a name="l333"><span class="linenum"> 333</span></a>              <a class="var it19832" onMouseOver="hilite(19832)" onMouseOut="lolite()" onClick="logVariable('logparams')" href="../../_variables/logparams.html">$logparams</a> = array('cmid' =&gt; <a class="var it19825" onMouseOver="hilite(19825)" onMouseOut="lolite()" onClick="logVariable('newcoursemodule')" href="../../_variables/newcoursemodule.html">$newcoursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it41181" onMouseOver="hilite(41181)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'course' =&gt; <a class="var it19825" onMouseOver="hilite(19825)" onMouseOut="lolite()" onClick="logVariable('newcoursemodule')" href="../../_variables/newcoursemodule.html">$newcoursemodule</a>-&gt;<a onClick="logVariable('course')" class="var it41181" onMouseOver="hilite(41181)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>);
<a name="l334"><span class="linenum"> 334</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('log', 'module', 'assignment', <a class="var it19832" onMouseOver="hilite(19832)" onMouseOut="lolite()" onClick="logVariable('logparams')" href="../../_variables/logparams.html">$logparams</a>);
<a name="l335"><span class="linenum"> 335</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('log', 'cmid', <a class="var it19818" onMouseOver="hilite(19818)" onMouseOut="lolite()" onClick="logVariable('oldcoursemodule')" href="../../_variables/oldcoursemodule.html">$oldcoursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it41179" onMouseOver="hilite(41179)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it19832" onMouseOver="hilite(19832)" onMouseOut="lolite()" onClick="logVariable('logparams')" href="../../_variables/logparams.html">$logparams</a>);
<a name="l336"><span class="linenum"> 336</span></a>  <span class="comment">            // Roll back the advanced grading update.</span>
<a name="l337"><span class="linenum"> 337</span></a>              if (<a class="var it1593" onMouseOver="hilite(1593)" onMouseOut="lolite()" onClick="logVariable('gradingarea')" href="../../_variables/gradingarea.html">$gradingarea</a>) {
<a name="l338"><span class="linenum"> 338</span></a>                  foreach (<a class="var it19827" onMouseOver="hilite(19827)" onMouseOut="lolite()" onClick="logVariable('gradeidmap')" href="../../_variables/gradeidmap.html">$gradeidmap</a> as <a class="var it10084" onMouseOver="hilite(10084)" onMouseOut="lolite()" onClick="logVariable('newgradeid')" href="../../_variables/newgradeid.html">$newgradeid</a> =&gt; <a class="var it12806" onMouseOver="hilite(12806)" onMouseOut="lolite()" onClick="logVariable('oldsubmissionid')" href="../../_variables/oldsubmissionid.html">$oldsubmissionid</a>) {
<a name="l339"><span class="linenum"> 339</span></a>                      foreach (<a class="var it19826" onMouseOver="hilite(19826)" onMouseOut="lolite()" onClick="logVariable('gradingdefinitions')" href="../../_variables/gradingdefinitions.html">$gradingdefinitions</a> as <a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('definition')" href="../../_variables/definition.html">$definition</a>) {
<a name="l340"><span class="linenum"> 340</span></a>                          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('grading_instances',
<a name="l341"><span class="linenum"> 341</span></a>                                         'itemid',
<a name="l342"><span class="linenum"> 342</span></a>                                         <a class="var it12806" onMouseOver="hilite(12806)" onMouseOut="lolite()" onClick="logVariable('oldsubmissionid')" href="../../_variables/oldsubmissionid.html">$oldsubmissionid</a>,
<a name="l343"><span class="linenum"> 343</span></a>                                         array('definitionid'=&gt;<a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('definition')" href="../../_variables/definition.html">$definition</a>-&gt;<a onClick="logVariable('id')" class="var it39451" onMouseOver="hilite(39451)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'itemid'=&gt;<a class="var it10084" onMouseOver="hilite(10084)" onMouseOut="lolite()" onClick="logVariable('newgradeid')" href="../../_variables/newgradeid.html">$newgradeid</a>));
<a name="l344"><span class="linenum"> 344</span></a>                      }
<a name="l345"><span class="linenum"> 345</span></a>                  }
<a name="l346"><span class="linenum"> 346</span></a>                  <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('id'=&gt;<a class="var it1593" onMouseOver="hilite(1593)" onMouseOut="lolite()" onClick="logVariable('gradingarea')" href="../../_variables/gradingarea.html">$gradingarea</a>-&gt;<a onClick="logVariable('id')" class="var it41182" onMouseOver="hilite(41182)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l347"><span class="linenum"> 347</span></a>                                  'contextid'=&gt;<a class="var it4359" onMouseOver="hilite(4359)" onMouseOut="lolite()" onClick="logVariable('oldcontext')" href="../../_variables/oldcontext.html">$oldcontext</a>-&gt;<a onClick="logVariable('id')" class="var it39630" onMouseOver="hilite(39630)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l348"><span class="linenum"> 348</span></a>                                  'component'=&gt;'mod_assignment',
<a name="l349"><span class="linenum"> 349</span></a>                                  'areaname'=&gt;'submission');
<a name="l350"><span class="linenum"> 350</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('grading_areas', <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l351"><span class="linenum"> 351</span></a>              }
<a name="l352"><span class="linenum"> 352</span></a>              <a class="var it19823" onMouseOver="hilite(19823)" onMouseOut="lolite()" onClick="logVariable('newassignment')" href="../../_variables/newassignment.html">$newassignment</a>-&gt;<a class="function" onClick="logFunction('delete_instance')" href="../../_functions/delete_instance.html" onMouseOver="funcPopup(event,'delete_instance')">delete_instance</a>();
<a name="l353"><span class="linenum"> 353</span></a>  
<a name="l354"><span class="linenum"> 354</span></a>              return false;
<a name="l355"><span class="linenum"> 355</span></a>          }
<a name="l356"><span class="linenum"> 356</span></a>  <span class="comment">        // Delete the old assignment (use object delete).</span>
<a name="l357"><span class="linenum"> 357</span></a>          <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a> = <a class="function" onClick="logFunction('get_coursemodule_from_id')" href="../../_functions/get_coursemodule_from_id.html" onMouseOver="funcPopup(event,'get_coursemodule_from_id')">get_coursemodule_from_id</a>('', <a class="var it19818" onMouseOver="hilite(19818)" onMouseOut="lolite()" onClick="logVariable('oldcoursemodule')" href="../../_variables/oldcoursemodule.html">$oldcoursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it41179" onMouseOver="hilite(41179)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it19818" onMouseOver="hilite(19818)" onMouseOut="lolite()" onClick="logVariable('oldcoursemodule')" href="../../_variables/oldcoursemodule.html">$oldcoursemodule</a>-&gt;<a onClick="logVariable('course')" class="var it41179" onMouseOver="hilite(41179)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>);
<a name="l358"><span class="linenum"> 358</span></a>          if (<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>) {
<a name="l359"><span class="linenum"> 359</span></a>              <a class="function" onClick="logFunction('course_delete_module')" href="../../_functions/course_delete_module.html" onMouseOver="funcPopup(event,'course_delete_module')">course_delete_module</a>(<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l360"><span class="linenum"> 360</span></a>          }
<a name="l361"><span class="linenum"> 361</span></a>          <a class="function" onClick="logFunction('rebuild_course_cache')" href="../../_functions/rebuild_course_cache.html" onMouseOver="funcPopup(event,'rebuild_course_cache')">rebuild_course_cache</a>(<a class="var it19818" onMouseOver="hilite(19818)" onMouseOut="lolite()" onClick="logVariable('oldcoursemodule')" href="../../_variables/oldcoursemodule.html">$oldcoursemodule</a>-&gt;<a onClick="logVariable('course')" class="var it41179" onMouseOver="hilite(41179)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>);
<a name="l362"><span class="linenum"> 362</span></a>          return true;
<a name="l363"><span class="linenum"> 363</span></a>      }
<a name="l364"><span class="linenum"> 364</span></a>  
<a name="l365"><span class="linenum"> 365</span></a>  
<a name="l366"><span class="linenum"> 366</span></a>      <span class="comment">/**</span>
<a name="l367"><span class="linenum"> 367</span></a>  <span class="comment">     * Create a duplicate course module record so we can create the upgraded</span>
<a name="l368"><span class="linenum"> 368</span></a>  <span class="comment">     * assign module alongside the old assignment module.</span>
<a name="l369"><span class="linenum"> 369</span></a>  <span class="comment">     *</span>
<a name="l370"><span class="linenum"> 370</span></a>  <span class="comment">     * @param stdClass $cm The old course module record</span>
<a name="l371"><span class="linenum"> 371</span></a>  <span class="comment">     * @param int $moduleid The id of the new assign module</span>
<a name="l372"><span class="linenum"> 372</span></a>  <span class="comment">     * @param int $newinstanceid The id of the new instance of the assign module</span>
<a name="l373"><span class="linenum"> 373</span></a>  <span class="comment">     * @return mixed stdClass|bool The new course module record or FALSE</span>
<a name="l374"><span class="linenum"> 374</span></a>  <span class="comment">     */</span>
<a name="l375"><span class="linenum"> 375</span></a>      private function <a class="function" onClick="logFunction('duplicate_course_module')" href="../../_functions/duplicate_course_module.html" onMouseOver="funcPopup(event,'duplicate_course_module')">duplicate_course_module</a>(stdClass <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('moduleid')" href="../../_variables/moduleid.html">$moduleid</a>, <a class="var it19838" onMouseOver="hilite(19838)" onMouseOut="lolite()" onClick="logVariable('newinstanceid')" href="../../_variables/newinstanceid.html">$newinstanceid</a>) {
<a name="l376"><span class="linenum"> 376</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l377"><span class="linenum"> 377</span></a>  
<a name="l378"><span class="linenum"> 378</span></a>          <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a> = new stdClass();
<a name="l379"><span class="linenum"> 379</span></a>          <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('course')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>           = <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('course')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>;
<a name="l380"><span class="linenum"> 380</span></a>          <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('module')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/module.html">module</a>           = <a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('moduleid')" href="../../_variables/moduleid.html">$moduleid</a>;
<a name="l381"><span class="linenum"> 381</span></a>          <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('instance')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/instance.html">instance</a>         = <a class="var it19838" onMouseOver="hilite(19838)" onMouseOut="lolite()" onClick="logVariable('newinstanceid')" href="../../_variables/newinstanceid.html">$newinstanceid</a>;
<a name="l382"><span class="linenum"> 382</span></a>          <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('visible')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/visible.html">visible</a>          = <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('visible')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../../_variables/visible.html">visible</a>;
<a name="l383"><span class="linenum"> 383</span></a>          <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('section')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/section.html">section</a>          = <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('section')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../../_variables/section.html">section</a>;
<a name="l384"><span class="linenum"> 384</span></a>          <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('score')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/score.html">score</a>            = <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('score')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../../_variables/score.html">score</a>;
<a name="l385"><span class="linenum"> 385</span></a>          <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('indent')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/indent.html">indent</a>           = <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('indent')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../../_variables/indent.html">indent</a>;
<a name="l386"><span class="linenum"> 386</span></a>          <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('groupmode')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/groupmode.html">groupmode</a>        = <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('groupmode')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../../_variables/groupmode.html">groupmode</a>;
<a name="l387"><span class="linenum"> 387</span></a>          <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('groupingid')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/groupingid.html">groupingid</a>       = <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('groupingid')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../../_variables/groupingid.html">groupingid</a>;
<a name="l388"><span class="linenum"> 388</span></a>          <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('completion')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/completion.html">completion</a>                = <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('completion')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../../_variables/completion.html">completion</a>;
<a name="l389"><span class="linenum"> 389</span></a>          <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('completiongradeitemnumber')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/completiongradeitemnumber.html">completiongradeitemnumber</a> = <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('completiongradeitemnumber')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../../_variables/completiongradeitemnumber.html">completiongradeitemnumber</a>;
<a name="l390"><span class="linenum"> 390</span></a>          <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('completionview')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/completionview.html">completionview</a>            = <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('completionview')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../../_variables/completionview.html">completionview</a>;
<a name="l391"><span class="linenum"> 391</span></a>          <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('completionexpected')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/completionexpected.html">completionexpected</a>        = <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('completionexpected')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../../_variables/completionexpected.html">completionexpected</a>;
<a name="l392"><span class="linenum"> 392</span></a>          if (!empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('enableavailability')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/enableavailability.html">enableavailability</a>)) {
<a name="l393"><span class="linenum"> 393</span></a>              <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('availability')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/availability.html">availability</a> = <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('availability')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../../_variables/availability.html">availability</a>;
<a name="l394"><span class="linenum"> 394</span></a>          }
<a name="l395"><span class="linenum"> 395</span></a>          <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('showdescription')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/showdescription.html">showdescription</a> = <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('showdescription')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../../_variables/showdescription.html">showdescription</a>;
<a name="l396"><span class="linenum"> 396</span></a>  
<a name="l397"><span class="linenum"> 397</span></a>          <a class="var it2485" onMouseOver="hilite(2485)" onMouseOut="lolite()" onClick="logVariable('newcmid')" href="../../_variables/newcmid.html">$newcmid</a> = <a class="function" onClick="logFunction('add_course_module')" href="../../_functions/add_course_module.html" onMouseOver="funcPopup(event,'add_course_module')">add_course_module</a>(<a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>);
<a name="l398"><span class="linenum"> 398</span></a>          <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a> = <a class="function" onClick="logFunction('get_coursemodule_from_id')" href="../../_functions/get_coursemodule_from_id.html" onMouseOver="funcPopup(event,'get_coursemodule_from_id')">get_coursemodule_from_id</a>('', <a class="var it2485" onMouseOver="hilite(2485)" onMouseOut="lolite()" onClick="logVariable('newcmid')" href="../../_variables/newcmid.html">$newcmid</a>, <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('course')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>);
<a name="l399"><span class="linenum"> 399</span></a>          if (!<a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>) {
<a name="l400"><span class="linenum"> 400</span></a>              return false;
<a name="l401"><span class="linenum"> 401</span></a>          }
<a name="l402"><span class="linenum"> 402</span></a>          <a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('section')" href="../../_variables/section.html">$section</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>(&quot;course_sections&quot;, array(&quot;id&quot;=&gt;<a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('section')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/section.html">section</a>));
<a name="l403"><span class="linenum"> 403</span></a>          if (!<a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('section')" href="../../_variables/section.html">$section</a>) {
<a name="l404"><span class="linenum"> 404</span></a>              return false;
<a name="l405"><span class="linenum"> 405</span></a>          }
<a name="l406"><span class="linenum"> 406</span></a>  
<a name="l407"><span class="linenum"> 407</span></a>          <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('section')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/section.html">section</a> = <a class="function" onClick="logFunction('course_add_cm_to_section')" href="../../_functions/course_add_cm_to_section.html" onMouseOver="funcPopup(event,'course_add_cm_to_section')">course_add_cm_to_section</a>(<a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('course')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>, <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('id')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('section')" href="../../_variables/section.html">$section</a>-&gt;<a onClick="logVariable('section')" class="var it39560" onMouseOver="hilite(39560)" onMouseOut="lolite()" href="../../_variables/section.html">section</a>, <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l408"><span class="linenum"> 408</span></a>  
<a name="l409"><span class="linenum"> 409</span></a>  <span class="comment">        // Make sure visibility is set correctly (in particular in calendar).</span>
<a name="l410"><span class="linenum"> 410</span></a>  <span class="comment">        // Note: Allow them to set it even without moodle/course:activityvisibility.</span>
<a name="l411"><span class="linenum"> 411</span></a>          <a class="function" onClick="logFunction('set_coursemodule_visible')" href="../../_functions/set_coursemodule_visible.html" onMouseOver="funcPopup(event,'set_coursemodule_visible')">set_coursemodule_visible</a>(<a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('id')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>-&gt;<a onClick="logVariable('visible')" class="var it40705" onMouseOver="hilite(40705)" onMouseOut="lolite()" href="../../_variables/visible.html">visible</a>);
<a name="l412"><span class="linenum"> 412</span></a>  
<a name="l413"><span class="linenum"> 413</span></a>          return <a class="var it8381" onMouseOver="hilite(8381)" onMouseOut="lolite()" onClick="logVariable('newcm')" href="../../_variables/newcm.html">$newcm</a>;
<a name="l414"><span class="linenum"> 414</span></a>      }
<a name="l415"><span class="linenum"> 415</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'get_config': ['get_config', 'Get a configuration value for this plugin ', [['mod/assign','assignmentplugin.php',345],['lib/portfolio','plugin.php',546],['question/engine','bank.php',109],['lib','moodlelib.php',1404],['lib','enrollib.php',1141],['lib/editor/tinymce/classes','plugin.php',73],['admin/tool/log/classes/helper','store.php',63]], 847],
'course_delete_module': ['course_delete_module', 'This function will handles the whole deletion process of a module. This includes calling the modules delete_instance function, deleting files, events, grades, conditional data, the data in the course_module and course_sections table and adding a module deletion event to the DB. ', [['course','lib.php',1635]], 16],
'upgrade_settings': ['upgrade_settings', 'Upgrade the settings from the old assignment to the new one ', [['mod/assign','assignmentplugin.php',480],['mod/assign/submission/file','locallib.php',367],['mod/assign/submission/onlinetext','locallib.php',459],['mod/assign/submission/comments','locallib.php',105],['mod/assign/feedback/file','locallib.php',303],['mod/assign/feedback/comments','locallib.php',375]], 2],
'disable': ['disable', 'Set this plugin to disabled ', [['mod/assign','assignmentplugin.php',213],['lib','licenselib.php',105],['cache/classes','factory.php',570],['backup/util/ui','backup_ui_setting.class.php',157]], 31],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required. ', [['lib/dml','pgsql_native_moodle_database.php',883],['lib/dml','oci_native_moodle_database.php',1249],['lib/dml','sqlsrv_native_moodle_database.php',978],['lib/dml','mssql_native_moodle_database.php',898],['lib/dml','mysqli_native_moodle_database.php',1177],['lib/dml/tests','dml_test.php',5427],['lib/dml','pdo_moodle_database.php',386],['question/engine/upgrade','upgradelib.php',121]], 1512],
'has_capability': ['has_capability', 'Wrapper round the has_capability funciton that automatically passes in the quiz context. ', [['mod/quiz','attemptlib.php',299],['mod/quiz','attemptlib.php',884],['lib','accesslib.php',346]], 1929],
'get_string': ['get_string', 'Return a core get_string() call ', [['lib/external','externallib.php',112],['lib','moodlelib.php',6538],['lib','moodlelib.php',9417],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38],['lib/classes','string_manager_install.php',95],['question/behaviour','behaviourbase.php',756]], 19235],
'delete_instance': ['delete_instance', 'The assignment has been deleted - remove the plugin specific data ', [['mod/assign','assignmentplugin.php',525],['mod/workshop/allocation/random','lib.php',243],['mod/assign/submission/file','locallib.php',447],['mod/assign/submission/onlinetext','locallib.php',538],['mod/workshop/form/accumulative','lib.php',375],['mod/workshop/form/rubric','lib.php',405],['mod/workshop/form/numerrors','lib.php',394],['lib','enrollib.php',1737],['mod/assign','locallib.php',677],['mod/workshop/form','lib.php',118],['mod/workshop/allocation/scheduled','lib.php',200],['mod/assign/feedback/editpdf','locallib.php',260],['mod/workshop/form/comments','lib.php',360],['mod/assign/feedback/file','locallib.php',256],['lib','accesslib.php',6060],['mod/workshop/eval','lib.php',59],['mod/workshop/allocation/manual','lib.php',349],['mod/assign/feedback/comments','locallib.php',458],['mod/workshop/eval/best','lib.php',125],['mod/workshop/allocation','lib.php',62]], 35],
'copy_area_files_for_upgrade': ['copy_area_files_for_upgrade', 'Copy all the files from the old assignment files area to the new one. This is used by the plugin upgrade code. ', [['mod/assign','locallib.php',6945]], 4],
'getmessage': ['getmessage', 'Get the error message from an error object. ', [['lib/pear','PEAR.php',921],['lib/htmlpurifier/HTMLPurifier','Language.php',86],['lib/google/src/Google/Service','Reports.php',1105],['lib/google/src/Google/Service','Gmail.php',1283],['lib/google/src/Google/Service','IdentityToolkit.php',1159],['lib/google/src/Google/Service','Dfareporting.php',2039],['lib/zend/Zend/XmlRpc','Fault.php',152],['lib/google/src/Google/Service','Books.php',3266],['lib/google/src/Google/Service','Books.php',3951],['lib/google/src/Google/Service','AdExchangeSeller.php',1042],['lib/google/src/Google/Service','Bigquery.php',1245],['lib/google/src/Google/Service','Freebase.php',440],['lib/google/src/Google/Service','Autoscaler.php',1078],['lib/google/src/Google/Service','Autoscaler.php',1170],['lib/google/src/Google/Service','ShoppingContent.php',2096],['lib/google/src/Google/Service','ShoppingContent.php',2498],['lib/google/src/Google/Service','ShoppingContent.php',2543],['lib/zend/Zend/Http','Response.php',323],['lib/google/src/Google/Service','Compute.php',5785],['lib/google/src/Google/Service','Compute.php',6842],['lib/google/src/Google/Service','Compute.php',6934],['lib/google/src/Google/Service','Compute.php',7440],['lib/google/src/Google/Service','Compute.php',8566],['lib/google/src/Google/Service','Compute.php',8969],['lib/google/src/Google/Service','Compute.php',9561],['lib/google/src/Google/Service','Compute.php',9653],['lib/google/src/Google/Service','Compute.php',9745],['lib/google/src/Google/Service','Compute.php',10382],['lib/google/src/Google/Service','Compute.php',11098],['lib/google/src/Google/Service','Compute.php',11524],['lib/zend/Zend/Service/DeveloperGarden/Request/SendSms','SendSmsAbstract.php',148],['lib/google/src/Google/Service','AdSense.php',2959],['lib/google/src/Google/Service','Pubsub.php',700],['lib/google/src/Google/Service','Pubsub.php',737],['lib/google/src/Google/Service','Replicapool.php',1151],['lib/google/src/Google/Service','Replicapool.php',1243],['lib/google/src/Google/Service','Resourceviews.php',890],['lib/google/src/Google/Service','Resourceviews.php',982]], 434],
'update_dependency_id_across_course': ['update_dependency_id_across_course', 'In rare cases the system may want to change all references to one ID (e.g. one course-module ID) to another one, within a course. This function does that for the conditional availability data for all modules and sections on the course. ', [['availability/classes','info.php',389]], 1],
'get_records': ['get_records', 'Get a number of records as an array of objects where all the given conditions met. ', [['lib/dml','moodle_database.php',1236],['lib','coursecatlib.php',654],['question','category_class.php',63]], 860],
'set_field': ['set_field', 'Sets the custom profile field used for testing. ', [['availability/condition/profile/tests','condition_test.php',349],['lib/dml','moodle_database.php',1688]], 462],
'get_record': ['get_record', 'Get a single database record as an object where all the given conditions met. ', [['lib/dml','moodle_database.php',1413]], 2960],
'can_upgrade': ['can_upgrade', 'Return true if this plugin can upgrade an old Moodle 2.2 assignment of this type and version. ', [['mod/assign','assignmentplugin.php',468],['mod/assign/submission/file','locallib.php',347],['mod/assign/submission/onlinetext','locallib.php',444],['mod/assign','locallib.php',6921],['mod/assign/submission/comments','locallib.php',88],['mod/assign/feedback/file','locallib.php',288],['mod/assign/feedback/comments','locallib.php',358]], 7],
'get_instance': ['get_instance', 'Returns the object of type gradingform_XXX_instance (where XXX is the plugin method name) ', [['grade/grading/form','lib.php',474],['blog','locallib.php',859],['question/engine','bank.php',445],['mod/assign','locallib.php',1164],['backup/util/helper','restore_logs_processor.class.php',69],['repository','lib.php',1135],['mnet/service/enrol','locallib.php',57],['lib','externallib.php',794],['backup/util/output','output_controller.class.php',53]], 393],
'get_feedback_plugins': ['get_feedback_plugins', 'Get list of feedback plugins installed. ', [['mod/assign','locallib.php',264]], 19],
'update_calendar': ['update_calendar', 'Update the calendar entries for this assignment. ', [['mod/assign','locallib.php',866]], 4],
'rebuild_course_cache': ['rebuild_course_cache', 'Rebuilds or resets the cached list of course activities stored in MUC. ', [['lib','modinfolib.php',2203]], 40],
'enable': ['enable', 'Set this plugin to enabled ', [['mod/assign','assignmentplugin.php',203],['lib','licenselib.php',90]], 33],
'add_instance': ['add_instance', 'Add new instance of enrol plugin. ', [['enrol/guest','lib.php',345],['lib','enrollib.php',1670],['mod/assign','locallib.php',562],['enrol/manual','lib.php',174]], 76],
'duplicate_course_module': ['duplicate_course_module', 'Create a duplicate course module record so we can create the upgraded assign module alongside the old assignment module. ', [['mod/assign','upgradelib.php',366]], 1],
'upgrade_assignment': ['upgrade_assignment', 'This function converts all of the base settings for an instance of the old assignment to the new format. Then it calls each of the plugins to see if they can help upgrade this assignment. ', [['mod/assign','upgradelib.php',47]], 6],
'upgrade': ['upgrade', 'Upgrade the submission from the old assignment to the new one ', [['mod/assign','assignmentplugin.php',494],['mod/assign/submission/file','locallib.php',406],['mod/assign/submission/onlinetext','locallib.php',472],['mod/assign/submission/comments','locallib.php',123],['mod/assign/feedback/file','locallib.php',316],['mod/assign/feedback/comments','locallib.php',391]], 6],
'raise': ['raise', 'Sets the PHP time limit to a number of seconds from now. ', [['lib/classes','php_time_limit.php',41]], 85],
'set_coursemodule_visible': ['set_coursemodule_visible', 'Set the visibility of a module and inherent properties. ', [['course','lib.php',1557]], 24],
'course_add_cm_to_section': ['course_add_cm_to_section', 'Adds an existing module to the section ', [['course','lib.php',1469]], 12],
'instance': ['instance', 'Retrieve sole instance of the registry. ', [['lib/htmlpurifier/HTMLPurifier','URISchemeRegistry.php',9],['lib/classes/update','checker.php',62],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',29],['lib/classes','useragent.php',101],['backup/cc','validator.php',35],['lib/portfolio','exporter.php',251],['lib/tests','update_deployer_test.php',69],['lib/tests','string_manager_standard_test.php',124],['lib','modinfolib.php',373],['','mdeploy.php',96],['cache','disabledlib.php',171],['cache','disabledlib.php',296],['admin/tool/installaddon/classes','validator.php',85],['cache/classes','config.php',87],['course/format','lib.php',156],['lib','accesslib.php',6184],['lib','accesslib.php',6436],['lib','accesslib.php',6614],['lib','accesslib.php',6868],['lib','accesslib.php',7129],['lib','accesslib.php',7341],['cache','locallib.php',52],['lib/htmlpurifier','HTMLPurifier.php',251],['cache/classes','factory.php',114],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',53],['cache/classes','helper.php',76],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',31],['lib/classes','plugin_manager.php',83],['lib','filterlib.php',81],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',80],['lib/classes/update','deployer.php',54],['admin/tool/installaddon/classes','pluginfo_client.php',37],['admin/tool/installaddon/classes','installer.php',40],['backup/cc/cc_lib','cc_utils.php',387],['backup/cc/cc_lib','cc_utils.php',443]], 3942],
'execute': ['execute', 'Exceptionally override the execute method, so, based in the activity_included setting, we are able to skip the execution of one task completely ', [['backup/moodle2','backup_activity_task.class.php',205],['backup/converter/moodle1','backuplib.php',10],['filter/tex','latex.php',60],['backup/util/plan','base_plan.class.php',158],['mod/lti/service/toolsettings/classes/local/resource','systemsettings.php',61],['mod/lti/service/toolsettings/classes/local/resource','linksettings.php',63],['mod/lti/service/profile/classes/local/resource','profile.php',76],['webservice','lib.php',1772],['lib/classes/task','context_cleanup_task.php',41],['lib/adodb','adodb.inc.php',967],['enrol/imsenterprise/classes/task','cron_task.php',43],['admin/tool/messageinbound/classes/task','cleanup_task.php',47],['lib/classes/task','calendar_cron_task.php',40],['mod/workshop/allocation/random','lib.php',83],['lib/classes/task','registration_cron_task.php',40],['lib/classes/task','portfolio_cron_task.php',40],['lib/htmlpurifier/HTMLPurifier/Strategy','Composite.php',21],['lib/google/src/Google/Http','Batch.php',56],['backup/converter/imscc11','lib.php',85],['lib/classes/task','file_temp_cleanup_task.php',40],['filter/tex','texdebug.php',287],['admin/tool/monitor/classes','notification_task.php',39],['lib/classes/task','stats_cron_task.php',40],['lib/classes/task','backup_cleanup_task.php',40],['admin/tool/log/store/legacy/classes/task','cleanup_task.php',40],['backup/util/ui','backup_ui.class.php',122],['lib/dml','pgsql_native_moodle_database.php',665],['lib/classes/task','messaging_cleanup_task.php',40],['lib/zend/Zend/Service/WindowsAzure/RetryPolicy','RetryN.php',68],['lib/classes/task','session_cleanup_task.php',40],['lib/classes/task','completion_cron_task.php',40],['lib/dml','oci_native_moodle_database.php',1009],['backup/util/plan','base_task.class.php',162],['lib/adodb/drivers','adodb-pdo.inc.php',464],['backup/util/plan','backup_plan.class.php',112],['backup/util/ui','restore_ui.class.php',206],['backup/converter/imscc11','backuplib.php',42],['backup/moodle2','restore_activity_task.class.php',183],['','mdeploy.php',743],['lib/dml','sqlsrv_native_moodle_database.php',745],['lib/htmlpurifier/HTMLPurifier/Strategy','MakeWellFormed.php',66],['lib/google/src/Google/Http','REST.php',28],['admin/tool/langimport/classes/task','update_langpacks_task.php',44],['mod/lti/service/toolproxy/classes/local/resource','toolproxy.php',62],['lib/classes/task','plagiarism_cron_task.php',40],['admin/tool/messageinbound/classes/task','pickup_task.php',47],['backup/util/plan','backup_structure_step.class.php',50],['mod/forum/classes/task','cron_task.php',39],['mod/workshop/allocation/scheduled','lib.php',128],['lib/classes/task','file_trash_cleanup_task.php',40],['backup/util/plan','restore_execution_step.class.php',25],['lib/tests/fixtures','task_fixtures.php',30],['lib/tests/fixtures','task_fixtures.php',39],['lib/tests/fixtures','task_fixtures.php',48],['lib/tests/fixtures','task_fixtures.php',57],['admin/tool/installaddon/classes','validator.php',114],['backup/util/plan','backup_execution_step.class.php',25],['lib/classes/task','password_reset_cleanup_task.php',40],['lib/classes/task','automated_backup_task.php',40],['backup/converter/moodle1','lib.php',142],['lib/htmlpurifier/HTMLPurifier/Strategy','ValidateAttributes.php',16],['lib/classes/task','create_contexts_task.php',40],['backup/util/plan','restore_plan.class.php',159],['backup/converter/imscc1','lib.php',84],['lib/dml','mssql_native_moodle_database.php',662],['admin/tool/log/store/standard/classes/task','cleanup_task.php',40],['lib/classes/task','cache_cleanup_task.php',40],['lib/classes/task','badges_cron_task.php',40],['lib/classes/task','cache_cron_task.php',40],['backup/util/interfaces','executable.class.php',32],['lib/htmlpurifier/HTMLPurifier/Strategy','FixNesting.php',41],['lib/adodb/drivers','adodb-oci8po.inc.php',52],['lib/classes/task','question_cron_task.php',40],['lib/zend/Zend/Service/WindowsAzure/RetryPolicy','NoRetry.php',37],['lib/dml','mysqli_native_moodle_database.php',955],['lib/htmlpurifier/HTMLPurifier/Strategy','RemoveForeignElements.php',20],['backup/util/plan/tests/fixtures','plan_fixtures.php',47],['backup/util/plan/tests/fixtures','plan_fixtures.php',55],['lib/classes/task','events_cron_task.php',40],['lib/classes/task','delete_unconfirmed_users_task.php',40],['lib/adodb/drivers','adodb-oci8.inc.php',786],['backup/converter/imscc1','backuplib.php',10],['lib/classes/task','tag_cron_task.php',40],['lib/classes/task','blog_cron_task.php',40],['lib/classes/task','send_failed_login_notifications_task.php',43],['lib/classes/task','grade_cron_task.php',40],['lib/dml/tests','dml_test.php',5422],['admin/tool/uploadcourse/classes','processor.php',174],['backup/moodle2','restore_section_task.class.php',87],['mod/lti/service/toolsettings/classes/local/resource','contextsettings.php',62],['lib/google/src/Google','Client.php',545],['backup/util/plan','restore_structure_step.class.php',62],['lib/classes/task','legacy_plugin_cron_task.php',42],['lib/dml','pdo_moodle_database.php',226],['lib/classes/task','check_for_updates_task.php',40],['backup/util/helper','restore_decode_processor.class.php',73],['backup/moodle2','backup_section_task.class.php',97],['webservice/amf/testclient','AMFTester.mxml',282],['lib/classes/task','delete_incomplete_users_task.php',40],['mod/assign','adminlib.php',342],['lib/classes/task','send_new_user_passwords_task.php',40],['admin/tool/monitor/classes/task','clean_events.php',41]], 733],
'update_record': ['update_record', 'Update a record in a table ', [['lib/dml','pgsql_native_moodle_database.php',1137],['lib/dml','oci_native_moodle_database.php',1355],['lib/dml','sqlsrv_native_moodle_database.php',1081],['lib/dml','mssql_native_moodle_database.php',1003],['lib/dml','mysqli_native_moodle_database.php',1397],['lib/dml/tests','dml_test.php',5430],['lib/dml','pdo_moodle_database.php',460]], 565],
'set_context': ['set_context', 'Set the context. ', [['mod/assign','locallib.php',246],['lib/portfolio','caller.php',568],['grade/grading','lib.php',116],['lib','pagelib.php',942]], 254],
'get_coursemodule_from_id': ['get_coursemodule_from_id', 'Given an id of a course module, finds the coursemodule description ', [['lib','datalib.php',1269]], 212],
'get_submission_plugins': ['get_submission_plugins', 'Get list of submission plugins installed. ', [['mod/assign','locallib.php',273]], 24],
'add_course_module': ['add_course_module', '', [['course','lib.php',1423]], 4],
'get_context': ['get_context', '', [['availability/classes','info_module.php',72],['grade/grading/form','lib.php',102],['availability/tests/fixtures','mock_info.php',59],['lib/classes/event','base.php',544],['lib','modinfolib.php',1501],['mod/assign','locallib.php',1247],['enrol','locallib.php',906],['lib/tests/behat','behat_data_generators.php',718],['mod/quiz','attemptlib.php',220],['comment','lib.php',990],['availability/classes','info_section.php',55],['grade/grading','lib.php',107],['lib','badgeslib.php',157],['lib','coursecatlib.php',2255],['lib','coursecatlib.php',2951]], 676],
'time': ['time', '', [], 1768],
'define': ['define', '', [], 2170],
'defined': ['defined', '', [], 4098]};
CLASS_DATA={
'core_php_time_limit': ['core_php_time_limit', 'Utility class to manage PHP time limit. ', [['lib/classes','php_time_limit.php',27]], 87],
'assign': ['assign', 'Standard base class for mod_assign (assignment types). ', [['mod/assign','locallib.php',80]], 76],
'assign_upgrade_manager': ['assign_upgrade_manager', 'Class to manage upgrades from mod_assignment to mod_assign ', [['mod/assign','upgradelib.php',38]], 6],
'context_module': ['context_module', 'Course module context class ', [['lib','accesslib.php',6988]], 942],
'info': ['info', 'Defines the structure of objects returned by {@link \core\update\checker::get_update_info()} ', [['lib/classes/update','info.php',28]], 52]};
CONST_DATA={
'IGNORE_MISSING': ['IGNORE_MISSING', '', [['lib','dmllib.php',48]], 204],
'ASSIGN_SUBMISSION_STATUS_SUBMITTED': ['ASSIGN_SUBMISSION_STATUS_SUBMITTED', '', [['mod/assign','locallib.php',33]], 65],
'ASSIGN_UNLIMITED_ATTEMPTS': ['ASSIGN_UNLIMITED_ATTEMPTS', '', [['mod/assign','locallib.php',50]], 10],
'MUST_EXIST': ['MUST_EXIST', '', [['lib','dmllib.php',52]], 1252],
'ASSIGN_MAX_UPGRADE_TIME_SECS': ['ASSIGN_MAX_UPGRADE_TIME_SECS', '', [['mod/assign','upgradelib.php',36]], 2],
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',138],['','install.php',93],['lib','setup.php',386]], 3532]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu May 28 19:17:31 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
