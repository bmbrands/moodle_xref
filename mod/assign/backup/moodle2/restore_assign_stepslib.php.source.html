<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /mod/assign/backup/moodle2/restore_assign_stepslib.php source</title>
    <link rel="stylesheet" href="../../../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Aug 11 10:00:09 2016 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../../../';
subdir='mod/assign/backup/moodle2';
filename='restore_assign_stepslib.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/mod/assign/backup/moodle2/</a> -> <a href="restore_assign_stepslib.php.html">restore_assign_stepslib.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="restore_assign_stepslib.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="restore_assign_stepslib.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * Define all the restore steps that will be used by the restore_assign_activity_task</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * @package   mod_assign</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @copyright 2012 NetSpot {@link http://www.netspot.com.au}</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> */</span>
<a name="l24"><span class="linenum">  24</span></a>  
<a name="l25"><span class="linenum">  25</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../../../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../../../../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die();
<a name="l26"><span class="linenum">  26</span></a>  
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment">/**</span>
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment"> * Define the complete assignment structure for restore, with file and id annotations</span>
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment"> *</span>
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment"> * @package   mod_assign</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment"> * @copyright 2012 NetSpot {@link http://www.netspot.com.au}</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> */</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('restore_assign_activity_structure_step')" href="../../../../_classes/restore_assign_activity_structure_step.html" onMouseOver="classPopup(event,'restore_assign_activity_structure_step')">restore_assign_activity_structure_step</a> extends restore_activity_structure_step {
<a name="l35"><span class="linenum">  35</span></a>  
<a name="l36"><span class="linenum">  36</span></a>      <span class="comment">/**</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment">     * Store whether submission details should be included. Details may not be included if the</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment">     * this is a team submission, but groups/grouping information was not included in the backup.</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="comment">     */</span>
<a name="l40"><span class="linenum">  40</span></a>      protected <a class="var it37189" onMouseOver="hilite(37189)" onMouseOut="lolite()" onClick="logVariable('includesubmission')" href="../../../../_variables/includesubmission.html">$includesubmission</a> = true;
<a name="l41"><span class="linenum">  41</span></a>  
<a name="l42"><span class="linenum">  42</span></a>      <span class="comment">/**</span>
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment">     * Define the structure of the restore workflow.</span>
<a name="l44"><span class="linenum">  44</span></a>  <span class="comment">     *</span>
<a name="l45"><span class="linenum">  45</span></a>  <span class="comment">     * @return restore_path_element $structure</span>
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment">     */</span>
<a name="l47"><span class="linenum">  47</span></a>      protected function <a class="function" onClick="logFunction('define_structure')" href="../../../../_functions/define_structure.html" onMouseOver="funcPopup(event,'define_structure')">define_structure</a>() {
<a name="l48"><span class="linenum">  48</span></a>  
<a name="l49"><span class="linenum">  49</span></a>          <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../../../_variables/paths.html">$paths</a> = array();
<a name="l50"><span class="linenum">  50</span></a>  <span class="comment">        // To know if we are including userinfo.</span>
<a name="l51"><span class="linenum">  51</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('userinfo')" href="../../../../_variables/userinfo.html">$userinfo</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_setting_value')" href="../../../../_functions/get_setting_value.html" onMouseOver="funcPopup(event,'get_setting_value')">get_setting_value</a>('userinfo');
<a name="l52"><span class="linenum">  52</span></a>  
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment">        // Define each element separated.</span>
<a name="l54"><span class="linenum">  54</span></a>          <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../../../_variables/paths.html">$paths</a>[] = <span class="keyword">new </span><a class="class" onClick="logClass('restore_path_element')" href="../../../../_classes/restore_path_element.html" onMouseOver="classPopup(event,'restore_path_element')">restore_path_element</a>('assign', '/activity/assign');
<a name="l55"><span class="linenum">  55</span></a>          if (<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('userinfo')" href="../../../../_variables/userinfo.html">$userinfo</a>) {
<a name="l56"><span class="linenum">  56</span></a>              <a class="var it5006" onMouseOver="hilite(5006)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../../../_variables/submission.html">$submission</a> = <span class="keyword">new </span><a class="class" onClick="logClass('restore_path_element')" href="../../../../_classes/restore_path_element.html" onMouseOver="classPopup(event,'restore_path_element')">restore_path_element</a>('assign_submission',
<a name="l57"><span class="linenum">  57</span></a>                                                     '/activity/assign/submissions/submission');
<a name="l58"><span class="linenum">  58</span></a>              <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../../../_variables/paths.html">$paths</a>[] = <a class="var it5006" onMouseOver="hilite(5006)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../../../_variables/submission.html">$submission</a>;
<a name="l59"><span class="linenum">  59</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('add_subplugin_structure')" href="../../../../_functions/add_subplugin_structure.html" onMouseOver="funcPopup(event,'add_subplugin_structure')">add_subplugin_structure</a>('assignsubmission', <a class="var it5006" onMouseOver="hilite(5006)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../../../_variables/submission.html">$submission</a>);
<a name="l60"><span class="linenum">  60</span></a>              <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../../../_variables/grade.html">$grade</a> = <span class="keyword">new </span><a class="class" onClick="logClass('restore_path_element')" href="../../../../_classes/restore_path_element.html" onMouseOver="classPopup(event,'restore_path_element')">restore_path_element</a>('assign_grade', '/activity/assign/grades/grade');
<a name="l61"><span class="linenum">  61</span></a>              <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../../../_variables/paths.html">$paths</a>[] = <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../../../_variables/grade.html">$grade</a>;
<a name="l62"><span class="linenum">  62</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('add_subplugin_structure')" href="../../../../_functions/add_subplugin_structure.html" onMouseOver="funcPopup(event,'add_subplugin_structure')">add_subplugin_structure</a>('assignfeedback', <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../../../_variables/grade.html">$grade</a>);
<a name="l63"><span class="linenum">  63</span></a>              <a class="var it20310" onMouseOver="hilite(20310)" onMouseOut="lolite()" onClick="logVariable('userflag')" href="../../../../_variables/userflag.html">$userflag</a> = <span class="keyword">new </span><a class="class" onClick="logClass('restore_path_element')" href="../../../../_classes/restore_path_element.html" onMouseOver="classPopup(event,'restore_path_element')">restore_path_element</a>('assign_userflag',
<a name="l64"><span class="linenum">  64</span></a>                                                     '/activity/assign/userflags/userflag');
<a name="l65"><span class="linenum">  65</span></a>              <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../../../_variables/paths.html">$paths</a>[] = <a class="var it20310" onMouseOver="hilite(20310)" onMouseOut="lolite()" onClick="logVariable('userflag')" href="../../../../_variables/userflag.html">$userflag</a>;
<a name="l66"><span class="linenum">  66</span></a>          }
<a name="l67"><span class="linenum">  67</span></a>          <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../../../_variables/paths.html">$paths</a>[] = <span class="keyword">new </span><a class="class" onClick="logClass('restore_path_element')" href="../../../../_classes/restore_path_element.html" onMouseOver="classPopup(event,'restore_path_element')">restore_path_element</a>('assign_plugin_config',
<a name="l68"><span class="linenum">  68</span></a>                                              '/activity/assign/plugin_configs/plugin_config');
<a name="l69"><span class="linenum">  69</span></a>  
<a name="l70"><span class="linenum">  70</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_activity_structure')" href="../../../../_functions/prepare_activity_structure.html" onMouseOver="funcPopup(event,'prepare_activity_structure')">prepare_activity_structure</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('paths')" href="../../../../_variables/paths.html">$paths</a>);
<a name="l71"><span class="linenum">  71</span></a>      }
<a name="l72"><span class="linenum">  72</span></a>  
<a name="l73"><span class="linenum">  73</span></a>      <span class="comment">/**</span>
<a name="l74"><span class="linenum">  74</span></a>  <span class="comment">     * Process an assign restore.</span>
<a name="l75"><span class="linenum">  75</span></a>  <span class="comment">     *</span>
<a name="l76"><span class="linenum">  76</span></a>  <span class="comment">     * @param object $data The data in object form</span>
<a name="l77"><span class="linenum">  77</span></a>  <span class="comment">     * @return void</span>
<a name="l78"><span class="linenum">  78</span></a>  <span class="comment">     */</span>
<a name="l79"><span class="linenum">  79</span></a>      protected function <a class="function" onClick="logFunction('process_assign')" href="../../../../_functions/process_assign.html" onMouseOver="funcPopup(event,'process_assign')">process_assign</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>) {
<a name="l80"><span class="linenum">  80</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>;
<a name="l81"><span class="linenum">  81</span></a>  
<a name="l82"><span class="linenum">  82</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a> = (object)<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>;
<a name="l83"><span class="linenum">  83</span></a>          <a class="var it6" onMouseOver="hilite(6)" onMouseOut="lolite()" onClick="logVariable('oldid')" href="../../../../_variables/oldid.html">$oldid</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('id')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/id.html">id</a>;
<a name="l84"><span class="linenum">  84</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('course')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/course.html">course</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_courseid')" href="../../../../_functions/get_courseid.html" onMouseOver="funcPopup(event,'get_courseid')">get_courseid</a>();
<a name="l85"><span class="linenum">  85</span></a>  
<a name="l86"><span class="linenum">  86</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('timemodified')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/timemodified.html">timemodified</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('apply_date_offset')" href="../../../../_functions/apply_date_offset.html" onMouseOver="funcPopup(event,'apply_date_offset')">apply_date_offset</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('timemodified')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/timemodified.html">timemodified</a>);
<a name="l87"><span class="linenum">  87</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('allowsubmissionsfromdate')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/allowsubmissionsfromdate.html">allowsubmissionsfromdate</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('apply_date_offset')" href="../../../../_functions/apply_date_offset.html" onMouseOver="funcPopup(event,'apply_date_offset')">apply_date_offset</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('allowsubmissionsfromdate')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/allowsubmissionsfromdate.html">allowsubmissionsfromdate</a>);
<a name="l88"><span class="linenum">  88</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('duedate')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/duedate.html">duedate</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('apply_date_offset')" href="../../../../_functions/apply_date_offset.html" onMouseOver="funcPopup(event,'apply_date_offset')">apply_date_offset</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('duedate')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/duedate.html">duedate</a>);
<a name="l89"><span class="linenum">  89</span></a>  
<a name="l90"><span class="linenum">  90</span></a>  <span class="comment">        // If this is a team submission, but there is no group info we need to flag that the submission</span>
<a name="l91"><span class="linenum">  91</span></a>  <span class="comment">        // information should not be included. It should not be restored.</span>
<a name="l92"><span class="linenum">  92</span></a>          <a class="var it15380" onMouseOver="hilite(15380)" onMouseOut="lolite()" onClick="logVariable('groupinfo')" href="../../../../_variables/groupinfo.html">$groupinfo</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('task')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../../../_variables/task.html">task</a>-&gt;<a class="function" onClick="logFunction('get_setting_value')" href="../../../../_functions/get_setting_value.html" onMouseOver="funcPopup(event,'get_setting_value')">get_setting_value</a>('groups');
<a name="l93"><span class="linenum">  93</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('teamsubmission')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/teamsubmission.html">teamsubmission</a> &amp;&amp; !<a class="var it15380" onMouseOver="hilite(15380)" onMouseOut="lolite()" onClick="logVariable('groupinfo')" href="../../../../_variables/groupinfo.html">$groupinfo</a>) {
<a name="l94"><span class="linenum">  94</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('includesubmission')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../../../_variables/includesubmission.html">includesubmission</a> = false;
<a name="l95"><span class="linenum">  95</span></a>          }
<a name="l96"><span class="linenum">  96</span></a>  
<a name="l97"><span class="linenum">  97</span></a>          if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('teamsubmissiongroupingid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/teamsubmissiongroupingid.html">teamsubmissiongroupingid</a>)) {
<a name="l98"><span class="linenum">  98</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('teamsubmissiongroupingid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/teamsubmissiongroupingid.html">teamsubmissiongroupingid</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_mappingid')" href="../../../../_functions/get_mappingid.html" onMouseOver="funcPopup(event,'get_mappingid')">get_mappingid</a>('grouping',
<a name="l99"><span class="linenum">  99</span></a>                                                                     <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('teamsubmissiongroupingid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/teamsubmissiongroupingid.html">teamsubmissiongroupingid</a>);
<a name="l100"><span class="linenum"> 100</span></a>          } else {
<a name="l101"><span class="linenum"> 101</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('teamsubmissiongroupingid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/teamsubmissiongroupingid.html">teamsubmissiongroupingid</a> = 0;
<a name="l102"><span class="linenum"> 102</span></a>          }
<a name="l103"><span class="linenum"> 103</span></a>  
<a name="l104"><span class="linenum"> 104</span></a>          if (!isset(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('cutoffdate')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/cutoffdate.html">cutoffdate</a>)) {
<a name="l105"><span class="linenum"> 105</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('cutoffdate')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/cutoffdate.html">cutoffdate</a> = 0;
<a name="l106"><span class="linenum"> 106</span></a>          }
<a name="l107"><span class="linenum"> 107</span></a>          if (!isset(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('markingworkflow')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/markingworkflow.html">markingworkflow</a>)) {
<a name="l108"><span class="linenum"> 108</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('markingworkflow')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/markingworkflow.html">markingworkflow</a> = 0;
<a name="l109"><span class="linenum"> 109</span></a>          }
<a name="l110"><span class="linenum"> 110</span></a>          if (!isset(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('markingallocation')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/markingallocation.html">markingallocation</a>)) {
<a name="l111"><span class="linenum"> 111</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('markingallocation')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/markingallocation.html">markingallocation</a> = 0;
<a name="l112"><span class="linenum"> 112</span></a>          }
<a name="l113"><span class="linenum"> 113</span></a>          if (!isset(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('preventsubmissionnotingroup')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/preventsubmissionnotingroup.html">preventsubmissionnotingroup</a>)) {
<a name="l114"><span class="linenum"> 114</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('preventsubmissionnotingroup')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/preventsubmissionnotingroup.html">preventsubmissionnotingroup</a> = 0;
<a name="l115"><span class="linenum"> 115</span></a>          }
<a name="l116"><span class="linenum"> 116</span></a>  
<a name="l117"><span class="linenum"> 117</span></a>          if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('preventlatesubmissions')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/preventlatesubmissions.html">preventlatesubmissions</a>)) {
<a name="l118"><span class="linenum"> 118</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('cutoffdate')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/cutoffdate.html">cutoffdate</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('duedate')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/duedate.html">duedate</a>;
<a name="l119"><span class="linenum"> 119</span></a>          } else {
<a name="l120"><span class="linenum"> 120</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('cutoffdate')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/cutoffdate.html">cutoffdate</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('apply_date_offset')" href="../../../../_functions/apply_date_offset.html" onMouseOver="funcPopup(event,'apply_date_offset')">apply_date_offset</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('cutoffdate')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/cutoffdate.html">cutoffdate</a>);
<a name="l121"><span class="linenum"> 121</span></a>          }
<a name="l122"><span class="linenum"> 122</span></a>  
<a name="l123"><span class="linenum"> 123</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('grade')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/grade.html">grade</a> &lt; 0) { // Scale found, get mapping.
<a name="l124"><span class="linenum"> 124</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('grade')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/grade.html">grade</a> = -(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_mappingid')" href="../../../../_functions/get_mappingid.html" onMouseOver="funcPopup(event,'get_mappingid')">get_mappingid</a>('scale', <a class="phpfunction" onClick="logFunction('abs')" href="../../../../_functions/abs.html" onMouseOver="phpfuncPopup(event,'abs')">abs</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('grade')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/grade.html">grade</a>)));
<a name="l125"><span class="linenum"> 125</span></a>          }
<a name="l126"><span class="linenum"> 126</span></a>  
<a name="l127"><span class="linenum"> 127</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('newitemid')" href="../../../../_variables/newitemid.html">$newitemid</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('assign', <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>);
<a name="l128"><span class="linenum"> 128</span></a>  
<a name="l129"><span class="linenum"> 129</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('apply_activity_instance')" href="../../../../_functions/apply_activity_instance.html" onMouseOver="funcPopup(event,'apply_activity_instance')">apply_activity_instance</a>(<a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('newitemid')" href="../../../../_variables/newitemid.html">$newitemid</a>);
<a name="l130"><span class="linenum"> 130</span></a>      }
<a name="l131"><span class="linenum"> 131</span></a>  
<a name="l132"><span class="linenum"> 132</span></a>      <span class="comment">/**</span>
<a name="l133"><span class="linenum"> 133</span></a>  <span class="comment">     * Process a submission restore</span>
<a name="l134"><span class="linenum"> 134</span></a>  <span class="comment">     * @param object $data The data in object form</span>
<a name="l135"><span class="linenum"> 135</span></a>  <span class="comment">     * @return void</span>
<a name="l136"><span class="linenum"> 136</span></a>  <span class="comment">     */</span>
<a name="l137"><span class="linenum"> 137</span></a>      protected function <a class="function" onClick="logFunction('process_assign_submission')" href="../../../../_functions/process_assign_submission.html" onMouseOver="funcPopup(event,'process_assign_submission')">process_assign_submission</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>) {
<a name="l138"><span class="linenum"> 138</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>;
<a name="l139"><span class="linenum"> 139</span></a>  
<a name="l140"><span class="linenum"> 140</span></a>          if (!<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('includesubmission')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../../../_variables/includesubmission.html">includesubmission</a>) {
<a name="l141"><span class="linenum"> 141</span></a>              return;
<a name="l142"><span class="linenum"> 142</span></a>          }
<a name="l143"><span class="linenum"> 143</span></a>  
<a name="l144"><span class="linenum"> 144</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a> = (object)<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>;
<a name="l145"><span class="linenum"> 145</span></a>          <a class="var it6" onMouseOver="hilite(6)" onMouseOut="lolite()" onClick="logVariable('oldid')" href="../../../../_variables/oldid.html">$oldid</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('id')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/id.html">id</a>;
<a name="l146"><span class="linenum"> 146</span></a>  
<a name="l147"><span class="linenum"> 147</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('assignment')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/assignment.html">assignment</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_new_parentid')" href="../../../../_functions/get_new_parentid.html" onMouseOver="funcPopup(event,'get_new_parentid')">get_new_parentid</a>('assign');
<a name="l148"><span class="linenum"> 148</span></a>  
<a name="l149"><span class="linenum"> 149</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('timemodified')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/timemodified.html">timemodified</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('apply_date_offset')" href="../../../../_functions/apply_date_offset.html" onMouseOver="funcPopup(event,'apply_date_offset')">apply_date_offset</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('timemodified')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/timemodified.html">timemodified</a>);
<a name="l150"><span class="linenum"> 150</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('timecreated')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/timecreated.html">timecreated</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('apply_date_offset')" href="../../../../_functions/apply_date_offset.html" onMouseOver="funcPopup(event,'apply_date_offset')">apply_date_offset</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('timecreated')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/timecreated.html">timecreated</a>);
<a name="l151"><span class="linenum"> 151</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('userid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/userid.html">userid</a> &gt; 0) {
<a name="l152"><span class="linenum"> 152</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('userid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/userid.html">userid</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_mappingid')" href="../../../../_functions/get_mappingid.html" onMouseOver="funcPopup(event,'get_mappingid')">get_mappingid</a>('user', <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('userid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/userid.html">userid</a>);
<a name="l153"><span class="linenum"> 153</span></a>          }
<a name="l154"><span class="linenum"> 154</span></a>          if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('groupid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/groupid.html">groupid</a>)) {
<a name="l155"><span class="linenum"> 155</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('groupid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/groupid.html">groupid</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_mappingid')" href="../../../../_functions/get_mappingid.html" onMouseOver="funcPopup(event,'get_mappingid')">get_mappingid</a>('group', <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('groupid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/groupid.html">groupid</a>);
<a name="l156"><span class="linenum"> 156</span></a>          } else {
<a name="l157"><span class="linenum"> 157</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('groupid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/groupid.html">groupid</a> = 0;
<a name="l158"><span class="linenum"> 158</span></a>          }
<a name="l159"><span class="linenum"> 159</span></a>  
<a name="l160"><span class="linenum"> 160</span></a>  <span class="comment">        // We will correct this in set_latest_submission_field() once all submissions are restored.</span>
<a name="l161"><span class="linenum"> 161</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('latest')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/latest.html">latest</a> = 0;
<a name="l162"><span class="linenum"> 162</span></a>  
<a name="l163"><span class="linenum"> 163</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('newitemid')" href="../../../../_variables/newitemid.html">$newitemid</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('assign_submission', <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>);
<a name="l164"><span class="linenum"> 164</span></a>  
<a name="l165"><span class="linenum"> 165</span></a>  <span class="comment">        // Note - the old contextid is required in order to be able to restore files stored in</span>
<a name="l166"><span class="linenum"> 166</span></a>  <span class="comment">        // sub plugin file areas attached to the submissionid.</span>
<a name="l167"><span class="linenum"> 167</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('set_mapping')" href="../../../../_functions/set_mapping.html" onMouseOver="funcPopup(event,'set_mapping')">set_mapping</a>('submission', <a class="var it6" onMouseOver="hilite(6)" onMouseOut="lolite()" onClick="logVariable('oldid')" href="../../../../_variables/oldid.html">$oldid</a>, <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('newitemid')" href="../../../../_variables/newitemid.html">$newitemid</a>, false, null, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('task')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../../../_variables/task.html">task</a>-&gt;<a class="function" onClick="logFunction('get_old_contextid')" href="../../../../_functions/get_old_contextid.html" onMouseOver="funcPopup(event,'get_old_contextid')">get_old_contextid</a>());
<a name="l168"><span class="linenum"> 168</span></a>      }
<a name="l169"><span class="linenum"> 169</span></a>  
<a name="l170"><span class="linenum"> 170</span></a>      <span class="comment">/**</span>
<a name="l171"><span class="linenum"> 171</span></a>  <span class="comment">     * Process a user_flags restore</span>
<a name="l172"><span class="linenum"> 172</span></a>  <span class="comment">     * @param object $data The data in object form</span>
<a name="l173"><span class="linenum"> 173</span></a>  <span class="comment">     * @return void</span>
<a name="l174"><span class="linenum"> 174</span></a>  <span class="comment">     */</span>
<a name="l175"><span class="linenum"> 175</span></a>      protected function <a class="function" onClick="logFunction('process_assign_userflag')" href="../../../../_functions/process_assign_userflag.html" onMouseOver="funcPopup(event,'process_assign_userflag')">process_assign_userflag</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>) {
<a name="l176"><span class="linenum"> 176</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>;
<a name="l177"><span class="linenum"> 177</span></a>  
<a name="l178"><span class="linenum"> 178</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a> = (object)<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>;
<a name="l179"><span class="linenum"> 179</span></a>          <a class="var it6" onMouseOver="hilite(6)" onMouseOut="lolite()" onClick="logVariable('oldid')" href="../../../../_variables/oldid.html">$oldid</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('id')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/id.html">id</a>;
<a name="l180"><span class="linenum"> 180</span></a>  
<a name="l181"><span class="linenum"> 181</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('assignment')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/assignment.html">assignment</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_new_parentid')" href="../../../../_functions/get_new_parentid.html" onMouseOver="funcPopup(event,'get_new_parentid')">get_new_parentid</a>('assign');
<a name="l182"><span class="linenum"> 182</span></a>  
<a name="l183"><span class="linenum"> 183</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('userid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/userid.html">userid</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_mappingid')" href="../../../../_functions/get_mappingid.html" onMouseOver="funcPopup(event,'get_mappingid')">get_mappingid</a>('user', <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('userid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/userid.html">userid</a>);
<a name="l184"><span class="linenum"> 184</span></a>          if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('allocatedmarker')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/allocatedmarker.html">allocatedmarker</a>)) {
<a name="l185"><span class="linenum"> 185</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('allocatedmarker')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/allocatedmarker.html">allocatedmarker</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_mappingid')" href="../../../../_functions/get_mappingid.html" onMouseOver="funcPopup(event,'get_mappingid')">get_mappingid</a>('user', <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('allocatedmarker')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/allocatedmarker.html">allocatedmarker</a>);
<a name="l186"><span class="linenum"> 186</span></a>          }
<a name="l187"><span class="linenum"> 187</span></a>          if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('extensionduedate')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/extensionduedate.html">extensionduedate</a>)) {
<a name="l188"><span class="linenum"> 188</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('extensionduedate')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/extensionduedate.html">extensionduedate</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('apply_date_offset')" href="../../../../_functions/apply_date_offset.html" onMouseOver="funcPopup(event,'apply_date_offset')">apply_date_offset</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('extensionduedate')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/extensionduedate.html">extensionduedate</a>);
<a name="l189"><span class="linenum"> 189</span></a>          } else {
<a name="l190"><span class="linenum"> 190</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('extensionduedate')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/extensionduedate.html">extensionduedate</a> = 0;
<a name="l191"><span class="linenum"> 191</span></a>          }
<a name="l192"><span class="linenum"> 192</span></a>  <span class="comment">        // Flags mailed and locked need no translation on restore.</span>
<a name="l193"><span class="linenum"> 193</span></a>  
<a name="l194"><span class="linenum"> 194</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('newitemid')" href="../../../../_variables/newitemid.html">$newitemid</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('assign_user_flags', <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>);
<a name="l195"><span class="linenum"> 195</span></a>      }
<a name="l196"><span class="linenum"> 196</span></a>  
<a name="l197"><span class="linenum"> 197</span></a>      <span class="comment">/**</span>
<a name="l198"><span class="linenum"> 198</span></a>  <span class="comment">     * Process a grade restore</span>
<a name="l199"><span class="linenum"> 199</span></a>  <span class="comment">     * @param object $data The data in object form</span>
<a name="l200"><span class="linenum"> 200</span></a>  <span class="comment">     * @return void</span>
<a name="l201"><span class="linenum"> 201</span></a>  <span class="comment">     */</span>
<a name="l202"><span class="linenum"> 202</span></a>      protected function <a class="function" onClick="logFunction('process_assign_grade')" href="../../../../_functions/process_assign_grade.html" onMouseOver="funcPopup(event,'process_assign_grade')">process_assign_grade</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>) {
<a name="l203"><span class="linenum"> 203</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>;
<a name="l204"><span class="linenum"> 204</span></a>  
<a name="l205"><span class="linenum"> 205</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a> = (object)<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>;
<a name="l206"><span class="linenum"> 206</span></a>          <a class="var it6" onMouseOver="hilite(6)" onMouseOut="lolite()" onClick="logVariable('oldid')" href="../../../../_variables/oldid.html">$oldid</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('id')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/id.html">id</a>;
<a name="l207"><span class="linenum"> 207</span></a>  
<a name="l208"><span class="linenum"> 208</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('assignment')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/assignment.html">assignment</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_new_parentid')" href="../../../../_functions/get_new_parentid.html" onMouseOver="funcPopup(event,'get_new_parentid')">get_new_parentid</a>('assign');
<a name="l209"><span class="linenum"> 209</span></a>  
<a name="l210"><span class="linenum"> 210</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('timemodified')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/timemodified.html">timemodified</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('apply_date_offset')" href="../../../../_functions/apply_date_offset.html" onMouseOver="funcPopup(event,'apply_date_offset')">apply_date_offset</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('timemodified')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/timemodified.html">timemodified</a>);
<a name="l211"><span class="linenum"> 211</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('timecreated')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/timecreated.html">timecreated</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('apply_date_offset')" href="../../../../_functions/apply_date_offset.html" onMouseOver="funcPopup(event,'apply_date_offset')">apply_date_offset</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('timecreated')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/timecreated.html">timecreated</a>);
<a name="l212"><span class="linenum"> 212</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('userid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/userid.html">userid</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_mappingid')" href="../../../../_functions/get_mappingid.html" onMouseOver="funcPopup(event,'get_mappingid')">get_mappingid</a>('user', <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('userid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/userid.html">userid</a>);
<a name="l213"><span class="linenum"> 213</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('grader')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/grader.html">grader</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_mappingid')" href="../../../../_functions/get_mappingid.html" onMouseOver="funcPopup(event,'get_mappingid')">get_mappingid</a>('user', <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('grader')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/grader.html">grader</a>);
<a name="l214"><span class="linenum"> 214</span></a>  
<a name="l215"><span class="linenum"> 215</span></a>  <span class="comment">        // Handle flags restore to a different table (for upgrade from old backups).</span>
<a name="l216"><span class="linenum"> 216</span></a>          if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('extensionduedate')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/extensionduedate.html">extensionduedate</a>) ||
<a name="l217"><span class="linenum"> 217</span></a>                  !empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('mailed')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/mailed.html">mailed</a>) ||
<a name="l218"><span class="linenum"> 218</span></a>                  !empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('locked')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/locked.html">locked</a>)) {
<a name="l219"><span class="linenum"> 219</span></a>              <a class="var it207" onMouseOver="hilite(207)" onMouseOut="lolite()" onClick="logVariable('flags')" href="../../../../_variables/flags.html">$flags</a> = new stdClass();
<a name="l220"><span class="linenum"> 220</span></a>              <a class="var it207" onMouseOver="hilite(207)" onMouseOut="lolite()" onClick="logVariable('flags')" href="../../../../_variables/flags.html">$flags</a>-&gt;<a onClick="logVariable('assignment')" class="var it43097" onMouseOver="hilite(43097)" onMouseOut="lolite()" href="../../../../_variables/assignment.html">assignment</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_new_parentid')" href="../../../../_functions/get_new_parentid.html" onMouseOver="funcPopup(event,'get_new_parentid')">get_new_parentid</a>('assign');
<a name="l221"><span class="linenum"> 221</span></a>              if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('extensionduedate')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/extensionduedate.html">extensionduedate</a>)) {
<a name="l222"><span class="linenum"> 222</span></a>                  <a class="var it207" onMouseOver="hilite(207)" onMouseOut="lolite()" onClick="logVariable('flags')" href="../../../../_variables/flags.html">$flags</a>-&gt;<a onClick="logVariable('extensionduedate')" class="var it43097" onMouseOver="hilite(43097)" onMouseOut="lolite()" href="../../../../_variables/extensionduedate.html">extensionduedate</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('apply_date_offset')" href="../../../../_functions/apply_date_offset.html" onMouseOver="funcPopup(event,'apply_date_offset')">apply_date_offset</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('extensionduedate')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/extensionduedate.html">extensionduedate</a>);
<a name="l223"><span class="linenum"> 223</span></a>              }
<a name="l224"><span class="linenum"> 224</span></a>              if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('mailed')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/mailed.html">mailed</a>)) {
<a name="l225"><span class="linenum"> 225</span></a>                  <a class="var it207" onMouseOver="hilite(207)" onMouseOut="lolite()" onClick="logVariable('flags')" href="../../../../_variables/flags.html">$flags</a>-&gt;<a onClick="logVariable('mailed')" class="var it43097" onMouseOver="hilite(43097)" onMouseOut="lolite()" href="../../../../_variables/mailed.html">mailed</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('mailed')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/mailed.html">mailed</a>;
<a name="l226"><span class="linenum"> 226</span></a>              }
<a name="l227"><span class="linenum"> 227</span></a>              if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('locked')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/locked.html">locked</a>)) {
<a name="l228"><span class="linenum"> 228</span></a>                  <a class="var it207" onMouseOver="hilite(207)" onMouseOut="lolite()" onClick="logVariable('flags')" href="../../../../_variables/flags.html">$flags</a>-&gt;<a onClick="logVariable('locked')" class="var it43097" onMouseOver="hilite(43097)" onMouseOut="lolite()" href="../../../../_variables/locked.html">locked</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('locked')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/locked.html">locked</a>;
<a name="l229"><span class="linenum"> 229</span></a>              }
<a name="l230"><span class="linenum"> 230</span></a>              <a class="var it207" onMouseOver="hilite(207)" onMouseOut="lolite()" onClick="logVariable('flags')" href="../../../../_variables/flags.html">$flags</a>-&gt;<a onClick="logVariable('userid')" class="var it43097" onMouseOver="hilite(43097)" onMouseOut="lolite()" href="../../../../_variables/userid.html">userid</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_mappingid')" href="../../../../_functions/get_mappingid.html" onMouseOver="funcPopup(event,'get_mappingid')">get_mappingid</a>('user', <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('userid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/userid.html">userid</a>);
<a name="l231"><span class="linenum"> 231</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('assign_user_flags', <a class="var it207" onMouseOver="hilite(207)" onMouseOut="lolite()" onClick="logVariable('flags')" href="../../../../_variables/flags.html">$flags</a>);
<a name="l232"><span class="linenum"> 232</span></a>          }
<a name="l233"><span class="linenum"> 233</span></a>  
<a name="l234"><span class="linenum"> 234</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('newitemid')" href="../../../../_variables/newitemid.html">$newitemid</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('assign_grades', <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>);
<a name="l235"><span class="linenum"> 235</span></a>  
<a name="l236"><span class="linenum"> 236</span></a>  <span class="comment">        // Note - the old contextid is required in order to be able to restore files stored in</span>
<a name="l237"><span class="linenum"> 237</span></a>  <span class="comment">        // sub plugin file areas attached to the gradeid.</span>
<a name="l238"><span class="linenum"> 238</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('set_mapping')" href="../../../../_functions/set_mapping.html" onMouseOver="funcPopup(event,'set_mapping')">set_mapping</a>('grade', <a class="var it6" onMouseOver="hilite(6)" onMouseOut="lolite()" onClick="logVariable('oldid')" href="../../../../_variables/oldid.html">$oldid</a>, <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('newitemid')" href="../../../../_variables/newitemid.html">$newitemid</a>, false, null, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('task')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../../../_variables/task.html">task</a>-&gt;<a class="function" onClick="logFunction('get_old_contextid')" href="../../../../_functions/get_old_contextid.html" onMouseOver="funcPopup(event,'get_old_contextid')">get_old_contextid</a>());
<a name="l239"><span class="linenum"> 239</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('set_mapping')" href="../../../../_functions/set_mapping.html" onMouseOver="funcPopup(event,'set_mapping')">set_mapping</a>(restore_gradingform_plugin::<a class="function" onClick="logFunction('itemid_mapping')" href="../../../../_functions/itemid_mapping.html" onMouseOver="funcPopup(event,'itemid_mapping')">itemid_mapping</a>('submissions'), <a class="var it6" onMouseOver="hilite(6)" onMouseOut="lolite()" onClick="logVariable('oldid')" href="../../../../_variables/oldid.html">$oldid</a>, <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('newitemid')" href="../../../../_variables/newitemid.html">$newitemid</a>);
<a name="l240"><span class="linenum"> 240</span></a>      }
<a name="l241"><span class="linenum"> 241</span></a>  
<a name="l242"><span class="linenum"> 242</span></a>      <span class="comment">/**</span>
<a name="l243"><span class="linenum"> 243</span></a>  <span class="comment">     * Process a plugin-config restore</span>
<a name="l244"><span class="linenum"> 244</span></a>  <span class="comment">     * @param object $data The data in object form</span>
<a name="l245"><span class="linenum"> 245</span></a>  <span class="comment">     * @return void</span>
<a name="l246"><span class="linenum"> 246</span></a>  <span class="comment">     */</span>
<a name="l247"><span class="linenum"> 247</span></a>      protected function <a class="function" onClick="logFunction('process_assign_plugin_config')" href="../../../../_functions/process_assign_plugin_config.html" onMouseOver="funcPopup(event,'process_assign_plugin_config')">process_assign_plugin_config</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>) {
<a name="l248"><span class="linenum"> 248</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>;
<a name="l249"><span class="linenum"> 249</span></a>  
<a name="l250"><span class="linenum"> 250</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a> = (object)<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>;
<a name="l251"><span class="linenum"> 251</span></a>          <a class="var it6" onMouseOver="hilite(6)" onMouseOut="lolite()" onClick="logVariable('oldid')" href="../../../../_variables/oldid.html">$oldid</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('id')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/id.html">id</a>;
<a name="l252"><span class="linenum"> 252</span></a>  
<a name="l253"><span class="linenum"> 253</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('assignment')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../../../_variables/assignment.html">assignment</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_new_parentid')" href="../../../../_functions/get_new_parentid.html" onMouseOver="funcPopup(event,'get_new_parentid')">get_new_parentid</a>('assign');
<a name="l254"><span class="linenum"> 254</span></a>  
<a name="l255"><span class="linenum"> 255</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('newitemid')" href="../../../../_variables/newitemid.html">$newitemid</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('assign_plugin_config', <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>);
<a name="l256"><span class="linenum"> 256</span></a>      }
<a name="l257"><span class="linenum"> 257</span></a>  
<a name="l258"><span class="linenum"> 258</span></a>      <span class="comment">/**</span>
<a name="l259"><span class="linenum"> 259</span></a>  <span class="comment">     * For all submissions in this assignment, either set the</span>
<a name="l260"><span class="linenum"> 260</span></a>  <span class="comment">     * submission-&gt;latest field to 1 for the latest attempts</span>
<a name="l261"><span class="linenum"> 261</span></a>  <span class="comment">     * or create a new submission record for grades with no submission.</span>
<a name="l262"><span class="linenum"> 262</span></a>  <span class="comment">     *</span>
<a name="l263"><span class="linenum"> 263</span></a>  <span class="comment">     * @return void</span>
<a name="l264"><span class="linenum"> 264</span></a>  <span class="comment">     */</span>
<a name="l265"><span class="linenum"> 265</span></a>      protected function <a class="function" onClick="logFunction('set_latest_submission_field')" href="../../../../_functions/set_latest_submission_field.html" onMouseOver="funcPopup(event,'set_latest_submission_field')">set_latest_submission_field</a>() {
<a name="l266"><span class="linenum"> 266</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../../_variables/CFG.html">$CFG</a>;
<a name="l267"><span class="linenum"> 267</span></a>  
<a name="l268"><span class="linenum"> 268</span></a>  <span class="comment">        // Required for constants.</span>
<a name="l269"><span class="linenum"> 269</span></a>          require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../../_variables/dirroot.html">dirroot</a> . '<a class="filename" href="../../../../mod/assign/locallib.php.html">/mod/assign/locallib.php</a>');
<a name="l270"><span class="linenum"> 270</span></a>  
<a name="l271"><span class="linenum"> 271</span></a>          <a class="var it281" onMouseOver="hilite(281)" onMouseOut="lolite()" onClick="logVariable('assignmentid')" href="../../../../_variables/assignmentid.html">$assignmentid</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_new_parentid')" href="../../../../_functions/get_new_parentid.html" onMouseOver="funcPopup(event,'get_new_parentid')">get_new_parentid</a>('assign');
<a name="l272"><span class="linenum"> 272</span></a>  <span class="comment">        // This code could be rewritten as a monster SQL - but the point of adding this &quot;latest&quot; field</span>
<a name="l273"><span class="linenum"> 273</span></a>  <span class="comment">        // to the submissions table in the first place was to get away from those hard to maintain SQL queries.</span>
<a name="l274"><span class="linenum"> 274</span></a>  
<a name="l275"><span class="linenum"> 275</span></a>  <span class="comment">        // First user submissions.</span>
<a name="l276"><span class="linenum"> 276</span></a>          <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../../_variables/sql.html">$sql</a> = 'SELECT DISTINCT userid FROM {assign_submission} WHERE assignment = ? AND groupid = ?';
<a name="l277"><span class="linenum"> 277</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../../_variables/params.html">$params</a> = array(<a class="var it281" onMouseOver="hilite(281)" onMouseOut="lolite()" onClick="logVariable('assignmentid')" href="../../../../_variables/assignmentid.html">$assignmentid</a>, 0);
<a name="l278"><span class="linenum"> 278</span></a>          <a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../../../_variables/users.html">$users</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../../_variables/sql.html">$sql</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../../_variables/params.html">$params</a>);
<a name="l279"><span class="linenum"> 279</span></a>  
<a name="l280"><span class="linenum"> 280</span></a>          foreach (<a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../../../_variables/users.html">$users</a> as <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../../_variables/userid.html">$userid</a> =&gt; <a class="var it1292" onMouseOver="hilite(1292)" onMouseOut="lolite()" onClick="logVariable('unused')" href="../../../../_variables/unused.html">$unused</a>) {
<a name="l281"><span class="linenum"> 281</span></a>              <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../../_variables/params.html">$params</a> = array('assignment'=&gt;<a class="var it281" onMouseOver="hilite(281)" onMouseOut="lolite()" onClick="logVariable('assignmentid')" href="../../../../_variables/assignmentid.html">$assignmentid</a>, 'groupid'=&gt;0, 'userid'=&gt;<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../../_variables/userid.html">$userid</a>);
<a name="l282"><span class="linenum"> 282</span></a>  
<a name="l283"><span class="linenum"> 283</span></a>  <span class="comment">            // Only return the row with the highest attemptnumber.</span>
<a name="l284"><span class="linenum"> 284</span></a>              <a class="var it5006" onMouseOver="hilite(5006)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../../../_variables/submission.html">$submission</a> = null;
<a name="l285"><span class="linenum"> 285</span></a>              <a class="var it8117" onMouseOver="hilite(8117)" onMouseOut="lolite()" onClick="logVariable('submissions')" href="../../../../_variables/submissions.html">$submissions</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('assign_submission', <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../../_variables/params.html">$params</a>, 'attemptnumber DESC', '*', 0, 1);
<a name="l286"><span class="linenum"> 286</span></a>              if (<a class="var it8117" onMouseOver="hilite(8117)" onMouseOut="lolite()" onClick="logVariable('submissions')" href="../../../../_variables/submissions.html">$submissions</a>) {
<a name="l287"><span class="linenum"> 287</span></a>                  <a class="var it5006" onMouseOver="hilite(5006)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../../../_variables/submission.html">$submission</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../../../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it8117" onMouseOver="hilite(8117)" onMouseOut="lolite()" onClick="logVariable('submissions')" href="../../../../_variables/submissions.html">$submissions</a>);
<a name="l288"><span class="linenum"> 288</span></a>                  <a class="var it5006" onMouseOver="hilite(5006)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../../../_variables/submission.html">$submission</a>-&gt;<a onClick="logVariable('latest')" class="var it42978" onMouseOver="hilite(42978)" onMouseOut="lolite()" href="../../../../_variables/latest.html">latest</a> = 1;
<a name="l289"><span class="linenum"> 289</span></a>                  <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('assign_submission', <a class="var it5006" onMouseOver="hilite(5006)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../../../_variables/submission.html">$submission</a>);
<a name="l290"><span class="linenum"> 290</span></a>              }
<a name="l291"><span class="linenum"> 291</span></a>          }
<a name="l292"><span class="linenum"> 292</span></a>  <span class="comment">        // Then group submissions (if any).</span>
<a name="l293"><span class="linenum"> 293</span></a>          <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../../_variables/sql.html">$sql</a> = 'SELECT DISTINCT groupid FROM {assign_submission} WHERE assignment = ? AND userid = ?';
<a name="l294"><span class="linenum"> 294</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../../_variables/params.html">$params</a> = array(<a class="var it281" onMouseOver="hilite(281)" onMouseOut="lolite()" onClick="logVariable('assignmentid')" href="../../../../_variables/assignmentid.html">$assignmentid</a>, 0);
<a name="l295"><span class="linenum"> 295</span></a>          <a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('groups')" href="../../../../_variables/groups.html">$groups</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../../_variables/sql.html">$sql</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../../_variables/params.html">$params</a>);
<a name="l296"><span class="linenum"> 296</span></a>  
<a name="l297"><span class="linenum"> 297</span></a>          foreach (<a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('groups')" href="../../../../_variables/groups.html">$groups</a> as <a class="var it681" onMouseOver="hilite(681)" onMouseOut="lolite()" onClick="logVariable('groupid')" href="../../../../_variables/groupid.html">$groupid</a> =&gt; <a class="var it1292" onMouseOver="hilite(1292)" onMouseOut="lolite()" onClick="logVariable('unused')" href="../../../../_variables/unused.html">$unused</a>) {
<a name="l298"><span class="linenum"> 298</span></a>              <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../../_variables/params.html">$params</a> = array('assignment'=&gt;<a class="var it281" onMouseOver="hilite(281)" onMouseOut="lolite()" onClick="logVariable('assignmentid')" href="../../../../_variables/assignmentid.html">$assignmentid</a>, 'userid'=&gt;0, 'groupid'=&gt;<a class="var it681" onMouseOver="hilite(681)" onMouseOut="lolite()" onClick="logVariable('groupid')" href="../../../../_variables/groupid.html">$groupid</a>);
<a name="l299"><span class="linenum"> 299</span></a>  
<a name="l300"><span class="linenum"> 300</span></a>  <span class="comment">            // Only return the row with the highest attemptnumber.</span>
<a name="l301"><span class="linenum"> 301</span></a>              <a class="var it5006" onMouseOver="hilite(5006)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../../../_variables/submission.html">$submission</a> = null;
<a name="l302"><span class="linenum"> 302</span></a>              <a class="var it8117" onMouseOver="hilite(8117)" onMouseOut="lolite()" onClick="logVariable('submissions')" href="../../../../_variables/submissions.html">$submissions</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('assign_submission', <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../../_variables/params.html">$params</a>, 'attemptnumber DESC', '*', 0, 1);
<a name="l303"><span class="linenum"> 303</span></a>              if (<a class="var it8117" onMouseOver="hilite(8117)" onMouseOut="lolite()" onClick="logVariable('submissions')" href="../../../../_variables/submissions.html">$submissions</a>) {
<a name="l304"><span class="linenum"> 304</span></a>                  <a class="var it5006" onMouseOver="hilite(5006)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../../../_variables/submission.html">$submission</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../../../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it8117" onMouseOver="hilite(8117)" onMouseOut="lolite()" onClick="logVariable('submissions')" href="../../../../_variables/submissions.html">$submissions</a>);
<a name="l305"><span class="linenum"> 305</span></a>                  <a class="var it5006" onMouseOver="hilite(5006)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../../../_variables/submission.html">$submission</a>-&gt;<a onClick="logVariable('latest')" class="var it42978" onMouseOver="hilite(42978)" onMouseOut="lolite()" href="../../../../_variables/latest.html">latest</a> = 1;
<a name="l306"><span class="linenum"> 306</span></a>                  <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('assign_submission', <a class="var it5006" onMouseOver="hilite(5006)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../../../_variables/submission.html">$submission</a>);
<a name="l307"><span class="linenum"> 307</span></a>              }
<a name="l308"><span class="linenum"> 308</span></a>          }
<a name="l309"><span class="linenum"> 309</span></a>  
<a name="l310"><span class="linenum"> 310</span></a>  <span class="comment">        // Now check for records with a grade, but no submission record.</span>
<a name="l311"><span class="linenum"> 311</span></a>  <span class="comment">        // This happens when a teacher marks a student before they have submitted anything.</span>
<a name="l312"><span class="linenum"> 312</span></a>          <a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../../_variables/records.html">$records</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset_sql')" href="../../../../_functions/get_recordset_sql.html" onMouseOver="funcPopup(event,'get_recordset_sql')">get_recordset_sql</a>('SELECT g.id, g.userid
<a name="l313"><span class="linenum"> 313</span></a>                                             FROM {assign_grades} g
<a name="l314"><span class="linenum"> 314</span></a>                                        LEFT JOIN {assign_submission} s
<a name="l315"><span class="linenum"> 315</span></a>                                               ON s.assignment = g.assignment
<a name="l316"><span class="linenum"> 316</span></a>                                              AND s.userid = g.userid
<a name="l317"><span class="linenum"> 317</span></a>                                            WHERE s.id IS NULL AND g.assignment = ?', array(<a class="var it281" onMouseOver="hilite(281)" onMouseOut="lolite()" onClick="logVariable('assignmentid')" href="../../../../_variables/assignmentid.html">$assignmentid</a>));
<a name="l318"><span class="linenum"> 318</span></a>  
<a name="l319"><span class="linenum"> 319</span></a>          <a class="var it8117" onMouseOver="hilite(8117)" onMouseOut="lolite()" onClick="logVariable('submissions')" href="../../../../_variables/submissions.html">$submissions</a> = array();
<a name="l320"><span class="linenum"> 320</span></a>          foreach (<a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../../_variables/records.html">$records</a> as <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>) {
<a name="l321"><span class="linenum"> 321</span></a>              <a class="var it5006" onMouseOver="hilite(5006)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../../../_variables/submission.html">$submission</a> = new stdClass();
<a name="l322"><span class="linenum"> 322</span></a>              <a class="var it5006" onMouseOver="hilite(5006)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../../../_variables/submission.html">$submission</a>-&gt;<a onClick="logVariable('assignment')" class="var it42978" onMouseOver="hilite(42978)" onMouseOut="lolite()" href="../../../../_variables/assignment.html">assignment</a> = <a class="var it281" onMouseOver="hilite(281)" onMouseOut="lolite()" onClick="logVariable('assignmentid')" href="../../../../_variables/assignmentid.html">$assignmentid</a>;
<a name="l323"><span class="linenum"> 323</span></a>              <a class="var it5006" onMouseOver="hilite(5006)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../../../_variables/submission.html">$submission</a>-&gt;<a onClick="logVariable('userid')" class="var it42978" onMouseOver="hilite(42978)" onMouseOut="lolite()" href="../../../../_variables/userid.html">userid</a> = <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('userid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../../../_variables/userid.html">userid</a>;
<a name="l324"><span class="linenum"> 324</span></a>              <a class="var it5006" onMouseOver="hilite(5006)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../../../_variables/submission.html">$submission</a>-&gt;<a onClick="logVariable('status')" class="var it42978" onMouseOver="hilite(42978)" onMouseOut="lolite()" href="../../../../_variables/status.html">status</a> = <a class="constant" onClick="logConstant('ASSIGN_SUBMISSION_STATUS_NEW')" href="../../../../_constants/ASSIGN_SUBMISSION_STATUS_NEW.html" onMouseOver="constPopup(event,'ASSIGN_SUBMISSION_STATUS_NEW')">ASSIGN_SUBMISSION_STATUS_NEW</a>;
<a name="l325"><span class="linenum"> 325</span></a>              <a class="var it5006" onMouseOver="hilite(5006)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../../../_variables/submission.html">$submission</a>-&gt;<a onClick="logVariable('groupid')" class="var it42978" onMouseOver="hilite(42978)" onMouseOut="lolite()" href="../../../../_variables/groupid.html">groupid</a> = 0;
<a name="l326"><span class="linenum"> 326</span></a>              <a class="var it5006" onMouseOver="hilite(5006)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../../../_variables/submission.html">$submission</a>-&gt;<a onClick="logVariable('latest')" class="var it42978" onMouseOver="hilite(42978)" onMouseOut="lolite()" href="../../../../_variables/latest.html">latest</a> = 1;
<a name="l327"><span class="linenum"> 327</span></a>              <a class="var it5006" onMouseOver="hilite(5006)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../../../_variables/submission.html">$submission</a>-&gt;<a onClick="logVariable('timecreated')" class="var it42978" onMouseOver="hilite(42978)" onMouseOut="lolite()" href="../../../../_variables/timecreated.html">timecreated</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l328"><span class="linenum"> 328</span></a>              <a class="var it5006" onMouseOver="hilite(5006)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../../../_variables/submission.html">$submission</a>-&gt;<a onClick="logVariable('timemodified')" class="var it42978" onMouseOver="hilite(42978)" onMouseOut="lolite()" href="../../../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l329"><span class="linenum"> 329</span></a>              <a class="phpfunction" onClick="logFunction('array_push')" href="../../../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>(<a class="var it8117" onMouseOver="hilite(8117)" onMouseOut="lolite()" onClick="logVariable('submissions')" href="../../../../_variables/submissions.html">$submissions</a>, <a class="var it5006" onMouseOver="hilite(5006)" onMouseOut="lolite()" onClick="logVariable('submission')" href="../../../../_variables/submission.html">$submission</a>);
<a name="l330"><span class="linenum"> 330</span></a>          }
<a name="l331"><span class="linenum"> 331</span></a>  
<a name="l332"><span class="linenum"> 332</span></a>          <a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../../_variables/records.html">$records</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l333"><span class="linenum"> 333</span></a>  
<a name="l334"><span class="linenum"> 334</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_records')" href="../../../../_functions/insert_records.html" onMouseOver="funcPopup(event,'insert_records')">insert_records</a>('assign_submission', <a class="var it8117" onMouseOver="hilite(8117)" onMouseOut="lolite()" onClick="logVariable('submissions')" href="../../../../_variables/submissions.html">$submissions</a>);
<a name="l335"><span class="linenum"> 335</span></a>      }
<a name="l336"><span class="linenum"> 336</span></a>  
<a name="l337"><span class="linenum"> 337</span></a>      <span class="comment">/**</span>
<a name="l338"><span class="linenum"> 338</span></a>  <span class="comment">     * Once the database tables have been fully restored, restore the files</span>
<a name="l339"><span class="linenum"> 339</span></a>  <span class="comment">     * @return void</span>
<a name="l340"><span class="linenum"> 340</span></a>  <span class="comment">     */</span>
<a name="l341"><span class="linenum"> 341</span></a>      protected function <a class="function" onClick="logFunction('after_execute')" href="../../../../_functions/after_execute.html" onMouseOver="funcPopup(event,'after_execute')">after_execute</a>() {
<a name="l342"><span class="linenum"> 342</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('add_related_files')" href="../../../../_functions/add_related_files.html" onMouseOver="funcPopup(event,'add_related_files')">add_related_files</a>('mod_assign', 'intro', null);
<a name="l343"><span class="linenum"> 343</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('add_related_files')" href="../../../../_functions/add_related_files.html" onMouseOver="funcPopup(event,'add_related_files')">add_related_files</a>('mod_assign', 'introattachment', null);
<a name="l344"><span class="linenum"> 344</span></a>  
<a name="l345"><span class="linenum"> 345</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('set_latest_submission_field')" href="../../../../_functions/set_latest_submission_field.html" onMouseOver="funcPopup(event,'set_latest_submission_field')">set_latest_submission_field</a>();
<a name="l346"><span class="linenum"> 346</span></a>      }
<a name="l347"><span class="linenum"> 347</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'close': ['close', 'Close archive, write changes to disk. ', [['lib/filestorage','zip_archive.php',183],['lib/dml','mssql_native_moodle_recordset.php',87],['auth/fc','fcFPP.php',78],['lib/dml','mysqli_native_moodle_recordset.php',86],['lib/spout/src/Spout/Reader','ReaderInterface.php',30],['lib/spout/src/Spout/Writer/ODS/Internal','Workbook.php',81],['lib/dml','pdo_moodle_recordset.php',79],['lib','csvlib.class.php',256],['lib/horde/framework/Horde/Socket','Client.php',135],['backup/util/helper','backup_null_iterator.class.php',53],['admin/tool/uploaduser','locallib.php',149],['lib/tcpdf','tcpdf.php',2943],['lib/phpunit/classes','phpmailer_sink.php',41],['lib/phpmailer','class.smtp.php',582],['lib/dml','sqlsrv_native_moodle_recordset.php',133],['lib/classes/dml','recordset_walk.php',153],['lib/spout/src/Spout/Writer/XLSX/Helper','SharedStringsHelper.php',84],['grade/export','lib.php',689],['lib','excellib.class.php',93],['backup/util/loggers','file_logger.class.php',69],['grade','lib.php',324],['backup/util/helper','backup_array_iterator.class.php',63],['lib/horde/framework/Horde/Imap/Client','Base.php',1846],['mod/assign/feedback/offline','importgradeslib.php',204],['lib/dml','oci_native_moodle_recordset.php',80],['lib/adodb','adodb.inc.php',2361],['lib/adodb','adodb.inc.php',3090],['lib/adodb','adodb.inc.php',3870],['lib/google/src/Google/Logger','File.php',132],['lib/phpunit/classes','event_sink.php',39],['lib/horde/framework/Horde','Stream.php',585],['backup/util/loggers','base_logger.class.php',89],['lib/phpexcel/PHPExcel/Shared','ZipArchive.php',71],['question/engine/tests','helpers.php',1241],['lib/spout/src/Spout/Writer','AbstractWriter.php',312],['lib','odslib.class.php',71],['lib/spout/src/Spout/Writer/Common/Internal','WorksheetInterface.php',34],['lib/spout/src/Spout/Writer/ODS/Internal','Worksheet.php',214],['lib/spout/src/Spout/Writer','WriterInterface.php',84],['lib/spout/src/Spout/Writer/XLSX/Internal','Worksheet.php',174],['lib/spout/src/Spout/Reader','AbstractReader.php',183],['lib/phpunit/classes','message_sink.php',39],['lib/spout/src/Spout/Writer/Common/Internal','WorkbookInterface.php',65],['lib/spout/src/Spout/Writer/XLSX/Internal','Workbook.php',95],['lib/pear/Net','GeoIP.php',556],['lib/tests','completionlib_test.php',907],['lib/pear/Auth','RADIUS.php',550],['lib/pear/Auth','RADIUS.php',710],['lib/pear/Auth','RADIUS.php',829],['lib','webdavlib.php',176],['lib/dml','pgsql_native_moodle_recordset.php',107]], 1128],
'update_record': ['update_record', 'Update a record in a table ', [['lib/dml','pdo_moodle_database.php',461],['lib/dml','oci_native_moodle_database.php',1404],['lib/dml','pgsql_native_moodle_database.php',1089],['lib/dml','mssql_native_moodle_database.php',1067],['lib/dml','mysqli_native_moodle_database.php',1405],['lib/dml','sqlsrv_native_moodle_database.php',1148],['lib/dml/tests','dml_test.php',5551]], 650],
'prepare_activity_structure': ['prepare_activity_structure', 'Adds support for the \'activity\' path that is common to all the activities and will be processed globally here ', [['backup/moodle2','restore_stepslib.php',4238],['backup/moodle2','backup_stepslib.php',98]], 45],
'apply_date_offset': ['apply_date_offset', 'Apply course startdate offset based in original course startdate and course_offset_startdate setting Note we are using one static cache here, but *by restoreid*, so it\'s ok for concurrence/multiple executions in the same request ', [['backup/moodle2','restore_plugin.class.php',221],['backup/moodle2','restore_subplugin.class.php',153],['backup/util/plan','restore_step.class.php',49]], 148],
'apply_activity_instance': ['apply_activity_instance', 'This must be invoked immediately after creating the "module" activity record (forum, choice...) and will adjust the new activity id (the instance) in various places ', [['backup/moodle2','restore_stepslib.php',4259]], 22],
'add_related_files': ['add_related_files', 'Add all the existing file, given their component and filearea and one backup_ids itemname to match with ', [['backup/moodle2','restore_plugin.class.php',214],['backup/moodle2','restore_subplugin.class.php',146],['backup/util/plan','restore_structure_step.class.php',222]], 86],
'get_old_contextid': ['get_old_contextid', '', [['backup/moodle2','restore_activity_task.class.php',119],['backup/moodle2','restore_block_task.class.php',141],['backup/util/plan','restore_task.class.php',90]], 13],
'after_execute': ['after_execute', '', [['mod/survey/backup/moodle2','restore_survey_stepslib.php',91],['mod/page/backup/moodle2','restore_page_stepslib.php',56],['mod/workshop/backup/moodle2','restore_workshop_stepslib.php',210],['mod/chat/backup/moodle2','restore_chat_stepslib.php',78],['backup/moodle2','restore_stepslib.php',372],['backup/moodle2','restore_stepslib.php',1272],['backup/moodle2','restore_stepslib.php',1418],['backup/moodle2','restore_stepslib.php',1487],['backup/moodle2','restore_stepslib.php',1742],['backup/moodle2','restore_stepslib.php',1929],['backup/moodle2','restore_stepslib.php',2605],['backup/moodle2','restore_stepslib.php',2701],['backup/moodle2','restore_stepslib.php',3540],['backup/moodle2','restore_stepslib.php',4474],['backup/moodle2','restore_stepslib.php',5232],['mod/scorm/backup/moodle2','restore_scorm_stepslib.php',190],['mod/url/backup/moodle2','restore_url_stepslib.php',56],['mod/imscp/backup/moodle2','restore_imscp_stepslib.php',57],['mod/forum/backup/moodle2','restore_forum_stepslib.php',208],['mod/wiki/backup/moodle2','restore_wiki_stepslib.php',174],['mod/folder/backup/moodle2','restore_folder_stepslib.php',62],['backup/util/plan','restore_structure_step.class.php',453],['mod/resource/backup/moodle2','restore_resource_stepslib.php',57],['mod/lti/backup/moodle2','restore_lti_stepslib.php',93],['mod/data/backup/moodle2','restore_data_stepslib.php',154],['mod/assignment/backup/moodle2','restore_assignment_stepslib.php',141],['mod/quiz/backup/moodle2','restore_quiz_stepslib.php',417],['mod/label/backup/moodle2','restore_label_stepslib.php',56],['mod/glossary/backup/moodle2','restore_glossary_stepslib.php',159],['mod/assign/backup/moodle2','restore_assign_stepslib.php',337],['mod/book/backup/moodle2','restore_book_stepslib.php',75],['mod/lesson/backup/moodle2','restore_lesson_stepslib.php',240],['mod/feedback/backup/moodle2','restore_feedback_stepslib.php',119],['mod/choice/backup/moodle2','restore_choice_stepslib.php',94]], 3],
'get_setting_value': ['get_setting_value', 'Returns the value of one (task/plan) setting ', [['backup/moodle2','backup_plugin.class.php',68],['backup/moodle2','restore_plugin.class.php',230],['backup/util/ui','base_ui.class.php',330],['backup/moodle2','restore_subplugin.class.php',169],['backup/moodle2','backup_subplugin.class.php',68],['backup/util/plan','base_step.class.php',98],['backup/util/plan','base_task.class.php',105]], 142],
'define_structure': ['define_structure', '', [['mod/survey/backup/moodle2','restore_survey_stepslib.php',34],['mod/page/backup/moodle2','restore_page_stepslib.php',34],['mod/feedback/backup/moodle2','backup_feedback_stepslib.php',33],['mod/lti/backup/moodle2','backup_lti_stepslib.php',56],['mod/book/backup/moodle2','backup_book_stepslib.php',32],['mod/workshop/backup/moodle2','restore_workshop_stepslib.php',33],['mod/label/backup/moodle2','backup_label_stepslib.php',33],['mod/resource/backup/moodle2','backup_resource_stepslib.php',33],['mod/chat/backup/moodle2','restore_chat_stepslib.php',33],['mod/assignment/backup/moodle2','backup_assignment_stepslib.php',34],['backup/moodle2','restore_stepslib.php',143],['backup/moodle2','restore_stepslib.php',725],['backup/moodle2','restore_stepslib.php',1034],['backup/moodle2','restore_stepslib.php',1157],['backup/moodle2','restore_stepslib.php',1292],['backup/moodle2','restore_stepslib.php',1369],['backup/moodle2','restore_stepslib.php',1431],['backup/moodle2','restore_stepslib.php',1545],['backup/moodle2','restore_stepslib.php',1771],['backup/moodle2','restore_stepslib.php',1996],['backup/moodle2','restore_stepslib.php',2151],['backup/moodle2','restore_stepslib.php',2335],['backup/moodle2','restore_stepslib.php',2390],['backup/moodle2','restore_stepslib.php',2473],['backup/moodle2','restore_stepslib.php',2616],['backup/moodle2','restore_stepslib.php',2765],['backup/moodle2','restore_stepslib.php',3020],['backup/moodle2','restore_stepslib.php',3150],['backup/moodle2','restore_stepslib.php',3194],['backup/moodle2','restore_stepslib.php',3341],['backup/moodle2','restore_stepslib.php',3435],['backup/moodle2','restore_stepslib.php',3567],['backup/moodle2','restore_stepslib.php',3721],['backup/moodle2','restore_stepslib.php',3767],['backup/moodle2','restore_stepslib.php',3930],['backup/moodle2','restore_stepslib.php',4194],['backup/moodle2','restore_stepslib.php',4287],['mod/url/backup/moodle2','backup_url_stepslib.php',33],['mod/scorm/backup/moodle2','restore_scorm_stepslib.php',33],['mod/scorm/backup/moodle2','backup_scorm_stepslib.php',33],['mod/assign/backup/moodle2','backup_assign_stepslib.php',36],['mod/url/backup/moodle2','restore_url_stepslib.php',34],['mod/lesson/backup/moodle2','backup_lesson_stepslib.php',65],['mod/imscp/backup/moodle2','restore_imscp_stepslib.php',34],['mod/workshop/backup/moodle2','backup_workshop_stepslib.php',36],['mod/glossary/backup/moodle2','backup_glossary_stepslib.php',34],['mod/forum/backup/moodle2','restore_forum_stepslib.php',34],['backup/util/plan/tests/fixtures','plan_fixtures.php',120],['backup/util/plan/tests/fixtures','plan_fixtures.php',142],['mod/wiki/backup/moodle2','restore_wiki_stepslib.php',34],['mod/folder/backup/moodle2','restore_folder_stepslib.php',34],['blocks/rss_client/backup/moodle2','restore_rss_client_stepslib.php',33],['blocks/rss_client/backup/moodle2','backup_rss_client_stepslib.php',33],['mod/resource/backup/moodle2','restore_resource_stepslib.php',34],['mod/lti/backup/moodle2','restore_lti_stepslib.php',56],['mod/survey/backup/moodle2','backup_survey_stepslib.php',34],['mod/choice/backup/moodle2','backup_choice_stepslib.php',34],['mod/data/backup/moodle2','restore_data_stepslib.php',34],['mod/assignment/backup/moodle2','restore_assignment_stepslib.php',34],['backup/moodle2','backup_stepslib.php',260],['backup/moodle2','backup_stepslib.php',322],['backup/moodle2','backup_stepslib.php',370],['backup/moodle2','backup_stepslib.php',480],['backup/moodle2','backup_stepslib.php',537],['backup/moodle2','backup_stepslib.php',594],['backup/moodle2','backup_stepslib.php',628],['backup/moodle2','backup_stepslib.php',664],['backup/moodle2','backup_stepslib.php',701],['backup/moodle2','backup_stepslib.php',741],['backup/moodle2','backup_stepslib.php',782],['backup/moodle2','backup_stepslib.php',851],['backup/moodle2','backup_stepslib.php',907],['backup/moodle2','backup_stepslib.php',1049],['backup/moodle2','backup_stepslib.php',1107],['backup/moodle2','backup_stepslib.php',1139],['backup/moodle2','backup_stepslib.php',1229],['backup/moodle2','backup_stepslib.php',1391],['backup/moodle2','backup_stepslib.php',1450],['backup/moodle2','backup_stepslib.php',1484],['backup/moodle2','backup_stepslib.php',1520],['backup/moodle2','backup_stepslib.php',1547],['backup/moodle2','backup_stepslib.php',1614],['backup/moodle2','backup_stepslib.php',1657],['backup/moodle2','backup_stepslib.php',1720],['backup/moodle2','backup_stepslib.php',1758],['backup/moodle2','backup_stepslib.php',2178],['backup/moodle2','backup_stepslib.php',2315],['backup/moodle2','backup_stepslib.php',2393],['backup/moodle2','backup_stepslib.php',2485],['backup/moodle2','backup_stepslib.php',2545],['mod/imscp/backup/moodle2','backup_imscp_stepslib.php',35],['mod/folder/backup/moodle2','backup_folder_stepslib.php',33],['mod/chat/backup/moodle2','backup_chat_stepslib.php',28],['mod/quiz/backup/moodle2','restore_quiz_stepslib.php',49],['mod/label/backup/moodle2','restore_label_stepslib.php',34],['mod/forum/backup/moodle2','backup_forum_stepslib.php',34],['mod/quiz/backup/moodle2','backup_quiz_stepslib.php',36],['mod/glossary/backup/moodle2','restore_glossary_stepslib.php',34],['mod/assign/backup/moodle2','restore_assign_stepslib.php',42],['mod/book/backup/moodle2','restore_book_stepslib.php',32],['mod/lesson/backup/moodle2','restore_lesson_stepslib.php',37],['mod/feedback/backup/moodle2','restore_feedback_stepslib.php',33],['mod/choice/backup/moodle2','restore_choice_stepslib.php',34],['mod/wiki/backup/moodle2','backup_wiki_stepslib.php',34],['mod/page/backup/moodle2','backup_page_stepslib.php',36],['mod/data/backup/moodle2','backup_data_stepslib.php',34]], 4],
'get_courseid': ['get_courseid', 'Id of the current course (for site feedbacks only) ', [['mod/feedback/classes','structure.php',80],['course/format','lib.php',222],['mod/quiz','attemptlib.php',175],['mod/quiz','attemptlib.php',717],['backup/util/plan','backup_plan.class.php',78],['comment','lib.php',1002],['mod/quiz/classes','structure.php',228],['question/classes/bank','view.php',217],['backup/util/plan','restore_plan.class.php',81],['backup/controller','backup_controller.class.php',267],['backup/util/plan','base_step.class.php',105],['backup/controller','restore_controller.class.php',269],['backup/util/plan','base_task.class.php',109]], 244],
'get_records_sql': ['get_records_sql', 'Get a number of records as an array of objects. ', [['lib/dml','pdo_moodle_database.php',309],['lib/dml','oci_native_moodle_database.php',1145],['lib/dml','pgsql_native_moodle_database.php',732],['lib/dml','mssql_native_moodle_database.php',805],['lib/dml','mysqli_native_moodle_database.php',1057],['lib/dml','sqlsrv_native_moodle_database.php',890],['lib/dml/tests','dml_test.php',5545]], 700],
'process_assign_userflag': ['process_assign_userflag', 'Process a user_flags restore ', [['mod/assign/backup/moodle2','restore_assign_stepslib.php',170]], 0],
'get_recordset_sql': ['get_recordset_sql', 'Get a number of records as an moodle_recordset.  $sql must be a complete SQL query. Since this method is a little less readable, use of it should be restricted to code where it\'s possible there might be large datasets being returned.  For known small datasets use get_records_sql - it leads to simpler code. ', [['lib/dml','pdo_moodle_database.php',252],['lib/dml','oci_native_moodle_database.php',1106],['lib/dml','pgsql_native_moodle_database.php',688],['lib/dml','mssql_native_moodle_database.php',736],['lib/dml','mysqli_native_moodle_database.php',993],['lib/dml','sqlsrv_native_moodle_database.php',811],['lib/dml/tests','dml_test.php',5544]], 283],
'get_new_parentid': ['get_new_parentid', 'Returns the latest (parent) new id mapped by one pathelement ', [['backup/moodle2','restore_plugin.class.php',189],['backup/moodle2','restore_subplugin.class.php',121],['backup/util/plan','restore_structure_step.class.php',196]], 148],
'set_mapping': ['set_mapping', 'To send ids pairs to backup_ids_table and to store them into paths ', [['backup/moodle2','restore_plugin.class.php',169],['backup/moodle2','restore_subplugin.class.php',101],['backup/util/plan','restore_structure_step.class.php',158]], 131],
'add_subplugin_structure': ['add_subplugin_structure', 'Add subplugin structure for a given plugin to any element in the structure backup tree. ', [['backup/util/plan','backup_structure_step.class.php',165],['backup/util/plan/tests/fixtures','plan_fixtures.php',136],['backup/util/plan/tests/fixtures','plan_fixtures.php',153],['backup/util/plan','restore_structure_step.class.php',297]], 46],
'process_assign': ['process_assign', 'Process an assign restore. ', [['mod/assign/backup/moodle2','restore_assign_stepslib.php',73]], 0],
'process_assign_submission': ['process_assign_submission', 'Process a submission restore ', [['mod/assign/backup/moodle2','restore_assign_stepslib.php',132]], 0],
'set_latest_submission_field': ['set_latest_submission_field', 'For all submissions in this assignment, either set the submission->latest field to 1 for the latest attempts or create a new submission record for grades with no submission. ', [['mod/assign/backup/moodle2','restore_assign_stepslib.php',258]], 1],
'get_mappingid': ['get_mappingid', 'Return the new id of a mapping for the given itemname ', [['backup/moodle2','restore_plugin.class.php',196],['backup/moodle2','restore_subplugin.class.php',128],['backup/util/plan','restore_structure_step.class.php',203]], 224],
'process_assign_plugin_config': ['process_assign_plugin_config', 'Process a plugin-config restore ', [['mod/assign/backup/moodle2','restore_assign_stepslib.php',242]], 0],
'itemid_mapping': ['itemid_mapping', 'Helper method returning the mapping identifierto use for grading form instance\'s itemid field ', [['backup/moodle2','restore_gradingform_plugin.class.php',39]], 3],
'get_records': ['get_records', 'Load a list of records. ', [['competency/classes','persistent.php',709],['mod/glossary/classes','entry_query_builder.php',295],['lib/dml','moodle_database.php',1285],['lib','coursecatlib.php',651],['question','category_class.php',63]], 965],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required, Some conversions and safety checks are carried out. Lobs are supported. If the return ID isn\'t required, then this just reports success as true/false. $data is an object containing needed data ', [['lib/dml','pdo_moodle_database.php',387],['lib/dml','oci_native_moodle_database.php',1297],['lib/dml','pgsql_native_moodle_database.php',889],['lib/dml','mssql_native_moodle_database.php',962],['lib/dml','mysqli_native_moodle_database.php',1185],['question/engine/upgrade','upgradelib.php',124],['lib/dml','sqlsrv_native_moodle_database.php',1045],['lib/dml/tests','dml_test.php',5548]], 1611],
'insert_records': ['insert_records', 'Insert multiple records into database as fast as possible. ', [['lib/dml','pgsql_native_moodle_database.php',926],['lib/dml','mysqli_native_moodle_database.php',1221],['lib/dml','moodle_database.php',1662]], 26],
'process_assign_grade': ['process_assign_grade', 'Process a grade restore ', [['mod/assign/backup/moodle2','restore_assign_stepslib.php',197]], 0],
'abs': ['abs', '', [], 560],
'reset': ['reset', '', [], 1213],
'defined': ['defined', '', [], 4731],
'time': ['time', '', [], 1959],
'array_push': ['array_push', '', [], 240]};
CLASS_DATA={
'restore_path_element': ['restore_path_element', 'Class representing one path to be restored from XML file ', [['backup/util/structure','restore_path_element.class.php',27]], 232],
'restore_assign_activity_structure_step': ['restore_assign_activity_structure_step', 'Define the complete assignment structure for restore, with file and id annotations ', [['mod/assign/backup/moodle2','restore_assign_stepslib.php',27]], 1]};
CONST_DATA={
'ASSIGN_SUBMISSION_STATUS_NEW': ['ASSIGN_SUBMISSION_STATUS_NEW', '', [['mod/assign','locallib.php',30]], 20],
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',140],['','install.php',93],['lib','setup.php',391]], 4153]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Aug 11 10:00:09 2016</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
