<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /mod/lti/locallib.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Aug 11 10:00:09 2016 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='mod/lti';
filename='locallib.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/mod/lti/</a> -> <a href="locallib.php.html">locallib.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="locallib.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="locallib.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  <span class="comment">//</span>
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">// This file is part of BasicLTI4Moodle</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment">//</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment">// BasicLTI4Moodle is an IMS BasicLTI (Basic Learning Tools for Interoperability)</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment">// consumer for Moodle 1.9 and Moodle 2.0. BasicLTI is a IMS Standard that allows web</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment">// based learning tools to be easily integrated in LMS as native ones. The IMS BasicLTI</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment">// specification is part of the IMS standard Common Cartridge 1.1 Sakai and other main LMS</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment">// are already supporting or going to support BasicLTI. This project Implements the consumer</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment">// for Moodle. Moodle is a Free Open source Learning Management System by Martin Dougiamas.</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment">// BasicLTI4Moodle is a project iniciated and leaded by Ludo(Marc Alier) and Jordi Piguillem</span>
<a name="l26"><span class="linenum">  26</span></a>  <span class="comment">// at the GESSI research group at UPC.</span>
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment">// SimpleLTI consumer for Moodle is an implementation of the early specification of LTI</span>
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment">// by Charles Severance (Dr Chuck) htp://dr-chuck.com , developed by Jordi Piguillem in a</span>
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment">// Google Summer of Code 2008 project co-mentored by Charles Severance and Marc Alier.</span>
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment">//</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment">// BasicLTI4Moodle is copyright 2009 by Marc Alier Forment, Jordi Piguillem and Nikolas Galanis</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment">// of the Universitat Politecnica de Catalunya http://www.upc.edu</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment">// Contact info: Marc Alier Forment granludo @ gmail.com or marc.alier @ upc.edu.</span>
<a name="l34"><span class="linenum">  34</span></a>  
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment">/**</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment"> * This file contains the library of functions and constants for the lti module</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment"> *</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment"> * @package mod_lti</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="comment"> * @copyright  2009 Marc Alier, Jordi Piguillem, Nikolas Galanis</span>
<a name="l40"><span class="linenum">  40</span></a>  <span class="comment"> *  marc.alier@upc.edu</span>
<a name="l41"><span class="linenum">  41</span></a>  <span class="comment"> * @copyright  2009 Universitat Politecnica de Catalunya http://www.upc.edu</span>
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment"> * @author     Marc Alier</span>
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment"> * @author     Jordi Piguillem</span>
<a name="l44"><span class="linenum">  44</span></a>  <span class="comment"> * @author     Nikolas Galanis</span>
<a name="l45"><span class="linenum">  45</span></a>  <span class="comment"> * @author     Chris Scribner</span>
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment"> * @copyright  2015 Vital Source Technologies http://vitalsource.com</span>
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment"> * @author     Stephen Vickers</span>
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l49"><span class="linenum">  49</span></a>  <span class="comment"> */</span>
<a name="l50"><span class="linenum">  50</span></a>  
<a name="l51"><span class="linenum">  51</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die;
<a name="l52"><span class="linenum">  52</span></a>  
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment">// TODO: Switch to core oauthlib once implemented - MDL-30149.</span>
<a name="l54"><span class="linenum">  54</span></a>  use moodle\mod\lti as lti;
<a name="l55"><span class="linenum">  55</span></a>  
<a name="l56"><span class="linenum">  56</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../mod/lti/OAuth.php.html">/mod/lti/OAuth.php</a>');
<a name="l57"><span class="linenum">  57</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a>.'/weblib.php');
<a name="l58"><span class="linenum">  58</span></a>  
<a name="l59"><span class="linenum">  59</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LTI_URL_DOMAIN_REGEX')" href="../../_constants/LTI_URL_DOMAIN_REGEX.html" onMouseOver="constPopup(event,'LTI_URL_DOMAIN_REGEX')">LTI_URL_DOMAIN_REGEX</a>', '/(?:https?:\/\/)?(?:www\.)?([^\/]+)(?:\/|$)/i');
<a name="l60"><span class="linenum">  60</span></a>  
<a name="l61"><span class="linenum">  61</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LTI_LAUNCH_CONTAINER_DEFAULT')" href="../../_constants/LTI_LAUNCH_CONTAINER_DEFAULT.html" onMouseOver="constPopup(event,'LTI_LAUNCH_CONTAINER_DEFAULT')">LTI_LAUNCH_CONTAINER_DEFAULT</a>', 1);
<a name="l62"><span class="linenum">  62</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LTI_LAUNCH_CONTAINER_EMBED')" href="../../_constants/LTI_LAUNCH_CONTAINER_EMBED.html" onMouseOver="constPopup(event,'LTI_LAUNCH_CONTAINER_EMBED')">LTI_LAUNCH_CONTAINER_EMBED</a>', 2);
<a name="l63"><span class="linenum">  63</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LTI_LAUNCH_CONTAINER_EMBED_NO_BLOCKS')" href="../../_constants/LTI_LAUNCH_CONTAINER_EMBED_NO_BLOCKS.html" onMouseOver="constPopup(event,'LTI_LAUNCH_CONTAINER_EMBED_NO_BLOCKS')">LTI_LAUNCH_CONTAINER_EMBED_NO_BLOCKS</a>', 3);
<a name="l64"><span class="linenum">  64</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LTI_LAUNCH_CONTAINER_WINDOW')" href="../../_constants/LTI_LAUNCH_CONTAINER_WINDOW.html" onMouseOver="constPopup(event,'LTI_LAUNCH_CONTAINER_WINDOW')">LTI_LAUNCH_CONTAINER_WINDOW</a>', 4);
<a name="l65"><span class="linenum">  65</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('LTI_LAUNCH_CONTAINER_REPLACE_MOODLE_WINDOW', 5);
<a name="l66"><span class="linenum">  66</span></a>  
<a name="l67"><span class="linenum">  67</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LTI_TOOL_STATE_ANY')" href="../../_constants/LTI_TOOL_STATE_ANY.html" onMouseOver="constPopup(event,'LTI_TOOL_STATE_ANY')">LTI_TOOL_STATE_ANY</a>', 0);
<a name="l68"><span class="linenum">  68</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LTI_TOOL_STATE_CONFIGURED')" href="../../_constants/LTI_TOOL_STATE_CONFIGURED.html" onMouseOver="constPopup(event,'LTI_TOOL_STATE_CONFIGURED')">LTI_TOOL_STATE_CONFIGURED</a>', 1);
<a name="l69"><span class="linenum">  69</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LTI_TOOL_STATE_PENDING')" href="../../_constants/LTI_TOOL_STATE_PENDING.html" onMouseOver="constPopup(event,'LTI_TOOL_STATE_PENDING')">LTI_TOOL_STATE_PENDING</a>', 2);
<a name="l70"><span class="linenum">  70</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LTI_TOOL_STATE_REJECTED')" href="../../_constants/LTI_TOOL_STATE_REJECTED.html" onMouseOver="constPopup(event,'LTI_TOOL_STATE_REJECTED')">LTI_TOOL_STATE_REJECTED</a>', 3);
<a name="l71"><span class="linenum">  71</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LTI_TOOL_PROXY_TAB')" href="../../_constants/LTI_TOOL_PROXY_TAB.html" onMouseOver="constPopup(event,'LTI_TOOL_PROXY_TAB')">LTI_TOOL_PROXY_TAB</a>', 4);
<a name="l72"><span class="linenum">  72</span></a>  
<a name="l73"><span class="linenum">  73</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LTI_TOOL_PROXY_STATE_CONFIGURED')" href="../../_constants/LTI_TOOL_PROXY_STATE_CONFIGURED.html" onMouseOver="constPopup(event,'LTI_TOOL_PROXY_STATE_CONFIGURED')">LTI_TOOL_PROXY_STATE_CONFIGURED</a>', 1);
<a name="l74"><span class="linenum">  74</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LTI_TOOL_PROXY_STATE_PENDING')" href="../../_constants/LTI_TOOL_PROXY_STATE_PENDING.html" onMouseOver="constPopup(event,'LTI_TOOL_PROXY_STATE_PENDING')">LTI_TOOL_PROXY_STATE_PENDING</a>', 2);
<a name="l75"><span class="linenum">  75</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LTI_TOOL_PROXY_STATE_ACCEPTED')" href="../../_constants/LTI_TOOL_PROXY_STATE_ACCEPTED.html" onMouseOver="constPopup(event,'LTI_TOOL_PROXY_STATE_ACCEPTED')">LTI_TOOL_PROXY_STATE_ACCEPTED</a>', 3);
<a name="l76"><span class="linenum">  76</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LTI_TOOL_PROXY_STATE_REJECTED')" href="../../_constants/LTI_TOOL_PROXY_STATE_REJECTED.html" onMouseOver="constPopup(event,'LTI_TOOL_PROXY_STATE_REJECTED')">LTI_TOOL_PROXY_STATE_REJECTED</a>', 4);
<a name="l77"><span class="linenum">  77</span></a>  
<a name="l78"><span class="linenum">  78</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LTI_SETTING_NEVER')" href="../../_constants/LTI_SETTING_NEVER.html" onMouseOver="constPopup(event,'LTI_SETTING_NEVER')">LTI_SETTING_NEVER</a>', 0);
<a name="l79"><span class="linenum">  79</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LTI_SETTING_ALWAYS')" href="../../_constants/LTI_SETTING_ALWAYS.html" onMouseOver="constPopup(event,'LTI_SETTING_ALWAYS')">LTI_SETTING_ALWAYS</a>', 1);
<a name="l80"><span class="linenum">  80</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LTI_SETTING_DELEGATE')" href="../../_constants/LTI_SETTING_DELEGATE.html" onMouseOver="constPopup(event,'LTI_SETTING_DELEGATE')">LTI_SETTING_DELEGATE</a>', 2);
<a name="l81"><span class="linenum">  81</span></a>  
<a name="l82"><span class="linenum">  82</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LTI_COURSEVISIBLE_NO')" href="../../_constants/LTI_COURSEVISIBLE_NO.html" onMouseOver="constPopup(event,'LTI_COURSEVISIBLE_NO')">LTI_COURSEVISIBLE_NO</a>', 0);
<a name="l83"><span class="linenum">  83</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LTI_COURSEVISIBLE_PRECONFIGURED')" href="../../_constants/LTI_COURSEVISIBLE_PRECONFIGURED.html" onMouseOver="constPopup(event,'LTI_COURSEVISIBLE_PRECONFIGURED')">LTI_COURSEVISIBLE_PRECONFIGURED</a>', 1);
<a name="l84"><span class="linenum">  84</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('LTI_COURSEVISIBLE_ACTIVITYCHOOSER')" href="../../_constants/LTI_COURSEVISIBLE_ACTIVITYCHOOSER.html" onMouseOver="constPopup(event,'LTI_COURSEVISIBLE_ACTIVITYCHOOSER')">LTI_COURSEVISIBLE_ACTIVITYCHOOSER</a>', 2);
<a name="l85"><span class="linenum">  85</span></a>  
<a name="l86"><span class="linenum">  86</span></a>  <span class="comment">/**</span>
<a name="l87"><span class="linenum">  87</span></a>  <span class="comment"> * Return the launch data required for opening the external tool.</span>
<a name="l88"><span class="linenum">  88</span></a>  <span class="comment"> *</span>
<a name="l89"><span class="linenum">  89</span></a>  <span class="comment"> * @param  stdClass $instance the external tool activity settings</span>
<a name="l90"><span class="linenum">  90</span></a>  <span class="comment"> * @return array the endpoint URL and parameters (including the signature)</span>
<a name="l91"><span class="linenum">  91</span></a>  <span class="comment"> * @since  Moodle 3.0</span>
<a name="l92"><span class="linenum">  92</span></a>  <span class="comment"> */</span>
<a name="l93"><span class="linenum">  93</span></a>  function <a class="function" onClick="logFunction('lti_get_launch_data')" href="../../_functions/lti_get_launch_data.html" onMouseOver="funcPopup(event,'lti_get_launch_data')">lti_get_launch_data</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>) {
<a name="l94"><span class="linenum">  94</span></a>      global <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l95"><span class="linenum">  95</span></a>  
<a name="l96"><span class="linenum">  96</span></a>      if (empty(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('typeid')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/typeid.html">typeid</a>)) {
<a name="l97"><span class="linenum">  97</span></a>          <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a> = <a class="function" onClick="logFunction('lti_get_tool_by_url_match')" href="../../_functions/lti_get_tool_by_url_match.html" onMouseOver="funcPopup(event,'lti_get_tool_by_url_match')">lti_get_tool_by_url_match</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('toolurl')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/toolurl.html">toolurl</a>, <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('course')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>);
<a name="l98"><span class="linenum">  98</span></a>          if (<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>) {
<a name="l99"><span class="linenum">  99</span></a>              <a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a> = <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('id')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l100"><span class="linenum"> 100</span></a>          } else {
<a name="l101"><span class="linenum"> 101</span></a>              <a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a> = null;
<a name="l102"><span class="linenum"> 102</span></a>          }
<a name="l103"><span class="linenum"> 103</span></a>      } else {
<a name="l104"><span class="linenum"> 104</span></a>          <a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a> = <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('typeid')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/typeid.html">typeid</a>;
<a name="l105"><span class="linenum"> 105</span></a>          <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a> = <a class="function" onClick="logFunction('lti_get_type')" href="../../_functions/lti_get_type.html" onMouseOver="funcPopup(event,'lti_get_type')">lti_get_type</a>(<a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a>);
<a name="l106"><span class="linenum"> 106</span></a>      }
<a name="l107"><span class="linenum"> 107</span></a>  
<a name="l108"><span class="linenum"> 108</span></a>      if (<a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a>) {
<a name="l109"><span class="linenum"> 109</span></a>          <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a> = <a class="function" onClick="logFunction('lti_get_type_config')" href="../../_functions/lti_get_type_config.html" onMouseOver="funcPopup(event,'lti_get_type_config')">lti_get_type_config</a>(<a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a>);
<a name="l110"><span class="linenum"> 110</span></a>      } else {
<a name="l111"><span class="linenum"> 111</span></a>  <span class="comment">        // There is no admin configuration for this tool. Use configuration in the lti instance record plus some defaults.</span>
<a name="l112"><span class="linenum"> 112</span></a>          <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a> = (array)<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>;
<a name="l113"><span class="linenum"> 113</span></a>  
<a name="l114"><span class="linenum"> 114</span></a>          <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['sendname'] = <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('instructorchoicesendname')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/instructorchoicesendname.html">instructorchoicesendname</a>;
<a name="l115"><span class="linenum"> 115</span></a>          <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['sendemailaddr'] = <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('instructorchoicesendemailaddr')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/instructorchoicesendemailaddr.html">instructorchoicesendemailaddr</a>;
<a name="l116"><span class="linenum"> 116</span></a>          <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['customparameters'] = <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('instructorcustomparameters')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/instructorcustomparameters.html">instructorcustomparameters</a>;
<a name="l117"><span class="linenum"> 117</span></a>          <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['acceptgrades'] = <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('instructorchoiceacceptgrades')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/instructorchoiceacceptgrades.html">instructorchoiceacceptgrades</a>;
<a name="l118"><span class="linenum"> 118</span></a>          <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['allowroster'] = <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('instructorchoiceallowroster')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/instructorchoiceallowroster.html">instructorchoiceallowroster</a>;
<a name="l119"><span class="linenum"> 119</span></a>          <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['forcessl'] = '0';
<a name="l120"><span class="linenum"> 120</span></a>      }
<a name="l121"><span class="linenum"> 121</span></a>  
<a name="l122"><span class="linenum"> 122</span></a>  <span class="comment">    // Default the organizationid if not specified.</span>
<a name="l123"><span class="linenum"> 123</span></a>      if (empty(<a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['organizationid'])) {
<a name="l124"><span class="linenum"> 124</span></a>          <a class="var it25179" onMouseOver="hilite(25179)" onMouseOut="lolite()" onClick="logVariable('urlparts')" href="../../_variables/urlparts.html">$urlparts</a> = <a class="phpfunction" onClick="logFunction('parse_url')" href="../../_functions/parse_url.html" onMouseOver="phpfuncPopup(event,'parse_url')">parse_url</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>);
<a name="l125"><span class="linenum"> 125</span></a>  
<a name="l126"><span class="linenum"> 126</span></a>          <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['organizationid'] = <a class="var it25179" onMouseOver="hilite(25179)" onMouseOut="lolite()" onClick="logVariable('urlparts')" href="../../_variables/urlparts.html">$urlparts</a>['host'];
<a name="l127"><span class="linenum"> 127</span></a>      }
<a name="l128"><span class="linenum"> 128</span></a>  
<a name="l129"><span class="linenum"> 129</span></a>      if (isset(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('toolproxyid')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/toolproxyid.html">toolproxyid</a>)) {
<a name="l130"><span class="linenum"> 130</span></a>          <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a> = <a class="function" onClick="logFunction('lti_get_tool_proxy')" href="../../_functions/lti_get_tool_proxy.html" onMouseOver="funcPopup(event,'lti_get_tool_proxy')">lti_get_tool_proxy</a>(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('toolproxyid')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/toolproxyid.html">toolproxyid</a>);
<a name="l131"><span class="linenum"> 131</span></a>          <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('guid')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/guid.html">guid</a>;
<a name="l132"><span class="linenum"> 132</span></a>          <a class="var it216" onMouseOver="hilite(216)" onMouseOut="lolite()" onClick="logVariable('secret')" href="../../_variables/secret.html">$secret</a> = <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('secret')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/secret.html">secret</a>;
<a name="l133"><span class="linenum"> 133</span></a>      } else {
<a name="l134"><span class="linenum"> 134</span></a>          <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a> = null;
<a name="l135"><span class="linenum"> 135</span></a>          if (!empty(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('resourcekey')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/resourcekey.html">resourcekey</a>)) {
<a name="l136"><span class="linenum"> 136</span></a>              <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('resourcekey')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/resourcekey.html">resourcekey</a>;
<a name="l137"><span class="linenum"> 137</span></a>          } else if (!empty(<a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['resourcekey'])) {
<a name="l138"><span class="linenum"> 138</span></a>              <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['resourcekey'];
<a name="l139"><span class="linenum"> 139</span></a>          } else {
<a name="l140"><span class="linenum"> 140</span></a>              <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = '';
<a name="l141"><span class="linenum"> 141</span></a>          }
<a name="l142"><span class="linenum"> 142</span></a>          if (!empty(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('password')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/password.html">password</a>)) {
<a name="l143"><span class="linenum"> 143</span></a>              <a class="var it216" onMouseOver="hilite(216)" onMouseOut="lolite()" onClick="logVariable('secret')" href="../../_variables/secret.html">$secret</a> = <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('password')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/password.html">password</a>;
<a name="l144"><span class="linenum"> 144</span></a>          } else if (!empty(<a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['password'])) {
<a name="l145"><span class="linenum"> 145</span></a>              <a class="var it216" onMouseOver="hilite(216)" onMouseOut="lolite()" onClick="logVariable('secret')" href="../../_variables/secret.html">$secret</a> = <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['password'];
<a name="l146"><span class="linenum"> 146</span></a>          } else {
<a name="l147"><span class="linenum"> 147</span></a>              <a class="var it216" onMouseOver="hilite(216)" onMouseOut="lolite()" onClick="logVariable('secret')" href="../../_variables/secret.html">$secret</a> = '';
<a name="l148"><span class="linenum"> 148</span></a>          }
<a name="l149"><span class="linenum"> 149</span></a>      }
<a name="l150"><span class="linenum"> 150</span></a>  
<a name="l151"><span class="linenum"> 151</span></a>      <a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a> = !empty(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('toolurl')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/toolurl.html">toolurl</a>) ? <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('toolurl')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/toolurl.html">toolurl</a> : <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['toolurl'];
<a name="l152"><span class="linenum"> 152</span></a>      <a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a>);
<a name="l153"><span class="linenum"> 153</span></a>  
<a name="l154"><span class="linenum"> 154</span></a>  <span class="comment">    // If the current request is using SSL and a secure tool URL is specified, use it.</span>
<a name="l155"><span class="linenum"> 155</span></a>      if (<a class="function" onClick="logFunction('lti_request_is_using_ssl')" href="../../_functions/lti_request_is_using_ssl.html" onMouseOver="funcPopup(event,'lti_request_is_using_ssl')">lti_request_is_using_ssl</a>() &amp;&amp; !empty(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('securetoolurl')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/securetoolurl.html">securetoolurl</a>)) {
<a name="l156"><span class="linenum"> 156</span></a>          <a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('securetoolurl')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/securetoolurl.html">securetoolurl</a>);
<a name="l157"><span class="linenum"> 157</span></a>      }
<a name="l158"><span class="linenum"> 158</span></a>  
<a name="l159"><span class="linenum"> 159</span></a>  <span class="comment">    // If SSL is forced, use the secure tool url if specified. Otherwise, make sure https is on the normal launch URL.</span>
<a name="l160"><span class="linenum"> 160</span></a>      if (isset(<a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['forcessl']) &amp;&amp; (<a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['forcessl'] == '1')) {
<a name="l161"><span class="linenum"> 161</span></a>          if (!empty(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('securetoolurl')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/securetoolurl.html">securetoolurl</a>)) {
<a name="l162"><span class="linenum"> 162</span></a>              <a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('securetoolurl')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/securetoolurl.html">securetoolurl</a>);
<a name="l163"><span class="linenum"> 163</span></a>          }
<a name="l164"><span class="linenum"> 164</span></a>  
<a name="l165"><span class="linenum"> 165</span></a>          <a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a> = <a class="function" onClick="logFunction('lti_ensure_url_is_https')" href="../../_functions/lti_ensure_url_is_https.html" onMouseOver="funcPopup(event,'lti_ensure_url_is_https')">lti_ensure_url_is_https</a>(<a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a>);
<a name="l166"><span class="linenum"> 166</span></a>      } else {
<a name="l167"><span class="linenum"> 167</span></a>          if (!<a class="phpfunction" onClick="logFunction('strstr')" href="../../_functions/strstr.html" onMouseOver="phpfuncPopup(event,'strstr')">strstr</a>(<a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a>, '://')) {
<a name="l168"><span class="linenum"> 168</span></a>              <a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a> = 'http://' . <a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a>;
<a name="l169"><span class="linenum"> 169</span></a>          }
<a name="l170"><span class="linenum"> 170</span></a>      }
<a name="l171"><span class="linenum"> 171</span></a>  
<a name="l172"><span class="linenum"> 172</span></a>      <a class="var it25180" onMouseOver="hilite(25180)" onMouseOut="lolite()" onClick="logVariable('orgid')" href="../../_variables/orgid.html">$orgid</a> = <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['organizationid'];
<a name="l173"><span class="linenum"> 173</span></a>  
<a name="l174"><span class="linenum"> 174</span></a>      <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a> = <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a onClick="logVariable('course')" class="var it42916" onMouseOver="hilite(42916)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>;
<a name="l175"><span class="linenum"> 175</span></a>      <a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a> = isset(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('toolproxyid')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/toolproxyid.html">toolproxyid</a>);
<a name="l176"><span class="linenum"> 176</span></a>      <a class="var it11267" onMouseOver="hilite(11267)" onMouseOut="lolite()" onClick="logVariable('allparams')" href="../../_variables/allparams.html">$allparams</a> = <a class="function" onClick="logFunction('lti_build_request')" href="../../_functions/lti_build_request.html" onMouseOver="funcPopup(event,'lti_build_request')">lti_build_request</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>, <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, <a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a>, <a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a>);
<a name="l177"><span class="linenum"> 177</span></a>      if (<a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a>) {
<a name="l178"><span class="linenum"> 178</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a> = <a class="function" onClick="logFunction('lti_build_request_lti2')" href="../../_functions/lti_build_request_lti2.html" onMouseOver="funcPopup(event,'lti_build_request_lti2')">lti_build_request_lti2</a>(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>, <a class="var it11267" onMouseOver="hilite(11267)" onMouseOut="lolite()" onClick="logVariable('allparams')" href="../../_variables/allparams.html">$allparams</a>);
<a name="l179"><span class="linenum"> 179</span></a>      } else {
<a name="l180"><span class="linenum"> 180</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a> = <a class="var it11267" onMouseOver="hilite(11267)" onMouseOut="lolite()" onClick="logVariable('allparams')" href="../../_variables/allparams.html">$allparams</a>;
<a name="l181"><span class="linenum"> 181</span></a>      }
<a name="l182"><span class="linenum"> 182</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>, <a class="function" onClick="logFunction('lti_build_standard_request')" href="../../_functions/lti_build_standard_request.html" onMouseOver="funcPopup(event,'lti_build_standard_request')">lti_build_standard_request</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>, <a class="var it25180" onMouseOver="hilite(25180)" onMouseOut="lolite()" onClick="logVariable('orgid')" href="../../_variables/orgid.html">$orgid</a>, <a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a>));
<a name="l183"><span class="linenum"> 183</span></a>      <a class="var it35739" onMouseOver="hilite(35739)" onMouseOut="lolite()" onClick="logVariable('customstr')" href="../../_variables/customstr.html">$customstr</a> = '';
<a name="l184"><span class="linenum"> 184</span></a>      if (isset(<a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['customparameters'])) {
<a name="l185"><span class="linenum"> 185</span></a>          <a class="var it35739" onMouseOver="hilite(35739)" onMouseOut="lolite()" onClick="logVariable('customstr')" href="../../_variables/customstr.html">$customstr</a> = <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['customparameters'];
<a name="l186"><span class="linenum"> 186</span></a>      }
<a name="l187"><span class="linenum"> 187</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>, <a class="function" onClick="logFunction('lti_build_custom_parameters')" href="../../_functions/lti_build_custom_parameters.html" onMouseOver="funcPopup(event,'lti_build_custom_parameters')">lti_build_custom_parameters</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>, <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>, <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>, <a class="var it11267" onMouseOver="hilite(11267)" onMouseOut="lolite()" onClick="logVariable('allparams')" href="../../_variables/allparams.html">$allparams</a>, <a class="var it35739" onMouseOver="hilite(35739)" onMouseOut="lolite()" onClick="logVariable('customstr')" href="../../_variables/customstr.html">$customstr</a>,
<a name="l188"><span class="linenum"> 188</span></a>          <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('instructorcustomparameters')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/instructorcustomparameters.html">instructorcustomparameters</a>, <a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a>));
<a name="l189"><span class="linenum"> 189</span></a>  
<a name="l190"><span class="linenum"> 190</span></a>      <a class="var it23750" onMouseOver="hilite(23750)" onMouseOut="lolite()" onClick="logVariable('launchcontainer')" href="../../_variables/launchcontainer.html">$launchcontainer</a> = <a class="function" onClick="logFunction('lti_get_launch_container')" href="../../_functions/lti_get_launch_container.html" onMouseOver="funcPopup(event,'lti_get_launch_container')">lti_get_launch_container</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>, <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>);
<a name="l191"><span class="linenum"> 191</span></a>      <a class="var it35740" onMouseOver="hilite(35740)" onMouseOut="lolite()" onClick="logVariable('returnurlparams')" href="../../_variables/returnurlparams.html">$returnurlparams</a> = array('course' =&gt; <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l192"><span class="linenum"> 192</span></a>                               'launch_container' =&gt; <a class="var it23750" onMouseOver="hilite(23750)" onMouseOut="lolite()" onClick="logVariable('launchcontainer')" href="../../_variables/launchcontainer.html">$launchcontainer</a>,
<a name="l193"><span class="linenum"> 193</span></a>                               'instanceid' =&gt; <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('id')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l194"><span class="linenum"> 194</span></a>                               'sesskey' =&gt; <a class="function" onClick="logFunction('sesskey')" href="../../_functions/sesskey.html" onMouseOver="funcPopup(event,'sesskey')">sesskey</a>());
<a name="l195"><span class="linenum"> 195</span></a>  
<a name="l196"><span class="linenum"> 196</span></a>  <span class="comment">    // Add the return URL. We send the launch container along to help us avoid frames-within-frames when the user returns.</span>
<a name="l197"><span class="linenum"> 197</span></a>      <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = new \moodle_url('<a class="filename" href="../../mod/lti/return.php.html">/mod/lti/return.php</a>', <a class="var it35740" onMouseOver="hilite(35740)" onMouseOut="lolite()" onClick="logVariable('returnurlparams')" href="../../_variables/returnurlparams.html">$returnurlparams</a>);
<a name="l198"><span class="linenum"> 198</span></a>      <a class="var it1440" onMouseOver="hilite(1440)" onMouseOut="lolite()" onClick="logVariable('returnurl')" href="../../_variables/returnurl.html">$returnurl</a> = <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>-&gt;<a class="function" onClick="logFunction('out')" href="../../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>(false);
<a name="l199"><span class="linenum"> 199</span></a>  
<a name="l200"><span class="linenum"> 200</span></a>      if (isset(<a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['forcessl']) &amp;&amp; (<a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['forcessl'] == '1')) {
<a name="l201"><span class="linenum"> 201</span></a>          <a class="var it1440" onMouseOver="hilite(1440)" onMouseOut="lolite()" onClick="logVariable('returnurl')" href="../../_variables/returnurl.html">$returnurl</a> = <a class="function" onClick="logFunction('lti_ensure_url_is_https')" href="../../_functions/lti_ensure_url_is_https.html" onMouseOver="funcPopup(event,'lti_ensure_url_is_https')">lti_ensure_url_is_https</a>(<a class="var it1440" onMouseOver="hilite(1440)" onMouseOut="lolite()" onClick="logVariable('returnurl')" href="../../_variables/returnurl.html">$returnurl</a>);
<a name="l202"><span class="linenum"> 202</span></a>      }
<a name="l203"><span class="linenum"> 203</span></a>  
<a name="l204"><span class="linenum"> 204</span></a>      <a class="var it713" onMouseOver="hilite(713)" onMouseOut="lolite()" onClick="logVariable('target')" href="../../_variables/target.html">$target</a> = '';
<a name="l205"><span class="linenum"> 205</span></a>      switch(<a class="var it23750" onMouseOver="hilite(23750)" onMouseOut="lolite()" onClick="logVariable('launchcontainer')" href="../../_variables/launchcontainer.html">$launchcontainer</a>) {
<a name="l206"><span class="linenum"> 206</span></a>          case <a class="constant" onClick="logConstant('LTI_LAUNCH_CONTAINER_EMBED')" href="../../_constants/LTI_LAUNCH_CONTAINER_EMBED.html" onMouseOver="constPopup(event,'LTI_LAUNCH_CONTAINER_EMBED')">LTI_LAUNCH_CONTAINER_EMBED</a>:
<a name="l207"><span class="linenum"> 207</span></a>          case <a class="constant" onClick="logConstant('LTI_LAUNCH_CONTAINER_EMBED_NO_BLOCKS')" href="../../_constants/LTI_LAUNCH_CONTAINER_EMBED_NO_BLOCKS.html" onMouseOver="constPopup(event,'LTI_LAUNCH_CONTAINER_EMBED_NO_BLOCKS')">LTI_LAUNCH_CONTAINER_EMBED_NO_BLOCKS</a>:
<a name="l208"><span class="linenum"> 208</span></a>              <a class="var it713" onMouseOver="hilite(713)" onMouseOut="lolite()" onClick="logVariable('target')" href="../../_variables/target.html">$target</a> = 'iframe';
<a name="l209"><span class="linenum"> 209</span></a>              break;
<a name="l210"><span class="linenum"> 210</span></a>          case LTI_LAUNCH_CONTAINER_REPLACE_MOODLE_WINDOW:
<a name="l211"><span class="linenum"> 211</span></a>              <a class="var it713" onMouseOver="hilite(713)" onMouseOut="lolite()" onClick="logVariable('target')" href="../../_variables/target.html">$target</a> = 'frame';
<a name="l212"><span class="linenum"> 212</span></a>              break;
<a name="l213"><span class="linenum"> 213</span></a>          case <a class="constant" onClick="logConstant('LTI_LAUNCH_CONTAINER_WINDOW')" href="../../_constants/LTI_LAUNCH_CONTAINER_WINDOW.html" onMouseOver="constPopup(event,'LTI_LAUNCH_CONTAINER_WINDOW')">LTI_LAUNCH_CONTAINER_WINDOW</a>:
<a name="l214"><span class="linenum"> 214</span></a>              <a class="var it713" onMouseOver="hilite(713)" onMouseOut="lolite()" onClick="logVariable('target')" href="../../_variables/target.html">$target</a> = 'window';
<a name="l215"><span class="linenum"> 215</span></a>              break;
<a name="l216"><span class="linenum"> 216</span></a>      }
<a name="l217"><span class="linenum"> 217</span></a>      if (!empty(<a class="var it713" onMouseOver="hilite(713)" onMouseOut="lolite()" onClick="logVariable('target')" href="../../_variables/target.html">$target</a>)) {
<a name="l218"><span class="linenum"> 218</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['launch_presentation_document_target'] = <a class="var it713" onMouseOver="hilite(713)" onMouseOut="lolite()" onClick="logVariable('target')" href="../../_variables/target.html">$target</a>;
<a name="l219"><span class="linenum"> 219</span></a>      }
<a name="l220"><span class="linenum"> 220</span></a>  
<a name="l221"><span class="linenum"> 221</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['launch_presentation_return_url'] = <a class="var it1440" onMouseOver="hilite(1440)" onMouseOut="lolite()" onClick="logVariable('returnurl')" href="../../_variables/returnurl.html">$returnurl</a>;
<a name="l222"><span class="linenum"> 222</span></a>  
<a name="l223"><span class="linenum"> 223</span></a>  <span class="comment">    // Allow request params to be updated by sub-plugins.</span>
<a name="l224"><span class="linenum"> 224</span></a>      <a class="var it3924" onMouseOver="hilite(3924)" onMouseOut="lolite()" onClick="logVariable('plugins')" href="../../_variables/plugins.html">$plugins</a> = <a class="class" onClick="logClass('core_component')" href="../../_classes/core_component.html" onMouseOver="classPopup(event,'core_component')">core_component</a>::<a class="function" onClick="logFunction('get_plugin_list')" href="../../_functions/get_plugin_list.html" onMouseOver="funcPopup(event,'get_plugin_list')">get_plugin_list</a>('ltisource');
<a name="l225"><span class="linenum"> 225</span></a>      foreach (<a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it3924" onMouseOver="hilite(3924)" onMouseOut="lolite()" onClick="logVariable('plugins')" href="../../_variables/plugins.html">$plugins</a>) as <a class="var it265" onMouseOver="hilite(265)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>) {
<a name="l226"><span class="linenum"> 226</span></a>          <a class="var it35008" onMouseOver="hilite(35008)" onMouseOut="lolite()" onClick="logVariable('pluginparams')" href="../../_variables/pluginparams.html">$pluginparams</a> = <a class="function" onClick="logFunction('component_callback')" href="../../_functions/component_callback.html" onMouseOver="funcPopup(event,'component_callback')">component_callback</a>('ltisource_'.<a class="var it265" onMouseOver="hilite(265)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>, 'before_launch',
<a name="l227"><span class="linenum"> 227</span></a>              array(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>, <a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a>, <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>), array());
<a name="l228"><span class="linenum"> 228</span></a>  
<a name="l229"><span class="linenum"> 229</span></a>          if (!empty(<a class="var it35008" onMouseOver="hilite(35008)" onMouseOut="lolite()" onClick="logVariable('pluginparams')" href="../../_variables/pluginparams.html">$pluginparams</a>) &amp;&amp; <a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it35008" onMouseOver="hilite(35008)" onMouseOut="lolite()" onClick="logVariable('pluginparams')" href="../../_variables/pluginparams.html">$pluginparams</a>)) {
<a name="l230"><span class="linenum"> 230</span></a>              <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>, <a class="var it35008" onMouseOver="hilite(35008)" onMouseOut="lolite()" onClick="logVariable('pluginparams')" href="../../_variables/pluginparams.html">$pluginparams</a>);
<a name="l231"><span class="linenum"> 231</span></a>          }
<a name="l232"><span class="linenum"> 232</span></a>      }
<a name="l233"><span class="linenum"> 233</span></a>  
<a name="l234"><span class="linenum"> 234</span></a>      if (!empty(<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>) &amp;&amp; !empty(<a class="var it216" onMouseOver="hilite(216)" onMouseOut="lolite()" onClick="logVariable('secret')" href="../../_variables/secret.html">$secret</a>)) {
<a name="l235"><span class="linenum"> 235</span></a>          <a class="var it3757" onMouseOver="hilite(3757)" onMouseOut="lolite()" onClick="logVariable('parms')" href="../../_variables/parms.html">$parms</a> = <a class="function" onClick="logFunction('lti_sign_parameters')" href="../../_functions/lti_sign_parameters.html" onMouseOver="funcPopup(event,'lti_sign_parameters')">lti_sign_parameters</a>(<a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>, <a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a>, &quot;POST&quot;, <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>, <a class="var it216" onMouseOver="hilite(216)" onMouseOut="lolite()" onClick="logVariable('secret')" href="../../_variables/secret.html">$secret</a>);
<a name="l236"><span class="linenum"> 236</span></a>  
<a name="l237"><span class="linenum"> 237</span></a>          <a class="var it35741" onMouseOver="hilite(35741)" onMouseOut="lolite()" onClick="logVariable('endpointurl')" href="../../_variables/endpointurl.html">$endpointurl</a> = new \moodle_url(<a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a>);
<a name="l238"><span class="linenum"> 238</span></a>          <a class="var it35742" onMouseOver="hilite(35742)" onMouseOut="lolite()" onClick="logVariable('endpointparams')" href="../../_variables/endpointparams.html">$endpointparams</a> = <a class="var it35741" onMouseOver="hilite(35741)" onMouseOut="lolite()" onClick="logVariable('endpointurl')" href="../../_variables/endpointurl.html">$endpointurl</a>-&gt;<a class="function" onClick="logFunction('params')" href="../../_functions/params.html" onMouseOver="funcPopup(event,'params')">params</a>();
<a name="l239"><span class="linenum"> 239</span></a>  
<a name="l240"><span class="linenum"> 240</span></a>  <span class="comment">        // Strip querystring params in endpoint url from $parms to avoid duplication.</span>
<a name="l241"><span class="linenum"> 241</span></a>          if (!empty(<a class="var it35742" onMouseOver="hilite(35742)" onMouseOut="lolite()" onClick="logVariable('endpointparams')" href="../../_variables/endpointparams.html">$endpointparams</a>) &amp;&amp; !empty(<a class="var it3757" onMouseOver="hilite(3757)" onMouseOut="lolite()" onClick="logVariable('parms')" href="../../_variables/parms.html">$parms</a>)) {
<a name="l242"><span class="linenum"> 242</span></a>              foreach (<a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it35742" onMouseOver="hilite(35742)" onMouseOut="lolite()" onClick="logVariable('endpointparams')" href="../../_variables/endpointparams.html">$endpointparams</a>) as <a class="var it15919" onMouseOver="hilite(15919)" onMouseOut="lolite()" onClick="logVariable('paramname')" href="../../_variables/paramname.html">$paramname</a>) {
<a name="l243"><span class="linenum"> 243</span></a>                  if (isset(<a class="var it3757" onMouseOver="hilite(3757)" onMouseOut="lolite()" onClick="logVariable('parms')" href="../../_variables/parms.html">$parms</a>[<a class="var it15919" onMouseOver="hilite(15919)" onMouseOut="lolite()" onClick="logVariable('paramname')" href="../../_variables/paramname.html">$paramname</a>])) {
<a name="l244"><span class="linenum"> 244</span></a>                      unset(<a class="var it3757" onMouseOver="hilite(3757)" onMouseOut="lolite()" onClick="logVariable('parms')" href="../../_variables/parms.html">$parms</a>[<a class="var it15919" onMouseOver="hilite(15919)" onMouseOut="lolite()" onClick="logVariable('paramname')" href="../../_variables/paramname.html">$paramname</a>]);
<a name="l245"><span class="linenum"> 245</span></a>                  }
<a name="l246"><span class="linenum"> 246</span></a>              }
<a name="l247"><span class="linenum"> 247</span></a>          }
<a name="l248"><span class="linenum"> 248</span></a>  
<a name="l249"><span class="linenum"> 249</span></a>      } else {
<a name="l250"><span class="linenum"> 250</span></a>  <span class="comment">        // If no key and secret, do the launch unsigned.</span>
<a name="l251"><span class="linenum"> 251</span></a>          <a class="var it35740" onMouseOver="hilite(35740)" onMouseOut="lolite()" onClick="logVariable('returnurlparams')" href="../../_variables/returnurlparams.html">$returnurlparams</a>['unsigned'] = '1';
<a name="l252"><span class="linenum"> 252</span></a>          <a class="var it3757" onMouseOver="hilite(3757)" onMouseOut="lolite()" onClick="logVariable('parms')" href="../../_variables/parms.html">$parms</a> = <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>;
<a name="l253"><span class="linenum"> 253</span></a>      }
<a name="l254"><span class="linenum"> 254</span></a>  
<a name="l255"><span class="linenum"> 255</span></a>      return array(<a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a>, <a class="var it3757" onMouseOver="hilite(3757)" onMouseOut="lolite()" onClick="logVariable('parms')" href="../../_variables/parms.html">$parms</a>);
<a name="l256"><span class="linenum"> 256</span></a>  }
<a name="l257"><span class="linenum"> 257</span></a>  
<a name="l258"><span class="linenum"> 258</span></a>  <span class="comment">/**</span>
<a name="l259"><span class="linenum"> 259</span></a>  <span class="comment"> * Launch an external tool activity.</span>
<a name="l260"><span class="linenum"> 260</span></a>  <span class="comment"> *</span>
<a name="l261"><span class="linenum"> 261</span></a>  <span class="comment"> * @param  stdClass $instance the external tool activity settings</span>
<a name="l262"><span class="linenum"> 262</span></a>  <span class="comment"> * @return string The HTML code containing the javascript code for the launch</span>
<a name="l263"><span class="linenum"> 263</span></a>  <span class="comment"> */</span>
<a name="l264"><span class="linenum"> 264</span></a>  function <a class="function" onClick="logFunction('lti_launch_tool')" href="../../_functions/lti_launch_tool.html" onMouseOver="funcPopup(event,'lti_launch_tool')">lti_launch_tool</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>) {
<a name="l265"><span class="linenum"> 265</span></a>  
<a name="l266"><span class="linenum"> 266</span></a>      <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a>, <a class="var it3757" onMouseOver="hilite(3757)" onMouseOut="lolite()" onClick="logVariable('parms')" href="../../_variables/parms.html">$parms</a>) = <a class="function" onClick="logFunction('lti_get_launch_data')" href="../../_functions/lti_get_launch_data.html" onMouseOver="funcPopup(event,'lti_get_launch_data')">lti_get_launch_data</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>);
<a name="l267"><span class="linenum"> 267</span></a>      <a class="var it35743" onMouseOver="hilite(35743)" onMouseOut="lolite()" onClick="logVariable('debuglaunch')" href="../../_variables/debuglaunch.html">$debuglaunch</a> = ( <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('debuglaunch')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/debuglaunch.html">debuglaunch</a> == 1 );
<a name="l268"><span class="linenum"> 268</span></a>  
<a name="l269"><span class="linenum"> 269</span></a>      <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a> = <a class="function" onClick="logFunction('lti_post_launch_html')" href="../../_functions/lti_post_launch_html.html" onMouseOver="funcPopup(event,'lti_post_launch_html')">lti_post_launch_html</a>(<a class="var it3757" onMouseOver="hilite(3757)" onMouseOut="lolite()" onClick="logVariable('parms')" href="../../_variables/parms.html">$parms</a>, <a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a>, <a class="var it35743" onMouseOver="hilite(35743)" onMouseOut="lolite()" onClick="logVariable('debuglaunch')" href="../../_variables/debuglaunch.html">$debuglaunch</a>);
<a name="l270"><span class="linenum"> 270</span></a>  
<a name="l271"><span class="linenum"> 271</span></a>      echo <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a>;
<a name="l272"><span class="linenum"> 272</span></a>  }
<a name="l273"><span class="linenum"> 273</span></a>  
<a name="l274"><span class="linenum"> 274</span></a>  <span class="comment">/**</span>
<a name="l275"><span class="linenum"> 275</span></a>  <span class="comment"> * Prepares an LTI registration request message</span>
<a name="l276"><span class="linenum"> 276</span></a>  <span class="comment"> *</span>
<a name="l277"><span class="linenum"> 277</span></a>  <span class="comment"> * $param object $instance       Tool Proxy instance object</span>
<a name="l278"><span class="linenum"> 278</span></a>  <span class="comment"> */</span>
<a name="l279"><span class="linenum"> 279</span></a>  function <a class="function" onClick="logFunction('lti_register')" href="../../_functions/lti_register.html" onMouseOver="funcPopup(event,'lti_register')">lti_register</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>) {
<a name="l280"><span class="linenum"> 280</span></a>      <a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a> = <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('regurl')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/regurl.html">regurl</a>;
<a name="l281"><span class="linenum"> 281</span></a>  
<a name="l282"><span class="linenum"> 282</span></a>  <span class="comment">    // Change the status to pending.</span>
<a name="l283"><span class="linenum"> 283</span></a>      <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('state')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> = <a class="constant" onClick="logConstant('LTI_TOOL_PROXY_STATE_PENDING')" href="../../_constants/LTI_TOOL_PROXY_STATE_PENDING.html" onMouseOver="constPopup(event,'LTI_TOOL_PROXY_STATE_PENDING')">LTI_TOOL_PROXY_STATE_PENDING</a>;
<a name="l284"><span class="linenum"> 284</span></a>      <a class="function" onClick="logFunction('lti_update_tool_proxy')" href="../../_functions/lti_update_tool_proxy.html" onMouseOver="funcPopup(event,'lti_update_tool_proxy')">lti_update_tool_proxy</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>);
<a name="l285"><span class="linenum"> 285</span></a>  
<a name="l286"><span class="linenum"> 286</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a> = <a class="function" onClick="logFunction('lti_build_registration_request')" href="../../_functions/lti_build_registration_request.html" onMouseOver="funcPopup(event,'lti_build_registration_request')">lti_build_registration_request</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>);
<a name="l287"><span class="linenum"> 287</span></a>  
<a name="l288"><span class="linenum"> 288</span></a>      <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a> = <a class="function" onClick="logFunction('lti_post_launch_html')" href="../../_functions/lti_post_launch_html.html" onMouseOver="funcPopup(event,'lti_post_launch_html')">lti_post_launch_html</a>(<a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>, <a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a>, false);
<a name="l289"><span class="linenum"> 289</span></a>  
<a name="l290"><span class="linenum"> 290</span></a>      echo <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a>;
<a name="l291"><span class="linenum"> 291</span></a>  }
<a name="l292"><span class="linenum"> 292</span></a>  
<a name="l293"><span class="linenum"> 293</span></a>  
<a name="l294"><span class="linenum"> 294</span></a>  <span class="comment">/**</span>
<a name="l295"><span class="linenum"> 295</span></a>  <span class="comment"> * Gets the parameters for the regirstration request</span>
<a name="l296"><span class="linenum"> 296</span></a>  <span class="comment"> *</span>
<a name="l297"><span class="linenum"> 297</span></a>  <span class="comment"> * @param object $toolproxy Tool Proxy instance object</span>
<a name="l298"><span class="linenum"> 298</span></a>  <span class="comment"> * @return array Registration request parameters</span>
<a name="l299"><span class="linenum"> 299</span></a>  <span class="comment"> */</span>
<a name="l300"><span class="linenum"> 300</span></a>  function <a class="function" onClick="logFunction('lti_build_registration_request')" href="../../_functions/lti_build_registration_request.html" onMouseOver="funcPopup(event,'lti_build_registration_request')">lti_build_registration_request</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>) {
<a name="l301"><span class="linenum"> 301</span></a>      <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('guid')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/guid.html">guid</a>;
<a name="l302"><span class="linenum"> 302</span></a>      <a class="var it216" onMouseOver="hilite(216)" onMouseOut="lolite()" onClick="logVariable('secret')" href="../../_variables/secret.html">$secret</a> = <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('secret')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/secret.html">secret</a>;
<a name="l303"><span class="linenum"> 303</span></a>  
<a name="l304"><span class="linenum"> 304</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a> = array();
<a name="l305"><span class="linenum"> 305</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['lti_message_type'] = 'ToolProxyRegistrationRequest';
<a name="l306"><span class="linenum"> 306</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['lti_version'] = 'LTI-2p0';
<a name="l307"><span class="linenum"> 307</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['reg_key'] = <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>;
<a name="l308"><span class="linenum"> 308</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['reg_password'] = <a class="var it216" onMouseOver="hilite(216)" onMouseOut="lolite()" onClick="logVariable('secret')" href="../../_variables/secret.html">$secret</a>;
<a name="l309"><span class="linenum"> 309</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['reg_url'] = <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('regurl')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/regurl.html">regurl</a>;
<a name="l310"><span class="linenum"> 310</span></a>  
<a name="l311"><span class="linenum"> 311</span></a>  <span class="comment">    // Add the profile URL.</span>
<a name="l312"><span class="linenum"> 312</span></a>      <a class="var it8396" onMouseOver="hilite(8396)" onMouseOut="lolite()" onClick="logVariable('profileservice')" href="../../_variables/profileservice.html">$profileservice</a> = <a class="function" onClick="logFunction('lti_get_service_by_name')" href="../../_functions/lti_get_service_by_name.html" onMouseOver="funcPopup(event,'lti_get_service_by_name')">lti_get_service_by_name</a>('profile');
<a name="l313"><span class="linenum"> 313</span></a>      <a class="var it8396" onMouseOver="hilite(8396)" onMouseOut="lolite()" onClick="logVariable('profileservice')" href="../../_variables/profileservice.html">$profileservice</a>-&gt;<a class="function" onClick="logFunction('set_tool_proxy')" href="../../_functions/set_tool_proxy.html" onMouseOver="funcPopup(event,'set_tool_proxy')">set_tool_proxy</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>);
<a name="l314"><span class="linenum"> 314</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['tc_profile_url'] = <a class="var it8396" onMouseOver="hilite(8396)" onMouseOut="lolite()" onClick="logVariable('profileservice')" href="../../_variables/profileservice.html">$profileservice</a>-&gt;<a class="function" onClick="logFunction('parse_value')" href="../../_functions/parse_value.html" onMouseOver="funcPopup(event,'parse_value')">parse_value</a>('<a class="var it25186" onMouseOver="hilite(25186)" onMouseOut="lolite()" onClick="logVariable('ToolConsumerProfile')" href="../../_variables/ToolConsumerProfile.html">$ToolConsumerProfile</a>.url');
<a name="l315"><span class="linenum"> 315</span></a>  
<a name="l316"><span class="linenum"> 316</span></a>  <span class="comment">    // Add the return URL.</span>
<a name="l317"><span class="linenum"> 317</span></a>      <a class="var it35740" onMouseOver="hilite(35740)" onMouseOut="lolite()" onClick="logVariable('returnurlparams')" href="../../_variables/returnurlparams.html">$returnurlparams</a> = array('id' =&gt; <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('id')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'sesskey' =&gt; <a class="function" onClick="logFunction('sesskey')" href="../../_functions/sesskey.html" onMouseOver="funcPopup(event,'sesskey')">sesskey</a>());
<a name="l318"><span class="linenum"> 318</span></a>      <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = new \moodle_url('<a class="filename" href="../../mod/lti/externalregistrationreturn.php.html">/mod/lti/externalregistrationreturn.php</a>', <a class="var it35740" onMouseOver="hilite(35740)" onMouseOut="lolite()" onClick="logVariable('returnurlparams')" href="../../_variables/returnurlparams.html">$returnurlparams</a>);
<a name="l319"><span class="linenum"> 319</span></a>      <a class="var it1440" onMouseOver="hilite(1440)" onMouseOut="lolite()" onClick="logVariable('returnurl')" href="../../_variables/returnurl.html">$returnurl</a> = <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>-&gt;<a class="function" onClick="logFunction('out')" href="../../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>(false);
<a name="l320"><span class="linenum"> 320</span></a>  
<a name="l321"><span class="linenum"> 321</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['launch_presentation_return_url'] = <a class="var it1440" onMouseOver="hilite(1440)" onMouseOut="lolite()" onClick="logVariable('returnurl')" href="../../_variables/returnurl.html">$returnurl</a>;
<a name="l322"><span class="linenum"> 322</span></a>  
<a name="l323"><span class="linenum"> 323</span></a>      return <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>;
<a name="l324"><span class="linenum"> 324</span></a>  }
<a name="l325"><span class="linenum"> 325</span></a>  
<a name="l326"><span class="linenum"> 326</span></a>  <span class="comment">/**</span>
<a name="l327"><span class="linenum"> 327</span></a>  <span class="comment"> * Build source ID</span>
<a name="l328"><span class="linenum"> 328</span></a>  <span class="comment"> *</span>
<a name="l329"><span class="linenum"> 329</span></a>  <span class="comment"> * @param int $instanceid</span>
<a name="l330"><span class="linenum"> 330</span></a>  <span class="comment"> * @param int $userid</span>
<a name="l331"><span class="linenum"> 331</span></a>  <span class="comment"> * @param string $servicesalt</span>
<a name="l332"><span class="linenum"> 332</span></a>  <span class="comment"> * @param null|int $typeid</span>
<a name="l333"><span class="linenum"> 333</span></a>  <span class="comment"> * @param null|int $launchid</span>
<a name="l334"><span class="linenum"> 334</span></a>  <span class="comment"> * @return stdClass</span>
<a name="l335"><span class="linenum"> 335</span></a>  <span class="comment"> */</span>
<a name="l336"><span class="linenum"> 336</span></a>  function <a class="function" onClick="logFunction('lti_build_sourcedid')" href="../../_functions/lti_build_sourcedid.html" onMouseOver="funcPopup(event,'lti_build_sourcedid')">lti_build_sourcedid</a>(<a class="var it1184" onMouseOver="hilite(1184)" onMouseOut="lolite()" onClick="logVariable('instanceid')" href="../../_variables/instanceid.html">$instanceid</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, <a class="var it23739" onMouseOver="hilite(23739)" onMouseOut="lolite()" onClick="logVariable('servicesalt')" href="../../_variables/servicesalt.html">$servicesalt</a>, <a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a> = null, <a class="var it27359" onMouseOver="hilite(27359)" onMouseOut="lolite()" onClick="logVariable('launchid')" href="../../_variables/launchid.html">$launchid</a> = null) {
<a name="l337"><span class="linenum"> 337</span></a>      <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a> = new \stdClass();
<a name="l338"><span class="linenum"> 338</span></a>  
<a name="l339"><span class="linenum"> 339</span></a>      <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('instanceid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/instanceid.html">instanceid</a> = <a class="var it1184" onMouseOver="hilite(1184)" onMouseOut="lolite()" onClick="logVariable('instanceid')" href="../../_variables/instanceid.html">$instanceid</a>;
<a name="l340"><span class="linenum"> 340</span></a>      <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('userid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> = <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>;
<a name="l341"><span class="linenum"> 341</span></a>      <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('typeid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/typeid.html">typeid</a> = <a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a>;
<a name="l342"><span class="linenum"> 342</span></a>      if (!empty(<a class="var it27359" onMouseOver="hilite(27359)" onMouseOut="lolite()" onClick="logVariable('launchid')" href="../../_variables/launchid.html">$launchid</a>)) {
<a name="l343"><span class="linenum"> 343</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('launchid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/launchid.html">launchid</a> = <a class="var it27359" onMouseOver="hilite(27359)" onMouseOut="lolite()" onClick="logVariable('launchid')" href="../../_variables/launchid.html">$launchid</a>;
<a name="l344"><span class="linenum"> 344</span></a>      } else {
<a name="l345"><span class="linenum"> 345</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('launchid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/launchid.html">launchid</a> = <a class="phpfunction" onClick="logFunction('mt_rand')" href="../../_functions/mt_rand.html" onMouseOver="phpfuncPopup(event,'mt_rand')">mt_rand</a>();
<a name="l346"><span class="linenum"> 346</span></a>      }
<a name="l347"><span class="linenum"> 347</span></a>  
<a name="l348"><span class="linenum"> 348</span></a>      <a class="var it2497" onMouseOver="hilite(2497)" onMouseOut="lolite()" onClick="logVariable('json')" href="../../_variables/json.html">$json</a> = <a class="function" onClick="logFunction('json_encode')" href="../../_functions/json_encode.html" onMouseOver="funcPopup(event,'json_encode')">json_encode</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>);
<a name="l349"><span class="linenum"> 349</span></a>  
<a name="l350"><span class="linenum"> 350</span></a>      <a class="var it928" onMouseOver="hilite(928)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../../_variables/hash.html">$hash</a> = <a class="function" onClick="logFunction('hash')" href="../../_functions/hash.html" onMouseOver="funcPopup(event,'hash')">hash</a>('sha256', <a class="var it2497" onMouseOver="hilite(2497)" onMouseOut="lolite()" onClick="logVariable('json')" href="../../_variables/json.html">$json</a> . <a class="var it23739" onMouseOver="hilite(23739)" onMouseOut="lolite()" onClick="logVariable('servicesalt')" href="../../_variables/servicesalt.html">$servicesalt</a>, false);
<a name="l351"><span class="linenum"> 351</span></a>  
<a name="l352"><span class="linenum"> 352</span></a>      <a class="var it11747" onMouseOver="hilite(11747)" onMouseOut="lolite()" onClick="logVariable('container')" href="../../_variables/container.html">$container</a> = new \stdClass();
<a name="l353"><span class="linenum"> 353</span></a>      <a class="var it11747" onMouseOver="hilite(11747)" onMouseOut="lolite()" onClick="logVariable('container')" href="../../_variables/container.html">$container</a>-&gt;<a onClick="logVariable('data')" class="var it44331" onMouseOver="hilite(44331)" onMouseOut="lolite()" href="../../_variables/data.html">data</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>;
<a name="l354"><span class="linenum"> 354</span></a>      <a class="var it11747" onMouseOver="hilite(11747)" onMouseOut="lolite()" onClick="logVariable('container')" href="../../_variables/container.html">$container</a>-&gt;<a onClick="logVariable('hash')" class="var it44331" onMouseOver="hilite(44331)" onMouseOut="lolite()" href="../../_variables/hash.html">hash</a> = <a class="var it928" onMouseOver="hilite(928)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../../_variables/hash.html">$hash</a>;
<a name="l355"><span class="linenum"> 355</span></a>  
<a name="l356"><span class="linenum"> 356</span></a>      return <a class="var it11747" onMouseOver="hilite(11747)" onMouseOut="lolite()" onClick="logVariable('container')" href="../../_variables/container.html">$container</a>;
<a name="l357"><span class="linenum"> 357</span></a>  }
<a name="l358"><span class="linenum"> 358</span></a>  
<a name="l359"><span class="linenum"> 359</span></a>  <span class="comment">/**</span>
<a name="l360"><span class="linenum"> 360</span></a>  <span class="comment"> * This function builds the request that must be sent to the tool producer</span>
<a name="l361"><span class="linenum"> 361</span></a>  <span class="comment"> *</span>
<a name="l362"><span class="linenum"> 362</span></a>  <span class="comment"> * @param object    $instance       Basic LTI instance object</span>
<a name="l363"><span class="linenum"> 363</span></a>  <span class="comment"> * @param array     $typeconfig     Basic LTI tool configuration</span>
<a name="l364"><span class="linenum"> 364</span></a>  <span class="comment"> * @param object    $course         Course object</span>
<a name="l365"><span class="linenum"> 365</span></a>  <span class="comment"> * @param int|null  $typeid         Basic LTI tool ID</span>
<a name="l366"><span class="linenum"> 366</span></a>  <span class="comment"> * @param boolean   $islti2         True if an LTI 2 tool is being launched</span>
<a name="l367"><span class="linenum"> 367</span></a>  <span class="comment"> *</span>
<a name="l368"><span class="linenum"> 368</span></a>  <span class="comment"> * @return array                    Request details</span>
<a name="l369"><span class="linenum"> 369</span></a>  <span class="comment"> */</span>
<a name="l370"><span class="linenum"> 370</span></a>  function <a class="function" onClick="logFunction('lti_build_request')" href="../../_functions/lti_build_request.html" onMouseOver="funcPopup(event,'lti_build_request')">lti_build_request</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>, <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, <a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a> = null, <a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a> = false) {
<a name="l371"><span class="linenum"> 371</span></a>      global <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l372"><span class="linenum"> 372</span></a>  
<a name="l373"><span class="linenum"> 373</span></a>      if (empty(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('cmid')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/cmid.html">cmid</a>)) {
<a name="l374"><span class="linenum"> 374</span></a>          <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('cmid')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/cmid.html">cmid</a> = 0;
<a name="l375"><span class="linenum"> 375</span></a>      }
<a name="l376"><span class="linenum"> 376</span></a>  
<a name="l377"><span class="linenum"> 377</span></a>      <a class="var it573" onMouseOver="hilite(573)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a> = <a class="function" onClick="logFunction('lti_get_ims_role')" href="../../_functions/lti_get_ims_role.html" onMouseOver="funcPopup(event,'lti_get_ims_role')">lti_get_ims_role</a>(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('cmid')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/cmid.html">cmid</a>, <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('course')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>, <a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a>);
<a name="l378"><span class="linenum"> 378</span></a>  
<a name="l379"><span class="linenum"> 379</span></a>      <a class="var it1175" onMouseOver="hilite(1175)" onMouseOut="lolite()" onClick="logVariable('intro')" href="../../_variables/intro.html">$intro</a> = '';
<a name="l380"><span class="linenum"> 380</span></a>      if (!empty(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('cmid')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/cmid.html">cmid</a>)) {
<a name="l381"><span class="linenum"> 381</span></a>          <a class="var it1175" onMouseOver="hilite(1175)" onMouseOut="lolite()" onClick="logVariable('intro')" href="../../_variables/intro.html">$intro</a> = <a class="function" onClick="logFunction('format_module_intro')" href="../../_functions/format_module_intro.html" onMouseOver="funcPopup(event,'format_module_intro')">format_module_intro</a>('lti', <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>, <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('cmid')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/cmid.html">cmid</a>);
<a name="l382"><span class="linenum"> 382</span></a>          <a class="var it1175" onMouseOver="hilite(1175)" onMouseOut="lolite()" onClick="logVariable('intro')" href="../../_variables/intro.html">$intro</a> = <a class="function" onClick="logFunction('html_to_text')" href="../../_functions/html_to_text.html" onMouseOver="funcPopup(event,'html_to_text')">html_to_text</a>(<a class="var it1175" onMouseOver="hilite(1175)" onMouseOut="lolite()" onClick="logVariable('intro')" href="../../_variables/intro.html">$intro</a>, 0, false);
<a name="l383"><span class="linenum"> 383</span></a>  
<a name="l384"><span class="linenum"> 384</span></a>  <span class="comment">        // This may look weird, but this is required for new lines</span>
<a name="l385"><span class="linenum"> 385</span></a>  <span class="comment">        // so we generate the same OAuth signature as the tool provider.</span>
<a name="l386"><span class="linenum"> 386</span></a>          <a class="var it1175" onMouseOver="hilite(1175)" onMouseOut="lolite()" onClick="logVariable('intro')" href="../../_variables/intro.html">$intro</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(&quot;\n&quot;, &quot;\r\n&quot;, <a class="var it1175" onMouseOver="hilite(1175)" onMouseOut="lolite()" onClick="logVariable('intro')" href="../../_variables/intro.html">$intro</a>);
<a name="l387"><span class="linenum"> 387</span></a>      }
<a name="l388"><span class="linenum"> 388</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a> = array(
<a name="l389"><span class="linenum"> 389</span></a>          'resource_link_title' =&gt; <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('name')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>,
<a name="l390"><span class="linenum"> 390</span></a>          'resource_link_description' =&gt; <a class="var it1175" onMouseOver="hilite(1175)" onMouseOut="lolite()" onClick="logVariable('intro')" href="../../_variables/intro.html">$intro</a>,
<a name="l391"><span class="linenum"> 391</span></a>          'user_id' =&gt; <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l392"><span class="linenum"> 392</span></a>          'lis_person_sourcedid' =&gt; <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('idnumber')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/idnumber.html">idnumber</a>,
<a name="l393"><span class="linenum"> 393</span></a>          'roles' =&gt; <a class="var it573" onMouseOver="hilite(573)" onMouseOut="lolite()" onClick="logVariable('role')" href="../../_variables/role.html">$role</a>,
<a name="l394"><span class="linenum"> 394</span></a>          'context_id' =&gt; <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l395"><span class="linenum"> 395</span></a>          'context_label' =&gt; <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('shortname')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/shortname.html">shortname</a>,
<a name="l396"><span class="linenum"> 396</span></a>          'context_title' =&gt; <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('fullname')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/fullname.html">fullname</a>,
<a name="l397"><span class="linenum"> 397</span></a>      );
<a name="l398"><span class="linenum"> 398</span></a>      if (!empty(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('id')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>)) {
<a name="l399"><span class="linenum"> 399</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['resource_link_id'] = <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('id')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l400"><span class="linenum"> 400</span></a>      }
<a name="l401"><span class="linenum"> 401</span></a>      if (!empty(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('resource_link_id')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/resource_link_id.html">resource_link_id</a>)) {
<a name="l402"><span class="linenum"> 402</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['resource_link_id'] = <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('resource_link_id')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/resource_link_id.html">resource_link_id</a>;
<a name="l403"><span class="linenum"> 403</span></a>      }
<a name="l404"><span class="linenum"> 404</span></a>      if (<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('format')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/format.html">format</a> == 'site') {
<a name="l405"><span class="linenum"> 405</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['context_type'] = 'Group';
<a name="l406"><span class="linenum"> 406</span></a>      } else {
<a name="l407"><span class="linenum"> 407</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['context_type'] = 'CourseSection';
<a name="l408"><span class="linenum"> 408</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['lis_course_section_sourcedid'] = <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('idnumber')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/idnumber.html">idnumber</a>;
<a name="l409"><span class="linenum"> 409</span></a>      }
<a name="l410"><span class="linenum"> 410</span></a>      <a class="var it35744" onMouseOver="hilite(35744)" onMouseOut="lolite()" onClick="logVariable('placementsecret')" href="../../_variables/placementsecret.html">$placementsecret</a> = <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('servicesalt')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/servicesalt.html">servicesalt</a>;
<a name="l411"><span class="linenum"> 411</span></a>  
<a name="l412"><span class="linenum"> 412</span></a>      if ( !empty(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('id')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>) &amp;&amp; isset(<a class="var it35744" onMouseOver="hilite(35744)" onMouseOut="lolite()" onClick="logVariable('placementsecret')" href="../../_variables/placementsecret.html">$placementsecret</a>) &amp;&amp; (<a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a> ||
<a name="l413"><span class="linenum"> 413</span></a>           <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['acceptgrades'] == <a class="constant" onClick="logConstant('LTI_SETTING_ALWAYS')" href="../../_constants/LTI_SETTING_ALWAYS.html" onMouseOver="constPopup(event,'LTI_SETTING_ALWAYS')">LTI_SETTING_ALWAYS</a> ||
<a name="l414"><span class="linenum"> 414</span></a>           (<a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['acceptgrades'] == <a class="constant" onClick="logConstant('LTI_SETTING_DELEGATE')" href="../../_constants/LTI_SETTING_DELEGATE.html" onMouseOver="constPopup(event,'LTI_SETTING_DELEGATE')">LTI_SETTING_DELEGATE</a> &amp;&amp; <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('instructorchoiceacceptgrades')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/instructorchoiceacceptgrades.html">instructorchoiceacceptgrades</a> == <a class="constant" onClick="logConstant('LTI_SETTING_ALWAYS')" href="../../_constants/LTI_SETTING_ALWAYS.html" onMouseOver="constPopup(event,'LTI_SETTING_ALWAYS')">LTI_SETTING_ALWAYS</a>))) {
<a name="l415"><span class="linenum"> 415</span></a>  
<a name="l416"><span class="linenum"> 416</span></a>          <a class="var it35745" onMouseOver="hilite(35745)" onMouseOut="lolite()" onClick="logVariable('sourcedid')" href="../../_variables/sourcedid.html">$sourcedid</a> = <a class="function" onClick="logFunction('json_encode')" href="../../_functions/json_encode.html" onMouseOver="funcPopup(event,'json_encode')">json_encode</a>(<a class="function" onClick="logFunction('lti_build_sourcedid')" href="../../_functions/lti_build_sourcedid.html" onMouseOver="funcPopup(event,'lti_build_sourcedid')">lti_build_sourcedid</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('id')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it35744" onMouseOver="hilite(35744)" onMouseOut="lolite()" onClick="logVariable('placementsecret')" href="../../_variables/placementsecret.html">$placementsecret</a>, <a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a>));
<a name="l417"><span class="linenum"> 417</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['lis_result_sourcedid'] = <a class="var it35745" onMouseOver="hilite(35745)" onMouseOut="lolite()" onClick="logVariable('sourcedid')" href="../../_variables/sourcedid.html">$sourcedid</a>;
<a name="l418"><span class="linenum"> 418</span></a>  
<a name="l419"><span class="linenum"> 419</span></a>  <span class="comment">        // Add outcome service URL.</span>
<a name="l420"><span class="linenum"> 420</span></a>          <a class="var it15821" onMouseOver="hilite(15821)" onMouseOut="lolite()" onClick="logVariable('serviceurl')" href="../../_variables/serviceurl.html">$serviceurl</a> = new \moodle_url('<a class="filename" href="../../mod/lti/service.php.html">/mod/lti/service.php</a>');
<a name="l421"><span class="linenum"> 421</span></a>          <a class="var it15821" onMouseOver="hilite(15821)" onMouseOut="lolite()" onClick="logVariable('serviceurl')" href="../../_variables/serviceurl.html">$serviceurl</a> = <a class="var it15821" onMouseOver="hilite(15821)" onMouseOut="lolite()" onClick="logVariable('serviceurl')" href="../../_variables/serviceurl.html">$serviceurl</a>-&gt;<a class="function" onClick="logFunction('out')" href="../../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>();
<a name="l422"><span class="linenum"> 422</span></a>  
<a name="l423"><span class="linenum"> 423</span></a>          <a class="var it35746" onMouseOver="hilite(35746)" onMouseOut="lolite()" onClick="logVariable('forcessl')" href="../../_variables/forcessl.html">$forcessl</a> = false;
<a name="l424"><span class="linenum"> 424</span></a>          if (!empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mod_lti_forcessl')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/mod_lti_forcessl.html">mod_lti_forcessl</a>)) {
<a name="l425"><span class="linenum"> 425</span></a>              <a class="var it35746" onMouseOver="hilite(35746)" onMouseOut="lolite()" onClick="logVariable('forcessl')" href="../../_variables/forcessl.html">$forcessl</a> = true;
<a name="l426"><span class="linenum"> 426</span></a>          }
<a name="l427"><span class="linenum"> 427</span></a>  
<a name="l428"><span class="linenum"> 428</span></a>          if ((isset(<a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['forcessl']) &amp;&amp; (<a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['forcessl'] == '1')) or <a class="var it35746" onMouseOver="hilite(35746)" onMouseOut="lolite()" onClick="logVariable('forcessl')" href="../../_variables/forcessl.html">$forcessl</a>) {
<a name="l429"><span class="linenum"> 429</span></a>              <a class="var it15821" onMouseOver="hilite(15821)" onMouseOut="lolite()" onClick="logVariable('serviceurl')" href="../../_variables/serviceurl.html">$serviceurl</a> = <a class="function" onClick="logFunction('lti_ensure_url_is_https')" href="../../_functions/lti_ensure_url_is_https.html" onMouseOver="funcPopup(event,'lti_ensure_url_is_https')">lti_ensure_url_is_https</a>(<a class="var it15821" onMouseOver="hilite(15821)" onMouseOut="lolite()" onClick="logVariable('serviceurl')" href="../../_variables/serviceurl.html">$serviceurl</a>);
<a name="l430"><span class="linenum"> 430</span></a>          }
<a name="l431"><span class="linenum"> 431</span></a>  
<a name="l432"><span class="linenum"> 432</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['lis_outcome_service_url'] = <a class="var it15821" onMouseOver="hilite(15821)" onMouseOut="lolite()" onClick="logVariable('serviceurl')" href="../../_variables/serviceurl.html">$serviceurl</a>;
<a name="l433"><span class="linenum"> 433</span></a>      }
<a name="l434"><span class="linenum"> 434</span></a>  
<a name="l435"><span class="linenum"> 435</span></a>  <span class="comment">    // Send user's name and email data if appropriate.</span>
<a name="l436"><span class="linenum"> 436</span></a>      if (<a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a> || <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['sendname'] == <a class="constant" onClick="logConstant('LTI_SETTING_ALWAYS')" href="../../_constants/LTI_SETTING_ALWAYS.html" onMouseOver="constPopup(event,'LTI_SETTING_ALWAYS')">LTI_SETTING_ALWAYS</a> ||
<a name="l437"><span class="linenum"> 437</span></a>           ( <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['sendname'] == <a class="constant" onClick="logConstant('LTI_SETTING_DELEGATE')" href="../../_constants/LTI_SETTING_DELEGATE.html" onMouseOver="constPopup(event,'LTI_SETTING_DELEGATE')">LTI_SETTING_DELEGATE</a> &amp;&amp; <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('instructorchoicesendname')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/instructorchoicesendname.html">instructorchoicesendname</a> == <a class="constant" onClick="logConstant('LTI_SETTING_ALWAYS')" href="../../_constants/LTI_SETTING_ALWAYS.html" onMouseOver="constPopup(event,'LTI_SETTING_ALWAYS')">LTI_SETTING_ALWAYS</a> ) ) {
<a name="l438"><span class="linenum"> 438</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['lis_person_name_given'] = <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('firstname')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/firstname.html">firstname</a>;
<a name="l439"><span class="linenum"> 439</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['lis_person_name_family'] = <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('lastname')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/lastname.html">lastname</a>;
<a name="l440"><span class="linenum"> 440</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['lis_person_name_full'] = <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('firstname')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/firstname.html">firstname</a> . ' ' . <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('lastname')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/lastname.html">lastname</a>;
<a name="l441"><span class="linenum"> 441</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['ext_user_username'] = <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('username')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>;
<a name="l442"><span class="linenum"> 442</span></a>      }
<a name="l443"><span class="linenum"> 443</span></a>  
<a name="l444"><span class="linenum"> 444</span></a>      if (<a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a> || <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['sendemailaddr'] == <a class="constant" onClick="logConstant('LTI_SETTING_ALWAYS')" href="../../_constants/LTI_SETTING_ALWAYS.html" onMouseOver="constPopup(event,'LTI_SETTING_ALWAYS')">LTI_SETTING_ALWAYS</a> ||
<a name="l445"><span class="linenum"> 445</span></a>           (<a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['sendemailaddr'] == <a class="constant" onClick="logConstant('LTI_SETTING_DELEGATE')" href="../../_constants/LTI_SETTING_DELEGATE.html" onMouseOver="constPopup(event,'LTI_SETTING_DELEGATE')">LTI_SETTING_DELEGATE</a> &amp;&amp; <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('instructorchoicesendemailaddr')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/instructorchoicesendemailaddr.html">instructorchoicesendemailaddr</a> == <a class="constant" onClick="logConstant('LTI_SETTING_ALWAYS')" href="../../_constants/LTI_SETTING_ALWAYS.html" onMouseOver="constPopup(event,'LTI_SETTING_ALWAYS')">LTI_SETTING_ALWAYS</a>)) {
<a name="l446"><span class="linenum"> 446</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['lis_person_contact_email_primary'] = <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('email')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/email.html">email</a>;
<a name="l447"><span class="linenum"> 447</span></a>      }
<a name="l448"><span class="linenum"> 448</span></a>  
<a name="l449"><span class="linenum"> 449</span></a>      return <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>;
<a name="l450"><span class="linenum"> 450</span></a>  }
<a name="l451"><span class="linenum"> 451</span></a>  
<a name="l452"><span class="linenum"> 452</span></a>  <span class="comment">/**</span>
<a name="l453"><span class="linenum"> 453</span></a>  <span class="comment"> * This function builds the request that must be sent to an LTI 2 tool provider</span>
<a name="l454"><span class="linenum"> 454</span></a>  <span class="comment"> *</span>
<a name="l455"><span class="linenum"> 455</span></a>  <span class="comment"> * @param object    $tool           Basic LTI tool object</span>
<a name="l456"><span class="linenum"> 456</span></a>  <span class="comment"> * @param array     $params         Custom launch parameters</span>
<a name="l457"><span class="linenum"> 457</span></a>  <span class="comment"> *</span>
<a name="l458"><span class="linenum"> 458</span></a>  <span class="comment"> * @return array                    Request details</span>
<a name="l459"><span class="linenum"> 459</span></a>  <span class="comment"> */</span>
<a name="l460"><span class="linenum"> 460</span></a>  function <a class="function" onClick="logFunction('lti_build_request_lti2')" href="../../_functions/lti_build_request_lti2.html" onMouseOver="funcPopup(event,'lti_build_request_lti2')">lti_build_request_lti2</a>(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) {
<a name="l461"><span class="linenum"> 461</span></a>  
<a name="l462"><span class="linenum"> 462</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a> = array();
<a name="l463"><span class="linenum"> 463</span></a>  
<a name="l464"><span class="linenum"> 464</span></a>      <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('capabilities')" href="../../_variables/capabilities.html">$capabilities</a> = <a class="function" onClick="logFunction('lti_get_capabilities')" href="../../_functions/lti_get_capabilities.html" onMouseOver="funcPopup(event,'lti_get_capabilities')">lti_get_capabilities</a>();
<a name="l465"><span class="linenum"> 465</span></a>      <a class="var it8401" onMouseOver="hilite(8401)" onMouseOut="lolite()" onClick="logVariable('enabledcapabilities')" href="../../_variables/enabledcapabilities.html">$enabledcapabilities</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(&quot;\n&quot;, <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('enabledcapability')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/enabledcapability.html">enabledcapability</a>);
<a name="l466"><span class="linenum"> 466</span></a>      foreach (<a class="var it8401" onMouseOver="hilite(8401)" onMouseOut="lolite()" onClick="logVariable('enabledcapabilities')" href="../../_variables/enabledcapabilities.html">$enabledcapabilities</a> as <a class="var it787" onMouseOver="hilite(787)" onMouseOut="lolite()" onClick="logVariable('capability')" href="../../_variables/capability.html">$capability</a>) {
<a name="l467"><span class="linenum"> 467</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it787" onMouseOver="hilite(787)" onMouseOut="lolite()" onClick="logVariable('capability')" href="../../_variables/capability.html">$capability</a>, <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('capabilities')" href="../../_variables/capabilities.html">$capabilities</a>)) {
<a name="l468"><span class="linenum"> 468</span></a>              <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a> = <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('capabilities')" href="../../_variables/capabilities.html">$capabilities</a>[<a class="var it787" onMouseOver="hilite(787)" onMouseOut="lolite()" onClick="logVariable('capability')" href="../../_variables/capability.html">$capability</a>];
<a name="l469"><span class="linenum"> 469</span></a>              if (<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a> &amp;&amp; (<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>, 0, 1) != '$')) {
<a name="l470"><span class="linenum"> 470</span></a>                  if (isset(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>[<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>])) {
<a name="l471"><span class="linenum"> 471</span></a>                      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>[<a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('capabilities')" href="../../_variables/capabilities.html">$capabilities</a>[<a class="var it787" onMouseOver="hilite(787)" onMouseOut="lolite()" onClick="logVariable('capability')" href="../../_variables/capability.html">$capability</a>]] = <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>[<a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('capabilities')" href="../../_variables/capabilities.html">$capabilities</a>[<a class="var it787" onMouseOver="hilite(787)" onMouseOut="lolite()" onClick="logVariable('capability')" href="../../_variables/capability.html">$capability</a>]];
<a name="l472"><span class="linenum"> 472</span></a>                  }
<a name="l473"><span class="linenum"> 473</span></a>              }
<a name="l474"><span class="linenum"> 474</span></a>          }
<a name="l475"><span class="linenum"> 475</span></a>      }
<a name="l476"><span class="linenum"> 476</span></a>  
<a name="l477"><span class="linenum"> 477</span></a>      return <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>;
<a name="l478"><span class="linenum"> 478</span></a>  
<a name="l479"><span class="linenum"> 479</span></a>  }
<a name="l480"><span class="linenum"> 480</span></a>  
<a name="l481"><span class="linenum"> 481</span></a>  <span class="comment">/**</span>
<a name="l482"><span class="linenum"> 482</span></a>  <span class="comment"> * This function builds the standard parameters for an LTI 1 or 2 request that must be sent to the tool producer</span>
<a name="l483"><span class="linenum"> 483</span></a>  <span class="comment"> *</span>
<a name="l484"><span class="linenum"> 484</span></a>  <span class="comment"> * @param object    $instance       Basic LTI instance object</span>
<a name="l485"><span class="linenum"> 485</span></a>  <span class="comment"> * @param string    $orgid          Organisation ID</span>
<a name="l486"><span class="linenum"> 486</span></a>  <span class="comment"> * @param boolean   $islti2         True if an LTI 2 tool is being launched</span>
<a name="l487"><span class="linenum"> 487</span></a>  <span class="comment"> *</span>
<a name="l488"><span class="linenum"> 488</span></a>  <span class="comment"> * @return array                    Request details</span>
<a name="l489"><span class="linenum"> 489</span></a>  <span class="comment"> */</span>
<a name="l490"><span class="linenum"> 490</span></a>  function <a class="function" onClick="logFunction('lti_build_standard_request')" href="../../_functions/lti_build_standard_request.html" onMouseOver="funcPopup(event,'lti_build_standard_request')">lti_build_standard_request</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>, <a class="var it25180" onMouseOver="hilite(25180)" onMouseOut="lolite()" onClick="logVariable('orgid')" href="../../_variables/orgid.html">$orgid</a>, <a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a>) {
<a name="l491"><span class="linenum"> 491</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l492"><span class="linenum"> 492</span></a>  
<a name="l493"><span class="linenum"> 493</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a> = array();
<a name="l494"><span class="linenum"> 494</span></a>  
<a name="l495"><span class="linenum"> 495</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['resource_link_id'] = <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('id')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l496"><span class="linenum"> 496</span></a>      if (property_exists(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>, 'resource_link_id') and !empty(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('resource_link_id')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/resource_link_id.html">resource_link_id</a>)) {
<a name="l497"><span class="linenum"> 497</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['resource_link_id'] = <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('resource_link_id')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/resource_link_id.html">resource_link_id</a>;
<a name="l498"><span class="linenum"> 498</span></a>      }
<a name="l499"><span class="linenum"> 499</span></a>  
<a name="l500"><span class="linenum"> 500</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['launch_presentation_locale'] = <a class="function" onClick="logFunction('current_language')" href="../../_functions/current_language.html" onMouseOver="funcPopup(event,'current_language')">current_language</a>();
<a name="l501"><span class="linenum"> 501</span></a>  
<a name="l502"><span class="linenum"> 502</span></a>  <span class="comment">    // Make sure we let the tool know what LMS they are being called from.</span>
<a name="l503"><span class="linenum"> 503</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['ext_lms'] = 'moodle-2';
<a name="l504"><span class="linenum"> 504</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['tool_consumer_info_product_family_code'] = 'moodle';
<a name="l505"><span class="linenum"> 505</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['tool_consumer_info_version'] = <a class="phpfunction" onClick="logFunction('strval')" href="../../_functions/strval.html" onMouseOver="phpfuncPopup(event,'strval')">strval</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('version')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/version.html">version</a>);
<a name="l506"><span class="linenum"> 506</span></a>  
<a name="l507"><span class="linenum"> 507</span></a>  <span class="comment">    // Add oauth_callback to be compliant with the 1.0A spec.</span>
<a name="l508"><span class="linenum"> 508</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['oauth_callback'] = 'about:blank';
<a name="l509"><span class="linenum"> 509</span></a>  
<a name="l510"><span class="linenum"> 510</span></a>      if (!<a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a>) {
<a name="l511"><span class="linenum"> 511</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['lti_version'] = 'LTI-1p0';
<a name="l512"><span class="linenum"> 512</span></a>      } else {
<a name="l513"><span class="linenum"> 513</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['lti_version'] = 'LTI-2p0';
<a name="l514"><span class="linenum"> 514</span></a>      }
<a name="l515"><span class="linenum"> 515</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['lti_message_type'] = 'basic-lti-launch-request';
<a name="l516"><span class="linenum"> 516</span></a>  
<a name="l517"><span class="linenum"> 517</span></a>      if (<a class="var it25180" onMouseOver="hilite(25180)" onMouseOut="lolite()" onClick="logVariable('orgid')" href="../../_variables/orgid.html">$orgid</a>) {
<a name="l518"><span class="linenum"> 518</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>[&quot;tool_consumer_instance_guid&quot;] = <a class="var it25180" onMouseOver="hilite(25180)" onMouseOut="lolite()" onClick="logVariable('orgid')" href="../../_variables/orgid.html">$orgid</a>;
<a name="l519"><span class="linenum"> 519</span></a>      }
<a name="l520"><span class="linenum"> 520</span></a>      if (!empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mod_lti_institution_name')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/mod_lti_institution_name.html">mod_lti_institution_name</a>)) {
<a name="l521"><span class="linenum"> 521</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['tool_consumer_instance_name'] = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mod_lti_institution_name')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/mod_lti_institution_name.html">mod_lti_institution_name</a>;
<a name="l522"><span class="linenum"> 522</span></a>      } else {
<a name="l523"><span class="linenum"> 523</span></a>          <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['tool_consumer_instance_name'] = <a class="function" onClick="logFunction('get_site')" href="../../_functions/get_site.html" onMouseOver="funcPopup(event,'get_site')">get_site</a>()-&gt;shortname;
<a name="l524"><span class="linenum"> 524</span></a>      }
<a name="l525"><span class="linenum"> 525</span></a>      <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>['tool_consumer_instance_description'] = <a class="function" onClick="logFunction('get_site')" href="../../_functions/get_site.html" onMouseOver="funcPopup(event,'get_site')">get_site</a>()-&gt;fullname;
<a name="l526"><span class="linenum"> 526</span></a>  
<a name="l527"><span class="linenum"> 527</span></a>      return <a class="var it35738" onMouseOver="hilite(35738)" onMouseOut="lolite()" onClick="logVariable('requestparams')" href="../../_variables/requestparams.html">$requestparams</a>;
<a name="l528"><span class="linenum"> 528</span></a>  }
<a name="l529"><span class="linenum"> 529</span></a>  
<a name="l530"><span class="linenum"> 530</span></a>  <span class="comment">/**</span>
<a name="l531"><span class="linenum"> 531</span></a>  <span class="comment"> * This function builds the custom parameters</span>
<a name="l532"><span class="linenum"> 532</span></a>  <span class="comment"> *</span>
<a name="l533"><span class="linenum"> 533</span></a>  <span class="comment"> * @param object    $toolproxy      Tool proxy instance object</span>
<a name="l534"><span class="linenum"> 534</span></a>  <span class="comment"> * @param object    $tool           Tool instance object</span>
<a name="l535"><span class="linenum"> 535</span></a>  <span class="comment"> * @param object    $instance       Tool placement instance object</span>
<a name="l536"><span class="linenum"> 536</span></a>  <span class="comment"> * @param array     $params         LTI launch parameters</span>
<a name="l537"><span class="linenum"> 537</span></a>  <span class="comment"> * @param string    $customstr      Custom parameters defined for tool</span>
<a name="l538"><span class="linenum"> 538</span></a>  <span class="comment"> * @param string    $instructorcustomstr      Custom parameters defined for this placement</span>
<a name="l539"><span class="linenum"> 539</span></a>  <span class="comment"> * @param boolean   $islti2         True if an LTI 2 tool is being launched</span>
<a name="l540"><span class="linenum"> 540</span></a>  <span class="comment"> *</span>
<a name="l541"><span class="linenum"> 541</span></a>  <span class="comment"> * @return array                    Custom parameters</span>
<a name="l542"><span class="linenum"> 542</span></a>  <span class="comment"> */</span>
<a name="l543"><span class="linenum"> 543</span></a>  function <a class="function" onClick="logFunction('lti_build_custom_parameters')" href="../../_functions/lti_build_custom_parameters.html" onMouseOver="funcPopup(event,'lti_build_custom_parameters')">lti_build_custom_parameters</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>, <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>, <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it35739" onMouseOver="hilite(35739)" onMouseOut="lolite()" onClick="logVariable('customstr')" href="../../_variables/customstr.html">$customstr</a>, <a class="var it35748" onMouseOver="hilite(35748)" onMouseOut="lolite()" onClick="logVariable('instructorcustomstr')" href="../../_variables/instructorcustomstr.html">$instructorcustomstr</a>, <a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a>) {
<a name="l544"><span class="linenum"> 544</span></a>  
<a name="l545"><span class="linenum"> 545</span></a>  <span class="comment">    // Concatenate the custom parameters from the administrator and the instructor</span>
<a name="l546"><span class="linenum"> 546</span></a>  <span class="comment">    // Instructor parameters are only taken into consideration if the administrator</span>
<a name="l547"><span class="linenum"> 547</span></a>  <span class="comment">    // has given permission.</span>
<a name="l548"><span class="linenum"> 548</span></a>      <a class="var it1271" onMouseOver="hilite(1271)" onMouseOut="lolite()" onClick="logVariable('custom')" href="../../_variables/custom.html">$custom</a> = array();
<a name="l549"><span class="linenum"> 549</span></a>      if (<a class="var it35739" onMouseOver="hilite(35739)" onMouseOut="lolite()" onClick="logVariable('customstr')" href="../../_variables/customstr.html">$customstr</a>) {
<a name="l550"><span class="linenum"> 550</span></a>          <a class="var it1271" onMouseOver="hilite(1271)" onMouseOut="lolite()" onClick="logVariable('custom')" href="../../_variables/custom.html">$custom</a> = <a class="function" onClick="logFunction('lti_split_custom_parameters')" href="../../_functions/lti_split_custom_parameters.html" onMouseOver="funcPopup(event,'lti_split_custom_parameters')">lti_split_custom_parameters</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>, <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it35739" onMouseOver="hilite(35739)" onMouseOut="lolite()" onClick="logVariable('customstr')" href="../../_variables/customstr.html">$customstr</a>, <a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a>);
<a name="l551"><span class="linenum"> 551</span></a>      }
<a name="l552"><span class="linenum"> 552</span></a>      if (!isset(<a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['allowinstructorcustom']) || <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>['allowinstructorcustom'] != <a class="constant" onClick="logConstant('LTI_SETTING_NEVER')" href="../../_constants/LTI_SETTING_NEVER.html" onMouseOver="constPopup(event,'LTI_SETTING_NEVER')">LTI_SETTING_NEVER</a>) {
<a name="l553"><span class="linenum"> 553</span></a>          if (<a class="var it35748" onMouseOver="hilite(35748)" onMouseOut="lolite()" onClick="logVariable('instructorcustomstr')" href="../../_variables/instructorcustomstr.html">$instructorcustomstr</a>) {
<a name="l554"><span class="linenum"> 554</span></a>              <a class="var it1271" onMouseOver="hilite(1271)" onMouseOut="lolite()" onClick="logVariable('custom')" href="../../_variables/custom.html">$custom</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="function" onClick="logFunction('lti_split_custom_parameters')" href="../../_functions/lti_split_custom_parameters.html" onMouseOver="funcPopup(event,'lti_split_custom_parameters')">lti_split_custom_parameters</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>, <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>,
<a name="l555"><span class="linenum"> 555</span></a>                  <a class="var it35748" onMouseOver="hilite(35748)" onMouseOut="lolite()" onClick="logVariable('instructorcustomstr')" href="../../_variables/instructorcustomstr.html">$instructorcustomstr</a>, <a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a>), <a class="var it1271" onMouseOver="hilite(1271)" onMouseOut="lolite()" onClick="logVariable('custom')" href="../../_variables/custom.html">$custom</a>);
<a name="l556"><span class="linenum"> 556</span></a>          }
<a name="l557"><span class="linenum"> 557</span></a>      }
<a name="l558"><span class="linenum"> 558</span></a>      if (<a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a>) {
<a name="l559"><span class="linenum"> 559</span></a>          <a class="var it1271" onMouseOver="hilite(1271)" onMouseOut="lolite()" onClick="logVariable('custom')" href="../../_variables/custom.html">$custom</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="function" onClick="logFunction('lti_split_custom_parameters')" href="../../_functions/lti_split_custom_parameters.html" onMouseOver="funcPopup(event,'lti_split_custom_parameters')">lti_split_custom_parameters</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>, <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>,
<a name="l560"><span class="linenum"> 560</span></a>              <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('parameter')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/parameter.html">parameter</a>, true), <a class="var it1271" onMouseOver="hilite(1271)" onMouseOut="lolite()" onClick="logVariable('custom')" href="../../_variables/custom.html">$custom</a>);
<a name="l561"><span class="linenum"> 561</span></a>          <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('settings')" href="../../_variables/settings.html">$settings</a> = <a class="function" onClick="logFunction('lti_get_tool_settings')" href="../../_functions/lti_get_tool_settings.html" onMouseOver="funcPopup(event,'lti_get_tool_settings')">lti_get_tool_settings</a>(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('toolproxyid')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/toolproxyid.html">toolproxyid</a>);
<a name="l562"><span class="linenum"> 562</span></a>          <a class="var it1271" onMouseOver="hilite(1271)" onMouseOut="lolite()" onClick="logVariable('custom')" href="../../_variables/custom.html">$custom</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it1271" onMouseOver="hilite(1271)" onMouseOut="lolite()" onClick="logVariable('custom')" href="../../_variables/custom.html">$custom</a>, <a class="function" onClick="logFunction('lti_get_custom_parameters')" href="../../_functions/lti_get_custom_parameters.html" onMouseOver="funcPopup(event,'lti_get_custom_parameters')">lti_get_custom_parameters</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>, <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('settings')" href="../../_variables/settings.html">$settings</a>));
<a name="l563"><span class="linenum"> 563</span></a>          <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('settings')" href="../../_variables/settings.html">$settings</a> = <a class="function" onClick="logFunction('lti_get_tool_settings')" href="../../_functions/lti_get_tool_settings.html" onMouseOver="funcPopup(event,'lti_get_tool_settings')">lti_get_tool_settings</a>(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('toolproxyid')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/toolproxyid.html">toolproxyid</a>, <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('course')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>);
<a name="l564"><span class="linenum"> 564</span></a>          <a class="var it1271" onMouseOver="hilite(1271)" onMouseOut="lolite()" onClick="logVariable('custom')" href="../../_variables/custom.html">$custom</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it1271" onMouseOver="hilite(1271)" onMouseOut="lolite()" onClick="logVariable('custom')" href="../../_variables/custom.html">$custom</a>, <a class="function" onClick="logFunction('lti_get_custom_parameters')" href="../../_functions/lti_get_custom_parameters.html" onMouseOver="funcPopup(event,'lti_get_custom_parameters')">lti_get_custom_parameters</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>, <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('settings')" href="../../_variables/settings.html">$settings</a>));
<a name="l565"><span class="linenum"> 565</span></a>          <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('settings')" href="../../_variables/settings.html">$settings</a> = <a class="function" onClick="logFunction('lti_get_tool_settings')" href="../../_functions/lti_get_tool_settings.html" onMouseOver="funcPopup(event,'lti_get_tool_settings')">lti_get_tool_settings</a>(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('toolproxyid')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/toolproxyid.html">toolproxyid</a>, <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('course')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>, <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('id')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l566"><span class="linenum"> 566</span></a>          <a class="var it1271" onMouseOver="hilite(1271)" onMouseOut="lolite()" onClick="logVariable('custom')" href="../../_variables/custom.html">$custom</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it1271" onMouseOver="hilite(1271)" onMouseOut="lolite()" onClick="logVariable('custom')" href="../../_variables/custom.html">$custom</a>, <a class="function" onClick="logFunction('lti_get_custom_parameters')" href="../../_functions/lti_get_custom_parameters.html" onMouseOver="funcPopup(event,'lti_get_custom_parameters')">lti_get_custom_parameters</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>, <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('settings')" href="../../_variables/settings.html">$settings</a>));
<a name="l567"><span class="linenum"> 567</span></a>      }
<a name="l568"><span class="linenum"> 568</span></a>  
<a name="l569"><span class="linenum"> 569</span></a>      return <a class="var it1271" onMouseOver="hilite(1271)" onMouseOut="lolite()" onClick="logVariable('custom')" href="../../_variables/custom.html">$custom</a>;
<a name="l570"><span class="linenum"> 570</span></a>  }
<a name="l571"><span class="linenum"> 571</span></a>  
<a name="l572"><span class="linenum"> 572</span></a>  function <a class="function" onClick="logFunction('lti_get_tool_table')" href="../../_functions/lti_get_tool_table.html" onMouseOver="funcPopup(event,'lti_get_tool_table')">lti_get_tool_table</a>(<a class="var it24702" onMouseOver="hilite(24702)" onMouseOut="lolite()" onClick="logVariable('tools')" href="../../_variables/tools.html">$tools</a>, <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>) {
<a name="l573"><span class="linenum"> 573</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>;
<a name="l574"><span class="linenum"> 574</span></a>      <a class="var it475" onMouseOver="hilite(475)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../_variables/html.html">$html</a> = '';
<a name="l575"><span class="linenum"> 575</span></a>  
<a name="l576"><span class="linenum"> 576</span></a>      <a class="var it21376" onMouseOver="hilite(21376)" onMouseOut="lolite()" onClick="logVariable('typename')" href="../../_variables/typename.html">$typename</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('typename', 'lti');
<a name="l577"><span class="linenum"> 577</span></a>      <a class="var it424" onMouseOver="hilite(424)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('baseurl', 'lti');
<a name="l578"><span class="linenum"> 578</span></a>      <a class="var it280" onMouseOver="hilite(280)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('action', 'lti');
<a name="l579"><span class="linenum"> 579</span></a>      <a class="var it35749" onMouseOver="hilite(35749)" onMouseOut="lolite()" onClick="logVariable('createdon')" href="../../_variables/createdon.html">$createdon</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('createdon', 'lti');
<a name="l580"><span class="linenum"> 580</span></a>  
<a name="l581"><span class="linenum"> 581</span></a>      if (!empty(<a class="var it24702" onMouseOver="hilite(24702)" onMouseOut="lolite()" onClick="logVariable('tools')" href="../../_variables/tools.html">$tools</a>)) {
<a name="l582"><span class="linenum"> 582</span></a>          <a class="var it475" onMouseOver="hilite(475)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../_variables/html.html">$html</a> .= &quot;
<a name="l583"><span class="linenum"> 583</span></a>          &lt;div id=\&quot;{<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>}_tools_container\&quot; style=\&quot;margin-top:.5em;margin-bottom:.5em\&quot;&gt;
<a name="l584"><span class="linenum"> 584</span></a>              &lt;table id=\&quot;{<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>}_tools\&quot;&gt;
<a name="l585"><span class="linenum"> 585</span></a>                  &lt;thead&gt;
<a name="l586"><span class="linenum"> 586</span></a>                      &lt;tr&gt;
<a name="l587"><span class="linenum"> 587</span></a>                          &lt;th&gt;<a class="var it21376" onMouseOver="hilite(21376)" onMouseOut="lolite()" onClick="logVariable('typename')" href="../../_variables/typename.html">$typename</a>&lt;/th&gt;
<a name="l588"><span class="linenum"> 588</span></a>                          &lt;th&gt;<a class="var it424" onMouseOver="hilite(424)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a>&lt;/th&gt;
<a name="l589"><span class="linenum"> 589</span></a>                          &lt;th&gt;<a class="var it35749" onMouseOver="hilite(35749)" onMouseOut="lolite()" onClick="logVariable('createdon')" href="../../_variables/createdon.html">$createdon</a>&lt;/th&gt;
<a name="l590"><span class="linenum"> 590</span></a>                          &lt;th&gt;<a class="var it280" onMouseOver="hilite(280)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a>&lt;/th&gt;
<a name="l591"><span class="linenum"> 591</span></a>                      &lt;/tr&gt;
<a name="l592"><span class="linenum"> 592</span></a>                  &lt;/thead&gt;
<a name="l593"><span class="linenum"> 593</span></a>          &quot;;
<a name="l594"><span class="linenum"> 594</span></a>  
<a name="l595"><span class="linenum"> 595</span></a>          foreach (<a class="var it24702" onMouseOver="hilite(24702)" onMouseOut="lolite()" onClick="logVariable('tools')" href="../../_variables/tools.html">$tools</a> as <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>) {
<a name="l596"><span class="linenum"> 596</span></a>              <a class="var it1098" onMouseOver="hilite(1098)" onMouseOut="lolite()" onClick="logVariable('date')" href="../../_variables/date.html">$date</a> = <a class="function" onClick="logFunction('userdate')" href="../../_functions/userdate.html" onMouseOver="funcPopup(event,'userdate')">userdate</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('timecreated')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a>, <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('strftimedatefullshort', 'core_langconfig'));
<a name="l597"><span class="linenum"> 597</span></a>              <a class="var it8836" onMouseOver="hilite(8836)" onMouseOut="lolite()" onClick="logVariable('accept')" href="../../_variables/accept.html">$accept</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('accept', 'lti');
<a name="l598"><span class="linenum"> 598</span></a>              <a class="var it2088" onMouseOver="hilite(2088)" onMouseOut="lolite()" onClick="logVariable('update')" href="../../_variables/update.html">$update</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('update', 'lti');
<a name="l599"><span class="linenum"> 599</span></a>              <a class="var it420" onMouseOver="hilite(420)" onMouseOut="lolite()" onClick="logVariable('delete')" href="../../_variables/delete.html">$delete</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('delete', 'lti');
<a name="l600"><span class="linenum"> 600</span></a>  
<a name="l601"><span class="linenum"> 601</span></a>              if (empty(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('toolproxyid')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/toolproxyid.html">toolproxyid</a>)) {
<a name="l602"><span class="linenum"> 602</span></a>                  <a class="var it424" onMouseOver="hilite(424)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a> = new \moodle_url('<a class="filename" href="../../mod/lti/typessettings.php.html">/mod/lti/typessettings.php</a>', array(
<a name="l603"><span class="linenum"> 603</span></a>                          'action' =&gt; 'accept',
<a name="l604"><span class="linenum"> 604</span></a>                          'id' =&gt; <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('id')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l605"><span class="linenum"> 605</span></a>                          'sesskey' =&gt; <a class="function" onClick="logFunction('sesskey')" href="../../_functions/sesskey.html" onMouseOver="funcPopup(event,'sesskey')">sesskey</a>(),
<a name="l606"><span class="linenum"> 606</span></a>                          'tab' =&gt; <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>
<a name="l607"><span class="linenum"> 607</span></a>                      ));
<a name="l608"><span class="linenum"> 608</span></a>                  <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('ref')" href="../../_variables/ref.html">$ref</a> = <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('baseurl')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/baseurl.html">baseurl</a>;
<a name="l609"><span class="linenum"> 609</span></a>              } else {
<a name="l610"><span class="linenum"> 610</span></a>                  <a class="var it424" onMouseOver="hilite(424)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a> = new \moodle_url('<a class="filename" href="../../mod/lti/toolssettings.php.html">/mod/lti/toolssettings.php</a>', array(
<a name="l611"><span class="linenum"> 611</span></a>                          'action' =&gt; 'accept',
<a name="l612"><span class="linenum"> 612</span></a>                          'id' =&gt; <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('id')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l613"><span class="linenum"> 613</span></a>                          'sesskey' =&gt; <a class="function" onClick="logFunction('sesskey')" href="../../_functions/sesskey.html" onMouseOver="funcPopup(event,'sesskey')">sesskey</a>(),
<a name="l614"><span class="linenum"> 614</span></a>                          'tab' =&gt; <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>
<a name="l615"><span class="linenum"> 615</span></a>                      ));
<a name="l616"><span class="linenum"> 616</span></a>                  <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('ref')" href="../../_variables/ref.html">$ref</a> = <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('tpname')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/tpname.html">tpname</a>;
<a name="l617"><span class="linenum"> 617</span></a>              }
<a name="l618"><span class="linenum"> 618</span></a>  
<a name="l619"><span class="linenum"> 619</span></a>              <a class="var it35751" onMouseOver="hilite(35751)" onMouseOut="lolite()" onClick="logVariable('accepthtml')" href="../../_variables/accepthtml.html">$accepthtml</a> = <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('action_icon')" href="../../_functions/action_icon.html" onMouseOver="funcPopup(event,'action_icon')">action_icon</a>(<a class="var it424" onMouseOver="hilite(424)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a>,
<a name="l620"><span class="linenum"> 620</span></a>                      new \<a class="function" onClick="logFunction('pix_icon')" href="../../_functions/pix_icon.html" onMouseOver="funcPopup(event,'pix_icon')">pix_icon</a>('t/check', <a class="var it8836" onMouseOver="hilite(8836)" onMouseOut="lolite()" onClick="logVariable('accept')" href="../../_variables/accept.html">$accept</a>, '', array('class' =&gt; 'iconsmall')), null,
<a name="l621"><span class="linenum"> 621</span></a>                      array('title' =&gt; <a class="var it8836" onMouseOver="hilite(8836)" onMouseOut="lolite()" onClick="logVariable('accept')" href="../../_variables/accept.html">$accept</a>, 'class' =&gt; 'editing_accept'));
<a name="l622"><span class="linenum"> 622</span></a>  
<a name="l623"><span class="linenum"> 623</span></a>              <a class="var it12977" onMouseOver="hilite(12977)" onMouseOut="lolite()" onClick="logVariable('deleteaction')" href="../../_variables/deleteaction.html">$deleteaction</a> = 'delete';
<a name="l624"><span class="linenum"> 624</span></a>  
<a name="l625"><span class="linenum"> 625</span></a>              if (<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('state')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> == <a class="constant" onClick="logConstant('LTI_TOOL_STATE_CONFIGURED')" href="../../_constants/LTI_TOOL_STATE_CONFIGURED.html" onMouseOver="constPopup(event,'LTI_TOOL_STATE_CONFIGURED')">LTI_TOOL_STATE_CONFIGURED</a>) {
<a name="l626"><span class="linenum"> 626</span></a>                  <a class="var it35751" onMouseOver="hilite(35751)" onMouseOut="lolite()" onClick="logVariable('accepthtml')" href="../../_variables/accepthtml.html">$accepthtml</a> = '';
<a name="l627"><span class="linenum"> 627</span></a>              }
<a name="l628"><span class="linenum"> 628</span></a>  
<a name="l629"><span class="linenum"> 629</span></a>              if (<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('state')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> != <a class="constant" onClick="logConstant('LTI_TOOL_STATE_REJECTED')" href="../../_constants/LTI_TOOL_STATE_REJECTED.html" onMouseOver="constPopup(event,'LTI_TOOL_STATE_REJECTED')">LTI_TOOL_STATE_REJECTED</a>) {
<a name="l630"><span class="linenum"> 630</span></a>                  <a class="var it12977" onMouseOver="hilite(12977)" onMouseOut="lolite()" onClick="logVariable('deleteaction')" href="../../_variables/deleteaction.html">$deleteaction</a> = 'reject';
<a name="l631"><span class="linenum"> 631</span></a>                  <a class="var it420" onMouseOver="hilite(420)" onMouseOut="lolite()" onClick="logVariable('delete')" href="../../_variables/delete.html">$delete</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('reject', 'lti');
<a name="l632"><span class="linenum"> 632</span></a>              }
<a name="l633"><span class="linenum"> 633</span></a>  
<a name="l634"><span class="linenum"> 634</span></a>              <a class="var it5241" onMouseOver="hilite(5241)" onMouseOut="lolite()" onClick="logVariable('updateurl')" href="../../_variables/updateurl.html">$updateurl</a> = <a class="function" onClick="logFunction('clone')" href="../../_functions/clone.html" onMouseOver="funcPopup(event,'clone')">clone</a>(<a class="var it424" onMouseOver="hilite(424)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a>);
<a name="l635"><span class="linenum"> 635</span></a>              <a class="var it5241" onMouseOver="hilite(5241)" onMouseOut="lolite()" onClick="logVariable('updateurl')" href="../../_variables/updateurl.html">$updateurl</a>-&gt;<a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>('action', 'update');
<a name="l636"><span class="linenum"> 636</span></a>              <a class="var it35752" onMouseOver="hilite(35752)" onMouseOut="lolite()" onClick="logVariable('updatehtml')" href="../../_variables/updatehtml.html">$updatehtml</a> = <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('action_icon')" href="../../_functions/action_icon.html" onMouseOver="funcPopup(event,'action_icon')">action_icon</a>(<a class="var it5241" onMouseOver="hilite(5241)" onMouseOut="lolite()" onClick="logVariable('updateurl')" href="../../_variables/updateurl.html">$updateurl</a>,
<a name="l637"><span class="linenum"> 637</span></a>                      new \<a class="function" onClick="logFunction('pix_icon')" href="../../_functions/pix_icon.html" onMouseOver="funcPopup(event,'pix_icon')">pix_icon</a>('t/edit', <a class="var it2088" onMouseOver="hilite(2088)" onMouseOut="lolite()" onClick="logVariable('update')" href="../../_variables/update.html">$update</a>, '', array('class' =&gt; 'iconsmall')), null,
<a name="l638"><span class="linenum"> 638</span></a>                      array('title' =&gt; <a class="var it2088" onMouseOver="hilite(2088)" onMouseOut="lolite()" onClick="logVariable('update')" href="../../_variables/update.html">$update</a>, 'class' =&gt; 'editing_update'));
<a name="l639"><span class="linenum"> 639</span></a>  
<a name="l640"><span class="linenum"> 640</span></a>              if ((<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('state')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> != <a class="constant" onClick="logConstant('LTI_TOOL_STATE_REJECTED')" href="../../_constants/LTI_TOOL_STATE_REJECTED.html" onMouseOver="constPopup(event,'LTI_TOOL_STATE_REJECTED')">LTI_TOOL_STATE_REJECTED</a>) || empty(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('toolproxyid')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/toolproxyid.html">toolproxyid</a>)) {
<a name="l641"><span class="linenum"> 641</span></a>                  <a class="var it10029" onMouseOver="hilite(10029)" onMouseOut="lolite()" onClick="logVariable('deleteurl')" href="../../_variables/deleteurl.html">$deleteurl</a> = <a class="function" onClick="logFunction('clone')" href="../../_functions/clone.html" onMouseOver="funcPopup(event,'clone')">clone</a>(<a class="var it424" onMouseOver="hilite(424)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a>);
<a name="l642"><span class="linenum"> 642</span></a>                  <a class="var it10029" onMouseOver="hilite(10029)" onMouseOut="lolite()" onClick="logVariable('deleteurl')" href="../../_variables/deleteurl.html">$deleteurl</a>-&gt;<a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>('action', <a class="var it12977" onMouseOver="hilite(12977)" onMouseOut="lolite()" onClick="logVariable('deleteaction')" href="../../_variables/deleteaction.html">$deleteaction</a>);
<a name="l643"><span class="linenum"> 643</span></a>                  <a class="var it35753" onMouseOver="hilite(35753)" onMouseOut="lolite()" onClick="logVariable('deletehtml')" href="../../_variables/deletehtml.html">$deletehtml</a> = <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('action_icon')" href="../../_functions/action_icon.html" onMouseOver="funcPopup(event,'action_icon')">action_icon</a>(<a class="var it10029" onMouseOver="hilite(10029)" onMouseOut="lolite()" onClick="logVariable('deleteurl')" href="../../_variables/deleteurl.html">$deleteurl</a>,
<a name="l644"><span class="linenum"> 644</span></a>                          new \<a class="function" onClick="logFunction('pix_icon')" href="../../_functions/pix_icon.html" onMouseOver="funcPopup(event,'pix_icon')">pix_icon</a>('t/delete', <a class="var it420" onMouseOver="hilite(420)" onMouseOut="lolite()" onClick="logVariable('delete')" href="../../_variables/delete.html">$delete</a>, '', array('class' =&gt; 'iconsmall')), null,
<a name="l645"><span class="linenum"> 645</span></a>                          array('title' =&gt; <a class="var it420" onMouseOver="hilite(420)" onMouseOut="lolite()" onClick="logVariable('delete')" href="../../_variables/delete.html">$delete</a>, 'class' =&gt; 'editing_delete'));
<a name="l646"><span class="linenum"> 646</span></a>              } else {
<a name="l647"><span class="linenum"> 647</span></a>                  <a class="var it35753" onMouseOver="hilite(35753)" onMouseOut="lolite()" onClick="logVariable('deletehtml')" href="../../_variables/deletehtml.html">$deletehtml</a> = '';
<a name="l648"><span class="linenum"> 648</span></a>              }
<a name="l649"><span class="linenum"> 649</span></a>              <a class="var it475" onMouseOver="hilite(475)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../_variables/html.html">$html</a> .= &quot;
<a name="l650"><span class="linenum"> 650</span></a>              &lt;tr&gt;
<a name="l651"><span class="linenum"> 651</span></a>                  &lt;td&gt;
<a name="l652"><span class="linenum"> 652</span></a>                      {<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('name')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>}
<a name="l653"><span class="linenum"> 653</span></a>                  &lt;/td&gt;
<a name="l654"><span class="linenum"> 654</span></a>                  &lt;td&gt;
<a name="l655"><span class="linenum"> 655</span></a>                      {<a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('ref')" href="../../_variables/ref.html">$ref</a>}
<a name="l656"><span class="linenum"> 656</span></a>                  &lt;/td&gt;
<a name="l657"><span class="linenum"> 657</span></a>                  &lt;td&gt;
<a name="l658"><span class="linenum"> 658</span></a>                      {<a class="var it1098" onMouseOver="hilite(1098)" onMouseOut="lolite()" onClick="logVariable('date')" href="../../_variables/date.html">$date</a>}
<a name="l659"><span class="linenum"> 659</span></a>                  &lt;/td&gt;
<a name="l660"><span class="linenum"> 660</span></a>                  &lt;td align=\&quot;center\&quot;&gt;
<a name="l661"><span class="linenum"> 661</span></a>                      {<a class="var it35751" onMouseOver="hilite(35751)" onMouseOut="lolite()" onClick="logVariable('accepthtml')" href="../../_variables/accepthtml.html">$accepthtml</a>}{<a class="var it35752" onMouseOver="hilite(35752)" onMouseOut="lolite()" onClick="logVariable('updatehtml')" href="../../_variables/updatehtml.html">$updatehtml</a>}{<a class="var it35753" onMouseOver="hilite(35753)" onMouseOut="lolite()" onClick="logVariable('deletehtml')" href="../../_variables/deletehtml.html">$deletehtml</a>}
<a name="l662"><span class="linenum"> 662</span></a>                  &lt;/td&gt;
<a name="l663"><span class="linenum"> 663</span></a>              &lt;/tr&gt;
<a name="l664"><span class="linenum"> 664</span></a>              &quot;;
<a name="l665"><span class="linenum"> 665</span></a>          }
<a name="l666"><span class="linenum"> 666</span></a>          <a class="var it475" onMouseOver="hilite(475)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../_variables/html.html">$html</a> .= '&lt;/table&gt;&lt;/div&gt;';
<a name="l667"><span class="linenum"> 667</span></a>      } else {
<a name="l668"><span class="linenum"> 668</span></a>          <a class="var it475" onMouseOver="hilite(475)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../_variables/html.html">$html</a> .= <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('no_' . <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>, 'lti');
<a name="l669"><span class="linenum"> 669</span></a>      }
<a name="l670"><span class="linenum"> 670</span></a>  
<a name="l671"><span class="linenum"> 671</span></a>      return <a class="var it475" onMouseOver="hilite(475)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../_variables/html.html">$html</a>;
<a name="l672"><span class="linenum"> 672</span></a>  }
<a name="l673"><span class="linenum"> 673</span></a>  
<a name="l674"><span class="linenum"> 674</span></a>  <span class="comment">/**</span>
<a name="l675"><span class="linenum"> 675</span></a>  <span class="comment"> * This function builds the tab for a category of tool proxies</span>
<a name="l676"><span class="linenum"> 676</span></a>  <span class="comment"> *</span>
<a name="l677"><span class="linenum"> 677</span></a>  <span class="comment"> * @param object    $toolproxies    Tool proxy instance objects</span>
<a name="l678"><span class="linenum"> 678</span></a>  <span class="comment"> * @param string    $id             Category ID</span>
<a name="l679"><span class="linenum"> 679</span></a>  <span class="comment"> *</span>
<a name="l680"><span class="linenum"> 680</span></a>  <span class="comment"> * @return string                   HTML for tab</span>
<a name="l681"><span class="linenum"> 681</span></a>  <span class="comment"> */</span>
<a name="l682"><span class="linenum"> 682</span></a>  function <a class="function" onClick="logFunction('lti_get_tool_proxy_table')" href="../../_functions/lti_get_tool_proxy_table.html" onMouseOver="funcPopup(event,'lti_get_tool_proxy_table')">lti_get_tool_proxy_table</a>(<a class="var it8395" onMouseOver="hilite(8395)" onMouseOut="lolite()" onClick="logVariable('toolproxies')" href="../../_variables/toolproxies.html">$toolproxies</a>, <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>) {
<a name="l683"><span class="linenum"> 683</span></a>      global <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>;
<a name="l684"><span class="linenum"> 684</span></a>  
<a name="l685"><span class="linenum"> 685</span></a>      if (!empty(<a class="var it8395" onMouseOver="hilite(8395)" onMouseOut="lolite()" onClick="logVariable('toolproxies')" href="../../_variables/toolproxies.html">$toolproxies</a>)) {
<a name="l686"><span class="linenum"> 686</span></a>          <a class="var it21376" onMouseOver="hilite(21376)" onMouseOut="lolite()" onClick="logVariable('typename')" href="../../_variables/typename.html">$typename</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('typename', 'lti');
<a name="l687"><span class="linenum"> 687</span></a>          <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('registrationurl', 'lti');
<a name="l688"><span class="linenum"> 688</span></a>          <a class="var it280" onMouseOver="hilite(280)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('action', 'lti');
<a name="l689"><span class="linenum"> 689</span></a>          <a class="var it35749" onMouseOver="hilite(35749)" onMouseOut="lolite()" onClick="logVariable('createdon')" href="../../_variables/createdon.html">$createdon</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('createdon', 'lti');
<a name="l690"><span class="linenum"> 690</span></a>  
<a name="l691"><span class="linenum"> 691</span></a>          <a class="var it475" onMouseOver="hilite(475)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../_variables/html.html">$html</a> = &lt;&lt;&lt; EOD
<a name="l692"><span class="linenum"> 692</span></a>          &lt;div id=&quot;{<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>}_tool_proxies_container&quot; style=&quot;margin-top: 0.5em; margin-bottom: 0.5em&quot;&gt;
<a name="l693"><span class="linenum"> 693</span></a>              &lt;table id=&quot;{<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>}_tool_proxies&quot;&gt;
<a name="l694"><span class="linenum"> 694</span></a>                  &lt;thead&gt;
<a name="l695"><span class="linenum"> 695</span></a>                      &lt;tr&gt;
<a name="l696"><span class="linenum"> 696</span></a>                          &lt;th&gt;{<a class="var it21376" onMouseOver="hilite(21376)" onMouseOut="lolite()" onClick="logVariable('typename')" href="../../_variables/typename.html">$typename</a>}&lt;/th&gt;
<a name="l697"><span class="linenum"> 697</span></a>                          &lt;th&gt;{<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>}&lt;/th&gt;
<a name="l698"><span class="linenum"> 698</span></a>                          &lt;th&gt;{<a class="var it35749" onMouseOver="hilite(35749)" onMouseOut="lolite()" onClick="logVariable('createdon')" href="../../_variables/createdon.html">$createdon</a>}&lt;/th&gt;
<a name="l699"><span class="linenum"> 699</span></a>                          &lt;th&gt;{<a class="var it280" onMouseOver="hilite(280)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a>}&lt;/th&gt;
<a name="l700"><span class="linenum"> 700</span></a>                      &lt;/tr&gt;
<a name="l701"><span class="linenum"> 701</span></a>                  &lt;/thead&gt;
<a name="l702"><span class="linenum"> 702</span></a>  EOD;
<a name="l703"><span class="linenum"> 703</span></a>          foreach (<a class="var it8395" onMouseOver="hilite(8395)" onMouseOut="lolite()" onClick="logVariable('toolproxies')" href="../../_variables/toolproxies.html">$toolproxies</a> as <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>) {
<a name="l704"><span class="linenum"> 704</span></a>              <a class="var it1098" onMouseOver="hilite(1098)" onMouseOut="lolite()" onClick="logVariable('date')" href="../../_variables/date.html">$date</a> = <a class="function" onClick="logFunction('userdate')" href="../../_functions/userdate.html" onMouseOver="funcPopup(event,'userdate')">userdate</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('timecreated')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a>, <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('strftimedatefullshort', 'core_langconfig'));
<a name="l705"><span class="linenum"> 705</span></a>              <a class="var it8836" onMouseOver="hilite(8836)" onMouseOut="lolite()" onClick="logVariable('accept')" href="../../_variables/accept.html">$accept</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('register', 'lti');
<a name="l706"><span class="linenum"> 706</span></a>              <a class="var it2088" onMouseOver="hilite(2088)" onMouseOut="lolite()" onClick="logVariable('update')" href="../../_variables/update.html">$update</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('update', 'lti');
<a name="l707"><span class="linenum"> 707</span></a>              <a class="var it420" onMouseOver="hilite(420)" onMouseOut="lolite()" onClick="logVariable('delete')" href="../../_variables/delete.html">$delete</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('delete', 'lti');
<a name="l708"><span class="linenum"> 708</span></a>  
<a name="l709"><span class="linenum"> 709</span></a>              <a class="var it424" onMouseOver="hilite(424)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a> = new \moodle_url('<a class="filename" href="../../mod/lti/registersettings.php.html">/mod/lti/registersettings.php</a>', array(
<a name="l710"><span class="linenum"> 710</span></a>                      'action' =&gt; 'accept',
<a name="l711"><span class="linenum"> 711</span></a>                      'id' =&gt; <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('id')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l712"><span class="linenum"> 712</span></a>                      'sesskey' =&gt; <a class="function" onClick="logFunction('sesskey')" href="../../_functions/sesskey.html" onMouseOver="funcPopup(event,'sesskey')">sesskey</a>(),
<a name="l713"><span class="linenum"> 713</span></a>                      'tab' =&gt; <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>
<a name="l714"><span class="linenum"> 714</span></a>                  ));
<a name="l715"><span class="linenum"> 715</span></a>  
<a name="l716"><span class="linenum"> 716</span></a>              <a class="var it7977" onMouseOver="hilite(7977)" onMouseOut="lolite()" onClick="logVariable('registerurl')" href="../../_variables/registerurl.html">$registerurl</a> = new \moodle_url('<a class="filename" href="../../mod/lti/register.php.html">/mod/lti/register.php</a>', array(
<a name="l717"><span class="linenum"> 717</span></a>                      'id' =&gt; <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('id')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l718"><span class="linenum"> 718</span></a>                      'sesskey' =&gt; <a class="function" onClick="logFunction('sesskey')" href="../../_functions/sesskey.html" onMouseOver="funcPopup(event,'sesskey')">sesskey</a>(),
<a name="l719"><span class="linenum"> 719</span></a>                      'tab' =&gt; 'tool_proxy'
<a name="l720"><span class="linenum"> 720</span></a>                  ));
<a name="l721"><span class="linenum"> 721</span></a>  
<a name="l722"><span class="linenum"> 722</span></a>              <a class="var it35751" onMouseOver="hilite(35751)" onMouseOut="lolite()" onClick="logVariable('accepthtml')" href="../../_variables/accepthtml.html">$accepthtml</a> = <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('action_icon')" href="../../_functions/action_icon.html" onMouseOver="funcPopup(event,'action_icon')">action_icon</a>(<a class="var it7977" onMouseOver="hilite(7977)" onMouseOut="lolite()" onClick="logVariable('registerurl')" href="../../_variables/registerurl.html">$registerurl</a>,
<a name="l723"><span class="linenum"> 723</span></a>                      new \<a class="function" onClick="logFunction('pix_icon')" href="../../_functions/pix_icon.html" onMouseOver="funcPopup(event,'pix_icon')">pix_icon</a>('t/check', <a class="var it8836" onMouseOver="hilite(8836)" onMouseOut="lolite()" onClick="logVariable('accept')" href="../../_variables/accept.html">$accept</a>, '', array('class' =&gt; 'iconsmall')), null,
<a name="l724"><span class="linenum"> 724</span></a>                      array('title' =&gt; <a class="var it8836" onMouseOver="hilite(8836)" onMouseOut="lolite()" onClick="logVariable('accept')" href="../../_variables/accept.html">$accept</a>, 'class' =&gt; 'editing_accept'));
<a name="l725"><span class="linenum"> 725</span></a>  
<a name="l726"><span class="linenum"> 726</span></a>              <a class="var it12977" onMouseOver="hilite(12977)" onMouseOut="lolite()" onClick="logVariable('deleteaction')" href="../../_variables/deleteaction.html">$deleteaction</a> = 'delete';
<a name="l727"><span class="linenum"> 727</span></a>  
<a name="l728"><span class="linenum"> 728</span></a>              if (<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('state')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> != <a class="constant" onClick="logConstant('LTI_TOOL_PROXY_STATE_CONFIGURED')" href="../../_constants/LTI_TOOL_PROXY_STATE_CONFIGURED.html" onMouseOver="constPopup(event,'LTI_TOOL_PROXY_STATE_CONFIGURED')">LTI_TOOL_PROXY_STATE_CONFIGURED</a>) {
<a name="l729"><span class="linenum"> 729</span></a>                  <a class="var it35751" onMouseOver="hilite(35751)" onMouseOut="lolite()" onClick="logVariable('accepthtml')" href="../../_variables/accepthtml.html">$accepthtml</a> = '';
<a name="l730"><span class="linenum"> 730</span></a>              }
<a name="l731"><span class="linenum"> 731</span></a>  
<a name="l732"><span class="linenum"> 732</span></a>              if ((<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('state')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> == <a class="constant" onClick="logConstant('LTI_TOOL_PROXY_STATE_CONFIGURED')" href="../../_constants/LTI_TOOL_PROXY_STATE_CONFIGURED.html" onMouseOver="constPopup(event,'LTI_TOOL_PROXY_STATE_CONFIGURED')">LTI_TOOL_PROXY_STATE_CONFIGURED</a>) || (<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('state')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> == <a class="constant" onClick="logConstant('LTI_TOOL_PROXY_STATE_PENDING')" href="../../_constants/LTI_TOOL_PROXY_STATE_PENDING.html" onMouseOver="constPopup(event,'LTI_TOOL_PROXY_STATE_PENDING')">LTI_TOOL_PROXY_STATE_PENDING</a>)) {
<a name="l733"><span class="linenum"> 733</span></a>                  <a class="var it420" onMouseOver="hilite(420)" onMouseOut="lolite()" onClick="logVariable('delete')" href="../../_variables/delete.html">$delete</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('cancel', 'lti');
<a name="l734"><span class="linenum"> 734</span></a>              }
<a name="l735"><span class="linenum"> 735</span></a>  
<a name="l736"><span class="linenum"> 736</span></a>              <a class="var it5241" onMouseOver="hilite(5241)" onMouseOut="lolite()" onClick="logVariable('updateurl')" href="../../_variables/updateurl.html">$updateurl</a> = <a class="function" onClick="logFunction('clone')" href="../../_functions/clone.html" onMouseOver="funcPopup(event,'clone')">clone</a>(<a class="var it424" onMouseOver="hilite(424)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a>);
<a name="l737"><span class="linenum"> 737</span></a>              <a class="var it5241" onMouseOver="hilite(5241)" onMouseOut="lolite()" onClick="logVariable('updateurl')" href="../../_variables/updateurl.html">$updateurl</a>-&gt;<a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>('action', 'update');
<a name="l738"><span class="linenum"> 738</span></a>              <a class="var it35752" onMouseOver="hilite(35752)" onMouseOut="lolite()" onClick="logVariable('updatehtml')" href="../../_variables/updatehtml.html">$updatehtml</a> = <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('action_icon')" href="../../_functions/action_icon.html" onMouseOver="funcPopup(event,'action_icon')">action_icon</a>(<a class="var it5241" onMouseOver="hilite(5241)" onMouseOut="lolite()" onClick="logVariable('updateurl')" href="../../_variables/updateurl.html">$updateurl</a>,
<a name="l739"><span class="linenum"> 739</span></a>                      new \<a class="function" onClick="logFunction('pix_icon')" href="../../_functions/pix_icon.html" onMouseOver="funcPopup(event,'pix_icon')">pix_icon</a>('t/edit', <a class="var it2088" onMouseOver="hilite(2088)" onMouseOut="lolite()" onClick="logVariable('update')" href="../../_variables/update.html">$update</a>, '', array('class' =&gt; 'iconsmall')), null,
<a name="l740"><span class="linenum"> 740</span></a>                      array('title' =&gt; <a class="var it2088" onMouseOver="hilite(2088)" onMouseOut="lolite()" onClick="logVariable('update')" href="../../_variables/update.html">$update</a>, 'class' =&gt; 'editing_update'));
<a name="l741"><span class="linenum"> 741</span></a>  
<a name="l742"><span class="linenum"> 742</span></a>              <a class="var it10029" onMouseOver="hilite(10029)" onMouseOut="lolite()" onClick="logVariable('deleteurl')" href="../../_variables/deleteurl.html">$deleteurl</a> = <a class="function" onClick="logFunction('clone')" href="../../_functions/clone.html" onMouseOver="funcPopup(event,'clone')">clone</a>(<a class="var it424" onMouseOver="hilite(424)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a>);
<a name="l743"><span class="linenum"> 743</span></a>              <a class="var it10029" onMouseOver="hilite(10029)" onMouseOut="lolite()" onClick="logVariable('deleteurl')" href="../../_variables/deleteurl.html">$deleteurl</a>-&gt;<a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>('action', <a class="var it12977" onMouseOver="hilite(12977)" onMouseOut="lolite()" onClick="logVariable('deleteaction')" href="../../_variables/deleteaction.html">$deleteaction</a>);
<a name="l744"><span class="linenum"> 744</span></a>              <a class="var it35753" onMouseOver="hilite(35753)" onMouseOut="lolite()" onClick="logVariable('deletehtml')" href="../../_variables/deletehtml.html">$deletehtml</a> = <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('action_icon')" href="../../_functions/action_icon.html" onMouseOver="funcPopup(event,'action_icon')">action_icon</a>(<a class="var it10029" onMouseOver="hilite(10029)" onMouseOut="lolite()" onClick="logVariable('deleteurl')" href="../../_variables/deleteurl.html">$deleteurl</a>,
<a name="l745"><span class="linenum"> 745</span></a>                      new \<a class="function" onClick="logFunction('pix_icon')" href="../../_functions/pix_icon.html" onMouseOver="funcPopup(event,'pix_icon')">pix_icon</a>('t/delete', <a class="var it420" onMouseOver="hilite(420)" onMouseOut="lolite()" onClick="logVariable('delete')" href="../../_variables/delete.html">$delete</a>, '', array('class' =&gt; 'iconsmall')), null,
<a name="l746"><span class="linenum"> 746</span></a>                      array('title' =&gt; <a class="var it420" onMouseOver="hilite(420)" onMouseOut="lolite()" onClick="logVariable('delete')" href="../../_variables/delete.html">$delete</a>, 'class' =&gt; 'editing_delete'));
<a name="l747"><span class="linenum"> 747</span></a>              <a class="var it475" onMouseOver="hilite(475)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../_variables/html.html">$html</a> .= &lt;&lt;&lt; EOD
<a name="l748"><span class="linenum"> 748</span></a>              &lt;tr&gt;
<a name="l749"><span class="linenum"> 749</span></a>                  &lt;td&gt;
<a name="l750"><span class="linenum"> 750</span></a>                      {<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('name')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>}
<a name="l751"><span class="linenum"> 751</span></a>                  &lt;/td&gt;
<a name="l752"><span class="linenum"> 752</span></a>                  &lt;td&gt;
<a name="l753"><span class="linenum"> 753</span></a>                      {<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('regurl')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/regurl.html">regurl</a>}
<a name="l754"><span class="linenum"> 754</span></a>                  &lt;/td&gt;
<a name="l755"><span class="linenum"> 755</span></a>                  &lt;td&gt;
<a name="l756"><span class="linenum"> 756</span></a>                      {<a class="var it1098" onMouseOver="hilite(1098)" onMouseOut="lolite()" onClick="logVariable('date')" href="../../_variables/date.html">$date</a>}
<a name="l757"><span class="linenum"> 757</span></a>                  &lt;/td&gt;
<a name="l758"><span class="linenum"> 758</span></a>                  &lt;td align=&quot;center&quot;&gt;
<a name="l759"><span class="linenum"> 759</span></a>                      {<a class="var it35751" onMouseOver="hilite(35751)" onMouseOut="lolite()" onClick="logVariable('accepthtml')" href="../../_variables/accepthtml.html">$accepthtml</a>}{<a class="var it35752" onMouseOver="hilite(35752)" onMouseOut="lolite()" onClick="logVariable('updatehtml')" href="../../_variables/updatehtml.html">$updatehtml</a>}{<a class="var it35753" onMouseOver="hilite(35753)" onMouseOut="lolite()" onClick="logVariable('deletehtml')" href="../../_variables/deletehtml.html">$deletehtml</a>}
<a name="l760"><span class="linenum"> 760</span></a>                  &lt;/td&gt;
<a name="l761"><span class="linenum"> 761</span></a>              &lt;/tr&gt;
<a name="l762"><span class="linenum"> 762</span></a>  EOD;
<a name="l763"><span class="linenum"> 763</span></a>          }
<a name="l764"><span class="linenum"> 764</span></a>          <a class="var it475" onMouseOver="hilite(475)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../_variables/html.html">$html</a> .= '&lt;/table&gt;&lt;/div&gt;';
<a name="l765"><span class="linenum"> 765</span></a>      } else {
<a name="l766"><span class="linenum"> 766</span></a>          <a class="var it475" onMouseOver="hilite(475)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../_variables/html.html">$html</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('no_' . <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>, 'lti');
<a name="l767"><span class="linenum"> 767</span></a>      }
<a name="l768"><span class="linenum"> 768</span></a>  
<a name="l769"><span class="linenum"> 769</span></a>      return <a class="var it475" onMouseOver="hilite(475)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../_variables/html.html">$html</a>;
<a name="l770"><span class="linenum"> 770</span></a>  }
<a name="l771"><span class="linenum"> 771</span></a>  
<a name="l772"><span class="linenum"> 772</span></a>  <span class="comment">/**</span>
<a name="l773"><span class="linenum"> 773</span></a>  <span class="comment"> * Extracts the enabled capabilities into an array, including those implicitly declared in a parameter</span>
<a name="l774"><span class="linenum"> 774</span></a>  <span class="comment"> *</span>
<a name="l775"><span class="linenum"> 775</span></a>  <span class="comment"> * @param object    $tool           Tool instance object</span>
<a name="l776"><span class="linenum"> 776</span></a>  <span class="comment"> *</span>
<a name="l777"><span class="linenum"> 777</span></a>  <span class="comment"> * @return Array of enabled capabilities</span>
<a name="l778"><span class="linenum"> 778</span></a>  <span class="comment"> */</span>
<a name="l779"><span class="linenum"> 779</span></a>  function <a class="function" onClick="logFunction('lti_get_enabled_capabilities')" href="../../_functions/lti_get_enabled_capabilities.html" onMouseOver="funcPopup(event,'lti_get_enabled_capabilities')">lti_get_enabled_capabilities</a>(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>) {
<a name="l780"><span class="linenum"> 780</span></a>      if (!empty(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('enabledcapability')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/enabledcapability.html">enabledcapability</a>)) {
<a name="l781"><span class="linenum"> 781</span></a>          <a class="var it8401" onMouseOver="hilite(8401)" onMouseOut="lolite()" onClick="logVariable('enabledcapabilities')" href="../../_variables/enabledcapabilities.html">$enabledcapabilities</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(&quot;\n&quot;, <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('enabledcapability')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/enabledcapability.html">enabledcapability</a>);
<a name="l782"><span class="linenum"> 782</span></a>      } else {
<a name="l783"><span class="linenum"> 783</span></a>          <a class="var it8401" onMouseOver="hilite(8401)" onMouseOut="lolite()" onClick="logVariable('enabledcapabilities')" href="../../_variables/enabledcapabilities.html">$enabledcapabilities</a> = array();
<a name="l784"><span class="linenum"> 784</span></a>      }
<a name="l785"><span class="linenum"> 785</span></a>      <a class="var it24083" onMouseOver="hilite(24083)" onMouseOut="lolite()" onClick="logVariable('paramstr')" href="../../_variables/paramstr.html">$paramstr</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(&quot;\r\n&quot;, &quot;\n&quot;, <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('parameter')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/parameter.html">parameter</a>);
<a name="l786"><span class="linenum"> 786</span></a>      <a class="var it24083" onMouseOver="hilite(24083)" onMouseOut="lolite()" onClick="logVariable('paramstr')" href="../../_variables/paramstr.html">$paramstr</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(&quot;\n\r&quot;, &quot;\n&quot;, <a class="var it24083" onMouseOver="hilite(24083)" onMouseOut="lolite()" onClick="logVariable('paramstr')" href="../../_variables/paramstr.html">$paramstr</a>);
<a name="l787"><span class="linenum"> 787</span></a>      <a class="var it24083" onMouseOver="hilite(24083)" onMouseOut="lolite()" onClick="logVariable('paramstr')" href="../../_variables/paramstr.html">$paramstr</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(&quot;\r&quot;, &quot;\n&quot;, <a class="var it24083" onMouseOver="hilite(24083)" onMouseOut="lolite()" onClick="logVariable('paramstr')" href="../../_variables/paramstr.html">$paramstr</a>);
<a name="l788"><span class="linenum"> 788</span></a>      <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(&quot;\n&quot;, <a class="var it24083" onMouseOver="hilite(24083)" onMouseOut="lolite()" onClick="logVariable('paramstr')" href="../../_variables/paramstr.html">$paramstr</a>);
<a name="l789"><span class="linenum"> 789</span></a>      foreach (<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> as <a class="var it334" onMouseOver="hilite(334)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../_variables/param.html">$param</a>) {
<a name="l790"><span class="linenum"> 790</span></a>          <a class="var it791" onMouseOver="hilite(791)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../../_variables/pos.html">$pos</a> = <a class="phpfunction" onClick="logFunction('strpos')" href="../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it334" onMouseOver="hilite(334)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../_variables/param.html">$param</a>, '=');
<a name="l791"><span class="linenum"> 791</span></a>          if ((<a class="var it791" onMouseOver="hilite(791)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../../_variables/pos.html">$pos</a> === false) || (<a class="var it791" onMouseOver="hilite(791)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../../_variables/pos.html">$pos</a> &lt; 1)) {
<a name="l792"><span class="linenum"> 792</span></a>              continue;
<a name="l793"><span class="linenum"> 793</span></a>          }
<a name="l794"><span class="linenum"> 794</span></a>          <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it334" onMouseOver="hilite(334)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../_variables/param.html">$param</a>, <a class="var it791" onMouseOver="hilite(791)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../../_variables/pos.html">$pos</a> + 1, <a class="function" onClick="logFunction('strlen')" href="../../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it334" onMouseOver="hilite(334)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../_variables/param.html">$param</a>)));
<a name="l795"><span class="linenum"> 795</span></a>          if (<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>, 0, 1) == '$') {
<a name="l796"><span class="linenum"> 796</span></a>              <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>, 1);
<a name="l797"><span class="linenum"> 797</span></a>              if (!<a class="phpfunction" onClick="logFunction('in_array')" href="../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>, <a class="var it8401" onMouseOver="hilite(8401)" onMouseOut="lolite()" onClick="logVariable('enabledcapabilities')" href="../../_variables/enabledcapabilities.html">$enabledcapabilities</a>)) {
<a name="l798"><span class="linenum"> 798</span></a>                  <a class="var it8401" onMouseOver="hilite(8401)" onMouseOut="lolite()" onClick="logVariable('enabledcapabilities')" href="../../_variables/enabledcapabilities.html">$enabledcapabilities</a>[] = <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l799"><span class="linenum"> 799</span></a>              }
<a name="l800"><span class="linenum"> 800</span></a>          }
<a name="l801"><span class="linenum"> 801</span></a>      }
<a name="l802"><span class="linenum"> 802</span></a>      return <a class="var it8401" onMouseOver="hilite(8401)" onMouseOut="lolite()" onClick="logVariable('enabledcapabilities')" href="../../_variables/enabledcapabilities.html">$enabledcapabilities</a>;
<a name="l803"><span class="linenum"> 803</span></a>  }
<a name="l804"><span class="linenum"> 804</span></a>  
<a name="l805"><span class="linenum"> 805</span></a>  <span class="comment">/**</span>
<a name="l806"><span class="linenum"> 806</span></a>  <span class="comment"> * Splits the custom parameters field to the various parameters</span>
<a name="l807"><span class="linenum"> 807</span></a>  <span class="comment"> *</span>
<a name="l808"><span class="linenum"> 808</span></a>  <span class="comment"> * @param object    $toolproxy      Tool proxy instance object</span>
<a name="l809"><span class="linenum"> 809</span></a>  <span class="comment"> * @param object    $tool           Tool instance object</span>
<a name="l810"><span class="linenum"> 810</span></a>  <span class="comment"> * @param array     $params         LTI launch parameters</span>
<a name="l811"><span class="linenum"> 811</span></a>  <span class="comment"> * @param string    $customstr      String containing the parameters</span>
<a name="l812"><span class="linenum"> 812</span></a>  <span class="comment"> * @param boolean   $islti2         True if an LTI 2 tool is being launched</span>
<a name="l813"><span class="linenum"> 813</span></a>  <span class="comment"> *</span>
<a name="l814"><span class="linenum"> 814</span></a>  <span class="comment"> * @return Array of custom parameters</span>
<a name="l815"><span class="linenum"> 815</span></a>  <span class="comment"> */</span>
<a name="l816"><span class="linenum"> 816</span></a>  function <a class="function" onClick="logFunction('lti_split_custom_parameters')" href="../../_functions/lti_split_custom_parameters.html" onMouseOver="funcPopup(event,'lti_split_custom_parameters')">lti_split_custom_parameters</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>, <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it35739" onMouseOver="hilite(35739)" onMouseOut="lolite()" onClick="logVariable('customstr')" href="../../_variables/customstr.html">$customstr</a>, <a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a> = false) {
<a name="l817"><span class="linenum"> 817</span></a>      <a class="var it35739" onMouseOver="hilite(35739)" onMouseOut="lolite()" onClick="logVariable('customstr')" href="../../_variables/customstr.html">$customstr</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(&quot;\r\n&quot;, &quot;\n&quot;, <a class="var it35739" onMouseOver="hilite(35739)" onMouseOut="lolite()" onClick="logVariable('customstr')" href="../../_variables/customstr.html">$customstr</a>);
<a name="l818"><span class="linenum"> 818</span></a>      <a class="var it35739" onMouseOver="hilite(35739)" onMouseOut="lolite()" onClick="logVariable('customstr')" href="../../_variables/customstr.html">$customstr</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(&quot;\n\r&quot;, &quot;\n&quot;, <a class="var it35739" onMouseOver="hilite(35739)" onMouseOut="lolite()" onClick="logVariable('customstr')" href="../../_variables/customstr.html">$customstr</a>);
<a name="l819"><span class="linenum"> 819</span></a>      <a class="var it35739" onMouseOver="hilite(35739)" onMouseOut="lolite()" onClick="logVariable('customstr')" href="../../_variables/customstr.html">$customstr</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(&quot;\r&quot;, &quot;\n&quot;, <a class="var it35739" onMouseOver="hilite(35739)" onMouseOut="lolite()" onClick="logVariable('customstr')" href="../../_variables/customstr.html">$customstr</a>);
<a name="l820"><span class="linenum"> 820</span></a>      <a class="var it255" onMouseOver="hilite(255)" onMouseOut="lolite()" onClick="logVariable('lines')" href="../../_variables/lines.html">$lines</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(&quot;\n&quot;, <a class="var it35739" onMouseOver="hilite(35739)" onMouseOut="lolite()" onClick="logVariable('customstr')" href="../../_variables/customstr.html">$customstr</a>);  <span class="comment">// Or should this split on &quot;/[\n;]/&quot;?</span>
<a name="l821"><span class="linenum"> 821</span></a>      <a class="var it8628" onMouseOver="hilite(8628)" onMouseOut="lolite()" onClick="logVariable('retval')" href="../../_variables/retval.html">$retval</a> = array();
<a name="l822"><span class="linenum"> 822</span></a>      foreach (<a class="var it255" onMouseOver="hilite(255)" onMouseOut="lolite()" onClick="logVariable('lines')" href="../../_variables/lines.html">$lines</a> as <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../_variables/line.html">$line</a>) {
<a name="l823"><span class="linenum"> 823</span></a>          <a class="var it791" onMouseOver="hilite(791)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../../_variables/pos.html">$pos</a> = <a class="phpfunction" onClick="logFunction('strpos')" href="../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../_variables/line.html">$line</a>, '=');
<a name="l824"><span class="linenum"> 824</span></a>          if ( <a class="var it791" onMouseOver="hilite(791)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../../_variables/pos.html">$pos</a> === false || <a class="var it791" onMouseOver="hilite(791)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../../_variables/pos.html">$pos</a> &lt; 1 ) {
<a name="l825"><span class="linenum"> 825</span></a>              continue;
<a name="l826"><span class="linenum"> 826</span></a>          }
<a name="l827"><span class="linenum"> 827</span></a>          <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../_variables/line.html">$line</a>, 0, <a class="var it791" onMouseOver="hilite(791)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../../_variables/pos.html">$pos</a>));
<a name="l828"><span class="linenum"> 828</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../_variables/line.html">$line</a>, <a class="var it791" onMouseOver="hilite(791)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../../_variables/pos.html">$pos</a> + 1, <a class="function" onClick="logFunction('strlen')" href="../../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../_variables/line.html">$line</a>)));
<a name="l829"><span class="linenum"> 829</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a> = <a class="function" onClick="logFunction('lti_parse_custom_parameter')" href="../../_functions/lti_parse_custom_parameter.html" onMouseOver="funcPopup(event,'lti_parse_custom_parameter')">lti_parse_custom_parameter</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>, <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>, <a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a>);
<a name="l830"><span class="linenum"> 830</span></a>          <a class="var it9591" onMouseOver="hilite(9591)" onMouseOut="lolite()" onClick="logVariable('key2')" href="../../_variables/key2.html">$key2</a> = <a class="function" onClick="logFunction('lti_map_keyname')" href="../../_functions/lti_map_keyname.html" onMouseOver="funcPopup(event,'lti_map_keyname')">lti_map_keyname</a>(<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>);
<a name="l831"><span class="linenum"> 831</span></a>          <a class="var it8628" onMouseOver="hilite(8628)" onMouseOut="lolite()" onClick="logVariable('retval')" href="../../_variables/retval.html">$retval</a>['custom_'.<a class="var it9591" onMouseOver="hilite(9591)" onMouseOut="lolite()" onClick="logVariable('key2')" href="../../_variables/key2.html">$key2</a>] = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>;
<a name="l832"><span class="linenum"> 832</span></a>          if (<a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a> &amp;&amp; (<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> != <a class="var it9591" onMouseOver="hilite(9591)" onMouseOut="lolite()" onClick="logVariable('key2')" href="../../_variables/key2.html">$key2</a>)) {
<a name="l833"><span class="linenum"> 833</span></a>              <a class="var it8628" onMouseOver="hilite(8628)" onMouseOut="lolite()" onClick="logVariable('retval')" href="../../_variables/retval.html">$retval</a>['custom_'.<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>] = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>;
<a name="l834"><span class="linenum"> 834</span></a>          }
<a name="l835"><span class="linenum"> 835</span></a>      }
<a name="l836"><span class="linenum"> 836</span></a>      return <a class="var it8628" onMouseOver="hilite(8628)" onMouseOut="lolite()" onClick="logVariable('retval')" href="../../_variables/retval.html">$retval</a>;
<a name="l837"><span class="linenum"> 837</span></a>  }
<a name="l838"><span class="linenum"> 838</span></a>  
<a name="l839"><span class="linenum"> 839</span></a>  <span class="comment">/**</span>
<a name="l840"><span class="linenum"> 840</span></a>  <span class="comment"> * Adds the custom parameters to an array</span>
<a name="l841"><span class="linenum"> 841</span></a>  <span class="comment"> *</span>
<a name="l842"><span class="linenum"> 842</span></a>  <span class="comment"> * @param object    $toolproxy      Tool proxy instance object</span>
<a name="l843"><span class="linenum"> 843</span></a>  <span class="comment"> * @param object    $tool           Tool instance object</span>
<a name="l844"><span class="linenum"> 844</span></a>  <span class="comment"> * @param array     $params         LTI launch parameters</span>
<a name="l845"><span class="linenum"> 845</span></a>  <span class="comment"> * @param array     $parameters     Array containing the parameters</span>
<a name="l846"><span class="linenum"> 846</span></a>  <span class="comment"> *</span>
<a name="l847"><span class="linenum"> 847</span></a>  <span class="comment"> * @return array    Array of custom parameters</span>
<a name="l848"><span class="linenum"> 848</span></a>  <span class="comment"> */</span>
<a name="l849"><span class="linenum"> 849</span></a>  function <a class="function" onClick="logFunction('lti_get_custom_parameters')" href="../../_functions/lti_get_custom_parameters.html" onMouseOver="funcPopup(event,'lti_get_custom_parameters')">lti_get_custom_parameters</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>, <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it2245" onMouseOver="hilite(2245)" onMouseOut="lolite()" onClick="logVariable('parameters')" href="../../_variables/parameters.html">$parameters</a>) {
<a name="l850"><span class="linenum"> 850</span></a>      <a class="var it8628" onMouseOver="hilite(8628)" onMouseOut="lolite()" onClick="logVariable('retval')" href="../../_variables/retval.html">$retval</a> = array();
<a name="l851"><span class="linenum"> 851</span></a>      foreach (<a class="var it2245" onMouseOver="hilite(2245)" onMouseOut="lolite()" onClick="logVariable('parameters')" href="../../_variables/parameters.html">$parameters</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>) {
<a name="l852"><span class="linenum"> 852</span></a>          <a class="var it9591" onMouseOver="hilite(9591)" onMouseOut="lolite()" onClick="logVariable('key2')" href="../../_variables/key2.html">$key2</a> = <a class="function" onClick="logFunction('lti_map_keyname')" href="../../_functions/lti_map_keyname.html" onMouseOver="funcPopup(event,'lti_map_keyname')">lti_map_keyname</a>(<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>);
<a name="l853"><span class="linenum"> 853</span></a>          <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a> = <a class="function" onClick="logFunction('lti_parse_custom_parameter')" href="../../_functions/lti_parse_custom_parameter.html" onMouseOver="funcPopup(event,'lti_parse_custom_parameter')">lti_parse_custom_parameter</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>, <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>, true);
<a name="l854"><span class="linenum"> 854</span></a>          <a class="var it8628" onMouseOver="hilite(8628)" onMouseOut="lolite()" onClick="logVariable('retval')" href="../../_variables/retval.html">$retval</a>['custom_'.<a class="var it9591" onMouseOver="hilite(9591)" onMouseOut="lolite()" onClick="logVariable('key2')" href="../../_variables/key2.html">$key2</a>] = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>;
<a name="l855"><span class="linenum"> 855</span></a>          if (<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> != <a class="var it9591" onMouseOver="hilite(9591)" onMouseOut="lolite()" onClick="logVariable('key2')" href="../../_variables/key2.html">$key2</a>) {
<a name="l856"><span class="linenum"> 856</span></a>              <a class="var it8628" onMouseOver="hilite(8628)" onMouseOut="lolite()" onClick="logVariable('retval')" href="../../_variables/retval.html">$retval</a>['custom_'.<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>] = <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>;
<a name="l857"><span class="linenum"> 857</span></a>          }
<a name="l858"><span class="linenum"> 858</span></a>      }
<a name="l859"><span class="linenum"> 859</span></a>      return <a class="var it8628" onMouseOver="hilite(8628)" onMouseOut="lolite()" onClick="logVariable('retval')" href="../../_variables/retval.html">$retval</a>;
<a name="l860"><span class="linenum"> 860</span></a>  }
<a name="l861"><span class="linenum"> 861</span></a>  
<a name="l862"><span class="linenum"> 862</span></a>  <span class="comment">/**</span>
<a name="l863"><span class="linenum"> 863</span></a>  <span class="comment"> * Parse a custom parameter to replace any substitution variables</span>
<a name="l864"><span class="linenum"> 864</span></a>  <span class="comment"> *</span>
<a name="l865"><span class="linenum"> 865</span></a>  <span class="comment"> * @param object    $toolproxy      Tool proxy instance object</span>
<a name="l866"><span class="linenum"> 866</span></a>  <span class="comment"> * @param object    $tool           Tool instance object</span>
<a name="l867"><span class="linenum"> 867</span></a>  <span class="comment"> * @param array     $params         LTI launch parameters</span>
<a name="l868"><span class="linenum"> 868</span></a>  <span class="comment"> * @param string    $value          Custom parameter value</span>
<a name="l869"><span class="linenum"> 869</span></a>  <span class="comment"> * @param boolean   $islti2         True if an LTI 2 tool is being launched</span>
<a name="l870"><span class="linenum"> 870</span></a>  <span class="comment"> *</span>
<a name="l871"><span class="linenum"> 871</span></a>  <span class="comment"> * @return Parsed value of custom parameter</span>
<a name="l872"><span class="linenum"> 872</span></a>  <span class="comment"> */</span>
<a name="l873"><span class="linenum"> 873</span></a>  function <a class="function" onClick="logFunction('lti_parse_custom_parameter')" href="../../_functions/lti_parse_custom_parameter.html" onMouseOver="funcPopup(event,'lti_parse_custom_parameter')">lti_parse_custom_parameter</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>, <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>, <a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a>) {
<a name="l874"><span class="linenum"> 874</span></a>      global <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it586" onMouseOver="hilite(586)" onMouseOut="lolite()" onClick="logVariable('COURSE')" href="../../_variables/COURSE.html">$COURSE</a>;
<a name="l875"><span class="linenum"> 875</span></a>  
<a name="l876"><span class="linenum"> 876</span></a>      if (<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l877"><span class="linenum"> 877</span></a>          if (<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>, 0, 1) == '\\') {
<a name="l878"><span class="linenum"> 878</span></a>              <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>, 1);
<a name="l879"><span class="linenum"> 879</span></a>          } else if (<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>, 0, 1) == '$') {
<a name="l880"><span class="linenum"> 880</span></a>              <a class="var it12433" onMouseOver="hilite(12433)" onMouseOut="lolite()" onClick="logVariable('value1')" href="../../_variables/value1.html">$value1</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>, 1);
<a name="l881"><span class="linenum"> 881</span></a>              <a class="var it8401" onMouseOver="hilite(8401)" onMouseOut="lolite()" onClick="logVariable('enabledcapabilities')" href="../../_variables/enabledcapabilities.html">$enabledcapabilities</a> = <a class="function" onClick="logFunction('lti_get_enabled_capabilities')" href="../../_functions/lti_get_enabled_capabilities.html" onMouseOver="funcPopup(event,'lti_get_enabled_capabilities')">lti_get_enabled_capabilities</a>(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>);
<a name="l882"><span class="linenum"> 882</span></a>              if (!<a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a> || <a class="phpfunction" onClick="logFunction('in_array')" href="../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it12433" onMouseOver="hilite(12433)" onMouseOut="lolite()" onClick="logVariable('value1')" href="../../_variables/value1.html">$value1</a>, <a class="var it8401" onMouseOver="hilite(8401)" onMouseOut="lolite()" onClick="logVariable('enabledcapabilities')" href="../../_variables/enabledcapabilities.html">$enabledcapabilities</a>)) {
<a name="l883"><span class="linenum"> 883</span></a>                  <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('capabilities')" href="../../_variables/capabilities.html">$capabilities</a> = <a class="function" onClick="logFunction('lti_get_capabilities')" href="../../_functions/lti_get_capabilities.html" onMouseOver="funcPopup(event,'lti_get_capabilities')">lti_get_capabilities</a>();
<a name="l884"><span class="linenum"> 884</span></a>                  if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it12433" onMouseOver="hilite(12433)" onMouseOut="lolite()" onClick="logVariable('value1')" href="../../_variables/value1.html">$value1</a>, <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('capabilities')" href="../../_variables/capabilities.html">$capabilities</a>)) {
<a name="l885"><span class="linenum"> 885</span></a>                      <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a> = <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('capabilities')" href="../../_variables/capabilities.html">$capabilities</a>[<a class="var it12433" onMouseOver="hilite(12433)" onMouseOut="lolite()" onClick="logVariable('value1')" href="../../_variables/value1.html">$value1</a>];
<a name="l886"><span class="linenum"> 886</span></a>                      if (<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>) {
<a name="l887"><span class="linenum"> 887</span></a>                          if (<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>, 0, 1) != '$') {
<a name="l888"><span class="linenum"> 888</span></a>                              <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>[<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>];
<a name="l889"><span class="linenum"> 889</span></a>                          } else {
<a name="l890"><span class="linenum"> 890</span></a>                              <a class="var it10160" onMouseOver="hilite(10160)" onMouseOut="lolite()" onClick="logVariable('valarr')" href="../../_variables/valarr.html">$valarr</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>('-&gt;', <a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>, 1), 2);
<a name="l891"><span class="linenum"> 891</span></a>                              <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = &quot;{${<a class="var it10160" onMouseOver="hilite(10160)" onMouseOut="lolite()" onClick="logVariable('valarr')" href="../../_variables/valarr.html">$valarr</a>[0]}-&gt;{<a class="var it10160" onMouseOver="hilite(10160)" onMouseOut="lolite()" onClick="logVariable('valarr')" href="../../_variables/valarr.html">$valarr</a>[1]}}&quot;;
<a name="l892"><span class="linenum"> 892</span></a>                              <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('&lt;br /&gt;' , ' ', <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>);
<a name="l893"><span class="linenum"> 893</span></a>                              <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('&lt;br&gt;' , ' ', <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>);
<a name="l894"><span class="linenum"> 894</span></a>                              <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="function" onClick="logFunction('format_string')" href="../../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>);
<a name="l895"><span class="linenum"> 895</span></a>                          }
<a name="l896"><span class="linenum"> 896</span></a>                      }
<a name="l897"><span class="linenum"> 897</span></a>                  } else if (<a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a>) {
<a name="l898"><span class="linenum"> 898</span></a>                      <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a> = <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l899"><span class="linenum"> 899</span></a>                      <a class="var it4429" onMouseOver="hilite(4429)" onMouseOut="lolite()" onClick="logVariable('services')" href="../../_variables/services.html">$services</a> = <a class="function" onClick="logFunction('lti_get_services')" href="../../_functions/lti_get_services.html" onMouseOver="funcPopup(event,'lti_get_services')">lti_get_services</a>();
<a name="l900"><span class="linenum"> 900</span></a>                      foreach (<a class="var it4429" onMouseOver="hilite(4429)" onMouseOut="lolite()" onClick="logVariable('services')" href="../../_variables/services.html">$services</a> as <a class="var it898" onMouseOver="hilite(898)" onMouseOut="lolite()" onClick="logVariable('service')" href="../../_variables/service.html">$service</a>) {
<a name="l901"><span class="linenum"> 901</span></a>                          <a class="var it898" onMouseOver="hilite(898)" onMouseOut="lolite()" onClick="logVariable('service')" href="../../_variables/service.html">$service</a>-&gt;<a class="function" onClick="logFunction('set_tool_proxy')" href="../../_functions/set_tool_proxy.html" onMouseOver="funcPopup(event,'set_tool_proxy')">set_tool_proxy</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>);
<a name="l902"><span class="linenum"> 902</span></a>                          <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="var it898" onMouseOver="hilite(898)" onMouseOut="lolite()" onClick="logVariable('service')" href="../../_variables/service.html">$service</a>-&gt;<a class="function" onClick="logFunction('parse_value')" href="../../_functions/parse_value.html" onMouseOver="funcPopup(event,'parse_value')">parse_value</a>(<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>);
<a name="l903"><span class="linenum"> 903</span></a>                          if (<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a> != <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l904"><span class="linenum"> 904</span></a>                              break;
<a name="l905"><span class="linenum"> 905</span></a>                          }
<a name="l906"><span class="linenum"> 906</span></a>                      }
<a name="l907"><span class="linenum"> 907</span></a>                  }
<a name="l908"><span class="linenum"> 908</span></a>              }
<a name="l909"><span class="linenum"> 909</span></a>          }
<a name="l910"><span class="linenum"> 910</span></a>      }
<a name="l911"><span class="linenum"> 911</span></a>      return <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l912"><span class="linenum"> 912</span></a>  }
<a name="l913"><span class="linenum"> 913</span></a>  
<a name="l914"><span class="linenum"> 914</span></a>  <span class="comment">/**</span>
<a name="l915"><span class="linenum"> 915</span></a>  <span class="comment"> * Used for building the names of the different custom parameters</span>
<a name="l916"><span class="linenum"> 916</span></a>  <span class="comment"> *</span>
<a name="l917"><span class="linenum"> 917</span></a>  <span class="comment"> * @param string $key   Parameter name</span>
<a name="l918"><span class="linenum"> 918</span></a>  <span class="comment"> *</span>
<a name="l919"><span class="linenum"> 919</span></a>  <span class="comment"> * @return string       Processed name</span>
<a name="l920"><span class="linenum"> 920</span></a>  <span class="comment"> */</span>
<a name="l921"><span class="linenum"> 921</span></a>  function <a class="function" onClick="logFunction('lti_map_keyname')" href="../../_functions/lti_map_keyname.html" onMouseOver="funcPopup(event,'lti_map_keyname')">lti_map_keyname</a>(<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>) {
<a name="l922"><span class="linenum"> 922</span></a>      <a class="var it14074" onMouseOver="hilite(14074)" onMouseOut="lolite()" onClick="logVariable('newkey')" href="../../_variables/newkey.html">$newkey</a> = &quot;&quot;;
<a name="l923"><span class="linenum"> 923</span></a>      <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>));
<a name="l924"><span class="linenum"> 924</span></a>      foreach (<a class="phpfunction" onClick="logFunction('str_split')" href="../../_functions/str_split.html" onMouseOver="phpfuncPopup(event,'str_split')">str_split</a>(<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>) as <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('ch')" href="../../_variables/ch.html">$ch</a>) {
<a name="l925"><span class="linenum"> 925</span></a>          if ( (<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('ch')" href="../../_variables/ch.html">$ch</a> &gt;= 'a' &amp;&amp; <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('ch')" href="../../_variables/ch.html">$ch</a> &lt;= 'z') || (<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('ch')" href="../../_variables/ch.html">$ch</a> &gt;= '0' &amp;&amp; <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('ch')" href="../../_variables/ch.html">$ch</a> &lt;= '9') ) {
<a name="l926"><span class="linenum"> 926</span></a>              <a class="var it14074" onMouseOver="hilite(14074)" onMouseOut="lolite()" onClick="logVariable('newkey')" href="../../_variables/newkey.html">$newkey</a> .= <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('ch')" href="../../_variables/ch.html">$ch</a>;
<a name="l927"><span class="linenum"> 927</span></a>          } else {
<a name="l928"><span class="linenum"> 928</span></a>              <a class="var it14074" onMouseOver="hilite(14074)" onMouseOut="lolite()" onClick="logVariable('newkey')" href="../../_variables/newkey.html">$newkey</a> .= '_';
<a name="l929"><span class="linenum"> 929</span></a>          }
<a name="l930"><span class="linenum"> 930</span></a>      }
<a name="l931"><span class="linenum"> 931</span></a>      return <a class="var it14074" onMouseOver="hilite(14074)" onMouseOut="lolite()" onClick="logVariable('newkey')" href="../../_variables/newkey.html">$newkey</a>;
<a name="l932"><span class="linenum"> 932</span></a>  }
<a name="l933"><span class="linenum"> 933</span></a>  
<a name="l934"><span class="linenum"> 934</span></a>  <span class="comment">/**</span>
<a name="l935"><span class="linenum"> 935</span></a>  <span class="comment"> * Gets the IMS role string for the specified user and LTI course module.</span>
<a name="l936"><span class="linenum"> 936</span></a>  <span class="comment"> *</span>
<a name="l937"><span class="linenum"> 937</span></a>  <span class="comment"> * @param mixed    $user      User object or user id</span>
<a name="l938"><span class="linenum"> 938</span></a>  <span class="comment"> * @param int      $cmid      The course module id of the LTI activity</span>
<a name="l939"><span class="linenum"> 939</span></a>  <span class="comment"> * @param int      $courseid  The course id of the LTI activity</span>
<a name="l940"><span class="linenum"> 940</span></a>  <span class="comment"> * @param boolean  $islti2    True if an LTI 2 tool is being launched</span>
<a name="l941"><span class="linenum"> 941</span></a>  <span class="comment"> *</span>
<a name="l942"><span class="linenum"> 942</span></a>  <span class="comment"> * @return string A role string suitable for passing with an LTI launch</span>
<a name="l943"><span class="linenum"> 943</span></a>  <span class="comment"> */</span>
<a name="l944"><span class="linenum"> 944</span></a>  function <a class="function" onClick="logFunction('lti_get_ims_role')" href="../../_functions/lti_get_ims_role.html" onMouseOver="funcPopup(event,'lti_get_ims_role')">lti_get_ims_role</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>, <a class="var it1077" onMouseOver="hilite(1077)" onMouseOut="lolite()" onClick="logVariable('cmid')" href="../../_variables/cmid.html">$cmid</a>, <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>, <a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a>) {
<a name="l945"><span class="linenum"> 945</span></a>      <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('roles')" href="../../_variables/roles.html">$roles</a> = array();
<a name="l946"><span class="linenum"> 946</span></a>  
<a name="l947"><span class="linenum"> 947</span></a>      if (empty(<a class="var it1077" onMouseOver="hilite(1077)" onMouseOut="lolite()" onClick="logVariable('cmid')" href="../../_variables/cmid.html">$cmid</a>)) {
<a name="l948"><span class="linenum"> 948</span></a>  <span class="comment">        // If no cmid is passed, check if the user is a teacher in the course</span>
<a name="l949"><span class="linenum"> 949</span></a>  <span class="comment">        // This allows other modules to programmatically &quot;fake&quot; a launch without</span>
<a name="l950"><span class="linenum"> 950</span></a>  <span class="comment">        // a real LTI instance.</span>
<a name="l951"><span class="linenum"> 951</span></a>          <a class="var it683" onMouseOver="hilite(683)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../../_variables/coursecontext.html">$coursecontext</a> = <a class="class" onClick="logClass('context_course')" href="../../_classes/context_course.html" onMouseOver="classPopup(event,'context_course')">context_course</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>);
<a name="l952"><span class="linenum"> 952</span></a>  
<a name="l953"><span class="linenum"> 953</span></a>          if (<a class="function" onClick="logFunction('has_capability')" href="../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/course:manageactivities', <a class="var it683" onMouseOver="hilite(683)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../../_variables/coursecontext.html">$coursecontext</a>, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>)) {
<a name="l954"><span class="linenum"> 954</span></a>              <a class="phpfunction" onClick="logFunction('array_push')" href="../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>(<a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('roles')" href="../../_variables/roles.html">$roles</a>, 'Instructor');
<a name="l955"><span class="linenum"> 955</span></a>          } else {
<a name="l956"><span class="linenum"> 956</span></a>              <a class="phpfunction" onClick="logFunction('array_push')" href="../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>(<a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('roles')" href="../../_variables/roles.html">$roles</a>, 'Learner');
<a name="l957"><span class="linenum"> 957</span></a>          }
<a name="l958"><span class="linenum"> 958</span></a>      } else {
<a name="l959"><span class="linenum"> 959</span></a>          <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_module')" href="../../_classes/context_module.html" onMouseOver="classPopup(event,'context_module')">context_module</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it1077" onMouseOver="hilite(1077)" onMouseOut="lolite()" onClick="logVariable('cmid')" href="../../_variables/cmid.html">$cmid</a>);
<a name="l960"><span class="linenum"> 960</span></a>  
<a name="l961"><span class="linenum"> 961</span></a>          if (<a class="function" onClick="logFunction('has_capability')" href="../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('mod/lti:manage', <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>)) {
<a name="l962"><span class="linenum"> 962</span></a>              <a class="phpfunction" onClick="logFunction('array_push')" href="../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>(<a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('roles')" href="../../_variables/roles.html">$roles</a>, 'Instructor');
<a name="l963"><span class="linenum"> 963</span></a>          } else {
<a name="l964"><span class="linenum"> 964</span></a>              <a class="phpfunction" onClick="logFunction('array_push')" href="../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>(<a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('roles')" href="../../_variables/roles.html">$roles</a>, 'Learner');
<a name="l965"><span class="linenum"> 965</span></a>          }
<a name="l966"><span class="linenum"> 966</span></a>      }
<a name="l967"><span class="linenum"> 967</span></a>  
<a name="l968"><span class="linenum"> 968</span></a>      if (<a class="function" onClick="logFunction('is_siteadmin')" href="../../_functions/is_siteadmin.html" onMouseOver="funcPopup(event,'is_siteadmin')">is_siteadmin</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>)) {
<a name="l969"><span class="linenum"> 969</span></a>          if (!<a class="var it35737" onMouseOver="hilite(35737)" onMouseOut="lolite()" onClick="logVariable('islti2')" href="../../_variables/islti2.html">$islti2</a>) {
<a name="l970"><span class="linenum"> 970</span></a>              <a class="phpfunction" onClick="logFunction('array_push')" href="../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>(<a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('roles')" href="../../_variables/roles.html">$roles</a>, 'urn:lti:sysrole:ims/lis/Administrator', 'urn:lti:instrole:ims/lis/Administrator');
<a name="l971"><span class="linenum"> 971</span></a>          } else {
<a name="l972"><span class="linenum"> 972</span></a>              <a class="phpfunction" onClick="logFunction('array_push')" href="../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>(<a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('roles')" href="../../_variables/roles.html">$roles</a>, 'http://purl.imsglobal.org/vocab/lis/v2/person#Administrator');
<a name="l973"><span class="linenum"> 973</span></a>          }
<a name="l974"><span class="linenum"> 974</span></a>      }
<a name="l975"><span class="linenum"> 975</span></a>  
<a name="l976"><span class="linenum"> 976</span></a>      return <a class="function" onClick="logFunction('join')" href="../../_functions/join.html" onMouseOver="funcPopup(event,'join')">join</a>(',', <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('roles')" href="../../_variables/roles.html">$roles</a>);
<a name="l977"><span class="linenum"> 977</span></a>  }
<a name="l978"><span class="linenum"> 978</span></a>  
<a name="l979"><span class="linenum"> 979</span></a>  <span class="comment">/**</span>
<a name="l980"><span class="linenum"> 980</span></a>  <span class="comment"> * Returns configuration details for the tool</span>
<a name="l981"><span class="linenum"> 981</span></a>  <span class="comment"> *</span>
<a name="l982"><span class="linenum"> 982</span></a>  <span class="comment"> * @param int $typeid   Basic LTI tool typeid</span>
<a name="l983"><span class="linenum"> 983</span></a>  <span class="comment"> *</span>
<a name="l984"><span class="linenum"> 984</span></a>  <span class="comment"> * @return array        Tool Configuration</span>
<a name="l985"><span class="linenum"> 985</span></a>  <span class="comment"> */</span>
<a name="l986"><span class="linenum"> 986</span></a>  function <a class="function" onClick="logFunction('lti_get_type_config')" href="../../_functions/lti_get_type_config.html" onMouseOver="funcPopup(event,'lti_get_type_config')">lti_get_type_config</a>(<a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a>) {
<a name="l987"><span class="linenum"> 987</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l988"><span class="linenum"> 988</span></a>  
<a name="l989"><span class="linenum"> 989</span></a>      <a class="var it249" onMouseOver="hilite(249)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../_variables/query.html">$query</a> = &quot;SELECT name, value
<a name="l990"><span class="linenum"> 990</span></a>                  FROM {lti_types_config}
<a name="l991"><span class="linenum"> 991</span></a>                 WHERE typeid = :typeid1
<a name="l992"><span class="linenum"> 992</span></a>             UNION ALL
<a name="l993"><span class="linenum"> 993</span></a>                SELECT 'toolurl' AS name, &quot; . <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_compare_text')" href="../../_functions/sql_compare_text.html" onMouseOver="funcPopup(event,'sql_compare_text')">sql_compare_text</a>('baseurl', 1333) . &quot; AS value
<a name="l994"><span class="linenum"> 994</span></a>                  FROM {lti_types}
<a name="l995"><span class="linenum"> 995</span></a>                 WHERE id = :typeid2
<a name="l996"><span class="linenum"> 996</span></a>             UNION ALL
<a name="l997"><span class="linenum"> 997</span></a>                SELECT 'icon' AS name, &quot; . <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_compare_text')" href="../../_functions/sql_compare_text.html" onMouseOver="funcPopup(event,'sql_compare_text')">sql_compare_text</a>('icon', 1333) . &quot; AS value
<a name="l998"><span class="linenum"> 998</span></a>                  FROM {lti_types}
<a name="l999"><span class="linenum"> 999</span></a>                 WHERE id = :typeid3
<a name="l1000"><span class="linenum">1000</span></a>             UNION ALL
<a name="l1001"><span class="linenum">1001</span></a>                SELECT 'secureicon' AS name, &quot; . <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_compare_text')" href="../../_functions/sql_compare_text.html" onMouseOver="funcPopup(event,'sql_compare_text')">sql_compare_text</a>('secureicon', 1333) . &quot; AS value
<a name="l1002"><span class="linenum">1002</span></a>                  FROM {lti_types}
<a name="l1003"><span class="linenum">1003</span></a>                 WHERE id = :typeid4&quot;;
<a name="l1004"><span class="linenum">1004</span></a>  
<a name="l1005"><span class="linenum">1005</span></a>      <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a> = array();
<a name="l1006"><span class="linenum">1006</span></a>      <a class="var it429" onMouseOver="hilite(429)" onMouseOut="lolite()" onClick="logVariable('configs')" href="../../_variables/configs.html">$configs</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it249" onMouseOver="hilite(249)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../_variables/query.html">$query</a>,
<a name="l1007"><span class="linenum">1007</span></a>          array('typeid1' =&gt; <a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a>, 'typeid2' =&gt; <a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a>, 'typeid3' =&gt; <a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a>, 'typeid4' =&gt; <a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a>));
<a name="l1008"><span class="linenum">1008</span></a>  
<a name="l1009"><span class="linenum">1009</span></a>      if (!empty(<a class="var it429" onMouseOver="hilite(429)" onMouseOut="lolite()" onClick="logVariable('configs')" href="../../_variables/configs.html">$configs</a>)) {
<a name="l1010"><span class="linenum">1010</span></a>          foreach (<a class="var it429" onMouseOver="hilite(429)" onMouseOut="lolite()" onClick="logVariable('configs')" href="../../_variables/configs.html">$configs</a> as <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>) {
<a name="l1011"><span class="linenum">1011</span></a>              <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>[<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('name')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>] = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('value')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/value.html">value</a>;
<a name="l1012"><span class="linenum">1012</span></a>          }
<a name="l1013"><span class="linenum">1013</span></a>      }
<a name="l1014"><span class="linenum">1014</span></a>  
<a name="l1015"><span class="linenum">1015</span></a>      return <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>;
<a name="l1016"><span class="linenum">1016</span></a>  }
<a name="l1017"><span class="linenum">1017</span></a>  
<a name="l1018"><span class="linenum">1018</span></a>  function <a class="function" onClick="logFunction('lti_get_tools_by_url')" href="../../_functions/lti_get_tools_by_url.html" onMouseOver="funcPopup(event,'lti_get_tools_by_url')">lti_get_tools_by_url</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>, <a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>, <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a> = null) {
<a name="l1019"><span class="linenum">1019</span></a>      <a class="var it8430" onMouseOver="hilite(8430)" onMouseOut="lolite()" onClick="logVariable('domain')" href="../../_variables/domain.html">$domain</a> = <a class="function" onClick="logFunction('lti_get_domain_from_url')" href="../../_functions/lti_get_domain_from_url.html" onMouseOver="funcPopup(event,'lti_get_domain_from_url')">lti_get_domain_from_url</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>);
<a name="l1020"><span class="linenum">1020</span></a>  
<a name="l1021"><span class="linenum">1021</span></a>      return <a class="function" onClick="logFunction('lti_get_tools_by_domain')" href="../../_functions/lti_get_tools_by_domain.html" onMouseOver="funcPopup(event,'lti_get_tools_by_domain')">lti_get_tools_by_domain</a>(<a class="var it8430" onMouseOver="hilite(8430)" onMouseOut="lolite()" onClick="logVariable('domain')" href="../../_variables/domain.html">$domain</a>, <a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>, <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>);
<a name="l1022"><span class="linenum">1022</span></a>  }
<a name="l1023"><span class="linenum">1023</span></a>  
<a name="l1024"><span class="linenum">1024</span></a>  function <a class="function" onClick="logFunction('lti_get_tools_by_domain')" href="../../_functions/lti_get_tools_by_domain.html" onMouseOver="funcPopup(event,'lti_get_tools_by_domain')">lti_get_tools_by_domain</a>(<a class="var it8430" onMouseOver="hilite(8430)" onMouseOut="lolite()" onClick="logVariable('domain')" href="../../_variables/domain.html">$domain</a>, <a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a> = null, <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a> = null) {
<a name="l1025"><span class="linenum">1025</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it940" onMouseOver="hilite(940)" onMouseOut="lolite()" onClick="logVariable('SITE')" href="../../_variables/SITE.html">$SITE</a>;
<a name="l1026"><span class="linenum">1026</span></a>  
<a name="l1027"><span class="linenum">1027</span></a>      <a class="var it655" onMouseOver="hilite(655)" onMouseOut="lolite()" onClick="logVariable('filters')" href="../../_variables/filters.html">$filters</a> = array('tooldomain' =&gt; <a class="var it8430" onMouseOver="hilite(8430)" onMouseOut="lolite()" onClick="logVariable('domain')" href="../../_variables/domain.html">$domain</a>);
<a name="l1028"><span class="linenum">1028</span></a>  
<a name="l1029"><span class="linenum">1029</span></a>      <a class="var it35754" onMouseOver="hilite(35754)" onMouseOut="lolite()" onClick="logVariable('statefilter')" href="../../_variables/statefilter.html">$statefilter</a> = '';
<a name="l1030"><span class="linenum">1030</span></a>      <a class="var it35755" onMouseOver="hilite(35755)" onMouseOut="lolite()" onClick="logVariable('coursefilter')" href="../../_variables/coursefilter.html">$coursefilter</a> = '';
<a name="l1031"><span class="linenum">1031</span></a>  
<a name="l1032"><span class="linenum">1032</span></a>      if (<a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>) {
<a name="l1033"><span class="linenum">1033</span></a>          <a class="var it35754" onMouseOver="hilite(35754)" onMouseOut="lolite()" onClick="logVariable('statefilter')" href="../../_variables/statefilter.html">$statefilter</a> = 'AND state = :state';
<a name="l1034"><span class="linenum">1034</span></a>      }
<a name="l1035"><span class="linenum">1035</span></a>  
<a name="l1036"><span class="linenum">1036</span></a>      if (<a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a> &amp;&amp; <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a> != <a class="var it940" onMouseOver="hilite(940)" onMouseOut="lolite()" onClick="logVariable('SITE')" href="../../_variables/SITE.html">$SITE</a>-&gt;<a onClick="logVariable('id')" class="var it43008" onMouseOver="hilite(43008)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>) {
<a name="l1037"><span class="linenum">1037</span></a>          <a class="var it35755" onMouseOver="hilite(35755)" onMouseOut="lolite()" onClick="logVariable('coursefilter')" href="../../_variables/coursefilter.html">$coursefilter</a> = 'OR course = :courseid';
<a name="l1038"><span class="linenum">1038</span></a>      }
<a name="l1039"><span class="linenum">1039</span></a>  
<a name="l1040"><span class="linenum">1040</span></a>      <a class="var it249" onMouseOver="hilite(249)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../_variables/query.html">$query</a> = &quot;SELECT *
<a name="l1041"><span class="linenum">1041</span></a>                  FROM {lti_types}
<a name="l1042"><span class="linenum">1042</span></a>                 WHERE tooldomain = :tooldomain
<a name="l1043"><span class="linenum">1043</span></a>                   AND (course = :siteid <a class="var it35755" onMouseOver="hilite(35755)" onMouseOut="lolite()" onClick="logVariable('coursefilter')" href="../../_variables/coursefilter.html">$coursefilter</a>)
<a name="l1044"><span class="linenum">1044</span></a>                   <a class="var it35754" onMouseOver="hilite(35754)" onMouseOut="lolite()" onClick="logVariable('statefilter')" href="../../_variables/statefilter.html">$statefilter</a>&quot;;
<a name="l1045"><span class="linenum">1045</span></a>  
<a name="l1046"><span class="linenum">1046</span></a>      return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it249" onMouseOver="hilite(249)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../_variables/query.html">$query</a>, array(
<a name="l1047"><span class="linenum">1047</span></a>          'courseid' =&gt; <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>,
<a name="l1048"><span class="linenum">1048</span></a>          'siteid' =&gt; <a class="var it940" onMouseOver="hilite(940)" onMouseOut="lolite()" onClick="logVariable('SITE')" href="../../_variables/SITE.html">$SITE</a>-&gt;<a onClick="logVariable('id')" class="var it43008" onMouseOver="hilite(43008)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l1049"><span class="linenum">1049</span></a>          'tooldomain' =&gt; <a class="var it8430" onMouseOver="hilite(8430)" onMouseOut="lolite()" onClick="logVariable('domain')" href="../../_variables/domain.html">$domain</a>,
<a name="l1050"><span class="linenum">1050</span></a>          'state' =&gt; <a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>
<a name="l1051"><span class="linenum">1051</span></a>      ));
<a name="l1052"><span class="linenum">1052</span></a>  }
<a name="l1053"><span class="linenum">1053</span></a>  
<a name="l1054"><span class="linenum">1054</span></a>  <span class="comment">/**</span>
<a name="l1055"><span class="linenum">1055</span></a>  <span class="comment"> * Returns all basicLTI tools configured by the administrator</span>
<a name="l1056"><span class="linenum">1056</span></a>  <span class="comment"> *</span>
<a name="l1057"><span class="linenum">1057</span></a>  <span class="comment"> */</span>
<a name="l1058"><span class="linenum">1058</span></a>  function <a class="function" onClick="logFunction('lti_filter_get_types')" href="../../_functions/lti_filter_get_types.html" onMouseOver="funcPopup(event,'lti_filter_get_types')">lti_filter_get_types</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>) {
<a name="l1059"><span class="linenum">1059</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1060"><span class="linenum">1060</span></a>  
<a name="l1061"><span class="linenum">1061</span></a>      if (!empty(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>)) {
<a name="l1062"><span class="linenum">1062</span></a>          <a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a> = &quot;WHERE t.course = :course&quot;;
<a name="l1063"><span class="linenum">1063</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('course' =&gt; <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>);
<a name="l1064"><span class="linenum">1064</span></a>      } else {
<a name="l1065"><span class="linenum">1065</span></a>          <a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a> = '';
<a name="l1066"><span class="linenum">1066</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array();
<a name="l1067"><span class="linenum">1067</span></a>      }
<a name="l1068"><span class="linenum">1068</span></a>      <a class="var it249" onMouseOver="hilite(249)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../_variables/query.html">$query</a> = &quot;SELECT t.id, t.name, t.baseurl, t.state, t.toolproxyid, t.timecreated, tp.name tpname
<a name="l1069"><span class="linenum">1069</span></a>                  FROM {lti_types} t LEFT OUTER JOIN {lti_tool_proxies} tp ON t.toolproxyid = tp.id
<a name="l1070"><span class="linenum">1070</span></a>                  {<a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a>}&quot;;
<a name="l1071"><span class="linenum">1071</span></a>      return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it249" onMouseOver="hilite(249)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../_variables/query.html">$query</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l1072"><span class="linenum">1072</span></a>  }
<a name="l1073"><span class="linenum">1073</span></a>  
<a name="l1074"><span class="linenum">1074</span></a>  <span class="comment">/**</span>
<a name="l1075"><span class="linenum">1075</span></a>  <span class="comment"> * Given an array of tools, filter them based on their state</span>
<a name="l1076"><span class="linenum">1076</span></a>  <span class="comment"> *</span>
<a name="l1077"><span class="linenum">1077</span></a>  <span class="comment"> * @param array $tools An array of lti_types records</span>
<a name="l1078"><span class="linenum">1078</span></a>  <span class="comment"> * @param int $state One of the LTI_TOOL_STATE_* constants</span>
<a name="l1079"><span class="linenum">1079</span></a>  <span class="comment"> * @return array</span>
<a name="l1080"><span class="linenum">1080</span></a>  <span class="comment"> */</span>
<a name="l1081"><span class="linenum">1081</span></a>  function <a class="function" onClick="logFunction('lti_filter_tool_types')" href="../../_functions/lti_filter_tool_types.html" onMouseOver="funcPopup(event,'lti_filter_tool_types')">lti_filter_tool_types</a>(array <a class="var it24702" onMouseOver="hilite(24702)" onMouseOut="lolite()" onClick="logVariable('tools')" href="../../_variables/tools.html">$tools</a>, <a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>) {
<a name="l1082"><span class="linenum">1082</span></a>      <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a> = array();
<a name="l1083"><span class="linenum">1083</span></a>      foreach (<a class="var it24702" onMouseOver="hilite(24702)" onMouseOut="lolite()" onClick="logVariable('tools')" href="../../_variables/tools.html">$tools</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>) {
<a name="l1084"><span class="linenum">1084</span></a>          if (<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('state')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> == <a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>) {
<a name="l1085"><span class="linenum">1085</span></a>              <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>] = <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>;
<a name="l1086"><span class="linenum">1086</span></a>          }
<a name="l1087"><span class="linenum">1087</span></a>      }
<a name="l1088"><span class="linenum">1088</span></a>      return <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a>;
<a name="l1089"><span class="linenum">1089</span></a>  }
<a name="l1090"><span class="linenum">1090</span></a>  
<a name="l1091"><span class="linenum">1091</span></a>  <span class="comment">/**</span>
<a name="l1092"><span class="linenum">1092</span></a>  <span class="comment"> * Returns all lti types visible in this course</span>
<a name="l1093"><span class="linenum">1093</span></a>  <span class="comment"> *</span>
<a name="l1094"><span class="linenum">1094</span></a>  <span class="comment"> * @param int $courseid The id of the course to retieve types for</span>
<a name="l1095"><span class="linenum">1095</span></a>  <span class="comment"> * @param array $coursevisible options for 'coursevisible' field,</span>
<a name="l1096"><span class="linenum">1096</span></a>  <span class="comment"> *        default [LTI_COURSEVISIBLE_PRECONFIGURED, LTI_COURSEVISIBLE_ACTIVITYCHOOSER]</span>
<a name="l1097"><span class="linenum">1097</span></a>  <span class="comment"> * @return stdClass[] All the lti types visible in the given course</span>
<a name="l1098"><span class="linenum">1098</span></a>  <span class="comment"> */</span>
<a name="l1099"><span class="linenum">1099</span></a>  function <a class="function" onClick="logFunction('lti_get_lti_types_by_course')" href="../../_functions/lti_get_lti_types_by_course.html" onMouseOver="funcPopup(event,'lti_get_lti_types_by_course')">lti_get_lti_types_by_course</a>(<a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>, <a class="var it35756" onMouseOver="hilite(35756)" onMouseOut="lolite()" onClick="logVariable('coursevisible')" href="../../_variables/coursevisible.html">$coursevisible</a> = null) {
<a name="l1100"><span class="linenum">1100</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it940" onMouseOver="hilite(940)" onMouseOut="lolite()" onClick="logVariable('SITE')" href="../../_variables/SITE.html">$SITE</a>;
<a name="l1101"><span class="linenum">1101</span></a>  
<a name="l1102"><span class="linenum">1102</span></a>      if (<a class="var it35756" onMouseOver="hilite(35756)" onMouseOut="lolite()" onClick="logVariable('coursevisible')" href="../../_variables/coursevisible.html">$coursevisible</a> === null) {
<a name="l1103"><span class="linenum">1103</span></a>          <a class="var it35756" onMouseOver="hilite(35756)" onMouseOut="lolite()" onClick="logVariable('coursevisible')" href="../../_variables/coursevisible.html">$coursevisible</a> = [<a class="constant" onClick="logConstant('LTI_COURSEVISIBLE_PRECONFIGURED')" href="../../_constants/LTI_COURSEVISIBLE_PRECONFIGURED.html" onMouseOver="constPopup(event,'LTI_COURSEVISIBLE_PRECONFIGURED')">LTI_COURSEVISIBLE_PRECONFIGURED</a>, <a class="constant" onClick="logConstant('LTI_COURSEVISIBLE_ACTIVITYCHOOSER')" href="../../_constants/LTI_COURSEVISIBLE_ACTIVITYCHOOSER.html" onMouseOver="constPopup(event,'LTI_COURSEVISIBLE_ACTIVITYCHOOSER')">LTI_COURSEVISIBLE_ACTIVITYCHOOSER</a>];
<a name="l1104"><span class="linenum">1104</span></a>      }
<a name="l1105"><span class="linenum">1105</span></a>  
<a name="l1106"><span class="linenum">1106</span></a>      <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it35757" onMouseOver="hilite(35757)" onMouseOut="lolite()" onClick="logVariable('coursevisiblesql')" href="../../_variables/coursevisiblesql.html">$coursevisiblesql</a>, <a class="var it35758" onMouseOver="hilite(35758)" onMouseOut="lolite()" onClick="logVariable('coursevisparams')" href="../../_variables/coursevisparams.html">$coursevisparams</a>) = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it35756" onMouseOver="hilite(35756)" onMouseOut="lolite()" onClick="logVariable('coursevisible')" href="../../_variables/coursevisible.html">$coursevisible</a>, <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'coursevisible');
<a name="l1107"><span class="linenum">1107</span></a>      <a class="var it249" onMouseOver="hilite(249)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../_variables/query.html">$query</a> = &quot;SELECT *
<a name="l1108"><span class="linenum">1108</span></a>                  FROM {lti_types}
<a name="l1109"><span class="linenum">1109</span></a>                 WHERE coursevisible <a class="var it35757" onMouseOver="hilite(35757)" onMouseOut="lolite()" onClick="logVariable('coursevisiblesql')" href="../../_variables/coursevisiblesql.html">$coursevisiblesql</a>
<a name="l1110"><span class="linenum">1110</span></a>                   AND (course = :siteid OR course = :courseid)
<a name="l1111"><span class="linenum">1111</span></a>                   AND state = :active&quot;;
<a name="l1112"><span class="linenum">1112</span></a>  
<a name="l1113"><span class="linenum">1113</span></a>      return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it249" onMouseOver="hilite(249)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../_variables/query.html">$query</a>,
<a name="l1114"><span class="linenum">1114</span></a>          array('siteid' =&gt; <a class="var it940" onMouseOver="hilite(940)" onMouseOut="lolite()" onClick="logVariable('SITE')" href="../../_variables/SITE.html">$SITE</a>-&gt;<a onClick="logVariable('id')" class="var it43008" onMouseOver="hilite(43008)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'courseid' =&gt; <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>, 'active' =&gt; <a class="constant" onClick="logConstant('LTI_TOOL_STATE_CONFIGURED')" href="../../_constants/LTI_TOOL_STATE_CONFIGURED.html" onMouseOver="constPopup(event,'LTI_TOOL_STATE_CONFIGURED')">LTI_TOOL_STATE_CONFIGURED</a>) + <a class="var it35758" onMouseOver="hilite(35758)" onMouseOut="lolite()" onClick="logVariable('coursevisparams')" href="../../_variables/coursevisparams.html">$coursevisparams</a>);
<a name="l1115"><span class="linenum">1115</span></a>  }
<a name="l1116"><span class="linenum">1116</span></a>  
<a name="l1117"><span class="linenum">1117</span></a>  <span class="comment">/**</span>
<a name="l1118"><span class="linenum">1118</span></a>  <span class="comment"> * Returns tool types for lti add instance and edit page</span>
<a name="l1119"><span class="linenum">1119</span></a>  <span class="comment"> *</span>
<a name="l1120"><span class="linenum">1120</span></a>  <span class="comment"> * @return array Array of lti types</span>
<a name="l1121"><span class="linenum">1121</span></a>  <span class="comment"> */</span>
<a name="l1122"><span class="linenum">1122</span></a>  function <a class="function" onClick="logFunction('lti_get_types_for_add_instance')" href="../../_functions/lti_get_types_for_add_instance.html" onMouseOver="funcPopup(event,'lti_get_types_for_add_instance')">lti_get_types_for_add_instance</a>() {
<a name="l1123"><span class="linenum">1123</span></a>      global <a class="var it586" onMouseOver="hilite(586)" onMouseOut="lolite()" onClick="logVariable('COURSE')" href="../../_variables/COURSE.html">$COURSE</a>;
<a name="l1124"><span class="linenum">1124</span></a>      <a class="var it35759" onMouseOver="hilite(35759)" onMouseOut="lolite()" onClick="logVariable('admintypes')" href="../../_variables/admintypes.html">$admintypes</a> = <a class="function" onClick="logFunction('lti_get_lti_types_by_course')" href="../../_functions/lti_get_lti_types_by_course.html" onMouseOver="funcPopup(event,'lti_get_lti_types_by_course')">lti_get_lti_types_by_course</a>(<a class="var it586" onMouseOver="hilite(586)" onMouseOut="lolite()" onClick="logVariable('COURSE')" href="../../_variables/COURSE.html">$COURSE</a>-&gt;<a onClick="logVariable('id')" class="var it43316" onMouseOver="hilite(43316)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l1125"><span class="linenum">1125</span></a>  
<a name="l1126"><span class="linenum">1126</span></a>      <a class="var it1455" onMouseOver="hilite(1455)" onMouseOut="lolite()" onClick="logVariable('types')" href="../../_variables/types.html">$types</a> = array();
<a name="l1127"><span class="linenum">1127</span></a>      <a class="var it1455" onMouseOver="hilite(1455)" onMouseOut="lolite()" onClick="logVariable('types')" href="../../_variables/types.html">$types</a>[0] = (object)array('name' =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('automatic', 'lti'), 'course' =&gt; 0, 'toolproxyid' =&gt; null);
<a name="l1128"><span class="linenum">1128</span></a>  
<a name="l1129"><span class="linenum">1129</span></a>      foreach (<a class="var it35759" onMouseOver="hilite(35759)" onMouseOut="lolite()" onClick="logVariable('admintypes')" href="../../_variables/admintypes.html">$admintypes</a> as <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>) {
<a name="l1130"><span class="linenum">1130</span></a>          <a class="var it1455" onMouseOver="hilite(1455)" onMouseOut="lolite()" onClick="logVariable('types')" href="../../_variables/types.html">$types</a>[<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('id')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>] = <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>;
<a name="l1131"><span class="linenum">1131</span></a>      }
<a name="l1132"><span class="linenum">1132</span></a>  
<a name="l1133"><span class="linenum">1133</span></a>      return <a class="var it1455" onMouseOver="hilite(1455)" onMouseOut="lolite()" onClick="logVariable('types')" href="../../_variables/types.html">$types</a>;
<a name="l1134"><span class="linenum">1134</span></a>  }
<a name="l1135"><span class="linenum">1135</span></a>  
<a name="l1136"><span class="linenum">1136</span></a>  <span class="comment">/**</span>
<a name="l1137"><span class="linenum">1137</span></a>  <span class="comment"> * Returns a list of configured types in the given course</span>
<a name="l1138"><span class="linenum">1138</span></a>  <span class="comment"> *</span>
<a name="l1139"><span class="linenum">1139</span></a>  <span class="comment"> * @param int $courseid The id of the course to retieve types for</span>
<a name="l1140"><span class="linenum">1140</span></a>  <span class="comment"> * @param int $sectionreturn section to return to for forming the URLs</span>
<a name="l1141"><span class="linenum">1141</span></a>  <span class="comment"> * @return array Array of lti types. Each element is object with properties: name, title, icon, help, helplink, link</span>
<a name="l1142"><span class="linenum">1142</span></a>  <span class="comment"> */</span>
<a name="l1143"><span class="linenum">1143</span></a>  function <a class="function" onClick="logFunction('lti_get_configured_types')" href="../../_functions/lti_get_configured_types.html" onMouseOver="funcPopup(event,'lti_get_configured_types')">lti_get_configured_types</a>(<a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>, <a class="var it2592" onMouseOver="hilite(2592)" onMouseOut="lolite()" onClick="logVariable('sectionreturn')" href="../../_variables/sectionreturn.html">$sectionreturn</a> = 0) {
<a name="l1144"><span class="linenum">1144</span></a>      global <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>;
<a name="l1145"><span class="linenum">1145</span></a>      <a class="var it1455" onMouseOver="hilite(1455)" onMouseOut="lolite()" onClick="logVariable('types')" href="../../_variables/types.html">$types</a> = array();
<a name="l1146"><span class="linenum">1146</span></a>      <a class="var it35759" onMouseOver="hilite(35759)" onMouseOut="lolite()" onClick="logVariable('admintypes')" href="../../_variables/admintypes.html">$admintypes</a> = <a class="function" onClick="logFunction('lti_get_lti_types_by_course')" href="../../_functions/lti_get_lti_types_by_course.html" onMouseOver="funcPopup(event,'lti_get_lti_types_by_course')">lti_get_lti_types_by_course</a>(<a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>, [<a class="constant" onClick="logConstant('LTI_COURSEVISIBLE_ACTIVITYCHOOSER')" href="../../_constants/LTI_COURSEVISIBLE_ACTIVITYCHOOSER.html" onMouseOver="constPopup(event,'LTI_COURSEVISIBLE_ACTIVITYCHOOSER')">LTI_COURSEVISIBLE_ACTIVITYCHOOSER</a>]);
<a name="l1147"><span class="linenum">1147</span></a>  
<a name="l1148"><span class="linenum">1148</span></a>      foreach (<a class="var it35759" onMouseOver="hilite(35759)" onMouseOut="lolite()" onClick="logVariable('admintypes')" href="../../_variables/admintypes.html">$admintypes</a> as <a class="var it23743" onMouseOver="hilite(23743)" onMouseOut="lolite()" onClick="logVariable('ltitype')" href="../../_variables/ltitype.html">$ltitype</a>) {
<a name="l1149"><span class="linenum">1149</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>           = new stdClass();
<a name="l1150"><span class="linenum">1150</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('modclass')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/modclass.html">modclass</a> = <a class="constant" onClick="logConstant('MOD_CLASS_ACTIVITY')" href="../../_constants/MOD_CLASS_ACTIVITY.html" onMouseOver="constPopup(event,'MOD_CLASS_ACTIVITY')">MOD_CLASS_ACTIVITY</a>;
<a name="l1151"><span class="linenum">1151</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('name')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>     = 'lti_type_' . <a class="var it23743" onMouseOver="hilite(23743)" onMouseOut="lolite()" onClick="logVariable('ltitype')" href="../../_variables/ltitype.html">$ltitype</a>-&gt;<a onClick="logVariable('id')" class="var it45440" onMouseOver="hilite(45440)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l1152"><span class="linenum">1152</span></a>  <span class="comment">        // Clean the name. We don't want tags here.</span>
<a name="l1153"><span class="linenum">1153</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('title')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/title.html">title</a>    = <a class="function" onClick="logFunction('clean_param')" href="../../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it23743" onMouseOver="hilite(23743)" onMouseOut="lolite()" onClick="logVariable('ltitype')" href="../../_variables/ltitype.html">$ltitype</a>-&gt;<a onClick="logVariable('name')" class="var it45440" onMouseOver="hilite(45440)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>, <a class="constant" onClick="logConstant('PARAM_NOTAGS')" href="../../_constants/PARAM_NOTAGS.html" onMouseOver="constPopup(event,'PARAM_NOTAGS')">PARAM_NOTAGS</a>);
<a name="l1154"><span class="linenum">1154</span></a>          <a class="var it35760" onMouseOver="hilite(35760)" onMouseOut="lolite()" onClick="logVariable('trimmeddescription')" href="../../_variables/trimmeddescription.html">$trimmeddescription</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it23743" onMouseOver="hilite(23743)" onMouseOut="lolite()" onClick="logVariable('ltitype')" href="../../_variables/ltitype.html">$ltitype</a>-&gt;<a onClick="logVariable('description')" class="var it45440" onMouseOver="hilite(45440)" onMouseOut="lolite()" href="../../_variables/description.html">description</a>);
<a name="l1155"><span class="linenum">1155</span></a>          if (<a class="var it35760" onMouseOver="hilite(35760)" onMouseOut="lolite()" onClick="logVariable('trimmeddescription')" href="../../_variables/trimmeddescription.html">$trimmeddescription</a> != '') {
<a name="l1156"><span class="linenum">1156</span></a>  <span class="comment">            // Clean the description. We don't want tags here.</span>
<a name="l1157"><span class="linenum">1157</span></a>              <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('help')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/help.html">help</a>     = <a class="function" onClick="logFunction('clean_param')" href="../../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it35760" onMouseOver="hilite(35760)" onMouseOut="lolite()" onClick="logVariable('trimmeddescription')" href="../../_variables/trimmeddescription.html">$trimmeddescription</a>, <a class="constant" onClick="logConstant('PARAM_NOTAGS')" href="../../_constants/PARAM_NOTAGS.html" onMouseOver="constPopup(event,'PARAM_NOTAGS')">PARAM_NOTAGS</a>);
<a name="l1158"><span class="linenum">1158</span></a>              <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('helplink')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/helplink.html">helplink</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('modulename_shortcut_link', 'lti');
<a name="l1159"><span class="linenum">1159</span></a>          }
<a name="l1160"><span class="linenum">1160</span></a>          if (empty(<a class="var it23743" onMouseOver="hilite(23743)" onMouseOut="lolite()" onClick="logVariable('ltitype')" href="../../_variables/ltitype.html">$ltitype</a>-&gt;<a onClick="logVariable('icon')" class="var it45440" onMouseOver="hilite(45440)" onMouseOut="lolite()" href="../../_variables/icon.html">icon</a>)) {
<a name="l1161"><span class="linenum">1161</span></a>              <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('icon')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/icon.html">icon</a> = <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('pix_icon')" href="../../_functions/pix_icon.html" onMouseOver="funcPopup(event,'pix_icon')">pix_icon</a>('icon', '', 'lti', array('class' =&gt; 'icon'));
<a name="l1162"><span class="linenum">1162</span></a>          } else {
<a name="l1163"><span class="linenum">1163</span></a>              <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('icon')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/icon.html">icon</a> = <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('empty_tag')" href="../../_functions/empty_tag.html" onMouseOver="funcPopup(event,'empty_tag')">empty_tag</a>('img', array('src' =&gt; <a class="var it23743" onMouseOver="hilite(23743)" onMouseOut="lolite()" onClick="logVariable('ltitype')" href="../../_variables/ltitype.html">$ltitype</a>-&gt;<a onClick="logVariable('icon')" class="var it45440" onMouseOver="hilite(45440)" onMouseOut="lolite()" href="../../_variables/icon.html">icon</a>, 'alt' =&gt; <a class="var it23743" onMouseOver="hilite(23743)" onMouseOut="lolite()" onClick="logVariable('ltitype')" href="../../_variables/ltitype.html">$ltitype</a>-&gt;<a onClick="logVariable('name')" class="var it45440" onMouseOver="hilite(45440)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>, 'class' =&gt; 'icon'));
<a name="l1164"><span class="linenum">1164</span></a>          }
<a name="l1165"><span class="linenum">1165</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('link')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/link.html">link</a> = <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../course/modedit.php.html">/course/modedit.php</a>', array('add' =&gt; 'lti', 'return' =&gt; 0, 'course' =&gt; <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>,
<a name="l1166"><span class="linenum">1166</span></a>              'sr' =&gt; <a class="var it2592" onMouseOver="hilite(2592)" onMouseOut="lolite()" onClick="logVariable('sectionreturn')" href="../../_variables/sectionreturn.html">$sectionreturn</a>, 'typeid' =&gt; <a class="var it23743" onMouseOver="hilite(23743)" onMouseOut="lolite()" onClick="logVariable('ltitype')" href="../../_variables/ltitype.html">$ltitype</a>-&gt;<a onClick="logVariable('id')" class="var it45440" onMouseOver="hilite(45440)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l1167"><span class="linenum">1167</span></a>          <a class="var it1455" onMouseOver="hilite(1455)" onMouseOut="lolite()" onClick="logVariable('types')" href="../../_variables/types.html">$types</a>[] = <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>;
<a name="l1168"><span class="linenum">1168</span></a>      }
<a name="l1169"><span class="linenum">1169</span></a>      return <a class="var it1455" onMouseOver="hilite(1455)" onMouseOut="lolite()" onClick="logVariable('types')" href="../../_variables/types.html">$types</a>;
<a name="l1170"><span class="linenum">1170</span></a>  }
<a name="l1171"><span class="linenum">1171</span></a>  
<a name="l1172"><span class="linenum">1172</span></a>  function <a class="function" onClick="logFunction('lti_get_domain_from_url')" href="../../_functions/lti_get_domain_from_url.html" onMouseOver="funcPopup(event,'lti_get_domain_from_url')">lti_get_domain_from_url</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>) {
<a name="l1173"><span class="linenum">1173</span></a>      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a> = array();
<a name="l1174"><span class="linenum">1174</span></a>  
<a name="l1175"><span class="linenum">1175</span></a>      if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>(<a class="constant" onClick="logConstant('LTI_URL_DOMAIN_REGEX')" href="../../_constants/LTI_URL_DOMAIN_REGEX.html" onMouseOver="constPopup(event,'LTI_URL_DOMAIN_REGEX')">LTI_URL_DOMAIN_REGEX</a>, <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>, <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>)) {
<a name="l1176"><span class="linenum">1176</span></a>          return <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l1177"><span class="linenum">1177</span></a>      }
<a name="l1178"><span class="linenum">1178</span></a>  }
<a name="l1179"><span class="linenum">1179</span></a>  
<a name="l1180"><span class="linenum">1180</span></a>  function <a class="function" onClick="logFunction('lti_get_tool_by_url_match')" href="../../_functions/lti_get_tool_by_url_match.html" onMouseOver="funcPopup(event,'lti_get_tool_by_url_match')">lti_get_tool_by_url_match</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>, <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a> = null, <a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a> = <a class="constant" onClick="logConstant('LTI_TOOL_STATE_CONFIGURED')" href="../../_constants/LTI_TOOL_STATE_CONFIGURED.html" onMouseOver="constPopup(event,'LTI_TOOL_STATE_CONFIGURED')">LTI_TOOL_STATE_CONFIGURED</a>) {
<a name="l1181"><span class="linenum">1181</span></a>      <a class="var it35761" onMouseOver="hilite(35761)" onMouseOut="lolite()" onClick="logVariable('possibletools')" href="../../_variables/possibletools.html">$possibletools</a> = <a class="function" onClick="logFunction('lti_get_tools_by_url')" href="../../_functions/lti_get_tools_by_url.html" onMouseOver="funcPopup(event,'lti_get_tools_by_url')">lti_get_tools_by_url</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>, <a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>, <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>);
<a name="l1182"><span class="linenum">1182</span></a>  
<a name="l1183"><span class="linenum">1183</span></a>      return <a class="function" onClick="logFunction('lti_get_best_tool_by_url')" href="../../_functions/lti_get_best_tool_by_url.html" onMouseOver="funcPopup(event,'lti_get_best_tool_by_url')">lti_get_best_tool_by_url</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>, <a class="var it35761" onMouseOver="hilite(35761)" onMouseOut="lolite()" onClick="logVariable('possibletools')" href="../../_variables/possibletools.html">$possibletools</a>, <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>);
<a name="l1184"><span class="linenum">1184</span></a>  }
<a name="l1185"><span class="linenum">1185</span></a>  
<a name="l1186"><span class="linenum">1186</span></a>  function <a class="function" onClick="logFunction('lti_get_url_thumbprint')" href="../../_functions/lti_get_url_thumbprint.html" onMouseOver="funcPopup(event,'lti_get_url_thumbprint')">lti_get_url_thumbprint</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>) {
<a name="l1187"><span class="linenum">1187</span></a>  <span class="comment">    // Parse URL requires a schema otherwise everything goes into 'path'.  Fixed 5.4.7 or later.</span>
<a name="l1188"><span class="linenum">1188</span></a>      if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/https?:\/\//', <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>) !== 1) {
<a name="l1189"><span class="linenum">1189</span></a>          <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = 'http://'.<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>;
<a name="l1190"><span class="linenum">1190</span></a>      }
<a name="l1191"><span class="linenum">1191</span></a>      <a class="var it25179" onMouseOver="hilite(25179)" onMouseOut="lolite()" onClick="logVariable('urlparts')" href="../../_variables/urlparts.html">$urlparts</a> = <a class="phpfunction" onClick="logFunction('parse_url')" href="../../_functions/parse_url.html" onMouseOver="phpfuncPopup(event,'parse_url')">parse_url</a>(<a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>));
<a name="l1192"><span class="linenum">1192</span></a>      if (!isset(<a class="var it25179" onMouseOver="hilite(25179)" onMouseOut="lolite()" onClick="logVariable('urlparts')" href="../../_variables/urlparts.html">$urlparts</a>['path'])) {
<a name="l1193"><span class="linenum">1193</span></a>          <a class="var it25179" onMouseOver="hilite(25179)" onMouseOut="lolite()" onClick="logVariable('urlparts')" href="../../_variables/urlparts.html">$urlparts</a>['path'] = '';
<a name="l1194"><span class="linenum">1194</span></a>      }
<a name="l1195"><span class="linenum">1195</span></a>  
<a name="l1196"><span class="linenum">1196</span></a>      if (!isset(<a class="var it25179" onMouseOver="hilite(25179)" onMouseOut="lolite()" onClick="logVariable('urlparts')" href="../../_variables/urlparts.html">$urlparts</a>['host'])) {
<a name="l1197"><span class="linenum">1197</span></a>          <a class="var it25179" onMouseOver="hilite(25179)" onMouseOut="lolite()" onClick="logVariable('urlparts')" href="../../_variables/urlparts.html">$urlparts</a>['host'] = '';
<a name="l1198"><span class="linenum">1198</span></a>      }
<a name="l1199"><span class="linenum">1199</span></a>  
<a name="l1200"><span class="linenum">1200</span></a>      if (<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it25179" onMouseOver="hilite(25179)" onMouseOut="lolite()" onClick="logVariable('urlparts')" href="../../_variables/urlparts.html">$urlparts</a>['host'], 0, 4) === 'www.') {
<a name="l1201"><span class="linenum">1201</span></a>          <a class="var it25179" onMouseOver="hilite(25179)" onMouseOut="lolite()" onClick="logVariable('urlparts')" href="../../_variables/urlparts.html">$urlparts</a>['host'] = <a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it25179" onMouseOver="hilite(25179)" onMouseOut="lolite()" onClick="logVariable('urlparts')" href="../../_variables/urlparts.html">$urlparts</a>['host'], 4);
<a name="l1202"><span class="linenum">1202</span></a>      }
<a name="l1203"><span class="linenum">1203</span></a>  
<a name="l1204"><span class="linenum">1204</span></a>      return <a class="var it35762" onMouseOver="hilite(35762)" onMouseOut="lolite()" onClick="logVariable('urllower')" href="../../_variables/urllower.html">$urllower</a> = <a class="var it25179" onMouseOver="hilite(25179)" onMouseOut="lolite()" onClick="logVariable('urlparts')" href="../../_variables/urlparts.html">$urlparts</a>['host'] . '/' . <a class="var it25179" onMouseOver="hilite(25179)" onMouseOut="lolite()" onClick="logVariable('urlparts')" href="../../_variables/urlparts.html">$urlparts</a>['path'];
<a name="l1205"><span class="linenum">1205</span></a>  }
<a name="l1206"><span class="linenum">1206</span></a>  
<a name="l1207"><span class="linenum">1207</span></a>  function <a class="function" onClick="logFunction('lti_get_best_tool_by_url')" href="../../_functions/lti_get_best_tool_by_url.html" onMouseOver="funcPopup(event,'lti_get_best_tool_by_url')">lti_get_best_tool_by_url</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>, <a class="var it24702" onMouseOver="hilite(24702)" onMouseOut="lolite()" onClick="logVariable('tools')" href="../../_variables/tools.html">$tools</a>, <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a> = null) {
<a name="l1208"><span class="linenum">1208</span></a>      if (<a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it24702" onMouseOver="hilite(24702)" onMouseOut="lolite()" onClick="logVariable('tools')" href="../../_variables/tools.html">$tools</a>) === 0) {
<a name="l1209"><span class="linenum">1209</span></a>          return null;
<a name="l1210"><span class="linenum">1210</span></a>      }
<a name="l1211"><span class="linenum">1211</span></a>  
<a name="l1212"><span class="linenum">1212</span></a>      <a class="var it35762" onMouseOver="hilite(35762)" onMouseOut="lolite()" onClick="logVariable('urllower')" href="../../_variables/urllower.html">$urllower</a> = <a class="function" onClick="logFunction('lti_get_url_thumbprint')" href="../../_functions/lti_get_url_thumbprint.html" onMouseOver="funcPopup(event,'lti_get_url_thumbprint')">lti_get_url_thumbprint</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>);
<a name="l1213"><span class="linenum">1213</span></a>  
<a name="l1214"><span class="linenum">1214</span></a>      foreach (<a class="var it24702" onMouseOver="hilite(24702)" onMouseOut="lolite()" onClick="logVariable('tools')" href="../../_variables/tools.html">$tools</a> as <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>) {
<a name="l1215"><span class="linenum">1215</span></a>          <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('_matchscore')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/_matchscore.html">_matchscore</a> = 0;
<a name="l1216"><span class="linenum">1216</span></a>  
<a name="l1217"><span class="linenum">1217</span></a>          <a class="var it35764" onMouseOver="hilite(35764)" onMouseOut="lolite()" onClick="logVariable('toolbaseurllower')" href="../../_variables/toolbaseurllower.html">$toolbaseurllower</a> = <a class="function" onClick="logFunction('lti_get_url_thumbprint')" href="../../_functions/lti_get_url_thumbprint.html" onMouseOver="funcPopup(event,'lti_get_url_thumbprint')">lti_get_url_thumbprint</a>(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('baseurl')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/baseurl.html">baseurl</a>);
<a name="l1218"><span class="linenum">1218</span></a>  
<a name="l1219"><span class="linenum">1219</span></a>          if (<a class="var it35762" onMouseOver="hilite(35762)" onMouseOut="lolite()" onClick="logVariable('urllower')" href="../../_variables/urllower.html">$urllower</a> === <a class="var it35764" onMouseOver="hilite(35764)" onMouseOut="lolite()" onClick="logVariable('toolbaseurllower')" href="../../_variables/toolbaseurllower.html">$toolbaseurllower</a>) {
<a name="l1220"><span class="linenum">1220</span></a>  <span class="comment">            // 100 points for exact thumbprint match.</span>
<a name="l1221"><span class="linenum">1221</span></a>              <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('_matchscore')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/_matchscore.html">_matchscore</a> += 100;
<a name="l1222"><span class="linenum">1222</span></a>          } else if (<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it35762" onMouseOver="hilite(35762)" onMouseOut="lolite()" onClick="logVariable('urllower')" href="../../_variables/urllower.html">$urllower</a>, 0, <a class="function" onClick="logFunction('strlen')" href="../../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it35764" onMouseOver="hilite(35764)" onMouseOut="lolite()" onClick="logVariable('toolbaseurllower')" href="../../_variables/toolbaseurllower.html">$toolbaseurllower</a>)) === <a class="var it35764" onMouseOver="hilite(35764)" onMouseOut="lolite()" onClick="logVariable('toolbaseurllower')" href="../../_variables/toolbaseurllower.html">$toolbaseurllower</a>) {
<a name="l1223"><span class="linenum">1223</span></a>  <span class="comment">            // 50 points if tool thumbprint starts with the base URL thumbprint.</span>
<a name="l1224"><span class="linenum">1224</span></a>              <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('_matchscore')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/_matchscore.html">_matchscore</a> += 50;
<a name="l1225"><span class="linenum">1225</span></a>          }
<a name="l1226"><span class="linenum">1226</span></a>  
<a name="l1227"><span class="linenum">1227</span></a>  <span class="comment">        // Prefer course tools over site tools.</span>
<a name="l1228"><span class="linenum">1228</span></a>          if (!empty(<a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>)) {
<a name="l1229"><span class="linenum">1229</span></a>  <span class="comment">            // Minus 10 points for not matching the course id (global tools).</span>
<a name="l1230"><span class="linenum">1230</span></a>              if (<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('course')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/course.html">course</a> != <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>) {
<a name="l1231"><span class="linenum">1231</span></a>                  <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('_matchscore')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/_matchscore.html">_matchscore</a> -= 10;
<a name="l1232"><span class="linenum">1232</span></a>              }
<a name="l1233"><span class="linenum">1233</span></a>          }
<a name="l1234"><span class="linenum">1234</span></a>      }
<a name="l1235"><span class="linenum">1235</span></a>  
<a name="l1236"><span class="linenum">1236</span></a>      <a class="var it35765" onMouseOver="hilite(35765)" onMouseOut="lolite()" onClick="logVariable('bestmatch')" href="../../_variables/bestmatch.html">$bestmatch</a> = <a class="phpfunction" onClick="logFunction('array_reduce')" href="../../_functions/array_reduce.html" onMouseOver="phpfuncPopup(event,'array_reduce')">array_reduce</a>(<a class="var it24702" onMouseOver="hilite(24702)" onMouseOut="lolite()" onClick="logVariable('tools')" href="../../_variables/tools.html">$tools</a>, function(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>, <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>) {
<a name="l1237"><span class="linenum">1237</span></a>          if (<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('_matchscore')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/_matchscore.html">_matchscore</a> &gt; <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>-&gt;<a onClick="logVariable('_matchscore')" class="var it43035" onMouseOver="hilite(43035)" onMouseOut="lolite()" href="../../_variables/_matchscore.html">_matchscore</a>) {
<a name="l1238"><span class="linenum">1238</span></a>              return <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>;
<a name="l1239"><span class="linenum">1239</span></a>          } else {
<a name="l1240"><span class="linenum">1240</span></a>              return <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l1241"><span class="linenum">1241</span></a>          }
<a name="l1242"><span class="linenum">1242</span></a>  
<a name="l1243"><span class="linenum">1243</span></a>      }, (object)array('_matchscore' =&gt; -1));
<a name="l1244"><span class="linenum">1244</span></a>  
<a name="l1245"><span class="linenum">1245</span></a>  <span class="comment">    // None of the tools are suitable for this URL.</span>
<a name="l1246"><span class="linenum">1246</span></a>      if (<a class="var it35765" onMouseOver="hilite(35765)" onMouseOut="lolite()" onClick="logVariable('bestmatch')" href="../../_variables/bestmatch.html">$bestmatch</a>-&gt;<a onClick="logVariable('_matchscore')" class="var it45511" onMouseOver="hilite(45511)" onMouseOut="lolite()" href="../../_variables/_matchscore.html">_matchscore</a> &lt;= 0) {
<a name="l1247"><span class="linenum">1247</span></a>          return null;
<a name="l1248"><span class="linenum">1248</span></a>      }
<a name="l1249"><span class="linenum">1249</span></a>  
<a name="l1250"><span class="linenum">1250</span></a>      return <a class="var it35765" onMouseOver="hilite(35765)" onMouseOut="lolite()" onClick="logVariable('bestmatch')" href="../../_variables/bestmatch.html">$bestmatch</a>;
<a name="l1251"><span class="linenum">1251</span></a>  }
<a name="l1252"><span class="linenum">1252</span></a>  
<a name="l1253"><span class="linenum">1253</span></a>  function <a class="function" onClick="logFunction('lti_get_shared_secrets_by_key')" href="../../_functions/lti_get_shared_secrets_by_key.html" onMouseOver="funcPopup(event,'lti_get_shared_secrets_by_key')">lti_get_shared_secrets_by_key</a>(<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>) {
<a name="l1254"><span class="linenum">1254</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1255"><span class="linenum">1255</span></a>  
<a name="l1256"><span class="linenum">1256</span></a>  <span class="comment">    // Look up the shared secret for the specified key in both the types_config table (for configured tools)</span>
<a name="l1257"><span class="linenum">1257</span></a>  <span class="comment">    // And in the lti resource table for ad-hoc tools.</span>
<a name="l1258"><span class="linenum">1258</span></a>      <a class="var it249" onMouseOver="hilite(249)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../_variables/query.html">$query</a> = &quot;SELECT t2.value
<a name="l1259"><span class="linenum">1259</span></a>                  FROM {lti_types_config} t1
<a name="l1260"><span class="linenum">1260</span></a>                  JOIN {lti_types_config} t2 ON t1.typeid = t2.typeid
<a name="l1261"><span class="linenum">1261</span></a>                  JOIN {lti_types} type ON t2.typeid = type.id
<a name="l1262"><span class="linenum">1262</span></a>                WHERE t1.name = 'resourcekey'
<a name="l1263"><span class="linenum">1263</span></a>                  AND t1.value = :key1
<a name="l1264"><span class="linenum">1264</span></a>                  AND t2.name = 'password'
<a name="l1265"><span class="linenum">1265</span></a>                  AND type.state = :configured1
<a name="l1266"><span class="linenum">1266</span></a>                 UNION
<a name="l1267"><span class="linenum">1267</span></a>                SELECT tp.secret AS value
<a name="l1268"><span class="linenum">1268</span></a>                  FROM {lti_tool_proxies} tp
<a name="l1269"><span class="linenum">1269</span></a>                  JOIN {lti_types} t ON tp.id = t.toolproxyid
<a name="l1270"><span class="linenum">1270</span></a>                WHERE tp.guid = :key2
<a name="l1271"><span class="linenum">1271</span></a>                  AND t.state = :configured2
<a name="l1272"><span class="linenum">1272</span></a>                UNION
<a name="l1273"><span class="linenum">1273</span></a>               SELECT password AS value
<a name="l1274"><span class="linenum">1274</span></a>                 FROM {lti}
<a name="l1275"><span class="linenum">1275</span></a>                WHERE resourcekey = :key3&quot;;
<a name="l1276"><span class="linenum">1276</span></a>  
<a name="l1277"><span class="linenum">1277</span></a>      <a class="var it30845" onMouseOver="hilite(30845)" onMouseOut="lolite()" onClick="logVariable('sharedsecrets')" href="../../_variables/sharedsecrets.html">$sharedsecrets</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it249" onMouseOver="hilite(249)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../_variables/query.html">$query</a>, array('configured1' =&gt; <a class="constant" onClick="logConstant('LTI_TOOL_STATE_CONFIGURED')" href="../../_constants/LTI_TOOL_STATE_CONFIGURED.html" onMouseOver="constPopup(event,'LTI_TOOL_STATE_CONFIGURED')">LTI_TOOL_STATE_CONFIGURED</a>,
<a name="l1278"><span class="linenum">1278</span></a>          'configured2' =&gt; <a class="constant" onClick="logConstant('LTI_TOOL_STATE_CONFIGURED')" href="../../_constants/LTI_TOOL_STATE_CONFIGURED.html" onMouseOver="constPopup(event,'LTI_TOOL_STATE_CONFIGURED')">LTI_TOOL_STATE_CONFIGURED</a>, 'key1' =&gt; <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>, 'key2' =&gt; <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>, 'key3' =&gt; <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>));
<a name="l1279"><span class="linenum">1279</span></a>  
<a name="l1280"><span class="linenum">1280</span></a>      <a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a> = <a class="phpfunction" onClick="logFunction('array_map')" href="../../_functions/array_map.html" onMouseOver="phpfuncPopup(event,'array_map')">array_map</a>(function(<a class="var it749" onMouseOver="hilite(749)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>) {
<a name="l1281"><span class="linenum">1281</span></a>          return <a class="var it749" onMouseOver="hilite(749)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>-&gt;<a onClick="logVariable('value')" class="var it42962" onMouseOver="hilite(42962)" onMouseOut="lolite()" href="../../_variables/value.html">value</a>;
<a name="l1282"><span class="linenum">1282</span></a>      }, <a class="var it30845" onMouseOver="hilite(30845)" onMouseOut="lolite()" onClick="logVariable('sharedsecrets')" href="../../_variables/sharedsecrets.html">$sharedsecrets</a>);
<a name="l1283"><span class="linenum">1283</span></a>  
<a name="l1284"><span class="linenum">1284</span></a>  <span class="comment">    // There should really only be one shared secret per key. But, we can't prevent</span>
<a name="l1285"><span class="linenum">1285</span></a>  <span class="comment">    // more than one getting entered. For instance, if the same key is used for two tool providers.</span>
<a name="l1286"><span class="linenum">1286</span></a>      return <a class="var it753" onMouseOver="hilite(753)" onMouseOut="lolite()" onClick="logVariable('values')" href="../../_variables/values.html">$values</a>;
<a name="l1287"><span class="linenum">1287</span></a>  }
<a name="l1288"><span class="linenum">1288</span></a>  
<a name="l1289"><span class="linenum">1289</span></a>  <span class="comment">/**</span>
<a name="l1290"><span class="linenum">1290</span></a>  <span class="comment"> * Delete a Basic LTI configuration</span>
<a name="l1291"><span class="linenum">1291</span></a>  <span class="comment"> *</span>
<a name="l1292"><span class="linenum">1292</span></a>  <span class="comment"> * @param int $id   Configuration id</span>
<a name="l1293"><span class="linenum">1293</span></a>  <span class="comment"> */</span>
<a name="l1294"><span class="linenum">1294</span></a>  function <a class="function" onClick="logFunction('lti_delete_type')" href="../../_functions/lti_delete_type.html" onMouseOver="funcPopup(event,'lti_delete_type')">lti_delete_type</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>) {
<a name="l1295"><span class="linenum">1295</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1296"><span class="linenum">1296</span></a>  
<a name="l1297"><span class="linenum">1297</span></a>  <span class="comment">    // We should probably just copy the launch URL to the tool instances in this case... using a single query.</span>
<a name="l1298"><span class="linenum">1298</span></a>      <span class="comment">/*</span>
<a name="l1299"><span class="linenum">1299</span></a>  <span class="comment">    $instances = $DB-&gt;get_records('lti', array('typeid' =&gt; $id));</span>
<a name="l1300"><span class="linenum">1300</span></a>  <span class="comment">    foreach ($instances as $instance) {</span>
<a name="l1301"><span class="linenum">1301</span></a>  <span class="comment">        $instance-&gt;typeid = 0;</span>
<a name="l1302"><span class="linenum">1302</span></a>  <span class="comment">        $DB-&gt;update_record('lti', $instance);</span>
<a name="l1303"><span class="linenum">1303</span></a>  <span class="comment">    }*/</span>
<a name="l1304"><span class="linenum">1304</span></a>  
<a name="l1305"><span class="linenum">1305</span></a>      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('lti_types', array('id' =&gt; <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>));
<a name="l1306"><span class="linenum">1306</span></a>      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('lti_types_config', array('typeid' =&gt; <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>));
<a name="l1307"><span class="linenum">1307</span></a>  }
<a name="l1308"><span class="linenum">1308</span></a>  
<a name="l1309"><span class="linenum">1309</span></a>  function <a class="function" onClick="logFunction('lti_set_state_for_type')" href="../../_functions/lti_set_state_for_type.html" onMouseOver="funcPopup(event,'lti_set_state_for_type')">lti_set_state_for_type</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>, <a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>) {
<a name="l1310"><span class="linenum">1310</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1311"><span class="linenum">1311</span></a>  
<a name="l1312"><span class="linenum">1312</span></a>      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('lti_types', array('id' =&gt; <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>, 'state' =&gt; <a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>));
<a name="l1313"><span class="linenum">1313</span></a>  }
<a name="l1314"><span class="linenum">1314</span></a>  
<a name="l1315"><span class="linenum">1315</span></a>  <span class="comment">/**</span>
<a name="l1316"><span class="linenum">1316</span></a>  <span class="comment"> * Transforms a basic LTI object to an array</span>
<a name="l1317"><span class="linenum">1317</span></a>  <span class="comment"> *</span>
<a name="l1318"><span class="linenum">1318</span></a>  <span class="comment"> * @param object $ltiobject    Basic LTI object</span>
<a name="l1319"><span class="linenum">1319</span></a>  <span class="comment"> *</span>
<a name="l1320"><span class="linenum">1320</span></a>  <span class="comment"> * @return array Basic LTI configuration details</span>
<a name="l1321"><span class="linenum">1321</span></a>  <span class="comment"> */</span>
<a name="l1322"><span class="linenum">1322</span></a>  function <a class="function" onClick="logFunction('lti_get_config')" href="../../_functions/lti_get_config.html" onMouseOver="funcPopup(event,'lti_get_config')">lti_get_config</a>(<a class="var it35766" onMouseOver="hilite(35766)" onMouseOut="lolite()" onClick="logVariable('ltiobject')" href="../../_variables/ltiobject.html">$ltiobject</a>) {
<a name="l1323"><span class="linenum">1323</span></a>      <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a> = array();
<a name="l1324"><span class="linenum">1324</span></a>      <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a> = (array)<a class="var it35766" onMouseOver="hilite(35766)" onMouseOut="lolite()" onClick="logVariable('ltiobject')" href="../../_variables/ltiobject.html">$ltiobject</a>;
<a name="l1325"><span class="linenum">1325</span></a>      <a class="var it35767" onMouseOver="hilite(35767)" onMouseOut="lolite()" onClick="logVariable('additionalconfig')" href="../../_variables/additionalconfig.html">$additionalconfig</a> = <a class="function" onClick="logFunction('lti_get_type_config')" href="../../_functions/lti_get_type_config.html" onMouseOver="funcPopup(event,'lti_get_type_config')">lti_get_type_config</a>(<a class="var it35766" onMouseOver="hilite(35766)" onMouseOut="lolite()" onClick="logVariable('ltiobject')" href="../../_variables/ltiobject.html">$ltiobject</a>-&gt;<a onClick="logVariable('typeid')" class="var it45512" onMouseOver="hilite(45512)" onMouseOut="lolite()" href="../../_variables/typeid.html">typeid</a>);
<a name="l1326"><span class="linenum">1326</span></a>      <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>, <a class="var it35767" onMouseOver="hilite(35767)" onMouseOut="lolite()" onClick="logVariable('additionalconfig')" href="../../_variables/additionalconfig.html">$additionalconfig</a>);
<a name="l1327"><span class="linenum">1327</span></a>      return <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>;
<a name="l1328"><span class="linenum">1328</span></a>  }
<a name="l1329"><span class="linenum">1329</span></a>  
<a name="l1330"><span class="linenum">1330</span></a>  <span class="comment">/**</span>
<a name="l1331"><span class="linenum">1331</span></a>  <span class="comment"> *</span>
<a name="l1332"><span class="linenum">1332</span></a>  <span class="comment"> * Generates some of the tool configuration based on the instance details</span>
<a name="l1333"><span class="linenum">1333</span></a>  <span class="comment"> *</span>
<a name="l1334"><span class="linenum">1334</span></a>  <span class="comment"> * @param int $id</span>
<a name="l1335"><span class="linenum">1335</span></a>  <span class="comment"> *</span>
<a name="l1336"><span class="linenum">1336</span></a>  <span class="comment"> * @return Instance configuration</span>
<a name="l1337"><span class="linenum">1337</span></a>  <span class="comment"> *</span>
<a name="l1338"><span class="linenum">1338</span></a>  <span class="comment"> */</span>
<a name="l1339"><span class="linenum">1339</span></a>  function <a class="function" onClick="logFunction('lti_get_type_config_from_instance')" href="../../_functions/lti_get_type_config_from_instance.html" onMouseOver="funcPopup(event,'lti_get_type_config_from_instance')">lti_get_type_config_from_instance</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>) {
<a name="l1340"><span class="linenum">1340</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1341"><span class="linenum">1341</span></a>  
<a name="l1342"><span class="linenum">1342</span></a>      <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('lti', array('id' =&gt; <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>));
<a name="l1343"><span class="linenum">1343</span></a>      <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a> = <a class="function" onClick="logFunction('lti_get_config')" href="../../_functions/lti_get_config.html" onMouseOver="funcPopup(event,'lti_get_config')">lti_get_config</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>);
<a name="l1344"><span class="linenum">1344</span></a>  
<a name="l1345"><span class="linenum">1345</span></a>      <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a> = new \stdClass();
<a name="l1346"><span class="linenum">1346</span></a>      <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_fix')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_fix.html">lti_fix</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>;
<a name="l1347"><span class="linenum">1347</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['toolurl'])) {
<a name="l1348"><span class="linenum">1348</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_toolurl')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_toolurl.html">lti_toolurl</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['toolurl'];
<a name="l1349"><span class="linenum">1349</span></a>      }
<a name="l1350"><span class="linenum">1350</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['instructorchoicesendname'])) {
<a name="l1351"><span class="linenum">1351</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_sendname')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_sendname.html">lti_sendname</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['instructorchoicesendname'];
<a name="l1352"><span class="linenum">1352</span></a>      }
<a name="l1353"><span class="linenum">1353</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['instructorchoicesendemailaddr'])) {
<a name="l1354"><span class="linenum">1354</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_sendemailaddr')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_sendemailaddr.html">lti_sendemailaddr</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['instructorchoicesendemailaddr'];
<a name="l1355"><span class="linenum">1355</span></a>      }
<a name="l1356"><span class="linenum">1356</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['instructorchoiceacceptgrades'])) {
<a name="l1357"><span class="linenum">1357</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_acceptgrades')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_acceptgrades.html">lti_acceptgrades</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['instructorchoiceacceptgrades'];
<a name="l1358"><span class="linenum">1358</span></a>      }
<a name="l1359"><span class="linenum">1359</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['instructorchoiceallowroster'])) {
<a name="l1360"><span class="linenum">1360</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_allowroster')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_allowroster.html">lti_allowroster</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['instructorchoiceallowroster'];
<a name="l1361"><span class="linenum">1361</span></a>      }
<a name="l1362"><span class="linenum">1362</span></a>  
<a name="l1363"><span class="linenum">1363</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['instructorcustomparameters'])) {
<a name="l1364"><span class="linenum">1364</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_allowsetting')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_allowsetting.html">lti_allowsetting</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['instructorcustomparameters'];
<a name="l1365"><span class="linenum">1365</span></a>      }
<a name="l1366"><span class="linenum">1366</span></a>      return <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>;
<a name="l1367"><span class="linenum">1367</span></a>  }
<a name="l1368"><span class="linenum">1368</span></a>  
<a name="l1369"><span class="linenum">1369</span></a>  <span class="comment">/**</span>
<a name="l1370"><span class="linenum">1370</span></a>  <span class="comment"> * Generates some of the tool configuration based on the admin configuration details</span>
<a name="l1371"><span class="linenum">1371</span></a>  <span class="comment"> *</span>
<a name="l1372"><span class="linenum">1372</span></a>  <span class="comment"> * @param int $id</span>
<a name="l1373"><span class="linenum">1373</span></a>  <span class="comment"> *</span>
<a name="l1374"><span class="linenum">1374</span></a>  <span class="comment"> * @return Configuration details</span>
<a name="l1375"><span class="linenum">1375</span></a>  <span class="comment"> */</span>
<a name="l1376"><span class="linenum">1376</span></a>  function <a class="function" onClick="logFunction('lti_get_type_type_config')" href="../../_functions/lti_get_type_type_config.html" onMouseOver="funcPopup(event,'lti_get_type_type_config')">lti_get_type_type_config</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>) {
<a name="l1377"><span class="linenum">1377</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1378"><span class="linenum">1378</span></a>  
<a name="l1379"><span class="linenum">1379</span></a>      <a class="var it35771" onMouseOver="hilite(35771)" onMouseOut="lolite()" onClick="logVariable('basicltitype')" href="../../_variables/basicltitype.html">$basicltitype</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('lti_types', array('id' =&gt; <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>));
<a name="l1380"><span class="linenum">1380</span></a>      <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a> = <a class="function" onClick="logFunction('lti_get_type_config')" href="../../_functions/lti_get_type_config.html" onMouseOver="funcPopup(event,'lti_get_type_config')">lti_get_type_config</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>);
<a name="l1381"><span class="linenum">1381</span></a>  
<a name="l1382"><span class="linenum">1382</span></a>      <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a> = new \stdClass();
<a name="l1383"><span class="linenum">1383</span></a>  
<a name="l1384"><span class="linenum">1384</span></a>      <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_typename')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_typename.html">lti_typename</a> = <a class="var it35771" onMouseOver="hilite(35771)" onMouseOut="lolite()" onClick="logVariable('basicltitype')" href="../../_variables/basicltitype.html">$basicltitype</a>-&gt;<a onClick="logVariable('name')" class="var it45513" onMouseOver="hilite(45513)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>;
<a name="l1385"><span class="linenum">1385</span></a>  
<a name="l1386"><span class="linenum">1386</span></a>      <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('typeid')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/typeid.html">typeid</a> = <a class="var it35771" onMouseOver="hilite(35771)" onMouseOut="lolite()" onClick="logVariable('basicltitype')" href="../../_variables/basicltitype.html">$basicltitype</a>-&gt;<a onClick="logVariable('id')" class="var it45513" onMouseOver="hilite(45513)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l1387"><span class="linenum">1387</span></a>  
<a name="l1388"><span class="linenum">1388</span></a>      <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('toolproxyid')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/toolproxyid.html">toolproxyid</a> = <a class="var it35771" onMouseOver="hilite(35771)" onMouseOut="lolite()" onClick="logVariable('basicltitype')" href="../../_variables/basicltitype.html">$basicltitype</a>-&gt;<a onClick="logVariable('toolproxyid')" class="var it45513" onMouseOver="hilite(45513)" onMouseOut="lolite()" href="../../_variables/toolproxyid.html">toolproxyid</a>;
<a name="l1389"><span class="linenum">1389</span></a>  
<a name="l1390"><span class="linenum">1390</span></a>      <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_toolurl')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_toolurl.html">lti_toolurl</a> = <a class="var it35771" onMouseOver="hilite(35771)" onMouseOut="lolite()" onClick="logVariable('basicltitype')" href="../../_variables/basicltitype.html">$basicltitype</a>-&gt;<a onClick="logVariable('baseurl')" class="var it45513" onMouseOver="hilite(45513)" onMouseOut="lolite()" href="../../_variables/baseurl.html">baseurl</a>;
<a name="l1391"><span class="linenum">1391</span></a>  
<a name="l1392"><span class="linenum">1392</span></a>      <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_description')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_description.html">lti_description</a> = <a class="var it35771" onMouseOver="hilite(35771)" onMouseOut="lolite()" onClick="logVariable('basicltitype')" href="../../_variables/basicltitype.html">$basicltitype</a>-&gt;<a onClick="logVariable('description')" class="var it45513" onMouseOver="hilite(45513)" onMouseOut="lolite()" href="../../_variables/description.html">description</a>;
<a name="l1393"><span class="linenum">1393</span></a>  
<a name="l1394"><span class="linenum">1394</span></a>      <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_parameters')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_parameters.html">lti_parameters</a> = <a class="var it35771" onMouseOver="hilite(35771)" onMouseOut="lolite()" onClick="logVariable('basicltitype')" href="../../_variables/basicltitype.html">$basicltitype</a>-&gt;<a onClick="logVariable('parameter')" class="var it45513" onMouseOver="hilite(45513)" onMouseOut="lolite()" href="../../_variables/parameter.html">parameter</a>;
<a name="l1395"><span class="linenum">1395</span></a>  
<a name="l1396"><span class="linenum">1396</span></a>      <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_icon')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_icon.html">lti_icon</a> = <a class="var it35771" onMouseOver="hilite(35771)" onMouseOut="lolite()" onClick="logVariable('basicltitype')" href="../../_variables/basicltitype.html">$basicltitype</a>-&gt;<a onClick="logVariable('icon')" class="var it45513" onMouseOver="hilite(45513)" onMouseOut="lolite()" href="../../_variables/icon.html">icon</a>;
<a name="l1397"><span class="linenum">1397</span></a>  
<a name="l1398"><span class="linenum">1398</span></a>      <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_secureicon')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_secureicon.html">lti_secureicon</a> = <a class="var it35771" onMouseOver="hilite(35771)" onMouseOut="lolite()" onClick="logVariable('basicltitype')" href="../../_variables/basicltitype.html">$basicltitype</a>-&gt;<a onClick="logVariable('secureicon')" class="var it45513" onMouseOver="hilite(45513)" onMouseOut="lolite()" href="../../_variables/secureicon.html">secureicon</a>;
<a name="l1399"><span class="linenum">1399</span></a>  
<a name="l1400"><span class="linenum">1400</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['resourcekey'])) {
<a name="l1401"><span class="linenum">1401</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_resourcekey')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_resourcekey.html">lti_resourcekey</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['resourcekey'];
<a name="l1402"><span class="linenum">1402</span></a>      }
<a name="l1403"><span class="linenum">1403</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['password'])) {
<a name="l1404"><span class="linenum">1404</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_password')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_password.html">lti_password</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['password'];
<a name="l1405"><span class="linenum">1405</span></a>      }
<a name="l1406"><span class="linenum">1406</span></a>  
<a name="l1407"><span class="linenum">1407</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['sendname'])) {
<a name="l1408"><span class="linenum">1408</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_sendname')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_sendname.html">lti_sendname</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['sendname'];
<a name="l1409"><span class="linenum">1409</span></a>      }
<a name="l1410"><span class="linenum">1410</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['instructorchoicesendname'])) {
<a name="l1411"><span class="linenum">1411</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_instructorchoicesendname')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_instructorchoicesendname.html">lti_instructorchoicesendname</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['instructorchoicesendname'];
<a name="l1412"><span class="linenum">1412</span></a>      }
<a name="l1413"><span class="linenum">1413</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['sendemailaddr'])) {
<a name="l1414"><span class="linenum">1414</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_sendemailaddr')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_sendemailaddr.html">lti_sendemailaddr</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['sendemailaddr'];
<a name="l1415"><span class="linenum">1415</span></a>      }
<a name="l1416"><span class="linenum">1416</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['instructorchoicesendemailaddr'])) {
<a name="l1417"><span class="linenum">1417</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_instructorchoicesendemailaddr')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_instructorchoicesendemailaddr.html">lti_instructorchoicesendemailaddr</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['instructorchoicesendemailaddr'];
<a name="l1418"><span class="linenum">1418</span></a>      }
<a name="l1419"><span class="linenum">1419</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['acceptgrades'])) {
<a name="l1420"><span class="linenum">1420</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_acceptgrades')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_acceptgrades.html">lti_acceptgrades</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['acceptgrades'];
<a name="l1421"><span class="linenum">1421</span></a>      }
<a name="l1422"><span class="linenum">1422</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['instructorchoiceacceptgrades'])) {
<a name="l1423"><span class="linenum">1423</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_instructorchoiceacceptgrades')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_instructorchoiceacceptgrades.html">lti_instructorchoiceacceptgrades</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['instructorchoiceacceptgrades'];
<a name="l1424"><span class="linenum">1424</span></a>      }
<a name="l1425"><span class="linenum">1425</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['allowroster'])) {
<a name="l1426"><span class="linenum">1426</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_allowroster')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_allowroster.html">lti_allowroster</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['allowroster'];
<a name="l1427"><span class="linenum">1427</span></a>      }
<a name="l1428"><span class="linenum">1428</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['instructorchoiceallowroster'])) {
<a name="l1429"><span class="linenum">1429</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_instructorchoiceallowroster')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_instructorchoiceallowroster.html">lti_instructorchoiceallowroster</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['instructorchoiceallowroster'];
<a name="l1430"><span class="linenum">1430</span></a>      }
<a name="l1431"><span class="linenum">1431</span></a>  
<a name="l1432"><span class="linenum">1432</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['customparameters'])) {
<a name="l1433"><span class="linenum">1433</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_customparameters')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_customparameters.html">lti_customparameters</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['customparameters'];
<a name="l1434"><span class="linenum">1434</span></a>      }
<a name="l1435"><span class="linenum">1435</span></a>  
<a name="l1436"><span class="linenum">1436</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['forcessl'])) {
<a name="l1437"><span class="linenum">1437</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_forcessl')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_forcessl.html">lti_forcessl</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['forcessl'];
<a name="l1438"><span class="linenum">1438</span></a>      }
<a name="l1439"><span class="linenum">1439</span></a>  
<a name="l1440"><span class="linenum">1440</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['organizationid'])) {
<a name="l1441"><span class="linenum">1441</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_organizationid')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_organizationid.html">lti_organizationid</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['organizationid'];
<a name="l1442"><span class="linenum">1442</span></a>      }
<a name="l1443"><span class="linenum">1443</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['organizationurl'])) {
<a name="l1444"><span class="linenum">1444</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_organizationurl')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_organizationurl.html">lti_organizationurl</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['organizationurl'];
<a name="l1445"><span class="linenum">1445</span></a>      }
<a name="l1446"><span class="linenum">1446</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['organizationdescr'])) {
<a name="l1447"><span class="linenum">1447</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_organizationdescr')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_organizationdescr.html">lti_organizationdescr</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['organizationdescr'];
<a name="l1448"><span class="linenum">1448</span></a>      }
<a name="l1449"><span class="linenum">1449</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['launchcontainer'])) {
<a name="l1450"><span class="linenum">1450</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_launchcontainer')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_launchcontainer.html">lti_launchcontainer</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['launchcontainer'];
<a name="l1451"><span class="linenum">1451</span></a>      }
<a name="l1452"><span class="linenum">1452</span></a>  
<a name="l1453"><span class="linenum">1453</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['coursevisible'])) {
<a name="l1454"><span class="linenum">1454</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_coursevisible')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_coursevisible.html">lti_coursevisible</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['coursevisible'];
<a name="l1455"><span class="linenum">1455</span></a>      }
<a name="l1456"><span class="linenum">1456</span></a>  
<a name="l1457"><span class="linenum">1457</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['debuglaunch'])) {
<a name="l1458"><span class="linenum">1458</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_debuglaunch')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_debuglaunch.html">lti_debuglaunch</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['debuglaunch'];
<a name="l1459"><span class="linenum">1459</span></a>      }
<a name="l1460"><span class="linenum">1460</span></a>  
<a name="l1461"><span class="linenum">1461</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['module_class_type'])) {
<a name="l1462"><span class="linenum">1462</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_module_class_type')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_module_class_type.html">lti_module_class_type</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>['module_class_type'];
<a name="l1463"><span class="linenum">1463</span></a>      }
<a name="l1464"><span class="linenum">1464</span></a>  
<a name="l1465"><span class="linenum">1465</span></a>      return <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>;
<a name="l1466"><span class="linenum">1466</span></a>  }
<a name="l1467"><span class="linenum">1467</span></a>  
<a name="l1468"><span class="linenum">1468</span></a>  function <a class="function" onClick="logFunction('lti_prepare_type_for_save')" href="../../_functions/lti_prepare_type_for_save.html" onMouseOver="funcPopup(event,'lti_prepare_type_for_save')">lti_prepare_type_for_save</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>, <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>) {
<a name="l1469"><span class="linenum">1469</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_toolurl')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_toolurl.html">lti_toolurl</a>)) {
<a name="l1470"><span class="linenum">1470</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('baseurl')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/baseurl.html">baseurl</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_toolurl')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_toolurl.html">lti_toolurl</a>;
<a name="l1471"><span class="linenum">1471</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('tooldomain')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/tooldomain.html">tooldomain</a> = <a class="function" onClick="logFunction('lti_get_domain_from_url')" href="../../_functions/lti_get_domain_from_url.html" onMouseOver="funcPopup(event,'lti_get_domain_from_url')">lti_get_domain_from_url</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_toolurl')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_toolurl.html">lti_toolurl</a>);
<a name="l1472"><span class="linenum">1472</span></a>      }
<a name="l1473"><span class="linenum">1473</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_description')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_description.html">lti_description</a>)) {
<a name="l1474"><span class="linenum">1474</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('description')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/description.html">description</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_description')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_description.html">lti_description</a>;
<a name="l1475"><span class="linenum">1475</span></a>      }
<a name="l1476"><span class="linenum">1476</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_typename')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_typename.html">lti_typename</a>)) {
<a name="l1477"><span class="linenum">1477</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('name')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/name.html">name</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_typename')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_typename.html">lti_typename</a>;
<a name="l1478"><span class="linenum">1478</span></a>      }
<a name="l1479"><span class="linenum">1479</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_coursevisible')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_coursevisible.html">lti_coursevisible</a>)) {
<a name="l1480"><span class="linenum">1480</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('coursevisible')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/coursevisible.html">coursevisible</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_coursevisible')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_coursevisible.html">lti_coursevisible</a>;
<a name="l1481"><span class="linenum">1481</span></a>      }
<a name="l1482"><span class="linenum">1482</span></a>  
<a name="l1483"><span class="linenum">1483</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_icon')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_icon.html">lti_icon</a>)) {
<a name="l1484"><span class="linenum">1484</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('icon')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/icon.html">icon</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_icon')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_icon.html">lti_icon</a>;
<a name="l1485"><span class="linenum">1485</span></a>      }
<a name="l1486"><span class="linenum">1486</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_secureicon')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_secureicon.html">lti_secureicon</a>)) {
<a name="l1487"><span class="linenum">1487</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('secureicon')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/secureicon.html">secureicon</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_secureicon')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_secureicon.html">lti_secureicon</a>;
<a name="l1488"><span class="linenum">1488</span></a>      }
<a name="l1489"><span class="linenum">1489</span></a>  
<a name="l1490"><span class="linenum">1490</span></a>      <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('forcessl')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/forcessl.html">forcessl</a> = !empty(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_forcessl')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_forcessl.html">lti_forcessl</a>) ? <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_forcessl')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_forcessl.html">lti_forcessl</a> : 0;
<a name="l1491"><span class="linenum">1491</span></a>      <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_forcessl')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_forcessl.html">lti_forcessl</a> = <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('forcessl')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/forcessl.html">forcessl</a>;
<a name="l1492"><span class="linenum">1492</span></a>  
<a name="l1493"><span class="linenum">1493</span></a>      <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('timemodified')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l1494"><span class="linenum">1494</span></a>  
<a name="l1495"><span class="linenum">1495</span></a>      unset (<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_typename')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_typename.html">lti_typename</a>);
<a name="l1496"><span class="linenum">1496</span></a>      unset (<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_toolurl')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_toolurl.html">lti_toolurl</a>);
<a name="l1497"><span class="linenum">1497</span></a>      unset (<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_description')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_description.html">lti_description</a>);
<a name="l1498"><span class="linenum">1498</span></a>      unset (<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_icon')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_icon.html">lti_icon</a>);
<a name="l1499"><span class="linenum">1499</span></a>      unset (<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_secureicon')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_secureicon.html">lti_secureicon</a>);
<a name="l1500"><span class="linenum">1500</span></a>  }
<a name="l1501"><span class="linenum">1501</span></a>  
<a name="l1502"><span class="linenum">1502</span></a>  function <a class="function" onClick="logFunction('lti_update_type')" href="../../_functions/lti_update_type.html" onMouseOver="funcPopup(event,'lti_update_type')">lti_update_type</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>, <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>) {
<a name="l1503"><span class="linenum">1503</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l1504"><span class="linenum">1504</span></a>  
<a name="l1505"><span class="linenum">1505</span></a>      <a class="function" onClick="logFunction('lti_prepare_type_for_save')" href="../../_functions/lti_prepare_type_for_save.html" onMouseOver="funcPopup(event,'lti_prepare_type_for_save')">lti_prepare_type_for_save</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>, <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>);
<a name="l1506"><span class="linenum">1506</span></a>  
<a name="l1507"><span class="linenum">1507</span></a>      <a class="var it35785" onMouseOver="hilite(35785)" onMouseOut="lolite()" onClick="logVariable('clearcache')" href="../../_variables/clearcache.html">$clearcache</a> = false;
<a name="l1508"><span class="linenum">1508</span></a>      if (<a class="function" onClick="logFunction('lti_request_is_using_ssl')" href="../../_functions/lti_request_is_using_ssl.html" onMouseOver="funcPopup(event,'lti_request_is_using_ssl')">lti_request_is_using_ssl</a>() &amp;&amp; !empty(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('secureicon')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/secureicon.html">secureicon</a>)) {
<a name="l1509"><span class="linenum">1509</span></a>          <a class="var it35785" onMouseOver="hilite(35785)" onMouseOut="lolite()" onClick="logVariable('clearcache')" href="../../_variables/clearcache.html">$clearcache</a> = !isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('oldicon')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/oldicon.html">oldicon</a>) || (<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('oldicon')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/oldicon.html">oldicon</a> !== <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('secureicon')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/secureicon.html">secureicon</a>);
<a name="l1510"><span class="linenum">1510</span></a>      } else {
<a name="l1511"><span class="linenum">1511</span></a>          <a class="var it35785" onMouseOver="hilite(35785)" onMouseOut="lolite()" onClick="logVariable('clearcache')" href="../../_variables/clearcache.html">$clearcache</a> = isset(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('icon')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/icon.html">icon</a>) &amp;&amp; (!isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('oldicon')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/oldicon.html">oldicon</a>) || (<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('oldicon')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/oldicon.html">oldicon</a> !== <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('icon')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/icon.html">icon</a>));
<a name="l1512"><span class="linenum">1512</span></a>      }
<a name="l1513"><span class="linenum">1513</span></a>      unset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('oldicon')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/oldicon.html">oldicon</a>);
<a name="l1514"><span class="linenum">1514</span></a>  
<a name="l1515"><span class="linenum">1515</span></a>      if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('lti_types', <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>)) {
<a name="l1516"><span class="linenum">1516</span></a>          foreach (<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l1517"><span class="linenum">1517</span></a>              if (<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>, 0, 4) == 'lti_' &amp;&amp; !<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>)) {
<a name="l1518"><span class="linenum">1518</span></a>                  <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a> = new \StdClass();
<a name="l1519"><span class="linenum">1519</span></a>                  <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('typeid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/typeid.html">typeid</a> = <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('id')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l1520"><span class="linenum">1520</span></a>                  <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('name')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/name.html">name</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>, 4);
<a name="l1521"><span class="linenum">1521</span></a>                  <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('value')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/value.html">value</a> = <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l1522"><span class="linenum">1522</span></a>                  <a class="function" onClick="logFunction('lti_update_config')" href="../../_functions/lti_update_config.html" onMouseOver="funcPopup(event,'lti_update_config')">lti_update_config</a>(<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>);
<a name="l1523"><span class="linenum">1523</span></a>              }
<a name="l1524"><span class="linenum">1524</span></a>          }
<a name="l1525"><span class="linenum">1525</span></a>          require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a>.'/modinfolib.php');
<a name="l1526"><span class="linenum">1526</span></a>          if (<a class="var it35785" onMouseOver="hilite(35785)" onMouseOut="lolite()" onClick="logVariable('clearcache')" href="../../_variables/clearcache.html">$clearcache</a>) {
<a name="l1527"><span class="linenum">1527</span></a>              <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT DISTINCT course
<a name="l1528"><span class="linenum">1528</span></a>                        FROM {lti}
<a name="l1529"><span class="linenum">1529</span></a>                       WHERE typeid = ?&quot;;
<a name="l1530"><span class="linenum">1530</span></a>  
<a name="l1531"><span class="linenum">1531</span></a>              <a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_fieldset_sql')" href="../../_functions/get_fieldset_sql.html" onMouseOver="funcPopup(event,'get_fieldset_sql')">get_fieldset_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, array(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('id')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l1532"><span class="linenum">1532</span></a>  
<a name="l1533"><span class="linenum">1533</span></a>              foreach (<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a> as <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>) {
<a name="l1534"><span class="linenum">1534</span></a>                  <a class="function" onClick="logFunction('rebuild_course_cache')" href="../../_functions/rebuild_course_cache.html" onMouseOver="funcPopup(event,'rebuild_course_cache')">rebuild_course_cache</a>(<a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>, true);
<a name="l1535"><span class="linenum">1535</span></a>              }
<a name="l1536"><span class="linenum">1536</span></a>          }
<a name="l1537"><span class="linenum">1537</span></a>      }
<a name="l1538"><span class="linenum">1538</span></a>  }
<a name="l1539"><span class="linenum">1539</span></a>  
<a name="l1540"><span class="linenum">1540</span></a>  function <a class="function" onClick="logFunction('lti_add_type')" href="../../_functions/lti_add_type.html" onMouseOver="funcPopup(event,'lti_add_type')">lti_add_type</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>, <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>) {
<a name="l1541"><span class="linenum">1541</span></a>      global <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it940" onMouseOver="hilite(940)" onMouseOut="lolite()" onClick="logVariable('SITE')" href="../../_variables/SITE.html">$SITE</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1542"><span class="linenum">1542</span></a>  
<a name="l1543"><span class="linenum">1543</span></a>      <a class="function" onClick="logFunction('lti_prepare_type_for_save')" href="../../_functions/lti_prepare_type_for_save.html" onMouseOver="funcPopup(event,'lti_prepare_type_for_save')">lti_prepare_type_for_save</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>, <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>);
<a name="l1544"><span class="linenum">1544</span></a>  
<a name="l1545"><span class="linenum">1545</span></a>      if (!isset(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('state')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/state.html">state</a>)) {
<a name="l1546"><span class="linenum">1546</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('state')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> = <a class="constant" onClick="logConstant('LTI_TOOL_STATE_PENDING')" href="../../_constants/LTI_TOOL_STATE_PENDING.html" onMouseOver="constPopup(event,'LTI_TOOL_STATE_PENDING')">LTI_TOOL_STATE_PENDING</a>;
<a name="l1547"><span class="linenum">1547</span></a>      }
<a name="l1548"><span class="linenum">1548</span></a>  
<a name="l1549"><span class="linenum">1549</span></a>      if (!isset(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('timecreated')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a>)) {
<a name="l1550"><span class="linenum">1550</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('timecreated')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l1551"><span class="linenum">1551</span></a>      }
<a name="l1552"><span class="linenum">1552</span></a>  
<a name="l1553"><span class="linenum">1553</span></a>      if (!isset(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('createdby')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/createdby.html">createdby</a>)) {
<a name="l1554"><span class="linenum">1554</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('createdby')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/createdby.html">createdby</a> = <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l1555"><span class="linenum">1555</span></a>      }
<a name="l1556"><span class="linenum">1556</span></a>  
<a name="l1557"><span class="linenum">1557</span></a>      if (!isset(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('course')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>)) {
<a name="l1558"><span class="linenum">1558</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('course')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/course.html">course</a> = <a class="var it940" onMouseOver="hilite(940)" onMouseOut="lolite()" onClick="logVariable('SITE')" href="../../_variables/SITE.html">$SITE</a>-&gt;<a onClick="logVariable('id')" class="var it43008" onMouseOver="hilite(43008)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l1559"><span class="linenum">1559</span></a>      }
<a name="l1560"><span class="linenum">1560</span></a>  
<a name="l1561"><span class="linenum">1561</span></a>  <span class="comment">    // Create a salt value to be used for signing passed data to extension services</span>
<a name="l1562"><span class="linenum">1562</span></a>  <span class="comment">    // The outcome service uses the service salt on the instance. This can be used</span>
<a name="l1563"><span class="linenum">1563</span></a>  <span class="comment">    // for communication with services not related to a specific LTI instance.</span>
<a name="l1564"><span class="linenum">1564</span></a>      <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_servicesalt')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_servicesalt.html">lti_servicesalt</a> = <a class="phpfunction" onClick="logFunction('uniqid')" href="../../_functions/uniqid.html" onMouseOver="phpfuncPopup(event,'uniqid')">uniqid</a>('', true);
<a name="l1565"><span class="linenum">1565</span></a>  
<a name="l1566"><span class="linenum">1566</span></a>      <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('lti_types', <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>);
<a name="l1567"><span class="linenum">1567</span></a>  
<a name="l1568"><span class="linenum">1568</span></a>      if (<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>) {
<a name="l1569"><span class="linenum">1569</span></a>          foreach (<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l1570"><span class="linenum">1570</span></a>              if (<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>, 0, 4) == 'lti_' &amp;&amp; !<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>)) {
<a name="l1571"><span class="linenum">1571</span></a>                  <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a> = new \StdClass();
<a name="l1572"><span class="linenum">1572</span></a>                  <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('typeid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/typeid.html">typeid</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>;
<a name="l1573"><span class="linenum">1573</span></a>                  <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('name')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/name.html">name</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>, 4);
<a name="l1574"><span class="linenum">1574</span></a>                  <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('value')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/value.html">value</a> = <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l1575"><span class="linenum">1575</span></a>  
<a name="l1576"><span class="linenum">1576</span></a>                  <a class="function" onClick="logFunction('lti_add_config')" href="../../_functions/lti_add_config.html" onMouseOver="funcPopup(event,'lti_add_config')">lti_add_config</a>(<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>);
<a name="l1577"><span class="linenum">1577</span></a>              }
<a name="l1578"><span class="linenum">1578</span></a>          }
<a name="l1579"><span class="linenum">1579</span></a>      }
<a name="l1580"><span class="linenum">1580</span></a>  
<a name="l1581"><span class="linenum">1581</span></a>      return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>;
<a name="l1582"><span class="linenum">1582</span></a>  }
<a name="l1583"><span class="linenum">1583</span></a>  
<a name="l1584"><span class="linenum">1584</span></a>  <span class="comment">/**</span>
<a name="l1585"><span class="linenum">1585</span></a>  <span class="comment"> * Given an array of tool proxies, filter them based on their state</span>
<a name="l1586"><span class="linenum">1586</span></a>  <span class="comment"> *</span>
<a name="l1587"><span class="linenum">1587</span></a>  <span class="comment"> * @param array $toolproxies An array of lti_tool_proxies records</span>
<a name="l1588"><span class="linenum">1588</span></a>  <span class="comment"> * @param int $state One of the LTI_TOOL_PROXY_STATE_* constants</span>
<a name="l1589"><span class="linenum">1589</span></a>  <span class="comment"> *</span>
<a name="l1590"><span class="linenum">1590</span></a>  <span class="comment"> * @return array</span>
<a name="l1591"><span class="linenum">1591</span></a>  <span class="comment"> */</span>
<a name="l1592"><span class="linenum">1592</span></a>  function <a class="function" onClick="logFunction('lti_filter_tool_proxy_types')" href="../../_functions/lti_filter_tool_proxy_types.html" onMouseOver="funcPopup(event,'lti_filter_tool_proxy_types')">lti_filter_tool_proxy_types</a>(array <a class="var it8395" onMouseOver="hilite(8395)" onMouseOut="lolite()" onClick="logVariable('toolproxies')" href="../../_variables/toolproxies.html">$toolproxies</a>, <a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>) {
<a name="l1593"><span class="linenum">1593</span></a>      <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a> = array();
<a name="l1594"><span class="linenum">1594</span></a>      foreach (<a class="var it8395" onMouseOver="hilite(8395)" onMouseOut="lolite()" onClick="logVariable('toolproxies')" href="../../_variables/toolproxies.html">$toolproxies</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>) {
<a name="l1595"><span class="linenum">1595</span></a>          if (<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('state')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> == <a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>) {
<a name="l1596"><span class="linenum">1596</span></a>              <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>] = <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>;
<a name="l1597"><span class="linenum">1597</span></a>          }
<a name="l1598"><span class="linenum">1598</span></a>      }
<a name="l1599"><span class="linenum">1599</span></a>      return <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a>;
<a name="l1600"><span class="linenum">1600</span></a>  }
<a name="l1601"><span class="linenum">1601</span></a>  
<a name="l1602"><span class="linenum">1602</span></a>  <span class="comment">/**</span>
<a name="l1603"><span class="linenum">1603</span></a>  <span class="comment"> * Get the tool proxy instance given its GUID</span>
<a name="l1604"><span class="linenum">1604</span></a>  <span class="comment"> *</span>
<a name="l1605"><span class="linenum">1605</span></a>  <span class="comment"> * @param string  $toolproxyguid   Tool proxy GUID value</span>
<a name="l1606"><span class="linenum">1606</span></a>  <span class="comment"> *</span>
<a name="l1607"><span class="linenum">1607</span></a>  <span class="comment"> * @return object</span>
<a name="l1608"><span class="linenum">1608</span></a>  <span class="comment"> */</span>
<a name="l1609"><span class="linenum">1609</span></a>  function <a class="function" onClick="logFunction('lti_get_tool_proxy_from_guid')" href="../../_functions/lti_get_tool_proxy_from_guid.html" onMouseOver="funcPopup(event,'lti_get_tool_proxy_from_guid')">lti_get_tool_proxy_from_guid</a>(<a class="var it29786" onMouseOver="hilite(29786)" onMouseOut="lolite()" onClick="logVariable('toolproxyguid')" href="../../_variables/toolproxyguid.html">$toolproxyguid</a>) {
<a name="l1610"><span class="linenum">1610</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1611"><span class="linenum">1611</span></a>  
<a name="l1612"><span class="linenum">1612</span></a>      <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('lti_tool_proxies', array('guid' =&gt; <a class="var it29786" onMouseOver="hilite(29786)" onMouseOut="lolite()" onClick="logVariable('toolproxyguid')" href="../../_variables/toolproxyguid.html">$toolproxyguid</a>));
<a name="l1613"><span class="linenum">1613</span></a>  
<a name="l1614"><span class="linenum">1614</span></a>      return <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>;
<a name="l1615"><span class="linenum">1615</span></a>  }
<a name="l1616"><span class="linenum">1616</span></a>  
<a name="l1617"><span class="linenum">1617</span></a>  <span class="comment">/**</span>
<a name="l1618"><span class="linenum">1618</span></a>  <span class="comment"> * Get the tool proxy instance given its registration URL</span>
<a name="l1619"><span class="linenum">1619</span></a>  <span class="comment"> *</span>
<a name="l1620"><span class="linenum">1620</span></a>  <span class="comment"> * @param string $regurl Tool proxy registration URL</span>
<a name="l1621"><span class="linenum">1621</span></a>  <span class="comment"> *</span>
<a name="l1622"><span class="linenum">1622</span></a>  <span class="comment"> * @return array The record of the tool proxy with this url</span>
<a name="l1623"><span class="linenum">1623</span></a>  <span class="comment"> */</span>
<a name="l1624"><span class="linenum">1624</span></a>  function <a class="function" onClick="logFunction('lti_get_tool_proxies_from_registration_url')" href="../../_functions/lti_get_tool_proxies_from_registration_url.html" onMouseOver="funcPopup(event,'lti_get_tool_proxies_from_registration_url')">lti_get_tool_proxies_from_registration_url</a>(<a class="var it3767" onMouseOver="hilite(3767)" onMouseOut="lolite()" onClick="logVariable('regurl')" href="../../_variables/regurl.html">$regurl</a>) {
<a name="l1625"><span class="linenum">1625</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1626"><span class="linenum">1626</span></a>  
<a name="l1627"><span class="linenum">1627</span></a>      return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(
<a name="l1628"><span class="linenum">1628</span></a>          'SELECT * FROM {lti_tool_proxies}
<a name="l1629"><span class="linenum">1629</span></a>          WHERE '.<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_compare_text')" href="../../_functions/sql_compare_text.html" onMouseOver="funcPopup(event,'sql_compare_text')">sql_compare_text</a>('regurl', 256).' = :regurl',
<a name="l1630"><span class="linenum">1630</span></a>          array('regurl' =&gt; <a class="var it3767" onMouseOver="hilite(3767)" onMouseOut="lolite()" onClick="logVariable('regurl')" href="../../_variables/regurl.html">$regurl</a>)
<a name="l1631"><span class="linenum">1631</span></a>      );
<a name="l1632"><span class="linenum">1632</span></a>  }
<a name="l1633"><span class="linenum">1633</span></a>  
<a name="l1634"><span class="linenum">1634</span></a>  <span class="comment">/**</span>
<a name="l1635"><span class="linenum">1635</span></a>  <span class="comment"> * Generates some of the tool proxy configuration based on the admin configuration details</span>
<a name="l1636"><span class="linenum">1636</span></a>  <span class="comment"> *</span>
<a name="l1637"><span class="linenum">1637</span></a>  <span class="comment"> * @param int $id</span>
<a name="l1638"><span class="linenum">1638</span></a>  <span class="comment"> *</span>
<a name="l1639"><span class="linenum">1639</span></a>  <span class="comment"> * @return Tool Proxy details</span>
<a name="l1640"><span class="linenum">1640</span></a>  <span class="comment"> */</span>
<a name="l1641"><span class="linenum">1641</span></a>  function <a class="function" onClick="logFunction('lti_get_tool_proxy')" href="../../_functions/lti_get_tool_proxy.html" onMouseOver="funcPopup(event,'lti_get_tool_proxy')">lti_get_tool_proxy</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>) {
<a name="l1642"><span class="linenum">1642</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1643"><span class="linenum">1643</span></a>  
<a name="l1644"><span class="linenum">1644</span></a>      <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('lti_tool_proxies', array('id' =&gt; <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>));
<a name="l1645"><span class="linenum">1645</span></a>      return <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>;
<a name="l1646"><span class="linenum">1646</span></a>  }
<a name="l1647"><span class="linenum">1647</span></a>  
<a name="l1648"><span class="linenum">1648</span></a>  <span class="comment">/**</span>
<a name="l1649"><span class="linenum">1649</span></a>  <span class="comment"> * Returns lti tool proxies.</span>
<a name="l1650"><span class="linenum">1650</span></a>  <span class="comment"> *</span>
<a name="l1651"><span class="linenum">1651</span></a>  <span class="comment"> * @param bool $orphanedonly Only retrieves tool proxies that have no type associated with them</span>
<a name="l1652"><span class="linenum">1652</span></a>  <span class="comment"> * @return array of basicLTI types</span>
<a name="l1653"><span class="linenum">1653</span></a>  <span class="comment"> */</span>
<a name="l1654"><span class="linenum">1654</span></a>  function <a class="function" onClick="logFunction('lti_get_tool_proxies')" href="../../_functions/lti_get_tool_proxies.html" onMouseOver="funcPopup(event,'lti_get_tool_proxies')">lti_get_tool_proxies</a>(<a class="var it3752" onMouseOver="hilite(3752)" onMouseOut="lolite()" onClick="logVariable('orphanedonly')" href="../../_variables/orphanedonly.html">$orphanedonly</a>) {
<a name="l1655"><span class="linenum">1655</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1656"><span class="linenum">1656</span></a>  
<a name="l1657"><span class="linenum">1657</span></a>      if (<a class="var it3752" onMouseOver="hilite(3752)" onMouseOut="lolite()" onClick="logVariable('orphanedonly')" href="../../_variables/orphanedonly.html">$orphanedonly</a>) {
<a name="l1658"><span class="linenum">1658</span></a>          <a class="var it24702" onMouseOver="hilite(24702)" onMouseOut="lolite()" onClick="logVariable('tools')" href="../../_variables/tools.html">$tools</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('lti_types');
<a name="l1659"><span class="linenum">1659</span></a>          <a class="var it35787" onMouseOver="hilite(35787)" onMouseOut="lolite()" onClick="logVariable('usedproxyids')" href="../../_variables/usedproxyids.html">$usedproxyids</a> = <a class="phpfunction" onClick="logFunction('array_values')" href="../../_functions/array_values.html" onMouseOver="phpfuncPopup(event,'array_values')">array_values</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_fieldset_select')" href="../../_functions/get_fieldset_select.html" onMouseOver="funcPopup(event,'get_fieldset_select')">get_fieldset_select</a>('lti_types', 'toolproxyid', 'toolproxyid IS NOT NULL'));
<a name="l1660"><span class="linenum">1660</span></a>          <a class="var it3753" onMouseOver="hilite(3753)" onMouseOut="lolite()" onClick="logVariable('proxies')" href="../../_variables/proxies.html">$proxies</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('lti_tool_proxies', null, 'state DESC, timemodified DESC');
<a name="l1661"><span class="linenum">1661</span></a>          foreach (<a class="var it3753" onMouseOver="hilite(3753)" onMouseOut="lolite()" onClick="logVariable('proxies')" href="../../_variables/proxies.html">$proxies</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l1662"><span class="linenum">1662</span></a>              if (<a class="phpfunction" onClick="logFunction('in_array')" href="../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>-&gt;<a onClick="logVariable('id')" class="var it43035" onMouseOver="hilite(43035)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it35787" onMouseOver="hilite(35787)" onMouseOut="lolite()" onClick="logVariable('usedproxyids')" href="../../_variables/usedproxyids.html">$usedproxyids</a>)) {
<a name="l1663"><span class="linenum">1663</span></a>                  unset(<a class="var it3753" onMouseOver="hilite(3753)" onMouseOut="lolite()" onClick="logVariable('proxies')" href="../../_variables/proxies.html">$proxies</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>]);
<a name="l1664"><span class="linenum">1664</span></a>              }
<a name="l1665"><span class="linenum">1665</span></a>          }
<a name="l1666"><span class="linenum">1666</span></a>          return <a class="var it3753" onMouseOver="hilite(3753)" onMouseOut="lolite()" onClick="logVariable('proxies')" href="../../_variables/proxies.html">$proxies</a>;
<a name="l1667"><span class="linenum">1667</span></a>      } else {
<a name="l1668"><span class="linenum">1668</span></a>          return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('lti_tool_proxies', null, 'state DESC, timemodified DESC');
<a name="l1669"><span class="linenum">1669</span></a>      }
<a name="l1670"><span class="linenum">1670</span></a>  }
<a name="l1671"><span class="linenum">1671</span></a>  
<a name="l1672"><span class="linenum">1672</span></a>  <span class="comment">/**</span>
<a name="l1673"><span class="linenum">1673</span></a>  <span class="comment"> * Generates some of the tool proxy configuration based on the admin configuration details</span>
<a name="l1674"><span class="linenum">1674</span></a>  <span class="comment"> *</span>
<a name="l1675"><span class="linenum">1675</span></a>  <span class="comment"> * @param int $id</span>
<a name="l1676"><span class="linenum">1676</span></a>  <span class="comment"> *</span>
<a name="l1677"><span class="linenum">1677</span></a>  <span class="comment"> * @return Tool Proxy details</span>
<a name="l1678"><span class="linenum">1678</span></a>  <span class="comment"> */</span>
<a name="l1679"><span class="linenum">1679</span></a>  function <a class="function" onClick="logFunction('lti_get_tool_proxy_config')" href="../../_functions/lti_get_tool_proxy_config.html" onMouseOver="funcPopup(event,'lti_get_tool_proxy_config')">lti_get_tool_proxy_config</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>) {
<a name="l1680"><span class="linenum">1680</span></a>      <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a> = <a class="function" onClick="logFunction('lti_get_tool_proxy')" href="../../_functions/lti_get_tool_proxy.html" onMouseOver="funcPopup(event,'lti_get_tool_proxy')">lti_get_tool_proxy</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>);
<a name="l1681"><span class="linenum">1681</span></a>  
<a name="l1682"><span class="linenum">1682</span></a>      <a class="var it2744" onMouseOver="hilite(2744)" onMouseOut="lolite()" onClick="logVariable('tp')" href="../../_variables/tp.html">$tp</a> = new \stdClass();
<a name="l1683"><span class="linenum">1683</span></a>      <a class="var it2744" onMouseOver="hilite(2744)" onMouseOut="lolite()" onClick="logVariable('tp')" href="../../_variables/tp.html">$tp</a>-&gt;<a onClick="logVariable('lti_registrationname')" class="var it45514" onMouseOver="hilite(45514)" onMouseOut="lolite()" href="../../_variables/lti_registrationname.html">lti_registrationname</a> = <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('name')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>;
<a name="l1684"><span class="linenum">1684</span></a>      <a class="var it2744" onMouseOver="hilite(2744)" onMouseOut="lolite()" onClick="logVariable('tp')" href="../../_variables/tp.html">$tp</a>-&gt;<a onClick="logVariable('toolproxyid')" class="var it45514" onMouseOver="hilite(45514)" onMouseOut="lolite()" href="../../_variables/toolproxyid.html">toolproxyid</a> = <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('id')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l1685"><span class="linenum">1685</span></a>      <a class="var it2744" onMouseOver="hilite(2744)" onMouseOut="lolite()" onClick="logVariable('tp')" href="../../_variables/tp.html">$tp</a>-&gt;<a onClick="logVariable('state')" class="var it45514" onMouseOver="hilite(45514)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> = <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('state')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/state.html">state</a>;
<a name="l1686"><span class="linenum">1686</span></a>      <a class="var it2744" onMouseOver="hilite(2744)" onMouseOut="lolite()" onClick="logVariable('tp')" href="../../_variables/tp.html">$tp</a>-&gt;<a onClick="logVariable('lti_registrationurl')" class="var it45514" onMouseOver="hilite(45514)" onMouseOut="lolite()" href="../../_variables/lti_registrationurl.html">lti_registrationurl</a> = <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('regurl')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/regurl.html">regurl</a>;
<a name="l1687"><span class="linenum">1687</span></a>      <a class="var it2744" onMouseOver="hilite(2744)" onMouseOut="lolite()" onClick="logVariable('tp')" href="../../_variables/tp.html">$tp</a>-&gt;<a onClick="logVariable('lti_capabilities')" class="var it45514" onMouseOver="hilite(45514)" onMouseOut="lolite()" href="../../_variables/lti_capabilities.html">lti_capabilities</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(&quot;\n&quot;, <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('capabilityoffered')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/capabilityoffered.html">capabilityoffered</a>);
<a name="l1688"><span class="linenum">1688</span></a>      <a class="var it2744" onMouseOver="hilite(2744)" onMouseOut="lolite()" onClick="logVariable('tp')" href="../../_variables/tp.html">$tp</a>-&gt;<a onClick="logVariable('lti_services')" class="var it45514" onMouseOver="hilite(45514)" onMouseOut="lolite()" href="../../_variables/lti_services.html">lti_services</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(&quot;\n&quot;, <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('serviceoffered')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/serviceoffered.html">serviceoffered</a>);
<a name="l1689"><span class="linenum">1689</span></a>  
<a name="l1690"><span class="linenum">1690</span></a>      return <a class="var it2744" onMouseOver="hilite(2744)" onMouseOut="lolite()" onClick="logVariable('tp')" href="../../_variables/tp.html">$tp</a>;
<a name="l1691"><span class="linenum">1691</span></a>  }
<a name="l1692"><span class="linenum">1692</span></a>  
<a name="l1693"><span class="linenum">1693</span></a>  <span class="comment">/**</span>
<a name="l1694"><span class="linenum">1694</span></a>  <span class="comment"> * Update the database with a tool proxy instance</span>
<a name="l1695"><span class="linenum">1695</span></a>  <span class="comment"> *</span>
<a name="l1696"><span class="linenum">1696</span></a>  <span class="comment"> * @param object   $config    Tool proxy definition</span>
<a name="l1697"><span class="linenum">1697</span></a>  <span class="comment"> *</span>
<a name="l1698"><span class="linenum">1698</span></a>  <span class="comment"> * @return int  Record id number</span>
<a name="l1699"><span class="linenum">1699</span></a>  <span class="comment"> */</span>
<a name="l1700"><span class="linenum">1700</span></a>  function <a class="function" onClick="logFunction('lti_add_tool_proxy')" href="../../_functions/lti_add_tool_proxy.html" onMouseOver="funcPopup(event,'lti_add_tool_proxy')">lti_add_tool_proxy</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>) {
<a name="l1701"><span class="linenum">1701</span></a>      global <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1702"><span class="linenum">1702</span></a>  
<a name="l1703"><span class="linenum">1703</span></a>      <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a> = new \stdClass();
<a name="l1704"><span class="linenum">1704</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_registrationname')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_registrationname.html">lti_registrationname</a>)) {
<a name="l1705"><span class="linenum">1705</span></a>          <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('name')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/name.html">name</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_registrationname')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_registrationname.html">lti_registrationname</a>);
<a name="l1706"><span class="linenum">1706</span></a>      }
<a name="l1707"><span class="linenum">1707</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_registrationurl')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_registrationurl.html">lti_registrationurl</a>)) {
<a name="l1708"><span class="linenum">1708</span></a>          <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('regurl')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/regurl.html">regurl</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_registrationurl')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_registrationurl.html">lti_registrationurl</a>);
<a name="l1709"><span class="linenum">1709</span></a>      }
<a name="l1710"><span class="linenum">1710</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_capabilities')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_capabilities.html">lti_capabilities</a>)) {
<a name="l1711"><span class="linenum">1711</span></a>          <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('capabilityoffered')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/capabilityoffered.html">capabilityoffered</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(&quot;\n&quot;, <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_capabilities')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_capabilities.html">lti_capabilities</a>);
<a name="l1712"><span class="linenum">1712</span></a>      } else {
<a name="l1713"><span class="linenum">1713</span></a>          <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('capabilityoffered')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/capabilityoffered.html">capabilityoffered</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(&quot;\n&quot;, <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="function" onClick="logFunction('lti_get_capabilities')" href="../../_functions/lti_get_capabilities.html" onMouseOver="funcPopup(event,'lti_get_capabilities')">lti_get_capabilities</a>()));
<a name="l1714"><span class="linenum">1714</span></a>      }
<a name="l1715"><span class="linenum">1715</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_services')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_services.html">lti_services</a>)) {
<a name="l1716"><span class="linenum">1716</span></a>          <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('serviceoffered')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/serviceoffered.html">serviceoffered</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(&quot;\n&quot;, <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('lti_services')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/lti_services.html">lti_services</a>);
<a name="l1717"><span class="linenum">1717</span></a>      } else {
<a name="l1718"><span class="linenum">1718</span></a>          <a class="var it5458" onMouseOver="hilite(5458)" onMouseOut="lolite()" onClick="logVariable('func')" href="../../_variables/func.html">$func</a> = function(<a class="var it105" onMouseOver="hilite(105)" onMouseOut="lolite()" onClick="logVariable('s')" href="../../_variables/s.html">$s</a>) {
<a name="l1719"><span class="linenum">1719</span></a>              return <a class="var it105" onMouseOver="hilite(105)" onMouseOut="lolite()" onClick="logVariable('s')" href="../../_variables/s.html">$s</a>-&gt;<a class="function" onClick="logFunction('get_id')" href="../../_functions/get_id.html" onMouseOver="funcPopup(event,'get_id')">get_id</a>();
<a name="l1720"><span class="linenum">1720</span></a>          };
<a name="l1721"><span class="linenum">1721</span></a>          <a class="var it35788" onMouseOver="hilite(35788)" onMouseOut="lolite()" onClick="logVariable('servicenames')" href="../../_variables/servicenames.html">$servicenames</a> = <a class="phpfunction" onClick="logFunction('array_map')" href="../../_functions/array_map.html" onMouseOver="phpfuncPopup(event,'array_map')">array_map</a>(<a class="var it5458" onMouseOver="hilite(5458)" onMouseOut="lolite()" onClick="logVariable('func')" href="../../_variables/func.html">$func</a>, <a class="function" onClick="logFunction('lti_get_services')" href="../../_functions/lti_get_services.html" onMouseOver="funcPopup(event,'lti_get_services')">lti_get_services</a>());
<a name="l1722"><span class="linenum">1722</span></a>          <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('serviceoffered')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/serviceoffered.html">serviceoffered</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(&quot;\n&quot;, <a class="var it35788" onMouseOver="hilite(35788)" onMouseOut="lolite()" onClick="logVariable('servicenames')" href="../../_variables/servicenames.html">$servicenames</a>);
<a name="l1723"><span class="linenum">1723</span></a>      }
<a name="l1724"><span class="linenum">1724</span></a>      if (isset(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('toolproxyid')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/toolproxyid.html">toolproxyid</a>) &amp;&amp; !empty(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('toolproxyid')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/toolproxyid.html">toolproxyid</a>)) {
<a name="l1725"><span class="linenum">1725</span></a>          <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('id')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('toolproxyid')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/toolproxyid.html">toolproxyid</a>;
<a name="l1726"><span class="linenum">1726</span></a>          if (!isset(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('state')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/state.html">state</a>) || (<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('state')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> != <a class="constant" onClick="logConstant('LTI_TOOL_PROXY_STATE_ACCEPTED')" href="../../_constants/LTI_TOOL_PROXY_STATE_ACCEPTED.html" onMouseOver="constPopup(event,'LTI_TOOL_PROXY_STATE_ACCEPTED')">LTI_TOOL_PROXY_STATE_ACCEPTED</a>)) {
<a name="l1727"><span class="linenum">1727</span></a>              <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('state')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> = <a class="constant" onClick="logConstant('LTI_TOOL_PROXY_STATE_CONFIGURED')" href="../../_constants/LTI_TOOL_PROXY_STATE_CONFIGURED.html" onMouseOver="constPopup(event,'LTI_TOOL_PROXY_STATE_CONFIGURED')">LTI_TOOL_PROXY_STATE_CONFIGURED</a>;
<a name="l1728"><span class="linenum">1728</span></a>              <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('guid')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/guid.html">guid</a> = <a class="function" onClick="logFunction('random_string')" href="../../_functions/random_string.html" onMouseOver="funcPopup(event,'random_string')">random_string</a>();
<a name="l1729"><span class="linenum">1729</span></a>              <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('secret')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/secret.html">secret</a> = <a class="function" onClick="logFunction('random_string')" href="../../_functions/random_string.html" onMouseOver="funcPopup(event,'random_string')">random_string</a>();
<a name="l1730"><span class="linenum">1730</span></a>          }
<a name="l1731"><span class="linenum">1731</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> = <a class="function" onClick="logFunction('lti_update_tool_proxy')" href="../../_functions/lti_update_tool_proxy.html" onMouseOver="funcPopup(event,'lti_update_tool_proxy')">lti_update_tool_proxy</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>);
<a name="l1732"><span class="linenum">1732</span></a>      } else {
<a name="l1733"><span class="linenum">1733</span></a>          <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('state')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> = <a class="constant" onClick="logConstant('LTI_TOOL_PROXY_STATE_CONFIGURED')" href="../../_constants/LTI_TOOL_PROXY_STATE_CONFIGURED.html" onMouseOver="constPopup(event,'LTI_TOOL_PROXY_STATE_CONFIGURED')">LTI_TOOL_PROXY_STATE_CONFIGURED</a>;
<a name="l1734"><span class="linenum">1734</span></a>          <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('timemodified')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l1735"><span class="linenum">1735</span></a>          <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('timecreated')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a> = <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('timemodified')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a>;
<a name="l1736"><span class="linenum">1736</span></a>          if (!isset(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('createdby')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/createdby.html">createdby</a>)) {
<a name="l1737"><span class="linenum">1737</span></a>              <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('createdby')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/createdby.html">createdby</a> = <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l1738"><span class="linenum">1738</span></a>          }
<a name="l1739"><span class="linenum">1739</span></a>          <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('guid')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/guid.html">guid</a> = <a class="function" onClick="logFunction('random_string')" href="../../_functions/random_string.html" onMouseOver="funcPopup(event,'random_string')">random_string</a>();
<a name="l1740"><span class="linenum">1740</span></a>          <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('secret')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/secret.html">secret</a> = <a class="function" onClick="logFunction('random_string')" href="../../_functions/random_string.html" onMouseOver="funcPopup(event,'random_string')">random_string</a>();
<a name="l1741"><span class="linenum">1741</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('lti_tool_proxies', <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>);
<a name="l1742"><span class="linenum">1742</span></a>      }
<a name="l1743"><span class="linenum">1743</span></a>  
<a name="l1744"><span class="linenum">1744</span></a>      return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>;
<a name="l1745"><span class="linenum">1745</span></a>  }
<a name="l1746"><span class="linenum">1746</span></a>  
<a name="l1747"><span class="linenum">1747</span></a>  <span class="comment">/**</span>
<a name="l1748"><span class="linenum">1748</span></a>  <span class="comment"> * Updates a tool proxy in the database</span>
<a name="l1749"><span class="linenum">1749</span></a>  <span class="comment"> *</span>
<a name="l1750"><span class="linenum">1750</span></a>  <span class="comment"> * @param object  $toolproxy   Tool proxy</span>
<a name="l1751"><span class="linenum">1751</span></a>  <span class="comment"> *</span>
<a name="l1752"><span class="linenum">1752</span></a>  <span class="comment"> * @return int    Record id number</span>
<a name="l1753"><span class="linenum">1753</span></a>  <span class="comment"> */</span>
<a name="l1754"><span class="linenum">1754</span></a>  function <a class="function" onClick="logFunction('lti_update_tool_proxy')" href="../../_functions/lti_update_tool_proxy.html" onMouseOver="funcPopup(event,'lti_update_tool_proxy')">lti_update_tool_proxy</a>(<a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>) {
<a name="l1755"><span class="linenum">1755</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1756"><span class="linenum">1756</span></a>  
<a name="l1757"><span class="linenum">1757</span></a>      <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>-&gt;<a onClick="logVariable('timemodified')" class="var it44705" onMouseOver="hilite(44705)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l1758"><span class="linenum">1758</span></a>      <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('lti_tool_proxies', <a class="var it3773" onMouseOver="hilite(3773)" onMouseOut="lolite()" onClick="logVariable('toolproxy')" href="../../_variables/toolproxy.html">$toolproxy</a>);
<a name="l1759"><span class="linenum">1759</span></a>  
<a name="l1760"><span class="linenum">1760</span></a>      return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>;
<a name="l1761"><span class="linenum">1761</span></a>  }
<a name="l1762"><span class="linenum">1762</span></a>  
<a name="l1763"><span class="linenum">1763</span></a>  <span class="comment">/**</span>
<a name="l1764"><span class="linenum">1764</span></a>  <span class="comment"> * Delete a Tool Proxy</span>
<a name="l1765"><span class="linenum">1765</span></a>  <span class="comment"> *</span>
<a name="l1766"><span class="linenum">1766</span></a>  <span class="comment"> * @param int $id   Tool Proxy id</span>
<a name="l1767"><span class="linenum">1767</span></a>  <span class="comment"> */</span>
<a name="l1768"><span class="linenum">1768</span></a>  function <a class="function" onClick="logFunction('lti_delete_tool_proxy')" href="../../_functions/lti_delete_tool_proxy.html" onMouseOver="funcPopup(event,'lti_delete_tool_proxy')">lti_delete_tool_proxy</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>) {
<a name="l1769"><span class="linenum">1769</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1770"><span class="linenum">1770</span></a>      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('lti_tool_settings', array('toolproxyid' =&gt; <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>));
<a name="l1771"><span class="linenum">1771</span></a>      <a class="var it24702" onMouseOver="hilite(24702)" onMouseOut="lolite()" onClick="logVariable('tools')" href="../../_variables/tools.html">$tools</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('lti_types', array('toolproxyid' =&gt; <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>));
<a name="l1772"><span class="linenum">1772</span></a>      foreach (<a class="var it24702" onMouseOver="hilite(24702)" onMouseOut="lolite()" onClick="logVariable('tools')" href="../../_variables/tools.html">$tools</a> as <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>) {
<a name="l1773"><span class="linenum">1773</span></a>          <a class="function" onClick="logFunction('lti_delete_type')" href="../../_functions/lti_delete_type.html" onMouseOver="funcPopup(event,'lti_delete_type')">lti_delete_type</a>(<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('id')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l1774"><span class="linenum">1774</span></a>      }
<a name="l1775"><span class="linenum">1775</span></a>      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('lti_tool_proxies', array('id' =&gt; <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>));
<a name="l1776"><span class="linenum">1776</span></a>  }
<a name="l1777"><span class="linenum">1777</span></a>  
<a name="l1778"><span class="linenum">1778</span></a>  <span class="comment">/**</span>
<a name="l1779"><span class="linenum">1779</span></a>  <span class="comment"> * Add a tool configuration in the database</span>
<a name="l1780"><span class="linenum">1780</span></a>  <span class="comment"> *</span>
<a name="l1781"><span class="linenum">1781</span></a>  <span class="comment"> * @param object $config   Tool configuration</span>
<a name="l1782"><span class="linenum">1782</span></a>  <span class="comment"> *</span>
<a name="l1783"><span class="linenum">1783</span></a>  <span class="comment"> * @return int Record id number</span>
<a name="l1784"><span class="linenum">1784</span></a>  <span class="comment"> */</span>
<a name="l1785"><span class="linenum">1785</span></a>  function <a class="function" onClick="logFunction('lti_add_config')" href="../../_functions/lti_add_config.html" onMouseOver="funcPopup(event,'lti_add_config')">lti_add_config</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>) {
<a name="l1786"><span class="linenum">1786</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1787"><span class="linenum">1787</span></a>  
<a name="l1788"><span class="linenum">1788</span></a>      return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('lti_types_config', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>);
<a name="l1789"><span class="linenum">1789</span></a>  }
<a name="l1790"><span class="linenum">1790</span></a>  
<a name="l1791"><span class="linenum">1791</span></a>  <span class="comment">/**</span>
<a name="l1792"><span class="linenum">1792</span></a>  <span class="comment"> * Updates a tool configuration in the database</span>
<a name="l1793"><span class="linenum">1793</span></a>  <span class="comment"> *</span>
<a name="l1794"><span class="linenum">1794</span></a>  <span class="comment"> * @param object  $config   Tool configuration</span>
<a name="l1795"><span class="linenum">1795</span></a>  <span class="comment"> *</span>
<a name="l1796"><span class="linenum">1796</span></a>  <span class="comment"> * @return Record id number</span>
<a name="l1797"><span class="linenum">1797</span></a>  <span class="comment"> */</span>
<a name="l1798"><span class="linenum">1798</span></a>  function <a class="function" onClick="logFunction('lti_update_config')" href="../../_functions/lti_update_config.html" onMouseOver="funcPopup(event,'lti_update_config')">lti_update_config</a>(<a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>) {
<a name="l1799"><span class="linenum">1799</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1800"><span class="linenum">1800</span></a>  
<a name="l1801"><span class="linenum">1801</span></a>      <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a> = true;
<a name="l1802"><span class="linenum">1802</span></a>      <a class="var it477" onMouseOver="hilite(477)" onMouseOut="lolite()" onClick="logVariable('old')" href="../../_variables/old.html">$old</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('lti_types_config', array('typeid' =&gt; <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('typeid')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/typeid.html">typeid</a>, 'name' =&gt; <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('name')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>));
<a name="l1803"><span class="linenum">1803</span></a>  
<a name="l1804"><span class="linenum">1804</span></a>      if (<a class="var it477" onMouseOver="hilite(477)" onMouseOut="lolite()" onClick="logVariable('old')" href="../../_variables/old.html">$old</a>) {
<a name="l1805"><span class="linenum">1805</span></a>          <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>-&gt;<a onClick="logVariable('id')" class="var it42981" onMouseOver="hilite(42981)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it477" onMouseOver="hilite(477)" onMouseOut="lolite()" onClick="logVariable('old')" href="../../_variables/old.html">$old</a>-&gt;<a onClick="logVariable('id')" class="var it43210" onMouseOver="hilite(43210)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l1806"><span class="linenum">1806</span></a>          <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('lti_types_config', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>);
<a name="l1807"><span class="linenum">1807</span></a>      } else {
<a name="l1808"><span class="linenum">1808</span></a>          <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('lti_types_config', <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../_variables/config.html">$config</a>);
<a name="l1809"><span class="linenum">1809</span></a>      }
<a name="l1810"><span class="linenum">1810</span></a>      return <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('return')" href="../../_variables/return.html">$return</a>;
<a name="l1811"><span class="linenum">1811</span></a>  }
<a name="l1812"><span class="linenum">1812</span></a>  
<a name="l1813"><span class="linenum">1813</span></a>  <span class="comment">/**</span>
<a name="l1814"><span class="linenum">1814</span></a>  <span class="comment"> * Gets the tool settings</span>
<a name="l1815"><span class="linenum">1815</span></a>  <span class="comment"> *</span>
<a name="l1816"><span class="linenum">1816</span></a>  <span class="comment"> * @param int  $toolproxyid   Id of tool proxy record</span>
<a name="l1817"><span class="linenum">1817</span></a>  <span class="comment"> * @param int  $courseid      Id of course (null if system settings)</span>
<a name="l1818"><span class="linenum">1818</span></a>  <span class="comment"> * @param int  $instanceid    Id of course module (null if system or context settings)</span>
<a name="l1819"><span class="linenum">1819</span></a>  <span class="comment"> *</span>
<a name="l1820"><span class="linenum">1820</span></a>  <span class="comment"> * @return array  Array settings</span>
<a name="l1821"><span class="linenum">1821</span></a>  <span class="comment"> */</span>
<a name="l1822"><span class="linenum">1822</span></a>  function <a class="function" onClick="logFunction('lti_get_tool_settings')" href="../../_functions/lti_get_tool_settings.html" onMouseOver="funcPopup(event,'lti_get_tool_settings')">lti_get_tool_settings</a>(<a class="var it3774" onMouseOver="hilite(3774)" onMouseOut="lolite()" onClick="logVariable('toolproxyid')" href="../../_variables/toolproxyid.html">$toolproxyid</a>, <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a> = null, <a class="var it1184" onMouseOver="hilite(1184)" onMouseOut="lolite()" onClick="logVariable('instanceid')" href="../../_variables/instanceid.html">$instanceid</a> = null) {
<a name="l1823"><span class="linenum">1823</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1824"><span class="linenum">1824</span></a>  
<a name="l1825"><span class="linenum">1825</span></a>      <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('settings')" href="../../_variables/settings.html">$settings</a> = array();
<a name="l1826"><span class="linenum">1826</span></a>      <a class="var it21409" onMouseOver="hilite(21409)" onMouseOut="lolite()" onClick="logVariable('settingsstr')" href="../../_variables/settingsstr.html">$settingsstr</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_field')" href="../../_functions/get_field.html" onMouseOver="funcPopup(event,'get_field')">get_field</a>('lti_tool_settings', 'settings', array('toolproxyid' =&gt; <a class="var it3774" onMouseOver="hilite(3774)" onMouseOut="lolite()" onClick="logVariable('toolproxyid')" href="../../_variables/toolproxyid.html">$toolproxyid</a>,
<a name="l1827"><span class="linenum">1827</span></a>          'course' =&gt; <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>, 'coursemoduleid' =&gt; <a class="var it1184" onMouseOver="hilite(1184)" onMouseOut="lolite()" onClick="logVariable('instanceid')" href="../../_variables/instanceid.html">$instanceid</a>));
<a name="l1828"><span class="linenum">1828</span></a>      if (<a class="var it21409" onMouseOver="hilite(21409)" onMouseOut="lolite()" onClick="logVariable('settingsstr')" href="../../_variables/settingsstr.html">$settingsstr</a> !== false) {
<a name="l1829"><span class="linenum">1829</span></a>          <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('settings')" href="../../_variables/settings.html">$settings</a> = json_decode(<a class="var it21409" onMouseOver="hilite(21409)" onMouseOut="lolite()" onClick="logVariable('settingsstr')" href="../../_variables/settingsstr.html">$settingsstr</a>, true);
<a name="l1830"><span class="linenum">1830</span></a>      }
<a name="l1831"><span class="linenum">1831</span></a>      return <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('settings')" href="../../_variables/settings.html">$settings</a>;
<a name="l1832"><span class="linenum">1832</span></a>  }
<a name="l1833"><span class="linenum">1833</span></a>  
<a name="l1834"><span class="linenum">1834</span></a>  <span class="comment">/**</span>
<a name="l1835"><span class="linenum">1835</span></a>  <span class="comment"> * Sets the tool settings (</span>
<a name="l1836"><span class="linenum">1836</span></a>  <span class="comment"> *</span>
<a name="l1837"><span class="linenum">1837</span></a>  <span class="comment"> * @param array  $settings      Array of settings</span>
<a name="l1838"><span class="linenum">1838</span></a>  <span class="comment"> * @param int    $toolproxyid   Id of tool proxy record</span>
<a name="l1839"><span class="linenum">1839</span></a>  <span class="comment"> * @param int    $courseid      Id of course (null if system settings)</span>
<a name="l1840"><span class="linenum">1840</span></a>  <span class="comment"> * @param int    $instanceid    Id of course module (null if system or context settings)</span>
<a name="l1841"><span class="linenum">1841</span></a>  <span class="comment"> */</span>
<a name="l1842"><span class="linenum">1842</span></a>  function <a class="function" onClick="logFunction('lti_set_tool_settings')" href="../../_functions/lti_set_tool_settings.html" onMouseOver="funcPopup(event,'lti_set_tool_settings')">lti_set_tool_settings</a>(<a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('settings')" href="../../_variables/settings.html">$settings</a>, <a class="var it3774" onMouseOver="hilite(3774)" onMouseOut="lolite()" onClick="logVariable('toolproxyid')" href="../../_variables/toolproxyid.html">$toolproxyid</a>, <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a> = null, <a class="var it1184" onMouseOver="hilite(1184)" onMouseOut="lolite()" onClick="logVariable('instanceid')" href="../../_variables/instanceid.html">$instanceid</a> = null) {
<a name="l1843"><span class="linenum">1843</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1844"><span class="linenum">1844</span></a>  
<a name="l1845"><span class="linenum">1845</span></a>      <a class="var it2497" onMouseOver="hilite(2497)" onMouseOut="lolite()" onClick="logVariable('json')" href="../../_variables/json.html">$json</a> = <a class="function" onClick="logFunction('json_encode')" href="../../_functions/json_encode.html" onMouseOver="funcPopup(event,'json_encode')">json_encode</a>(<a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('settings')" href="../../_variables/settings.html">$settings</a>);
<a name="l1846"><span class="linenum">1846</span></a>      <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('lti_tool_settings', array('toolproxyid' =&gt; <a class="var it3774" onMouseOver="hilite(3774)" onMouseOut="lolite()" onClick="logVariable('toolproxyid')" href="../../_variables/toolproxyid.html">$toolproxyid</a>,
<a name="l1847"><span class="linenum">1847</span></a>          'course' =&gt; <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>, 'coursemoduleid' =&gt; <a class="var it1184" onMouseOver="hilite(1184)" onMouseOut="lolite()" onClick="logVariable('instanceid')" href="../../_variables/instanceid.html">$instanceid</a>));
<a name="l1848"><span class="linenum">1848</span></a>      if (<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a> !== false) {
<a name="l1849"><span class="linenum">1849</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('lti_tool_settings', array('id' =&gt; <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'settings' =&gt; <a class="var it2497" onMouseOver="hilite(2497)" onMouseOut="lolite()" onClick="logVariable('json')" href="../../_variables/json.html">$json</a>, 'timemodified' =&gt; <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>()));
<a name="l1850"><span class="linenum">1850</span></a>      } else {
<a name="l1851"><span class="linenum">1851</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a> = new \stdClass();
<a name="l1852"><span class="linenum">1852</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('toolproxyid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/toolproxyid.html">toolproxyid</a> = <a class="var it3774" onMouseOver="hilite(3774)" onMouseOut="lolite()" onClick="logVariable('toolproxyid')" href="../../_variables/toolproxyid.html">$toolproxyid</a>;
<a name="l1853"><span class="linenum">1853</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('course')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/course.html">course</a> = <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>;
<a name="l1854"><span class="linenum">1854</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('coursemoduleid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/coursemoduleid.html">coursemoduleid</a> = <a class="var it1184" onMouseOver="hilite(1184)" onMouseOut="lolite()" onClick="logVariable('instanceid')" href="../../_variables/instanceid.html">$instanceid</a>;
<a name="l1855"><span class="linenum">1855</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('settings')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/settings.html">settings</a> = <a class="var it2497" onMouseOver="hilite(2497)" onMouseOut="lolite()" onClick="logVariable('json')" href="../../_variables/json.html">$json</a>;
<a name="l1856"><span class="linenum">1856</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('timecreated')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l1857"><span class="linenum">1857</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('timemodified')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('timecreated')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a>;
<a name="l1858"><span class="linenum">1858</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('lti_tool_settings', <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>);
<a name="l1859"><span class="linenum">1859</span></a>      }
<a name="l1860"><span class="linenum">1860</span></a>  }
<a name="l1861"><span class="linenum">1861</span></a>  
<a name="l1862"><span class="linenum">1862</span></a>  <span class="comment">/**</span>
<a name="l1863"><span class="linenum">1863</span></a>  <span class="comment"> * Signs the petition to launch the external tool using OAuth</span>
<a name="l1864"><span class="linenum">1864</span></a>  <span class="comment"> *</span>
<a name="l1865"><span class="linenum">1865</span></a>  <span class="comment"> * @param $oldparms     Parameters to be passed for signing</span>
<a name="l1866"><span class="linenum">1866</span></a>  <span class="comment"> * @param $endpoint     url of the external tool</span>
<a name="l1867"><span class="linenum">1867</span></a>  <span class="comment"> * @param $method       Method for sending the parameters (e.g. POST)</span>
<a name="l1868"><span class="linenum">1868</span></a>  <span class="comment"> * @param $oauth_consumoer_key          Key</span>
<a name="l1869"><span class="linenum">1869</span></a>  <span class="comment"> * @param $oauth_consumoer_secret       Secret</span>
<a name="l1870"><span class="linenum">1870</span></a>  <span class="comment"> */</span>
<a name="l1871"><span class="linenum">1871</span></a>  function <a class="function" onClick="logFunction('lti_sign_parameters')" href="../../_functions/lti_sign_parameters.html" onMouseOver="funcPopup(event,'lti_sign_parameters')">lti_sign_parameters</a>(<a class="var it24848" onMouseOver="hilite(24848)" onMouseOut="lolite()" onClick="logVariable('oldparms')" href="../../_variables/oldparms.html">$oldparms</a>, <a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a>, <a class="var it532" onMouseOver="hilite(532)" onMouseOut="lolite()" onClick="logVariable('method')" href="../../_variables/method.html">$method</a>, <a class="var it24990" onMouseOver="hilite(24990)" onMouseOut="lolite()" onClick="logVariable('oauthconsumerkey')" href="../../_variables/oauthconsumerkey.html">$oauthconsumerkey</a>, <a class="var it24991" onMouseOver="hilite(24991)" onMouseOut="lolite()" onClick="logVariable('oauthconsumersecret')" href="../../_variables/oauthconsumersecret.html">$oauthconsumersecret</a>) {
<a name="l1872"><span class="linenum">1872</span></a>  
<a name="l1873"><span class="linenum">1873</span></a>      <a class="var it3757" onMouseOver="hilite(3757)" onMouseOut="lolite()" onClick="logVariable('parms')" href="../../_variables/parms.html">$parms</a> = <a class="var it24848" onMouseOver="hilite(24848)" onMouseOut="lolite()" onClick="logVariable('oldparms')" href="../../_variables/oldparms.html">$oldparms</a>;
<a name="l1874"><span class="linenum">1874</span></a>  
<a name="l1875"><span class="linenum">1875</span></a>      <a class="var it35789" onMouseOver="hilite(35789)" onMouseOut="lolite()" onClick="logVariable('testtoken')" href="../../_variables/testtoken.html">$testtoken</a> = '';
<a name="l1876"><span class="linenum">1876</span></a>  
<a name="l1877"><span class="linenum">1877</span></a>  <span class="comment">    // TODO: Switch to core oauthlib once implemented - MDL-30149.</span>
<a name="l1878"><span class="linenum">1878</span></a>      <a class="var it35790" onMouseOver="hilite(35790)" onMouseOut="lolite()" onClick="logVariable('hmacmethod')" href="../../_variables/hmacmethod.html">$hmacmethod</a> = new lti\OAuthSignatureMethod_HMAC_SHA1();
<a name="l1879"><span class="linenum">1879</span></a>      <a class="var it35791" onMouseOver="hilite(35791)" onMouseOut="lolite()" onClick="logVariable('testconsumer')" href="../../_variables/testconsumer.html">$testconsumer</a> = new lti\OAuthConsumer(<a class="var it24990" onMouseOver="hilite(24990)" onMouseOut="lolite()" onClick="logVariable('oauthconsumerkey')" href="../../_variables/oauthconsumerkey.html">$oauthconsumerkey</a>, <a class="var it24991" onMouseOver="hilite(24991)" onMouseOut="lolite()" onClick="logVariable('oauthconsumersecret')" href="../../_variables/oauthconsumersecret.html">$oauthconsumersecret</a>, null);
<a name="l1880"><span class="linenum">1880</span></a>      <a class="var it35792" onMouseOver="hilite(35792)" onMouseOut="lolite()" onClick="logVariable('accreq')" href="../../_variables/accreq.html">$accreq</a> = lti\<a class="class" onClick="logClass('OAuthRequest')" href="../../_classes/oauthrequest.html" onMouseOver="classPopup(event,'oauthrequest')">OAuthRequest</a>::<a class="function" onClick="logFunction('from_consumer_and_token')" href="../../_functions/from_consumer_and_token.html" onMouseOver="funcPopup(event,'from_consumer_and_token')">from_consumer_and_token</a>(<a class="var it35791" onMouseOver="hilite(35791)" onMouseOut="lolite()" onClick="logVariable('testconsumer')" href="../../_variables/testconsumer.html">$testconsumer</a>, <a class="var it35789" onMouseOver="hilite(35789)" onMouseOut="lolite()" onClick="logVariable('testtoken')" href="../../_variables/testtoken.html">$testtoken</a>, <a class="var it532" onMouseOver="hilite(532)" onMouseOut="lolite()" onClick="logVariable('method')" href="../../_variables/method.html">$method</a>, <a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a>, <a class="var it3757" onMouseOver="hilite(3757)" onMouseOut="lolite()" onClick="logVariable('parms')" href="../../_variables/parms.html">$parms</a>);
<a name="l1881"><span class="linenum">1881</span></a>      <a class="var it35792" onMouseOver="hilite(35792)" onMouseOut="lolite()" onClick="logVariable('accreq')" href="../../_variables/accreq.html">$accreq</a>-&gt;<a class="function" onClick="logFunction('sign_request')" href="../../_functions/sign_request.html" onMouseOver="funcPopup(event,'sign_request')">sign_request</a>(<a class="var it35790" onMouseOver="hilite(35790)" onMouseOut="lolite()" onClick="logVariable('hmacmethod')" href="../../_variables/hmacmethod.html">$hmacmethod</a>, <a class="var it35791" onMouseOver="hilite(35791)" onMouseOut="lolite()" onClick="logVariable('testconsumer')" href="../../_variables/testconsumer.html">$testconsumer</a>, <a class="var it35789" onMouseOver="hilite(35789)" onMouseOut="lolite()" onClick="logVariable('testtoken')" href="../../_variables/testtoken.html">$testtoken</a>);
<a name="l1882"><span class="linenum">1882</span></a>  
<a name="l1883"><span class="linenum">1883</span></a>      <a class="var it24858" onMouseOver="hilite(24858)" onMouseOut="lolite()" onClick="logVariable('newparms')" href="../../_variables/newparms.html">$newparms</a> = <a class="var it35792" onMouseOver="hilite(35792)" onMouseOut="lolite()" onClick="logVariable('accreq')" href="../../_variables/accreq.html">$accreq</a>-&gt;<a class="function" onClick="logFunction('get_parameters')" href="../../_functions/get_parameters.html" onMouseOver="funcPopup(event,'get_parameters')">get_parameters</a>();
<a name="l1884"><span class="linenum">1884</span></a>  
<a name="l1885"><span class="linenum">1885</span></a>      return <a class="var it24858" onMouseOver="hilite(24858)" onMouseOut="lolite()" onClick="logVariable('newparms')" href="../../_variables/newparms.html">$newparms</a>;
<a name="l1886"><span class="linenum">1886</span></a>  }
<a name="l1887"><span class="linenum">1887</span></a>  
<a name="l1888"><span class="linenum">1888</span></a>  <span class="comment">/**</span>
<a name="l1889"><span class="linenum">1889</span></a>  <span class="comment"> * Posts the launch petition HTML</span>
<a name="l1890"><span class="linenum">1890</span></a>  <span class="comment"> *</span>
<a name="l1891"><span class="linenum">1891</span></a>  <span class="comment"> * @param $newparms     Signed parameters</span>
<a name="l1892"><span class="linenum">1892</span></a>  <span class="comment"> * @param $endpoint     URL of the external tool</span>
<a name="l1893"><span class="linenum">1893</span></a>  <span class="comment"> * @param $debug        Debug (true/false)</span>
<a name="l1894"><span class="linenum">1894</span></a>  <span class="comment"> */</span>
<a name="l1895"><span class="linenum">1895</span></a>  function <a class="function" onClick="logFunction('lti_post_launch_html')" href="../../_functions/lti_post_launch_html.html" onMouseOver="funcPopup(event,'lti_post_launch_html')">lti_post_launch_html</a>(<a class="var it24858" onMouseOver="hilite(24858)" onMouseOut="lolite()" onClick="logVariable('newparms')" href="../../_variables/newparms.html">$newparms</a>, <a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a>, <a class="var it75" onMouseOver="hilite(75)" onMouseOut="lolite()" onClick="logVariable('debug')" href="../../_variables/debug.html">$debug</a>=false) {
<a name="l1896"><span class="linenum">1896</span></a>      <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> = &quot;&lt;form action=\&quot;&quot; . <a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a> .
<a name="l1897"><span class="linenum">1897</span></a>          &quot;\&quot; name=\&quot;ltiLaunchForm\&quot; id=\&quot;ltiLaunchForm\&quot; method=\&quot;post\&quot; encType=\&quot;application/x-www-form-urlencoded\&quot;&gt;\n&quot;;
<a name="l1898"><span class="linenum">1898</span></a>  
<a name="l1899"><span class="linenum">1899</span></a>  <span class="comment">    // Contruct html for the launch parameters.</span>
<a name="l1900"><span class="linenum">1900</span></a>      foreach (<a class="var it24858" onMouseOver="hilite(24858)" onMouseOut="lolite()" onClick="logVariable('newparms')" href="../../_variables/newparms.html">$newparms</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l1901"><span class="linenum">1901</span></a>          <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>);
<a name="l1902"><span class="linenum">1902</span></a>          <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>);
<a name="l1903"><span class="linenum">1903</span></a>          if ( <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> == &quot;ext_submit&quot; ) {
<a name="l1904"><span class="linenum">1904</span></a>              <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;&lt;input type=\&quot;submit\&quot;&quot;;
<a name="l1905"><span class="linenum">1905</span></a>          } else {
<a name="l1906"><span class="linenum">1906</span></a>              <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;&lt;input type=\&quot;hidden\&quot; name=\&quot;{<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>}\&quot;&quot;;
<a name="l1907"><span class="linenum">1907</span></a>          }
<a name="l1908"><span class="linenum">1908</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot; value=\&quot;&quot;;
<a name="l1909"><span class="linenum">1909</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l1910"><span class="linenum">1910</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;\&quot;/&gt;\n&quot;;
<a name="l1911"><span class="linenum">1911</span></a>      }
<a name="l1912"><span class="linenum">1912</span></a>  
<a name="l1913"><span class="linenum">1913</span></a>      if ( <a class="var it75" onMouseOver="hilite(75)" onMouseOut="lolite()" onClick="logVariable('debug')" href="../../_variables/debug.html">$debug</a> ) {
<a name="l1914"><span class="linenum">1914</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;&lt;script language=\&quot;javascript\&quot;&gt; \n&quot;;
<a name="l1915"><span class="linenum">1915</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;  //&lt;![CDATA[ \n&quot;;
<a name="l1916"><span class="linenum">1916</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;function basicltiDebugToggle() {\n&quot;;
<a name="l1917"><span class="linenum">1917</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;    var ele = document.getElementById(\&quot;basicltiDebug\&quot;);\n&quot;;
<a name="l1918"><span class="linenum">1918</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;    if (ele.style.display == \&quot;block\&quot;) {\n&quot;;
<a name="l1919"><span class="linenum">1919</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;        ele.style.display = \&quot;none\&quot;;\n&quot;;
<a name="l1920"><span class="linenum">1920</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;    }\n&quot;;
<a name="l1921"><span class="linenum">1921</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;    else {\n&quot;;
<a name="l1922"><span class="linenum">1922</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;        ele.style.display = \&quot;block\&quot;;\n&quot;;
<a name="l1923"><span class="linenum">1923</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;    }\n&quot;;
<a name="l1924"><span class="linenum">1924</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;} \n&quot;;
<a name="l1925"><span class="linenum">1925</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;  //]]&gt; \n&quot;;
<a name="l1926"><span class="linenum">1926</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;&lt;/script&gt;\n&quot;;
<a name="l1927"><span class="linenum">1927</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;&lt;a id=\&quot;displayText\&quot; href=\&quot;javascript:basicltiDebugToggle();\&quot;&gt;&quot;;
<a name="l1928"><span class="linenum">1928</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;toggle_debug_data&quot;, &quot;lti&quot;).&quot;&lt;/a&gt;\n&quot;;
<a name="l1929"><span class="linenum">1929</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;&lt;div id=\&quot;basicltiDebug\&quot; style=\&quot;display:none\&quot;&gt;\n&quot;;
<a name="l1930"><span class="linenum">1930</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;&lt;b&gt;&quot;.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;basiclti_endpoint&quot;, &quot;lti&quot;).&quot;&lt;/b&gt;&lt;br/&gt;\n&quot;;
<a name="l1931"><span class="linenum">1931</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= <a class="var it3756" onMouseOver="hilite(3756)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../_variables/endpoint.html">$endpoint</a> . &quot;&lt;br/&gt;\n&amp;nbsp;&lt;br/&gt;\n&quot;;
<a name="l1932"><span class="linenum">1932</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;&lt;b&gt;&quot;.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;basiclti_parameters&quot;, &quot;lti&quot;).&quot;&lt;/b&gt;&lt;br/&gt;\n&quot;;
<a name="l1933"><span class="linenum">1933</span></a>          foreach (<a class="var it24858" onMouseOver="hilite(24858)" onMouseOut="lolite()" onClick="logVariable('newparms')" href="../../_variables/newparms.html">$newparms</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l1934"><span class="linenum">1934</span></a>              <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>);
<a name="l1935"><span class="linenum">1935</span></a>              <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>);
<a name="l1936"><span class="linenum">1936</span></a>              <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>&lt;br/&gt;\n&quot;;
<a name="l1937"><span class="linenum">1937</span></a>          }
<a name="l1938"><span class="linenum">1938</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;&amp;nbsp;&lt;br/&gt;\n&quot;;
<a name="l1939"><span class="linenum">1939</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;&lt;/div&gt;\n&quot;;
<a name="l1940"><span class="linenum">1940</span></a>      }
<a name="l1941"><span class="linenum">1941</span></a>      <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot;&lt;/form&gt;\n&quot;;
<a name="l1942"><span class="linenum">1942</span></a>  
<a name="l1943"><span class="linenum">1943</span></a>      if ( ! <a class="var it75" onMouseOver="hilite(75)" onMouseOut="lolite()" onClick="logVariable('debug')" href="../../_variables/debug.html">$debug</a> ) {
<a name="l1944"><span class="linenum">1944</span></a>          <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> .= &quot; &lt;script type=\&quot;text/javascript\&quot;&gt; \n&quot; .
<a name="l1945"><span class="linenum">1945</span></a>              &quot;  //&lt;![CDATA[ \n&quot; .
<a name="l1946"><span class="linenum">1946</span></a>              &quot;    document.ltiLaunchForm.<a class="function" onClick="logFunction('submit')" href="../../_functions/submit.html" onMouseOver="funcPopup(event,'submit')">submit</a>(); \n&quot; .
<a name="l1947"><span class="linenum">1947</span></a>              &quot;  //]]&gt; \n&quot; .
<a name="l1948"><span class="linenum">1948</span></a>              &quot; &lt;/script&gt; \n&quot;;
<a name="l1949"><span class="linenum">1949</span></a>      }
<a name="l1950"><span class="linenum">1950</span></a>      return <a class="var it1024" onMouseOver="hilite(1024)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a>;
<a name="l1951"><span class="linenum">1951</span></a>  }
<a name="l1952"><span class="linenum">1952</span></a>  
<a name="l1953"><span class="linenum">1953</span></a>  function <a class="function" onClick="logFunction('lti_get_type')" href="../../_functions/lti_get_type.html" onMouseOver="funcPopup(event,'lti_get_type')">lti_get_type</a>(<a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a>) {
<a name="l1954"><span class="linenum">1954</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1955"><span class="linenum">1955</span></a>  
<a name="l1956"><span class="linenum">1956</span></a>      return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('lti_types', array('id' =&gt; <a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a>));
<a name="l1957"><span class="linenum">1957</span></a>  }
<a name="l1958"><span class="linenum">1958</span></a>  
<a name="l1959"><span class="linenum">1959</span></a>  function <a class="function" onClick="logFunction('lti_get_launch_container')" href="../../_functions/lti_get_launch_container.html" onMouseOver="funcPopup(event,'lti_get_launch_container')">lti_get_launch_container</a>(<a class="var it3755" onMouseOver="hilite(3755)" onMouseOut="lolite()" onClick="logVariable('lti')" href="../../_variables/lti.html">$lti</a>, <a class="var it23748" onMouseOver="hilite(23748)" onMouseOut="lolite()" onClick="logVariable('toolconfig')" href="../../_variables/toolconfig.html">$toolconfig</a>) {
<a name="l1960"><span class="linenum">1960</span></a>      if (empty(<a class="var it3755" onMouseOver="hilite(3755)" onMouseOut="lolite()" onClick="logVariable('lti')" href="../../_variables/lti.html">$lti</a>-&gt;<a onClick="logVariable('launchcontainer')" class="var it45050" onMouseOver="hilite(45050)" onMouseOut="lolite()" href="../../_variables/launchcontainer.html">launchcontainer</a>)) {
<a name="l1961"><span class="linenum">1961</span></a>          <a class="var it3755" onMouseOver="hilite(3755)" onMouseOut="lolite()" onClick="logVariable('lti')" href="../../_variables/lti.html">$lti</a>-&gt;<a onClick="logVariable('launchcontainer')" class="var it45050" onMouseOver="hilite(45050)" onMouseOut="lolite()" href="../../_variables/launchcontainer.html">launchcontainer</a> = <a class="constant" onClick="logConstant('LTI_LAUNCH_CONTAINER_DEFAULT')" href="../../_constants/LTI_LAUNCH_CONTAINER_DEFAULT.html" onMouseOver="constPopup(event,'LTI_LAUNCH_CONTAINER_DEFAULT')">LTI_LAUNCH_CONTAINER_DEFAULT</a>;
<a name="l1962"><span class="linenum">1962</span></a>      }
<a name="l1963"><span class="linenum">1963</span></a>  
<a name="l1964"><span class="linenum">1964</span></a>      if (<a class="var it3755" onMouseOver="hilite(3755)" onMouseOut="lolite()" onClick="logVariable('lti')" href="../../_variables/lti.html">$lti</a>-&gt;<a onClick="logVariable('launchcontainer')" class="var it45050" onMouseOver="hilite(45050)" onMouseOut="lolite()" href="../../_variables/launchcontainer.html">launchcontainer</a> == <a class="constant" onClick="logConstant('LTI_LAUNCH_CONTAINER_DEFAULT')" href="../../_constants/LTI_LAUNCH_CONTAINER_DEFAULT.html" onMouseOver="constPopup(event,'LTI_LAUNCH_CONTAINER_DEFAULT')">LTI_LAUNCH_CONTAINER_DEFAULT</a>) {
<a name="l1965"><span class="linenum">1965</span></a>          if (isset(<a class="var it23748" onMouseOver="hilite(23748)" onMouseOut="lolite()" onClick="logVariable('toolconfig')" href="../../_variables/toolconfig.html">$toolconfig</a>['launchcontainer'])) {
<a name="l1966"><span class="linenum">1966</span></a>              <a class="var it23750" onMouseOver="hilite(23750)" onMouseOut="lolite()" onClick="logVariable('launchcontainer')" href="../../_variables/launchcontainer.html">$launchcontainer</a> = <a class="var it23748" onMouseOver="hilite(23748)" onMouseOut="lolite()" onClick="logVariable('toolconfig')" href="../../_variables/toolconfig.html">$toolconfig</a>['launchcontainer'];
<a name="l1967"><span class="linenum">1967</span></a>          }
<a name="l1968"><span class="linenum">1968</span></a>      } else {
<a name="l1969"><span class="linenum">1969</span></a>          <a class="var it23750" onMouseOver="hilite(23750)" onMouseOut="lolite()" onClick="logVariable('launchcontainer')" href="../../_variables/launchcontainer.html">$launchcontainer</a> = <a class="var it3755" onMouseOver="hilite(3755)" onMouseOut="lolite()" onClick="logVariable('lti')" href="../../_variables/lti.html">$lti</a>-&gt;<a onClick="logVariable('launchcontainer')" class="var it45050" onMouseOver="hilite(45050)" onMouseOut="lolite()" href="../../_variables/launchcontainer.html">launchcontainer</a>;
<a name="l1970"><span class="linenum">1970</span></a>      }
<a name="l1971"><span class="linenum">1971</span></a>  
<a name="l1972"><span class="linenum">1972</span></a>      if (empty(<a class="var it23750" onMouseOver="hilite(23750)" onMouseOut="lolite()" onClick="logVariable('launchcontainer')" href="../../_variables/launchcontainer.html">$launchcontainer</a>) || <a class="var it23750" onMouseOver="hilite(23750)" onMouseOut="lolite()" onClick="logVariable('launchcontainer')" href="../../_variables/launchcontainer.html">$launchcontainer</a> == <a class="constant" onClick="logConstant('LTI_LAUNCH_CONTAINER_DEFAULT')" href="../../_constants/LTI_LAUNCH_CONTAINER_DEFAULT.html" onMouseOver="constPopup(event,'LTI_LAUNCH_CONTAINER_DEFAULT')">LTI_LAUNCH_CONTAINER_DEFAULT</a>) {
<a name="l1973"><span class="linenum">1973</span></a>          <a class="var it23750" onMouseOver="hilite(23750)" onMouseOut="lolite()" onClick="logVariable('launchcontainer')" href="../../_variables/launchcontainer.html">$launchcontainer</a> = <a class="constant" onClick="logConstant('LTI_LAUNCH_CONTAINER_EMBED_NO_BLOCKS')" href="../../_constants/LTI_LAUNCH_CONTAINER_EMBED_NO_BLOCKS.html" onMouseOver="constPopup(event,'LTI_LAUNCH_CONTAINER_EMBED_NO_BLOCKS')">LTI_LAUNCH_CONTAINER_EMBED_NO_BLOCKS</a>;
<a name="l1974"><span class="linenum">1974</span></a>      }
<a name="l1975"><span class="linenum">1975</span></a>  
<a name="l1976"><span class="linenum">1976</span></a>      <a class="var it1444" onMouseOver="hilite(1444)" onMouseOut="lolite()" onClick="logVariable('devicetype')" href="../../_variables/devicetype.html">$devicetype</a> = <a class="class" onClick="logClass('core_useragent')" href="../../_classes/core_useragent.html" onMouseOver="classPopup(event,'core_useragent')">core_useragent</a>::<a class="function" onClick="logFunction('get_device_type')" href="../../_functions/get_device_type.html" onMouseOver="funcPopup(event,'get_device_type')">get_device_type</a>();
<a name="l1977"><span class="linenum">1977</span></a>  
<a name="l1978"><span class="linenum">1978</span></a>  <span class="comment">    // Scrolling within the object element doesn't work on iOS or Android</span>
<a name="l1979"><span class="linenum">1979</span></a>  <span class="comment">    // Opening the popup window also had some issues in testing</span>
<a name="l1980"><span class="linenum">1980</span></a>  <span class="comment">    // For mobile devices, always take up the entire screen to ensure the best experience.</span>
<a name="l1981"><span class="linenum">1981</span></a>      if (<a class="var it1444" onMouseOver="hilite(1444)" onMouseOut="lolite()" onClick="logVariable('devicetype')" href="../../_variables/devicetype.html">$devicetype</a> === <a class="class" onClick="logClass('core_useragent')" href="../../_classes/core_useragent.html" onMouseOver="classPopup(event,'core_useragent')">core_useragent</a>::DEVICETYPE_MOBILE || <a class="var it1444" onMouseOver="hilite(1444)" onMouseOut="lolite()" onClick="logVariable('devicetype')" href="../../_variables/devicetype.html">$devicetype</a> === <a class="class" onClick="logClass('core_useragent')" href="../../_classes/core_useragent.html" onMouseOver="classPopup(event,'core_useragent')">core_useragent</a>::DEVICETYPE_TABLET ) {
<a name="l1982"><span class="linenum">1982</span></a>          <a class="var it23750" onMouseOver="hilite(23750)" onMouseOut="lolite()" onClick="logVariable('launchcontainer')" href="../../_variables/launchcontainer.html">$launchcontainer</a> = LTI_LAUNCH_CONTAINER_REPLACE_MOODLE_WINDOW;
<a name="l1983"><span class="linenum">1983</span></a>      }
<a name="l1984"><span class="linenum">1984</span></a>  
<a name="l1985"><span class="linenum">1985</span></a>      return <a class="var it23750" onMouseOver="hilite(23750)" onMouseOut="lolite()" onClick="logVariable('launchcontainer')" href="../../_variables/launchcontainer.html">$launchcontainer</a>;
<a name="l1986"><span class="linenum">1986</span></a>  }
<a name="l1987"><span class="linenum">1987</span></a>  
<a name="l1988"><span class="linenum">1988</span></a>  function <a class="function" onClick="logFunction('lti_request_is_using_ssl')" href="../../_functions/lti_request_is_using_ssl.html" onMouseOver="funcPopup(event,'lti_request_is_using_ssl')">lti_request_is_using_ssl</a>() {
<a name="l1989"><span class="linenum">1989</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l1990"><span class="linenum">1990</span></a>      return (<a class="phpfunction" onClick="logFunction('stripos')" href="../../_functions/stripos.html" onMouseOver="phpfuncPopup(event,'stripos')">stripos</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('httpswwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/httpswwwroot.html">httpswwwroot</a>, 'https://') === 0);
<a name="l1991"><span class="linenum">1991</span></a>  }
<a name="l1992"><span class="linenum">1992</span></a>  
<a name="l1993"><span class="linenum">1993</span></a>  function <a class="function" onClick="logFunction('lti_ensure_url_is_https')" href="../../_functions/lti_ensure_url_is_https.html" onMouseOver="funcPopup(event,'lti_ensure_url_is_https')">lti_ensure_url_is_https</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>) {
<a name="l1994"><span class="linenum">1994</span></a>      if (!<a class="phpfunction" onClick="logFunction('strstr')" href="../../_functions/strstr.html" onMouseOver="phpfuncPopup(event,'strstr')">strstr</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>, '://')) {
<a name="l1995"><span class="linenum">1995</span></a>          <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = 'https://' . <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>;
<a name="l1996"><span class="linenum">1996</span></a>      } else {
<a name="l1997"><span class="linenum">1997</span></a>  <span class="comment">        // If the URL starts with http, replace with https.</span>
<a name="l1998"><span class="linenum">1998</span></a>          if (<a class="phpfunction" onClick="logFunction('stripos')" href="../../_functions/stripos.html" onMouseOver="phpfuncPopup(event,'stripos')">stripos</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>, 'http://') === 0) {
<a name="l1999"><span class="linenum">1999</span></a>              <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = 'https://' . <a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>, 7);
<a name="l2000"><span class="linenum">2000</span></a>          }
<a name="l2001"><span class="linenum">2001</span></a>      }
<a name="l2002"><span class="linenum">2002</span></a>  
<a name="l2003"><span class="linenum">2003</span></a>      return <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>;
<a name="l2004"><span class="linenum">2004</span></a>  }
<a name="l2005"><span class="linenum">2005</span></a>  
<a name="l2006"><span class="linenum">2006</span></a>  <span class="comment">/**</span>
<a name="l2007"><span class="linenum">2007</span></a>  <span class="comment"> * Determines if we should try to log the request</span>
<a name="l2008"><span class="linenum">2008</span></a>  <span class="comment"> *</span>
<a name="l2009"><span class="linenum">2009</span></a>  <span class="comment"> * @param string $rawbody</span>
<a name="l2010"><span class="linenum">2010</span></a>  <span class="comment"> * @return bool</span>
<a name="l2011"><span class="linenum">2011</span></a>  <span class="comment"> */</span>
<a name="l2012"><span class="linenum">2012</span></a>  function <a class="function" onClick="logFunction('lti_should_log_request')" href="../../_functions/lti_should_log_request.html" onMouseOver="funcPopup(event,'lti_should_log_request')">lti_should_log_request</a>(<a class="var it27351" onMouseOver="hilite(27351)" onMouseOut="lolite()" onClick="logVariable('rawbody')" href="../../_variables/rawbody.html">$rawbody</a>) {
<a name="l2013"><span class="linenum">2013</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l2014"><span class="linenum">2014</span></a>  
<a name="l2015"><span class="linenum">2015</span></a>      if (empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mod_lti_log_users')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/mod_lti_log_users.html">mod_lti_log_users</a>)) {
<a name="l2016"><span class="linenum">2016</span></a>          return false;
<a name="l2017"><span class="linenum">2017</span></a>      }
<a name="l2018"><span class="linenum">2018</span></a>  
<a name="l2019"><span class="linenum">2019</span></a>      <a class="var it35794" onMouseOver="hilite(35794)" onMouseOut="lolite()" onClick="logVariable('logusers')" href="../../_variables/logusers.html">$logusers</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(',', <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mod_lti_log_users')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/mod_lti_log_users.html">mod_lti_log_users</a>);
<a name="l2020"><span class="linenum">2020</span></a>      if (empty(<a class="var it35794" onMouseOver="hilite(35794)" onMouseOut="lolite()" onClick="logVariable('logusers')" href="../../_variables/logusers.html">$logusers</a>)) {
<a name="l2021"><span class="linenum">2021</span></a>          return false;
<a name="l2022"><span class="linenum">2022</span></a>      }
<a name="l2023"><span class="linenum">2023</span></a>  
<a name="l2024"><span class="linenum">2024</span></a>      try {
<a name="l2025"><span class="linenum">2025</span></a>          <a class="var it1525" onMouseOver="hilite(1525)" onMouseOut="lolite()" onClick="logVariable('xml')" href="../../_variables/xml.html">$xml</a> = new \SimpleXMLElement(<a class="var it27351" onMouseOver="hilite(27351)" onMouseOut="lolite()" onClick="logVariable('rawbody')" href="../../_variables/rawbody.html">$rawbody</a>);
<a name="l2026"><span class="linenum">2026</span></a>          <a class="var it3315" onMouseOver="hilite(3315)" onMouseOut="lolite()" onClick="logVariable('ns')" href="../../_variables/ns.html">$ns</a>  = <a class="var it1525" onMouseOver="hilite(1525)" onMouseOut="lolite()" onClick="logVariable('xml')" href="../../_variables/xml.html">$xml</a>-&gt;<a class="function" onClick="logFunction('getNamespaces')" href="../../_functions/getnamespaces.html" onMouseOver="funcPopup(event,'getnamespaces')">getNamespaces</a>();
<a name="l2027"><span class="linenum">2027</span></a>          <a class="var it3315" onMouseOver="hilite(3315)" onMouseOut="lolite()" onClick="logVariable('ns')" href="../../_variables/ns.html">$ns</a>  = <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it3315" onMouseOver="hilite(3315)" onMouseOut="lolite()" onClick="logVariable('ns')" href="../../_variables/ns.html">$ns</a>);
<a name="l2028"><span class="linenum">2028</span></a>          <a class="var it1525" onMouseOver="hilite(1525)" onMouseOut="lolite()" onClick="logVariable('xml')" href="../../_variables/xml.html">$xml</a>-&gt;<a class="function" onClick="logFunction('registerXPathNamespace')" href="../../_functions/registerxpathnamespace.html" onMouseOver="funcPopup(event,'registerxpathnamespace')">registerXPathNamespace</a>('lti', <a class="var it3315" onMouseOver="hilite(3315)" onMouseOut="lolite()" onClick="logVariable('ns')" href="../../_variables/ns.html">$ns</a>);
<a name="l2029"><span class="linenum">2029</span></a>          <a class="var it35795" onMouseOver="hilite(35795)" onMouseOut="lolite()" onClick="logVariable('requestuserid')" href="../../_variables/requestuserid.html">$requestuserid</a> = '';
<a name="l2030"><span class="linenum">2030</span></a>          if (<a class="var it481" onMouseOver="hilite(481)" onMouseOut="lolite()" onClick="logVariable('node')" href="../../_variables/node.html">$node</a> = <a class="var it1525" onMouseOver="hilite(1525)" onMouseOut="lolite()" onClick="logVariable('xml')" href="../../_variables/xml.html">$xml</a>-&gt;<a class="function" onClick="logFunction('xpath')" href="../../_functions/xpath.html" onMouseOver="funcPopup(event,'xpath')">xpath</a>('//lti:userId')) {
<a name="l2031"><span class="linenum">2031</span></a>              <a class="var it481" onMouseOver="hilite(481)" onMouseOut="lolite()" onClick="logVariable('node')" href="../../_variables/node.html">$node</a> = <a class="var it481" onMouseOver="hilite(481)" onMouseOut="lolite()" onClick="logVariable('node')" href="../../_variables/node.html">$node</a>[0];
<a name="l2032"><span class="linenum">2032</span></a>              <a class="var it35795" onMouseOver="hilite(35795)" onMouseOut="lolite()" onClick="logVariable('requestuserid')" href="../../_variables/requestuserid.html">$requestuserid</a> = <a class="function" onClick="logFunction('clean_param')" href="../../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>((string) <a class="var it481" onMouseOver="hilite(481)" onMouseOut="lolite()" onClick="logVariable('node')" href="../../_variables/node.html">$node</a>, <a class="constant" onClick="logConstant('PARAM_INT')" href="../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>);
<a name="l2033"><span class="linenum">2033</span></a>          } else if (<a class="var it481" onMouseOver="hilite(481)" onMouseOut="lolite()" onClick="logVariable('node')" href="../../_variables/node.html">$node</a> = <a class="var it1525" onMouseOver="hilite(1525)" onMouseOut="lolite()" onClick="logVariable('xml')" href="../../_variables/xml.html">$xml</a>-&gt;<a class="function" onClick="logFunction('xpath')" href="../../_functions/xpath.html" onMouseOver="funcPopup(event,'xpath')">xpath</a>('//lti:sourcedId')) {
<a name="l2034"><span class="linenum">2034</span></a>              <a class="var it481" onMouseOver="hilite(481)" onMouseOut="lolite()" onClick="logVariable('node')" href="../../_variables/node.html">$node</a> = <a class="var it481" onMouseOver="hilite(481)" onMouseOut="lolite()" onClick="logVariable('node')" href="../../_variables/node.html">$node</a>[0];
<a name="l2035"><span class="linenum">2035</span></a>              <a class="var it30839" onMouseOver="hilite(30839)" onMouseOut="lolite()" onClick="logVariable('resultjson')" href="../../_variables/resultjson.html">$resultjson</a> = json_decode((string) <a class="var it481" onMouseOver="hilite(481)" onMouseOut="lolite()" onClick="logVariable('node')" href="../../_variables/node.html">$node</a>);
<a name="l2036"><span class="linenum">2036</span></a>              <a class="var it35795" onMouseOver="hilite(35795)" onMouseOut="lolite()" onClick="logVariable('requestuserid')" href="../../_variables/requestuserid.html">$requestuserid</a> = <a class="function" onClick="logFunction('clean_param')" href="../../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it30839" onMouseOver="hilite(30839)" onMouseOut="lolite()" onClick="logVariable('resultjson')" href="../../_variables/resultjson.html">$resultjson</a>-&gt;<a onClick="logVariable('data')" class="var it45515" onMouseOver="hilite(45515)" onMouseOut="lolite()" href="../../_variables/data.html">data</a>-&gt;userid, <a class="constant" onClick="logConstant('PARAM_INT')" href="../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>);
<a name="l2037"><span class="linenum">2037</span></a>          }
<a name="l2038"><span class="linenum">2038</span></a>      } catch (Exception <a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('e')" href="../../_variables/e.html">$e</a>) {
<a name="l2039"><span class="linenum">2039</span></a>          return false;
<a name="l2040"><span class="linenum">2040</span></a>      }
<a name="l2041"><span class="linenum">2041</span></a>  
<a name="l2042"><span class="linenum">2042</span></a>      if (empty(<a class="var it35795" onMouseOver="hilite(35795)" onMouseOut="lolite()" onClick="logVariable('requestuserid')" href="../../_variables/requestuserid.html">$requestuserid</a>) or !<a class="phpfunction" onClick="logFunction('in_array')" href="../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it35795" onMouseOver="hilite(35795)" onMouseOut="lolite()" onClick="logVariable('requestuserid')" href="../../_variables/requestuserid.html">$requestuserid</a>, <a class="var it35794" onMouseOver="hilite(35794)" onMouseOut="lolite()" onClick="logVariable('logusers')" href="../../_variables/logusers.html">$logusers</a>)) {
<a name="l2043"><span class="linenum">2043</span></a>          return false;
<a name="l2044"><span class="linenum">2044</span></a>      }
<a name="l2045"><span class="linenum">2045</span></a>  
<a name="l2046"><span class="linenum">2046</span></a>      return true;
<a name="l2047"><span class="linenum">2047</span></a>  }
<a name="l2048"><span class="linenum">2048</span></a>  
<a name="l2049"><span class="linenum">2049</span></a>  <span class="comment">/**</span>
<a name="l2050"><span class="linenum">2050</span></a>  <span class="comment"> * Logs the request to a file in temp dir.</span>
<a name="l2051"><span class="linenum">2051</span></a>  <span class="comment"> *</span>
<a name="l2052"><span class="linenum">2052</span></a>  <span class="comment"> * @param string $rawbody</span>
<a name="l2053"><span class="linenum">2053</span></a>  <span class="comment"> */</span>
<a name="l2054"><span class="linenum">2054</span></a>  function <a class="function" onClick="logFunction('lti_log_request')" href="../../_functions/lti_log_request.html" onMouseOver="funcPopup(event,'lti_log_request')">lti_log_request</a>(<a class="var it27351" onMouseOver="hilite(27351)" onMouseOut="lolite()" onClick="logVariable('rawbody')" href="../../_variables/rawbody.html">$rawbody</a>) {
<a name="l2055"><span class="linenum">2055</span></a>      if (<a class="var it242" onMouseOver="hilite(242)" onMouseOut="lolite()" onClick="logVariable('tempdir')" href="../../_variables/tempdir.html">$tempdir</a> = <a class="function" onClick="logFunction('make_temp_directory')" href="../../_functions/make_temp_directory.html" onMouseOver="funcPopup(event,'make_temp_directory')">make_temp_directory</a>('mod_lti', false)) {
<a name="l2056"><span class="linenum">2056</span></a>          if (<a class="var it2559" onMouseOver="hilite(2559)" onMouseOut="lolite()" onClick="logVariable('tempfile')" href="../../_variables/tempfile.html">$tempfile</a> = <a class="phpfunction" onClick="logFunction('tempnam')" href="../../_functions/tempnam.html" onMouseOver="phpfuncPopup(event,'tempnam')">tempnam</a>(<a class="var it242" onMouseOver="hilite(242)" onMouseOut="lolite()" onClick="logVariable('tempdir')" href="../../_variables/tempdir.html">$tempdir</a>, 'mod_lti_request'.<a class="phpfunction" onClick="logFunction('date')" href="../../_functions/date.html" onMouseOver="phpfuncPopup(event,'date')">date</a>('YmdHis'))) {
<a name="l2057"><span class="linenum">2057</span></a>              <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a>  = &quot;Request Headers:\n&quot;;
<a name="l2058"><span class="linenum">2058</span></a>              foreach (moodle\mod\lti\<a class="class" onClick="logClass('OAuthUtil')" href="../../_classes/oauthutil.html" onMouseOver="classPopup(event,'oauthutil')">OAuthUtil</a>::<a class="phpfunction" onClick="logFunction('get_headers')" href="../../_functions/get_headers.html" onMouseOver="phpfuncPopup(event,'get_headers')">get_headers</a>() as <a class="var it907" onMouseOver="hilite(907)" onMouseOut="lolite()" onClick="logVariable('header')" href="../../_variables/header.html">$header</a> =&gt; <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l2059"><span class="linenum">2059</span></a>                  <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a> .= &quot;<a class="var it907" onMouseOver="hilite(907)" onMouseOut="lolite()" onClick="logVariable('header')" href="../../_variables/header.html">$header</a>: <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>\n&quot;;
<a name="l2060"><span class="linenum">2060</span></a>              }
<a name="l2061"><span class="linenum">2061</span></a>              <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a> .= &quot;Request Body:\n&quot;;
<a name="l2062"><span class="linenum">2062</span></a>              <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a> .= <a class="var it27351" onMouseOver="hilite(27351)" onMouseOut="lolite()" onClick="logVariable('rawbody')" href="../../_variables/rawbody.html">$rawbody</a>;
<a name="l2063"><span class="linenum">2063</span></a>  
<a name="l2064"><span class="linenum">2064</span></a>              <a class="phpfunction" onClick="logFunction('file_put_contents')" href="../../_functions/file_put_contents.html" onMouseOver="phpfuncPopup(event,'file_put_contents')">file_put_contents</a>(<a class="var it2559" onMouseOver="hilite(2559)" onMouseOut="lolite()" onClick="logVariable('tempfile')" href="../../_variables/tempfile.html">$tempfile</a>, <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a>);
<a name="l2065"><span class="linenum">2065</span></a>              <a class="phpfunction" onClick="logFunction('chmod')" href="../../_functions/chmod.html" onMouseOver="phpfuncPopup(event,'chmod')">chmod</a>(<a class="var it2559" onMouseOver="hilite(2559)" onMouseOut="lolite()" onClick="logVariable('tempfile')" href="../../_variables/tempfile.html">$tempfile</a>, 0644);
<a name="l2066"><span class="linenum">2066</span></a>          }
<a name="l2067"><span class="linenum">2067</span></a>      }
<a name="l2068"><span class="linenum">2068</span></a>  }
<a name="l2069"><span class="linenum">2069</span></a>  
<a name="l2070"><span class="linenum">2070</span></a>  <span class="comment">/**</span>
<a name="l2071"><span class="linenum">2071</span></a>  <span class="comment"> * Log an LTI response.</span>
<a name="l2072"><span class="linenum">2072</span></a>  <span class="comment"> *</span>
<a name="l2073"><span class="linenum">2073</span></a>  <span class="comment"> * @param string $responsexml The response XML</span>
<a name="l2074"><span class="linenum">2074</span></a>  <span class="comment"> * @param Exception $e If there was an exception, pass that too</span>
<a name="l2075"><span class="linenum">2075</span></a>  <span class="comment"> */</span>
<a name="l2076"><span class="linenum">2076</span></a>  function <a class="function" onClick="logFunction('lti_log_response')" href="../../_functions/lti_log_response.html" onMouseOver="funcPopup(event,'lti_log_response')">lti_log_response</a>(<a class="var it27360" onMouseOver="hilite(27360)" onMouseOut="lolite()" onClick="logVariable('responsexml')" href="../../_variables/responsexml.html">$responsexml</a>, <a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('e')" href="../../_variables/e.html">$e</a> = null) {
<a name="l2077"><span class="linenum">2077</span></a>      if (<a class="var it242" onMouseOver="hilite(242)" onMouseOut="lolite()" onClick="logVariable('tempdir')" href="../../_variables/tempdir.html">$tempdir</a> = <a class="function" onClick="logFunction('make_temp_directory')" href="../../_functions/make_temp_directory.html" onMouseOver="funcPopup(event,'make_temp_directory')">make_temp_directory</a>('mod_lti', false)) {
<a name="l2078"><span class="linenum">2078</span></a>          if (<a class="var it2559" onMouseOver="hilite(2559)" onMouseOut="lolite()" onClick="logVariable('tempfile')" href="../../_variables/tempfile.html">$tempfile</a> = <a class="phpfunction" onClick="logFunction('tempnam')" href="../../_functions/tempnam.html" onMouseOver="phpfuncPopup(event,'tempnam')">tempnam</a>(<a class="var it242" onMouseOver="hilite(242)" onMouseOut="lolite()" onClick="logVariable('tempdir')" href="../../_variables/tempdir.html">$tempdir</a>, 'mod_lti_response'.<a class="phpfunction" onClick="logFunction('date')" href="../../_functions/date.html" onMouseOver="phpfuncPopup(event,'date')">date</a>('YmdHis'))) {
<a name="l2079"><span class="linenum">2079</span></a>              <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a> = '';
<a name="l2080"><span class="linenum">2080</span></a>              if (<a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('e')" href="../../_variables/e.html">$e</a> instanceof Exception) {
<a name="l2081"><span class="linenum">2081</span></a>                  <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a> = <a class="function" onClick="logFunction('get_exception_info')" href="../../_functions/get_exception_info.html" onMouseOver="funcPopup(event,'get_exception_info')">get_exception_info</a>(<a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('e')" href="../../_variables/e.html">$e</a>);
<a name="l2082"><span class="linenum">2082</span></a>  
<a name="l2083"><span class="linenum">2083</span></a>                  <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a> .= &quot;Exception:\n&quot;;
<a name="l2084"><span class="linenum">2084</span></a>                  <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a> .= &quot;Message: <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>-&gt;<a onClick="logVariable('message')" class="var it42982" onMouseOver="hilite(42982)" onMouseOut="lolite()" href="../../_variables/message.html">message</a>\n&quot;;
<a name="l2085"><span class="linenum">2085</span></a>                  <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a> .= &quot;Debug info: <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>-&gt;<a onClick="logVariable('debuginfo')" class="var it42982" onMouseOver="hilite(42982)" onMouseOut="lolite()" href="../../_variables/debuginfo.html">debuginfo</a>\n&quot;;
<a name="l2086"><span class="linenum">2086</span></a>                  <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a> .= &quot;Backtrace:\n&quot;;
<a name="l2087"><span class="linenum">2087</span></a>                  <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a> .= <a class="function" onClick="logFunction('format_backtrace')" href="../../_functions/format_backtrace.html" onMouseOver="funcPopup(event,'format_backtrace')">format_backtrace</a>(<a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>-&gt;<a onClick="logVariable('backtrace')" class="var it42982" onMouseOver="hilite(42982)" onMouseOut="lolite()" href="../../_variables/backtrace.html">backtrace</a>, true);
<a name="l2088"><span class="linenum">2088</span></a>                  <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a> .= &quot;\n&quot;;
<a name="l2089"><span class="linenum">2089</span></a>              }
<a name="l2090"><span class="linenum">2090</span></a>              <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a> .= &quot;Response XML:\n&quot;;
<a name="l2091"><span class="linenum">2091</span></a>              <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a> .= <a class="var it27360" onMouseOver="hilite(27360)" onMouseOut="lolite()" onClick="logVariable('responsexml')" href="../../_variables/responsexml.html">$responsexml</a>;
<a name="l2092"><span class="linenum">2092</span></a>  
<a name="l2093"><span class="linenum">2093</span></a>              <a class="phpfunction" onClick="logFunction('file_put_contents')" href="../../_functions/file_put_contents.html" onMouseOver="phpfuncPopup(event,'file_put_contents')">file_put_contents</a>(<a class="var it2559" onMouseOver="hilite(2559)" onMouseOut="lolite()" onClick="logVariable('tempfile')" href="../../_variables/tempfile.html">$tempfile</a>, <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a>);
<a name="l2094"><span class="linenum">2094</span></a>              <a class="phpfunction" onClick="logFunction('chmod')" href="../../_functions/chmod.html" onMouseOver="phpfuncPopup(event,'chmod')">chmod</a>(<a class="var it2559" onMouseOver="hilite(2559)" onMouseOut="lolite()" onClick="logVariable('tempfile')" href="../../_variables/tempfile.html">$tempfile</a>, 0644);
<a name="l2095"><span class="linenum">2095</span></a>          }
<a name="l2096"><span class="linenum">2096</span></a>      }
<a name="l2097"><span class="linenum">2097</span></a>  }
<a name="l2098"><span class="linenum">2098</span></a>  
<a name="l2099"><span class="linenum">2099</span></a>  <span class="comment">/**</span>
<a name="l2100"><span class="linenum">2100</span></a>  <span class="comment"> * Fetches LTI type configuration for an LTI instance</span>
<a name="l2101"><span class="linenum">2101</span></a>  <span class="comment"> *</span>
<a name="l2102"><span class="linenum">2102</span></a>  <span class="comment"> * @param stdClass $instance</span>
<a name="l2103"><span class="linenum">2103</span></a>  <span class="comment"> * @return array Can be empty if no type is found</span>
<a name="l2104"><span class="linenum">2104</span></a>  <span class="comment"> */</span>
<a name="l2105"><span class="linenum">2105</span></a>  function <a class="function" onClick="logFunction('lti_get_type_config_by_instance')" href="../../_functions/lti_get_type_config_by_instance.html" onMouseOver="funcPopup(event,'lti_get_type_config_by_instance')">lti_get_type_config_by_instance</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>) {
<a name="l2106"><span class="linenum">2106</span></a>      <a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a> = null;
<a name="l2107"><span class="linenum">2107</span></a>      if (empty(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('typeid')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/typeid.html">typeid</a>)) {
<a name="l2108"><span class="linenum">2108</span></a>          <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a> = <a class="function" onClick="logFunction('lti_get_tool_by_url_match')" href="../../_functions/lti_get_tool_by_url_match.html" onMouseOver="funcPopup(event,'lti_get_tool_by_url_match')">lti_get_tool_by_url_match</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('toolurl')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/toolurl.html">toolurl</a>, <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('course')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>);
<a name="l2109"><span class="linenum">2109</span></a>          if (<a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>) {
<a name="l2110"><span class="linenum">2110</span></a>              <a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a> = <a class="var it3113" onMouseOver="hilite(3113)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a>-&gt;<a onClick="logVariable('id')" class="var it43021" onMouseOver="hilite(43021)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l2111"><span class="linenum">2111</span></a>          }
<a name="l2112"><span class="linenum">2112</span></a>      } else {
<a name="l2113"><span class="linenum">2113</span></a>          <a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a> = <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a onClick="logVariable('typeid')" class="var it43004" onMouseOver="hilite(43004)" onMouseOut="lolite()" href="../../_variables/typeid.html">typeid</a>;
<a name="l2114"><span class="linenum">2114</span></a>      }
<a name="l2115"><span class="linenum">2115</span></a>      if (!empty(<a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a>)) {
<a name="l2116"><span class="linenum">2116</span></a>          return <a class="function" onClick="logFunction('lti_get_type_config')" href="../../_functions/lti_get_type_config.html" onMouseOver="funcPopup(event,'lti_get_type_config')">lti_get_type_config</a>(<a class="var it430" onMouseOver="hilite(430)" onMouseOut="lolite()" onClick="logVariable('typeid')" href="../../_variables/typeid.html">$typeid</a>);
<a name="l2117"><span class="linenum">2117</span></a>      }
<a name="l2118"><span class="linenum">2118</span></a>      return array();
<a name="l2119"><span class="linenum">2119</span></a>  }
<a name="l2120"><span class="linenum">2120</span></a>  
<a name="l2121"><span class="linenum">2121</span></a>  <span class="comment">/**</span>
<a name="l2122"><span class="linenum">2122</span></a>  <span class="comment"> * Enforce type config settings onto the LTI instance</span>
<a name="l2123"><span class="linenum">2123</span></a>  <span class="comment"> *</span>
<a name="l2124"><span class="linenum">2124</span></a>  <span class="comment"> * @param stdClass $instance</span>
<a name="l2125"><span class="linenum">2125</span></a>  <span class="comment"> * @param array $typeconfig</span>
<a name="l2126"><span class="linenum">2126</span></a>  <span class="comment"> */</span>
<a name="l2127"><span class="linenum">2127</span></a>  function <a class="function" onClick="logFunction('lti_force_type_config_settings')" href="../../_functions/lti_force_type_config_settings.html" onMouseOver="funcPopup(event,'lti_force_type_config_settings')">lti_force_type_config_settings</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>, array <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>) {
<a name="l2128"><span class="linenum">2128</span></a>      <a class="var it6487" onMouseOver="hilite(6487)" onMouseOut="lolite()" onClick="logVariable('forced')" href="../../_variables/forced.html">$forced</a> = array(
<a name="l2129"><span class="linenum">2129</span></a>          'instructorchoicesendname'      =&gt; 'sendname',
<a name="l2130"><span class="linenum">2130</span></a>          'instructorchoicesendemailaddr' =&gt; 'sendemailaddr',
<a name="l2131"><span class="linenum">2131</span></a>          'instructorchoiceacceptgrades'  =&gt; 'acceptgrades',
<a name="l2132"><span class="linenum">2132</span></a>      );
<a name="l2133"><span class="linenum">2133</span></a>  
<a name="l2134"><span class="linenum">2134</span></a>      foreach (<a class="var it6487" onMouseOver="hilite(6487)" onMouseOut="lolite()" onClick="logVariable('forced')" href="../../_variables/forced.html">$forced</a> as <a class="var it35796" onMouseOver="hilite(35796)" onMouseOut="lolite()" onClick="logVariable('instanceparam')" href="../../_variables/instanceparam.html">$instanceparam</a> =&gt; <a class="var it35797" onMouseOver="hilite(35797)" onMouseOut="lolite()" onClick="logVariable('typeconfigparam')" href="../../_variables/typeconfigparam.html">$typeconfigparam</a>) {
<a name="l2135"><span class="linenum">2135</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it35797" onMouseOver="hilite(35797)" onMouseOut="lolite()" onClick="logVariable('typeconfigparam')" href="../../_variables/typeconfigparam.html">$typeconfigparam</a>, <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>) &amp;&amp; <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>[<a class="var it35797" onMouseOver="hilite(35797)" onMouseOut="lolite()" onClick="logVariable('typeconfigparam')" href="../../_variables/typeconfigparam.html">$typeconfigparam</a>] != <a class="constant" onClick="logConstant('LTI_SETTING_DELEGATE')" href="../../_constants/LTI_SETTING_DELEGATE.html" onMouseOver="constPopup(event,'LTI_SETTING_DELEGATE')">LTI_SETTING_DELEGATE</a>) {
<a name="l2136"><span class="linenum">2136</span></a>              <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>-&gt;<a class="var it35796" onMouseOver="hilite(35796)" onMouseOut="lolite()" onClick="logVariable('instanceparam')" href="../../_variables/instanceparam.html">$instanceparam</a> = <a class="var it30842" onMouseOver="hilite(30842)" onMouseOut="lolite()" onClick="logVariable('typeconfig')" href="../../_variables/typeconfig.html">$typeconfig</a>[<a class="var it35797" onMouseOver="hilite(35797)" onMouseOut="lolite()" onClick="logVariable('typeconfigparam')" href="../../_variables/typeconfigparam.html">$typeconfigparam</a>];
<a name="l2137"><span class="linenum">2137</span></a>          }
<a name="l2138"><span class="linenum">2138</span></a>      }
<a name="l2139"><span class="linenum">2139</span></a>  }
<a name="l2140"><span class="linenum">2140</span></a>  
<a name="l2141"><span class="linenum">2141</span></a>  <span class="comment">/**</span>
<a name="l2142"><span class="linenum">2142</span></a>  <span class="comment"> * Initializes an array with the capabilities supported by the LTI module</span>
<a name="l2143"><span class="linenum">2143</span></a>  <span class="comment"> *</span>
<a name="l2144"><span class="linenum">2144</span></a>  <span class="comment"> * @return array List of capability names (without a dollar sign prefix)</span>
<a name="l2145"><span class="linenum">2145</span></a>  <span class="comment"> */</span>
<a name="l2146"><span class="linenum">2146</span></a>  function <a class="function" onClick="logFunction('lti_get_capabilities')" href="../../_functions/lti_get_capabilities.html" onMouseOver="funcPopup(event,'lti_get_capabilities')">lti_get_capabilities</a>() {
<a name="l2147"><span class="linenum">2147</span></a>  
<a name="l2148"><span class="linenum">2148</span></a>      <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('capabilities')" href="../../_variables/capabilities.html">$capabilities</a> = array(
<a name="l2149"><span class="linenum">2149</span></a>         'basic-lti-launch-request' =&gt; '',
<a name="l2150"><span class="linenum">2150</span></a>         'Context.id' =&gt; 'context_id',
<a name="l2151"><span class="linenum">2151</span></a>         'CourseSection.title' =&gt; 'context_title',
<a name="l2152"><span class="linenum">2152</span></a>         'CourseSection.label' =&gt; 'context_label',
<a name="l2153"><span class="linenum">2153</span></a>         'CourseSection.sourcedId' =&gt; 'lis_course_section_sourcedid',
<a name="l2154"><span class="linenum">2154</span></a>         'CourseSection.longDescription' =&gt; '<a class="var it586" onMouseOver="hilite(586)" onMouseOut="lolite()" onClick="logVariable('COURSE')" href="../../_variables/COURSE.html">$COURSE</a>-&gt;<a onClick="logVariable('summary')" class="var it43316" onMouseOver="hilite(43316)" onMouseOut="lolite()" href="../../_variables/summary.html">summary</a>',
<a name="l2155"><span class="linenum">2155</span></a>         'CourseSection.timeFrame.begin' =&gt; '<a class="var it586" onMouseOver="hilite(586)" onMouseOut="lolite()" onClick="logVariable('COURSE')" href="../../_variables/COURSE.html">$COURSE</a>-&gt;<a onClick="logVariable('startdate')" class="var it43316" onMouseOver="hilite(43316)" onMouseOut="lolite()" href="../../_variables/startdate.html">startdate</a>',
<a name="l2156"><span class="linenum">2156</span></a>         'ResourceLink.id' =&gt; 'resource_link_id',
<a name="l2157"><span class="linenum">2157</span></a>         'ResourceLink.title' =&gt; 'resource_link_title',
<a name="l2158"><span class="linenum">2158</span></a>         'ResourceLink.description' =&gt; 'resource_link_description',
<a name="l2159"><span class="linenum">2159</span></a>         'User.id' =&gt; 'user_id',
<a name="l2160"><span class="linenum">2160</span></a>         'User.username' =&gt; '<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('username')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>',
<a name="l2161"><span class="linenum">2161</span></a>         'Person.name.full' =&gt; 'lis_person_name_full',
<a name="l2162"><span class="linenum">2162</span></a>         'Person.name.given' =&gt; 'lis_person_name_given',
<a name="l2163"><span class="linenum">2163</span></a>         'Person.name.family' =&gt; 'lis_person_name_family',
<a name="l2164"><span class="linenum">2164</span></a>         'Person.email.primary' =&gt; 'lis_person_contact_email_primary',
<a name="l2165"><span class="linenum">2165</span></a>         'Person.sourcedId' =&gt; 'lis_person_sourcedid',
<a name="l2166"><span class="linenum">2166</span></a>         'Person.name.middle' =&gt; '<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('middlename')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/middlename.html">middlename</a>',
<a name="l2167"><span class="linenum">2167</span></a>         'Person.address.street1' =&gt; '<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('address')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/address.html">address</a>',
<a name="l2168"><span class="linenum">2168</span></a>         'Person.address.locality' =&gt; '<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('city')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/city.html">city</a>',
<a name="l2169"><span class="linenum">2169</span></a>         'Person.address.country' =&gt; '<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('country')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/country.html">country</a>',
<a name="l2170"><span class="linenum">2170</span></a>         'Person.address.timezone' =&gt; '<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('timezone')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/timezone.html">timezone</a>',
<a name="l2171"><span class="linenum">2171</span></a>         'Person.phone.primary' =&gt; '<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('phone1')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/phone1.html">phone1</a>',
<a name="l2172"><span class="linenum">2172</span></a>         'Person.phone.mobile' =&gt; '<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('phone2')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/phone2.html">phone2</a>',
<a name="l2173"><span class="linenum">2173</span></a>         'Person.webaddress' =&gt; '<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('url')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/url.html">url</a>',
<a name="l2174"><span class="linenum">2174</span></a>         'Membership.role' =&gt; 'roles',
<a name="l2175"><span class="linenum">2175</span></a>         'Result.sourcedId' =&gt; 'lis_result_sourcedid',
<a name="l2176"><span class="linenum">2176</span></a>         'Result.autocreate' =&gt; 'lis_outcome_service_url');
<a name="l2177"><span class="linenum">2177</span></a>  
<a name="l2178"><span class="linenum">2178</span></a>      return <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('capabilities')" href="../../_variables/capabilities.html">$capabilities</a>;
<a name="l2179"><span class="linenum">2179</span></a>  
<a name="l2180"><span class="linenum">2180</span></a>  }
<a name="l2181"><span class="linenum">2181</span></a>  
<a name="l2182"><span class="linenum">2182</span></a>  <span class="comment">/**</span>
<a name="l2183"><span class="linenum">2183</span></a>  <span class="comment"> * Initializes an array with the services supported by the LTI module</span>
<a name="l2184"><span class="linenum">2184</span></a>  <span class="comment"> *</span>
<a name="l2185"><span class="linenum">2185</span></a>  <span class="comment"> * @return array List of services</span>
<a name="l2186"><span class="linenum">2186</span></a>  <span class="comment"> */</span>
<a name="l2187"><span class="linenum">2187</span></a>  function <a class="function" onClick="logFunction('lti_get_services')" href="../../_functions/lti_get_services.html" onMouseOver="funcPopup(event,'lti_get_services')">lti_get_services</a>() {
<a name="l2188"><span class="linenum">2188</span></a>  
<a name="l2189"><span class="linenum">2189</span></a>      <a class="var it4429" onMouseOver="hilite(4429)" onMouseOut="lolite()" onClick="logVariable('services')" href="../../_variables/services.html">$services</a> = array();
<a name="l2190"><span class="linenum">2190</span></a>      <a class="var it35798" onMouseOver="hilite(35798)" onMouseOut="lolite()" onClick="logVariable('definedservices')" href="../../_variables/definedservices.html">$definedservices</a> = <a class="class" onClick="logClass('core_component')" href="../../_classes/core_component.html" onMouseOver="classPopup(event,'core_component')">core_component</a>::<a class="function" onClick="logFunction('get_plugin_list')" href="../../_functions/get_plugin_list.html" onMouseOver="funcPopup(event,'get_plugin_list')">get_plugin_list</a>('ltiservice');
<a name="l2191"><span class="linenum">2191</span></a>      foreach (<a class="var it35798" onMouseOver="hilite(35798)" onMouseOut="lolite()" onClick="logVariable('definedservices')" href="../../_variables/definedservices.html">$definedservices</a> as <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a> =&gt; <a class="var it3200" onMouseOver="hilite(3200)" onMouseOut="lolite()" onClick="logVariable('location')" href="../../_variables/location.html">$location</a>) {
<a name="l2192"><span class="linenum">2192</span></a>          <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../_variables/classname.html">$classname</a> = &quot;\\ltiservice_{<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>}\\local\\service\\{<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>}&quot;;
<a name="l2193"><span class="linenum">2193</span></a>          <a class="var it4429" onMouseOver="hilite(4429)" onMouseOut="lolite()" onClick="logVariable('services')" href="../../_variables/services.html">$services</a>[] = new <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../_variables/classname.html">$classname</a>();
<a name="l2194"><span class="linenum">2194</span></a>      }
<a name="l2195"><span class="linenum">2195</span></a>  
<a name="l2196"><span class="linenum">2196</span></a>      return <a class="var it4429" onMouseOver="hilite(4429)" onMouseOut="lolite()" onClick="logVariable('services')" href="../../_variables/services.html">$services</a>;
<a name="l2197"><span class="linenum">2197</span></a>  
<a name="l2198"><span class="linenum">2198</span></a>  }
<a name="l2199"><span class="linenum">2199</span></a>  
<a name="l2200"><span class="linenum">2200</span></a>  <span class="comment">/**</span>
<a name="l2201"><span class="linenum">2201</span></a>  <span class="comment"> * Initializes an instance of the named service</span>
<a name="l2202"><span class="linenum">2202</span></a>  <span class="comment"> *</span>
<a name="l2203"><span class="linenum">2203</span></a>  <span class="comment"> * @param string $servicename Name of service</span>
<a name="l2204"><span class="linenum">2204</span></a>  <span class="comment"> *</span>
<a name="l2205"><span class="linenum">2205</span></a>  <span class="comment"> * @return mod_lti\local\ltiservice\service_base Service</span>
<a name="l2206"><span class="linenum">2206</span></a>  <span class="comment"> */</span>
<a name="l2207"><span class="linenum">2207</span></a>  function <a class="function" onClick="logFunction('lti_get_service_by_name')" href="../../_functions/lti_get_service_by_name.html" onMouseOver="funcPopup(event,'lti_get_service_by_name')">lti_get_service_by_name</a>(<a class="var it19256" onMouseOver="hilite(19256)" onMouseOut="lolite()" onClick="logVariable('servicename')" href="../../_variables/servicename.html">$servicename</a>) {
<a name="l2208"><span class="linenum">2208</span></a>  
<a name="l2209"><span class="linenum">2209</span></a>      <a class="var it898" onMouseOver="hilite(898)" onMouseOut="lolite()" onClick="logVariable('service')" href="../../_variables/service.html">$service</a> = false;
<a name="l2210"><span class="linenum">2210</span></a>      <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../_variables/classname.html">$classname</a> = &quot;\\ltiservice_{<a class="var it19256" onMouseOver="hilite(19256)" onMouseOut="lolite()" onClick="logVariable('servicename')" href="../../_variables/servicename.html">$servicename</a>}\\local\\service\\{<a class="var it19256" onMouseOver="hilite(19256)" onMouseOut="lolite()" onClick="logVariable('servicename')" href="../../_variables/servicename.html">$servicename</a>}&quot;;
<a name="l2211"><span class="linenum">2211</span></a>      if (<a class="phpfunction" onClick="logFunction('class_exists')" href="../../_functions/class_exists.html" onMouseOver="phpfuncPopup(event,'class_exists')">class_exists</a>(<a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../_variables/classname.html">$classname</a>)) {
<a name="l2212"><span class="linenum">2212</span></a>          <a class="var it898" onMouseOver="hilite(898)" onMouseOut="lolite()" onClick="logVariable('service')" href="../../_variables/service.html">$service</a> = new <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('classname')" href="../../_variables/classname.html">$classname</a>();
<a name="l2213"><span class="linenum">2213</span></a>      }
<a name="l2214"><span class="linenum">2214</span></a>  
<a name="l2215"><span class="linenum">2215</span></a>      return <a class="var it898" onMouseOver="hilite(898)" onMouseOut="lolite()" onClick="logVariable('service')" href="../../_variables/service.html">$service</a>;
<a name="l2216"><span class="linenum">2216</span></a>  
<a name="l2217"><span class="linenum">2217</span></a>  }
<a name="l2218"><span class="linenum">2218</span></a>  
<a name="l2219"><span class="linenum">2219</span></a>  <span class="comment">/**</span>
<a name="l2220"><span class="linenum">2220</span></a>  <span class="comment"> * Finds a service by id</span>
<a name="l2221"><span class="linenum">2221</span></a>  <span class="comment"> *</span>
<a name="l2222"><span class="linenum">2222</span></a>  <span class="comment"> * @param array  $services    Array of services</span>
<a name="l2223"><span class="linenum">2223</span></a>  <span class="comment"> * @param string $resourceid  ID of resource</span>
<a name="l2224"><span class="linenum">2224</span></a>  <span class="comment"> *</span>
<a name="l2225"><span class="linenum">2225</span></a>  <span class="comment"> * @return mod_lti\local\ltiservice\service_base Service</span>
<a name="l2226"><span class="linenum">2226</span></a>  <span class="comment"> */</span>
<a name="l2227"><span class="linenum">2227</span></a>  function <a class="function" onClick="logFunction('lti_get_service_by_resource_id')" href="../../_functions/lti_get_service_by_resource_id.html" onMouseOver="funcPopup(event,'lti_get_service_by_resource_id')">lti_get_service_by_resource_id</a>(<a class="var it4429" onMouseOver="hilite(4429)" onMouseOut="lolite()" onClick="logVariable('services')" href="../../_variables/services.html">$services</a>, <a class="var it8427" onMouseOver="hilite(8427)" onMouseOut="lolite()" onClick="logVariable('resourceid')" href="../../_variables/resourceid.html">$resourceid</a>) {
<a name="l2228"><span class="linenum">2228</span></a>  
<a name="l2229"><span class="linenum">2229</span></a>      <a class="var it898" onMouseOver="hilite(898)" onMouseOut="lolite()" onClick="logVariable('service')" href="../../_variables/service.html">$service</a> = false;
<a name="l2230"><span class="linenum">2230</span></a>      foreach (<a class="var it4429" onMouseOver="hilite(4429)" onMouseOut="lolite()" onClick="logVariable('services')" href="../../_variables/services.html">$services</a> as <a class="var it27624" onMouseOver="hilite(27624)" onMouseOut="lolite()" onClick="logVariable('aservice')" href="../../_variables/aservice.html">$aservice</a>) {
<a name="l2231"><span class="linenum">2231</span></a>          foreach (<a class="var it27624" onMouseOver="hilite(27624)" onMouseOut="lolite()" onClick="logVariable('aservice')" href="../../_variables/aservice.html">$aservice</a>-&gt;<a class="function" onClick="logFunction('get_resources')" href="../../_functions/get_resources.html" onMouseOver="funcPopup(event,'get_resources')">get_resources</a>() as <a class="var it1775" onMouseOver="hilite(1775)" onMouseOut="lolite()" onClick="logVariable('resource')" href="../../_variables/resource.html">$resource</a>) {
<a name="l2232"><span class="linenum">2232</span></a>              if (<a class="var it1775" onMouseOver="hilite(1775)" onMouseOut="lolite()" onClick="logVariable('resource')" href="../../_variables/resource.html">$resource</a>-&gt;<a class="function" onClick="logFunction('get_id')" href="../../_functions/get_id.html" onMouseOver="funcPopup(event,'get_id')">get_id</a>() === <a class="var it8427" onMouseOver="hilite(8427)" onMouseOut="lolite()" onClick="logVariable('resourceid')" href="../../_variables/resourceid.html">$resourceid</a>) {
<a name="l2233"><span class="linenum">2233</span></a>                  <a class="var it898" onMouseOver="hilite(898)" onMouseOut="lolite()" onClick="logVariable('service')" href="../../_variables/service.html">$service</a> = <a class="var it27624" onMouseOver="hilite(27624)" onMouseOut="lolite()" onClick="logVariable('aservice')" href="../../_variables/aservice.html">$aservice</a>;
<a name="l2234"><span class="linenum">2234</span></a>                  break 2;
<a name="l2235"><span class="linenum">2235</span></a>              }
<a name="l2236"><span class="linenum">2236</span></a>          }
<a name="l2237"><span class="linenum">2237</span></a>      }
<a name="l2238"><span class="linenum">2238</span></a>  
<a name="l2239"><span class="linenum">2239</span></a>      return <a class="var it898" onMouseOver="hilite(898)" onMouseOut="lolite()" onClick="logVariable('service')" href="../../_variables/service.html">$service</a>;
<a name="l2240"><span class="linenum">2240</span></a>  
<a name="l2241"><span class="linenum">2241</span></a>  }
<a name="l2242"><span class="linenum">2242</span></a>  
<a name="l2243"><span class="linenum">2243</span></a>  <span class="comment">/**</span>
<a name="l2244"><span class="linenum">2244</span></a>  <span class="comment"> * Extracts the named contexts from a tool proxy</span>
<a name="l2245"><span class="linenum">2245</span></a>  <span class="comment"> *</span>
<a name="l2246"><span class="linenum">2246</span></a>  <span class="comment"> * @param object $json</span>
<a name="l2247"><span class="linenum">2247</span></a>  <span class="comment"> *</span>
<a name="l2248"><span class="linenum">2248</span></a>  <span class="comment"> * @return array Contexts</span>
<a name="l2249"><span class="linenum">2249</span></a>  <span class="comment"> */</span>
<a name="l2250"><span class="linenum">2250</span></a>  function <a class="function" onClick="logFunction('lti_get_contexts')" href="../../_functions/lti_get_contexts.html" onMouseOver="funcPopup(event,'lti_get_contexts')">lti_get_contexts</a>(<a class="var it2497" onMouseOver="hilite(2497)" onMouseOut="lolite()" onClick="logVariable('json')" href="../../_variables/json.html">$json</a>) {
<a name="l2251"><span class="linenum">2251</span></a>  
<a name="l2252"><span class="linenum">2252</span></a>      <a class="var it2537" onMouseOver="hilite(2537)" onMouseOut="lolite()" onClick="logVariable('contexts')" href="../../_variables/contexts.html">$contexts</a> = array();
<a name="l2253"><span class="linenum">2253</span></a>      if (isset(<a class="var it2497" onMouseOver="hilite(2497)" onMouseOut="lolite()" onClick="logVariable('json')" href="../../_variables/json.html">$json</a>-&gt;{'@context'})) {
<a name="l2254"><span class="linenum">2254</span></a>          foreach (<a class="var it2497" onMouseOver="hilite(2497)" onMouseOut="lolite()" onClick="logVariable('json')" href="../../_variables/json.html">$json</a>-&gt;{'@context'} as <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>) {
<a name="l2255"><span class="linenum">2255</span></a>              if (<a class="phpfunction" onClick="logFunction('is_object')" href="../../_functions/is_object.html" onMouseOver="phpfuncPopup(event,'is_object')">is_object</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>)) {
<a name="l2256"><span class="linenum">2256</span></a>                  <a class="var it2537" onMouseOver="hilite(2537)" onMouseOut="lolite()" onClick="logVariable('contexts')" href="../../_variables/contexts.html">$contexts</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="phpfunction" onClick="logFunction('get_object_vars')" href="../../_functions/get_object_vars.html" onMouseOver="phpfuncPopup(event,'get_object_vars')">get_object_vars</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>), <a class="var it2537" onMouseOver="hilite(2537)" onMouseOut="lolite()" onClick="logVariable('contexts')" href="../../_variables/contexts.html">$contexts</a>);
<a name="l2257"><span class="linenum">2257</span></a>              }
<a name="l2258"><span class="linenum">2258</span></a>          }
<a name="l2259"><span class="linenum">2259</span></a>      }
<a name="l2260"><span class="linenum">2260</span></a>  
<a name="l2261"><span class="linenum">2261</span></a>      return <a class="var it2537" onMouseOver="hilite(2537)" onMouseOut="lolite()" onClick="logVariable('contexts')" href="../../_variables/contexts.html">$contexts</a>;
<a name="l2262"><span class="linenum">2262</span></a>  
<a name="l2263"><span class="linenum">2263</span></a>  }
<a name="l2264"><span class="linenum">2264</span></a>  
<a name="l2265"><span class="linenum">2265</span></a>  <span class="comment">/**</span>
<a name="l2266"><span class="linenum">2266</span></a>  <span class="comment"> * Converts an ID to a fully-qualified ID</span>
<a name="l2267"><span class="linenum">2267</span></a>  <span class="comment"> *</span>
<a name="l2268"><span class="linenum">2268</span></a>  <span class="comment"> * @param array $contexts</span>
<a name="l2269"><span class="linenum">2269</span></a>  <span class="comment"> * @param string $id</span>
<a name="l2270"><span class="linenum">2270</span></a>  <span class="comment"> *</span>
<a name="l2271"><span class="linenum">2271</span></a>  <span class="comment"> * @return string Fully-qualified ID</span>
<a name="l2272"><span class="linenum">2272</span></a>  <span class="comment"> */</span>
<a name="l2273"><span class="linenum">2273</span></a>  function <a class="function" onClick="logFunction('lti_get_fqid')" href="../../_functions/lti_get_fqid.html" onMouseOver="funcPopup(event,'lti_get_fqid')">lti_get_fqid</a>(<a class="var it2537" onMouseOver="hilite(2537)" onMouseOut="lolite()" onClick="logVariable('contexts')" href="../../_variables/contexts.html">$contexts</a>, <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>) {
<a name="l2274"><span class="linenum">2274</span></a>  
<a name="l2275"><span class="linenum">2275</span></a>      <a class="var it1412" onMouseOver="hilite(1412)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(':', <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>, 2);
<a name="l2276"><span class="linenum">2276</span></a>      if (<a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it1412" onMouseOver="hilite(1412)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>) &gt; 1) {
<a name="l2277"><span class="linenum">2277</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it1412" onMouseOver="hilite(1412)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>[0], <a class="var it2537" onMouseOver="hilite(2537)" onMouseOut="lolite()" onClick="logVariable('contexts')" href="../../_variables/contexts.html">$contexts</a>)) {
<a name="l2278"><span class="linenum">2278</span></a>              <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> = <a class="var it2537" onMouseOver="hilite(2537)" onMouseOut="lolite()" onClick="logVariable('contexts')" href="../../_variables/contexts.html">$contexts</a>[<a class="var it1412" onMouseOver="hilite(1412)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>[0]] . <a class="var it1412" onMouseOver="hilite(1412)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>[1];
<a name="l2279"><span class="linenum">2279</span></a>          }
<a name="l2280"><span class="linenum">2280</span></a>      }
<a name="l2281"><span class="linenum">2281</span></a>  
<a name="l2282"><span class="linenum">2282</span></a>      return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>;
<a name="l2283"><span class="linenum">2283</span></a>  
<a name="l2284"><span class="linenum">2284</span></a>  }
<a name="l2285"><span class="linenum">2285</span></a>  
<a name="l2286"><span class="linenum">2286</span></a>  <span class="comment">/**</span>
<a name="l2287"><span class="linenum">2287</span></a>  <span class="comment"> * Returns the icon for the given tool type</span>
<a name="l2288"><span class="linenum">2288</span></a>  <span class="comment"> *</span>
<a name="l2289"><span class="linenum">2289</span></a>  <span class="comment"> * @param stdClass $type The tool type</span>
<a name="l2290"><span class="linenum">2290</span></a>  <span class="comment"> *</span>
<a name="l2291"><span class="linenum">2291</span></a>  <span class="comment"> * @return string The url to the tool type's corresponding icon</span>
<a name="l2292"><span class="linenum">2292</span></a>  <span class="comment"> */</span>
<a name="l2293"><span class="linenum">2293</span></a>  function <a class="function" onClick="logFunction('get_tool_type_icon_url')" href="../../_functions/get_tool_type_icon_url.html" onMouseOver="funcPopup(event,'get_tool_type_icon_url')">get_tool_type_icon_url</a>(stdClass <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>) {
<a name="l2294"><span class="linenum">2294</span></a>      global <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>;
<a name="l2295"><span class="linenum">2295</span></a>  
<a name="l2296"><span class="linenum">2296</span></a>      <a class="var it21067" onMouseOver="hilite(21067)" onMouseOut="lolite()" onClick="logVariable('iconurl')" href="../../_variables/iconurl.html">$iconurl</a> = <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('secureicon')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/secureicon.html">secureicon</a>;
<a name="l2297"><span class="linenum">2297</span></a>  
<a name="l2298"><span class="linenum">2298</span></a>      if (empty(<a class="var it21067" onMouseOver="hilite(21067)" onMouseOut="lolite()" onClick="logVariable('iconurl')" href="../../_variables/iconurl.html">$iconurl</a>)) {
<a name="l2299"><span class="linenum">2299</span></a>          <a class="var it21067" onMouseOver="hilite(21067)" onMouseOut="lolite()" onClick="logVariable('iconurl')" href="../../_variables/iconurl.html">$iconurl</a> = <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('icon')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/icon.html">icon</a>;
<a name="l2300"><span class="linenum">2300</span></a>      }
<a name="l2301"><span class="linenum">2301</span></a>  
<a name="l2302"><span class="linenum">2302</span></a>      if (empty(<a class="var it21067" onMouseOver="hilite(21067)" onMouseOut="lolite()" onClick="logVariable('iconurl')" href="../../_variables/iconurl.html">$iconurl</a>)) {
<a name="l2303"><span class="linenum">2303</span></a>          <a class="var it21067" onMouseOver="hilite(21067)" onMouseOut="lolite()" onClick="logVariable('iconurl')" href="../../_variables/iconurl.html">$iconurl</a> = <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('pix_url')" href="../../_functions/pix_url.html" onMouseOver="funcPopup(event,'pix_url')">pix_url</a>('icon', 'lti')-&gt;<a class="function" onClick="logFunction('out')" href="../../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>();
<a name="l2304"><span class="linenum">2304</span></a>      }
<a name="l2305"><span class="linenum">2305</span></a>  
<a name="l2306"><span class="linenum">2306</span></a>      return <a class="var it21067" onMouseOver="hilite(21067)" onMouseOut="lolite()" onClick="logVariable('iconurl')" href="../../_variables/iconurl.html">$iconurl</a>;
<a name="l2307"><span class="linenum">2307</span></a>  }
<a name="l2308"><span class="linenum">2308</span></a>  
<a name="l2309"><span class="linenum">2309</span></a>  <span class="comment">/**</span>
<a name="l2310"><span class="linenum">2310</span></a>  <span class="comment"> * Returns the edit url for the given tool type</span>
<a name="l2311"><span class="linenum">2311</span></a>  <span class="comment"> *</span>
<a name="l2312"><span class="linenum">2312</span></a>  <span class="comment"> * @param stdClass $type The tool type</span>
<a name="l2313"><span class="linenum">2313</span></a>  <span class="comment"> *</span>
<a name="l2314"><span class="linenum">2314</span></a>  <span class="comment"> * @return string The url to edit the tool type</span>
<a name="l2315"><span class="linenum">2315</span></a>  <span class="comment"> */</span>
<a name="l2316"><span class="linenum">2316</span></a>  function <a class="function" onClick="logFunction('get_tool_type_edit_url')" href="../../_functions/get_tool_type_edit_url.html" onMouseOver="funcPopup(event,'get_tool_type_edit_url')">get_tool_type_edit_url</a>(stdClass <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>) {
<a name="l2317"><span class="linenum">2317</span></a>      <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../mod/lti/typessettings.php.html">/mod/lti/typessettings.php</a>',
<a name="l2318"><span class="linenum">2318</span></a>                            array('action' =&gt; 'update', 'id' =&gt; <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('id')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'sesskey' =&gt; <a class="function" onClick="logFunction('sesskey')" href="../../_functions/sesskey.html" onMouseOver="funcPopup(event,'sesskey')">sesskey</a>(), 'returnto' =&gt; 'toolconfigure'));
<a name="l2319"><span class="linenum">2319</span></a>      return <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>-&gt;<a class="function" onClick="logFunction('out')" href="../../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>();
<a name="l2320"><span class="linenum">2320</span></a>  }
<a name="l2321"><span class="linenum">2321</span></a>  
<a name="l2322"><span class="linenum">2322</span></a>  <span class="comment">/**</span>
<a name="l2323"><span class="linenum">2323</span></a>  <span class="comment"> * Returns the edit url for the given tool proxy.</span>
<a name="l2324"><span class="linenum">2324</span></a>  <span class="comment"> *</span>
<a name="l2325"><span class="linenum">2325</span></a>  <span class="comment"> * @param stdClass $proxy The tool proxy</span>
<a name="l2326"><span class="linenum">2326</span></a>  <span class="comment"> *</span>
<a name="l2327"><span class="linenum">2327</span></a>  <span class="comment"> * @return string The url to edit the tool type</span>
<a name="l2328"><span class="linenum">2328</span></a>  <span class="comment"> */</span>
<a name="l2329"><span class="linenum">2329</span></a>  function <a class="function" onClick="logFunction('get_tool_proxy_edit_url')" href="../../_functions/get_tool_proxy_edit_url.html" onMouseOver="funcPopup(event,'get_tool_proxy_edit_url')">get_tool_proxy_edit_url</a>(stdClass <a class="var it9493" onMouseOver="hilite(9493)" onMouseOut="lolite()" onClick="logVariable('proxy')" href="../../_variables/proxy.html">$proxy</a>) {
<a name="l2330"><span class="linenum">2330</span></a>      <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../mod/lti/registersettings.php.html">/mod/lti/registersettings.php</a>',
<a name="l2331"><span class="linenum">2331</span></a>                            array('action' =&gt; 'update', 'id' =&gt; <a class="var it9493" onMouseOver="hilite(9493)" onMouseOut="lolite()" onClick="logVariable('proxy')" href="../../_variables/proxy.html">$proxy</a>-&gt;<a onClick="logVariable('id')" class="var it45271" onMouseOver="hilite(45271)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'sesskey' =&gt; <a class="function" onClick="logFunction('sesskey')" href="../../_functions/sesskey.html" onMouseOver="funcPopup(event,'sesskey')">sesskey</a>(), 'returnto' =&gt; 'toolconfigure'));
<a name="l2332"><span class="linenum">2332</span></a>      return <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>-&gt;<a class="function" onClick="logFunction('out')" href="../../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>();
<a name="l2333"><span class="linenum">2333</span></a>  }
<a name="l2334"><span class="linenum">2334</span></a>  
<a name="l2335"><span class="linenum">2335</span></a>  <span class="comment">/**</span>
<a name="l2336"><span class="linenum">2336</span></a>  <span class="comment"> * Returns the course url for the given tool type</span>
<a name="l2337"><span class="linenum">2337</span></a>  <span class="comment"> *</span>
<a name="l2338"><span class="linenum">2338</span></a>  <span class="comment"> * @param stdClass $type The tool type</span>
<a name="l2339"><span class="linenum">2339</span></a>  <span class="comment"> *</span>
<a name="l2340"><span class="linenum">2340</span></a>  <span class="comment"> * @return string|void The url to the course of the tool type, void if it is a site wide type</span>
<a name="l2341"><span class="linenum">2341</span></a>  <span class="comment"> */</span>
<a name="l2342"><span class="linenum">2342</span></a>  function <a class="function" onClick="logFunction('get_tool_type_course_url')" href="../../_functions/get_tool_type_course_url.html" onMouseOver="funcPopup(event,'get_tool_type_course_url')">get_tool_type_course_url</a>(stdClass <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>) {
<a name="l2343"><span class="linenum">2343</span></a>      if (<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('course')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/course.html">course</a> == 1) {
<a name="l2344"><span class="linenum">2344</span></a>          return;
<a name="l2345"><span class="linenum">2345</span></a>      } else {
<a name="l2346"><span class="linenum">2346</span></a>          <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../course/view.php.html">/course/view.php</a>', array('id' =&gt; <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('course')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>));
<a name="l2347"><span class="linenum">2347</span></a>          return <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>-&gt;<a class="function" onClick="logFunction('out')" href="../../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>();
<a name="l2348"><span class="linenum">2348</span></a>      }
<a name="l2349"><span class="linenum">2349</span></a>  }
<a name="l2350"><span class="linenum">2350</span></a>  
<a name="l2351"><span class="linenum">2351</span></a>  <span class="comment">/**</span>
<a name="l2352"><span class="linenum">2352</span></a>  <span class="comment"> * Returns the icon and edit urls for the tool type and the course url if it is a course type.</span>
<a name="l2353"><span class="linenum">2353</span></a>  <span class="comment"> *</span>
<a name="l2354"><span class="linenum">2354</span></a>  <span class="comment"> * @param stdClass $type The tool type</span>
<a name="l2355"><span class="linenum">2355</span></a>  <span class="comment"> *</span>
<a name="l2356"><span class="linenum">2356</span></a>  <span class="comment"> * @return string The urls of the tool type</span>
<a name="l2357"><span class="linenum">2357</span></a>  <span class="comment"> */</span>
<a name="l2358"><span class="linenum">2358</span></a>  function <a class="function" onClick="logFunction('get_tool_type_urls')" href="../../_functions/get_tool_type_urls.html" onMouseOver="funcPopup(event,'get_tool_type_urls')">get_tool_type_urls</a>(stdClass <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>) {
<a name="l2359"><span class="linenum">2359</span></a>      <a class="var it1080" onMouseOver="hilite(1080)" onMouseOut="lolite()" onClick="logVariable('courseurl')" href="../../_variables/courseurl.html">$courseurl</a> = <a class="function" onClick="logFunction('get_tool_type_course_url')" href="../../_functions/get_tool_type_course_url.html" onMouseOver="funcPopup(event,'get_tool_type_course_url')">get_tool_type_course_url</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>);
<a name="l2360"><span class="linenum">2360</span></a>  
<a name="l2361"><span class="linenum">2361</span></a>      <a class="var it8204" onMouseOver="hilite(8204)" onMouseOut="lolite()" onClick="logVariable('urls')" href="../../_variables/urls.html">$urls</a> = array(
<a name="l2362"><span class="linenum">2362</span></a>          'icon' =&gt; <a class="function" onClick="logFunction('get_tool_type_icon_url')" href="../../_functions/get_tool_type_icon_url.html" onMouseOver="funcPopup(event,'get_tool_type_icon_url')">get_tool_type_icon_url</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>),
<a name="l2363"><span class="linenum">2363</span></a>          'edit' =&gt; <a class="function" onClick="logFunction('get_tool_type_edit_url')" href="../../_functions/get_tool_type_edit_url.html" onMouseOver="funcPopup(event,'get_tool_type_edit_url')">get_tool_type_edit_url</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>),
<a name="l2364"><span class="linenum">2364</span></a>      );
<a name="l2365"><span class="linenum">2365</span></a>  
<a name="l2366"><span class="linenum">2366</span></a>      if (<a class="var it1080" onMouseOver="hilite(1080)" onMouseOut="lolite()" onClick="logVariable('courseurl')" href="../../_variables/courseurl.html">$courseurl</a>) {
<a name="l2367"><span class="linenum">2367</span></a>          <a class="var it8204" onMouseOver="hilite(8204)" onMouseOut="lolite()" onClick="logVariable('urls')" href="../../_variables/urls.html">$urls</a>['course'] = <a class="var it1080" onMouseOver="hilite(1080)" onMouseOut="lolite()" onClick="logVariable('courseurl')" href="../../_variables/courseurl.html">$courseurl</a>;
<a name="l2368"><span class="linenum">2368</span></a>      }
<a name="l2369"><span class="linenum">2369</span></a>  
<a name="l2370"><span class="linenum">2370</span></a>      return <a class="var it8204" onMouseOver="hilite(8204)" onMouseOut="lolite()" onClick="logVariable('urls')" href="../../_variables/urls.html">$urls</a>;
<a name="l2371"><span class="linenum">2371</span></a>  }
<a name="l2372"><span class="linenum">2372</span></a>  
<a name="l2373"><span class="linenum">2373</span></a>  <span class="comment">/**</span>
<a name="l2374"><span class="linenum">2374</span></a>  <span class="comment"> * Returns the icon and edit urls for the tool proxy.</span>
<a name="l2375"><span class="linenum">2375</span></a>  <span class="comment"> *</span>
<a name="l2376"><span class="linenum">2376</span></a>  <span class="comment"> * @param stdClass $proxy The tool proxy</span>
<a name="l2377"><span class="linenum">2377</span></a>  <span class="comment"> *</span>
<a name="l2378"><span class="linenum">2378</span></a>  <span class="comment"> * @return string The urls of the tool proxy</span>
<a name="l2379"><span class="linenum">2379</span></a>  <span class="comment"> */</span>
<a name="l2380"><span class="linenum">2380</span></a>  function <a class="function" onClick="logFunction('get_tool_proxy_urls')" href="../../_functions/get_tool_proxy_urls.html" onMouseOver="funcPopup(event,'get_tool_proxy_urls')">get_tool_proxy_urls</a>(stdClass <a class="var it9493" onMouseOver="hilite(9493)" onMouseOut="lolite()" onClick="logVariable('proxy')" href="../../_variables/proxy.html">$proxy</a>) {
<a name="l2381"><span class="linenum">2381</span></a>      global <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>;
<a name="l2382"><span class="linenum">2382</span></a>  
<a name="l2383"><span class="linenum">2383</span></a>      <a class="var it8204" onMouseOver="hilite(8204)" onMouseOut="lolite()" onClick="logVariable('urls')" href="../../_variables/urls.html">$urls</a> = array(
<a name="l2384"><span class="linenum">2384</span></a>          'icon' =&gt; <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('pix_url')" href="../../_functions/pix_url.html" onMouseOver="funcPopup(event,'pix_url')">pix_url</a>('icon', 'lti')-&gt;<a class="function" onClick="logFunction('out')" href="../../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>(),
<a name="l2385"><span class="linenum">2385</span></a>          'edit' =&gt; <a class="function" onClick="logFunction('get_tool_proxy_edit_url')" href="../../_functions/get_tool_proxy_edit_url.html" onMouseOver="funcPopup(event,'get_tool_proxy_edit_url')">get_tool_proxy_edit_url</a>(<a class="var it9493" onMouseOver="hilite(9493)" onMouseOut="lolite()" onClick="logVariable('proxy')" href="../../_variables/proxy.html">$proxy</a>),
<a name="l2386"><span class="linenum">2386</span></a>      );
<a name="l2387"><span class="linenum">2387</span></a>  
<a name="l2388"><span class="linenum">2388</span></a>      return <a class="var it8204" onMouseOver="hilite(8204)" onMouseOut="lolite()" onClick="logVariable('urls')" href="../../_variables/urls.html">$urls</a>;
<a name="l2389"><span class="linenum">2389</span></a>  }
<a name="l2390"><span class="linenum">2390</span></a>  
<a name="l2391"><span class="linenum">2391</span></a>  <span class="comment">/**</span>
<a name="l2392"><span class="linenum">2392</span></a>  <span class="comment"> * Returns information on the current state of the tool type</span>
<a name="l2393"><span class="linenum">2393</span></a>  <span class="comment"> *</span>
<a name="l2394"><span class="linenum">2394</span></a>  <span class="comment"> * @param stdClass $type The tool type</span>
<a name="l2395"><span class="linenum">2395</span></a>  <span class="comment"> *</span>
<a name="l2396"><span class="linenum">2396</span></a>  <span class="comment"> * @return array An array with a text description of the state, and boolean for whether it is in each state:</span>
<a name="l2397"><span class="linenum">2397</span></a>  <span class="comment"> * pending, configured, rejected, unknown</span>
<a name="l2398"><span class="linenum">2398</span></a>  <span class="comment"> */</span>
<a name="l2399"><span class="linenum">2399</span></a>  function <a class="function" onClick="logFunction('get_tool_type_state_info')" href="../../_functions/get_tool_type_state_info.html" onMouseOver="funcPopup(event,'get_tool_type_state_info')">get_tool_type_state_info</a>(stdClass <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>) {
<a name="l2400"><span class="linenum">2400</span></a>      <a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a> = '';
<a name="l2401"><span class="linenum">2401</span></a>      <a class="var it35799" onMouseOver="hilite(35799)" onMouseOut="lolite()" onClick="logVariable('isconfigured')" href="../../_variables/isconfigured.html">$isconfigured</a> = false;
<a name="l2402"><span class="linenum">2402</span></a>      <a class="var it35800" onMouseOver="hilite(35800)" onMouseOut="lolite()" onClick="logVariable('ispending')" href="../../_variables/ispending.html">$ispending</a> = false;
<a name="l2403"><span class="linenum">2403</span></a>      <a class="var it35801" onMouseOver="hilite(35801)" onMouseOut="lolite()" onClick="logVariable('isrejected')" href="../../_variables/isrejected.html">$isrejected</a> = false;
<a name="l2404"><span class="linenum">2404</span></a>      <a class="var it35802" onMouseOver="hilite(35802)" onMouseOut="lolite()" onClick="logVariable('isunknown')" href="../../_variables/isunknown.html">$isunknown</a> = false;
<a name="l2405"><span class="linenum">2405</span></a>      switch (<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('state')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/state.html">state</a>) {
<a name="l2406"><span class="linenum">2406</span></a>          case <a class="constant" onClick="logConstant('LTI_TOOL_STATE_CONFIGURED')" href="../../_constants/LTI_TOOL_STATE_CONFIGURED.html" onMouseOver="constPopup(event,'LTI_TOOL_STATE_CONFIGURED')">LTI_TOOL_STATE_CONFIGURED</a>:
<a name="l2407"><span class="linenum">2407</span></a>              <a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('active', 'mod_lti');
<a name="l2408"><span class="linenum">2408</span></a>              <a class="var it35799" onMouseOver="hilite(35799)" onMouseOut="lolite()" onClick="logVariable('isconfigured')" href="../../_variables/isconfigured.html">$isconfigured</a> = true;
<a name="l2409"><span class="linenum">2409</span></a>              break;
<a name="l2410"><span class="linenum">2410</span></a>          case <a class="constant" onClick="logConstant('LTI_TOOL_STATE_PENDING')" href="../../_constants/LTI_TOOL_STATE_PENDING.html" onMouseOver="constPopup(event,'LTI_TOOL_STATE_PENDING')">LTI_TOOL_STATE_PENDING</a>:
<a name="l2411"><span class="linenum">2411</span></a>              <a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('pending', 'mod_lti');
<a name="l2412"><span class="linenum">2412</span></a>              <a class="var it35800" onMouseOver="hilite(35800)" onMouseOut="lolite()" onClick="logVariable('ispending')" href="../../_variables/ispending.html">$ispending</a> = true;
<a name="l2413"><span class="linenum">2413</span></a>              break;
<a name="l2414"><span class="linenum">2414</span></a>          case <a class="constant" onClick="logConstant('LTI_TOOL_STATE_REJECTED')" href="../../_constants/LTI_TOOL_STATE_REJECTED.html" onMouseOver="constPopup(event,'LTI_TOOL_STATE_REJECTED')">LTI_TOOL_STATE_REJECTED</a>:
<a name="l2415"><span class="linenum">2415</span></a>              <a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('rejected', 'mod_lti');
<a name="l2416"><span class="linenum">2416</span></a>              <a class="var it35801" onMouseOver="hilite(35801)" onMouseOut="lolite()" onClick="logVariable('isrejected')" href="../../_variables/isrejected.html">$isrejected</a> = true;
<a name="l2417"><span class="linenum">2417</span></a>              break;
<a name="l2418"><span class="linenum">2418</span></a>          default:
<a name="l2419"><span class="linenum">2419</span></a>              <a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('unknownstate', 'mod_lti');
<a name="l2420"><span class="linenum">2420</span></a>              <a class="var it35802" onMouseOver="hilite(35802)" onMouseOut="lolite()" onClick="logVariable('isunknown')" href="../../_variables/isunknown.html">$isunknown</a> = true;
<a name="l2421"><span class="linenum">2421</span></a>              break;
<a name="l2422"><span class="linenum">2422</span></a>      }
<a name="l2423"><span class="linenum">2423</span></a>  
<a name="l2424"><span class="linenum">2424</span></a>      return array(
<a name="l2425"><span class="linenum">2425</span></a>          'text' =&gt; <a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>,
<a name="l2426"><span class="linenum">2426</span></a>          'pending' =&gt; <a class="var it35800" onMouseOver="hilite(35800)" onMouseOut="lolite()" onClick="logVariable('ispending')" href="../../_variables/ispending.html">$ispending</a>,
<a name="l2427"><span class="linenum">2427</span></a>          'configured' =&gt; <a class="var it35799" onMouseOver="hilite(35799)" onMouseOut="lolite()" onClick="logVariable('isconfigured')" href="../../_variables/isconfigured.html">$isconfigured</a>,
<a name="l2428"><span class="linenum">2428</span></a>          'rejected' =&gt; <a class="var it35801" onMouseOver="hilite(35801)" onMouseOut="lolite()" onClick="logVariable('isrejected')" href="../../_variables/isrejected.html">$isrejected</a>,
<a name="l2429"><span class="linenum">2429</span></a>          'unknown' =&gt; <a class="var it35802" onMouseOver="hilite(35802)" onMouseOut="lolite()" onClick="logVariable('isunknown')" href="../../_variables/isunknown.html">$isunknown</a>
<a name="l2430"><span class="linenum">2430</span></a>      );
<a name="l2431"><span class="linenum">2431</span></a>  }
<a name="l2432"><span class="linenum">2432</span></a>  
<a name="l2433"><span class="linenum">2433</span></a>  <span class="comment">/**</span>
<a name="l2434"><span class="linenum">2434</span></a>  <span class="comment"> * Returns a summary of each LTI capability this tool type requires in plain language</span>
<a name="l2435"><span class="linenum">2435</span></a>  <span class="comment"> *</span>
<a name="l2436"><span class="linenum">2436</span></a>  <span class="comment"> * @param stdClass $type The tool type</span>
<a name="l2437"><span class="linenum">2437</span></a>  <span class="comment"> *</span>
<a name="l2438"><span class="linenum">2438</span></a>  <span class="comment"> * @return array An array of text descriptions of each of the capabilities this tool type requires</span>
<a name="l2439"><span class="linenum">2439</span></a>  <span class="comment"> */</span>
<a name="l2440"><span class="linenum">2440</span></a>  function <a class="function" onClick="logFunction('get_tool_type_capability_groups')" href="../../_functions/get_tool_type_capability_groups.html" onMouseOver="funcPopup(event,'get_tool_type_capability_groups')">get_tool_type_capability_groups</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>) {
<a name="l2441"><span class="linenum">2441</span></a>      <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('capabilities')" href="../../_variables/capabilities.html">$capabilities</a> = <a class="function" onClick="logFunction('lti_get_enabled_capabilities')" href="../../_functions/lti_get_enabled_capabilities.html" onMouseOver="funcPopup(event,'lti_get_enabled_capabilities')">lti_get_enabled_capabilities</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>);
<a name="l2442"><span class="linenum">2442</span></a>      <a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('groups')" href="../../_variables/groups.html">$groups</a> = array();
<a name="l2443"><span class="linenum">2443</span></a>      <a class="var it35803" onMouseOver="hilite(35803)" onMouseOut="lolite()" onClick="logVariable('hascourse')" href="../../_variables/hascourse.html">$hascourse</a> = false;
<a name="l2444"><span class="linenum">2444</span></a>      <a class="var it35804" onMouseOver="hilite(35804)" onMouseOut="lolite()" onClick="logVariable('hasactivities')" href="../../_variables/hasactivities.html">$hasactivities</a> = false;
<a name="l2445"><span class="linenum">2445</span></a>      <a class="var it35805" onMouseOver="hilite(35805)" onMouseOut="lolite()" onClick="logVariable('hasuseraccount')" href="../../_variables/hasuseraccount.html">$hasuseraccount</a> = false;
<a name="l2446"><span class="linenum">2446</span></a>      <a class="var it35806" onMouseOver="hilite(35806)" onMouseOut="lolite()" onClick="logVariable('hasuserpersonal')" href="../../_variables/hasuserpersonal.html">$hasuserpersonal</a> = false;
<a name="l2447"><span class="linenum">2447</span></a>  
<a name="l2448"><span class="linenum">2448</span></a>      foreach (<a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('capabilities')" href="../../_variables/capabilities.html">$capabilities</a> as <a class="var it787" onMouseOver="hilite(787)" onMouseOut="lolite()" onClick="logVariable('capability')" href="../../_variables/capability.html">$capability</a>) {
<a name="l2449"><span class="linenum">2449</span></a>  <span class="comment">        // Bail out early if we've already found all groups.</span>
<a name="l2450"><span class="linenum">2450</span></a>          if (<a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('groups')" href="../../_variables/groups.html">$groups</a>) &gt;= 4) {
<a name="l2451"><span class="linenum">2451</span></a>              continue;
<a name="l2452"><span class="linenum">2452</span></a>          }
<a name="l2453"><span class="linenum">2453</span></a>  
<a name="l2454"><span class="linenum">2454</span></a>          if (!<a class="var it35803" onMouseOver="hilite(35803)" onMouseOut="lolite()" onClick="logVariable('hascourse')" href="../../_variables/hascourse.html">$hascourse</a> &amp;&amp; <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^CourseSection/', <a class="var it787" onMouseOver="hilite(787)" onMouseOut="lolite()" onClick="logVariable('capability')" href="../../_variables/capability.html">$capability</a>)) {
<a name="l2455"><span class="linenum">2455</span></a>              <a class="var it35803" onMouseOver="hilite(35803)" onMouseOut="lolite()" onClick="logVariable('hascourse')" href="../../_variables/hascourse.html">$hascourse</a> = true;
<a name="l2456"><span class="linenum">2456</span></a>              <a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('groups')" href="../../_variables/groups.html">$groups</a>[] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('courseinformation', 'mod_lti');
<a name="l2457"><span class="linenum">2457</span></a>          } else if (!<a class="var it35804" onMouseOver="hilite(35804)" onMouseOut="lolite()" onClick="logVariable('hasactivities')" href="../../_variables/hasactivities.html">$hasactivities</a> &amp;&amp; <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^ResourceLink/', <a class="var it787" onMouseOver="hilite(787)" onMouseOut="lolite()" onClick="logVariable('capability')" href="../../_variables/capability.html">$capability</a>)) {
<a name="l2458"><span class="linenum">2458</span></a>              <a class="var it35804" onMouseOver="hilite(35804)" onMouseOut="lolite()" onClick="logVariable('hasactivities')" href="../../_variables/hasactivities.html">$hasactivities</a> = true;
<a name="l2459"><span class="linenum">2459</span></a>              <a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('groups')" href="../../_variables/groups.html">$groups</a>[] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('courseactivitiesorresources', 'mod_lti');
<a name="l2460"><span class="linenum">2460</span></a>          } else if (!<a class="var it35805" onMouseOver="hilite(35805)" onMouseOut="lolite()" onClick="logVariable('hasuseraccount')" href="../../_variables/hasuseraccount.html">$hasuseraccount</a> &amp;&amp; <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^User/', <a class="var it787" onMouseOver="hilite(787)" onMouseOut="lolite()" onClick="logVariable('capability')" href="../../_variables/capability.html">$capability</a>) || <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^Membership/', <a class="var it787" onMouseOver="hilite(787)" onMouseOut="lolite()" onClick="logVariable('capability')" href="../../_variables/capability.html">$capability</a>)) {
<a name="l2461"><span class="linenum">2461</span></a>              <a class="var it35805" onMouseOver="hilite(35805)" onMouseOut="lolite()" onClick="logVariable('hasuseraccount')" href="../../_variables/hasuseraccount.html">$hasuseraccount</a> = true;
<a name="l2462"><span class="linenum">2462</span></a>              <a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('groups')" href="../../_variables/groups.html">$groups</a>[] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('useraccountinformation', 'mod_lti');
<a name="l2463"><span class="linenum">2463</span></a>          } else if (!<a class="var it35806" onMouseOver="hilite(35806)" onMouseOut="lolite()" onClick="logVariable('hasuserpersonal')" href="../../_variables/hasuserpersonal.html">$hasuserpersonal</a> &amp;&amp; <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^Person/', <a class="var it787" onMouseOver="hilite(787)" onMouseOut="lolite()" onClick="logVariable('capability')" href="../../_variables/capability.html">$capability</a>)) {
<a name="l2464"><span class="linenum">2464</span></a>              <a class="var it35806" onMouseOver="hilite(35806)" onMouseOut="lolite()" onClick="logVariable('hasuserpersonal')" href="../../_variables/hasuserpersonal.html">$hasuserpersonal</a> = true;
<a name="l2465"><span class="linenum">2465</span></a>              <a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('groups')" href="../../_variables/groups.html">$groups</a>[] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('userpersonalinformation', 'mod_lti');
<a name="l2466"><span class="linenum">2466</span></a>          }
<a name="l2467"><span class="linenum">2467</span></a>      }
<a name="l2468"><span class="linenum">2468</span></a>  
<a name="l2469"><span class="linenum">2469</span></a>      return <a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('groups')" href="../../_variables/groups.html">$groups</a>;
<a name="l2470"><span class="linenum">2470</span></a>  }
<a name="l2471"><span class="linenum">2471</span></a>  
<a name="l2472"><span class="linenum">2472</span></a>  
<a name="l2473"><span class="linenum">2473</span></a>  <span class="comment">/**</span>
<a name="l2474"><span class="linenum">2474</span></a>  <span class="comment"> * Returns the ids of each instance of this tool type</span>
<a name="l2475"><span class="linenum">2475</span></a>  <span class="comment"> *</span>
<a name="l2476"><span class="linenum">2476</span></a>  <span class="comment"> * @param stdClass $type The tool type</span>
<a name="l2477"><span class="linenum">2477</span></a>  <span class="comment"> *</span>
<a name="l2478"><span class="linenum">2478</span></a>  <span class="comment"> * @return array An array of ids of the instances of this tool type</span>
<a name="l2479"><span class="linenum">2479</span></a>  <span class="comment"> */</span>
<a name="l2480"><span class="linenum">2480</span></a>  function <a class="function" onClick="logFunction('get_tool_type_instance_ids')" href="../../_functions/get_tool_type_instance_ids.html" onMouseOver="funcPopup(event,'get_tool_type_instance_ids')">get_tool_type_instance_ids</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>) {
<a name="l2481"><span class="linenum">2481</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l2482"><span class="linenum">2482</span></a>  
<a name="l2483"><span class="linenum">2483</span></a>      return <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_fieldset_select')" href="../../_functions/get_fieldset_select.html" onMouseOver="funcPopup(event,'get_fieldset_select')">get_fieldset_select</a>('lti', 'id', 'typeid = ?', array(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('id')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>)));
<a name="l2484"><span class="linenum">2484</span></a>  }
<a name="l2485"><span class="linenum">2485</span></a>  
<a name="l2486"><span class="linenum">2486</span></a>  <span class="comment">/**</span>
<a name="l2487"><span class="linenum">2487</span></a>  <span class="comment"> * Serialises this tool type</span>
<a name="l2488"><span class="linenum">2488</span></a>  <span class="comment"> *</span>
<a name="l2489"><span class="linenum">2489</span></a>  <span class="comment"> * @param stdClass $type The tool type</span>
<a name="l2490"><span class="linenum">2490</span></a>  <span class="comment"> *</span>
<a name="l2491"><span class="linenum">2491</span></a>  <span class="comment"> * @return array An array of values representing this type</span>
<a name="l2492"><span class="linenum">2492</span></a>  <span class="comment"> */</span>
<a name="l2493"><span class="linenum">2493</span></a>  function <a class="function" onClick="logFunction('serialise_tool_type')" href="../../_functions/serialise_tool_type.html" onMouseOver="funcPopup(event,'serialise_tool_type')">serialise_tool_type</a>(stdClass <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>) {
<a name="l2494"><span class="linenum">2494</span></a>      <a class="var it35807" onMouseOver="hilite(35807)" onMouseOut="lolite()" onClick="logVariable('capabilitygroups')" href="../../_variables/capabilitygroups.html">$capabilitygroups</a> = <a class="function" onClick="logFunction('get_tool_type_capability_groups')" href="../../_functions/get_tool_type_capability_groups.html" onMouseOver="funcPopup(event,'get_tool_type_capability_groups')">get_tool_type_capability_groups</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>);
<a name="l2495"><span class="linenum">2495</span></a>      <a class="var it3794" onMouseOver="hilite(3794)" onMouseOut="lolite()" onClick="logVariable('instanceids')" href="../../_variables/instanceids.html">$instanceids</a> = <a class="function" onClick="logFunction('get_tool_type_instance_ids')" href="../../_functions/get_tool_type_instance_ids.html" onMouseOver="funcPopup(event,'get_tool_type_instance_ids')">get_tool_type_instance_ids</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>);
<a name="l2496"><span class="linenum">2496</span></a>  <span class="comment">    // Clean the name. We don't want tags here.</span>
<a name="l2497"><span class="linenum">2497</span></a>      <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a> = <a class="function" onClick="logFunction('clean_param')" href="../../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('name')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>, <a class="constant" onClick="logConstant('PARAM_NOTAGS')" href="../../_constants/PARAM_NOTAGS.html" onMouseOver="constPopup(event,'PARAM_NOTAGS')">PARAM_NOTAGS</a>);
<a name="l2498"><span class="linenum">2498</span></a>      if (!empty(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('description')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/description.html">description</a>)) {
<a name="l2499"><span class="linenum">2499</span></a>  <span class="comment">        // Clean the description. We don't want tags here.</span>
<a name="l2500"><span class="linenum">2500</span></a>          <a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('description')" href="../../_variables/description.html">$description</a> = <a class="function" onClick="logFunction('clean_param')" href="../../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('description')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/description.html">description</a>, <a class="constant" onClick="logConstant('PARAM_NOTAGS')" href="../../_constants/PARAM_NOTAGS.html" onMouseOver="constPopup(event,'PARAM_NOTAGS')">PARAM_NOTAGS</a>);
<a name="l2501"><span class="linenum">2501</span></a>      } else {
<a name="l2502"><span class="linenum">2502</span></a>          <a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('description')" href="../../_variables/description.html">$description</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('editdescription', 'mod_lti');
<a name="l2503"><span class="linenum">2503</span></a>      }
<a name="l2504"><span class="linenum">2504</span></a>      return array(
<a name="l2505"><span class="linenum">2505</span></a>          'id' =&gt; <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('id')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l2506"><span class="linenum">2506</span></a>          'name' =&gt; <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>,
<a name="l2507"><span class="linenum">2507</span></a>          'description' =&gt; <a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('description')" href="../../_variables/description.html">$description</a>,
<a name="l2508"><span class="linenum">2508</span></a>          'urls' =&gt; <a class="function" onClick="logFunction('get_tool_type_urls')" href="../../_functions/get_tool_type_urls.html" onMouseOver="funcPopup(event,'get_tool_type_urls')">get_tool_type_urls</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>),
<a name="l2509"><span class="linenum">2509</span></a>          'state' =&gt; <a class="function" onClick="logFunction('get_tool_type_state_info')" href="../../_functions/get_tool_type_state_info.html" onMouseOver="funcPopup(event,'get_tool_type_state_info')">get_tool_type_state_info</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>),
<a name="l2510"><span class="linenum">2510</span></a>          'hascapabilitygroups' =&gt; !empty(<a class="var it35807" onMouseOver="hilite(35807)" onMouseOut="lolite()" onClick="logVariable('capabilitygroups')" href="../../_variables/capabilitygroups.html">$capabilitygroups</a>),
<a name="l2511"><span class="linenum">2511</span></a>          'capabilitygroups' =&gt; <a class="var it35807" onMouseOver="hilite(35807)" onMouseOut="lolite()" onClick="logVariable('capabilitygroups')" href="../../_variables/capabilitygroups.html">$capabilitygroups</a>,
<a name="l2512"><span class="linenum">2512</span></a>  <span class="comment">        // Course ID of 1 means it's not linked to a course.</span>
<a name="l2513"><span class="linenum">2513</span></a>          'courseid' =&gt; <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('course')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/course.html">course</a> == 1 ? 0 : <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('course')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>,
<a name="l2514"><span class="linenum">2514</span></a>          'instanceids' =&gt; <a class="var it3794" onMouseOver="hilite(3794)" onMouseOut="lolite()" onClick="logVariable('instanceids')" href="../../_variables/instanceids.html">$instanceids</a>,
<a name="l2515"><span class="linenum">2515</span></a>          'instancecount' =&gt; <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it3794" onMouseOver="hilite(3794)" onMouseOut="lolite()" onClick="logVariable('instanceids')" href="../../_variables/instanceids.html">$instanceids</a>)
<a name="l2516"><span class="linenum">2516</span></a>      );
<a name="l2517"><span class="linenum">2517</span></a>  }
<a name="l2518"><span class="linenum">2518</span></a>  
<a name="l2519"><span class="linenum">2519</span></a>  <span class="comment">/**</span>
<a name="l2520"><span class="linenum">2520</span></a>  <span class="comment"> * Serialises this tool proxy.</span>
<a name="l2521"><span class="linenum">2521</span></a>  <span class="comment"> *</span>
<a name="l2522"><span class="linenum">2522</span></a>  <span class="comment"> * @param stdClass $proxy The tool proxy</span>
<a name="l2523"><span class="linenum">2523</span></a>  <span class="comment"> *</span>
<a name="l2524"><span class="linenum">2524</span></a>  <span class="comment"> * @return array An array of values representing this type</span>
<a name="l2525"><span class="linenum">2525</span></a>  <span class="comment"> */</span>
<a name="l2526"><span class="linenum">2526</span></a>  function <a class="function" onClick="logFunction('serialise_tool_proxy')" href="../../_functions/serialise_tool_proxy.html" onMouseOver="funcPopup(event,'serialise_tool_proxy')">serialise_tool_proxy</a>(stdClass <a class="var it9493" onMouseOver="hilite(9493)" onMouseOut="lolite()" onClick="logVariable('proxy')" href="../../_variables/proxy.html">$proxy</a>) {
<a name="l2527"><span class="linenum">2527</span></a>      return array(
<a name="l2528"><span class="linenum">2528</span></a>          'id' =&gt; <a class="var it9493" onMouseOver="hilite(9493)" onMouseOut="lolite()" onClick="logVariable('proxy')" href="../../_variables/proxy.html">$proxy</a>-&gt;<a onClick="logVariable('id')" class="var it45271" onMouseOver="hilite(45271)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l2529"><span class="linenum">2529</span></a>          'name' =&gt; <a class="var it9493" onMouseOver="hilite(9493)" onMouseOut="lolite()" onClick="logVariable('proxy')" href="../../_variables/proxy.html">$proxy</a>-&gt;<a onClick="logVariable('name')" class="var it45271" onMouseOver="hilite(45271)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>,
<a name="l2530"><span class="linenum">2530</span></a>          'description' =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('activatetoadddescription', 'mod_lti'),
<a name="l2531"><span class="linenum">2531</span></a>          'urls' =&gt; <a class="function" onClick="logFunction('get_tool_proxy_urls')" href="../../_functions/get_tool_proxy_urls.html" onMouseOver="funcPopup(event,'get_tool_proxy_urls')">get_tool_proxy_urls</a>(<a class="var it9493" onMouseOver="hilite(9493)" onMouseOut="lolite()" onClick="logVariable('proxy')" href="../../_variables/proxy.html">$proxy</a>),
<a name="l2532"><span class="linenum">2532</span></a>          'state' =&gt; array(
<a name="l2533"><span class="linenum">2533</span></a>              'text' =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('pending', 'mod_lti'),
<a name="l2534"><span class="linenum">2534</span></a>              'pending' =&gt; true,
<a name="l2535"><span class="linenum">2535</span></a>              'configured' =&gt; false,
<a name="l2536"><span class="linenum">2536</span></a>              'rejected' =&gt; false,
<a name="l2537"><span class="linenum">2537</span></a>              'unknown' =&gt; false
<a name="l2538"><span class="linenum">2538</span></a>          ),
<a name="l2539"><span class="linenum">2539</span></a>          'hascapabilitygroups' =&gt; true,
<a name="l2540"><span class="linenum">2540</span></a>          'capabilitygroups' =&gt; array(),
<a name="l2541"><span class="linenum">2541</span></a>          'courseid' =&gt; 0,
<a name="l2542"><span class="linenum">2542</span></a>          'instanceids' =&gt; array(),
<a name="l2543"><span class="linenum">2543</span></a>          'instancecount' =&gt; 0
<a name="l2544"><span class="linenum">2544</span></a>      );
<a name="l2545"><span class="linenum">2545</span></a>  }
<a name="l2546"><span class="linenum">2546</span></a>  
<a name="l2547"><span class="linenum">2547</span></a>  <span class="comment">/**</span>
<a name="l2548"><span class="linenum">2548</span></a>  <span class="comment"> * Loads the cartridge information into the tool type, if the launch url is for a cartridge file</span>
<a name="l2549"><span class="linenum">2549</span></a>  <span class="comment"> *</span>
<a name="l2550"><span class="linenum">2550</span></a>  <span class="comment"> * @param stdClass $type The tool type object to be filled in</span>
<a name="l2551"><span class="linenum">2551</span></a>  <span class="comment"> * @since Moodle 3.1</span>
<a name="l2552"><span class="linenum">2552</span></a>  <span class="comment"> */</span>
<a name="l2553"><span class="linenum">2553</span></a>  function <a class="function" onClick="logFunction('lti_load_type_if_cartridge')" href="../../_functions/lti_load_type_if_cartridge.html" onMouseOver="funcPopup(event,'lti_load_type_if_cartridge')">lti_load_type_if_cartridge</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>) {
<a name="l2554"><span class="linenum">2554</span></a>      if (!empty(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_toolurl')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_toolurl.html">lti_toolurl</a>) &amp;&amp; <a class="function" onClick="logFunction('lti_is_cartridge')" href="../../_functions/lti_is_cartridge.html" onMouseOver="funcPopup(event,'lti_is_cartridge')">lti_is_cartridge</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_toolurl')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_toolurl.html">lti_toolurl</a>)) {
<a name="l2555"><span class="linenum">2555</span></a>          <a class="function" onClick="logFunction('lti_load_type_from_cartridge')" href="../../_functions/lti_load_type_from_cartridge.html" onMouseOver="funcPopup(event,'lti_load_type_from_cartridge')">lti_load_type_from_cartridge</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_toolurl')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_toolurl.html">lti_toolurl</a>, <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>);
<a name="l2556"><span class="linenum">2556</span></a>      }
<a name="l2557"><span class="linenum">2557</span></a>  }
<a name="l2558"><span class="linenum">2558</span></a>  
<a name="l2559"><span class="linenum">2559</span></a>  <span class="comment">/**</span>
<a name="l2560"><span class="linenum">2560</span></a>  <span class="comment"> * Loads the cartridge information into the new tool, if the launch url is for a cartridge file</span>
<a name="l2561"><span class="linenum">2561</span></a>  <span class="comment"> *</span>
<a name="l2562"><span class="linenum">2562</span></a>  <span class="comment"> * @param stdClass $lti The tools config</span>
<a name="l2563"><span class="linenum">2563</span></a>  <span class="comment"> * @since Moodle 3.1</span>
<a name="l2564"><span class="linenum">2564</span></a>  <span class="comment"> */</span>
<a name="l2565"><span class="linenum">2565</span></a>  function <a class="function" onClick="logFunction('lti_load_tool_if_cartridge')" href="../../_functions/lti_load_tool_if_cartridge.html" onMouseOver="funcPopup(event,'lti_load_tool_if_cartridge')">lti_load_tool_if_cartridge</a>(<a class="var it3755" onMouseOver="hilite(3755)" onMouseOut="lolite()" onClick="logVariable('lti')" href="../../_variables/lti.html">$lti</a>) {
<a name="l2566"><span class="linenum">2566</span></a>      if (!empty(<a class="var it3755" onMouseOver="hilite(3755)" onMouseOut="lolite()" onClick="logVariable('lti')" href="../../_variables/lti.html">$lti</a>-&gt;<a onClick="logVariable('toolurl')" class="var it45050" onMouseOver="hilite(45050)" onMouseOut="lolite()" href="../../_variables/toolurl.html">toolurl</a>) &amp;&amp; <a class="function" onClick="logFunction('lti_is_cartridge')" href="../../_functions/lti_is_cartridge.html" onMouseOver="funcPopup(event,'lti_is_cartridge')">lti_is_cartridge</a>(<a class="var it3755" onMouseOver="hilite(3755)" onMouseOut="lolite()" onClick="logVariable('lti')" href="../../_variables/lti.html">$lti</a>-&gt;<a onClick="logVariable('toolurl')" class="var it45050" onMouseOver="hilite(45050)" onMouseOut="lolite()" href="../../_variables/toolurl.html">toolurl</a>)) {
<a name="l2567"><span class="linenum">2567</span></a>          <a class="function" onClick="logFunction('lti_load_tool_from_cartridge')" href="../../_functions/lti_load_tool_from_cartridge.html" onMouseOver="funcPopup(event,'lti_load_tool_from_cartridge')">lti_load_tool_from_cartridge</a>(<a class="var it3755" onMouseOver="hilite(3755)" onMouseOut="lolite()" onClick="logVariable('lti')" href="../../_variables/lti.html">$lti</a>-&gt;<a onClick="logVariable('toolurl')" class="var it45050" onMouseOver="hilite(45050)" onMouseOut="lolite()" href="../../_variables/toolurl.html">toolurl</a>, <a class="var it3755" onMouseOver="hilite(3755)" onMouseOut="lolite()" onClick="logVariable('lti')" href="../../_variables/lti.html">$lti</a>);
<a name="l2568"><span class="linenum">2568</span></a>      }
<a name="l2569"><span class="linenum">2569</span></a>  }
<a name="l2570"><span class="linenum">2570</span></a>  
<a name="l2571"><span class="linenum">2571</span></a>  <span class="comment">/**</span>
<a name="l2572"><span class="linenum">2572</span></a>  <span class="comment"> * Determines if the given url is for a IMS basic cartridge</span>
<a name="l2573"><span class="linenum">2573</span></a>  <span class="comment"> *</span>
<a name="l2574"><span class="linenum">2574</span></a>  <span class="comment"> * @param  string $url The url to be checked</span>
<a name="l2575"><span class="linenum">2575</span></a>  <span class="comment"> * @return True if the url is for a cartridge</span>
<a name="l2576"><span class="linenum">2576</span></a>  <span class="comment"> * @since Moodle 3.1</span>
<a name="l2577"><span class="linenum">2577</span></a>  <span class="comment"> */</span>
<a name="l2578"><span class="linenum">2578</span></a>  function <a class="function" onClick="logFunction('lti_is_cartridge')" href="../../_functions/lti_is_cartridge.html" onMouseOver="funcPopup(event,'lti_is_cartridge')">lti_is_cartridge</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>) {
<a name="l2579"><span class="linenum">2579</span></a>  <span class="comment">    // If it is empty, it's not a cartridge.</span>
<a name="l2580"><span class="linenum">2580</span></a>      if (empty(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>)) {
<a name="l2581"><span class="linenum">2581</span></a>          return false;
<a name="l2582"><span class="linenum">2582</span></a>      }
<a name="l2583"><span class="linenum">2583</span></a>  <span class="comment">    // If it has xml at the end of the url, it's a cartridge.</span>
<a name="l2584"><span class="linenum">2584</span></a>      if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/\.xml$/', <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>)) {
<a name="l2585"><span class="linenum">2585</span></a>          return true;
<a name="l2586"><span class="linenum">2586</span></a>      }
<a name="l2587"><span class="linenum">2587</span></a>  <span class="comment">    // Even if it doesn't have .xml, load the url to check if it's a cartridge..</span>
<a name="l2588"><span class="linenum">2588</span></a>      try {
<a name="l2589"><span class="linenum">2589</span></a>          <a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a> = <a class="function" onClick="logFunction('lti_load_cartridge')" href="../../_functions/lti_load_cartridge.html" onMouseOver="funcPopup(event,'lti_load_cartridge')">lti_load_cartridge</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>,
<a name="l2590"><span class="linenum">2590</span></a>              array(
<a name="l2591"><span class="linenum">2591</span></a>                  &quot;launch_url&quot; =&gt; &quot;launchurl&quot;
<a name="l2592"><span class="linenum">2592</span></a>              )
<a name="l2593"><span class="linenum">2593</span></a>          );
<a name="l2594"><span class="linenum">2594</span></a>          if (!empty(<a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['launchurl'])) {
<a name="l2595"><span class="linenum">2595</span></a>              return true;
<a name="l2596"><span class="linenum">2596</span></a>          }
<a name="l2597"><span class="linenum">2597</span></a>      } catch (moodle_exception <a class="var it122" onMouseOver="hilite(122)" onMouseOut="lolite()" onClick="logVariable('e')" href="../../_variables/e.html">$e</a>) {
<a name="l2598"><span class="linenum">2598</span></a>          return false; <span class="comment">// Error loading the xml, so it's not a cartridge.</span>
<a name="l2599"><span class="linenum">2599</span></a>      }
<a name="l2600"><span class="linenum">2600</span></a>      return false;
<a name="l2601"><span class="linenum">2601</span></a>  }
<a name="l2602"><span class="linenum">2602</span></a>  
<a name="l2603"><span class="linenum">2603</span></a>  <span class="comment">/**</span>
<a name="l2604"><span class="linenum">2604</span></a>  <span class="comment"> * Allows you to load settings for an external tool type from an IMS cartridge.</span>
<a name="l2605"><span class="linenum">2605</span></a>  <span class="comment"> *</span>
<a name="l2606"><span class="linenum">2606</span></a>  <span class="comment"> * @param  string   $url     The URL to the cartridge</span>
<a name="l2607"><span class="linenum">2607</span></a>  <span class="comment"> * @param  stdClass $type    The tool type object to be filled in</span>
<a name="l2608"><span class="linenum">2608</span></a>  <span class="comment"> * @throws moodle_exception if the cartridge could not be loaded correctly</span>
<a name="l2609"><span class="linenum">2609</span></a>  <span class="comment"> * @since Moodle 3.1</span>
<a name="l2610"><span class="linenum">2610</span></a>  <span class="comment"> */</span>
<a name="l2611"><span class="linenum">2611</span></a>  function <a class="function" onClick="logFunction('lti_load_type_from_cartridge')" href="../../_functions/lti_load_type_from_cartridge.html" onMouseOver="funcPopup(event,'lti_load_type_from_cartridge')">lti_load_type_from_cartridge</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>, <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>) {
<a name="l2612"><span class="linenum">2612</span></a>      <a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a> = <a class="function" onClick="logFunction('lti_load_cartridge')" href="../../_functions/lti_load_cartridge.html" onMouseOver="funcPopup(event,'lti_load_cartridge')">lti_load_cartridge</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>,
<a name="l2613"><span class="linenum">2613</span></a>          array(
<a name="l2614"><span class="linenum">2614</span></a>              &quot;title&quot; =&gt; &quot;lti_typename&quot;,
<a name="l2615"><span class="linenum">2615</span></a>              &quot;launch_url&quot; =&gt; &quot;lti_toolurl&quot;,
<a name="l2616"><span class="linenum">2616</span></a>              &quot;description&quot; =&gt; &quot;lti_description&quot;,
<a name="l2617"><span class="linenum">2617</span></a>              &quot;icon&quot; =&gt; &quot;lti_icon&quot;,
<a name="l2618"><span class="linenum">2618</span></a>              &quot;secure_icon&quot; =&gt; &quot;lti_secureicon&quot;
<a name="l2619"><span class="linenum">2619</span></a>          ),
<a name="l2620"><span class="linenum">2620</span></a>          array(
<a name="l2621"><span class="linenum">2621</span></a>              &quot;icon_url&quot; =&gt; &quot;lti_extension_icon&quot;,
<a name="l2622"><span class="linenum">2622</span></a>              &quot;secure_icon_url&quot; =&gt; &quot;lti_extension_secureicon&quot;
<a name="l2623"><span class="linenum">2623</span></a>          )
<a name="l2624"><span class="linenum">2624</span></a>      );
<a name="l2625"><span class="linenum">2625</span></a>  <span class="comment">    // If an activity name exists, unset the cartridge name so we don't override it.</span>
<a name="l2626"><span class="linenum">2626</span></a>      if (isset(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a onClick="logVariable('lti_typename')" class="var it44031" onMouseOver="hilite(44031)" onMouseOut="lolite()" href="../../_variables/lti_typename.html">lti_typename</a>)) {
<a name="l2627"><span class="linenum">2627</span></a>          unset(<a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['lti_typename']);
<a name="l2628"><span class="linenum">2628</span></a>      }
<a name="l2629"><span class="linenum">2629</span></a>  
<a name="l2630"><span class="linenum">2630</span></a>  <span class="comment">    // Always prefer cartridge core icons first, then, if none are found, look at the extension icons.</span>
<a name="l2631"><span class="linenum">2631</span></a>      if (empty(<a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['lti_icon']) &amp;&amp; !empty(<a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['lti_extension_icon'])) {
<a name="l2632"><span class="linenum">2632</span></a>          <a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['lti_icon'] = <a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['lti_extension_icon'];
<a name="l2633"><span class="linenum">2633</span></a>      }
<a name="l2634"><span class="linenum">2634</span></a>      unset(<a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['lti_extension_icon']);
<a name="l2635"><span class="linenum">2635</span></a>  
<a name="l2636"><span class="linenum">2636</span></a>      if (empty(<a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['lti_secureicon']) &amp;&amp; !empty(<a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['lti_extension_secureicon'])) {
<a name="l2637"><span class="linenum">2637</span></a>          <a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['lti_secureicon'] = <a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['lti_extension_secureicon'];
<a name="l2638"><span class="linenum">2638</span></a>      }
<a name="l2639"><span class="linenum">2639</span></a>      unset(<a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['lti_extension_secureicon']);
<a name="l2640"><span class="linenum">2640</span></a>  
<a name="l2641"><span class="linenum">2641</span></a>      foreach (<a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a> as <a class="var it1414" onMouseOver="hilite(1414)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a> =&gt; <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l2642"><span class="linenum">2642</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>-&gt;<a class="var it1414" onMouseOver="hilite(1414)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a> = <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l2643"><span class="linenum">2643</span></a>      }
<a name="l2644"><span class="linenum">2644</span></a>  }
<a name="l2645"><span class="linenum">2645</span></a>  
<a name="l2646"><span class="linenum">2646</span></a>  <span class="comment">/**</span>
<a name="l2647"><span class="linenum">2647</span></a>  <span class="comment"> * Allows you to load in the configuration for an external tool from an IMS cartridge.</span>
<a name="l2648"><span class="linenum">2648</span></a>  <span class="comment"> *</span>
<a name="l2649"><span class="linenum">2649</span></a>  <span class="comment"> * @param  string   $url    The URL to the cartridge</span>
<a name="l2650"><span class="linenum">2650</span></a>  <span class="comment"> * @param  stdClass $lti    LTI object</span>
<a name="l2651"><span class="linenum">2651</span></a>  <span class="comment"> * @throws moodle_exception if the cartridge could not be loaded correctly</span>
<a name="l2652"><span class="linenum">2652</span></a>  <span class="comment"> * @since Moodle 3.1</span>
<a name="l2653"><span class="linenum">2653</span></a>  <span class="comment"> */</span>
<a name="l2654"><span class="linenum">2654</span></a>  function <a class="function" onClick="logFunction('lti_load_tool_from_cartridge')" href="../../_functions/lti_load_tool_from_cartridge.html" onMouseOver="funcPopup(event,'lti_load_tool_from_cartridge')">lti_load_tool_from_cartridge</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>, <a class="var it3755" onMouseOver="hilite(3755)" onMouseOut="lolite()" onClick="logVariable('lti')" href="../../_variables/lti.html">$lti</a>) {
<a name="l2655"><span class="linenum">2655</span></a>      <a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a> = <a class="function" onClick="logFunction('lti_load_cartridge')" href="../../_functions/lti_load_cartridge.html" onMouseOver="funcPopup(event,'lti_load_cartridge')">lti_load_cartridge</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>,
<a name="l2656"><span class="linenum">2656</span></a>          array(
<a name="l2657"><span class="linenum">2657</span></a>              &quot;title&quot; =&gt; &quot;name&quot;,
<a name="l2658"><span class="linenum">2658</span></a>              &quot;launch_url&quot; =&gt; &quot;toolurl&quot;,
<a name="l2659"><span class="linenum">2659</span></a>              &quot;secure_launch_url&quot; =&gt; &quot;securetoolurl&quot;,
<a name="l2660"><span class="linenum">2660</span></a>              &quot;description&quot; =&gt; &quot;intro&quot;,
<a name="l2661"><span class="linenum">2661</span></a>              &quot;icon&quot; =&gt; &quot;icon&quot;,
<a name="l2662"><span class="linenum">2662</span></a>              &quot;secure_icon&quot; =&gt; &quot;secureicon&quot;
<a name="l2663"><span class="linenum">2663</span></a>          ),
<a name="l2664"><span class="linenum">2664</span></a>          array(
<a name="l2665"><span class="linenum">2665</span></a>              &quot;icon_url&quot; =&gt; &quot;extension_icon&quot;,
<a name="l2666"><span class="linenum">2666</span></a>              &quot;secure_icon_url&quot; =&gt; &quot;extension_secureicon&quot;
<a name="l2667"><span class="linenum">2667</span></a>          )
<a name="l2668"><span class="linenum">2668</span></a>      );
<a name="l2669"><span class="linenum">2669</span></a>  <span class="comment">    // If an activity name exists, unset the cartridge name so we don't override it.</span>
<a name="l2670"><span class="linenum">2670</span></a>      if (isset(<a class="var it3755" onMouseOver="hilite(3755)" onMouseOut="lolite()" onClick="logVariable('lti')" href="../../_variables/lti.html">$lti</a>-&gt;<a onClick="logVariable('name')" class="var it45050" onMouseOver="hilite(45050)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>)) {
<a name="l2671"><span class="linenum">2671</span></a>          unset(<a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['name']);
<a name="l2672"><span class="linenum">2672</span></a>      }
<a name="l2673"><span class="linenum">2673</span></a>  
<a name="l2674"><span class="linenum">2674</span></a>  <span class="comment">    // Always prefer cartridge core icons first, then, if none are found, look at the extension icons.</span>
<a name="l2675"><span class="linenum">2675</span></a>      if (empty(<a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['icon']) &amp;&amp; !empty(<a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['extension_icon'])) {
<a name="l2676"><span class="linenum">2676</span></a>          <a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['icon'] = <a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['extension_icon'];
<a name="l2677"><span class="linenum">2677</span></a>      }
<a name="l2678"><span class="linenum">2678</span></a>      unset(<a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['extension_icon']);
<a name="l2679"><span class="linenum">2679</span></a>  
<a name="l2680"><span class="linenum">2680</span></a>      if (empty(<a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['secureicon']) &amp;&amp; !empty(<a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['extension_secureicon'])) {
<a name="l2681"><span class="linenum">2681</span></a>          <a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['secureicon'] = <a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['extension_secureicon'];
<a name="l2682"><span class="linenum">2682</span></a>      }
<a name="l2683"><span class="linenum">2683</span></a>      unset(<a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>['extension_secureicon']);
<a name="l2684"><span class="linenum">2684</span></a>  
<a name="l2685"><span class="linenum">2685</span></a>      foreach (<a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a> as <a class="var it1414" onMouseOver="hilite(1414)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a> =&gt; <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l2686"><span class="linenum">2686</span></a>          <a class="var it3755" onMouseOver="hilite(3755)" onMouseOut="lolite()" onClick="logVariable('lti')" href="../../_variables/lti.html">$lti</a>-&gt;<a class="var it1414" onMouseOver="hilite(1414)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a> = <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l2687"><span class="linenum">2687</span></a>      }
<a name="l2688"><span class="linenum">2688</span></a>  }
<a name="l2689"><span class="linenum">2689</span></a>  
<a name="l2690"><span class="linenum">2690</span></a>  <span class="comment">/**</span>
<a name="l2691"><span class="linenum">2691</span></a>  <span class="comment"> * Search for a tag within an XML DOMDocument</span>
<a name="l2692"><span class="linenum">2692</span></a>  <span class="comment"> *</span>
<a name="l2693"><span class="linenum">2693</span></a>  <span class="comment"> * @param  string $url The url of the cartridge to be loaded</span>
<a name="l2694"><span class="linenum">2694</span></a>  <span class="comment"> * @param  array  $map The map of tags to keys in the return array</span>
<a name="l2695"><span class="linenum">2695</span></a>  <span class="comment"> * @param  array  $propertiesmap The map of properties to keys in the return array</span>
<a name="l2696"><span class="linenum">2696</span></a>  <span class="comment"> * @return array An associative array with the given keys and their values from the cartridge</span>
<a name="l2697"><span class="linenum">2697</span></a>  <span class="comment"> * @throws moodle_exception if the cartridge could not be loaded correctly</span>
<a name="l2698"><span class="linenum">2698</span></a>  <span class="comment"> * @since Moodle 3.1</span>
<a name="l2699"><span class="linenum">2699</span></a>  <span class="comment"> */</span>
<a name="l2700"><span class="linenum">2700</span></a>  function <a class="function" onClick="logFunction('lti_load_cartridge')" href="../../_functions/lti_load_cartridge.html" onMouseOver="funcPopup(event,'lti_load_cartridge')">lti_load_cartridge</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>, <a class="var it2071" onMouseOver="hilite(2071)" onMouseOut="lolite()" onClick="logVariable('map')" href="../../_variables/map.html">$map</a>, <a class="var it35809" onMouseOver="hilite(35809)" onMouseOut="lolite()" onClick="logVariable('propertiesmap')" href="../../_variables/propertiesmap.html">$propertiesmap</a> = array()) {
<a name="l2701"><span class="linenum">2701</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l2702"><span class="linenum">2702</span></a>      require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a>. &quot;/filelib.php&quot;);
<a name="l2703"><span class="linenum">2703</span></a>  
<a name="l2704"><span class="linenum">2704</span></a>      <a class="var it6381" onMouseOver="hilite(6381)" onMouseOut="lolite()" onClick="logVariable('curl')" href="../../_variables/curl.html">$curl</a> = <span class="keyword">new </span><a class="class" onClick="logClass('curl')" href="../../_classes/curl.html" onMouseOver="classPopup(event,'curl')">curl</a>();
<a name="l2705"><span class="linenum">2705</span></a>      <a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../_variables/response.html">$response</a> = <a class="var it6381" onMouseOver="hilite(6381)" onMouseOut="lolite()" onClick="logVariable('curl')" href="../../_variables/curl.html">$curl</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>);
<a name="l2706"><span class="linenum">2706</span></a>  
<a name="l2707"><span class="linenum">2707</span></a>  <span class="comment">    // TODO MDL-46023 Replace this code with a call to the new library.</span>
<a name="l2708"><span class="linenum">2708</span></a>      <a class="var it35810" onMouseOver="hilite(35810)" onMouseOut="lolite()" onClick="logVariable('origerrors')" href="../../_variables/origerrors.html">$origerrors</a> = libxml_use_internal_errors(true);
<a name="l2709"><span class="linenum">2709</span></a>      <a class="var it27355" onMouseOver="hilite(27355)" onMouseOut="lolite()" onClick="logVariable('origentity')" href="../../_variables/origentity.html">$origentity</a> = libxml_disable_entity_loader(true);
<a name="l2710"><span class="linenum">2710</span></a>      libxml_clear_errors();
<a name="l2711"><span class="linenum">2711</span></a>  
<a name="l2712"><span class="linenum">2712</span></a>      <a class="var it3847" onMouseOver="hilite(3847)" onMouseOut="lolite()" onClick="logVariable('document')" href="../../_variables/document.html">$document</a> = new DOMDocument();
<a name="l2713"><span class="linenum">2713</span></a>      @<a class="var it3847" onMouseOver="hilite(3847)" onMouseOut="lolite()" onClick="logVariable('document')" href="../../_variables/document.html">$document</a>-&gt;<a class="function" onClick="logFunction('loadXML')" href="../../_functions/loadxml.html" onMouseOver="funcPopup(event,'loadxml')">loadXML</a>(<a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../_variables/response.html">$response</a>, LIBXML_DTDLOAD | LIBXML_DTDATTR);
<a name="l2714"><span class="linenum">2714</span></a>  
<a name="l2715"><span class="linenum">2715</span></a>      <a class="var it29545" onMouseOver="hilite(29545)" onMouseOut="lolite()" onClick="logVariable('cartridge')" href="../../_variables/cartridge.html">$cartridge</a> = new DomXpath(<a class="var it3847" onMouseOver="hilite(3847)" onMouseOut="lolite()" onClick="logVariable('document')" href="../../_variables/document.html">$document</a>);
<a name="l2716"><span class="linenum">2716</span></a>  
<a name="l2717"><span class="linenum">2717</span></a>      <a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('errors')" href="../../_variables/errors.html">$errors</a> = libxml_get_errors();
<a name="l2718"><span class="linenum">2718</span></a>  
<a name="l2719"><span class="linenum">2719</span></a>      libxml_clear_errors();
<a name="l2720"><span class="linenum">2720</span></a>      libxml_use_internal_errors(<a class="var it35810" onMouseOver="hilite(35810)" onMouseOut="lolite()" onClick="logVariable('origerrors')" href="../../_variables/origerrors.html">$origerrors</a>);
<a name="l2721"><span class="linenum">2721</span></a>      libxml_disable_entity_loader(<a class="var it27355" onMouseOver="hilite(27355)" onMouseOut="lolite()" onClick="logVariable('origentity')" href="../../_variables/origentity.html">$origentity</a>);
<a name="l2722"><span class="linenum">2722</span></a>  
<a name="l2723"><span class="linenum">2723</span></a>      if (<a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('errors')" href="../../_variables/errors.html">$errors</a>) &gt; 0) {
<a name="l2724"><span class="linenum">2724</span></a>          <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../_variables/message.html">$message</a> = 'Failed to load cartridge.';
<a name="l2725"><span class="linenum">2725</span></a>          foreach (<a class="var it224" onMouseOver="hilite(224)" onMouseOut="lolite()" onClick="logVariable('errors')" href="../../_variables/errors.html">$errors</a> as <a class="var it275" onMouseOver="hilite(275)" onMouseOut="lolite()" onClick="logVariable('error')" href="../../_variables/error.html">$error</a>) {
<a name="l2726"><span class="linenum">2726</span></a>              <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../_variables/message.html">$message</a> .= &quot;\n&quot; . <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it275" onMouseOver="hilite(275)" onMouseOut="lolite()" onClick="logVariable('error')" href="../../_variables/error.html">$error</a>-&gt;<a onClick="logVariable('message')" class="var it43394" onMouseOver="hilite(43394)" onMouseOut="lolite()" href="../../_variables/message.html">message</a>, &quot;\n\r\t .&quot;) . &quot; at line &quot; . <a class="var it275" onMouseOver="hilite(275)" onMouseOut="lolite()" onClick="logVariable('error')" href="../../_variables/error.html">$error</a>-&gt;<a onClick="logVariable('line')" class="var it43394" onMouseOver="hilite(43394)" onMouseOut="lolite()" href="../../_variables/line.html">line</a>;
<a name="l2727"><span class="linenum">2727</span></a>          }
<a name="l2728"><span class="linenum">2728</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('errorreadingfile', '', '', <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>, <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../_variables/message.html">$message</a>);
<a name="l2729"><span class="linenum">2729</span></a>      }
<a name="l2730"><span class="linenum">2730</span></a>  
<a name="l2731"><span class="linenum">2731</span></a>      <a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a> = array();
<a name="l2732"><span class="linenum">2732</span></a>      foreach (<a class="var it2071" onMouseOver="hilite(2071)" onMouseOut="lolite()" onClick="logVariable('map')" href="../../_variables/map.html">$map</a> as <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a> =&gt; <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>) {
<a name="l2733"><span class="linenum">2733</span></a>          <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="function" onClick="logFunction('get_tag')" href="../../_functions/get_tag.html" onMouseOver="funcPopup(event,'get_tag')">get_tag</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>, <a class="var it29545" onMouseOver="hilite(29545)" onMouseOut="lolite()" onClick="logVariable('cartridge')" href="../../_variables/cartridge.html">$cartridge</a>);
<a name="l2734"><span class="linenum">2734</span></a>          if (<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l2735"><span class="linenum">2735</span></a>              <a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>] = <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l2736"><span class="linenum">2736</span></a>          }
<a name="l2737"><span class="linenum">2737</span></a>      }
<a name="l2738"><span class="linenum">2738</span></a>      if (!empty(<a class="var it35809" onMouseOver="hilite(35809)" onMouseOut="lolite()" onClick="logVariable('propertiesmap')" href="../../_variables/propertiesmap.html">$propertiesmap</a>)) {
<a name="l2739"><span class="linenum">2739</span></a>          foreach (<a class="var it35809" onMouseOver="hilite(35809)" onMouseOut="lolite()" onClick="logVariable('propertiesmap')" href="../../_variables/propertiesmap.html">$propertiesmap</a> as <a class="var it1414" onMouseOver="hilite(1414)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a> =&gt; <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>) {
<a name="l2740"><span class="linenum">2740</span></a>              <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="function" onClick="logFunction('get_tag')" href="../../_functions/get_tag.html" onMouseOver="funcPopup(event,'get_tag')">get_tag</a>(&quot;property&quot;, <a class="var it29545" onMouseOver="hilite(29545)" onMouseOut="lolite()" onClick="logVariable('cartridge')" href="../../_variables/cartridge.html">$cartridge</a>, <a class="var it1414" onMouseOver="hilite(1414)" onMouseOut="lolite()" onClick="logVariable('property')" href="../../_variables/property.html">$property</a>);
<a name="l2741"><span class="linenum">2741</span></a>              if (<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l2742"><span class="linenum">2742</span></a>                  <a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>] = <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l2743"><span class="linenum">2743</span></a>              }
<a name="l2744"><span class="linenum">2744</span></a>          }
<a name="l2745"><span class="linenum">2745</span></a>      }
<a name="l2746"><span class="linenum">2746</span></a>  
<a name="l2747"><span class="linenum">2747</span></a>      return <a class="var it35808" onMouseOver="hilite(35808)" onMouseOut="lolite()" onClick="logVariable('toolinfo')" href="../../_variables/toolinfo.html">$toolinfo</a>;
<a name="l2748"><span class="linenum">2748</span></a>  }
<a name="l2749"><span class="linenum">2749</span></a>  
<a name="l2750"><span class="linenum">2750</span></a>  <span class="comment">/**</span>
<a name="l2751"><span class="linenum">2751</span></a>  <span class="comment"> * Search for a tag within an XML DOMDocument</span>
<a name="l2752"><span class="linenum">2752</span></a>  <span class="comment"> *</span>
<a name="l2753"><span class="linenum">2753</span></a>  <span class="comment"> * @param  stdClass $tagname The name of the tag to search for</span>
<a name="l2754"><span class="linenum">2754</span></a>  <span class="comment"> * @param  XPath    $xpath   The XML to find the tag in</span>
<a name="l2755"><span class="linenum">2755</span></a>  <span class="comment"> * @param  XPath    $attribute The attribute to search for (if we should search for a child node with the given</span>
<a name="l2756"><span class="linenum">2756</span></a>  <span class="comment"> * value for the name attribute</span>
<a name="l2757"><span class="linenum">2757</span></a>  <span class="comment"> * @since Moodle 3.1</span>
<a name="l2758"><span class="linenum">2758</span></a>  <span class="comment"> */</span>
<a name="l2759"><span class="linenum">2759</span></a>  function <a class="function" onClick="logFunction('get_tag')" href="../../_functions/get_tag.html" onMouseOver="funcPopup(event,'get_tag')">get_tag</a>(<a class="var it2390" onMouseOver="hilite(2390)" onMouseOut="lolite()" onClick="logVariable('tagname')" href="../../_variables/tagname.html">$tagname</a>, <a class="var it248" onMouseOver="hilite(248)" onMouseOut="lolite()" onClick="logVariable('xpath')" href="../../_variables/xpath.html">$xpath</a>, <a class="var it1927" onMouseOver="hilite(1927)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> = null) {
<a name="l2760"><span class="linenum">2760</span></a>      if (<a class="var it1927" onMouseOver="hilite(1927)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a>) {
<a name="l2761"><span class="linenum">2761</span></a>          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = <a class="var it248" onMouseOver="hilite(248)" onMouseOut="lolite()" onClick="logVariable('xpath')" href="../../_variables/xpath.html">$xpath</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>('/<span class="comment">/*[local-name() = \'' . $tagname . '\'][@name=&quot;' . $attribute . '&quot;]');</span>
<a name="l2762"><span class="linenum">2762</span></a>  <span class="comment">    } else {</span>
<a name="l2763"><span class="linenum">2763</span></a>  <span class="comment">        $result = $xpath-&gt;query('//*[local-name() = \'' . $tagname . '\']');</span>
<a name="l2764"><span class="linenum">2764</span></a>  <span class="comment">    }</span>
<a name="l2765"><span class="linenum">2765</span></a>  <span class="comment">    if ($result-&gt;length &gt; 0) {</span>
<a name="l2766"><span class="linenum">2766</span></a>  <span class="comment">        return $result-&gt;item(0)-&gt;nodeValue;</span>
<a name="l2767"><span class="linenum">2767</span></a>  <span class="comment">    }</span>
<a name="l2768"><span class="linenum">2768</span></a>  <span class="comment">    return null;</span>
<a name="l2769"><span class="linenum">2769</span></a>  <span class="comment">}</span>
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'sign_request': ['sign_request', '', [['mod/lti','OAuth.php',464],['enrol/lti/ims-blti','OAuth.php',411]], 5],
'get_record': ['get_record', 'Load a single record. ', [['competency/classes','persistent.php',738],['lib/dml','moodle_database.php',1462]], 3224],
'lti_post_launch_html': ['lti_post_launch_html', 'Posts the launch petition HTML ', [['mod/lti','locallib.php',1888]], 2],
'lti_filter_tool_proxy_types': ['lti_filter_tool_proxy_types', 'Given an array of tool proxies, filter them based on their state ', [['mod/lti','locallib.php',1584]], 4],
'get_field': ['get_field', 'Gets an instance of the form field. ', [['lib/behat','behat_field_manager.php',248],['mod/quiz/report/statistics/classes','calculated.php',109],['lib/dml','moodle_database.php',1546],['user/filters','lib.php',124]], 536],
'lti_get_url_thumbprint': ['lti_get_url_thumbprint', '', [['mod/lti','locallib.php',1186]], 10],
'get_in_or_equal': ['get_in_or_equal', 'Constructs \'IN()\' or \'=\' sql fragment ', [['lib/dml','oci_native_moodle_database.php',1635],['lib/dml','moodle_database.php',711]], 438],
'pix_url': ['pix_url', 'Return the moodle_url for an image. ', [['lib','outputrenderers.php',237],['lib','outputlib.php',1394]], 367],
'lti_prepare_type_for_save': ['lti_prepare_type_for_save', '', [['mod/lti','locallib.php',1468]], 5],
'lti_get_launch_container': ['lti_get_launch_container', '', [['mod/lti','locallib.php',1959]], 3],
'lti_get_service_by_name': ['lti_get_service_by_name', 'Initializes an instance of the named service ', [['mod/lti','locallib.php',2200]], 3],
'lti_get_launch_data': ['lti_get_launch_data', 'Return the launch data required for opening the external tool. ', [['mod/lti','locallib.php',86]], 2],
'serialise_tool_type': ['serialise_tool_type', 'Serialises this tool type ', [['mod/lti','locallib.php',2486]], 2],
'get_string': ['get_string', 'Get String returns a requested string ', [['lib/classes','string_manager_install.php',95],['lib','moodlelib.php',6735],['lib','moodlelib.php',9695],['lib/external','externallib.php',102],['question/behaviour','behaviourbase.php',770],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38]], 20134],
'lti_get_tool_proxies_from_registration_url': ['lti_get_tool_proxies_from_registration_url', 'Get the tool proxy instance given its registration URL ', [['mod/lti','locallib.php',1617]], 1],
'lti_load_type_from_cartridge': ['lti_load_type_from_cartridge', 'Allows you to load settings for an external tool type from an IMS cartridge. ', [['mod/lti','locallib.php',2603]], 3],
'get_fieldset_select': ['get_fieldset_select', 'Selects records and return values of chosen field as an array which match a particular WHERE clause. ', [['lib/dml','moodle_database.php',1608]], 32],
'component_callback': ['component_callback', 'Invoke component\'s callback functions ', [['lib','moodlelib.php',7413]], 28],
'lti_sign_parameters': ['lti_sign_parameters', 'Signs the petition to launch the external tool using OAuth ', [['mod/lti','locallib.php',1862]], 2],
'lti_add_tool_proxy': ['lti_add_tool_proxy', 'Update the database with a tool proxy instance ', [['mod/lti','locallib.php',1693]], 2],
'lti_get_service_by_resource_id': ['lti_get_service_by_resource_id', 'Finds a service by id ', [['mod/lti','locallib.php',2219]], 1],
'lti_get_lti_types_by_course': ['lti_get_lti_types_by_course', 'Returns all lti types visible in this course ', [['mod/lti','locallib.php',1091]], 2],
'lti_get_tool_proxy_table': ['lti_get_tool_proxy_table', 'This function builds the tab for a category of tool proxies ', [['mod/lti','locallib.php',674]], 4],
'is_siteadmin': ['is_siteadmin', 'Check if the user is an admin at the site level. ', [['lib','accesslib.php',602]], 95],
'sesskey': ['sesskey', 'Makes sure that $USER->sesskey exists, if $USER itself exists. It sets a new sesskey if one does not already exist, but does not overwrite existing sesskeys. Returns the sesskey string if $USER exists, or boolean false if not. ', [['lib','sessionlib.php',28]], 641],
'getnamespaces': ['getnamespaces', 'Get the NAMESPACE information from the IMAP server (RFC 2342). ', [['lib/horde/framework/Horde/Imap/Client','Base.php',645],['lib/google/src/Google/Service','Proximitybeacon.php',1142]], 10],
'clean_param': ['clean_param', 'Used by {@link optional_param()} and {@link required_param()} to clean the variables and/or cast to specific types, based on an options field. <code> $course->format = clean_param($course->format, PARAM_ALPHA); $selectedgradeitem = clean_param($selectedgradeitem, PARAM_INT); </code> ', [['lib','moodlelib.php',769]], 635],
'empty_tag': ['empty_tag', 'Outputs an empty tag with attributes ', [['lib','outputcomponents.php',1106]], 522],
'lti_get_custom_parameters': ['lti_get_custom_parameters', 'Adds the custom parameters to an array ', [['mod/lti','locallib.php',839]], 3],
'random_string': ['random_string', 'Generate and return a random string of the specified length. ', [['lib','moodlelib.php',7736]], 42],
'format_string': ['format_string', 'Given a simple string, this function returns the string processed by enabled string filters if $CFG->filterall is enabled ', [['lib','weblib.php',1379]], 880],
'lti_set_state_for_type': ['lti_set_state_for_type', '', [['mod/lti','locallib.php',1309]], 4],
'lti_get_domain_from_url': ['lti_get_domain_from_url', '', [['mod/lti','locallib.php',1172]], 4],
'serialise_tool_proxy': ['serialise_tool_proxy', 'Serialises this tool proxy. ', [['mod/lti','locallib.php',2519]], 0],
'get_tool_type_edit_url': ['get_tool_type_edit_url', 'Returns the edit url for the given tool type ', [['mod/lti','locallib.php',2309]], 1],
'lti_get_tool_proxy_config': ['lti_get_tool_proxy_config', 'Generates some of the tool proxy configuration based on the admin configuration details ', [['mod/lti','locallib.php',1672]], 1],
'get_tool_type_icon_url': ['get_tool_type_icon_url', 'Returns the icon for the given tool type ', [['mod/lti','locallib.php',2286]], 1],
'lti_get_ims_role': ['lti_get_ims_role', 'Gets the IMS role string for the specified user and LTI course module. ', [['mod/lti','locallib.php',934]], 2],
'get_device_type': ['get_device_type', 'Returns the device type we believe is being used. ', [['lib/classes','useragent.php',149],['lib','deprecatedlib.php',1988]], 10],
'join': ['join', 'Join a room. For internal use by the Games SDK only. Calling this method directly is unsupported. (rooms.join) ', [['lib/google/src/Google/Service','Games.php',1716],['lib/google/src/Google/Service','Games.php',2100]], 1030],
'out': ['out', 'Returns the selector for use in a CSS rule ', [['lib','csslib.php',1540],['lib','csslib.php',1698],['lib','csslib.php',2078],['lib','csslib.php',2162],['lib','csslib.php',2306],['lib','csslib.php',2495],['lib','csslib.php',3240],['mod/feedback/classes','responses_table.php',332],['lib','moodlelib.php',9729],['lib','weblib.php',545],['lib','tablelib.php',1594],['report/loglive/classes','table_log_ajax.php',37]], 626],
'lti_load_tool_if_cartridge': ['lti_load_tool_if_cartridge', 'Loads the cartridge information into the new tool, if the launch url is for a cartridge file ', [['mod/lti','locallib.php',2559]], 3],
'format_module_intro': ['format_module_intro', 'Formats activity intro text ', [['lib','weblib.php',1542]], 65],
'from_consumer_and_token': ['from_consumer_and_token', 'pretty much a helper function to set up the request ', [['mod/lti','OAuth.php',302],['enrol/lti/ims-blti','OAuth.php',251]], 5],
'submit': ['submit', 'Submits a sitemap for a site. (sitemaps.submit) ', [['lib/google/src/Google/Service','Webmasters.php',408],['lib/google/src/Google/Service','Games.php',1893]], 77],
'get_tool_type_instance_ids': ['get_tool_type_instance_ids', 'Returns the ids of each instance of this tool type ', [['mod/lti','locallib.php',2473]], 1],
'set_tool_proxy': ['set_tool_proxy', 'Set the tool proxy object. ', [['mod/lti/classes/local/ltiservice','service_base.php',120]], 4],
'pix_icon': ['pix_icon', 'Return HTML for a pix_icon. ', [['lib','outputrenderers.php',2161]], 504],
'lti_get_tools_by_url': ['lti_get_tools_by_url', '', [['mod/lti','locallib.php',1018]], 1],
'get_parameters': ['get_parameters', '', [['mod/lti','OAuth.php',348],['enrol/lti/ims-blti','OAuth.php',295]], 3],
'get_tool_proxy_edit_url': ['get_tool_proxy_edit_url', 'Returns the edit url for the given tool proxy. ', [['mod/lti','locallib.php',2322]], 1],
'current_language': ['current_language', 'Returns the code for the current language ', [['lib','moodlelib.php',6589]], 44],
'lti_build_registration_request': ['lti_build_registration_request', 'Gets the parameters for the regirstration request ', [['mod/lti','locallib.php',294]], 2],
'instance': ['instance', 'Returns an instance of the cache_factor method. ', [['cache','disabledlib.php',171],['cache','disabledlib.php',296],['lib/classes','useragent.php',101],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',80],['lib/htmlpurifier/HTMLPurifier','URISchemeRegistry.php',9],['search/classes','manager.php',109],['cache','locallib.php',52],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',53],['lib/classes','plugin_manager.php',103],['lib/htmlpurifier','HTMLPurifier.php',251],['course/format','lib.php',156],['lib/classes/update','checker.php',62],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',31],['admin/tool/installaddon/classes','installer.php',40],['lib','modinfolib.php',373],['cache/classes','helper.php',76],['lib/tests','string_manager_standard_test.php',124],['lib/portfolio','exporter.php',251],['lib/classes/update','validator.php',88],['search/classes','document_factory.php',49],['lib','accesslib.php',6235],['lib','accesslib.php',6487],['lib','accesslib.php',6665],['lib','accesslib.php',6919],['lib','accesslib.php',7180],['lib','accesslib.php',7392],['backup/cc/cc_lib','cc_utils.php',387],['backup/cc/cc_lib','cc_utils.php',443],['lib','filterlib.php',80],['search/tests/fixtures','testable_core_search.php',43],['lib/tests/fixtures','testable_update_checker.php',45],['backup/cc','validator.php',35],['cache/classes','config.php',87],['cache/classes','factory.php',114],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',29]], 4647],
'lti_set_tool_settings': ['lti_set_tool_settings', 'Sets the tool settings ( ', [['mod/lti','locallib.php',1834]], 4],
'lti_build_standard_request': ['lti_build_standard_request', 'This function builds the standard parameters for an LTI 1 or 2 request that must be sent to the tool producer ', [['mod/lti','locallib.php',481]], 1],
'lti_launch_tool': ['lti_launch_tool', 'Launch an external tool activity. ', [['mod/lti','locallib.php',258]], 1],
'lti_log_response': ['lti_log_response', 'Log an LTI response. ', [['mod/lti','locallib.php',2070]], 1],
'get_plugin_list': ['get_plugin_list', 'Use when listing real plugins of one type. ', [['lib','deprecatedlib.php',150],['lib/classes','component.php',796],['admin/tool/monitor/classes','eventlist.php',176]], 191],
'lti_delete_type': ['lti_delete_type', 'Delete a Basic LTI configuration ', [['mod/lti','locallib.php',1289]], 4],
'lti_get_type_type_config': ['lti_get_type_type_config', 'Generates some of the tool configuration based on the admin configuration details ', [['mod/lti','locallib.php',1369]], 3],
'get_records_sql': ['get_records_sql', 'Get a number of records as an array of objects. ', [['lib/dml','pdo_moodle_database.php',309],['lib/dml','oci_native_moodle_database.php',1145],['lib/dml','pgsql_native_moodle_database.php',732],['lib/dml','mssql_native_moodle_database.php',805],['lib/dml','mysqli_native_moodle_database.php',1057],['lib/dml','sqlsrv_native_moodle_database.php',890],['lib/dml/tests','dml_test.php',5545]], 700],
'lti_get_tool_by_url_match': ['lti_get_tool_by_url_match', '', [['mod/lti','locallib.php',1180]], 6],
'lti_should_log_request': ['lti_should_log_request', 'Determines if we should try to log the request ', [['mod/lti','locallib.php',2006]], 1],
'lti_ensure_url_is_https': ['lti_ensure_url_is_https', '', [['mod/lti','locallib.php',1993]], 6],
'lti_get_tools_by_domain': ['lti_get_tools_by_domain', '', [['mod/lti','locallib.php',1024]], 1],
'lti_filter_get_types': ['lti_filter_get_types', 'Returns all basicLTI tools configured by the administrator ', [['mod/lti','locallib.php',1054]], 1],
'lti_load_type_if_cartridge': ['lti_load_type_if_cartridge', 'Loads the cartridge information into the tool type, if the launch url is for a cartridge file ', [['mod/lti','locallib.php',2547]], 5],
'userdate': ['userdate', 'Returns a formatted string that represents a date in user time. ', [['lib','moodlelib.php',2155],['lib/adodb','adodb.inc.php',2842],['lib/adodb','adodb.inc.php',3569]], 525],
'lti_build_sourcedid': ['lti_build_sourcedid', 'Build source ID ', [['mod/lti','locallib.php',326]], 3],
'get_fieldset_sql': ['get_fieldset_sql', 'Selects rows and return values of first column as array. ', [['lib/dml','pdo_moodle_database.php',288],['lib/dml','oci_native_moodle_database.php',1196],['lib/dml','pgsql_native_moodle_database.php',799],['lib/dml','mssql_native_moodle_database.php',839],['lib/dml','mysqli_native_moodle_database.php',1106],['lib/dml','sqlsrv_native_moodle_database.php',925],['lib/dml/tests','dml_test.php',5546]], 58],
'json_encode': ['json_encode', 'encodes an arbitrary variable into JSON format ', [['lib/minify/lib','FirePHP.php',1124]], 307],
'lti_get_best_tool_by_url': ['lti_get_best_tool_by_url', '', [['mod/lti','locallib.php',1207]], 1],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required, Some conversions and safety checks are carried out. Lobs are supported. If the return ID isn\'t required, then this just reports success as true/false. $data is an object containing needed data ', [['lib/dml','pdo_moodle_database.php',387],['lib/dml','oci_native_moodle_database.php',1297],['lib/dml','pgsql_native_moodle_database.php',889],['lib/dml','mssql_native_moodle_database.php',962],['lib/dml','mysqli_native_moodle_database.php',1185],['question/engine/upgrade','upgradelib.php',124],['lib/dml','sqlsrv_native_moodle_database.php',1045],['lib/dml/tests','dml_test.php',5548]], 1611],
'lti_load_cartridge': ['lti_load_cartridge', 'Search for a tag within an XML DOMDocument ', [['mod/lti','locallib.php',2690]], 3],
'get': ['get', 'Retrieves a variable reference from the context. ', [['lib/htmlpurifier/HTMLPurifier','Context.php',36],['cache/stores/static','lib.php',220],['cache','disabledlib.php',55],['search/classes','document.php',299],['lib/lessphp','Cache.php',27],['lib/google/src/Google/Service','DataTransfer.php',162],['lib/google/src/Google/Service','DataTransfer.php',208],['lib/minify/lib','JSMinPlus.php',1827],['lib/google/src/Google/Service','AdSense.php',1076],['lib/google/src/Google/Service','AdSense.php',1155],['lib/google/src/Google/Service','AdSense.php',1303],['lib/google/src/Google/Service','AdSense.php',1519],['lib/google/src/Google/Service','AdSense.php',1631],['lib/google/src/Google/Service','AdSense.php',1773],['lib/google/src/Google/Service','AdSense.php',2047],['lib/google/src/Google/Service','Replicapool.php',420],['lib/google/src/Google/Service','Replicapool.php',575],['lib/google/src/Google/Service','Tasks.php',323],['lib/google/src/Google/Service','Tasks.php',442],['lib/google/src/Google/Service','Partners.php',362],['lib/google/src/Google/Service','AndroidPublisher.php',1247],['lib/google/src/Google/Service','AndroidPublisher.php',1349],['lib/google/src/Google/Service','AndroidPublisher.php',1510],['lib/google/src/Google/Service','AndroidPublisher.php',1573],['lib/google/src/Google/Service','AndroidPublisher.php',1796],['lib/google/src/Google/Service','AndroidPublisher.php',1884],['lib/google/src/Google/Service','AndroidPublisher.php',1948],['lib/google/src/Google/Service','AndroidPublisher.php',2098],['lib/google/src/Google/Service','AndroidPublisher.php',2223],['lib/google/src/Google/Service','AndroidPublisher.php',2293],['lib/phpexcel/PHPExcel/Shared/JAMA','Matrix.php',146],['lib/google/src/Google/Service','YouTubeReporting.php',273],['lib/google/src/Google/Service','YouTubeReporting.php',326],['lib/google/src/Google/Service','Reseller.php',295],['lib/google/src/Google/Service','Reseller.php',458],['lib/google/src/Google/Cache','Memcache.php',74],['lib','filelib.php',3382],['lib','filelib.php',3630],['lib/google/src/Google/Service','Computeaccounts.php',432],['lib/google/src/Google/Service','Computeaccounts.php',512],['lib/google/src/Google/Service','Computeaccounts.php',683],['lib/htmlpurifier/HTMLPurifier','AttrTypes.php',64],['lib/google/src/Google/Service','MapsEngine.php',1530],['lib/google/src/Google/Service','MapsEngine.php',1709],['lib/google/src/Google/Service','MapsEngine.php',2006],['lib/google/src/Google/Service','MapsEngine.php',2268],['lib/google/src/Google/Service','MapsEngine.php',2360],['lib/google/src/Google/Service','MapsEngine.php',2666],['lib/google/src/Google/Service','MapsEngine.php',2927],['lib/google/src/Google/Service','MapsEngine.php',3118],['lib/google/src/Google/Cache','File.php',47],['cache/classes','dummystore.php',141],['lib/google/src/Google/Service','Dns.php',307],['lib/google/src/Google/Service','Dns.php',393],['lib/google/src/Google/Service','Dns.php',444],['cache/classes','loaders.php',278],['cache/classes','loaders.php',1422],['cache/classes','loaders.php',1731],['lib/google/src/Google/Service','Appengine.php',320],['lib/google/src/Google/Service','Appengine.php',368],['lib/google/src/Google/Service','Appengine.php',472],['lib/google/src/Google/Service','Appengine.php',525],['lib/google/src/Google/Service','Urlshortener.php',109],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Memory.php',74],['lib/google/src/Google/Service','AdExchangeBuyer.php',759],['lib/google/src/Google/Service','AdExchangeBuyer.php',829],['lib/google/src/Google/Service','AdExchangeBuyer.php',870],['lib/google/src/Google/Service','AdExchangeBuyer.php',952],['lib/google/src/Google/Service','AdExchangeBuyer.php',1041],['lib/google/src/Google/Service','AdExchangeBuyer.php',1111],['lib/google/src/Google/Service','AdExchangeBuyer.php',1251],['lib/google/src/Google/Service','AdExchangeBuyer.php',1293],['lib/google/src/Google/Service','AdExchangeBuyer.php',1417],['lib/google/src/Google/Service','AdExchangeBuyer.php',1471],['lib/google/src/Google/Service','AdExchangeBuyer.php',1576],['lib/google/src/Google/Service','Books.php',1456],['lib/google/src/Google/Service','Books.php',1625],['lib/google/src/Google/Service','Books.php',1677],['lib/google/src/Google/Service','Books.php',1752],['lib/google/src/Google/Service','Books.php',2086],['lib/google/src/Google/Service','Books.php',2205],['lib/google/src/Google/Service','Books.php',2262],['lib/google/src/Google/Service','Books.php',2345],['lib/google/src/Google/Service','Books.php',2418],['lib/google/src/Google/Service','Books.php',2450],['lib/google/src/Google/Service','Oauth2.php',165],['lib/google/src/Google/Service','Oauth2.php',202],['lib/google/src/Google/Service','Analytics.php',1988],['lib/google/src/Google/Service','Analytics.php',2037],['lib/google/src/Google/Service','Analytics.php',2084],['lib/google/src/Google/Service','Analytics.php',2308],['lib/google/src/Google/Service','Analytics.php',2422],['lib/google/src/Google/Service','Analytics.php',2550],['lib/google/src/Google/Service','Analytics.php',2670],['lib/google/src/Google/Service','Analytics.php',2763],['lib/google/src/Google/Service','Analytics.php',2889],['lib/google/src/Google/Service','Analytics.php',3108],['lib/google/src/Google/Service','Analytics.php',3245],['lib/google/src/Google/Service','Analytics.php',3336],['lib/google/src/Google/Service','Analytics.php',3422],['lib/google/src/Google/Service','Analytics.php',3533],['lib/google/src/Google/Service','Coordinate.php',509],['lib/google/src/Google/Service','Coordinate.php',689],['lib','oauthlib.php',302],['lib/horde/framework/Horde/Support','ConsistentHash.php',69],['lib/google/src/Google/Service','DeploymentManager.php',468],['lib/google/src/Google/Service','DeploymentManager.php',632],['lib/google/src/Google/Service','DeploymentManager.php',693],['lib/google/src/Google/Service','DeploymentManager.php',752],['lib/google/src/Google/Service','Blogger.php',945],['lib/google/src/Google/Service','Blogger.php',976],['lib/google/src/Google/Service','Blogger.php',1080],['lib/google/src/Google/Service','Blogger.php',1199],['lib/google/src/Google/Service','Blogger.php',1241],['lib/google/src/Google/Service','Blogger.php',1382],['lib/google/src/Google/Service','Blogger.php',1465],['lib/google/src/Google/Service','Blogger.php',1686],['lib/editor/tinymce/tiny_mce/3.5.11','tiny_mce_src.js',981],['lib/editor/tinymce/tiny_mce/3.5.11','tiny_mce_src.js',16595],['question/engine','states.php',116],['lib/google/src/Google/Service','Dataflow.php',292],['lib/horde/framework/Horde','Variables.php',135],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Template.php.in',58],['competency/classes','persistent.php',86],['lib/google/src/Google/Service','CloudUserAccounts.php',542],['lib/google/src/Google/Service','CloudUserAccounts.php',643],['lib/google/src/Google/Service','CloudUserAccounts.php',908],['lib/google/src/Google/Service','Cloudresourcemanager.php',248],['lib/google/src/Google/Service','Cloudresourcemanager.php',427],['lib/editor/tinymce/classes','plugin.php',447],['lib/simplepie/library/SimplePie/Parse','Date.php',567],['lib/google/src/Google/Service','TagManager.php',950],['lib/google/src/Google/Service','TagManager.php',1036],['lib/google/src/Google/Service','TagManager.php',1128],['lib/google/src/Google/Service','TagManager.php',1280],['lib/google/src/Google/Service','TagManager.php',1373],['lib/google/src/Google/Service','TagManager.php',1467],['lib/google/src/Google/Service','TagManager.php',1561],['lib/google/src/Google/Service','TagManager.php',1711],['mod/lesson','locallib.php',3248],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Cache.php',163],['lib/htmlpurifier/HTMLPurifier','PropertyList.php',34],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Cleanup.php',68],['lib/google/src/Google/Service','Replicapoolupdater.php',338],['lib/google/src/Google/Service','Replicapoolupdater.php',489],['lib/google/src/Google/Service','Bigquery.php',552],['lib/google/src/Google/Service','Bigquery.php',668],['lib/google/src/Google/Service','Bigquery.php',879],['lib/google/src/Google/Service','ShoppingContent.php',1066],['lib/google/src/Google/Service','ShoppingContent.php',1183],['lib/google/src/Google/Service','ShoppingContent.php',1283],['lib/google/src/Google/Service','ShoppingContent.php',1346],['lib/google/src/Google/Service','ShoppingContent.php',1464],['lib/google/src/Google/Service','ShoppingContent.php',1578],['lib/google/src/Google/Service','ShoppingContent.php',1773],['lib/google/src/Google/Service','ShoppingContent.php',1986],['lib/google/src/Google/Service','ShoppingContent.php',2063],['lib/google/src/Google/Service','Webmasters.php',371],['lib/google/src/Google/Service','Webmasters.php',464],['lib/google/src/Google/Service','Webmasters.php',540],['lib','navigationlib.php',384],['lib','navigationlib.php',836],['lib','navigationlib.php',2704],['lib','navigationlib.php',3139],['lib/google/src/Google/Service','Clouddebugger.php',399],['lib/htmlpurifier/HTMLPurifier','Config.php',161],['lib/portfolio','exporter.php',134],['lib/google/src/Google/Service','Container.php',329],['lib/google/src/Google/Service','Container.php',396],['backup/cc/cc_lib/gral_lib','cssparser.php',147],['lib/horde/framework/Horde/Support','Array.php',30],['lib/horde/framework/Horde/Imap/Client','Mailbox.php',46],['lib/google/src/Google/Service','Storage.php',1059],['lib/google/src/Google/Service','Storage.php',1175],['lib/google/src/Google/Service','Storage.php',1349],['lib/google/src/Google/Service','Storage.php',1476],['lib/google/src/Google/Service','Storage.php',1709],['cache/stores/memcache','lib.php',312],['lib/google/src/Google/Service','Genomics.php',660],['lib/google/src/Google/Service','Genomics.php',749],['lib/google/src/Google/Service','Genomics.php',918],['lib/google/src/Google/Service','Genomics.php',1007],['lib/google/src/Google/Service','Genomics.php',1185],['lib/google/src/Google/Service','Genomics.php',1268],['lib/google/src/Google/Service','Genomics.php',1340],['lib/google/src/Google/Service','Genomics.php',1475],['lib/google/src/Google/Service','Games.php',1220],['lib/google/src/Google/Service','Games.php',1339],['lib/google/src/Google/Service','Games.php',1441],['lib/google/src/Google/Service','Games.php',1699],['lib/google/src/Google/Service','Games.php',1806],['lib/google/src/Google/Service','Games.php',1948],['lib/google/src/Google/Service','Games.php',2082],['lib/google/src/Google/Service','Licensing.php',239],['lib/google/src/Google/Service','Fitness.php',417],['lib/google/src/Google/Service','Fitness.php',543],['lib/google/src/Google/Service','Reports.php',375],['lib/google/src/Google/Service','Reports.php',409],['lib/google/src/Google/Service','Gmail.php',779],['lib/google/src/Google/Service','Gmail.php',937],['lib/google/src/Google/Service','Gmail.php',1030],['lib/google/src/Google/Service','Gmail.php',1206],['lib/google/src/Google/Service','Gmail.php',1250],['lib/google/src/Google/Service','Taskqueue.php',264],['lib/google/src/Google/Service','Taskqueue.php',308],['lib/mustache/src/Mustache','HelperCollection.php',81],['cache/classes','interfaces.php',41],['lib/google/src/Google/Service','Doubleclicksearch.php',257],['lib/google/src/Google/Service','Doubleclicksearch.php',381],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Mongo.php',105],['lib/google/src/Google/Service','Autoscaler.php',331],['lib/google/src/Google/Service','Autoscaler.php',445],['lib/google/src/Google/Service','AdExchangeSeller.php',444],['lib/google/src/Google/Service','AdExchangeSeller.php',552],['lib/google/src/Google/Service','AdExchangeSeller.php',666],['lib/horde/framework/Horde/Imap/Client','Cache.php',88],['lib/google/src/Google/Service','Prediction.php',276],['lib/behat/classes','behat_context_helper.php',63],['lib/google/src/Google/Service','SiteVerification.php',152],['lib/google/src/Google/Service','Drive.php',1333],['lib/google/src/Google/Service','Drive.php',1369],['lib/google/src/Google/Service','Drive.php',1422],['lib/google/src/Google/Service','Drive.php',1536],['lib/google/src/Google/Service','Drive.php',1617],['lib/google/src/Google/Service','Drive.php',1792],['lib/google/src/Google/Service','Drive.php',2054],['lib/google/src/Google/Service','Drive.php',2124],['lib/google/src/Google/Service','Drive.php',2256],['lib/google/src/Google/Service','Drive.php',2350],['lib/google/src/Google/Service','Drive.php',2418],['lib/google/src/Google/Service','Drive.php',2537],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Decorator.php',79],['lib/google/src/Google/Service','Proximitybeacon.php',348],['lib/google/src/Google/Service','Groupssettings.php',108],['lib/google/src/Google/Service','Directory.php',1698],['lib/google/src/Google/Service','Directory.php',1766],['lib/google/src/Google/Service','Directory.php',1860],['lib/google/src/Google/Service','Directory.php',1930],['lib/google/src/Google/Service','Directory.php',2003],['lib/google/src/Google/Service','Directory.php',2072],['lib/google/src/Google/Service','Directory.php',2238],['lib/google/src/Google/Service','Directory.php',2365],['lib/google/src/Google/Service','Directory.php',2435],['lib/google/src/Google/Service','Directory.php',2531],['lib/google/src/Google/Service','Directory.php',2666],['lib/google/src/Google/Service','Directory.php',2745],['lib/google/src/Google/Service','Directory.php',2850],['lib/google/src/Google/Service','Directory.php',2954],['lib/google/src/Google/Service','Directory.php',3012],['lib/google/src/Google/Service','Directory.php',3287],['lib/google/src/Google/Service','Fusiontables.php',659],['lib/google/src/Google/Service','Fusiontables.php',826],['lib/google/src/Google/Service','Fusiontables.php',950],['lib/google/src/Google/Service','Fusiontables.php',1141],['lib/google/src/Google/Service','Fusiontables.php',1202],['lib/google/src/Google/Service','AdSenseHost.php',645],['lib/google/src/Google/Service','AdSenseHost.php',686],['lib/google/src/Google/Service','AdSenseHost.php',751],['lib/google/src/Google/Service','AdSenseHost.php',918],['lib/google/src/Google/Service','AdSenseHost.php',1026],['lib/google/src/Google/Service','Plus.php',343],['lib/google/src/Google/Service','Plus.php',418],['lib/google/src/Google/Service','Plus.php',525],['lib/google/src/Google/Service','Mirror.php',438],['lib/google/src/Google/Service','Mirror.php',523],['lib/google/src/Google/Service','Mirror.php',563],['lib/google/src/Google/Service','Mirror.php',674],['lib/google/src/Google/Service','Mirror.php',786],['lib/google/src/Google/Service','AndroidEnterprise.php',1002],['lib/google/src/Google/Service','AndroidEnterprise.php',1109],['lib/google/src/Google/Service','AndroidEnterprise.php',1196],['lib/google/src/Google/Service','AndroidEnterprise.php',1312],['lib/google/src/Google/Service','AndroidEnterprise.php',1432],['lib/google/src/Google/Service','AndroidEnterprise.php',1524],['lib/google/src/Google/Service','AndroidEnterprise.php',1616],['lib/google/src/Google/Service','AndroidEnterprise.php',1705],['lib/google/src/Google/Service','AndroidEnterprise.php',1777],['lib/google/src/Google/Service','AndroidEnterprise.php',1879],['lib/htmlpurifier/HTMLPurifier','DoctypeRegistry.php',76],['lib/testing/classes','nasty_strings.php',73],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Null.php',52],['lib/google/src/Google/Service','Playmoviespartner.php',411],['lib/google/src/Google/Service','Playmoviespartner.php',475],['lib/google/src/Google/Service','Playmoviespartner.php',580],['lib','coursecatlib.php',212],['lib/google/src/Google/Service','Cloudtrace.php',217],['lib/editor/tinymce/tiny_mce/3.5.11/plugins/media/js','media.js',7],['tag/classes','tag.php',190],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Db.php',65],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Null.php',27],['competency/classes','url.php',55],['lib/portfolio','caller.php',170],['lib/portfolio','caller.php',538],['lib/google/src/Google/Service','Calendar.php',919],['lib/google/src/Google/Service','Calendar.php',1086],['lib/google/src/Google/Service','Calendar.php',1285],['lib/google/src/Google/Service','Calendar.php',1387],['lib/google/src/Google/Service','Calendar.php',1431],['lib/google/src/Google/Service','Calendar.php',1873],['lib/horde/framework/Horde/Imap/Client/Fetch','Results.php',78],['cache/stores/session','lib.php',225],['lib/google/src/Google/Service','Cloudbilling.php',162],['lib/google/src/Google/Service','PlusDomains.php',468],['lib/google/src/Google/Service','PlusDomains.php',593],['lib/google/src/Google/Service','PlusDomains.php',719],['lib/google/src/Google/Service','PlusDomains.php',813],['lib/google/src/Google/Service','Storagetransfer.php',248],['lib/google/src/Google/Service','Storagetransfer.php',295],['lib/google/src/Google/Service','Storagetransfer.php',396],['cache/stores/mongodb','lib.php',252],['lib/google/src/Google/Cache','Null.php',36],['lib/google/src/Google/Service','GamesConfiguration.php',265],['lib/google/src/Google/Service','GamesConfiguration.php',404],['cache/stores/file','lib.php',330],['cache/stores/memcached','lib.php',319],['lib/google/src/Google/Service','AppState.php',171],['lib/google/src/Google/Service','Resourceviews.php',354],['lib/google/src/Google/Service','Resourceviews.php',439],['lib/portfolio','plugin.php',631],['lib/google/src/Google/Service','Classroom.php',484],['lib/google/src/Google/Service','Classroom.php',724],['lib/google/src/Google/Service','Classroom.php',830],['lib/google/src/Google/Service','Classroom.php',951],['lib/google/src/Google/Service','Classroom.php',1010],['lib/google/src/Google/Service','SQLAdmin.php',804],['lib/google/src/Google/Service','SQLAdmin.php',874],['lib/google/src/Google/Service','SQLAdmin.php',1076],['lib/google/src/Google/Service','SQLAdmin.php',1298],['lib/google/src/Google/Service','SQLAdmin.php',1387],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Serializer.php',67],['lib/google/src/Google/Service','Compute.php',4037],['lib/google/src/Google/Service','Compute.php',4166],['lib/google/src/Google/Service','Compute.php',4299],['lib/google/src/Google/Service','Compute.php',4460],['lib/google/src/Google/Service','Compute.php',4590],['lib/google/src/Google/Service','Compute.php',4686],['lib/google/src/Google/Service','Compute.php',4845],['lib/google/src/Google/Service','Compute.php',4957],['lib/google/src/Google/Service','Compute.php',5048],['lib/google/src/Google/Service','Compute.php',5188],['lib/google/src/Google/Service','Compute.php',5264],['lib/google/src/Google/Service','Compute.php',5394],['lib/google/src/Google/Service','Compute.php',5542],['lib/google/src/Google/Service','Compute.php',5726],['lib/google/src/Google/Service','Compute.php',6001],['lib/google/src/Google/Service','Compute.php',6171],['lib/google/src/Google/Service','Compute.php',6369],['lib/google/src/Google/Service','Compute.php',6595],['lib/google/src/Google/Service','Compute.php',6655],['lib/google/src/Google/Service','Compute.php',6732],['lib/google/src/Google/Service','Compute.php',6808],['lib/google/src/Google/Service','Compute.php',6914],['lib/google/src/Google/Service','Compute.php',6977],['lib/google/src/Google/Service','Compute.php',7052],['lib/google/src/Google/Service','Compute.php',7148],['lib/google/src/Google/Service','Compute.php',7223],['lib/google/src/Google/Service','Compute.php',7315],['lib/google/src/Google/Service','Compute.php',7425],['lib/google/src/Google/Service','Compute.php',7586],['lib/google/src/Google/Service','Compute.php',7750],['lib/google/src/Google/Service','Compute.php',7955],['lib/google/src/Google/Service','Compute.php',8050],['lib/google/src/Google/Service','Compute.php',8226],['lib/google/src/Google/Service','Compute.php',8321],['lib/google/src/Google/Service','Compute.php',8384],['lib/google/src/Google/Service','Pubsub.php',255],['lib/google/src/Google/Service','Pubsub.php',394],['lib/google/src/Google/Cache','Apc.php',52],['lib/google/src/Google/Service','Dfareporting.php',4559],['lib/google/src/Google/Service','Dfareporting.php',4587],['lib/google/src/Google/Service','Dfareporting.php',4629],['lib/google/src/Google/Service','Dfareporting.php',4671],['lib/google/src/Google/Service','Dfareporting.php',4779],['lib/google/src/Google/Service','Dfareporting.php',4867],['lib/google/src/Google/Service','Dfareporting.php',5014],['lib/google/src/Google/Service','Dfareporting.php',5117],['lib/google/src/Google/Service','Dfareporting.php',5308],['lib/google/src/Google/Service','Dfareporting.php',5427],['lib/google/src/Google/Service','Dfareporting.php',5525],['lib/google/src/Google/Service','Dfareporting.php',5580],['lib/google/src/Google/Service','Dfareporting.php',5683],['lib/google/src/Google/Service','Dfareporting.php',5769],['lib/google/src/Google/Service','Dfareporting.php',5891],['lib/google/src/Google/Service','Dfareporting.php',5997],['lib/google/src/Google/Service','Dfareporting.php',6105],['lib/google/src/Google/Service','Dfareporting.php',6255],['lib/google/src/Google/Service','Dfareporting.php',6314],['lib/google/src/Google/Service','Dfareporting.php',6411],['lib/google/src/Google/Service','Dfareporting.php',6529],['lib/google/src/Google/Service','Dfareporting.php',6609],['lib/google/src/Google/Service','Dfareporting.php',6746],['lib/google/src/Google/Service','Dfareporting.php',6862],['lib/google/src/Google/Service','Dfareporting.php',6940],['lib/google/src/Google/Service','Dfareporting.php',7011],['lib/google/src/Google/Service','Dfareporting.php',7131],['lib/google/src/Google/Service','Dfareporting.php',7172],['lib/google/src/Google/Service','Dfareporting.php',7214],['lib/google/src/Google/Service','Dfareporting.php',7256],['lib/google/src/Google/Service','Dfareporting.php',7320],['lib/google/src/Google/Service','Dfareporting.php',7378],['lib/google/src/Google/Service','Dfareporting.php',7517],['lib/google/src/Google/Service','Dfareporting.php',7640],['lib/google/src/Google/Service','Dfareporting.php',7771],['lib/google/src/Google/Service','Dfareporting.php',7812],['lib/google/src/Google/Service','Dfareporting.php',7853],['lib/google/src/Google/Service','Dfareporting.php',7935],['lib/google/src/Google/Service','Dfareporting.php',7995],['lib/google/src/Google/Service','Dfareporting.php',8116],['lib/google/src/Google/Service','Dfareporting.php',8258],['lib/google/src/Google/Service','Dfareporting.php',8307],['lib/google/src/Google/Service','Dfareporting.php',8421],['lib/google/src/Google/Service','Dfareporting.php',8482],['lib/google/src/Google/Service','Dfareporting.php',8584],['lib/google/src/Google/Service','Dfareporting.php',8643],['lib/google/src/Google/Service','Dfareporting.php',8682],['lib/google/src/Google/Service','Dfareporting.php',8724],['lib/google/src/Google/Service','Dfareporting.php',8782],['lib/google/src/Google/Service','Manager.php',259],['lib/google/src/Google/Service','Manager.php',338],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Hashtable.php',108],['lib','webdavlib.php',264]], 21532],
'lti_get_tool_table': ['lti_get_tool_table', '', [['mod/lti','locallib.php',572]], 3],
'lti_update_config': ['lti_update_config', 'Updates a tool configuration in the database ', [['mod/lti','locallib.php',1791]], 1],
'lti_map_keyname': ['lti_map_keyname', 'Used for building the names of the different custom parameters ', [['mod/lti','locallib.php',914]], 2],
'get_tool_type_urls': ['get_tool_type_urls', 'Returns the icon and edit urls for the tool type and the course url if it is a course type. ', [['mod/lti','locallib.php',2351]], 1],
'lti_parse_custom_parameter': ['lti_parse_custom_parameter', 'Parse a custom parameter to replace any substitution variables ', [['mod/lti','locallib.php',862]], 2],
'lti_load_tool_from_cartridge': ['lti_load_tool_from_cartridge', 'Allows you to load in the configuration for an external tool from an IMS cartridge. ', [['mod/lti','locallib.php',2646]], 1],
'lti_get_type': ['lti_get_type', '', [['mod/lti','locallib.php',1953]], 11],
'clone': ['clone', '', [['lib/editor/tinymce/tiny_mce/3.5.11/plugins/media/js','media.js',11]], 370],
'lti_delete_tool_proxy': ['lti_delete_tool_proxy', 'Delete a Tool Proxy ', [['mod/lti','locallib.php',1763]], 3],
'get_records': ['get_records', 'Load a list of records. ', [['competency/classes','persistent.php',709],['mod/glossary/classes','entry_query_builder.php',295],['lib/dml','moodle_database.php',1285],['lib','coursecatlib.php',651],['question','category_class.php',63]], 965],
'sql_compare_text': ['sql_compare_text', 'Returns the SQL text to be used to compare one TEXT (clob) column with one varchar column, because some RDBMS doesn\'t support such direct comparisons. ', [['lib/dml','moodle_database.php',2040]], 95],
'query': ['query', 'Retrieve your YouTube Analytics reports. (reports.query) ', [['lib/google/src/Google/Service','YouTubeAnalytics.php',574],['lib/google/src/Google/Service','Bigquery.php',753],['lib/google/src/Google/Service','Webmasters.php',320],['lib/google/src/Google/Service','Webmasters.php',504],['repository/googledocs','lib.php',288],['lib/adodb','adodb.inc.php',903],['lib/google/src/Google/Service','Calendar.php',1847],['lib/google/src/Google/Service','Dfareporting.php',6223],['lib/google/src/Google/Service','Dfareporting.php',8230]], 282],
'lti_get_enabled_capabilities': ['lti_get_enabled_capabilities', 'Extracts the enabled capabilities into an array, including those implicitly declared in a parameter ', [['mod/lti','locallib.php',772]], 3],
'lti_register': ['lti_register', 'Prepares an LTI registration request message ', [['mod/lti','locallib.php',274]], 1],
'lti_split_custom_parameters': ['lti_split_custom_parameters', 'Splits the custom parameters field to the various parameters ', [['mod/lti','locallib.php',805]], 7],
'lti_get_configured_types': ['lti_get_configured_types', 'Returns a list of configured types in the given course ', [['mod/lti','locallib.php',1136]], 1],
'lti_build_request_lti2': ['lti_build_request_lti2', 'This function builds the request that must be sent to an LTI 2 tool provider ', [['mod/lti','locallib.php',452]], 1],
'lti_force_type_config_settings': ['lti_force_type_config_settings', 'Enforce type config settings onto the LTI instance ', [['mod/lti','locallib.php',2121]], 2],
'list': ['list', '', [['mod/data/preset/imagegallery','jstemplate.js',9]], 2229],
'xpath': ['xpath', 'Runs XPath query on XML data ', [['lib/spout/src/Spout/Reader/Wrapper','SimpleXMLElement.php',77]], 32],
'html_to_text': ['html_to_text', 'Given HTML text, make it into plain text using external function ', [['lib','weblib.php',1947],['question/type','questionbase.php',367]], 65],
'lti_get_types_for_add_instance': ['lti_get_types_for_add_instance', 'Returns tool types for lti add instance and edit page ', [['mod/lti','locallib.php',1117]], 1],
'lti_is_cartridge': ['lti_is_cartridge', 'Determines if the given url is for a IMS basic cartridge ', [['mod/lti','locallib.php',2571]], 4],
'get_tool_type_capability_groups': ['get_tool_type_capability_groups', 'Returns a summary of each LTI capability this tool type requires in plain language ', [['mod/lti','locallib.php',2433]], 1],
'registerxpathnamespace': ['registerxpathnamespace', 'Creates a prefix/ns context for the next XPath query ', [['lib/spout/src/Spout/Reader/Wrapper','SimpleXMLElement.php',63]], 15],
'lti_get_shared_secrets_by_key': ['lti_get_shared_secrets_by_key', '', [['mod/lti','locallib.php',1253]], 1],
'lti_request_is_using_ssl': ['lti_request_is_using_ssl', '', [['mod/lti','locallib.php',1988]], 5],
'lti_get_tool_proxy': ['lti_get_tool_proxy', 'Generates some of the tool proxy configuration based on the admin configuration details ', [['mod/lti','locallib.php',1634]], 7],
'lti_update_tool_proxy': ['lti_update_tool_proxy', 'Updates a tool proxy in the database ', [['mod/lti','locallib.php',1747]], 5],
'hash': ['hash', 'Expose the hash function for testing, probing, and extension. ', [['lib/horde/framework/Horde/Support','ConsistentHash.php',218],['mod/assign/feedback/editpdf/classes','document_services.php',100],['filter/censor','filter.php',47],['lib','filterlib.php',393],['lib/horde/framework/Horde/Imap/Client/Fetch','Query.php',288]], 195],
'lti_filter_tool_types': ['lti_filter_tool_types', 'Given an array of tools, filter them based on their state ', [['mod/lti','locallib.php',1074]], 3],
'param': ['param', '', [['lib/adodb/drivers','adodb-postgres64.inc.php',609],['lib','weblib.php',453],['lib/adodb/drivers','adodb-oci8po.inc.php',39],['lib/adodb','adodb.inc.php',934],['lib/adodb/drivers','adodb-oci8.inc.php',1179],['lib/adodb/drivers','adodb-db2oci.inc.php',163]], 640],
'params': ['params', 'Add an array of params to the params for this url. ', [['lib','weblib.php',392],['question/classes/bank/search','condition.php',43],['question/classes/bank/search','category_condition.php',100]], 93],
'lti_build_custom_parameters': ['lti_build_custom_parameters', 'This function builds the custom parameters ', [['mod/lti','locallib.php',530]], 1],
'lti_get_tool_settings': ['lti_get_tool_settings', 'Gets the tool settings ', [['mod/lti','locallib.php',1813]], 9],
'lti_get_type_config_by_instance': ['lti_get_type_config_by_instance', 'Fetches LTI type configuration for an LTI instance ', [['mod/lti','locallib.php',2099]], 2],
'get_resources': ['get_resources', 'Get the resources for this service. ', [['mod/lti/service/toolsettings/classes/local/service','toolsettings.php',52],['mod/lti/service/profile/classes/local/service','profile.php',53],['backup/cc/cc_lib','cc_manifest.php',190],['mod/lti/service/toolproxy/classes/local/service','toolproxy.php',52],['backup/cc/cc_lib','cc_interfaces.php',32],['mod/lti/service/memberships/classes/local/service','memberships.php',61]], 6],
'strlen': ['strlen', 'Counts the number of characters. Unit-tested by Kasper (single byte charsets only) ', [['lib/typo3','class.t3lib_cs.php',1520],['lib/classes','text.php',305]], 1649],
'lti_add_config': ['lti_add_config', 'Add a tool configuration in the database ', [['mod/lti','locallib.php',1778]], 1],
'get_tool_proxy_urls': ['get_tool_proxy_urls', 'Returns the icon and edit urls for the tool proxy. ', [['mod/lti','locallib.php',2373]], 1],
'has_capability': ['has_capability', 'Wrapper round the has_capability funciton that automatically passes in the quiz context. ', [['mod/quiz','attemptlib.php',299],['mod/quiz','attemptlib.php',922],['lib','accesslib.php',344]], 2064],
'loadxml': ['loadxml', '', [['backup/cc/cc_lib','xmlbase.php',121]], 24],
'lti_get_capabilities': ['lti_get_capabilities', 'Initializes an array with the capabilities supported by the LTI module ', [['mod/lti','locallib.php',2141]], 4],
'lti_add_type': ['lti_add_type', '', [['mod/lti','locallib.php',1540]], 8],
'lti_update_type': ['lti_update_type', '', [['mod/lti','locallib.php',1502]], 4],
'lti_build_request': ['lti_build_request', 'This function builds the request that must be sent to the tool producer ', [['mod/lti','locallib.php',359]], 5],
'action_icon': ['action_icon', 'Renders an action_icon. ', [['course/classes','management_renderer.php',987],['lib','outputrenderers.php',1694]], 113],
'lti_get_fqid': ['lti_get_fqid', 'Converts an ID to a fully-qualified ID ', [['mod/lti','locallib.php',2265]], 2],
'get_tool_type_state_info': ['get_tool_type_state_info', 'Returns information on the current state of the tool type ', [['mod/lti','locallib.php',2391]], 1],
'get_exception_info': ['get_exception_info', 'Returns detailed information about specified exception. ', [['lib','setuplib.php',498],['lib/tests','setuplib_test.php',449]], 22],
'lti_get_services': ['lti_get_services', 'Initializes an array with the services supported by the LTI module ', [['mod/lti','locallib.php',2182]], 5],
'lti_get_type_config_from_instance': ['lti_get_type_config_from_instance', 'Generates some of the tool configuration based on the instance details ', [['mod/lti','locallib.php',1330]], 0],
'update_record': ['update_record', 'Update a record in a table ', [['lib/dml','pdo_moodle_database.php',461],['lib/dml','oci_native_moodle_database.php',1404],['lib/dml','pgsql_native_moodle_database.php',1089],['lib/dml','mssql_native_moodle_database.php',1067],['lib/dml','mysqli_native_moodle_database.php',1405],['lib/dml','sqlsrv_native_moodle_database.php',1148],['lib/dml/tests','dml_test.php',5551]], 650],
'lti_get_contexts': ['lti_get_contexts', 'Extracts the named contexts from a tool proxy ', [['mod/lti','locallib.php',2243]], 2],
'lti_get_type_config': ['lti_get_type_config', 'Returns configuration details for the tool ', [['mod/lti','locallib.php',979]], 9],
'lti_get_tool_proxy_from_guid': ['lti_get_tool_proxy_from_guid', 'Get the tool proxy instance given its GUID ', [['mod/lti','locallib.php',1602]], 1],
'get_site': ['get_site', 'Returns $course object of the top-level site. ', [['lib','datalib.php',547]], 77],
'delete_records': ['delete_records', 'Delete the records from a table where all the given conditions met. If conditions not specified, table is truncated. ', [['lib/dml','sqlite3_pdo_moodle_database.php',345],['lib/dml','moodle_database.php',1864]], 773],
'parse_value': ['parse_value', 'Parse a value for custom parameter substitution variables. ', [['mod/lti/service/memberships/classes/local/resource','linkmemberships.php',116],['mod/lti/service/toolsettings/classes/local/resource','contextsettings.php',159],['mod/lti/service/profile/classes/local/resource','profile.php',213],['mod/lti/service/toolsettings/classes/local/resource','linksettings.php',189],['mod/lti/classes/local/ltiservice','service_base.php',153],['mod/lti/service/toolsettings/classes/local/resource','systemsettings.php',138],['mod/lti/classes/local/ltiservice','resource_base.php',236],['mod/lti/service/memberships/classes/local/resource','contextmemberships.php',104]], 3],
'lti_get_tool_proxies': ['lti_get_tool_proxies', 'Returns lti tool proxies. ', [['mod/lti','locallib.php',1648]], 1],
'get_id': ['get_id', 'Getter for $id. ', [['lib/classes/task','adhoc_task.php',51],['backup/converter','convertlib.php',100],['lib/filebrowser','virtual_root_file.php',290],['lib','adminlib.php',1719],['admin/tool/uploadcourse/classes','course.php',335],['lib/simplepie/library/SimplePie','Item.php',199],['lib/filestorage','stored_file.php',786],['cache/classes','definition.php',613],['grade/grading/form','lib.php',854],['question/engine','questionusage.php',120],['mod/lti/classes/local/ltiservice','service_base.php',76],['blocks/rss_client/classes/output','item.php',152],['backup/controller','backup_controller.class.php',263],['question/engine','questionattemptstep.php',136],['mod/lti/classes/local/ltiservice','resource_base.php',81]], 2250],
'make_temp_directory': ['make_temp_directory', 'Create a directory under tempdir and make sure it is writable. ', [['lib','setuplib.php',1642]], 50],
'get_tool_type_course_url': ['get_tool_type_course_url', 'Returns the course url for the given tool type ', [['mod/lti','locallib.php',2335]], 1],
'lti_get_config': ['lti_get_config', 'Transforms a basic LTI object to an array ', [['mod/lti','locallib.php',1315]], 2],
'rebuild_course_cache': ['rebuild_course_cache', 'Rebuilds or resets the cached list of course activities stored in MUC. ', [['lib','modinfolib.php',2179]], 40],
'get_tag': ['get_tag', 'Search for a tag within an XML DOMDocument ', [['mod/lti','locallib.php',2750]], 2],
'format_backtrace': ['format_backtrace', 'Formats a backtrace ready for output. ', [['lib','setuplib.php',729]], 20],
'lti_log_request': ['lti_log_request', 'Logs the request to a file in temp dir. ', [['mod/lti','locallib.php',2049]], 1],
'stripos': ['stripos', '', [], 88],
'implode': ['implode', '', [], 1281],
'is_array': ['is_array', '', [], 1608],
'strpos': ['strpos', '', [], 1604],
'time': ['time', '', [], 1959],
'file_put_contents': ['file_put_contents', '', [], 94],
'count': ['count', '', [], 4095],
'define': ['define', '', [], 2373],
'uniqid': ['uniqid', '', [], 86],
'array_values': ['array_values', '', [], 342],
'trim': ['trim', '', [], 1948],
'is_null': ['is_null', '', [], 2003],
'array_map': ['array_map', '', [], 169],
'array_shift': ['array_shift', '', [], 700],
'substr': ['substr', '', [], 2823],
'array_push': ['array_push', '', [], 240],
'is_object': ['is_object', '', [], 544],
'parse_url': ['parse_url', '', [], 55],
'in_array': ['in_array', '', [], 1234],
'strtolower': ['strtolower', '', [], 817],
'explode': ['explode', '', [], 1572],
'chmod': ['chmod', '', [], 50],
'strstr': ['strstr', '', [], 54],
'defined': ['defined', '', [], 4731],
'array_reduce': ['array_reduce', '', [], 5],
'class_exists': ['class_exists', '', [], 279],
'array_merge': ['array_merge', '', [], 2944],
'get_headers': ['get_headers', '', [], 11],
'strval': ['strval', '', [], 151],
'str_split': ['str_split', '', [], 28],
'htmlspecialchars': ['htmlspecialchars', '', [], 215],
'date': ['date', '', [], 693],
'mt_rand': ['mt_rand', '', [], 47],
'str_replace': ['str_replace', '', [], 1648],
'array_keys': ['array_keys', '', [], 1256],
'preg_match': ['preg_match', '', [], 1286],
'get_object_vars': ['get_object_vars', '', [], 48],
'tempnam': ['tempnam', '', [], 31],
'array_key_exists': ['array_key_exists', '', [], 1445]};
CLASS_DATA={
'core_text': ['core_text', 'defines string api\'s for manipulating strings ', [['lib/classes','text.php',27]], 566],
'moodle_exception': ['moodle_exception', 'Base Moodle Exception class ', [['lib','setuplib.php',75]], 606],
'context_course': ['context_course', 'Course context class ', [['lib','accesslib.php',6817]], 1323],
'html_writer': ['html_writer', 'Simple html output class ', [['lib','outputcomponents.php',1062]], 5120],
'context_module': ['context_module', 'Course module context class ', [['lib','accesslib.php',7039]], 1106],
'oauthrequest': ['oauthrequest', '', [['mod/lti','OAuth.php',235],['enrol/lti/ims-blti','OAuth.php',178]], 14],
'moodle_url': ['moodle_url', 'Class for creating and manipulating urls. ', [['lib','weblib.php',238]], 3088],
'core_component': ['core_component', 'Collection of components related methods. ', [['lib/classes','component.php',41]], 511],
'oauthutil': ['oauthutil', '', [['mod/lti','OAuth.php',705],['enrol/lti/ims-blti','OAuth.php',672]], 44],
'curl': ['curl', 'RESTful cURL class ', [['lib','filelib.php',2656]], 74],
'core_useragent': ['core_useragent', 'The user agent class. ', [['lib/classes','useragent.php',25]], 159]};
CONST_DATA={
'LTI_SETTING_ALWAYS': ['LTI_SETTING_ALWAYS', '', [['mod/lti','locallib.php',79]], 14],
'LTI_TOOL_PROXY_STATE_REJECTED': ['LTI_TOOL_PROXY_STATE_REJECTED', '', [['mod/lti','locallib.php',76]], 4],
'LTI_TOOL_STATE_PENDING': ['LTI_TOOL_STATE_PENDING', '', [['mod/lti','locallib.php',69]], 6],
'LTI_LAUNCH_CONTAINER_EMBED': ['LTI_LAUNCH_CONTAINER_EMBED', '', [['mod/lti','locallib.php',62]], 6],
'LTI_SETTING_DELEGATE': ['LTI_SETTING_DELEGATE', '', [['mod/lti','locallib.php',80]], 15],
'PARAM_NOTAGS': ['PARAM_NOTAGS', '', [['lib','moodlelib.php',172]], 217],
'LTI_SETTING_NEVER': ['LTI_SETTING_NEVER', '', [['mod/lti','locallib.php',78]], 4],
'LTI_LAUNCH_CONTAINER_EMBED_NO_BLOCKS': ['LTI_LAUNCH_CONTAINER_EMBED_NO_BLOCKS', '', [['mod/lti','locallib.php',63]], 9],
'LTI_COURSEVISIBLE_NO': ['LTI_COURSEVISIBLE_NO', '', [['mod/lti','locallib.php',82]], 3],
'LTI_TOOL_PROXY_STATE_ACCEPTED': ['LTI_TOOL_PROXY_STATE_ACCEPTED', '', [['mod/lti','locallib.php',75]], 7],
'LTI_COURSEVISIBLE_ACTIVITYCHOOSER': ['LTI_COURSEVISIBLE_ACTIVITYCHOOSER', '', [['mod/lti','locallib.php',84]], 4],
'LTI_TOOL_PROXY_STATE_CONFIGURED': ['LTI_TOOL_PROXY_STATE_CONFIGURED', '', [['mod/lti','locallib.php',73]], 7],
'LTI_COURSEVISIBLE_PRECONFIGURED': ['LTI_COURSEVISIBLE_PRECONFIGURED', '', [['mod/lti','locallib.php',83]], 4],
'LTI_TOOL_PROXY_TAB': ['LTI_TOOL_PROXY_TAB', '', [['mod/lti','locallib.php',71]], 1],
'LTI_LAUNCH_CONTAINER_WINDOW': ['LTI_LAUNCH_CONTAINER_WINDOW', '', [['mod/lti','locallib.php',64]], 7],
'LTI_URL_DOMAIN_REGEX': ['LTI_URL_DOMAIN_REGEX', '', [['mod/lti','locallib.php',59]], 2],
'LTI_TOOL_STATE_ANY': ['LTI_TOOL_STATE_ANY', '', [['mod/lti','locallib.php',67]], 2],
'MOD_CLASS_ACTIVITY': ['MOD_CLASS_ACTIVITY', '', [['course','lib.php',55]], 6],
'SQL_PARAMS_NAMED': ['SQL_PARAMS_NAMED', '', [['lib/dml','moodle_database.php',32]], 315],
'PARAM_INT': ['PARAM_INT', '', [['lib','moodlelib.php',156]], 3812],
'LTI_LAUNCH_CONTAINER_DEFAULT': ['LTI_LAUNCH_CONTAINER_DEFAULT', '', [['mod/lti','locallib.php',61]], 6],
'LTI_TOOL_PROXY_STATE_PENDING': ['LTI_TOOL_PROXY_STATE_PENDING', '', [['mod/lti','locallib.php',74]], 9],
'LTI_TOOL_STATE_CONFIGURED': ['LTI_TOOL_STATE_CONFIGURED', '', [['mod/lti','locallib.php',68]], 16],
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',140],['','install.php',93],['lib','setup.php',391]], 4153],
'LTI_TOOL_STATE_REJECTED': ['LTI_TOOL_STATE_REJECTED', '', [['mod/lti','locallib.php',70]], 7]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Aug 11 10:00:09 2016</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
