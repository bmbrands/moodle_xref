<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /mod/quiz/report/reportlib.php source</title>
    <link rel="stylesheet" href="../../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu May 28 19:17:31 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../../';
subdir='mod/quiz/report';
filename='reportlib.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/mod/quiz/report/</a> -> <a href="reportlib.php.html">reportlib.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="reportlib.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="reportlib.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * Helper functions for the quiz reports.</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * @package   mod_quiz</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @copyright 2008 Jamie Pratt</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> */</span>
<a name="l24"><span class="linenum">  24</span></a>  
<a name="l25"><span class="linenum">  25</span></a>  
<a name="l26"><span class="linenum">  26</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../../../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die();
<a name="l27"><span class="linenum">  27</span></a>  
<a name="l28"><span class="linenum">  28</span></a>  require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../../_variables/dirroot.html">dirroot</a> . '<a class="filename" href="../../../mod/quiz/lib.php.html">/mod/quiz/lib.php</a>');
<a name="l29"><span class="linenum">  29</span></a>  require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../../_variables/libdir.html">libdir</a> . '/filelib.php');
<a name="l30"><span class="linenum">  30</span></a>  
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment">/**</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> * Takes an array of objects and constructs a multidimensional array keyed by</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> * the keys it finds on the object.</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> * @param array $datum an array of objects with properties on the object</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> * including the keys passed as the next param.</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment"> * @param array $keys Array of strings with the names of the properties on the</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment"> * objects in datum that you want to index the multidimensional array by.</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment"> * @param bool $keysunique If there is not only one object for each</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="comment"> * combination of keys you are using you should set $keysunique to true.</span>
<a name="l40"><span class="linenum">  40</span></a>  <span class="comment"> * Otherwise all the object will be added to a zero based array. So the array</span>
<a name="l41"><span class="linenum">  41</span></a>  <span class="comment"> * returned will have count($keys) + 1 indexs.</span>
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment"> * @return array multidimensional array properly indexed.</span>
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment"> */</span>
<a name="l44"><span class="linenum">  44</span></a>  function <a class="function" onClick="logFunction('quiz_report_index_by_keys')" href="../../../_functions/quiz_report_index_by_keys.html" onMouseOver="funcPopup(event,'quiz_report_index_by_keys')">quiz_report_index_by_keys</a>(<a class="var it10189" onMouseOver="hilite(10189)" onMouseOut="lolite()" onClick="logVariable('datum')" href="../../../_variables/datum.html">$datum</a>, <a class="var it1933" onMouseOver="hilite(1933)" onMouseOut="lolite()" onClick="logVariable('keys')" href="../../../_variables/keys.html">$keys</a>, <a class="var it17590" onMouseOver="hilite(17590)" onMouseOut="lolite()" onClick="logVariable('keysunique')" href="../../../_variables/keysunique.html">$keysunique</a> = true) {
<a name="l45"><span class="linenum">  45</span></a>      if (!<a class="var it10189" onMouseOver="hilite(10189)" onMouseOut="lolite()" onClick="logVariable('datum')" href="../../../_variables/datum.html">$datum</a>) {
<a name="l46"><span class="linenum">  46</span></a>          return array();
<a name="l47"><span class="linenum">  47</span></a>      }
<a name="l48"><span class="linenum">  48</span></a>      <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> = <a class="phpfunction" onClick="logFunction('array_shift')" href="../../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it1933" onMouseOver="hilite(1933)" onMouseOut="lolite()" onClick="logVariable('keys')" href="../../../_variables/keys.html">$keys</a>);
<a name="l49"><span class="linenum">  49</span></a>      <a class="var it17591" onMouseOver="hilite(17591)" onMouseOut="lolite()" onClick="logVariable('datumkeyed')" href="../../../_variables/datumkeyed.html">$datumkeyed</a> = array();
<a name="l50"><span class="linenum">  50</span></a>      foreach (<a class="var it10189" onMouseOver="hilite(10189)" onMouseOut="lolite()" onClick="logVariable('datum')" href="../../../_variables/datum.html">$datum</a> as <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a>) {
<a name="l51"><span class="linenum">  51</span></a>          if (<a class="var it1933" onMouseOver="hilite(1933)" onMouseOut="lolite()" onClick="logVariable('keys')" href="../../../_variables/keys.html">$keys</a> || !<a class="var it17590" onMouseOver="hilite(17590)" onMouseOut="lolite()" onClick="logVariable('keysunique')" href="../../../_variables/keysunique.html">$keysunique</a>) {
<a name="l52"><span class="linenum">  52</span></a>              <a class="var it17591" onMouseOver="hilite(17591)" onMouseOut="lolite()" onClick="logVariable('datumkeyed')" href="../../../_variables/datumkeyed.html">$datumkeyed</a>[<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a>-&gt;{<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>}][]= <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a>;
<a name="l53"><span class="linenum">  53</span></a>          } else {
<a name="l54"><span class="linenum">  54</span></a>              <a class="var it17591" onMouseOver="hilite(17591)" onMouseOut="lolite()" onClick="logVariable('datumkeyed')" href="../../../_variables/datumkeyed.html">$datumkeyed</a>[<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a>-&gt;{<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>}]= <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a>;
<a name="l55"><span class="linenum">  55</span></a>          }
<a name="l56"><span class="linenum">  56</span></a>      }
<a name="l57"><span class="linenum">  57</span></a>      if (<a class="var it1933" onMouseOver="hilite(1933)" onMouseOut="lolite()" onClick="logVariable('keys')" href="../../../_variables/keys.html">$keys</a>) {
<a name="l58"><span class="linenum">  58</span></a>          foreach (<a class="var it17591" onMouseOver="hilite(17591)" onMouseOut="lolite()" onClick="logVariable('datumkeyed')" href="../../../_variables/datumkeyed.html">$datumkeyed</a> as <a class="var it17592" onMouseOver="hilite(17592)" onMouseOut="lolite()" onClick="logVariable('datakey')" href="../../../_variables/datakey.html">$datakey</a> =&gt; <a class="var it17593" onMouseOver="hilite(17593)" onMouseOut="lolite()" onClick="logVariable('datakeyed')" href="../../../_variables/datakeyed.html">$datakeyed</a>) {
<a name="l59"><span class="linenum">  59</span></a>              <a class="var it17591" onMouseOver="hilite(17591)" onMouseOut="lolite()" onClick="logVariable('datumkeyed')" href="../../../_variables/datumkeyed.html">$datumkeyed</a>[<a class="var it17592" onMouseOver="hilite(17592)" onMouseOut="lolite()" onClick="logVariable('datakey')" href="../../../_variables/datakey.html">$datakey</a>] = <a class="function" onClick="logFunction('quiz_report_index_by_keys')" href="../../../_functions/quiz_report_index_by_keys.html" onMouseOver="funcPopup(event,'quiz_report_index_by_keys')">quiz_report_index_by_keys</a>(<a class="var it17593" onMouseOver="hilite(17593)" onMouseOut="lolite()" onClick="logVariable('datakeyed')" href="../../../_variables/datakeyed.html">$datakeyed</a>, <a class="var it1933" onMouseOver="hilite(1933)" onMouseOut="lolite()" onClick="logVariable('keys')" href="../../../_variables/keys.html">$keys</a>, <a class="var it17590" onMouseOver="hilite(17590)" onMouseOut="lolite()" onClick="logVariable('keysunique')" href="../../../_variables/keysunique.html">$keysunique</a>);
<a name="l60"><span class="linenum">  60</span></a>          }
<a name="l61"><span class="linenum">  61</span></a>      }
<a name="l62"><span class="linenum">  62</span></a>      return <a class="var it17591" onMouseOver="hilite(17591)" onMouseOut="lolite()" onClick="logVariable('datumkeyed')" href="../../../_variables/datumkeyed.html">$datumkeyed</a>;
<a name="l63"><span class="linenum">  63</span></a>  }
<a name="l64"><span class="linenum">  64</span></a>  
<a name="l65"><span class="linenum">  65</span></a>  function <a class="function" onClick="logFunction('quiz_report_unindex')" href="../../../_functions/quiz_report_unindex.html" onMouseOver="funcPopup(event,'quiz_report_unindex')">quiz_report_unindex</a>(<a class="var it10189" onMouseOver="hilite(10189)" onMouseOut="lolite()" onClick="logVariable('datum')" href="../../../_variables/datum.html">$datum</a>) {
<a name="l66"><span class="linenum">  66</span></a>      if (!<a class="var it10189" onMouseOver="hilite(10189)" onMouseOut="lolite()" onClick="logVariable('datum')" href="../../../_variables/datum.html">$datum</a>) {
<a name="l67"><span class="linenum">  67</span></a>          return <a class="var it10189" onMouseOver="hilite(10189)" onMouseOut="lolite()" onClick="logVariable('datum')" href="../../../_variables/datum.html">$datum</a>;
<a name="l68"><span class="linenum">  68</span></a>      }
<a name="l69"><span class="linenum">  69</span></a>      <a class="var it17594" onMouseOver="hilite(17594)" onMouseOut="lolite()" onClick="logVariable('datumunkeyed')" href="../../../_variables/datumunkeyed.html">$datumunkeyed</a> = array();
<a name="l70"><span class="linenum">  70</span></a>      foreach (<a class="var it10189" onMouseOver="hilite(10189)" onMouseOut="lolite()" onClick="logVariable('datum')" href="../../../_variables/datum.html">$datum</a> as <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../_variables/value.html">$value</a>) {
<a name="l71"><span class="linenum">  71</span></a>          if (<a class="phpfunction" onClick="logFunction('is_array')" href="../../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../_variables/value.html">$value</a>)) {
<a name="l72"><span class="linenum">  72</span></a>              <a class="var it17594" onMouseOver="hilite(17594)" onMouseOut="lolite()" onClick="logVariable('datumunkeyed')" href="../../../_variables/datumunkeyed.html">$datumunkeyed</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it17594" onMouseOver="hilite(17594)" onMouseOut="lolite()" onClick="logVariable('datumunkeyed')" href="../../../_variables/datumunkeyed.html">$datumunkeyed</a>, <a class="function" onClick="logFunction('quiz_report_unindex')" href="../../../_functions/quiz_report_unindex.html" onMouseOver="funcPopup(event,'quiz_report_unindex')">quiz_report_unindex</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../_variables/value.html">$value</a>));
<a name="l73"><span class="linenum">  73</span></a>          } else {
<a name="l74"><span class="linenum">  74</span></a>              <a class="var it17594" onMouseOver="hilite(17594)" onMouseOut="lolite()" onClick="logVariable('datumunkeyed')" href="../../../_variables/datumunkeyed.html">$datumunkeyed</a>[] = <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../_variables/value.html">$value</a>;
<a name="l75"><span class="linenum">  75</span></a>          }
<a name="l76"><span class="linenum">  76</span></a>      }
<a name="l77"><span class="linenum">  77</span></a>      return <a class="var it17594" onMouseOver="hilite(17594)" onMouseOut="lolite()" onClick="logVariable('datumunkeyed')" href="../../../_variables/datumunkeyed.html">$datumunkeyed</a>;
<a name="l78"><span class="linenum">  78</span></a>  }
<a name="l79"><span class="linenum">  79</span></a>  
<a name="l80"><span class="linenum">  80</span></a>  <span class="comment">/**</span>
<a name="l81"><span class="linenum">  81</span></a>  <span class="comment"> * Are there any questions in this quiz?</span>
<a name="l82"><span class="linenum">  82</span></a>  <span class="comment"> * @param int $quizid the quiz id.</span>
<a name="l83"><span class="linenum">  83</span></a>  <span class="comment"> */</span>
<a name="l84"><span class="linenum">  84</span></a>  function <a class="function" onClick="logFunction('quiz_has_questions')" href="../../../_functions/quiz_has_questions.html" onMouseOver="funcPopup(event,'quiz_has_questions')">quiz_has_questions</a>(<a class="var it1069" onMouseOver="hilite(1069)" onMouseOut="lolite()" onClick="logVariable('quizid')" href="../../../_variables/quizid.html">$quizid</a>) {
<a name="l85"><span class="linenum">  85</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l86"><span class="linenum">  86</span></a>      return <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('record_exists')" href="../../../_functions/record_exists.html" onMouseOver="funcPopup(event,'record_exists')">record_exists</a>('quiz_slots', array('quizid' =&gt; <a class="var it1069" onMouseOver="hilite(1069)" onMouseOut="lolite()" onClick="logVariable('quizid')" href="../../../_variables/quizid.html">$quizid</a>));
<a name="l87"><span class="linenum">  87</span></a>  }
<a name="l88"><span class="linenum">  88</span></a>  
<a name="l89"><span class="linenum">  89</span></a>  <span class="comment">/**</span>
<a name="l90"><span class="linenum">  90</span></a>  <span class="comment"> * Get the slots of real questions (not descriptions) in this quiz, in order.</span>
<a name="l91"><span class="linenum">  91</span></a>  <span class="comment"> * @param object $quiz the quiz.</span>
<a name="l92"><span class="linenum">  92</span></a>  <span class="comment"> * @return array of slot =&gt; $question object with fields</span>
<a name="l93"><span class="linenum">  93</span></a>  <span class="comment"> *      -&gt;slot, -&gt;id, -&gt;maxmark, -&gt;number, -&gt;length.</span>
<a name="l94"><span class="linenum">  94</span></a>  <span class="comment"> */</span>
<a name="l95"><span class="linenum">  95</span></a>  function <a class="function" onClick="logFunction('quiz_report_get_significant_questions')" href="../../../_functions/quiz_report_get_significant_questions.html" onMouseOver="funcPopup(event,'quiz_report_get_significant_questions')">quiz_report_get_significant_questions</a>(<a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>) {
<a name="l96"><span class="linenum">  96</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l97"><span class="linenum">  97</span></a>  
<a name="l98"><span class="linenum">  98</span></a>      <a class="var it17595" onMouseOver="hilite(17595)" onMouseOut="lolite()" onClick="logVariable('qsbyslot')" href="../../../_variables/qsbyslot.html">$qsbyslot</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(&quot;
<a name="l99"><span class="linenum">  99</span></a>              SELECT slot.slot,
<a name="l100"><span class="linenum"> 100</span></a>                     q.id,
<a name="l101"><span class="linenum"> 101</span></a>                     q.length,
<a name="l102"><span class="linenum"> 102</span></a>                     slot.maxmark
<a name="l103"><span class="linenum"> 103</span></a>  
<a name="l104"><span class="linenum"> 104</span></a>                FROM {question} q
<a name="l105"><span class="linenum"> 105</span></a>                JOIN {quiz_slots} slot ON slot.questionid = q.id
<a name="l106"><span class="linenum"> 106</span></a>  
<a name="l107"><span class="linenum"> 107</span></a>               WHERE slot.quizid = ?
<a name="l108"><span class="linenum"> 108</span></a>                 AND q.length &gt; 0
<a name="l109"><span class="linenum"> 109</span></a>  
<a name="l110"><span class="linenum"> 110</span></a>            ORDER BY slot.slot&quot;, array(<a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it39928" onMouseOver="hilite(39928)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>));
<a name="l111"><span class="linenum"> 111</span></a>  
<a name="l112"><span class="linenum"> 112</span></a>      <a class="var it2919" onMouseOver="hilite(2919)" onMouseOut="lolite()" onClick="logVariable('number')" href="../../../_variables/number.html">$number</a> = 1;
<a name="l113"><span class="linenum"> 113</span></a>      foreach (<a class="var it17595" onMouseOver="hilite(17595)" onMouseOut="lolite()" onClick="logVariable('qsbyslot')" href="../../../_variables/qsbyslot.html">$qsbyslot</a> as <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>) {
<a name="l114"><span class="linenum"> 114</span></a>          <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('number')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/number.html">number</a> = <a class="var it2919" onMouseOver="hilite(2919)" onMouseOut="lolite()" onClick="logVariable('number')" href="../../../_variables/number.html">$number</a>;
<a name="l115"><span class="linenum"> 115</span></a>          <a class="var it2919" onMouseOver="hilite(2919)" onMouseOut="lolite()" onClick="logVariable('number')" href="../../../_variables/number.html">$number</a> += <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('length')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/length.html">length</a>;
<a name="l116"><span class="linenum"> 116</span></a>      }
<a name="l117"><span class="linenum"> 117</span></a>  
<a name="l118"><span class="linenum"> 118</span></a>      return <a class="var it17595" onMouseOver="hilite(17595)" onMouseOut="lolite()" onClick="logVariable('qsbyslot')" href="../../../_variables/qsbyslot.html">$qsbyslot</a>;
<a name="l119"><span class="linenum"> 119</span></a>  }
<a name="l120"><span class="linenum"> 120</span></a>  
<a name="l121"><span class="linenum"> 121</span></a>  <span class="comment">/**</span>
<a name="l122"><span class="linenum"> 122</span></a>  <span class="comment"> * @param object $quiz the quiz settings.</span>
<a name="l123"><span class="linenum"> 123</span></a>  <span class="comment"> * @return bool whether, for this quiz, it is possible to filter attempts to show</span>
<a name="l124"><span class="linenum"> 124</span></a>  <span class="comment"> *      only those that gave the final grade.</span>
<a name="l125"><span class="linenum"> 125</span></a>  <span class="comment"> */</span>
<a name="l126"><span class="linenum"> 126</span></a>  function <a class="function" onClick="logFunction('quiz_report_can_filter_only_graded')" href="../../../_functions/quiz_report_can_filter_only_graded.html" onMouseOver="funcPopup(event,'quiz_report_can_filter_only_graded')">quiz_report_can_filter_only_graded</a>(<a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>) {
<a name="l127"><span class="linenum"> 127</span></a>      return <a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('attempts')" class="var it39928" onMouseOver="hilite(39928)" onMouseOut="lolite()" href="../../../_variables/attempts.html">attempts</a> != 1 &amp;&amp; <a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('grademethod')" class="var it39928" onMouseOver="hilite(39928)" onMouseOut="lolite()" href="../../../_variables/grademethod.html">grademethod</a> != <a class="constant" onClick="logConstant('QUIZ_GRADEAVERAGE')" href="../../../_constants/QUIZ_GRADEAVERAGE.html" onMouseOver="constPopup(event,'QUIZ_GRADEAVERAGE')">QUIZ_GRADEAVERAGE</a>;
<a name="l128"><span class="linenum"> 128</span></a>  }
<a name="l129"><span class="linenum"> 129</span></a>  
<a name="l130"><span class="linenum"> 130</span></a>  <span class="comment">/**</span>
<a name="l131"><span class="linenum"> 131</span></a>  <span class="comment"> * This is a wrapper for {@link quiz_report_grade_method_sql} that takes the whole quiz object instead of just the grading method</span>
<a name="l132"><span class="linenum"> 132</span></a>  <span class="comment"> * as a param. See definition for {@link quiz_report_grade_method_sql} below.</span>
<a name="l133"><span class="linenum"> 133</span></a>  <span class="comment"> *</span>
<a name="l134"><span class="linenum"> 134</span></a>  <span class="comment"> * @param object $quiz</span>
<a name="l135"><span class="linenum"> 135</span></a>  <span class="comment"> * @param string $quizattemptsalias sql alias for 'quiz_attempts' table</span>
<a name="l136"><span class="linenum"> 136</span></a>  <span class="comment"> * @return string sql to test if this is an attempt that will contribute towards the grade of the user</span>
<a name="l137"><span class="linenum"> 137</span></a>  <span class="comment"> */</span>
<a name="l138"><span class="linenum"> 138</span></a>  function <a class="function" onClick="logFunction('quiz_report_qm_filter_select')" href="../../../_functions/quiz_report_qm_filter_select.html" onMouseOver="funcPopup(event,'quiz_report_qm_filter_select')">quiz_report_qm_filter_select</a>(<a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>, <a class="var it17596" onMouseOver="hilite(17596)" onMouseOut="lolite()" onClick="logVariable('quizattemptsalias')" href="../../../_variables/quizattemptsalias.html">$quizattemptsalias</a> = 'quiza') {
<a name="l139"><span class="linenum"> 139</span></a>      if (<a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('attempts')" class="var it39928" onMouseOver="hilite(39928)" onMouseOut="lolite()" href="../../../_variables/attempts.html">attempts</a> == 1) {
<a name="l140"><span class="linenum"> 140</span></a>  <span class="comment">        // This quiz only allows one attempt.</span>
<a name="l141"><span class="linenum"> 141</span></a>          return '';
<a name="l142"><span class="linenum"> 142</span></a>      }
<a name="l143"><span class="linenum"> 143</span></a>      return <a class="function" onClick="logFunction('quiz_report_grade_method_sql')" href="../../../_functions/quiz_report_grade_method_sql.html" onMouseOver="funcPopup(event,'quiz_report_grade_method_sql')">quiz_report_grade_method_sql</a>(<a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('grademethod')" class="var it39928" onMouseOver="hilite(39928)" onMouseOut="lolite()" href="../../../_variables/grademethod.html">grademethod</a>, <a class="var it17596" onMouseOver="hilite(17596)" onMouseOut="lolite()" onClick="logVariable('quizattemptsalias')" href="../../../_variables/quizattemptsalias.html">$quizattemptsalias</a>);
<a name="l144"><span class="linenum"> 144</span></a>  }
<a name="l145"><span class="linenum"> 145</span></a>  
<a name="l146"><span class="linenum"> 146</span></a>  <span class="comment">/**</span>
<a name="l147"><span class="linenum"> 147</span></a>  <span class="comment"> * Given a quiz grading method return sql to test if this is an</span>
<a name="l148"><span class="linenum"> 148</span></a>  <span class="comment"> * attempt that will be contribute towards the grade of the user. Or return an</span>
<a name="l149"><span class="linenum"> 149</span></a>  <span class="comment"> * empty string if the grading method is QUIZ_GRADEAVERAGE and thus all attempts</span>
<a name="l150"><span class="linenum"> 150</span></a>  <span class="comment"> * contribute to final grade.</span>
<a name="l151"><span class="linenum"> 151</span></a>  <span class="comment"> *</span>
<a name="l152"><span class="linenum"> 152</span></a>  <span class="comment"> * @param string $grademethod quiz grading method.</span>
<a name="l153"><span class="linenum"> 153</span></a>  <span class="comment"> * @param string $quizattemptsalias sql alias for 'quiz_attempts' table</span>
<a name="l154"><span class="linenum"> 154</span></a>  <span class="comment"> * @return string sql to test if this is an attempt that will contribute towards the graded of the user</span>
<a name="l155"><span class="linenum"> 155</span></a>  <span class="comment"> */</span>
<a name="l156"><span class="linenum"> 156</span></a>  function <a class="function" onClick="logFunction('quiz_report_grade_method_sql')" href="../../../_functions/quiz_report_grade_method_sql.html" onMouseOver="funcPopup(event,'quiz_report_grade_method_sql')">quiz_report_grade_method_sql</a>(<a class="var it10193" onMouseOver="hilite(10193)" onMouseOut="lolite()" onClick="logVariable('grademethod')" href="../../../_variables/grademethod.html">$grademethod</a>, <a class="var it17596" onMouseOver="hilite(17596)" onMouseOut="lolite()" onClick="logVariable('quizattemptsalias')" href="../../../_variables/quizattemptsalias.html">$quizattemptsalias</a> = 'quiza') {
<a name="l157"><span class="linenum"> 157</span></a>      switch (<a class="var it10193" onMouseOver="hilite(10193)" onMouseOut="lolite()" onClick="logVariable('grademethod')" href="../../../_variables/grademethod.html">$grademethod</a>) {
<a name="l158"><span class="linenum"> 158</span></a>          case <a class="constant" onClick="logConstant('QUIZ_GRADEHIGHEST')" href="../../../_constants/QUIZ_GRADEHIGHEST.html" onMouseOver="constPopup(event,'QUIZ_GRADEHIGHEST')">QUIZ_GRADEHIGHEST</a> :
<a name="l159"><span class="linenum"> 159</span></a>              return &quot;(<a class="var it17596" onMouseOver="hilite(17596)" onMouseOut="lolite()" onClick="logVariable('quizattemptsalias')" href="../../../_variables/quizattemptsalias.html">$quizattemptsalias</a>.state = 'finished' AND NOT <a class="function" onClick="logFunction('EXISTS')" href="../../../_functions/exists.html" onMouseOver="funcPopup(event,'exists')">EXISTS</a> (
<a name="l160"><span class="linenum"> 160</span></a>                             SELECT 1 FROM {quiz_attempts} qa2
<a name="l161"><span class="linenum"> 161</span></a>                              WHERE qa2.quiz = <a class="var it17596" onMouseOver="hilite(17596)" onMouseOut="lolite()" onClick="logVariable('quizattemptsalias')" href="../../../_variables/quizattemptsalias.html">$quizattemptsalias</a>.quiz AND
<a name="l162"><span class="linenum"> 162</span></a>                                  qa2.userid = <a class="var it17596" onMouseOver="hilite(17596)" onMouseOut="lolite()" onClick="logVariable('quizattemptsalias')" href="../../../_variables/quizattemptsalias.html">$quizattemptsalias</a>.userid AND
<a name="l163"><span class="linenum"> 163</span></a>                                   qa2.state = 'finished' AND (
<a name="l164"><span class="linenum"> 164</span></a>                  COALESCE(qa2.sumgrades, 0) &gt; COALESCE(<a class="var it17596" onMouseOver="hilite(17596)" onMouseOut="lolite()" onClick="logVariable('quizattemptsalias')" href="../../../_variables/quizattemptsalias.html">$quizattemptsalias</a>.sumgrades, 0) OR
<a name="l165"><span class="linenum"> 165</span></a>                 (COALESCE(qa2.sumgrades, 0) = COALESCE(<a class="var it17596" onMouseOver="hilite(17596)" onMouseOut="lolite()" onClick="logVariable('quizattemptsalias')" href="../../../_variables/quizattemptsalias.html">$quizattemptsalias</a>.sumgrades, 0) AND qa2.attempt &lt; <a class="var it17596" onMouseOver="hilite(17596)" onMouseOut="lolite()" onClick="logVariable('quizattemptsalias')" href="../../../_variables/quizattemptsalias.html">$quizattemptsalias</a>.attempt)
<a name="l166"><span class="linenum"> 166</span></a>                                  )))&quot;;
<a name="l167"><span class="linenum"> 167</span></a>  
<a name="l168"><span class="linenum"> 168</span></a>          case <a class="constant" onClick="logConstant('QUIZ_GRADEAVERAGE')" href="../../../_constants/QUIZ_GRADEAVERAGE.html" onMouseOver="constPopup(event,'QUIZ_GRADEAVERAGE')">QUIZ_GRADEAVERAGE</a> :
<a name="l169"><span class="linenum"> 169</span></a>              return '';
<a name="l170"><span class="linenum"> 170</span></a>  
<a name="l171"><span class="linenum"> 171</span></a>          case <a class="constant" onClick="logConstant('QUIZ_ATTEMPTFIRST')" href="../../../_constants/QUIZ_ATTEMPTFIRST.html" onMouseOver="constPopup(event,'QUIZ_ATTEMPTFIRST')">QUIZ_ATTEMPTFIRST</a> :
<a name="l172"><span class="linenum"> 172</span></a>              return &quot;(<a class="var it17596" onMouseOver="hilite(17596)" onMouseOut="lolite()" onClick="logVariable('quizattemptsalias')" href="../../../_variables/quizattemptsalias.html">$quizattemptsalias</a>.state = 'finished' AND NOT <a class="function" onClick="logFunction('EXISTS')" href="../../../_functions/exists.html" onMouseOver="funcPopup(event,'exists')">EXISTS</a> (
<a name="l173"><span class="linenum"> 173</span></a>                             SELECT 1 FROM {quiz_attempts} qa2
<a name="l174"><span class="linenum"> 174</span></a>                              WHERE qa2.quiz = <a class="var it17596" onMouseOver="hilite(17596)" onMouseOut="lolite()" onClick="logVariable('quizattemptsalias')" href="../../../_variables/quizattemptsalias.html">$quizattemptsalias</a>.quiz AND
<a name="l175"><span class="linenum"> 175</span></a>                                  qa2.userid = <a class="var it17596" onMouseOver="hilite(17596)" onMouseOut="lolite()" onClick="logVariable('quizattemptsalias')" href="../../../_variables/quizattemptsalias.html">$quizattemptsalias</a>.userid AND
<a name="l176"><span class="linenum"> 176</span></a>                                   qa2.state = 'finished' AND
<a name="l177"><span class="linenum"> 177</span></a>                                 qa2.attempt &lt; <a class="var it17596" onMouseOver="hilite(17596)" onMouseOut="lolite()" onClick="logVariable('quizattemptsalias')" href="../../../_variables/quizattemptsalias.html">$quizattemptsalias</a>.attempt))&quot;;
<a name="l178"><span class="linenum"> 178</span></a>  
<a name="l179"><span class="linenum"> 179</span></a>          case <a class="constant" onClick="logConstant('QUIZ_ATTEMPTLAST')" href="../../../_constants/QUIZ_ATTEMPTLAST.html" onMouseOver="constPopup(event,'QUIZ_ATTEMPTLAST')">QUIZ_ATTEMPTLAST</a> :
<a name="l180"><span class="linenum"> 180</span></a>              return &quot;(<a class="var it17596" onMouseOver="hilite(17596)" onMouseOut="lolite()" onClick="logVariable('quizattemptsalias')" href="../../../_variables/quizattemptsalias.html">$quizattemptsalias</a>.state = 'finished' AND NOT <a class="function" onClick="logFunction('EXISTS')" href="../../../_functions/exists.html" onMouseOver="funcPopup(event,'exists')">EXISTS</a> (
<a name="l181"><span class="linenum"> 181</span></a>                             SELECT 1 FROM {quiz_attempts} qa2
<a name="l182"><span class="linenum"> 182</span></a>                              WHERE qa2.quiz = <a class="var it17596" onMouseOver="hilite(17596)" onMouseOut="lolite()" onClick="logVariable('quizattemptsalias')" href="../../../_variables/quizattemptsalias.html">$quizattemptsalias</a>.quiz AND
<a name="l183"><span class="linenum"> 183</span></a>                                  qa2.userid = <a class="var it17596" onMouseOver="hilite(17596)" onMouseOut="lolite()" onClick="logVariable('quizattemptsalias')" href="../../../_variables/quizattemptsalias.html">$quizattemptsalias</a>.userid AND
<a name="l184"><span class="linenum"> 184</span></a>                                   qa2.state = 'finished' AND
<a name="l185"><span class="linenum"> 185</span></a>                                 qa2.attempt &gt; <a class="var it17596" onMouseOver="hilite(17596)" onMouseOut="lolite()" onClick="logVariable('quizattemptsalias')" href="../../../_variables/quizattemptsalias.html">$quizattemptsalias</a>.attempt))&quot;;
<a name="l186"><span class="linenum"> 186</span></a>      }
<a name="l187"><span class="linenum"> 187</span></a>  }
<a name="l188"><span class="linenum"> 188</span></a>  
<a name="l189"><span class="linenum"> 189</span></a>  <span class="comment">/**</span>
<a name="l190"><span class="linenum"> 190</span></a>  <span class="comment"> * Get the number of students whose score was in a particular band for this quiz.</span>
<a name="l191"><span class="linenum"> 191</span></a>  <span class="comment"> * @param number $bandwidth the width of each band.</span>
<a name="l192"><span class="linenum"> 192</span></a>  <span class="comment"> * @param int $bands the number of bands</span>
<a name="l193"><span class="linenum"> 193</span></a>  <span class="comment"> * @param int $quizid the quiz id.</span>
<a name="l194"><span class="linenum"> 194</span></a>  <span class="comment"> * @param array $userids list of user ids.</span>
<a name="l195"><span class="linenum"> 195</span></a>  <span class="comment"> * @return array band number =&gt; number of users with scores in that band.</span>
<a name="l196"><span class="linenum"> 196</span></a>  <span class="comment"> */</span>
<a name="l197"><span class="linenum"> 197</span></a>  function <a class="function" onClick="logFunction('quiz_report_grade_bands')" href="../../../_functions/quiz_report_grade_bands.html" onMouseOver="funcPopup(event,'quiz_report_grade_bands')">quiz_report_grade_bands</a>(<a class="var it10679" onMouseOver="hilite(10679)" onMouseOut="lolite()" onClick="logVariable('bandwidth')" href="../../../_variables/bandwidth.html">$bandwidth</a>, <a class="var it17597" onMouseOver="hilite(17597)" onMouseOut="lolite()" onClick="logVariable('bands')" href="../../../_variables/bands.html">$bands</a>, <a class="var it1069" onMouseOver="hilite(1069)" onMouseOut="lolite()" onClick="logVariable('quizid')" href="../../../_variables/quizid.html">$quizid</a>, <a class="var it2955" onMouseOver="hilite(2955)" onMouseOut="lolite()" onClick="logVariable('userids')" href="../../../_variables/userids.html">$userids</a> = array()) {
<a name="l198"><span class="linenum"> 198</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l199"><span class="linenum"> 199</span></a>      if (!is_int(<a class="var it17597" onMouseOver="hilite(17597)" onMouseOut="lolite()" onClick="logVariable('bands')" href="../../../_variables/bands.html">$bands</a>)) {
<a name="l200"><span class="linenum"> 200</span></a>          <a class="function" onClick="logFunction('debugging')" href="../../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('<a class="var it17597" onMouseOver="hilite(17597)" onMouseOut="lolite()" onClick="logVariable('bands')" href="../../../_variables/bands.html">$bands</a> passed to quiz_report_grade_bands must be an integer. (' .
<a name="l201"><span class="linenum"> 201</span></a>                  <a class="phpfunction" onClick="logFunction('gettype')" href="../../../_functions/gettype.html" onMouseOver="phpfuncPopup(event,'gettype')">gettype</a>(<a class="var it17597" onMouseOver="hilite(17597)" onMouseOut="lolite()" onClick="logVariable('bands')" href="../../../_variables/bands.html">$bands</a>) . ' passed.)', <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../../../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l202"><span class="linenum"> 202</span></a>          <a class="var it17597" onMouseOver="hilite(17597)" onMouseOut="lolite()" onClick="logVariable('bands')" href="../../../_variables/bands.html">$bands</a> = (int) <a class="var it17597" onMouseOver="hilite(17597)" onMouseOut="lolite()" onClick="logVariable('bands')" href="../../../_variables/bands.html">$bands</a>;
<a name="l203"><span class="linenum"> 203</span></a>      }
<a name="l204"><span class="linenum"> 204</span></a>  
<a name="l205"><span class="linenum"> 205</span></a>      if (<a class="var it2955" onMouseOver="hilite(2955)" onMouseOut="lolite()" onClick="logVariable('userids')" href="../../../_variables/userids.html">$userids</a>) {
<a name="l206"><span class="linenum"> 206</span></a>          <a class="function" onClick="logFunction('list')" href="../../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it2909" onMouseOver="hilite(2909)" onMouseOut="lolite()" onClick="logVariable('usql')" href="../../../_variables/usql.html">$usql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>) = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it2955" onMouseOver="hilite(2955)" onMouseOut="lolite()" onClick="logVariable('userids')" href="../../../_variables/userids.html">$userids</a>, <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'u');
<a name="l207"><span class="linenum"> 207</span></a>          <a class="var it2909" onMouseOver="hilite(2909)" onMouseOut="lolite()" onClick="logVariable('usql')" href="../../../_variables/usql.html">$usql</a> = &quot;qg.userid <a class="var it2909" onMouseOver="hilite(2909)" onMouseOut="lolite()" onClick="logVariable('usql')" href="../../../_variables/usql.html">$usql</a> AND&quot;;
<a name="l208"><span class="linenum"> 208</span></a>      } else {
<a name="l209"><span class="linenum"> 209</span></a>          <a class="var it2909" onMouseOver="hilite(2909)" onMouseOut="lolite()" onClick="logVariable('usql')" href="../../../_variables/usql.html">$usql</a> = '';
<a name="l210"><span class="linenum"> 210</span></a>          <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a> = array();
<a name="l211"><span class="linenum"> 211</span></a>      }
<a name="l212"><span class="linenum"> 212</span></a>      <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a> = &quot;
<a name="l213"><span class="linenum"> 213</span></a>  SELECT band, <a class="phpfunction" onClick="logFunction('COUNT')" href="../../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">COUNT</a>(1)
<a name="l214"><span class="linenum"> 214</span></a>  
<a name="l215"><span class="linenum"> 215</span></a>  <a class="function" onClick="logFunction('FROM')" href="../../../_functions/from.html" onMouseOver="funcPopup(event,'from')">FROM</a> (
<a name="l216"><span class="linenum"> 216</span></a>      SELECT <a class="phpfunction" onClick="logFunction('FLOOR')" href="../../../_functions/floor.html" onMouseOver="phpfuncPopup(event,'floor')">FLOOR</a>(qg.grade / :bandwidth) AS band
<a name="l217"><span class="linenum"> 217</span></a>        FROM {quiz_grades} qg
<a name="l218"><span class="linenum"> 218</span></a>       WHERE <a class="var it2909" onMouseOver="hilite(2909)" onMouseOut="lolite()" onClick="logVariable('usql')" href="../../../_variables/usql.html">$usql</a> qg.quiz = :quizid
<a name="l219"><span class="linenum"> 219</span></a>  ) subquery
<a name="l220"><span class="linenum"> 220</span></a>  
<a name="l221"><span class="linenum"> 221</span></a>  GROUP BY
<a name="l222"><span class="linenum"> 222</span></a>      band
<a name="l223"><span class="linenum"> 223</span></a>  
<a name="l224"><span class="linenum"> 224</span></a>  ORDER BY
<a name="l225"><span class="linenum"> 225</span></a>      band&quot;;
<a name="l226"><span class="linenum"> 226</span></a>  
<a name="l227"><span class="linenum"> 227</span></a>      <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>['quizid'] = <a class="var it1069" onMouseOver="hilite(1069)" onMouseOut="lolite()" onClick="logVariable('quizid')" href="../../../_variables/quizid.html">$quizid</a>;
<a name="l228"><span class="linenum"> 228</span></a>      <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>['bandwidth'] = <a class="var it10679" onMouseOver="hilite(10679)" onMouseOut="lolite()" onClick="logVariable('bandwidth')" href="../../../_variables/bandwidth.html">$bandwidth</a>;
<a name="l229"><span class="linenum"> 229</span></a>  
<a name="l230"><span class="linenum"> 230</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql_menu')" href="../../../_functions/get_records_sql_menu.html" onMouseOver="funcPopup(event,'get_records_sql_menu')">get_records_sql_menu</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>);
<a name="l231"><span class="linenum"> 231</span></a>  
<a name="l232"><span class="linenum"> 232</span></a>  <span class="comment">    // We need to create array elements with values 0 at indexes where there is no element.</span>
<a name="l233"><span class="linenum"> 233</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a> = <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a> + <a class="phpfunction" onClick="logFunction('array_fill')" href="../../../_functions/array_fill.html" onMouseOver="phpfuncPopup(event,'array_fill')">array_fill</a>(0, <a class="var it17597" onMouseOver="hilite(17597)" onMouseOut="lolite()" onClick="logVariable('bands')" href="../../../_variables/bands.html">$bands</a> + 1, 0);
<a name="l234"><span class="linenum"> 234</span></a>      <a class="phpfunction" onClick="logFunction('ksort')" href="../../../_functions/ksort.html" onMouseOver="phpfuncPopup(event,'ksort')">ksort</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a>);
<a name="l235"><span class="linenum"> 235</span></a>  
<a name="l236"><span class="linenum"> 236</span></a>  <span class="comment">    // Place the maximum (perfect grade) into the last band i.e. make last</span>
<a name="l237"><span class="linenum"> 237</span></a>  <span class="comment">    // band for example 9 &lt;= g &lt;=10 (where 10 is the perfect grade) rather than</span>
<a name="l238"><span class="linenum"> 238</span></a>  <span class="comment">    // just 9 &lt;= g &lt;10.</span>
<a name="l239"><span class="linenum"> 239</span></a>      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a>[<a class="var it17597" onMouseOver="hilite(17597)" onMouseOut="lolite()" onClick="logVariable('bands')" href="../../../_variables/bands.html">$bands</a> - 1] += <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a>[<a class="var it17597" onMouseOver="hilite(17597)" onMouseOut="lolite()" onClick="logVariable('bands')" href="../../../_variables/bands.html">$bands</a>];
<a name="l240"><span class="linenum"> 240</span></a>      unset(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a>[<a class="var it17597" onMouseOver="hilite(17597)" onMouseOut="lolite()" onClick="logVariable('bands')" href="../../../_variables/bands.html">$bands</a>]);
<a name="l241"><span class="linenum"> 241</span></a>  
<a name="l242"><span class="linenum"> 242</span></a>      return <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../_variables/data.html">$data</a>;
<a name="l243"><span class="linenum"> 243</span></a>  }
<a name="l244"><span class="linenum"> 244</span></a>  
<a name="l245"><span class="linenum"> 245</span></a>  function <a class="function" onClick="logFunction('quiz_report_highlighting_grading_method')" href="../../../_functions/quiz_report_highlighting_grading_method.html" onMouseOver="funcPopup(event,'quiz_report_highlighting_grading_method')">quiz_report_highlighting_grading_method</a>(<a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>, <a class="var it1072" onMouseOver="hilite(1072)" onMouseOut="lolite()" onClick="logVariable('qmsubselect')" href="../../../_variables/qmsubselect.html">$qmsubselect</a>, <a class="var it17598" onMouseOver="hilite(17598)" onMouseOut="lolite()" onClick="logVariable('qmfilter')" href="../../../_variables/qmfilter.html">$qmfilter</a>) {
<a name="l246"><span class="linenum"> 246</span></a>      if (<a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('attempts')" class="var it39928" onMouseOver="hilite(39928)" onMouseOut="lolite()" href="../../../_variables/attempts.html">attempts</a> == 1) {
<a name="l247"><span class="linenum"> 247</span></a>          return '&lt;p&gt;' . <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('onlyoneattemptallowed', 'quiz_overview') . '&lt;/p&gt;';
<a name="l248"><span class="linenum"> 248</span></a>  
<a name="l249"><span class="linenum"> 249</span></a>      } else if (!<a class="var it1072" onMouseOver="hilite(1072)" onMouseOut="lolite()" onClick="logVariable('qmsubselect')" href="../../../_variables/qmsubselect.html">$qmsubselect</a>) {
<a name="l250"><span class="linenum"> 250</span></a>          return '&lt;p&gt;' . <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('allattemptscontributetograde', 'quiz_overview') . '&lt;/p&gt;';
<a name="l251"><span class="linenum"> 251</span></a>  
<a name="l252"><span class="linenum"> 252</span></a>      } else if (<a class="var it17598" onMouseOver="hilite(17598)" onMouseOut="lolite()" onClick="logVariable('qmfilter')" href="../../../_variables/qmfilter.html">$qmfilter</a>) {
<a name="l253"><span class="linenum"> 253</span></a>          return '&lt;p&gt;' . <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('showinggraded', 'quiz_overview') . '&lt;/p&gt;';
<a name="l254"><span class="linenum"> 254</span></a>  
<a name="l255"><span class="linenum"> 255</span></a>      } else {
<a name="l256"><span class="linenum"> 256</span></a>          return '&lt;p&gt;' . <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('showinggradedandungraded', 'quiz_overview',
<a name="l257"><span class="linenum"> 257</span></a>                  '&lt;span class=&quot;gradedattempt&quot;&gt;' . <a class="function" onClick="logFunction('quiz_get_grading_option_name')" href="../../../_functions/quiz_get_grading_option_name.html" onMouseOver="funcPopup(event,'quiz_get_grading_option_name')">quiz_get_grading_option_name</a>(<a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('grademethod')" class="var it39928" onMouseOver="hilite(39928)" onMouseOut="lolite()" href="../../../_variables/grademethod.html">grademethod</a>) .
<a name="l258"><span class="linenum"> 258</span></a>                  '&lt;/span&gt;') . '&lt;/p&gt;';
<a name="l259"><span class="linenum"> 259</span></a>      }
<a name="l260"><span class="linenum"> 260</span></a>  }
<a name="l261"><span class="linenum"> 261</span></a>  
<a name="l262"><span class="linenum"> 262</span></a>  <span class="comment">/**</span>
<a name="l263"><span class="linenum"> 263</span></a>  <span class="comment"> * Get the feedback text for a grade on this quiz. The feedback is</span>
<a name="l264"><span class="linenum"> 264</span></a>  <span class="comment"> * processed ready for display.</span>
<a name="l265"><span class="linenum"> 265</span></a>  <span class="comment"> *</span>
<a name="l266"><span class="linenum"> 266</span></a>  <span class="comment"> * @param float $grade a grade on this quiz.</span>
<a name="l267"><span class="linenum"> 267</span></a>  <span class="comment"> * @param int $quizid the id of the quiz object.</span>
<a name="l268"><span class="linenum"> 268</span></a>  <span class="comment"> * @return string the comment that corresponds to this grade (empty string if there is not one.</span>
<a name="l269"><span class="linenum"> 269</span></a>  <span class="comment"> */</span>
<a name="l270"><span class="linenum"> 270</span></a>  function <a class="function" onClick="logFunction('quiz_report_feedback_for_grade')" href="../../../_functions/quiz_report_feedback_for_grade.html" onMouseOver="funcPopup(event,'quiz_report_feedback_for_grade')">quiz_report_feedback_for_grade</a>(<a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../../_variables/grade.html">$grade</a>, <a class="var it1069" onMouseOver="hilite(1069)" onMouseOut="lolite()" onClick="logVariable('quizid')" href="../../../_variables/quizid.html">$quizid</a>, <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../_variables/context.html">$context</a>) {
<a name="l271"><span class="linenum"> 271</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l272"><span class="linenum"> 272</span></a>  
<a name="l273"><span class="linenum"> 273</span></a>      static <a class="var it17599" onMouseOver="hilite(17599)" onMouseOut="lolite()" onClick="logVariable('feedbackcache')" href="../../../_variables/feedbackcache.html">$feedbackcache</a> = array();
<a name="l274"><span class="linenum"> 274</span></a>  
<a name="l275"><span class="linenum"> 275</span></a>      if (!isset(<a class="var it17599" onMouseOver="hilite(17599)" onMouseOut="lolite()" onClick="logVariable('feedbackcache')" href="../../../_variables/feedbackcache.html">$feedbackcache</a>[<a class="var it1069" onMouseOver="hilite(1069)" onMouseOut="lolite()" onClick="logVariable('quizid')" href="../../../_variables/quizid.html">$quizid</a>])) {
<a name="l276"><span class="linenum"> 276</span></a>          <a class="var it17599" onMouseOver="hilite(17599)" onMouseOut="lolite()" onClick="logVariable('feedbackcache')" href="../../../_variables/feedbackcache.html">$feedbackcache</a>[<a class="var it1069" onMouseOver="hilite(1069)" onMouseOut="lolite()" onClick="logVariable('quizid')" href="../../../_variables/quizid.html">$quizid</a>] = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('quiz_feedback', array('quizid' =&gt; <a class="var it1069" onMouseOver="hilite(1069)" onMouseOut="lolite()" onClick="logVariable('quizid')" href="../../../_variables/quizid.html">$quizid</a>));
<a name="l277"><span class="linenum"> 277</span></a>      }
<a name="l278"><span class="linenum"> 278</span></a>  
<a name="l279"><span class="linenum"> 279</span></a>  <span class="comment">    // With CBM etc, it is possible to get -ve grades, which would then not match</span>
<a name="l280"><span class="linenum"> 280</span></a>  <span class="comment">    // any feedback. Therefore, we replace -ve grades with 0.</span>
<a name="l281"><span class="linenum"> 281</span></a>      <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../../_variables/grade.html">$grade</a> = <a class="phpfunction" onClick="logFunction('max')" href="../../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">max</a>(<a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../../_variables/grade.html">$grade</a>, 0);
<a name="l282"><span class="linenum"> 282</span></a>  
<a name="l283"><span class="linenum"> 283</span></a>      <a class="var it4219" onMouseOver="hilite(4219)" onMouseOut="lolite()" onClick="logVariable('feedbacks')" href="../../../_variables/feedbacks.html">$feedbacks</a> = <a class="var it17599" onMouseOver="hilite(17599)" onMouseOut="lolite()" onClick="logVariable('feedbackcache')" href="../../../_variables/feedbackcache.html">$feedbackcache</a>[<a class="var it1069" onMouseOver="hilite(1069)" onMouseOut="lolite()" onClick="logVariable('quizid')" href="../../../_variables/quizid.html">$quizid</a>];
<a name="l284"><span class="linenum"> 284</span></a>      <a class="var it1045" onMouseOver="hilite(1045)" onMouseOut="lolite()" onClick="logVariable('feedbackid')" href="../../../_variables/feedbackid.html">$feedbackid</a> = 0;
<a name="l285"><span class="linenum"> 285</span></a>      <a class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" onClick="logVariable('feedbacktext')" href="../../../_variables/feedbacktext.html">$feedbacktext</a> = '';
<a name="l286"><span class="linenum"> 286</span></a>      <a class="var it17600" onMouseOver="hilite(17600)" onMouseOut="lolite()" onClick="logVariable('feedbacktextformat')" href="../../../_variables/feedbacktextformat.html">$feedbacktextformat</a> = <a class="constant" onClick="logConstant('FORMAT_MOODLE')" href="../../../_constants/FORMAT_MOODLE.html" onMouseOver="constPopup(event,'FORMAT_MOODLE')">FORMAT_MOODLE</a>;
<a name="l287"><span class="linenum"> 287</span></a>      foreach (<a class="var it4219" onMouseOver="hilite(4219)" onMouseOut="lolite()" onClick="logVariable('feedbacks')" href="../../../_variables/feedbacks.html">$feedbacks</a> as <a class="var it714" onMouseOver="hilite(714)" onMouseOut="lolite()" onClick="logVariable('feedback')" href="../../../_variables/feedback.html">$feedback</a>) {
<a name="l288"><span class="linenum"> 288</span></a>          if (<a class="var it714" onMouseOver="hilite(714)" onMouseOut="lolite()" onClick="logVariable('feedback')" href="../../../_variables/feedback.html">$feedback</a>-&gt;<a onClick="logVariable('mingrade')" class="var it39694" onMouseOver="hilite(39694)" onMouseOut="lolite()" href="../../../_variables/mingrade.html">mingrade</a> &lt;= <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../../_variables/grade.html">$grade</a> &amp;&amp; <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../../_variables/grade.html">$grade</a> &lt; <a class="var it714" onMouseOver="hilite(714)" onMouseOut="lolite()" onClick="logVariable('feedback')" href="../../../_variables/feedback.html">$feedback</a>-&gt;<a onClick="logVariable('maxgrade')" class="var it39694" onMouseOver="hilite(39694)" onMouseOut="lolite()" href="../../../_variables/maxgrade.html">maxgrade</a>) {
<a name="l289"><span class="linenum"> 289</span></a>              <a class="var it1045" onMouseOver="hilite(1045)" onMouseOut="lolite()" onClick="logVariable('feedbackid')" href="../../../_variables/feedbackid.html">$feedbackid</a> = <a class="var it714" onMouseOver="hilite(714)" onMouseOut="lolite()" onClick="logVariable('feedback')" href="../../../_variables/feedback.html">$feedback</a>-&gt;<a onClick="logVariable('id')" class="var it39694" onMouseOver="hilite(39694)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>;
<a name="l290"><span class="linenum"> 290</span></a>              <a class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" onClick="logVariable('feedbacktext')" href="../../../_variables/feedbacktext.html">$feedbacktext</a> = <a class="var it714" onMouseOver="hilite(714)" onMouseOut="lolite()" onClick="logVariable('feedback')" href="../../../_variables/feedback.html">$feedback</a>-&gt;<a onClick="logVariable('feedbacktext')" class="var it39694" onMouseOver="hilite(39694)" onMouseOut="lolite()" href="../../../_variables/feedbacktext.html">feedbacktext</a>;
<a name="l291"><span class="linenum"> 291</span></a>              <a class="var it17600" onMouseOver="hilite(17600)" onMouseOut="lolite()" onClick="logVariable('feedbacktextformat')" href="../../../_variables/feedbacktextformat.html">$feedbacktextformat</a> = <a class="var it714" onMouseOver="hilite(714)" onMouseOut="lolite()" onClick="logVariable('feedback')" href="../../../_variables/feedback.html">$feedback</a>-&gt;<a onClick="logVariable('feedbacktextformat')" class="var it39694" onMouseOver="hilite(39694)" onMouseOut="lolite()" href="../../../_variables/feedbacktextformat.html">feedbacktextformat</a>;
<a name="l292"><span class="linenum"> 292</span></a>              break;
<a name="l293"><span class="linenum"> 293</span></a>          }
<a name="l294"><span class="linenum"> 294</span></a>      }
<a name="l295"><span class="linenum"> 295</span></a>  
<a name="l296"><span class="linenum"> 296</span></a>  <span class="comment">    // Clean the text, ready for display.</span>
<a name="l297"><span class="linenum"> 297</span></a>      <a class="var it6026" onMouseOver="hilite(6026)" onMouseOut="lolite()" onClick="logVariable('formatoptions')" href="../../../_variables/formatoptions.html">$formatoptions</a> = new stdClass();
<a name="l298"><span class="linenum"> 298</span></a>      <a class="var it6026" onMouseOver="hilite(6026)" onMouseOut="lolite()" onClick="logVariable('formatoptions')" href="../../../_variables/formatoptions.html">$formatoptions</a>-&gt;<a onClick="logVariable('noclean')" class="var it39710" onMouseOver="hilite(39710)" onMouseOut="lolite()" href="../../../_variables/noclean.html">noclean</a> = true;
<a name="l299"><span class="linenum"> 299</span></a>      <a class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" onClick="logVariable('feedbacktext')" href="../../../_variables/feedbacktext.html">$feedbacktext</a> = <a class="function" onClick="logFunction('file_rewrite_pluginfile_urls')" href="../../../_functions/file_rewrite_pluginfile_urls.html" onMouseOver="funcPopup(event,'file_rewrite_pluginfile_urls')">file_rewrite_pluginfile_urls</a>(<a class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" onClick="logVariable('feedbacktext')" href="../../../_variables/feedbacktext.html">$feedbacktext</a>, '<a class="filename" href="../../../pluginfile.php.html">pluginfile.php</a>',
<a name="l300"><span class="linenum"> 300</span></a>              <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it39491" onMouseOver="hilite(39491)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>, 'mod_quiz', 'feedback', <a class="var it1045" onMouseOver="hilite(1045)" onMouseOut="lolite()" onClick="logVariable('feedbackid')" href="../../../_variables/feedbackid.html">$feedbackid</a>);
<a name="l301"><span class="linenum"> 301</span></a>      <a class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" onClick="logVariable('feedbacktext')" href="../../../_variables/feedbacktext.html">$feedbacktext</a> = <a class="function" onClick="logFunction('format_text')" href="../../../_functions/format_text.html" onMouseOver="funcPopup(event,'format_text')">format_text</a>(<a class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" onClick="logVariable('feedbacktext')" href="../../../_variables/feedbacktext.html">$feedbacktext</a>, <a class="var it17600" onMouseOver="hilite(17600)" onMouseOut="lolite()" onClick="logVariable('feedbacktextformat')" href="../../../_variables/feedbacktextformat.html">$feedbacktextformat</a>, <a class="var it6026" onMouseOver="hilite(6026)" onMouseOut="lolite()" onClick="logVariable('formatoptions')" href="../../../_variables/formatoptions.html">$formatoptions</a>);
<a name="l302"><span class="linenum"> 302</span></a>  
<a name="l303"><span class="linenum"> 303</span></a>      return <a class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" onClick="logVariable('feedbacktext')" href="../../../_variables/feedbacktext.html">$feedbacktext</a>;
<a name="l304"><span class="linenum"> 304</span></a>  }
<a name="l305"><span class="linenum"> 305</span></a>  
<a name="l306"><span class="linenum"> 306</span></a>  <span class="comment">/**</span>
<a name="l307"><span class="linenum"> 307</span></a>  <span class="comment"> * Format a number as a percentage out of $quiz-&gt;sumgrades</span>
<a name="l308"><span class="linenum"> 308</span></a>  <span class="comment"> * @param number $rawgrade the mark to format.</span>
<a name="l309"><span class="linenum"> 309</span></a>  <span class="comment"> * @param object $quiz the quiz settings</span>
<a name="l310"><span class="linenum"> 310</span></a>  <span class="comment"> * @param bool $round whether to round the results ot $quiz-&gt;decimalpoints.</span>
<a name="l311"><span class="linenum"> 311</span></a>  <span class="comment"> */</span>
<a name="l312"><span class="linenum"> 312</span></a>  function <a class="function" onClick="logFunction('quiz_report_scale_summarks_as_percentage')" href="../../../_functions/quiz_report_scale_summarks_as_percentage.html" onMouseOver="funcPopup(event,'quiz_report_scale_summarks_as_percentage')">quiz_report_scale_summarks_as_percentage</a>(<a class="var it7174" onMouseOver="hilite(7174)" onMouseOut="lolite()" onClick="logVariable('rawmark')" href="../../../_variables/rawmark.html">$rawmark</a>, <a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>, <a class="var it15028" onMouseOver="hilite(15028)" onMouseOut="lolite()" onClick="logVariable('round')" href="../../../_variables/round.html">$round</a> = true) {
<a name="l313"><span class="linenum"> 313</span></a>      if (<a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('sumgrades')" class="var it39928" onMouseOver="hilite(39928)" onMouseOut="lolite()" href="../../../_variables/sumgrades.html">sumgrades</a> == 0) {
<a name="l314"><span class="linenum"> 314</span></a>          return '';
<a name="l315"><span class="linenum"> 315</span></a>      }
<a name="l316"><span class="linenum"> 316</span></a>      if (!<a class="phpfunction" onClick="logFunction('is_numeric')" href="../../../_functions/is_numeric.html" onMouseOver="phpfuncPopup(event,'is_numeric')">is_numeric</a>(<a class="var it7174" onMouseOver="hilite(7174)" onMouseOut="lolite()" onClick="logVariable('rawmark')" href="../../../_variables/rawmark.html">$rawmark</a>)) {
<a name="l317"><span class="linenum"> 317</span></a>          return <a class="var it7174" onMouseOver="hilite(7174)" onMouseOut="lolite()" onClick="logVariable('rawmark')" href="../../../_variables/rawmark.html">$rawmark</a>;
<a name="l318"><span class="linenum"> 318</span></a>      }
<a name="l319"><span class="linenum"> 319</span></a>  
<a name="l320"><span class="linenum"> 320</span></a>      <a class="var it2272" onMouseOver="hilite(2272)" onMouseOut="lolite()" onClick="logVariable('mark')" href="../../../_variables/mark.html">$mark</a> = <a class="var it7174" onMouseOver="hilite(7174)" onMouseOut="lolite()" onClick="logVariable('rawmark')" href="../../../_variables/rawmark.html">$rawmark</a> * 100 / <a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('sumgrades')" class="var it39928" onMouseOver="hilite(39928)" onMouseOut="lolite()" href="../../../_variables/sumgrades.html">sumgrades</a>;
<a name="l321"><span class="linenum"> 321</span></a>      if (<a class="var it15028" onMouseOver="hilite(15028)" onMouseOut="lolite()" onClick="logVariable('round')" href="../../../_variables/round.html">$round</a>) {
<a name="l322"><span class="linenum"> 322</span></a>          <a class="var it2272" onMouseOver="hilite(2272)" onMouseOut="lolite()" onClick="logVariable('mark')" href="../../../_variables/mark.html">$mark</a> = <a class="function" onClick="logFunction('quiz_format_grade')" href="../../../_functions/quiz_format_grade.html" onMouseOver="funcPopup(event,'quiz_format_grade')">quiz_format_grade</a>(<a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>, <a class="var it2272" onMouseOver="hilite(2272)" onMouseOut="lolite()" onClick="logVariable('mark')" href="../../../_variables/mark.html">$mark</a>);
<a name="l323"><span class="linenum"> 323</span></a>      }
<a name="l324"><span class="linenum"> 324</span></a>      return <a class="var it2272" onMouseOver="hilite(2272)" onMouseOut="lolite()" onClick="logVariable('mark')" href="../../../_variables/mark.html">$mark</a> . '%';
<a name="l325"><span class="linenum"> 325</span></a>  }
<a name="l326"><span class="linenum"> 326</span></a>  
<a name="l327"><span class="linenum"> 327</span></a>  <span class="comment">/**</span>
<a name="l328"><span class="linenum"> 328</span></a>  <span class="comment"> * Returns an array of reports to which the current user has access to.</span>
<a name="l329"><span class="linenum"> 329</span></a>  <span class="comment"> * @return array reports are ordered as they should be for display in tabs.</span>
<a name="l330"><span class="linenum"> 330</span></a>  <span class="comment"> */</span>
<a name="l331"><span class="linenum"> 331</span></a>  function <a class="function" onClick="logFunction('quiz_report_list')" href="../../../_functions/quiz_report_list.html" onMouseOver="funcPopup(event,'quiz_report_list')">quiz_report_list</a>(<a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../_variables/context.html">$context</a>) {
<a name="l332"><span class="linenum"> 332</span></a>      global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l333"><span class="linenum"> 333</span></a>      static <a class="var it17601" onMouseOver="hilite(17601)" onMouseOut="lolite()" onClick="logVariable('reportlist')" href="../../../_variables/reportlist.html">$reportlist</a> = null;
<a name="l334"><span class="linenum"> 334</span></a>      if (!<a class="phpfunction" onClick="logFunction('is_null')" href="../../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it17601" onMouseOver="hilite(17601)" onMouseOut="lolite()" onClick="logVariable('reportlist')" href="../../../_variables/reportlist.html">$reportlist</a>)) {
<a name="l335"><span class="linenum"> 335</span></a>          return <a class="var it17601" onMouseOver="hilite(17601)" onMouseOut="lolite()" onClick="logVariable('reportlist')" href="../../../_variables/reportlist.html">$reportlist</a>;
<a name="l336"><span class="linenum"> 336</span></a>      }
<a name="l337"><span class="linenum"> 337</span></a>  
<a name="l338"><span class="linenum"> 338</span></a>      <a class="var it1891" onMouseOver="hilite(1891)" onMouseOut="lolite()" onClick="logVariable('reports')" href="../../../_variables/reports.html">$reports</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('quiz_reports', null, 'displayorder DESC', 'name, capability');
<a name="l339"><span class="linenum"> 339</span></a>      <a class="var it17602" onMouseOver="hilite(17602)" onMouseOut="lolite()" onClick="logVariable('reportdirs')" href="../../../_variables/reportdirs.html">$reportdirs</a> = <a class="class" onClick="logClass('core_component')" href="../../../_classes/core_component.html" onMouseOver="classPopup(event,'core_component')">core_component</a>::<a class="function" onClick="logFunction('get_plugin_list')" href="../../../_functions/get_plugin_list.html" onMouseOver="funcPopup(event,'get_plugin_list')">get_plugin_list</a>('quiz');
<a name="l340"><span class="linenum"> 340</span></a>  
<a name="l341"><span class="linenum"> 341</span></a>  <span class="comment">    // Order the reports tab in descending order of displayorder.</span>
<a name="l342"><span class="linenum"> 342</span></a>      <a class="var it17603" onMouseOver="hilite(17603)" onMouseOut="lolite()" onClick="logVariable('reportcaps')" href="../../../_variables/reportcaps.html">$reportcaps</a> = array();
<a name="l343"><span class="linenum"> 343</span></a>      foreach (<a class="var it1891" onMouseOver="hilite(1891)" onMouseOut="lolite()" onClick="logVariable('reports')" href="../../../_variables/reports.html">$reports</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> =&gt; <a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../../_variables/report.html">$report</a>) {
<a name="l344"><span class="linenum"> 344</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../../_variables/report.html">$report</a>-&gt;<a onClick="logVariable('name')" class="var it39540" onMouseOver="hilite(39540)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a>, <a class="var it17602" onMouseOver="hilite(17602)" onMouseOut="lolite()" onClick="logVariable('reportdirs')" href="../../../_variables/reportdirs.html">$reportdirs</a>)) {
<a name="l345"><span class="linenum"> 345</span></a>              <a class="var it17603" onMouseOver="hilite(17603)" onMouseOut="lolite()" onClick="logVariable('reportcaps')" href="../../../_variables/reportcaps.html">$reportcaps</a>[<a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../../_variables/report.html">$report</a>-&gt;<a onClick="logVariable('name')" class="var it39540" onMouseOver="hilite(39540)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a>] = <a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../../_variables/report.html">$report</a>-&gt;<a onClick="logVariable('capability')" class="var it39540" onMouseOver="hilite(39540)" onMouseOut="lolite()" href="../../../_variables/capability.html">capability</a>;
<a name="l346"><span class="linenum"> 346</span></a>          }
<a name="l347"><span class="linenum"> 347</span></a>      }
<a name="l348"><span class="linenum"> 348</span></a>  
<a name="l349"><span class="linenum"> 349</span></a>  <span class="comment">    // Add any other reports, which are on disc but not in the DB, on the end.</span>
<a name="l350"><span class="linenum"> 350</span></a>      foreach (<a class="var it17602" onMouseOver="hilite(17602)" onMouseOut="lolite()" onClick="logVariable('reportdirs')" href="../../../_variables/reportdirs.html">$reportdirs</a> as <a class="var it14701" onMouseOver="hilite(14701)" onMouseOut="lolite()" onClick="logVariable('reportname')" href="../../../_variables/reportname.html">$reportname</a> =&gt; <a class="var it2596" onMouseOver="hilite(2596)" onMouseOut="lolite()" onClick="logVariable('notused')" href="../../../_variables/notused.html">$notused</a>) {
<a name="l351"><span class="linenum"> 351</span></a>          if (!isset(<a class="var it17603" onMouseOver="hilite(17603)" onMouseOut="lolite()" onClick="logVariable('reportcaps')" href="../../../_variables/reportcaps.html">$reportcaps</a>[<a class="var it14701" onMouseOver="hilite(14701)" onMouseOut="lolite()" onClick="logVariable('reportname')" href="../../../_variables/reportname.html">$reportname</a>])) {
<a name="l352"><span class="linenum"> 352</span></a>              <a class="var it17603" onMouseOver="hilite(17603)" onMouseOut="lolite()" onClick="logVariable('reportcaps')" href="../../../_variables/reportcaps.html">$reportcaps</a>[<a class="var it14701" onMouseOver="hilite(14701)" onMouseOut="lolite()" onClick="logVariable('reportname')" href="../../../_variables/reportname.html">$reportname</a>] = null;
<a name="l353"><span class="linenum"> 353</span></a>          }
<a name="l354"><span class="linenum"> 354</span></a>      }
<a name="l355"><span class="linenum"> 355</span></a>      <a class="var it17601" onMouseOver="hilite(17601)" onMouseOut="lolite()" onClick="logVariable('reportlist')" href="../../../_variables/reportlist.html">$reportlist</a> = array();
<a name="l356"><span class="linenum"> 356</span></a>      foreach (<a class="var it17603" onMouseOver="hilite(17603)" onMouseOut="lolite()" onClick="logVariable('reportcaps')" href="../../../_variables/reportcaps.html">$reportcaps</a> as <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../../_variables/name.html">$name</a> =&gt; <a class="var it2621" onMouseOver="hilite(2621)" onMouseOut="lolite()" onClick="logVariable('capability')" href="../../../_variables/capability.html">$capability</a>) {
<a name="l357"><span class="linenum"> 357</span></a>          if (empty(<a class="var it2621" onMouseOver="hilite(2621)" onMouseOut="lolite()" onClick="logVariable('capability')" href="../../../_variables/capability.html">$capability</a>)) {
<a name="l358"><span class="linenum"> 358</span></a>              <a class="var it2621" onMouseOver="hilite(2621)" onMouseOut="lolite()" onClick="logVariable('capability')" href="../../../_variables/capability.html">$capability</a> = 'mod/quiz:viewreports';
<a name="l359"><span class="linenum"> 359</span></a>          }
<a name="l360"><span class="linenum"> 360</span></a>          if (<a class="function" onClick="logFunction('has_capability')" href="../../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>(<a class="var it2621" onMouseOver="hilite(2621)" onMouseOut="lolite()" onClick="logVariable('capability')" href="../../../_variables/capability.html">$capability</a>, <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../_variables/context.html">$context</a>)) {
<a name="l361"><span class="linenum"> 361</span></a>              <a class="var it17601" onMouseOver="hilite(17601)" onMouseOut="lolite()" onClick="logVariable('reportlist')" href="../../../_variables/reportlist.html">$reportlist</a>[] = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../../_variables/name.html">$name</a>;
<a name="l362"><span class="linenum"> 362</span></a>          }
<a name="l363"><span class="linenum"> 363</span></a>      }
<a name="l364"><span class="linenum"> 364</span></a>      return <a class="var it17601" onMouseOver="hilite(17601)" onMouseOut="lolite()" onClick="logVariable('reportlist')" href="../../../_variables/reportlist.html">$reportlist</a>;
<a name="l365"><span class="linenum"> 365</span></a>  }
<a name="l366"><span class="linenum"> 366</span></a>  
<a name="l367"><span class="linenum"> 367</span></a>  <span class="comment">/**</span>
<a name="l368"><span class="linenum"> 368</span></a>  <span class="comment"> * Create a filename for use when downloading data from a quiz report. It is</span>
<a name="l369"><span class="linenum"> 369</span></a>  <span class="comment"> * expected that this will be passed to flexible_table::is_downloading, which</span>
<a name="l370"><span class="linenum"> 370</span></a>  <span class="comment"> * cleans the filename of bad characters and adds the file extension.</span>
<a name="l371"><span class="linenum"> 371</span></a>  <span class="comment"> * @param string $report the type of report.</span>
<a name="l372"><span class="linenum"> 372</span></a>  <span class="comment"> * @param string $courseshortname the course shortname.</span>
<a name="l373"><span class="linenum"> 373</span></a>  <span class="comment"> * @param string $quizname the quiz name.</span>
<a name="l374"><span class="linenum"> 374</span></a>  <span class="comment"> * @return string the filename.</span>
<a name="l375"><span class="linenum"> 375</span></a>  <span class="comment"> */</span>
<a name="l376"><span class="linenum"> 376</span></a>  function <a class="function" onClick="logFunction('quiz_report_download_filename')" href="../../../_functions/quiz_report_download_filename.html" onMouseOver="funcPopup(event,'quiz_report_download_filename')">quiz_report_download_filename</a>(<a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../../_variables/report.html">$report</a>, <a class="var it4713" onMouseOver="hilite(4713)" onMouseOut="lolite()" onClick="logVariable('courseshortname')" href="../../../_variables/courseshortname.html">$courseshortname</a>, <a class="var it15977" onMouseOver="hilite(15977)" onMouseOut="lolite()" onClick="logVariable('quizname')" href="../../../_variables/quizname.html">$quizname</a>) {
<a name="l377"><span class="linenum"> 377</span></a>      return <a class="var it4713" onMouseOver="hilite(4713)" onMouseOut="lolite()" onClick="logVariable('courseshortname')" href="../../../_variables/courseshortname.html">$courseshortname</a> . '-' . <a class="function" onClick="logFunction('format_string')" href="../../../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it15977" onMouseOver="hilite(15977)" onMouseOut="lolite()" onClick="logVariable('quizname')" href="../../../_variables/quizname.html">$quizname</a>, true) . '-' . <a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../../_variables/report.html">$report</a>;
<a name="l378"><span class="linenum"> 378</span></a>  }
<a name="l379"><span class="linenum"> 379</span></a>  
<a name="l380"><span class="linenum"> 380</span></a>  <span class="comment">/**</span>
<a name="l381"><span class="linenum"> 381</span></a>  <span class="comment"> * Get the default report for the current user.</span>
<a name="l382"><span class="linenum"> 382</span></a>  <span class="comment"> * @param object $context the quiz context.</span>
<a name="l383"><span class="linenum"> 383</span></a>  <span class="comment"> */</span>
<a name="l384"><span class="linenum"> 384</span></a>  function <a class="function" onClick="logFunction('quiz_report_default_report')" href="../../../_functions/quiz_report_default_report.html" onMouseOver="funcPopup(event,'quiz_report_default_report')">quiz_report_default_report</a>(<a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../_variables/context.html">$context</a>) {
<a name="l385"><span class="linenum"> 385</span></a>      <a class="var it1891" onMouseOver="hilite(1891)" onMouseOut="lolite()" onClick="logVariable('reports')" href="../../../_variables/reports.html">$reports</a> = <a class="function" onClick="logFunction('quiz_report_list')" href="../../../_functions/quiz_report_list.html" onMouseOver="funcPopup(event,'quiz_report_list')">quiz_report_list</a>(<a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../_variables/context.html">$context</a>);
<a name="l386"><span class="linenum"> 386</span></a>      return <a class="phpfunction" onClick="logFunction('reset')" href="../../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it1891" onMouseOver="hilite(1891)" onMouseOut="lolite()" onClick="logVariable('reports')" href="../../../_variables/reports.html">$reports</a>);
<a name="l387"><span class="linenum"> 387</span></a>  }
<a name="l388"><span class="linenum"> 388</span></a>  
<a name="l389"><span class="linenum"> 389</span></a>  <span class="comment">/**</span>
<a name="l390"><span class="linenum"> 390</span></a>  <span class="comment"> * Generate a message saying that this quiz has no questions, with a button to</span>
<a name="l391"><span class="linenum"> 391</span></a>  <span class="comment"> * go to the edit page, if the user has the right capability.</span>
<a name="l392"><span class="linenum"> 392</span></a>  <span class="comment"> * @param object $quiz the quiz settings.</span>
<a name="l393"><span class="linenum"> 393</span></a>  <span class="comment"> * @param object $cm the course_module object.</span>
<a name="l394"><span class="linenum"> 394</span></a>  <span class="comment"> * @param object $context the quiz context.</span>
<a name="l395"><span class="linenum"> 395</span></a>  <span class="comment"> * @return string HTML to output.</span>
<a name="l396"><span class="linenum"> 396</span></a>  <span class="comment"> */</span>
<a name="l397"><span class="linenum"> 397</span></a>  function <a class="function" onClick="logFunction('quiz_no_questions_message')" href="../../../_functions/quiz_no_questions_message.html" onMouseOver="funcPopup(event,'quiz_no_questions_message')">quiz_no_questions_message</a>(<a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>, <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../../_variables/cm.html">$cm</a>, <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../_variables/context.html">$context</a>) {
<a name="l398"><span class="linenum"> 398</span></a>      global <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>;
<a name="l399"><span class="linenum"> 399</span></a>  
<a name="l400"><span class="linenum"> 400</span></a>      <a class="var it71" onMouseOver="hilite(71)" onMouseOut="lolite()" onClick="logVariable('output')" href="../../../_variables/output.html">$output</a> = '';
<a name="l401"><span class="linenum"> 401</span></a>      <a class="var it71" onMouseOver="hilite(71)" onMouseOut="lolite()" onClick="logVariable('output')" href="../../../_variables/output.html">$output</a> .= <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../../../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('noquestions', 'quiz'));
<a name="l402"><span class="linenum"> 402</span></a>      if (<a class="function" onClick="logFunction('has_capability')" href="../../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('mod/quiz:manage', <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../_variables/context.html">$context</a>)) {
<a name="l403"><span class="linenum"> 403</span></a>          <a class="var it71" onMouseOver="hilite(71)" onMouseOut="lolite()" onClick="logVariable('output')" href="../../../_variables/output.html">$output</a> .= <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('single_button')" href="../../../_functions/single_button.html" onMouseOver="funcPopup(event,'single_button')">single_button</a>(<span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../../mod/quiz/edit.php.html">/mod/quiz/edit.php</a>',
<a name="l404"><span class="linenum"> 404</span></a>          array('cmid' =&gt; <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>)), <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('editquiz', 'quiz'), 'get');
<a name="l405"><span class="linenum"> 405</span></a>      }
<a name="l406"><span class="linenum"> 406</span></a>  
<a name="l407"><span class="linenum"> 407</span></a>      return <a class="var it71" onMouseOver="hilite(71)" onMouseOut="lolite()" onClick="logVariable('output')" href="../../../_variables/output.html">$output</a>;
<a name="l408"><span class="linenum"> 408</span></a>  }
<a name="l409"><span class="linenum"> 409</span></a>  
<a name="l410"><span class="linenum"> 410</span></a>  <span class="comment">/**</span>
<a name="l411"><span class="linenum"> 411</span></a>  <span class="comment"> * Should the grades be displayed in this report. That depends on the quiz</span>
<a name="l412"><span class="linenum"> 412</span></a>  <span class="comment"> * display options, and whether the quiz is graded.</span>
<a name="l413"><span class="linenum"> 413</span></a>  <span class="comment"> * @param object $quiz the quiz settings.</span>
<a name="l414"><span class="linenum"> 414</span></a>  <span class="comment"> * @param context $context the quiz context.</span>
<a name="l415"><span class="linenum"> 415</span></a>  <span class="comment"> * @return bool</span>
<a name="l416"><span class="linenum"> 416</span></a>  <span class="comment"> */</span>
<a name="l417"><span class="linenum"> 417</span></a>  function <a class="function" onClick="logFunction('quiz_report_should_show_grades')" href="../../../_functions/quiz_report_should_show_grades.html" onMouseOver="funcPopup(event,'quiz_report_should_show_grades')">quiz_report_should_show_grades</a>(<a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>, context <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../_variables/context.html">$context</a>) {
<a name="l418"><span class="linenum"> 418</span></a>      if (<a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('timeclose')" class="var it39928" onMouseOver="hilite(39928)" onMouseOut="lolite()" href="../../../_variables/timeclose.html">timeclose</a> &amp;&amp; <a class="phpfunction" onClick="logFunction('time')" href="../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() &gt; <a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('timeclose')" class="var it39928" onMouseOver="hilite(39928)" onMouseOut="lolite()" href="../../../_variables/timeclose.html">timeclose</a>) {
<a name="l419"><span class="linenum"> 419</span></a>          <a class="var it5143" onMouseOver="hilite(5143)" onMouseOut="lolite()" onClick="logVariable('when')" href="../../../_variables/when.html">$when</a> = <a class="class" onClick="logClass('mod_quiz_display_options')" href="../../../_classes/mod_quiz_display_options.html" onMouseOver="classPopup(event,'mod_quiz_display_options')">mod_quiz_display_options</a>::AFTER_CLOSE;
<a name="l420"><span class="linenum"> 420</span></a>      } else {
<a name="l421"><span class="linenum"> 421</span></a>          <a class="var it5143" onMouseOver="hilite(5143)" onMouseOut="lolite()" onClick="logVariable('when')" href="../../../_variables/when.html">$when</a> = <a class="class" onClick="logClass('mod_quiz_display_options')" href="../../../_classes/mod_quiz_display_options.html" onMouseOver="classPopup(event,'mod_quiz_display_options')">mod_quiz_display_options</a>::LATER_WHILE_OPEN;
<a name="l422"><span class="linenum"> 422</span></a>      }
<a name="l423"><span class="linenum"> 423</span></a>      <a class="var it17604" onMouseOver="hilite(17604)" onMouseOut="lolite()" onClick="logVariable('reviewoptions')" href="../../../_variables/reviewoptions.html">$reviewoptions</a> = <a class="class" onClick="logClass('mod_quiz_display_options')" href="../../../_classes/mod_quiz_display_options.html" onMouseOver="classPopup(event,'mod_quiz_display_options')">mod_quiz_display_options</a>::<a class="function" onClick="logFunction('make_from_quiz')" href="../../../_functions/make_from_quiz.html" onMouseOver="funcPopup(event,'make_from_quiz')">make_from_quiz</a>(<a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>, <a class="var it5143" onMouseOver="hilite(5143)" onMouseOut="lolite()" onClick="logVariable('when')" href="../../../_variables/when.html">$when</a>);
<a name="l424"><span class="linenum"> 424</span></a>  
<a name="l425"><span class="linenum"> 425</span></a>      return <a class="function" onClick="logFunction('quiz_has_grades')" href="../../../_functions/quiz_has_grades.html" onMouseOver="funcPopup(event,'quiz_has_grades')">quiz_has_grades</a>(<a class="var it998" onMouseOver="hilite(998)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../../_variables/quiz.html">$quiz</a>) &amp;&amp;
<a name="l426"><span class="linenum"> 426</span></a>              (<a class="var it17604" onMouseOver="hilite(17604)" onMouseOut="lolite()" onClick="logVariable('reviewoptions')" href="../../../_variables/reviewoptions.html">$reviewoptions</a>-&gt;<a onClick="logVariable('marks')" class="var it40840" onMouseOver="hilite(40840)" onMouseOut="lolite()" href="../../../_variables/marks.html">marks</a> &gt;= <a class="class" onClick="logClass('question_display_options')" href="../../../_classes/question_display_options.html" onMouseOver="classPopup(event,'question_display_options')">question_display_options</a>::MARK_AND_MAX ||
<a name="l427"><span class="linenum"> 427</span></a>              <a class="function" onClick="logFunction('has_capability')" href="../../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/grade:viewhidden', <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../_variables/context.html">$context</a>));
<a name="l428"><span class="linenum"> 428</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'get_records_sql_menu': ['get_records_sql_menu', 'Get the first two columns from a number of records as an associative array using a SQL statement. ', [['lib/dml','moodle_database.php',1387]], 33],
'quiz_format_grade': ['quiz_format_grade', 'Round a grade to to the correct number of decimal places, and format it for display. ', [['mod/quiz','lib.php',627]], 35],
'exists': ['exists', 'Checks whether or not the variable exists. ', [['lib/htmlpurifier/HTMLPurifier','Context.php',73],['lib/horde/framework/Horde','Variables.php',101],['admin/tool/health','index.php',139],['admin/tool/health','index.php',160],['admin/tool/health','index.php',184],['admin/tool/health','index.php',208],['admin/tool/health','index.php',229],['admin/tool/health','index.php',248],['admin/tool/health','index.php',267],['admin/tool/health','index.php',313],['admin/tool/health','index.php',334],['admin/tool/health','index.php',420],['admin/tool/health','index.php',444],['admin/tool/health','index.php',481],['admin/tool/health','index.php',506],['admin/tool/health','index.php',554],['admin/tool/health','index.php',617],['admin/tool/health','index.php',707],['admin/tool/health','index.php',777],['lib/horde/framework/Horde/Imap/Client/Data','Fetch.php',468],['admin/tool/uploadcourse/classes','course.php',252]], 56],
'format_string': ['format_string', 'Given a simple string, this function returns the string processed by enabled string filters if $CFG->filterall is enabled ', [['lib','weblib.php',1318]], 854],
'quiz_has_questions': ['quiz_has_questions', 'Are there any questions in this quiz? ', [['mod/quiz/report','reportlib.php',80]], 4],
'notification': ['notification', 'Output a notification (that is, a status message about something that has just happened). ', [['lib','outputrenderers.php',2762],['lib','outputrenderers.php',4128],['lib','outputrenderers.php',4201]], 495],
'debugging': ['debugging', 'Standard Debugging Function ', [['lib','weblib.php',2854]], 853],
'quiz_report_default_report': ['quiz_report_default_report', 'Get the default report for the current user. ', [['mod/quiz/report','reportlib.php',380]], 2],
'quiz_report_highlighting_grading_method': ['quiz_report_highlighting_grading_method', '', [['mod/quiz/report','reportlib.php',245]], 2],
'has_capability': ['has_capability', 'Wrapper round the has_capability funciton that automatically passes in the quiz context. ', [['mod/quiz','attemptlib.php',299],['mod/quiz','attemptlib.php',884],['lib','accesslib.php',346]], 1929],
'get_string': ['get_string', 'Return a core get_string() call ', [['lib/external','externallib.php',112],['lib','moodlelib.php',6538],['lib','moodlelib.php',9417],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38],['lib/classes','string_manager_install.php',95],['question/behaviour','behaviourbase.php',756]], 19235],
'quiz_report_should_show_grades': ['quiz_report_should_show_grades', 'Should the grades be displayed in this report. That depends on the quiz display options, and whether the quiz is graded. ', [['mod/quiz/report','reportlib.php',410]], 1],
'get_records': ['get_records', 'Get a number of records as an array of objects where all the given conditions met. ', [['lib/dml','moodle_database.php',1236],['lib','coursecatlib.php',654],['question','category_class.php',63]], 860],
'quiz_report_download_filename': ['quiz_report_download_filename', 'Create a filename for use when downloading data from a quiz report. It is expected that this will be passed to flexible_table::is_downloading, which cleans the filename of bad characters and adds the file extension. ', [['mod/quiz/report','reportlib.php',367]], 3],
'record_exists': ['record_exists', 'Test whether a record exists in a table where all the given conditions met. ', [['lib/dml','moodle_database.php',1768]], 735],
'quiz_report_grade_method_sql': ['quiz_report_grade_method_sql', 'Given a quiz grading method return sql to test if this is an attempt that will be contribute towards the grade of the user. Or return an empty string if the grading method is QUIZ_GRADEAVERAGE and thus all attempts contribute to final grade. ', [['mod/quiz/report','reportlib.php',146]], 2],
'quiz_report_can_filter_only_graded': ['quiz_report_can_filter_only_graded', '', [['mod/quiz/report','reportlib.php',126]], 2],
'quiz_report_qm_filter_select': ['quiz_report_qm_filter_select', 'This is a wrapper for {@link quiz_report_grade_method_sql} that takes the whole quiz object instead of just the grading method as a param. See definition for {@link quiz_report_grade_method_sql} below. ', [['mod/quiz/report','reportlib.php',130]], 7],
'quiz_report_grade_bands': ['quiz_report_grade_bands', 'Get the number of students whose score was in a particular band for this quiz. ', [['mod/quiz/report','reportlib.php',189]], 1],
'quiz_report_get_significant_questions': ['quiz_report_get_significant_questions', 'Get the slots of real questions (not descriptions) in this quiz, in order. ', [['mod/quiz/report','reportlib.php',89]], 5],
'list': ['list', '', [['mod/data/preset/imagegallery','jstemplate.js',9]], 1891],
'quiz_report_list': ['quiz_report_list', 'Returns an array of reports to which the current user has access to. ', [['mod/quiz/report','reportlib.php',327]], 4],
'quiz_has_grades': ['quiz_has_grades', 'Is this a graded quiz? If this method returns true, you can assume that $quiz->grade and $quiz->sumgrades are non-zero (for example, if you want to divide by them). ', [['mod/quiz','lib.php',414]], 11],
'quiz_no_questions_message': ['quiz_no_questions_message', 'Generate a message saying that this quiz has no questions, with a button to go to the edit page, if the user has the right capability. ', [['mod/quiz/report','reportlib.php',389]], 4],
'quiz_report_unindex': ['quiz_report_unindex', '', [['mod/quiz/report','reportlib.php',65]], 1],
'quiz_get_grading_option_name': ['quiz_get_grading_option_name', '', [['mod/quiz','locallib.php',1160]], 4],
'get_records_sql': ['get_records_sql', 'Get a number of records as an array of objects using a SQL statement. ', [['lib/dml','pgsql_native_moodle_database.php',732],['lib/dml','oci_native_moodle_database.php',1102],['lib/dml','sqlsrv_native_moodle_database.php',823],['lib/dml','mssql_native_moodle_database.php',741],['lib/dml','mysqli_native_moodle_database.php',1049],['lib/dml/tests','dml_test.php',5424],['lib/dml','pdo_moodle_database.php',308]], 678],
'quiz_report_scale_summarks_as_percentage': ['quiz_report_scale_summarks_as_percentage', 'Format a number as a percentage out of $quiz->sumgrades ', [['mod/quiz/report','reportlib.php',306]], 5],
'quiz_report_index_by_keys': ['quiz_report_index_by_keys', 'Takes an array of objects and constructs a multidimensional array keyed by the keys it finds on the object. ', [['mod/quiz/report','reportlib.php',31]], 4],
'quiz_report_feedback_for_grade': ['quiz_report_feedback_for_grade', 'Get the feedback text for a grade on this quiz. The feedback is processed ready for display. ', [['mod/quiz/report','reportlib.php',262]], 2],
'get_plugin_list': ['get_plugin_list', 'Get list of plugins of given type. ', [['lib/classes','component.php',781],['lib','deprecatedlib.php',467],['admin/tool/monitor/classes','eventlist.php',176]], 184],
'get_in_or_equal': ['get_in_or_equal', 'Constructs \'IN()\' or \'=\' sql fragment ', [['lib/dml','oci_native_moodle_database.php',1583],['lib/dml','moodle_database.php',678]], 375],
'single_button': ['single_button', 'Returns a form with a single button. ', [['lib','outputrenderers.php',1735]], 298],
'from': ['from', 'From clause ', [['lib/zend/Zend/Service/WindowsAzure/Storage','TableEntityQuery.php',84]], 226],
'file_rewrite_pluginfile_urls': ['file_rewrite_pluginfile_urls', 'Convert encoded URLs in $text from the @@PLUGINFILE@@/... form to an actual URL. ', [['lib','filelib.php',446]], 85],
'make_from_quiz': ['make_from_quiz', 'Set up the various options from the quiz settings, and a time constant. ', [['mod/quiz','locallib.php',1848]], 12],
'format_text': ['format_text', 'Given text in a variety of format codings, this function returns the text as safe HTML. ', [['lib','weblib.php',1115],['lib','tablelib.php',846],['lib','tablelib.php',1583],['lib','tablelib.php',1900],['question/type','questionbase.php',345],['lib/classes','grading_external.php',182]], 325],
'floor': ['floor', '', [], 467],
'is_array': ['is_array', '', [], 1820],
'count': ['count', '', [], 3984],
'time': ['time', '', [], 1768],
'array_shift': ['array_shift', '', [], 607],
'array_key_exists': ['array_key_exists', '', [], 1539],
'gettype': ['gettype', '', [], 288],
'is_null': ['is_null', '', [], 1992],
'is_numeric': ['is_numeric', '', [], 723],
'array_merge': ['array_merge', '', [], 2320],
'max': ['max', '', [], 1096],
'ksort': ['ksort', '', [], 158],
'defined': ['defined', '', [], 4098],
'reset': ['reset', '', [], 1070],
'array_fill': ['array_fill', '', [], 59]};
CLASS_DATA={
'mod_quiz_display_options': ['mod_quiz_display_options', 'An extension of question_display_options that includes the extra options used by the quiz. ', [['mod/quiz','locallib.php',1818]], 99],
'moodle_url': ['moodle_url', 'Class for creating and manipulating urls. ', [['lib','weblib.php',240]], 2887],
'question_display_options': ['question_display_options', 'This class contains all the options that controls how a question is displayed. ', [['question/engine','lib.php',461]], 78],
'core_component': ['core_component', 'Collection of components related methods. ', [['lib/classes','component.php',41]], 485]};
CONST_DATA={
'DEBUG_DEVELOPER': ['DEBUG_DEVELOPER', '', [['lib','setuplib.php',40]], 554],
'QUIZ_GRADEHIGHEST': ['QUIZ_GRADEHIGHEST', '', [['mod/quiz','lib.php',48]], 15],
'FORMAT_MOODLE': ['FORMAT_MOODLE', '', [['lib','weblib.php',42]], 378],
'QUIZ_ATTEMPTLAST': ['QUIZ_ATTEMPTLAST', '', [['mod/quiz','lib.php',51]], 11],
'SQL_PARAMS_NAMED': ['SQL_PARAMS_NAMED', '', [['lib/dml','moodle_database.php',32]], 271],
'QUIZ_GRADEAVERAGE': ['QUIZ_GRADEAVERAGE', '', [['mod/quiz','lib.php',49]], 15],
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',138],['','install.php',93],['lib','setup.php',386]], 3532],
'QUIZ_ATTEMPTFIRST': ['QUIZ_ATTEMPTFIRST', '', [['mod/quiz','lib.php',50]], 11]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu May 28 19:17:31 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
