<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /mod/quiz/locallib.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Aug 11 10:00:09 2016 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='mod/quiz';
filename='locallib.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/mod/quiz/</a> -> <a href="locallib.php.html">locallib.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="locallib.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="locallib.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * Library of functions used by the quiz module.</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * This contains functions that are called from within the quiz module only</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * Functions that are also called by core Moodle are in {@link lib.php}</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * This script also loads the code in {@link questionlib.php} which holds</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * the module-indpendent code for handling questions and which in turn</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> * initialises all the questiontype classes.</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment"> *</span>
<a name="l26"><span class="linenum">  26</span></a>  <span class="comment"> * @package    mod_quiz</span>
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment"> * @copyright  1999 onwards Martin Dougiamas and others {@link http://moodle.com}</span>
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment"> */</span>
<a name="l30"><span class="linenum">  30</span></a>  
<a name="l31"><span class="linenum">  31</span></a>  
<a name="l32"><span class="linenum">  32</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die();
<a name="l33"><span class="linenum">  33</span></a>  
<a name="l34"><span class="linenum">  34</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a> . '<a class="filename" href="../../mod/quiz/lib.php.html">/mod/quiz/lib.php</a>');
<a name="l35"><span class="linenum">  35</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a> . '<a class="filename" href="../../mod/quiz/accessmanager.php.html">/mod/quiz/accessmanager.php</a>');
<a name="l36"><span class="linenum">  36</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a> . '<a class="filename" href="../../mod/quiz/accessmanager_form.php.html">/mod/quiz/accessmanager_form.php</a>');
<a name="l37"><span class="linenum">  37</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a> . '<a class="filename" href="../../mod/quiz/renderer.php.html">/mod/quiz/renderer.php</a>');
<a name="l38"><span class="linenum">  38</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a> . '<a class="filename" href="../../mod/quiz/attemptlib.php.html">/mod/quiz/attemptlib.php</a>');
<a name="l39"><span class="linenum">  39</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a> . '/completionlib.php');
<a name="l40"><span class="linenum">  40</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a> . '/eventslib.php');
<a name="l41"><span class="linenum">  41</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a> . '/filelib.php');
<a name="l42"><span class="linenum">  42</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a> . '/questionlib.php');
<a name="l43"><span class="linenum">  43</span></a>  
<a name="l44"><span class="linenum">  44</span></a>  
<a name="l45"><span class="linenum">  45</span></a>  <span class="comment">/**</span>
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment"> * @var int We show the countdown timer if there is less than this amount of time left before the</span>
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment"> * the quiz close date. (1 hour)</span>
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment"> */</span>
<a name="l49"><span class="linenum">  49</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('QUIZ_SHOW_TIME_BEFORE_DEADLINE')" href="../../_constants/QUIZ_SHOW_TIME_BEFORE_DEADLINE.html" onMouseOver="constPopup(event,'QUIZ_SHOW_TIME_BEFORE_DEADLINE')">QUIZ_SHOW_TIME_BEFORE_DEADLINE</a>', '3600');
<a name="l50"><span class="linenum">  50</span></a>  
<a name="l51"><span class="linenum">  51</span></a>  <span class="comment">/**</span>
<a name="l52"><span class="linenum">  52</span></a>  <span class="comment"> * @var int If there are fewer than this many seconds left when the student submits</span>
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment"> * a page of the quiz, then do not take them to the next page of the quiz. Instead</span>
<a name="l54"><span class="linenum">  54</span></a>  <span class="comment"> * close the quiz immediately.</span>
<a name="l55"><span class="linenum">  55</span></a>  <span class="comment"> */</span>
<a name="l56"><span class="linenum">  56</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('QUIZ_MIN_TIME_TO_CONTINUE')" href="../../_constants/QUIZ_MIN_TIME_TO_CONTINUE.html" onMouseOver="constPopup(event,'QUIZ_MIN_TIME_TO_CONTINUE')">QUIZ_MIN_TIME_TO_CONTINUE</a>', '2');
<a name="l57"><span class="linenum">  57</span></a>  
<a name="l58"><span class="linenum">  58</span></a>  <span class="comment">/**</span>
<a name="l59"><span class="linenum">  59</span></a>  <span class="comment"> * @var int We show no image when user selects No image from dropdown menu in quiz settings.</span>
<a name="l60"><span class="linenum">  60</span></a>  <span class="comment"> */</span>
<a name="l61"><span class="linenum">  61</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('QUIZ_SHOWIMAGE_NONE')" href="../../_constants/QUIZ_SHOWIMAGE_NONE.html" onMouseOver="constPopup(event,'QUIZ_SHOWIMAGE_NONE')">QUIZ_SHOWIMAGE_NONE</a>', 0);
<a name="l62"><span class="linenum">  62</span></a>  
<a name="l63"><span class="linenum">  63</span></a>  <span class="comment">/**</span>
<a name="l64"><span class="linenum">  64</span></a>  <span class="comment"> * @var int We show small image when user selects small image from dropdown menu in quiz settings.</span>
<a name="l65"><span class="linenum">  65</span></a>  <span class="comment"> */</span>
<a name="l66"><span class="linenum">  66</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('QUIZ_SHOWIMAGE_SMALL')" href="../../_constants/QUIZ_SHOWIMAGE_SMALL.html" onMouseOver="constPopup(event,'QUIZ_SHOWIMAGE_SMALL')">QUIZ_SHOWIMAGE_SMALL</a>', 1);
<a name="l67"><span class="linenum">  67</span></a>  
<a name="l68"><span class="linenum">  68</span></a>  <span class="comment">/**</span>
<a name="l69"><span class="linenum">  69</span></a>  <span class="comment"> * @var int We show Large image when user selects Large image from dropdown menu in quiz settings.</span>
<a name="l70"><span class="linenum">  70</span></a>  <span class="comment"> */</span>
<a name="l71"><span class="linenum">  71</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('QUIZ_SHOWIMAGE_LARGE')" href="../../_constants/QUIZ_SHOWIMAGE_LARGE.html" onMouseOver="constPopup(event,'QUIZ_SHOWIMAGE_LARGE')">QUIZ_SHOWIMAGE_LARGE</a>', 2);
<a name="l72"><span class="linenum">  72</span></a>  
<a name="l73"><span class="linenum">  73</span></a>  
<a name="l74"><span class="linenum">  74</span></a>  <span class="comment">// Functions related to attempts ///////////////////////////////////////////////</span>
<a name="l75"><span class="linenum">  75</span></a>  
<a name="l76"><span class="linenum">  76</span></a>  <span class="comment">/**</span>
<a name="l77"><span class="linenum">  77</span></a>  <span class="comment"> * Creates an object to represent a new attempt at a quiz</span>
<a name="l78"><span class="linenum">  78</span></a>  <span class="comment"> *</span>
<a name="l79"><span class="linenum">  79</span></a>  <span class="comment"> * Creates an attempt object to represent an attempt at the quiz by the current</span>
<a name="l80"><span class="linenum">  80</span></a>  <span class="comment"> * user starting at the current time. The -&gt;id field is not set. The object is</span>
<a name="l81"><span class="linenum">  81</span></a>  <span class="comment"> * NOT written to the database.</span>
<a name="l82"><span class="linenum">  82</span></a>  <span class="comment"> *</span>
<a name="l83"><span class="linenum">  83</span></a>  <span class="comment"> * @param object $quizobj the quiz object to create an attempt for.</span>
<a name="l84"><span class="linenum">  84</span></a>  <span class="comment"> * @param int $attemptnumber the sequence number for the attempt.</span>
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment"> * @param object $lastattempt the previous attempt by this user, if any. Only needed</span>
<a name="l86"><span class="linenum">  86</span></a>  <span class="comment"> *         if $attemptnumber &gt; 1 and $quiz-&gt;attemptonlast is true.</span>
<a name="l87"><span class="linenum">  87</span></a>  <span class="comment"> * @param int $timenow the time the attempt was started at.</span>
<a name="l88"><span class="linenum">  88</span></a>  <span class="comment"> * @param bool $ispreview whether this new attempt is a preview.</span>
<a name="l89"><span class="linenum">  89</span></a>  <span class="comment"> * @param int $userid  the id of the user attempting this quiz.</span>
<a name="l90"><span class="linenum">  90</span></a>  <span class="comment"> *</span>
<a name="l91"><span class="linenum">  91</span></a>  <span class="comment"> * @return object the newly created attempt object.</span>
<a name="l92"><span class="linenum">  92</span></a>  <span class="comment"> */</span>
<a name="l93"><span class="linenum">  93</span></a>  function <a class="function" onClick="logFunction('quiz_create_attempt')" href="../../_functions/quiz_create_attempt.html" onMouseOver="funcPopup(event,'quiz_create_attempt')">quiz_create_attempt</a>(quiz <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>, <a class="var it282" onMouseOver="hilite(282)" onMouseOut="lolite()" onClick="logVariable('attemptnumber')" href="../../_variables/attemptnumber.html">$attemptnumber</a>, <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>, <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a>, <a class="var it39500" onMouseOver="hilite(39500)" onMouseOut="lolite()" onClick="logVariable('ispreview')" href="../../_variables/ispreview.html">$ispreview</a> = false, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a> = null) {
<a name="l94"><span class="linenum">  94</span></a>      global <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>;
<a name="l95"><span class="linenum">  95</span></a>  
<a name="l96"><span class="linenum">  96</span></a>      if (<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a> === null) {
<a name="l97"><span class="linenum">  97</span></a>          <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a> = <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l98"><span class="linenum">  98</span></a>      }
<a name="l99"><span class="linenum">  99</span></a>  
<a name="l100"><span class="linenum"> 100</span></a>      <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a> = <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('get_quiz')" href="../../_functions/get_quiz.html" onMouseOver="funcPopup(event,'get_quiz')">get_quiz</a>();
<a name="l101"><span class="linenum"> 101</span></a>      if (<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('sumgrades')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/sumgrades.html">sumgrades</a> &lt; 0.000005 &amp;&amp; <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('grade')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> &gt; 0.000005) {
<a name="l102"><span class="linenum"> 102</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('cannotstartgradesmismatch', 'quiz',
<a name="l103"><span class="linenum"> 103</span></a>                  <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../mod/quiz/view.php.html">/mod/quiz/view.php</a>', array('q' =&gt; <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>)),
<a name="l104"><span class="linenum"> 104</span></a>                      array('grade' =&gt; <a class="function" onClick="logFunction('quiz_format_grade')" href="../../_functions/quiz_format_grade.html" onMouseOver="funcPopup(event,'quiz_format_grade')">quiz_format_grade</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('grade')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a>)));
<a name="l105"><span class="linenum"> 105</span></a>      }
<a name="l106"><span class="linenum"> 106</span></a>  
<a name="l107"><span class="linenum"> 107</span></a>      if (<a class="var it282" onMouseOver="hilite(282)" onMouseOut="lolite()" onClick="logVariable('attemptnumber')" href="../../_variables/attemptnumber.html">$attemptnumber</a> == 1 || !<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('attemptonlast')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/attemptonlast.html">attemptonlast</a>) {
<a name="l108"><span class="linenum"> 108</span></a>  <span class="comment">        // We are not building on last attempt so create a new attempt.</span>
<a name="l109"><span class="linenum"> 109</span></a>          <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a> = new stdClass();
<a name="l110"><span class="linenum"> 110</span></a>          <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('quiz')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/quiz.html">quiz</a> = <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l111"><span class="linenum"> 111</span></a>          <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('userid')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> = <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>;
<a name="l112"><span class="linenum"> 112</span></a>          <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('preview')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/preview.html">preview</a> = 0;
<a name="l113"><span class="linenum"> 113</span></a>          <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('layout')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/layout.html">layout</a> = '';
<a name="l114"><span class="linenum"> 114</span></a>      } else {
<a name="l115"><span class="linenum"> 115</span></a>  <span class="comment">        // Build on last attempt.</span>
<a name="l116"><span class="linenum"> 116</span></a>          if (empty(<a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>)) {
<a name="l117"><span class="linenum"> 117</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('cannotfindprevattempt', 'quiz');
<a name="l118"><span class="linenum"> 118</span></a>          }
<a name="l119"><span class="linenum"> 119</span></a>          <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a> = <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>;
<a name="l120"><span class="linenum"> 120</span></a>      }
<a name="l121"><span class="linenum"> 121</span></a>  
<a name="l122"><span class="linenum"> 122</span></a>      <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('attempt')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/attempt.html">attempt</a> = <a class="var it282" onMouseOver="hilite(282)" onMouseOut="lolite()" onClick="logVariable('attemptnumber')" href="../../_variables/attemptnumber.html">$attemptnumber</a>;
<a name="l123"><span class="linenum"> 123</span></a>      <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('timestart')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/timestart.html">timestart</a> = <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a>;
<a name="l124"><span class="linenum"> 124</span></a>      <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('timefinish')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/timefinish.html">timefinish</a> = 0;
<a name="l125"><span class="linenum"> 125</span></a>      <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('timemodified')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a>;
<a name="l126"><span class="linenum"> 126</span></a>      <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('state')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> = <a class="class" onClick="logClass('quiz_attempt')" href="../../_classes/quiz_attempt.html" onMouseOver="classPopup(event,'quiz_attempt')">quiz_attempt</a>::IN_PROGRESS;
<a name="l127"><span class="linenum"> 127</span></a>      <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('currentpage')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/currentpage.html">currentpage</a> = 0;
<a name="l128"><span class="linenum"> 128</span></a>      <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('sumgrades')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/sumgrades.html">sumgrades</a> = null;
<a name="l129"><span class="linenum"> 129</span></a>  
<a name="l130"><span class="linenum"> 130</span></a>  <span class="comment">    // If this is a preview, mark it as such.</span>
<a name="l131"><span class="linenum"> 131</span></a>      if (<a class="var it39500" onMouseOver="hilite(39500)" onMouseOut="lolite()" onClick="logVariable('ispreview')" href="../../_variables/ispreview.html">$ispreview</a>) {
<a name="l132"><span class="linenum"> 132</span></a>          <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('preview')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/preview.html">preview</a> = 1;
<a name="l133"><span class="linenum"> 133</span></a>      }
<a name="l134"><span class="linenum"> 134</span></a>  
<a name="l135"><span class="linenum"> 135</span></a>      <a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('timeclose')" href="../../_variables/timeclose.html">$timeclose</a> = <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('get_access_manager')" href="../../_functions/get_access_manager.html" onMouseOver="funcPopup(event,'get_access_manager')">get_access_manager</a>(<a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a>)-&gt;<a class="function" onClick="logFunction('get_end_time')" href="../../_functions/get_end_time.html" onMouseOver="funcPopup(event,'get_end_time')">get_end_time</a>(<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>);
<a name="l136"><span class="linenum"> 136</span></a>      if (<a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('timeclose')" href="../../_variables/timeclose.html">$timeclose</a> === false || <a class="var it39500" onMouseOver="hilite(39500)" onMouseOut="lolite()" onClick="logVariable('ispreview')" href="../../_variables/ispreview.html">$ispreview</a>) {
<a name="l137"><span class="linenum"> 137</span></a>          <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('timecheckstate')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/timecheckstate.html">timecheckstate</a> = null;
<a name="l138"><span class="linenum"> 138</span></a>      } else {
<a name="l139"><span class="linenum"> 139</span></a>          <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('timecheckstate')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/timecheckstate.html">timecheckstate</a> = <a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('timeclose')" href="../../_variables/timeclose.html">$timeclose</a>;
<a name="l140"><span class="linenum"> 140</span></a>      }
<a name="l141"><span class="linenum"> 141</span></a>  
<a name="l142"><span class="linenum"> 142</span></a>      return <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>;
<a name="l143"><span class="linenum"> 143</span></a>  }
<a name="l144"><span class="linenum"> 144</span></a>  <span class="comment">/**</span>
<a name="l145"><span class="linenum"> 145</span></a>  <span class="comment"> * Start a normal, new, quiz attempt.</span>
<a name="l146"><span class="linenum"> 146</span></a>  <span class="comment"> *</span>
<a name="l147"><span class="linenum"> 147</span></a>  <span class="comment"> * @param quiz      $quizobj            the quiz object to start an attempt for.</span>
<a name="l148"><span class="linenum"> 148</span></a>  <span class="comment"> * @param question_usage_by_activity $quba</span>
<a name="l149"><span class="linenum"> 149</span></a>  <span class="comment"> * @param object    $attempt</span>
<a name="l150"><span class="linenum"> 150</span></a>  <span class="comment"> * @param integer   $attemptnumber      starting from 1</span>
<a name="l151"><span class="linenum"> 151</span></a>  <span class="comment"> * @param integer   $timenow            the attempt start time</span>
<a name="l152"><span class="linenum"> 152</span></a>  <span class="comment"> * @param array     $questionids        slot number =&gt; question id. Used for random questions, to force the choice</span>
<a name="l153"><span class="linenum"> 153</span></a>  <span class="comment"> *                                        of a particular actual question. Intended for testing purposes only.</span>
<a name="l154"><span class="linenum"> 154</span></a>  <span class="comment"> * @param array     $forcedvariantsbyslot slot number =&gt; variant. Used for questions with variants,</span>
<a name="l155"><span class="linenum"> 155</span></a>  <span class="comment"> *                                          to force the choice of a particular variant. Intended for testing</span>
<a name="l156"><span class="linenum"> 156</span></a>  <span class="comment"> *                                          purposes only.</span>
<a name="l157"><span class="linenum"> 157</span></a>  <span class="comment"> * @throws moodle_exception</span>
<a name="l158"><span class="linenum"> 158</span></a>  <span class="comment"> * @return object   modified attempt object</span>
<a name="l159"><span class="linenum"> 159</span></a>  <span class="comment"> */</span>
<a name="l160"><span class="linenum"> 160</span></a>  function <a class="function" onClick="logFunction('quiz_start_new_attempt')" href="../../_functions/quiz_start_new_attempt.html" onMouseOver="funcPopup(event,'quiz_start_new_attempt')">quiz_start_new_attempt</a>(<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>, <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>, <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>, <a class="var it282" onMouseOver="hilite(282)" onMouseOut="lolite()" onClick="logVariable('attemptnumber')" href="../../_variables/attemptnumber.html">$attemptnumber</a>, <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a>,
<a name="l161"><span class="linenum"> 161</span></a>                                  <a class="var it5865" onMouseOver="hilite(5865)" onMouseOut="lolite()" onClick="logVariable('questionids')" href="../../_variables/questionids.html">$questionids</a> = array(), <a class="var it41424" onMouseOver="hilite(41424)" onMouseOut="lolite()" onClick="logVariable('forcedvariantsbyslot')" href="../../_variables/forcedvariantsbyslot.html">$forcedvariantsbyslot</a> = array()) {
<a name="l162"><span class="linenum"> 162</span></a>  
<a name="l163"><span class="linenum"> 163</span></a>  <span class="comment">    // Usages for this user's previous quiz attempts.</span>
<a name="l164"><span class="linenum"> 164</span></a>      <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a> = new \mod_quiz\question\qubaids_for_users_attempts(
<a name="l165"><span class="linenum"> 165</span></a>              <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('get_quizid')" href="../../_functions/get_quizid.html" onMouseOver="funcPopup(event,'get_quizid')">get_quizid</a>(), <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('userid')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>);
<a name="l166"><span class="linenum"> 166</span></a>  
<a name="l167"><span class="linenum"> 167</span></a>  <span class="comment">    // Fully load all the questions in this quiz.</span>
<a name="l168"><span class="linenum"> 168</span></a>      <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('preload_questions')" href="../../_functions/preload_questions.html" onMouseOver="funcPopup(event,'preload_questions')">preload_questions</a>();
<a name="l169"><span class="linenum"> 169</span></a>      <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('load_questions')" href="../../_functions/load_questions.html" onMouseOver="funcPopup(event,'load_questions')">load_questions</a>();
<a name="l170"><span class="linenum"> 170</span></a>  
<a name="l171"><span class="linenum"> 171</span></a>  <span class="comment">    // First load all the non-random questions.</span>
<a name="l172"><span class="linenum"> 172</span></a>      <a class="var it41425" onMouseOver="hilite(41425)" onMouseOut="lolite()" onClick="logVariable('randomfound')" href="../../_variables/randomfound.html">$randomfound</a> = false;
<a name="l173"><span class="linenum"> 173</span></a>      <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a> = 0;
<a name="l174"><span class="linenum"> 174</span></a>      <a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../../_variables/questions.html">$questions</a> = array();
<a name="l175"><span class="linenum"> 175</span></a>      <a class="var it455" onMouseOver="hilite(455)" onMouseOut="lolite()" onClick="logVariable('maxmark')" href="../../_variables/maxmark.html">$maxmark</a> = array();
<a name="l176"><span class="linenum"> 176</span></a>      <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a> = array();
<a name="l177"><span class="linenum"> 177</span></a>      foreach (<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('get_questions')" href="../../_functions/get_questions.html" onMouseOver="funcPopup(event,'get_questions')">get_questions</a>() as <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('questiondata')" href="../../_variables/questiondata.html">$questiondata</a>) {
<a name="l178"><span class="linenum"> 178</span></a>          <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a> += 1;
<a name="l179"><span class="linenum"> 179</span></a>          <a class="var it455" onMouseOver="hilite(455)" onMouseOut="lolite()" onClick="logVariable('maxmark')" href="../../_variables/maxmark.html">$maxmark</a>[<a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>] = <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('questiondata')" href="../../_variables/questiondata.html">$questiondata</a>-&gt;<a onClick="logVariable('maxmark')" class="var it43218" onMouseOver="hilite(43218)" onMouseOut="lolite()" href="../../_variables/maxmark.html">maxmark</a>;
<a name="l180"><span class="linenum"> 180</span></a>          <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>[<a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>] = <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('questiondata')" href="../../_variables/questiondata.html">$questiondata</a>-&gt;<a onClick="logVariable('page')" class="var it43218" onMouseOver="hilite(43218)" onMouseOut="lolite()" href="../../_variables/page.html">page</a>;
<a name="l181"><span class="linenum"> 181</span></a>          if (<a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('questiondata')" href="../../_variables/questiondata.html">$questiondata</a>-&gt;<a onClick="logVariable('qtype')" class="var it43218" onMouseOver="hilite(43218)" onMouseOut="lolite()" href="../../_variables/qtype.html">qtype</a> == 'random') {
<a name="l182"><span class="linenum"> 182</span></a>              <a class="var it41425" onMouseOver="hilite(41425)" onMouseOut="lolite()" onClick="logVariable('randomfound')" href="../../_variables/randomfound.html">$randomfound</a> = true;
<a name="l183"><span class="linenum"> 183</span></a>              continue;
<a name="l184"><span class="linenum"> 184</span></a>          }
<a name="l185"><span class="linenum"> 185</span></a>          if (!<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('get_quiz')" href="../../_functions/get_quiz.html" onMouseOver="funcPopup(event,'get_quiz')">get_quiz</a>()-&gt;shuffleanswers) {
<a name="l186"><span class="linenum"> 186</span></a>              <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('questiondata')" href="../../_variables/questiondata.html">$questiondata</a>-&gt;<a onClick="logVariable('options')" class="var it43218" onMouseOver="hilite(43218)" onMouseOut="lolite()" href="../../_variables/options.html">options</a>-&gt;shuffleanswers = false;
<a name="l187"><span class="linenum"> 187</span></a>          }
<a name="l188"><span class="linenum"> 188</span></a>          <a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../../_variables/questions.html">$questions</a>[<a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>] = question_bank::<a class="function" onClick="logFunction('make_question')" href="../../_functions/make_question.html" onMouseOver="funcPopup(event,'make_question')">make_question</a>(<a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('questiondata')" href="../../_variables/questiondata.html">$questiondata</a>);
<a name="l189"><span class="linenum"> 189</span></a>      }
<a name="l190"><span class="linenum"> 190</span></a>  
<a name="l191"><span class="linenum"> 191</span></a>  <span class="comment">    // Then find a question to go in place of each random question.</span>
<a name="l192"><span class="linenum"> 192</span></a>      if (<a class="var it41425" onMouseOver="hilite(41425)" onMouseOut="lolite()" onClick="logVariable('randomfound')" href="../../_variables/randomfound.html">$randomfound</a>) {
<a name="l193"><span class="linenum"> 193</span></a>          <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a> = 0;
<a name="l194"><span class="linenum"> 194</span></a>          <a class="var it41426" onMouseOver="hilite(41426)" onMouseOut="lolite()" onClick="logVariable('usedquestionids')" href="../../_variables/usedquestionids.html">$usedquestionids</a> = array();
<a name="l195"><span class="linenum"> 195</span></a>          foreach (<a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../../_variables/questions.html">$questions</a> as <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>) {
<a name="l196"><span class="linenum"> 196</span></a>              if (isset(<a class="var it7540" onMouseOver="hilite(7540)" onMouseOut="lolite()" onClick="logVariable('usedquestions')" href="../../_variables/usedquestions.html">$usedquestions</a>[<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>])) {
<a name="l197"><span class="linenum"> 197</span></a>                  <a class="var it41426" onMouseOver="hilite(41426)" onMouseOut="lolite()" onClick="logVariable('usedquestionids')" href="../../_variables/usedquestionids.html">$usedquestionids</a>[<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>] += 1;
<a name="l198"><span class="linenum"> 198</span></a>              } else {
<a name="l199"><span class="linenum"> 199</span></a>                  <a class="var it41426" onMouseOver="hilite(41426)" onMouseOut="lolite()" onClick="logVariable('usedquestionids')" href="../../_variables/usedquestionids.html">$usedquestionids</a>[<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>] = 1;
<a name="l200"><span class="linenum"> 200</span></a>              }
<a name="l201"><span class="linenum"> 201</span></a>          }
<a name="l202"><span class="linenum"> 202</span></a>          <a class="var it18288" onMouseOver="hilite(18288)" onMouseOut="lolite()" onClick="logVariable('randomloader')" href="../../_variables/randomloader.html">$randomloader</a> = new \core_question\bank\random_question_loader(<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>, <a class="var it41426" onMouseOver="hilite(41426)" onMouseOut="lolite()" onClick="logVariable('usedquestionids')" href="../../_variables/usedquestionids.html">$usedquestionids</a>);
<a name="l203"><span class="linenum"> 203</span></a>  
<a name="l204"><span class="linenum"> 204</span></a>          foreach (<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('get_questions')" href="../../_functions/get_questions.html" onMouseOver="funcPopup(event,'get_questions')">get_questions</a>() as <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('questiondata')" href="../../_variables/questiondata.html">$questiondata</a>) {
<a name="l205"><span class="linenum"> 205</span></a>              <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a> += 1;
<a name="l206"><span class="linenum"> 206</span></a>              if (<a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('questiondata')" href="../../_variables/questiondata.html">$questiondata</a>-&gt;<a onClick="logVariable('qtype')" class="var it43218" onMouseOver="hilite(43218)" onMouseOut="lolite()" href="../../_variables/qtype.html">qtype</a> != 'random') {
<a name="l207"><span class="linenum"> 207</span></a>                  continue;
<a name="l208"><span class="linenum"> 208</span></a>              }
<a name="l209"><span class="linenum"> 209</span></a>  
<a name="l210"><span class="linenum"> 210</span></a>  <span class="comment">            // Deal with fixed random choices for testing.</span>
<a name="l211"><span class="linenum"> 211</span></a>              if (isset(<a class="var it5865" onMouseOver="hilite(5865)" onMouseOut="lolite()" onClick="logVariable('questionids')" href="../../_variables/questionids.html">$questionids</a>[<a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>-&gt;<a class="function" onClick="logFunction('next_slot_number')" href="../../_functions/next_slot_number.html" onMouseOver="funcPopup(event,'next_slot_number')">next_slot_number</a>()])) {
<a name="l212"><span class="linenum"> 212</span></a>                  if (<a class="var it18288" onMouseOver="hilite(18288)" onMouseOut="lolite()" onClick="logVariable('randomloader')" href="../../_variables/randomloader.html">$randomloader</a>-&gt;<a class="function" onClick="logFunction('is_question_available')" href="../../_functions/is_question_available.html" onMouseOver="funcPopup(event,'is_question_available')">is_question_available</a>(<a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('questiondata')" href="../../_variables/questiondata.html">$questiondata</a>-&gt;<a onClick="logVariable('category')" class="var it43218" onMouseOver="hilite(43218)" onMouseOut="lolite()" href="../../_variables/category.html">category</a>,
<a name="l213"><span class="linenum"> 213</span></a>                          (bool) <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('questiondata')" href="../../_variables/questiondata.html">$questiondata</a>-&gt;<a onClick="logVariable('questiontext')" class="var it43218" onMouseOver="hilite(43218)" onMouseOut="lolite()" href="../../_variables/questiontext.html">questiontext</a>, <a class="var it5865" onMouseOver="hilite(5865)" onMouseOut="lolite()" onClick="logVariable('questionids')" href="../../_variables/questionids.html">$questionids</a>[<a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>-&gt;<a class="function" onClick="logFunction('next_slot_number')" href="../../_functions/next_slot_number.html" onMouseOver="funcPopup(event,'next_slot_number')">next_slot_number</a>()])) {
<a name="l214"><span class="linenum"> 214</span></a>                      <a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../../_variables/questions.html">$questions</a>[<a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>] = question_bank::<a class="function" onClick="logFunction('load_question')" href="../../_functions/load_question.html" onMouseOver="funcPopup(event,'load_question')">load_question</a>(
<a name="l215"><span class="linenum"> 215</span></a>                              <a class="var it5865" onMouseOver="hilite(5865)" onMouseOut="lolite()" onClick="logVariable('questionids')" href="../../_variables/questionids.html">$questionids</a>[<a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>-&gt;<a class="function" onClick="logFunction('next_slot_number')" href="../../_functions/next_slot_number.html" onMouseOver="funcPopup(event,'next_slot_number')">next_slot_number</a>()], <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('get_quiz')" href="../../_functions/get_quiz.html" onMouseOver="funcPopup(event,'get_quiz')">get_quiz</a>()-&gt;shuffleanswers);
<a name="l216"><span class="linenum"> 216</span></a>                      continue;
<a name="l217"><span class="linenum"> 217</span></a>                  } else {
<a name="l218"><span class="linenum"> 218</span></a>                      throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Forced question id not available.');
<a name="l219"><span class="linenum"> 219</span></a>                  }
<a name="l220"><span class="linenum"> 220</span></a>              }
<a name="l221"><span class="linenum"> 221</span></a>  
<a name="l222"><span class="linenum"> 222</span></a>  <span class="comment">            // Normal case, pick one at random.</span>
<a name="l223"><span class="linenum"> 223</span></a>              <a class="var it530" onMouseOver="hilite(530)" onMouseOut="lolite()" onClick="logVariable('questionid')" href="../../_variables/questionid.html">$questionid</a> = <a class="var it18288" onMouseOver="hilite(18288)" onMouseOut="lolite()" onClick="logVariable('randomloader')" href="../../_variables/randomloader.html">$randomloader</a>-&gt;<a class="function" onClick="logFunction('get_next_question_id')" href="../../_functions/get_next_question_id.html" onMouseOver="funcPopup(event,'get_next_question_id')">get_next_question_id</a>(<a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('questiondata')" href="../../_variables/questiondata.html">$questiondata</a>-&gt;<a onClick="logVariable('category')" class="var it43218" onMouseOver="hilite(43218)" onMouseOut="lolite()" href="../../_variables/category.html">category</a>,
<a name="l224"><span class="linenum"> 224</span></a>                          (bool) <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('questiondata')" href="../../_variables/questiondata.html">$questiondata</a>-&gt;<a onClick="logVariable('questiontext')" class="var it43218" onMouseOver="hilite(43218)" onMouseOut="lolite()" href="../../_variables/questiontext.html">questiontext</a>);
<a name="l225"><span class="linenum"> 225</span></a>              if (<a class="var it530" onMouseOver="hilite(530)" onMouseOut="lolite()" onClick="logVariable('questionid')" href="../../_variables/questionid.html">$questionid</a> === null) {
<a name="l226"><span class="linenum"> 226</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('notenoughrandomquestions', 'quiz',
<a name="l227"><span class="linenum"> 227</span></a>                                             <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('view_url')" href="../../_functions/view_url.html" onMouseOver="funcPopup(event,'view_url')">view_url</a>(), <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('questiondata')" href="../../_variables/questiondata.html">$questiondata</a>);
<a name="l228"><span class="linenum"> 228</span></a>              }
<a name="l229"><span class="linenum"> 229</span></a>  
<a name="l230"><span class="linenum"> 230</span></a>              <a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../../_variables/questions.html">$questions</a>[<a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>] = question_bank::<a class="function" onClick="logFunction('load_question')" href="../../_functions/load_question.html" onMouseOver="funcPopup(event,'load_question')">load_question</a>(<a class="var it530" onMouseOver="hilite(530)" onMouseOut="lolite()" onClick="logVariable('questionid')" href="../../_variables/questionid.html">$questionid</a>,
<a name="l231"><span class="linenum"> 231</span></a>                      <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('get_quiz')" href="../../_functions/get_quiz.html" onMouseOver="funcPopup(event,'get_quiz')">get_quiz</a>()-&gt;shuffleanswers);
<a name="l232"><span class="linenum"> 232</span></a>          }
<a name="l233"><span class="linenum"> 233</span></a>      }
<a name="l234"><span class="linenum"> 234</span></a>  
<a name="l235"><span class="linenum"> 235</span></a>  <span class="comment">    // Finally add them all to the usage.</span>
<a name="l236"><span class="linenum"> 236</span></a>      <a class="phpfunction" onClick="logFunction('ksort')" href="../../_functions/ksort.html" onMouseOver="phpfuncPopup(event,'ksort')">ksort</a>(<a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../../_variables/questions.html">$questions</a>);
<a name="l237"><span class="linenum"> 237</span></a>      foreach (<a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../../_variables/questions.html">$questions</a> as <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a> =&gt; <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>) {
<a name="l238"><span class="linenum"> 238</span></a>          <a class="var it9242" onMouseOver="hilite(9242)" onMouseOut="lolite()" onClick="logVariable('newslot')" href="../../_variables/newslot.html">$newslot</a> = <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>-&gt;<a class="function" onClick="logFunction('add_question')" href="../../_functions/add_question.html" onMouseOver="funcPopup(event,'add_question')">add_question</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>, <a class="var it455" onMouseOver="hilite(455)" onMouseOut="lolite()" onClick="logVariable('maxmark')" href="../../_variables/maxmark.html">$maxmark</a>[<a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>]);
<a name="l239"><span class="linenum"> 239</span></a>          if (<a class="var it9242" onMouseOver="hilite(9242)" onMouseOut="lolite()" onClick="logVariable('newslot')" href="../../_variables/newslot.html">$newslot</a> != <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>) {
<a name="l240"><span class="linenum"> 240</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Slot numbers have got confused.');
<a name="l241"><span class="linenum"> 241</span></a>          }
<a name="l242"><span class="linenum"> 242</span></a>      }
<a name="l243"><span class="linenum"> 243</span></a>  
<a name="l244"><span class="linenum"> 244</span></a>  <span class="comment">    // Start all the questions.</span>
<a name="l245"><span class="linenum"> 245</span></a>      <a class="var it18289" onMouseOver="hilite(18289)" onMouseOut="lolite()" onClick="logVariable('variantstrategy')" href="../../_variables/variantstrategy.html">$variantstrategy</a> = new core_question\engine\variants\least_used_strategy(<a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>, <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>);
<a name="l246"><span class="linenum"> 246</span></a>  
<a name="l247"><span class="linenum"> 247</span></a>      if (!empty(<a class="var it41424" onMouseOver="hilite(41424)" onMouseOut="lolite()" onClick="logVariable('forcedvariantsbyslot')" href="../../_variables/forcedvariantsbyslot.html">$forcedvariantsbyslot</a>)) {
<a name="l248"><span class="linenum"> 248</span></a>          <a class="var it41427" onMouseOver="hilite(41427)" onMouseOut="lolite()" onClick="logVariable('forcedvariantsbyseed')" href="../../_variables/forcedvariantsbyseed.html">$forcedvariantsbyseed</a> = <a class="class" onClick="logClass('question_variant_forced_choices_selection_strategy')" href="../../_classes/question_variant_forced_choices_selection_strategy.html" onMouseOver="classPopup(event,'question_variant_forced_choices_selection_strategy')">question_variant_forced_choices_selection_strategy</a>::<a class="function" onClick="logFunction('prepare_forced_choices_array')" href="../../_functions/prepare_forced_choices_array.html" onMouseOver="funcPopup(event,'prepare_forced_choices_array')">prepare_forced_choices_array</a>(
<a name="l249"><span class="linenum"> 249</span></a>              <a class="var it41424" onMouseOver="hilite(41424)" onMouseOut="lolite()" onClick="logVariable('forcedvariantsbyslot')" href="../../_variables/forcedvariantsbyslot.html">$forcedvariantsbyslot</a>, <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>);
<a name="l250"><span class="linenum"> 250</span></a>          <a class="var it18289" onMouseOver="hilite(18289)" onMouseOut="lolite()" onClick="logVariable('variantstrategy')" href="../../_variables/variantstrategy.html">$variantstrategy</a> = <span class="keyword">new </span><a class="class" onClick="logClass('question_variant_forced_choices_selection_strategy')" href="../../_classes/question_variant_forced_choices_selection_strategy.html" onMouseOver="classPopup(event,'question_variant_forced_choices_selection_strategy')">question_variant_forced_choices_selection_strategy</a>(
<a name="l251"><span class="linenum"> 251</span></a>              <a class="var it41427" onMouseOver="hilite(41427)" onMouseOut="lolite()" onClick="logVariable('forcedvariantsbyseed')" href="../../_variables/forcedvariantsbyseed.html">$forcedvariantsbyseed</a>, <a class="var it18289" onMouseOver="hilite(18289)" onMouseOut="lolite()" onClick="logVariable('variantstrategy')" href="../../_variables/variantstrategy.html">$variantstrategy</a>);
<a name="l252"><span class="linenum"> 252</span></a>      }
<a name="l253"><span class="linenum"> 253</span></a>  
<a name="l254"><span class="linenum"> 254</span></a>      <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>-&gt;<a class="function" onClick="logFunction('start_all_questions')" href="../../_functions/start_all_questions.html" onMouseOver="funcPopup(event,'start_all_questions')">start_all_questions</a>(<a class="var it18289" onMouseOver="hilite(18289)" onMouseOut="lolite()" onClick="logVariable('variantstrategy')" href="../../_variables/variantstrategy.html">$variantstrategy</a>, <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a>);
<a name="l255"><span class="linenum"> 255</span></a>  
<a name="l256"><span class="linenum"> 256</span></a>  <span class="comment">    // Work out the attempt layout.</span>
<a name="l257"><span class="linenum"> 257</span></a>      <a class="var it5385" onMouseOver="hilite(5385)" onMouseOut="lolite()" onClick="logVariable('sections')" href="../../_variables/sections.html">$sections</a> = <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('get_sections')" href="../../_functions/get_sections.html" onMouseOver="funcPopup(event,'get_sections')">get_sections</a>();
<a name="l258"><span class="linenum"> 258</span></a>      foreach (<a class="var it5385" onMouseOver="hilite(5385)" onMouseOut="lolite()" onClick="logVariable('sections')" href="../../_variables/sections.html">$sections</a> as <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> =&gt; <a class="var it989" onMouseOver="hilite(989)" onMouseOut="lolite()" onClick="logVariable('section')" href="../../_variables/section.html">$section</a>) {
<a name="l259"><span class="linenum"> 259</span></a>          if (isset(<a class="var it5385" onMouseOver="hilite(5385)" onMouseOut="lolite()" onClick="logVariable('sections')" href="../../_variables/sections.html">$sections</a>[<a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> + 1])) {
<a name="l260"><span class="linenum"> 260</span></a>              <a class="var it5385" onMouseOver="hilite(5385)" onMouseOut="lolite()" onClick="logVariable('sections')" href="../../_variables/sections.html">$sections</a>[<a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>]-&gt;lastslot = <a class="var it5385" onMouseOver="hilite(5385)" onMouseOut="lolite()" onClick="logVariable('sections')" href="../../_variables/sections.html">$sections</a>[<a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> + 1]-&gt;firstslot - 1;
<a name="l261"><span class="linenum"> 261</span></a>          } else {
<a name="l262"><span class="linenum"> 262</span></a>              <a class="var it5385" onMouseOver="hilite(5385)" onMouseOut="lolite()" onClick="logVariable('sections')" href="../../_variables/sections.html">$sections</a>[<a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>]-&gt;lastslot = <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../../_variables/questions.html">$questions</a>);
<a name="l263"><span class="linenum"> 263</span></a>          }
<a name="l264"><span class="linenum"> 264</span></a>      }
<a name="l265"><span class="linenum"> 265</span></a>  
<a name="l266"><span class="linenum"> 266</span></a>      <a class="var it459" onMouseOver="hilite(459)" onMouseOut="lolite()" onClick="logVariable('layout')" href="../../_variables/layout.html">$layout</a> = array();
<a name="l267"><span class="linenum"> 267</span></a>      foreach (<a class="var it5385" onMouseOver="hilite(5385)" onMouseOut="lolite()" onClick="logVariable('sections')" href="../../_variables/sections.html">$sections</a> as <a class="var it989" onMouseOver="hilite(989)" onMouseOut="lolite()" onClick="logVariable('section')" href="../../_variables/section.html">$section</a>) {
<a name="l268"><span class="linenum"> 268</span></a>          if (<a class="var it989" onMouseOver="hilite(989)" onMouseOut="lolite()" onClick="logVariable('section')" href="../../_variables/section.html">$section</a>-&gt;<a onClick="logVariable('shufflequestions')" class="var it43306" onMouseOver="hilite(43306)" onMouseOut="lolite()" href="../../_variables/shufflequestions.html">shufflequestions</a>) {
<a name="l269"><span class="linenum"> 269</span></a>              <a class="var it41428" onMouseOver="hilite(41428)" onMouseOut="lolite()" onClick="logVariable('questionsinthissection')" href="../../_variables/questionsinthissection.html">$questionsinthissection</a> = array();
<a name="l270"><span class="linenum"> 270</span></a>              for (<a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a> = <a class="var it989" onMouseOver="hilite(989)" onMouseOut="lolite()" onClick="logVariable('section')" href="../../_variables/section.html">$section</a>-&gt;<a onClick="logVariable('firstslot')" class="var it43306" onMouseOver="hilite(43306)" onMouseOut="lolite()" href="../../_variables/firstslot.html">firstslot</a>; <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a> &lt;= <a class="var it989" onMouseOver="hilite(989)" onMouseOut="lolite()" onClick="logVariable('section')" href="../../_variables/section.html">$section</a>-&gt;<a onClick="logVariable('lastslot')" class="var it43306" onMouseOver="hilite(43306)" onMouseOut="lolite()" href="../../_variables/lastslot.html">lastslot</a>; <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a> += 1) {
<a name="l271"><span class="linenum"> 271</span></a>                  <a class="var it41428" onMouseOver="hilite(41428)" onMouseOut="lolite()" onClick="logVariable('questionsinthissection')" href="../../_variables/questionsinthissection.html">$questionsinthissection</a>[] = <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>;
<a name="l272"><span class="linenum"> 272</span></a>              }
<a name="l273"><span class="linenum"> 273</span></a>              <a class="phpfunction" onClick="logFunction('shuffle')" href="../../_functions/shuffle.html" onMouseOver="phpfuncPopup(event,'shuffle')">shuffle</a>(<a class="var it41428" onMouseOver="hilite(41428)" onMouseOut="lolite()" onClick="logVariable('questionsinthissection')" href="../../_variables/questionsinthissection.html">$questionsinthissection</a>);
<a name="l274"><span class="linenum"> 274</span></a>              <a class="var it41429" onMouseOver="hilite(41429)" onMouseOut="lolite()" onClick="logVariable('questionsonthispage')" href="../../_variables/questionsonthispage.html">$questionsonthispage</a> = 0;
<a name="l275"><span class="linenum"> 275</span></a>              foreach (<a class="var it41428" onMouseOver="hilite(41428)" onMouseOut="lolite()" onClick="logVariable('questionsinthissection')" href="../../_variables/questionsinthissection.html">$questionsinthissection</a> as <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>) {
<a name="l276"><span class="linenum"> 276</span></a>                  if (<a class="var it41429" onMouseOver="hilite(41429)" onMouseOut="lolite()" onClick="logVariable('questionsonthispage')" href="../../_variables/questionsonthispage.html">$questionsonthispage</a> &amp;&amp; <a class="var it41429" onMouseOver="hilite(41429)" onMouseOut="lolite()" onClick="logVariable('questionsonthispage')" href="../../_variables/questionsonthispage.html">$questionsonthispage</a> == <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('get_quiz')" href="../../_functions/get_quiz.html" onMouseOver="funcPopup(event,'get_quiz')">get_quiz</a>()-&gt;questionsperpage) {
<a name="l277"><span class="linenum"> 277</span></a>                      <a class="var it459" onMouseOver="hilite(459)" onMouseOut="lolite()" onClick="logVariable('layout')" href="../../_variables/layout.html">$layout</a>[] = 0;
<a name="l278"><span class="linenum"> 278</span></a>                      <a class="var it41429" onMouseOver="hilite(41429)" onMouseOut="lolite()" onClick="logVariable('questionsonthispage')" href="../../_variables/questionsonthispage.html">$questionsonthispage</a> = 0;
<a name="l279"><span class="linenum"> 279</span></a>                  }
<a name="l280"><span class="linenum"> 280</span></a>                  <a class="var it459" onMouseOver="hilite(459)" onMouseOut="lolite()" onClick="logVariable('layout')" href="../../_variables/layout.html">$layout</a>[] = <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>;
<a name="l281"><span class="linenum"> 281</span></a>                  <a class="var it41429" onMouseOver="hilite(41429)" onMouseOut="lolite()" onClick="logVariable('questionsonthispage')" href="../../_variables/questionsonthispage.html">$questionsonthispage</a> += 1;
<a name="l282"><span class="linenum"> 282</span></a>              }
<a name="l283"><span class="linenum"> 283</span></a>  
<a name="l284"><span class="linenum"> 284</span></a>          } else {
<a name="l285"><span class="linenum"> 285</span></a>              <a class="var it10055" onMouseOver="hilite(10055)" onMouseOut="lolite()" onClick="logVariable('currentpage')" href="../../_variables/currentpage.html">$currentpage</a> = <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>[<a class="var it989" onMouseOver="hilite(989)" onMouseOut="lolite()" onClick="logVariable('section')" href="../../_variables/section.html">$section</a>-&gt;<a onClick="logVariable('firstslot')" class="var it43306" onMouseOver="hilite(43306)" onMouseOut="lolite()" href="../../_variables/firstslot.html">firstslot</a>];
<a name="l286"><span class="linenum"> 286</span></a>              for (<a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a> = <a class="var it989" onMouseOver="hilite(989)" onMouseOut="lolite()" onClick="logVariable('section')" href="../../_variables/section.html">$section</a>-&gt;<a onClick="logVariable('firstslot')" class="var it43306" onMouseOver="hilite(43306)" onMouseOut="lolite()" href="../../_variables/firstslot.html">firstslot</a>; <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a> &lt;= <a class="var it989" onMouseOver="hilite(989)" onMouseOut="lolite()" onClick="logVariable('section')" href="../../_variables/section.html">$section</a>-&gt;<a onClick="logVariable('lastslot')" class="var it43306" onMouseOver="hilite(43306)" onMouseOut="lolite()" href="../../_variables/lastslot.html">lastslot</a>; <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a> += 1) {
<a name="l287"><span class="linenum"> 287</span></a>                  if (<a class="var it10055" onMouseOver="hilite(10055)" onMouseOut="lolite()" onClick="logVariable('currentpage')" href="../../_variables/currentpage.html">$currentpage</a> !== null &amp;&amp; <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>[<a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>] != <a class="var it10055" onMouseOver="hilite(10055)" onMouseOut="lolite()" onClick="logVariable('currentpage')" href="../../_variables/currentpage.html">$currentpage</a>) {
<a name="l288"><span class="linenum"> 288</span></a>                      <a class="var it459" onMouseOver="hilite(459)" onMouseOut="lolite()" onClick="logVariable('layout')" href="../../_variables/layout.html">$layout</a>[] = 0;
<a name="l289"><span class="linenum"> 289</span></a>                  }
<a name="l290"><span class="linenum"> 290</span></a>                  <a class="var it459" onMouseOver="hilite(459)" onMouseOut="lolite()" onClick="logVariable('layout')" href="../../_variables/layout.html">$layout</a>[] = <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>;
<a name="l291"><span class="linenum"> 291</span></a>                  <a class="var it10055" onMouseOver="hilite(10055)" onMouseOut="lolite()" onClick="logVariable('currentpage')" href="../../_variables/currentpage.html">$currentpage</a> = <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>[<a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>];
<a name="l292"><span class="linenum"> 292</span></a>              }
<a name="l293"><span class="linenum"> 293</span></a>          }
<a name="l294"><span class="linenum"> 294</span></a>  
<a name="l295"><span class="linenum"> 295</span></a>  <span class="comment">        // Each section ends with a page break.</span>
<a name="l296"><span class="linenum"> 296</span></a>          <a class="var it459" onMouseOver="hilite(459)" onMouseOut="lolite()" onClick="logVariable('layout')" href="../../_variables/layout.html">$layout</a>[] = 0;
<a name="l297"><span class="linenum"> 297</span></a>      }
<a name="l298"><span class="linenum"> 298</span></a>      <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('layout')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/layout.html">layout</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(',', <a class="var it459" onMouseOver="hilite(459)" onMouseOut="lolite()" onClick="logVariable('layout')" href="../../_variables/layout.html">$layout</a>);
<a name="l299"><span class="linenum"> 299</span></a>  
<a name="l300"><span class="linenum"> 300</span></a>      return <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>;
<a name="l301"><span class="linenum"> 301</span></a>  }
<a name="l302"><span class="linenum"> 302</span></a>  
<a name="l303"><span class="linenum"> 303</span></a>  <span class="comment">/**</span>
<a name="l304"><span class="linenum"> 304</span></a>  <span class="comment"> * Start a subsequent new attempt, in each attempt builds on last mode.</span>
<a name="l305"><span class="linenum"> 305</span></a>  <span class="comment"> *</span>
<a name="l306"><span class="linenum"> 306</span></a>  <span class="comment"> * @param question_usage_by_activity    $quba         this question usage</span>
<a name="l307"><span class="linenum"> 307</span></a>  <span class="comment"> * @param object                        $attempt      this attempt</span>
<a name="l308"><span class="linenum"> 308</span></a>  <span class="comment"> * @param object                        $lastattempt  last attempt</span>
<a name="l309"><span class="linenum"> 309</span></a>  <span class="comment"> * @return object                       modified attempt object</span>
<a name="l310"><span class="linenum"> 310</span></a>  <span class="comment"> *</span>
<a name="l311"><span class="linenum"> 311</span></a>  <span class="comment"> */</span>
<a name="l312"><span class="linenum"> 312</span></a>  function <a class="function" onClick="logFunction('quiz_start_attempt_built_on_last')" href="../../_functions/quiz_start_attempt_built_on_last.html" onMouseOver="funcPopup(event,'quiz_start_attempt_built_on_last')">quiz_start_attempt_built_on_last</a>(<a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>, <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>, <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>) {
<a name="l313"><span class="linenum"> 313</span></a>      <a class="var it41430" onMouseOver="hilite(41430)" onMouseOut="lolite()" onClick="logVariable('oldquba')" href="../../_variables/oldquba.html">$oldquba</a> = question_engine::<a class="function" onClick="logFunction('load_questions_usage_by_activity')" href="../../_functions/load_questions_usage_by_activity.html" onMouseOver="funcPopup(event,'load_questions_usage_by_activity')">load_questions_usage_by_activity</a>(<a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>-&gt;<a onClick="logVariable('uniqueid')" class="var it43541" onMouseOver="hilite(43541)" onMouseOut="lolite()" href="../../_variables/uniqueid.html">uniqueid</a>);
<a name="l314"><span class="linenum"> 314</span></a>  
<a name="l315"><span class="linenum"> 315</span></a>      <a class="var it41431" onMouseOver="hilite(41431)" onMouseOut="lolite()" onClick="logVariable('oldnumberstonew')" href="../../_variables/oldnumberstonew.html">$oldnumberstonew</a> = array();
<a name="l316"><span class="linenum"> 316</span></a>      foreach (<a class="var it41430" onMouseOver="hilite(41430)" onMouseOut="lolite()" onClick="logVariable('oldquba')" href="../../_variables/oldquba.html">$oldquba</a>-&gt;<a class="function" onClick="logFunction('get_attempt_iterator')" href="../../_functions/get_attempt_iterator.html" onMouseOver="funcPopup(event,'get_attempt_iterator')">get_attempt_iterator</a>() as <a class="var it9241" onMouseOver="hilite(9241)" onMouseOut="lolite()" onClick="logVariable('oldslot')" href="../../_variables/oldslot.html">$oldslot</a> =&gt; <a class="var it4456" onMouseOver="hilite(4456)" onMouseOut="lolite()" onClick="logVariable('oldqa')" href="../../_variables/oldqa.html">$oldqa</a>) {
<a name="l317"><span class="linenum"> 317</span></a>          <a class="var it9242" onMouseOver="hilite(9242)" onMouseOut="lolite()" onClick="logVariable('newslot')" href="../../_variables/newslot.html">$newslot</a> = <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>-&gt;<a class="function" onClick="logFunction('add_question')" href="../../_functions/add_question.html" onMouseOver="funcPopup(event,'add_question')">add_question</a>(<a class="var it4456" onMouseOver="hilite(4456)" onMouseOut="lolite()" onClick="logVariable('oldqa')" href="../../_variables/oldqa.html">$oldqa</a>-&gt;<a class="function" onClick="logFunction('get_question')" href="../../_functions/get_question.html" onMouseOver="funcPopup(event,'get_question')">get_question</a>(), <a class="var it4456" onMouseOver="hilite(4456)" onMouseOut="lolite()" onClick="logVariable('oldqa')" href="../../_variables/oldqa.html">$oldqa</a>-&gt;<a class="function" onClick="logFunction('get_max_mark')" href="../../_functions/get_max_mark.html" onMouseOver="funcPopup(event,'get_max_mark')">get_max_mark</a>());
<a name="l318"><span class="linenum"> 318</span></a>  
<a name="l319"><span class="linenum"> 319</span></a>          <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>-&gt;<a class="function" onClick="logFunction('start_question_based_on')" href="../../_functions/start_question_based_on.html" onMouseOver="funcPopup(event,'start_question_based_on')">start_question_based_on</a>(<a class="var it9242" onMouseOver="hilite(9242)" onMouseOut="lolite()" onClick="logVariable('newslot')" href="../../_variables/newslot.html">$newslot</a>, <a class="var it4456" onMouseOver="hilite(4456)" onMouseOut="lolite()" onClick="logVariable('oldqa')" href="../../_variables/oldqa.html">$oldqa</a>);
<a name="l320"><span class="linenum"> 320</span></a>  
<a name="l321"><span class="linenum"> 321</span></a>          <a class="var it41431" onMouseOver="hilite(41431)" onMouseOut="lolite()" onClick="logVariable('oldnumberstonew')" href="../../_variables/oldnumberstonew.html">$oldnumberstonew</a>[<a class="var it9241" onMouseOver="hilite(9241)" onMouseOut="lolite()" onClick="logVariable('oldslot')" href="../../_variables/oldslot.html">$oldslot</a>] = <a class="var it9242" onMouseOver="hilite(9242)" onMouseOut="lolite()" onClick="logVariable('newslot')" href="../../_variables/newslot.html">$newslot</a>;
<a name="l322"><span class="linenum"> 322</span></a>      }
<a name="l323"><span class="linenum"> 323</span></a>  
<a name="l324"><span class="linenum"> 324</span></a>  <span class="comment">    // Update attempt layout.</span>
<a name="l325"><span class="linenum"> 325</span></a>      <a class="var it15488" onMouseOver="hilite(15488)" onMouseOut="lolite()" onClick="logVariable('newlayout')" href="../../_variables/newlayout.html">$newlayout</a> = array();
<a name="l326"><span class="linenum"> 326</span></a>      foreach (<a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(',', <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>-&gt;<a onClick="logVariable('layout')" class="var it43541" onMouseOver="hilite(43541)" onMouseOut="lolite()" href="../../_variables/layout.html">layout</a>) as <a class="var it9241" onMouseOver="hilite(9241)" onMouseOut="lolite()" onClick="logVariable('oldslot')" href="../../_variables/oldslot.html">$oldslot</a>) {
<a name="l327"><span class="linenum"> 327</span></a>          if (<a class="var it9241" onMouseOver="hilite(9241)" onMouseOut="lolite()" onClick="logVariable('oldslot')" href="../../_variables/oldslot.html">$oldslot</a> != 0) {
<a name="l328"><span class="linenum"> 328</span></a>              <a class="var it15488" onMouseOver="hilite(15488)" onMouseOut="lolite()" onClick="logVariable('newlayout')" href="../../_variables/newlayout.html">$newlayout</a>[] = <a class="var it41431" onMouseOver="hilite(41431)" onMouseOut="lolite()" onClick="logVariable('oldnumberstonew')" href="../../_variables/oldnumberstonew.html">$oldnumberstonew</a>[<a class="var it9241" onMouseOver="hilite(9241)" onMouseOut="lolite()" onClick="logVariable('oldslot')" href="../../_variables/oldslot.html">$oldslot</a>];
<a name="l329"><span class="linenum"> 329</span></a>          } else {
<a name="l330"><span class="linenum"> 330</span></a>              <a class="var it15488" onMouseOver="hilite(15488)" onMouseOut="lolite()" onClick="logVariable('newlayout')" href="../../_variables/newlayout.html">$newlayout</a>[] = 0;
<a name="l331"><span class="linenum"> 331</span></a>          }
<a name="l332"><span class="linenum"> 332</span></a>      }
<a name="l333"><span class="linenum"> 333</span></a>      <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('layout')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/layout.html">layout</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(',', <a class="var it15488" onMouseOver="hilite(15488)" onMouseOut="lolite()" onClick="logVariable('newlayout')" href="../../_variables/newlayout.html">$newlayout</a>);
<a name="l334"><span class="linenum"> 334</span></a>      return <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>;
<a name="l335"><span class="linenum"> 335</span></a>  }
<a name="l336"><span class="linenum"> 336</span></a>  
<a name="l337"><span class="linenum"> 337</span></a>  <span class="comment">/**</span>
<a name="l338"><span class="linenum"> 338</span></a>  <span class="comment"> * The save started question usage and quiz attempt in db and log the started attempt.</span>
<a name="l339"><span class="linenum"> 339</span></a>  <span class="comment"> *</span>
<a name="l340"><span class="linenum"> 340</span></a>  <span class="comment"> * @param quiz                       $quizobj</span>
<a name="l341"><span class="linenum"> 341</span></a>  <span class="comment"> * @param question_usage_by_activity $quba</span>
<a name="l342"><span class="linenum"> 342</span></a>  <span class="comment"> * @param object                     $attempt</span>
<a name="l343"><span class="linenum"> 343</span></a>  <span class="comment"> * @return object                    attempt object with uniqueid and id set.</span>
<a name="l344"><span class="linenum"> 344</span></a>  <span class="comment"> */</span>
<a name="l345"><span class="linenum"> 345</span></a>  function <a class="function" onClick="logFunction('quiz_attempt_save_started')" href="../../_functions/quiz_attempt_save_started.html" onMouseOver="funcPopup(event,'quiz_attempt_save_started')">quiz_attempt_save_started</a>(<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>, <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>, <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>) {
<a name="l346"><span class="linenum"> 346</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l347"><span class="linenum"> 347</span></a>  <span class="comment">    // Save the attempt in the database.</span>
<a name="l348"><span class="linenum"> 348</span></a>      question_engine::<a class="function" onClick="logFunction('save_questions_usage_by_activity')" href="../../_functions/save_questions_usage_by_activity.html" onMouseOver="funcPopup(event,'save_questions_usage_by_activity')">save_questions_usage_by_activity</a>(<a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>);
<a name="l349"><span class="linenum"> 349</span></a>      <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('uniqueid')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/uniqueid.html">uniqueid</a> = <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>-&gt;<a class="function" onClick="logFunction('get_id')" href="../../_functions/get_id.html" onMouseOver="funcPopup(event,'get_id')">get_id</a>();
<a name="l350"><span class="linenum"> 350</span></a>      <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('id')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('quiz_attempts', <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>);
<a name="l351"><span class="linenum"> 351</span></a>  
<a name="l352"><span class="linenum"> 352</span></a>  <span class="comment">    // Params used by the events below.</span>
<a name="l353"><span class="linenum"> 353</span></a>      <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array(
<a name="l354"><span class="linenum"> 354</span></a>          'objectid' =&gt; <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('id')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l355"><span class="linenum"> 355</span></a>          'relateduserid' =&gt; <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('userid')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>,
<a name="l356"><span class="linenum"> 356</span></a>          'courseid' =&gt; <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('get_courseid')" href="../../_functions/get_courseid.html" onMouseOver="funcPopup(event,'get_courseid')">get_courseid</a>(),
<a name="l357"><span class="linenum"> 357</span></a>          'context' =&gt; <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('get_context')" href="../../_functions/get_context.html" onMouseOver="funcPopup(event,'get_context')">get_context</a>()
<a name="l358"><span class="linenum"> 358</span></a>      );
<a name="l359"><span class="linenum"> 359</span></a>  <span class="comment">    // Decide which event we are using.</span>
<a name="l360"><span class="linenum"> 360</span></a>      if (<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('preview')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/preview.html">preview</a>) {
<a name="l361"><span class="linenum"> 361</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['other'] = array(
<a name="l362"><span class="linenum"> 362</span></a>              'quizid' =&gt; <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('get_quizid')" href="../../_functions/get_quizid.html" onMouseOver="funcPopup(event,'get_quizid')">get_quizid</a>()
<a name="l363"><span class="linenum"> 363</span></a>          );
<a name="l364"><span class="linenum"> 364</span></a>          <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a> = \mod_quiz\event\<a class="class" onClick="logClass('attempt_preview_started')" href="../../_classes/attempt_preview_started.html" onMouseOver="classPopup(event,'attempt_preview_started')">attempt_preview_started</a>::<a class="function" onClick="logFunction('create')" href="../../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l365"><span class="linenum"> 365</span></a>      } else {
<a name="l366"><span class="linenum"> 366</span></a>          <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a> = \mod_quiz\event\<a class="class" onClick="logClass('attempt_started')" href="../../_classes/attempt_started.html" onMouseOver="classPopup(event,'attempt_started')">attempt_started</a>::<a class="function" onClick="logFunction('create')" href="../../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l367"><span class="linenum"> 367</span></a>  
<a name="l368"><span class="linenum"> 368</span></a>      }
<a name="l369"><span class="linenum"> 369</span></a>  
<a name="l370"><span class="linenum"> 370</span></a>  <span class="comment">    // Trigger the event.</span>
<a name="l371"><span class="linenum"> 371</span></a>      <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('quiz', <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('get_quiz')" href="../../_functions/get_quiz.html" onMouseOver="funcPopup(event,'get_quiz')">get_quiz</a>());
<a name="l372"><span class="linenum"> 372</span></a>      <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('quiz_attempts', <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>);
<a name="l373"><span class="linenum"> 373</span></a>      <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l374"><span class="linenum"> 374</span></a>  
<a name="l375"><span class="linenum"> 375</span></a>      return <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>;
<a name="l376"><span class="linenum"> 376</span></a>  }
<a name="l377"><span class="linenum"> 377</span></a>  
<a name="l378"><span class="linenum"> 378</span></a>  <span class="comment">/**</span>
<a name="l379"><span class="linenum"> 379</span></a>  <span class="comment"> * Returns an unfinished attempt (if there is one) for the given</span>
<a name="l380"><span class="linenum"> 380</span></a>  <span class="comment"> * user on the given quiz. This function does not return preview attempts.</span>
<a name="l381"><span class="linenum"> 381</span></a>  <span class="comment"> *</span>
<a name="l382"><span class="linenum"> 382</span></a>  <span class="comment"> * @param int $quizid the id of the quiz.</span>
<a name="l383"><span class="linenum"> 383</span></a>  <span class="comment"> * @param int $userid the id of the user.</span>
<a name="l384"><span class="linenum"> 384</span></a>  <span class="comment"> *</span>
<a name="l385"><span class="linenum"> 385</span></a>  <span class="comment"> * @return mixed the unfinished attempt if there is one, false if not.</span>
<a name="l386"><span class="linenum"> 386</span></a>  <span class="comment"> */</span>
<a name="l387"><span class="linenum"> 387</span></a>  function <a class="function" onClick="logFunction('quiz_get_user_attempt_unfinished')" href="../../_functions/quiz_get_user_attempt_unfinished.html" onMouseOver="funcPopup(event,'quiz_get_user_attempt_unfinished')">quiz_get_user_attempt_unfinished</a>(<a class="var it932" onMouseOver="hilite(932)" onMouseOut="lolite()" onClick="logVariable('quizid')" href="../../_variables/quizid.html">$quizid</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>) {
<a name="l388"><span class="linenum"> 388</span></a>      <a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a> = <a class="function" onClick="logFunction('quiz_get_user_attempts')" href="../../_functions/quiz_get_user_attempts.html" onMouseOver="funcPopup(event,'quiz_get_user_attempts')">quiz_get_user_attempts</a>(<a class="var it932" onMouseOver="hilite(932)" onMouseOut="lolite()" onClick="logVariable('quizid')" href="../../_variables/quizid.html">$quizid</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, 'unfinished', true);
<a name="l389"><span class="linenum"> 389</span></a>      if (<a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a>) {
<a name="l390"><span class="linenum"> 390</span></a>          return <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a>);
<a name="l391"><span class="linenum"> 391</span></a>      } else {
<a name="l392"><span class="linenum"> 392</span></a>          return false;
<a name="l393"><span class="linenum"> 393</span></a>      }
<a name="l394"><span class="linenum"> 394</span></a>  }
<a name="l395"><span class="linenum"> 395</span></a>  
<a name="l396"><span class="linenum"> 396</span></a>  <span class="comment">/**</span>
<a name="l397"><span class="linenum"> 397</span></a>  <span class="comment"> * Delete a quiz attempt.</span>
<a name="l398"><span class="linenum"> 398</span></a>  <span class="comment"> * @param mixed $attempt an integer attempt id or an attempt object</span>
<a name="l399"><span class="linenum"> 399</span></a>  <span class="comment"> *      (row of the quiz_attempts table).</span>
<a name="l400"><span class="linenum"> 400</span></a>  <span class="comment"> * @param object $quiz the quiz object.</span>
<a name="l401"><span class="linenum"> 401</span></a>  <span class="comment"> */</span>
<a name="l402"><span class="linenum"> 402</span></a>  function <a class="function" onClick="logFunction('quiz_delete_attempt')" href="../../_functions/quiz_delete_attempt.html" onMouseOver="funcPopup(event,'quiz_delete_attempt')">quiz_delete_attempt</a>(<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>, <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>) {
<a name="l403"><span class="linenum"> 403</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l404"><span class="linenum"> 404</span></a>      if (<a class="phpfunction" onClick="logFunction('is_numeric')" href="../../_functions/is_numeric.html" onMouseOver="phpfuncPopup(event,'is_numeric')">is_numeric</a>(<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>)) {
<a name="l405"><span class="linenum"> 405</span></a>          if (!<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('quiz_attempts', array('id' =&gt; <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>))) {
<a name="l406"><span class="linenum"> 406</span></a>              return;
<a name="l407"><span class="linenum"> 407</span></a>          }
<a name="l408"><span class="linenum"> 408</span></a>      }
<a name="l409"><span class="linenum"> 409</span></a>  
<a name="l410"><span class="linenum"> 410</span></a>      if (<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('quiz')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/quiz.html">quiz</a> != <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>) {
<a name="l411"><span class="linenum"> 411</span></a>          <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>(&quot;Trying to delete attempt <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('id')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> which belongs to quiz <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('quiz')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/quiz.html">quiz</a> &quot; .
<a name="l412"><span class="linenum"> 412</span></a>                  &quot;but was passed quiz <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>.&quot;);
<a name="l413"><span class="linenum"> 413</span></a>          return;
<a name="l414"><span class="linenum"> 414</span></a>      }
<a name="l415"><span class="linenum"> 415</span></a>  
<a name="l416"><span class="linenum"> 416</span></a>      if (!isset(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('cmid')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/cmid.html">cmid</a>)) {
<a name="l417"><span class="linenum"> 417</span></a>          <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a> = <a class="function" onClick="logFunction('get_coursemodule_from_instance')" href="../../_functions/get_coursemodule_from_instance.html" onMouseOver="funcPopup(event,'get_coursemodule_from_instance')">get_coursemodule_from_instance</a>('quiz', <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('course')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>);
<a name="l418"><span class="linenum"> 418</span></a>          <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('cmid')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/cmid.html">cmid</a> = <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l419"><span class="linenum"> 419</span></a>      }
<a name="l420"><span class="linenum"> 420</span></a>  
<a name="l421"><span class="linenum"> 421</span></a>      question_engine::<a class="function" onClick="logFunction('delete_questions_usage_by_activity')" href="../../_functions/delete_questions_usage_by_activity.html" onMouseOver="funcPopup(event,'delete_questions_usage_by_activity')">delete_questions_usage_by_activity</a>(<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('uniqueid')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/uniqueid.html">uniqueid</a>);
<a name="l422"><span class="linenum"> 422</span></a>      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('quiz_attempts', array('id' =&gt; <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('id')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l423"><span class="linenum"> 423</span></a>  
<a name="l424"><span class="linenum"> 424</span></a>  <span class="comment">    // Log the deletion of the attempt if not a preview.</span>
<a name="l425"><span class="linenum"> 425</span></a>      if (!<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('preview')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/preview.html">preview</a>) {
<a name="l426"><span class="linenum"> 426</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array(
<a name="l427"><span class="linenum"> 427</span></a>              'objectid' =&gt; <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('id')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l428"><span class="linenum"> 428</span></a>              'relateduserid' =&gt; <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('userid')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>,
<a name="l429"><span class="linenum"> 429</span></a>              'context' =&gt; <a class="class" onClick="logClass('context_module')" href="../../_classes/context_module.html" onMouseOver="classPopup(event,'context_module')">context_module</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('cmid')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/cmid.html">cmid</a>),
<a name="l430"><span class="linenum"> 430</span></a>              'other' =&gt; array(
<a name="l431"><span class="linenum"> 431</span></a>                  'quizid' =&gt; <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;id
<a name="l432"><span class="linenum"> 432</span></a>              )
<a name="l433"><span class="linenum"> 433</span></a>          );
<a name="l434"><span class="linenum"> 434</span></a>          <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a> = \mod_quiz\event\<a class="class" onClick="logClass('attempt_deleted')" href="../../_classes/attempt_deleted.html" onMouseOver="classPopup(event,'attempt_deleted')">attempt_deleted</a>::<a class="function" onClick="logFunction('create')" href="../../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l435"><span class="linenum"> 435</span></a>          <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('quiz_attempts', <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>);
<a name="l436"><span class="linenum"> 436</span></a>          <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l437"><span class="linenum"> 437</span></a>      }
<a name="l438"><span class="linenum"> 438</span></a>  
<a name="l439"><span class="linenum"> 439</span></a>  <span class="comment">    // Search quiz_attempts for other instances by this user.</span>
<a name="l440"><span class="linenum"> 440</span></a>  <span class="comment">    // If none, then delete record for this quiz, this user from quiz_grades</span>
<a name="l441"><span class="linenum"> 441</span></a>  <span class="comment">    // else recalculate best grade.</span>
<a name="l442"><span class="linenum"> 442</span></a>      <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a> = <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('userid')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>;
<a name="l443"><span class="linenum"> 443</span></a>      if (!<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('record_exists')" href="../../_functions/record_exists.html" onMouseOver="funcPopup(event,'record_exists')">record_exists</a>('quiz_attempts', array('userid' =&gt; <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, 'quiz' =&gt; <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l444"><span class="linenum"> 444</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('quiz_grades', array('userid' =&gt; <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, 'quiz' =&gt; <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l445"><span class="linenum"> 445</span></a>      } else {
<a name="l446"><span class="linenum"> 446</span></a>          <a class="function" onClick="logFunction('quiz_save_best_grade')" href="../../_functions/quiz_save_best_grade.html" onMouseOver="funcPopup(event,'quiz_save_best_grade')">quiz_save_best_grade</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>);
<a name="l447"><span class="linenum"> 447</span></a>      }
<a name="l448"><span class="linenum"> 448</span></a>  
<a name="l449"><span class="linenum"> 449</span></a>      <a class="function" onClick="logFunction('quiz_update_grades')" href="../../_functions/quiz_update_grades.html" onMouseOver="funcPopup(event,'quiz_update_grades')">quiz_update_grades</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>);
<a name="l450"><span class="linenum"> 450</span></a>  }
<a name="l451"><span class="linenum"> 451</span></a>  
<a name="l452"><span class="linenum"> 452</span></a>  <span class="comment">/**</span>
<a name="l453"><span class="linenum"> 453</span></a>  <span class="comment"> * Delete all the preview attempts at a quiz, or possibly all the attempts belonging</span>
<a name="l454"><span class="linenum"> 454</span></a>  <span class="comment"> * to one user.</span>
<a name="l455"><span class="linenum"> 455</span></a>  <span class="comment"> * @param object $quiz the quiz object.</span>
<a name="l456"><span class="linenum"> 456</span></a>  <span class="comment"> * @param int $userid (optional) if given, only delete the previews belonging to this user.</span>
<a name="l457"><span class="linenum"> 457</span></a>  <span class="comment"> */</span>
<a name="l458"><span class="linenum"> 458</span></a>  function <a class="function" onClick="logFunction('quiz_delete_previews')" href="../../_functions/quiz_delete_previews.html" onMouseOver="funcPopup(event,'quiz_delete_previews')">quiz_delete_previews</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a> = null) {
<a name="l459"><span class="linenum"> 459</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l460"><span class="linenum"> 460</span></a>      <a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a> = array('quiz' =&gt; <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'preview' =&gt; 1);
<a name="l461"><span class="linenum"> 461</span></a>      if (!empty(<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>)) {
<a name="l462"><span class="linenum"> 462</span></a>          <a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>['userid'] = <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>;
<a name="l463"><span class="linenum"> 463</span></a>      }
<a name="l464"><span class="linenum"> 464</span></a>      <a class="var it41432" onMouseOver="hilite(41432)" onMouseOut="lolite()" onClick="logVariable('previewattempts')" href="../../_variables/previewattempts.html">$previewattempts</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('quiz_attempts', <a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>);
<a name="l465"><span class="linenum"> 465</span></a>      foreach (<a class="var it41432" onMouseOver="hilite(41432)" onMouseOut="lolite()" onClick="logVariable('previewattempts')" href="../../_variables/previewattempts.html">$previewattempts</a> as <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>) {
<a name="l466"><span class="linenum"> 466</span></a>          <a class="function" onClick="logFunction('quiz_delete_attempt')" href="../../_functions/quiz_delete_attempt.html" onMouseOver="funcPopup(event,'quiz_delete_attempt')">quiz_delete_attempt</a>(<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>, <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>);
<a name="l467"><span class="linenum"> 467</span></a>      }
<a name="l468"><span class="linenum"> 468</span></a>  }
<a name="l469"><span class="linenum"> 469</span></a>  
<a name="l470"><span class="linenum"> 470</span></a>  <span class="comment">/**</span>
<a name="l471"><span class="linenum"> 471</span></a>  <span class="comment"> * @param int $quizid The quiz id.</span>
<a name="l472"><span class="linenum"> 472</span></a>  <span class="comment"> * @return bool whether this quiz has any (non-preview) attempts.</span>
<a name="l473"><span class="linenum"> 473</span></a>  <span class="comment"> */</span>
<a name="l474"><span class="linenum"> 474</span></a>  function <a class="function" onClick="logFunction('quiz_has_attempts')" href="../../_functions/quiz_has_attempts.html" onMouseOver="funcPopup(event,'quiz_has_attempts')">quiz_has_attempts</a>(<a class="var it932" onMouseOver="hilite(932)" onMouseOut="lolite()" onClick="logVariable('quizid')" href="../../_variables/quizid.html">$quizid</a>) {
<a name="l475"><span class="linenum"> 475</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l476"><span class="linenum"> 476</span></a>      return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('record_exists')" href="../../_functions/record_exists.html" onMouseOver="funcPopup(event,'record_exists')">record_exists</a>('quiz_attempts', array('quiz' =&gt; <a class="var it932" onMouseOver="hilite(932)" onMouseOut="lolite()" onClick="logVariable('quizid')" href="../../_variables/quizid.html">$quizid</a>, 'preview' =&gt; 0));
<a name="l477"><span class="linenum"> 477</span></a>  }
<a name="l478"><span class="linenum"> 478</span></a>  
<a name="l479"><span class="linenum"> 479</span></a>  <span class="comment">// Functions to do with quiz layout and pages //////////////////////////////////</span>
<a name="l480"><span class="linenum"> 480</span></a>  
<a name="l481"><span class="linenum"> 481</span></a>  <span class="comment">/**</span>
<a name="l482"><span class="linenum"> 482</span></a>  <span class="comment"> * Repaginate the questions in a quiz</span>
<a name="l483"><span class="linenum"> 483</span></a>  <span class="comment"> * @param int $quizid the id of the quiz to repaginate.</span>
<a name="l484"><span class="linenum"> 484</span></a>  <span class="comment"> * @param int $slotsperpage number of items to put on each page. 0 means unlimited.</span>
<a name="l485"><span class="linenum"> 485</span></a>  <span class="comment"> */</span>
<a name="l486"><span class="linenum"> 486</span></a>  function <a class="function" onClick="logFunction('quiz_repaginate_questions')" href="../../_functions/quiz_repaginate_questions.html" onMouseOver="funcPopup(event,'quiz_repaginate_questions')">quiz_repaginate_questions</a>(<a class="var it932" onMouseOver="hilite(932)" onMouseOut="lolite()" onClick="logVariable('quizid')" href="../../_variables/quizid.html">$quizid</a>, <a class="var it41433" onMouseOver="hilite(41433)" onMouseOut="lolite()" onClick="logVariable('slotsperpage')" href="../../_variables/slotsperpage.html">$slotsperpage</a>) {
<a name="l487"><span class="linenum"> 487</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l488"><span class="linenum"> 488</span></a>      <a class="var it18640" onMouseOver="hilite(18640)" onMouseOut="lolite()" onClick="logVariable('trans')" href="../../_variables/trans.html">$trans</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('start_delegated_transaction')" href="../../_functions/start_delegated_transaction.html" onMouseOver="funcPopup(event,'start_delegated_transaction')">start_delegated_transaction</a>();
<a name="l489"><span class="linenum"> 489</span></a>  
<a name="l490"><span class="linenum"> 490</span></a>      <a class="var it5385" onMouseOver="hilite(5385)" onMouseOut="lolite()" onClick="logVariable('sections')" href="../../_variables/sections.html">$sections</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('quiz_sections', array('quizid' =&gt; <a class="var it932" onMouseOver="hilite(932)" onMouseOut="lolite()" onClick="logVariable('quizid')" href="../../_variables/quizid.html">$quizid</a>), 'firstslot ASC');
<a name="l491"><span class="linenum"> 491</span></a>      <a class="var it29391" onMouseOver="hilite(29391)" onMouseOut="lolite()" onClick="logVariable('firstslots')" href="../../_variables/firstslots.html">$firstslots</a> = array();
<a name="l492"><span class="linenum"> 492</span></a>      foreach (<a class="var it5385" onMouseOver="hilite(5385)" onMouseOut="lolite()" onClick="logVariable('sections')" href="../../_variables/sections.html">$sections</a> as <a class="var it989" onMouseOver="hilite(989)" onMouseOut="lolite()" onClick="logVariable('section')" href="../../_variables/section.html">$section</a>) {
<a name="l493"><span class="linenum"> 493</span></a>          if ((int)<a class="var it989" onMouseOver="hilite(989)" onMouseOut="lolite()" onClick="logVariable('section')" href="../../_variables/section.html">$section</a>-&gt;<a onClick="logVariable('firstslot')" class="var it43306" onMouseOver="hilite(43306)" onMouseOut="lolite()" href="../../_variables/firstslot.html">firstslot</a> === 1) {
<a name="l494"><span class="linenum"> 494</span></a>              continue;
<a name="l495"><span class="linenum"> 495</span></a>          }
<a name="l496"><span class="linenum"> 496</span></a>          <a class="var it29391" onMouseOver="hilite(29391)" onMouseOut="lolite()" onClick="logVariable('firstslots')" href="../../_variables/firstslots.html">$firstslots</a>[] = <a class="var it989" onMouseOver="hilite(989)" onMouseOut="lolite()" onClick="logVariable('section')" href="../../_variables/section.html">$section</a>-&gt;<a onClick="logVariable('firstslot')" class="var it43306" onMouseOver="hilite(43306)" onMouseOut="lolite()" href="../../_variables/firstslot.html">firstslot</a>;
<a name="l497"><span class="linenum"> 497</span></a>      }
<a name="l498"><span class="linenum"> 498</span></a>  
<a name="l499"><span class="linenum"> 499</span></a>      <a class="var it933" onMouseOver="hilite(933)" onMouseOut="lolite()" onClick="logVariable('slots')" href="../../_variables/slots.html">$slots</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('quiz_slots', array('quizid' =&gt; <a class="var it932" onMouseOver="hilite(932)" onMouseOut="lolite()" onClick="logVariable('quizid')" href="../../_variables/quizid.html">$quizid</a>),
<a name="l500"><span class="linenum"> 500</span></a>              'slot');
<a name="l501"><span class="linenum"> 501</span></a>      <a class="var it10055" onMouseOver="hilite(10055)" onMouseOut="lolite()" onClick="logVariable('currentpage')" href="../../_variables/currentpage.html">$currentpage</a> = 1;
<a name="l502"><span class="linenum"> 502</span></a>      <a class="var it41434" onMouseOver="hilite(41434)" onMouseOut="lolite()" onClick="logVariable('slotsonthispage')" href="../../_variables/slotsonthispage.html">$slotsonthispage</a> = 0;
<a name="l503"><span class="linenum"> 503</span></a>      foreach (<a class="var it933" onMouseOver="hilite(933)" onMouseOut="lolite()" onClick="logVariable('slots')" href="../../_variables/slots.html">$slots</a> as <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>) {
<a name="l504"><span class="linenum"> 504</span></a>          if ((<a class="var it29391" onMouseOver="hilite(29391)" onMouseOut="lolite()" onClick="logVariable('firstslots')" href="../../_variables/firstslots.html">$firstslots</a> &amp;&amp; <a class="phpfunction" onClick="logFunction('in_array')" href="../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>-&gt;<a onClick="logVariable('slot')" class="var it43545" onMouseOver="hilite(43545)" onMouseOut="lolite()" href="../../_variables/slot.html">slot</a>, <a class="var it29391" onMouseOver="hilite(29391)" onMouseOut="lolite()" onClick="logVariable('firstslots')" href="../../_variables/firstslots.html">$firstslots</a>)) ||
<a name="l505"><span class="linenum"> 505</span></a>              (<a class="var it41434" onMouseOver="hilite(41434)" onMouseOut="lolite()" onClick="logVariable('slotsonthispage')" href="../../_variables/slotsonthispage.html">$slotsonthispage</a> &amp;&amp; <a class="var it41434" onMouseOver="hilite(41434)" onMouseOut="lolite()" onClick="logVariable('slotsonthispage')" href="../../_variables/slotsonthispage.html">$slotsonthispage</a> == <a class="var it41433" onMouseOver="hilite(41433)" onMouseOut="lolite()" onClick="logVariable('slotsperpage')" href="../../_variables/slotsperpage.html">$slotsperpage</a>)) {
<a name="l506"><span class="linenum"> 506</span></a>              <a class="var it10055" onMouseOver="hilite(10055)" onMouseOut="lolite()" onClick="logVariable('currentpage')" href="../../_variables/currentpage.html">$currentpage</a> += 1;
<a name="l507"><span class="linenum"> 507</span></a>              <a class="var it41434" onMouseOver="hilite(41434)" onMouseOut="lolite()" onClick="logVariable('slotsonthispage')" href="../../_variables/slotsonthispage.html">$slotsonthispage</a> = 0;
<a name="l508"><span class="linenum"> 508</span></a>          }
<a name="l509"><span class="linenum"> 509</span></a>          if (<a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>-&gt;<a onClick="logVariable('page')" class="var it43545" onMouseOver="hilite(43545)" onMouseOut="lolite()" href="../../_variables/page.html">page</a> != <a class="var it10055" onMouseOver="hilite(10055)" onMouseOut="lolite()" onClick="logVariable('currentpage')" href="../../_variables/currentpage.html">$currentpage</a>) {
<a name="l510"><span class="linenum"> 510</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('quiz_slots', 'page', <a class="var it10055" onMouseOver="hilite(10055)" onMouseOut="lolite()" onClick="logVariable('currentpage')" href="../../_variables/currentpage.html">$currentpage</a>, array('id' =&gt; <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>-&gt;<a onClick="logVariable('id')" class="var it43545" onMouseOver="hilite(43545)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l511"><span class="linenum"> 511</span></a>          }
<a name="l512"><span class="linenum"> 512</span></a>          <a class="var it41434" onMouseOver="hilite(41434)" onMouseOut="lolite()" onClick="logVariable('slotsonthispage')" href="../../_variables/slotsonthispage.html">$slotsonthispage</a> += 1;
<a name="l513"><span class="linenum"> 513</span></a>      }
<a name="l514"><span class="linenum"> 514</span></a>  
<a name="l515"><span class="linenum"> 515</span></a>      <a class="var it18640" onMouseOver="hilite(18640)" onMouseOut="lolite()" onClick="logVariable('trans')" href="../../_variables/trans.html">$trans</a>-&gt;<a class="function" onClick="logFunction('allow_commit')" href="../../_functions/allow_commit.html" onMouseOver="funcPopup(event,'allow_commit')">allow_commit</a>();
<a name="l516"><span class="linenum"> 516</span></a>  }
<a name="l517"><span class="linenum"> 517</span></a>  
<a name="l518"><span class="linenum"> 518</span></a>  <span class="comment">// Functions to do with quiz grades ////////////////////////////////////////////</span>
<a name="l519"><span class="linenum"> 519</span></a>  
<a name="l520"><span class="linenum"> 520</span></a>  <span class="comment">/**</span>
<a name="l521"><span class="linenum"> 521</span></a>  <span class="comment"> * Convert the raw grade stored in $attempt into a grade out of the maximum</span>
<a name="l522"><span class="linenum"> 522</span></a>  <span class="comment"> * grade for this quiz.</span>
<a name="l523"><span class="linenum"> 523</span></a>  <span class="comment"> *</span>
<a name="l524"><span class="linenum"> 524</span></a>  <span class="comment"> * @param float $rawgrade the unadjusted grade, fof example $attempt-&gt;sumgrades</span>
<a name="l525"><span class="linenum"> 525</span></a>  <span class="comment"> * @param object $quiz the quiz object. Only the fields grade, sumgrades and decimalpoints are used.</span>
<a name="l526"><span class="linenum"> 526</span></a>  <span class="comment"> * @param bool|string $format whether to format the results for display</span>
<a name="l527"><span class="linenum"> 527</span></a>  <span class="comment"> *      or 'question' to format a question grade (different number of decimal places.</span>
<a name="l528"><span class="linenum"> 528</span></a>  <span class="comment"> * @return float|string the rescaled grade, or null/the lang string 'notyetgraded'</span>
<a name="l529"><span class="linenum"> 529</span></a>  <span class="comment"> *      if the $grade is null.</span>
<a name="l530"><span class="linenum"> 530</span></a>  <span class="comment"> */</span>
<a name="l531"><span class="linenum"> 531</span></a>  function <a class="function" onClick="logFunction('quiz_rescale_grade')" href="../../_functions/quiz_rescale_grade.html" onMouseOver="funcPopup(event,'quiz_rescale_grade')">quiz_rescale_grade</a>(<a class="var it3411" onMouseOver="hilite(3411)" onMouseOut="lolite()" onClick="logVariable('rawgrade')" href="../../_variables/rawgrade.html">$rawgrade</a>, <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it606" onMouseOver="hilite(606)" onMouseOut="lolite()" onClick="logVariable('format')" href="../../_variables/format.html">$format</a> = true) {
<a name="l532"><span class="linenum"> 532</span></a>      if (<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it3411" onMouseOver="hilite(3411)" onMouseOut="lolite()" onClick="logVariable('rawgrade')" href="../../_variables/rawgrade.html">$rawgrade</a>)) {
<a name="l533"><span class="linenum"> 533</span></a>          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a> = null;
<a name="l534"><span class="linenum"> 534</span></a>      } else if (<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('sumgrades')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/sumgrades.html">sumgrades</a> &gt;= 0.000005) {
<a name="l535"><span class="linenum"> 535</span></a>          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a> = <a class="var it3411" onMouseOver="hilite(3411)" onMouseOut="lolite()" onClick="logVariable('rawgrade')" href="../../_variables/rawgrade.html">$rawgrade</a> * <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('grade')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> / <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('sumgrades')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/sumgrades.html">sumgrades</a>;
<a name="l536"><span class="linenum"> 536</span></a>      } else {
<a name="l537"><span class="linenum"> 537</span></a>          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a> = 0;
<a name="l538"><span class="linenum"> 538</span></a>      }
<a name="l539"><span class="linenum"> 539</span></a>      if (<a class="var it606" onMouseOver="hilite(606)" onMouseOut="lolite()" onClick="logVariable('format')" href="../../_variables/format.html">$format</a> === 'question') {
<a name="l540"><span class="linenum"> 540</span></a>          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a> = <a class="function" onClick="logFunction('quiz_format_question_grade')" href="../../_functions/quiz_format_question_grade.html" onMouseOver="funcPopup(event,'quiz_format_question_grade')">quiz_format_question_grade</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>);
<a name="l541"><span class="linenum"> 541</span></a>      } else if (<a class="var it606" onMouseOver="hilite(606)" onMouseOut="lolite()" onClick="logVariable('format')" href="../../_variables/format.html">$format</a>) {
<a name="l542"><span class="linenum"> 542</span></a>          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a> = <a class="function" onClick="logFunction('quiz_format_grade')" href="../../_functions/quiz_format_grade.html" onMouseOver="funcPopup(event,'quiz_format_grade')">quiz_format_grade</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>);
<a name="l543"><span class="linenum"> 543</span></a>      }
<a name="l544"><span class="linenum"> 544</span></a>      return <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>;
<a name="l545"><span class="linenum"> 545</span></a>  }
<a name="l546"><span class="linenum"> 546</span></a>  
<a name="l547"><span class="linenum"> 547</span></a>  <span class="comment">/**</span>
<a name="l548"><span class="linenum"> 548</span></a>  <span class="comment"> * Get the feedback object for this grade on this quiz.</span>
<a name="l549"><span class="linenum"> 549</span></a>  <span class="comment"> *</span>
<a name="l550"><span class="linenum"> 550</span></a>  <span class="comment"> * @param float $grade a grade on this quiz.</span>
<a name="l551"><span class="linenum"> 551</span></a>  <span class="comment"> * @param object $quiz the quiz settings.</span>
<a name="l552"><span class="linenum"> 552</span></a>  <span class="comment"> * @return false|stdClass the record object or false if there is not feedback for the given grade</span>
<a name="l553"><span class="linenum"> 553</span></a>  <span class="comment"> * @since  Moodle 3.1</span>
<a name="l554"><span class="linenum"> 554</span></a>  <span class="comment"> */</span>
<a name="l555"><span class="linenum"> 555</span></a>  function <a class="function" onClick="logFunction('quiz_feedback_record_for_grade')" href="../../_functions/quiz_feedback_record_for_grade.html" onMouseOver="funcPopup(event,'quiz_feedback_record_for_grade')">quiz_feedback_record_for_grade</a>(<a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>, <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>) {
<a name="l556"><span class="linenum"> 556</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l557"><span class="linenum"> 557</span></a>  
<a name="l558"><span class="linenum"> 558</span></a>  <span class="comment">    // With CBM etc, it is possible to get -ve grades, which would then not match</span>
<a name="l559"><span class="linenum"> 559</span></a>  <span class="comment">    // any feedback. Therefore, we replace -ve grades with 0.</span>
<a name="l560"><span class="linenum"> 560</span></a>      <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a> = <a class="phpfunction" onClick="logFunction('max')" href="../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">max</a>(<a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>, 0);
<a name="l561"><span class="linenum"> 561</span></a>  
<a name="l562"><span class="linenum"> 562</span></a>      <a class="var it954" onMouseOver="hilite(954)" onMouseOut="lolite()" onClick="logVariable('feedback')" href="../../_variables/feedback.html">$feedback</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record_select')" href="../../_functions/get_record_select.html" onMouseOver="funcPopup(event,'get_record_select')">get_record_select</a>('quiz_feedback',
<a name="l563"><span class="linenum"> 563</span></a>              'quizid = ? AND mingrade &lt;= ? AND ? &lt; maxgrade', array(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>, <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>));
<a name="l564"><span class="linenum"> 564</span></a>  
<a name="l565"><span class="linenum"> 565</span></a>      return <a class="var it954" onMouseOver="hilite(954)" onMouseOut="lolite()" onClick="logVariable('feedback')" href="../../_variables/feedback.html">$feedback</a>;
<a name="l566"><span class="linenum"> 566</span></a>  }
<a name="l567"><span class="linenum"> 567</span></a>  
<a name="l568"><span class="linenum"> 568</span></a>  <span class="comment">/**</span>
<a name="l569"><span class="linenum"> 569</span></a>  <span class="comment"> * Get the feedback text that should be show to a student who</span>
<a name="l570"><span class="linenum"> 570</span></a>  <span class="comment"> * got this grade on this quiz. The feedback is processed ready for diplay.</span>
<a name="l571"><span class="linenum"> 571</span></a>  <span class="comment"> *</span>
<a name="l572"><span class="linenum"> 572</span></a>  <span class="comment"> * @param float $grade a grade on this quiz.</span>
<a name="l573"><span class="linenum"> 573</span></a>  <span class="comment"> * @param object $quiz the quiz settings.</span>
<a name="l574"><span class="linenum"> 574</span></a>  <span class="comment"> * @param object $context the quiz context.</span>
<a name="l575"><span class="linenum"> 575</span></a>  <span class="comment"> * @return string the comment that corresponds to this grade (empty string if there is not one.</span>
<a name="l576"><span class="linenum"> 576</span></a>  <span class="comment"> */</span>
<a name="l577"><span class="linenum"> 577</span></a>  function <a class="function" onClick="logFunction('quiz_feedback_for_grade')" href="../../_functions/quiz_feedback_for_grade.html" onMouseOver="funcPopup(event,'quiz_feedback_for_grade')">quiz_feedback_for_grade</a>(<a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>, <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>) {
<a name="l578"><span class="linenum"> 578</span></a>  
<a name="l579"><span class="linenum"> 579</span></a>      if (<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>)) {
<a name="l580"><span class="linenum"> 580</span></a>          return '';
<a name="l581"><span class="linenum"> 581</span></a>      }
<a name="l582"><span class="linenum"> 582</span></a>  
<a name="l583"><span class="linenum"> 583</span></a>      <a class="var it954" onMouseOver="hilite(954)" onMouseOut="lolite()" onClick="logVariable('feedback')" href="../../_variables/feedback.html">$feedback</a> = <a class="function" onClick="logFunction('quiz_feedback_record_for_grade')" href="../../_functions/quiz_feedback_record_for_grade.html" onMouseOver="funcPopup(event,'quiz_feedback_record_for_grade')">quiz_feedback_record_for_grade</a>(<a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>, <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>);
<a name="l584"><span class="linenum"> 584</span></a>  
<a name="l585"><span class="linenum"> 585</span></a>      if (empty(<a class="var it954" onMouseOver="hilite(954)" onMouseOut="lolite()" onClick="logVariable('feedback')" href="../../_variables/feedback.html">$feedback</a>-&gt;<a onClick="logVariable('feedbacktext')" class="var it43060" onMouseOver="hilite(43060)" onMouseOut="lolite()" href="../../_variables/feedbacktext.html">feedbacktext</a>)) {
<a name="l586"><span class="linenum"> 586</span></a>          return '';
<a name="l587"><span class="linenum"> 587</span></a>      }
<a name="l588"><span class="linenum"> 588</span></a>  
<a name="l589"><span class="linenum"> 589</span></a>  <span class="comment">    // Clean the text, ready for display.</span>
<a name="l590"><span class="linenum"> 590</span></a>      <a class="var it8419" onMouseOver="hilite(8419)" onMouseOut="lolite()" onClick="logVariable('formatoptions')" href="../../_variables/formatoptions.html">$formatoptions</a> = new stdClass();
<a name="l591"><span class="linenum"> 591</span></a>      <a class="var it8419" onMouseOver="hilite(8419)" onMouseOut="lolite()" onClick="logVariable('formatoptions')" href="../../_variables/formatoptions.html">$formatoptions</a>-&gt;<a onClick="logVariable('noclean')" class="var it43693" onMouseOver="hilite(43693)" onMouseOut="lolite()" href="../../_variables/noclean.html">noclean</a> = true;
<a name="l592"><span class="linenum"> 592</span></a>      <a class="var it6245" onMouseOver="hilite(6245)" onMouseOut="lolite()" onClick="logVariable('feedbacktext')" href="../../_variables/feedbacktext.html">$feedbacktext</a> = <a class="function" onClick="logFunction('file_rewrite_pluginfile_urls')" href="../../_functions/file_rewrite_pluginfile_urls.html" onMouseOver="funcPopup(event,'file_rewrite_pluginfile_urls')">file_rewrite_pluginfile_urls</a>(<a class="var it954" onMouseOver="hilite(954)" onMouseOut="lolite()" onClick="logVariable('feedback')" href="../../_variables/feedback.html">$feedback</a>-&gt;<a onClick="logVariable('feedbacktext')" class="var it43060" onMouseOver="hilite(43060)" onMouseOut="lolite()" href="../../_variables/feedbacktext.html">feedbacktext</a>, '<a class="filename" href="../../pluginfile.php.html">pluginfile.php</a>',
<a name="l593"><span class="linenum"> 593</span></a>              <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'mod_quiz', 'feedback', <a class="var it954" onMouseOver="hilite(954)" onMouseOut="lolite()" onClick="logVariable('feedback')" href="../../_variables/feedback.html">$feedback</a>-&gt;<a onClick="logVariable('id')" class="var it43060" onMouseOver="hilite(43060)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l594"><span class="linenum"> 594</span></a>      <a class="var it6245" onMouseOver="hilite(6245)" onMouseOut="lolite()" onClick="logVariable('feedbacktext')" href="../../_variables/feedbacktext.html">$feedbacktext</a> = <a class="function" onClick="logFunction('format_text')" href="../../_functions/format_text.html" onMouseOver="funcPopup(event,'format_text')">format_text</a>(<a class="var it6245" onMouseOver="hilite(6245)" onMouseOut="lolite()" onClick="logVariable('feedbacktext')" href="../../_variables/feedbacktext.html">$feedbacktext</a>, <a class="var it954" onMouseOver="hilite(954)" onMouseOut="lolite()" onClick="logVariable('feedback')" href="../../_variables/feedback.html">$feedback</a>-&gt;<a onClick="logVariable('feedbacktextformat')" class="var it43060" onMouseOver="hilite(43060)" onMouseOut="lolite()" href="../../_variables/feedbacktextformat.html">feedbacktextformat</a>, <a class="var it8419" onMouseOver="hilite(8419)" onMouseOut="lolite()" onClick="logVariable('formatoptions')" href="../../_variables/formatoptions.html">$formatoptions</a>);
<a name="l595"><span class="linenum"> 595</span></a>  
<a name="l596"><span class="linenum"> 596</span></a>      return <a class="var it6245" onMouseOver="hilite(6245)" onMouseOut="lolite()" onClick="logVariable('feedbacktext')" href="../../_variables/feedbacktext.html">$feedbacktext</a>;
<a name="l597"><span class="linenum"> 597</span></a>  }
<a name="l598"><span class="linenum"> 598</span></a>  
<a name="l599"><span class="linenum"> 599</span></a>  <span class="comment">/**</span>
<a name="l600"><span class="linenum"> 600</span></a>  <span class="comment"> * @param object $quiz the quiz database row.</span>
<a name="l601"><span class="linenum"> 601</span></a>  <span class="comment"> * @return bool Whether this quiz has any non-blank feedback text.</span>
<a name="l602"><span class="linenum"> 602</span></a>  <span class="comment"> */</span>
<a name="l603"><span class="linenum"> 603</span></a>  function <a class="function" onClick="logFunction('quiz_has_feedback')" href="../../_functions/quiz_has_feedback.html" onMouseOver="funcPopup(event,'quiz_has_feedback')">quiz_has_feedback</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>) {
<a name="l604"><span class="linenum"> 604</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l605"><span class="linenum"> 605</span></a>      static <a class="var it415" onMouseOver="hilite(415)" onMouseOut="lolite()" onClick="logVariable('cache')" href="../../_variables/cache.html">$cache</a> = array();
<a name="l606"><span class="linenum"> 606</span></a>      if (!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it415" onMouseOver="hilite(415)" onMouseOut="lolite()" onClick="logVariable('cache')" href="../../_variables/cache.html">$cache</a>)) {
<a name="l607"><span class="linenum"> 607</span></a>          <a class="var it415" onMouseOver="hilite(415)" onMouseOut="lolite()" onClick="logVariable('cache')" href="../../_variables/cache.html">$cache</a>[<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>] = <a class="function" onClick="logFunction('quiz_has_grades')" href="../../_functions/quiz_has_grades.html" onMouseOver="funcPopup(event,'quiz_has_grades')">quiz_has_grades</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>) &amp;&amp;
<a name="l608"><span class="linenum"> 608</span></a>                  <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('record_exists_select')" href="../../_functions/record_exists_select.html" onMouseOver="funcPopup(event,'record_exists_select')">record_exists_select</a>('quiz_feedback', &quot;quizid = ? AND &quot; .
<a name="l609"><span class="linenum"> 609</span></a>                      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_isnotempty')" href="../../_functions/sql_isnotempty.html" onMouseOver="funcPopup(event,'sql_isnotempty')">sql_isnotempty</a>('quiz_feedback', 'feedbacktext', false, true),
<a name="l610"><span class="linenum"> 610</span></a>                  array(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l611"><span class="linenum"> 611</span></a>      }
<a name="l612"><span class="linenum"> 612</span></a>      return <a class="var it415" onMouseOver="hilite(415)" onMouseOut="lolite()" onClick="logVariable('cache')" href="../../_variables/cache.html">$cache</a>[<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>];
<a name="l613"><span class="linenum"> 613</span></a>  }
<a name="l614"><span class="linenum"> 614</span></a>  
<a name="l615"><span class="linenum"> 615</span></a>  <span class="comment">/**</span>
<a name="l616"><span class="linenum"> 616</span></a>  <span class="comment"> * Update the sumgrades field of the quiz. This needs to be called whenever</span>
<a name="l617"><span class="linenum"> 617</span></a>  <span class="comment"> * the grading structure of the quiz is changed. For example if a question is</span>
<a name="l618"><span class="linenum"> 618</span></a>  <span class="comment"> * added or removed, or a question weight is changed.</span>
<a name="l619"><span class="linenum"> 619</span></a>  <span class="comment"> *</span>
<a name="l620"><span class="linenum"> 620</span></a>  <span class="comment"> * You should call {@link quiz_delete_previews()} before you call this function.</span>
<a name="l621"><span class="linenum"> 621</span></a>  <span class="comment"> *</span>
<a name="l622"><span class="linenum"> 622</span></a>  <span class="comment"> * @param object $quiz a quiz.</span>
<a name="l623"><span class="linenum"> 623</span></a>  <span class="comment"> */</span>
<a name="l624"><span class="linenum"> 624</span></a>  function <a class="function" onClick="logFunction('quiz_update_sumgrades')" href="../../_functions/quiz_update_sumgrades.html" onMouseOver="funcPopup(event,'quiz_update_sumgrades')">quiz_update_sumgrades</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>) {
<a name="l625"><span class="linenum"> 625</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l626"><span class="linenum"> 626</span></a>  
<a name="l627"><span class="linenum"> 627</span></a>      <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = 'UPDATE {quiz}
<a name="l628"><span class="linenum"> 628</span></a>              SET sumgrades = COALESCE((
<a name="l629"><span class="linenum"> 629</span></a>                  SELECT <a class="function" onClick="logFunction('SUM')" href="../../_functions/sum.html" onMouseOver="funcPopup(event,'sum')">SUM</a>(maxmark)
<a name="l630"><span class="linenum"> 630</span></a>                  FROM {quiz_slots}
<a name="l631"><span class="linenum"> 631</span></a>                  WHERE quizid = {quiz}.id
<a name="l632"><span class="linenum"> 632</span></a>              ), 0)
<a name="l633"><span class="linenum"> 633</span></a>              WHERE id = ?';
<a name="l634"><span class="linenum"> 634</span></a>      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, array(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l635"><span class="linenum"> 635</span></a>      <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('sumgrades')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/sumgrades.html">sumgrades</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_field')" href="../../_functions/get_field.html" onMouseOver="funcPopup(event,'get_field')">get_field</a>('quiz', 'sumgrades', array('id' =&gt; <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l636"><span class="linenum"> 636</span></a>  
<a name="l637"><span class="linenum"> 637</span></a>      if (<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('sumgrades')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/sumgrades.html">sumgrades</a> &lt; 0.000005 &amp;&amp; <a class="function" onClick="logFunction('quiz_has_attempts')" href="../../_functions/quiz_has_attempts.html" onMouseOver="funcPopup(event,'quiz_has_attempts')">quiz_has_attempts</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>)) {
<a name="l638"><span class="linenum"> 638</span></a>  <span class="comment">        // If the quiz has been attempted, and the sumgrades has been</span>
<a name="l639"><span class="linenum"> 639</span></a>  <span class="comment">        // set to 0, then we must also set the maximum possible grade to 0, or</span>
<a name="l640"><span class="linenum"> 640</span></a>  <span class="comment">        // we will get a divide by zero error.</span>
<a name="l641"><span class="linenum"> 641</span></a>          <a class="function" onClick="logFunction('quiz_set_grade')" href="../../_functions/quiz_set_grade.html" onMouseOver="funcPopup(event,'quiz_set_grade')">quiz_set_grade</a>(0, <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>);
<a name="l642"><span class="linenum"> 642</span></a>      }
<a name="l643"><span class="linenum"> 643</span></a>  }
<a name="l644"><span class="linenum"> 644</span></a>  
<a name="l645"><span class="linenum"> 645</span></a>  <span class="comment">/**</span>
<a name="l646"><span class="linenum"> 646</span></a>  <span class="comment"> * Update the sumgrades field of the attempts at a quiz.</span>
<a name="l647"><span class="linenum"> 647</span></a>  <span class="comment"> *</span>
<a name="l648"><span class="linenum"> 648</span></a>  <span class="comment"> * @param object $quiz a quiz.</span>
<a name="l649"><span class="linenum"> 649</span></a>  <span class="comment"> */</span>
<a name="l650"><span class="linenum"> 650</span></a>  function <a class="function" onClick="logFunction('quiz_update_all_attempt_sumgrades')" href="../../_functions/quiz_update_all_attempt_sumgrades.html" onMouseOver="funcPopup(event,'quiz_update_all_attempt_sumgrades')">quiz_update_all_attempt_sumgrades</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>) {
<a name="l651"><span class="linenum"> 651</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l652"><span class="linenum"> 652</span></a>      <a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('dm')" href="../../_variables/dm.html">$dm</a> = <span class="keyword">new </span><a class="class" onClick="logClass('question_engine_data_mapper')" href="../../_classes/question_engine_data_mapper.html" onMouseOver="classPopup(event,'question_engine_data_mapper')">question_engine_data_mapper</a>();
<a name="l653"><span class="linenum"> 653</span></a>      <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l654"><span class="linenum"> 654</span></a>  
<a name="l655"><span class="linenum"> 655</span></a>      <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;UPDATE {quiz_attempts}
<a name="l656"><span class="linenum"> 656</span></a>              SET
<a name="l657"><span class="linenum"> 657</span></a>                  timemodified = :timenow,
<a name="l658"><span class="linenum"> 658</span></a>                  sumgrades = (
<a name="l659"><span class="linenum"> 659</span></a>                      {<a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('dm')" href="../../_variables/dm.html">$dm</a>-&gt;<a class="function" onClick="logFunction('sum_usage_marks_subquery')" href="../../_functions/sum_usage_marks_subquery.html" onMouseOver="funcPopup(event,'sum_usage_marks_subquery')">sum_usage_marks_subquery</a>('uniqueid')}
<a name="l660"><span class="linenum"> 660</span></a>                  )
<a name="l661"><span class="linenum"> 661</span></a>              WHERE quiz = :quizid AND state = :finishedstate&quot;;
<a name="l662"><span class="linenum"> 662</span></a>      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, array('timenow' =&gt; <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a>, 'quizid' =&gt; <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l663"><span class="linenum"> 663</span></a>              'finishedstate' =&gt; <a class="class" onClick="logClass('quiz_attempt')" href="../../_classes/quiz_attempt.html" onMouseOver="classPopup(event,'quiz_attempt')">quiz_attempt</a>::FINISHED));
<a name="l664"><span class="linenum"> 664</span></a>  }
<a name="l665"><span class="linenum"> 665</span></a>  
<a name="l666"><span class="linenum"> 666</span></a>  <span class="comment">/**</span>
<a name="l667"><span class="linenum"> 667</span></a>  <span class="comment"> * The quiz grade is the maximum that student's results are marked out of. When it</span>
<a name="l668"><span class="linenum"> 668</span></a>  <span class="comment"> * changes, the corresponding data in quiz_grades and quiz_feedback needs to be</span>
<a name="l669"><span class="linenum"> 669</span></a>  <span class="comment"> * rescaled. After calling this function, you probably need to call</span>
<a name="l670"><span class="linenum"> 670</span></a>  <span class="comment"> * quiz_update_all_attempt_sumgrades, quiz_update_all_final_grades and</span>
<a name="l671"><span class="linenum"> 671</span></a>  <span class="comment"> * quiz_update_grades.</span>
<a name="l672"><span class="linenum"> 672</span></a>  <span class="comment"> *</span>
<a name="l673"><span class="linenum"> 673</span></a>  <span class="comment"> * @param float $newgrade the new maximum grade for the quiz.</span>
<a name="l674"><span class="linenum"> 674</span></a>  <span class="comment"> * @param object $quiz the quiz we are updating. Passed by reference so its</span>
<a name="l675"><span class="linenum"> 675</span></a>  <span class="comment"> *      grade field can be updated too.</span>
<a name="l676"><span class="linenum"> 676</span></a>  <span class="comment"> * @return bool indicating success or failure.</span>
<a name="l677"><span class="linenum"> 677</span></a>  <span class="comment"> */</span>
<a name="l678"><span class="linenum"> 678</span></a>  function <a class="function" onClick="logFunction('quiz_set_grade')" href="../../_functions/quiz_set_grade.html" onMouseOver="funcPopup(event,'quiz_set_grade')">quiz_set_grade</a>(<a class="var it8647" onMouseOver="hilite(8647)" onMouseOut="lolite()" onClick="logVariable('newgrade')" href="../../_variables/newgrade.html">$newgrade</a>, <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>) {
<a name="l679"><span class="linenum"> 679</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l680"><span class="linenum"> 680</span></a>  <span class="comment">    // This is potentially expensive, so only do it if necessary.</span>
<a name="l681"><span class="linenum"> 681</span></a>      if (<a class="phpfunction" onClick="logFunction('abs')" href="../../_functions/abs.html" onMouseOver="phpfuncPopup(event,'abs')">abs</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('grade')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> - <a class="var it8647" onMouseOver="hilite(8647)" onMouseOut="lolite()" onClick="logVariable('newgrade')" href="../../_variables/newgrade.html">$newgrade</a>) &lt; 1e-7) {
<a name="l682"><span class="linenum"> 682</span></a>  <span class="comment">        // Nothing to do.</span>
<a name="l683"><span class="linenum"> 683</span></a>          return true;
<a name="l684"><span class="linenum"> 684</span></a>      }
<a name="l685"><span class="linenum"> 685</span></a>  
<a name="l686"><span class="linenum"> 686</span></a>      <a class="var it1281" onMouseOver="hilite(1281)" onMouseOut="lolite()" onClick="logVariable('oldgrade')" href="../../_variables/oldgrade.html">$oldgrade</a> = <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('grade')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a>;
<a name="l687"><span class="linenum"> 687</span></a>      <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('grade')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> = <a class="var it8647" onMouseOver="hilite(8647)" onMouseOut="lolite()" onClick="logVariable('newgrade')" href="../../_variables/newgrade.html">$newgrade</a>;
<a name="l688"><span class="linenum"> 688</span></a>  
<a name="l689"><span class="linenum"> 689</span></a>  <span class="comment">    // Use a transaction, so that on those databases that support it, this is safer.</span>
<a name="l690"><span class="linenum"> 690</span></a>      <a class="var it4224" onMouseOver="hilite(4224)" onMouseOut="lolite()" onClick="logVariable('transaction')" href="../../_variables/transaction.html">$transaction</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('start_delegated_transaction')" href="../../_functions/start_delegated_transaction.html" onMouseOver="funcPopup(event,'start_delegated_transaction')">start_delegated_transaction</a>();
<a name="l691"><span class="linenum"> 691</span></a>  
<a name="l692"><span class="linenum"> 692</span></a>  <span class="comment">    // Update the quiz table.</span>
<a name="l693"><span class="linenum"> 693</span></a>      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('quiz', 'grade', <a class="var it8647" onMouseOver="hilite(8647)" onMouseOut="lolite()" onClick="logVariable('newgrade')" href="../../_variables/newgrade.html">$newgrade</a>, array('id' =&gt; <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('instance')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/instance.html">instance</a>));
<a name="l694"><span class="linenum"> 694</span></a>  
<a name="l695"><span class="linenum"> 695</span></a>      if (<a class="var it1281" onMouseOver="hilite(1281)" onMouseOut="lolite()" onClick="logVariable('oldgrade')" href="../../_variables/oldgrade.html">$oldgrade</a> &lt; 1) {
<a name="l696"><span class="linenum"> 696</span></a>  <span class="comment">        // If the old grade was zero, we cannot rescale, we have to recompute.</span>
<a name="l697"><span class="linenum"> 697</span></a>  <span class="comment">        // We also recompute if the old grade was too small to avoid underflow problems.</span>
<a name="l698"><span class="linenum"> 698</span></a>          <a class="function" onClick="logFunction('quiz_update_all_final_grades')" href="../../_functions/quiz_update_all_final_grades.html" onMouseOver="funcPopup(event,'quiz_update_all_final_grades')">quiz_update_all_final_grades</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>);
<a name="l699"><span class="linenum"> 699</span></a>  
<a name="l700"><span class="linenum"> 700</span></a>      } else {
<a name="l701"><span class="linenum"> 701</span></a>  <span class="comment">        // We can rescale the grades efficiently.</span>
<a name="l702"><span class="linenum"> 702</span></a>          <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('timemodified')" href="../../_variables/timemodified.html">$timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l703"><span class="linenum"> 703</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>(&quot;
<a name="l704"><span class="linenum"> 704</span></a>                  UPDATE {quiz_grades}
<a name="l705"><span class="linenum"> 705</span></a>                  SET grade = ? * grade, timemodified = ?
<a name="l706"><span class="linenum"> 706</span></a>                  WHERE quiz = ?
<a name="l707"><span class="linenum"> 707</span></a>          &quot;, array(<a class="var it8647" onMouseOver="hilite(8647)" onMouseOut="lolite()" onClick="logVariable('newgrade')" href="../../_variables/newgrade.html">$newgrade</a>/<a class="var it1281" onMouseOver="hilite(1281)" onMouseOut="lolite()" onClick="logVariable('oldgrade')" href="../../_variables/oldgrade.html">$oldgrade</a>, <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('timemodified')" href="../../_variables/timemodified.html">$timemodified</a>, <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l708"><span class="linenum"> 708</span></a>      }
<a name="l709"><span class="linenum"> 709</span></a>  
<a name="l710"><span class="linenum"> 710</span></a>      if (<a class="var it1281" onMouseOver="hilite(1281)" onMouseOut="lolite()" onClick="logVariable('oldgrade')" href="../../_variables/oldgrade.html">$oldgrade</a> &gt; 1e-7) {
<a name="l711"><span class="linenum"> 711</span></a>  <span class="comment">        // Update the quiz_feedback table.</span>
<a name="l712"><span class="linenum"> 712</span></a>          <a class="var it5041" onMouseOver="hilite(5041)" onMouseOut="lolite()" onClick="logVariable('factor')" href="../../_variables/factor.html">$factor</a> = <a class="var it8647" onMouseOver="hilite(8647)" onMouseOut="lolite()" onClick="logVariable('newgrade')" href="../../_variables/newgrade.html">$newgrade</a>/<a class="var it1281" onMouseOver="hilite(1281)" onMouseOut="lolite()" onClick="logVariable('oldgrade')" href="../../_variables/oldgrade.html">$oldgrade</a>;
<a name="l713"><span class="linenum"> 713</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>(&quot;
<a name="l714"><span class="linenum"> 714</span></a>                  UPDATE {quiz_feedback}
<a name="l715"><span class="linenum"> 715</span></a>                  SET mingrade = ? * mingrade, maxgrade = ? * maxgrade
<a name="l716"><span class="linenum"> 716</span></a>                  WHERE quizid = ?
<a name="l717"><span class="linenum"> 717</span></a>          &quot;, array(<a class="var it5041" onMouseOver="hilite(5041)" onMouseOut="lolite()" onClick="logVariable('factor')" href="../../_variables/factor.html">$factor</a>, <a class="var it5041" onMouseOver="hilite(5041)" onMouseOut="lolite()" onClick="logVariable('factor')" href="../../_variables/factor.html">$factor</a>, <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l718"><span class="linenum"> 718</span></a>      }
<a name="l719"><span class="linenum"> 719</span></a>  
<a name="l720"><span class="linenum"> 720</span></a>  <span class="comment">    // Update grade item and send all grades to gradebook.</span>
<a name="l721"><span class="linenum"> 721</span></a>      <a class="function" onClick="logFunction('quiz_grade_item_update')" href="../../_functions/quiz_grade_item_update.html" onMouseOver="funcPopup(event,'quiz_grade_item_update')">quiz_grade_item_update</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>);
<a name="l722"><span class="linenum"> 722</span></a>      <a class="function" onClick="logFunction('quiz_update_grades')" href="../../_functions/quiz_update_grades.html" onMouseOver="funcPopup(event,'quiz_update_grades')">quiz_update_grades</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>);
<a name="l723"><span class="linenum"> 723</span></a>  
<a name="l724"><span class="linenum"> 724</span></a>      <a class="var it4224" onMouseOver="hilite(4224)" onMouseOut="lolite()" onClick="logVariable('transaction')" href="../../_variables/transaction.html">$transaction</a>-&gt;<a class="function" onClick="logFunction('allow_commit')" href="../../_functions/allow_commit.html" onMouseOver="funcPopup(event,'allow_commit')">allow_commit</a>();
<a name="l725"><span class="linenum"> 725</span></a>      return true;
<a name="l726"><span class="linenum"> 726</span></a>  }
<a name="l727"><span class="linenum"> 727</span></a>  
<a name="l728"><span class="linenum"> 728</span></a>  <span class="comment">/**</span>
<a name="l729"><span class="linenum"> 729</span></a>  <span class="comment"> * Save the overall grade for a user at a quiz in the quiz_grades table</span>
<a name="l730"><span class="linenum"> 730</span></a>  <span class="comment"> *</span>
<a name="l731"><span class="linenum"> 731</span></a>  <span class="comment"> * @param object $quiz The quiz for which the best grade is to be calculated and then saved.</span>
<a name="l732"><span class="linenum"> 732</span></a>  <span class="comment"> * @param int $userid The userid to calculate the grade for. Defaults to the current user.</span>
<a name="l733"><span class="linenum"> 733</span></a>  <span class="comment"> * @param array $attempts The attempts of this user. Useful if you are</span>
<a name="l734"><span class="linenum"> 734</span></a>  <span class="comment"> * looping through many users. Attempts can be fetched in one master query to</span>
<a name="l735"><span class="linenum"> 735</span></a>  <span class="comment"> * avoid repeated querying.</span>
<a name="l736"><span class="linenum"> 736</span></a>  <span class="comment"> * @return bool Indicates success or failure.</span>
<a name="l737"><span class="linenum"> 737</span></a>  <span class="comment"> */</span>
<a name="l738"><span class="linenum"> 738</span></a>  function <a class="function" onClick="logFunction('quiz_save_best_grade')" href="../../_functions/quiz_save_best_grade.html" onMouseOver="funcPopup(event,'quiz_save_best_grade')">quiz_save_best_grade</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a> = null, <a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a> = array()) {
<a name="l739"><span class="linenum"> 739</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>;
<a name="l740"><span class="linenum"> 740</span></a>  
<a name="l741"><span class="linenum"> 741</span></a>      if (empty(<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>)) {
<a name="l742"><span class="linenum"> 742</span></a>          <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a> = <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l743"><span class="linenum"> 743</span></a>      }
<a name="l744"><span class="linenum"> 744</span></a>  
<a name="l745"><span class="linenum"> 745</span></a>      if (!<a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a>) {
<a name="l746"><span class="linenum"> 746</span></a>  <span class="comment">        // Get all the attempts made by the user.</span>
<a name="l747"><span class="linenum"> 747</span></a>          <a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a> = <a class="function" onClick="logFunction('quiz_get_user_attempts')" href="../../_functions/quiz_get_user_attempts.html" onMouseOver="funcPopup(event,'quiz_get_user_attempts')">quiz_get_user_attempts</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>);
<a name="l748"><span class="linenum"> 748</span></a>      }
<a name="l749"><span class="linenum"> 749</span></a>  
<a name="l750"><span class="linenum"> 750</span></a>  <span class="comment">    // Calculate the best grade.</span>
<a name="l751"><span class="linenum"> 751</span></a>      <a class="var it14970" onMouseOver="hilite(14970)" onMouseOut="lolite()" onClick="logVariable('bestgrade')" href="../../_variables/bestgrade.html">$bestgrade</a> = <a class="function" onClick="logFunction('quiz_calculate_best_grade')" href="../../_functions/quiz_calculate_best_grade.html" onMouseOver="funcPopup(event,'quiz_calculate_best_grade')">quiz_calculate_best_grade</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a>);
<a name="l752"><span class="linenum"> 752</span></a>      <a class="var it14970" onMouseOver="hilite(14970)" onMouseOut="lolite()" onClick="logVariable('bestgrade')" href="../../_variables/bestgrade.html">$bestgrade</a> = <a class="function" onClick="logFunction('quiz_rescale_grade')" href="../../_functions/quiz_rescale_grade.html" onMouseOver="funcPopup(event,'quiz_rescale_grade')">quiz_rescale_grade</a>(<a class="var it14970" onMouseOver="hilite(14970)" onMouseOut="lolite()" onClick="logVariable('bestgrade')" href="../../_variables/bestgrade.html">$bestgrade</a>, <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, false);
<a name="l753"><span class="linenum"> 753</span></a>  
<a name="l754"><span class="linenum"> 754</span></a>  <span class="comment">    // Save the best grade in the database.</span>
<a name="l755"><span class="linenum"> 755</span></a>      if (<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it14970" onMouseOver="hilite(14970)" onMouseOut="lolite()" onClick="logVariable('bestgrade')" href="../../_variables/bestgrade.html">$bestgrade</a>)) {
<a name="l756"><span class="linenum"> 756</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('quiz_grades', array('quiz' =&gt; <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'userid' =&gt; <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>));
<a name="l757"><span class="linenum"> 757</span></a>  
<a name="l758"><span class="linenum"> 758</span></a>      } else if (<a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('quiz_grades',
<a name="l759"><span class="linenum"> 759</span></a>              array('quiz' =&gt; <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'userid' =&gt; <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>))) {
<a name="l760"><span class="linenum"> 760</span></a>          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('grade')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> = <a class="var it14970" onMouseOver="hilite(14970)" onMouseOut="lolite()" onClick="logVariable('bestgrade')" href="../../_variables/bestgrade.html">$bestgrade</a>;
<a name="l761"><span class="linenum"> 761</span></a>          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('timemodified')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l762"><span class="linenum"> 762</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('quiz_grades', <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>);
<a name="l763"><span class="linenum"> 763</span></a>  
<a name="l764"><span class="linenum"> 764</span></a>      } else {
<a name="l765"><span class="linenum"> 765</span></a>          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a> = new stdClass();
<a name="l766"><span class="linenum"> 766</span></a>          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('quiz')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/quiz.html">quiz</a> = <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l767"><span class="linenum"> 767</span></a>          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('userid')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> = <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>;
<a name="l768"><span class="linenum"> 768</span></a>          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('grade')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> = <a class="var it14970" onMouseOver="hilite(14970)" onMouseOut="lolite()" onClick="logVariable('bestgrade')" href="../../_variables/bestgrade.html">$bestgrade</a>;
<a name="l769"><span class="linenum"> 769</span></a>          <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('timemodified')" class="var it42963" onMouseOver="hilite(42963)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l770"><span class="linenum"> 770</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('quiz_grades', <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>);
<a name="l771"><span class="linenum"> 771</span></a>      }
<a name="l772"><span class="linenum"> 772</span></a>  
<a name="l773"><span class="linenum"> 773</span></a>      <a class="function" onClick="logFunction('quiz_update_grades')" href="../../_functions/quiz_update_grades.html" onMouseOver="funcPopup(event,'quiz_update_grades')">quiz_update_grades</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>);
<a name="l774"><span class="linenum"> 774</span></a>  }
<a name="l775"><span class="linenum"> 775</span></a>  
<a name="l776"><span class="linenum"> 776</span></a>  <span class="comment">/**</span>
<a name="l777"><span class="linenum"> 777</span></a>  <span class="comment"> * Calculate the overall grade for a quiz given a number of attempts by a particular user.</span>
<a name="l778"><span class="linenum"> 778</span></a>  <span class="comment"> *</span>
<a name="l779"><span class="linenum"> 779</span></a>  <span class="comment"> * @param object $quiz    the quiz settings object.</span>
<a name="l780"><span class="linenum"> 780</span></a>  <span class="comment"> * @param array $attempts an array of all the user's attempts at this quiz in order.</span>
<a name="l781"><span class="linenum"> 781</span></a>  <span class="comment"> * @return float          the overall grade</span>
<a name="l782"><span class="linenum"> 782</span></a>  <span class="comment"> */</span>
<a name="l783"><span class="linenum"> 783</span></a>  function <a class="function" onClick="logFunction('quiz_calculate_best_grade')" href="../../_functions/quiz_calculate_best_grade.html" onMouseOver="funcPopup(event,'quiz_calculate_best_grade')">quiz_calculate_best_grade</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a>) {
<a name="l784"><span class="linenum"> 784</span></a>  
<a name="l785"><span class="linenum"> 785</span></a>      switch (<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('grademethod')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/grademethod.html">grademethod</a>) {
<a name="l786"><span class="linenum"> 786</span></a>  
<a name="l787"><span class="linenum"> 787</span></a>          case <a class="constant" onClick="logConstant('QUIZ_ATTEMPTFIRST')" href="../../_constants/QUIZ_ATTEMPTFIRST.html" onMouseOver="constPopup(event,'QUIZ_ATTEMPTFIRST')">QUIZ_ATTEMPTFIRST</a>:
<a name="l788"><span class="linenum"> 788</span></a>              <a class="var it1283" onMouseOver="hilite(1283)" onMouseOut="lolite()" onClick="logVariable('firstattempt')" href="../../_variables/firstattempt.html">$firstattempt</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a>);
<a name="l789"><span class="linenum"> 789</span></a>              return <a class="var it1283" onMouseOver="hilite(1283)" onMouseOut="lolite()" onClick="logVariable('firstattempt')" href="../../_variables/firstattempt.html">$firstattempt</a>-&gt;<a onClick="logVariable('sumgrades')" class="var it43580" onMouseOver="hilite(43580)" onMouseOut="lolite()" href="../../_variables/sumgrades.html">sumgrades</a>;
<a name="l790"><span class="linenum"> 790</span></a>  
<a name="l791"><span class="linenum"> 791</span></a>          case <a class="constant" onClick="logConstant('QUIZ_ATTEMPTLAST')" href="../../_constants/QUIZ_ATTEMPTLAST.html" onMouseOver="constPopup(event,'QUIZ_ATTEMPTLAST')">QUIZ_ATTEMPTLAST</a>:
<a name="l792"><span class="linenum"> 792</span></a>              <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a> = <a class="phpfunction" onClick="logFunction('end')" href="../../_functions/end.html" onMouseOver="phpfuncPopup(event,'end')">end</a>(<a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a>);
<a name="l793"><span class="linenum"> 793</span></a>              return <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>-&gt;<a onClick="logVariable('sumgrades')" class="var it43541" onMouseOver="hilite(43541)" onMouseOut="lolite()" href="../../_variables/sumgrades.html">sumgrades</a>;
<a name="l794"><span class="linenum"> 794</span></a>  
<a name="l795"><span class="linenum"> 795</span></a>          case <a class="constant" onClick="logConstant('QUIZ_GRADEAVERAGE')" href="../../_constants/QUIZ_GRADEAVERAGE.html" onMouseOver="constPopup(event,'QUIZ_GRADEAVERAGE')">QUIZ_GRADEAVERAGE</a>:
<a name="l796"><span class="linenum"> 796</span></a>              <a class="var it2862" onMouseOver="hilite(2862)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a> = 0;
<a name="l797"><span class="linenum"> 797</span></a>              <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a> = 0;
<a name="l798"><span class="linenum"> 798</span></a>              foreach (<a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a> as <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>) {
<a name="l799"><span class="linenum"> 799</span></a>                  if (!<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('sumgrades')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/sumgrades.html">sumgrades</a>)) {
<a name="l800"><span class="linenum"> 800</span></a>                      <a class="var it2862" onMouseOver="hilite(2862)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a> += <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('sumgrades')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/sumgrades.html">sumgrades</a>;
<a name="l801"><span class="linenum"> 801</span></a>                      <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a>++;
<a name="l802"><span class="linenum"> 802</span></a>                  }
<a name="l803"><span class="linenum"> 803</span></a>              }
<a name="l804"><span class="linenum"> 804</span></a>              if (<a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a> == 0) {
<a name="l805"><span class="linenum"> 805</span></a>                  return null;
<a name="l806"><span class="linenum"> 806</span></a>              }
<a name="l807"><span class="linenum"> 807</span></a>              return <a class="var it2862" onMouseOver="hilite(2862)" onMouseOut="lolite()" onClick="logVariable('sum')" href="../../_variables/sum.html">$sum</a> / <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a>;
<a name="l808"><span class="linenum"> 808</span></a>  
<a name="l809"><span class="linenum"> 809</span></a>          case <a class="constant" onClick="logConstant('QUIZ_GRADEHIGHEST')" href="../../_constants/QUIZ_GRADEHIGHEST.html" onMouseOver="constPopup(event,'QUIZ_GRADEHIGHEST')">QUIZ_GRADEHIGHEST</a>:
<a name="l810"><span class="linenum"> 810</span></a>          default:
<a name="l811"><span class="linenum"> 811</span></a>              <a class="var it536" onMouseOver="hilite(536)" onMouseOut="lolite()" onClick="logVariable('max')" href="../../_variables/max.html">$max</a> = null;
<a name="l812"><span class="linenum"> 812</span></a>              foreach (<a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a> as <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>) {
<a name="l813"><span class="linenum"> 813</span></a>                  if (<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('sumgrades')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/sumgrades.html">sumgrades</a> &gt; <a class="var it536" onMouseOver="hilite(536)" onMouseOut="lolite()" onClick="logVariable('max')" href="../../_variables/max.html">$max</a>) {
<a name="l814"><span class="linenum"> 814</span></a>                      <a class="var it536" onMouseOver="hilite(536)" onMouseOut="lolite()" onClick="logVariable('max')" href="../../_variables/max.html">$max</a> = <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('sumgrades')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/sumgrades.html">sumgrades</a>;
<a name="l815"><span class="linenum"> 815</span></a>                  }
<a name="l816"><span class="linenum"> 816</span></a>              }
<a name="l817"><span class="linenum"> 817</span></a>              return <a class="var it536" onMouseOver="hilite(536)" onMouseOut="lolite()" onClick="logVariable('max')" href="../../_variables/max.html">$max</a>;
<a name="l818"><span class="linenum"> 818</span></a>      }
<a name="l819"><span class="linenum"> 819</span></a>  }
<a name="l820"><span class="linenum"> 820</span></a>  
<a name="l821"><span class="linenum"> 821</span></a>  <span class="comment">/**</span>
<a name="l822"><span class="linenum"> 822</span></a>  <span class="comment"> * Update the final grade at this quiz for all students.</span>
<a name="l823"><span class="linenum"> 823</span></a>  <span class="comment"> *</span>
<a name="l824"><span class="linenum"> 824</span></a>  <span class="comment"> * This function is equivalent to calling quiz_save_best_grade for all</span>
<a name="l825"><span class="linenum"> 825</span></a>  <span class="comment"> * users, but much more efficient.</span>
<a name="l826"><span class="linenum"> 826</span></a>  <span class="comment"> *</span>
<a name="l827"><span class="linenum"> 827</span></a>  <span class="comment"> * @param object $quiz the quiz settings.</span>
<a name="l828"><span class="linenum"> 828</span></a>  <span class="comment"> */</span>
<a name="l829"><span class="linenum"> 829</span></a>  function <a class="function" onClick="logFunction('quiz_update_all_final_grades')" href="../../_functions/quiz_update_all_final_grades.html" onMouseOver="funcPopup(event,'quiz_update_all_final_grades')">quiz_update_all_final_grades</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>) {
<a name="l830"><span class="linenum"> 830</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l831"><span class="linenum"> 831</span></a>  
<a name="l832"><span class="linenum"> 832</span></a>      if (!<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('sumgrades')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/sumgrades.html">sumgrades</a>) {
<a name="l833"><span class="linenum"> 833</span></a>          return;
<a name="l834"><span class="linenum"> 834</span></a>      }
<a name="l835"><span class="linenum"> 835</span></a>  
<a name="l836"><span class="linenum"> 836</span></a>      <a class="var it334" onMouseOver="hilite(334)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../_variables/param.html">$param</a> = array('iquizid' =&gt; <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'istatefinished' =&gt; <a class="class" onClick="logClass('quiz_attempt')" href="../../_classes/quiz_attempt.html" onMouseOver="classPopup(event,'quiz_attempt')">quiz_attempt</a>::FINISHED);
<a name="l837"><span class="linenum"> 837</span></a>      <a class="var it41435" onMouseOver="hilite(41435)" onMouseOut="lolite()" onClick="logVariable('firstlastattemptjoin')" href="../../_variables/firstlastattemptjoin.html">$firstlastattemptjoin</a> = &quot;<a class="function" onClick="logFunction('JOIN')" href="../../_functions/join.html" onMouseOver="funcPopup(event,'join')">JOIN</a> (
<a name="l838"><span class="linenum"> 838</span></a>              SELECT
<a name="l839"><span class="linenum"> 839</span></a>                  iquiza.userid,
<a name="l840"><span class="linenum"> 840</span></a>                  <a class="phpfunction" onClick="logFunction('MIN')" href="../../_functions/min.html" onMouseOver="phpfuncPopup(event,'min')">MIN</a>(attempt) AS firstattempt,
<a name="l841"><span class="linenum"> 841</span></a>                  <a class="phpfunction" onClick="logFunction('MAX')" href="../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">MAX</a>(attempt) AS lastattempt
<a name="l842"><span class="linenum"> 842</span></a>  
<a name="l843"><span class="linenum"> 843</span></a>              FROM {quiz_attempts} iquiza
<a name="l844"><span class="linenum"> 844</span></a>  
<a name="l845"><span class="linenum"> 845</span></a>              WHERE
<a name="l846"><span class="linenum"> 846</span></a>                  iquiza.state = :istatefinished AND
<a name="l847"><span class="linenum"> 847</span></a>                  iquiza.preview = 0 AND
<a name="l848"><span class="linenum"> 848</span></a>                  iquiza.quiz = :iquizid
<a name="l849"><span class="linenum"> 849</span></a>  
<a name="l850"><span class="linenum"> 850</span></a>              GROUP BY iquiza.userid
<a name="l851"><span class="linenum"> 851</span></a>          ) first_last_attempts ON first_last_attempts.userid = quiza.userid&quot;;
<a name="l852"><span class="linenum"> 852</span></a>  
<a name="l853"><span class="linenum"> 853</span></a>      switch (<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('grademethod')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/grademethod.html">grademethod</a>) {
<a name="l854"><span class="linenum"> 854</span></a>          case <a class="constant" onClick="logConstant('QUIZ_ATTEMPTFIRST')" href="../../_constants/QUIZ_ATTEMPTFIRST.html" onMouseOver="constPopup(event,'QUIZ_ATTEMPTFIRST')">QUIZ_ATTEMPTFIRST</a>:
<a name="l855"><span class="linenum"> 855</span></a>  <span class="comment">            // Because of the where clause, there will only be one row, but we</span>
<a name="l856"><span class="linenum"> 856</span></a>  <span class="comment">            // must still use an aggregate function.</span>
<a name="l857"><span class="linenum"> 857</span></a>              <a class="var it1047" onMouseOver="hilite(1047)" onMouseOut="lolite()" onClick="logVariable('select')" href="../../_variables/select.html">$select</a> = '<a class="phpfunction" onClick="logFunction('MAX')" href="../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">MAX</a>(quiza.sumgrades)';
<a name="l858"><span class="linenum"> 858</span></a>              <a class="var it11538" onMouseOver="hilite(11538)" onMouseOut="lolite()" onClick="logVariable('join')" href="../../_variables/join.html">$join</a> = <a class="var it41435" onMouseOver="hilite(41435)" onMouseOut="lolite()" onClick="logVariable('firstlastattemptjoin')" href="../../_variables/firstlastattemptjoin.html">$firstlastattemptjoin</a>;
<a name="l859"><span class="linenum"> 859</span></a>              <a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a> = 'quiza.attempt = first_last_attempts.firstattempt AND';
<a name="l860"><span class="linenum"> 860</span></a>              break;
<a name="l861"><span class="linenum"> 861</span></a>  
<a name="l862"><span class="linenum"> 862</span></a>          case <a class="constant" onClick="logConstant('QUIZ_ATTEMPTLAST')" href="../../_constants/QUIZ_ATTEMPTLAST.html" onMouseOver="constPopup(event,'QUIZ_ATTEMPTLAST')">QUIZ_ATTEMPTLAST</a>:
<a name="l863"><span class="linenum"> 863</span></a>  <span class="comment">            // Because of the where clause, there will only be one row, but we</span>
<a name="l864"><span class="linenum"> 864</span></a>  <span class="comment">            // must still use an aggregate function.</span>
<a name="l865"><span class="linenum"> 865</span></a>              <a class="var it1047" onMouseOver="hilite(1047)" onMouseOut="lolite()" onClick="logVariable('select')" href="../../_variables/select.html">$select</a> = '<a class="phpfunction" onClick="logFunction('MAX')" href="../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">MAX</a>(quiza.sumgrades)';
<a name="l866"><span class="linenum"> 866</span></a>              <a class="var it11538" onMouseOver="hilite(11538)" onMouseOut="lolite()" onClick="logVariable('join')" href="../../_variables/join.html">$join</a> = <a class="var it41435" onMouseOver="hilite(41435)" onMouseOut="lolite()" onClick="logVariable('firstlastattemptjoin')" href="../../_variables/firstlastattemptjoin.html">$firstlastattemptjoin</a>;
<a name="l867"><span class="linenum"> 867</span></a>              <a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a> = 'quiza.attempt = first_last_attempts.lastattempt AND';
<a name="l868"><span class="linenum"> 868</span></a>              break;
<a name="l869"><span class="linenum"> 869</span></a>  
<a name="l870"><span class="linenum"> 870</span></a>          case <a class="constant" onClick="logConstant('QUIZ_GRADEAVERAGE')" href="../../_constants/QUIZ_GRADEAVERAGE.html" onMouseOver="constPopup(event,'QUIZ_GRADEAVERAGE')">QUIZ_GRADEAVERAGE</a>:
<a name="l871"><span class="linenum"> 871</span></a>              <a class="var it1047" onMouseOver="hilite(1047)" onMouseOut="lolite()" onClick="logVariable('select')" href="../../_variables/select.html">$select</a> = '<a class="function" onClick="logFunction('AVG')" href="../../_functions/avg.html" onMouseOver="funcPopup(event,'avg')">AVG</a>(quiza.sumgrades)';
<a name="l872"><span class="linenum"> 872</span></a>              <a class="var it11538" onMouseOver="hilite(11538)" onMouseOut="lolite()" onClick="logVariable('join')" href="../../_variables/join.html">$join</a> = '';
<a name="l873"><span class="linenum"> 873</span></a>              <a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a> = '';
<a name="l874"><span class="linenum"> 874</span></a>              break;
<a name="l875"><span class="linenum"> 875</span></a>  
<a name="l876"><span class="linenum"> 876</span></a>          default:
<a name="l877"><span class="linenum"> 877</span></a>          case <a class="constant" onClick="logConstant('QUIZ_GRADEHIGHEST')" href="../../_constants/QUIZ_GRADEHIGHEST.html" onMouseOver="constPopup(event,'QUIZ_GRADEHIGHEST')">QUIZ_GRADEHIGHEST</a>:
<a name="l878"><span class="linenum"> 878</span></a>              <a class="var it1047" onMouseOver="hilite(1047)" onMouseOut="lolite()" onClick="logVariable('select')" href="../../_variables/select.html">$select</a> = '<a class="phpfunction" onClick="logFunction('MAX')" href="../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">MAX</a>(quiza.sumgrades)';
<a name="l879"><span class="linenum"> 879</span></a>              <a class="var it11538" onMouseOver="hilite(11538)" onMouseOut="lolite()" onClick="logVariable('join')" href="../../_variables/join.html">$join</a> = '';
<a name="l880"><span class="linenum"> 880</span></a>              <a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a> = '';
<a name="l881"><span class="linenum"> 881</span></a>              break;
<a name="l882"><span class="linenum"> 882</span></a>      }
<a name="l883"><span class="linenum"> 883</span></a>  
<a name="l884"><span class="linenum"> 884</span></a>      if (<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('sumgrades')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/sumgrades.html">sumgrades</a> &gt;= 0.000005) {
<a name="l885"><span class="linenum"> 885</span></a>          <a class="var it3414" onMouseOver="hilite(3414)" onMouseOut="lolite()" onClick="logVariable('finalgrade')" href="../../_variables/finalgrade.html">$finalgrade</a> = <a class="var it1047" onMouseOver="hilite(1047)" onMouseOut="lolite()" onClick="logVariable('select')" href="../../_variables/select.html">$select</a> . ' * ' . (<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('grade')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> / <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('sumgrades')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/sumgrades.html">sumgrades</a>);
<a name="l886"><span class="linenum"> 886</span></a>      } else {
<a name="l887"><span class="linenum"> 887</span></a>          <a class="var it3414" onMouseOver="hilite(3414)" onMouseOut="lolite()" onClick="logVariable('finalgrade')" href="../../_variables/finalgrade.html">$finalgrade</a> = '0';
<a name="l888"><span class="linenum"> 888</span></a>      }
<a name="l889"><span class="linenum"> 889</span></a>      <a class="var it334" onMouseOver="hilite(334)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../_variables/param.html">$param</a>['quizid'] = <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l890"><span class="linenum"> 890</span></a>      <a class="var it334" onMouseOver="hilite(334)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../_variables/param.html">$param</a>['quizid2'] = <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l891"><span class="linenum"> 891</span></a>      <a class="var it334" onMouseOver="hilite(334)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../_variables/param.html">$param</a>['quizid3'] = <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l892"><span class="linenum"> 892</span></a>      <a class="var it334" onMouseOver="hilite(334)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../_variables/param.html">$param</a>['quizid4'] = <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l893"><span class="linenum"> 893</span></a>      <a class="var it334" onMouseOver="hilite(334)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../_variables/param.html">$param</a>['statefinished'] = <a class="class" onClick="logClass('quiz_attempt')" href="../../_classes/quiz_attempt.html" onMouseOver="classPopup(event,'quiz_attempt')">quiz_attempt</a>::FINISHED;
<a name="l894"><span class="linenum"> 894</span></a>      <a class="var it334" onMouseOver="hilite(334)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../_variables/param.html">$param</a>['statefinished2'] = <a class="class" onClick="logClass('quiz_attempt')" href="../../_classes/quiz_attempt.html" onMouseOver="classPopup(event,'quiz_attempt')">quiz_attempt</a>::FINISHED;
<a name="l895"><span class="linenum"> 895</span></a>      <a class="var it41436" onMouseOver="hilite(41436)" onMouseOut="lolite()" onClick="logVariable('finalgradesubquery')" href="../../_variables/finalgradesubquery.html">$finalgradesubquery</a> = &quot;
<a name="l896"><span class="linenum"> 896</span></a>              SELECT quiza.userid, <a class="var it3414" onMouseOver="hilite(3414)" onMouseOut="lolite()" onClick="logVariable('finalgrade')" href="../../_variables/finalgrade.html">$finalgrade</a> AS newgrade
<a name="l897"><span class="linenum"> 897</span></a>              FROM {quiz_attempts} quiza
<a name="l898"><span class="linenum"> 898</span></a>              <a class="var it11538" onMouseOver="hilite(11538)" onMouseOut="lolite()" onClick="logVariable('join')" href="../../_variables/join.html">$join</a>
<a name="l899"><span class="linenum"> 899</span></a>              WHERE
<a name="l900"><span class="linenum"> 900</span></a>                  <a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a>
<a name="l901"><span class="linenum"> 901</span></a>                  quiza.state = :statefinished AND
<a name="l902"><span class="linenum"> 902</span></a>                  quiza.preview = 0 AND
<a name="l903"><span class="linenum"> 903</span></a>                  quiza.quiz = :quizid3
<a name="l904"><span class="linenum"> 904</span></a>              GROUP BY quiza.userid&quot;;
<a name="l905"><span class="linenum"> 905</span></a>  
<a name="l906"><span class="linenum"> 906</span></a>      <a class="var it3994" onMouseOver="hilite(3994)" onMouseOut="lolite()" onClick="logVariable('changedgrades')" href="../../_variables/changedgrades.html">$changedgrades</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(&quot;
<a name="l907"><span class="linenum"> 907</span></a>              SELECT users.userid, qg.id, qg.grade, newgrades.newgrade
<a name="l908"><span class="linenum"> 908</span></a>  
<a name="l909"><span class="linenum"> 909</span></a>              FROM (
<a name="l910"><span class="linenum"> 910</span></a>                  SELECT userid
<a name="l911"><span class="linenum"> 911</span></a>                  FROM {quiz_grades} qg
<a name="l912"><span class="linenum"> 912</span></a>                  WHERE quiz = :quizid
<a name="l913"><span class="linenum"> 913</span></a>              UNION
<a name="l914"><span class="linenum"> 914</span></a>                  SELECT DISTINCT userid
<a name="l915"><span class="linenum"> 915</span></a>                  FROM {quiz_attempts} quiza2
<a name="l916"><span class="linenum"> 916</span></a>                  WHERE
<a name="l917"><span class="linenum"> 917</span></a>                      quiza2.state = :statefinished2 AND
<a name="l918"><span class="linenum"> 918</span></a>                      quiza2.preview = 0 AND
<a name="l919"><span class="linenum"> 919</span></a>                      quiza2.quiz = :quizid2
<a name="l920"><span class="linenum"> 920</span></a>              ) users
<a name="l921"><span class="linenum"> 921</span></a>  
<a name="l922"><span class="linenum"> 922</span></a>              LEFT JOIN {quiz_grades} qg ON qg.userid = users.userid AND qg.quiz = :quizid4
<a name="l923"><span class="linenum"> 923</span></a>  
<a name="l924"><span class="linenum"> 924</span></a>              LEFT <a class="function" onClick="logFunction('JOIN')" href="../../_functions/join.html" onMouseOver="funcPopup(event,'join')">JOIN</a> (
<a name="l925"><span class="linenum"> 925</span></a>                  <a class="var it41436" onMouseOver="hilite(41436)" onMouseOut="lolite()" onClick="logVariable('finalgradesubquery')" href="../../_variables/finalgradesubquery.html">$finalgradesubquery</a>
<a name="l926"><span class="linenum"> 926</span></a>              ) newgrades ON newgrades.userid = users.userid
<a name="l927"><span class="linenum"> 927</span></a>  
<a name="l928"><span class="linenum"> 928</span></a>              WHERE
<a name="l929"><span class="linenum"> 929</span></a>                  <a class="phpfunction" onClick="logFunction('ABS')" href="../../_functions/abs.html" onMouseOver="phpfuncPopup(event,'abs')">ABS</a>(newgrades.newgrade - qg.grade) &gt; 0.000005 OR
<a name="l930"><span class="linenum"> 930</span></a>                  ((newgrades.newgrade IS NULL OR qg.grade IS NULL) AND NOT
<a name="l931"><span class="linenum"> 931</span></a>                            (newgrades.newgrade IS NULL AND qg.grade IS NULL))&quot;,
<a name="l932"><span class="linenum"> 932</span></a>  <span class="comment">                // The mess on the previous line is detecting where the value is</span>
<a name="l933"><span class="linenum"> 933</span></a>  <span class="comment">                // NULL in one column, and NOT NULL in the other, but SQL does</span>
<a name="l934"><span class="linenum"> 934</span></a>  <span class="comment">                // not have an XOR operator, and MS SQL server can't cope with</span>
<a name="l935"><span class="linenum"> 935</span></a>  <span class="comment">                // (newgrades.newgrade IS NULL) &lt;&gt; (qg.grade IS NULL).</span>
<a name="l936"><span class="linenum"> 936</span></a>              <a class="var it334" onMouseOver="hilite(334)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../_variables/param.html">$param</a>);
<a name="l937"><span class="linenum"> 937</span></a>  
<a name="l938"><span class="linenum"> 938</span></a>      <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l939"><span class="linenum"> 939</span></a>      <a class="var it9224" onMouseOver="hilite(9224)" onMouseOut="lolite()" onClick="logVariable('todelete')" href="../../_variables/todelete.html">$todelete</a> = array();
<a name="l940"><span class="linenum"> 940</span></a>      foreach (<a class="var it3994" onMouseOver="hilite(3994)" onMouseOut="lolite()" onClick="logVariable('changedgrades')" href="../../_variables/changedgrades.html">$changedgrades</a> as <a class="var it41437" onMouseOver="hilite(41437)" onMouseOut="lolite()" onClick="logVariable('changedgrade')" href="../../_variables/changedgrade.html">$changedgrade</a>) {
<a name="l941"><span class="linenum"> 941</span></a>  
<a name="l942"><span class="linenum"> 942</span></a>          if (<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it41437" onMouseOver="hilite(41437)" onMouseOut="lolite()" onClick="logVariable('changedgrade')" href="../../_variables/changedgrade.html">$changedgrade</a>-&gt;<a onClick="logVariable('newgrade')" class="var it45191" onMouseOver="hilite(45191)" onMouseOut="lolite()" href="../../_variables/newgrade.html">newgrade</a>)) {
<a name="l943"><span class="linenum"> 943</span></a>              <a class="var it9224" onMouseOver="hilite(9224)" onMouseOut="lolite()" onClick="logVariable('todelete')" href="../../_variables/todelete.html">$todelete</a>[] = <a class="var it41437" onMouseOver="hilite(41437)" onMouseOut="lolite()" onClick="logVariable('changedgrade')" href="../../_variables/changedgrade.html">$changedgrade</a>-&gt;<a onClick="logVariable('userid')" class="var it45191" onMouseOver="hilite(45191)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>;
<a name="l944"><span class="linenum"> 944</span></a>  
<a name="l945"><span class="linenum"> 945</span></a>          } else if (<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it41437" onMouseOver="hilite(41437)" onMouseOut="lolite()" onClick="logVariable('changedgrade')" href="../../_variables/changedgrade.html">$changedgrade</a>-&gt;<a onClick="logVariable('grade')" class="var it45191" onMouseOver="hilite(45191)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a>)) {
<a name="l946"><span class="linenum"> 946</span></a>              <a class="var it7571" onMouseOver="hilite(7571)" onMouseOut="lolite()" onClick="logVariable('toinsert')" href="../../_variables/toinsert.html">$toinsert</a> = new stdClass();
<a name="l947"><span class="linenum"> 947</span></a>              <a class="var it7571" onMouseOver="hilite(7571)" onMouseOut="lolite()" onClick="logVariable('toinsert')" href="../../_variables/toinsert.html">$toinsert</a>-&gt;<a onClick="logVariable('quiz')" class="var it44740" onMouseOver="hilite(44740)" onMouseOut="lolite()" href="../../_variables/quiz.html">quiz</a> = <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l948"><span class="linenum"> 948</span></a>              <a class="var it7571" onMouseOver="hilite(7571)" onMouseOut="lolite()" onClick="logVariable('toinsert')" href="../../_variables/toinsert.html">$toinsert</a>-&gt;<a onClick="logVariable('userid')" class="var it44740" onMouseOver="hilite(44740)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> = <a class="var it41437" onMouseOver="hilite(41437)" onMouseOut="lolite()" onClick="logVariable('changedgrade')" href="../../_variables/changedgrade.html">$changedgrade</a>-&gt;<a onClick="logVariable('userid')" class="var it45191" onMouseOver="hilite(45191)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>;
<a name="l949"><span class="linenum"> 949</span></a>              <a class="var it7571" onMouseOver="hilite(7571)" onMouseOut="lolite()" onClick="logVariable('toinsert')" href="../../_variables/toinsert.html">$toinsert</a>-&gt;<a onClick="logVariable('timemodified')" class="var it44740" onMouseOver="hilite(44740)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a>;
<a name="l950"><span class="linenum"> 950</span></a>              <a class="var it7571" onMouseOver="hilite(7571)" onMouseOut="lolite()" onClick="logVariable('toinsert')" href="../../_variables/toinsert.html">$toinsert</a>-&gt;<a onClick="logVariable('grade')" class="var it44740" onMouseOver="hilite(44740)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> = <a class="var it41437" onMouseOver="hilite(41437)" onMouseOut="lolite()" onClick="logVariable('changedgrade')" href="../../_variables/changedgrade.html">$changedgrade</a>-&gt;<a onClick="logVariable('newgrade')" class="var it45191" onMouseOver="hilite(45191)" onMouseOut="lolite()" href="../../_variables/newgrade.html">newgrade</a>;
<a name="l951"><span class="linenum"> 951</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('quiz_grades', <a class="var it7571" onMouseOver="hilite(7571)" onMouseOut="lolite()" onClick="logVariable('toinsert')" href="../../_variables/toinsert.html">$toinsert</a>);
<a name="l952"><span class="linenum"> 952</span></a>  
<a name="l953"><span class="linenum"> 953</span></a>          } else {
<a name="l954"><span class="linenum"> 954</span></a>              <a class="var it9944" onMouseOver="hilite(9944)" onMouseOut="lolite()" onClick="logVariable('toupdate')" href="../../_variables/toupdate.html">$toupdate</a> = new stdClass();
<a name="l955"><span class="linenum"> 955</span></a>              <a class="var it9944" onMouseOver="hilite(9944)" onMouseOut="lolite()" onClick="logVariable('toupdate')" href="../../_variables/toupdate.html">$toupdate</a>-&gt;<a onClick="logVariable('id')" class="var it44212" onMouseOver="hilite(44212)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it41437" onMouseOver="hilite(41437)" onMouseOut="lolite()" onClick="logVariable('changedgrade')" href="../../_variables/changedgrade.html">$changedgrade</a>-&gt;<a onClick="logVariable('id')" class="var it45191" onMouseOver="hilite(45191)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l956"><span class="linenum"> 956</span></a>              <a class="var it9944" onMouseOver="hilite(9944)" onMouseOut="lolite()" onClick="logVariable('toupdate')" href="../../_variables/toupdate.html">$toupdate</a>-&gt;<a onClick="logVariable('grade')" class="var it44212" onMouseOver="hilite(44212)" onMouseOut="lolite()" href="../../_variables/grade.html">grade</a> = <a class="var it41437" onMouseOver="hilite(41437)" onMouseOut="lolite()" onClick="logVariable('changedgrade')" href="../../_variables/changedgrade.html">$changedgrade</a>-&gt;<a onClick="logVariable('newgrade')" class="var it45191" onMouseOver="hilite(45191)" onMouseOut="lolite()" href="../../_variables/newgrade.html">newgrade</a>;
<a name="l957"><span class="linenum"> 957</span></a>              <a class="var it9944" onMouseOver="hilite(9944)" onMouseOut="lolite()" onClick="logVariable('toupdate')" href="../../_variables/toupdate.html">$toupdate</a>-&gt;<a onClick="logVariable('timemodified')" class="var it44212" onMouseOver="hilite(44212)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a>;
<a name="l958"><span class="linenum"> 958</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('quiz_grades', <a class="var it9944" onMouseOver="hilite(9944)" onMouseOut="lolite()" onClick="logVariable('toupdate')" href="../../_variables/toupdate.html">$toupdate</a>);
<a name="l959"><span class="linenum"> 959</span></a>          }
<a name="l960"><span class="linenum"> 960</span></a>      }
<a name="l961"><span class="linenum"> 961</span></a>  
<a name="l962"><span class="linenum"> 962</span></a>      if (!empty(<a class="var it9224" onMouseOver="hilite(9224)" onMouseOut="lolite()" onClick="logVariable('todelete')" href="../../_variables/todelete.html">$todelete</a>)) {
<a name="l963"><span class="linenum"> 963</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it3797" onMouseOver="hilite(3797)" onMouseOut="lolite()" onClick="logVariable('test')" href="../../_variables/test.html">$test</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it9224" onMouseOver="hilite(9224)" onMouseOut="lolite()" onClick="logVariable('todelete')" href="../../_variables/todelete.html">$todelete</a>);
<a name="l964"><span class="linenum"> 964</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records_select')" href="../../_functions/delete_records_select.html" onMouseOver="funcPopup(event,'delete_records_select')">delete_records_select</a>('quiz_grades', 'quiz = ? AND userid ' . <a class="var it3797" onMouseOver="hilite(3797)" onMouseOut="lolite()" onClick="logVariable('test')" href="../../_variables/test.html">$test</a>,
<a name="l965"><span class="linenum"> 965</span></a>                  <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(array(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>), <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>));
<a name="l966"><span class="linenum"> 966</span></a>      }
<a name="l967"><span class="linenum"> 967</span></a>  }
<a name="l968"><span class="linenum"> 968</span></a>  
<a name="l969"><span class="linenum"> 969</span></a>  <span class="comment">/**</span>
<a name="l970"><span class="linenum"> 970</span></a>  <span class="comment"> * Efficiently update check state time on all open attempts</span>
<a name="l971"><span class="linenum"> 971</span></a>  <span class="comment"> *</span>
<a name="l972"><span class="linenum"> 972</span></a>  <span class="comment"> * @param array $conditions optional restrictions on which attempts to update</span>
<a name="l973"><span class="linenum"> 973</span></a>  <span class="comment"> *                    Allowed conditions:</span>
<a name="l974"><span class="linenum"> 974</span></a>  <span class="comment"> *                      courseid =&gt; (array|int) attempts in given course(s)</span>
<a name="l975"><span class="linenum"> 975</span></a>  <span class="comment"> *                      userid   =&gt; (array|int) attempts for given user(s)</span>
<a name="l976"><span class="linenum"> 976</span></a>  <span class="comment"> *                      quizid   =&gt; (array|int) attempts in given quiz(s)</span>
<a name="l977"><span class="linenum"> 977</span></a>  <span class="comment"> *                      groupid  =&gt; (array|int) quizzes with some override for given group(s)</span>
<a name="l978"><span class="linenum"> 978</span></a>  <span class="comment"> *</span>
<a name="l979"><span class="linenum"> 979</span></a>  <span class="comment"> */</span>
<a name="l980"><span class="linenum"> 980</span></a>  function <a class="function" onClick="logFunction('quiz_update_open_attempts')" href="../../_functions/quiz_update_open_attempts.html" onMouseOver="funcPopup(event,'quiz_update_open_attempts')">quiz_update_open_attempts</a>(array <a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>) {
<a name="l981"><span class="linenum"> 981</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l982"><span class="linenum"> 982</span></a>  
<a name="l983"><span class="linenum"> 983</span></a>      foreach (<a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a> as &amp;<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l984"><span class="linenum"> 984</span></a>          if (!<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>)) {
<a name="l985"><span class="linenum"> 985</span></a>              <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = array(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>);
<a name="l986"><span class="linenum"> 986</span></a>          }
<a name="l987"><span class="linenum"> 987</span></a>      }
<a name="l988"><span class="linenum"> 988</span></a>  
<a name="l989"><span class="linenum"> 989</span></a>      <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array();
<a name="l990"><span class="linenum"> 990</span></a>      <a class="var it8680" onMouseOver="hilite(8680)" onMouseOut="lolite()" onClick="logVariable('wheres')" href="../../_variables/wheres.html">$wheres</a> = array(&quot;quiza.state IN ('inprogress', 'overdue')&quot;);
<a name="l991"><span class="linenum"> 991</span></a>      <a class="var it41438" onMouseOver="hilite(41438)" onMouseOut="lolite()" onClick="logVariable('iwheres')" href="../../_variables/iwheres.html">$iwheres</a> = array(&quot;iquiza.state IN ('inprogress', 'overdue')&quot;);
<a name="l992"><span class="linenum"> 992</span></a>  
<a name="l993"><span class="linenum"> 993</span></a>      if (isset(<a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>['courseid'])) {
<a name="l994"><span class="linenum"> 994</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a> (<a class="var it41439" onMouseOver="hilite(41439)" onMouseOut="lolite()" onClick="logVariable('incond')" href="../../_variables/incond.html">$incond</a>, <a class="var it4859" onMouseOver="hilite(4859)" onMouseOut="lolite()" onClick="logVariable('inparams')" href="../../_variables/inparams.html">$inparams</a>) = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>['courseid'], <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'cid');
<a name="l995"><span class="linenum"> 995</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it4859" onMouseOver="hilite(4859)" onMouseOut="lolite()" onClick="logVariable('inparams')" href="../../_variables/inparams.html">$inparams</a>);
<a name="l996"><span class="linenum"> 996</span></a>          <a class="var it8680" onMouseOver="hilite(8680)" onMouseOut="lolite()" onClick="logVariable('wheres')" href="../../_variables/wheres.html">$wheres</a>[] = &quot;quiza.quiz IN (SELECT q.id FROM {quiz} q WHERE q.course <a class="var it41439" onMouseOver="hilite(41439)" onMouseOut="lolite()" onClick="logVariable('incond')" href="../../_variables/incond.html">$incond</a>)&quot;;
<a name="l997"><span class="linenum"> 997</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a> (<a class="var it41439" onMouseOver="hilite(41439)" onMouseOut="lolite()" onClick="logVariable('incond')" href="../../_variables/incond.html">$incond</a>, <a class="var it4859" onMouseOver="hilite(4859)" onMouseOut="lolite()" onClick="logVariable('inparams')" href="../../_variables/inparams.html">$inparams</a>) = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>['courseid'], <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'icid');
<a name="l998"><span class="linenum"> 998</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it4859" onMouseOver="hilite(4859)" onMouseOut="lolite()" onClick="logVariable('inparams')" href="../../_variables/inparams.html">$inparams</a>);
<a name="l999"><span class="linenum"> 999</span></a>          <a class="var it41438" onMouseOver="hilite(41438)" onMouseOut="lolite()" onClick="logVariable('iwheres')" href="../../_variables/iwheres.html">$iwheres</a>[] = &quot;iquiza.quiz IN (SELECT q.id FROM {quiz} q WHERE q.course <a class="var it41439" onMouseOver="hilite(41439)" onMouseOut="lolite()" onClick="logVariable('incond')" href="../../_variables/incond.html">$incond</a>)&quot;;
<a name="l1000"><span class="linenum">1000</span></a>      }
<a name="l1001"><span class="linenum">1001</span></a>  
<a name="l1002"><span class="linenum">1002</span></a>      if (isset(<a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>['userid'])) {
<a name="l1003"><span class="linenum">1003</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a> (<a class="var it41439" onMouseOver="hilite(41439)" onMouseOut="lolite()" onClick="logVariable('incond')" href="../../_variables/incond.html">$incond</a>, <a class="var it4859" onMouseOver="hilite(4859)" onMouseOut="lolite()" onClick="logVariable('inparams')" href="../../_variables/inparams.html">$inparams</a>) = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>['userid'], <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'uid');
<a name="l1004"><span class="linenum">1004</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it4859" onMouseOver="hilite(4859)" onMouseOut="lolite()" onClick="logVariable('inparams')" href="../../_variables/inparams.html">$inparams</a>);
<a name="l1005"><span class="linenum">1005</span></a>          <a class="var it8680" onMouseOver="hilite(8680)" onMouseOut="lolite()" onClick="logVariable('wheres')" href="../../_variables/wheres.html">$wheres</a>[] = &quot;quiza.userid <a class="var it41439" onMouseOver="hilite(41439)" onMouseOut="lolite()" onClick="logVariable('incond')" href="../../_variables/incond.html">$incond</a>&quot;;
<a name="l1006"><span class="linenum">1006</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a> (<a class="var it41439" onMouseOver="hilite(41439)" onMouseOut="lolite()" onClick="logVariable('incond')" href="../../_variables/incond.html">$incond</a>, <a class="var it4859" onMouseOver="hilite(4859)" onMouseOut="lolite()" onClick="logVariable('inparams')" href="../../_variables/inparams.html">$inparams</a>) = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>['userid'], <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'iuid');
<a name="l1007"><span class="linenum">1007</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it4859" onMouseOver="hilite(4859)" onMouseOut="lolite()" onClick="logVariable('inparams')" href="../../_variables/inparams.html">$inparams</a>);
<a name="l1008"><span class="linenum">1008</span></a>          <a class="var it41438" onMouseOver="hilite(41438)" onMouseOut="lolite()" onClick="logVariable('iwheres')" href="../../_variables/iwheres.html">$iwheres</a>[] = &quot;iquiza.userid <a class="var it41439" onMouseOver="hilite(41439)" onMouseOut="lolite()" onClick="logVariable('incond')" href="../../_variables/incond.html">$incond</a>&quot;;
<a name="l1009"><span class="linenum">1009</span></a>      }
<a name="l1010"><span class="linenum">1010</span></a>  
<a name="l1011"><span class="linenum">1011</span></a>      if (isset(<a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>['quizid'])) {
<a name="l1012"><span class="linenum">1012</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a> (<a class="var it41439" onMouseOver="hilite(41439)" onMouseOut="lolite()" onClick="logVariable('incond')" href="../../_variables/incond.html">$incond</a>, <a class="var it4859" onMouseOver="hilite(4859)" onMouseOut="lolite()" onClick="logVariable('inparams')" href="../../_variables/inparams.html">$inparams</a>) = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>['quizid'], <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'qid');
<a name="l1013"><span class="linenum">1013</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it4859" onMouseOver="hilite(4859)" onMouseOut="lolite()" onClick="logVariable('inparams')" href="../../_variables/inparams.html">$inparams</a>);
<a name="l1014"><span class="linenum">1014</span></a>          <a class="var it8680" onMouseOver="hilite(8680)" onMouseOut="lolite()" onClick="logVariable('wheres')" href="../../_variables/wheres.html">$wheres</a>[] = &quot;quiza.quiz <a class="var it41439" onMouseOver="hilite(41439)" onMouseOut="lolite()" onClick="logVariable('incond')" href="../../_variables/incond.html">$incond</a>&quot;;
<a name="l1015"><span class="linenum">1015</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a> (<a class="var it41439" onMouseOver="hilite(41439)" onMouseOut="lolite()" onClick="logVariable('incond')" href="../../_variables/incond.html">$incond</a>, <a class="var it4859" onMouseOver="hilite(4859)" onMouseOut="lolite()" onClick="logVariable('inparams')" href="../../_variables/inparams.html">$inparams</a>) = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>['quizid'], <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'iqid');
<a name="l1016"><span class="linenum">1016</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it4859" onMouseOver="hilite(4859)" onMouseOut="lolite()" onClick="logVariable('inparams')" href="../../_variables/inparams.html">$inparams</a>);
<a name="l1017"><span class="linenum">1017</span></a>          <a class="var it41438" onMouseOver="hilite(41438)" onMouseOut="lolite()" onClick="logVariable('iwheres')" href="../../_variables/iwheres.html">$iwheres</a>[] = &quot;iquiza.quiz <a class="var it41439" onMouseOver="hilite(41439)" onMouseOut="lolite()" onClick="logVariable('incond')" href="../../_variables/incond.html">$incond</a>&quot;;
<a name="l1018"><span class="linenum">1018</span></a>      }
<a name="l1019"><span class="linenum">1019</span></a>  
<a name="l1020"><span class="linenum">1020</span></a>      if (isset(<a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>['groupid'])) {
<a name="l1021"><span class="linenum">1021</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a> (<a class="var it41439" onMouseOver="hilite(41439)" onMouseOut="lolite()" onClick="logVariable('incond')" href="../../_variables/incond.html">$incond</a>, <a class="var it4859" onMouseOver="hilite(4859)" onMouseOut="lolite()" onClick="logVariable('inparams')" href="../../_variables/inparams.html">$inparams</a>) = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>['groupid'], <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'gid');
<a name="l1022"><span class="linenum">1022</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it4859" onMouseOver="hilite(4859)" onMouseOut="lolite()" onClick="logVariable('inparams')" href="../../_variables/inparams.html">$inparams</a>);
<a name="l1023"><span class="linenum">1023</span></a>          <a class="var it8680" onMouseOver="hilite(8680)" onMouseOut="lolite()" onClick="logVariable('wheres')" href="../../_variables/wheres.html">$wheres</a>[] = &quot;quiza.quiz IN (SELECT qo.quiz FROM {quiz_overrides} qo WHERE qo.groupid <a class="var it41439" onMouseOver="hilite(41439)" onMouseOut="lolite()" onClick="logVariable('incond')" href="../../_variables/incond.html">$incond</a>)&quot;;
<a name="l1024"><span class="linenum">1024</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a> (<a class="var it41439" onMouseOver="hilite(41439)" onMouseOut="lolite()" onClick="logVariable('incond')" href="../../_variables/incond.html">$incond</a>, <a class="var it4859" onMouseOver="hilite(4859)" onMouseOut="lolite()" onClick="logVariable('inparams')" href="../../_variables/inparams.html">$inparams</a>) = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it1217" onMouseOver="hilite(1217)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../_variables/conditions.html">$conditions</a>['groupid'], <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'igid');
<a name="l1025"><span class="linenum">1025</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it4859" onMouseOver="hilite(4859)" onMouseOut="lolite()" onClick="logVariable('inparams')" href="../../_variables/inparams.html">$inparams</a>);
<a name="l1026"><span class="linenum">1026</span></a>          <a class="var it41438" onMouseOver="hilite(41438)" onMouseOut="lolite()" onClick="logVariable('iwheres')" href="../../_variables/iwheres.html">$iwheres</a>[] = &quot;iquiza.quiz IN (SELECT qo.quiz FROM {quiz_overrides} qo WHERE qo.groupid <a class="var it41439" onMouseOver="hilite(41439)" onMouseOut="lolite()" onClick="logVariable('incond')" href="../../_variables/incond.html">$incond</a>)&quot;;
<a name="l1027"><span class="linenum">1027</span></a>      }
<a name="l1028"><span class="linenum">1028</span></a>  
<a name="l1029"><span class="linenum">1029</span></a>  <span class="comment">    // SQL to compute timeclose and timelimit for each attempt:</span>
<a name="l1030"><span class="linenum">1030</span></a>      <a class="var it10198" onMouseOver="hilite(10198)" onMouseOut="lolite()" onClick="logVariable('quizausersql')" href="../../_variables/quizausersql.html">$quizausersql</a> = <a class="function" onClick="logFunction('quiz_get_attempt_usertime_sql')" href="../../_functions/quiz_get_attempt_usertime_sql.html" onMouseOver="funcPopup(event,'quiz_get_attempt_usertime_sql')">quiz_get_attempt_usertime_sql</a>(
<a name="l1031"><span class="linenum">1031</span></a>              <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(&quot;\n                AND &quot;, <a class="var it41438" onMouseOver="hilite(41438)" onMouseOut="lolite()" onClick="logVariable('iwheres')" href="../../_variables/iwheres.html">$iwheres</a>));
<a name="l1032"><span class="linenum">1032</span></a>  
<a name="l1033"><span class="linenum">1033</span></a>  <span class="comment">    // SQL to compute the new timecheckstate</span>
<a name="l1034"><span class="linenum">1034</span></a>      <a class="var it41440" onMouseOver="hilite(41440)" onMouseOut="lolite()" onClick="logVariable('timecheckstatesql')" href="../../_variables/timecheckstatesql.html">$timecheckstatesql</a> = &quot;
<a name="l1035"><span class="linenum">1035</span></a>            CASE WHEN quizauser.usertimelimit = 0 AND quizauser.usertimeclose = 0 THEN NULL
<a name="l1036"><span class="linenum">1036</span></a>                 WHEN quizauser.usertimelimit = 0 THEN quizauser.usertimeclose
<a name="l1037"><span class="linenum">1037</span></a>                 WHEN quizauser.usertimeclose = 0 THEN quiza.timestart + quizauser.usertimelimit
<a name="l1038"><span class="linenum">1038</span></a>                 WHEN quiza.timestart + quizauser.usertimelimit &lt; quizauser.usertimeclose THEN quiza.timestart + quizauser.usertimelimit
<a name="l1039"><span class="linenum">1039</span></a>                 ELSE quizauser.usertimeclose END +
<a name="l1040"><span class="linenum">1040</span></a>            CASE WHEN quiza.state = 'overdue' THEN quiz.graceperiod ELSE 0 END&quot;;
<a name="l1041"><span class="linenum">1041</span></a>  
<a name="l1042"><span class="linenum">1042</span></a>  <span class="comment">    // SQL to select which attempts to process</span>
<a name="l1043"><span class="linenum">1043</span></a>      <a class="var it41441" onMouseOver="hilite(41441)" onMouseOut="lolite()" onClick="logVariable('attemptselect')" href="../../_variables/attemptselect.html">$attemptselect</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(&quot;\n                         AND &quot;, <a class="var it8680" onMouseOver="hilite(8680)" onMouseOut="lolite()" onClick="logVariable('wheres')" href="../../_variables/wheres.html">$wheres</a>);
<a name="l1044"><span class="linenum">1044</span></a>  
<a name="l1045"><span class="linenum">1045</span></a>     <span class="comment">/*</span>
<a name="l1046"><span class="linenum">1046</span></a>  <span class="comment">    * Each database handles updates with inner joins differently:</span>
<a name="l1047"><span class="linenum">1047</span></a>  <span class="comment">    *  - mysql does not allow a FROM clause</span>
<a name="l1048"><span class="linenum">1048</span></a>  <span class="comment">    *  - postgres and mssql allow FROM but handle table aliases differently</span>
<a name="l1049"><span class="linenum">1049</span></a>  <span class="comment">    *  - oracle requires a subquery</span>
<a name="l1050"><span class="linenum">1050</span></a>  <span class="comment">    *</span>
<a name="l1051"><span class="linenum">1051</span></a>  <span class="comment">    * Different code for each database.</span>
<a name="l1052"><span class="linenum">1052</span></a>  <span class="comment">    */</span>
<a name="l1053"><span class="linenum">1053</span></a>  
<a name="l1054"><span class="linenum">1054</span></a>      <a class="var it4369" onMouseOver="hilite(4369)" onMouseOut="lolite()" onClick="logVariable('dbfamily')" href="../../_variables/dbfamily.html">$dbfamily</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_dbfamily')" href="../../_functions/get_dbfamily.html" onMouseOver="funcPopup(event,'get_dbfamily')">get_dbfamily</a>();
<a name="l1055"><span class="linenum">1055</span></a>      if (<a class="var it4369" onMouseOver="hilite(4369)" onMouseOut="lolite()" onClick="logVariable('dbfamily')" href="../../_variables/dbfamily.html">$dbfamily</a> == 'mysql') {
<a name="l1056"><span class="linenum">1056</span></a>          <a class="var it13898" onMouseOver="hilite(13898)" onMouseOut="lolite()" onClick="logVariable('updatesql')" href="../../_variables/updatesql.html">$updatesql</a> = &quot;UPDATE {quiz_attempts} quiza
<a name="l1057"><span class="linenum">1057</span></a>                          JOIN {quiz} quiz ON quiz.id = quiza.quiz
<a name="l1058"><span class="linenum">1058</span></a>                          <a class="function" onClick="logFunction('JOIN')" href="../../_functions/join.html" onMouseOver="funcPopup(event,'join')">JOIN</a> ( <a class="var it10198" onMouseOver="hilite(10198)" onMouseOut="lolite()" onClick="logVariable('quizausersql')" href="../../_variables/quizausersql.html">$quizausersql</a> ) quizauser ON quizauser.id = quiza.id
<a name="l1059"><span class="linenum">1059</span></a>                           SET quiza.timecheckstate = <a class="var it41440" onMouseOver="hilite(41440)" onMouseOut="lolite()" onClick="logVariable('timecheckstatesql')" href="../../_variables/timecheckstatesql.html">$timecheckstatesql</a>
<a name="l1060"><span class="linenum">1060</span></a>                         WHERE <a class="var it41441" onMouseOver="hilite(41441)" onMouseOut="lolite()" onClick="logVariable('attemptselect')" href="../../_variables/attemptselect.html">$attemptselect</a>&quot;;
<a name="l1061"><span class="linenum">1061</span></a>      } else if (<a class="var it4369" onMouseOver="hilite(4369)" onMouseOut="lolite()" onClick="logVariable('dbfamily')" href="../../_variables/dbfamily.html">$dbfamily</a> == 'postgres') {
<a name="l1062"><span class="linenum">1062</span></a>          <a class="var it13898" onMouseOver="hilite(13898)" onMouseOut="lolite()" onClick="logVariable('updatesql')" href="../../_variables/updatesql.html">$updatesql</a> = &quot;UPDATE {quiz_attempts} quiza
<a name="l1063"><span class="linenum">1063</span></a>                           SET timecheckstate = <a class="var it41440" onMouseOver="hilite(41440)" onMouseOut="lolite()" onClick="logVariable('timecheckstatesql')" href="../../_variables/timecheckstatesql.html">$timecheckstatesql</a>
<a name="l1064"><span class="linenum">1064</span></a>                          FROM {quiz} quiz, ( <a class="var it10198" onMouseOver="hilite(10198)" onMouseOut="lolite()" onClick="logVariable('quizausersql')" href="../../_variables/quizausersql.html">$quizausersql</a> ) quizauser
<a name="l1065"><span class="linenum">1065</span></a>                         WHERE quiz.id = quiza.quiz
<a name="l1066"><span class="linenum">1066</span></a>                           AND quizauser.id = quiza.id
<a name="l1067"><span class="linenum">1067</span></a>                           AND <a class="var it41441" onMouseOver="hilite(41441)" onMouseOut="lolite()" onClick="logVariable('attemptselect')" href="../../_variables/attemptselect.html">$attemptselect</a>&quot;;
<a name="l1068"><span class="linenum">1068</span></a>      } else if (<a class="var it4369" onMouseOver="hilite(4369)" onMouseOut="lolite()" onClick="logVariable('dbfamily')" href="../../_variables/dbfamily.html">$dbfamily</a> == 'mssql') {
<a name="l1069"><span class="linenum">1069</span></a>          <a class="var it13898" onMouseOver="hilite(13898)" onMouseOut="lolite()" onClick="logVariable('updatesql')" href="../../_variables/updatesql.html">$updatesql</a> = &quot;UPDATE quiza
<a name="l1070"><span class="linenum">1070</span></a>                           SET timecheckstate = <a class="var it41440" onMouseOver="hilite(41440)" onMouseOut="lolite()" onClick="logVariable('timecheckstatesql')" href="../../_variables/timecheckstatesql.html">$timecheckstatesql</a>
<a name="l1071"><span class="linenum">1071</span></a>                          FROM {quiz_attempts} quiza
<a name="l1072"><span class="linenum">1072</span></a>                          JOIN {quiz} quiz ON quiz.id = quiza.quiz
<a name="l1073"><span class="linenum">1073</span></a>                          <a class="function" onClick="logFunction('JOIN')" href="../../_functions/join.html" onMouseOver="funcPopup(event,'join')">JOIN</a> ( <a class="var it10198" onMouseOver="hilite(10198)" onMouseOut="lolite()" onClick="logVariable('quizausersql')" href="../../_variables/quizausersql.html">$quizausersql</a> ) quizauser ON quizauser.id = quiza.id
<a name="l1074"><span class="linenum">1074</span></a>                         WHERE <a class="var it41441" onMouseOver="hilite(41441)" onMouseOut="lolite()" onClick="logVariable('attemptselect')" href="../../_variables/attemptselect.html">$attemptselect</a>&quot;;
<a name="l1075"><span class="linenum">1075</span></a>      } else {
<a name="l1076"><span class="linenum">1076</span></a>  <span class="comment">        // oracle, sqlite and others</span>
<a name="l1077"><span class="linenum">1077</span></a>          <a class="var it13898" onMouseOver="hilite(13898)" onMouseOut="lolite()" onClick="logVariable('updatesql')" href="../../_variables/updatesql.html">$updatesql</a> = &quot;UPDATE {quiz_attempts} quiza
<a name="l1078"><span class="linenum">1078</span></a>                           SET timecheckstate = (
<a name="l1079"><span class="linenum">1079</span></a>                             SELECT <a class="var it41440" onMouseOver="hilite(41440)" onMouseOut="lolite()" onClick="logVariable('timecheckstatesql')" href="../../_variables/timecheckstatesql.html">$timecheckstatesql</a>
<a name="l1080"><span class="linenum">1080</span></a>                               FROM {quiz} quiz, ( <a class="var it10198" onMouseOver="hilite(10198)" onMouseOut="lolite()" onClick="logVariable('quizausersql')" href="../../_variables/quizausersql.html">$quizausersql</a> ) quizauser
<a name="l1081"><span class="linenum">1081</span></a>                              WHERE quiz.id = quiza.quiz
<a name="l1082"><span class="linenum">1082</span></a>                                AND quizauser.id = quiza.id
<a name="l1083"><span class="linenum">1083</span></a>                           )
<a name="l1084"><span class="linenum">1084</span></a>                           WHERE <a class="var it41441" onMouseOver="hilite(41441)" onMouseOut="lolite()" onClick="logVariable('attemptselect')" href="../../_variables/attemptselect.html">$attemptselect</a>&quot;;
<a name="l1085"><span class="linenum">1085</span></a>      }
<a name="l1086"><span class="linenum">1086</span></a>  
<a name="l1087"><span class="linenum">1087</span></a>      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>(<a class="var it13898" onMouseOver="hilite(13898)" onMouseOut="lolite()" onClick="logVariable('updatesql')" href="../../_variables/updatesql.html">$updatesql</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l1088"><span class="linenum">1088</span></a>  }
<a name="l1089"><span class="linenum">1089</span></a>  
<a name="l1090"><span class="linenum">1090</span></a>  <span class="comment">/**</span>
<a name="l1091"><span class="linenum">1091</span></a>  <span class="comment"> * Returns SQL to compute timeclose and timelimit for every attempt, taking into account user and group overrides.</span>
<a name="l1092"><span class="linenum">1092</span></a>  <span class="comment"> *</span>
<a name="l1093"><span class="linenum">1093</span></a>  <span class="comment"> * @param string $redundantwhereclauses extra where clauses to add to the subquery</span>
<a name="l1094"><span class="linenum">1094</span></a>  <span class="comment"> *      for performance. These can use the table alias iquiza for the quiz attempts table.</span>
<a name="l1095"><span class="linenum">1095</span></a>  <span class="comment"> * @return string SQL select with columns attempt.id, usertimeclose, usertimelimit.</span>
<a name="l1096"><span class="linenum">1096</span></a>  <span class="comment"> */</span>
<a name="l1097"><span class="linenum">1097</span></a>  function <a class="function" onClick="logFunction('quiz_get_attempt_usertime_sql')" href="../../_functions/quiz_get_attempt_usertime_sql.html" onMouseOver="funcPopup(event,'quiz_get_attempt_usertime_sql')">quiz_get_attempt_usertime_sql</a>(<a class="var it41442" onMouseOver="hilite(41442)" onMouseOut="lolite()" onClick="logVariable('redundantwhereclauses')" href="../../_variables/redundantwhereclauses.html">$redundantwhereclauses</a> = '') {
<a name="l1098"><span class="linenum">1098</span></a>      if (<a class="var it41442" onMouseOver="hilite(41442)" onMouseOut="lolite()" onClick="logVariable('redundantwhereclauses')" href="../../_variables/redundantwhereclauses.html">$redundantwhereclauses</a>) {
<a name="l1099"><span class="linenum">1099</span></a>          <a class="var it41442" onMouseOver="hilite(41442)" onMouseOut="lolite()" onClick="logVariable('redundantwhereclauses')" href="../../_variables/redundantwhereclauses.html">$redundantwhereclauses</a> = 'WHERE ' . <a class="var it41442" onMouseOver="hilite(41442)" onMouseOut="lolite()" onClick="logVariable('redundantwhereclauses')" href="../../_variables/redundantwhereclauses.html">$redundantwhereclauses</a>;
<a name="l1100"><span class="linenum">1100</span></a>      }
<a name="l1101"><span class="linenum">1101</span></a>  <span class="comment">    // The multiple qgo JOINS are necessary because we want timeclose/timelimit = 0 (unlimited) to supercede</span>
<a name="l1102"><span class="linenum">1102</span></a>  <span class="comment">    // any other group override</span>
<a name="l1103"><span class="linenum">1103</span></a>      <a class="var it10198" onMouseOver="hilite(10198)" onMouseOut="lolite()" onClick="logVariable('quizausersql')" href="../../_variables/quizausersql.html">$quizausersql</a> = &quot;
<a name="l1104"><span class="linenum">1104</span></a>            SELECT iquiza.id,
<a name="l1105"><span class="linenum">1105</span></a>             COALESCE(<a class="phpfunction" onClick="logFunction('MAX')" href="../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">MAX</a>(quo.timeclose), <a class="phpfunction" onClick="logFunction('MAX')" href="../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">MAX</a>(qgo1.timeclose), <a class="phpfunction" onClick="logFunction('MAX')" href="../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">MAX</a>(qgo2.timeclose), iquiz.timeclose) AS usertimeclose,
<a name="l1106"><span class="linenum">1106</span></a>             COALESCE(<a class="phpfunction" onClick="logFunction('MAX')" href="../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">MAX</a>(quo.timelimit), <a class="phpfunction" onClick="logFunction('MAX')" href="../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">MAX</a>(qgo3.timelimit), <a class="phpfunction" onClick="logFunction('MAX')" href="../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">MAX</a>(qgo4.timelimit), iquiz.timelimit) AS usertimelimit
<a name="l1107"><span class="linenum">1107</span></a>  
<a name="l1108"><span class="linenum">1108</span></a>             FROM {quiz_attempts} iquiza
<a name="l1109"><span class="linenum">1109</span></a>             JOIN {quiz} iquiz ON iquiz.id = iquiza.quiz
<a name="l1110"><span class="linenum">1110</span></a>        LEFT JOIN {quiz_overrides} quo ON quo.quiz = iquiza.quiz AND quo.userid = iquiza.userid
<a name="l1111"><span class="linenum">1111</span></a>        LEFT JOIN {groups_members} gm ON gm.userid = iquiza.userid
<a name="l1112"><span class="linenum">1112</span></a>        LEFT JOIN {quiz_overrides} qgo1 ON qgo1.quiz = iquiza.quiz AND qgo1.groupid = gm.groupid AND qgo1.timeclose = 0
<a name="l1113"><span class="linenum">1113</span></a>        LEFT JOIN {quiz_overrides} qgo2 ON qgo2.quiz = iquiza.quiz AND qgo2.groupid = gm.groupid AND qgo2.timeclose &gt; 0
<a name="l1114"><span class="linenum">1114</span></a>        LEFT JOIN {quiz_overrides} qgo3 ON qgo3.quiz = iquiza.quiz AND qgo3.groupid = gm.groupid AND qgo3.timelimit = 0
<a name="l1115"><span class="linenum">1115</span></a>        LEFT JOIN {quiz_overrides} qgo4 ON qgo4.quiz = iquiza.quiz AND qgo4.groupid = gm.groupid AND qgo4.timelimit &gt; 0
<a name="l1116"><span class="linenum">1116</span></a>            <a class="var it41442" onMouseOver="hilite(41442)" onMouseOut="lolite()" onClick="logVariable('redundantwhereclauses')" href="../../_variables/redundantwhereclauses.html">$redundantwhereclauses</a>
<a name="l1117"><span class="linenum">1117</span></a>         GROUP BY iquiza.id, iquiz.id, iquiz.timeclose, iquiz.timelimit&quot;;
<a name="l1118"><span class="linenum">1118</span></a>      return <a class="var it10198" onMouseOver="hilite(10198)" onMouseOut="lolite()" onClick="logVariable('quizausersql')" href="../../_variables/quizausersql.html">$quizausersql</a>;
<a name="l1119"><span class="linenum">1119</span></a>  }
<a name="l1120"><span class="linenum">1120</span></a>  
<a name="l1121"><span class="linenum">1121</span></a>  <span class="comment">/**</span>
<a name="l1122"><span class="linenum">1122</span></a>  <span class="comment"> * Return the attempt with the best grade for a quiz</span>
<a name="l1123"><span class="linenum">1123</span></a>  <span class="comment"> *</span>
<a name="l1124"><span class="linenum">1124</span></a>  <span class="comment"> * Which attempt is the best depends on $quiz-&gt;grademethod. If the grade</span>
<a name="l1125"><span class="linenum">1125</span></a>  <span class="comment"> * method is GRADEAVERAGE then this function simply returns the last attempt.</span>
<a name="l1126"><span class="linenum">1126</span></a>  <span class="comment"> * @return object         The attempt with the best grade</span>
<a name="l1127"><span class="linenum">1127</span></a>  <span class="comment"> * @param object $quiz    The quiz for which the best grade is to be calculated</span>
<a name="l1128"><span class="linenum">1128</span></a>  <span class="comment"> * @param array $attempts An array of all the attempts of the user at the quiz</span>
<a name="l1129"><span class="linenum">1129</span></a>  <span class="comment"> */</span>
<a name="l1130"><span class="linenum">1130</span></a>  function <a class="function" onClick="logFunction('quiz_calculate_best_attempt')" href="../../_functions/quiz_calculate_best_attempt.html" onMouseOver="funcPopup(event,'quiz_calculate_best_attempt')">quiz_calculate_best_attempt</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a>) {
<a name="l1131"><span class="linenum">1131</span></a>  
<a name="l1132"><span class="linenum">1132</span></a>      switch (<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('grademethod')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/grademethod.html">grademethod</a>) {
<a name="l1133"><span class="linenum">1133</span></a>  
<a name="l1134"><span class="linenum">1134</span></a>          case <a class="constant" onClick="logConstant('QUIZ_ATTEMPTFIRST')" href="../../_constants/QUIZ_ATTEMPTFIRST.html" onMouseOver="constPopup(event,'QUIZ_ATTEMPTFIRST')">QUIZ_ATTEMPTFIRST</a>:
<a name="l1135"><span class="linenum">1135</span></a>              foreach (<a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a> as <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>) {
<a name="l1136"><span class="linenum">1136</span></a>                  return <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>;
<a name="l1137"><span class="linenum">1137</span></a>              }
<a name="l1138"><span class="linenum">1138</span></a>              break;
<a name="l1139"><span class="linenum">1139</span></a>  
<a name="l1140"><span class="linenum">1140</span></a>          case <a class="constant" onClick="logConstant('QUIZ_GRADEAVERAGE')" href="../../_constants/QUIZ_GRADEAVERAGE.html" onMouseOver="constPopup(event,'QUIZ_GRADEAVERAGE')">QUIZ_GRADEAVERAGE</a>: // We need to do something with it.
<a name="l1141"><span class="linenum">1141</span></a>          case <a class="constant" onClick="logConstant('QUIZ_ATTEMPTLAST')" href="../../_constants/QUIZ_ATTEMPTLAST.html" onMouseOver="constPopup(event,'QUIZ_ATTEMPTLAST')">QUIZ_ATTEMPTLAST</a>:
<a name="l1142"><span class="linenum">1142</span></a>              foreach (<a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a> as <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>) {
<a name="l1143"><span class="linenum">1143</span></a>                  <a class="var it4448" onMouseOver="hilite(4448)" onMouseOut="lolite()" onClick="logVariable('final')" href="../../_variables/final.html">$final</a> = <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>;
<a name="l1144"><span class="linenum">1144</span></a>              }
<a name="l1145"><span class="linenum">1145</span></a>              return <a class="var it4448" onMouseOver="hilite(4448)" onMouseOut="lolite()" onClick="logVariable('final')" href="../../_variables/final.html">$final</a>;
<a name="l1146"><span class="linenum">1146</span></a>  
<a name="l1147"><span class="linenum">1147</span></a>          default:
<a name="l1148"><span class="linenum">1148</span></a>          case <a class="constant" onClick="logConstant('QUIZ_GRADEHIGHEST')" href="../../_constants/QUIZ_GRADEHIGHEST.html" onMouseOver="constPopup(event,'QUIZ_GRADEHIGHEST')">QUIZ_GRADEHIGHEST</a>:
<a name="l1149"><span class="linenum">1149</span></a>              <a class="var it536" onMouseOver="hilite(536)" onMouseOut="lolite()" onClick="logVariable('max')" href="../../_variables/max.html">$max</a> = -1;
<a name="l1150"><span class="linenum">1150</span></a>              foreach (<a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a> as <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>) {
<a name="l1151"><span class="linenum">1151</span></a>                  if (<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('sumgrades')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/sumgrades.html">sumgrades</a> &gt; <a class="var it536" onMouseOver="hilite(536)" onMouseOut="lolite()" onClick="logVariable('max')" href="../../_variables/max.html">$max</a>) {
<a name="l1152"><span class="linenum">1152</span></a>                      <a class="var it536" onMouseOver="hilite(536)" onMouseOut="lolite()" onClick="logVariable('max')" href="../../_variables/max.html">$max</a> = <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('sumgrades')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/sumgrades.html">sumgrades</a>;
<a name="l1153"><span class="linenum">1153</span></a>                      <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('maxattempt')" href="../../_variables/maxattempt.html">$maxattempt</a> = <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>;
<a name="l1154"><span class="linenum">1154</span></a>                  }
<a name="l1155"><span class="linenum">1155</span></a>              }
<a name="l1156"><span class="linenum">1156</span></a>              return <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('maxattempt')" href="../../_variables/maxattempt.html">$maxattempt</a>;
<a name="l1157"><span class="linenum">1157</span></a>      }
<a name="l1158"><span class="linenum">1158</span></a>  }
<a name="l1159"><span class="linenum">1159</span></a>  
<a name="l1160"><span class="linenum">1160</span></a>  <span class="comment">/**</span>
<a name="l1161"><span class="linenum">1161</span></a>  <span class="comment"> * @return array int =&gt; lang string the options for calculating the quiz grade</span>
<a name="l1162"><span class="linenum">1162</span></a>  <span class="comment"> *      from the individual attempt grades.</span>
<a name="l1163"><span class="linenum">1163</span></a>  <span class="comment"> */</span>
<a name="l1164"><span class="linenum">1164</span></a>  function <a class="function" onClick="logFunction('quiz_get_grading_options')" href="../../_functions/quiz_get_grading_options.html" onMouseOver="funcPopup(event,'quiz_get_grading_options')">quiz_get_grading_options</a>() {
<a name="l1165"><span class="linenum">1165</span></a>      return array(
<a name="l1166"><span class="linenum">1166</span></a>          <a class="constant" onClick="logConstant('QUIZ_GRADEHIGHEST')" href="../../_constants/QUIZ_GRADEHIGHEST.html" onMouseOver="constPopup(event,'QUIZ_GRADEHIGHEST')">QUIZ_GRADEHIGHEST</a> =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('gradehighest', 'quiz'),
<a name="l1167"><span class="linenum">1167</span></a>          <a class="constant" onClick="logConstant('QUIZ_GRADEAVERAGE')" href="../../_constants/QUIZ_GRADEAVERAGE.html" onMouseOver="constPopup(event,'QUIZ_GRADEAVERAGE')">QUIZ_GRADEAVERAGE</a> =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('gradeaverage', 'quiz'),
<a name="l1168"><span class="linenum">1168</span></a>          <a class="constant" onClick="logConstant('QUIZ_ATTEMPTFIRST')" href="../../_constants/QUIZ_ATTEMPTFIRST.html" onMouseOver="constPopup(event,'QUIZ_ATTEMPTFIRST')">QUIZ_ATTEMPTFIRST</a> =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('attemptfirst', 'quiz'),
<a name="l1169"><span class="linenum">1169</span></a>          <a class="constant" onClick="logConstant('QUIZ_ATTEMPTLAST')" href="../../_constants/QUIZ_ATTEMPTLAST.html" onMouseOver="constPopup(event,'QUIZ_ATTEMPTLAST')">QUIZ_ATTEMPTLAST</a>  =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('attemptlast', 'quiz')
<a name="l1170"><span class="linenum">1170</span></a>      );
<a name="l1171"><span class="linenum">1171</span></a>  }
<a name="l1172"><span class="linenum">1172</span></a>  
<a name="l1173"><span class="linenum">1173</span></a>  <span class="comment">/**</span>
<a name="l1174"><span class="linenum">1174</span></a>  <span class="comment"> * @param int $option one of the values QUIZ_GRADEHIGHEST, QUIZ_GRADEAVERAGE,</span>
<a name="l1175"><span class="linenum">1175</span></a>  <span class="comment"> *      QUIZ_ATTEMPTFIRST or QUIZ_ATTEMPTLAST.</span>
<a name="l1176"><span class="linenum">1176</span></a>  <span class="comment"> * @return the lang string for that option.</span>
<a name="l1177"><span class="linenum">1177</span></a>  <span class="comment"> */</span>
<a name="l1178"><span class="linenum">1178</span></a>  function <a class="function" onClick="logFunction('quiz_get_grading_option_name')" href="../../_functions/quiz_get_grading_option_name.html" onMouseOver="funcPopup(event,'quiz_get_grading_option_name')">quiz_get_grading_option_name</a>(<a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>) {
<a name="l1179"><span class="linenum">1179</span></a>      <a class="var it6547" onMouseOver="hilite(6547)" onMouseOut="lolite()" onClick="logVariable('strings')" href="../../_variables/strings.html">$strings</a> = <a class="function" onClick="logFunction('quiz_get_grading_options')" href="../../_functions/quiz_get_grading_options.html" onMouseOver="funcPopup(event,'quiz_get_grading_options')">quiz_get_grading_options</a>();
<a name="l1180"><span class="linenum">1180</span></a>      return <a class="var it6547" onMouseOver="hilite(6547)" onMouseOut="lolite()" onClick="logVariable('strings')" href="../../_variables/strings.html">$strings</a>[<a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>];
<a name="l1181"><span class="linenum">1181</span></a>  }
<a name="l1182"><span class="linenum">1182</span></a>  
<a name="l1183"><span class="linenum">1183</span></a>  <span class="comment">/**</span>
<a name="l1184"><span class="linenum">1184</span></a>  <span class="comment"> * @return array string =&gt; lang string the options for handling overdue quiz</span>
<a name="l1185"><span class="linenum">1185</span></a>  <span class="comment"> *      attempts.</span>
<a name="l1186"><span class="linenum">1186</span></a>  <span class="comment"> */</span>
<a name="l1187"><span class="linenum">1187</span></a>  function <a class="function" onClick="logFunction('quiz_get_overdue_handling_options')" href="../../_functions/quiz_get_overdue_handling_options.html" onMouseOver="funcPopup(event,'quiz_get_overdue_handling_options')">quiz_get_overdue_handling_options</a>() {
<a name="l1188"><span class="linenum">1188</span></a>      return array(
<a name="l1189"><span class="linenum">1189</span></a>          'autosubmit'  =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('overduehandlingautosubmit', 'quiz'),
<a name="l1190"><span class="linenum">1190</span></a>          'graceperiod' =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('overduehandlinggraceperiod', 'quiz'),
<a name="l1191"><span class="linenum">1191</span></a>          'autoabandon' =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('overduehandlingautoabandon', 'quiz'),
<a name="l1192"><span class="linenum">1192</span></a>      );
<a name="l1193"><span class="linenum">1193</span></a>  }
<a name="l1194"><span class="linenum">1194</span></a>  
<a name="l1195"><span class="linenum">1195</span></a>  <span class="comment">/**</span>
<a name="l1196"><span class="linenum">1196</span></a>  <span class="comment"> * Get the choices for what size user picture to show.</span>
<a name="l1197"><span class="linenum">1197</span></a>  <span class="comment"> * @return array string =&gt; lang string the options for whether to display the user's picture.</span>
<a name="l1198"><span class="linenum">1198</span></a>  <span class="comment"> */</span>
<a name="l1199"><span class="linenum">1199</span></a>  function <a class="function" onClick="logFunction('quiz_get_user_image_options')" href="../../_functions/quiz_get_user_image_options.html" onMouseOver="funcPopup(event,'quiz_get_user_image_options')">quiz_get_user_image_options</a>() {
<a name="l1200"><span class="linenum">1200</span></a>      return array(
<a name="l1201"><span class="linenum">1201</span></a>          <a class="constant" onClick="logConstant('QUIZ_SHOWIMAGE_NONE')" href="../../_constants/QUIZ_SHOWIMAGE_NONE.html" onMouseOver="constPopup(event,'QUIZ_SHOWIMAGE_NONE')">QUIZ_SHOWIMAGE_NONE</a>  =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('shownoimage', 'quiz'),
<a name="l1202"><span class="linenum">1202</span></a>          <a class="constant" onClick="logConstant('QUIZ_SHOWIMAGE_SMALL')" href="../../_constants/QUIZ_SHOWIMAGE_SMALL.html" onMouseOver="constPopup(event,'QUIZ_SHOWIMAGE_SMALL')">QUIZ_SHOWIMAGE_SMALL</a> =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('showsmallimage', 'quiz'),
<a name="l1203"><span class="linenum">1203</span></a>          <a class="constant" onClick="logConstant('QUIZ_SHOWIMAGE_LARGE')" href="../../_constants/QUIZ_SHOWIMAGE_LARGE.html" onMouseOver="constPopup(event,'QUIZ_SHOWIMAGE_LARGE')">QUIZ_SHOWIMAGE_LARGE</a> =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('showlargeimage', 'quiz'),
<a name="l1204"><span class="linenum">1204</span></a>      );
<a name="l1205"><span class="linenum">1205</span></a>  }
<a name="l1206"><span class="linenum">1206</span></a>  
<a name="l1207"><span class="linenum">1207</span></a>  <span class="comment">/**</span>
<a name="l1208"><span class="linenum">1208</span></a>  <span class="comment"> * Get the choices to offer for the 'Questions per page' option.</span>
<a name="l1209"><span class="linenum">1209</span></a>  <span class="comment"> * @return array int =&gt; string.</span>
<a name="l1210"><span class="linenum">1210</span></a>  <span class="comment"> */</span>
<a name="l1211"><span class="linenum">1211</span></a>  function <a class="function" onClick="logFunction('quiz_questions_per_page_options')" href="../../_functions/quiz_questions_per_page_options.html" onMouseOver="funcPopup(event,'quiz_questions_per_page_options')">quiz_questions_per_page_options</a>() {
<a name="l1212"><span class="linenum">1212</span></a>      <a class="var it14734" onMouseOver="hilite(14734)" onMouseOut="lolite()" onClick="logVariable('pageoptions')" href="../../_variables/pageoptions.html">$pageoptions</a> = array();
<a name="l1213"><span class="linenum">1213</span></a>      <a class="var it14734" onMouseOver="hilite(14734)" onMouseOut="lolite()" onClick="logVariable('pageoptions')" href="../../_variables/pageoptions.html">$pageoptions</a>[0] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('neverallononepage', 'quiz');
<a name="l1214"><span class="linenum">1214</span></a>      <a class="var it14734" onMouseOver="hilite(14734)" onMouseOut="lolite()" onClick="logVariable('pageoptions')" href="../../_variables/pageoptions.html">$pageoptions</a>[1] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('everyquestion', 'quiz');
<a name="l1215"><span class="linenum">1215</span></a>      for (<a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> = 2; <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> &lt;= <a class="constant" onClick="logConstant('QUIZ_MAX_QPP_OPTION')" href="../../_constants/QUIZ_MAX_QPP_OPTION.html" onMouseOver="constPopup(event,'QUIZ_MAX_QPP_OPTION')">QUIZ_MAX_QPP_OPTION</a>; ++<a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>) {
<a name="l1216"><span class="linenum">1216</span></a>          <a class="var it14734" onMouseOver="hilite(14734)" onMouseOut="lolite()" onClick="logVariable('pageoptions')" href="../../_variables/pageoptions.html">$pageoptions</a>[<a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('everynquestions', 'quiz', <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>);
<a name="l1217"><span class="linenum">1217</span></a>      }
<a name="l1218"><span class="linenum">1218</span></a>      return <a class="var it14734" onMouseOver="hilite(14734)" onMouseOut="lolite()" onClick="logVariable('pageoptions')" href="../../_variables/pageoptions.html">$pageoptions</a>;
<a name="l1219"><span class="linenum">1219</span></a>  }
<a name="l1220"><span class="linenum">1220</span></a>  
<a name="l1221"><span class="linenum">1221</span></a>  <span class="comment">/**</span>
<a name="l1222"><span class="linenum">1222</span></a>  <span class="comment"> * Get the human-readable name for a quiz attempt state.</span>
<a name="l1223"><span class="linenum">1223</span></a>  <span class="comment"> * @param string $state one of the state constants like {@link quiz_attempt::IN_PROGRESS}.</span>
<a name="l1224"><span class="linenum">1224</span></a>  <span class="comment"> * @return string The lang string to describe that state.</span>
<a name="l1225"><span class="linenum">1225</span></a>  <span class="comment"> */</span>
<a name="l1226"><span class="linenum">1226</span></a>  function <a class="function" onClick="logFunction('quiz_attempt_state_name')" href="../../_functions/quiz_attempt_state_name.html" onMouseOver="funcPopup(event,'quiz_attempt_state_name')">quiz_attempt_state_name</a>(<a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>) {
<a name="l1227"><span class="linenum">1227</span></a>      switch (<a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>) {
<a name="l1228"><span class="linenum">1228</span></a>          case <a class="class" onClick="logClass('quiz_attempt')" href="../../_classes/quiz_attempt.html" onMouseOver="classPopup(event,'quiz_attempt')">quiz_attempt</a>::IN_PROGRESS:
<a name="l1229"><span class="linenum">1229</span></a>              return <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('stateinprogress', 'quiz');
<a name="l1230"><span class="linenum">1230</span></a>          case <a class="class" onClick="logClass('quiz_attempt')" href="../../_classes/quiz_attempt.html" onMouseOver="classPopup(event,'quiz_attempt')">quiz_attempt</a>::OVERDUE:
<a name="l1231"><span class="linenum">1231</span></a>              return <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('stateoverdue', 'quiz');
<a name="l1232"><span class="linenum">1232</span></a>          case <a class="class" onClick="logClass('quiz_attempt')" href="../../_classes/quiz_attempt.html" onMouseOver="classPopup(event,'quiz_attempt')">quiz_attempt</a>::FINISHED:
<a name="l1233"><span class="linenum">1233</span></a>              return <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('statefinished', 'quiz');
<a name="l1234"><span class="linenum">1234</span></a>          case <a class="class" onClick="logClass('quiz_attempt')" href="../../_classes/quiz_attempt.html" onMouseOver="classPopup(event,'quiz_attempt')">quiz_attempt</a>::ABANDONED:
<a name="l1235"><span class="linenum">1235</span></a>              return <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('stateabandoned', 'quiz');
<a name="l1236"><span class="linenum">1236</span></a>          default:
<a name="l1237"><span class="linenum">1237</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Unknown quiz attempt state.');
<a name="l1238"><span class="linenum">1238</span></a>      }
<a name="l1239"><span class="linenum">1239</span></a>  }
<a name="l1240"><span class="linenum">1240</span></a>  
<a name="l1241"><span class="linenum">1241</span></a>  <span class="comment">// Other quiz functions ////////////////////////////////////////////////////////</span>
<a name="l1242"><span class="linenum">1242</span></a>  
<a name="l1243"><span class="linenum">1243</span></a>  <span class="comment">/**</span>
<a name="l1244"><span class="linenum">1244</span></a>  <span class="comment"> * @param object $quiz the quiz.</span>
<a name="l1245"><span class="linenum">1245</span></a>  <span class="comment"> * @param int $cmid the course_module object for this quiz.</span>
<a name="l1246"><span class="linenum">1246</span></a>  <span class="comment"> * @param object $question the question.</span>
<a name="l1247"><span class="linenum">1247</span></a>  <span class="comment"> * @param string $returnurl url to return to after action is done.</span>
<a name="l1248"><span class="linenum">1248</span></a>  <span class="comment"> * @param int $variant which question variant to preview (optional).</span>
<a name="l1249"><span class="linenum">1249</span></a>  <span class="comment"> * @return string html for a number of icons linked to action pages for a</span>
<a name="l1250"><span class="linenum">1250</span></a>  <span class="comment"> * question - preview and edit / view icons depending on user capabilities.</span>
<a name="l1251"><span class="linenum">1251</span></a>  <span class="comment"> */</span>
<a name="l1252"><span class="linenum">1252</span></a>  function <a class="function" onClick="logFunction('quiz_question_action_icons')" href="../../_functions/quiz_question_action_icons.html" onMouseOver="funcPopup(event,'quiz_question_action_icons')">quiz_question_action_icons</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it1077" onMouseOver="hilite(1077)" onMouseOut="lolite()" onClick="logVariable('cmid')" href="../../_variables/cmid.html">$cmid</a>, <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>, <a class="var it1440" onMouseOver="hilite(1440)" onMouseOut="lolite()" onClick="logVariable('returnurl')" href="../../_variables/returnurl.html">$returnurl</a>, <a class="var it183" onMouseOver="hilite(183)" onMouseOut="lolite()" onClick="logVariable('variant')" href="../../_variables/variant.html">$variant</a> = null) {
<a name="l1253"><span class="linenum">1253</span></a>      <a class="var it475" onMouseOver="hilite(475)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../_variables/html.html">$html</a> = <a class="function" onClick="logFunction('quiz_question_preview_button')" href="../../_functions/quiz_question_preview_button.html" onMouseOver="funcPopup(event,'quiz_question_preview_button')">quiz_question_preview_button</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>, false, <a class="var it183" onMouseOver="hilite(183)" onMouseOut="lolite()" onClick="logVariable('variant')" href="../../_variables/variant.html">$variant</a>) . ' ' .
<a name="l1254"><span class="linenum">1254</span></a>              <a class="function" onClick="logFunction('quiz_question_edit_button')" href="../../_functions/quiz_question_edit_button.html" onMouseOver="funcPopup(event,'quiz_question_edit_button')">quiz_question_edit_button</a>(<a class="var it1077" onMouseOver="hilite(1077)" onMouseOut="lolite()" onClick="logVariable('cmid')" href="../../_variables/cmid.html">$cmid</a>, <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>, <a class="var it1440" onMouseOver="hilite(1440)" onMouseOut="lolite()" onClick="logVariable('returnurl')" href="../../_variables/returnurl.html">$returnurl</a>);
<a name="l1255"><span class="linenum">1255</span></a>      return <a class="var it475" onMouseOver="hilite(475)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../_variables/html.html">$html</a>;
<a name="l1256"><span class="linenum">1256</span></a>  }
<a name="l1257"><span class="linenum">1257</span></a>  
<a name="l1258"><span class="linenum">1258</span></a>  <span class="comment">/**</span>
<a name="l1259"><span class="linenum">1259</span></a>  <span class="comment"> * @param int $cmid the course_module.id for this quiz.</span>
<a name="l1260"><span class="linenum">1260</span></a>  <span class="comment"> * @param object $question the question.</span>
<a name="l1261"><span class="linenum">1261</span></a>  <span class="comment"> * @param string $returnurl url to return to after action is done.</span>
<a name="l1262"><span class="linenum">1262</span></a>  <span class="comment"> * @param string $contentbeforeicon some HTML content to be added inside the link, before the icon.</span>
<a name="l1263"><span class="linenum">1263</span></a>  <span class="comment"> * @return the HTML for an edit icon, view icon, or nothing for a question</span>
<a name="l1264"><span class="linenum">1264</span></a>  <span class="comment"> *      (depending on permissions).</span>
<a name="l1265"><span class="linenum">1265</span></a>  <span class="comment"> */</span>
<a name="l1266"><span class="linenum">1266</span></a>  function <a class="function" onClick="logFunction('quiz_question_edit_button')" href="../../_functions/quiz_question_edit_button.html" onMouseOver="funcPopup(event,'quiz_question_edit_button')">quiz_question_edit_button</a>(<a class="var it1077" onMouseOver="hilite(1077)" onMouseOut="lolite()" onClick="logVariable('cmid')" href="../../_variables/cmid.html">$cmid</a>, <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>, <a class="var it1440" onMouseOver="hilite(1440)" onMouseOut="lolite()" onClick="logVariable('returnurl')" href="../../_variables/returnurl.html">$returnurl</a>, <a class="var it41443" onMouseOver="hilite(41443)" onMouseOut="lolite()" onClick="logVariable('contentaftericon')" href="../../_variables/contentaftericon.html">$contentaftericon</a> = '') {
<a name="l1267"><span class="linenum">1267</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>;
<a name="l1268"><span class="linenum">1268</span></a>  
<a name="l1269"><span class="linenum">1269</span></a>  <span class="comment">    // Minor efficiency saving. Only get strings once, even if there are a lot of icons on one page.</span>
<a name="l1270"><span class="linenum">1270</span></a>      static <a class="var it1848" onMouseOver="hilite(1848)" onMouseOut="lolite()" onClick="logVariable('stredit')" href="../../_variables/stredit.html">$stredit</a> = null;
<a name="l1271"><span class="linenum">1271</span></a>      static <a class="var it2259" onMouseOver="hilite(2259)" onMouseOut="lolite()" onClick="logVariable('strview')" href="../../_variables/strview.html">$strview</a> = null;
<a name="l1272"><span class="linenum">1272</span></a>      if (<a class="var it1848" onMouseOver="hilite(1848)" onMouseOut="lolite()" onClick="logVariable('stredit')" href="../../_variables/stredit.html">$stredit</a> === null) {
<a name="l1273"><span class="linenum">1273</span></a>          <a class="var it1848" onMouseOver="hilite(1848)" onMouseOut="lolite()" onClick="logVariable('stredit')" href="../../_variables/stredit.html">$stredit</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('edit');
<a name="l1274"><span class="linenum">1274</span></a>          <a class="var it2259" onMouseOver="hilite(2259)" onMouseOut="lolite()" onClick="logVariable('strview')" href="../../_variables/strview.html">$strview</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('view');
<a name="l1275"><span class="linenum">1275</span></a>      }
<a name="l1276"><span class="linenum">1276</span></a>  
<a name="l1277"><span class="linenum">1277</span></a>  <span class="comment">    // What sort of icon should we show?</span>
<a name="l1278"><span class="linenum">1278</span></a>      <a class="var it280" onMouseOver="hilite(280)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> = '';
<a name="l1279"><span class="linenum">1279</span></a>      if (!empty(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>) &amp;&amp;
<a name="l1280"><span class="linenum">1280</span></a>              (<a class="function" onClick="logFunction('question_has_capability_on')" href="../../_functions/question_has_capability_on.html" onMouseOver="funcPopup(event,'question_has_capability_on')">question_has_capability_on</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>, 'edit', <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('category')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../../_variables/category.html">category</a>) ||
<a name="l1281"><span class="linenum">1281</span></a>                      <a class="function" onClick="logFunction('question_has_capability_on')" href="../../_functions/question_has_capability_on.html" onMouseOver="funcPopup(event,'question_has_capability_on')">question_has_capability_on</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>, 'move', <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('category')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../../_variables/category.html">category</a>))) {
<a name="l1282"><span class="linenum">1282</span></a>          <a class="var it280" onMouseOver="hilite(280)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> = <a class="var it1848" onMouseOver="hilite(1848)" onMouseOut="lolite()" onClick="logVariable('stredit')" href="../../_variables/stredit.html">$stredit</a>;
<a name="l1283"><span class="linenum">1283</span></a>          <a class="var it727" onMouseOver="hilite(727)" onMouseOut="lolite()" onClick="logVariable('icon')" href="../../_variables/icon.html">$icon</a> = '/t/edit';
<a name="l1284"><span class="linenum">1284</span></a>      } else if (!empty(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>) &amp;&amp;
<a name="l1285"><span class="linenum">1285</span></a>              <a class="function" onClick="logFunction('question_has_capability_on')" href="../../_functions/question_has_capability_on.html" onMouseOver="funcPopup(event,'question_has_capability_on')">question_has_capability_on</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>, 'view', <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('category')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../../_variables/category.html">category</a>)) {
<a name="l1286"><span class="linenum">1286</span></a>          <a class="var it280" onMouseOver="hilite(280)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> = <a class="var it2259" onMouseOver="hilite(2259)" onMouseOut="lolite()" onClick="logVariable('strview')" href="../../_variables/strview.html">$strview</a>;
<a name="l1287"><span class="linenum">1287</span></a>          <a class="var it727" onMouseOver="hilite(727)" onMouseOut="lolite()" onClick="logVariable('icon')" href="../../_variables/icon.html">$icon</a> = '/i/info';
<a name="l1288"><span class="linenum">1288</span></a>      }
<a name="l1289"><span class="linenum">1289</span></a>  
<a name="l1290"><span class="linenum">1290</span></a>  <span class="comment">    // Build the icon.</span>
<a name="l1291"><span class="linenum">1291</span></a>      if (<a class="var it280" onMouseOver="hilite(280)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a>) {
<a name="l1292"><span class="linenum">1292</span></a>          if (<a class="var it1440" onMouseOver="hilite(1440)" onMouseOut="lolite()" onClick="logVariable('returnurl')" href="../../_variables/returnurl.html">$returnurl</a> instanceof moodle_url) {
<a name="l1293"><span class="linenum">1293</span></a>              <a class="var it1440" onMouseOver="hilite(1440)" onMouseOut="lolite()" onClick="logVariable('returnurl')" href="../../_variables/returnurl.html">$returnurl</a> = <a class="var it1440" onMouseOver="hilite(1440)" onMouseOut="lolite()" onClick="logVariable('returnurl')" href="../../_variables/returnurl.html">$returnurl</a>-&gt;<a class="function" onClick="logFunction('out_as_local_url')" href="../../_functions/out_as_local_url.html" onMouseOver="funcPopup(event,'out_as_local_url')">out_as_local_url</a>(false);
<a name="l1294"><span class="linenum">1294</span></a>          }
<a name="l1295"><span class="linenum">1295</span></a>          <a class="var it41444" onMouseOver="hilite(41444)" onMouseOut="lolite()" onClick="logVariable('questionparams')" href="../../_variables/questionparams.html">$questionparams</a> = array('returnurl' =&gt; <a class="var it1440" onMouseOver="hilite(1440)" onMouseOut="lolite()" onClick="logVariable('returnurl')" href="../../_variables/returnurl.html">$returnurl</a>, 'cmid' =&gt; <a class="var it1077" onMouseOver="hilite(1077)" onMouseOut="lolite()" onClick="logVariable('cmid')" href="../../_variables/cmid.html">$cmid</a>, 'id' =&gt; <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l1296"><span class="linenum">1296</span></a>          <a class="var it41445" onMouseOver="hilite(41445)" onMouseOut="lolite()" onClick="logVariable('questionurl')" href="../../_variables/questionurl.html">$questionurl</a> = <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>(&quot;<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>/question/question.php&quot;, <a class="var it41444" onMouseOver="hilite(41444)" onMouseOut="lolite()" onClick="logVariable('questionparams')" href="../../_variables/questionparams.html">$questionparams</a>);
<a name="l1297"><span class="linenum">1297</span></a>          return '&lt;a title=&quot;' . <a class="var it280" onMouseOver="hilite(280)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> . '&quot; href=&quot;' . <a class="var it41445" onMouseOver="hilite(41445)" onMouseOut="lolite()" onClick="logVariable('questionurl')" href="../../_variables/questionurl.html">$questionurl</a>-&gt;<a class="function" onClick="logFunction('out')" href="../../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>() . '&quot; class=&quot;questioneditbutton&quot;&gt;&lt;img src=&quot;' .
<a name="l1298"><span class="linenum">1298</span></a>                  <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('pix_url')" href="../../_functions/pix_url.html" onMouseOver="funcPopup(event,'pix_url')">pix_url</a>(<a class="var it727" onMouseOver="hilite(727)" onMouseOut="lolite()" onClick="logVariable('icon')" href="../../_variables/icon.html">$icon</a>) . '&quot; alt=&quot;' . <a class="var it280" onMouseOver="hilite(280)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> . '&quot; /&gt;' . <a class="var it41443" onMouseOver="hilite(41443)" onMouseOut="lolite()" onClick="logVariable('contentaftericon')" href="../../_variables/contentaftericon.html">$contentaftericon</a> .
<a name="l1299"><span class="linenum">1299</span></a>                  '&lt;/a&gt;';
<a name="l1300"><span class="linenum">1300</span></a>      } else if (<a class="var it41443" onMouseOver="hilite(41443)" onMouseOut="lolite()" onClick="logVariable('contentaftericon')" href="../../_variables/contentaftericon.html">$contentaftericon</a>) {
<a name="l1301"><span class="linenum">1301</span></a>          return '&lt;span class=&quot;questioneditbutton&quot;&gt;' . <a class="var it41443" onMouseOver="hilite(41443)" onMouseOut="lolite()" onClick="logVariable('contentaftericon')" href="../../_variables/contentaftericon.html">$contentaftericon</a> . '&lt;/span&gt;';
<a name="l1302"><span class="linenum">1302</span></a>      } else {
<a name="l1303"><span class="linenum">1303</span></a>          return '';
<a name="l1304"><span class="linenum">1304</span></a>      }
<a name="l1305"><span class="linenum">1305</span></a>  }
<a name="l1306"><span class="linenum">1306</span></a>  
<a name="l1307"><span class="linenum">1307</span></a>  <span class="comment">/**</span>
<a name="l1308"><span class="linenum">1308</span></a>  <span class="comment"> * @param object $quiz the quiz settings</span>
<a name="l1309"><span class="linenum">1309</span></a>  <span class="comment"> * @param object $question the question</span>
<a name="l1310"><span class="linenum">1310</span></a>  <span class="comment"> * @param int $variant which question variant to preview (optional).</span>
<a name="l1311"><span class="linenum">1311</span></a>  <span class="comment"> * @return moodle_url to preview this question with the options from this quiz.</span>
<a name="l1312"><span class="linenum">1312</span></a>  <span class="comment"> */</span>
<a name="l1313"><span class="linenum">1313</span></a>  function <a class="function" onClick="logFunction('quiz_question_preview_url')" href="../../_functions/quiz_question_preview_url.html" onMouseOver="funcPopup(event,'quiz_question_preview_url')">quiz_question_preview_url</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>, <a class="var it183" onMouseOver="hilite(183)" onMouseOut="lolite()" onClick="logVariable('variant')" href="../../_variables/variant.html">$variant</a> = null) {
<a name="l1314"><span class="linenum">1314</span></a>  <span class="comment">    // Get the appropriate display options.</span>
<a name="l1315"><span class="linenum">1315</span></a>      <a class="var it4390" onMouseOver="hilite(4390)" onMouseOut="lolite()" onClick="logVariable('displayoptions')" href="../../_variables/displayoptions.html">$displayoptions</a> = <a class="class" onClick="logClass('mod_quiz_display_options')" href="../../_classes/mod_quiz_display_options.html" onMouseOver="classPopup(event,'mod_quiz_display_options')">mod_quiz_display_options</a>::<a class="function" onClick="logFunction('make_from_quiz')" href="../../_functions/make_from_quiz.html" onMouseOver="funcPopup(event,'make_from_quiz')">make_from_quiz</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>,
<a name="l1316"><span class="linenum">1316</span></a>              <a class="class" onClick="logClass('mod_quiz_display_options')" href="../../_classes/mod_quiz_display_options.html" onMouseOver="classPopup(event,'mod_quiz_display_options')">mod_quiz_display_options</a>::DURING);
<a name="l1317"><span class="linenum">1317</span></a>  
<a name="l1318"><span class="linenum">1318</span></a>      <a class="var it455" onMouseOver="hilite(455)" onMouseOut="lolite()" onClick="logVariable('maxmark')" href="../../_variables/maxmark.html">$maxmark</a> = null;
<a name="l1319"><span class="linenum">1319</span></a>      if (isset(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('maxmark')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../../_variables/maxmark.html">maxmark</a>)) {
<a name="l1320"><span class="linenum">1320</span></a>          <a class="var it455" onMouseOver="hilite(455)" onMouseOut="lolite()" onClick="logVariable('maxmark')" href="../../_variables/maxmark.html">$maxmark</a> = <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('maxmark')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../../_variables/maxmark.html">maxmark</a>;
<a name="l1321"><span class="linenum">1321</span></a>      }
<a name="l1322"><span class="linenum">1322</span></a>  
<a name="l1323"><span class="linenum">1323</span></a>  <span class="comment">    // Work out the correcte preview URL.</span>
<a name="l1324"><span class="linenum">1324</span></a>      return <a class="function" onClick="logFunction('question_preview_url')" href="../../_functions/question_preview_url.html" onMouseOver="funcPopup(event,'question_preview_url')">question_preview_url</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('preferredbehaviour')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/preferredbehaviour.html">preferredbehaviour</a>,
<a name="l1325"><span class="linenum">1325</span></a>              <a class="var it455" onMouseOver="hilite(455)" onMouseOut="lolite()" onClick="logVariable('maxmark')" href="../../_variables/maxmark.html">$maxmark</a>, <a class="var it4390" onMouseOver="hilite(4390)" onMouseOut="lolite()" onClick="logVariable('displayoptions')" href="../../_variables/displayoptions.html">$displayoptions</a>, <a class="var it183" onMouseOver="hilite(183)" onMouseOut="lolite()" onClick="logVariable('variant')" href="../../_variables/variant.html">$variant</a>);
<a name="l1326"><span class="linenum">1326</span></a>  }
<a name="l1327"><span class="linenum">1327</span></a>  
<a name="l1328"><span class="linenum">1328</span></a>  <span class="comment">/**</span>
<a name="l1329"><span class="linenum">1329</span></a>  <span class="comment"> * @param object $quiz the quiz settings</span>
<a name="l1330"><span class="linenum">1330</span></a>  <span class="comment"> * @param object $question the question</span>
<a name="l1331"><span class="linenum">1331</span></a>  <span class="comment"> * @param bool $label if true, show the preview question label after the icon</span>
<a name="l1332"><span class="linenum">1332</span></a>  <span class="comment"> * @param int $variant which question variant to preview (optional).</span>
<a name="l1333"><span class="linenum">1333</span></a>  <span class="comment"> * @return the HTML for a preview question icon.</span>
<a name="l1334"><span class="linenum">1334</span></a>  <span class="comment"> */</span>
<a name="l1335"><span class="linenum">1335</span></a>  function <a class="function" onClick="logFunction('quiz_question_preview_button')" href="../../_functions/quiz_question_preview_button.html" onMouseOver="funcPopup(event,'quiz_question_preview_button')">quiz_question_preview_button</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>, <a class="var it560" onMouseOver="hilite(560)" onMouseOut="lolite()" onClick="logVariable('label')" href="../../_variables/label.html">$label</a> = false, <a class="var it183" onMouseOver="hilite(183)" onMouseOut="lolite()" onClick="logVariable('variant')" href="../../_variables/variant.html">$variant</a> = null) {
<a name="l1336"><span class="linenum">1336</span></a>      global <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>;
<a name="l1337"><span class="linenum">1337</span></a>      if (!<a class="function" onClick="logFunction('question_has_capability_on')" href="../../_functions/question_has_capability_on.html" onMouseOver="funcPopup(event,'question_has_capability_on')">question_has_capability_on</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>, 'use', <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('category')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../../_variables/category.html">category</a>)) {
<a name="l1338"><span class="linenum">1338</span></a>          return '';
<a name="l1339"><span class="linenum">1339</span></a>      }
<a name="l1340"><span class="linenum">1340</span></a>  
<a name="l1341"><span class="linenum">1341</span></a>      return <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('get_renderer')" href="../../_functions/get_renderer.html" onMouseOver="funcPopup(event,'get_renderer')">get_renderer</a>('mod_quiz', 'edit')-&gt;<a class="function" onClick="logFunction('question_preview_icon')" href="../../_functions/question_preview_icon.html" onMouseOver="funcPopup(event,'question_preview_icon')">question_preview_icon</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>, <a class="var it560" onMouseOver="hilite(560)" onMouseOut="lolite()" onClick="logVariable('label')" href="../../_variables/label.html">$label</a>, <a class="var it183" onMouseOver="hilite(183)" onMouseOut="lolite()" onClick="logVariable('variant')" href="../../_variables/variant.html">$variant</a>);
<a name="l1342"><span class="linenum">1342</span></a>  }
<a name="l1343"><span class="linenum">1343</span></a>  
<a name="l1344"><span class="linenum">1344</span></a>  <span class="comment">/**</span>
<a name="l1345"><span class="linenum">1345</span></a>  <span class="comment"> * @param object $attempt the attempt.</span>
<a name="l1346"><span class="linenum">1346</span></a>  <span class="comment"> * @param object $context the quiz context.</span>
<a name="l1347"><span class="linenum">1347</span></a>  <span class="comment"> * @return int whether flags should be shown/editable to the current user for this attempt.</span>
<a name="l1348"><span class="linenum">1348</span></a>  <span class="comment"> */</span>
<a name="l1349"><span class="linenum">1349</span></a>  function <a class="function" onClick="logFunction('quiz_get_flag_option')" href="../../_functions/quiz_get_flag_option.html" onMouseOver="funcPopup(event,'quiz_get_flag_option')">quiz_get_flag_option</a>(<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>) {
<a name="l1350"><span class="linenum">1350</span></a>      global <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>;
<a name="l1351"><span class="linenum">1351</span></a>      if (!<a class="function" onClick="logFunction('has_capability')" href="../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/question:flag', <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>)) {
<a name="l1352"><span class="linenum">1352</span></a>          return <a class="class" onClick="logClass('question_display_options')" href="../../_classes/question_display_options.html" onMouseOver="classPopup(event,'question_display_options')">question_display_options</a>::HIDDEN;
<a name="l1353"><span class="linenum">1353</span></a>      } else if (<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('userid')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> == <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>) {
<a name="l1354"><span class="linenum">1354</span></a>          return <a class="class" onClick="logClass('question_display_options')" href="../../_classes/question_display_options.html" onMouseOver="classPopup(event,'question_display_options')">question_display_options</a>::EDITABLE;
<a name="l1355"><span class="linenum">1355</span></a>      } else {
<a name="l1356"><span class="linenum">1356</span></a>          return <a class="class" onClick="logClass('question_display_options')" href="../../_classes/question_display_options.html" onMouseOver="classPopup(event,'question_display_options')">question_display_options</a>::VISIBLE;
<a name="l1357"><span class="linenum">1357</span></a>      }
<a name="l1358"><span class="linenum">1358</span></a>  }
<a name="l1359"><span class="linenum">1359</span></a>  
<a name="l1360"><span class="linenum">1360</span></a>  <span class="comment">/**</span>
<a name="l1361"><span class="linenum">1361</span></a>  <span class="comment"> * Work out what state this quiz attempt is in - in the sense used by</span>
<a name="l1362"><span class="linenum">1362</span></a>  <span class="comment"> * quiz_get_review_options, not in the sense of $attempt-&gt;state.</span>
<a name="l1363"><span class="linenum">1363</span></a>  <span class="comment"> * @param object $quiz the quiz settings</span>
<a name="l1364"><span class="linenum">1364</span></a>  <span class="comment"> * @param object $attempt the quiz_attempt database row.</span>
<a name="l1365"><span class="linenum">1365</span></a>  <span class="comment"> * @return int one of the mod_quiz_display_options::DURING,</span>
<a name="l1366"><span class="linenum">1366</span></a>  <span class="comment"> *      IMMEDIATELY_AFTER, LATER_WHILE_OPEN or AFTER_CLOSE constants.</span>
<a name="l1367"><span class="linenum">1367</span></a>  <span class="comment"> */</span>
<a name="l1368"><span class="linenum">1368</span></a>  function <a class="function" onClick="logFunction('quiz_attempt_state')" href="../../_functions/quiz_attempt_state.html" onMouseOver="funcPopup(event,'quiz_attempt_state')">quiz_attempt_state</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>) {
<a name="l1369"><span class="linenum">1369</span></a>      if (<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('state')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> == <a class="class" onClick="logClass('quiz_attempt')" href="../../_classes/quiz_attempt.html" onMouseOver="classPopup(event,'quiz_attempt')">quiz_attempt</a>::IN_PROGRESS) {
<a name="l1370"><span class="linenum">1370</span></a>          return <a class="class" onClick="logClass('mod_quiz_display_options')" href="../../_classes/mod_quiz_display_options.html" onMouseOver="classPopup(event,'mod_quiz_display_options')">mod_quiz_display_options</a>::DURING;
<a name="l1371"><span class="linenum">1371</span></a>      } else if (<a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() &lt; <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('timefinish')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/timefinish.html">timefinish</a> + 120) {
<a name="l1372"><span class="linenum">1372</span></a>          return <a class="class" onClick="logClass('mod_quiz_display_options')" href="../../_classes/mod_quiz_display_options.html" onMouseOver="classPopup(event,'mod_quiz_display_options')">mod_quiz_display_options</a>::IMMEDIATELY_AFTER;
<a name="l1373"><span class="linenum">1373</span></a>      } else if (!<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('timeclose')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/timeclose.html">timeclose</a> || <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() &lt; <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('timeclose')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/timeclose.html">timeclose</a>) {
<a name="l1374"><span class="linenum">1374</span></a>          return <a class="class" onClick="logClass('mod_quiz_display_options')" href="../../_classes/mod_quiz_display_options.html" onMouseOver="classPopup(event,'mod_quiz_display_options')">mod_quiz_display_options</a>::LATER_WHILE_OPEN;
<a name="l1375"><span class="linenum">1375</span></a>      } else {
<a name="l1376"><span class="linenum">1376</span></a>          return <a class="class" onClick="logClass('mod_quiz_display_options')" href="../../_classes/mod_quiz_display_options.html" onMouseOver="classPopup(event,'mod_quiz_display_options')">mod_quiz_display_options</a>::AFTER_CLOSE;
<a name="l1377"><span class="linenum">1377</span></a>      }
<a name="l1378"><span class="linenum">1378</span></a>  }
<a name="l1379"><span class="linenum">1379</span></a>  
<a name="l1380"><span class="linenum">1380</span></a>  <span class="comment">/**</span>
<a name="l1381"><span class="linenum">1381</span></a>  <span class="comment"> * The the appropraite mod_quiz_display_options object for this attempt at this</span>
<a name="l1382"><span class="linenum">1382</span></a>  <span class="comment"> * quiz right now.</span>
<a name="l1383"><span class="linenum">1383</span></a>  <span class="comment"> *</span>
<a name="l1384"><span class="linenum">1384</span></a>  <span class="comment"> * @param object $quiz the quiz instance.</span>
<a name="l1385"><span class="linenum">1385</span></a>  <span class="comment"> * @param object $attempt the attempt in question.</span>
<a name="l1386"><span class="linenum">1386</span></a>  <span class="comment"> * @param $context the quiz context.</span>
<a name="l1387"><span class="linenum">1387</span></a>  <span class="comment"> *</span>
<a name="l1388"><span class="linenum">1388</span></a>  <span class="comment"> * @return mod_quiz_display_options</span>
<a name="l1389"><span class="linenum">1389</span></a>  <span class="comment"> */</span>
<a name="l1390"><span class="linenum">1390</span></a>  function <a class="function" onClick="logFunction('quiz_get_review_options')" href="../../_functions/quiz_get_review_options.html" onMouseOver="funcPopup(event,'quiz_get_review_options')">quiz_get_review_options</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>) {
<a name="l1391"><span class="linenum">1391</span></a>      <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a> = <a class="class" onClick="logClass('mod_quiz_display_options')" href="../../_classes/mod_quiz_display_options.html" onMouseOver="classPopup(event,'mod_quiz_display_options')">mod_quiz_display_options</a>::<a class="function" onClick="logFunction('make_from_quiz')" href="../../_functions/make_from_quiz.html" onMouseOver="funcPopup(event,'make_from_quiz')">make_from_quiz</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="function" onClick="logFunction('quiz_attempt_state')" href="../../_functions/quiz_attempt_state.html" onMouseOver="funcPopup(event,'quiz_attempt_state')">quiz_attempt_state</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>));
<a name="l1392"><span class="linenum">1392</span></a>  
<a name="l1393"><span class="linenum">1393</span></a>      <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('readonly')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/readonly.html">readonly</a> = true;
<a name="l1394"><span class="linenum">1394</span></a>      <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('flags')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/flags.html">flags</a> = <a class="function" onClick="logFunction('quiz_get_flag_option')" href="../../_functions/quiz_get_flag_option.html" onMouseOver="funcPopup(event,'quiz_get_flag_option')">quiz_get_flag_option</a>(<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l1395"><span class="linenum">1395</span></a>      if (!empty(<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('id')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>)) {
<a name="l1396"><span class="linenum">1396</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('questionreviewlink')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/questionreviewlink.html">questionreviewlink</a> = <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../mod/quiz/reviewquestion.php.html">/mod/quiz/reviewquestion.php</a>',
<a name="l1397"><span class="linenum">1397</span></a>                  array('attempt' =&gt; <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('id')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l1398"><span class="linenum">1398</span></a>      }
<a name="l1399"><span class="linenum">1399</span></a>  
<a name="l1400"><span class="linenum">1400</span></a>  <span class="comment">    // Show a link to the comment box only for closed attempts.</span>
<a name="l1401"><span class="linenum">1401</span></a>      if (!empty(<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('id')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>) &amp;&amp; <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('state')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> == <a class="class" onClick="logClass('quiz_attempt')" href="../../_classes/quiz_attempt.html" onMouseOver="classPopup(event,'quiz_attempt')">quiz_attempt</a>::FINISHED &amp;&amp; !<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('preview')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/preview.html">preview</a> &amp;&amp;
<a name="l1402"><span class="linenum">1402</span></a>              !<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>) &amp;&amp; <a class="function" onClick="logFunction('has_capability')" href="../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('mod/quiz:grade', <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>)) {
<a name="l1403"><span class="linenum">1403</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('manualcomment')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/manualcomment.html">manualcomment</a> = <a class="class" onClick="logClass('question_display_options')" href="../../_classes/question_display_options.html" onMouseOver="classPopup(event,'question_display_options')">question_display_options</a>::VISIBLE;
<a name="l1404"><span class="linenum">1404</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('manualcommentlink')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/manualcommentlink.html">manualcommentlink</a> = <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../mod/quiz/comment.php.html">/mod/quiz/comment.php</a>',
<a name="l1405"><span class="linenum">1405</span></a>                  array('attempt' =&gt; <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('id')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l1406"><span class="linenum">1406</span></a>      }
<a name="l1407"><span class="linenum">1407</span></a>  
<a name="l1408"><span class="linenum">1408</span></a>      if (!<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>) &amp;&amp; !<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('preview')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/preview.html">preview</a> &amp;&amp;
<a name="l1409"><span class="linenum">1409</span></a>              <a class="function" onClick="logFunction('has_capability')" href="../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('mod/quiz:viewreports', <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>) &amp;&amp;
<a name="l1410"><span class="linenum">1410</span></a>              <a class="function" onClick="logFunction('has_capability')" href="../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/grade:viewhidden', <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>)) {
<a name="l1411"><span class="linenum">1411</span></a>  <span class="comment">        // People who can see reports and hidden grades should be shown everything,</span>
<a name="l1412"><span class="linenum">1412</span></a>  <span class="comment">        // except during preview when teachers want to see what students see.</span>
<a name="l1413"><span class="linenum">1413</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('attempt')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/attempt.html">attempt</a> = <a class="class" onClick="logClass('question_display_options')" href="../../_classes/question_display_options.html" onMouseOver="classPopup(event,'question_display_options')">question_display_options</a>::VISIBLE;
<a name="l1414"><span class="linenum">1414</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('correctness')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/correctness.html">correctness</a> = <a class="class" onClick="logClass('question_display_options')" href="../../_classes/question_display_options.html" onMouseOver="classPopup(event,'question_display_options')">question_display_options</a>::VISIBLE;
<a name="l1415"><span class="linenum">1415</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('marks')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/marks.html">marks</a> = <a class="class" onClick="logClass('question_display_options')" href="../../_classes/question_display_options.html" onMouseOver="classPopup(event,'question_display_options')">question_display_options</a>::MARK_AND_MAX;
<a name="l1416"><span class="linenum">1416</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('feedback')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/feedback.html">feedback</a> = <a class="class" onClick="logClass('question_display_options')" href="../../_classes/question_display_options.html" onMouseOver="classPopup(event,'question_display_options')">question_display_options</a>::VISIBLE;
<a name="l1417"><span class="linenum">1417</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('numpartscorrect')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/numpartscorrect.html">numpartscorrect</a> = <a class="class" onClick="logClass('question_display_options')" href="../../_classes/question_display_options.html" onMouseOver="classPopup(event,'question_display_options')">question_display_options</a>::VISIBLE;
<a name="l1418"><span class="linenum">1418</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('manualcomment')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/manualcomment.html">manualcomment</a> = <a class="class" onClick="logClass('question_display_options')" href="../../_classes/question_display_options.html" onMouseOver="classPopup(event,'question_display_options')">question_display_options</a>::VISIBLE;
<a name="l1419"><span class="linenum">1419</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('generalfeedback')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/generalfeedback.html">generalfeedback</a> = <a class="class" onClick="logClass('question_display_options')" href="../../_classes/question_display_options.html" onMouseOver="classPopup(event,'question_display_options')">question_display_options</a>::VISIBLE;
<a name="l1420"><span class="linenum">1420</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('rightanswer')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/rightanswer.html">rightanswer</a> = <a class="class" onClick="logClass('question_display_options')" href="../../_classes/question_display_options.html" onMouseOver="classPopup(event,'question_display_options')">question_display_options</a>::VISIBLE;
<a name="l1421"><span class="linenum">1421</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('overallfeedback')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/overallfeedback.html">overallfeedback</a> = <a class="class" onClick="logClass('question_display_options')" href="../../_classes/question_display_options.html" onMouseOver="classPopup(event,'question_display_options')">question_display_options</a>::VISIBLE;
<a name="l1422"><span class="linenum">1422</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('history')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/history.html">history</a> = <a class="class" onClick="logClass('question_display_options')" href="../../_classes/question_display_options.html" onMouseOver="classPopup(event,'question_display_options')">question_display_options</a>::VISIBLE;
<a name="l1423"><span class="linenum">1423</span></a>  
<a name="l1424"><span class="linenum">1424</span></a>      }
<a name="l1425"><span class="linenum">1425</span></a>  
<a name="l1426"><span class="linenum">1426</span></a>      return <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>;
<a name="l1427"><span class="linenum">1427</span></a>  }
<a name="l1428"><span class="linenum">1428</span></a>  
<a name="l1429"><span class="linenum">1429</span></a>  <span class="comment">/**</span>
<a name="l1430"><span class="linenum">1430</span></a>  <span class="comment"> * Combines the review options from a number of different quiz attempts.</span>
<a name="l1431"><span class="linenum">1431</span></a>  <span class="comment"> * Returns an array of two ojects, so the suggested way of calling this</span>
<a name="l1432"><span class="linenum">1432</span></a>  <span class="comment"> * funciton is:</span>
<a name="l1433"><span class="linenum">1433</span></a>  <span class="comment"> * list($someoptions, $alloptions) = quiz_get_combined_reviewoptions(...)</span>
<a name="l1434"><span class="linenum">1434</span></a>  <span class="comment"> *</span>
<a name="l1435"><span class="linenum">1435</span></a>  <span class="comment"> * @param object $quiz the quiz instance.</span>
<a name="l1436"><span class="linenum">1436</span></a>  <span class="comment"> * @param array $attempts an array of attempt objects.</span>
<a name="l1437"><span class="linenum">1437</span></a>  <span class="comment"> *</span>
<a name="l1438"><span class="linenum">1438</span></a>  <span class="comment"> * @return array of two options objects, one showing which options are true for</span>
<a name="l1439"><span class="linenum">1439</span></a>  <span class="comment"> *          at least one of the attempts, the other showing which options are true</span>
<a name="l1440"><span class="linenum">1440</span></a>  <span class="comment"> *          for all attempts.</span>
<a name="l1441"><span class="linenum">1441</span></a>  <span class="comment"> */</span>
<a name="l1442"><span class="linenum">1442</span></a>  function <a class="function" onClick="logFunction('quiz_get_combined_reviewoptions')" href="../../_functions/quiz_get_combined_reviewoptions.html" onMouseOver="funcPopup(event,'quiz_get_combined_reviewoptions')">quiz_get_combined_reviewoptions</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a>) {
<a name="l1443"><span class="linenum">1443</span></a>      <a class="var it89" onMouseOver="hilite(89)" onMouseOut="lolite()" onClick="logVariable('fields')" href="../../_variables/fields.html">$fields</a> = array('feedback', 'generalfeedback', 'rightanswer', 'overallfeedback');
<a name="l1444"><span class="linenum">1444</span></a>      <a class="var it6229" onMouseOver="hilite(6229)" onMouseOut="lolite()" onClick="logVariable('someoptions')" href="../../_variables/someoptions.html">$someoptions</a> = new stdClass();
<a name="l1445"><span class="linenum">1445</span></a>      <a class="var it6230" onMouseOver="hilite(6230)" onMouseOut="lolite()" onClick="logVariable('alloptions')" href="../../_variables/alloptions.html">$alloptions</a> = new stdClass();
<a name="l1446"><span class="linenum">1446</span></a>      foreach (<a class="var it89" onMouseOver="hilite(89)" onMouseOut="lolite()" onClick="logVariable('fields')" href="../../_variables/fields.html">$fields</a> as <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>) {
<a name="l1447"><span class="linenum">1447</span></a>          <a class="var it6229" onMouseOver="hilite(6229)" onMouseOut="lolite()" onClick="logVariable('someoptions')" href="../../_variables/someoptions.html">$someoptions</a>-&gt;<a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = false;
<a name="l1448"><span class="linenum">1448</span></a>          <a class="var it6230" onMouseOver="hilite(6230)" onMouseOut="lolite()" onClick="logVariable('alloptions')" href="../../_variables/alloptions.html">$alloptions</a>-&gt;<a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = true;
<a name="l1449"><span class="linenum">1449</span></a>      }
<a name="l1450"><span class="linenum">1450</span></a>      <a class="var it6229" onMouseOver="hilite(6229)" onMouseOut="lolite()" onClick="logVariable('someoptions')" href="../../_variables/someoptions.html">$someoptions</a>-&gt;<a onClick="logVariable('marks')" class="var it45192" onMouseOver="hilite(45192)" onMouseOut="lolite()" href="../../_variables/marks.html">marks</a> = <a class="class" onClick="logClass('question_display_options')" href="../../_classes/question_display_options.html" onMouseOver="classPopup(event,'question_display_options')">question_display_options</a>::HIDDEN;
<a name="l1451"><span class="linenum">1451</span></a>      <a class="var it6230" onMouseOver="hilite(6230)" onMouseOut="lolite()" onClick="logVariable('alloptions')" href="../../_variables/alloptions.html">$alloptions</a>-&gt;<a onClick="logVariable('marks')" class="var it45186" onMouseOver="hilite(45186)" onMouseOut="lolite()" href="../../_variables/marks.html">marks</a> = <a class="class" onClick="logClass('question_display_options')" href="../../_classes/question_display_options.html" onMouseOver="classPopup(event,'question_display_options')">question_display_options</a>::MARK_AND_MAX;
<a name="l1452"><span class="linenum">1452</span></a>  
<a name="l1453"><span class="linenum">1453</span></a>  <span class="comment">    // This shouldn't happen, but we need to prevent reveal information.</span>
<a name="l1454"><span class="linenum">1454</span></a>      if (empty(<a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a>)) {
<a name="l1455"><span class="linenum">1455</span></a>          return array(<a class="var it6229" onMouseOver="hilite(6229)" onMouseOut="lolite()" onClick="logVariable('someoptions')" href="../../_variables/someoptions.html">$someoptions</a>, <a class="var it6229" onMouseOver="hilite(6229)" onMouseOut="lolite()" onClick="logVariable('someoptions')" href="../../_variables/someoptions.html">$someoptions</a>);
<a name="l1456"><span class="linenum">1456</span></a>      }
<a name="l1457"><span class="linenum">1457</span></a>  
<a name="l1458"><span class="linenum">1458</span></a>      foreach (<a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a> as <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>) {
<a name="l1459"><span class="linenum">1459</span></a>          <a class="var it39513" onMouseOver="hilite(39513)" onMouseOut="lolite()" onClick="logVariable('attemptoptions')" href="../../_variables/attemptoptions.html">$attemptoptions</a> = <a class="class" onClick="logClass('mod_quiz_display_options')" href="../../_classes/mod_quiz_display_options.html" onMouseOver="classPopup(event,'mod_quiz_display_options')">mod_quiz_display_options</a>::<a class="function" onClick="logFunction('make_from_quiz')" href="../../_functions/make_from_quiz.html" onMouseOver="funcPopup(event,'make_from_quiz')">make_from_quiz</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>,
<a name="l1460"><span class="linenum">1460</span></a>                  <a class="function" onClick="logFunction('quiz_attempt_state')" href="../../_functions/quiz_attempt_state.html" onMouseOver="funcPopup(event,'quiz_attempt_state')">quiz_attempt_state</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>));
<a name="l1461"><span class="linenum">1461</span></a>          foreach (<a class="var it89" onMouseOver="hilite(89)" onMouseOut="lolite()" onClick="logVariable('fields')" href="../../_variables/fields.html">$fields</a> as <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>) {
<a name="l1462"><span class="linenum">1462</span></a>              <a class="var it6229" onMouseOver="hilite(6229)" onMouseOut="lolite()" onClick="logVariable('someoptions')" href="../../_variables/someoptions.html">$someoptions</a>-&gt;<a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <a class="var it6229" onMouseOver="hilite(6229)" onMouseOut="lolite()" onClick="logVariable('someoptions')" href="../../_variables/someoptions.html">$someoptions</a>-&gt;<a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> || <a class="var it39513" onMouseOver="hilite(39513)" onMouseOut="lolite()" onClick="logVariable('attemptoptions')" href="../../_variables/attemptoptions.html">$attemptoptions</a>-&gt;<a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>;
<a name="l1463"><span class="linenum">1463</span></a>              <a class="var it6230" onMouseOver="hilite(6230)" onMouseOut="lolite()" onClick="logVariable('alloptions')" href="../../_variables/alloptions.html">$alloptions</a>-&gt;<a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> = <a class="var it6230" onMouseOver="hilite(6230)" onMouseOut="lolite()" onClick="logVariable('alloptions')" href="../../_variables/alloptions.html">$alloptions</a>-&gt;<a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a> &amp;&amp; <a class="var it39513" onMouseOver="hilite(39513)" onMouseOut="lolite()" onClick="logVariable('attemptoptions')" href="../../_variables/attemptoptions.html">$attemptoptions</a>-&gt;<a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../_variables/field.html">$field</a>;
<a name="l1464"><span class="linenum">1464</span></a>          }
<a name="l1465"><span class="linenum">1465</span></a>          <a class="var it6229" onMouseOver="hilite(6229)" onMouseOut="lolite()" onClick="logVariable('someoptions')" href="../../_variables/someoptions.html">$someoptions</a>-&gt;<a onClick="logVariable('marks')" class="var it45192" onMouseOver="hilite(45192)" onMouseOut="lolite()" href="../../_variables/marks.html">marks</a> = <a class="phpfunction" onClick="logFunction('max')" href="../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">max</a>(<a class="var it6229" onMouseOver="hilite(6229)" onMouseOut="lolite()" onClick="logVariable('someoptions')" href="../../_variables/someoptions.html">$someoptions</a>-&gt;<a onClick="logVariable('marks')" class="var it45192" onMouseOver="hilite(45192)" onMouseOut="lolite()" href="../../_variables/marks.html">marks</a>, <a class="var it39513" onMouseOver="hilite(39513)" onMouseOut="lolite()" onClick="logVariable('attemptoptions')" href="../../_variables/attemptoptions.html">$attemptoptions</a>-&gt;<a onClick="logVariable('marks')" class="var it45193" onMouseOver="hilite(45193)" onMouseOut="lolite()" href="../../_variables/marks.html">marks</a>);
<a name="l1466"><span class="linenum">1466</span></a>          <a class="var it6230" onMouseOver="hilite(6230)" onMouseOut="lolite()" onClick="logVariable('alloptions')" href="../../_variables/alloptions.html">$alloptions</a>-&gt;<a onClick="logVariable('marks')" class="var it45186" onMouseOver="hilite(45186)" onMouseOut="lolite()" href="../../_variables/marks.html">marks</a> = <a class="phpfunction" onClick="logFunction('min')" href="../../_functions/min.html" onMouseOver="phpfuncPopup(event,'min')">min</a>(<a class="var it6230" onMouseOver="hilite(6230)" onMouseOut="lolite()" onClick="logVariable('alloptions')" href="../../_variables/alloptions.html">$alloptions</a>-&gt;<a onClick="logVariable('marks')" class="var it45186" onMouseOver="hilite(45186)" onMouseOut="lolite()" href="../../_variables/marks.html">marks</a>, <a class="var it39513" onMouseOver="hilite(39513)" onMouseOut="lolite()" onClick="logVariable('attemptoptions')" href="../../_variables/attemptoptions.html">$attemptoptions</a>-&gt;<a onClick="logVariable('marks')" class="var it45193" onMouseOver="hilite(45193)" onMouseOut="lolite()" href="../../_variables/marks.html">marks</a>);
<a name="l1467"><span class="linenum">1467</span></a>      }
<a name="l1468"><span class="linenum">1468</span></a>      return array(<a class="var it6229" onMouseOver="hilite(6229)" onMouseOut="lolite()" onClick="logVariable('someoptions')" href="../../_variables/someoptions.html">$someoptions</a>, <a class="var it6230" onMouseOver="hilite(6230)" onMouseOut="lolite()" onClick="logVariable('alloptions')" href="../../_variables/alloptions.html">$alloptions</a>);
<a name="l1469"><span class="linenum">1469</span></a>  }
<a name="l1470"><span class="linenum">1470</span></a>  
<a name="l1471"><span class="linenum">1471</span></a>  <span class="comment">// Functions for sending notification messages /////////////////////////////////</span>
<a name="l1472"><span class="linenum">1472</span></a>  
<a name="l1473"><span class="linenum">1473</span></a>  <span class="comment">/**</span>
<a name="l1474"><span class="linenum">1474</span></a>  <span class="comment"> * Sends a confirmation message to the student confirming that the attempt was processed.</span>
<a name="l1475"><span class="linenum">1475</span></a>  <span class="comment"> *</span>
<a name="l1476"><span class="linenum">1476</span></a>  <span class="comment"> * @param object $a lots of useful information that can be used in the message</span>
<a name="l1477"><span class="linenum">1477</span></a>  <span class="comment"> *      subject and body.</span>
<a name="l1478"><span class="linenum">1478</span></a>  <span class="comment"> *</span>
<a name="l1479"><span class="linenum">1479</span></a>  <span class="comment"> * @return int|false as for {@link message_send()}.</span>
<a name="l1480"><span class="linenum">1480</span></a>  <span class="comment"> */</span>
<a name="l1481"><span class="linenum">1481</span></a>  function <a class="function" onClick="logFunction('quiz_send_confirmation')" href="../../_functions/quiz_send_confirmation.html" onMouseOver="funcPopup(event,'quiz_send_confirmation')">quiz_send_confirmation</a>(<a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>, <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>) {
<a name="l1482"><span class="linenum">1482</span></a>  
<a name="l1483"><span class="linenum">1483</span></a>  <span class="comment">    // Add information about the recipient to $a.</span>
<a name="l1484"><span class="linenum">1484</span></a>  <span class="comment">    // Don't do idnumber. we want idnumber to be the submitter's idnumber.</span>
<a name="l1485"><span class="linenum">1485</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('username')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>     = <a class="function" onClick="logFunction('fullname')" href="../../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>);
<a name="l1486"><span class="linenum">1486</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('userusername')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/userusername.html">userusername</a> = <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>-&gt;<a onClick="logVariable('username')" class="var it44820" onMouseOver="hilite(44820)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>;
<a name="l1487"><span class="linenum">1487</span></a>  
<a name="l1488"><span class="linenum">1488</span></a>  <span class="comment">    // Prepare the message.</span>
<a name="l1489"><span class="linenum">1489</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a> = new stdClass();
<a name="l1490"><span class="linenum">1490</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('component')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/component.html">component</a>         = 'mod_quiz';
<a name="l1491"><span class="linenum">1491</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('name')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>              = 'confirmation';
<a name="l1492"><span class="linenum">1492</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('notification')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/notification.html">notification</a>      = 1;
<a name="l1493"><span class="linenum">1493</span></a>  
<a name="l1494"><span class="linenum">1494</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('userfrom')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/userfrom.html">userfrom</a>          = <a class="class" onClick="logClass('core_user')" href="../../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('get_noreply_user')" href="../../_functions/get_noreply_user.html" onMouseOver="funcPopup(event,'get_noreply_user')">get_noreply_user</a>();
<a name="l1495"><span class="linenum">1495</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('userto')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/userto.html">userto</a>            = <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>;
<a name="l1496"><span class="linenum">1496</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('subject')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/subject.html">subject</a>           = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailconfirmsubject', 'quiz', <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>);
<a name="l1497"><span class="linenum">1497</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('fullmessage')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/fullmessage.html">fullmessage</a>       = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailconfirmbody', 'quiz', <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>);
<a name="l1498"><span class="linenum">1498</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('fullmessageformat')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/fullmessageformat.html">fullmessageformat</a> = <a class="constant" onClick="logConstant('FORMAT_PLAIN')" href="../../_constants/FORMAT_PLAIN.html" onMouseOver="constPopup(event,'FORMAT_PLAIN')">FORMAT_PLAIN</a>;
<a name="l1499"><span class="linenum">1499</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('fullmessagehtml')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/fullmessagehtml.html">fullmessagehtml</a>   = '';
<a name="l1500"><span class="linenum">1500</span></a>  
<a name="l1501"><span class="linenum">1501</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('smallmessage')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/smallmessage.html">smallmessage</a>      = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailconfirmsmall', 'quiz', <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>);
<a name="l1502"><span class="linenum">1502</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('contexturl')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/contexturl.html">contexturl</a>        = <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('quizurl')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/quizurl.html">quizurl</a>;
<a name="l1503"><span class="linenum">1503</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('contexturlname')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/contexturlname.html">contexturlname</a>    = <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('quizname')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/quizname.html">quizname</a>;
<a name="l1504"><span class="linenum">1504</span></a>  
<a name="l1505"><span class="linenum">1505</span></a>  <span class="comment">    // ... and send it.</span>
<a name="l1506"><span class="linenum">1506</span></a>      return <a class="function" onClick="logFunction('message_send')" href="../../_functions/message_send.html" onMouseOver="funcPopup(event,'message_send')">message_send</a>(<a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>);
<a name="l1507"><span class="linenum">1507</span></a>  }
<a name="l1508"><span class="linenum">1508</span></a>  
<a name="l1509"><span class="linenum">1509</span></a>  <span class="comment">/**</span>
<a name="l1510"><span class="linenum">1510</span></a>  <span class="comment"> * Sends notification messages to the interested parties that assign the role capability</span>
<a name="l1511"><span class="linenum">1511</span></a>  <span class="comment"> *</span>
<a name="l1512"><span class="linenum">1512</span></a>  <span class="comment"> * @param object $recipient user object of the intended recipient</span>
<a name="l1513"><span class="linenum">1513</span></a>  <span class="comment"> * @param object $a associative array of replaceable fields for the templates</span>
<a name="l1514"><span class="linenum">1514</span></a>  <span class="comment"> *</span>
<a name="l1515"><span class="linenum">1515</span></a>  <span class="comment"> * @return int|false as for {@link message_send()}.</span>
<a name="l1516"><span class="linenum">1516</span></a>  <span class="comment"> */</span>
<a name="l1517"><span class="linenum">1517</span></a>  function <a class="function" onClick="logFunction('quiz_send_notification')" href="../../_functions/quiz_send_notification.html" onMouseOver="funcPopup(event,'quiz_send_notification')">quiz_send_notification</a>(<a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>, <a class="var it41447" onMouseOver="hilite(41447)" onMouseOut="lolite()" onClick="logVariable('submitter')" href="../../_variables/submitter.html">$submitter</a>, <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>) {
<a name="l1518"><span class="linenum">1518</span></a>  
<a name="l1519"><span class="linenum">1519</span></a>  <span class="comment">    // Recipient info for template.</span>
<a name="l1520"><span class="linenum">1520</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('useridnumber')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/useridnumber.html">useridnumber</a> = <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>-&gt;<a onClick="logVariable('idnumber')" class="var it44820" onMouseOver="hilite(44820)" onMouseOut="lolite()" href="../../_variables/idnumber.html">idnumber</a>;
<a name="l1521"><span class="linenum">1521</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('username')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>     = <a class="function" onClick="logFunction('fullname')" href="../../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>);
<a name="l1522"><span class="linenum">1522</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('userusername')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/userusername.html">userusername</a> = <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>-&gt;<a onClick="logVariable('username')" class="var it44820" onMouseOver="hilite(44820)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>;
<a name="l1523"><span class="linenum">1523</span></a>  
<a name="l1524"><span class="linenum">1524</span></a>  <span class="comment">    // Prepare the message.</span>
<a name="l1525"><span class="linenum">1525</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a> = new stdClass();
<a name="l1526"><span class="linenum">1526</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('component')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/component.html">component</a>         = 'mod_quiz';
<a name="l1527"><span class="linenum">1527</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('name')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>              = 'submission';
<a name="l1528"><span class="linenum">1528</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('notification')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/notification.html">notification</a>      = 1;
<a name="l1529"><span class="linenum">1529</span></a>  
<a name="l1530"><span class="linenum">1530</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('userfrom')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/userfrom.html">userfrom</a>          = <a class="var it41447" onMouseOver="hilite(41447)" onMouseOut="lolite()" onClick="logVariable('submitter')" href="../../_variables/submitter.html">$submitter</a>;
<a name="l1531"><span class="linenum">1531</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('userto')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/userto.html">userto</a>            = <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>;
<a name="l1532"><span class="linenum">1532</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('subject')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/subject.html">subject</a>           = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailnotifysubject', 'quiz', <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>);
<a name="l1533"><span class="linenum">1533</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('fullmessage')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/fullmessage.html">fullmessage</a>       = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailnotifybody', 'quiz', <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>);
<a name="l1534"><span class="linenum">1534</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('fullmessageformat')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/fullmessageformat.html">fullmessageformat</a> = <a class="constant" onClick="logConstant('FORMAT_PLAIN')" href="../../_constants/FORMAT_PLAIN.html" onMouseOver="constPopup(event,'FORMAT_PLAIN')">FORMAT_PLAIN</a>;
<a name="l1535"><span class="linenum">1535</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('fullmessagehtml')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/fullmessagehtml.html">fullmessagehtml</a>   = '';
<a name="l1536"><span class="linenum">1536</span></a>  
<a name="l1537"><span class="linenum">1537</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('smallmessage')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/smallmessage.html">smallmessage</a>      = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailnotifysmall', 'quiz', <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>);
<a name="l1538"><span class="linenum">1538</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('contexturl')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/contexturl.html">contexturl</a>        = <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('quizreviewurl')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/quizreviewurl.html">quizreviewurl</a>;
<a name="l1539"><span class="linenum">1539</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('contexturlname')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/contexturlname.html">contexturlname</a>    = <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('quizname')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/quizname.html">quizname</a>;
<a name="l1540"><span class="linenum">1540</span></a>  
<a name="l1541"><span class="linenum">1541</span></a>  <span class="comment">    // ... and send it.</span>
<a name="l1542"><span class="linenum">1542</span></a>      return <a class="function" onClick="logFunction('message_send')" href="../../_functions/message_send.html" onMouseOver="funcPopup(event,'message_send')">message_send</a>(<a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>);
<a name="l1543"><span class="linenum">1543</span></a>  }
<a name="l1544"><span class="linenum">1544</span></a>  
<a name="l1545"><span class="linenum">1545</span></a>  <span class="comment">/**</span>
<a name="l1546"><span class="linenum">1546</span></a>  <span class="comment"> * Send all the requried messages when a quiz attempt is submitted.</span>
<a name="l1547"><span class="linenum">1547</span></a>  <span class="comment"> *</span>
<a name="l1548"><span class="linenum">1548</span></a>  <span class="comment"> * @param object $course the course</span>
<a name="l1549"><span class="linenum">1549</span></a>  <span class="comment"> * @param object $quiz the quiz</span>
<a name="l1550"><span class="linenum">1550</span></a>  <span class="comment"> * @param object $attempt this attempt just finished</span>
<a name="l1551"><span class="linenum">1551</span></a>  <span class="comment"> * @param object $context the quiz context</span>
<a name="l1552"><span class="linenum">1552</span></a>  <span class="comment"> * @param object $cm the coursemodule for this quiz</span>
<a name="l1553"><span class="linenum">1553</span></a>  <span class="comment"> *</span>
<a name="l1554"><span class="linenum">1554</span></a>  <span class="comment"> * @return bool true if all necessary messages were sent successfully, else false.</span>
<a name="l1555"><span class="linenum">1555</span></a>  <span class="comment"> */</span>
<a name="l1556"><span class="linenum">1556</span></a>  function <a class="function" onClick="logFunction('quiz_send_notification_messages')" href="../../_functions/quiz_send_notification_messages.html" onMouseOver="funcPopup(event,'quiz_send_notification_messages')">quiz_send_notification_messages</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>) {
<a name="l1557"><span class="linenum">1557</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1558"><span class="linenum">1558</span></a>  
<a name="l1559"><span class="linenum">1559</span></a>  <span class="comment">    // Do nothing if required objects not present.</span>
<a name="l1560"><span class="linenum">1560</span></a>      if (empty(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>) or empty(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>) or empty(<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>) or empty(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>)) {
<a name="l1561"><span class="linenum">1561</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> and <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a> must all be set.');
<a name="l1562"><span class="linenum">1562</span></a>      }
<a name="l1563"><span class="linenum">1563</span></a>  
<a name="l1564"><span class="linenum">1564</span></a>      <a class="var it41447" onMouseOver="hilite(41447)" onMouseOut="lolite()" onClick="logVariable('submitter')" href="../../_variables/submitter.html">$submitter</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user', array('id' =&gt; <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('userid')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>), '*', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l1565"><span class="linenum">1565</span></a>  
<a name="l1566"><span class="linenum">1566</span></a>  <span class="comment">    // Check for confirmation required.</span>
<a name="l1567"><span class="linenum">1567</span></a>      <a class="var it41448" onMouseOver="hilite(41448)" onMouseOut="lolite()" onClick="logVariable('sendconfirm')" href="../../_variables/sendconfirm.html">$sendconfirm</a> = false;
<a name="l1568"><span class="linenum">1568</span></a>      <a class="var it41449" onMouseOver="hilite(41449)" onMouseOut="lolite()" onClick="logVariable('notifyexcludeusers')" href="../../_variables/notifyexcludeusers.html">$notifyexcludeusers</a> = '';
<a name="l1569"><span class="linenum">1569</span></a>      if (<a class="function" onClick="logFunction('has_capability')" href="../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('mod/quiz:emailconfirmsubmission', <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>, <a class="var it41447" onMouseOver="hilite(41447)" onMouseOut="lolite()" onClick="logVariable('submitter')" href="../../_variables/submitter.html">$submitter</a>, false)) {
<a name="l1570"><span class="linenum">1570</span></a>          <a class="var it41449" onMouseOver="hilite(41449)" onMouseOut="lolite()" onClick="logVariable('notifyexcludeusers')" href="../../_variables/notifyexcludeusers.html">$notifyexcludeusers</a> = <a class="var it41447" onMouseOver="hilite(41447)" onMouseOut="lolite()" onClick="logVariable('submitter')" href="../../_variables/submitter.html">$submitter</a>-&gt;<a onClick="logVariable('id')" class="var it45194" onMouseOver="hilite(45194)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l1571"><span class="linenum">1571</span></a>          <a class="var it41448" onMouseOver="hilite(41448)" onMouseOut="lolite()" onClick="logVariable('sendconfirm')" href="../../_variables/sendconfirm.html">$sendconfirm</a> = true;
<a name="l1572"><span class="linenum">1572</span></a>      }
<a name="l1573"><span class="linenum">1573</span></a>  
<a name="l1574"><span class="linenum">1574</span></a>  <span class="comment">    // Check for notifications required.</span>
<a name="l1575"><span class="linenum">1575</span></a>      <a class="var it41450" onMouseOver="hilite(41450)" onMouseOut="lolite()" onClick="logVariable('notifyfields')" href="../../_variables/notifyfields.html">$notifyfields</a> = 'u.id, u.username, u.idnumber, u.email, u.emailstop, u.lang,
<a name="l1576"><span class="linenum">1576</span></a>              u.timezone, u.mailformat, u.maildisplay, u.auth, u.suspended, u.deleted, ';
<a name="l1577"><span class="linenum">1577</span></a>      <a class="var it41450" onMouseOver="hilite(41450)" onMouseOut="lolite()" onClick="logVariable('notifyfields')" href="../../_variables/notifyfields.html">$notifyfields</a> .= <a class="function" onClick="logFunction('get_all_user_name_fields')" href="../../_functions/get_all_user_name_fields.html" onMouseOver="funcPopup(event,'get_all_user_name_fields')">get_all_user_name_fields</a>(true, 'u');
<a name="l1578"><span class="linenum">1578</span></a>      <a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('groups')" href="../../_variables/groups.html">$groups</a> = <a class="function" onClick="logFunction('groups_get_all_groups')" href="../../_functions/groups_get_all_groups.html" onMouseOver="funcPopup(event,'groups_get_all_groups')">groups_get_all_groups</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it41447" onMouseOver="hilite(41447)" onMouseOut="lolite()" onClick="logVariable('submitter')" href="../../_variables/submitter.html">$submitter</a>-&gt;<a onClick="logVariable('id')" class="var it45194" onMouseOver="hilite(45194)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('groupingid')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/groupingid.html">groupingid</a>);
<a name="l1579"><span class="linenum">1579</span></a>      if (<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('groups')" href="../../_variables/groups.html">$groups</a>) &amp;&amp; <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('groups')" href="../../_variables/groups.html">$groups</a>) &gt; 0) {
<a name="l1580"><span class="linenum">1580</span></a>          <a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('groups')" href="../../_variables/groups.html">$groups</a> = <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('groups')" href="../../_variables/groups.html">$groups</a>);
<a name="l1581"><span class="linenum">1581</span></a>      } else if (<a class="function" onClick="logFunction('groups_get_activity_groupmode')" href="../../_functions/groups_get_activity_groupmode.html" onMouseOver="funcPopup(event,'groups_get_activity_groupmode')">groups_get_activity_groupmode</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>) != <a class="constant" onClick="logConstant('NOGROUPS')" href="../../_constants/NOGROUPS.html" onMouseOver="constPopup(event,'NOGROUPS')">NOGROUPS</a>) {
<a name="l1582"><span class="linenum">1582</span></a>  <span class="comment">        // If the user is not in a group, and the quiz is set to group mode,</span>
<a name="l1583"><span class="linenum">1583</span></a>  <span class="comment">        // then set $groups to a non-existant id so that only users with</span>
<a name="l1584"><span class="linenum">1584</span></a>  <span class="comment">        // 'moodle/site:accessallgroups' get notified.</span>
<a name="l1585"><span class="linenum">1585</span></a>          <a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('groups')" href="../../_variables/groups.html">$groups</a> = -1;
<a name="l1586"><span class="linenum">1586</span></a>      } else {
<a name="l1587"><span class="linenum">1587</span></a>          <a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('groups')" href="../../_variables/groups.html">$groups</a> = '';
<a name="l1588"><span class="linenum">1588</span></a>      }
<a name="l1589"><span class="linenum">1589</span></a>      <a class="var it41451" onMouseOver="hilite(41451)" onMouseOut="lolite()" onClick="logVariable('userstonotify')" href="../../_variables/userstonotify.html">$userstonotify</a> = <a class="function" onClick="logFunction('get_users_by_capability')" href="../../_functions/get_users_by_capability.html" onMouseOver="funcPopup(event,'get_users_by_capability')">get_users_by_capability</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>, 'mod/quiz:emailnotifysubmission',
<a name="l1590"><span class="linenum">1590</span></a>              <a class="var it41450" onMouseOver="hilite(41450)" onMouseOut="lolite()" onClick="logVariable('notifyfields')" href="../../_variables/notifyfields.html">$notifyfields</a>, '', '', '', <a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('groups')" href="../../_variables/groups.html">$groups</a>, <a class="var it41449" onMouseOver="hilite(41449)" onMouseOut="lolite()" onClick="logVariable('notifyexcludeusers')" href="../../_variables/notifyexcludeusers.html">$notifyexcludeusers</a>, false, false, true);
<a name="l1591"><span class="linenum">1591</span></a>  
<a name="l1592"><span class="linenum">1592</span></a>      if (empty(<a class="var it41451" onMouseOver="hilite(41451)" onMouseOut="lolite()" onClick="logVariable('userstonotify')" href="../../_variables/userstonotify.html">$userstonotify</a>) &amp;&amp; !<a class="var it41448" onMouseOver="hilite(41448)" onMouseOut="lolite()" onClick="logVariable('sendconfirm')" href="../../_variables/sendconfirm.html">$sendconfirm</a>) {
<a name="l1593"><span class="linenum">1593</span></a>          return true; <span class="comment">// Nothing to do.</span>
<a name="l1594"><span class="linenum">1594</span></a>      }
<a name="l1595"><span class="linenum">1595</span></a>  
<a name="l1596"><span class="linenum">1596</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a> = new stdClass();
<a name="l1597"><span class="linenum">1597</span></a>  <span class="comment">    // Course info.</span>
<a name="l1598"><span class="linenum">1598</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('coursename')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/coursename.html">coursename</a>      = <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('fullname')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/fullname.html">fullname</a>;
<a name="l1599"><span class="linenum">1599</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('courseshortname')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/courseshortname.html">courseshortname</a> = <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('shortname')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/shortname.html">shortname</a>;
<a name="l1600"><span class="linenum">1600</span></a>  <span class="comment">    // Quiz info.</span>
<a name="l1601"><span class="linenum">1601</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('quizname')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/quizname.html">quizname</a>        = <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('name')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>;
<a name="l1602"><span class="linenum">1602</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('quizreporturl')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/quizreporturl.html">quizreporturl</a>   = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a> . '/mod/quiz/report.php?id=' . <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l1603"><span class="linenum">1603</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('quizreportlink')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/quizreportlink.html">quizreportlink</a>  = '&lt;a href=&quot;' . <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('quizreporturl')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/quizreporturl.html">quizreporturl</a> . '&quot;&gt;' .
<a name="l1604"><span class="linenum">1604</span></a>              <a class="function" onClick="logFunction('format_string')" href="../../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('name')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>) . ' report&lt;/a&gt;';
<a name="l1605"><span class="linenum">1605</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('quizurl')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/quizurl.html">quizurl</a>         = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a> . '/mod/quiz/view.php?id=' . <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l1606"><span class="linenum">1606</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('quizlink')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/quizlink.html">quizlink</a>        = '&lt;a href=&quot;' . <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('quizurl')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/quizurl.html">quizurl</a> . '&quot;&gt;' . <a class="function" onClick="logFunction('format_string')" href="../../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('name')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>) . '&lt;/a&gt;';
<a name="l1607"><span class="linenum">1607</span></a>  <span class="comment">    // Attempt info.</span>
<a name="l1608"><span class="linenum">1608</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('submissiontime')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/submissiontime.html">submissiontime</a>  = <a class="function" onClick="logFunction('userdate')" href="../../_functions/userdate.html" onMouseOver="funcPopup(event,'userdate')">userdate</a>(<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('timefinish')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/timefinish.html">timefinish</a>);
<a name="l1609"><span class="linenum">1609</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('timetaken')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/timetaken.html">timetaken</a>       = <a class="function" onClick="logFunction('format_time')" href="../../_functions/format_time.html" onMouseOver="funcPopup(event,'format_time')">format_time</a>(<a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('timefinish')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/timefinish.html">timefinish</a> - <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('timestart')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/timestart.html">timestart</a>);
<a name="l1610"><span class="linenum">1610</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('quizreviewurl')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/quizreviewurl.html">quizreviewurl</a>   = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a> . '/mod/quiz/review.php?attempt=' . <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('id')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l1611"><span class="linenum">1611</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('quizreviewlink')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/quizreviewlink.html">quizreviewlink</a>  = '&lt;a href=&quot;' . <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('quizreviewurl')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/quizreviewurl.html">quizreviewurl</a> . '&quot;&gt;' .
<a name="l1612"><span class="linenum">1612</span></a>              <a class="function" onClick="logFunction('format_string')" href="../../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('name')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>) . ' review&lt;/a&gt;';
<a name="l1613"><span class="linenum">1613</span></a>  <span class="comment">    // Student who sat the quiz info.</span>
<a name="l1614"><span class="linenum">1614</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('studentidnumber')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/studentidnumber.html">studentidnumber</a> = <a class="var it41447" onMouseOver="hilite(41447)" onMouseOut="lolite()" onClick="logVariable('submitter')" href="../../_variables/submitter.html">$submitter</a>-&gt;<a onClick="logVariable('idnumber')" class="var it45194" onMouseOver="hilite(45194)" onMouseOut="lolite()" href="../../_variables/idnumber.html">idnumber</a>;
<a name="l1615"><span class="linenum">1615</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('studentname')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/studentname.html">studentname</a>     = <a class="function" onClick="logFunction('fullname')" href="../../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it41447" onMouseOver="hilite(41447)" onMouseOut="lolite()" onClick="logVariable('submitter')" href="../../_variables/submitter.html">$submitter</a>);
<a name="l1616"><span class="linenum">1616</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('studentusername')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/studentusername.html">studentusername</a> = <a class="var it41447" onMouseOver="hilite(41447)" onMouseOut="lolite()" onClick="logVariable('submitter')" href="../../_variables/submitter.html">$submitter</a>-&gt;<a onClick="logVariable('username')" class="var it45194" onMouseOver="hilite(45194)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>;
<a name="l1617"><span class="linenum">1617</span></a>  
<a name="l1618"><span class="linenum">1618</span></a>      <a class="var it41458" onMouseOver="hilite(41458)" onMouseOut="lolite()" onClick="logVariable('allok')" href="../../_variables/allok.html">$allok</a> = true;
<a name="l1619"><span class="linenum">1619</span></a>  
<a name="l1620"><span class="linenum">1620</span></a>  <span class="comment">    // Send notifications if required.</span>
<a name="l1621"><span class="linenum">1621</span></a>      if (!empty(<a class="var it41451" onMouseOver="hilite(41451)" onMouseOut="lolite()" onClick="logVariable('userstonotify')" href="../../_variables/userstonotify.html">$userstonotify</a>)) {
<a name="l1622"><span class="linenum">1622</span></a>          foreach (<a class="var it41451" onMouseOver="hilite(41451)" onMouseOut="lolite()" onClick="logVariable('userstonotify')" href="../../_variables/userstonotify.html">$userstonotify</a> as <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>) {
<a name="l1623"><span class="linenum">1623</span></a>              <a class="var it41458" onMouseOver="hilite(41458)" onMouseOut="lolite()" onClick="logVariable('allok')" href="../../_variables/allok.html">$allok</a> = <a class="var it41458" onMouseOver="hilite(41458)" onMouseOut="lolite()" onClick="logVariable('allok')" href="../../_variables/allok.html">$allok</a> &amp;&amp; <a class="function" onClick="logFunction('quiz_send_notification')" href="../../_functions/quiz_send_notification.html" onMouseOver="funcPopup(event,'quiz_send_notification')">quiz_send_notification</a>(<a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>, <a class="var it41447" onMouseOver="hilite(41447)" onMouseOut="lolite()" onClick="logVariable('submitter')" href="../../_variables/submitter.html">$submitter</a>, <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>);
<a name="l1624"><span class="linenum">1624</span></a>          }
<a name="l1625"><span class="linenum">1625</span></a>      }
<a name="l1626"><span class="linenum">1626</span></a>  
<a name="l1627"><span class="linenum">1627</span></a>  <span class="comment">    // Send confirmation if required. We send the student confirmation last, so</span>
<a name="l1628"><span class="linenum">1628</span></a>  <span class="comment">    // that if message sending is being intermittently buggy, which means we send</span>
<a name="l1629"><span class="linenum">1629</span></a>  <span class="comment">    // some but not all messages, and then try again later, then teachers may get</span>
<a name="l1630"><span class="linenum">1630</span></a>  <span class="comment">    // duplicate messages, but the student will always get exactly one.</span>
<a name="l1631"><span class="linenum">1631</span></a>      if (<a class="var it41448" onMouseOver="hilite(41448)" onMouseOut="lolite()" onClick="logVariable('sendconfirm')" href="../../_variables/sendconfirm.html">$sendconfirm</a>) {
<a name="l1632"><span class="linenum">1632</span></a>          <a class="var it41458" onMouseOver="hilite(41458)" onMouseOut="lolite()" onClick="logVariable('allok')" href="../../_variables/allok.html">$allok</a> = <a class="var it41458" onMouseOver="hilite(41458)" onMouseOut="lolite()" onClick="logVariable('allok')" href="../../_variables/allok.html">$allok</a> &amp;&amp; <a class="function" onClick="logFunction('quiz_send_confirmation')" href="../../_functions/quiz_send_confirmation.html" onMouseOver="funcPopup(event,'quiz_send_confirmation')">quiz_send_confirmation</a>(<a class="var it41447" onMouseOver="hilite(41447)" onMouseOut="lolite()" onClick="logVariable('submitter')" href="../../_variables/submitter.html">$submitter</a>, <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>);
<a name="l1633"><span class="linenum">1633</span></a>      }
<a name="l1634"><span class="linenum">1634</span></a>  
<a name="l1635"><span class="linenum">1635</span></a>      return <a class="var it41458" onMouseOver="hilite(41458)" onMouseOut="lolite()" onClick="logVariable('allok')" href="../../_variables/allok.html">$allok</a>;
<a name="l1636"><span class="linenum">1636</span></a>  }
<a name="l1637"><span class="linenum">1637</span></a>  
<a name="l1638"><span class="linenum">1638</span></a>  <span class="comment">/**</span>
<a name="l1639"><span class="linenum">1639</span></a>  <span class="comment"> * Send the notification message when a quiz attempt becomes overdue.</span>
<a name="l1640"><span class="linenum">1640</span></a>  <span class="comment"> *</span>
<a name="l1641"><span class="linenum">1641</span></a>  <span class="comment"> * @param quiz_attempt $attemptobj all the data about the quiz attempt.</span>
<a name="l1642"><span class="linenum">1642</span></a>  <span class="comment"> */</span>
<a name="l1643"><span class="linenum">1643</span></a>  function <a class="function" onClick="logFunction('quiz_send_overdue_message')" href="../../_functions/quiz_send_overdue_message.html" onMouseOver="funcPopup(event,'quiz_send_overdue_message')">quiz_send_overdue_message</a>(<a class="var it5049" onMouseOver="hilite(5049)" onMouseOut="lolite()" onClick="logVariable('attemptobj')" href="../../_variables/attemptobj.html">$attemptobj</a>) {
<a name="l1644"><span class="linenum">1644</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1645"><span class="linenum">1645</span></a>  
<a name="l1646"><span class="linenum">1646</span></a>      <a class="var it41447" onMouseOver="hilite(41447)" onMouseOut="lolite()" onClick="logVariable('submitter')" href="../../_variables/submitter.html">$submitter</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user', array('id' =&gt; <a class="var it5049" onMouseOver="hilite(5049)" onMouseOut="lolite()" onClick="logVariable('attemptobj')" href="../../_variables/attemptobj.html">$attemptobj</a>-&gt;<a class="function" onClick="logFunction('get_userid')" href="../../_functions/get_userid.html" onMouseOver="funcPopup(event,'get_userid')">get_userid</a>()), '*', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l1647"><span class="linenum">1647</span></a>  
<a name="l1648"><span class="linenum">1648</span></a>      if (!<a class="var it5049" onMouseOver="hilite(5049)" onMouseOut="lolite()" onClick="logVariable('attemptobj')" href="../../_variables/attemptobj.html">$attemptobj</a>-&gt;<a class="function" onClick="logFunction('has_capability')" href="../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('mod/quiz:emailwarnoverdue', <a class="var it41447" onMouseOver="hilite(41447)" onMouseOut="lolite()" onClick="logVariable('submitter')" href="../../_variables/submitter.html">$submitter</a>-&gt;<a onClick="logVariable('id')" class="var it45194" onMouseOver="hilite(45194)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, false)) {
<a name="l1649"><span class="linenum">1649</span></a>          return; <span class="comment">// Message not required.</span>
<a name="l1650"><span class="linenum">1650</span></a>      }
<a name="l1651"><span class="linenum">1651</span></a>  
<a name="l1652"><span class="linenum">1652</span></a>      if (!<a class="var it5049" onMouseOver="hilite(5049)" onMouseOut="lolite()" onClick="logVariable('attemptobj')" href="../../_variables/attemptobj.html">$attemptobj</a>-&gt;<a class="function" onClick="logFunction('has_response_to_at_least_one_graded_question')" href="../../_functions/has_response_to_at_least_one_graded_question.html" onMouseOver="funcPopup(event,'has_response_to_at_least_one_graded_question')">has_response_to_at_least_one_graded_question</a>()) {
<a name="l1653"><span class="linenum">1653</span></a>          return; <span class="comment">// Message not required.</span>
<a name="l1654"><span class="linenum">1654</span></a>      }
<a name="l1655"><span class="linenum">1655</span></a>  
<a name="l1656"><span class="linenum">1656</span></a>  <span class="comment">    // Prepare lots of useful information that admins might want to include in</span>
<a name="l1657"><span class="linenum">1657</span></a>  <span class="comment">    // the email message.</span>
<a name="l1658"><span class="linenum">1658</span></a>      <a class="var it521" onMouseOver="hilite(521)" onMouseOut="lolite()" onClick="logVariable('quizname')" href="../../_variables/quizname.html">$quizname</a> = <a class="function" onClick="logFunction('format_string')" href="../../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it5049" onMouseOver="hilite(5049)" onMouseOut="lolite()" onClick="logVariable('attemptobj')" href="../../_variables/attemptobj.html">$attemptobj</a>-&gt;<a class="function" onClick="logFunction('get_quiz_name')" href="../../_functions/get_quiz_name.html" onMouseOver="funcPopup(event,'get_quiz_name')">get_quiz_name</a>());
<a name="l1659"><span class="linenum">1659</span></a>  
<a name="l1660"><span class="linenum">1660</span></a>      <a class="var it18273" onMouseOver="hilite(18273)" onMouseOut="lolite()" onClick="logVariable('deadlines')" href="../../_variables/deadlines.html">$deadlines</a> = array();
<a name="l1661"><span class="linenum">1661</span></a>      if (<a class="var it5049" onMouseOver="hilite(5049)" onMouseOut="lolite()" onClick="logVariable('attemptobj')" href="../../_variables/attemptobj.html">$attemptobj</a>-&gt;<a class="function" onClick="logFunction('get_quiz')" href="../../_functions/get_quiz.html" onMouseOver="funcPopup(event,'get_quiz')">get_quiz</a>()-&gt;timelimit) {
<a name="l1662"><span class="linenum">1662</span></a>          <a class="var it18273" onMouseOver="hilite(18273)" onMouseOut="lolite()" onClick="logVariable('deadlines')" href="../../_variables/deadlines.html">$deadlines</a>[] = <a class="var it5049" onMouseOver="hilite(5049)" onMouseOut="lolite()" onClick="logVariable('attemptobj')" href="../../_variables/attemptobj.html">$attemptobj</a>-&gt;<a class="function" onClick="logFunction('get_attempt')" href="../../_functions/get_attempt.html" onMouseOver="funcPopup(event,'get_attempt')">get_attempt</a>()-&gt;timestart + <a class="var it5049" onMouseOver="hilite(5049)" onMouseOut="lolite()" onClick="logVariable('attemptobj')" href="../../_variables/attemptobj.html">$attemptobj</a>-&gt;<a class="function" onClick="logFunction('get_quiz')" href="../../_functions/get_quiz.html" onMouseOver="funcPopup(event,'get_quiz')">get_quiz</a>()-&gt;timelimit;
<a name="l1663"><span class="linenum">1663</span></a>      }
<a name="l1664"><span class="linenum">1664</span></a>      if (<a class="var it5049" onMouseOver="hilite(5049)" onMouseOut="lolite()" onClick="logVariable('attemptobj')" href="../../_variables/attemptobj.html">$attemptobj</a>-&gt;<a class="function" onClick="logFunction('get_quiz')" href="../../_functions/get_quiz.html" onMouseOver="funcPopup(event,'get_quiz')">get_quiz</a>()-&gt;timeclose) {
<a name="l1665"><span class="linenum">1665</span></a>          <a class="var it18273" onMouseOver="hilite(18273)" onMouseOut="lolite()" onClick="logVariable('deadlines')" href="../../_variables/deadlines.html">$deadlines</a>[] = <a class="var it5049" onMouseOver="hilite(5049)" onMouseOut="lolite()" onClick="logVariable('attemptobj')" href="../../_variables/attemptobj.html">$attemptobj</a>-&gt;<a class="function" onClick="logFunction('get_quiz')" href="../../_functions/get_quiz.html" onMouseOver="funcPopup(event,'get_quiz')">get_quiz</a>()-&gt;timeclose;
<a name="l1666"><span class="linenum">1666</span></a>      }
<a name="l1667"><span class="linenum">1667</span></a>      <a class="var it2265" onMouseOver="hilite(2265)" onMouseOut="lolite()" onClick="logVariable('duedate')" href="../../_variables/duedate.html">$duedate</a> = <a class="phpfunction" onClick="logFunction('min')" href="../../_functions/min.html" onMouseOver="phpfuncPopup(event,'min')">min</a>(<a class="var it18273" onMouseOver="hilite(18273)" onMouseOut="lolite()" onClick="logVariable('deadlines')" href="../../_variables/deadlines.html">$deadlines</a>);
<a name="l1668"><span class="linenum">1668</span></a>      <a class="var it41459" onMouseOver="hilite(41459)" onMouseOut="lolite()" onClick="logVariable('graceend')" href="../../_variables/graceend.html">$graceend</a> = <a class="var it2265" onMouseOver="hilite(2265)" onMouseOut="lolite()" onClick="logVariable('duedate')" href="../../_variables/duedate.html">$duedate</a> + <a class="var it5049" onMouseOver="hilite(5049)" onMouseOut="lolite()" onClick="logVariable('attemptobj')" href="../../_variables/attemptobj.html">$attemptobj</a>-&gt;<a class="function" onClick="logFunction('get_quiz')" href="../../_functions/get_quiz.html" onMouseOver="funcPopup(event,'get_quiz')">get_quiz</a>()-&gt;graceperiod;
<a name="l1669"><span class="linenum">1669</span></a>  
<a name="l1670"><span class="linenum">1670</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a> = new stdClass();
<a name="l1671"><span class="linenum">1671</span></a>  <span class="comment">    // Course info.</span>
<a name="l1672"><span class="linenum">1672</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('coursename')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/coursename.html">coursename</a>         = <a class="function" onClick="logFunction('format_string')" href="../../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it5049" onMouseOver="hilite(5049)" onMouseOut="lolite()" onClick="logVariable('attemptobj')" href="../../_variables/attemptobj.html">$attemptobj</a>-&gt;<a class="function" onClick="logFunction('get_course')" href="../../_functions/get_course.html" onMouseOver="funcPopup(event,'get_course')">get_course</a>()-&gt;fullname);
<a name="l1673"><span class="linenum">1673</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('courseshortname')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/courseshortname.html">courseshortname</a>    = <a class="function" onClick="logFunction('format_string')" href="../../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it5049" onMouseOver="hilite(5049)" onMouseOut="lolite()" onClick="logVariable('attemptobj')" href="../../_variables/attemptobj.html">$attemptobj</a>-&gt;<a class="function" onClick="logFunction('get_course')" href="../../_functions/get_course.html" onMouseOver="funcPopup(event,'get_course')">get_course</a>()-&gt;shortname);
<a name="l1674"><span class="linenum">1674</span></a>  <span class="comment">    // Quiz info.</span>
<a name="l1675"><span class="linenum">1675</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('quizname')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/quizname.html">quizname</a>           = <a class="var it521" onMouseOver="hilite(521)" onMouseOut="lolite()" onClick="logVariable('quizname')" href="../../_variables/quizname.html">$quizname</a>;
<a name="l1676"><span class="linenum">1676</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('quizurl')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/quizurl.html">quizurl</a>            = <a class="var it5049" onMouseOver="hilite(5049)" onMouseOut="lolite()" onClick="logVariable('attemptobj')" href="../../_variables/attemptobj.html">$attemptobj</a>-&gt;<a class="function" onClick="logFunction('view_url')" href="../../_functions/view_url.html" onMouseOver="funcPopup(event,'view_url')">view_url</a>();
<a name="l1677"><span class="linenum">1677</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('quizlink')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/quizlink.html">quizlink</a>           = '&lt;a href=&quot;' . <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('quizurl')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/quizurl.html">quizurl</a> . '&quot;&gt;' . <a class="var it521" onMouseOver="hilite(521)" onMouseOut="lolite()" onClick="logVariable('quizname')" href="../../_variables/quizname.html">$quizname</a> . '&lt;/a&gt;';
<a name="l1678"><span class="linenum">1678</span></a>  <span class="comment">    // Attempt info.</span>
<a name="l1679"><span class="linenum">1679</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('attemptduedate')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/attemptduedate.html">attemptduedate</a>     = <a class="function" onClick="logFunction('userdate')" href="../../_functions/userdate.html" onMouseOver="funcPopup(event,'userdate')">userdate</a>(<a class="var it2265" onMouseOver="hilite(2265)" onMouseOut="lolite()" onClick="logVariable('duedate')" href="../../_variables/duedate.html">$duedate</a>);
<a name="l1680"><span class="linenum">1680</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('attemptgraceend')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/attemptgraceend.html">attemptgraceend</a>    = <a class="function" onClick="logFunction('userdate')" href="../../_functions/userdate.html" onMouseOver="funcPopup(event,'userdate')">userdate</a>(<a class="var it41459" onMouseOver="hilite(41459)" onMouseOut="lolite()" onClick="logVariable('graceend')" href="../../_variables/graceend.html">$graceend</a>);
<a name="l1681"><span class="linenum">1681</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('attemptsummaryurl')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/attemptsummaryurl.html">attemptsummaryurl</a>  = <a class="var it5049" onMouseOver="hilite(5049)" onMouseOut="lolite()" onClick="logVariable('attemptobj')" href="../../_variables/attemptobj.html">$attemptobj</a>-&gt;<a class="function" onClick="logFunction('summary_url')" href="../../_functions/summary_url.html" onMouseOver="funcPopup(event,'summary_url')">summary_url</a>()-&gt;<a class="function" onClick="logFunction('out')" href="../../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>(false);
<a name="l1682"><span class="linenum">1682</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('attemptsummarylink')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/attemptsummarylink.html">attemptsummarylink</a> = '&lt;a href=&quot;' . <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('attemptsummaryurl')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/attemptsummaryurl.html">attemptsummaryurl</a> . '&quot;&gt;' . <a class="var it521" onMouseOver="hilite(521)" onMouseOut="lolite()" onClick="logVariable('quizname')" href="../../_variables/quizname.html">$quizname</a> . ' review&lt;/a&gt;';
<a name="l1683"><span class="linenum">1683</span></a>  <span class="comment">    // Student's info.</span>
<a name="l1684"><span class="linenum">1684</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('studentidnumber')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/studentidnumber.html">studentidnumber</a>    = <a class="var it41447" onMouseOver="hilite(41447)" onMouseOut="lolite()" onClick="logVariable('submitter')" href="../../_variables/submitter.html">$submitter</a>-&gt;<a onClick="logVariable('idnumber')" class="var it45194" onMouseOver="hilite(45194)" onMouseOut="lolite()" href="../../_variables/idnumber.html">idnumber</a>;
<a name="l1685"><span class="linenum">1685</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('studentname')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/studentname.html">studentname</a>        = <a class="function" onClick="logFunction('fullname')" href="../../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it41447" onMouseOver="hilite(41447)" onMouseOut="lolite()" onClick="logVariable('submitter')" href="../../_variables/submitter.html">$submitter</a>);
<a name="l1686"><span class="linenum">1686</span></a>      <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('studentusername')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/studentusername.html">studentusername</a>    = <a class="var it41447" onMouseOver="hilite(41447)" onMouseOut="lolite()" onClick="logVariable('submitter')" href="../../_variables/submitter.html">$submitter</a>-&gt;<a onClick="logVariable('username')" class="var it45194" onMouseOver="hilite(45194)" onMouseOut="lolite()" href="../../_variables/username.html">username</a>;
<a name="l1687"><span class="linenum">1687</span></a>  
<a name="l1688"><span class="linenum">1688</span></a>  <span class="comment">    // Prepare the message.</span>
<a name="l1689"><span class="linenum">1689</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a> = new stdClass();
<a name="l1690"><span class="linenum">1690</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('component')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/component.html">component</a>         = 'mod_quiz';
<a name="l1691"><span class="linenum">1691</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('name')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>              = 'attempt_overdue';
<a name="l1692"><span class="linenum">1692</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('notification')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/notification.html">notification</a>      = 1;
<a name="l1693"><span class="linenum">1693</span></a>  
<a name="l1694"><span class="linenum">1694</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('userfrom')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/userfrom.html">userfrom</a>          = <a class="class" onClick="logClass('core_user')" href="../../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('get_noreply_user')" href="../../_functions/get_noreply_user.html" onMouseOver="funcPopup(event,'get_noreply_user')">get_noreply_user</a>();
<a name="l1695"><span class="linenum">1695</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('userto')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/userto.html">userto</a>            = <a class="var it41447" onMouseOver="hilite(41447)" onMouseOut="lolite()" onClick="logVariable('submitter')" href="../../_variables/submitter.html">$submitter</a>;
<a name="l1696"><span class="linenum">1696</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('subject')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/subject.html">subject</a>           = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailoverduesubject', 'quiz', <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>);
<a name="l1697"><span class="linenum">1697</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('fullmessage')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/fullmessage.html">fullmessage</a>       = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailoverduebody', 'quiz', <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>);
<a name="l1698"><span class="linenum">1698</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('fullmessageformat')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/fullmessageformat.html">fullmessageformat</a> = <a class="constant" onClick="logConstant('FORMAT_PLAIN')" href="../../_constants/FORMAT_PLAIN.html" onMouseOver="constPopup(event,'FORMAT_PLAIN')">FORMAT_PLAIN</a>;
<a name="l1699"><span class="linenum">1699</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('fullmessagehtml')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/fullmessagehtml.html">fullmessagehtml</a>   = '';
<a name="l1700"><span class="linenum">1700</span></a>  
<a name="l1701"><span class="linenum">1701</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('smallmessage')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/smallmessage.html">smallmessage</a>      = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailoverduesmall', 'quiz', <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>);
<a name="l1702"><span class="linenum">1702</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('contexturl')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/contexturl.html">contexturl</a>        = <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('quizurl')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/quizurl.html">quizurl</a>;
<a name="l1703"><span class="linenum">1703</span></a>      <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('contexturlname')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../_variables/contexturlname.html">contexturlname</a>    = <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('quizname')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/quizname.html">quizname</a>;
<a name="l1704"><span class="linenum">1704</span></a>  
<a name="l1705"><span class="linenum">1705</span></a>  <span class="comment">    // Send the message.</span>
<a name="l1706"><span class="linenum">1706</span></a>      return <a class="function" onClick="logFunction('message_send')" href="../../_functions/message_send.html" onMouseOver="funcPopup(event,'message_send')">message_send</a>(<a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>);
<a name="l1707"><span class="linenum">1707</span></a>  }
<a name="l1708"><span class="linenum">1708</span></a>  
<a name="l1709"><span class="linenum">1709</span></a>  <span class="comment">/**</span>
<a name="l1710"><span class="linenum">1710</span></a>  <span class="comment"> * Handle the quiz_attempt_submitted event.</span>
<a name="l1711"><span class="linenum">1711</span></a>  <span class="comment"> *</span>
<a name="l1712"><span class="linenum">1712</span></a>  <span class="comment"> * This sends the confirmation and notification messages, if required.</span>
<a name="l1713"><span class="linenum">1713</span></a>  <span class="comment"> *</span>
<a name="l1714"><span class="linenum">1714</span></a>  <span class="comment"> * @param object $event the event object.</span>
<a name="l1715"><span class="linenum">1715</span></a>  <span class="comment"> */</span>
<a name="l1716"><span class="linenum">1716</span></a>  function <a class="function" onClick="logFunction('quiz_attempt_submitted_handler')" href="../../_functions/quiz_attempt_submitted_handler.html" onMouseOver="funcPopup(event,'quiz_attempt_submitted_handler')">quiz_attempt_submitted_handler</a>(<a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>) {
<a name="l1717"><span class="linenum">1717</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1718"><span class="linenum">1718</span></a>  
<a name="l1719"><span class="linenum">1719</span></a>      <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>  = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('course', array('id' =&gt; <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a onClick="logVariable('courseid')" class="var it42950" onMouseOver="hilite(42950)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>));
<a name="l1720"><span class="linenum">1720</span></a>      <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a> = <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('get_record_snapshot')" href="../../_functions/get_record_snapshot.html" onMouseOver="funcPopup(event,'get_record_snapshot')">get_record_snapshot</a>('quiz_attempts', <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a onClick="logVariable('objectid')" class="var it42950" onMouseOver="hilite(42950)" onMouseOut="lolite()" href="../../_variables/objectid.html">objectid</a>);
<a name="l1721"><span class="linenum">1721</span></a>      <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>    = <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('get_record_snapshot')" href="../../_functions/get_record_snapshot.html" onMouseOver="funcPopup(event,'get_record_snapshot')">get_record_snapshot</a>('quiz', <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>-&gt;<a onClick="logVariable('quiz')" class="var it43015" onMouseOver="hilite(43015)" onMouseOut="lolite()" href="../../_variables/quiz.html">quiz</a>);
<a name="l1722"><span class="linenum">1722</span></a>      <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>      = <a class="function" onClick="logFunction('get_coursemodule_from_id')" href="../../_functions/get_coursemodule_from_id.html" onMouseOver="funcPopup(event,'get_coursemodule_from_id')">get_coursemodule_from_id</a>('quiz', <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('get_context')" href="../../_functions/get_context.html" onMouseOver="funcPopup(event,'get_context')">get_context</a>()-&gt;instanceid, <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a onClick="logVariable('courseid')" class="var it42950" onMouseOver="hilite(42950)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>);
<a name="l1723"><span class="linenum">1723</span></a>  
<a name="l1724"><span class="linenum">1724</span></a>      if (!(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a> &amp;&amp; <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a> &amp;&amp; <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a> &amp;&amp; <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>)) {
<a name="l1725"><span class="linenum">1725</span></a>  <span class="comment">        // Something has been deleted since the event was raised. Therefore, the</span>
<a name="l1726"><span class="linenum">1726</span></a>  <span class="comment">        // event is no longer relevant.</span>
<a name="l1727"><span class="linenum">1727</span></a>          return true;
<a name="l1728"><span class="linenum">1728</span></a>      }
<a name="l1729"><span class="linenum">1729</span></a>  
<a name="l1730"><span class="linenum">1730</span></a>  <span class="comment">    // Update completion state.</span>
<a name="l1731"><span class="linenum">1731</span></a>      <a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a> = <span class="keyword">new </span><a class="class" onClick="logClass('completion_info')" href="../../_classes/completion_info.html" onMouseOver="classPopup(event,'completion_info')">completion_info</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>);
<a name="l1732"><span class="linenum">1732</span></a>      if (<a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a>-&gt;<a class="function" onClick="logFunction('is_enabled')" href="../../_functions/is_enabled.html" onMouseOver="funcPopup(event,'is_enabled')">is_enabled</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>) &amp;&amp; (<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('completionattemptsexhausted')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/completionattemptsexhausted.html">completionattemptsexhausted</a> || <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('completionpass')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/completionpass.html">completionpass</a>)) {
<a name="l1733"><span class="linenum">1733</span></a>          <a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a>-&gt;<a class="function" onClick="logFunction('update_state')" href="../../_functions/update_state.html" onMouseOver="funcPopup(event,'update_state')">update_state</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="constant" onClick="logConstant('COMPLETION_COMPLETE')" href="../../_constants/COMPLETION_COMPLETE.html" onMouseOver="constPopup(event,'COMPLETION_COMPLETE')">COMPLETION_COMPLETE</a>, <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a onClick="logVariable('userid')" class="var it42950" onMouseOver="hilite(42950)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>);
<a name="l1734"><span class="linenum">1734</span></a>      }
<a name="l1735"><span class="linenum">1735</span></a>      return <a class="function" onClick="logFunction('quiz_send_notification_messages')" href="../../_functions/quiz_send_notification_messages.html" onMouseOver="funcPopup(event,'quiz_send_notification_messages')">quiz_send_notification_messages</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>,
<a name="l1736"><span class="linenum">1736</span></a>              <a class="class" onClick="logClass('context_module')" href="../../_classes/context_module.html" onMouseOver="classPopup(event,'context_module')">context_module</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>), <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>);
<a name="l1737"><span class="linenum">1737</span></a>  }
<a name="l1738"><span class="linenum">1738</span></a>  
<a name="l1739"><span class="linenum">1739</span></a>  <span class="comment">/**</span>
<a name="l1740"><span class="linenum">1740</span></a>  <span class="comment"> * Handle groups_member_added event</span>
<a name="l1741"><span class="linenum">1741</span></a>  <span class="comment"> *</span>
<a name="l1742"><span class="linenum">1742</span></a>  <span class="comment"> * @param object $event the event object.</span>
<a name="l1743"><span class="linenum">1743</span></a>  <span class="comment"> * @deprecated since 2.6, see {@link \mod_quiz\group_observers::group_member_added()}.</span>
<a name="l1744"><span class="linenum">1744</span></a>  <span class="comment"> */</span>
<a name="l1745"><span class="linenum">1745</span></a>  function <a class="function" onClick="logFunction('quiz_groups_member_added_handler')" href="../../_functions/quiz_groups_member_added_handler.html" onMouseOver="funcPopup(event,'quiz_groups_member_added_handler')">quiz_groups_member_added_handler</a>(<a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>) {
<a name="l1746"><span class="linenum">1746</span></a>      <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('<a class="function" onClick="logFunction('quiz_groups_member_added_handler')" href="../../_functions/quiz_groups_member_added_handler.html" onMouseOver="funcPopup(event,'quiz_groups_member_added_handler')">quiz_groups_member_added_handler</a>() is deprecated, please use ' .
<a name="l1747"><span class="linenum">1747</span></a>          '\mod_quiz\<a class="class" onClick="logClass('group_observers')" href="../../_classes/group_observers.html" onMouseOver="classPopup(event,'group_observers')">group_observers</a>::<a class="function" onClick="logFunction('group_member_added')" href="../../_functions/group_member_added.html" onMouseOver="funcPopup(event,'group_member_added')">group_member_added</a>() instead.', <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l1748"><span class="linenum">1748</span></a>      <a class="function" onClick="logFunction('quiz_update_open_attempts')" href="../../_functions/quiz_update_open_attempts.html" onMouseOver="funcPopup(event,'quiz_update_open_attempts')">quiz_update_open_attempts</a>(array('userid'=&gt;<a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a onClick="logVariable('userid')" class="var it42950" onMouseOver="hilite(42950)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>, 'groupid'=&gt;<a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a onClick="logVariable('groupid')" class="var it42950" onMouseOver="hilite(42950)" onMouseOut="lolite()" href="../../_variables/groupid.html">groupid</a>));
<a name="l1749"><span class="linenum">1749</span></a>  }
<a name="l1750"><span class="linenum">1750</span></a>  
<a name="l1751"><span class="linenum">1751</span></a>  <span class="comment">/**</span>
<a name="l1752"><span class="linenum">1752</span></a>  <span class="comment"> * Handle groups_member_removed event</span>
<a name="l1753"><span class="linenum">1753</span></a>  <span class="comment"> *</span>
<a name="l1754"><span class="linenum">1754</span></a>  <span class="comment"> * @param object $event the event object.</span>
<a name="l1755"><span class="linenum">1755</span></a>  <span class="comment"> * @deprecated since 2.6, see {@link \mod_quiz\group_observers::group_member_removed()}.</span>
<a name="l1756"><span class="linenum">1756</span></a>  <span class="comment"> */</span>
<a name="l1757"><span class="linenum">1757</span></a>  function <a class="function" onClick="logFunction('quiz_groups_member_removed_handler')" href="../../_functions/quiz_groups_member_removed_handler.html" onMouseOver="funcPopup(event,'quiz_groups_member_removed_handler')">quiz_groups_member_removed_handler</a>(<a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>) {
<a name="l1758"><span class="linenum">1758</span></a>      <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('<a class="function" onClick="logFunction('quiz_groups_member_removed_handler')" href="../../_functions/quiz_groups_member_removed_handler.html" onMouseOver="funcPopup(event,'quiz_groups_member_removed_handler')">quiz_groups_member_removed_handler</a>() is deprecated, please use ' .
<a name="l1759"><span class="linenum">1759</span></a>          '\mod_quiz\<a class="class" onClick="logClass('group_observers')" href="../../_classes/group_observers.html" onMouseOver="classPopup(event,'group_observers')">group_observers</a>::<a class="function" onClick="logFunction('group_member_removed')" href="../../_functions/group_member_removed.html" onMouseOver="funcPopup(event,'group_member_removed')">group_member_removed</a>() instead.', <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l1760"><span class="linenum">1760</span></a>      <a class="function" onClick="logFunction('quiz_update_open_attempts')" href="../../_functions/quiz_update_open_attempts.html" onMouseOver="funcPopup(event,'quiz_update_open_attempts')">quiz_update_open_attempts</a>(array('userid'=&gt;<a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a onClick="logVariable('userid')" class="var it42950" onMouseOver="hilite(42950)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>, 'groupid'=&gt;<a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a onClick="logVariable('groupid')" class="var it42950" onMouseOver="hilite(42950)" onMouseOut="lolite()" href="../../_variables/groupid.html">groupid</a>));
<a name="l1761"><span class="linenum">1761</span></a>  }
<a name="l1762"><span class="linenum">1762</span></a>  
<a name="l1763"><span class="linenum">1763</span></a>  <span class="comment">/**</span>
<a name="l1764"><span class="linenum">1764</span></a>  <span class="comment"> * Handle groups_group_deleted event</span>
<a name="l1765"><span class="linenum">1765</span></a>  <span class="comment"> *</span>
<a name="l1766"><span class="linenum">1766</span></a>  <span class="comment"> * @param object $event the event object.</span>
<a name="l1767"><span class="linenum">1767</span></a>  <span class="comment"> * @deprecated since 2.6, see {@link \mod_quiz\group_observers::group_deleted()}.</span>
<a name="l1768"><span class="linenum">1768</span></a>  <span class="comment"> */</span>
<a name="l1769"><span class="linenum">1769</span></a>  function <a class="function" onClick="logFunction('quiz_groups_group_deleted_handler')" href="../../_functions/quiz_groups_group_deleted_handler.html" onMouseOver="funcPopup(event,'quiz_groups_group_deleted_handler')">quiz_groups_group_deleted_handler</a>(<a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>) {
<a name="l1770"><span class="linenum">1770</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1771"><span class="linenum">1771</span></a>      <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('<a class="function" onClick="logFunction('quiz_groups_group_deleted_handler')" href="../../_functions/quiz_groups_group_deleted_handler.html" onMouseOver="funcPopup(event,'quiz_groups_group_deleted_handler')">quiz_groups_group_deleted_handler</a>() is deprecated, please use ' .
<a name="l1772"><span class="linenum">1772</span></a>          '\mod_quiz\<a class="class" onClick="logClass('group_observers')" href="../../_classes/group_observers.html" onMouseOver="classPopup(event,'group_observers')">group_observers</a>::<a class="function" onClick="logFunction('group_deleted')" href="../../_functions/group_deleted.html" onMouseOver="funcPopup(event,'group_deleted')">group_deleted</a>() instead.', <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l1773"><span class="linenum">1773</span></a>      <a class="function" onClick="logFunction('quiz_process_group_deleted_in_course')" href="../../_functions/quiz_process_group_deleted_in_course.html" onMouseOver="funcPopup(event,'quiz_process_group_deleted_in_course')">quiz_process_group_deleted_in_course</a>(<a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a onClick="logVariable('courseid')" class="var it42950" onMouseOver="hilite(42950)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>);
<a name="l1774"><span class="linenum">1774</span></a>  }
<a name="l1775"><span class="linenum">1775</span></a>  
<a name="l1776"><span class="linenum">1776</span></a>  <span class="comment">/**</span>
<a name="l1777"><span class="linenum">1777</span></a>  <span class="comment"> * Logic to happen when a/some group(s) has/have been deleted in a course.</span>
<a name="l1778"><span class="linenum">1778</span></a>  <span class="comment"> *</span>
<a name="l1779"><span class="linenum">1779</span></a>  <span class="comment"> * @param int $courseid The course ID.</span>
<a name="l1780"><span class="linenum">1780</span></a>  <span class="comment"> * @return void</span>
<a name="l1781"><span class="linenum">1781</span></a>  <span class="comment"> */</span>
<a name="l1782"><span class="linenum">1782</span></a>  function <a class="function" onClick="logFunction('quiz_process_group_deleted_in_course')" href="../../_functions/quiz_process_group_deleted_in_course.html" onMouseOver="funcPopup(event,'quiz_process_group_deleted_in_course')">quiz_process_group_deleted_in_course</a>(<a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>) {
<a name="l1783"><span class="linenum">1783</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1784"><span class="linenum">1784</span></a>  
<a name="l1785"><span class="linenum">1785</span></a>  <span class="comment">    // It would be nice if we got the groupid that was deleted.</span>
<a name="l1786"><span class="linenum">1786</span></a>  <span class="comment">    // Instead, we just update all quizzes with orphaned group overrides.</span>
<a name="l1787"><span class="linenum">1787</span></a>      <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT o.id, o.quiz
<a name="l1788"><span class="linenum">1788</span></a>                FROM {quiz_overrides} o
<a name="l1789"><span class="linenum">1789</span></a>                JOIN {quiz} quiz ON quiz.id = o.quiz
<a name="l1790"><span class="linenum">1790</span></a>           LEFT JOIN {groups} grp ON grp.id = o.groupid
<a name="l1791"><span class="linenum">1791</span></a>               WHERE quiz.course = :courseid
<a name="l1792"><span class="linenum">1792</span></a>                 AND o.groupid IS NOT NULL
<a name="l1793"><span class="linenum">1793</span></a>                 AND grp.id IS NULL&quot;;
<a name="l1794"><span class="linenum">1794</span></a>      <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('courseid' =&gt; <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>);
<a name="l1795"><span class="linenum">1795</span></a>      <a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql_menu')" href="../../_functions/get_records_sql_menu.html" onMouseOver="funcPopup(event,'get_records_sql_menu')">get_records_sql_menu</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l1796"><span class="linenum">1796</span></a>      if (!<a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>) {
<a name="l1797"><span class="linenum">1797</span></a>          return; <span class="comment">// Nothing to do.</span>
<a name="l1798"><span class="linenum">1798</span></a>      }
<a name="l1799"><span class="linenum">1799</span></a>      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records_list')" href="../../_functions/delete_records_list.html" onMouseOver="funcPopup(event,'delete_records_list')">delete_records_list</a>('quiz_overrides', 'id', <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>));
<a name="l1800"><span class="linenum">1800</span></a>      <a class="function" onClick="logFunction('quiz_update_open_attempts')" href="../../_functions/quiz_update_open_attempts.html" onMouseOver="funcPopup(event,'quiz_update_open_attempts')">quiz_update_open_attempts</a>(array('quizid' =&gt; <a class="phpfunction" onClick="logFunction('array_unique')" href="../../_functions/array_unique.html" onMouseOver="phpfuncPopup(event,'array_unique')">array_unique</a>(<a class="phpfunction" onClick="logFunction('array_values')" href="../../_functions/array_values.html" onMouseOver="phpfuncPopup(event,'array_values')">array_values</a>(<a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>))));
<a name="l1801"><span class="linenum">1801</span></a>  }
<a name="l1802"><span class="linenum">1802</span></a>  
<a name="l1803"><span class="linenum">1803</span></a>  <span class="comment">/**</span>
<a name="l1804"><span class="linenum">1804</span></a>  <span class="comment"> * Handle groups_members_removed event</span>
<a name="l1805"><span class="linenum">1805</span></a>  <span class="comment"> *</span>
<a name="l1806"><span class="linenum">1806</span></a>  <span class="comment"> * @param object $event the event object.</span>
<a name="l1807"><span class="linenum">1807</span></a>  <span class="comment"> * @deprecated since 2.6, see {@link \mod_quiz\group_observers::group_member_removed()}.</span>
<a name="l1808"><span class="linenum">1808</span></a>  <span class="comment"> */</span>
<a name="l1809"><span class="linenum">1809</span></a>  function <a class="function" onClick="logFunction('quiz_groups_members_removed_handler')" href="../../_functions/quiz_groups_members_removed_handler.html" onMouseOver="funcPopup(event,'quiz_groups_members_removed_handler')">quiz_groups_members_removed_handler</a>(<a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>) {
<a name="l1810"><span class="linenum">1810</span></a>      <a class="function" onClick="logFunction('debugging')" href="../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('<a class="function" onClick="logFunction('quiz_groups_members_removed_handler')" href="../../_functions/quiz_groups_members_removed_handler.html" onMouseOver="funcPopup(event,'quiz_groups_members_removed_handler')">quiz_groups_members_removed_handler</a>() is deprecated, please use ' .
<a name="l1811"><span class="linenum">1811</span></a>          '\mod_quiz\<a class="class" onClick="logClass('group_observers')" href="../../_classes/group_observers.html" onMouseOver="classPopup(event,'group_observers')">group_observers</a>::<a class="function" onClick="logFunction('group_member_removed')" href="../../_functions/group_member_removed.html" onMouseOver="funcPopup(event,'group_member_removed')">group_member_removed</a>() instead.', <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l1812"><span class="linenum">1812</span></a>      if (<a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a onClick="logVariable('userid')" class="var it42950" onMouseOver="hilite(42950)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> == 0) {
<a name="l1813"><span class="linenum">1813</span></a>          <a class="function" onClick="logFunction('quiz_update_open_attempts')" href="../../_functions/quiz_update_open_attempts.html" onMouseOver="funcPopup(event,'quiz_update_open_attempts')">quiz_update_open_attempts</a>(array('courseid'=&gt;<a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a onClick="logVariable('courseid')" class="var it42950" onMouseOver="hilite(42950)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>));
<a name="l1814"><span class="linenum">1814</span></a>      } else {
<a name="l1815"><span class="linenum">1815</span></a>          <a class="function" onClick="logFunction('quiz_update_open_attempts')" href="../../_functions/quiz_update_open_attempts.html" onMouseOver="funcPopup(event,'quiz_update_open_attempts')">quiz_update_open_attempts</a>(array('courseid'=&gt;<a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a onClick="logVariable('courseid')" class="var it42950" onMouseOver="hilite(42950)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>, 'userid'=&gt;<a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a onClick="logVariable('userid')" class="var it42950" onMouseOver="hilite(42950)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>));
<a name="l1816"><span class="linenum">1816</span></a>      }
<a name="l1817"><span class="linenum">1817</span></a>  }
<a name="l1818"><span class="linenum">1818</span></a>  
<a name="l1819"><span class="linenum">1819</span></a>  <span class="comment">/**</span>
<a name="l1820"><span class="linenum">1820</span></a>  <span class="comment"> * Get the information about the standard quiz JavaScript module.</span>
<a name="l1821"><span class="linenum">1821</span></a>  <span class="comment"> * @return array a standard jsmodule structure.</span>
<a name="l1822"><span class="linenum">1822</span></a>  <span class="comment"> */</span>
<a name="l1823"><span class="linenum">1823</span></a>  function <a class="function" onClick="logFunction('quiz_get_js_module')" href="../../_functions/quiz_get_js_module.html" onMouseOver="funcPopup(event,'quiz_get_js_module')">quiz_get_js_module</a>() {
<a name="l1824"><span class="linenum">1824</span></a>      global <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>;
<a name="l1825"><span class="linenum">1825</span></a>  
<a name="l1826"><span class="linenum">1826</span></a>      return array(
<a name="l1827"><span class="linenum">1827</span></a>          'name' =&gt; 'mod_quiz',
<a name="l1828"><span class="linenum">1828</span></a>          'fullpath' =&gt; '<a class="filename" href="../../mod/quiz/module.js.html">/mod/quiz/module.js</a>',
<a name="l1829"><span class="linenum">1829</span></a>          'requires' =&gt; array('base', 'dom', 'event-delegate', 'event-key',
<a name="l1830"><span class="linenum">1830</span></a>                  'core_question_engine', 'moodle-core-formchangechecker'),
<a name="l1831"><span class="linenum">1831</span></a>          'strings' =&gt; array(
<a name="l1832"><span class="linenum">1832</span></a>              array('cancel', 'moodle'),
<a name="l1833"><span class="linenum">1833</span></a>              array('flagged', 'question'),
<a name="l1834"><span class="linenum">1834</span></a>              array('functiondisabledbysecuremode', 'quiz'),
<a name="l1835"><span class="linenum">1835</span></a>              array('startattempt', 'quiz'),
<a name="l1836"><span class="linenum">1836</span></a>              array('timesup', 'quiz'),
<a name="l1837"><span class="linenum">1837</span></a>              array('changesmadereallygoaway', 'moodle'),
<a name="l1838"><span class="linenum">1838</span></a>          ),
<a name="l1839"><span class="linenum">1839</span></a>      );
<a name="l1840"><span class="linenum">1840</span></a>  }
<a name="l1841"><span class="linenum">1841</span></a>  
<a name="l1842"><span class="linenum">1842</span></a>  
<a name="l1843"><span class="linenum">1843</span></a>  <span class="comment">/**</span>
<a name="l1844"><span class="linenum">1844</span></a>  <span class="comment"> * An extension of question_display_options that includes the extra options used</span>
<a name="l1845"><span class="linenum">1845</span></a>  <span class="comment"> * by the quiz.</span>
<a name="l1846"><span class="linenum">1846</span></a>  <span class="comment"> *</span>
<a name="l1847"><span class="linenum">1847</span></a>  <span class="comment"> * @copyright  2010 The Open University</span>
<a name="l1848"><span class="linenum">1848</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l1849"><span class="linenum">1849</span></a>  <span class="comment"> */</span>
<a name="l1850"><span class="linenum">1850</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('mod_quiz_display_options')" href="../../_classes/mod_quiz_display_options.html" onMouseOver="classPopup(event,'mod_quiz_display_options')">mod_quiz_display_options</a> <span class="keyword">extends</span> <a class="class" onClick="logClass('question_display_options')" href="../../_classes/question_display_options.html" onMouseOver="classPopup(event,'question_display_options')">question_display_options</a> {
<a name="l1851"><span class="linenum">1851</span></a>      <span class="comment">/**#@+</span>
<a name="l1852"><span class="linenum">1852</span></a>  <span class="comment">     * @var integer bits used to indicate various times in relation to a</span>
<a name="l1853"><span class="linenum">1853</span></a>  <span class="comment">     * quiz attempt.</span>
<a name="l1854"><span class="linenum">1854</span></a>  <span class="comment">     */</span>
<a name="l1855"><span class="linenum">1855</span></a>      const DURING =            0x10000;
<a name="l1856"><span class="linenum">1856</span></a>      const IMMEDIATELY_AFTER = 0x01000;
<a name="l1857"><span class="linenum">1857</span></a>      const LATER_WHILE_OPEN =  0x00100;
<a name="l1858"><span class="linenum">1858</span></a>      const AFTER_CLOSE =       0x00010;
<a name="l1859"><span class="linenum">1859</span></a>  <span class="comment">    /**#@-*/</span>
<a name="l1860"><span class="linenum">1860</span></a>  
<a name="l1861"><span class="linenum">1861</span></a>      <span class="comment">/**</span>
<a name="l1862"><span class="linenum">1862</span></a>  <span class="comment">     * @var boolean if this is false, then the student is not allowed to review</span>
<a name="l1863"><span class="linenum">1863</span></a>  <span class="comment">     * anything about the attempt.</span>
<a name="l1864"><span class="linenum">1864</span></a>  <span class="comment">     */</span>
<a name="l1865"><span class="linenum">1865</span></a>      public <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a> = true;
<a name="l1866"><span class="linenum">1866</span></a>  
<a name="l1867"><span class="linenum">1867</span></a>      <span class="comment">/**</span>
<a name="l1868"><span class="linenum">1868</span></a>  <span class="comment">     * @var boolean if this is false, then the student is not allowed to review</span>
<a name="l1869"><span class="linenum">1869</span></a>  <span class="comment">     * anything about the attempt.</span>
<a name="l1870"><span class="linenum">1870</span></a>  <span class="comment">     */</span>
<a name="l1871"><span class="linenum">1871</span></a>      public <a class="var it6244" onMouseOver="hilite(6244)" onMouseOut="lolite()" onClick="logVariable('overallfeedback')" href="../../_variables/overallfeedback.html">$overallfeedback</a> = self::VISIBLE;
<a name="l1872"><span class="linenum">1872</span></a>  
<a name="l1873"><span class="linenum">1873</span></a>      <span class="comment">/**</span>
<a name="l1874"><span class="linenum">1874</span></a>  <span class="comment">     * Set up the various options from the quiz settings, and a time constant.</span>
<a name="l1875"><span class="linenum">1875</span></a>  <span class="comment">     * @param object $quiz the quiz settings.</span>
<a name="l1876"><span class="linenum">1876</span></a>  <span class="comment">     * @param int $one of the {@link DURING}, {@link IMMEDIATELY_AFTER},</span>
<a name="l1877"><span class="linenum">1877</span></a>  <span class="comment">     * {@link LATER_WHILE_OPEN} or {@link AFTER_CLOSE} constants.</span>
<a name="l1878"><span class="linenum">1878</span></a>  <span class="comment">     * @return mod_quiz_display_options set up appropriately.</span>
<a name="l1879"><span class="linenum">1879</span></a>  <span class="comment">     */</span>
<a name="l1880"><span class="linenum">1880</span></a>      public static function <a class="function" onClick="logFunction('make_from_quiz')" href="../../_functions/make_from_quiz.html" onMouseOver="funcPopup(event,'make_from_quiz')">make_from_quiz</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it9819" onMouseOver="hilite(9819)" onMouseOut="lolite()" onClick="logVariable('when')" href="../../_variables/when.html">$when</a>) {
<a name="l1881"><span class="linenum">1881</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a> = new self();
<a name="l1882"><span class="linenum">1882</span></a>  
<a name="l1883"><span class="linenum">1883</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('attempt')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/attempt.html">attempt</a> = self::<a class="phpfunction" onClick="logFunction('extract')" href="../../_functions/extract.html" onMouseOver="phpfuncPopup(event,'extract')">extract</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('reviewattempt')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/reviewattempt.html">reviewattempt</a>, <a class="var it9819" onMouseOver="hilite(9819)" onMouseOut="lolite()" onClick="logVariable('when')" href="../../_variables/when.html">$when</a>, true, false);
<a name="l1884"><span class="linenum">1884</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('correctness')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/correctness.html">correctness</a> = self::<a class="phpfunction" onClick="logFunction('extract')" href="../../_functions/extract.html" onMouseOver="phpfuncPopup(event,'extract')">extract</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('reviewcorrectness')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/reviewcorrectness.html">reviewcorrectness</a>, <a class="var it9819" onMouseOver="hilite(9819)" onMouseOut="lolite()" onClick="logVariable('when')" href="../../_variables/when.html">$when</a>);
<a name="l1885"><span class="linenum">1885</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('marks')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/marks.html">marks</a> = self::<a class="phpfunction" onClick="logFunction('extract')" href="../../_functions/extract.html" onMouseOver="phpfuncPopup(event,'extract')">extract</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('reviewmarks')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/reviewmarks.html">reviewmarks</a>, <a class="var it9819" onMouseOver="hilite(9819)" onMouseOut="lolite()" onClick="logVariable('when')" href="../../_variables/when.html">$when</a>,
<a name="l1886"><span class="linenum">1886</span></a>                  self::MARK_AND_MAX, self::MAX_ONLY);
<a name="l1887"><span class="linenum">1887</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('feedback')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/feedback.html">feedback</a> = self::<a class="phpfunction" onClick="logFunction('extract')" href="../../_functions/extract.html" onMouseOver="phpfuncPopup(event,'extract')">extract</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('reviewspecificfeedback')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/reviewspecificfeedback.html">reviewspecificfeedback</a>, <a class="var it9819" onMouseOver="hilite(9819)" onMouseOut="lolite()" onClick="logVariable('when')" href="../../_variables/when.html">$when</a>);
<a name="l1888"><span class="linenum">1888</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('generalfeedback')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/generalfeedback.html">generalfeedback</a> = self::<a class="phpfunction" onClick="logFunction('extract')" href="../../_functions/extract.html" onMouseOver="phpfuncPopup(event,'extract')">extract</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('reviewgeneralfeedback')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/reviewgeneralfeedback.html">reviewgeneralfeedback</a>, <a class="var it9819" onMouseOver="hilite(9819)" onMouseOut="lolite()" onClick="logVariable('when')" href="../../_variables/when.html">$when</a>);
<a name="l1889"><span class="linenum">1889</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('rightanswer')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/rightanswer.html">rightanswer</a> = self::<a class="phpfunction" onClick="logFunction('extract')" href="../../_functions/extract.html" onMouseOver="phpfuncPopup(event,'extract')">extract</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('reviewrightanswer')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/reviewrightanswer.html">reviewrightanswer</a>, <a class="var it9819" onMouseOver="hilite(9819)" onMouseOut="lolite()" onClick="logVariable('when')" href="../../_variables/when.html">$when</a>);
<a name="l1890"><span class="linenum">1890</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('overallfeedback')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/overallfeedback.html">overallfeedback</a> = self::<a class="phpfunction" onClick="logFunction('extract')" href="../../_functions/extract.html" onMouseOver="phpfuncPopup(event,'extract')">extract</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('reviewoverallfeedback')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/reviewoverallfeedback.html">reviewoverallfeedback</a>, <a class="var it9819" onMouseOver="hilite(9819)" onMouseOut="lolite()" onClick="logVariable('when')" href="../../_variables/when.html">$when</a>);
<a name="l1891"><span class="linenum">1891</span></a>  
<a name="l1892"><span class="linenum">1892</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('numpartscorrect')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/numpartscorrect.html">numpartscorrect</a> = <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('feedback')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/feedback.html">feedback</a>;
<a name="l1893"><span class="linenum">1893</span></a>          <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('manualcomment')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/manualcomment.html">manualcomment</a> = <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('feedback')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/feedback.html">feedback</a>;
<a name="l1894"><span class="linenum">1894</span></a>  
<a name="l1895"><span class="linenum">1895</span></a>          if (<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('questiondecimalpoints')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/questiondecimalpoints.html">questiondecimalpoints</a> != -1) {
<a name="l1896"><span class="linenum">1896</span></a>              <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('markdp')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/markdp.html">markdp</a> = <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('questiondecimalpoints')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/questiondecimalpoints.html">questiondecimalpoints</a>;
<a name="l1897"><span class="linenum">1897</span></a>          } else {
<a name="l1898"><span class="linenum">1898</span></a>              <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('markdp')" class="var it42909" onMouseOver="hilite(42909)" onMouseOut="lolite()" href="../../_variables/markdp.html">markdp</a> = <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('decimalpoints')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/decimalpoints.html">decimalpoints</a>;
<a name="l1899"><span class="linenum">1899</span></a>          }
<a name="l1900"><span class="linenum">1900</span></a>  
<a name="l1901"><span class="linenum">1901</span></a>          return <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>;
<a name="l1902"><span class="linenum">1902</span></a>      }
<a name="l1903"><span class="linenum">1903</span></a>  
<a name="l1904"><span class="linenum">1904</span></a>      protected static function <a class="function" onClick="logFunction('extract')" href="../../_functions/extract.html" onMouseOver="funcPopup(event,'extract')">extract</a>(<a class="var it31900" onMouseOver="hilite(31900)" onMouseOut="lolite()" onClick="logVariable('bitmask')" href="../../_variables/bitmask.html">$bitmask</a>, <a class="var it6628" onMouseOver="hilite(6628)" onMouseOut="lolite()" onClick="logVariable('bit')" href="../../_variables/bit.html">$bit</a>,
<a name="l1905"><span class="linenum">1905</span></a>              <a class="var it41461" onMouseOver="hilite(41461)" onMouseOut="lolite()" onClick="logVariable('whenset')" href="../../_variables/whenset.html">$whenset</a> = self::VISIBLE, <a class="var it41462" onMouseOver="hilite(41462)" onMouseOut="lolite()" onClick="logVariable('whennotset')" href="../../_variables/whennotset.html">$whennotset</a> = self::HIDDEN) {
<a name="l1906"><span class="linenum">1906</span></a>          if (<a class="var it31900" onMouseOver="hilite(31900)" onMouseOut="lolite()" onClick="logVariable('bitmask')" href="../../_variables/bitmask.html">$bitmask</a> &amp; <a class="var it6628" onMouseOver="hilite(6628)" onMouseOut="lolite()" onClick="logVariable('bit')" href="../../_variables/bit.html">$bit</a>) {
<a name="l1907"><span class="linenum">1907</span></a>              return <a class="var it41461" onMouseOver="hilite(41461)" onMouseOut="lolite()" onClick="logVariable('whenset')" href="../../_variables/whenset.html">$whenset</a>;
<a name="l1908"><span class="linenum">1908</span></a>          } else {
<a name="l1909"><span class="linenum">1909</span></a>              return <a class="var it41462" onMouseOver="hilite(41462)" onMouseOut="lolite()" onClick="logVariable('whennotset')" href="../../_variables/whennotset.html">$whennotset</a>;
<a name="l1910"><span class="linenum">1910</span></a>          }
<a name="l1911"><span class="linenum">1911</span></a>      }
<a name="l1912"><span class="linenum">1912</span></a>  }
<a name="l1913"><span class="linenum">1913</span></a>  
<a name="l1914"><span class="linenum">1914</span></a>  
<a name="l1915"><span class="linenum">1915</span></a>  <span class="comment">/**</span>
<a name="l1916"><span class="linenum">1916</span></a>  <span class="comment"> * A {@link qubaid_condition} for finding all the question usages belonging to</span>
<a name="l1917"><span class="linenum">1917</span></a>  <span class="comment"> * a particular quiz.</span>
<a name="l1918"><span class="linenum">1918</span></a>  <span class="comment"> *</span>
<a name="l1919"><span class="linenum">1919</span></a>  <span class="comment"> * @copyright  2010 The Open University</span>
<a name="l1920"><span class="linenum">1920</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l1921"><span class="linenum">1921</span></a>  <span class="comment"> */</span>
<a name="l1922"><span class="linenum">1922</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('qubaids_for_quiz')" href="../../_classes/qubaids_for_quiz.html" onMouseOver="classPopup(event,'qubaids_for_quiz')">qubaids_for_quiz</a> <span class="keyword">extends</span> <a class="class" onClick="logClass('qubaid_join')" href="../../_classes/qubaid_join.html" onMouseOver="classPopup(event,'qubaid_join')">qubaid_join</a> {
<a name="l1923"><span class="linenum">1923</span></a>      public function <a class="function" onClick="logFunction('__construct')" href="../../_functions/__construct.html" onMouseOver="funcPopup(event,'__construct')">__construct</a>(<a class="var it932" onMouseOver="hilite(932)" onMouseOut="lolite()" onClick="logVariable('quizid')" href="../../_variables/quizid.html">$quizid</a>, <a class="var it6228" onMouseOver="hilite(6228)" onMouseOut="lolite()" onClick="logVariable('includepreviews')" href="../../_variables/includepreviews.html">$includepreviews</a> = true, <a class="var it41463" onMouseOver="hilite(41463)" onMouseOut="lolite()" onClick="logVariable('onlyfinished')" href="../../_variables/onlyfinished.html">$onlyfinished</a> = false) {
<a name="l1924"><span class="linenum">1924</span></a>          <a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a> = 'quiza.quiz = :quizaquiz';
<a name="l1925"><span class="linenum">1925</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array('quizaquiz' =&gt; <a class="var it932" onMouseOver="hilite(932)" onMouseOut="lolite()" onClick="logVariable('quizid')" href="../../_variables/quizid.html">$quizid</a>);
<a name="l1926"><span class="linenum">1926</span></a>  
<a name="l1927"><span class="linenum">1927</span></a>          if (!<a class="var it6228" onMouseOver="hilite(6228)" onMouseOut="lolite()" onClick="logVariable('includepreviews')" href="../../_variables/includepreviews.html">$includepreviews</a>) {
<a name="l1928"><span class="linenum">1928</span></a>              <a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a> .= ' AND preview = 0';
<a name="l1929"><span class="linenum">1929</span></a>          }
<a name="l1930"><span class="linenum">1930</span></a>  
<a name="l1931"><span class="linenum">1931</span></a>          if (<a class="var it41463" onMouseOver="hilite(41463)" onMouseOut="lolite()" onClick="logVariable('onlyfinished')" href="../../_variables/onlyfinished.html">$onlyfinished</a>) {
<a name="l1932"><span class="linenum">1932</span></a>              <a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a> .= ' AND state == :statefinished';
<a name="l1933"><span class="linenum">1933</span></a>              <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['statefinished'] = <a class="class" onClick="logClass('quiz_attempt')" href="../../_classes/quiz_attempt.html" onMouseOver="classPopup(event,'quiz_attempt')">quiz_attempt</a>::FINISHED;
<a name="l1934"><span class="linenum">1934</span></a>          }
<a name="l1935"><span class="linenum">1935</span></a>  
<a name="l1936"><span class="linenum">1936</span></a>          parent::<a class="function" onClick="logFunction('__construct')" href="../../_functions/__construct.html" onMouseOver="funcPopup(event,'__construct')">__construct</a>('{quiz_attempts} quiza', 'quiza.uniqueid', <a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l1937"><span class="linenum">1937</span></a>      }
<a name="l1938"><span class="linenum">1938</span></a>  }
<a name="l1939"><span class="linenum">1939</span></a>  
<a name="l1940"><span class="linenum">1940</span></a>  <span class="comment">/**</span>
<a name="l1941"><span class="linenum">1941</span></a>  <span class="comment"> * Creates a textual representation of a question for display.</span>
<a name="l1942"><span class="linenum">1942</span></a>  <span class="comment"> *</span>
<a name="l1943"><span class="linenum">1943</span></a>  <span class="comment"> * @param object $question A question object from the database questions table</span>
<a name="l1944"><span class="linenum">1944</span></a>  <span class="comment"> * @param bool $showicon If true, show the question's icon with the question. False by default.</span>
<a name="l1945"><span class="linenum">1945</span></a>  <span class="comment"> * @param bool $showquestiontext If true (default), show question text after question name.</span>
<a name="l1946"><span class="linenum">1946</span></a>  <span class="comment"> *       If false, show only question name.</span>
<a name="l1947"><span class="linenum">1947</span></a>  <span class="comment"> * @return string</span>
<a name="l1948"><span class="linenum">1948</span></a>  <span class="comment"> */</span>
<a name="l1949"><span class="linenum">1949</span></a>  function <a class="function" onClick="logFunction('quiz_question_tostring')" href="../../_functions/quiz_question_tostring.html" onMouseOver="funcPopup(event,'quiz_question_tostring')">quiz_question_tostring</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>, <a class="var it41464" onMouseOver="hilite(41464)" onMouseOut="lolite()" onClick="logVariable('showicon')" href="../../_variables/showicon.html">$showicon</a> = false, <a class="var it29555" onMouseOver="hilite(29555)" onMouseOut="lolite()" onClick="logVariable('showquestiontext')" href="../../_variables/showquestiontext.html">$showquestiontext</a> = true) {
<a name="l1950"><span class="linenum">1950</span></a>      <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = '';
<a name="l1951"><span class="linenum">1951</span></a>  
<a name="l1952"><span class="linenum">1952</span></a>      <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a> = <a class="function" onClick="logFunction('shorten_text')" href="../../_functions/shorten_text.html" onMouseOver="funcPopup(event,'shorten_text')">shorten_text</a>(<a class="function" onClick="logFunction('format_string')" href="../../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('name')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>), 200);
<a name="l1953"><span class="linenum">1953</span></a>      if (<a class="var it41464" onMouseOver="hilite(41464)" onMouseOut="lolite()" onClick="logVariable('showicon')" href="../../_variables/showicon.html">$showicon</a>) {
<a name="l1954"><span class="linenum">1954</span></a>          <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a> .= <a class="function" onClick="logFunction('print_question_icon')" href="../../_functions/print_question_icon.html" onMouseOver="funcPopup(event,'print_question_icon')">print_question_icon</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>) . ' ' . <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>;
<a name="l1955"><span class="linenum">1955</span></a>      }
<a name="l1956"><span class="linenum">1956</span></a>      <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> .= <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('span')" href="../../_functions/span.html" onMouseOver="funcPopup(event,'span')">span</a>(<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>, 'questionname');
<a name="l1957"><span class="linenum">1957</span></a>  
<a name="l1958"><span class="linenum">1958</span></a>      if (<a class="var it29555" onMouseOver="hilite(29555)" onMouseOut="lolite()" onClick="logVariable('showquestiontext')" href="../../_variables/showquestiontext.html">$showquestiontext</a>) {
<a name="l1959"><span class="linenum">1959</span></a>          <a class="var it446" onMouseOver="hilite(446)" onMouseOut="lolite()" onClick="logVariable('questiontext')" href="../../_variables/questiontext.html">$questiontext</a> = question_utils::<a class="function" onClick="logFunction('to_plain_text')" href="../../_functions/to_plain_text.html" onMouseOver="funcPopup(event,'to_plain_text')">to_plain_text</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('questiontext')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../../_variables/questiontext.html">questiontext</a>,
<a name="l1960"><span class="linenum">1960</span></a>                  <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('questiontextformat')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../../_variables/questiontextformat.html">questiontextformat</a>, array('noclean' =&gt; true, 'para' =&gt; false));
<a name="l1961"><span class="linenum">1961</span></a>          <a class="var it446" onMouseOver="hilite(446)" onMouseOut="lolite()" onClick="logVariable('questiontext')" href="../../_variables/questiontext.html">$questiontext</a> = <a class="function" onClick="logFunction('shorten_text')" href="../../_functions/shorten_text.html" onMouseOver="funcPopup(event,'shorten_text')">shorten_text</a>(<a class="var it446" onMouseOver="hilite(446)" onMouseOut="lolite()" onClick="logVariable('questiontext')" href="../../_variables/questiontext.html">$questiontext</a>, 200);
<a name="l1962"><span class="linenum">1962</span></a>          if (<a class="var it446" onMouseOver="hilite(446)" onMouseOut="lolite()" onClick="logVariable('questiontext')" href="../../_variables/questiontext.html">$questiontext</a>) {
<a name="l1963"><span class="linenum">1963</span></a>              <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> .= ' ' . <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('span')" href="../../_functions/span.html" onMouseOver="funcPopup(event,'span')">span</a>(<a class="function" onClick="logFunction('s')" href="../../_functions/s.html" onMouseOver="funcPopup(event,'s')">s</a>(<a class="var it446" onMouseOver="hilite(446)" onMouseOut="lolite()" onClick="logVariable('questiontext')" href="../../_variables/questiontext.html">$questiontext</a>), 'questiontext');
<a name="l1964"><span class="linenum">1964</span></a>          }
<a name="l1965"><span class="linenum">1965</span></a>      }
<a name="l1966"><span class="linenum">1966</span></a>  
<a name="l1967"><span class="linenum">1967</span></a>      return <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l1968"><span class="linenum">1968</span></a>  }
<a name="l1969"><span class="linenum">1969</span></a>  
<a name="l1970"><span class="linenum">1970</span></a>  <span class="comment">/**</span>
<a name="l1971"><span class="linenum">1971</span></a>  <span class="comment"> * Verify that the question exists, and the user has permission to use it.</span>
<a name="l1972"><span class="linenum">1972</span></a>  <span class="comment"> * Does not return. Throws an exception if the question cannot be used.</span>
<a name="l1973"><span class="linenum">1973</span></a>  <span class="comment"> * @param int $questionid The id of the question.</span>
<a name="l1974"><span class="linenum">1974</span></a>  <span class="comment"> */</span>
<a name="l1975"><span class="linenum">1975</span></a>  function <a class="function" onClick="logFunction('quiz_require_question_use')" href="../../_functions/quiz_require_question_use.html" onMouseOver="funcPopup(event,'quiz_require_question_use')">quiz_require_question_use</a>(<a class="var it530" onMouseOver="hilite(530)" onMouseOut="lolite()" onClick="logVariable('questionid')" href="../../_variables/questionid.html">$questionid</a>) {
<a name="l1976"><span class="linenum">1976</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1977"><span class="linenum">1977</span></a>      <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('question', array('id' =&gt; <a class="var it530" onMouseOver="hilite(530)" onMouseOut="lolite()" onClick="logVariable('questionid')" href="../../_variables/questionid.html">$questionid</a>), '*', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l1978"><span class="linenum">1978</span></a>      <a class="function" onClick="logFunction('question_require_capability_on')" href="../../_functions/question_require_capability_on.html" onMouseOver="funcPopup(event,'question_require_capability_on')">question_require_capability_on</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>, 'use');
<a name="l1979"><span class="linenum">1979</span></a>  }
<a name="l1980"><span class="linenum">1980</span></a>  
<a name="l1981"><span class="linenum">1981</span></a>  <span class="comment">/**</span>
<a name="l1982"><span class="linenum">1982</span></a>  <span class="comment"> * Verify that the question exists, and the user has permission to use it.</span>
<a name="l1983"><span class="linenum">1983</span></a>  <span class="comment"> * @param object $quiz the quiz settings.</span>
<a name="l1984"><span class="linenum">1984</span></a>  <span class="comment"> * @param int $slot which question in the quiz to test.</span>
<a name="l1985"><span class="linenum">1985</span></a>  <span class="comment"> * @return bool whether the user can use this question.</span>
<a name="l1986"><span class="linenum">1986</span></a>  <span class="comment"> */</span>
<a name="l1987"><span class="linenum">1987</span></a>  function <a class="function" onClick="logFunction('quiz_has_question_use')" href="../../_functions/quiz_has_question_use.html" onMouseOver="funcPopup(event,'quiz_has_question_use')">quiz_has_question_use</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>) {
<a name="l1988"><span class="linenum">1988</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1989"><span class="linenum">1989</span></a>      <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record_sql')" href="../../_functions/get_record_sql.html" onMouseOver="funcPopup(event,'get_record_sql')">get_record_sql</a>(&quot;
<a name="l1990"><span class="linenum">1990</span></a>              SELECT q.*
<a name="l1991"><span class="linenum">1991</span></a>                FROM {quiz_slots} slot
<a name="l1992"><span class="linenum">1992</span></a>                JOIN {question} q ON q.id = slot.questionid
<a name="l1993"><span class="linenum">1993</span></a>               WHERE slot.quizid = ? AND slot.slot = ?&quot;, array(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>));
<a name="l1994"><span class="linenum">1994</span></a>      if (!<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>) {
<a name="l1995"><span class="linenum">1995</span></a>          return false;
<a name="l1996"><span class="linenum">1996</span></a>      }
<a name="l1997"><span class="linenum">1997</span></a>      return <a class="function" onClick="logFunction('question_has_capability_on')" href="../../_functions/question_has_capability_on.html" onMouseOver="funcPopup(event,'question_has_capability_on')">question_has_capability_on</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>, 'use');
<a name="l1998"><span class="linenum">1998</span></a>  }
<a name="l1999"><span class="linenum">1999</span></a>  
<a name="l2000"><span class="linenum">2000</span></a>  <span class="comment">/**</span>
<a name="l2001"><span class="linenum">2001</span></a>  <span class="comment"> * Add a question to a quiz</span>
<a name="l2002"><span class="linenum">2002</span></a>  <span class="comment"> *</span>
<a name="l2003"><span class="linenum">2003</span></a>  <span class="comment"> * Adds a question to a quiz by updating $quiz as well as the</span>
<a name="l2004"><span class="linenum">2004</span></a>  <span class="comment"> * quiz and quiz_slots tables. It also adds a page break if required.</span>
<a name="l2005"><span class="linenum">2005</span></a>  <span class="comment"> * @param int $questionid The id of the question to be added</span>
<a name="l2006"><span class="linenum">2006</span></a>  <span class="comment"> * @param object $quiz The extended quiz object as used by edit.php</span>
<a name="l2007"><span class="linenum">2007</span></a>  <span class="comment"> *      This is updated by this function</span>
<a name="l2008"><span class="linenum">2008</span></a>  <span class="comment"> * @param int $page Which page in quiz to add the question on. If 0 (default),</span>
<a name="l2009"><span class="linenum">2009</span></a>  <span class="comment"> *      add at the end</span>
<a name="l2010"><span class="linenum">2010</span></a>  <span class="comment"> * @param float $maxmark The maximum mark to set for this question. (Optional,</span>
<a name="l2011"><span class="linenum">2011</span></a>  <span class="comment"> *      defaults to question.defaultmark.</span>
<a name="l2012"><span class="linenum">2012</span></a>  <span class="comment"> * @return bool false if the question was already in the quiz</span>
<a name="l2013"><span class="linenum">2013</span></a>  <span class="comment"> */</span>
<a name="l2014"><span class="linenum">2014</span></a>  function <a class="function" onClick="logFunction('quiz_add_quiz_question')" href="../../_functions/quiz_add_quiz_question.html" onMouseOver="funcPopup(event,'quiz_add_quiz_question')">quiz_add_quiz_question</a>(<a class="var it530" onMouseOver="hilite(530)" onMouseOut="lolite()" onClick="logVariable('questionid')" href="../../_variables/questionid.html">$questionid</a>, <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a> = 0, <a class="var it455" onMouseOver="hilite(455)" onMouseOut="lolite()" onClick="logVariable('maxmark')" href="../../_variables/maxmark.html">$maxmark</a> = null) {
<a name="l2015"><span class="linenum">2015</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l2016"><span class="linenum">2016</span></a>      <a class="var it933" onMouseOver="hilite(933)" onMouseOut="lolite()" onClick="logVariable('slots')" href="../../_variables/slots.html">$slots</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('quiz_slots', array('quizid' =&gt; <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>),
<a name="l2017"><span class="linenum">2017</span></a>              'slot', 'questionid, slot, page, id');
<a name="l2018"><span class="linenum">2018</span></a>      if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it530" onMouseOver="hilite(530)" onMouseOut="lolite()" onClick="logVariable('questionid')" href="../../_variables/questionid.html">$questionid</a>, <a class="var it933" onMouseOver="hilite(933)" onMouseOut="lolite()" onClick="logVariable('slots')" href="../../_variables/slots.html">$slots</a>)) {
<a name="l2019"><span class="linenum">2019</span></a>          return false;
<a name="l2020"><span class="linenum">2020</span></a>      }
<a name="l2021"><span class="linenum">2021</span></a>  
<a name="l2022"><span class="linenum">2022</span></a>      <a class="var it18640" onMouseOver="hilite(18640)" onMouseOut="lolite()" onClick="logVariable('trans')" href="../../_variables/trans.html">$trans</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('start_delegated_transaction')" href="../../_functions/start_delegated_transaction.html" onMouseOver="funcPopup(event,'start_delegated_transaction')">start_delegated_transaction</a>();
<a name="l2023"><span class="linenum">2023</span></a>  
<a name="l2024"><span class="linenum">2024</span></a>      <a class="var it12666" onMouseOver="hilite(12666)" onMouseOut="lolite()" onClick="logVariable('maxpage')" href="../../_variables/maxpage.html">$maxpage</a> = 1;
<a name="l2025"><span class="linenum">2025</span></a>      <a class="var it41465" onMouseOver="hilite(41465)" onMouseOut="lolite()" onClick="logVariable('numonlastpage')" href="../../_variables/numonlastpage.html">$numonlastpage</a> = 0;
<a name="l2026"><span class="linenum">2026</span></a>      foreach (<a class="var it933" onMouseOver="hilite(933)" onMouseOut="lolite()" onClick="logVariable('slots')" href="../../_variables/slots.html">$slots</a> as <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>) {
<a name="l2027"><span class="linenum">2027</span></a>          if (<a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>-&gt;<a onClick="logVariable('page')" class="var it43545" onMouseOver="hilite(43545)" onMouseOut="lolite()" href="../../_variables/page.html">page</a> &gt; <a class="var it12666" onMouseOver="hilite(12666)" onMouseOut="lolite()" onClick="logVariable('maxpage')" href="../../_variables/maxpage.html">$maxpage</a>) {
<a name="l2028"><span class="linenum">2028</span></a>              <a class="var it12666" onMouseOver="hilite(12666)" onMouseOut="lolite()" onClick="logVariable('maxpage')" href="../../_variables/maxpage.html">$maxpage</a> = <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>-&gt;<a onClick="logVariable('page')" class="var it43545" onMouseOver="hilite(43545)" onMouseOut="lolite()" href="../../_variables/page.html">page</a>;
<a name="l2029"><span class="linenum">2029</span></a>              <a class="var it41465" onMouseOver="hilite(41465)" onMouseOut="lolite()" onClick="logVariable('numonlastpage')" href="../../_variables/numonlastpage.html">$numonlastpage</a> = 1;
<a name="l2030"><span class="linenum">2030</span></a>          } else {
<a name="l2031"><span class="linenum">2031</span></a>              <a class="var it41465" onMouseOver="hilite(41465)" onMouseOut="lolite()" onClick="logVariable('numonlastpage')" href="../../_variables/numonlastpage.html">$numonlastpage</a> += 1;
<a name="l2032"><span class="linenum">2032</span></a>          }
<a name="l2033"><span class="linenum">2033</span></a>      }
<a name="l2034"><span class="linenum">2034</span></a>  
<a name="l2035"><span class="linenum">2035</span></a>  <span class="comment">    // Add the new question instance.</span>
<a name="l2036"><span class="linenum">2036</span></a>      <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a> = new stdClass();
<a name="l2037"><span class="linenum">2037</span></a>      <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>-&gt;<a onClick="logVariable('quizid')" class="var it43545" onMouseOver="hilite(43545)" onMouseOut="lolite()" href="../../_variables/quizid.html">quizid</a> = <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l2038"><span class="linenum">2038</span></a>      <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>-&gt;<a onClick="logVariable('questionid')" class="var it43545" onMouseOver="hilite(43545)" onMouseOut="lolite()" href="../../_variables/questionid.html">questionid</a> = <a class="var it530" onMouseOver="hilite(530)" onMouseOut="lolite()" onClick="logVariable('questionid')" href="../../_variables/questionid.html">$questionid</a>;
<a name="l2039"><span class="linenum">2039</span></a>  
<a name="l2040"><span class="linenum">2040</span></a>      if (<a class="var it455" onMouseOver="hilite(455)" onMouseOut="lolite()" onClick="logVariable('maxmark')" href="../../_variables/maxmark.html">$maxmark</a> !== null) {
<a name="l2041"><span class="linenum">2041</span></a>          <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>-&gt;<a onClick="logVariable('maxmark')" class="var it43545" onMouseOver="hilite(43545)" onMouseOut="lolite()" href="../../_variables/maxmark.html">maxmark</a> = <a class="var it455" onMouseOver="hilite(455)" onMouseOut="lolite()" onClick="logVariable('maxmark')" href="../../_variables/maxmark.html">$maxmark</a>;
<a name="l2042"><span class="linenum">2042</span></a>      } else {
<a name="l2043"><span class="linenum">2043</span></a>          <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>-&gt;<a onClick="logVariable('maxmark')" class="var it43545" onMouseOver="hilite(43545)" onMouseOut="lolite()" href="../../_variables/maxmark.html">maxmark</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_field')" href="../../_functions/get_field.html" onMouseOver="funcPopup(event,'get_field')">get_field</a>('question', 'defaultmark', array('id' =&gt; <a class="var it530" onMouseOver="hilite(530)" onMouseOut="lolite()" onClick="logVariable('questionid')" href="../../_variables/questionid.html">$questionid</a>));
<a name="l2044"><span class="linenum">2044</span></a>      }
<a name="l2045"><span class="linenum">2045</span></a>  
<a name="l2046"><span class="linenum">2046</span></a>      if (is_int(<a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>) &amp;&amp; <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a> &gt;= 1) {
<a name="l2047"><span class="linenum">2047</span></a>  <span class="comment">        // Adding on a given page.</span>
<a name="l2048"><span class="linenum">2048</span></a>          <a class="var it41466" onMouseOver="hilite(41466)" onMouseOut="lolite()" onClick="logVariable('lastslotbefore')" href="../../_variables/lastslotbefore.html">$lastslotbefore</a> = 0;
<a name="l2049"><span class="linenum">2049</span></a>          foreach (<a class="phpfunction" onClick="logFunction('array_reverse')" href="../../_functions/array_reverse.html" onMouseOver="phpfuncPopup(event,'array_reverse')">array_reverse</a>(<a class="var it933" onMouseOver="hilite(933)" onMouseOut="lolite()" onClick="logVariable('slots')" href="../../_variables/slots.html">$slots</a>) as <a class="var it41467" onMouseOver="hilite(41467)" onMouseOut="lolite()" onClick="logVariable('otherslot')" href="../../_variables/otherslot.html">$otherslot</a>) {
<a name="l2050"><span class="linenum">2050</span></a>              if (<a class="var it41467" onMouseOver="hilite(41467)" onMouseOut="lolite()" onClick="logVariable('otherslot')" href="../../_variables/otherslot.html">$otherslot</a>-&gt;<a onClick="logVariable('page')" class="var it45195" onMouseOver="hilite(45195)" onMouseOut="lolite()" href="../../_variables/page.html">page</a> &gt; <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>) {
<a name="l2051"><span class="linenum">2051</span></a>                  <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('quiz_slots', 'slot', <a class="var it41467" onMouseOver="hilite(41467)" onMouseOut="lolite()" onClick="logVariable('otherslot')" href="../../_variables/otherslot.html">$otherslot</a>-&gt;<a onClick="logVariable('slot')" class="var it45195" onMouseOver="hilite(45195)" onMouseOut="lolite()" href="../../_variables/slot.html">slot</a> + 1, array('id' =&gt; <a class="var it41467" onMouseOver="hilite(41467)" onMouseOut="lolite()" onClick="logVariable('otherslot')" href="../../_variables/otherslot.html">$otherslot</a>-&gt;<a onClick="logVariable('id')" class="var it45195" onMouseOver="hilite(45195)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l2052"><span class="linenum">2052</span></a>              } else {
<a name="l2053"><span class="linenum">2053</span></a>                  <a class="var it41466" onMouseOver="hilite(41466)" onMouseOut="lolite()" onClick="logVariable('lastslotbefore')" href="../../_variables/lastslotbefore.html">$lastslotbefore</a> = <a class="var it41467" onMouseOver="hilite(41467)" onMouseOut="lolite()" onClick="logVariable('otherslot')" href="../../_variables/otherslot.html">$otherslot</a>-&gt;<a onClick="logVariable('slot')" class="var it45195" onMouseOver="hilite(45195)" onMouseOut="lolite()" href="../../_variables/slot.html">slot</a>;
<a name="l2054"><span class="linenum">2054</span></a>                  break;
<a name="l2055"><span class="linenum">2055</span></a>              }
<a name="l2056"><span class="linenum">2056</span></a>          }
<a name="l2057"><span class="linenum">2057</span></a>          <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>-&gt;<a onClick="logVariable('slot')" class="var it43545" onMouseOver="hilite(43545)" onMouseOut="lolite()" href="../../_variables/slot.html">slot</a> = <a class="var it41466" onMouseOver="hilite(41466)" onMouseOut="lolite()" onClick="logVariable('lastslotbefore')" href="../../_variables/lastslotbefore.html">$lastslotbefore</a> + 1;
<a name="l2058"><span class="linenum">2058</span></a>          <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>-&gt;<a onClick="logVariable('page')" class="var it43545" onMouseOver="hilite(43545)" onMouseOut="lolite()" href="../../_variables/page.html">page</a> = <a class="phpfunction" onClick="logFunction('min')" href="../../_functions/min.html" onMouseOver="phpfuncPopup(event,'min')">min</a>(<a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>, <a class="var it12666" onMouseOver="hilite(12666)" onMouseOut="lolite()" onClick="logVariable('maxpage')" href="../../_variables/maxpage.html">$maxpage</a> + 1);
<a name="l2059"><span class="linenum">2059</span></a>  
<a name="l2060"><span class="linenum">2060</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>(&quot;
<a name="l2061"><span class="linenum">2061</span></a>                  UPDATE {quiz_sections}
<a name="l2062"><span class="linenum">2062</span></a>                     SET firstslot = firstslot + 1
<a name="l2063"><span class="linenum">2063</span></a>                   WHERE quizid = ?
<a name="l2064"><span class="linenum">2064</span></a>                     AND firstslot &gt; ?
<a name="l2065"><span class="linenum">2065</span></a>                  &quot;, array(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="phpfunction" onClick="logFunction('max')" href="../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">max</a>(<a class="var it41466" onMouseOver="hilite(41466)" onMouseOut="lolite()" onClick="logVariable('lastslotbefore')" href="../../_variables/lastslotbefore.html">$lastslotbefore</a>, 1)));
<a name="l2066"><span class="linenum">2066</span></a>  
<a name="l2067"><span class="linenum">2067</span></a>      } else {
<a name="l2068"><span class="linenum">2068</span></a>          <a class="var it18262" onMouseOver="hilite(18262)" onMouseOut="lolite()" onClick="logVariable('lastslot')" href="../../_variables/lastslot.html">$lastslot</a> = <a class="phpfunction" onClick="logFunction('end')" href="../../_functions/end.html" onMouseOver="phpfuncPopup(event,'end')">end</a>(<a class="var it933" onMouseOver="hilite(933)" onMouseOut="lolite()" onClick="logVariable('slots')" href="../../_variables/slots.html">$slots</a>);
<a name="l2069"><span class="linenum">2069</span></a>          if (<a class="var it18262" onMouseOver="hilite(18262)" onMouseOut="lolite()" onClick="logVariable('lastslot')" href="../../_variables/lastslot.html">$lastslot</a>) {
<a name="l2070"><span class="linenum">2070</span></a>              <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>-&gt;<a onClick="logVariable('slot')" class="var it43545" onMouseOver="hilite(43545)" onMouseOut="lolite()" href="../../_variables/slot.html">slot</a> = <a class="var it18262" onMouseOver="hilite(18262)" onMouseOut="lolite()" onClick="logVariable('lastslot')" href="../../_variables/lastslot.html">$lastslot</a>-&gt;<a onClick="logVariable('slot')" class="var it45196" onMouseOver="hilite(45196)" onMouseOut="lolite()" href="../../_variables/slot.html">slot</a> + 1;
<a name="l2071"><span class="linenum">2071</span></a>          } else {
<a name="l2072"><span class="linenum">2072</span></a>              <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>-&gt;<a onClick="logVariable('slot')" class="var it43545" onMouseOver="hilite(43545)" onMouseOut="lolite()" href="../../_variables/slot.html">slot</a> = 1;
<a name="l2073"><span class="linenum">2073</span></a>          }
<a name="l2074"><span class="linenum">2074</span></a>          if (<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('questionsperpage')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/questionsperpage.html">questionsperpage</a> &amp;&amp; <a class="var it41465" onMouseOver="hilite(41465)" onMouseOut="lolite()" onClick="logVariable('numonlastpage')" href="../../_variables/numonlastpage.html">$numonlastpage</a> &gt;= <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('questionsperpage')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/questionsperpage.html">questionsperpage</a>) {
<a name="l2075"><span class="linenum">2075</span></a>              <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>-&gt;<a onClick="logVariable('page')" class="var it43545" onMouseOver="hilite(43545)" onMouseOut="lolite()" href="../../_variables/page.html">page</a> = <a class="var it12666" onMouseOver="hilite(12666)" onMouseOut="lolite()" onClick="logVariable('maxpage')" href="../../_variables/maxpage.html">$maxpage</a> + 1;
<a name="l2076"><span class="linenum">2076</span></a>          } else {
<a name="l2077"><span class="linenum">2077</span></a>              <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>-&gt;<a onClick="logVariable('page')" class="var it43545" onMouseOver="hilite(43545)" onMouseOut="lolite()" href="../../_variables/page.html">page</a> = <a class="var it12666" onMouseOver="hilite(12666)" onMouseOut="lolite()" onClick="logVariable('maxpage')" href="../../_variables/maxpage.html">$maxpage</a>;
<a name="l2078"><span class="linenum">2078</span></a>          }
<a name="l2079"><span class="linenum">2079</span></a>      }
<a name="l2080"><span class="linenum">2080</span></a>  
<a name="l2081"><span class="linenum">2081</span></a>      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('quiz_slots', <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>);
<a name="l2082"><span class="linenum">2082</span></a>      <a class="var it18640" onMouseOver="hilite(18640)" onMouseOut="lolite()" onClick="logVariable('trans')" href="../../_variables/trans.html">$trans</a>-&gt;<a class="function" onClick="logFunction('allow_commit')" href="../../_functions/allow_commit.html" onMouseOver="funcPopup(event,'allow_commit')">allow_commit</a>();
<a name="l2083"><span class="linenum">2083</span></a>  }
<a name="l2084"><span class="linenum">2084</span></a>  
<a name="l2085"><span class="linenum">2085</span></a>  <span class="comment">/**</span>
<a name="l2086"><span class="linenum">2086</span></a>  <span class="comment"> * Add a random question to the quiz at a given point.</span>
<a name="l2087"><span class="linenum">2087</span></a>  <span class="comment"> * @param object $quiz the quiz settings.</span>
<a name="l2088"><span class="linenum">2088</span></a>  <span class="comment"> * @param int $addonpage the page on which to add the question.</span>
<a name="l2089"><span class="linenum">2089</span></a>  <span class="comment"> * @param int $categoryid the question category to add the question from.</span>
<a name="l2090"><span class="linenum">2090</span></a>  <span class="comment"> * @param int $number the number of random questions to add.</span>
<a name="l2091"><span class="linenum">2091</span></a>  <span class="comment"> * @param bool $includesubcategories whether to include questoins from subcategories.</span>
<a name="l2092"><span class="linenum">2092</span></a>  <span class="comment"> */</span>
<a name="l2093"><span class="linenum">2093</span></a>  function <a class="function" onClick="logFunction('quiz_add_random_questions')" href="../../_functions/quiz_add_random_questions.html" onMouseOver="funcPopup(event,'quiz_add_random_questions')">quiz_add_random_questions</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it35688" onMouseOver="hilite(35688)" onMouseOut="lolite()" onClick="logVariable('addonpage')" href="../../_variables/addonpage.html">$addonpage</a>, <a class="var it904" onMouseOver="hilite(904)" onMouseOut="lolite()" onClick="logVariable('categoryid')" href="../../_variables/categoryid.html">$categoryid</a>, <a class="var it548" onMouseOver="hilite(548)" onMouseOut="lolite()" onClick="logVariable('number')" href="../../_variables/number.html">$number</a>,
<a name="l2094"><span class="linenum">2094</span></a>          <a class="var it7541" onMouseOver="hilite(7541)" onMouseOut="lolite()" onClick="logVariable('includesubcategories')" href="../../_variables/includesubcategories.html">$includesubcategories</a>) {
<a name="l2095"><span class="linenum">2095</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l2096"><span class="linenum">2096</span></a>  
<a name="l2097"><span class="linenum">2097</span></a>      <a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../../_variables/category.html">$category</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('question_categories', array('id' =&gt; <a class="var it904" onMouseOver="hilite(904)" onMouseOut="lolite()" onClick="logVariable('categoryid')" href="../../_variables/categoryid.html">$categoryid</a>));
<a name="l2098"><span class="linenum">2098</span></a>      if (!<a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../../_variables/category.html">$category</a>) {
<a name="l2099"><span class="linenum">2099</span></a>          <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('invalidcategoryid', 'error');
<a name="l2100"><span class="linenum">2100</span></a>      }
<a name="l2101"><span class="linenum">2101</span></a>  
<a name="l2102"><span class="linenum">2102</span></a>      <a class="var it5500" onMouseOver="hilite(5500)" onMouseOut="lolite()" onClick="logVariable('catcontext')" href="../../_variables/catcontext.html">$catcontext</a> = context::<a class="function" onClick="logFunction('instance_by_id')" href="../../_functions/instance_by_id.html" onMouseOver="funcPopup(event,'instance_by_id')">instance_by_id</a>(<a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../../_variables/category.html">$category</a>-&gt;<a onClick="logVariable('contextid')" class="var it42970" onMouseOver="hilite(42970)" onMouseOut="lolite()" href="../../_variables/contextid.html">contextid</a>);
<a name="l2103"><span class="linenum">2103</span></a>      <a class="function" onClick="logFunction('require_capability')" href="../../_functions/require_capability.html" onMouseOver="funcPopup(event,'require_capability')">require_capability</a>('moodle/question:useall', <a class="var it5500" onMouseOver="hilite(5500)" onMouseOut="lolite()" onClick="logVariable('catcontext')" href="../../_variables/catcontext.html">$catcontext</a>);
<a name="l2104"><span class="linenum">2104</span></a>  
<a name="l2105"><span class="linenum">2105</span></a>  <span class="comment">    // Find existing random questions in this category that are</span>
<a name="l2106"><span class="linenum">2106</span></a>  <span class="comment">    // not used by any quiz.</span>
<a name="l2107"><span class="linenum">2107</span></a>      if (<a class="var it41468" onMouseOver="hilite(41468)" onMouseOut="lolite()" onClick="logVariable('existingquestions')" href="../../_variables/existingquestions.html">$existingquestions</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(
<a name="l2108"><span class="linenum">2108</span></a>              &quot;SELECT q.id, q.qtype FROM {question} q
<a name="l2109"><span class="linenum">2109</span></a>              WHERE qtype = 'random'
<a name="l2110"><span class="linenum">2110</span></a>                  AND category = ?
<a name="l2111"><span class="linenum">2111</span></a>                  AND &quot; . <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_compare_text')" href="../../_functions/sql_compare_text.html" onMouseOver="funcPopup(event,'sql_compare_text')">sql_compare_text</a>('questiontext') . &quot; = ?
<a name="l2112"><span class="linenum">2112</span></a>                  AND NOT <a class="function" onClick="logFunction('EXISTS')" href="../../_functions/exists.html" onMouseOver="funcPopup(event,'exists')">EXISTS</a> (
<a name="l2113"><span class="linenum">2113</span></a>                          SELECT *
<a name="l2114"><span class="linenum">2114</span></a>                            FROM {quiz_slots}
<a name="l2115"><span class="linenum">2115</span></a>                           WHERE questionid = q.id)
<a name="l2116"><span class="linenum">2116</span></a>              ORDER BY id&quot;, array(<a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../../_variables/category.html">$category</a>-&gt;<a onClick="logVariable('id')" class="var it42970" onMouseOver="hilite(42970)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, (<a class="var it7541" onMouseOver="hilite(7541)" onMouseOut="lolite()" onClick="logVariable('includesubcategories')" href="../../_variables/includesubcategories.html">$includesubcategories</a> ? '1' : '0')))) {
<a name="l2117"><span class="linenum">2117</span></a>  <span class="comment">            // Take as many of these as needed.</span>
<a name="l2118"><span class="linenum">2118</span></a>          while ((<a class="var it41469" onMouseOver="hilite(41469)" onMouseOut="lolite()" onClick="logVariable('existingquestion')" href="../../_variables/existingquestion.html">$existingquestion</a> = <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it41468" onMouseOver="hilite(41468)" onMouseOut="lolite()" onClick="logVariable('existingquestions')" href="../../_variables/existingquestions.html">$existingquestions</a>)) &amp;&amp; <a class="var it548" onMouseOver="hilite(548)" onMouseOut="lolite()" onClick="logVariable('number')" href="../../_variables/number.html">$number</a> &gt; 0) {
<a name="l2119"><span class="linenum">2119</span></a>              <a class="function" onClick="logFunction('quiz_add_quiz_question')" href="../../_functions/quiz_add_quiz_question.html" onMouseOver="funcPopup(event,'quiz_add_quiz_question')">quiz_add_quiz_question</a>(<a class="var it41469" onMouseOver="hilite(41469)" onMouseOut="lolite()" onClick="logVariable('existingquestion')" href="../../_variables/existingquestion.html">$existingquestion</a>-&gt;<a onClick="logVariable('id')" class="var it45197" onMouseOver="hilite(45197)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it35688" onMouseOver="hilite(35688)" onMouseOut="lolite()" onClick="logVariable('addonpage')" href="../../_variables/addonpage.html">$addonpage</a>);
<a name="l2120"><span class="linenum">2120</span></a>              <a class="var it548" onMouseOver="hilite(548)" onMouseOut="lolite()" onClick="logVariable('number')" href="../../_variables/number.html">$number</a> -= 1;
<a name="l2121"><span class="linenum">2121</span></a>          }
<a name="l2122"><span class="linenum">2122</span></a>      }
<a name="l2123"><span class="linenum">2123</span></a>  
<a name="l2124"><span class="linenum">2124</span></a>      if (<a class="var it548" onMouseOver="hilite(548)" onMouseOut="lolite()" onClick="logVariable('number')" href="../../_variables/number.html">$number</a> &lt;= 0) {
<a name="l2125"><span class="linenum">2125</span></a>          return;
<a name="l2126"><span class="linenum">2126</span></a>      }
<a name="l2127"><span class="linenum">2127</span></a>  
<a name="l2128"><span class="linenum">2128</span></a>  <span class="comment">    // More random questions are needed, create them.</span>
<a name="l2129"><span class="linenum">2129</span></a>      for (<a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> = 0; <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> &lt; <a class="var it548" onMouseOver="hilite(548)" onMouseOut="lolite()" onClick="logVariable('number')" href="../../_variables/number.html">$number</a>; <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> += 1) {
<a name="l2130"><span class="linenum">2130</span></a>          <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../_variables/form.html">$form</a> = new stdClass();
<a name="l2131"><span class="linenum">2131</span></a>          <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../_variables/form.html">$form</a>-&gt;<a onClick="logVariable('questiontext')" class="var it43215" onMouseOver="hilite(43215)" onMouseOut="lolite()" href="../../_variables/questiontext.html">questiontext</a> = array('text' =&gt; (<a class="var it7541" onMouseOver="hilite(7541)" onMouseOut="lolite()" onClick="logVariable('includesubcategories')" href="../../_variables/includesubcategories.html">$includesubcategories</a> ? '1' : '0'), 'format' =&gt; 0);
<a name="l2132"><span class="linenum">2132</span></a>          <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../_variables/form.html">$form</a>-&gt;<a onClick="logVariable('category')" class="var it43215" onMouseOver="hilite(43215)" onMouseOut="lolite()" href="../../_variables/category.html">category</a> = <a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../../_variables/category.html">$category</a>-&gt;<a onClick="logVariable('id')" class="var it42970" onMouseOver="hilite(42970)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> . ',' . <a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../../_variables/category.html">$category</a>-&gt;<a onClick="logVariable('contextid')" class="var it42970" onMouseOver="hilite(42970)" onMouseOut="lolite()" href="../../_variables/contextid.html">contextid</a>;
<a name="l2133"><span class="linenum">2133</span></a>          <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../_variables/form.html">$form</a>-&gt;<a onClick="logVariable('defaultmark')" class="var it43215" onMouseOver="hilite(43215)" onMouseOut="lolite()" href="../../_variables/defaultmark.html">defaultmark</a> = 1;
<a name="l2134"><span class="linenum">2134</span></a>          <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../_variables/form.html">$form</a>-&gt;<a onClick="logVariable('hidden')" class="var it43215" onMouseOver="hilite(43215)" onMouseOut="lolite()" href="../../_variables/hidden.html">hidden</a> = 1;
<a name="l2135"><span class="linenum">2135</span></a>          <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../_variables/form.html">$form</a>-&gt;<a onClick="logVariable('stamp')" class="var it43215" onMouseOver="hilite(43215)" onMouseOut="lolite()" href="../../_variables/stamp.html">stamp</a> = <a class="function" onClick="logFunction('make_unique_id_code')" href="../../_functions/make_unique_id_code.html" onMouseOver="funcPopup(event,'make_unique_id_code')">make_unique_id_code</a>(); <span class="comment">// Set the unique code (not to be changed).</span>
<a name="l2136"><span class="linenum">2136</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a> = new stdClass();
<a name="l2137"><span class="linenum">2137</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('qtype')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../../_variables/qtype.html">qtype</a> = 'random';
<a name="l2138"><span class="linenum">2138</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a> = question_bank::<a class="function" onClick="logFunction('get_qtype')" href="../../_functions/get_qtype.html" onMouseOver="funcPopup(event,'get_qtype')">get_qtype</a>('random')-&gt;<a class="function" onClick="logFunction('save_question')" href="../../_functions/save_question.html" onMouseOver="funcPopup(event,'save_question')">save_question</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>, <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../_variables/form.html">$form</a>);
<a name="l2139"><span class="linenum">2139</span></a>          if (!isset(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>)) {
<a name="l2140"><span class="linenum">2140</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('cannotinsertrandomquestion', 'quiz');
<a name="l2141"><span class="linenum">2141</span></a>          }
<a name="l2142"><span class="linenum">2142</span></a>          <a class="function" onClick="logFunction('quiz_add_quiz_question')" href="../../_functions/quiz_add_quiz_question.html" onMouseOver="funcPopup(event,'quiz_add_quiz_question')">quiz_add_quiz_question</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it35688" onMouseOver="hilite(35688)" onMouseOut="lolite()" onClick="logVariable('addonpage')" href="../../_variables/addonpage.html">$addonpage</a>);
<a name="l2143"><span class="linenum">2143</span></a>      }
<a name="l2144"><span class="linenum">2144</span></a>  }
<a name="l2145"><span class="linenum">2145</span></a>  
<a name="l2146"><span class="linenum">2146</span></a>  <span class="comment">/**</span>
<a name="l2147"><span class="linenum">2147</span></a>  <span class="comment"> * Mark the activity completed (if required) and trigger the course_module_viewed event.</span>
<a name="l2148"><span class="linenum">2148</span></a>  <span class="comment"> *</span>
<a name="l2149"><span class="linenum">2149</span></a>  <span class="comment"> * @param  stdClass $quiz       quiz object</span>
<a name="l2150"><span class="linenum">2150</span></a>  <span class="comment"> * @param  stdClass $course     course object</span>
<a name="l2151"><span class="linenum">2151</span></a>  <span class="comment"> * @param  stdClass $cm         course module object</span>
<a name="l2152"><span class="linenum">2152</span></a>  <span class="comment"> * @param  stdClass $context    context object</span>
<a name="l2153"><span class="linenum">2153</span></a>  <span class="comment"> * @since Moodle 3.1</span>
<a name="l2154"><span class="linenum">2154</span></a>  <span class="comment"> */</span>
<a name="l2155"><span class="linenum">2155</span></a>  function <a class="function" onClick="logFunction('quiz_view')" href="../../_functions/quiz_view.html" onMouseOver="funcPopup(event,'quiz_view')">quiz_view</a>(<a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>) {
<a name="l2156"><span class="linenum">2156</span></a>  
<a name="l2157"><span class="linenum">2157</span></a>      <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array(
<a name="l2158"><span class="linenum">2158</span></a>          'objectid' =&gt; <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>-&gt;<a onClick="logVariable('id')" class="var it43017" onMouseOver="hilite(43017)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l2159"><span class="linenum">2159</span></a>          'context' =&gt; <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>
<a name="l2160"><span class="linenum">2160</span></a>      );
<a name="l2161"><span class="linenum">2161</span></a>  
<a name="l2162"><span class="linenum">2162</span></a>      <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a> = \mod_quiz\event\<a class="class" onClick="logClass('course_module_viewed')" href="../../_classes/course_module_viewed.html" onMouseOver="classPopup(event,'course_module_viewed')">course_module_viewed</a>::<a class="function" onClick="logFunction('create')" href="../../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l2163"><span class="linenum">2163</span></a>      <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('quiz', <a class="var it538" onMouseOver="hilite(538)" onMouseOut="lolite()" onClick="logVariable('quiz')" href="../../_variables/quiz.html">$quiz</a>);
<a name="l2164"><span class="linenum">2164</span></a>      <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l2165"><span class="linenum">2165</span></a>  
<a name="l2166"><span class="linenum">2166</span></a>  <span class="comment">    // Completion.</span>
<a name="l2167"><span class="linenum">2167</span></a>      <a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a> = <span class="keyword">new </span><a class="class" onClick="logClass('completion_info')" href="../../_classes/completion_info.html" onMouseOver="classPopup(event,'completion_info')">completion_info</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>);
<a name="l2168"><span class="linenum">2168</span></a>      <a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a>-&gt;<a class="function" onClick="logFunction('set_module_viewed')" href="../../_functions/set_module_viewed.html" onMouseOver="funcPopup(event,'set_module_viewed')">set_module_viewed</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>);
<a name="l2169"><span class="linenum">2169</span></a>  }
<a name="l2170"><span class="linenum">2170</span></a>  
<a name="l2171"><span class="linenum">2171</span></a>  <span class="comment">/**</span>
<a name="l2172"><span class="linenum">2172</span></a>  <span class="comment"> * Validate permissions for creating a new attempt and start a new preview attempt if required.</span>
<a name="l2173"><span class="linenum">2173</span></a>  <span class="comment"> *</span>
<a name="l2174"><span class="linenum">2174</span></a>  <span class="comment"> * @param  quiz $quizobj quiz object</span>
<a name="l2175"><span class="linenum">2175</span></a>  <span class="comment"> * @param  quiz_access_manager $accessmanager quiz access manager</span>
<a name="l2176"><span class="linenum">2176</span></a>  <span class="comment"> * @param  bool $forcenew whether was required to start a new preview attempt</span>
<a name="l2177"><span class="linenum">2177</span></a>  <span class="comment"> * @param  int $page page to jump to in the attempt</span>
<a name="l2178"><span class="linenum">2178</span></a>  <span class="comment"> * @param  bool $redirect whether to redirect or throw exceptions (for web or ws usage)</span>
<a name="l2179"><span class="linenum">2179</span></a>  <span class="comment"> * @return array an array containing the attempt information, access error messages and the page to jump to in the attempt</span>
<a name="l2180"><span class="linenum">2180</span></a>  <span class="comment"> * @throws moodle_quiz_exception</span>
<a name="l2181"><span class="linenum">2181</span></a>  <span class="comment"> * @since Moodle 3.1</span>
<a name="l2182"><span class="linenum">2182</span></a>  <span class="comment"> */</span>
<a name="l2183"><span class="linenum">2183</span></a>  function <a class="function" onClick="logFunction('quiz_validate_new_attempt')" href="../../_functions/quiz_validate_new_attempt.html" onMouseOver="funcPopup(event,'quiz_validate_new_attempt')">quiz_validate_new_attempt</a>(quiz <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>, quiz_access_manager <a class="var it6226" onMouseOver="hilite(6226)" onMouseOut="lolite()" onClick="logVariable('accessmanager')" href="../../_variables/accessmanager.html">$accessmanager</a>, <a class="var it6233" onMouseOver="hilite(6233)" onMouseOut="lolite()" onClick="logVariable('forcenew')" href="../../_variables/forcenew.html">$forcenew</a>, <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>, <a class="var it4789" onMouseOver="hilite(4789)" onMouseOut="lolite()" onClick="logVariable('redirect')" href="../../_variables/redirect.html">$redirect</a>) {
<a name="l2184"><span class="linenum">2184</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>;
<a name="l2185"><span class="linenum">2185</span></a>      <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l2186"><span class="linenum">2186</span></a>  
<a name="l2187"><span class="linenum">2187</span></a>      if (<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('is_preview_user')" href="../../_functions/is_preview_user.html" onMouseOver="funcPopup(event,'is_preview_user')">is_preview_user</a>() &amp;&amp; <a class="var it6233" onMouseOver="hilite(6233)" onMouseOut="lolite()" onClick="logVariable('forcenew')" href="../../_variables/forcenew.html">$forcenew</a>) {
<a name="l2188"><span class="linenum">2188</span></a>          <a class="var it6226" onMouseOver="hilite(6226)" onMouseOut="lolite()" onClick="logVariable('accessmanager')" href="../../_variables/accessmanager.html">$accessmanager</a>-&gt;<a class="function" onClick="logFunction('current_attempt_finished')" href="../../_functions/current_attempt_finished.html" onMouseOver="funcPopup(event,'current_attempt_finished')">current_attempt_finished</a>();
<a name="l2189"><span class="linenum">2189</span></a>      }
<a name="l2190"><span class="linenum">2190</span></a>  
<a name="l2191"><span class="linenum">2191</span></a>  <span class="comment">    // Check capabilities.</span>
<a name="l2192"><span class="linenum">2192</span></a>      if (!<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('is_preview_user')" href="../../_functions/is_preview_user.html" onMouseOver="funcPopup(event,'is_preview_user')">is_preview_user</a>()) {
<a name="l2193"><span class="linenum">2193</span></a>          <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('require_capability')" href="../../_functions/require_capability.html" onMouseOver="funcPopup(event,'require_capability')">require_capability</a>('mod/quiz:attempt');
<a name="l2194"><span class="linenum">2194</span></a>      }
<a name="l2195"><span class="linenum">2195</span></a>  
<a name="l2196"><span class="linenum">2196</span></a>  <span class="comment">    // Check to see if a new preview was requested.</span>
<a name="l2197"><span class="linenum">2197</span></a>      if (<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('is_preview_user')" href="../../_functions/is_preview_user.html" onMouseOver="funcPopup(event,'is_preview_user')">is_preview_user</a>() &amp;&amp; <a class="var it6233" onMouseOver="hilite(6233)" onMouseOut="lolite()" onClick="logVariable('forcenew')" href="../../_variables/forcenew.html">$forcenew</a>) {
<a name="l2198"><span class="linenum">2198</span></a>  <span class="comment">        // To force the creation of a new preview, we mark the current attempt (if any)</span>
<a name="l2199"><span class="linenum">2199</span></a>  <span class="comment">        // as finished. It will then automatically be deleted below.</span>
<a name="l2200"><span class="linenum">2200</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('quiz_attempts', 'state', <a class="class" onClick="logClass('quiz_attempt')" href="../../_classes/quiz_attempt.html" onMouseOver="classPopup(event,'quiz_attempt')">quiz_attempt</a>::FINISHED,
<a name="l2201"><span class="linenum">2201</span></a>                  array('quiz' =&gt; <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('get_quizid')" href="../../_functions/get_quizid.html" onMouseOver="funcPopup(event,'get_quizid')">get_quizid</a>(), 'userid' =&gt; <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l2202"><span class="linenum">2202</span></a>      }
<a name="l2203"><span class="linenum">2203</span></a>  
<a name="l2204"><span class="linenum">2204</span></a>  <span class="comment">    // Look for an existing attempt.</span>
<a name="l2205"><span class="linenum">2205</span></a>      <a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a> = <a class="function" onClick="logFunction('quiz_get_user_attempts')" href="../../_functions/quiz_get_user_attempts.html" onMouseOver="funcPopup(event,'quiz_get_user_attempts')">quiz_get_user_attempts</a>(<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('get_quizid')" href="../../_functions/get_quizid.html" onMouseOver="funcPopup(event,'get_quizid')">get_quizid</a>(), <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'all', true);
<a name="l2206"><span class="linenum">2206</span></a>      <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a> = <a class="phpfunction" onClick="logFunction('end')" href="../../_functions/end.html" onMouseOver="phpfuncPopup(event,'end')">end</a>(<a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a>);
<a name="l2207"><span class="linenum">2207</span></a>  
<a name="l2208"><span class="linenum">2208</span></a>      <a class="var it282" onMouseOver="hilite(282)" onMouseOut="lolite()" onClick="logVariable('attemptnumber')" href="../../_variables/attemptnumber.html">$attemptnumber</a> = null;
<a name="l2209"><span class="linenum">2209</span></a>  <span class="comment">    // If an in-progress attempt exists, check password then redirect to it.</span>
<a name="l2210"><span class="linenum">2210</span></a>      if (<a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a> &amp;&amp; (<a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>-&gt;<a onClick="logVariable('state')" class="var it43541" onMouseOver="hilite(43541)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> == <a class="class" onClick="logClass('quiz_attempt')" href="../../_classes/quiz_attempt.html" onMouseOver="classPopup(event,'quiz_attempt')">quiz_attempt</a>::IN_PROGRESS ||
<a name="l2211"><span class="linenum">2211</span></a>              <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>-&gt;<a onClick="logVariable('state')" class="var it43541" onMouseOver="hilite(43541)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> == <a class="class" onClick="logClass('quiz_attempt')" href="../../_classes/quiz_attempt.html" onMouseOver="classPopup(event,'quiz_attempt')">quiz_attempt</a>::OVERDUE)) {
<a name="l2212"><span class="linenum">2212</span></a>          <a class="var it6234" onMouseOver="hilite(6234)" onMouseOut="lolite()" onClick="logVariable('currentattemptid')" href="../../_variables/currentattemptid.html">$currentattemptid</a> = <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>-&gt;<a onClick="logVariable('id')" class="var it43541" onMouseOver="hilite(43541)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l2213"><span class="linenum">2213</span></a>          <a class="var it925" onMouseOver="hilite(925)" onMouseOut="lolite()" onClick="logVariable('messages')" href="../../_variables/messages.html">$messages</a> = <a class="var it6226" onMouseOver="hilite(6226)" onMouseOut="lolite()" onClick="logVariable('accessmanager')" href="../../_variables/accessmanager.html">$accessmanager</a>-&gt;<a class="function" onClick="logFunction('prevent_access')" href="../../_functions/prevent_access.html" onMouseOver="funcPopup(event,'prevent_access')">prevent_access</a>();
<a name="l2214"><span class="linenum">2214</span></a>  
<a name="l2215"><span class="linenum">2215</span></a>  <span class="comment">        // If the attempt is now overdue, deal with that.</span>
<a name="l2216"><span class="linenum">2216</span></a>          <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('create_attempt_object')" href="../../_functions/create_attempt_object.html" onMouseOver="funcPopup(event,'create_attempt_object')">create_attempt_object</a>(<a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>)-&gt;<a class="function" onClick="logFunction('handle_if_time_expired')" href="../../_functions/handle_if_time_expired.html" onMouseOver="funcPopup(event,'handle_if_time_expired')">handle_if_time_expired</a>(<a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a>, true);
<a name="l2217"><span class="linenum">2217</span></a>  
<a name="l2218"><span class="linenum">2218</span></a>  <span class="comment">        // And, if the attempt is now no longer in progress, redirect to the appropriate place.</span>
<a name="l2219"><span class="linenum">2219</span></a>          if (<a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>-&gt;<a onClick="logVariable('state')" class="var it43541" onMouseOver="hilite(43541)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> == <a class="class" onClick="logClass('quiz_attempt')" href="../../_classes/quiz_attempt.html" onMouseOver="classPopup(event,'quiz_attempt')">quiz_attempt</a>::ABANDONED || <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>-&gt;<a onClick="logVariable('state')" class="var it43541" onMouseOver="hilite(43541)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> == <a class="class" onClick="logClass('quiz_attempt')" href="../../_classes/quiz_attempt.html" onMouseOver="classPopup(event,'quiz_attempt')">quiz_attempt</a>::FINISHED) {
<a name="l2220"><span class="linenum">2220</span></a>              if (<a class="var it4789" onMouseOver="hilite(4789)" onMouseOut="lolite()" onClick="logVariable('redirect')" href="../../_variables/redirect.html">$redirect</a>) {
<a name="l2221"><span class="linenum">2221</span></a>                  <a class="function" onClick="logFunction('redirect')" href="../../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('review_url')" href="../../_functions/review_url.html" onMouseOver="funcPopup(event,'review_url')">review_url</a>(<a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>-&gt;<a onClick="logVariable('id')" class="var it43541" onMouseOver="hilite(43541)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l2222"><span class="linenum">2222</span></a>              } else {
<a name="l2223"><span class="linenum">2223</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_quiz_exception')" href="../../_classes/moodle_quiz_exception.html" onMouseOver="classPopup(event,'moodle_quiz_exception')">moodle_quiz_exception</a>(<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>, 'attemptalreadyclosed');
<a name="l2224"><span class="linenum">2224</span></a>              }
<a name="l2225"><span class="linenum">2225</span></a>          }
<a name="l2226"><span class="linenum">2226</span></a>  
<a name="l2227"><span class="linenum">2227</span></a>  <span class="comment">        // If the page number was not explicitly in the URL, go to the current page.</span>
<a name="l2228"><span class="linenum">2228</span></a>          if (<a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a> == -1) {
<a name="l2229"><span class="linenum">2229</span></a>              <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a> = <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>-&gt;<a onClick="logVariable('currentpage')" class="var it43541" onMouseOver="hilite(43541)" onMouseOut="lolite()" href="../../_variables/currentpage.html">currentpage</a>;
<a name="l2230"><span class="linenum">2230</span></a>          }
<a name="l2231"><span class="linenum">2231</span></a>  
<a name="l2232"><span class="linenum">2232</span></a>      } else {
<a name="l2233"><span class="linenum">2233</span></a>          while (<a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a> &amp;&amp; <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>-&gt;<a onClick="logVariable('preview')" class="var it43541" onMouseOver="hilite(43541)" onMouseOut="lolite()" href="../../_variables/preview.html">preview</a>) {
<a name="l2234"><span class="linenum">2234</span></a>              <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a> = <a class="phpfunction" onClick="logFunction('array_pop')" href="../../_functions/array_pop.html" onMouseOver="phpfuncPopup(event,'array_pop')">array_pop</a>(<a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a>);
<a name="l2235"><span class="linenum">2235</span></a>          }
<a name="l2236"><span class="linenum">2236</span></a>  
<a name="l2237"><span class="linenum">2237</span></a>  <span class="comment">        // Get number for the next or unfinished attempt.</span>
<a name="l2238"><span class="linenum">2238</span></a>          if (<a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>) {
<a name="l2239"><span class="linenum">2239</span></a>              <a class="var it282" onMouseOver="hilite(282)" onMouseOut="lolite()" onClick="logVariable('attemptnumber')" href="../../_variables/attemptnumber.html">$attemptnumber</a> = <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>-&gt;<a onClick="logVariable('attempt')" class="var it43541" onMouseOver="hilite(43541)" onMouseOut="lolite()" href="../../_variables/attempt.html">attempt</a> + 1;
<a name="l2240"><span class="linenum">2240</span></a>          } else {
<a name="l2241"><span class="linenum">2241</span></a>              <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a> = false;
<a name="l2242"><span class="linenum">2242</span></a>              <a class="var it282" onMouseOver="hilite(282)" onMouseOut="lolite()" onClick="logVariable('attemptnumber')" href="../../_variables/attemptnumber.html">$attemptnumber</a> = 1;
<a name="l2243"><span class="linenum">2243</span></a>          }
<a name="l2244"><span class="linenum">2244</span></a>          <a class="var it6234" onMouseOver="hilite(6234)" onMouseOut="lolite()" onClick="logVariable('currentattemptid')" href="../../_variables/currentattemptid.html">$currentattemptid</a> = null;
<a name="l2245"><span class="linenum">2245</span></a>  
<a name="l2246"><span class="linenum">2246</span></a>          <a class="var it925" onMouseOver="hilite(925)" onMouseOut="lolite()" onClick="logVariable('messages')" href="../../_variables/messages.html">$messages</a> = <a class="var it6226" onMouseOver="hilite(6226)" onMouseOut="lolite()" onClick="logVariable('accessmanager')" href="../../_variables/accessmanager.html">$accessmanager</a>-&gt;<a class="function" onClick="logFunction('prevent_access')" href="../../_functions/prevent_access.html" onMouseOver="funcPopup(event,'prevent_access')">prevent_access</a>() +
<a name="l2247"><span class="linenum">2247</span></a>              <a class="var it6226" onMouseOver="hilite(6226)" onMouseOut="lolite()" onClick="logVariable('accessmanager')" href="../../_variables/accessmanager.html">$accessmanager</a>-&gt;<a class="function" onClick="logFunction('prevent_new_attempt')" href="../../_functions/prevent_new_attempt.html" onMouseOver="funcPopup(event,'prevent_new_attempt')">prevent_new_attempt</a>(<a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a>), <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>);
<a name="l2248"><span class="linenum">2248</span></a>  
<a name="l2249"><span class="linenum">2249</span></a>          if (<a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a> == -1) {
<a name="l2250"><span class="linenum">2250</span></a>              <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a> = 0;
<a name="l2251"><span class="linenum">2251</span></a>          }
<a name="l2252"><span class="linenum">2252</span></a>      }
<a name="l2253"><span class="linenum">2253</span></a>      return array(<a class="var it6234" onMouseOver="hilite(6234)" onMouseOut="lolite()" onClick="logVariable('currentattemptid')" href="../../_variables/currentattemptid.html">$currentattemptid</a>, <a class="var it282" onMouseOver="hilite(282)" onMouseOut="lolite()" onClick="logVariable('attemptnumber')" href="../../_variables/attemptnumber.html">$attemptnumber</a>, <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>, <a class="var it925" onMouseOver="hilite(925)" onMouseOut="lolite()" onClick="logVariable('messages')" href="../../_variables/messages.html">$messages</a>, <a class="var it30" onMouseOver="hilite(30)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../_variables/page.html">$page</a>);
<a name="l2254"><span class="linenum">2254</span></a>  }
<a name="l2255"><span class="linenum">2255</span></a>  
<a name="l2256"><span class="linenum">2256</span></a>  <span class="comment">/**</span>
<a name="l2257"><span class="linenum">2257</span></a>  <span class="comment"> * Prepare and start a new attempt deleting the previous preview attempts.</span>
<a name="l2258"><span class="linenum">2258</span></a>  <span class="comment"> *</span>
<a name="l2259"><span class="linenum">2259</span></a>  <span class="comment"> * @param  quiz $quizobj quiz object</span>
<a name="l2260"><span class="linenum">2260</span></a>  <span class="comment"> * @param  int $attemptnumber the attempt number</span>
<a name="l2261"><span class="linenum">2261</span></a>  <span class="comment"> * @param  object $lastattempt last attempt object</span>
<a name="l2262"><span class="linenum">2262</span></a>  <span class="comment"> * @return object the new attempt</span>
<a name="l2263"><span class="linenum">2263</span></a>  <span class="comment"> * @since  Moodle 3.1</span>
<a name="l2264"><span class="linenum">2264</span></a>  <span class="comment"> */</span>
<a name="l2265"><span class="linenum">2265</span></a>  function <a class="function" onClick="logFunction('quiz_prepare_and_start_new_attempt')" href="../../_functions/quiz_prepare_and_start_new_attempt.html" onMouseOver="funcPopup(event,'quiz_prepare_and_start_new_attempt')">quiz_prepare_and_start_new_attempt</a>(quiz <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>, <a class="var it282" onMouseOver="hilite(282)" onMouseOut="lolite()" onClick="logVariable('attemptnumber')" href="../../_variables/attemptnumber.html">$attemptnumber</a>, <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>) {
<a name="l2266"><span class="linenum">2266</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>;
<a name="l2267"><span class="linenum">2267</span></a>  
<a name="l2268"><span class="linenum">2268</span></a>  <span class="comment">    // Delete any previous preview attempts belonging to this user.</span>
<a name="l2269"><span class="linenum">2269</span></a>      <a class="function" onClick="logFunction('quiz_delete_previews')" href="../../_functions/quiz_delete_previews.html" onMouseOver="funcPopup(event,'quiz_delete_previews')">quiz_delete_previews</a>(<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('get_quiz')" href="../../_functions/get_quiz.html" onMouseOver="funcPopup(event,'get_quiz')">get_quiz</a>(), <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l2270"><span class="linenum">2270</span></a>  
<a name="l2271"><span class="linenum">2271</span></a>      <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a> = question_engine::<a class="function" onClick="logFunction('make_questions_usage_by_activity')" href="../../_functions/make_questions_usage_by_activity.html" onMouseOver="funcPopup(event,'make_questions_usage_by_activity')">make_questions_usage_by_activity</a>('mod_quiz', <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('get_context')" href="../../_functions/get_context.html" onMouseOver="funcPopup(event,'get_context')">get_context</a>());
<a name="l2272"><span class="linenum">2272</span></a>      <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>-&gt;<a class="function" onClick="logFunction('set_preferred_behaviour')" href="../../_functions/set_preferred_behaviour.html" onMouseOver="funcPopup(event,'set_preferred_behaviour')">set_preferred_behaviour</a>(<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('get_quiz')" href="../../_functions/get_quiz.html" onMouseOver="funcPopup(event,'get_quiz')">get_quiz</a>()-&gt;preferredbehaviour);
<a name="l2273"><span class="linenum">2273</span></a>  
<a name="l2274"><span class="linenum">2274</span></a>  <span class="comment">    // Create the new attempt and initialize the question sessions</span>
<a name="l2275"><span class="linenum">2275</span></a>      <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>(); <span class="comment">// Update time now, in case the server is running really slowly.</span>
<a name="l2276"><span class="linenum">2276</span></a>      <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a> = <a class="function" onClick="logFunction('quiz_create_attempt')" href="../../_functions/quiz_create_attempt.html" onMouseOver="funcPopup(event,'quiz_create_attempt')">quiz_create_attempt</a>(<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>, <a class="var it282" onMouseOver="hilite(282)" onMouseOut="lolite()" onClick="logVariable('attemptnumber')" href="../../_variables/attemptnumber.html">$attemptnumber</a>, <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>, <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a>, <a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('is_preview_user')" href="../../_functions/is_preview_user.html" onMouseOver="funcPopup(event,'is_preview_user')">is_preview_user</a>());
<a name="l2277"><span class="linenum">2277</span></a>  
<a name="l2278"><span class="linenum">2278</span></a>      if (!(<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>-&gt;<a class="function" onClick="logFunction('get_quiz')" href="../../_functions/get_quiz.html" onMouseOver="funcPopup(event,'get_quiz')">get_quiz</a>()-&gt;attemptonlast &amp;&amp; <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>)) {
<a name="l2279"><span class="linenum">2279</span></a>          <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a> = <a class="function" onClick="logFunction('quiz_start_new_attempt')" href="../../_functions/quiz_start_new_attempt.html" onMouseOver="funcPopup(event,'quiz_start_new_attempt')">quiz_start_new_attempt</a>(<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>, <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>, <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>, <a class="var it282" onMouseOver="hilite(282)" onMouseOut="lolite()" onClick="logVariable('attemptnumber')" href="../../_variables/attemptnumber.html">$attemptnumber</a>, <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a>);
<a name="l2280"><span class="linenum">2280</span></a>      } else {
<a name="l2281"><span class="linenum">2281</span></a>          <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a> = <a class="function" onClick="logFunction('quiz_start_attempt_built_on_last')" href="../../_functions/quiz_start_attempt_built_on_last.html" onMouseOver="funcPopup(event,'quiz_start_attempt_built_on_last')">quiz_start_attempt_built_on_last</a>(<a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>, <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>, <a class="var it1284" onMouseOver="hilite(1284)" onMouseOut="lolite()" onClick="logVariable('lastattempt')" href="../../_variables/lastattempt.html">$lastattempt</a>);
<a name="l2282"><span class="linenum">2282</span></a>      }
<a name="l2283"><span class="linenum">2283</span></a>  
<a name="l2284"><span class="linenum">2284</span></a>      <a class="var it4224" onMouseOver="hilite(4224)" onMouseOut="lolite()" onClick="logVariable('transaction')" href="../../_variables/transaction.html">$transaction</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('start_delegated_transaction')" href="../../_functions/start_delegated_transaction.html" onMouseOver="funcPopup(event,'start_delegated_transaction')">start_delegated_transaction</a>();
<a name="l2285"><span class="linenum">2285</span></a>  
<a name="l2286"><span class="linenum">2286</span></a>      <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a> = <a class="function" onClick="logFunction('quiz_attempt_save_started')" href="../../_functions/quiz_attempt_save_started.html" onMouseOver="funcPopup(event,'quiz_attempt_save_started')">quiz_attempt_save_started</a>(<a class="var it745" onMouseOver="hilite(745)" onMouseOut="lolite()" onClick="logVariable('quizobj')" href="../../_variables/quizobj.html">$quizobj</a>, <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>, <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>);
<a name="l2287"><span class="linenum">2287</span></a>  
<a name="l2288"><span class="linenum">2288</span></a>      <a class="var it4224" onMouseOver="hilite(4224)" onMouseOut="lolite()" onClick="logVariable('transaction')" href="../../_variables/transaction.html">$transaction</a>-&gt;<a class="function" onClick="logFunction('allow_commit')" href="../../_functions/allow_commit.html" onMouseOver="funcPopup(event,'allow_commit')">allow_commit</a>();
<a name="l2289"><span class="linenum">2289</span></a>  
<a name="l2290"><span class="linenum">2290</span></a>      return <a class="var it550" onMouseOver="hilite(550)" onMouseOut="lolite()" onClick="logVariable('attempt')" href="../../_variables/attempt.html">$attempt</a>;
<a name="l2291"><span class="linenum">2291</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'get_courseid': ['get_courseid', 'Id of the current course (for site feedbacks only) ', [['mod/feedback/classes','structure.php',80],['course/format','lib.php',222],['mod/quiz','attemptlib.php',175],['mod/quiz','attemptlib.php',717],['backup/util/plan','backup_plan.class.php',78],['comment','lib.php',1002],['mod/quiz/classes','structure.php',228],['question/classes/bank','view.php',217],['backup/util/plan','restore_plan.class.php',81],['backup/controller','backup_controller.class.php',267],['backup/util/plan','base_step.class.php',105],['backup/controller','restore_controller.class.php',269],['backup/util/plan','base_task.class.php',109]], 244],
'update_record': ['update_record', 'Update a record in a table ', [['lib/dml','pdo_moodle_database.php',461],['lib/dml','oci_native_moodle_database.php',1404],['lib/dml','pgsql_native_moodle_database.php',1089],['lib/dml','mssql_native_moodle_database.php',1067],['lib/dml','mysqli_native_moodle_database.php',1405],['lib/dml','sqlsrv_native_moodle_database.php',1148],['lib/dml/tests','dml_test.php',5551]], 650],
'get_sections': ['get_sections', 'Returns a list of sections used in the course ', [['course/format','lib.php',301],['mod/quiz','attemptlib.php',271],['lib','modinfolib.php',210],['mod/quiz/classes','structure.php',457]], 15],
'is_enabled': ['is_enabled', 'Tools cannot be disabled. ', [['lib/classes/plugininfo','tool.php',39],['admin/tool/recyclebin/classes','category_bin.php',54],['admin/tool/log/classes/plugininfo','logstore.php',35],['admin/tool/recyclebin/classes','course_bin.php',54],['mod/assign/feedback/offline','locallib.php',380],['admin/tool/recyclebin/classes','base_bin.php',38],['lib','adminlib.php',1955],['search/classes','base.php',190],['lib','medialib.php',318],['lib','medialib.php',635],['lib','medialib.php',1268],['admin/tool/health','index.php',393],['lib/classes/plugininfo','mnetservice.php',33],['lib/classes/message/inbound','manager.php',37],['mod/assignment/classes/plugininfo','assignment.php',32],['competency/classes','api.php',49],['mod/assign','assignmentplugin.php',223],['lib/classes/plugininfo','orphaned.php',37],['search/tests/fixtures','mock_search_area.php',38],['tag/classes','area.php',106],['lib/classes/plugininfo','base.php',383],['mod/assign/feedback/editpdf','locallib.php',340],['tag/classes','tag.php',1269],['mod/assign/submission/comments','locallib.php',172],['lib','completionlib.php',269]], 276],
'review_url': ['review_url', '', [['mod/quiz','attemptlib.php',359],['mod/quiz','attemptlib.php',1409]], 60],
'delete_records': ['delete_records', 'Delete the records from a table where all the given conditions met. If conditions not specified, table is truncated. ', [['lib/dml','sqlite3_pdo_moodle_database.php',345],['lib/dml','moodle_database.php',1864]], 773],
'quiz_attempt_state_name': ['quiz_attempt_state_name', 'Get the human-readable name for a quiz attempt state. ', [['mod/quiz','locallib.php',1221]], 2],
'get_coursemodule_from_id': ['get_coursemodule_from_id', 'Given an id of a course module, finds the coursemodule description ', [['lib','datalib.php',1238]], 212],
'start_delegated_transaction': ['start_delegated_transaction', 'On DBs that support it, switch to transaction mode and begin a transaction you\'ll need to ensure you call allow_commit() on the returned object or your changes *will* be lost. ', [['lib/dml','moodle_database.php',2393]], 145],
'preload_questions': ['preload_questions', 'Load just basic information about all the questions in this quiz. ', [['mod/quiz','attemptlib.php',133]], 4],
'get_attempt': ['get_attempt', '', [['mod/quiz','attemptlib.php',789]], 14],
'get_id': ['get_id', 'Getter for $id. ', [['lib/classes/task','adhoc_task.php',51],['backup/converter','convertlib.php',100],['lib/filebrowser','virtual_root_file.php',290],['lib','adminlib.php',1719],['admin/tool/uploadcourse/classes','course.php',335],['lib/simplepie/library/SimplePie','Item.php',199],['lib/filestorage','stored_file.php',786],['cache/classes','definition.php',613],['grade/grading/form','lib.php',854],['question/engine','questionusage.php',120],['mod/lti/classes/local/ltiservice','service_base.php',76],['blocks/rss_client/classes/output','item.php',152],['backup/controller','backup_controller.class.php',263],['question/engine','questionattemptstep.php',136],['mod/lti/classes/local/ltiservice','resource_base.php',81]], 2250],
'quiz_delete_previews': ['quiz_delete_previews', 'Delete all the preview attempts at a quiz, or possibly all the attempts belonging to one user. ', [['mod/quiz','locallib.php',452]], 11],
'question_has_capability_on': ['question_has_capability_on', 'Check capability on category ', [['lib','questionlib.php',1300]], 22],
'quiz_questions_per_page_options': ['quiz_questions_per_page_options', 'Get the choices to offer for the \'Questions per page\' option. ', [['mod/quiz','locallib.php',1207]], 1],
'shorten_text': ['shorten_text', 'Given some text (which may contain HTML) and an ideal length, this function truncates the text neatly on a word boundary if possible ', [['lib','moodlelib.php',7822]], 87],
'is_preview_user': ['is_preview_user', '', [['mod/quiz','attemptlib.php',228],['mod/quiz','attemptlib.php',755]], 21],
'quiz_question_edit_button': ['quiz_question_edit_button', '', [['mod/quiz','locallib.php',1266]], 1],
'save_questions_usage_by_activity': ['save_questions_usage_by_activity', 'Save a {@link question_usage_by_activity} to the database. This works either if the usage was newly created by {@link make_questions_usage_by_activity()} or loaded from the database using {@link load_questions_usage_by_activity()} ', [['question/engine','lib.php',87]], 19],
'quiz_set_grade': ['quiz_set_grade', 'The quiz grade is the maximum that student\'s results are marked out of. When it changes, the corresponding data in quiz_grades and quiz_feedback needs to be rescaled. After calling this function, you probably need to call quiz_update_all_attempt_sumgrades, quiz_update_all_final_grades and quiz_update_grades. ', [['mod/quiz','locallib.php',666]], 2],
'quiz_get_js_module': ['quiz_get_js_module', 'Get the information about the standard quiz JavaScript module. ', [['mod/quiz','locallib.php',1819]], 8],
'quiz_save_best_grade': ['quiz_save_best_grade', 'Save the overall grade for a user at a quiz in the quiz_grades table ', [['mod/quiz','locallib.php',728]], 3],
'quiz_send_notification': ['quiz_send_notification', 'Sends notification messages to the interested parties that assign the role capability ', [['mod/quiz','locallib.php',1509]], 1],
'load_question': ['load_question', 'Load a question definition from the database. The object returned will actually be of an appropriate {@link question_definition} subclass. ', [['question/engine','bank.php',258],['question/type/randomsamatch/db','upgradelib.php',240],['question/engine/upgrade','upgradelib.php',133],['question/engine/upgrade','upgradelib.php',287],['question/engine/upgrade/tests','helper.php',63]], 47],
'to_plain_text': ['to_plain_text', 'Convert part of some question content to plain text. ', [['question/engine','lib.php',942]], 6],
'get_quiz': ['get_quiz', '', [['mod/quiz','attemptlib.php',190],['mod/quiz','attemptlib.php',708],['mod/quiz/classes','structure.php',252]], 104],
'quiz_has_grades': ['quiz_has_grades', 'Is this a graded quiz? If this method returns true, you can assume that $quiz->grade and $quiz->sumgrades are non-zero (for example, if you want to divide by them). ', [['mod/quiz','lib.php',414]], 11],
'record_exists': ['record_exists', 'Check if a record exists by ID. ', [['competency/classes','persistent.php',842],['lib/dml','moodle_database.php',1817]], 901],
'get_qtype': ['get_qtype', 'Get the question type class for a particular question type. ', [['question/engine','bank.php',80],['question/format/xml','format.php',1009]], 113],
'quiz_get_combined_reviewoptions': ['quiz_get_combined_reviewoptions', 'Combines the review options from a number of different quiz attempts. Returns an array of two ojects, so the suggested way of calling this funciton is: list($someoptions, $alloptions) = quiz_get_combined_reviewoptions(...) ', [['mod/quiz','locallib.php',1429]], 3],
'add_question': ['add_question', 'Add another question to this usage. ', [['question/engine','questionusage.php',156]], 43],
'has_capability': ['has_capability', 'Wrapper round the has_capability funciton that automatically passes in the quiz context. ', [['mod/quiz','attemptlib.php',299],['mod/quiz','attemptlib.php',922],['lib','accesslib.php',344]], 2064],
'quiz_add_quiz_question': ['quiz_add_quiz_question', 'Add a question to a quiz ', [['mod/quiz','locallib.php',2000]], 39],
'quiz_view': ['quiz_view', 'Mark the activity completed (if required) and trigger the course_module_viewed event. ', [['mod/quiz','locallib.php',2146]], 3],
'quiz_get_user_attempt_unfinished': ['quiz_get_user_attempt_unfinished', 'Returns an unfinished attempt (if there is one) for the given user on the given quiz. This function does not return preview attempts. ', [['mod/quiz','locallib.php',378]], 2],
'question_preview_url': ['question_preview_url', 'Generate the URL for starting a new preview of a given question with the given options. ', [['lib','questionlib.php',621]], 6],
'get_records_sql_menu': ['get_records_sql_menu', 'Get the first two columns from a number of records as an associative array using a SQL statement. ', [['lib/dml','moodle_database.php',1436]], 30],
'quiz_update_grades': ['quiz_update_grades', 'Update grades in central gradebook ', [['mod/quiz','lib.php',673]], 7],
'quiz_has_question_use': ['quiz_has_question_use', 'Verify that the question exists, and the user has permission to use it. ', [['mod/quiz','locallib.php',1981]], 0],
'redirect': ['redirect', '', [['enrol/lti/ims-blti','blti.php',230],['lib','weblib.php',2659]], 999],
'get_quiz_name': ['get_quiz_name', '', [['mod/quiz','attemptlib.php',195],['mod/quiz','attemptlib.php',732]], 14],
'fullname': ['fullname', 'Returns a persons full name ', [['lib','moodlelib.php',3249],['mod/assign','locallib.php',3915]], 546],
'record_exists_select': ['record_exists_select', 'Check if a records exists. ', [['competency/classes','persistent.php',853],['lib/dml','moodle_database.php',1830]], 85],
'quiz_groups_member_removed_handler': ['quiz_groups_member_removed_handler', 'Handle groups_member_removed event ', [['mod/quiz','locallib.php',1751]], 1],
'quiz_groups_member_added_handler': ['quiz_groups_member_added_handler', 'Handle groups_member_added event ', [['mod/quiz','locallib.php',1739]], 1],
'get_dbfamily': ['get_dbfamily', 'Returns database family type - describes SQL dialect Note: can be used before connect() ', [['lib/dml','oci_native_moodle_database.php',67],['lib/dml','sqlite3_pdo_moodle_database.php',50],['lib/dml','pgsql_native_moodle_database.php',60],['lib/dml','mssql_native_moodle_database.php',61],['lib/dml','mysqli_native_moodle_database.php',117],['lib/dml','sqlsrv_native_moodle_database.php',81],['lib/dml/tests','dml_test.php',5527]], 54],
'list': ['list', '', [['mod/data/preset/imagegallery','jstemplate.js',9]], 2229],
'quiz_update_all_attempt_sumgrades': ['quiz_update_all_attempt_sumgrades', 'Update the sumgrades field of the attempts at a quiz. ', [['mod/quiz','locallib.php',645]], 2],
'get_questions': ['get_questions', '', [['backup/cc','entity.quiz.class.php',341],['mod/quiz','attemptlib.php',256],['backup/cc','entity11.quiz.class.php',329],['mod/survey/classes','external.php',252]], 8],
'format_time': ['format_time', 'Format a date/time (seconds) as weeks, days, hours etc as needed ', [['lib','moodlelib.php',2065]], 70],
'quiz_process_group_deleted_in_course': ['quiz_process_group_deleted_in_course', 'Logic to happen when a/some group(s) has/have been deleted in a course. ', [['mod/quiz','locallib.php',1776]], 3],
'get_context': ['get_context', 'Return the course context for new modules, or the module context for existing modules. ', [['course','moodleform_mod.php',148],['availability/classes','info_module.php',72],['availability/classes','info_section.php',55],['competency/classes','user_competency_plan.php',83],['availability/tests/fixtures','mock_info.php',59],['mod/feedback/classes','responses_table.php',146],['competency/classes','competency.php',730],['competency/classes','plan.php',258],['mod/quiz','attemptlib.php',220],['competency/classes','user_competency.php',216],['grade/grading','lib.php',107],['lib','modinfolib.php',1486],['lib','badgeslib.php',157],['competency/classes/external','exporter.php',172],['comment','lib.php',994],['grade/grading/form','lib.php',102],['mod/assign','locallib.php',1307],['competency/classes','user_evidence.php',90],['competency/classes','user_competency_course.php',80],['lib/classes/event','base.php',627],['enrol','locallib.php',921],['lib','coursecatlib.php',2369],['lib','coursecatlib.php',3065],['competency/classes','course_competency_settings.php',133],['lib/tests/behat','behat_data_generators.php',769],['competency/classes','competency_framework.php',70],['competency/classes','template.php',139]], 1033],
'quiz_get_grading_option_name': ['quiz_get_grading_option_name', '', [['mod/quiz','locallib.php',1178]], 4],
'print_error': ['print_error', 'Abort execution by throwing of a general exception, default exception handler displays the error message in most cases. ', [['lib','setuplib.php',481]], 1488],
'get_renderer': ['get_renderer', 'Returns instance of page renderer used by this plugin ', [['course/format','lib.php',905],['question/type/multichoice','question.php',156],['question/type/multichoice','question.php',278],['question/behaviour','behaviourbase.php',135],['question/type','questionbase.php',275],['lib','pagelib.php',802],['lib','outputlib.php',1828],['lib','outputfactories.php',70],['lib','outputfactories.php',292],['lib','outputfactories.php',377],['mod/assign','locallib.php',2987],['grade/grading/form/rubric','lib.php',486],['lib/tests/fixtures','test_renderer_factory.php',49],['grade/grading/form/guide','lib.php',492]], 452],
'set_field': ['set_field', 'Set a single field in every table record where all the given conditions met. ', [['lib/dml','moodle_database.php',1737],['availability/condition/profile/tests','condition_test.php',349]], 485],
'make_from_quiz': ['make_from_quiz', 'Set up the various options from the quiz settings, and a time constant. ', [['mod/quiz','locallib.php',1873]], 12],
'quiz_send_notification_messages': ['quiz_send_notification_messages', 'Send all the requried messages when a quiz attempt is submitted. ', [['mod/quiz','locallib.php',1545]], 1],
'delete_questions_usage_by_activity': ['delete_questions_usage_by_activity', 'Delete a {@link question_usage_by_activity} from the database, based on its id. ', [['question/engine','lib.php',104]], 3],
'get_record_snapshot': ['get_record_snapshot', 'Returns cached record or fetches data from database if not cached. ', [['lib/classes/event','base.php',883]], 90],
'quiz_create_attempt': ['quiz_create_attempt', 'Creates an object to represent a new attempt at a quiz ', [['mod/quiz','locallib.php',76]], 25],
'quiz_prepare_and_start_new_attempt': ['quiz_prepare_and_start_new_attempt', 'Prepare and start a new attempt deleting the previous preview attempts. ', [['mod/quiz','locallib.php',2256]], 2],
'update_state': ['update_state', 'Updates (if necessary) the completion state of activity $cm for the given user. ', [['lib','completionlib.php',507]], 40],
'get_noreply_user': ['get_noreply_user', 'Return noreply user record, this is currently used in messaging system only for sending messages from noreply email. It will return record of $CFG->noreplyuserid if set else return dummy user object with hard-coded $user->emailstop = 1 so noreply can be sent to user. ', [['lib/classes','user.php',137]], 34],
'execute': ['execute', 'Run langpack update ', [['admin/tool/langimport/classes/task','update_langpacks_task.php',44],['backup/converter/imscc1','lib.php',84],['lib/classes/task','blog_cron_task.php',40],['mod/workshop/allocation/scheduled','lib.php',128],['lib/classes/task','send_new_user_passwords_task.php',40],['admin/tool/log/store/standard/classes/task','cleanup_task.php',40],['lib/dml','pdo_moodle_database.php',227],['lib/classes/task','tag_cron_task.php',42],['enrol/imsenterprise/classes/task','cron_task.php',43],['lib/classes/task','completion_daily_task.php',42],['lib/google/src/Google/Http','Batch.php',61],['lib/dml','oci_native_moodle_database.php',1048],['lib/classes/task','context_cleanup_task.php',41],['backup/util/plan','backup_structure_step.class.php',50],['backup/util/ui','restore_ui.class.php',206],['webservice','lib.php',1319],['lib/classes/task','stats_cron_task.php',40],['lib/htmlpurifier/HTMLPurifier/Strategy','ValidateAttributes.php',16],['lib/htmlpurifier/HTMLPurifier/Strategy','RemoveForeignElements.php',20],['lib/classes/task','legacy_plugin_cron_task.php',42],['backup/moodle2','restore_activity_task.class.php',189],['lib/classes/task','portfolio_cron_task.php',40],['lib/google/src/Google/Http','REST.php',27],['lib/htmlpurifier/HTMLPurifier/Strategy','MakeWellFormed.php',66],['backup/converter/imscc11','backuplib.php',42],['lib/classes/task','question_cron_task.php',40],['lib/classes/task','cache_cron_task.php',40],['admin/tool/log/store/legacy/classes/task','cleanup_task.php',40],['mod/lti/service/memberships/classes/local/resource','linkmemberships.php',62],['admin/tool/messageinbound/classes/task','cleanup_task.php',47],['lib/adodb/drivers','adodb-pdo.inc.php',559],['lib/editor/atto/classes/task','autosave_cleanup_task.php',42],['admin/tool/recyclebin/classes/task','cleanup_category_bin.php',43],['lib/classes/task','completion_regular_task.php',42],['lib/adodb/drivers','adodb-oci8po.inc.php',54],['lib/classes/task','events_cron_task.php',40],['mod/workshop/allocation/random','lib.php',83],['mod/assign/feedback/editpdf/classes/task','convert_submissions.php',47],['auth/cas/classes/task','sync_task.php',43],['admin/tool/recyclebin/classes/task','cleanup_course_bin.php',43],['mod/lti/service/toolsettings/classes/local/resource','contextsettings.php',62],['backup/util/helper','restore_decode_processor.class.php',73],['lib/behat','behat_base.php',840],['enrol/flatfile/classes/task','flatfile_sync_task.php',46],['lib/classes/task','registration_cron_task.php',40],['backup/moodle2','backup_section_task.class.php',97],['lib/classes/task','check_for_updates_task.php',40],['backup/util/plan/tests/fixtures','plan_fixtures.php',48],['backup/util/plan/tests/fixtures','plan_fixtures.php',56],['mod/forum/classes/task','cron_task.php',39],['lib/classes/task','send_failed_login_notifications_task.php',43],['enrol/lti/classes/task','sync_grades.php',45],['lib/dml','pgsql_native_moodle_database.php',665],['lib/htmlpurifier/HTMLPurifier/Strategy','Composite.php',21],['lib/classes/update','validator.php',117],['lib/google/src/Google','Client.php',574],['lib/dml','mssql_native_moodle_database.php',711],['mod/lti/service/profile/classes/local/resource','profile.php',76],['backup/util/plan','backup_plan.class.php',112],['lib/dml','mysqli_native_moodle_database.php',963],['backup/util/ui','backup_ui.class.php',122],['admin/tool/monitor/classes/task','clean_events.php',41],['backup/converter/moodle1','backuplib.php',10],['backup/converter/imscc11','lib.php',85],['lib/classes/task','grade_cron_task.php',40],['lib/classes/task','file_temp_cleanup_task.php',40],['backup/moodle2','restore_section_task.class.php',87],['mod/lti/service/toolsettings/classes/local/resource','linksettings.php',63],['filter/tex','latex.php',70],['lib/adodb','adodb.inc.php',1088],['lib/classes/task','plagiarism_cron_task.php',40],['mod/lti/service/toolproxy/classes/local/resource','toolproxy.php',62],['backup/converter/moodle1','lib.php',142],['backup/util/plan','restore_structure_step.class.php',62],['lib/classes/task','search_index_task.php',44],['enrol/lti/classes/task','sync_members.php',55],['lib/classes/task','session_cleanup_task.php',40],['mod/lti/service/toolsettings/classes/local/resource','systemsettings.php',61],['lib/classes/task','backup_cleanup_task.php',40],['lib/classes/task','delete_unconfirmed_users_task.php',40],['backup/converter/imscc1','backuplib.php',10],['lib/classes/task','badges_cron_task.php',40],['admin/tool/uploadcourse/classes','processor.php',174],['lib/classes/task','calendar_cron_task.php',40],['backup/util/plan','base_plan.class.php',158],['auth/ldap/classes/task','sync_task.php',43],['lib/adodb/drivers','adodb-oci8.inc.php',920],['backup/util/plan','restore_plan.class.php',159],['lib/tests/fixtures','task_fixtures.php',30],['lib/tests/fixtures','task_fixtures.php',39],['lib/tests/fixtures','task_fixtures.php',48],['lib/tests/fixtures','task_fixtures.php',57],['lib/dml','sqlsrv_native_moodle_database.php',795],['lib/classes/task','create_contexts_task.php',40],['lib/classes/task','file_trash_cleanup_task.php',40],['admin/tool/cohortroles/classes/task','cohort_role_sync.php',46],['lib/classes/task','complete_plans_task.php',52],['lib/classes/task','messaging_cleanup_task.php',40],['backup/util/plan','backup_execution_step.class.php',25],['lib/classes/task','cache_cleanup_task.php',40],['backup/moodle2','backup_activity_task.class.php',211],['filter/tex','texdebug.php',287],['lib/classes/task','password_reset_cleanup_task.php',40],['lib/classes/task','search_optimize_task.php',47],['mod/assign','adminlib.php',342],['lib/classes/task','delete_incomplete_users_task.php',40],['lib/classes/task','automated_backup_task.php',40],['admin/tool/messageinbound/classes/task','pickup_task.php',47],['backup/util/plan','restore_execution_step.class.php',25],['lib/classes/task','sync_plans_from_template_cohorts_task.php',50],['admin/tool/monitor/classes','notification_task.php',39],['lib/dml/tests','dml_test.php',5543],['lib/htmlpurifier/HTMLPurifier/Strategy','FixNesting.php',41],['mod/lti/service/memberships/classes/local/resource','contextmemberships.php',60],['admin/tool/monitor/classes/task','check_subscriptions.php',60],['backup/util/interfaces','executable.class.php',32],['backup/util/plan','base_task.class.php',162]], 1058],
'prepare_forced_choices_array': ['prepare_forced_choices_array', 'Helper method for preparing the $forcedchoices array. ', [['question/engine','lib.php',1081]], 1],
'quiz_get_user_image_options': ['quiz_get_user_image_options', 'Get the choices for what size user picture to show. ', [['mod/quiz','locallib.php',1195]], 2],
'current_attempt_finished': ['current_attempt_finished', 'This is called when the current attempt at the quiz is finished. This is used, for example by the password rule, to clear the flag in the session. ', [['mod/quiz/accessrule','accessrulebase.php',148],['mod/quiz','accessmanager.php',395],['mod/quiz/accessrule/password','rule.php',94]], 3],
'quiz_validate_new_attempt': ['quiz_validate_new_attempt', 'Validate permissions for creating a new attempt and start a new preview attempt if required. ', [['mod/quiz','locallib.php',2171]], 2],
'quiz_attempt_state': ['quiz_attempt_state', 'Work out what state this quiz attempt is in - in the sense used by quiz_get_review_options, not in the sense of $attempt->state. ', [['mod/quiz','locallib.php',1360]], 12],
'create_attempt_object': ['create_attempt_object', 'Create a {@link quiz_attempt} for an attempt at this quiz. ', [['mod/quiz','attemptlib.php',122]], 3],
'quiz_start_attempt_built_on_last': ['quiz_start_attempt_built_on_last', 'Start a subsequent new attempt, in each attempt builds on last mode. ', [['mod/quiz','locallib.php',303]], 1],
'get_users_by_capability': ['get_users_by_capability', 'Who has this capability in this context? ', [['lib','accesslib.php',3741],['availability/classes','capability_checker.php',58]], 53],
'quiz_require_question_use': ['quiz_require_question_use', 'Verify that the question exists, and the user has permission to use it. Does not return. Throws an exception if the question cannot be used. ', [['mod/quiz','locallib.php',1970]], 2],
'prevent_access': ['prevent_access', 'Whether the user should be blocked from starting a new attempt or continuing an attempt now. ', [['mod/quiz/accessrule','accessrulebase.php',87],['mod/quiz/accessrule/openclosedate','rule.php',69],['mod/quiz','accessmanager.php',332],['mod/quiz/accessrule/ipaddress','rule.php',48],['mod/quiz/accessrule/safebrowser','rule.php',49]], 35],
'get_records': ['get_records', 'Load a list of records. ', [['competency/classes','persistent.php',709],['mod/glossary/classes','entry_query_builder.php',295],['lib/dml','moodle_database.php',1285],['lib','coursecatlib.php',651],['question','category_class.php',63]], 965],
'quiz_get_attempt_usertime_sql': ['quiz_get_attempt_usertime_sql', 'Returns SQL to compute timeclose and timelimit for every attempt, taking into account user and group overrides. ', [['mod/quiz','locallib.php',1090]], 2],
'sql_compare_text': ['sql_compare_text', 'Returns the SQL text to be used to compare one TEXT (clob) column with one varchar column, because some RDBMS doesn\'t support such direct comparisons. ', [['lib/dml','moodle_database.php',2040]], 95],
'require_capability': ['require_capability', 'Wrapper round the require_capability funciton that automatically passes in the quiz context. ', [['mod/quiz','attemptlib.php',306],['mod/quiz','attemptlib.php',929],['lib','accesslib.php',762],['backup/util/ui','restore_ui_components.php',157]], 690],
'get_record_select': ['get_record_select', 'Get a single database record as an object which match a particular WHERE clause. ', [['lib/dml','moodle_database.php',1481]], 19],
'span': ['span', 'Creates a <span> tag. (Shortcut function.) ', [['lib','outputcomponents.php',1846]], 161],
'quiz_repaginate_questions': ['quiz_repaginate_questions', 'Repaginate the questions in a quiz ', [['mod/quiz','locallib.php',481]], 3],
'sum': ['sum', 'SUM ', [['lib/phpexcel/PHPExcel/Calculation','MathTrig.php',1152],['lib/evalmath','evalmath.class.php',530]], 91],
'make_unique_id_code': ['make_unique_id_code', 'make_unique_id_code ', [['lib','moodlelib.php',8250]], 26],
'quiz_groups_group_deleted_handler': ['quiz_groups_group_deleted_handler', 'Handle groups_group_deleted event ', [['mod/quiz','locallib.php',1763]], 1],
'out_as_local_url': ['out_as_local_url', 'Returns URL a relative path from $CFG->wwwroot ', [['lib','weblib.php',852]], 44],
'quiz_get_flag_option': ['quiz_get_flag_option', '', [['mod/quiz','locallib.php',1349]], 2],
'get_records_sql': ['get_records_sql', 'Get a number of records as an array of objects. ', [['lib/dml','pdo_moodle_database.php',309],['lib/dml','oci_native_moodle_database.php',1145],['lib/dml','pgsql_native_moodle_database.php',732],['lib/dml','mssql_native_moodle_database.php',805],['lib/dml','mysqli_native_moodle_database.php',1057],['lib/dml','sqlsrv_native_moodle_database.php',890],['lib/dml/tests','dml_test.php',5545]], 700],
'start_all_questions': ['start_all_questions', 'Start the attempt at all questions that has been added to this usage. ', [['question/engine','questionusage.php',558]], 16],
'get_question': ['get_question', '', [['mod/quiz','attemptlib.php',249],['question/engine/upgrade','upgradelib.php',326],['question/engine','questionusage.php',218],['question/engine','questionattempt.php',204]], 89],
'get_course': ['get_course', 'Get the course id. ', [['course','moodleform_mod.php',132],['search/classes','engine.php',102],['course/format','lib.php',231],['mod/quiz','attemptlib.php',180],['mod/quiz','attemptlib.php',722],['tag/classes','index_builder.php',296],['lib','modinfolib.php',180],['lib','modinfolib.php',1424],['lib','modinfolib.php',2706],['lib','datalib.php',568],['availability/classes','info.php',70],['mod/assign','locallib.php',1316],['admin/tool/uploadcourse/classes','processor.php',232],['enrol','locallib.php',912],['search/tests/fixtures','mock_search_engine.php',56]], 302],
's': ['s', 'Count of attempts selected by $this->whichattempts ', [['mod/quiz/report/statistics/classes','calculated.php',91],['lib','weblib.php',84]], 1072],
'get_quizid': ['get_quizid', '', [['mod/quiz','attemptlib.php',185],['mod/quiz','attemptlib.php',727],['mod/quiz/classes','structure.php',244]], 45],
'load_questions': ['load_questions', 'Fully load some or all of the questions for this quiz. You must call {@link preload_questions()} first. ', [['mod/quiz','attemptlib.php',143],['question/type/randomsamatch','question.php',124],['question/type/randomsamatch/tests','helper.php',132]], 4],
'quiz_get_review_options': ['quiz_get_review_options', 'The the appropraite mod_quiz_display_options object for this attempt at this quiz right now. ', [['mod/quiz','locallib.php',1380]], 3],
'quiz_update_all_final_grades': ['quiz_update_all_final_grades', 'Update the final grade at this quiz for all students. ', [['mod/quiz','locallib.php',821]], 5],
'make_questions_usage_by_activity': ['make_questions_usage_by_activity', 'Create a new {@link question_usage_by_activity}. The usage is created in memory. If you want it to persist, you will need to call {@link save_questions_usage_by_activity()}. ', [['question/engine','lib.php',63]], 51],
'groups_get_activity_groupmode': ['groups_get_activity_groupmode', 'Returns effective groupmode used in activity, course setting overrides activity setting if groupmodeforce enabled. ', [['lib','grouplib.php',468]], 136],
'userdate': ['userdate', 'Returns a formatted string that represents a date in user time. ', [['lib','moodlelib.php',2155],['lib/adodb','adodb.inc.php',2842],['lib/adodb','adodb.inc.php',3569]], 525],
'quiz_calculate_best_attempt': ['quiz_calculate_best_attempt', 'Return the attempt with the best grade for a quiz ', [['mod/quiz','locallib.php',1121]], 0],
'get_attempt_iterator': ['get_attempt_iterator', 'Note the part of the {@link question_usage_by_activity} comment that explains that {@link question_attempt} objects should be considered part of the inner workings of the question engine, and should not, if possible, be accessed directly. ', [['question/engine','questionusage.php',243]], 7],
'allow_commit': ['allow_commit', 'Commit delegated transaction. The real database commit SQL is executed only after committing all delegated transactions. ', [['lib/dml','moodle_transaction.php',78]], 135],
'quiz_update_sumgrades': ['quiz_update_sumgrades', 'Update the sumgrades field of the quiz. This needs to be called whenever the grading structure of the quiz is changed. For example if a question is added or removed, or a question weight is changed. ', [['mod/quiz','locallib.php',615]], 7],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required, Some conversions and safety checks are carried out. Lobs are supported. If the return ID isn\'t required, then this just reports success as true/false. $data is an object containing needed data ', [['lib/dml','pdo_moodle_database.php',387],['lib/dml','oci_native_moodle_database.php',1297],['lib/dml','pgsql_native_moodle_database.php',889],['lib/dml','mssql_native_moodle_database.php',962],['lib/dml','mysqli_native_moodle_database.php',1185],['question/engine/upgrade','upgradelib.php',124],['lib/dml','sqlsrv_native_moodle_database.php',1045],['lib/dml/tests','dml_test.php',5548]], 1611],
'quiz_has_attempts': ['quiz_has_attempts', '', [['mod/quiz','locallib.php',474]], 6],
'group_deleted': ['group_deleted', 'A group was deleted. ', [['mod/lesson/classes','group_observers.php',72],['mod/quiz/classes','group_observers.php',75]], 1],
'quiz_format_question_grade': ['quiz_format_question_grade', 'Round a grade to the correct number of decimal places, and format it for display. ', [['mod/quiz','lib.php',662]], 15],
'groups_get_all_groups': ['groups_get_all_groups', 'Gets array of all groups in a specified course. ', [['lib','grouplib.php',189]], 108],
'get_all_user_name_fields': ['get_all_user_name_fields', 'A centralised location for the all name fields. Returns an array / sql string snippet. ', [['lib','moodlelib.php',3360]], 94],
'get_end_time': ['get_end_time', 'Compute when the attempt must be submitted. ', [['mod/quiz','accessmanager.php',436]], 4],
'handle_if_time_expired': ['handle_if_time_expired', 'Check this attempt, to see if there are any state transitions that should happen automatically.  This function will update the attempt checkstatetime. ', [['mod/quiz','attemptlib.php',1737]], 6],
'avg': ['avg', 'Average grade for the attempts selected by $this->whichattempts ', [['mod/quiz/report/statistics/classes','calculated.php',100]], 19],
'quiz_feedback_record_for_grade': ['quiz_feedback_record_for_grade', 'Get the feedback object for this grade on this quiz. ', [['mod/quiz','locallib.php',547]], 2],
'out': ['out', 'Returns the selector for use in a CSS rule ', [['lib','csslib.php',1540],['lib','csslib.php',1698],['lib','csslib.php',2078],['lib','csslib.php',2162],['lib','csslib.php',2306],['lib','csslib.php',2495],['lib','csslib.php',3240],['mod/feedback/classes','responses_table.php',332],['lib','moodlelib.php',9729],['lib','weblib.php',545],['lib','tablelib.php',1594],['report/loglive/classes','table_log_ajax.php',37]], 626],
'set_module_viewed': ['set_module_viewed', 'Update the module completion status (set it viewed). ', [['mod/assign','locallib.php',8075],['lib','completionlib.php',657]], 29],
'create': ['create', 'Auto-scan an incoming line to determine the response type. ', [['lib/horde/framework/Horde/Imap/Client/Interaction','Server.php',65],['lib/google/src/Google/Service','Partners.php',492],['lib/simplepie/library/SimplePie','Cache.php',95],['lib/google/src/Google/Service','YouTubeReporting.php',237],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',81],['lib/google/src/Google/Service','MapsEngine.php',1677],['lib/google/src/Google/Service','MapsEngine.php',1977],['lib/google/src/Google/Service','MapsEngine.php',2253],['lib/google/src/Google/Service','MapsEngine.php',2330],['lib/google/src/Google/Service','MapsEngine.php',2898],['lib/spout/src/Spout/Writer','WriterFactory.php',18],['lib/google/src/Google/Service','Dns.php',290],['lib/google/src/Google/Service','Dns.php',363],['lib/google/src/Google/Service','Appengine.php',438],['tag/classes','collection.php',188],['lib/adodb','adodb-xmlschema.inc.php',152],['lib/adodb','adodb-xmlschema.inc.php',473],['lib/adodb','adodb-xmlschema.inc.php',738],['lib/adodb','adodb-xmlschema.inc.php',884],['lib/adodb','adodb-xmlschema.inc.php',1129],['mod/quiz','attemptlib.php',100],['mod/quiz','attemptlib.php',596],['lib','weblib.php',3206],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',58],['lib/google/src/Google/Service','Dataflow.php',273],['lib/simplepie/library/SimplePie','Registry.php',153],['competency/classes','persistent.php',387],['lib/google/src/Google/Service','Cloudresourcemanager.php',373],['lib/phpexcel/PHPExcel/Shared/PCLZip','pclzip.lib.php',270],['lib/google/src/Google/Service','TagManager.php',1007],['lib/google/src/Google/Service','TagManager.php',1097],['lib/google/src/Google/Service','TagManager.php',1249],['lib/google/src/Google/Service','TagManager.php',1342],['lib/google/src/Google/Service','TagManager.php',1436],['lib/google/src/Google/Service','TagManager.php',1530],['lib/google/src/Google/Service','TagManager.php',1681],['mod/lesson','locallib.php',1011],['mod/lesson','locallib.php',2163],['mod/lesson','locallib.php',3212],['lib','modinfolib.php',1732],['repository','lib.php',206],['repository','lib.php',1910],['lib','navigationlib.php',268],['lib/htmlpurifier/HTMLPurifier','Config.php',114],['lib/google/src/Google/Service','Container.php',284],['lib/google/src/Google/Service','Genomics.php',632],['lib/google/src/Google/Service','Genomics.php',721],['lib/google/src/Google/Service','Genomics.php',1312],['lib/google/src/Google/Service','Genomics.php',1427],['lib/google/src/Google/Service','Games.php',1649],['lib/google/src/Google/Service','Games.php',2013],['lib/google/src/Google/Service','Fitness.php',377],['lib/google/src/Google/Service','Gmail.php',747],['lib/google/src/Google/Service','Gmail.php',905],['mod/quiz/classes','structure.php',65],['lib/htmlpurifier/HTMLPurifier','ElementDef.php',135],['lib/adodb','adodb-xmlschema03.inc.php',170],['lib/adodb','adodb-xmlschema03.inc.php',514],['lib/adodb','adodb-xmlschema03.inc.php',779],['lib/adodb','adodb-xmlschema03.inc.php',930],['lib/adodb','adodb-xmlschema03.inc.php',1228],['lib/google/src/Google/Service','Proximitybeacon.php',500],['tag/classes','area.php',205],['course','lib.php',3003],['question/type/ddmarker','shapes.php',170],['lib/classes/event','base.php',149],['lib','coursecatlib.php',325],['repository/filesystem','lib.php',498],['lib/google/src/Google/Service','Storagetransfer.php',281],['calendar','lib.php',2686],['lib/htmlpurifier/HTMLPurifier','Lexer.php',53],['lib/google/src/Google/Service','Classroom.php',445],['lib/google/src/Google/Service','Classroom.php',596],['lib/google/src/Google/Service','Classroom.php',673],['lib/google/src/Google/Service','Classroom.php',783],['lib/google/src/Google/Service','Classroom.php',912],['lib/spout/src/Spout/Reader','ReaderFactory.php',18],['lib/google/src/Google/Service','Pubsub.php',220],['lib/google/src/Google/Service','Pubsub.php',365],['lib/google/src/Google/Service','CloudMonitoring.php',258]], 3276],
'quiz_attempt_submitted_handler': ['quiz_attempt_submitted_handler', 'Handle the quiz_attempt_submitted event. ', [['mod/quiz','locallib.php',1709]], 0],
'message_send': ['message_send', 'Called when a message provider wants to send a message. This functions checks the message recipient\'s message processor configuration then sends the message to the configured processors ', [['lib','messagelib.php',29]], 94],
'start_question_based_on': ['start_question_based_on', 'Start the attempt at a question, starting from the point where the previous question_attempt $oldqa had reached. This is used by the quiz \'Each attempt builds on last\' mode. ', [['question/engine','questionusage.php',576]], 8],
'prevent_new_attempt': ['prevent_new_attempt', '', [['mod/quiz/accessrule/numattempts','rule.php',53],['mod/quiz/accessrule','accessrulebase.php',76],['mod/quiz','accessmanager.php',312],['mod/quiz/accessrule/delaybetweenattempts','rule.php',48]], 95],
'next_slot_number': ['next_slot_number', 'The slot number that will be allotted to the next question added. ', [['question/engine','questionusage.php',211]], 6],
'delete_records_select': ['delete_records_select', '', [['lib/dml','pdo_moodle_database.php',208],['lib/dml','oci_native_moodle_database.php',1495],['lib/dml','pgsql_native_moodle_database.php',1162],['lib/dml','mssql_native_moodle_database.php',1146],['lib/dml','mysqli_native_moodle_database.php',1477],['lib/dml','sqlsrv_native_moodle_database.php',1220],['lib/dml/tests','dml_test.php',5553]], 163],
'quiz_rescale_grade': ['quiz_rescale_grade', 'Convert the raw grade stored in $attempt into a grade out of the maximum grade for this quiz. ', [['mod/quiz','locallib.php',520]], 22],
'quiz_question_action_icons': ['quiz_question_action_icons', '', [['mod/quiz','locallib.php',1252]], 1],
'quiz_calculate_best_grade': ['quiz_calculate_best_grade', 'Calculate the overall grade for a quiz given a number of attempts by a particular user. ', [['mod/quiz','locallib.php',776]], 1],
'instance': ['instance', 'Returns an instance of the cache_factor method. ', [['cache','disabledlib.php',171],['cache','disabledlib.php',296],['lib/classes','useragent.php',101],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',80],['lib/htmlpurifier/HTMLPurifier','URISchemeRegistry.php',9],['search/classes','manager.php',109],['cache','locallib.php',52],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',53],['lib/classes','plugin_manager.php',103],['lib/htmlpurifier','HTMLPurifier.php',251],['course/format','lib.php',156],['lib/classes/update','checker.php',62],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',31],['admin/tool/installaddon/classes','installer.php',40],['lib','modinfolib.php',373],['cache/classes','helper.php',76],['lib/tests','string_manager_standard_test.php',124],['lib/portfolio','exporter.php',251],['lib/classes/update','validator.php',88],['search/classes','document_factory.php',49],['lib','accesslib.php',6235],['lib','accesslib.php',6487],['lib','accesslib.php',6665],['lib','accesslib.php',6919],['lib','accesslib.php',7180],['lib','accesslib.php',7392],['backup/cc/cc_lib','cc_utils.php',387],['backup/cc/cc_lib','cc_utils.php',443],['lib','filterlib.php',80],['search/tests/fixtures','testable_core_search.php',43],['lib/tests/fixtures','testable_update_checker.php',45],['backup/cc','validator.php',35],['cache/classes','config.php',87],['cache/classes','factory.php',114],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',29]], 4647],
'quiz_has_feedback': ['quiz_has_feedback', '', [['mod/quiz','locallib.php',603]], 4],
'quiz_question_tostring': ['quiz_question_tostring', 'Creates a textual representation of a question for display. ', [['mod/quiz','locallib.php',1940]], 4],
'quiz_attempt_save_started': ['quiz_attempt_save_started', 'The save started question usage and quiz attempt in db and log the started attempt. ', [['mod/quiz','locallib.php',337]], 25],
'quiz_send_overdue_message': ['quiz_send_overdue_message', 'Send the notification message when a quiz attempt becomes overdue. ', [['mod/quiz','locallib.php',1638]], 1],
'save_question': ['save_question', 'Saves (creates or updates) a question. ', [['question/type','questiontypebase.php',277],['question/type/calculated','questiontype.php',575],['question/type/multianswer','questiontype.php',170],['question/type/random','questiontype.php',145],['question/type/description','questiontype.php',51]], 20],
'quiz_grade_item_update': ['quiz_grade_item_update', 'Create or update the grade item for given quiz ', [['mod/quiz','lib.php',702]], 7],
'instance_by_id': ['instance_by_id', 'Get a context instance as an object, from a given context id. ', [['lib','accesslib.php',5434]], 235],
'extract': ['extract', '', [['lib/phpexcel/PHPExcel/Shared/PCLZip','pclzip.lib.php',666],['lib/filestorage','tgz_extractor.php',132],['lib/lessphp','Functions.php',824],['mod/quiz','locallib.php',1904]], 17],
'make_question': ['make_question', 'Create an appropriate question_definition for the question of this type using data loaded from the database. ', [['question/type','questiontypebase.php',807],['question/engine','bank.php',282],['question/type/missingtype','questiontype.php',54],['question/type/random','questiontype.php',214],['question/engine/tests','helpers.php',269]], 266],
'quiz_get_grading_options': ['quiz_get_grading_options', '', [['mod/quiz','locallib.php',1164]], 5],
'quiz_send_confirmation': ['quiz_send_confirmation', 'Sends a confirmation message to the student confirming that the attempt was processed. ', [['mod/quiz','locallib.php',1473]], 1],
'quiz_get_overdue_handling_options': ['quiz_get_overdue_handling_options', '', [['mod/quiz','locallib.php',1187]], 2],
'quiz_start_new_attempt': ['quiz_start_new_attempt', 'Start a normal, new, quiz attempt. ', [['mod/quiz','locallib.php',144]], 23],
'is_question_available': ['is_question_available', 'Check whether a given question is available in a given category. If so, mark it used. ', [['question/classes/bank','random_question_loader.php',201]], 8],
'quiz_question_preview_url': ['quiz_question_preview_url', '', [['mod/quiz','locallib.php',1313]], 2],
'sql_isnotempty': ['sql_isnotempty', 'Returns the proper SQL to know if one field is not empty. ', [['lib/dml','moodle_database.php',2228]], 21],
'quiz_feedback_for_grade': ['quiz_feedback_for_grade', 'Get the feedback text that should be show to a student who got this grade on this quiz. The feedback is processed ready for diplay. ', [['mod/quiz','locallib.php',568]], 4],
'load_questions_usage_by_activity': ['load_questions_usage_by_activity', 'Load a {@link question_usage_by_activity} from the database, including all its {@link question_attempt}s and all their steps. ', [['question/engine','datalib.php',403],['question/engine','lib.php',76]], 14],
'get_userid': ['get_userid', 'Returns user ID ', [['lib/filebrowser','virtual_root_file.php',236],['mod/quiz','attemptlib.php',804],['lib/filestorage','stored_file.php',708],['mod/data','lib.php',2585],['backup/util/plan','restore_task.class.php',54],['backup/util/plan','restore_plan.class.php',115],['backup/controller','backup_controller.class.php',283],['backup/controller','restore_controller.class.php',285]], 220],
'quiz_question_preview_button': ['quiz_question_preview_button', '', [['mod/quiz','locallib.php',1335]], 1],
'quiz_format_grade': ['quiz_format_grade', 'Round a grade to to the correct number of decimal places, and format it for display. ', [['mod/quiz','lib.php',630]], 35],
'get_access_manager': ['get_access_manager', 'Return quiz_access_manager and instance of the quiz_access_manager class for this quiz at this time. ', [['mod/quiz','attemptlib.php',284],['mod/quiz','attemptlib.php',774]], 15],
'question_preview_icon': ['question_preview_icon', 'Render the preview icon. ', [['mod/quiz/classes/output','edit_renderer.php',700]], 2],
'quiz_update_open_attempts': ['quiz_update_open_attempts', 'Efficiently update check state time on all open attempts ', [['mod/quiz','locallib.php',969]], 13],
'sum_usage_marks_subquery': ['sum_usage_marks_subquery', 'Return a subquery that computes the sum of the marks for all the questions in a usage. Which useage to compute the sum for is controlled bu the $qubaid parameter. ', [['question/engine','datalib.php',1143]], 2],
'quiz_delete_attempt': ['quiz_delete_attempt', 'Delete a quiz attempt. ', [['mod/quiz','locallib.php',396]], 4],
'quiz_add_random_questions': ['quiz_add_random_questions', 'Add a random question to the quiz at a given point. ', [['mod/quiz','locallib.php',2085]], 7],
'format_string': ['format_string', 'Given a simple string, this function returns the string processed by enabled string filters if $CFG->filterall is enabled ', [['lib','weblib.php',1379]], 880],
'print_question_icon': ['print_question_icon', 'Print the icon for the question type ', [['lib','questionlib.php',821]], 4],
'exists': ['exists', 'Checks whether or not the variable exists. ', [['lib/htmlpurifier/HTMLPurifier','Context.php',73],['lib/horde/framework/Horde','Variables.php',101],['admin/tool/uploadcourse/classes','course.php',252],['admin/tool/health','index.php',139],['admin/tool/health','index.php',160],['admin/tool/health','index.php',184],['admin/tool/health','index.php',208],['admin/tool/health','index.php',229],['admin/tool/health','index.php',248],['admin/tool/health','index.php',267],['admin/tool/health','index.php',313],['admin/tool/health','index.php',334],['admin/tool/health','index.php',420],['admin/tool/health','index.php',444],['admin/tool/health','index.php',481],['admin/tool/health','index.php',506],['admin/tool/health','index.php',554],['admin/tool/health','index.php',617],['admin/tool/health','index.php',707],['admin/tool/health','index.php',777],['lib/horde/framework/Horde/Imap/Client/Data','Fetch.php',468],['question/type/ddmarker','shapes.php',160]], 44],
'trigger': ['trigger', '', [['lib/evalmath','evalmath.class.php',448],['lib/classes/event','base.php',765]], 964],
'join': ['join', 'Join a room. For internal use by the Games SDK only. Calling this method directly is unsupported. (rooms.join) ', [['lib/google/src/Google/Service','Games.php',1716],['lib/google/src/Google/Service','Games.php',2100]], 1030],
'get_next_question_id': ['get_next_question_id', 'Pick a question at random from the given category, from among those with the fewest uses. ', [['question/classes/bank','random_question_loader.php',78]], 23],
'view_url': ['view_url', '', [['mod/quiz','attemptlib.php',317],['mod/quiz','attemptlib.php',1355],['mod/url/classes','external.php',56],['mod/workshop','locallib.php',1527]], 49],
'has_response_to_at_least_one_graded_question': ['has_response_to_at_least_one_graded_question', 'Has the student, in this attempt, engaged with the quiz in a non-trivial way? That is, is there any question worth a non-zero number of marks, where the student has made some response that we have saved? ', [['mod/quiz','attemptlib.php',874]], 14],
'set_preferred_behaviour': ['set_preferred_behaviour', '', [['question/engine','questionusage.php',97]], 54],
'get_max_mark': ['get_max_mark', '', [['question/engine','questionattempt.php',682]], 26],
'get_record': ['get_record', 'Load a single record. ', [['competency/classes','persistent.php',738],['lib/dml','moodle_database.php',1462]], 3224],
'delete_records_list': ['delete_records_list', 'Delete the records from a table where one field match one list of values. ', [['lib/dml','moodle_database.php',1883]], 37],
'quiz_groups_members_removed_handler': ['quiz_groups_members_removed_handler', 'Handle groups_members_removed event ', [['mod/quiz','locallib.php',1803]], 1],
'get_in_or_equal': ['get_in_or_equal', 'Constructs \'IN()\' or \'=\' sql fragment ', [['lib/dml','oci_native_moodle_database.php',1635],['lib/dml','moodle_database.php',711]], 438],
'__construct': ['__construct', '', [['lib/adodb/drivers','adodb-odbc_mssql.inc.php',50],['lib/adodb/drivers','adodb-odbc_mssql.inc.php',359],['question/classes/statistics/responses','analyser.php',69],['auth/radius','auth.php',38],['lib/xmldb','xmldb_file.php',43],['lib/lessphp/Tree/Mixin','Definition.php',18],['cache/stores/static','lib.php',127],['lib/classes/session','file.php',40],['lib/htmlpurifier/HTMLPurifier/Lexer','DOMLex.php',35],['backup/util/ui','base_moodleform.class.php',68],['lib/simplepie/library/SimplePie','Author.php',81],['lib/filestorage','zip_archive.php',66],['backup/util/structure','restore_path_element.class.php',47],['backup/util/structure','restore_path_element.class.php',128],['lib/htmlpurifier/HTMLPurifier/ChildDef','Chameleon.php',36],['lib/phpexcel/PHPExcel','HashTable.php',44],['mod/quiz/tests','repaginate_test.php',39],['lib/form','modvisible.php',43],['lib/phpexcel/PHPExcel/Worksheet','Row.php',44],['cache','disabledlib.php',44],['lib/phpexcel/PHPExcel/Worksheet','Dimension.php',58],['lib/mustache/src/Mustache/Cache','FilesystemCache.php',27],['question/type/ddwtos','question.php',61],['mnet/xmlrpc','client.php',25],['lib/horde/framework/Horde/Imap/Client','Url.php',112],['lib/classes','useragent.php',115],['lib/pear/HTML/QuickForm','advcheckbox.php',66],['lib/classes/update','checker_exception.php',37],['lib/phpexcel/PHPExcel/Reader','Excel2007.php',53],['lib/jabber/XMPP','XMPP.php',101],['lib/form','radio.php',44],['lib/spout/src/Spout/Reader/XLSX/Helper','StyleHelper.php',45],['auth/cas/CAS/CAS/ProxiedService/Http','Abstract.php',58],['lib/phpexcel/PHPExcel/Style','Border.php',67],['lib/htmlpurifier/HTMLPurifier','HTMLDefinition.php',182],['lib/adodb/drivers','adodb-oci8quercus.inc.php',31],['lib/adodb/drivers','adodb-oci8quercus.inc.php',45],['lib/spout/src/Spout/Reader/XLSX','SheetIterator.php',29],['lib/horde/framework/Horde/Imap/Client/Interaction','Server.php',91],['lib/phpexcel/PHPExcel','DocumentProperties.php',123],['lib/typo3','class.t3lib_cs.php',509],['mod/workshop/allocation/scheduled','lib.php',48],['lib/adodb/drivers','adodb-netezza.inc.php',53],['lib/adodb/drivers','adodb-netezza.inc.php',144],['mod/feedback/classes','complete_form.php',58],['search/classes','document.php',188],['webservice/rest','locallib.php',40],['lib/dml','mssql_native_moodle_recordset.php',34],['mod/assign/feedback/editpdf/fpdi','fpdi_pdf_parser.php',57],['lib/htmlpurifier/HTMLPurifier','TokenFactory.php',43],['backup/moodle2','backup_block_task.class.php',43],['lib/lessphp/Tree','Negative.php',14],['lib/minify/lib/Minify/Cache','APC.php',19],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',54],['lib/pear/HTML/QuickForm','header.php',33],['lib/spout/src/Spout/Reader/XLSX/Helper/SharedStringsCaching','InMemoryStrategy.php',26],['lib/phpexcel/PHPExcel/Worksheet','RowCellIterator.php',51],['lib/simplepie/library/SimplePie/XML/Declaration','Parser.php',110],['lib/phpexcel/PHPExcel/Worksheet','ColumnIterator.php',60],['lib/spout/src/Spout/Reader/ODS','Sheet.php',33],['question/type/calculated/tests','helper.php',205],['lib/adodb/drivers','adodb-odbtp.inc.php',38],['lib/adodb/drivers','adodb-odbtp.inc.php',673],['lib/adodb/drivers','adodb-odbtp.inc.php',796],['lib/adodb/drivers','adodb-odbtp.inc.php',806],['lib/adodb/drivers','adodb-odbtp.inc.php',816],['lib/adodb/drivers','adodb-odbtp.inc.php',826],['lib/adodb/drivers','adodb-odbtp.inc.php',836],['enrol/lti/ims-blti','blti.php',28],['backup/cc','cc2moodle.php',105],['mod/chat','locallib.php',181],['mod/chat','locallib.php',229],['user/filters','simpleselect.php',45],['lib/phpexcel/PHPExcel/CachedObjectStorage','Memcache.php',244],['lib/dml','pdo_moodle_database.php',42],['lib/adodb/drivers','adodb-sqlite3.inc.php',36],['lib/adodb/drivers','adodb-sqlite3.inc.php',350],['lib/pear/HTML/QuickForm','static.php',44],['competency/classes/external','comment_area_exporter.php',48],['lib/lessphp/Tree','Selector.php',31],['auth/cas/CAS/CAS','TypeMismatchException.php',43],['auth/fc','fcFPP.php',33],['lib/xmldb','xmldb_key.php',43],['grade/grading/form/rubric','rubriceditor.php',56],['lib/google/src/Google/Service','Cloudlatencytest.php',40],['course','moodleform_mod.php',69],['auth/nntp','auth.php',35],['grade/report/grader','lib.php',111],['admin/tool/generator/classes','course_backend.php',116],['lib/minify/lib','FirePHP.php',189],['lib/adodb/drivers','adodb-sqlitepo.inc.php',38],['lib/horde/framework/Horde/Imap/Client','Tokenize.php',67],['lib/phpexcel/PHPExcel/CachedObjectStorage','CacheBase.php',66],['lib/lessphp/Tree','Rule.php',24],['lib/behat/features/bootstrap','behat_init_context.php',45],['lib','dmllib.php',69],['lib','dmllib.php',84],['lib','dmllib.php',104],['lib','dmllib.php',129],['lib','dmllib.php',159],['lib','dmllib.php',187],['lib','dmllib.php',240],['lib','dmllib.php',270],['lib/google/src/Google/Service','DataTransfer.php',44],['lib/google/src/Google/Http','Batch.php',42],['backup/util/structure','base_processor.class.php',49],['admin/tool/lpmigrate/classes','framework_mapper.php',50],['lib/phpexcel/PHPExcel/Reader','OOCalc.php',46],['lib/lessphp/Tree','NameValue.php',22],['mod/quiz/classes','admin_review_setting.php',82],['lib/htmlpurifier/HTMLPurifier','Generator.php',67],['mod/quiz/report','attemptsreport_table.php',76],['blocks/lp/classes/output','summary.php',59],['lib/google/src/Google/IO','Stream.php',45],['lib/google/src/Google/Service','Freebase.php',38],['grade/tests','reportlib_test.php',36],['search/classes','manager.php',100],['question/behaviour/adaptive','behaviour.php',310],['admin/tool/lp/classes/form','framework_autocomplete.php',48],['lib/minify/lib','JSMinPlus.php',193],['lib/minify/lib','JSMinPlus.php',726],['lib/minify/lib','JSMinPlus.php',1638],['lib/minify/lib','JSMinPlus.php',1656],['lib/minify/lib','JSMinPlus.php',1748],['lib/simplepie/library/SimplePie','Copyright.php',73],['lib/phpexcel/PHPExcel/Style','Conditional.php',93],['lib/google/src/Google/Task','Runner.php',76],['backup/util/settings/root','root_backup_setting.class.php',34],['lib','componentlib.class.php',179],['lib','componentlib.class.php',610],['lib','componentlib.class.php',834],['lib/google/src/Google/Service','AdSense.php',68],['lib/htmlpurifier/HTMLPurifier/AttrDef','Clone.php',18],['lib/spout/src/Spout/Reader/CSV','Sheet.php',24],['lib/filebrowser','file_info_context_system.php',37],['lib/grade','grade_item.php',260],['lib/horde/framework/Horde/Imap/Client/Data/Format','Nstring.php',27],['repository/boxnet','lib.php',56],['auth/email','auth.php',34],['mod/wiki/editors','wikifiletable.php',40],['lib/google/src/Google/Service','Replicapool.php',51],['lib/dtl','database_exporter.php',55],['lib/horde/framework/Horde/Imap/Client/Namespace','List.php',34],['lib/phpexcel/PHPExcel/Writer','CSV.php',79],['lib/google/src/Google/Service','Tasks.php',44],['lib/dml','mysqli_native_moodle_recordset.php',42],['lib/google/src/Google/Service','GamesManagement.php',50],['lib/minify/lib/Minify','Source.php',43],['lib/jabber/XMPP','Roster.php',48],['lib/lessphp/Tree','Element.php',19],['lib/classes','string_manager_install.php',43],['question/type','questiontypebase.php',55],['question/type','questiontypebase.php',1442],['lib/form','filemanager.php',54],['lib/form','filemanager.php',316],['lib/htmlpurifier/HTMLPurifier/ChildDef','Custom.php',36],['backup/util/ui','renderer.php',813],['lib/simplepie/library/SimplePie','Rating.php',73],['lib/phpexcel/PHPExcel/Cell','Hyperlink.php',44],['question/classes/statistics/questions','calculator.php',66],['backup/moodle2','backup_xml_transformer.class.php',50],['lib/google/src/Google/Service','Resource.php',62],['lib/form','autocomplete.php',56],['lib/phpexcel/PHPExcel/Worksheet','RowIterator.php',60],['mod/lesson/classes','file_info.php',45],['question/type/tests','question_first_matching_answer_grading_strategy_test.php',40],['lib/google/src/Google/Service','Partners.php',43],['cache','lib.php',66],['cache','lib.php',109],['cache','lib.php',138],['cache','lib.php',183],['grade/edit/tree','lib.php',57],['grade/edit/tree','lib.php',635],['grade/edit/tree','lib.php',668],['grade/edit/tree','lib.php',834],['lib/simplepie/library/SimplePie','Cache.php',69],['mod/wiki/diff','difflib.php',277],['mod/wiki/diff','difflib.php',381],['mod/wiki/diff','difflib.php',478],['lib/pear/HTML/QuickForm','select.php',58],['lib/classes/output','mustache_javascript_helper.php',40],['lib/phpexcel/PHPExcel/Reader/Excel2007','Theme.php',68],['mod/data','export_form.php',16],['lib/pear/HTML/QuickForm','autocomplete.php',67],['question/type/shortanswer','question.php',44],['lib/google/src/Google/Service','AndroidPublisher.php',52],['lib/google/src/Google/Verifier','Pem.php',31],['lib/classes/antivirus','scanner.php',41],['lib/phpexcel/PHPExcel/Reader','Excel5.php',414],['lib/horde/framework/Horde/Imap/Client/Auth','DigestMD5.php',69],['lib/classes/output','mustache_filesystem_loader.php',39],['lib/classes/output','inplace_editable.php',107],['lib/adodb/drivers','adodb-informix.inc.php',37],['competency/classes','competency_rule.php',45],['lib/phpexcel/PHPExcel','RichText.php',37],['lib/phpexcel/PHPExcel/Shared/JAMA','Matrix.php',59],['lib/pear/HTML/QuickForm','input.php',38],['repository/picasa','lib.php',41],['mod/feedback/classes','structure.php',48],['backup/util/plan','backup_structure_step.class.php',38],['question/classes/bank','random_question_loader.php',61],['mod/quiz/report/statistics/classes','calculated.php',43],['lib/horde/framework/Horde/Stream','String.php',27],['backup/util/helper','restore_decode_content.class.php',50],['backup/util/helper','restore_decode_content.class.php',125],['mod/workshop/backup/moodle1','lib.php',308],['lib/google/src/Google/Service','YouTubeReporting.php',47],['grade/export/txt','grade_export_txt.php',27],['lib/mustache/src/Mustache/Exception','SyntaxException.php',23],['lib/tcpdf','tcpdf_barcodes_2d.php',58],['mod/imscp','locallib.php',289],['lib/form','selectyesno.php',42],['lib/horde/framework/Horde/Mail/Transport','Smtphorde.php',62],['mod/lti/service/toolsettings/classes/local/service','toolsettings.php',41],['mod/lti/service/profile/classes/local/service','profile.php',41],['repository/flickr_public','lib.php',49],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','BackgroundPosition.php',57],['admin/tool/lp/classes/output','template_cohorts_table.php',53],['lib/simplepie/library','SimplePie.php',611],['lib/horde/framework/Horde/Imap/Client/Base','Debug.php',55],['lib/google/src/Google/Service','Reseller.php',44],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Border.php',18],['lib/testing/generator','component_generator_base.php',45],['lib/horde/framework/Horde/Translation/Handler','Gettext.php',34],['lib/phpexcel/PHPExcel/Worksheet','HeaderFooter.php',175],['lib/classes','plugin_manager.php',91],['lib/horde/framework/Horde/Imap/Client/Data/Format','List.php',28],['lib/horde/framework/Horde/Support','CombineStream.php',29],['lib/xmldb','xmldb_field.php',84],['lib/adodb/drivers','adodb-ibase.inc.php',59],['lib/adodb/drivers','adodb-ibase.inc.php',764],['lib/htmlpurifier/HTMLPurifier/AttrDef','URI.php',23],['admin/roles/classes','view_role_definition_table.php',28],['lib/google/src/Google/Cache','Memcache.php',44],['lib/pear/HTML/QuickForm','radio.php',48],['lib/filebrowser','file_info_context_coursecat.php',39],['lib/spout/src/Spout/Writer/ODS/Internal','Workbook.php',37],['mod/workshop/eval/best','lib.php',44],['lib/phpexcel/PHPExcel/Writer/PDF','DomPDF.php',38],['grade/report','lib.php',156],['lib','csslib.php',1501],['lib','csslib.php',1587],['lib','csslib.php',2068],['lib','csslib.php',2136],['lib','csslib.php',2242],['availability/classes','info_module.php',40],['mod/book','locallib.php',414],['question/engine','datalib.php',68],['question/engine','datalib.php',1331],['question/engine','datalib.php',1632],['question/engine','datalib.php',1740],['question/engine','datalib.php',1870],['question/engine','datalib.php',1941],['webservice','lib.php',745],['webservice','lib.php',841],['lib/adodb/drivers','adodb-informix72.inc.php',59],['lib/adodb/drivers','adodb-informix72.inc.php',399],['lib/adodb','adodb-pager.inc.php',60],['user/classes/output/myprofile','category.php',68],['lib/lessphp/Visitor','extendFinder.php',15],['backup/util/settings','base_setting.class.php',89],['backup/util/settings','base_setting.class.php',556],['lib','filelib.php',2720],['lib','filelib.php',3601],['lib/phpunit/classes','database_driver_testcase.php',55],['lib/phpexcel/PHPExcel/Shared/OLE/PPS','File.php',32],['report/competency/classes/output','report.php',56],['lib/google/src/Google/Service','Computeaccounts.php',49],['question/type','edit_question_form.php',96],['lib/filebrowser','file_info_context_user.php',39],['admin/tool/lp/classes/output','template_plans_page.php',37],['lib/phpexcel/PHPExcel','Style.php',93],['lib/minify/lib/Minify','HTML.php',49],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','ListStyle.php',20],['lib/form','password.php',44],['backup','backup.class.php',146],['mod/feedback/classes','course_select_form.php',39],['lib/google/src/Google/Auth','AppIdentity.php',39],['lib/adodb','adodb-active-record.inc.php',121],['lib/phpexcel/PHPExcel','Chart.php',169],['lib/horde/framework/Horde/Mail/Rfc822','List.php',61],['admin/roles/classes','allow_switch_page.php',33],['lib/grade','grade_object.php',80],['lib/google/src/Google/IO','Exception.php',29],['auth/lti','auth.php',38],['mod/quiz/report/statistics/classes','calculator.php',39],['lib/htmlpurifier','HTMLPurifier.php',104],['admin/tool/lp/classes/output','user_competency_summary_in_plan.php',47],['mod/assign/feedback/editpdf/classes','widget.php',53],['lib/evalmath','evalmath.class.php',120],['lib/form','url.php',46],['lib/dml','pdo_moodle_recordset.php',41],['lib/htmlpurifier/HTMLPurifier/TagTransform','Simple.php',19],['backup/cc/cc_lib','xmlbase.php',52],['badges/lib','bakerlib.php',52],['lib/google/src/Google/Signer','P12.php',35],['availability/classes','info_section.php',40],['lib/form','static.php',47],['backup/converter','convertlib.php',52],['backup/converter','convertlib.php',277],['lib/google/src/Google/Service','YouTubeAnalytics.php',56],['admin/roles/classes','check_capability_table.php',40],['lib/htmlpurifier/HTMLPurifier','AttrTypes.php',14],['lib/adodb/drivers','adodb-postgres64.inc.php',127],['lib/adodb/drivers','adodb-postgres64.inc.php',919],['backup/util/helper','restore_prechecks_helper.class.php',213],['user/profile','lib.php',59],['lib/google/src/Google/Service','Admin.php',40],['lib/spout/src/Spout/Reader/CSV','RowIterator.php',62],['lib/google/src/Google/Service','MapsEngine.php',66],['lib','listlib.php',82],['lib','listlib.php',485],['lib/phpexcel/PHPExcel/Writer','HTML.php',128],['backup/moodle2','restore_activity_task.class.php',48],['lib/htmlpurifier/HTMLPurifier','HTMLModuleManager.php',68],['lib/simplepie/library/SimplePie','Source.php',61],['completion','data_object.php',68],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','ID.php',28],['grade/report/singleview/classes/local/ui','dropdown_attribute.php',49],['lib/horde/framework/Horde/Support','Stack.php',18],['lib/google/src/Google/Cache','File.php',41],['lib/horde/framework/Horde/Mail/Transport','Mock.php',76],['backup/util/ui','backup_moodleform.class.php',41],['availability/condition/grouping/classes','condition.php',46],['lib/classes/session','memcache.php',50],['cache/classes','dummystore.php',62],['badges/classes','assertion.php',49],['lib/xhprof/xhprof_lib/utils','xhprof_runs.php',87],['availability/tests/fixtures','mock_condition.php',52],['lib/mustache/src/Mustache/Loader','FilesystemLoader.php',33],['mod/quiz/report','attemptsreport_options.php',95],['lib/phpexcel/PHPExcel/Writer/PDF','tcPDF.php',39],['lib/minify/lib/Minify/CSS','Compressor.php',51],['lib/google/src/Google/Service','Dns.php',53],['question/type/calculatedmulti','edit_calculatedmulti_form.php',47],['backup/moodle2','restore_block_task.class.php',45],['lib/phpexcel/PHPExcel/Worksheet','AutoFilter.php',54],['lib/form','recaptcha.php',48],['lib','csvlib.class.php',64],['lib','csvlib.class.php',398],['lib/simplepie/library/SimplePie/Cache','File.php',82],['lib/phpexcel/PHPExcel/Chart','Legend.php',75],['lib/phpexcel/PHPExcel','WorksheetIterator.php',44],['cache/classes','loaders.php',196],['cache/classes','loaders.php',1189],['cache/classes','loaders.php',1586],['lib/google/src/Google/Service','Appengine.php',44],['admin/tool/lp/classes/output','template_cohorts_page.php',37],['search/classes','engine.php',77],['backup/cc/cc_lib','cc_assesment_essay.php',25],['lib/classes/progress','display.php',48],['lib/lessphp/Tree','Call.php',19],['course/format','lib.php',78],['question/type/calculated','datasetdefinitions_form.php',53],['lib/google/src/Google/Service','Translate.php',40],['enrol/database','settingslib.php',34],['lib/lessphp/Tree/Mixin','Call.php',14],['admin/tool/log/store/standard/classes/log','store.php',37],['lib/google/src/Google/Service','Urlshortener.php',40],['lib/horde/framework/Horde/Imap/Client','Socket.php',168],['lib/tests','collator_test.php',310],['lib/google/src/Google/Auth','Simple.php',31],['backup/cc/cc_lib','cc_manifest.php',45],['lib/bennu','iCalendar_properties.php',28],['lib/bennu','iCalendar_properties.php',220],['lib/bennu','iCalendar_properties.php',238],['lib/bennu','iCalendar_properties.php',259],['lib/bennu','iCalendar_properties.php',275],['lib/bennu','iCalendar_properties.php',296],['lib/bennu','iCalendar_properties.php',343],['lib/bennu','iCalendar_properties.php',358],['lib/bennu','iCalendar_properties.php',376],['lib/bennu','iCalendar_properties.php',391],['lib/bennu','iCalendar_properties.php',406],['lib/bennu','iCalendar_properties.php',447],['lib/bennu','iCalendar_properties.php',462],['lib/bennu','iCalendar_properties.php',485],['lib/bennu','iCalendar_properties.php',509],['lib/bennu','iCalendar_properties.php',524],['lib/bennu','iCalendar_properties.php',555],['lib/bennu','iCalendar_properties.php',573],['lib/bennu','iCalendar_properties.php',594],['lib/bennu','iCalendar_properties.php',637],['lib/bennu','iCalendar_properties.php',680],['lib/bennu','iCalendar_properties.php',724],['lib/bennu','iCalendar_properties.php',747],['lib/bennu','iCalendar_properties.php',782],['lib/bennu','iCalendar_properties.php',808],['lib/bennu','iCalendar_properties.php',849],['lib/bennu','iCalendar_properties.php',864],['lib/bennu','iCalendar_properties.php',905],['lib/bennu','iCalendar_properties.php',938],['lib/bennu','iCalendar_properties.php',952],['lib/bennu','iCalendar_properties.php',965],['lib/bennu','iCalendar_properties.php',987],['lib/bennu','iCalendar_properties.php',1017],['lib/bennu','iCalendar_properties.php',1031],['lib/bennu','iCalendar_properties.php',1061],['lib/bennu','iCalendar_properties.php',1075],['lib/bennu','iCalendar_properties.php',1098],['lib/bennu','iCalendar_properties.php',1110],['lib/bennu','iCalendar_properties.php',1139],['lib/bennu','iCalendar_properties.php',1160],['lib/bennu','iCalendar_properties.php',1181],['lib/bennu','iCalendar_properties.php',1203],['lib/bennu','iCalendar_properties.php',1227],['lib/bennu','iCalendar_properties.php',1260],['lib/bennu','iCalendar_properties.php',1386],['lib/bennu','iCalendar_properties.php',1407],['lib/bennu','iCalendar_properties.php',1429],['lib/bennu','iCalendar_properties.php',1450],['lib/mustache/src/Mustache/Exception','UnknownTemplateException.php',22],['lib/phpmailer','moodle_phpmailer.php',47],['availability/tests/fixtures','mock_info.php',40],['lib/horde/framework/Horde/Mail/Transport','Smtpmx.php',138],['admin/tool/lp/classes/form','persistent.php',68],['lib/adodb/drivers','adodb-mysqlt.inc.php',32],['lib/adodb/drivers','adodb-mysqlt.inc.php',96],['webservice/tests','lib_test.php',213],['lib/horde/framework/Horde/Imap/Client/Data/Format','Mailbox.php',35],['filter','local_settings_form.php',33],['mod/quiz/accessrule','accessrulebase.php',52],['lib/horde/framework/Horde/Exception','Wrapped.php',16],['mod/assign/feedback/editpdf/fpdi','pdf_parser.php',170],['lib/lessphp/Tree','Dimension.php',15],['lib/minify/lib/HTTP','ConditionalGet.php',109],['lib/adodb/perf','perf-oci8.inc.php',203],['lib/phpexcel','PHPExcel.php',361],['backup/util/helper','restore_questions_parser_processor.class.php',42],['backup/moodle2','backup_plugin.class.php',44],['lib/classes/antivirus','scanner_exception.php',38],['webservice/xmlrpc','lib.php',43],['report/loglive/classes','renderable.php',73],['course','dnduploadlib.php',109],['course','dnduploadlib.php',407],['lib/filebrowser','file_info.php',43],['lib/adodb/drivers','adodb-access.inc.php',34],['lib/adodb/drivers','adodb-access.inc.php',83],['mod/feedback/classes','responses_table.php',54],['lib/editor/tinymce','adminlib.php',36],['admin/tool/monitor/classes','rule.php',44],['lib/google/src/Google/Service','AdExchangeBuyer.php',55],['lib/filebrowser','virtual_root_file.php',45],['lib/phpexcel/PHPExcel/RichText','Run.php',35],['admin/tool/monitor/classes/output/managesubs','subs.php',51],['auth/cas/CAS/CAS','ProxyChain.php',48],['lib/htmlpurifier/HTMLPurifier','DefinitionCache.php',22],['lib/google/src/Google/Service','CivicInfo.php',40],['mod/feedback/classes/output','summary.php',52],['lib/minify/lib/Minify','Build.php',77],['lib/adodb/drivers','adodb-ado_mssql.inc.php',146],['lib/adodb/drivers','adodb-odbc.inc.php',44],['lib/adodb/drivers','adodb-odbc.inc.php',611],['lib','moodlelib.php',9421],['lib','moodlelib.php',9632],['user/selector','lib.php',85],['user/selector','lib.php',674],['admin/tool/lp/classes/output','plan_page.php',49],['repository/dropbox','lib.php',49],['lib/horde/framework/Horde/Mime','Part.php',261],['lib/spout/src/Spout/Reader/XLSX/Helper/SharedStringsCaching','CachingStrategyFactory.php',56],['lib/phpexcel/PHPExcel/Chart','Layout.php',143],['lib/mustache/src/Mustache/Loader','CascadingLoader.php',20],['lib/phpexcel/PHPExcel/Shared/JAMA','EigenvalueDecomposition.php',777],['lib/google/src/Google/Service','Books.php',60],['lib/google/src/Google/Service','Oauth2.php',50],['admin/tool/log/classes/log','store.php',30],['admin/tool/recyclebin/classes','category_bin.php',45],['lib/phpexcel/PHPExcel/Style','Color.php',64],['lib/phpexcel/PHPExcel/Worksheet','SheetView.php',69],['lib/htmlpurifier/HTMLPurifier/Token','Text.php',34],['lib/classes/update','checker.php',50],['lib/horde/framework/Horde/Socket','Client.php',52],['lib/phpexcel/PHPExcel/CachedObjectStorage','APC.php',243],['lib/horde/framework/Horde/Imap/Client/Cache','Backend.php',33],['lib/phpexcel/PHPExcel/Chart','Title.php',45],['lib/horde/framework/Horde/Imap/Client/Data','Format.php',32],['lib/adodb/drivers','adodb-text.inc.php',93],['lib/adodb/drivers','adodb-text.inc.php',379],['lib/phpexcel/PHPExcel','Calculation.php',2071],['lib/adodb/drivers','adodb-sqlite.inc.php',36],['lib/adodb/drivers','adodb-sqlite.inc.php',367],['lib/google/src/Google/Service','Analytics.php',77],['blocks/lp/classes/output','plans_to_review_page.php',48],['lib/google/src/Google/Service','Coordinate.php',48],['availability/condition/group/classes','condition.php',43],['lib/lessphp/Exception','Chunk.php',19],['lib/htmlpurifier/HTMLPurifier','PropertyListIterator.php',22],['backup/cc/cc_lib','cc_resources.php',102],['lib/horde/framework/Horde/Mail/Rfc822','Group.php',45],['backup/util/structure','base_optigroup.class.php',35],['backup/util/structure','base_optigroup.class.php',169],['question/classes/statistics/questions','calculated.php',181],['lib/horde/framework/Horde/Imap/Client/Interaction','Command.php',72],['lib/htmlpurifier/HTMLPurifier/Strategy','Core.php',8],['lib/htmlpurifier/HTMLPurifier/Filter','ExtractStyleBlocks.php',57],['backup/cc/cc_lib','cc_converter_url.php',29],['lib/xmldb','xmldb_structure.php',40],['lib/ddl','sqlite_sql_generator.php',73],['lib/pear/HTML/QuickForm','Renderer.php',31],['backup/util/helper','restore_moodlexml_parser_processor.class.php',38],['lib/pear/HTML/QuickForm','file.php',54],['lib/minify/lib/Minify/Cache','File.php',9],['lib/pear/HTML/QuickForm','xbutton.php',39],['lib/htmlpurifier','locallib.php',134],['admin/tool/recyclebin/classes','course_bin.php',45],['backup/util/plan','backup_task.class.php',32],['backup/util/plan','backup_task.class.php',56],['lib/phpexcel/PHPExcel/CachedObjectStorage','PHPTemp.php',174],['backup/util/helper','backup_helper.class.php',381],['lib/form','htmleditor.php',48],['lib','oauthlib.php',65],['lib','oauthlib.php',409],['auth/cas/CAS/CAS/PGTStorage','File.php',105],['auth/cas/CAS/CAS/ProxiedService','Imap.php',51],['repository/skydrive','lib.php',42],['lib/htmlpurifier/HTMLPurifier','ErrorCollector.php',57],['lib/classes/lock','postgres_lock_factory.php',81],['lib/phpexcel/PHPExcel/CachedObjectStorage','SQLite.php',260],['lib/horde/framework/Horde/Support','ConsistentHash.php',56],['lib/horde/framework/Horde/Exception','Pear.php',22],['lib/portfolio','exceptions.php',50],['backup/moodle2','restore_plugin.class.php',43],['lib/phpexcel/PHPExcel/CachedObjectStorage','DiscISAM.php',177],['lib/google/src/Google/Service','DoubleClickBidManager.php',40],['lib/minify/lib/Minify/JS','ClosureCompiler.php',101],['lib/horde/framework/Horde/Imap/Client/Data/Format','String.php',38],['lib/form','dateselector.php',70],['lib/spout/src/Spout/Common/Helper','EncodingHelper.php',38],['report/competency/classes/output','user_course_navigation.php',51],['lib/adodb/drivers','adodb-postgres7.inc.php',98],['lib/adodb/drivers','adodb-postgres7.inc.php',311],['lib/adodb/drivers','adodb-postgres7.inc.php',342],['lib/lessphp/Tree','Alpha.php',13],['mod/lti/service/memberships/classes/local/resource','linkmemberships.php',46],['lib/tcpdf','tcpdf.php',1822],['lib/adodb/drivers','adodb-sybase.inc.php',47],['lib/adodb/drivers','adodb-sybase.inc.php',313],['lib/adodb/drivers','adodb-sybase.inc.php',394],['lib/phpexcel/PHPExcel/Chart','PlotArea.php',44],['lib/phpexcel/PHPExcel/Chart','DataSeries.php',136],['mod/lesson','editpage_form.php',41],['question/classes/statistics/responses','analysis_for_question.php',58],['lib/horde/framework/Horde','Domhtml.php',53],['lib','formslib.php',142],['lib','formslib.php',1442],['lib','formslib.php',2653],['rating','lib.php',114],['rating','lib.php',1070],['lib/phpexcel/PHPExcel/Worksheet','Column.php',44],['lib/google/src/Google/Service','Script.php',67],['lib/adodb','adodb-xmlschema.inc.php',118],['lib/adodb','adodb-xmlschema.inc.php',245],['lib/adodb','adodb-xmlschema.inc.php',637],['lib/adodb','adodb-xmlschema.inc.php',781],['lib/adodb','adodb-xmlschema.inc.php',982],['lib/adodb','adodb-xmlschema.inc.php',1295],['lib/google/src/Google/Service','DeploymentManager.php',54],['mod/quiz','attemptlib.php',41],['mod/quiz','attemptlib.php',82],['mod/quiz','attemptlib.php',546],['mod/quiz','attemptlib.php',2337],['mod/quiz','attemptlib.php',2392],['backup/cc/cc_lib','cc_converter_forum.php',29],['lib','boxlib.php',264],['lib/simplepie/library/SimplePie','Restriction.php',81],['admin/roles/classes','allow_assign_page.php',31],['lib/adodb/drivers','adodb-pdo.inc.php',90],['lib/adodb/drivers','adodb-pdo.inc.php',553],['lib/adodb/drivers','adodb-pdo.inc.php',630],['tag/classes/output','tagareacollection.php',40],['admin/tool/lp/classes','template_statistics.php',62],['lib','weblib.php',313],['lib','weblib.php',3183],['lib','weblib.php',3483],['lib','weblib.php',3518],['lib','weblib.php',3593],['backup/cc/cc_lib','cc_converter_basiclti.php',29],['lib/html2text','Html2Text.php',232],['mod/assign/feedback/editpdf/classes','annotation.php',66],['lib/pear/HTML/QuickForm/Renderer','Array.php',143],['question/engine','lib.php',774],['question/engine','lib.php',1011],['question/engine','lib.php',1059],['lib/jabber/XMPP','XMLObj.php',76],['lib/horde/framework/Horde/Exception','PermissionDenied.php',15],['lib/editor/atto','adminlib.php',109],['lib/pear/HTML/QuickForm/Renderer','Tableless.php',116],['grade/report/history/classes/output','tablelog.php',72],['lib/google/src/Google/IO','Curl.php',38],['lib/editor/tinymce/plugins/spellchecker/classes/utils','Logger.php',31],['lib/pear/HTML/QuickForm','hiddenselect.php',41],['backup/util/ui','backup_ui_setting.class.php',70],['backup/util/ui','backup_ui_setting.class.php',200],['backup/util/ui','backup_ui_setting.class.php',398],['backup/util/ui','backup_ui_setting.class.php',504],['backup/util/ui','backup_ui_setting.class.php',583],['lib/adodb/drivers','adodb-mysqlpo.inc.php',35],['lib/adodb/drivers','adodb-mysqlpo.inc.php',82],['lib/adodb/drivers','adodb-mysqlpo.inc.php',119],['lib/google/src/Google/Service','Blogger.php',50],['backup/util/xml/output','file_xml_output.class.php',37],['lib/form','tags.php',75],['admin/tool/installaddon/classes','installer.php',219],['lib/htmlpurifier/HTMLPurifier/AttrDef','Enum.php',30],['lib/simplepie/library/SimplePie','IRI.php',252],['comment','locallib.php',39],['question/engine','states.php',61],['lib/spout/src/Spout/Reader/XLSX/Helper','CellValueFormatter.php',52],['lib/google/src/Google/Service','Dataflow.php',45],['mod/data','locallib.php',66],['mod/data','locallib.php',433],['lib/horde/framework/Horde','Variables.php',60],['backup/util/ui','base_ui.class.php',84],['lib/simplepie/library/SimplePie','Registry.php',99],['cache/locks/file','lib.php',66],['question/classes/statistics/responses','analysis_for_class.php',68],['lib/filebrowser','file_info_stored.php',51],['tag/classes/output','tagcollname.php',42],['competency/classes','persistent.php',54],['admin/tool/lp/classes/output','competency_plan_navigation.php',54],['lib/phpexcel/PHPExcel/Cell','DataValidation.php',146],['lib/pear/HTML/QuickForm','textarea.php',48],['lib/lessphp','Visitor.php',14],['lib/google/src/Google/Service','CloudUserAccounts.php',52],['question/classes/bank','column_base.php',44],['lib/minify/lib/MrClay','Cli.php',74],['lib','outputcomponents.php',80],['lib','outputcomponents.php',204],['lib','outputcomponents.php',469],['lib','outputcomponents.php',523],['lib','outputcomponents.php',589],['lib','outputcomponents.php',665],['lib','outputcomponents.php',783],['lib','outputcomponents.php',925],['lib','outputcomponents.php',1009],['lib','outputcomponents.php',2183],['lib','outputcomponents.php',2222],['lib','outputcomponents.php',2295],['lib','outputcomponents.php',2376],['lib','outputcomponents.php',2579],['lib','outputcomponents.php',2627],['lib','outputcomponents.php',2687],['lib','outputcomponents.php',2860],['lib','outputcomponents.php',3030],['lib','outputcomponents.php',3134],['lib','outputcomponents.php',3201],['lib','outputcomponents.php',3329],['lib','outputcomponents.php',3613],['lib','outputcomponents.php',3642],['lib','outputcomponents.php',3668],['lib','outputcomponents.php',3690],['lib','outputcomponents.php',3719],['lib','outputcomponents.php',3751],['lib/google/src/Google/Service','Pagespeedonline.php',39],['lib/phpexcel/PHPExcel','Cell.php',114],['lib/dml','sqlsrv_native_moodle_recordset.php',40],['repository/wikimedia','wikimedia.php',35],['lib/phpexcel/PHPExcel/Style','Fill.php',81],['lib/google/src/Google/Service','Cloudresourcemanager.php',42],['lib/editor/tinymce/classes','plugin.php',49],['mod/wiki/parser/markups','html.php',21],['lib/simplepie/library/SimplePie/Parse','Date.php',536],['lib/horde/framework/Horde/Support','Inflector.php',115],['question/type/gapselect','question.php',55],['lib/google/src/Google','Config.php',33],['badges/criteria','award_criteria_activity.php',45],['backup/util/xml/output','xml_output.class.php',52],['backup/util/xml/output','xml_output.class.php',158],['course/format/topics','renderer.php',38],['lib/adodb/drivers','adodb-oci8po.inc.php',33],['lib/adodb/drivers','adodb-oci8po.inc.php',99],['mod/workshop/allocation/random','lib.php',52],['mod/workshop/allocation/random','lib.php',727],['backup/util/structure','base_final_element.class.php',38],['backup/util/structure','base_final_element.class.php',239],['backup/util/structure','base_final_element.class.php',256],['lib/htmlpurifier/HTMLPurifier','Zipper.php',25],['lib/horde/framework/Horde/Imap/Client/Data','Thread.php',41],['lib/mustache/src/Mustache/Exception','UnknownHelperException.php',22],['backup/util/settings/activity','activity_backup_setting.class.php',25],['lib/filestorage','tgz_packer.php',749],['lib/filestorage','tgz_packer.php',831],['tag/classes','index_builder.php',96],['lib/pear/HTML/QuickForm','reset.php',37],['lib/classes/lock','lock.php',55],['admin/roles/classes','assign_user_selector_base.php',40],['backup/util/output','output_controller.class.php',44],['question/type/randomsamatch','question.php',114],['lib/google/src/Google/Service','Customsearch.php',38],['lib/lessphp/Tree','Extend.php',28],['lib/phpexcel/PHPExcel/Shared/PCLZip','pclzip.lib.php',215],['lib/google/src/Google/Service','TagManager.php',67],['question/type/gapselect/tests','edit_form_test.php',41],['mod/lesson','locallib.php',2004],['mod/lesson','locallib.php',2611],['backup/util/helper','restore_structure_parser_processor.class.php',41],['course','renderer.php',52],['backup/util/xml/parser/processors','selective_exact_parser_processor.class.php',35],['lib','modinfolib.php',429],['lib','modinfolib.php',1665],['lib','modinfolib.php',2492],['lib','tablelib.php',128],['lib','tablelib.php',1468],['lib','tablelib.php',1633],['lib','tablelib.php',1698],['user/filters','cohort.php',36],['user/filters','text.php',37],['lib','outputrenderers.php',120],['lib','outputrenderers.php',285],['lib','outputrenderers.php',408],['lib','outputrenderers.php',4578],['lib','outputrenderers.php',4831],['repository','lib.php',116],['repository','lib.php',533],['lib','adminlib.php',791],['lib','adminlib.php',1138],['lib','adminlib.php',1212],['lib','adminlib.php',1355],['lib','adminlib.php',1556],['lib','adminlib.php',1928],['lib','adminlib.php',2040],['lib','adminlib.php',2106],['lib','adminlib.php',2199],['lib','adminlib.php',2260],['lib','adminlib.php',2302],['lib','adminlib.php',2341],['lib','adminlib.php',2429],['lib','adminlib.php',2463],['lib','adminlib.php',2621],['lib','adminlib.php',2706],['lib','adminlib.php',2935],['lib','adminlib.php',3091],['lib','adminlib.php',3233],['lib','adminlib.php',3324],['lib','adminlib.php',3488],['lib','adminlib.php',3571],['lib','adminlib.php',3682],['lib','adminlib.php',3833],['lib','adminlib.php',4067],['lib','adminlib.php',4134],['lib','adminlib.php',4352],['lib','adminlib.php',4381],['lib','adminlib.php',4410],['lib','adminlib.php',4434],['lib','adminlib.php',4464],['lib','adminlib.php',4500],['lib','adminlib.php',4535],['lib','adminlib.php',4567],['lib','adminlib.php',4657],['lib','adminlib.php',4690],['lib','adminlib.php',4748],['lib','adminlib.php',4790],['lib','adminlib.php',4814],['lib','adminlib.php',4840],['lib','adminlib.php',4863],['lib','adminlib.php',4880],['lib','adminlib.php',4925],['lib','adminlib.php',4943],['lib','adminlib.php',5002],['lib','adminlib.php',5045],['lib','adminlib.php',5080],['lib','adminlib.php',5123],['lib','adminlib.php',5206],['lib','adminlib.php',5336],['lib','adminlib.php',5378],['lib','adminlib.php',5423],['lib','adminlib.php',5480],['lib','adminlib.php',5496],['lib','adminlib.php',5552],['lib','adminlib.php',5777],['lib','adminlib.php',5831],['lib','adminlib.php',5885],['lib','adminlib.php',5902],['lib','adminlib.php',5950],['lib','adminlib.php',5992],['lib','adminlib.php',6043],['lib','adminlib.php',6099],['lib','adminlib.php',6328],['lib','adminlib.php',6508],['lib','adminlib.php',6688],['lib','adminlib.php',6782],['lib','adminlib.php',6931],['lib','adminlib.php',7088],['lib','adminlib.php',7712],['lib','adminlib.php',8147],['lib','adminlib.php',8330],['lib','adminlib.php',8617],['lib','adminlib.php',8764],['lib','adminlib.php',8924],['lib','adminlib.php',9071],['lib','adminlib.php',9235],['lib','adminlib.php',9428],['lib','adminlib.php',9482],['lib','adminlib.php',9544],['lib','adminlib.php',9589],['lib','adminlib.php',9626],['backup/cc/cc_lib','cc_organization.php',47],['backup/cc/cc_lib','cc_organization.php',145],['lib/phpexcel/PHPExcel/Chart','DataSeriesValues.php',81],['lib/horde/framework/Horde/Mail/Rfc822','Identification.php',34],['question/type/numerical','questiontype.php',507],['auth/mnet','auth.php',35],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Cache.php',68],['lib/htmlpurifier/HTMLPurifier','PropertyList.php',29],['auth/imap','auth.php',35],['tag/classes/output','taglist.php',54],['lib','pdflib.php',161],['lib/phpexcel/PHPExcel/RichText','TextElement.php',35],['lib/dml','database_column_info.php',112],['lib/horde/framework/Horde/Imap/Client/Exception','NoSupportExtension.php',33],['mod/wiki/editors','wikieditor.php',36],['lib/lessphp/SourceMap','Base64VLQ.php',67],['repository/s3','lib.php',44],['admin/tool/uploadcourse/classes','course.php',111],['lib/google/src/Google/Service','Replicapoolupdater.php',51],['lib/horde/framework/Horde/Imap/Client/Data/Format','Date.php',25],['lib/bennu','iCalendar_components.php',21],['lib/bennu','iCalendar_components.php',333],['lib/bennu','iCalendar_components.php',355],['lib/bennu','iCalendar_components.php',433],['lib/bennu','iCalendar_components.php',513],['lib/bennu','iCalendar_components.php',551],['lib/bennu','iCalendar_components.php',602],['lib/bennu','iCalendar_components.php',659],['lib/bennu','iCalendar_components.php',679],['lib/phpexcel/PHPExcel/Calculation','FormulaToken.php',102],['mod/feedback/item','feedback_item_class.php',28],['lib/adodb/drivers','adodb-mssql_n.inc.php',245],['lib','badgeslib.php',133],['lib/pear/HTML/QuickForm','text.php',38],['lib/simplepie/library/SimplePie','Enclosure.php',219],['calendar/classes','rrule_manager.php',182],['auth/webservice','auth.php',35],['lib','outputrequirementslib.php',171],['mod/lti/service/toolsettings/classes/local/resource','contextsettings.php',44],['lib','questionlib.php',1261],['lib','questionlib.php',1505],['lib','uploadlib.php',40],['lib/spout/src/Spout/Writer/Common/Helper','ZipHelper.php',28],['lib/google/src/Google/Service','Cloudsearch.php',40],['backup/util/structure','backup_nested_element.class.php',44],['lib/spout/src/Spout/Writer/Common','Sheet.php',39],['question/behaviour','behaviourbase.php',50],['blocks/rss_client/classes/output','footer.php',47],['lib/dtl','file_xml_database_importer.php',34],['admin/roles/classes','capability_table_with_risks.php',45],['lib/adodb/drivers','adodb-mssql.inc.php',110],['lib/adodb/drivers','adodb-mssql.inc.php',870],['lib/adodb/drivers','adodb-mssql.inc.php',1077],['lib/google/src/Google/Service','Bigquery.php',62],['lib/google/src/Google/Service','ShoppingContent.php',50],['mod/lti','OAuth.php',73],['mod/lti','OAuth.php',89],['mod/lti','OAuth.php',244],['mod/lti','OAuth.php',499],['repository/equella','lib.php',42],['lib/phpexcel/PHPExcel/Worksheet','PageMargins.php',80],['backup/cc/cc_lib','cc_converter_quiz.php',33],['lib/horde/framework/Horde/Imap/Client/Interaction','Pipeline.php',60],['lib/phpexcel/PHPExcel/Shared/trend','polynomialBestFitClass.php',199],['backup/util/helper','restore_decode_processor.class.php',47],['backup/util/helper','restore_decode_processor.class.php',182],['cache/classes','helper.php',90],['lib/simplepie/library/SimplePie','Credit.php',81],['lib/classes','chart_series.php',62],['lib/classes/dml','recordset_walk.php',64],['lib/google/src/Google/Service','Webmasters.php',47],['lib/tcpdf/include/barcodes','qrcode.php',631],['backup/moodle2','backup_settingslib.php',42],['backup/moodle2','backup_settingslib.php',138],['lib/spout/src/Spout/Writer/XLSX/Helper','SharedStringsHelper.php',40],['course/tests/fixtures','course_capability_assignment.php',60],['mod/forum/classes','subscriber_selector_base.php',53],['lib','blocklib.php',54],['lib','blocklib.php',152],['report/loglive/classes','table_log.php',50],['lib','navigationlib.php',147],['lib','navigationlib.php',1015],['lib','navigationlib.php',2825],['lib','navigationlib.php',3086],['lib','navigationlib.php',3412],['lib','navigationlib.php',3459],['lib','navigationlib.php',4888],['lib','navigationlib.php',5070],['lib/phpexcel/PHPExcel/Shared/JAMA','CholeskyDecomposition.php',41],['grade/report/history/classes/output','user_button.php',40],['user/filters','courserole.php',34],['lib/phpexcel/PHPExcel','IOFactory.php',69],['lib/lessphp/Tree','Color.php',15],['lib/phpexcel/PHPExcel/Worksheet','MemoryDrawing.php',70],['lib/adodb/drivers','adodb-vfp.inc.php',72],['lib/horde/framework/Horde/Support','Backtrace.php',20],['lib/google/src/Google/Service','Clouddebugger.php',50],['lib/horde/framework/Horde/Exception','NotFound.php',15],['admin/tool/lp/classes/output','user_competency_course_navigation.php',55],['lib/lessphp/Tree','UnicodeDescriptor.php',14],['lib/phpexcel/PHPExcel/Worksheet','PageSetup.php',277],['grade/report/singleview/classes/local/ui','bulk_insert.php',40],['lib','mathslib.php',45],['lib/filestorage','tgz_extractor.php',119],['lib/horde/framework/Horde/Imap/Client/Interaction/Command','Continuation.php',42],['lib/horde/framework/Horde/Imap/Client','Exception.php',247],['filter/emoticon/tests','filter_test.php',68],['mnet/xmlrpc','xmlparser.php',15],['lib/spout/src/Spout/Reader/XLSX','Sheet.php',31],['admin/roles/classes','capability_table_base.php',51],['lib/simplepie/library/SimplePie','Item.php',82],['lib/form','selectgroups.php',57],['auth/shibboleth','auth.php',38],['admin/tool/langimport/classes','controller.php',48],['lib/form','warning.php',49],['lib/filestorage','stored_file.php',63],['grade/grading/form/guide','guideeditor.php',49],['lib/pear/HTML/QuickForm','group.php',80],['backup/moodle2','restore_subplugin.class.php',45],['grade/export','lib.php',60],['grade/export','lib.php',625],['lib/phpexcel/PHPExcel/Style','NumberFormat.php',98],['backup/moodle2','backup_section_task.class.php',40],['lib/htmlpurifier/HTMLPurifier','Config.php',100],['lib','flickrlib.php',53],['mod/assign/classes/output','grading_app.php',59],['grade/report/singleview/classes/local/ui','grade_attribute_format.php',47],['user/profile/field/menu','field.class.php',39],['lib/spout/src/Spout/Writer/Common/Internal','AbstractWorkbook.php',30],['lib/portfolio','exporter.php',113],['lib','ddllib.php',80],['lib','ddllib.php',93],['lib','ddllib.php',107],['lib','ddllib.php',126],['lib','ddllib.php',140],['lib/horde/framework/Horde/Crypt','Blowfish.php',54],['lib/horde/framework/Horde','Secret.php',48],['lib/htmlpurifier/HTMLPurifier/AttrDef','Integer.php',36],['lib/classes/update','info.php',48],['lib/htmlpurifier/HTMLPurifier/ConfigSchema','ValidatorAtom.php',31],['lib/lessphp/Tree','Anonymous.php',21],['admin/tool/lp/classes','course_competencies_form_element.php',43],['lib/lessphp/Tree','Comment.php',17],['auth/cas/CAS/CAS','OutOfSequenceBeforeAuthenticationCallException.php',47],['question/type/calculatedsimple','edit_calculatedsimple_form.php',72],['lib/adodb/drivers','adodb-mysql.inc.php',54],['lib/adodb/drivers','adodb-mysql.inc.php',717],['lib/adodb/drivers','adodb-mysql.inc.php',880],['enrol/ldap','lib.php',43],['mod/quiz/report/statistics','statistics_table.php',45],['lib/form','listing.php',68],['lib/google/src/Google/Service','Container.php',43],['mod/quiz','accessmanager.php',45],['lib/classes/message/inbound','processing_failed_exception.php',36],['blocks/online_users/classes','fetcher.php',45],['lib/pear/HTML/QuickForm','checkbox.php',48],['auth/cas/CAS/CAS','OutOfSequenceBeforeProxyException.php',48],['mod/lti/service/toolproxy/classes/local/service','toolproxy.php',41],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','URI.php',15],['lib/classes','chart_axis.php',65],['mod/glossary/classes','entry_query_builder.php',83],['mod/feedback/item/label','lib.php',26],['lib/adodb/drivers','adodb-mssqlnative.inc.php',131],['lib/adodb/drivers','adodb-mssqlnative.inc.php',847],['lib/adodb/drivers','adodb-mssqlnative.inc.php',1099],['lib/horde/framework/Horde/Imap/Client','Ids.php',78],['lib/form','editor.php',62],['lib','environmentlib.php',1258],['mod/workshop','fileinfolib.php',43],['mod/workshop','fileinfolib.php',198],['mod/feedback/classes','templates_table.php',39],['tag/classes','manage_table.php',44],['lib/adodb/drivers','adodb-odbc_db2.inc.php',115],['lib/adodb/drivers','adodb-odbc_db2.inc.php',309],['backup/cc/cc_lib/gral_lib','cssparser.php',21],['lib/horde/framework/Horde/Support','Array.php',21],['lib/google/src/Google/Service','GroupsMigration.php',40],['admin/tool/lp/classes/output','user_evidence_list_page.php',61],['lib/google/src/Google/Service','Audit.php',39],['lib/simplepie/library/SimplePie','File.php',68],['lib/horde/framework/Horde/Imap/Client','Mailbox.php',62],['enrol/lti/classes','manage_table.php',62],['lib/simplepie/library/SimplePie/Content/Type','Sniffer.php',69],['question/type','questionbase.php',124],['question/type','questionbase.php',438],['question/type','questionbase.php',531],['question/type','questionbase.php',750],['question/type','questionbase.php',835],['question/type','questionbase.php',868],['question/type','questionbase.php',914],['question/type','questionbase.php',1013],['question/type/ddimageortext','question.php',64],['question/type/ddimageortext','question.php',122],['lib','excellib.class.php',47],['lib','excellib.class.php',155],['lib','excellib.class.php',456],['lib/minify/lib','CSSmin.php',43],['lib/dml','moodle_temptables.php',51],['lib/minify/lib/Minify/Cache','ZendPlatform.php',23],['backup/util/xml/parser','progressive_parser.class.php',79],['backup/util/xml/parser','progressive_parser.class.php',305],['blocks/rss_client/classes/output','block.php',47],['question/type/ddmarker','question.php',417],['question/type/ddmarker','question.php',469],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Percentage.php',18],['admin/tool/lp/classes/output','user_competency_summary_in_course.php',51],['backup/util/helper','convert_helper.class.php',378],['lib/classes/update','validator.php',265],['lib/lessphp/Tree','Attribute.php',16],['admin/tool/generator/classes','backend.php',84],['backup/util/loggers','file_logger.class.php',35],['lib/adodb','adodb-exceptions.inc.php',30],['lib/google/src/Google','Client.php',70],['user/filters','profilefield.php',36],['backup/util/helper','restore_inforef_parser_processor.class.php',37],['cache/tests/fixtures','lib.php',326],['mod/lti/service/profile/classes/local/resource','profile.php',43],['competency/classes','invalid_persistent_exception.php',38],['backup/util/plan','backup_plan.class.php',36],['backup/util/plan','backup_plan.class.php',130],['lib/phpexcel/PHPExcel/Writer/Excel2007','WriterPart.php',63],['backup/util/settings','setting_dependency.class.php',68],['backup/util/settings','setting_dependency.class.php',175],['backup/util/settings','setting_dependency.class.php',328],['backup/util/settings','setting_dependency.class.php',439],['backup/util/settings','setting_dependency.class.php',465],['backup/util/settings','setting_dependency.class.php',491],['backup/util/settings','setting_dependency.class.php',556],['backup/util/xml','xml_writer.class.php',57],['backup/util/xml','xml_writer.class.php',284],['enrol/imsenterprise','locallib.php',38],['enrol/imsenterprise','locallib.php',115],['lib/dml','moodle_database.php',139],['search/classes','base.php',69],['admin/tool/lp/classes/output','competency_summary.php',54],['lib','upgradelib.php',45],['lib','upgradelib.php',61],['lib','upgradelib.php',76],['lib','upgradelib.php',94],['lib','upgradelib.php',111],['lib/htmlpurifier/HTMLPurifier/AttrTransform','NameSync.php',11],['mod/workshop/form/rubric','lib.php',105],['grade','lib.php',103],['grade','lib.php',927],['grade','lib.php',1089],['grade','lib.php',2053],['grade','lib.php',2213],['lib/horde/framework/Horde/Imap/Client/Data','Acl.php',32],['lib/phpexcel/PHPExcel/Reader/Excel5','RC4.php',35],['lib/google/src/Google/Service','Datastore.php',46],['admin/tool/lpmigrate/classes','framework_processor.php',98],['lib/dtl','database_importer.php',61],['lib/horde/framework/Horde/Imap/Client/Password','Xoauth2.php',44],['badges/lib','awardlib.php',55],['backup/util/helper','backup_array_iterator.class.php',39],['admin/tool/monitor/classes','subscription.php',43],['question/type/calculated','edit_calculated_form.php',51],['lib/spout/src/Spout/Reader/XLSX/Helper/SharedStringsCaching','FileBasedStrategy.php',57],['lib/form','datetimeselector.php',72],['lib/horde/framework/Horde/Imap/Client','Base.php',153],['lib/classes','collator.php',58],['admin/tool/lp/classes','course_competency_statistics.php',48],['lib/google/src/Google/Service','Storage.php',57],['lib/spout/src/Spout/Reader/CSV','SheetIterator.php',28],['lib/lessphp/Tree','Paren.php',14],['mod/lti/classes','service_exception_handler.php',63],['lib/tcpdf/include/barcodes','pdf417.php',523],['mod/assign/feedback/offline','importgradeslib.php',66],['lib/filestorage','file_exceptions.php',36],['lib/filestorage','file_exceptions.php',57],['lib/filestorage','file_exceptions.php',89],['lib/filestorage','file_exceptions.php',108],['lib/filestorage','file_exceptions.php',129],['lib/horde/framework/Horde/Mail/Transport','Smtp.php',100],['lib/htmlpurifier/HTMLPurifier/ConfigSchema/Interchange','Id.php',17],['question/engine/upgrade','upgradelib.php',283],['question/engine/upgrade','upgradelib.php',384],['question/type/numerical','question.php',323],['lib/pear/PEAR','Exception.php',107],['course/format','renderer.php',44],['lib/dml','oci_native_moodle_recordset.php',34],['question/behaviour','behaviourtypebase.php',133],['lib/pear/HTML','QuickForm.php',246],['lib/pear/HTML','QuickForm.php',1979],['backup/util/structure','base_atom.class.php',41],['backup/util/structure','base_atom.class.php',114],['backup/util/structure','base_atom.class.php',135],['backup/util/structure','base_atom.class.php',156],['lib/horde/framework/Horde/Imap/Client/Data','BaseSubject.php',39],['lib/google/src/Google/Auth','LoginTicket.php',37],['lib/adodb/drivers','adodb-csv.inc.php',41],['lib/adodb/drivers','adodb-csv.inc.php',196],['user/filters','yesno.php',33],['mod/wiki/parser','parser.php',98],['lib/htmlpurifier/HTMLPurifier/Token','Comment.php',19],['lib/phpexcel/PHPExcel/Calculation','FormulaParser.php',87],['backup/cc/cc_lib','cc_assesment_truefalse.php',27],['lib/htmlpurifier/HTMLPurifier','Encoder.php',10],['admin/tool/lpmigrate/classes/form','migrate_framework.php',45],['backup/util/xml/parser/tests','parser_test.php',797],['lib/htmlpurifier/HTMLPurifier/AttrTransform','EnumToCSS.php',34],['lib/tests','medialib_test.php',644],['lib/google/src/Google/Service','QPXExpress.php',39],['tag/classes/output','tagname.php',41],['lib/mustache/src/Mustache','Context.php',20],['lib/adodb/drivers','adodb-oracle.inc.php',32],['lib/adodb/drivers','adodb-oracle.inc.php',224],['backup/moodle2','restore_section_task.class.php',42],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Composite.php',25],['lib/htmlpurifier/HTMLPurifier/AttrTransform','Nofollow.php',16],['mod/forum/classes/output','forum_post.php',110],['admin/tool/assignmentupgrade','locallib.php',50],['admin/tool/assignmentupgrade','locallib.php',93],['repository/googledocs','lib.php',65],['cache/stores/memcache','lib.php',120],['lib/filestorage','file_storage.php',78],['admin/tool/monitor/classes/output/managerules','renderable.php',56],['mod/lti/service/toolsettings/classes/local/resource','linksettings.php',45],['lib/form','duration.php',55],['lib','outputlib.php',480],['lib','outputlib.php',2038],['filter/tex','latex.php',13],['backup/moodle2','backup_course_task.class.php',39],['lib/adodb','adodb.inc.php',310],['lib/adodb','adodb.inc.php',3035],['lib/adodb','adodb.inc.php',3160],['lib/adodb','adodb.inc.php',3242],['lib/adodb','adodb.inc.php',4353],['lib/horde/framework/Horde/Support','Randomid.php',26],['lib/google/src/Google/Logger','File.php',51],['admin/roles/classes','allow_role_page.php',37],['mod/quiz/report/overview','overview_table.php',41],['lib/lessphp/Tree','Keyword.php',17],['lib/htmlpurifier/HTMLPurifier/Node','Comment.php',19],['question/type/ddmarker','questiontype.php',48],['mod/folder','renderer.php',159],['lib','portfoliolib.php',101],['tag/classes/output','tagcollsearchable.php',40],['webservice/soap/classes','wsdl.php',88],['lib/lessphp/Exception','Parser.php',30],['badges','renderer.php',973],['badges','renderer.php',1014],['badges','renderer.php',1078],['badges','renderer.php',1111],['badges','renderer.php',1137],['competency/classes/external','exporter.php',56],['mod/lti/service/toolproxy/classes/local/resource','toolproxy.php',47],['lib/google/src/Google/Service','Genomics.php',63],['lib/phpexcel/PHPExcel/Writer','PDF.php',38],['lib/phpexcel/PHPExcel/Shared/trend','exponentialBestFitClass.php',125],['lib/google/src/Google/Service','Games.php',60],['backup/converter/moodle1','lib.php',725],['backup/converter/moodle1','lib.php',865],['backup/converter/moodle1','lib.php',1145],['backup/converter/moodle1','lib.php',1190],['backup/converter/moodle1','lib.php',1480],['backup/util/helper','restore_logs_processor.class.php',45],['backup/util/helper','restore_logs_processor.class.php',141],['lib/htmlpurifier/HTMLPurifier/AttrTransform','Input.php',14],['lib/google/src/Google/Service','Licensing.php',40],['mod/workshop/form/comments','lib.php',99],['backup/util/settings/section','section_backup_setting.class.php',25],['lib/htmlpurifier/HTMLPurifier','Doctype.php',48],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Font.php',22],['lib/google/src/Google/Service','Fitness.php',58],['blocks/private_files','renderer.php',83],['lib/phpexcel/PHPExcel/Worksheet','ColumnCellIterator.php',51],['enrol/flatfile','adminlib.php',35],['lib/xmldb','xmldb_object.php',55],['lib/google/src/Google/Service','Reports.php',47],['question/classes/statistics/responses','analysis_for_actual_response.php',70],['auth/pam','auth.php',53],['lib/horde/framework/Horde','Stream.php',50],['comment','lib.php',100],['lib/htmlpurifier/HTMLPurifier','URIParser.php',10],['lib/htmlpurifier/HTMLPurifier/Node','Text.php',35],['lib/phpexcel/PHPExcel/Worksheet','RowDimension.php',53],['lib/google/src/Google/Service','Gmail.php',64],['lib/google/src/Google/Service','Taskqueue.php',44],['lib/minify/lib/Minify','ImportProcessor.php',48],['lib/horde/framework/Horde/Mime','Related.php',32],['blocks','moodleblock.class.php',111],['lib/tcpdf','tcpdf_parser.php',92],['backup/util/plan','restore_structure_step.class.php',46],['blocks/rss_client/classes/output','channel_image.php',61],['lib/pear/HTML/QuickForm','hierselect.php',105],['question/type/numerical/tests','form_test.php',40],['badges/lib','backpacklib.php',40],['mod/workshop/allocation/manual','lib.php',51],['mod/quiz/report/responses','last_responses_table.php',39],['lib/simplepie','autoloader.php',62],['lib/spout/src/Spout/Common/Helper','StringHelper.php',21],['lib/phpexcel/PHPExcel/Worksheet','BaseDrawing.php',121],['lib/pear/Crypt','CHAP.php',82],['lib/pear/Crypt','CHAP.php',170],['lib/pear/Crypt','CHAP.php',424],['lib/spout/src/Spout/Writer/Common/Helper','AbstractStyleHelper.php',22],['backup/util/xml/parser/processors','progressive_parser_processor.class.php',57],['mod/quiz/classes/question','qubaids_for_users_attempts.php',37],['lib/spout/src/Spout/Reader/XLSX','RowIterator.php',63],['lib/phpexcel/PHPExcel/Reader/Excel5','Escher.php',77],['lib/simplepie/library/SimplePie','gzdecode.php',186],['mod/wiki','renderer.php',540],['lib/adodb','adodb-active-recordx.inc.php',138],['availability/classes','result.php',46],['lib','accesslib.php',5352],['lib','accesslib.php',5897],['lib','accesslib.php',6167],['lib','accesslib.php',6408],['lib','accesslib.php',6595],['lib','accesslib.php',6827],['lib','accesslib.php',7049],['lib','accesslib.php',7291],['lib/phpexcel/PHPExcel/Shared/OLE','PPS.php',110],['grade/grading/form','lib.php',82],['grade/grading/form','lib.php',766],['question/engine','questionusage.php',78],['question/engine','questionusage.php',973],['auth/manual','auth.php',46],['question/engine/upgrade','behaviourconverters.php',78],['mod/wiki/diff','diff_nwiki.php',35],['mod/wiki/diff','diff_nwiki.php',50],['mod/wiki/diff','diff_nwiki.php',63],['mod/wiki/diff','diff_nwiki.php',76],['mod/wiki/diff','diff_nwiki.php',495],['mod/wiki/diff','diff_nwiki.php',640],['mod/wiki/diff','diff_nwiki.php',850],['mod/wiki/diff','diff_nwiki.php',901],['mod/wiki/diff','diff_nwiki.php',953],['lib/adodb/drivers','adodb-proxy.inc.php',28],['lib/classes/lock','file_lock_factory.php',57],['lib/google/src/Google/Auth','OAuth2.php',55],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','Pixels.php',17],['lib/filebrowser','file_info_context_module.php',47],['auth/none','auth.php',34],['lib/simplepie/library/SimplePie/Cache','Base.php',70],['lib/htmlpurifier/HTMLPurifier','Queue.php',24],['lib/horde/framework/Horde/Text','Flowed.php',75],['admin/tool/log/store/legacy/classes/log','store.php',33],['lib/mustache/src/Mustache','HelperCollection.php',19],['backup/util/structure','backup_structure_processor.class.php',45],['backup/util/structure','backup_structure_processor.class.php',133],['admin/tool/lp/classes/output','related_competencies.php',47],['mod/quiz/classes/question/bank','custom_view.php',44],['files','renderer.php',1083],['lib/form','text.php',47],['lib/phpexcel/PHPExcel/Shared/trend','bestFitClass.php',398],['backup/cc','cc112moodle.php',59],['admin/tool/cohortroles/classes/output','cohort_role_assignments_table.php',45],['lib/horde/framework/Horde/Imap/Client/Data','Envelope.php',46],['lib/google/src/Google/Service','Logging.php',39],['lib/lessphp/Tree','Expression.php',16],['mod/lti/classes/local/ltiservice','service_base.php',63],['lib/phpexcel/PHPExcel/Reader','HTML.php',118],['search/engine/solr/classes','schema.php',60],['backup/util/xml/parser/processors','simplified_parser_processor.class.php',46],['lib/htmlpurifier/HTMLPurifier','UnitConverter.php',50],['lib/adodb/drivers','adodb-ado5.inc.php',42],['lib/adodb/drivers','adodb-ado5.inc.php',380],['mod/assign/feedback/editpdf/classes','comment.php',58],['cache/classes','interfaces.php',473],['lib/phpexcel/PHPExcel/Worksheet','Protection.php',157],['repository/merlot','lib.php',37],['lib/adodb/drivers','adodb-firebird.inc.php',69],['backup/util/settings','backup_setting.class.php',43],['lib/adodb/drivers','adodb-fbsql.inc.php',28],['lib/adodb/drivers','adodb-fbsql.inc.php',167],['mnet/xmlrpc','serverlib.php',674],['webservice/soap','lib.php',45],['admin/tool/log/store/database/classes/log','store.php',47],['lib/google/src/Google/Service','Doubleclicksearch.php',43],['lib/form','passwordunmask.php',46],['lib/lessphp/Tree','Variable.php',20],['report/log/classes','renderable.php',96],['mod/lti/service/toolsettings/classes/local/resource','systemsettings.php',43],['question/classes/bank','view.php',70],['grade/report/singleview/classes/local/ui','range.php',38],['lib/simplepie/library/SimplePie/Cache','MySQL.php',80],['admin/roles/classes','define_role_table_basic.php',31],['backup/cc/cc_lib','cc_converter_resource.php',28],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Mongo.php',78],['blocks/rss_client','editfeed.php',36],['admin/tool/lpmigrate/classes/output','migrate_framework_results.php',55],['blocks/lp/classes/output','competencies_to_review_page.php',49],['lib/horde/framework/Horde/Crypt/Blowfish/Php','Base.php',318],['backup/util/loggers','base_logger.class.php',42],['backup/util/loggers','base_logger.class.php',187],['mod/assign/feedback/file','renderable.php',44],['backup/cc/cc_lib','cc_utils.php',313],['backup/cc/cc_lib','cc_utils.php',381],['backup/cc/cc_lib','cc_utils.php',437],['lib/adodb/drivers','adodb-db2.inc.php',66],['lib/adodb/drivers','adodb-db2.inc.php',731],['lib/adodb','adodb-xmlschema03.inc.php',136],['lib/adodb','adodb-xmlschema03.inc.php',270],['lib/adodb','adodb-xmlschema03.inc.php',678],['lib/adodb','adodb-xmlschema03.inc.php',823],['lib/adodb','adodb-xmlschema03.inc.php',1081],['lib/adodb','adodb-xmlschema03.inc.php',1399],['repository/youtube','lib.php',58],['lib/phpexcel/PHPExcel/Writer/PDF','mPDF.php',38],['auth/cas/CAS/CAS','GracefullTerminationException.php',48],['lib/adodb/drivers','adodb-sybase_ase.inc.php',25],['lib/adodb/drivers','adodb-sybase_ase.inc.php',115],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Background.php',20],['lib/adodb','adodb-memcache.lib.inc.php',53],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','FrameTarget.php',19],['lib/phpexcel/PHPExcel/Writer','Excel2007.php',118],['lib/minify/lib/MrClay/Cli','Arg.php',82],['lib/phpexcel/PHPExcel/Worksheet/AutoFilter','Column.php',117],['lib/simplepie','moodle_simplepie.php',50],['lib/simplepie','moodle_simplepie.php',121],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','FontFamily.php',11],['lib/simplepie/library/SimplePie/Decode/HTML','Entities.php',80],['lib/spout/src/Spout/Common/Helper','FileSystemHelper.php',22],['lib/pear/HTML/QuickForm','button.php',37],['lib/google/src/Google/Service','Autoscaler.php',46],['lib/mustache/src/Mustache','Engine.php',63],['lib/google/src/Google/Http','MediaFileUpload.php',75],['lib/phpexcel/PHPExcel','Worksheet.php',327],['mod/assign','gradingtable.php',68],['lib/google/src/Google/Service','AdExchangeSeller.php',53],['question/engine/tests','helpers.php',582],['question/engine/tests','helpers.php',594],['question/engine/tests','helpers.php',608],['question/engine/tests','helpers.php',623],['question/engine/tests','helpers.php',637],['question/engine/tests','helpers.php',652],['question/engine/tests','helpers.php',665],['question/engine/tests','helpers.php',676],['question/engine/tests','helpers.php',1196],['repository/webdav','lib.php',38],['tag/classes/output','tagisstandard.php',39],['lib/google/src/Google/Service','Appsactivity.php',52],['badges/criteria','award_criteria_course.php',47],['lib','searchlib.php',53],['lib','searchlib.php',95],['lib/lessphp/Output','Mapped.php',39],['availability/classes','tree.php',118],['lib/lessphp/Tree','Javascript.php',20],['lib/horde/framework/Horde/Imap/Client','Cache.php',53],['lib/htmlpurifier/HTMLPurifier','AttrCollections.php',16],['lib/mustache/src/Mustache/Loader','InlineLoader.php',56],['repository/url','lib.php',46],['lib/phpexcel/PHPExcel/CachedObjectStorage','SQLite3.php',293],['lib/lessphp/Tree','Ruleset.php',45],['tag/classes/output','tagindex.php',52],['backup/util/ui','backup_ui_stage.class.php',43],['backup/util/ui','backup_ui_stage.class.php',79],['backup/util/ui','backup_ui_stage.class.php',234],['backup/util/ui','backup_ui_stage.class.php',387],['backup/util/ui','backup_ui_stage.class.php',516],['backup/util/ui','backup_ui_stage.class.php',575],['grade/report/singleview/classes/local/screen','screen.php',67],['lib/tcpdf/include/barcodes','datamatrix.php',229],['lib/horde/framework/Horde/Imap/Client/Socket','Catenate.php',37],['lib/google/src/Google/Service','Prediction.php',51],['lib/classes/output','notification.php',101],['lib/lessphp/Tree','Unit.php',16],['backup/util/settings/course','course_backup_setting.class.php',25],['lib/spout/src/Spout/Writer','AbstractWriter.php',68],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','DenyElementDecorator.php',21],['lib','outputfactories.php',120],['lib','outputfactories.php',367],['lib','dtllib.php',66],['mod/assign','assignmentplugin.php',50],['mnet/service/enrol','locallib.php',48],['mnet/service/enrol','locallib.php',466],['mnet/service/enrol','locallib.php',537],['backup/cc/cc_lib','cc_version11.php',57],['availability/condition/completion/classes','condition.php',48],['admin/roles/classes','allow_override_page.php',31],['mod/workshop/allocation','lib.php',103],['lib/htmlpurifier/HTMLPurifier/AttrTransform','BoolToCSS.php',24],['lib/horde/framework/Horde/Imap/Client/Base','Mailbox.php',59],['lib/spout/src/Spout/Reader/Wrapper','SimpleXMLElement.php',23],['lib/google/src/Google/Service','SiteVerification.php',43],['lib/phpexcel/PHPExcel/Calculation','Function.php',64],['availability/classes','capability_checker.php',49],['lib/google/src/Google/Service','Drive.php',76],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Decorator.php',12],['lib/phpexcel/PHPExcel/Shared/JAMA','LUDecomposition.php',56],['lib','setuplib.php',67],['lib','setuplib.php',113],['lib','setuplib.php',165],['lib','setuplib.php',184],['lib','setuplib.php',199],['lib','setuplib.php',219],['lib','setuplib.php',249],['lib','setuplib.php',271],['lib','setuplib.php',287],['lib','setuplib.php',309],['lib','setuplib.php',328],['lib','setuplib.php',346],['lib/form','textarea.php',50],['webservice/soap','locallib.php',57],['availability/classes','info.php',55],['lib/tcpdf','tcpdf_barcodes_1d.php',58],['lib/spout/src/Spout/Reader/XLSX/Helper','SheetHelper.php',49],['filter/urltolink/tests','filter_test.php',209],['lib/simplepie/library/SimplePie','Category.php',81],['admin/tool/lp/classes/output','manage_competencies_page.php',65],['lib/markdown','Markdown.php',99],['mod/assign','locallib.php',160],['mod/assign','locallib.php',8131],['lib/adodb/drivers','adodb-ldap.inc.php',48],['lib/adodb/drivers','adodb-ldap.inc.php',297],['lib/editor/tinymce/plugins/spellchecker/classes/utils','JSON.php',32],['lib/editor/tinymce/plugins/spellchecker/classes/utils','JSON.php',373],['lib','odslib.class.php',42],['lib','odslib.class.php',124],['lib','odslib.class.php',422],['lib','odslib.class.php',827],['lib/horde/framework/Horde/Crypt/Blowfish','Base.php',56],['lib/phpexcel/PHPExcel/Reader/Excel5','MD5.php',36],['grade/report/singleview/classes/local/ui','checkbox_attribute.php',42],['lib/lessphp/Tree','Quoted.php',20],['mod/lesson','mod_form.php',36],['blocks/rss_client/classes/output','item.php',89],['lib/google/src/Google/Service','IdentityToolkit.php',38],['lib/horde/framework/Horde/Stream','Temp.php',25],['tag/classes/output','tagflag.php',39],['admin/tool/monitor/classes/output/managesubs','rules.php',56],['lib/htmlpurifier/HTMLPurifier/ChildDef','Table.php',57],['lib/behat/form_field','behat_form_field.php',59],['lib/phpexcel/PHPExcel/Worksheet/Drawing','Shadow.php',93],['lib/spout/src/Spout/Reader/ODS/Helper','CellValueFormatter.php',42],['tag/classes','collections_table.php',36],['lib/google/src/Google/Service','Spectrum.php',38],['lib/htmlpurifier/HTMLPurifier/AttrTransform','Length.php',19],['admin/tool/lp/classes/output','user_competency_summary.php',49],['lib/phpexcel/PHPExcel','NamedRange.php',65],['lib/pear/HTML/QuickForm','image.php',36],['lib/htmlpurifier/HTMLPurifier/AttrDef/URI','Host.php',15],['lib/form','searchableselector.php',44],['lib/phpexcel/PHPExcel/Shared/JAMA','SingularValueDecomposition.php',52],['lib/adodb/drivers','adodb-oci805.inc.php',51],['lib/google/src/Google','Service.php',28],['lib/google/src/Google/IO','Abstract.php',50],['lib/spout/src/Spout/Writer/ODS/Internal','Worksheet.php',46],['lib/form','header.php',45],['question/type/randomsamatch/tests','helper.php',121],['mod/workshop/form/accumulative','lib.php',99],['lib/phpexcel/PHPExcel/Shared/trend','linearBestFitClass.php',89],['lib/form','submit.php',41],['report/log/classes','table_log.php',45],['admin/roles/classes','admins_potential_selector.php',30],['question/classes/engine/variants','least_used_strategy.php',51],['question/engine/upgrade','logger.php',42],['question/engine/upgrade','logger.php',87],['mod/data','lib.php',68],['mod/data','lib.php',2278],['mod/data','lib.php',2552],['mod/data','lib.php',2573],['backup/util/xml/parser/processors','grouped_parser_processor.class.php',67],['lib/horde/framework/Horde/Imap/Client/Exception','NoSupportPop3.php',26],['mod/scorm','renderer.php',129],['lib/phpunit/classes','advanced_testcase.php',45],['lib/spout/src/Spout/Reader/ODS','SheetIterator.php',41],['backup/cc/cc_lib','cc_version1.php',57],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','LinkTypes.php',21],['tag/classes','areas_table.php',36],['lib/phpexcel/PHPExcel/Shared/trend','powerBestFitClass.php',125],['lib/portfolio/formats/leap2a','lib.php',62],['lib/portfolio/formats/leap2a','lib.php',258],['lib/portfolio/formats/leap2a','lib.php',503],['lib/google/src/Google/Service','Proximitybeacon.php',42],['lib/pear','PEAR.php',139],['lib/pear','PEAR.php',818],['competency/classes/external','persistent_exporter.php',42],['lib/google/src/Google/Service','Groupssettings.php',40],['lib/phpexcel/PHPExcel/Reader','CSV.php',87],['lib/horde/framework/Horde/Exception','LastError.php',16],['lib/google/src/Google/Service','Directory.php',134],['lib/google/src/Google/Service','Fusiontables.php',48],['question/type/missingtype','edit_missingtype_form.php',38],['lib/google/src/Google/Service','AdSenseHost.php',49],['lib/lessphp/Tree','Directive.php',20],['auth/ldap','auth.php',119],['auth/cas/CAS/CAS','CookieJar.php',46],['lib/phpexcel/PHPExcel/CachedObjectStorage','Wincache.php',245],['availability/condition/date/classes','condition.php',52],['lib/horde/framework/Horde/Mime','Mail.php',93],['lib','outputactions.php',60],['lib','outputactions.php',91],['lib','outputactions.php',148],['lib/horde/framework/Horde/Crypt/Blowfish','Mcrypt.php',47],['lib/classes','string_manager_standard.php',53],['repository/skydrive','microsoftliveapi.php',50],['user/filters','globalrole.php',35],['enrol/lti/ims-blti','OAuth.php',16],['enrol/lti/ims-blti','OAuth.php',32],['enrol/lti/ims-blti','OAuth.php',187],['enrol/lti/ims-blti','OAuth.php',451],['course/classes/output','course_module_name.php',46],['lib/google/src/Google/Service','Plus.php',52],['lib/horde/framework/Horde/Mime','Mdn.php',35],['lib/pear/HTML/QuickForm','html.php',36],['repository/s3','S3.php',193],['repository/s3','S3.php',2018],['repository/s3','S3.php',2374],['lib/spout/src/Spout/Reader/XLSX/Helper','SharedStringsHelper.php',39],['question/classes/bank/search','hidden_condition.php',42],['lib/htmlpurifier/HTMLPurifier/ChildDef','Empty.php',22],['lib/pear/HTML/QuickForm','element.php',73],['question/classes/statistics/responses','analysis_for_subpart.php',50],['admin/tool/log/classes','setting_managestores.php',30],['lib/google/src/Google/Service','Mirror.php',49],['lib/adodb/drivers','adodb-db2ora.inc.php',80],['lib/minify/lib/HTTP','Encoder.php',75],['mod/feedback/classes','completion.php',47],['admin/tool/uploadcourse/classes','processor.php',122],['lib/lessphp','Parser.php',78],['lib/adodb/drivers','adodb-sapdb.inc.php',36],['lib/adodb/drivers','adodb-sapdb.inc.php',179],['lib/ddl','sql_generator.php',175],['lib/google/src/Google/Service','AndroidEnterprise.php',51],['admin/tool/lp/classes/output','template_competencies_page.php',70],['lib/horde/framework/Horde/Support','ObjectStub.php',29],['mod/assignment/backup/moodle1','lib.php',223],['blocks','edit_form.php',47],['lib/simplepie/library/SimplePie/Cache','Memcache.php',81],['mod/quiz/report/statistics','statistics_question_table.php',49],['mod/workshop/form/numerrors','lib.php',102],['mod/quiz/classes','repaginate.php',49],['lib/classes/session','memcached.php',51],['lib/phpexcel/PHPExcel/Shared/OLE/PPS','Root.php',43],['lib/phpexcel/PHPExcel/Writer/PDF','Core.php',206],['mod/workshop','mod_form.php',43],['mod/assign/feedback/editpdf/fpdi','pdf_context.php',48],['availability/condition/profile/classes','condition.php',73],['lib/horde/framework/Horde/Imap/Client','DateTime.php',29],['auth/cas/CAS/CAS','Client.php',862],['lib/xhprof','xhprof_moodle.php',788],['lib/dtl','file_xml_database_exporter.php',36],['course','lib.php',3061],['lib/adodb/drivers','adodb-mssqlpo.inc.php',54],['lib/xmldb','xmldb_table.php',49],['lib/adodb/perf','perf-postgres.inc.php',92],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Filter.php',15],['question/type/ddmarker','shapes.php',40],['question/type/ddmarker','shapes.php',203],['question/type/ddmarker','shapes.php',267],['question/type/ddmarker','shapes.php',332],['question/type/ddmarker','shapes.php',470],['mod/lti/classes/local/ltiservice','response.php',58],['backup/util/helper','restore_users_parser_processor.class.php',43],['lib/pear/HTML','Common.php',79],['mod/glossary','locallib.php',481],['lib/adodb/perf','perf-mssqlnative.inc.php',70],['lib/adodb/perf','perf-mssql.inc.php',70],['backup/util/plan','base_plan.class.php',39],['backup/util/plan','base_plan.class.php',215],['backup/util/plan','restore_task.class.php',32],['backup/util/plan','restore_task.class.php',121],['lib/classes/event','base.php',124],['lib/form','checkbox.php',46],['admin/roles/classes','permissions_table.php',38],['lib/pear/HTML/QuickForm','submit.php',37],['auth/fc','auth.php',37],['enrol/ldap','settingslib.php',32],['enrol/ldap','settingslib.php',90],['enrol/ldap','settingslib.php',204],['lib/minify/lib/Minify/Cache','Memcache.php',22],['lib/lessphp/Tree','Condition.php',18],['admin/tool/lp/classes/output','plans_page.php',59],['lib/mustache/src/Mustache','Autoloader.php',19],['lib/spout/src/Spout/Writer/XLSX/Internal','Worksheet.php',52],['lib/phpexcel/PHPExcel','Comment.php',93],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','AlphaValue.php',6],['lib/lessphp/Tree','Url.php',17],['mod/lesson','override_form.php',58],['lib/form','button.php',45],['admin/tool/lp/classes/output','manage_templates_page.php',56],['lib/google/src/Google/Service','Playmoviespartner.php',44],['backup/util/ui','base_ui_stage.class.php',67],['backup/cc/cc_lib','cc_converters.php',75],['lib/dtl','database_mover.php',33],['enrol','locallib.php',125],['enrol','locallib.php',1256],['enrol','locallib.php',1379],['enrol','locallib.php',1430],['enrol','locallib.php',1463],['lib/htmlpurifier/HTMLPurifier','URI.php',58],['backup/moodle2','restore_course_task.class.php',41],['lib/htmlpurifier/HTMLPurifier/Printer','ConfigForm.php',40],['lib/htmlpurifier/HTMLPurifier/Printer','ConfigForm.php',221],['lib','xmlize.php',31],['lib','googleapi.php',52],['lib','googleapi.php',243],['grade/report/singleview/classes/local/ui','element.php',47],['lib/html2text','lib.php',43],['user/filters','lib.php',52],['user/filters','lib.php',272],['auth/cas/CAS/CAS/PGTStorage','Db.php',122],['lib/classes/lock','db_record_lock_factory.php',61],['lib/pear/HTML/QuickForm','link.php',47],['backup/cc/cc_lib','cc_asssesment.php',290],['backup/cc/cc_lib','cc_asssesment.php',345],['backup/cc/cc_lib','cc_asssesment.php',364],['backup/cc/cc_lib','cc_asssesment.php',415],['backup/cc/cc_lib','cc_asssesment.php',476],['backup/cc/cc_lib','cc_asssesment.php',486],['backup/cc/cc_lib','cc_asssesment.php',561],['backup/cc/cc_lib','cc_asssesment.php',585],['backup/cc/cc_lib','cc_asssesment.php',635],['backup/cc/cc_lib','cc_asssesment.php',668],['backup/cc/cc_lib','cc_asssesment.php',693],['backup/cc/cc_lib','cc_asssesment.php',788],['backup/cc/cc_lib','cc_asssesment.php',814],['backup/cc/cc_lib','cc_asssesment.php',838],['backup/cc/cc_lib','cc_asssesment.php',965],['backup/cc/cc_lib','cc_asssesment.php',971],['backup/cc/cc_lib','cc_asssesment.php',986],['backup/cc/cc_lib','cc_asssesment.php',1003],['backup/cc/cc_lib','cc_asssesment.php',1017],['backup/cc/cc_lib','cc_asssesment.php',1045],['backup/cc/cc_lib','cc_asssesment.php',1186],['backup/cc/cc_lib','cc_asssesment.php',1263],['backup/cc/cc_lib','cc_asssesment.php',1317],['backup/cc/cc_lib','cc_asssesment.php',1389],['backup/cc/cc_lib','cc_asssesment.php',1451],['backup/cc/cc_lib','cc_asssesment.php',1558],['backup/cc/cc_lib','cc_asssesment.php',1620],['backup/cc/cc_lib','cc_asssesment.php',1648],['backup/cc/cc_lib','cc_asssesment.php',1716],['backup/cc/cc_lib','cc_asssesment.php',2155],['backup/cc/cc_lib','cc_asssesment.php',2264],['backup/cc/cc_lib','cc_asssesment.php',2469],['lib/phpunit/classes','hint_resultprinter.php',37],['lib/horde/framework/Horde/Mail/Transport','Mail.php',53],['auth/pop3','auth.php',35],['lib/adodb/drivers','adodb-oci8.inc.php',106],['lib/adodb/drivers','adodb-oci8.inc.php',1539],['lib/adodb/drivers','adodb-oci8.inc.php',1805],['lib/classes/session','database.php',52],['backup/util/ui','restore_ui_components.php',81],['backup/util/ui','restore_ui_components.php',287],['backup/util/ui','restore_ui_components.php',382],['question/classes/bank/search','category_condition.php',60],['lib/google/src/Google/Auth','AssertionCredentials.php',53],['backup/util/plan','restore_plan.class.php',43],['backup/util/plan','restore_plan.class.php',203],['backup/util/xml/parser/processors','findpaths_parser_processor.class.php',35],['lib/phpexcel/PHPExcel/CalcEngine','Logger.php',63],['lib/jabber/XMPP','Log.php',67],['lib/horde/framework/Horde/Imap/Client/Exception','ServerResponse.php',44],['lib/lessphp/Tree','Assignment.php',15],['lib/dtl','string_xml_database_importer.php',34],['admin/tool/lp/classes/output','manage_competency_frameworks_page.php',62],['question/type/calculated','question.php',188],['question/type/calculated','question.php',303],['repository/recent','lib.php',39],['grade/report/singleview/classes/local/ui','text_attribute.php',42],['admin/webservice','lib.php',38],['lib','coursecatlib.php',194],['lib','coursecatlib.php',2782],['lib/google/src/Google/Service','Cloudtrace.php',43],['lib','filterlib.php',73],['lib','filterlib.php',377],['lib','filterlib.php',456],['lib/classes/lock','lock_factory.php',39],['lib/filebrowser','file_info_context_course.php',39],['lib/filebrowser','file_info_context_course.php',492],['lib/filebrowser','file_info_context_course.php',596],['lib/filebrowser','file_info_context_course.php',745],['enrol','renderer.php',426],['enrol','renderer.php',723],['question/classes/statistics/questions','calculated_for_subquestion.php',57],['backup/moodle2','backup_format_plugin.class.php',40],['admin/tool/lp/classes','course_competency_rule_form_element.php',45],['auth/cas/CAS/CAS','ProxyTicketException.php',46],['lib/phpunit/classes','basic_testcase.php',39],['lib/spout/src/Spout/Reader/ODS','RowIterator.php',49],['backup/util/dbops','backup_dbops.class.php',37],['admin/tool/customlang','locallib.php',44],['admin/tool/customlang','locallib.php',405],['admin/tool/customlang','locallib.php',471],['backup/util/structure','backup_optigroup_element.class.php',51],['mod/quiz/report/grading','gradingsettings_form.php',44],['backup/util/plan','restore_step.class.php',32],['backup/util/plan','restore_step.class.php',104],['lib/form','hidden.php',44],['repository/filesystem','lib.php',48],['backup/controller','backup_controller.class.php',68],['backup/controller','backup_controller.class.php',409],['backup/util/helper','restore_log_rule.class.php',62],['tag/classes','tag.php',77],['lib/htmlpurifier/HTMLPurifier/AttrTransform','SafeParam.php',27],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Db.php',38],['lib/spout/src/Spout/Writer/Style','StyleBuilder.php',19],['lib/dml','sqlsrv_native_moodle_database.php',53],['user/filters','date.php',40],['auth/nologin','auth.php',35],['lib/google/src/Google','Model.php',35],['lib/horde/framework/Horde/Imap/Client/Socket','ClientSort.php',37],['lib/horde/framework/Horde/Imap/Client/Exception','SearchCharset.php',34],['lib/horde/framework/Horde/Support','StringStream.php',30],['lib/adodb/drivers','adodb-mysqli.inc.php',66],['lib/adodb/drivers','adodb-mysqli.inc.php',887],['lib/adodb/drivers','adodb-mysqli.inc.php',1193],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','ImportantDecorator.php',21],['lib/form','questioncategory.php',46],['lib/mustache/src/Mustache','Template.php',29],['backup/util/structure','base_nested_element.class.php',44],['backup/util/structure','base_nested_element.class.php',258],['lib/google/src/Google/Logger','Abstract.php',123],['backup/cc/cc_lib','cc_general.php',38],['lib/phpexcel/PHPExcel','ReferenceHelper.php',58],['lib/pear/HTML/QuickForm','password.php',37],['lib/dml','moodle_transaction.php',40],['lib/phpexcel/PHPExcel/Reader','Excel2003XML.php',53],['lib/htmlpurifier/HTMLPurifier/AttrDef','Switch.php',29],['repository/flickr','lib.php',51],['lib/form','grading.php',57],['lib/classes/update','api.php',71],['backup/cc/cc_lib','cc_converter_lti.php',29],['backup/moodle2','backup_subplugin.class.php',44],['lib/portfolio','caller.php',67],['lib/classes/progress','display_if_slow.php',60],['lib/adodb/perf','perf-informix.inc.php',66],['lib/classes','chart_base.php',52],['lib/lessphp/Tree','Media.php',18],['lib/spout/src/Spout/Common/Escaper','XLSX.php',19],['grade/export/ods','grade_export_ods.php',24],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Length.php',23],['lib/google/src/Google/Service','Calendar.php',50],['lib/form','group.php',44],['lib/phpexcel/PHPExcel/Writer','OpenDocument.php',44],['lib/pear/HTML/QuickForm/Renderer','Object.php',75],['admin/tool/lp/classes/output','user_evidence_page.php',48],['lib/horde/framework/Horde/Imap/Client/Fetch','Results.php',54],['grade/export/xls','grade_export_xls.php',24],['lib/classes/output','mustache_pix_helper.php',43],['lib/horde/framework/Horde/Imap/Client/Mailbox','List.php',46],['lib/google/src/Google/Auth','ComputeEngine.php',35],['cache/stores/session','lib.php',131],['lib/mustache/src/Mustache/Logger','StreamLogger.php',44],['admin/tool/log/store/database/backup/moodle2','backup_logstore_database_nested_element.php',43],['user','renderer.php',220],['lib/htmlpurifier/HTMLPurifier/ChildDef','Required.php',23],['availability/condition/grade/classes','condition.php',46],['lib/lessphp/Tree','RulesetCall.php',14],['blocks/rss_client/classes/output','feed.php',75],['lib/form','select.php',47],['lib/htmlpurifier/HTMLPurifier','ContentSets.php',33],['lib/lessphp/Visitor','toCSS.php',13],['lib','outputfragmentrequirementslib.php',40],['backup/util/ui','restore_moodleform.class.php',34],['lib/google/src/Google/Service','Cloudbilling.php',43],['lib/google/src/Google/Service','PlusDomains.php',72],['lib','externallib.php',37],['lib','externallib.php',531],['lib','externallib.php',562],['lib','externallib.php',593],['lib','externallib.php',622],['lib','externallib.php',648],['lib','externallib.php',778],['lib','externallib.php',813],['lib','externallib.php',984],['lib','externallib.php',1177],['blog','locallib.php',71],['blog','locallib.php',564],['blog','locallib.php',847],['blog','locallib.php',892],['blog','locallib.php',965],['blog','locallib.php',1016],['blog','locallib.php',1041],['blog','locallib.php',1051],['blog','locallib.php',1063],['blog','locallib.php',1084],['lib/phpexcel/PHPExcel/Worksheet','ColumnDimension.php',53],['auth/cas','auth.php',39],['lib','lexer.php',41],['lib','lexer.php',145],['lib','lexer.php',217],['lib/phpexcel/PHPExcel/Shared/JAMA','QRDecomposition.php',48],['lib/google/src/Google/Service','Exception.php',34],['lib/htmlpurifier/HTMLPurifier','Printer.php',21],['tag/classes/output','tagcloud.php',49],['lib/google/src/Google/Service','Storagetransfer.php',44],['user/filters','select.php',46],['cache/stores/mongodb','lib.php',116],['admin/tool/lp/classes/output','course_competencies_page.php',73],['lib/google/src/Google/Cache','Null.php',28],['lib','graphlib.php',1176],['lib/phpexcel/PHPExcel/Style','Protection.php',49],['lib/google/src/Google/Service','GamesConfiguration.php',42],['repository/dropbox','locallib.php',46],['lib/phpexcel/PHPExcel/Style','Alignment.php',100],['lib/htmlpurifier/HTMLPurifier','Language.php',63],['cache/stores/file','lib.php',117],['tag/classes/output','tagareashowstandard.php',41],['question/type/multianswer','edit_multianswer_form.php',63],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','Bool.php',22],['mod/assign','renderable.php',41],['mod/assign','renderable.php',71],['mod/assign','renderable.php',103],['mod/assign','renderable.php',139],['mod/assign','renderable.php',191],['mod/assign','renderable.php',242],['mod/assign','renderable.php',291],['mod/assign','renderable.php',395],['mod/assign','renderable.php',531],['mod/assign','renderable.php',586],['mod/assign','renderable.php',670],['mod/assign','renderable.php',707],['mod/assign','renderable.php',747],['mod/assign','renderable.php',800],['mod/assign','renderable.php',854],['lib/form','selectwithlink.php',56],['backup/moodle2','backup_activity_task.class.php',45],['lib/phpmailer','class.phpmailer.php',633],['lib/horde/framework/Horde/Imap/Client/Data','AclRights.php',39],['auth/db','auth.php',36],['lib/lessphp/Tree','Value.php',14],['lib/form','course.php',62],['question/engine','questionattemptstep.php',97],['question/engine','questionattemptstep.php',608],['cohort','locallib.php',37],['cohort','locallib.php',101],['badges/criteria','award_criteria.php',127],['lib/adodb/perf','perf-mysql.inc.php',86],['cache/stores/memcached','lib.php',133],['grade/report/singleview/classes/local/ui','empty_element.php',38],['lib/google/src/Google/Service','AppState.php',40],['lib/adodb/drivers','adodb-odbc_oracle.inc.php',107],['lib/pear/HTML/QuickForm/Renderer','Default.php',139],['tag/classes/output','tag.php',46],['question','previewlib.php',122],['backup/util/loggers','database_logger.class.php',40],['mod/forum/classes','potential_subscriber_selector.php',47],['lib/htmlpurifier/HTMLPurifier/ConfigSchema','InterchangeBuilder.php',15],['lib/phpexcel/PHPExcel/Reader','SYLK.php',67],['lib/form','submitlink.php',47],['backup/util/dbops','restore_dbops.class.php',1788],['lib/xmldb','xmldb_index.php',56],['question','category_class.php',58],['question','category_class.php',160],['lib/google/src/Google/Service','Webfonts.php',38],['webservice/xmlrpc','locallib.php',41],['admin/roles/classes','check_users_selector.php',38],['lib/htmlpurifier/HTMLPurifier/AttrTransform','ImgSpace.php',24],['user/profile/field/checkbox','field.class.php',33],['lib/form','cancel.php',47],['lib/google/src/Google/Service','Resourceviews.php',57],['lib/phpexcel/PHPExcel/Style','Font.php',100],['lib/portfolio','plugin.php',445],['calendar','lib.php',2003],['calendar','lib.php',2774],['mod/wiki','pagelib.php',93],['mod/wiki','pagelib.php',380],['mod/wiki','pagelib.php',981],['mod/wiki','pagelib.php',1190],['mod/wiki','pagelib.php',2194],['mod/wiki','pagelib.php',2422],['tag/classes/output','tagfeed.php',43],['tag/classes/output','tagareaenabled.php',38],['backup/util/xml/parser/processors','selective_like_parser_processor.class.php',35],['mod/workshop','locallib.php',183],['mod/workshop','locallib.php',2976],['mod/workshop','locallib.php',3411],['mod/workshop','locallib.php',3647],['mod/workshop','locallib.php',3889],['mod/workshop','locallib.php',3975],['mod/workshop','locallib.php',4060],['mod/workshop','locallib.php',4079],['lib/form','advcheckbox.php',48],['backup/cc/cc_lib','cc_assesment_sfib.php',27],['cohort/classes/output','cohortidnumber.php',37],['lib/adodb/drivers','adodb-ado.inc.php',42],['lib/adodb/drivers','adodb-ado.inc.php',346],['lib/form','filepicker.php',53],['mod/assign','adminlib.php',41],['mod/assign','adminlib.php',102],['lib/tests/fixtures','test_renderer_factory.php',41],['backup/cc/cc_lib','cc_converter_label.php',28],['lib/htmlpurifier/HTMLPurifier','Lexer.php',152],['grade/report/singleview','lib.php',69],['backup/cc/cc_lib','cc_converter_page.php',28],['lib/google/src/Google/Logger','Psr.php',39],['lib/simplepie/library/SimplePie/HTTP','Parser.php',131],['backup/util/plan','backup_step.class.php',32],['backup/util/plan','backup_step.class.php',55],['lib/lessphp/Tree','Import.php',30],['lib/jabber/XMPP','XMPP_Old.php',45],['lib/phpexcel/PHPExcel/Worksheet','Drawing.php',37],['lib/google/src/Google/Service','Classroom.php',60],['lib/phpexcel/PHPExcel/Chart/Renderer','jpgraph.php',875],['admin/tool/lp/classes/external','competency_path_exporter.php',38],['cohort/classes/output','cohortname.php',37],['grade/report/overview','lib.php',76],['lib/horde/framework/Horde/Mail/Rfc822','Address.php',66],['admin/roles/classes','admins_existing_selector.php',30],['lib/phpunit/classes','arraydataset.php',45],['question/engine','questionattempt.php',166],['question/engine','questionattempt.php',1532],['question/engine','questionattempt.php',1618],['question/engine','questionattempt.php',1703],['lib/horde/framework/Horde/Support','Uuid.php',23],['lib/horde/framework/Horde/Imap/Client/Data/Format','Nil.php',27],['webservice/rest','lib.php',47],['lib/phpexcel/PHPExcel/Worksheet','HeaderFooterDrawing.php',79],['backup/util/xml/output','memory_xml_output.class.php',37],['repository/flickr_public','image.php',34],['mod/lti/classes/local/ltiservice','resource_base.php',62],['admin/tool/lp/classes/output','template_plans_table.php',53],['mod/quiz','mod_form.php',48],['lib/simplepie/library/SimplePie','Caption.php',98],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Multiple.php',33],['lib/htmlpurifier/HTMLPurifier','PercentEncoder.php',20],['lib/phpexcel/PHPExcel/Calculation','ExceptionHandler.php',30],['lib/htmlpurifier/HTMLPurifier/Token','Tag.php',33],['backup/moodle2','backup_theme_plugin.class.php',61],['mod/chat','chatd.php',78],['mod/chat','chatd.php',103],['lib/phpexcel/PHPExcel','DocumentSecurity.php',65],['lib/htmlpurifier/HTMLPurifier','URIDefinition.php',21],['lib/spout/src/Spout/Writer/XLSX/Internal','Workbook.php',45],['lib/phpexcel/PHPExcel/Shared','XMLWriter.php',49],['lib/lessphp/Tree','Operation.php',19],['lib/htmlpurifier/HTMLPurifier/Lexer','PH5P.php',461],['lib/htmlpurifier/HTMLPurifier/Lexer','PH5P.php',1699],['backup/cc/cc_lib','cc_converter_folder.php',28],['backup/util/helper','restore_roles_parser_processor.class.php',39],['lib/simplepie/library/SimplePie','Locator.php',68],['lib/google/src/Google/Service','SQLAdmin.php',50],['lib/lessphp/Tree','DetachedRuleset.php',15],['admin/tool/assignmentupgrade','upgradableassignmentstable.php',49],['backup/cc','validator.php',30],['backup/cc','validator.php',116],['backup/cc','validator.php',202],['backup/cc','validator.php',230],['backup/cc','validator.php',236],['backup/cc','validator.php',242],['backup/cc','validator.php',248],['backup/cc','validator.php',254],['backup/cc','validator.php',260],['lib/horde/framework/Horde/Imap/Client/Interaction','Client.php',34],['mod/quiz','override_form.php',58],['auth/cas/CAS/CAS/PGTStorage','AbstractStorage.php',57],['lib/htmlpurifier/HTMLPurifier','Length.php',41],['backup/util/helper','restore_decode_rule.class.php',47],['backup/util/helper','restore_decode_rule.class.php',192],['lib/horde/framework/Horde/Imap/Client/Data','Sync.php',133],['lib/phpexcel/PHPExcel/Shared/trend','logarithmicBestFitClass.php',97],['lib/adodb/perf','perf-db2.inc.php',61],['lib/phpexcel/PHPExcel/Style','Supervisor.php',44],['lib/htmlpurifier/HTMLPurifier/AttrTransform','TargetBlank.php',17],['lib/ddl','database_manager.php',48],['lib/mustache/src/Mustache/Exception','UnknownFilterException.php',22],['admin/roles/classes','define_role_table_advanced.php',46],['lib/dml','oci_native_moodle_temptables.php',40],['lib/horde/framework/Horde/Stream','Existing.php',28],['enrol/manual','locallib.php',37],['enrol/manual','locallib.php',102],['availability/classes','multiple_messages.php',56],['lib/phpexcel/PHPExcel/Reader','Gnumeric.php',55],['admin/roles/classes','override_permissions_table_advanced.php',31],['lib/pear/Net','GeoIP.php',323],['lib/mustache/src/Mustache/Loader','ArrayLoader.php',31],['lib/form','modgrade.php',78],['admin/tool/log/store/database/backup/moodle2','restore_logstore_database_subplugin.class.php',40],['cache/classes','config.php',80],['lib/pear/HTML/QuickForm','hidden.php',37],['question/type/calculated','datasetitems_form.php',72],['lib/tests','navigationlib_test.php',554],['lib/tests','navigationlib_test.php',612],['lib/tests','navigationlib_test.php',639],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Number.php',18],['lib/tests','completionlib_test.php',882],['admin/tool/generator/classes','site_backend.php',58],['lib/jabber/XMPP','XMLStream.php',171],['lib/simplepie/library/SimplePie','Sanitize.php',75],['cache/classes','factory.php',149],['lib/minify/lib/Minify/Cache','WinCache.php',20],['user/classes/output/myprofile','node.php',82],['lib/horde/framework/Horde/Stream','TempString.php',40],['lib/adodb/drivers','adodb-borland_ibase.inc.php',83],['mod/forum','locallib.php',55],['mod/forum','locallib.php',419],['mod/lti/service/memberships/classes/local/resource','contextmemberships.php',44],['lib/phpexcel/PHPExcel/Worksheet/AutoFilter/Column','Rule.php',262],['lib/classes/update','code_manager.php',57],['search/engine/solr/classes','engine.php',103],['lib/horde/framework/Horde/Imap/Client/Interaction/Server','Tagged.php',36],['lib/google/src/Google/Service','Compute.php',89],['lib/phpexcel/PHPExcel/Style','Borders.php',113],['lib','completionlib.php',243],['lib/google/src/Google/Service','Pubsub.php',44],['lib/adodb/drivers','adodb-ads.inc.php',69],['lib/adodb/drivers','adodb-ads.inc.php',657],['lib/markdown','MarkdownExtra.php',56],['lib/minify/lib/Minify/Cache','XCache.php',22],['lib/google/src/Google/Service','YouTube.php',75],['lib/lessphp','Functions.php',15],['auth/cas/CAS/CAS','AuthenticationException.php',53],['mod/quiz','locallib.php',1923],['competency/classes/external','stored_file_exporter.php',45],['user/filters','checkbox.php',51],['backup/moodle2','restore_settingslib.php',86],['backup/moodle2','restore_settingslib.php',149],['lib/htmlpurifier/HTMLPurifier/Node','Element.php',39],['lib/pear/HTML/QuickForm','date.php',260],['lib/lessphp/SourceMap','Generator.php',82],['backup/util/plan','base_step.class.php',35],['backup/util/plan','base_step.class.php',127],['mod/lti/service/memberships/classes/local/service','memberships.php',50],['lib/google/src/Google/Cache','Apc.php',37],['backup/util/ui','restore_ui_stage.class.php',42],['backup/util/ui','restore_ui_stage.class.php',265],['backup/util/ui','restore_ui_stage.class.php',452],['backup/util/ui','restore_ui_stage.class.php',592],['backup/util/ui','restore_ui_stage.class.php',704],['backup/util/ui','restore_ui_stage.class.php',852],['backup/util/ui','restore_ui_stage.class.php',959],['backup/util/ui','restore_ui_stage.class.php',1100],['lib/pear/Auth','RADIUS.php',120],['lib/pear/Auth','RADIUS.php',579],['lib/pear/Auth','RADIUS.php',672],['lib/pear/Auth','RADIUS.php',879],['lib/adodb/drivers','adodb-ado_access.inc.php',46],['admin/tool/xmldb/actions','XMLDBAction.class.php',56],['backup/converter/moodle1','handlerlib.php',120],['backup/converter/moodle1','handlerlib.php',1710],['backup/converter/moodle1','handlerlib.php',1902],['backup/converter/moodle1','handlerlib.php',2155],['backup/controller','restore_controller.class.php',63],['backup/controller','restore_controller.class.php',519],['lib/google/src/Google/Http','Request.php',58],['lib/google/src/Google/Service','Dfareporting.php',99],['lib/google/src/Google/Service','Manager.php',60],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Hashtable.php',73],['lib/htmlpurifier/HTMLPurifier/ConfigSchema','Validator.php',30],['lib/google/src/Google/Service','CloudMonitoring.php',45],['lib/editor/tinymce/plugins/spellchecker/classes','SpellChecker.php',11],['lib/horde/framework/Horde/Imap/Client/Ids','Map.php',44],['lib/horde/framework/Horde/Mail/Transport','Sendmail.php',65],['lib','webdavlib.php',84],['lib/dml','pgsql_native_moodle_recordset.php',43],['lib/horde/framework/Horde/Support','Guid.php',24],['lib/mustache/src/Mustache','LambdaHelper.php',25],['question/engine/upgrade/tests','helper.php',45],['admin/tool/uploadcourse/classes','tracker.php',72],['grade/report/user','lib.php',188],['lib/adodb/drivers','adodb-sqlanywhere.inc.php',156],['auth/cas/CAS/CAS','OutOfSequenceBeforeClientException.php',47],['backup/util/plan','base_task.class.php',40],['backup/util/plan','base_task.class.php',277],['lib/adodb/drivers','adodb-db2oci.inc.php',220]], 1102],
'file_rewrite_pluginfile_urls': ['file_rewrite_pluginfile_urls', 'Convert encoded URLs in $text from the @@PLUGINFILE@@/... form to an actual URL. Passing a new option reverse = true in the $options var will make the function to convert actual URLs in $text to encoded URLs in the @@PLUGINFILE@@ form. ', [['lib','filelib.php',446]], 96],
'group_member_added': ['group_member_added', 'A group member was removed. ', [['mod/quiz/classes','group_observers.php',89]], 1],
'get_field': ['get_field', 'Gets an instance of the form field. ', [['lib/behat','behat_field_manager.php',248],['mod/quiz/report/statistics/classes','calculated.php',109],['lib/dml','moodle_database.php',1546],['user/filters','lib.php',124]], 536],
'get_string': ['get_string', 'Get String returns a requested string ', [['lib/classes','string_manager_install.php',95],['lib','moodlelib.php',6735],['lib','moodlelib.php',9695],['lib/external','externallib.php',102],['question/behaviour','behaviourbase.php',770],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38]], 20134],
'pix_url': ['pix_url', 'Return the moodle_url for an image. ', [['lib','outputrenderers.php',237],['lib','outputlib.php',1394]], 367],
'summary_url': ['summary_url', '', [['mod/quiz','attemptlib.php',367],['mod/quiz','attemptlib.php',1388]], 7],
'question_require_capability_on': ['question_require_capability_on', 'Require capability on question. ', [['lib','questionlib.php',1360]], 11],
'format_text': ['format_text', 'Formats a text string coming from the search engine. ', [['search/classes','document.php',606],['lib/classes','grading_external.php',182],['search/engine/solr/classes','document.php',129],['lib','weblib.php',1158],['lib','tablelib.php',860],['lib','tablelib.php',1667],['question/type','questionbase.php',345]], 322],
'get_coursemodule_from_instance': ['get_coursemodule_from_instance', 'Given an instance number of a module, finds the coursemodule description ', [['lib','datalib.php',1300]], 441],
'add_record_snapshot': ['add_record_snapshot', 'Add cached data that will be most probably used in event observers. ', [['lib/classes/event','base.php',840]], 332],
'debugging': ['debugging', 'Standard Debugging Function ', [['lib','weblib.php',3012]], 1007],
'get_record_sql': ['get_record_sql', 'Get a single database record as an object using a SQL statement. ', [['lib/dml','oci_native_moodle_database.php',1076],['lib/dml','moodle_database.php',1506]], 157],
'group_member_removed': ['group_member_removed', 'A group member was deleted. ', [['mod/quiz/classes','group_observers.php',99]], 2],
'quiz_get_user_attempts': ['quiz_get_user_attempts', '', [['mod/quiz','lib.php',554]], 29],
'extract': ['extract', '', [], 17],
'array_reverse': ['array_reverse', '', [], 130],
'defined': ['defined', '', [], 4731],
'array_merge': ['array_merge', '', [], 2944],
'array_key_exists': ['array_key_exists', '', [], 1445],
'reset': ['reset', '', [], 1213],
'array_keys': ['array_keys', '', [], 1256],
'array_unique': ['array_unique', '', [], 171],
'is_null': ['is_null', '', [], 2003],
'shuffle': ['shuffle', '', [], 27],
'min': ['min', '', [], 898],
'implode': ['implode', '', [], 1281],
'array_pop': ['array_pop', '', [], 483],
'is_array': ['is_array', '', [], 1608],
'define': ['define', '', [], 2373],
'count': ['count', '', [], 4095],
'is_numeric': ['is_numeric', '', [], 672],
'time': ['time', '', [], 1959],
'array_values': ['array_values', '', [], 342],
'max': ['max', '', [], 1266],
'explode': ['explode', '', [], 1572],
'ksort': ['ksort', '', [], 153],
'abs': ['abs', '', [], 560],
'array_shift': ['array_shift', '', [], 700],
'end': ['end', '', [], 433],
'in_array': ['in_array', '', [], 1234]};
CLASS_DATA={
'moodle_exception': ['moodle_exception', 'Base Moodle Exception class ', [['lib','setuplib.php',75]], 606],
'mod_quiz_display_options': ['mod_quiz_display_options', 'An extension of question_display_options that includes the extra options used by the quiz. ', [['mod/quiz','locallib.php',1843]], 99],
'group_observers': ['group_observers', 'Group observers class. ', [['mod/lesson/classes','group_observers.php',30],['mod/quiz/classes','group_observers.php',30]], 12],
'course_module_viewed': ['course_module_viewed', 'The mod_page course module viewed event class. ', [['mod/page/classes/event','course_module_viewed.php',28],['mod/chat/classes/event','course_module_viewed.php',29],['mod/quiz/classes/event','course_module_viewed.php',29],['mod/data/classes/event','course_module_viewed.php',30],['mod/choice/classes/event','course_module_viewed.php',28],['mod/forum/classes/event','course_module_viewed.php',29],['mod/resource/classes/event','course_module_viewed.php',29],['mod/book/classes/event','course_module_viewed.php',28],['mod/imscp/classes/event','course_module_viewed.php',30],['mod/lti/classes/event','course_module_viewed.php',29],['mod/feedback/classes/event','course_module_viewed.php',28],['mod/survey/classes/event','course_module_viewed.php',29],['mod/folder/classes/event','course_module_viewed.php',29],['mod/glossary/classes/event','course_module_viewed.php',28],['mod/scorm/classes/event','course_module_viewed.php',28],['mod/url/classes/event','course_module_viewed.php',29],['mod/wiki/classes/event','course_module_viewed.php',28],['lib/tests/fixtures','event_fixtures.php',232],['mod/lesson/classes/event','course_module_viewed.php',30],['mod/workshop/classes/event','course_module_viewed.php',32]], 37],
'question_variant_forced_choices_selection_strategy': ['question_variant_forced_choices_selection_strategy', 'A {@link question_variant_selection_strategy} designed ONLY for testing. For selected questions it wil return a specific variants. For the other slots it will use a fallback strategy. ', [['question/engine','lib.php',1042]], 2],
'attempt_deleted': ['attempt_deleted', 'The mod_scorm attempt deleted event class. ', [['mod/scorm/classes/event','attempt_deleted.php',28],['mod/quiz/classes/event','attempt_deleted.php',28]], 3],
'question_display_options': ['question_display_options', 'This class contains all the options that controls how a question is displayed. ', [['question/engine','lib.php',463]], 84],
'qubaid_join': ['qubaid_join', 'This class represents a restriction on the set of question_usage ids to include in a larger database query based on JOINing to some other tables. ', [['question/engine','datalib.php',1919]], 15],
'html_writer': ['html_writer', 'Simple html output class ', [['lib','outputcomponents.php',1062]], 5120],
'core_user': ['core_user', 'User class to access user details. ', [['lib/classes','user.php',27]], 457],
'context_module': ['context_module', 'Course module context class ', [['lib','accesslib.php',7039]], 1106],
'qubaids_for_quiz': ['qubaids_for_quiz', 'A {@link qubaid_condition} for finding all the question usages belonging to a particular quiz. ', [['mod/quiz','locallib.php',1915]], 1],
'attempt_preview_started': ['attempt_preview_started', 'The mod_quiz attempt preview started event class. ', [['mod/quiz/classes/event','attempt_preview_started.php',29]], 1],
'moodle_url': ['moodle_url', 'Class for creating and manipulating urls. ', [['lib','weblib.php',238]], 3088],
'completion_info': ['completion_info', 'Class represents completion information for a course. ', [['lib','completionlib.php',210]], 141],
'coding_exception': ['coding_exception', 'Exception indicating programming error, must be fixed by a programer. For example a core API might throw this type of exception if a plugin calls it incorrectly. ', [['lib','setuplib.php',239]], 1200],
'moodle_quiz_exception': ['moodle_quiz_exception', 'Class for quiz exceptions. Just saves a couple of arguments on the constructor for a moodle_exception. ', [['mod/quiz','attemptlib.php',32]], 27],
'quiz_attempt': ['quiz_attempt', 'This class extends the quiz class to hold data about the state of a particular attempt, in addition to the data about the quiz. ', [['mod/quiz','attemptlib.php',490]], 167],
'attempt_started': ['attempt_started', 'The mod_quiz attempt started event class. ', [['mod/quiz/classes/event','attempt_started.php',27]], 1],
'question_engine_data_mapper': ['question_engine_data_mapper', 'This class controls the loading and saving of question engine data to and from the database. ', [['question/engine','datalib.php',51]], 17]};
CONST_DATA={
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',140],['','install.php',93],['lib','setup.php',391]], 4153],
'QUIZ_ATTEMPTLAST': ['QUIZ_ATTEMPTLAST', '', [['mod/quiz','lib.php',51]], 12],
'DEBUG_DEVELOPER': ['DEBUG_DEVELOPER', '', [['lib','setuplib.php',40]], 736],
'NOGROUPS': ['NOGROUPS', '', [['lib','grouplib.php',29]], 58],
'QUIZ_SHOWIMAGE_LARGE': ['QUIZ_SHOWIMAGE_LARGE', '', [['mod/quiz','locallib.php',71]], 3],
'QUIZ_GRADEHIGHEST': ['QUIZ_GRADEHIGHEST', '', [['mod/quiz','lib.php',48]], 16],
'QUIZ_MAX_QPP_OPTION': ['QUIZ_MAX_QPP_OPTION', '', [['mod/quiz','lib.php',39]], 3],
'FORMAT_PLAIN': ['FORMAT_PLAIN', '', [['lib','weblib.php',52]], 152],
'QUIZ_MIN_TIME_TO_CONTINUE': ['QUIZ_MIN_TIME_TO_CONTINUE', '', [['mod/quiz','locallib.php',56]], 2],
'QUIZ_ATTEMPTFIRST': ['QUIZ_ATTEMPTFIRST', '', [['mod/quiz','lib.php',50]], 12],
'SQL_PARAMS_NAMED': ['SQL_PARAMS_NAMED', '', [['lib/dml','moodle_database.php',32]], 315],
'QUIZ_SHOWIMAGE_SMALL': ['QUIZ_SHOWIMAGE_SMALL', '', [['mod/quiz','locallib.php',66]], 2],
'COMPLETION_COMPLETE': ['COMPLETION_COMPLETE', '', [['lib','completionlib.php',76]], 90],
'QUIZ_SHOWIMAGE_NONE': ['QUIZ_SHOWIMAGE_NONE', '', [['mod/quiz','locallib.php',61]], 3],
'MUST_EXIST': ['MUST_EXIST', '', [['lib','dmllib.php',52]], 1384],
'QUIZ_GRADEAVERAGE': ['QUIZ_GRADEAVERAGE', '', [['mod/quiz','lib.php',49]], 16],
'QUIZ_SHOW_TIME_BEFORE_DEADLINE': ['QUIZ_SHOW_TIME_BEFORE_DEADLINE', '', [['mod/quiz','locallib.php',49]], 5]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Aug 11 10:00:09 2016</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
