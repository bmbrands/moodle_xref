<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /mod/choice/lib.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Aug 11 10:00:09 2016 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='mod/choice';
filename='lib.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/mod/choice/</a> -> <a href="lib.php.html">lib.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="lib.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="lib.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">//</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">//</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">//</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l16"><span class="linenum">  16</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l17"><span class="linenum">  17</span></a>  
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment">/**</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> * @package   mod_choice</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * @copyright 1999 onwards Martin Dougiamas  {@link http://moodle.com}</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> */</span>
<a name="l23"><span class="linenum">  23</span></a>  
<a name="l24"><span class="linenum">  24</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die();
<a name="l25"><span class="linenum">  25</span></a>  
<a name="l26"><span class="linenum">  26</span></a>  <span class="comment">/** @global int $CHOICE_COLUMN_HEIGHT */</span>
<a name="l27"><span class="linenum">  27</span></a>  global <a class="var it25951" onMouseOver="hilite(25951)" onMouseOut="lolite()" onClick="logVariable('CHOICE_COLUMN_HEIGHT')" href="../../_variables/CHOICE_COLUMN_HEIGHT.html">$CHOICE_COLUMN_HEIGHT</a>;
<a name="l28"><span class="linenum">  28</span></a>  <a class="var it25951" onMouseOver="hilite(25951)" onMouseOut="lolite()" onClick="logVariable('CHOICE_COLUMN_HEIGHT')" href="../../_variables/CHOICE_COLUMN_HEIGHT.html">$CHOICE_COLUMN_HEIGHT</a> = 300;
<a name="l29"><span class="linenum">  29</span></a>  
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment">/** @global int $CHOICE_COLUMN_WIDTH */</span>
<a name="l31"><span class="linenum">  31</span></a>  global <a class="var it25952" onMouseOver="hilite(25952)" onMouseOut="lolite()" onClick="logVariable('CHOICE_COLUMN_WIDTH')" href="../../_variables/CHOICE_COLUMN_WIDTH.html">$CHOICE_COLUMN_WIDTH</a>;
<a name="l32"><span class="linenum">  32</span></a>  <a class="var it25952" onMouseOver="hilite(25952)" onMouseOut="lolite()" onClick="logVariable('CHOICE_COLUMN_WIDTH')" href="../../_variables/CHOICE_COLUMN_WIDTH.html">$CHOICE_COLUMN_WIDTH</a> = 300;
<a name="l33"><span class="linenum">  33</span></a>  
<a name="l34"><span class="linenum">  34</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('CHOICE_PUBLISH_ANONYMOUS')" href="../../_constants/CHOICE_PUBLISH_ANONYMOUS.html" onMouseOver="constPopup(event,'CHOICE_PUBLISH_ANONYMOUS')">CHOICE_PUBLISH_ANONYMOUS</a>', '0');
<a name="l35"><span class="linenum">  35</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('CHOICE_PUBLISH_NAMES')" href="../../_constants/CHOICE_PUBLISH_NAMES.html" onMouseOver="constPopup(event,'CHOICE_PUBLISH_NAMES')">CHOICE_PUBLISH_NAMES</a>',     '1');
<a name="l36"><span class="linenum">  36</span></a>  
<a name="l37"><span class="linenum">  37</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('CHOICE_SHOWRESULTS_NOT')" href="../../_constants/CHOICE_SHOWRESULTS_NOT.html" onMouseOver="constPopup(event,'CHOICE_SHOWRESULTS_NOT')">CHOICE_SHOWRESULTS_NOT</a>',          '0');
<a name="l38"><span class="linenum">  38</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('CHOICE_SHOWRESULTS_AFTER_ANSWER')" href="../../_constants/CHOICE_SHOWRESULTS_AFTER_ANSWER.html" onMouseOver="constPopup(event,'CHOICE_SHOWRESULTS_AFTER_ANSWER')">CHOICE_SHOWRESULTS_AFTER_ANSWER</a>', '1');
<a name="l39"><span class="linenum">  39</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('CHOICE_SHOWRESULTS_AFTER_CLOSE')" href="../../_constants/CHOICE_SHOWRESULTS_AFTER_CLOSE.html" onMouseOver="constPopup(event,'CHOICE_SHOWRESULTS_AFTER_CLOSE')">CHOICE_SHOWRESULTS_AFTER_CLOSE</a>',  '2');
<a name="l40"><span class="linenum">  40</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('CHOICE_SHOWRESULTS_ALWAYS')" href="../../_constants/CHOICE_SHOWRESULTS_ALWAYS.html" onMouseOver="constPopup(event,'CHOICE_SHOWRESULTS_ALWAYS')">CHOICE_SHOWRESULTS_ALWAYS</a>',       '3');
<a name="l41"><span class="linenum">  41</span></a>  
<a name="l42"><span class="linenum">  42</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('CHOICE_DISPLAY_HORIZONTAL')" href="../../_constants/CHOICE_DISPLAY_HORIZONTAL.html" onMouseOver="constPopup(event,'CHOICE_DISPLAY_HORIZONTAL')">CHOICE_DISPLAY_HORIZONTAL</a>',  '0');
<a name="l43"><span class="linenum">  43</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('CHOICE_DISPLAY_VERTICAL')" href="../../_constants/CHOICE_DISPLAY_VERTICAL.html" onMouseOver="constPopup(event,'CHOICE_DISPLAY_VERTICAL')">CHOICE_DISPLAY_VERTICAL</a>',    '1');
<a name="l44"><span class="linenum">  44</span></a>  
<a name="l45"><span class="linenum">  45</span></a>  <span class="comment">/** @global array $CHOICE_PUBLISH */</span>
<a name="l46"><span class="linenum">  46</span></a>  global <a class="var it25953" onMouseOver="hilite(25953)" onMouseOut="lolite()" onClick="logVariable('CHOICE_PUBLISH')" href="../../_variables/CHOICE_PUBLISH.html">$CHOICE_PUBLISH</a>;
<a name="l47"><span class="linenum">  47</span></a>  <a class="var it25953" onMouseOver="hilite(25953)" onMouseOut="lolite()" onClick="logVariable('CHOICE_PUBLISH')" href="../../_variables/CHOICE_PUBLISH.html">$CHOICE_PUBLISH</a> = array (<a class="constant" onClick="logConstant('CHOICE_PUBLISH_ANONYMOUS')" href="../../_constants/CHOICE_PUBLISH_ANONYMOUS.html" onMouseOver="constPopup(event,'CHOICE_PUBLISH_ANONYMOUS')">CHOICE_PUBLISH_ANONYMOUS</a>  =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('publishanonymous', 'choice'),
<a name="l48"><span class="linenum">  48</span></a>                           <a class="constant" onClick="logConstant('CHOICE_PUBLISH_NAMES')" href="../../_constants/CHOICE_PUBLISH_NAMES.html" onMouseOver="constPopup(event,'CHOICE_PUBLISH_NAMES')">CHOICE_PUBLISH_NAMES</a>      =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('publishnames', 'choice'));
<a name="l49"><span class="linenum">  49</span></a>  
<a name="l50"><span class="linenum">  50</span></a>  <span class="comment">/** @global array $CHOICE_SHOWRESULTS */</span>
<a name="l51"><span class="linenum">  51</span></a>  global <a class="var it25954" onMouseOver="hilite(25954)" onMouseOut="lolite()" onClick="logVariable('CHOICE_SHOWRESULTS')" href="../../_variables/CHOICE_SHOWRESULTS.html">$CHOICE_SHOWRESULTS</a>;
<a name="l52"><span class="linenum">  52</span></a>  <a class="var it25954" onMouseOver="hilite(25954)" onMouseOut="lolite()" onClick="logVariable('CHOICE_SHOWRESULTS')" href="../../_variables/CHOICE_SHOWRESULTS.html">$CHOICE_SHOWRESULTS</a> = array (<a class="constant" onClick="logConstant('CHOICE_SHOWRESULTS_NOT')" href="../../_constants/CHOICE_SHOWRESULTS_NOT.html" onMouseOver="constPopup(event,'CHOICE_SHOWRESULTS_NOT')">CHOICE_SHOWRESULTS_NOT</a>          =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('publishnot', 'choice'),
<a name="l53"><span class="linenum">  53</span></a>                           <a class="constant" onClick="logConstant('CHOICE_SHOWRESULTS_AFTER_ANSWER')" href="../../_constants/CHOICE_SHOWRESULTS_AFTER_ANSWER.html" onMouseOver="constPopup(event,'CHOICE_SHOWRESULTS_AFTER_ANSWER')">CHOICE_SHOWRESULTS_AFTER_ANSWER</a> =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('publishafteranswer', 'choice'),
<a name="l54"><span class="linenum">  54</span></a>                           <a class="constant" onClick="logConstant('CHOICE_SHOWRESULTS_AFTER_CLOSE')" href="../../_constants/CHOICE_SHOWRESULTS_AFTER_CLOSE.html" onMouseOver="constPopup(event,'CHOICE_SHOWRESULTS_AFTER_CLOSE')">CHOICE_SHOWRESULTS_AFTER_CLOSE</a>  =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('publishafterclose', 'choice'),
<a name="l55"><span class="linenum">  55</span></a>                           <a class="constant" onClick="logConstant('CHOICE_SHOWRESULTS_ALWAYS')" href="../../_constants/CHOICE_SHOWRESULTS_ALWAYS.html" onMouseOver="constPopup(event,'CHOICE_SHOWRESULTS_ALWAYS')">CHOICE_SHOWRESULTS_ALWAYS</a>       =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('publishalways', 'choice'));
<a name="l56"><span class="linenum">  56</span></a>  
<a name="l57"><span class="linenum">  57</span></a>  <span class="comment">/** @global array $CHOICE_DISPLAY */</span>
<a name="l58"><span class="linenum">  58</span></a>  global <a class="var it25955" onMouseOver="hilite(25955)" onMouseOut="lolite()" onClick="logVariable('CHOICE_DISPLAY')" href="../../_variables/CHOICE_DISPLAY.html">$CHOICE_DISPLAY</a>;
<a name="l59"><span class="linenum">  59</span></a>  <a class="var it25955" onMouseOver="hilite(25955)" onMouseOut="lolite()" onClick="logVariable('CHOICE_DISPLAY')" href="../../_variables/CHOICE_DISPLAY.html">$CHOICE_DISPLAY</a> = array (<a class="constant" onClick="logConstant('CHOICE_DISPLAY_HORIZONTAL')" href="../../_constants/CHOICE_DISPLAY_HORIZONTAL.html" onMouseOver="constPopup(event,'CHOICE_DISPLAY_HORIZONTAL')">CHOICE_DISPLAY_HORIZONTAL</a>   =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('displayhorizontal', 'choice'),
<a name="l60"><span class="linenum">  60</span></a>                           <a class="constant" onClick="logConstant('CHOICE_DISPLAY_VERTICAL')" href="../../_constants/CHOICE_DISPLAY_VERTICAL.html" onMouseOver="constPopup(event,'CHOICE_DISPLAY_VERTICAL')">CHOICE_DISPLAY_VERTICAL</a>     =&gt; <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('displayvertical','choice'));
<a name="l61"><span class="linenum">  61</span></a>  
<a name="l62"><span class="linenum">  62</span></a>  <span class="comment">/// Standard functions /////////////////////////////////////////////////////////</span>
<a name="l63"><span class="linenum">  63</span></a>  
<a name="l64"><span class="linenum">  64</span></a>  <span class="comment">/**</span>
<a name="l65"><span class="linenum">  65</span></a>  <span class="comment"> * @global object</span>
<a name="l66"><span class="linenum">  66</span></a>  <span class="comment"> * @param object $course</span>
<a name="l67"><span class="linenum">  67</span></a>  <span class="comment"> * @param object $user</span>
<a name="l68"><span class="linenum">  68</span></a>  <span class="comment"> * @param object $mod</span>
<a name="l69"><span class="linenum">  69</span></a>  <span class="comment"> * @param object $choice</span>
<a name="l70"><span class="linenum">  70</span></a>  <span class="comment"> * @return object|null</span>
<a name="l71"><span class="linenum">  71</span></a>  <span class="comment"> */</span>
<a name="l72"><span class="linenum">  72</span></a>  function <a class="function" onClick="logFunction('choice_user_outline')" href="../../_functions/choice_user_outline.html" onMouseOver="funcPopup(event,'choice_user_outline')">choice_user_outline</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>, <a class="var it2586" onMouseOver="hilite(2586)" onMouseOut="lolite()" onClick="logVariable('mod')" href="../../_variables/mod.html">$mod</a>, <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>) {
<a name="l73"><span class="linenum">  73</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l74"><span class="linenum">  74</span></a>      if (<a class="var it2951" onMouseOver="hilite(2951)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../_variables/answer.html">$answer</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('choice_answers', array('choiceid' =&gt; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'userid' =&gt; <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l75"><span class="linenum">  75</span></a>          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = new stdClass();
<a name="l76"><span class="linenum">  76</span></a>          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('info')" class="var it43057" onMouseOver="hilite(43057)" onMouseOut="lolite()" href="../../_variables/info.html">info</a> = &quot;'&quot;.<a class="function" onClick="logFunction('format_string')" href="../../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="function" onClick="logFunction('choice_get_option_text')" href="../../_functions/choice_get_option_text.html" onMouseOver="funcPopup(event,'choice_get_option_text')">choice_get_option_text</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>, <a class="var it2951" onMouseOver="hilite(2951)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../_variables/answer.html">$answer</a>-&gt;<a onClick="logVariable('optionid')" class="var it43027" onMouseOver="hilite(43027)" onMouseOut="lolite()" href="../../_variables/optionid.html">optionid</a>)).&quot;'&quot;;
<a name="l77"><span class="linenum">  77</span></a>          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('time')" class="var it43057" onMouseOver="hilite(43057)" onMouseOut="lolite()" href="../../_variables/time.html">time</a> = <a class="var it2951" onMouseOver="hilite(2951)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../_variables/answer.html">$answer</a>-&gt;<a onClick="logVariable('timemodified')" class="var it43027" onMouseOver="hilite(43027)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a>;
<a name="l78"><span class="linenum">  78</span></a>          return <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l79"><span class="linenum">  79</span></a>      }
<a name="l80"><span class="linenum">  80</span></a>      return NULL;
<a name="l81"><span class="linenum">  81</span></a>  }
<a name="l82"><span class="linenum">  82</span></a>  
<a name="l83"><span class="linenum">  83</span></a>  <span class="comment">/**</span>
<a name="l84"><span class="linenum">  84</span></a>  <span class="comment"> * Callback for the &quot;Complete&quot; report - prints the activity summary for the given user</span>
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment"> *</span>
<a name="l86"><span class="linenum">  86</span></a>  <span class="comment"> * @param object $course</span>
<a name="l87"><span class="linenum">  87</span></a>  <span class="comment"> * @param object $user</span>
<a name="l88"><span class="linenum">  88</span></a>  <span class="comment"> * @param object $mod</span>
<a name="l89"><span class="linenum">  89</span></a>  <span class="comment"> * @param object $choice</span>
<a name="l90"><span class="linenum">  90</span></a>  <span class="comment"> */</span>
<a name="l91"><span class="linenum">  91</span></a>  function <a class="function" onClick="logFunction('choice_user_complete')" href="../../_functions/choice_user_complete.html" onMouseOver="funcPopup(event,'choice_user_complete')">choice_user_complete</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>, <a class="var it2586" onMouseOver="hilite(2586)" onMouseOut="lolite()" onClick="logVariable('mod')" href="../../_variables/mod.html">$mod</a>, <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>) {
<a name="l92"><span class="linenum">  92</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l93"><span class="linenum">  93</span></a>      if (<a class="var it454" onMouseOver="hilite(454)" onMouseOut="lolite()" onClick="logVariable('answers')" href="../../_variables/answers.html">$answers</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('choice_answers', array(&quot;choiceid&quot; =&gt; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, &quot;userid&quot; =&gt; <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l94"><span class="linenum">  94</span></a>          <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a> = [];
<a name="l95"><span class="linenum">  95</span></a>          foreach (<a class="var it454" onMouseOver="hilite(454)" onMouseOut="lolite()" onClick="logVariable('answers')" href="../../_variables/answers.html">$answers</a> as <a class="var it2951" onMouseOver="hilite(2951)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../_variables/answer.html">$answer</a>) {
<a name="l96"><span class="linenum">  96</span></a>              <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>[] = &quot;'&quot; . <a class="function" onClick="logFunction('format_string')" href="../../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="function" onClick="logFunction('choice_get_option_text')" href="../../_functions/choice_get_option_text.html" onMouseOver="funcPopup(event,'choice_get_option_text')">choice_get_option_text</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>, <a class="var it2951" onMouseOver="hilite(2951)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../_variables/answer.html">$answer</a>-&gt;<a onClick="logVariable('optionid')" class="var it43027" onMouseOver="hilite(43027)" onMouseOut="lolite()" href="../../_variables/optionid.html">optionid</a>)) . &quot;'&quot;;
<a name="l97"><span class="linenum">  97</span></a>          }
<a name="l98"><span class="linenum">  98</span></a>          <a class="class" onClick="logClass('core_collator')" href="../../_classes/core_collator.html" onMouseOver="classPopup(event,'core_collator')">core_collator</a>::<a class="phpfunction" onClick="logFunction('asort')" href="../../_functions/asort.html" onMouseOver="phpfuncPopup(event,'asort')">asort</a>(<a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>);
<a name="l99"><span class="linenum">  99</span></a>          echo <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;answered&quot;, &quot;choice&quot;) . &quot;: &quot;. <a class="function" onClick="logFunction('join')" href="../../_functions/join.html" onMouseOver="funcPopup(event,'join')">join</a>(', ', <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>) . &quot;. &quot; .
<a name="l100"><span class="linenum"> 100</span></a>                  <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;updated&quot;, '', <a class="function" onClick="logFunction('userdate')" href="../../_functions/userdate.html" onMouseOver="funcPopup(event,'userdate')">userdate</a>(<a class="var it2951" onMouseOver="hilite(2951)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../_variables/answer.html">$answer</a>-&gt;<a onClick="logVariable('timemodified')" class="var it43027" onMouseOver="hilite(43027)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a>));
<a name="l101"><span class="linenum"> 101</span></a>      } else {
<a name="l102"><span class="linenum"> 102</span></a>          <a class="function" onClick="logFunction('print_string')" href="../../_functions/print_string.html" onMouseOver="funcPopup(event,'print_string')">print_string</a>(&quot;notanswered&quot;, &quot;choice&quot;);
<a name="l103"><span class="linenum"> 103</span></a>      }
<a name="l104"><span class="linenum"> 104</span></a>  }
<a name="l105"><span class="linenum"> 105</span></a>  
<a name="l106"><span class="linenum"> 106</span></a>  <span class="comment">/**</span>
<a name="l107"><span class="linenum"> 107</span></a>  <span class="comment"> * Given an object containing all the necessary data,</span>
<a name="l108"><span class="linenum"> 108</span></a>  <span class="comment"> * (defined by the form in mod_form.php) this function</span>
<a name="l109"><span class="linenum"> 109</span></a>  <span class="comment"> * will create a new instance and return the id number</span>
<a name="l110"><span class="linenum"> 110</span></a>  <span class="comment"> * of the new instance.</span>
<a name="l111"><span class="linenum"> 111</span></a>  <span class="comment"> *</span>
<a name="l112"><span class="linenum"> 112</span></a>  <span class="comment"> * @global object</span>
<a name="l113"><span class="linenum"> 113</span></a>  <span class="comment"> * @param object $choice</span>
<a name="l114"><span class="linenum"> 114</span></a>  <span class="comment"> * @return int</span>
<a name="l115"><span class="linenum"> 115</span></a>  <span class="comment"> */</span>
<a name="l116"><span class="linenum"> 116</span></a>  function <a class="function" onClick="logFunction('choice_add_instance')" href="../../_functions/choice_add_instance.html" onMouseOver="funcPopup(event,'choice_add_instance')">choice_add_instance</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>) {
<a name="l117"><span class="linenum"> 117</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l118"><span class="linenum"> 118</span></a>      require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../mod/choice/locallib.php.html">/mod/choice/locallib.php</a>');
<a name="l119"><span class="linenum"> 119</span></a>  
<a name="l120"><span class="linenum"> 120</span></a>      <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('timemodified')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l121"><span class="linenum"> 121</span></a>  
<a name="l122"><span class="linenum"> 122</span></a>  <span class="comment">    //insert answers</span>
<a name="l123"><span class="linenum"> 123</span></a>      <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>(&quot;choice&quot;, <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>);
<a name="l124"><span class="linenum"> 124</span></a>      foreach (<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('option')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/option.html">option</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l125"><span class="linenum"> 125</span></a>          <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>);
<a name="l126"><span class="linenum"> 126</span></a>          if (isset(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) &amp;&amp; <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> &lt;&gt; '') {
<a name="l127"><span class="linenum"> 127</span></a>              <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a> = new stdClass();
<a name="l128"><span class="linenum"> 128</span></a>              <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('text')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/text.html">text</a> = <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l129"><span class="linenum"> 129</span></a>              <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('choiceid')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/choiceid.html">choiceid</a> = <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l130"><span class="linenum"> 130</span></a>              if (isset(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('limit')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/limit.html">limit</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>])) {
<a name="l131"><span class="linenum"> 131</span></a>                  <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('maxanswers')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/maxanswers.html">maxanswers</a> = <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('limit')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/limit.html">limit</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>];
<a name="l132"><span class="linenum"> 132</span></a>              }
<a name="l133"><span class="linenum"> 133</span></a>              <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('timemodified')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l134"><span class="linenum"> 134</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>(&quot;choice_options&quot;, <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>);
<a name="l135"><span class="linenum"> 135</span></a>          }
<a name="l136"><span class="linenum"> 136</span></a>      }
<a name="l137"><span class="linenum"> 137</span></a>  
<a name="l138"><span class="linenum"> 138</span></a>  <span class="comment">    // Add calendar events if necessary.</span>
<a name="l139"><span class="linenum"> 139</span></a>      <a class="function" onClick="logFunction('choice_set_events')" href="../../_functions/choice_set_events.html" onMouseOver="funcPopup(event,'choice_set_events')">choice_set_events</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>);
<a name="l140"><span class="linenum"> 140</span></a>  
<a name="l141"><span class="linenum"> 141</span></a>      return <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l142"><span class="linenum"> 142</span></a>  }
<a name="l143"><span class="linenum"> 143</span></a>  
<a name="l144"><span class="linenum"> 144</span></a>  <span class="comment">/**</span>
<a name="l145"><span class="linenum"> 145</span></a>  <span class="comment"> * Given an object containing all the necessary data,</span>
<a name="l146"><span class="linenum"> 146</span></a>  <span class="comment"> * (defined by the form in mod_form.php) this function</span>
<a name="l147"><span class="linenum"> 147</span></a>  <span class="comment"> * will update an existing instance with new data.</span>
<a name="l148"><span class="linenum"> 148</span></a>  <span class="comment"> *</span>
<a name="l149"><span class="linenum"> 149</span></a>  <span class="comment"> * @global object</span>
<a name="l150"><span class="linenum"> 150</span></a>  <span class="comment"> * @param object $choice</span>
<a name="l151"><span class="linenum"> 151</span></a>  <span class="comment"> * @return bool</span>
<a name="l152"><span class="linenum"> 152</span></a>  <span class="comment"> */</span>
<a name="l153"><span class="linenum"> 153</span></a>  function <a class="function" onClick="logFunction('choice_update_instance')" href="../../_functions/choice_update_instance.html" onMouseOver="funcPopup(event,'choice_update_instance')">choice_update_instance</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>) {
<a name="l154"><span class="linenum"> 154</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l155"><span class="linenum"> 155</span></a>      require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../mod/choice/locallib.php.html">/mod/choice/locallib.php</a>');
<a name="l156"><span class="linenum"> 156</span></a>  
<a name="l157"><span class="linenum"> 157</span></a>      <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('instance')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/instance.html">instance</a>;
<a name="l158"><span class="linenum"> 158</span></a>      <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('timemodified')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l159"><span class="linenum"> 159</span></a>  
<a name="l160"><span class="linenum"> 160</span></a>  <span class="comment">    //update, delete or insert answers</span>
<a name="l161"><span class="linenum"> 161</span></a>      foreach (<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('option')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/option.html">option</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l162"><span class="linenum"> 162</span></a>          <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>);
<a name="l163"><span class="linenum"> 163</span></a>          <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a> = new stdClass();
<a name="l164"><span class="linenum"> 164</span></a>          <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('text')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/text.html">text</a> = <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l165"><span class="linenum"> 165</span></a>          <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('choiceid')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/choiceid.html">choiceid</a> = <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l166"><span class="linenum"> 166</span></a>          if (isset(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('limit')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/limit.html">limit</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>])) {
<a name="l167"><span class="linenum"> 167</span></a>              <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('maxanswers')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/maxanswers.html">maxanswers</a> = <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('limit')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/limit.html">limit</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>];
<a name="l168"><span class="linenum"> 168</span></a>          }
<a name="l169"><span class="linenum"> 169</span></a>          <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('timemodified')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l170"><span class="linenum"> 170</span></a>          if (isset(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('optionid')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/optionid.html">optionid</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>]) &amp;&amp; !empty(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('optionid')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/optionid.html">optionid</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>])){//existing choice record
<a name="l171"><span class="linenum"> 171</span></a>              <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('id')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>=<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('optionid')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/optionid.html">optionid</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>];
<a name="l172"><span class="linenum"> 172</span></a>              if (isset(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) &amp;&amp; <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> &lt;&gt; '') {
<a name="l173"><span class="linenum"> 173</span></a>                  <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>(&quot;choice_options&quot;, <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>);
<a name="l174"><span class="linenum"> 174</span></a>              } else {
<a name="l175"><span class="linenum"> 175</span></a>  <span class="comment">                // Remove the empty (unused) option.</span>
<a name="l176"><span class="linenum"> 176</span></a>                  <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>(&quot;choice_options&quot;, array(&quot;id&quot; =&gt; <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('id')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l177"><span class="linenum"> 177</span></a>  <span class="comment">                // Delete any answers associated with this option.</span>
<a name="l178"><span class="linenum"> 178</span></a>                  <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>(&quot;choice_answers&quot;, array(&quot;choiceid&quot; =&gt; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, &quot;optionid&quot; =&gt; <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('id')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l179"><span class="linenum"> 179</span></a>              }
<a name="l180"><span class="linenum"> 180</span></a>          } else {
<a name="l181"><span class="linenum"> 181</span></a>              if (isset(<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) &amp;&amp; <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> &lt;&gt; '') {
<a name="l182"><span class="linenum"> 182</span></a>                  <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>(&quot;choice_options&quot;, <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>);
<a name="l183"><span class="linenum"> 183</span></a>              }
<a name="l184"><span class="linenum"> 184</span></a>          }
<a name="l185"><span class="linenum"> 185</span></a>      }
<a name="l186"><span class="linenum"> 186</span></a>  
<a name="l187"><span class="linenum"> 187</span></a>  <span class="comment">    // Add calendar events if necessary.</span>
<a name="l188"><span class="linenum"> 188</span></a>      <a class="function" onClick="logFunction('choice_set_events')" href="../../_functions/choice_set_events.html" onMouseOver="funcPopup(event,'choice_set_events')">choice_set_events</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>);
<a name="l189"><span class="linenum"> 189</span></a>  
<a name="l190"><span class="linenum"> 190</span></a>      return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('choice', <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>);
<a name="l191"><span class="linenum"> 191</span></a>  
<a name="l192"><span class="linenum"> 192</span></a>  }
<a name="l193"><span class="linenum"> 193</span></a>  
<a name="l194"><span class="linenum"> 194</span></a>  <span class="comment">/**</span>
<a name="l195"><span class="linenum"> 195</span></a>  <span class="comment"> * @global object</span>
<a name="l196"><span class="linenum"> 196</span></a>  <span class="comment"> * @param object $choice</span>
<a name="l197"><span class="linenum"> 197</span></a>  <span class="comment"> * @param object $user</span>
<a name="l198"><span class="linenum"> 198</span></a>  <span class="comment"> * @param object $coursemodule</span>
<a name="l199"><span class="linenum"> 199</span></a>  <span class="comment"> * @param array $allresponses</span>
<a name="l200"><span class="linenum"> 200</span></a>  <span class="comment"> * @return array</span>
<a name="l201"><span class="linenum"> 201</span></a>  <span class="comment"> */</span>
<a name="l202"><span class="linenum"> 202</span></a>  function <a class="function" onClick="logFunction('choice_prepare_options')" href="../../_functions/choice_prepare_options.html" onMouseOver="funcPopup(event,'choice_prepare_options')">choice_prepare_options</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>, <a class="var it1880" onMouseOver="hilite(1880)" onMouseOut="lolite()" onClick="logVariable('coursemodule')" href="../../_variables/coursemodule.html">$coursemodule</a>, <a class="var it24060" onMouseOver="hilite(24060)" onMouseOut="lolite()" onClick="logVariable('allresponses')" href="../../_variables/allresponses.html">$allresponses</a>) {
<a name="l203"><span class="linenum"> 203</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l204"><span class="linenum"> 204</span></a>  
<a name="l205"><span class="linenum"> 205</span></a>      <a class="var it25956" onMouseOver="hilite(25956)" onMouseOut="lolite()" onClick="logVariable('cdisplay')" href="../../_variables/cdisplay.html">$cdisplay</a> = array('options'=&gt;array());
<a name="l206"><span class="linenum"> 206</span></a>  
<a name="l207"><span class="linenum"> 207</span></a>      <a class="var it25956" onMouseOver="hilite(25956)" onMouseOut="lolite()" onClick="logVariable('cdisplay')" href="../../_variables/cdisplay.html">$cdisplay</a>['limitanswers'] = true;
<a name="l208"><span class="linenum"> 208</span></a>      <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_module')" href="../../_classes/context_module.html" onMouseOver="classPopup(event,'context_module')">context_module</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it1880" onMouseOver="hilite(1880)" onMouseOut="lolite()" onClick="logVariable('coursemodule')" href="../../_variables/coursemodule.html">$coursemodule</a>-&gt;<a onClick="logVariable('id')" class="var it43092" onMouseOver="hilite(43092)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l209"><span class="linenum"> 209</span></a>  
<a name="l210"><span class="linenum"> 210</span></a>      foreach (<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('option')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/option.html">option</a> as <a class="var it6606" onMouseOver="hilite(6606)" onMouseOut="lolite()" onClick="logVariable('optionid')" href="../../_variables/optionid.html">$optionid</a> =&gt; <a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l211"><span class="linenum"> 211</span></a>          if (isset(<a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>)) { //make sure there are no dud entries in the db with blank text values.
<a name="l212"><span class="linenum"> 212</span></a>              <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a> = new stdClass;
<a name="l213"><span class="linenum"> 213</span></a>              <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('attributes')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/attributes.html">attributes</a> = new stdClass;
<a name="l214"><span class="linenum"> 214</span></a>              <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('attributes')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/attributes.html">attributes</a>-&gt;value = <a class="var it6606" onMouseOver="hilite(6606)" onMouseOut="lolite()" onClick="logVariable('optionid')" href="../../_variables/optionid.html">$optionid</a>;
<a name="l215"><span class="linenum"> 215</span></a>              <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('text')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/text.html">text</a> = <a class="function" onClick="logFunction('format_string')" href="../../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l216"><span class="linenum"> 216</span></a>              <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('maxanswers')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/maxanswers.html">maxanswers</a> = <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('maxanswers')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/maxanswers.html">maxanswers</a>[<a class="var it6606" onMouseOver="hilite(6606)" onMouseOut="lolite()" onClick="logVariable('optionid')" href="../../_variables/optionid.html">$optionid</a>];
<a name="l217"><span class="linenum"> 217</span></a>              <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('displaylayout')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/displaylayout.html">displaylayout</a> = <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('display')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/display.html">display</a>;
<a name="l218"><span class="linenum"> 218</span></a>  
<a name="l219"><span class="linenum"> 219</span></a>              if (isset(<a class="var it24060" onMouseOver="hilite(24060)" onMouseOut="lolite()" onClick="logVariable('allresponses')" href="../../_variables/allresponses.html">$allresponses</a>[<a class="var it6606" onMouseOver="hilite(6606)" onMouseOut="lolite()" onClick="logVariable('optionid')" href="../../_variables/optionid.html">$optionid</a>])) {
<a name="l220"><span class="linenum"> 220</span></a>                  <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('countanswers')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/countanswers.html">countanswers</a> = <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it24060" onMouseOver="hilite(24060)" onMouseOut="lolite()" onClick="logVariable('allresponses')" href="../../_variables/allresponses.html">$allresponses</a>[<a class="var it6606" onMouseOver="hilite(6606)" onMouseOut="lolite()" onClick="logVariable('optionid')" href="../../_variables/optionid.html">$optionid</a>]);
<a name="l221"><span class="linenum"> 221</span></a>              } else {
<a name="l222"><span class="linenum"> 222</span></a>                  <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('countanswers')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/countanswers.html">countanswers</a> = 0;
<a name="l223"><span class="linenum"> 223</span></a>              }
<a name="l224"><span class="linenum"> 224</span></a>              if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('record_exists')" href="../../_functions/record_exists.html" onMouseOver="funcPopup(event,'record_exists')">record_exists</a>('choice_answers', array('choiceid' =&gt; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'userid' =&gt; <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'optionid' =&gt; <a class="var it6606" onMouseOver="hilite(6606)" onMouseOut="lolite()" onClick="logVariable('optionid')" href="../../_variables/optionid.html">$optionid</a>))) {
<a name="l225"><span class="linenum"> 225</span></a>                  <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('attributes')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/attributes.html">attributes</a>-&gt;checked = true;
<a name="l226"><span class="linenum"> 226</span></a>              }
<a name="l227"><span class="linenum"> 227</span></a>              if ( <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('limitanswers')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/limitanswers.html">limitanswers</a> &amp;&amp; (<a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('countanswers')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/countanswers.html">countanswers</a> &gt;= <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('maxanswers')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/maxanswers.html">maxanswers</a>) &amp;&amp; empty(<a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('attributes')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/attributes.html">attributes</a>-&gt;checked)) {
<a name="l228"><span class="linenum"> 228</span></a>                  <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('attributes')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/attributes.html">attributes</a>-&gt;disabled = true;
<a name="l229"><span class="linenum"> 229</span></a>              }
<a name="l230"><span class="linenum"> 230</span></a>              <a class="var it25956" onMouseOver="hilite(25956)" onMouseOut="lolite()" onClick="logVariable('cdisplay')" href="../../_variables/cdisplay.html">$cdisplay</a>['options'][] = <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>;
<a name="l231"><span class="linenum"> 231</span></a>          }
<a name="l232"><span class="linenum"> 232</span></a>      }
<a name="l233"><span class="linenum"> 233</span></a>  
<a name="l234"><span class="linenum"> 234</span></a>      <a class="var it25956" onMouseOver="hilite(25956)" onMouseOut="lolite()" onClick="logVariable('cdisplay')" href="../../_variables/cdisplay.html">$cdisplay</a>['hascapability'] = <a class="function" onClick="logFunction('is_enrolled')" href="../../_functions/is_enrolled.html" onMouseOver="funcPopup(event,'is_enrolled')">is_enrolled</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>, NULL, 'mod/choice:choose'); <span class="comment">//only enrolled users are allowed to make a choice</span>
<a name="l235"><span class="linenum"> 235</span></a>  
<a name="l236"><span class="linenum"> 236</span></a>      if (<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('allowupdate')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/allowupdate.html">allowupdate</a> &amp;&amp; <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('record_exists')" href="../../_functions/record_exists.html" onMouseOver="funcPopup(event,'record_exists')">record_exists</a>('choice_answers', array('choiceid'=&gt; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'userid'=&gt; <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l237"><span class="linenum"> 237</span></a>          <a class="var it25956" onMouseOver="hilite(25956)" onMouseOut="lolite()" onClick="logVariable('cdisplay')" href="../../_variables/cdisplay.html">$cdisplay</a>['allowupdate'] = true;
<a name="l238"><span class="linenum"> 238</span></a>      }
<a name="l239"><span class="linenum"> 239</span></a>  
<a name="l240"><span class="linenum"> 240</span></a>      if (<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('showpreview')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/showpreview.html">showpreview</a> &amp;&amp; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('timeopen')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/timeopen.html">timeopen</a> &gt; <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>()) {
<a name="l241"><span class="linenum"> 241</span></a>          <a class="var it25956" onMouseOver="hilite(25956)" onMouseOut="lolite()" onClick="logVariable('cdisplay')" href="../../_variables/cdisplay.html">$cdisplay</a>['previewonly'] = true;
<a name="l242"><span class="linenum"> 242</span></a>      }
<a name="l243"><span class="linenum"> 243</span></a>  
<a name="l244"><span class="linenum"> 244</span></a>      return <a class="var it25956" onMouseOver="hilite(25956)" onMouseOut="lolite()" onClick="logVariable('cdisplay')" href="../../_variables/cdisplay.html">$cdisplay</a>;
<a name="l245"><span class="linenum"> 245</span></a>  }
<a name="l246"><span class="linenum"> 246</span></a>  
<a name="l247"><span class="linenum"> 247</span></a>  <span class="comment">/**</span>
<a name="l248"><span class="linenum"> 248</span></a>  <span class="comment"> * Process user submitted answers for a choice,</span>
<a name="l249"><span class="linenum"> 249</span></a>  <span class="comment"> * and either updating them or saving new answers.</span>
<a name="l250"><span class="linenum"> 250</span></a>  <span class="comment"> *</span>
<a name="l251"><span class="linenum"> 251</span></a>  <span class="comment"> * @param int $formanswer users submitted answers.</span>
<a name="l252"><span class="linenum"> 252</span></a>  <span class="comment"> * @param object $choice the selected choice.</span>
<a name="l253"><span class="linenum"> 253</span></a>  <span class="comment"> * @param int $userid user identifier.</span>
<a name="l254"><span class="linenum"> 254</span></a>  <span class="comment"> * @param object $course current course.</span>
<a name="l255"><span class="linenum"> 255</span></a>  <span class="comment"> * @param object $cm course context.</span>
<a name="l256"><span class="linenum"> 256</span></a>  <span class="comment"> * @return void</span>
<a name="l257"><span class="linenum"> 257</span></a>  <span class="comment"> */</span>
<a name="l258"><span class="linenum"> 258</span></a>  function <a class="function" onClick="logFunction('choice_user_submit_response')" href="../../_functions/choice_user_submit_response.html" onMouseOver="funcPopup(event,'choice_user_submit_response')">choice_user_submit_response</a>(<a class="var it25957" onMouseOver="hilite(25957)" onMouseOut="lolite()" onClick="logVariable('formanswer')" href="../../_variables/formanswer.html">$formanswer</a>, <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>) {
<a name="l259"><span class="linenum"> 259</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l260"><span class="linenum"> 260</span></a>      require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a>.'/completionlib.php');
<a name="l261"><span class="linenum"> 261</span></a>  
<a name="l262"><span class="linenum"> 262</span></a>      <a class="var it434" onMouseOver="hilite(434)" onMouseOut="lolite()" onClick="logVariable('continueurl')" href="../../_variables/continueurl.html">$continueurl</a> = <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../mod/choice/view.php.html">/mod/choice/view.php</a>', array('id' =&gt; <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l263"><span class="linenum"> 263</span></a>  
<a name="l264"><span class="linenum"> 264</span></a>      if (empty(<a class="var it25957" onMouseOver="hilite(25957)" onMouseOut="lolite()" onClick="logVariable('formanswer')" href="../../_variables/formanswer.html">$formanswer</a>)) {
<a name="l265"><span class="linenum"> 265</span></a>          <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('atleastoneoption', 'choice', <a class="var it434" onMouseOver="hilite(434)" onMouseOut="lolite()" onClick="logVariable('continueurl')" href="../../_variables/continueurl.html">$continueurl</a>);
<a name="l266"><span class="linenum"> 266</span></a>      }
<a name="l267"><span class="linenum"> 267</span></a>  
<a name="l268"><span class="linenum"> 268</span></a>      if (<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it25957" onMouseOver="hilite(25957)" onMouseOut="lolite()" onClick="logVariable('formanswer')" href="../../_variables/formanswer.html">$formanswer</a>)) {
<a name="l269"><span class="linenum"> 269</span></a>          if (!<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('allowmultiple')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/allowmultiple.html">allowmultiple</a>) {
<a name="l270"><span class="linenum"> 270</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('multiplenotallowederror', 'choice', <a class="var it434" onMouseOver="hilite(434)" onMouseOut="lolite()" onClick="logVariable('continueurl')" href="../../_variables/continueurl.html">$continueurl</a>);
<a name="l271"><span class="linenum"> 271</span></a>          }
<a name="l272"><span class="linenum"> 272</span></a>          <a class="var it25958" onMouseOver="hilite(25958)" onMouseOut="lolite()" onClick="logVariable('formanswers')" href="../../_variables/formanswers.html">$formanswers</a> = <a class="var it25957" onMouseOver="hilite(25957)" onMouseOut="lolite()" onClick="logVariable('formanswer')" href="../../_variables/formanswer.html">$formanswer</a>;
<a name="l273"><span class="linenum"> 273</span></a>      } else {
<a name="l274"><span class="linenum"> 274</span></a>          <a class="var it25958" onMouseOver="hilite(25958)" onMouseOut="lolite()" onClick="logVariable('formanswers')" href="../../_variables/formanswers.html">$formanswers</a> = array(<a class="var it25957" onMouseOver="hilite(25957)" onMouseOut="lolite()" onClick="logVariable('formanswer')" href="../../_variables/formanswer.html">$formanswer</a>);
<a name="l275"><span class="linenum"> 275</span></a>      }
<a name="l276"><span class="linenum"> 276</span></a>  
<a name="l277"><span class="linenum"> 277</span></a>      <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('choice_options', array('choiceid' =&gt; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>), '', 'id');
<a name="l278"><span class="linenum"> 278</span></a>      foreach (<a class="var it25958" onMouseOver="hilite(25958)" onMouseOut="lolite()" onClick="logVariable('formanswers')" href="../../_variables/formanswers.html">$formanswers</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>) {
<a name="l279"><span class="linenum"> 279</span></a>          if (!isset(<a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>[<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>])) {
<a name="l280"><span class="linenum"> 280</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('cannotsubmit', 'choice', <a class="var it434" onMouseOver="hilite(434)" onMouseOut="lolite()" onClick="logVariable('continueurl')" href="../../_variables/continueurl.html">$continueurl</a>);
<a name="l281"><span class="linenum"> 281</span></a>          }
<a name="l282"><span class="linenum"> 282</span></a>      }
<a name="l283"><span class="linenum"> 283</span></a>  <span class="comment">    // Start lock to prevent synchronous access to the same data</span>
<a name="l284"><span class="linenum"> 284</span></a>  <span class="comment">    // before it's updated, if using limits.</span>
<a name="l285"><span class="linenum"> 285</span></a>      if (<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('limitanswers')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/limitanswers.html">limitanswers</a>) {
<a name="l286"><span class="linenum"> 286</span></a>          <a class="var it1356" onMouseOver="hilite(1356)" onMouseOut="lolite()" onClick="logVariable('timeout')" href="../../_variables/timeout.html">$timeout</a> = 10;
<a name="l287"><span class="linenum"> 287</span></a>          <a class="var it25959" onMouseOver="hilite(25959)" onMouseOut="lolite()" onClick="logVariable('locktype')" href="../../_variables/locktype.html">$locktype</a> = 'mod_choice_choice_user_submit_response';
<a name="l288"><span class="linenum"> 288</span></a>  <span class="comment">        // Limiting access to this choice.</span>
<a name="l289"><span class="linenum"> 289</span></a>          <a class="var it25960" onMouseOver="hilite(25960)" onMouseOut="lolite()" onClick="logVariable('resouce')" href="../../_variables/resouce.html">$resouce</a> = 'choiceid:' . <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l290"><span class="linenum"> 290</span></a>          <a class="var it25961" onMouseOver="hilite(25961)" onMouseOut="lolite()" onClick="logVariable('lockfactory')" href="../../_variables/lockfactory.html">$lockfactory</a> = \core\lock\<a class="class" onClick="logClass('lock_config')" href="../../_classes/lock_config.html" onMouseOver="classPopup(event,'lock_config')">lock_config</a>::<a class="function" onClick="logFunction('get_lock_factory')" href="../../_functions/get_lock_factory.html" onMouseOver="funcPopup(event,'get_lock_factory')">get_lock_factory</a>(<a class="var it25959" onMouseOver="hilite(25959)" onMouseOut="lolite()" onClick="logVariable('locktype')" href="../../_variables/locktype.html">$locktype</a>);
<a name="l291"><span class="linenum"> 291</span></a>  
<a name="l292"><span class="linenum"> 292</span></a>  <span class="comment">        // Opening the lock.</span>
<a name="l293"><span class="linenum"> 293</span></a>          <a class="var it25962" onMouseOver="hilite(25962)" onMouseOut="lolite()" onClick="logVariable('choicelock')" href="../../_variables/choicelock.html">$choicelock</a> = <a class="var it25961" onMouseOver="hilite(25961)" onMouseOut="lolite()" onClick="logVariable('lockfactory')" href="../../_variables/lockfactory.html">$lockfactory</a>-&gt;<a class="function" onClick="logFunction('get_lock')" href="../../_functions/get_lock.html" onMouseOver="funcPopup(event,'get_lock')">get_lock</a>(<a class="var it25960" onMouseOver="hilite(25960)" onMouseOut="lolite()" onClick="logVariable('resouce')" href="../../_variables/resouce.html">$resouce</a>, <a class="var it1356" onMouseOver="hilite(1356)" onMouseOut="lolite()" onClick="logVariable('timeout')" href="../../_variables/timeout.html">$timeout</a>);
<a name="l294"><span class="linenum"> 294</span></a>          if (!<a class="var it25962" onMouseOver="hilite(25962)" onMouseOut="lolite()" onClick="logVariable('choicelock')" href="../../_variables/choicelock.html">$choicelock</a>) {
<a name="l295"><span class="linenum"> 295</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('cannotsubmit', 'choice', <a class="var it434" onMouseOver="hilite(434)" onMouseOut="lolite()" onClick="logVariable('continueurl')" href="../../_variables/continueurl.html">$continueurl</a>);
<a name="l296"><span class="linenum"> 296</span></a>          }
<a name="l297"><span class="linenum"> 297</span></a>      }
<a name="l298"><span class="linenum"> 298</span></a>  
<a name="l299"><span class="linenum"> 299</span></a>      <a class="var it397" onMouseOver="hilite(397)" onMouseOut="lolite()" onClick="logVariable('current')" href="../../_variables/current.html">$current</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('choice_answers', array('choiceid' =&gt; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'userid' =&gt; <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>));
<a name="l300"><span class="linenum"> 300</span></a>      <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_module')" href="../../_classes/context_module.html" onMouseOver="classPopup(event,'context_module')">context_module</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l301"><span class="linenum"> 301</span></a>  
<a name="l302"><span class="linenum"> 302</span></a>      <a class="var it25963" onMouseOver="hilite(25963)" onMouseOut="lolite()" onClick="logVariable('choicesexceeded')" href="../../_variables/choicesexceeded.html">$choicesexceeded</a> = false;
<a name="l303"><span class="linenum"> 303</span></a>      <a class="var it24065" onMouseOver="hilite(24065)" onMouseOut="lolite()" onClick="logVariable('countanswers')" href="../../_variables/countanswers.html">$countanswers</a> = array();
<a name="l304"><span class="linenum"> 304</span></a>      foreach (<a class="var it25958" onMouseOver="hilite(25958)" onMouseOut="lolite()" onClick="logVariable('formanswers')" href="../../_variables/formanswers.html">$formanswers</a> as <a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>) {
<a name="l305"><span class="linenum"> 305</span></a>          <a class="var it24065" onMouseOver="hilite(24065)" onMouseOut="lolite()" onClick="logVariable('countanswers')" href="../../_variables/countanswers.html">$countanswers</a>[<a class="var it119" onMouseOver="hilite(119)" onMouseOut="lolite()" onClick="logVariable('val')" href="../../_variables/val.html">$val</a>] = 0;
<a name="l306"><span class="linenum"> 306</span></a>      }
<a name="l307"><span class="linenum"> 307</span></a>      if(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('limitanswers')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/limitanswers.html">limitanswers</a>) {
<a name="l308"><span class="linenum"> 308</span></a>  <span class="comment">        // Find out whether groups are being used and enabled</span>
<a name="l309"><span class="linenum"> 309</span></a>          if (<a class="function" onClick="logFunction('groups_get_activity_groupmode')" href="../../_functions/groups_get_activity_groupmode.html" onMouseOver="funcPopup(event,'groups_get_activity_groupmode')">groups_get_activity_groupmode</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>) &gt; 0) {
<a name="l310"><span class="linenum"> 310</span></a>              <a class="var it2561" onMouseOver="hilite(2561)" onMouseOut="lolite()" onClick="logVariable('currentgroup')" href="../../_variables/currentgroup.html">$currentgroup</a> = <a class="function" onClick="logFunction('groups_get_activity_group')" href="../../_functions/groups_get_activity_group.html" onMouseOver="funcPopup(event,'groups_get_activity_group')">groups_get_activity_group</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>);
<a name="l311"><span class="linenum"> 311</span></a>          } else {
<a name="l312"><span class="linenum"> 312</span></a>              <a class="var it2561" onMouseOver="hilite(2561)" onMouseOut="lolite()" onClick="logVariable('currentgroup')" href="../../_variables/currentgroup.html">$currentgroup</a> = 0;
<a name="l313"><span class="linenum"> 313</span></a>          }
<a name="l314"><span class="linenum"> 314</span></a>  
<a name="l315"><span class="linenum"> 315</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a> (<a class="var it1041" onMouseOver="hilite(1041)" onMouseOut="lolite()" onClick="logVariable('insql')" href="../../_variables/insql.html">$insql</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it25958" onMouseOver="hilite(25958)" onMouseOut="lolite()" onClick="logVariable('formanswers')" href="../../_variables/formanswers.html">$formanswers</a>, <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>);
<a name="l316"><span class="linenum"> 316</span></a>  
<a name="l317"><span class="linenum"> 317</span></a>          if(<a class="var it2561" onMouseOver="hilite(2561)" onMouseOut="lolite()" onClick="logVariable('currentgroup')" href="../../_variables/currentgroup.html">$currentgroup</a>) {
<a name="l318"><span class="linenum"> 318</span></a>  <span class="comment">            // If groups are being used, retrieve responses only for users in</span>
<a name="l319"><span class="linenum"> 319</span></a>  <span class="comment">            // current group</span>
<a name="l320"><span class="linenum"> 320</span></a>              global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l321"><span class="linenum"> 321</span></a>  
<a name="l322"><span class="linenum"> 322</span></a>              <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['groupid'] = <a class="var it2561" onMouseOver="hilite(2561)" onMouseOut="lolite()" onClick="logVariable('currentgroup')" href="../../_variables/currentgroup.html">$currentgroup</a>;
<a name="l323"><span class="linenum"> 323</span></a>              <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT ca.*
<a name="l324"><span class="linenum"> 324</span></a>                        FROM {choice_answers} ca
<a name="l325"><span class="linenum"> 325</span></a>                  INNER JOIN {groups_members} gm ON ca.userid=gm.userid
<a name="l326"><span class="linenum"> 326</span></a>                       WHERE optionid <a class="var it1041" onMouseOver="hilite(1041)" onMouseOut="lolite()" onClick="logVariable('insql')" href="../../_variables/insql.html">$insql</a>
<a name="l327"><span class="linenum"> 327</span></a>                         AND gm.groupid= :groupid&quot;;
<a name="l328"><span class="linenum"> 328</span></a>          } else {
<a name="l329"><span class="linenum"> 329</span></a>  <span class="comment">            // Groups are not used, retrieve all answers for this option ID</span>
<a name="l330"><span class="linenum"> 330</span></a>              <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT ca.*
<a name="l331"><span class="linenum"> 331</span></a>                        FROM {choice_answers} ca
<a name="l332"><span class="linenum"> 332</span></a>                       WHERE optionid <a class="var it1041" onMouseOver="hilite(1041)" onMouseOut="lolite()" onClick="logVariable('insql')" href="../../_variables/insql.html">$insql</a>&quot;;
<a name="l333"><span class="linenum"> 333</span></a>          }
<a name="l334"><span class="linenum"> 334</span></a>  
<a name="l335"><span class="linenum"> 335</span></a>          <a class="var it454" onMouseOver="hilite(454)" onMouseOut="lolite()" onClick="logVariable('answers')" href="../../_variables/answers.html">$answers</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l336"><span class="linenum"> 336</span></a>          if (<a class="var it454" onMouseOver="hilite(454)" onMouseOut="lolite()" onClick="logVariable('answers')" href="../../_variables/answers.html">$answers</a>) {
<a name="l337"><span class="linenum"> 337</span></a>              foreach (<a class="var it454" onMouseOver="hilite(454)" onMouseOut="lolite()" onClick="logVariable('answers')" href="../../_variables/answers.html">$answers</a> as <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>) { //only return enrolled users.
<a name="l338"><span class="linenum"> 338</span></a>                  if (<a class="function" onClick="logFunction('is_enrolled')" href="../../_functions/is_enrolled.html" onMouseOver="funcPopup(event,'is_enrolled')">is_enrolled</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>, <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('userid')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>, 'mod/choice:choose')) {
<a name="l339"><span class="linenum"> 339</span></a>                      <a class="var it24065" onMouseOver="hilite(24065)" onMouseOut="lolite()" onClick="logVariable('countanswers')" href="../../_variables/countanswers.html">$countanswers</a>[<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('optionid')" class="var it42992" onMouseOver="hilite(42992)" onMouseOut="lolite()" href="../../_variables/optionid.html">optionid</a>]++;
<a name="l340"><span class="linenum"> 340</span></a>                  }
<a name="l341"><span class="linenum"> 341</span></a>              }
<a name="l342"><span class="linenum"> 342</span></a>          }
<a name="l343"><span class="linenum"> 343</span></a>          foreach (<a class="var it24065" onMouseOver="hilite(24065)" onMouseOut="lolite()" onClick="logVariable('countanswers')" href="../../_variables/countanswers.html">$countanswers</a> as <a class="var it643" onMouseOver="hilite(643)" onMouseOut="lolite()" onClick="logVariable('opt')" href="../../_variables/opt.html">$opt</a> =&gt; <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a>) {
<a name="l344"><span class="linenum"> 344</span></a>              if (<a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a> &gt;= <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('maxanswers')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/maxanswers.html">maxanswers</a>[<a class="var it643" onMouseOver="hilite(643)" onMouseOut="lolite()" onClick="logVariable('opt')" href="../../_variables/opt.html">$opt</a>]) {
<a name="l345"><span class="linenum"> 345</span></a>                  <a class="var it25963" onMouseOver="hilite(25963)" onMouseOut="lolite()" onClick="logVariable('choicesexceeded')" href="../../_variables/choicesexceeded.html">$choicesexceeded</a> = true;
<a name="l346"><span class="linenum"> 346</span></a>                  break;
<a name="l347"><span class="linenum"> 347</span></a>              }
<a name="l348"><span class="linenum"> 348</span></a>          }
<a name="l349"><span class="linenum"> 349</span></a>      }
<a name="l350"><span class="linenum"> 350</span></a>  
<a name="l351"><span class="linenum"> 351</span></a>  <span class="comment">    // Check the user hasn't exceeded the maximum selections for the choice(s) they have selected.</span>
<a name="l352"><span class="linenum"> 352</span></a>      if (!(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('limitanswers')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/limitanswers.html">limitanswers</a> &amp;&amp; <a class="var it25963" onMouseOver="hilite(25963)" onMouseOut="lolite()" onClick="logVariable('choicesexceeded')" href="../../_variables/choicesexceeded.html">$choicesexceeded</a>)) {
<a name="l353"><span class="linenum"> 353</span></a>          <a class="var it25964" onMouseOver="hilite(25964)" onMouseOut="lolite()" onClick="logVariable('answersnapshots')" href="../../_variables/answersnapshots.html">$answersnapshots</a> = array();
<a name="l354"><span class="linenum"> 354</span></a>          if (<a class="var it397" onMouseOver="hilite(397)" onMouseOut="lolite()" onClick="logVariable('current')" href="../../_variables/current.html">$current</a>) {
<a name="l355"><span class="linenum"> 355</span></a>  <span class="comment">            // Update an existing answer.</span>
<a name="l356"><span class="linenum"> 356</span></a>              <a class="var it25965" onMouseOver="hilite(25965)" onMouseOut="lolite()" onClick="logVariable('existingchoices')" href="../../_variables/existingchoices.html">$existingchoices</a> = array();
<a name="l357"><span class="linenum"> 357</span></a>              foreach (<a class="var it397" onMouseOver="hilite(397)" onMouseOut="lolite()" onClick="logVariable('current')" href="../../_variables/current.html">$current</a> as <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('c')" href="../../_variables/c.html">$c</a>) {
<a name="l358"><span class="linenum"> 358</span></a>                  if (<a class="phpfunction" onClick="logFunction('in_array')" href="../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('c')" href="../../_variables/c.html">$c</a>-&gt;<a onClick="logVariable('optionid')" class="var it42990" onMouseOver="hilite(42990)" onMouseOut="lolite()" href="../../_variables/optionid.html">optionid</a>, <a class="var it25958" onMouseOver="hilite(25958)" onMouseOut="lolite()" onClick="logVariable('formanswers')" href="../../_variables/formanswers.html">$formanswers</a>)) {
<a name="l359"><span class="linenum"> 359</span></a>                      <a class="var it25965" onMouseOver="hilite(25965)" onMouseOut="lolite()" onClick="logVariable('existingchoices')" href="../../_variables/existingchoices.html">$existingchoices</a>[] = <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('c')" href="../../_variables/c.html">$c</a>-&gt;<a onClick="logVariable('optionid')" class="var it42990" onMouseOver="hilite(42990)" onMouseOut="lolite()" href="../../_variables/optionid.html">optionid</a>;
<a name="l360"><span class="linenum"> 360</span></a>                      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('choice_answers', 'timemodified', <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>(), array('id' =&gt; <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('c')" href="../../_variables/c.html">$c</a>-&gt;<a onClick="logVariable('id')" class="var it42990" onMouseOver="hilite(42990)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l361"><span class="linenum"> 361</span></a>                      <a class="var it25964" onMouseOver="hilite(25964)" onMouseOut="lolite()" onClick="logVariable('answersnapshots')" href="../../_variables/answersnapshots.html">$answersnapshots</a>[] = <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('c')" href="../../_variables/c.html">$c</a>;
<a name="l362"><span class="linenum"> 362</span></a>                  } else {
<a name="l363"><span class="linenum"> 363</span></a>                      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('choice_answers', array('id' =&gt; <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('c')" href="../../_variables/c.html">$c</a>-&gt;<a onClick="logVariable('id')" class="var it42990" onMouseOver="hilite(42990)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l364"><span class="linenum"> 364</span></a>                  }
<a name="l365"><span class="linenum"> 365</span></a>              }
<a name="l366"><span class="linenum"> 366</span></a>  
<a name="l367"><span class="linenum"> 367</span></a>  <span class="comment">            // Add new ones.</span>
<a name="l368"><span class="linenum"> 368</span></a>              foreach (<a class="var it25958" onMouseOver="hilite(25958)" onMouseOut="lolite()" onClick="logVariable('formanswers')" href="../../_variables/formanswers.html">$formanswers</a> as <a class="var it1531" onMouseOver="hilite(1531)" onMouseOut="lolite()" onClick="logVariable('f')" href="../../_variables/f.html">$f</a>) {
<a name="l369"><span class="linenum"> 369</span></a>                  if (!<a class="phpfunction" onClick="logFunction('in_array')" href="../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it1531" onMouseOver="hilite(1531)" onMouseOut="lolite()" onClick="logVariable('f')" href="../../_variables/f.html">$f</a>, <a class="var it25965" onMouseOver="hilite(25965)" onMouseOut="lolite()" onClick="logVariable('existingchoices')" href="../../_variables/existingchoices.html">$existingchoices</a>)) {
<a name="l370"><span class="linenum"> 370</span></a>                      <a class="var it10655" onMouseOver="hilite(10655)" onMouseOut="lolite()" onClick="logVariable('newanswer')" href="../../_variables/newanswer.html">$newanswer</a> = new stdClass();
<a name="l371"><span class="linenum"> 371</span></a>                      <a class="var it10655" onMouseOver="hilite(10655)" onMouseOut="lolite()" onClick="logVariable('newanswer')" href="../../_variables/newanswer.html">$newanswer</a>-&gt;<a onClick="logVariable('optionid')" class="var it44664" onMouseOver="hilite(44664)" onMouseOut="lolite()" href="../../_variables/optionid.html">optionid</a> = <a class="var it1531" onMouseOver="hilite(1531)" onMouseOut="lolite()" onClick="logVariable('f')" href="../../_variables/f.html">$f</a>;
<a name="l372"><span class="linenum"> 372</span></a>                      <a class="var it10655" onMouseOver="hilite(10655)" onMouseOut="lolite()" onClick="logVariable('newanswer')" href="../../_variables/newanswer.html">$newanswer</a>-&gt;<a onClick="logVariable('choiceid')" class="var it44664" onMouseOver="hilite(44664)" onMouseOut="lolite()" href="../../_variables/choiceid.html">choiceid</a> = <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l373"><span class="linenum"> 373</span></a>                      <a class="var it10655" onMouseOver="hilite(10655)" onMouseOut="lolite()" onClick="logVariable('newanswer')" href="../../_variables/newanswer.html">$newanswer</a>-&gt;<a onClick="logVariable('userid')" class="var it44664" onMouseOver="hilite(44664)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> = <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>;
<a name="l374"><span class="linenum"> 374</span></a>                      <a class="var it10655" onMouseOver="hilite(10655)" onMouseOut="lolite()" onClick="logVariable('newanswer')" href="../../_variables/newanswer.html">$newanswer</a>-&gt;<a onClick="logVariable('timemodified')" class="var it44664" onMouseOver="hilite(44664)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l375"><span class="linenum"> 375</span></a>                      <a class="var it10655" onMouseOver="hilite(10655)" onMouseOut="lolite()" onClick="logVariable('newanswer')" href="../../_variables/newanswer.html">$newanswer</a>-&gt;<a onClick="logVariable('id')" class="var it44664" onMouseOver="hilite(44664)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>(&quot;choice_answers&quot;, <a class="var it10655" onMouseOver="hilite(10655)" onMouseOut="lolite()" onClick="logVariable('newanswer')" href="../../_variables/newanswer.html">$newanswer</a>);
<a name="l376"><span class="linenum"> 376</span></a>                      <a class="var it25964" onMouseOver="hilite(25964)" onMouseOut="lolite()" onClick="logVariable('answersnapshots')" href="../../_variables/answersnapshots.html">$answersnapshots</a>[] = <a class="var it10655" onMouseOver="hilite(10655)" onMouseOut="lolite()" onClick="logVariable('newanswer')" href="../../_variables/newanswer.html">$newanswer</a>;
<a name="l377"><span class="linenum"> 377</span></a>                  }
<a name="l378"><span class="linenum"> 378</span></a>              }
<a name="l379"><span class="linenum"> 379</span></a>  
<a name="l380"><span class="linenum"> 380</span></a>  <span class="comment">            // Initialised as true, meaning we updated the answer.</span>
<a name="l381"><span class="linenum"> 381</span></a>              <a class="var it25966" onMouseOver="hilite(25966)" onMouseOut="lolite()" onClick="logVariable('answerupdated')" href="../../_variables/answerupdated.html">$answerupdated</a> = true;
<a name="l382"><span class="linenum"> 382</span></a>          } else {
<a name="l383"><span class="linenum"> 383</span></a>  <span class="comment">            // Add new answer.</span>
<a name="l384"><span class="linenum"> 384</span></a>              foreach (<a class="var it25958" onMouseOver="hilite(25958)" onMouseOut="lolite()" onClick="logVariable('formanswers')" href="../../_variables/formanswers.html">$formanswers</a> as <a class="var it2951" onMouseOver="hilite(2951)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../_variables/answer.html">$answer</a>) {
<a name="l385"><span class="linenum"> 385</span></a>                  <a class="var it10655" onMouseOver="hilite(10655)" onMouseOut="lolite()" onClick="logVariable('newanswer')" href="../../_variables/newanswer.html">$newanswer</a> = new stdClass();
<a name="l386"><span class="linenum"> 386</span></a>                  <a class="var it10655" onMouseOver="hilite(10655)" onMouseOut="lolite()" onClick="logVariable('newanswer')" href="../../_variables/newanswer.html">$newanswer</a>-&gt;<a onClick="logVariable('choiceid')" class="var it44664" onMouseOver="hilite(44664)" onMouseOut="lolite()" href="../../_variables/choiceid.html">choiceid</a> = <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l387"><span class="linenum"> 387</span></a>                  <a class="var it10655" onMouseOver="hilite(10655)" onMouseOut="lolite()" onClick="logVariable('newanswer')" href="../../_variables/newanswer.html">$newanswer</a>-&gt;<a onClick="logVariable('userid')" class="var it44664" onMouseOver="hilite(44664)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> = <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>;
<a name="l388"><span class="linenum"> 388</span></a>                  <a class="var it10655" onMouseOver="hilite(10655)" onMouseOut="lolite()" onClick="logVariable('newanswer')" href="../../_variables/newanswer.html">$newanswer</a>-&gt;<a onClick="logVariable('optionid')" class="var it44664" onMouseOver="hilite(44664)" onMouseOut="lolite()" href="../../_variables/optionid.html">optionid</a> = <a class="var it2951" onMouseOver="hilite(2951)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../_variables/answer.html">$answer</a>;
<a name="l389"><span class="linenum"> 389</span></a>                  <a class="var it10655" onMouseOver="hilite(10655)" onMouseOut="lolite()" onClick="logVariable('newanswer')" href="../../_variables/newanswer.html">$newanswer</a>-&gt;<a onClick="logVariable('timemodified')" class="var it44664" onMouseOver="hilite(44664)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l390"><span class="linenum"> 390</span></a>                  <a class="var it10655" onMouseOver="hilite(10655)" onMouseOut="lolite()" onClick="logVariable('newanswer')" href="../../_variables/newanswer.html">$newanswer</a>-&gt;<a onClick="logVariable('id')" class="var it44664" onMouseOver="hilite(44664)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>(&quot;choice_answers&quot;, <a class="var it10655" onMouseOver="hilite(10655)" onMouseOut="lolite()" onClick="logVariable('newanswer')" href="../../_variables/newanswer.html">$newanswer</a>);
<a name="l391"><span class="linenum"> 391</span></a>                  <a class="var it25964" onMouseOver="hilite(25964)" onMouseOut="lolite()" onClick="logVariable('answersnapshots')" href="../../_variables/answersnapshots.html">$answersnapshots</a>[] = <a class="var it10655" onMouseOver="hilite(10655)" onMouseOut="lolite()" onClick="logVariable('newanswer')" href="../../_variables/newanswer.html">$newanswer</a>;
<a name="l392"><span class="linenum"> 392</span></a>              }
<a name="l393"><span class="linenum"> 393</span></a>  
<a name="l394"><span class="linenum"> 394</span></a>  <span class="comment">            // Update completion state</span>
<a name="l395"><span class="linenum"> 395</span></a>              <a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a> = <span class="keyword">new </span><a class="class" onClick="logClass('completion_info')" href="../../_classes/completion_info.html" onMouseOver="classPopup(event,'completion_info')">completion_info</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>);
<a name="l396"><span class="linenum"> 396</span></a>              if (<a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a>-&gt;<a class="function" onClick="logFunction('is_enabled')" href="../../_functions/is_enabled.html" onMouseOver="funcPopup(event,'is_enabled')">is_enabled</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>) &amp;&amp; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('completionsubmit')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/completionsubmit.html">completionsubmit</a>) {
<a name="l397"><span class="linenum"> 397</span></a>                  <a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a>-&gt;<a class="function" onClick="logFunction('update_state')" href="../../_functions/update_state.html" onMouseOver="funcPopup(event,'update_state')">update_state</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="constant" onClick="logConstant('COMPLETION_COMPLETE')" href="../../_constants/COMPLETION_COMPLETE.html" onMouseOver="constPopup(event,'COMPLETION_COMPLETE')">COMPLETION_COMPLETE</a>);
<a name="l398"><span class="linenum"> 398</span></a>              }
<a name="l399"><span class="linenum"> 399</span></a>  
<a name="l400"><span class="linenum"> 400</span></a>  <span class="comment">            // Initalised as false, meaning we submitted a new answer.</span>
<a name="l401"><span class="linenum"> 401</span></a>              <a class="var it25966" onMouseOver="hilite(25966)" onMouseOut="lolite()" onClick="logVariable('answerupdated')" href="../../_variables/answerupdated.html">$answerupdated</a> = false;
<a name="l402"><span class="linenum"> 402</span></a>          }
<a name="l403"><span class="linenum"> 403</span></a>      } else {
<a name="l404"><span class="linenum"> 404</span></a>  <span class="comment">        // Check to see if current choice already selected - if not display error.</span>
<a name="l405"><span class="linenum"> 405</span></a>          <a class="var it25967" onMouseOver="hilite(25967)" onMouseOut="lolite()" onClick="logVariable('currentids')" href="../../_variables/currentids.html">$currentids</a> = <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it397" onMouseOver="hilite(397)" onMouseOut="lolite()" onClick="logVariable('current')" href="../../_variables/current.html">$current</a>);
<a name="l406"><span class="linenum"> 406</span></a>  
<a name="l407"><span class="linenum"> 407</span></a>          if (<a class="phpfunction" onClick="logFunction('array_diff')" href="../../_functions/array_diff.html" onMouseOver="phpfuncPopup(event,'array_diff')">array_diff</a>(<a class="var it25967" onMouseOver="hilite(25967)" onMouseOut="lolite()" onClick="logVariable('currentids')" href="../../_variables/currentids.html">$currentids</a>, <a class="var it25958" onMouseOver="hilite(25958)" onMouseOut="lolite()" onClick="logVariable('formanswers')" href="../../_variables/formanswers.html">$formanswers</a>) || <a class="phpfunction" onClick="logFunction('array_diff')" href="../../_functions/array_diff.html" onMouseOver="phpfuncPopup(event,'array_diff')">array_diff</a>(<a class="var it25958" onMouseOver="hilite(25958)" onMouseOut="lolite()" onClick="logVariable('formanswers')" href="../../_variables/formanswers.html">$formanswers</a>, <a class="var it25967" onMouseOver="hilite(25967)" onMouseOut="lolite()" onClick="logVariable('currentids')" href="../../_variables/currentids.html">$currentids</a>) ) {
<a name="l408"><span class="linenum"> 408</span></a>  <span class="comment">            // Release lock before error.</span>
<a name="l409"><span class="linenum"> 409</span></a>              <a class="var it25962" onMouseOver="hilite(25962)" onMouseOut="lolite()" onClick="logVariable('choicelock')" href="../../_variables/choicelock.html">$choicelock</a>-&gt;<a class="function" onClick="logFunction('release')" href="../../_functions/release.html" onMouseOver="funcPopup(event,'release')">release</a>();
<a name="l410"><span class="linenum"> 410</span></a>              <a class="function" onClick="logFunction('print_error')" href="../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('choicefull', 'choice', <a class="var it434" onMouseOver="hilite(434)" onMouseOut="lolite()" onClick="logVariable('continueurl')" href="../../_variables/continueurl.html">$continueurl</a>);
<a name="l411"><span class="linenum"> 411</span></a>          }
<a name="l412"><span class="linenum"> 412</span></a>      }
<a name="l413"><span class="linenum"> 413</span></a>  
<a name="l414"><span class="linenum"> 414</span></a>  <span class="comment">    // Release lock.</span>
<a name="l415"><span class="linenum"> 415</span></a>      if (isset(<a class="var it25962" onMouseOver="hilite(25962)" onMouseOut="lolite()" onClick="logVariable('choicelock')" href="../../_variables/choicelock.html">$choicelock</a>)) {
<a name="l416"><span class="linenum"> 416</span></a>          <a class="var it25962" onMouseOver="hilite(25962)" onMouseOut="lolite()" onClick="logVariable('choicelock')" href="../../_variables/choicelock.html">$choicelock</a>-&gt;<a class="function" onClick="logFunction('release')" href="../../_functions/release.html" onMouseOver="funcPopup(event,'release')">release</a>();
<a name="l417"><span class="linenum"> 417</span></a>      }
<a name="l418"><span class="linenum"> 418</span></a>  
<a name="l419"><span class="linenum"> 419</span></a>  <span class="comment">    // Now record completed event.</span>
<a name="l420"><span class="linenum"> 420</span></a>      if (isset(<a class="var it25966" onMouseOver="hilite(25966)" onMouseOut="lolite()" onClick="logVariable('answerupdated')" href="../../_variables/answerupdated.html">$answerupdated</a>)) {
<a name="l421"><span class="linenum"> 421</span></a>          <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a> = array();
<a name="l422"><span class="linenum"> 422</span></a>          <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>['context'] = <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>;
<a name="l423"><span class="linenum"> 423</span></a>          <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>['objectid'] = <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l424"><span class="linenum"> 424</span></a>          <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>['userid'] = <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>;
<a name="l425"><span class="linenum"> 425</span></a>          <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>['courseid'] = <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l426"><span class="linenum"> 426</span></a>          <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>['other'] = array();
<a name="l427"><span class="linenum"> 427</span></a>          <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>['other']['choiceid'] = <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l428"><span class="linenum"> 428</span></a>  
<a name="l429"><span class="linenum"> 429</span></a>          if (<a class="var it25966" onMouseOver="hilite(25966)" onMouseOut="lolite()" onClick="logVariable('answerupdated')" href="../../_variables/answerupdated.html">$answerupdated</a>) {
<a name="l430"><span class="linenum"> 430</span></a>              <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>['other']['optionid'] = <a class="var it25957" onMouseOver="hilite(25957)" onMouseOut="lolite()" onClick="logVariable('formanswer')" href="../../_variables/formanswer.html">$formanswer</a>;
<a name="l431"><span class="linenum"> 431</span></a>              <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a> = \mod_choice\event\<a class="class" onClick="logClass('answer_updated')" href="../../_classes/answer_updated.html" onMouseOver="classPopup(event,'answer_updated')">answer_updated</a>::<a class="function" onClick="logFunction('create')" href="../../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(<a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>);
<a name="l432"><span class="linenum"> 432</span></a>          } else {
<a name="l433"><span class="linenum"> 433</span></a>              <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>['other']['optionid'] = <a class="var it25958" onMouseOver="hilite(25958)" onMouseOut="lolite()" onClick="logVariable('formanswers')" href="../../_variables/formanswers.html">$formanswers</a>;
<a name="l434"><span class="linenum"> 434</span></a>              <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a> = \mod_choice\event\<a class="class" onClick="logClass('answer_submitted')" href="../../_classes/answer_submitted.html" onMouseOver="classPopup(event,'answer_submitted')">answer_submitted</a>::<a class="function" onClick="logFunction('create')" href="../../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(<a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>);
<a name="l435"><span class="linenum"> 435</span></a>          }
<a name="l436"><span class="linenum"> 436</span></a>          <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('course', <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>);
<a name="l437"><span class="linenum"> 437</span></a>          <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('course_modules', <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>);
<a name="l438"><span class="linenum"> 438</span></a>          <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('choice', <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>);
<a name="l439"><span class="linenum"> 439</span></a>          foreach (<a class="var it25964" onMouseOver="hilite(25964)" onMouseOut="lolite()" onClick="logVariable('answersnapshots')" href="../../_variables/answersnapshots.html">$answersnapshots</a> as <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>) {
<a name="l440"><span class="linenum"> 440</span></a>              <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('choice_answers', <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>);
<a name="l441"><span class="linenum"> 441</span></a>          }
<a name="l442"><span class="linenum"> 442</span></a>          <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l443"><span class="linenum"> 443</span></a>      }
<a name="l444"><span class="linenum"> 444</span></a>  }
<a name="l445"><span class="linenum"> 445</span></a>  
<a name="l446"><span class="linenum"> 446</span></a>  <span class="comment">/**</span>
<a name="l447"><span class="linenum"> 447</span></a>  <span class="comment"> * @param array $user</span>
<a name="l448"><span class="linenum"> 448</span></a>  <span class="comment"> * @param object $cm</span>
<a name="l449"><span class="linenum"> 449</span></a>  <span class="comment"> * @return void Output is echo'd</span>
<a name="l450"><span class="linenum"> 450</span></a>  <span class="comment"> */</span>
<a name="l451"><span class="linenum"> 451</span></a>  function <a class="function" onClick="logFunction('choice_show_reportlink')" href="../../_functions/choice_show_reportlink.html" onMouseOver="funcPopup(event,'choice_show_reportlink')">choice_show_reportlink</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>) {
<a name="l452"><span class="linenum"> 452</span></a>      <a class="var it25968" onMouseOver="hilite(25968)" onMouseOut="lolite()" onClick="logVariable('userschosen')" href="../../_variables/userschosen.html">$userschosen</a> = array();
<a name="l453"><span class="linenum"> 453</span></a>      foreach(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a> as <a class="var it6606" onMouseOver="hilite(6606)" onMouseOut="lolite()" onClick="logVariable('optionid')" href="../../_variables/optionid.html">$optionid</a> =&gt; <a class="var it1811" onMouseOver="hilite(1811)" onMouseOut="lolite()" onClick="logVariable('userlist')" href="../../_variables/userlist.html">$userlist</a>) {
<a name="l454"><span class="linenum"> 454</span></a>          if (<a class="var it6606" onMouseOver="hilite(6606)" onMouseOut="lolite()" onClick="logVariable('optionid')" href="../../_variables/optionid.html">$optionid</a>) {
<a name="l455"><span class="linenum"> 455</span></a>              <a class="var it25968" onMouseOver="hilite(25968)" onMouseOut="lolite()" onClick="logVariable('userschosen')" href="../../_variables/userschosen.html">$userschosen</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it25968" onMouseOver="hilite(25968)" onMouseOut="lolite()" onClick="logVariable('userschosen')" href="../../_variables/userschosen.html">$userschosen</a>, <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it1811" onMouseOver="hilite(1811)" onMouseOut="lolite()" onClick="logVariable('userlist')" href="../../_variables/userlist.html">$userlist</a>));
<a name="l456"><span class="linenum"> 456</span></a>          }
<a name="l457"><span class="linenum"> 457</span></a>      }
<a name="l458"><span class="linenum"> 458</span></a>      <a class="var it25969" onMouseOver="hilite(25969)" onMouseOut="lolite()" onClick="logVariable('responsecount')" href="../../_variables/responsecount.html">$responsecount</a> = <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="phpfunction" onClick="logFunction('array_unique')" href="../../_functions/array_unique.html" onMouseOver="phpfuncPopup(event,'array_unique')">array_unique</a>(<a class="var it25968" onMouseOver="hilite(25968)" onMouseOut="lolite()" onClick="logVariable('userschosen')" href="../../_variables/userschosen.html">$userschosen</a>));
<a name="l459"><span class="linenum"> 459</span></a>  
<a name="l460"><span class="linenum"> 460</span></a>      echo '&lt;div class=&quot;reportlink&quot;&gt;';
<a name="l461"><span class="linenum"> 461</span></a>      echo &quot;&lt;a href=\&quot;report.php?id=<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>\&quot;&gt;&quot;.<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;viewallresponses&quot;, &quot;choice&quot;, <a class="var it25969" onMouseOver="hilite(25969)" onMouseOut="lolite()" onClick="logVariable('responsecount')" href="../../_variables/responsecount.html">$responsecount</a>).&quot;&lt;/a&gt;&quot;;
<a name="l462"><span class="linenum"> 462</span></a>      echo '&lt;/div&gt;';
<a name="l463"><span class="linenum"> 463</span></a>  }
<a name="l464"><span class="linenum"> 464</span></a>  
<a name="l465"><span class="linenum"> 465</span></a>  <span class="comment">/**</span>
<a name="l466"><span class="linenum"> 466</span></a>  <span class="comment"> * @global object</span>
<a name="l467"><span class="linenum"> 467</span></a>  <span class="comment"> * @param object $choice</span>
<a name="l468"><span class="linenum"> 468</span></a>  <span class="comment"> * @param object $course</span>
<a name="l469"><span class="linenum"> 469</span></a>  <span class="comment"> * @param object $coursemodule</span>
<a name="l470"><span class="linenum"> 470</span></a>  <span class="comment"> * @param array $allresponses</span>
<a name="l471"><span class="linenum"> 471</span></a>  <span class="comment"></span>
<a name="l472"><span class="linenum"> 472</span></a>  <span class="comment"> *  * @param bool $allresponses</span>
<a name="l473"><span class="linenum"> 473</span></a>  <span class="comment"> * @return object</span>
<a name="l474"><span class="linenum"> 474</span></a>  <span class="comment"> */</span>
<a name="l475"><span class="linenum"> 475</span></a>  function <a class="function" onClick="logFunction('prepare_choice_show_results')" href="../../_functions/prepare_choice_show_results.html" onMouseOver="funcPopup(event,'prepare_choice_show_results')">prepare_choice_show_results</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="var it24060" onMouseOver="hilite(24060)" onMouseOut="lolite()" onClick="logVariable('allresponses')" href="../../_variables/allresponses.html">$allresponses</a>) {
<a name="l476"><span class="linenum"> 476</span></a>      global <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>;
<a name="l477"><span class="linenum"> 477</span></a>  
<a name="l478"><span class="linenum"> 478</span></a>      <a class="var it1467" onMouseOver="hilite(1467)" onMouseOut="lolite()" onClick="logVariable('display')" href="../../_variables/display.html">$display</a> = <a class="function" onClick="logFunction('clone')" href="../../_functions/clone.html" onMouseOver="funcPopup(event,'clone')">clone</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>);
<a name="l479"><span class="linenum"> 479</span></a>      <a class="var it1467" onMouseOver="hilite(1467)" onMouseOut="lolite()" onClick="logVariable('display')" href="../../_variables/display.html">$display</a>-&gt;<a onClick="logVariable('coursemoduleid')" class="var it44665" onMouseOver="hilite(44665)" onMouseOut="lolite()" href="../../_variables/coursemoduleid.html">coursemoduleid</a> = <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l480"><span class="linenum"> 480</span></a>      <a class="var it1467" onMouseOver="hilite(1467)" onMouseOut="lolite()" onClick="logVariable('display')" href="../../_variables/display.html">$display</a>-&gt;<a onClick="logVariable('courseid')" class="var it44665" onMouseOver="hilite(44665)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a> = <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l481"><span class="linenum"> 481</span></a>  
<a name="l482"><span class="linenum"> 482</span></a>  <span class="comment">    //overwrite options value;</span>
<a name="l483"><span class="linenum"> 483</span></a>      <a class="var it1467" onMouseOver="hilite(1467)" onMouseOut="lolite()" onClick="logVariable('display')" href="../../_variables/display.html">$display</a>-&gt;<a onClick="logVariable('options')" class="var it44665" onMouseOver="hilite(44665)" onMouseOut="lolite()" href="../../_variables/options.html">options</a> = array();
<a name="l484"><span class="linenum"> 484</span></a>      <a class="var it24803" onMouseOver="hilite(24803)" onMouseOut="lolite()" onClick="logVariable('allusers')" href="../../_variables/allusers.html">$allusers</a> = [];
<a name="l485"><span class="linenum"> 485</span></a>      foreach (<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('option')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/option.html">option</a> as <a class="var it6606" onMouseOver="hilite(6606)" onMouseOut="lolite()" onClick="logVariable('optionid')" href="../../_variables/optionid.html">$optionid</a> =&gt; <a class="var it25970" onMouseOver="hilite(25970)" onMouseOut="lolite()" onClick="logVariable('optiontext')" href="../../_variables/optiontext.html">$optiontext</a>) {
<a name="l486"><span class="linenum"> 486</span></a>          <a class="var it1467" onMouseOver="hilite(1467)" onMouseOut="lolite()" onClick="logVariable('display')" href="../../_variables/display.html">$display</a>-&gt;<a onClick="logVariable('options')" class="var it44665" onMouseOver="hilite(44665)" onMouseOut="lolite()" href="../../_variables/options.html">options</a>[<a class="var it6606" onMouseOver="hilite(6606)" onMouseOut="lolite()" onClick="logVariable('optionid')" href="../../_variables/optionid.html">$optionid</a>] = new stdClass;
<a name="l487"><span class="linenum"> 487</span></a>          <a class="var it1467" onMouseOver="hilite(1467)" onMouseOut="lolite()" onClick="logVariable('display')" href="../../_variables/display.html">$display</a>-&gt;<a onClick="logVariable('options')" class="var it44665" onMouseOver="hilite(44665)" onMouseOut="lolite()" href="../../_variables/options.html">options</a>[<a class="var it6606" onMouseOver="hilite(6606)" onMouseOut="lolite()" onClick="logVariable('optionid')" href="../../_variables/optionid.html">$optionid</a>]-&gt;text = <a class="var it25970" onMouseOver="hilite(25970)" onMouseOut="lolite()" onClick="logVariable('optiontext')" href="../../_variables/optiontext.html">$optiontext</a>;
<a name="l488"><span class="linenum"> 488</span></a>          <a class="var it1467" onMouseOver="hilite(1467)" onMouseOut="lolite()" onClick="logVariable('display')" href="../../_variables/display.html">$display</a>-&gt;<a onClick="logVariable('options')" class="var it44665" onMouseOver="hilite(44665)" onMouseOut="lolite()" href="../../_variables/options.html">options</a>[<a class="var it6606" onMouseOver="hilite(6606)" onMouseOut="lolite()" onClick="logVariable('optionid')" href="../../_variables/optionid.html">$optionid</a>]-&gt;maxanswer = <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('maxanswers')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/maxanswers.html">maxanswers</a>[<a class="var it6606" onMouseOver="hilite(6606)" onMouseOut="lolite()" onClick="logVariable('optionid')" href="../../_variables/optionid.html">$optionid</a>];
<a name="l489"><span class="linenum"> 489</span></a>  
<a name="l490"><span class="linenum"> 490</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it6606" onMouseOver="hilite(6606)" onMouseOut="lolite()" onClick="logVariable('optionid')" href="../../_variables/optionid.html">$optionid</a>, <a class="var it24060" onMouseOver="hilite(24060)" onMouseOut="lolite()" onClick="logVariable('allresponses')" href="../../_variables/allresponses.html">$allresponses</a>)) {
<a name="l491"><span class="linenum"> 491</span></a>              <a class="var it1467" onMouseOver="hilite(1467)" onMouseOut="lolite()" onClick="logVariable('display')" href="../../_variables/display.html">$display</a>-&gt;<a onClick="logVariable('options')" class="var it44665" onMouseOver="hilite(44665)" onMouseOut="lolite()" href="../../_variables/options.html">options</a>[<a class="var it6606" onMouseOver="hilite(6606)" onMouseOut="lolite()" onClick="logVariable('optionid')" href="../../_variables/optionid.html">$optionid</a>]-&gt;user = <a class="var it24060" onMouseOver="hilite(24060)" onMouseOut="lolite()" onClick="logVariable('allresponses')" href="../../_variables/allresponses.html">$allresponses</a>[<a class="var it6606" onMouseOver="hilite(6606)" onMouseOut="lolite()" onClick="logVariable('optionid')" href="../../_variables/optionid.html">$optionid</a>];
<a name="l492"><span class="linenum"> 492</span></a>              <a class="var it24803" onMouseOver="hilite(24803)" onMouseOut="lolite()" onClick="logVariable('allusers')" href="../../_variables/allusers.html">$allusers</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it24803" onMouseOver="hilite(24803)" onMouseOut="lolite()" onClick="logVariable('allusers')" href="../../_variables/allusers.html">$allusers</a>, <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it24060" onMouseOver="hilite(24060)" onMouseOut="lolite()" onClick="logVariable('allresponses')" href="../../_variables/allresponses.html">$allresponses</a>[<a class="var it6606" onMouseOver="hilite(6606)" onMouseOut="lolite()" onClick="logVariable('optionid')" href="../../_variables/optionid.html">$optionid</a>]));
<a name="l493"><span class="linenum"> 493</span></a>          }
<a name="l494"><span class="linenum"> 494</span></a>      }
<a name="l495"><span class="linenum"> 495</span></a>      unset(<a class="var it1467" onMouseOver="hilite(1467)" onMouseOut="lolite()" onClick="logVariable('display')" href="../../_variables/display.html">$display</a>-&gt;<a onClick="logVariable('option')" class="var it44665" onMouseOver="hilite(44665)" onMouseOut="lolite()" href="../../_variables/option.html">option</a>);
<a name="l496"><span class="linenum"> 496</span></a>      unset(<a class="var it1467" onMouseOver="hilite(1467)" onMouseOut="lolite()" onClick="logVariable('display')" href="../../_variables/display.html">$display</a>-&gt;<a onClick="logVariable('maxanswers')" class="var it44665" onMouseOver="hilite(44665)" onMouseOut="lolite()" href="../../_variables/maxanswers.html">maxanswers</a>);
<a name="l497"><span class="linenum"> 497</span></a>  
<a name="l498"><span class="linenum"> 498</span></a>      <a class="var it1467" onMouseOver="hilite(1467)" onMouseOut="lolite()" onClick="logVariable('display')" href="../../_variables/display.html">$display</a>-&gt;<a onClick="logVariable('numberofuser')" class="var it44665" onMouseOver="hilite(44665)" onMouseOut="lolite()" href="../../_variables/numberofuser.html">numberofuser</a> = <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="phpfunction" onClick="logFunction('array_unique')" href="../../_functions/array_unique.html" onMouseOver="phpfuncPopup(event,'array_unique')">array_unique</a>(<a class="var it24803" onMouseOver="hilite(24803)" onMouseOut="lolite()" onClick="logVariable('allusers')" href="../../_variables/allusers.html">$allusers</a>));
<a name="l499"><span class="linenum"> 499</span></a>      <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_module')" href="../../_classes/context_module.html" onMouseOver="classPopup(event,'context_module')">context_module</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l500"><span class="linenum"> 500</span></a>      <a class="var it1467" onMouseOver="hilite(1467)" onMouseOut="lolite()" onClick="logVariable('display')" href="../../_variables/display.html">$display</a>-&gt;<a onClick="logVariable('viewresponsecapability')" class="var it44665" onMouseOver="hilite(44665)" onMouseOut="lolite()" href="../../_variables/viewresponsecapability.html">viewresponsecapability</a> = <a class="function" onClick="logFunction('has_capability')" href="../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('mod/choice:readresponses', <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l501"><span class="linenum"> 501</span></a>      <a class="var it1467" onMouseOver="hilite(1467)" onMouseOut="lolite()" onClick="logVariable('display')" href="../../_variables/display.html">$display</a>-&gt;<a onClick="logVariable('deleterepsonsecapability')" class="var it44665" onMouseOver="hilite(44665)" onMouseOut="lolite()" href="../../_variables/deleterepsonsecapability.html">deleterepsonsecapability</a> = <a class="function" onClick="logFunction('has_capability')" href="../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('mod/choice:deleteresponses',<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l502"><span class="linenum"> 502</span></a>      <a class="var it1467" onMouseOver="hilite(1467)" onMouseOut="lolite()" onClick="logVariable('display')" href="../../_variables/display.html">$display</a>-&gt;<a onClick="logVariable('fullnamecapability')" class="var it44665" onMouseOver="hilite(44665)" onMouseOut="lolite()" href="../../_variables/fullnamecapability.html">fullnamecapability</a> = <a class="function" onClick="logFunction('has_capability')" href="../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/site:viewfullnames', <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l503"><span class="linenum"> 503</span></a>  
<a name="l504"><span class="linenum"> 504</span></a>      if (empty(<a class="var it24060" onMouseOver="hilite(24060)" onMouseOut="lolite()" onClick="logVariable('allresponses')" href="../../_variables/allresponses.html">$allresponses</a>)) {
<a name="l505"><span class="linenum"> 505</span></a>          echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('heading')" href="../../_functions/heading.html" onMouseOver="funcPopup(event,'heading')">heading</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;nousersyet&quot;), 3, null);
<a name="l506"><span class="linenum"> 506</span></a>          return false;
<a name="l507"><span class="linenum"> 507</span></a>      }
<a name="l508"><span class="linenum"> 508</span></a>  
<a name="l509"><span class="linenum"> 509</span></a>      return <a class="var it1467" onMouseOver="hilite(1467)" onMouseOut="lolite()" onClick="logVariable('display')" href="../../_variables/display.html">$display</a>;
<a name="l510"><span class="linenum"> 510</span></a>  }
<a name="l511"><span class="linenum"> 511</span></a>  
<a name="l512"><span class="linenum"> 512</span></a>  <span class="comment">/**</span>
<a name="l513"><span class="linenum"> 513</span></a>  <span class="comment"> * @global object</span>
<a name="l514"><span class="linenum"> 514</span></a>  <span class="comment"> * @param array $attemptids</span>
<a name="l515"><span class="linenum"> 515</span></a>  <span class="comment"> * @param object $choice Choice main table row</span>
<a name="l516"><span class="linenum"> 516</span></a>  <span class="comment"> * @param object $cm Course-module object</span>
<a name="l517"><span class="linenum"> 517</span></a>  <span class="comment"> * @param object $course Course object</span>
<a name="l518"><span class="linenum"> 518</span></a>  <span class="comment"> * @return bool</span>
<a name="l519"><span class="linenum"> 519</span></a>  <span class="comment"> */</span>
<a name="l520"><span class="linenum"> 520</span></a>  function <a class="function" onClick="logFunction('choice_delete_responses')" href="../../_functions/choice_delete_responses.html" onMouseOver="funcPopup(event,'choice_delete_responses')">choice_delete_responses</a>(<a class="var it5514" onMouseOver="hilite(5514)" onMouseOut="lolite()" onClick="logVariable('attemptids')" href="../../_variables/attemptids.html">$attemptids</a>, <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>) {
<a name="l521"><span class="linenum"> 521</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>;
<a name="l522"><span class="linenum"> 522</span></a>      require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a>.'/completionlib.php');
<a name="l523"><span class="linenum"> 523</span></a>  
<a name="l524"><span class="linenum"> 524</span></a>      if(!<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it5514" onMouseOver="hilite(5514)" onMouseOut="lolite()" onClick="logVariable('attemptids')" href="../../_variables/attemptids.html">$attemptids</a>) || empty(<a class="var it5514" onMouseOver="hilite(5514)" onMouseOut="lolite()" onClick="logVariable('attemptids')" href="../../_variables/attemptids.html">$attemptids</a>)) {
<a name="l525"><span class="linenum"> 525</span></a>          return false;
<a name="l526"><span class="linenum"> 526</span></a>      }
<a name="l527"><span class="linenum"> 527</span></a>  
<a name="l528"><span class="linenum"> 528</span></a>      foreach(<a class="var it5514" onMouseOver="hilite(5514)" onMouseOut="lolite()" onClick="logVariable('attemptids')" href="../../_variables/attemptids.html">$attemptids</a> as <a class="var it1844" onMouseOver="hilite(1844)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a> =&gt; <a class="var it531" onMouseOver="hilite(531)" onMouseOut="lolite()" onClick="logVariable('attemptid')" href="../../_variables/attemptid.html">$attemptid</a>) {
<a name="l529"><span class="linenum"> 529</span></a>          if(empty(<a class="var it531" onMouseOver="hilite(531)" onMouseOut="lolite()" onClick="logVariable('attemptid')" href="../../_variables/attemptid.html">$attemptid</a>)) {
<a name="l530"><span class="linenum"> 530</span></a>              unset(<a class="var it5514" onMouseOver="hilite(5514)" onMouseOut="lolite()" onClick="logVariable('attemptids')" href="../../_variables/attemptids.html">$attemptids</a>[<a class="var it1844" onMouseOver="hilite(1844)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a>]);
<a name="l531"><span class="linenum"> 531</span></a>          }
<a name="l532"><span class="linenum"> 532</span></a>      }
<a name="l533"><span class="linenum"> 533</span></a>  
<a name="l534"><span class="linenum"> 534</span></a>      <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_module')" href="../../_classes/context_module.html" onMouseOver="classPopup(event,'context_module')">context_module</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l535"><span class="linenum"> 535</span></a>      <a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a> = <span class="keyword">new </span><a class="class" onClick="logClass('completion_info')" href="../../_classes/completion_info.html" onMouseOver="classPopup(event,'completion_info')">completion_info</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>);
<a name="l536"><span class="linenum"> 536</span></a>      foreach(<a class="var it5514" onMouseOver="hilite(5514)" onMouseOut="lolite()" onClick="logVariable('attemptids')" href="../../_variables/attemptids.html">$attemptids</a> as <a class="var it531" onMouseOver="hilite(531)" onMouseOut="lolite()" onClick="logVariable('attemptid')" href="../../_variables/attemptid.html">$attemptid</a>) {
<a name="l537"><span class="linenum"> 537</span></a>          if (<a class="var it9224" onMouseOver="hilite(9224)" onMouseOut="lolite()" onClick="logVariable('todelete')" href="../../_variables/todelete.html">$todelete</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('choice_answers', array('choiceid' =&gt; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'id' =&gt; <a class="var it531" onMouseOver="hilite(531)" onMouseOut="lolite()" onClick="logVariable('attemptid')" href="../../_variables/attemptid.html">$attemptid</a>))) {
<a name="l538"><span class="linenum"> 538</span></a>  <span class="comment">            // Trigger the event answer deleted.</span>
<a name="l539"><span class="linenum"> 539</span></a>              <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a> = array();
<a name="l540"><span class="linenum"> 540</span></a>              <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>['objectid'] = <a class="var it9224" onMouseOver="hilite(9224)" onMouseOut="lolite()" onClick="logVariable('todelete')" href="../../_variables/todelete.html">$todelete</a>-&gt;<a onClick="logVariable('id')" class="var it44666" onMouseOver="hilite(44666)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l541"><span class="linenum"> 541</span></a>              <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>['context'] = <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>;
<a name="l542"><span class="linenum"> 542</span></a>              <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>['userid'] = <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l543"><span class="linenum"> 543</span></a>              <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>['courseid'] = <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l544"><span class="linenum"> 544</span></a>              <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>['relateduserid'] = <a class="var it9224" onMouseOver="hilite(9224)" onMouseOut="lolite()" onClick="logVariable('todelete')" href="../../_variables/todelete.html">$todelete</a>-&gt;<a onClick="logVariable('userid')" class="var it44666" onMouseOver="hilite(44666)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>;
<a name="l545"><span class="linenum"> 545</span></a>              <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>['other'] = array();
<a name="l546"><span class="linenum"> 546</span></a>              <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>['other']['choiceid'] = <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l547"><span class="linenum"> 547</span></a>              <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>['other']['optionid'] = <a class="var it9224" onMouseOver="hilite(9224)" onMouseOut="lolite()" onClick="logVariable('todelete')" href="../../_variables/todelete.html">$todelete</a>-&gt;<a onClick="logVariable('optionid')" class="var it44666" onMouseOver="hilite(44666)" onMouseOut="lolite()" href="../../_variables/optionid.html">optionid</a>;
<a name="l548"><span class="linenum"> 548</span></a>              <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a> = \mod_choice\event\<a class="class" onClick="logClass('answer_deleted')" href="../../_classes/answer_deleted.html" onMouseOver="classPopup(event,'answer_deleted')">answer_deleted</a>::<a class="function" onClick="logFunction('create')" href="../../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(<a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../_variables/eventdata.html">$eventdata</a>);
<a name="l549"><span class="linenum"> 549</span></a>              <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('course', <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>);
<a name="l550"><span class="linenum"> 550</span></a>              <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('course_modules', <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>);
<a name="l551"><span class="linenum"> 551</span></a>              <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('choice', <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>);
<a name="l552"><span class="linenum"> 552</span></a>              <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('choice_answers', <a class="var it9224" onMouseOver="hilite(9224)" onMouseOut="lolite()" onClick="logVariable('todelete')" href="../../_variables/todelete.html">$todelete</a>);
<a name="l553"><span class="linenum"> 553</span></a>              <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l554"><span class="linenum"> 554</span></a>  
<a name="l555"><span class="linenum"> 555</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('choice_answers', array('choiceid' =&gt; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'id' =&gt; <a class="var it531" onMouseOver="hilite(531)" onMouseOut="lolite()" onClick="logVariable('attemptid')" href="../../_variables/attemptid.html">$attemptid</a>));
<a name="l556"><span class="linenum"> 556</span></a>          }
<a name="l557"><span class="linenum"> 557</span></a>      }
<a name="l558"><span class="linenum"> 558</span></a>  
<a name="l559"><span class="linenum"> 559</span></a>  <span class="comment">    // Update completion state.</span>
<a name="l560"><span class="linenum"> 560</span></a>      if (<a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a>-&gt;<a class="function" onClick="logFunction('is_enabled')" href="../../_functions/is_enabled.html" onMouseOver="funcPopup(event,'is_enabled')">is_enabled</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>) &amp;&amp; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('completionsubmit')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/completionsubmit.html">completionsubmit</a>) {
<a name="l561"><span class="linenum"> 561</span></a>          <a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a>-&gt;<a class="function" onClick="logFunction('update_state')" href="../../_functions/update_state.html" onMouseOver="funcPopup(event,'update_state')">update_state</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="constant" onClick="logConstant('COMPLETION_INCOMPLETE')" href="../../_constants/COMPLETION_INCOMPLETE.html" onMouseOver="constPopup(event,'COMPLETION_INCOMPLETE')">COMPLETION_INCOMPLETE</a>);
<a name="l562"><span class="linenum"> 562</span></a>      }
<a name="l563"><span class="linenum"> 563</span></a>  
<a name="l564"><span class="linenum"> 564</span></a>      return true;
<a name="l565"><span class="linenum"> 565</span></a>  }
<a name="l566"><span class="linenum"> 566</span></a>  
<a name="l567"><span class="linenum"> 567</span></a>  
<a name="l568"><span class="linenum"> 568</span></a>  <span class="comment">/**</span>
<a name="l569"><span class="linenum"> 569</span></a>  <span class="comment"> * Given an ID of an instance of this module,</span>
<a name="l570"><span class="linenum"> 570</span></a>  <span class="comment"> * this function will permanently delete the instance</span>
<a name="l571"><span class="linenum"> 571</span></a>  <span class="comment"> * and any data that depends on it.</span>
<a name="l572"><span class="linenum"> 572</span></a>  <span class="comment"> *</span>
<a name="l573"><span class="linenum"> 573</span></a>  <span class="comment"> * @global object</span>
<a name="l574"><span class="linenum"> 574</span></a>  <span class="comment"> * @param int $id</span>
<a name="l575"><span class="linenum"> 575</span></a>  <span class="comment"> * @return bool</span>
<a name="l576"><span class="linenum"> 576</span></a>  <span class="comment"> */</span>
<a name="l577"><span class="linenum"> 577</span></a>  function <a class="function" onClick="logFunction('choice_delete_instance')" href="../../_functions/choice_delete_instance.html" onMouseOver="funcPopup(event,'choice_delete_instance')">choice_delete_instance</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>) {
<a name="l578"><span class="linenum"> 578</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l579"><span class="linenum"> 579</span></a>  
<a name="l580"><span class="linenum"> 580</span></a>      if (! <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>(&quot;choice&quot;, array(&quot;id&quot;=&gt;&quot;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>&quot;))) {
<a name="l581"><span class="linenum"> 581</span></a>          return false;
<a name="l582"><span class="linenum"> 582</span></a>      }
<a name="l583"><span class="linenum"> 583</span></a>  
<a name="l584"><span class="linenum"> 584</span></a>      <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = true;
<a name="l585"><span class="linenum"> 585</span></a>  
<a name="l586"><span class="linenum"> 586</span></a>      if (! <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>(&quot;choice_answers&quot;, array(&quot;choiceid&quot;=&gt;&quot;<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>&quot;))) {
<a name="l587"><span class="linenum"> 587</span></a>          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = false;
<a name="l588"><span class="linenum"> 588</span></a>      }
<a name="l589"><span class="linenum"> 589</span></a>  
<a name="l590"><span class="linenum"> 590</span></a>      if (! <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>(&quot;choice_options&quot;, array(&quot;choiceid&quot;=&gt;&quot;<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>&quot;))) {
<a name="l591"><span class="linenum"> 591</span></a>          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = false;
<a name="l592"><span class="linenum"> 592</span></a>      }
<a name="l593"><span class="linenum"> 593</span></a>  
<a name="l594"><span class="linenum"> 594</span></a>      if (! <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>(&quot;choice&quot;, array(&quot;id&quot;=&gt;&quot;<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>&quot;))) {
<a name="l595"><span class="linenum"> 595</span></a>          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = false;
<a name="l596"><span class="linenum"> 596</span></a>      }
<a name="l597"><span class="linenum"> 597</span></a>  <span class="comment">    // Remove old calendar events.</span>
<a name="l598"><span class="linenum"> 598</span></a>      if (! <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('event', array('modulename' =&gt; 'choice', 'instance' =&gt; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l599"><span class="linenum"> 599</span></a>          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = false;
<a name="l600"><span class="linenum"> 600</span></a>      }
<a name="l601"><span class="linenum"> 601</span></a>  
<a name="l602"><span class="linenum"> 602</span></a>      return <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l603"><span class="linenum"> 603</span></a>  }
<a name="l604"><span class="linenum"> 604</span></a>  
<a name="l605"><span class="linenum"> 605</span></a>  <span class="comment">/**</span>
<a name="l606"><span class="linenum"> 606</span></a>  <span class="comment"> * Returns text string which is the answer that matches the id</span>
<a name="l607"><span class="linenum"> 607</span></a>  <span class="comment"> *</span>
<a name="l608"><span class="linenum"> 608</span></a>  <span class="comment"> * @global object</span>
<a name="l609"><span class="linenum"> 609</span></a>  <span class="comment"> * @param object $choice</span>
<a name="l610"><span class="linenum"> 610</span></a>  <span class="comment"> * @param int $id</span>
<a name="l611"><span class="linenum"> 611</span></a>  <span class="comment"> * @return string</span>
<a name="l612"><span class="linenum"> 612</span></a>  <span class="comment"> */</span>
<a name="l613"><span class="linenum"> 613</span></a>  function <a class="function" onClick="logFunction('choice_get_option_text')" href="../../_functions/choice_get_option_text.html" onMouseOver="funcPopup(event,'choice_get_option_text')">choice_get_option_text</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>, <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>) {
<a name="l614"><span class="linenum"> 614</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l615"><span class="linenum"> 615</span></a>  
<a name="l616"><span class="linenum"> 616</span></a>      if (<a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>(&quot;choice_options&quot;, array(&quot;id&quot; =&gt; <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>))) {
<a name="l617"><span class="linenum"> 617</span></a>          return <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('text')" class="var it43057" onMouseOver="hilite(43057)" onMouseOut="lolite()" href="../../_variables/text.html">text</a>;
<a name="l618"><span class="linenum"> 618</span></a>      } else {
<a name="l619"><span class="linenum"> 619</span></a>          return <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;notanswered&quot;, &quot;choice&quot;);
<a name="l620"><span class="linenum"> 620</span></a>      }
<a name="l621"><span class="linenum"> 621</span></a>  }
<a name="l622"><span class="linenum"> 622</span></a>  
<a name="l623"><span class="linenum"> 623</span></a>  <span class="comment">/**</span>
<a name="l624"><span class="linenum"> 624</span></a>  <span class="comment"> * Gets a full choice record</span>
<a name="l625"><span class="linenum"> 625</span></a>  <span class="comment"> *</span>
<a name="l626"><span class="linenum"> 626</span></a>  <span class="comment"> * @global object</span>
<a name="l627"><span class="linenum"> 627</span></a>  <span class="comment"> * @param int $choiceid</span>
<a name="l628"><span class="linenum"> 628</span></a>  <span class="comment"> * @return object|bool The choice or false</span>
<a name="l629"><span class="linenum"> 629</span></a>  <span class="comment"> */</span>
<a name="l630"><span class="linenum"> 630</span></a>  function <a class="function" onClick="logFunction('choice_get_choice')" href="../../_functions/choice_get_choice.html" onMouseOver="funcPopup(event,'choice_get_choice')">choice_get_choice</a>(<a class="var it6835" onMouseOver="hilite(6835)" onMouseOut="lolite()" onClick="logVariable('choiceid')" href="../../_variables/choiceid.html">$choiceid</a>) {
<a name="l631"><span class="linenum"> 631</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l632"><span class="linenum"> 632</span></a>  
<a name="l633"><span class="linenum"> 633</span></a>      if (<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>(&quot;choice&quot;, array(&quot;id&quot; =&gt; <a class="var it6835" onMouseOver="hilite(6835)" onMouseOut="lolite()" onClick="logVariable('choiceid')" href="../../_variables/choiceid.html">$choiceid</a>))) {
<a name="l634"><span class="linenum"> 634</span></a>          if (<a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>(&quot;choice_options&quot;, array(&quot;choiceid&quot; =&gt; <a class="var it6835" onMouseOver="hilite(6835)" onMouseOut="lolite()" onClick="logVariable('choiceid')" href="../../_variables/choiceid.html">$choiceid</a>), &quot;id&quot;)) {
<a name="l635"><span class="linenum"> 635</span></a>              foreach (<a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a> as <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>) {
<a name="l636"><span class="linenum"> 636</span></a>                  <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('option')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/option.html">option</a>[<a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('id')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>] = <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('text')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/text.html">text</a>;
<a name="l637"><span class="linenum"> 637</span></a>                  <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('maxanswers')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/maxanswers.html">maxanswers</a>[<a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('id')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>] = <a class="var it395" onMouseOver="hilite(395)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../_variables/option.html">$option</a>-&gt;<a onClick="logVariable('maxanswers')" class="var it44663" onMouseOver="hilite(44663)" onMouseOut="lolite()" href="../../_variables/maxanswers.html">maxanswers</a>;
<a name="l638"><span class="linenum"> 638</span></a>              }
<a name="l639"><span class="linenum"> 639</span></a>              return <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>;
<a name="l640"><span class="linenum"> 640</span></a>          }
<a name="l641"><span class="linenum"> 641</span></a>      }
<a name="l642"><span class="linenum"> 642</span></a>      return false;
<a name="l643"><span class="linenum"> 643</span></a>  }
<a name="l644"><span class="linenum"> 644</span></a>  
<a name="l645"><span class="linenum"> 645</span></a>  <span class="comment">/**</span>
<a name="l646"><span class="linenum"> 646</span></a>  <span class="comment"> * List the actions that correspond to a view of this module.</span>
<a name="l647"><span class="linenum"> 647</span></a>  <span class="comment"> * This is used by the participation report.</span>
<a name="l648"><span class="linenum"> 648</span></a>  <span class="comment"> *</span>
<a name="l649"><span class="linenum"> 649</span></a>  <span class="comment"> * Note: This is not used by new logging system. Event with</span>
<a name="l650"><span class="linenum"> 650</span></a>  <span class="comment"> *       crud = 'r' and edulevel = LEVEL_PARTICIPATING will</span>
<a name="l651"><span class="linenum"> 651</span></a>  <span class="comment"> *       be considered as view action.</span>
<a name="l652"><span class="linenum"> 652</span></a>  <span class="comment"> *</span>
<a name="l653"><span class="linenum"> 653</span></a>  <span class="comment"> * @return array</span>
<a name="l654"><span class="linenum"> 654</span></a>  <span class="comment"> */</span>
<a name="l655"><span class="linenum"> 655</span></a>  function <a class="function" onClick="logFunction('choice_get_view_actions')" href="../../_functions/choice_get_view_actions.html" onMouseOver="funcPopup(event,'choice_get_view_actions')">choice_get_view_actions</a>() {
<a name="l656"><span class="linenum"> 656</span></a>      return array('view','view all','report');
<a name="l657"><span class="linenum"> 657</span></a>  }
<a name="l658"><span class="linenum"> 658</span></a>  
<a name="l659"><span class="linenum"> 659</span></a>  <span class="comment">/**</span>
<a name="l660"><span class="linenum"> 660</span></a>  <span class="comment"> * List the actions that correspond to a post of this module.</span>
<a name="l661"><span class="linenum"> 661</span></a>  <span class="comment"> * This is used by the participation report.</span>
<a name="l662"><span class="linenum"> 662</span></a>  <span class="comment"> *</span>
<a name="l663"><span class="linenum"> 663</span></a>  <span class="comment"> * Note: This is not used by new logging system. Event with</span>
<a name="l664"><span class="linenum"> 664</span></a>  <span class="comment"> *       crud = ('c' || 'u' || 'd') and edulevel = LEVEL_PARTICIPATING</span>
<a name="l665"><span class="linenum"> 665</span></a>  <span class="comment"> *       will be considered as post action.</span>
<a name="l666"><span class="linenum"> 666</span></a>  <span class="comment"> *</span>
<a name="l667"><span class="linenum"> 667</span></a>  <span class="comment"> * @return array</span>
<a name="l668"><span class="linenum"> 668</span></a>  <span class="comment"> */</span>
<a name="l669"><span class="linenum"> 669</span></a>  function <a class="function" onClick="logFunction('choice_get_post_actions')" href="../../_functions/choice_get_post_actions.html" onMouseOver="funcPopup(event,'choice_get_post_actions')">choice_get_post_actions</a>() {
<a name="l670"><span class="linenum"> 670</span></a>      return array('choose','choose again');
<a name="l671"><span class="linenum"> 671</span></a>  }
<a name="l672"><span class="linenum"> 672</span></a>  
<a name="l673"><span class="linenum"> 673</span></a>  
<a name="l674"><span class="linenum"> 674</span></a>  <span class="comment">/**</span>
<a name="l675"><span class="linenum"> 675</span></a>  <span class="comment"> * Implementation of the function for printing the form elements that control</span>
<a name="l676"><span class="linenum"> 676</span></a>  <span class="comment"> * whether the course reset functionality affects the choice.</span>
<a name="l677"><span class="linenum"> 677</span></a>  <span class="comment"> *</span>
<a name="l678"><span class="linenum"> 678</span></a>  <span class="comment"> * @param object $mform form passed by reference</span>
<a name="l679"><span class="linenum"> 679</span></a>  <span class="comment"> */</span>
<a name="l680"><span class="linenum"> 680</span></a>  function <a class="function" onClick="logFunction('choice_reset_course_form_definition')" href="../../_functions/choice_reset_course_form_definition.html" onMouseOver="funcPopup(event,'choice_reset_course_form_definition')">choice_reset_course_form_definition</a>(&amp;<a class="var it219" onMouseOver="hilite(219)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../../_variables/mform.html">$mform</a>) {
<a name="l681"><span class="linenum"> 681</span></a>      <a class="var it219" onMouseOver="hilite(219)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../../_variables/mform.html">$mform</a>-&gt;<a class="function" onClick="logFunction('addElement')" href="../../_functions/addelement.html" onMouseOver="funcPopup(event,'addelement')">addElement</a>('header', 'choiceheader', <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('modulenameplural', 'choice'));
<a name="l682"><span class="linenum"> 682</span></a>      <a class="var it219" onMouseOver="hilite(219)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../../_variables/mform.html">$mform</a>-&gt;<a class="function" onClick="logFunction('addElement')" href="../../_functions/addelement.html" onMouseOver="funcPopup(event,'addelement')">addElement</a>('advcheckbox', 'reset_choice', <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('removeresponses','choice'));
<a name="l683"><span class="linenum"> 683</span></a>  }
<a name="l684"><span class="linenum"> 684</span></a>  
<a name="l685"><span class="linenum"> 685</span></a>  <span class="comment">/**</span>
<a name="l686"><span class="linenum"> 686</span></a>  <span class="comment"> * Course reset form defaults.</span>
<a name="l687"><span class="linenum"> 687</span></a>  <span class="comment"> *</span>
<a name="l688"><span class="linenum"> 688</span></a>  <span class="comment"> * @return array</span>
<a name="l689"><span class="linenum"> 689</span></a>  <span class="comment"> */</span>
<a name="l690"><span class="linenum"> 690</span></a>  function <a class="function" onClick="logFunction('choice_reset_course_form_defaults')" href="../../_functions/choice_reset_course_form_defaults.html" onMouseOver="funcPopup(event,'choice_reset_course_form_defaults')">choice_reset_course_form_defaults</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>) {
<a name="l691"><span class="linenum"> 691</span></a>      return array('reset_choice'=&gt;1);
<a name="l692"><span class="linenum"> 692</span></a>  }
<a name="l693"><span class="linenum"> 693</span></a>  
<a name="l694"><span class="linenum"> 694</span></a>  <span class="comment">/**</span>
<a name="l695"><span class="linenum"> 695</span></a>  <span class="comment"> * Actual implementation of the reset course functionality, delete all the</span>
<a name="l696"><span class="linenum"> 696</span></a>  <span class="comment"> * choice responses for course $data-&gt;courseid.</span>
<a name="l697"><span class="linenum"> 697</span></a>  <span class="comment"> *</span>
<a name="l698"><span class="linenum"> 698</span></a>  <span class="comment"> * @global object</span>
<a name="l699"><span class="linenum"> 699</span></a>  <span class="comment"> * @global object</span>
<a name="l700"><span class="linenum"> 700</span></a>  <span class="comment"> * @param object $data the data submitted from the reset course.</span>
<a name="l701"><span class="linenum"> 701</span></a>  <span class="comment"> * @return array status array</span>
<a name="l702"><span class="linenum"> 702</span></a>  <span class="comment"> */</span>
<a name="l703"><span class="linenum"> 703</span></a>  function <a class="function" onClick="logFunction('choice_reset_userdata')" href="../../_functions/choice_reset_userdata.html" onMouseOver="funcPopup(event,'choice_reset_userdata')">choice_reset_userdata</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>) {
<a name="l704"><span class="linenum"> 704</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l705"><span class="linenum"> 705</span></a>  
<a name="l706"><span class="linenum"> 706</span></a>      <a class="var it9827" onMouseOver="hilite(9827)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../../_variables/componentstr.html">$componentstr</a> = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('modulenameplural', 'choice');
<a name="l707"><span class="linenum"> 707</span></a>      <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../_variables/status.html">$status</a> = array();
<a name="l708"><span class="linenum"> 708</span></a>  
<a name="l709"><span class="linenum"> 709</span></a>      if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('reset_choice')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/reset_choice.html">reset_choice</a>)) {
<a name="l710"><span class="linenum"> 710</span></a>          <a class="var it25975" onMouseOver="hilite(25975)" onMouseOut="lolite()" onClick="logVariable('choicessql')" href="../../_variables/choicessql.html">$choicessql</a> = &quot;SELECT ch.id
<a name="l711"><span class="linenum"> 711</span></a>                         FROM {choice} ch
<a name="l712"><span class="linenum"> 712</span></a>                         WHERE ch.course=?&quot;;
<a name="l713"><span class="linenum"> 713</span></a>  
<a name="l714"><span class="linenum"> 714</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records_select')" href="../../_functions/delete_records_select.html" onMouseOver="funcPopup(event,'delete_records_select')">delete_records_select</a>('choice_answers', &quot;choiceid IN (<a class="var it25975" onMouseOver="hilite(25975)" onMouseOut="lolite()" onClick="logVariable('choicessql')" href="../../_variables/choicessql.html">$choicessql</a>)&quot;, array(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>));
<a name="l715"><span class="linenum"> 715</span></a>          <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../_variables/status.html">$status</a>[] = array('component'=&gt;<a class="var it9827" onMouseOver="hilite(9827)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../../_variables/componentstr.html">$componentstr</a>, 'item'=&gt;<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('removeresponses', 'choice'), 'error'=&gt;false);
<a name="l716"><span class="linenum"> 716</span></a>      }
<a name="l717"><span class="linenum"> 717</span></a>  
<a name="l718"><span class="linenum"> 718</span></a>  <span class="comment">    /// updating dates - shift may be negative too</span>
<a name="l719"><span class="linenum"> 719</span></a>      if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('timeshift')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/timeshift.html">timeshift</a>) {
<a name="l720"><span class="linenum"> 720</span></a>          <a class="function" onClick="logFunction('shift_course_mod_dates')" href="../../_functions/shift_course_mod_dates.html" onMouseOver="funcPopup(event,'shift_course_mod_dates')">shift_course_mod_dates</a>('choice', array('timeopen', 'timeclose'), <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('timeshift')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/timeshift.html">timeshift</a>, <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('courseid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a>);
<a name="l721"><span class="linenum"> 721</span></a>          <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../_variables/status.html">$status</a>[] = array('component'=&gt;<a class="var it9827" onMouseOver="hilite(9827)" onMouseOut="lolite()" onClick="logVariable('componentstr')" href="../../_variables/componentstr.html">$componentstr</a>, 'item'=&gt;<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('datechanged'), 'error'=&gt;false);
<a name="l722"><span class="linenum"> 722</span></a>      }
<a name="l723"><span class="linenum"> 723</span></a>  
<a name="l724"><span class="linenum"> 724</span></a>      return <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../_variables/status.html">$status</a>;
<a name="l725"><span class="linenum"> 725</span></a>  }
<a name="l726"><span class="linenum"> 726</span></a>  
<a name="l727"><span class="linenum"> 727</span></a>  <span class="comment">/**</span>
<a name="l728"><span class="linenum"> 728</span></a>  <span class="comment"> * @global object</span>
<a name="l729"><span class="linenum"> 729</span></a>  <span class="comment"> * @global object</span>
<a name="l730"><span class="linenum"> 730</span></a>  <span class="comment"> * @global object</span>
<a name="l731"><span class="linenum"> 731</span></a>  <span class="comment"> * @uses CONTEXT_MODULE</span>
<a name="l732"><span class="linenum"> 732</span></a>  <span class="comment"> * @param object $choice</span>
<a name="l733"><span class="linenum"> 733</span></a>  <span class="comment"> * @param object $cm</span>
<a name="l734"><span class="linenum"> 734</span></a>  <span class="comment"> * @param int $groupmode</span>
<a name="l735"><span class="linenum"> 735</span></a>  <span class="comment"> * @param bool $onlyactive Whether to get response data for active users only.</span>
<a name="l736"><span class="linenum"> 736</span></a>  <span class="comment"> * @return array</span>
<a name="l737"><span class="linenum"> 737</span></a>  <span class="comment"> */</span>
<a name="l738"><span class="linenum"> 738</span></a>  function <a class="function" onClick="logFunction('choice_get_response_data')" href="../../_functions/choice_get_response_data.html" onMouseOver="funcPopup(event,'choice_get_response_data')">choice_get_response_data</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="var it688" onMouseOver="hilite(688)" onMouseOut="lolite()" onClick="logVariable('groupmode')" href="../../_variables/groupmode.html">$groupmode</a>, <a class="var it3719" onMouseOver="hilite(3719)" onMouseOut="lolite()" onClick="logVariable('onlyactive')" href="../../_variables/onlyactive.html">$onlyactive</a>) {
<a name="l739"><span class="linenum"> 739</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l740"><span class="linenum"> 740</span></a>  
<a name="l741"><span class="linenum"> 741</span></a>      <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_module')" href="../../_classes/context_module.html" onMouseOver="classPopup(event,'context_module')">context_module</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('id')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l742"><span class="linenum"> 742</span></a>  
<a name="l743"><span class="linenum"> 743</span></a>  <span class="comment">/// Get the current group</span>
<a name="l744"><span class="linenum"> 744</span></a>      if (<a class="var it688" onMouseOver="hilite(688)" onMouseOut="lolite()" onClick="logVariable('groupmode')" href="../../_variables/groupmode.html">$groupmode</a> &gt; 0) {
<a name="l745"><span class="linenum"> 745</span></a>          <a class="var it2561" onMouseOver="hilite(2561)" onMouseOut="lolite()" onClick="logVariable('currentgroup')" href="../../_variables/currentgroup.html">$currentgroup</a> = <a class="function" onClick="logFunction('groups_get_activity_group')" href="../../_functions/groups_get_activity_group.html" onMouseOver="funcPopup(event,'groups_get_activity_group')">groups_get_activity_group</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>);
<a name="l746"><span class="linenum"> 746</span></a>      } else {
<a name="l747"><span class="linenum"> 747</span></a>          <a class="var it2561" onMouseOver="hilite(2561)" onMouseOut="lolite()" onClick="logVariable('currentgroup')" href="../../_variables/currentgroup.html">$currentgroup</a> = 0;
<a name="l748"><span class="linenum"> 748</span></a>      }
<a name="l749"><span class="linenum"> 749</span></a>  
<a name="l750"><span class="linenum"> 750</span></a>  <span class="comment">/// Initialise the returned array, which is a matrix:  $allresponses[responseid][userid] = responseobject</span>
<a name="l751"><span class="linenum"> 751</span></a>      <a class="var it24060" onMouseOver="hilite(24060)" onMouseOut="lolite()" onClick="logVariable('allresponses')" href="../../_variables/allresponses.html">$allresponses</a> = array();
<a name="l752"><span class="linenum"> 752</span></a>  
<a name="l753"><span class="linenum"> 753</span></a>  <span class="comment">/// First get all the users who have access here</span>
<a name="l754"><span class="linenum"> 754</span></a>  <span class="comment">/// To start with we assume they are all &quot;unanswered&quot; then move them later</span>
<a name="l755"><span class="linenum"> 755</span></a>      <a class="var it24060" onMouseOver="hilite(24060)" onMouseOut="lolite()" onClick="logVariable('allresponses')" href="../../_variables/allresponses.html">$allresponses</a>[0] = <a class="function" onClick="logFunction('get_enrolled_users')" href="../../_functions/get_enrolled_users.html" onMouseOver="funcPopup(event,'get_enrolled_users')">get_enrolled_users</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>, 'mod/choice:choose', <a class="var it2561" onMouseOver="hilite(2561)" onMouseOut="lolite()" onClick="logVariable('currentgroup')" href="../../_variables/currentgroup.html">$currentgroup</a>,
<a name="l756"><span class="linenum"> 756</span></a>              <a class="class" onClick="logClass('user_picture')" href="../../_classes/user_picture.html" onMouseOver="classPopup(event,'user_picture')">user_picture</a>::<a class="function" onClick="logFunction('fields')" href="../../_functions/fields.html" onMouseOver="funcPopup(event,'fields')">fields</a>('u', array('idnumber')), null, 0, 0, <a class="var it3719" onMouseOver="hilite(3719)" onMouseOut="lolite()" onClick="logVariable('onlyactive')" href="../../_variables/onlyactive.html">$onlyactive</a>);
<a name="l757"><span class="linenum"> 757</span></a>  
<a name="l758"><span class="linenum"> 758</span></a>  <span class="comment">/// Get all the recorded responses for this choice</span>
<a name="l759"><span class="linenum"> 759</span></a>      <a class="var it25976" onMouseOver="hilite(25976)" onMouseOut="lolite()" onClick="logVariable('rawresponses')" href="../../_variables/rawresponses.html">$rawresponses</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('choice_answers', array('choiceid' =&gt; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l760"><span class="linenum"> 760</span></a>  
<a name="l761"><span class="linenum"> 761</span></a>  <span class="comment">/// Use the responses to move users into the correct column</span>
<a name="l762"><span class="linenum"> 762</span></a>  
<a name="l763"><span class="linenum"> 763</span></a>      if (<a class="var it25976" onMouseOver="hilite(25976)" onMouseOut="lolite()" onClick="logVariable('rawresponses')" href="../../_variables/rawresponses.html">$rawresponses</a>) {
<a name="l764"><span class="linenum"> 764</span></a>          <a class="var it25977" onMouseOver="hilite(25977)" onMouseOut="lolite()" onClick="logVariable('answeredusers')" href="../../_variables/answeredusers.html">$answeredusers</a> = array();
<a name="l765"><span class="linenum"> 765</span></a>          foreach (<a class="var it25976" onMouseOver="hilite(25976)" onMouseOut="lolite()" onClick="logVariable('rawresponses')" href="../../_variables/rawresponses.html">$rawresponses</a> as <a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../_variables/response.html">$response</a>) {
<a name="l766"><span class="linenum"> 766</span></a>              if (isset(<a class="var it24060" onMouseOver="hilite(24060)" onMouseOut="lolite()" onClick="logVariable('allresponses')" href="../../_variables/allresponses.html">$allresponses</a>[0][<a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../_variables/response.html">$response</a>-&gt;<a onClick="logVariable('userid')" class="var it43083" onMouseOver="hilite(43083)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>])) {   // This person is enrolled and in correct group
<a name="l767"><span class="linenum"> 767</span></a>                  <a class="var it24060" onMouseOver="hilite(24060)" onMouseOut="lolite()" onClick="logVariable('allresponses')" href="../../_variables/allresponses.html">$allresponses</a>[0][<a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../_variables/response.html">$response</a>-&gt;<a onClick="logVariable('userid')" class="var it43083" onMouseOver="hilite(43083)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>]-&gt;timemodified = <a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../_variables/response.html">$response</a>-&gt;<a onClick="logVariable('timemodified')" class="var it43083" onMouseOver="hilite(43083)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a>;
<a name="l768"><span class="linenum"> 768</span></a>                  <a class="var it24060" onMouseOver="hilite(24060)" onMouseOut="lolite()" onClick="logVariable('allresponses')" href="../../_variables/allresponses.html">$allresponses</a>[<a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../_variables/response.html">$response</a>-&gt;<a onClick="logVariable('optionid')" class="var it43083" onMouseOver="hilite(43083)" onMouseOut="lolite()" href="../../_variables/optionid.html">optionid</a>][<a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../_variables/response.html">$response</a>-&gt;<a onClick="logVariable('userid')" class="var it43083" onMouseOver="hilite(43083)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>] = <a class="function" onClick="logFunction('clone')" href="../../_functions/clone.html" onMouseOver="funcPopup(event,'clone')">clone</a>(<a class="var it24060" onMouseOver="hilite(24060)" onMouseOut="lolite()" onClick="logVariable('allresponses')" href="../../_variables/allresponses.html">$allresponses</a>[0][<a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../_variables/response.html">$response</a>-&gt;<a onClick="logVariable('userid')" class="var it43083" onMouseOver="hilite(43083)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>]);
<a name="l769"><span class="linenum"> 769</span></a>                  <a class="var it24060" onMouseOver="hilite(24060)" onMouseOut="lolite()" onClick="logVariable('allresponses')" href="../../_variables/allresponses.html">$allresponses</a>[<a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../_variables/response.html">$response</a>-&gt;<a onClick="logVariable('optionid')" class="var it43083" onMouseOver="hilite(43083)" onMouseOut="lolite()" href="../../_variables/optionid.html">optionid</a>][<a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../_variables/response.html">$response</a>-&gt;<a onClick="logVariable('userid')" class="var it43083" onMouseOver="hilite(43083)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>]-&gt;answerid = <a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../_variables/response.html">$response</a>-&gt;<a onClick="logVariable('id')" class="var it43083" onMouseOver="hilite(43083)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l770"><span class="linenum"> 770</span></a>                  <a class="var it25977" onMouseOver="hilite(25977)" onMouseOut="lolite()" onClick="logVariable('answeredusers')" href="../../_variables/answeredusers.html">$answeredusers</a>[] = <a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../_variables/response.html">$response</a>-&gt;<a onClick="logVariable('userid')" class="var it43083" onMouseOver="hilite(43083)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>;
<a name="l771"><span class="linenum"> 771</span></a>              }
<a name="l772"><span class="linenum"> 772</span></a>          }
<a name="l773"><span class="linenum"> 773</span></a>          foreach (<a class="var it25977" onMouseOver="hilite(25977)" onMouseOut="lolite()" onClick="logVariable('answeredusers')" href="../../_variables/answeredusers.html">$answeredusers</a> as <a class="var it25978" onMouseOver="hilite(25978)" onMouseOut="lolite()" onClick="logVariable('answereduser')" href="../../_variables/answereduser.html">$answereduser</a>) {
<a name="l774"><span class="linenum"> 774</span></a>              unset(<a class="var it24060" onMouseOver="hilite(24060)" onMouseOut="lolite()" onClick="logVariable('allresponses')" href="../../_variables/allresponses.html">$allresponses</a>[0][<a class="var it25978" onMouseOver="hilite(25978)" onMouseOut="lolite()" onClick="logVariable('answereduser')" href="../../_variables/answereduser.html">$answereduser</a>]);
<a name="l775"><span class="linenum"> 775</span></a>          }
<a name="l776"><span class="linenum"> 776</span></a>      }
<a name="l777"><span class="linenum"> 777</span></a>      return <a class="var it24060" onMouseOver="hilite(24060)" onMouseOut="lolite()" onClick="logVariable('allresponses')" href="../../_variables/allresponses.html">$allresponses</a>;
<a name="l778"><span class="linenum"> 778</span></a>  }
<a name="l779"><span class="linenum"> 779</span></a>  
<a name="l780"><span class="linenum"> 780</span></a>  <span class="comment">/**</span>
<a name="l781"><span class="linenum"> 781</span></a>  <span class="comment"> * Returns all other caps used in module</span>
<a name="l782"><span class="linenum"> 782</span></a>  <span class="comment"> *</span>
<a name="l783"><span class="linenum"> 783</span></a>  <span class="comment"> * @return array</span>
<a name="l784"><span class="linenum"> 784</span></a>  <span class="comment"> */</span>
<a name="l785"><span class="linenum"> 785</span></a>  function <a class="function" onClick="logFunction('choice_get_extra_capabilities')" href="../../_functions/choice_get_extra_capabilities.html" onMouseOver="funcPopup(event,'choice_get_extra_capabilities')">choice_get_extra_capabilities</a>() {
<a name="l786"><span class="linenum"> 786</span></a>      return array('moodle/site:accessallgroups');
<a name="l787"><span class="linenum"> 787</span></a>  }
<a name="l788"><span class="linenum"> 788</span></a>  
<a name="l789"><span class="linenum"> 789</span></a>  <span class="comment">/**</span>
<a name="l790"><span class="linenum"> 790</span></a>  <span class="comment"> * @uses FEATURE_GROUPS</span>
<a name="l791"><span class="linenum"> 791</span></a>  <span class="comment"> * @uses FEATURE_GROUPINGS</span>
<a name="l792"><span class="linenum"> 792</span></a>  <span class="comment"> * @uses FEATURE_MOD_INTRO</span>
<a name="l793"><span class="linenum"> 793</span></a>  <span class="comment"> * @uses FEATURE_COMPLETION_TRACKS_VIEWS</span>
<a name="l794"><span class="linenum"> 794</span></a>  <span class="comment"> * @uses FEATURE_GRADE_HAS_GRADE</span>
<a name="l795"><span class="linenum"> 795</span></a>  <span class="comment"> * @uses FEATURE_GRADE_OUTCOMES</span>
<a name="l796"><span class="linenum"> 796</span></a>  <span class="comment"> * @param string $feature FEATURE_xx constant for requested feature</span>
<a name="l797"><span class="linenum"> 797</span></a>  <span class="comment"> * @return mixed True if module supports feature, null if doesn't know</span>
<a name="l798"><span class="linenum"> 798</span></a>  <span class="comment"> */</span>
<a name="l799"><span class="linenum"> 799</span></a>  function <a class="function" onClick="logFunction('choice_supports')" href="../../_functions/choice_supports.html" onMouseOver="funcPopup(event,'choice_supports')">choice_supports</a>(<a class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" onClick="logVariable('feature')" href="../../_variables/feature.html">$feature</a>) {
<a name="l800"><span class="linenum"> 800</span></a>      switch(<a class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" onClick="logVariable('feature')" href="../../_variables/feature.html">$feature</a>) {
<a name="l801"><span class="linenum"> 801</span></a>          case <a class="constant" onClick="logConstant('FEATURE_GROUPS')" href="../../_constants/FEATURE_GROUPS.html" onMouseOver="constPopup(event,'FEATURE_GROUPS')">FEATURE_GROUPS</a>:                  return true;
<a name="l802"><span class="linenum"> 802</span></a>          case <a class="constant" onClick="logConstant('FEATURE_GROUPINGS')" href="../../_constants/FEATURE_GROUPINGS.html" onMouseOver="constPopup(event,'FEATURE_GROUPINGS')">FEATURE_GROUPINGS</a>:               return true;
<a name="l803"><span class="linenum"> 803</span></a>          case <a class="constant" onClick="logConstant('FEATURE_MOD_INTRO')" href="../../_constants/FEATURE_MOD_INTRO.html" onMouseOver="constPopup(event,'FEATURE_MOD_INTRO')">FEATURE_MOD_INTRO</a>:               return true;
<a name="l804"><span class="linenum"> 804</span></a>          case <a class="constant" onClick="logConstant('FEATURE_COMPLETION_TRACKS_VIEWS')" href="../../_constants/FEATURE_COMPLETION_TRACKS_VIEWS.html" onMouseOver="constPopup(event,'FEATURE_COMPLETION_TRACKS_VIEWS')">FEATURE_COMPLETION_TRACKS_VIEWS</a>: return true;
<a name="l805"><span class="linenum"> 805</span></a>          case <a class="constant" onClick="logConstant('FEATURE_COMPLETION_HAS_RULES')" href="../../_constants/FEATURE_COMPLETION_HAS_RULES.html" onMouseOver="constPopup(event,'FEATURE_COMPLETION_HAS_RULES')">FEATURE_COMPLETION_HAS_RULES</a>:    return true;
<a name="l806"><span class="linenum"> 806</span></a>          case <a class="constant" onClick="logConstant('FEATURE_GRADE_HAS_GRADE')" href="../../_constants/FEATURE_GRADE_HAS_GRADE.html" onMouseOver="constPopup(event,'FEATURE_GRADE_HAS_GRADE')">FEATURE_GRADE_HAS_GRADE</a>:         return false;
<a name="l807"><span class="linenum"> 807</span></a>          case <a class="constant" onClick="logConstant('FEATURE_GRADE_OUTCOMES')" href="../../_constants/FEATURE_GRADE_OUTCOMES.html" onMouseOver="constPopup(event,'FEATURE_GRADE_OUTCOMES')">FEATURE_GRADE_OUTCOMES</a>:          return false;
<a name="l808"><span class="linenum"> 808</span></a>          case <a class="constant" onClick="logConstant('FEATURE_BACKUP_MOODLE2')" href="../../_constants/FEATURE_BACKUP_MOODLE2.html" onMouseOver="constPopup(event,'FEATURE_BACKUP_MOODLE2')">FEATURE_BACKUP_MOODLE2</a>:          return true;
<a name="l809"><span class="linenum"> 809</span></a>          case <a class="constant" onClick="logConstant('FEATURE_SHOW_DESCRIPTION')" href="../../_constants/FEATURE_SHOW_DESCRIPTION.html" onMouseOver="constPopup(event,'FEATURE_SHOW_DESCRIPTION')">FEATURE_SHOW_DESCRIPTION</a>:        return true;
<a name="l810"><span class="linenum"> 810</span></a>  
<a name="l811"><span class="linenum"> 811</span></a>          default: return null;
<a name="l812"><span class="linenum"> 812</span></a>      }
<a name="l813"><span class="linenum"> 813</span></a>  }
<a name="l814"><span class="linenum"> 814</span></a>  
<a name="l815"><span class="linenum"> 815</span></a>  <span class="comment">/**</span>
<a name="l816"><span class="linenum"> 816</span></a>  <span class="comment"> * Adds module specific settings to the settings block</span>
<a name="l817"><span class="linenum"> 817</span></a>  <span class="comment"> *</span>
<a name="l818"><span class="linenum"> 818</span></a>  <span class="comment"> * @param settings_navigation $settings The settings navigation object</span>
<a name="l819"><span class="linenum"> 819</span></a>  <span class="comment"> * @param navigation_node $choicenode The node to add module settings to</span>
<a name="l820"><span class="linenum"> 820</span></a>  <span class="comment"> */</span>
<a name="l821"><span class="linenum"> 821</span></a>  function <a class="function" onClick="logFunction('choice_extend_settings_navigation')" href="../../_functions/choice_extend_settings_navigation.html" onMouseOver="funcPopup(event,'choice_extend_settings_navigation')">choice_extend_settings_navigation</a>(settings_navigation <a class="var it18" onMouseOver="hilite(18)" onMouseOut="lolite()" onClick="logVariable('settings')" href="../../_variables/settings.html">$settings</a>, navigation_node <a class="var it25979" onMouseOver="hilite(25979)" onMouseOut="lolite()" onClick="logVariable('choicenode')" href="../../_variables/choicenode.html">$choicenode</a>) {
<a name="l822"><span class="linenum"> 822</span></a>      global <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>;
<a name="l823"><span class="linenum"> 823</span></a>  
<a name="l824"><span class="linenum"> 824</span></a>      if (<a class="function" onClick="logFunction('has_capability')" href="../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('mod/choice:readresponses', <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a onClick="logVariable('cm')" class="var it42916" onMouseOver="hilite(42916)" onMouseOut="lolite()" href="../../_variables/cm.html">cm</a>-&gt;context)) {
<a name="l825"><span class="linenum"> 825</span></a>  
<a name="l826"><span class="linenum"> 826</span></a>          <a class="var it688" onMouseOver="hilite(688)" onMouseOut="lolite()" onClick="logVariable('groupmode')" href="../../_variables/groupmode.html">$groupmode</a> = <a class="function" onClick="logFunction('groups_get_activity_groupmode')" href="../../_functions/groups_get_activity_groupmode.html" onMouseOver="funcPopup(event,'groups_get_activity_groupmode')">groups_get_activity_groupmode</a>(<a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a onClick="logVariable('cm')" class="var it42916" onMouseOver="hilite(42916)" onMouseOut="lolite()" href="../../_variables/cm.html">cm</a>);
<a name="l827"><span class="linenum"> 827</span></a>          if (<a class="var it688" onMouseOver="hilite(688)" onMouseOut="lolite()" onClick="logVariable('groupmode')" href="../../_variables/groupmode.html">$groupmode</a>) {
<a name="l828"><span class="linenum"> 828</span></a>              <a class="function" onClick="logFunction('groups_get_activity_group')" href="../../_functions/groups_get_activity_group.html" onMouseOver="funcPopup(event,'groups_get_activity_group')">groups_get_activity_group</a>(<a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a onClick="logVariable('cm')" class="var it42916" onMouseOver="hilite(42916)" onMouseOut="lolite()" href="../../_variables/cm.html">cm</a>, true);
<a name="l829"><span class="linenum"> 829</span></a>          }
<a name="l830"><span class="linenum"> 830</span></a>  
<a name="l831"><span class="linenum"> 831</span></a>          <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a> = <a class="function" onClick="logFunction('choice_get_choice')" href="../../_functions/choice_get_choice.html" onMouseOver="funcPopup(event,'choice_get_choice')">choice_get_choice</a>(<a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a onClick="logVariable('cm')" class="var it42916" onMouseOver="hilite(42916)" onMouseOut="lolite()" href="../../_variables/cm.html">cm</a>-&gt;instance);
<a name="l832"><span class="linenum"> 832</span></a>  
<a name="l833"><span class="linenum"> 833</span></a>  <span class="comment">        // Check if we want to include responses from inactive users.</span>
<a name="l834"><span class="linenum"> 834</span></a>          <a class="var it3719" onMouseOver="hilite(3719)" onMouseOut="lolite()" onClick="logVariable('onlyactive')" href="../../_variables/onlyactive.html">$onlyactive</a> = <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('includeinactive')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/includeinactive.html">includeinactive</a> ? false : true;
<a name="l835"><span class="linenum"> 835</span></a>  
<a name="l836"><span class="linenum"> 836</span></a>  <span class="comment">        // Big function, approx 6 SQL calls per user.</span>
<a name="l837"><span class="linenum"> 837</span></a>          <a class="var it24060" onMouseOver="hilite(24060)" onMouseOut="lolite()" onClick="logVariable('allresponses')" href="../../_variables/allresponses.html">$allresponses</a> = <a class="function" onClick="logFunction('choice_get_response_data')" href="../../_functions/choice_get_response_data.html" onMouseOver="funcPopup(event,'choice_get_response_data')">choice_get_response_data</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>, <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a onClick="logVariable('cm')" class="var it42916" onMouseOver="hilite(42916)" onMouseOut="lolite()" href="../../_variables/cm.html">cm</a>, <a class="var it688" onMouseOver="hilite(688)" onMouseOut="lolite()" onClick="logVariable('groupmode')" href="../../_variables/groupmode.html">$groupmode</a>, <a class="var it3719" onMouseOver="hilite(3719)" onMouseOut="lolite()" onClick="logVariable('onlyactive')" href="../../_variables/onlyactive.html">$onlyactive</a>);
<a name="l838"><span class="linenum"> 838</span></a>  
<a name="l839"><span class="linenum"> 839</span></a>          <a class="var it24803" onMouseOver="hilite(24803)" onMouseOut="lolite()" onClick="logVariable('allusers')" href="../../_variables/allusers.html">$allusers</a> = [];
<a name="l840"><span class="linenum"> 840</span></a>          foreach(<a class="var it24060" onMouseOver="hilite(24060)" onMouseOut="lolite()" onClick="logVariable('allresponses')" href="../../_variables/allresponses.html">$allresponses</a> as <a class="var it6606" onMouseOver="hilite(6606)" onMouseOut="lolite()" onClick="logVariable('optionid')" href="../../_variables/optionid.html">$optionid</a> =&gt; <a class="var it1811" onMouseOver="hilite(1811)" onMouseOut="lolite()" onClick="logVariable('userlist')" href="../../_variables/userlist.html">$userlist</a>) {
<a name="l841"><span class="linenum"> 841</span></a>              if (<a class="var it6606" onMouseOver="hilite(6606)" onMouseOut="lolite()" onClick="logVariable('optionid')" href="../../_variables/optionid.html">$optionid</a>) {
<a name="l842"><span class="linenum"> 842</span></a>                  <a class="var it24803" onMouseOver="hilite(24803)" onMouseOut="lolite()" onClick="logVariable('allusers')" href="../../_variables/allusers.html">$allusers</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it24803" onMouseOver="hilite(24803)" onMouseOut="lolite()" onClick="logVariable('allusers')" href="../../_variables/allusers.html">$allusers</a>, <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it1811" onMouseOver="hilite(1811)" onMouseOut="lolite()" onClick="logVariable('userlist')" href="../../_variables/userlist.html">$userlist</a>));
<a name="l843"><span class="linenum"> 843</span></a>              }
<a name="l844"><span class="linenum"> 844</span></a>          }
<a name="l845"><span class="linenum"> 845</span></a>          <a class="var it25969" onMouseOver="hilite(25969)" onMouseOut="lolite()" onClick="logVariable('responsecount')" href="../../_variables/responsecount.html">$responsecount</a> = <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="phpfunction" onClick="logFunction('array_unique')" href="../../_functions/array_unique.html" onMouseOver="phpfuncPopup(event,'array_unique')">array_unique</a>(<a class="var it24803" onMouseOver="hilite(24803)" onMouseOut="lolite()" onClick="logVariable('allusers')" href="../../_variables/allusers.html">$allusers</a>));
<a name="l846"><span class="linenum"> 846</span></a>          <a class="var it25979" onMouseOver="hilite(25979)" onMouseOut="lolite()" onClick="logVariable('choicenode')" href="../../_variables/choicenode.html">$choicenode</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>(&quot;viewallresponses&quot;, &quot;choice&quot;, <a class="var it25969" onMouseOver="hilite(25969)" onMouseOut="lolite()" onClick="logVariable('responsecount')" href="../../_variables/responsecount.html">$responsecount</a>), <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../mod/choice/report.php.html">/mod/choice/report.php</a>', array('id'=&gt;<a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../_variables/PAGE.html">$PAGE</a>-&gt;<a onClick="logVariable('cm')" class="var it42916" onMouseOver="hilite(42916)" onMouseOut="lolite()" href="../../_variables/cm.html">cm</a>-&gt;id)));
<a name="l847"><span class="linenum"> 847</span></a>      }
<a name="l848"><span class="linenum"> 848</span></a>  }
<a name="l849"><span class="linenum"> 849</span></a>  
<a name="l850"><span class="linenum"> 850</span></a>  <span class="comment">/**</span>
<a name="l851"><span class="linenum"> 851</span></a>  <span class="comment"> * Obtains the automatic completion state for this choice based on any conditions</span>
<a name="l852"><span class="linenum"> 852</span></a>  <span class="comment"> * in forum settings.</span>
<a name="l853"><span class="linenum"> 853</span></a>  <span class="comment"> *</span>
<a name="l854"><span class="linenum"> 854</span></a>  <span class="comment"> * @param object $course Course</span>
<a name="l855"><span class="linenum"> 855</span></a>  <span class="comment"> * @param object $cm Course-module</span>
<a name="l856"><span class="linenum"> 856</span></a>  <span class="comment"> * @param int $userid User ID</span>
<a name="l857"><span class="linenum"> 857</span></a>  <span class="comment"> * @param bool $type Type of comparison (or/and; can be used as return value if no conditions)</span>
<a name="l858"><span class="linenum"> 858</span></a>  <span class="comment"> * @return bool True if completed, false if not, $type if conditions not set.</span>
<a name="l859"><span class="linenum"> 859</span></a>  <span class="comment"> */</span>
<a name="l860"><span class="linenum"> 860</span></a>  function <a class="function" onClick="logFunction('choice_get_completion_state')" href="../../_functions/choice_get_completion_state.html" onMouseOver="funcPopup(event,'choice_get_completion_state')">choice_get_completion_state</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>, <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>) {
<a name="l861"><span class="linenum"> 861</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>,<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l862"><span class="linenum"> 862</span></a>  
<a name="l863"><span class="linenum"> 863</span></a>  <span class="comment">    // Get choice details</span>
<a name="l864"><span class="linenum"> 864</span></a>      <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('choice', array('id'=&gt;<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('instance')" class="var it42905" onMouseOver="hilite(42905)" onMouseOut="lolite()" href="../../_variables/instance.html">instance</a>), '*',
<a name="l865"><span class="linenum"> 865</span></a>              <a class="constant" onClick="logConstant('MUST_EXIST')" href="../../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l866"><span class="linenum"> 866</span></a>  
<a name="l867"><span class="linenum"> 867</span></a>  <span class="comment">    // If completion option is enabled, evaluate it and return true/false</span>
<a name="l868"><span class="linenum"> 868</span></a>      if(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('completionsubmit')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/completionsubmit.html">completionsubmit</a>) {
<a name="l869"><span class="linenum"> 869</span></a>          return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('record_exists')" href="../../_functions/record_exists.html" onMouseOver="funcPopup(event,'record_exists')">record_exists</a>('choice_answers', array(
<a name="l870"><span class="linenum"> 870</span></a>                  'choiceid'=&gt;<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'userid'=&gt;<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../_variables/userid.html">$userid</a>));
<a name="l871"><span class="linenum"> 871</span></a>      } else {
<a name="l872"><span class="linenum"> 872</span></a>  <span class="comment">        // Completion option is not enabled so just return $type</span>
<a name="l873"><span class="linenum"> 873</span></a>          return <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../../_variables/type.html">$type</a>;
<a name="l874"><span class="linenum"> 874</span></a>      }
<a name="l875"><span class="linenum"> 875</span></a>  }
<a name="l876"><span class="linenum"> 876</span></a>  
<a name="l877"><span class="linenum"> 877</span></a>  <span class="comment">/**</span>
<a name="l878"><span class="linenum"> 878</span></a>  <span class="comment"> * Return a list of page types</span>
<a name="l879"><span class="linenum"> 879</span></a>  <span class="comment"> * @param string $pagetype current page type</span>
<a name="l880"><span class="linenum"> 880</span></a>  <span class="comment"> * @param stdClass $parentcontext Block's parent context</span>
<a name="l881"><span class="linenum"> 881</span></a>  <span class="comment"> * @param stdClass $currentcontext Current context of block</span>
<a name="l882"><span class="linenum"> 882</span></a>  <span class="comment"> */</span>
<a name="l883"><span class="linenum"> 883</span></a>  function <a class="function" onClick="logFunction('choice_page_type_list')" href="../../_functions/choice_page_type_list.html" onMouseOver="funcPopup(event,'choice_page_type_list')">choice_page_type_list</a>(<a class="var it2278" onMouseOver="hilite(2278)" onMouseOut="lolite()" onClick="logVariable('pagetype')" href="../../_variables/pagetype.html">$pagetype</a>, <a class="var it2279" onMouseOver="hilite(2279)" onMouseOut="lolite()" onClick="logVariable('parentcontext')" href="../../_variables/parentcontext.html">$parentcontext</a>, <a class="var it2280" onMouseOver="hilite(2280)" onMouseOut="lolite()" onClick="logVariable('currentcontext')" href="../../_variables/currentcontext.html">$currentcontext</a>) {
<a name="l884"><span class="linenum"> 884</span></a>      <a class="var it9844" onMouseOver="hilite(9844)" onMouseOut="lolite()" onClick="logVariable('module_pagetype')" href="../../_variables/module_pagetype.html">$module_pagetype</a> = array('mod-choice-*'=&gt;<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('page-mod-choice-x', 'choice'));
<a name="l885"><span class="linenum"> 885</span></a>      return <a class="var it9844" onMouseOver="hilite(9844)" onMouseOut="lolite()" onClick="logVariable('module_pagetype')" href="../../_variables/module_pagetype.html">$module_pagetype</a>;
<a name="l886"><span class="linenum"> 886</span></a>  }
<a name="l887"><span class="linenum"> 887</span></a>  
<a name="l888"><span class="linenum"> 888</span></a>  <span class="comment">/**</span>
<a name="l889"><span class="linenum"> 889</span></a>  <span class="comment"> * Prints choice summaries on MyMoodle Page</span>
<a name="l890"><span class="linenum"> 890</span></a>  <span class="comment"> *</span>
<a name="l891"><span class="linenum"> 891</span></a>  <span class="comment"> * Prints choice name, due date and attempt information on</span>
<a name="l892"><span class="linenum"> 892</span></a>  <span class="comment"> * choice activities that have a deadline that has not already passed</span>
<a name="l893"><span class="linenum"> 893</span></a>  <span class="comment"> * and it is available for completing.</span>
<a name="l894"><span class="linenum"> 894</span></a>  <span class="comment"> * @uses CONTEXT_MODULE</span>
<a name="l895"><span class="linenum"> 895</span></a>  <span class="comment"> * @param array $courses An array of course objects to get choice instances from.</span>
<a name="l896"><span class="linenum"> 896</span></a>  <span class="comment"> * @param array $htmlarray Store overview output array( course ID =&gt; 'choice' =&gt; HTML output )</span>
<a name="l897"><span class="linenum"> 897</span></a>  <span class="comment"> */</span>
<a name="l898"><span class="linenum"> 898</span></a>  function <a class="function" onClick="logFunction('choice_print_overview')" href="../../_functions/choice_print_overview.html" onMouseOver="funcPopup(event,'choice_print_overview')">choice_print_overview</a>(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>, &amp;<a class="var it9833" onMouseOver="hilite(9833)" onMouseOut="lolite()" onClick="logVariable('htmlarray')" href="../../_variables/htmlarray.html">$htmlarray</a>) {
<a name="l899"><span class="linenum"> 899</span></a>      global <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>;
<a name="l900"><span class="linenum"> 900</span></a>  
<a name="l901"><span class="linenum"> 901</span></a>      if (empty(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>) || !<a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>) || <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>) == 0) {
<a name="l902"><span class="linenum"> 902</span></a>          return;
<a name="l903"><span class="linenum"> 903</span></a>      }
<a name="l904"><span class="linenum"> 904</span></a>      if (!<a class="var it1191" onMouseOver="hilite(1191)" onMouseOut="lolite()" onClick="logVariable('choices')" href="../../_variables/choices.html">$choices</a> = <a class="function" onClick="logFunction('get_all_instances_in_courses')" href="../../_functions/get_all_instances_in_courses.html" onMouseOver="funcPopup(event,'get_all_instances_in_courses')">get_all_instances_in_courses</a>('choice', <a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('courses')" href="../../_variables/courses.html">$courses</a>)) {
<a name="l905"><span class="linenum"> 905</span></a>          return;
<a name="l906"><span class="linenum"> 906</span></a>      }
<a name="l907"><span class="linenum"> 907</span></a>  
<a name="l908"><span class="linenum"> 908</span></a>      <a class="var it3027" onMouseOver="hilite(3027)" onMouseOut="lolite()" onClick="logVariable('now')" href="../../_variables/now.html">$now</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l909"><span class="linenum"> 909</span></a>      foreach (<a class="var it1191" onMouseOver="hilite(1191)" onMouseOut="lolite()" onClick="logVariable('choices')" href="../../_variables/choices.html">$choices</a> as <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>) {
<a name="l910"><span class="linenum"> 910</span></a>          if (<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('timeclose')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/timeclose.html">timeclose</a> != 0                                      // If this choice is scheduled.
<a name="l911"><span class="linenum"> 911</span></a>              and <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('timeclose')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/timeclose.html">timeclose</a> &gt;= <a class="var it3027" onMouseOver="hilite(3027)" onMouseOut="lolite()" onClick="logVariable('now')" href="../../_variables/now.html">$now</a>                               // And the deadline has not passed.
<a name="l912"><span class="linenum"> 912</span></a>              and (<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('timeopen')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/timeopen.html">timeopen</a> == 0 or <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('timeopen')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/timeopen.html">timeopen</a> &lt;= <a class="var it3027" onMouseOver="hilite(3027)" onMouseOut="lolite()" onClick="logVariable('now')" href="../../_variables/now.html">$now</a>)) { // And the choice is available.
<a name="l913"><span class="linenum"> 913</span></a>  
<a name="l914"><span class="linenum"> 914</span></a>  <span class="comment">            // Visibility.</span>
<a name="l915"><span class="linenum"> 915</span></a>              <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('class')" href="../../_variables/class.html">$class</a> = (!<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('visible')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/visible.html">visible</a>) ? 'dimmed' : '';
<a name="l916"><span class="linenum"> 916</span></a>  
<a name="l917"><span class="linenum"> 917</span></a>  <span class="comment">            // Link to activity.</span>
<a name="l918"><span class="linenum"> 918</span></a>              <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../mod/choice/view.php.html">/mod/choice/view.php</a>', array('id' =&gt; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('coursemodule')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/coursemodule.html">coursemodule</a>));
<a name="l919"><span class="linenum"> 919</span></a>              <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="phpfunction" onClick="logFunction('link')" href="../../_functions/link.html" onMouseOver="phpfuncPopup(event,'link')">link</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>, <a class="function" onClick="logFunction('format_string')" href="../../_functions/format_string.html" onMouseOver="funcPopup(event,'format_string')">format_string</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('name')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>), array('class' =&gt; <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('class')" href="../../_variables/class.html">$class</a>));
<a name="l920"><span class="linenum"> 920</span></a>              <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a> = <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box')" href="../../_functions/box.html" onMouseOver="funcPopup(event,'box')">box</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('choiceactivityname', 'choice', <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>), 'name');
<a name="l921"><span class="linenum"> 921</span></a>  
<a name="l922"><span class="linenum"> 922</span></a>  <span class="comment">             // Deadline.</span>
<a name="l923"><span class="linenum"> 923</span></a>              <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a> .= <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box')" href="../../_functions/box.html" onMouseOver="funcPopup(event,'box')">box</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('choicecloseson', 'choice', <a class="function" onClick="logFunction('userdate')" href="../../_functions/userdate.html" onMouseOver="funcPopup(event,'userdate')">userdate</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('timeclose')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/timeclose.html">timeclose</a>)), 'info');
<a name="l924"><span class="linenum"> 924</span></a>  
<a name="l925"><span class="linenum"> 925</span></a>  <span class="comment">            // Display relevant info based on permissions.</span>
<a name="l926"><span class="linenum"> 926</span></a>              if (<a class="function" onClick="logFunction('has_capability')" href="../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('mod/choice:readresponses', <a class="class" onClick="logClass('context_module')" href="../../_classes/context_module.html" onMouseOver="classPopup(event,'context_module')">context_module</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('coursemodule')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/coursemodule.html">coursemodule</a>))) {
<a name="l927"><span class="linenum"> 927</span></a>                  <a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records_sql')" href="../../_functions/count_records_sql.html" onMouseOver="funcPopup(event,'count_records_sql')">count_records_sql</a>('SELECT <a class="phpfunction" onClick="logFunction('COUNT')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">COUNT</a>(DISTINCT userid) FROM {choice_answers} WHERE choiceid = ?',
<a name="l928"><span class="linenum"> 928</span></a>                      [<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>]);
<a name="l929"><span class="linenum"> 929</span></a>                  <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../mod/choice/report.php.html">/mod/choice/report.php</a>', ['id' =&gt; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('coursemodule')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/coursemodule.html">coursemodule</a>]);
<a name="l930"><span class="linenum"> 930</span></a>                  <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a> .= <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box')" href="../../_functions/box.html" onMouseOver="funcPopup(event,'box')">box</a>(<a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="phpfunction" onClick="logFunction('link')" href="../../_functions/link.html" onMouseOver="phpfuncPopup(event,'link')">link</a>(<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>, <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('viewallresponses', 'choice', <a class="var it744" onMouseOver="hilite(744)" onMouseOut="lolite()" onClick="logVariable('attempts')" href="../../_variables/attempts.html">$attempts</a>)), 'info');
<a name="l931"><span class="linenum"> 931</span></a>  
<a name="l932"><span class="linenum"> 932</span></a>              } else if (<a class="function" onClick="logFunction('has_capability')" href="../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('mod/choice:choose', <a class="class" onClick="logClass('context_module')" href="../../_classes/context_module.html" onMouseOver="classPopup(event,'context_module')">context_module</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('coursemodule')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/coursemodule.html">coursemodule</a>))) {
<a name="l933"><span class="linenum"> 933</span></a>  <span class="comment">                // See if the user has submitted anything.</span>
<a name="l934"><span class="linenum"> 934</span></a>                  <a class="var it454" onMouseOver="hilite(454)" onMouseOut="lolite()" onClick="logVariable('answers')" href="../../_variables/answers.html">$answers</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('count_records')" href="../../_functions/count_records.html" onMouseOver="funcPopup(event,'count_records')">count_records</a>('choice_answers', array('choiceid' =&gt; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'userid' =&gt; <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l935"><span class="linenum"> 935</span></a>                  if (<a class="var it454" onMouseOver="hilite(454)" onMouseOut="lolite()" onClick="logVariable('answers')" href="../../_variables/answers.html">$answers</a> &gt; 0) {
<a name="l936"><span class="linenum"> 936</span></a>  <span class="comment">                    // User has already selected an answer, nothing to show.</span>
<a name="l937"><span class="linenum"> 937</span></a>                      <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a> = '';
<a name="l938"><span class="linenum"> 938</span></a>                  } else {
<a name="l939"><span class="linenum"> 939</span></a>  <span class="comment">                    // User has not made a selection yet.</span>
<a name="l940"><span class="linenum"> 940</span></a>                      <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a> .= <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box')" href="../../_functions/box.html" onMouseOver="funcPopup(event,'box')">box</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('notanswered', 'choice'), 'info');
<a name="l941"><span class="linenum"> 941</span></a>                  }
<a name="l942"><span class="linenum"> 942</span></a>              } else {
<a name="l943"><span class="linenum"> 943</span></a>  <span class="comment">                // Does not have permission to do anything on this choice activity.</span>
<a name="l944"><span class="linenum"> 944</span></a>                  <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a> = '';
<a name="l945"><span class="linenum"> 945</span></a>              }
<a name="l946"><span class="linenum"> 946</span></a>  
<a name="l947"><span class="linenum"> 947</span></a>  <span class="comment">            // Make sure we have something to display.</span>
<a name="l948"><span class="linenum"> 948</span></a>              if (!empty(<a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a>)) {
<a name="l949"><span class="linenum"> 949</span></a>  <span class="comment">                // Generate the containing div.</span>
<a name="l950"><span class="linenum"> 950</span></a>                  <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a> = <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box')" href="../../_functions/box.html" onMouseOver="funcPopup(event,'box')">box</a>(<a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a>, 'choice overview');
<a name="l951"><span class="linenum"> 951</span></a>  
<a name="l952"><span class="linenum"> 952</span></a>                  if (empty(<a class="var it9833" onMouseOver="hilite(9833)" onMouseOut="lolite()" onClick="logVariable('htmlarray')" href="../../_variables/htmlarray.html">$htmlarray</a>[<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('course')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>]['choice'])) {
<a name="l953"><span class="linenum"> 953</span></a>                      <a class="var it9833" onMouseOver="hilite(9833)" onMouseOut="lolite()" onClick="logVariable('htmlarray')" href="../../_variables/htmlarray.html">$htmlarray</a>[<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('course')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>]['choice'] = <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a>;
<a name="l954"><span class="linenum"> 954</span></a>                  } else {
<a name="l955"><span class="linenum"> 955</span></a>                      <a class="var it9833" onMouseOver="hilite(9833)" onMouseOut="lolite()" onClick="logVariable('htmlarray')" href="../../_variables/htmlarray.html">$htmlarray</a>[<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('course')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/course.html">course</a>]['choice'] .= <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a>;
<a name="l956"><span class="linenum"> 956</span></a>                  }
<a name="l957"><span class="linenum"> 957</span></a>              }
<a name="l958"><span class="linenum"> 958</span></a>          }
<a name="l959"><span class="linenum"> 959</span></a>      }
<a name="l960"><span class="linenum"> 960</span></a>      return;
<a name="l961"><span class="linenum"> 961</span></a>  }
<a name="l962"><span class="linenum"> 962</span></a>  
<a name="l963"><span class="linenum"> 963</span></a>  
<a name="l964"><span class="linenum"> 964</span></a>  <span class="comment">/**</span>
<a name="l965"><span class="linenum"> 965</span></a>  <span class="comment"> * Get my responses on a given choice.</span>
<a name="l966"><span class="linenum"> 966</span></a>  <span class="comment"> *</span>
<a name="l967"><span class="linenum"> 967</span></a>  <span class="comment"> * @param stdClass $choice Choice record</span>
<a name="l968"><span class="linenum"> 968</span></a>  <span class="comment"> * @return array of choice answers records</span>
<a name="l969"><span class="linenum"> 969</span></a>  <span class="comment"> * @since  Moodle 3.0</span>
<a name="l970"><span class="linenum"> 970</span></a>  <span class="comment"> */</span>
<a name="l971"><span class="linenum"> 971</span></a>  function <a class="function" onClick="logFunction('choice_get_my_response')" href="../../_functions/choice_get_my_response.html" onMouseOver="funcPopup(event,'choice_get_my_response')">choice_get_my_response</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>) {
<a name="l972"><span class="linenum"> 972</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>;
<a name="l973"><span class="linenum"> 973</span></a>      return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('choice_answers', array('choiceid' =&gt; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'userid' =&gt; <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l974"><span class="linenum"> 974</span></a>  }
<a name="l975"><span class="linenum"> 975</span></a>  
<a name="l976"><span class="linenum"> 976</span></a>  
<a name="l977"><span class="linenum"> 977</span></a>  <span class="comment">/**</span>
<a name="l978"><span class="linenum"> 978</span></a>  <span class="comment"> * Get all the responses on a given choice.</span>
<a name="l979"><span class="linenum"> 979</span></a>  <span class="comment"> *</span>
<a name="l980"><span class="linenum"> 980</span></a>  <span class="comment"> * @param stdClass $choice Choice record</span>
<a name="l981"><span class="linenum"> 981</span></a>  <span class="comment"> * @return array of choice answers records</span>
<a name="l982"><span class="linenum"> 982</span></a>  <span class="comment"> * @since  Moodle 3.0</span>
<a name="l983"><span class="linenum"> 983</span></a>  <span class="comment"> */</span>
<a name="l984"><span class="linenum"> 984</span></a>  function <a class="function" onClick="logFunction('choice_get_all_responses')" href="../../_functions/choice_get_all_responses.html" onMouseOver="funcPopup(event,'choice_get_all_responses')">choice_get_all_responses</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>) {
<a name="l985"><span class="linenum"> 985</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l986"><span class="linenum"> 986</span></a>      return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('choice_answers', array('choiceid' =&gt; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('id')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l987"><span class="linenum"> 987</span></a>  }
<a name="l988"><span class="linenum"> 988</span></a>  
<a name="l989"><span class="linenum"> 989</span></a>  
<a name="l990"><span class="linenum"> 990</span></a>  <span class="comment">/**</span>
<a name="l991"><span class="linenum"> 991</span></a>  <span class="comment"> * Return true if we are allowd to view the choice results.</span>
<a name="l992"><span class="linenum"> 992</span></a>  <span class="comment"> *</span>
<a name="l993"><span class="linenum"> 993</span></a>  <span class="comment"> * @param stdClass $choice Choice record</span>
<a name="l994"><span class="linenum"> 994</span></a>  <span class="comment"> * @param rows|null $current my choice responses</span>
<a name="l995"><span class="linenum"> 995</span></a>  <span class="comment"> * @param bool|null $choiceopen if the choice is open</span>
<a name="l996"><span class="linenum"> 996</span></a>  <span class="comment"> * @return bool true if we can view the results, false otherwise.</span>
<a name="l997"><span class="linenum"> 997</span></a>  <span class="comment"> * @since  Moodle 3.0</span>
<a name="l998"><span class="linenum"> 998</span></a>  <span class="comment"> */</span>
<a name="l999"><span class="linenum"> 999</span></a>  function <a class="function" onClick="logFunction('choice_can_view_results')" href="../../_functions/choice_can_view_results.html" onMouseOver="funcPopup(event,'choice_can_view_results')">choice_can_view_results</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>, <a class="var it397" onMouseOver="hilite(397)" onMouseOut="lolite()" onClick="logVariable('current')" href="../../_variables/current.html">$current</a> = null, <a class="var it24061" onMouseOver="hilite(24061)" onMouseOut="lolite()" onClick="logVariable('choiceopen')" href="../../_variables/choiceopen.html">$choiceopen</a> = null) {
<a name="l1000"><span class="linenum">1000</span></a>  
<a name="l1001"><span class="linenum">1001</span></a>      if (<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it24061" onMouseOver="hilite(24061)" onMouseOut="lolite()" onClick="logVariable('choiceopen')" href="../../_variables/choiceopen.html">$choiceopen</a>)) {
<a name="l1002"><span class="linenum">1002</span></a>          <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l1003"><span class="linenum">1003</span></a>          if (<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('timeclose')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/timeclose.html">timeclose</a> != 0 &amp;&amp; <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a> &gt; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('timeclose')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/timeclose.html">timeclose</a>) {
<a name="l1004"><span class="linenum">1004</span></a>              <a class="var it24061" onMouseOver="hilite(24061)" onMouseOut="lolite()" onClick="logVariable('choiceopen')" href="../../_variables/choiceopen.html">$choiceopen</a> = false;
<a name="l1005"><span class="linenum">1005</span></a>          } else {
<a name="l1006"><span class="linenum">1006</span></a>              <a class="var it24061" onMouseOver="hilite(24061)" onMouseOut="lolite()" onClick="logVariable('choiceopen')" href="../../_variables/choiceopen.html">$choiceopen</a> = true;
<a name="l1007"><span class="linenum">1007</span></a>          }
<a name="l1008"><span class="linenum">1008</span></a>      }
<a name="l1009"><span class="linenum">1009</span></a>      if (empty(<a class="var it397" onMouseOver="hilite(397)" onMouseOut="lolite()" onClick="logVariable('current')" href="../../_variables/current.html">$current</a>)) {
<a name="l1010"><span class="linenum">1010</span></a>          <a class="var it397" onMouseOver="hilite(397)" onMouseOut="lolite()" onClick="logVariable('current')" href="../../_variables/current.html">$current</a> = <a class="function" onClick="logFunction('choice_get_my_response')" href="../../_functions/choice_get_my_response.html" onMouseOver="funcPopup(event,'choice_get_my_response')">choice_get_my_response</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>);
<a name="l1011"><span class="linenum">1011</span></a>      }
<a name="l1012"><span class="linenum">1012</span></a>  
<a name="l1013"><span class="linenum">1013</span></a>      if (<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('showresults')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/showresults.html">showresults</a> == <a class="constant" onClick="logConstant('CHOICE_SHOWRESULTS_ALWAYS')" href="../../_constants/CHOICE_SHOWRESULTS_ALWAYS.html" onMouseOver="constPopup(event,'CHOICE_SHOWRESULTS_ALWAYS')">CHOICE_SHOWRESULTS_ALWAYS</a> or
<a name="l1014"><span class="linenum">1014</span></a>         (<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('showresults')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/showresults.html">showresults</a> == <a class="constant" onClick="logConstant('CHOICE_SHOWRESULTS_AFTER_ANSWER')" href="../../_constants/CHOICE_SHOWRESULTS_AFTER_ANSWER.html" onMouseOver="constPopup(event,'CHOICE_SHOWRESULTS_AFTER_ANSWER')">CHOICE_SHOWRESULTS_AFTER_ANSWER</a> and !empty(<a class="var it397" onMouseOver="hilite(397)" onMouseOut="lolite()" onClick="logVariable('current')" href="../../_variables/current.html">$current</a>)) or
<a name="l1015"><span class="linenum">1015</span></a>         (<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('showresults')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/showresults.html">showresults</a> == <a class="constant" onClick="logConstant('CHOICE_SHOWRESULTS_AFTER_CLOSE')" href="../../_constants/CHOICE_SHOWRESULTS_AFTER_CLOSE.html" onMouseOver="constPopup(event,'CHOICE_SHOWRESULTS_AFTER_CLOSE')">CHOICE_SHOWRESULTS_AFTER_CLOSE</a> and !<a class="var it24061" onMouseOver="hilite(24061)" onMouseOut="lolite()" onClick="logVariable('choiceopen')" href="../../_variables/choiceopen.html">$choiceopen</a>)) {
<a name="l1016"><span class="linenum">1016</span></a>          return true;
<a name="l1017"><span class="linenum">1017</span></a>      }
<a name="l1018"><span class="linenum">1018</span></a>      return false;
<a name="l1019"><span class="linenum">1019</span></a>  }
<a name="l1020"><span class="linenum">1020</span></a>  
<a name="l1021"><span class="linenum">1021</span></a>  <span class="comment">/**</span>
<a name="l1022"><span class="linenum">1022</span></a>  <span class="comment"> * Mark the activity completed (if required) and trigger the course_module_viewed event.</span>
<a name="l1023"><span class="linenum">1023</span></a>  <span class="comment"> *</span>
<a name="l1024"><span class="linenum">1024</span></a>  <span class="comment"> * @param  stdClass $choice     choice object</span>
<a name="l1025"><span class="linenum">1025</span></a>  <span class="comment"> * @param  stdClass $course     course object</span>
<a name="l1026"><span class="linenum">1026</span></a>  <span class="comment"> * @param  stdClass $cm         course module object</span>
<a name="l1027"><span class="linenum">1027</span></a>  <span class="comment"> * @param  stdClass $context    context object</span>
<a name="l1028"><span class="linenum">1028</span></a>  <span class="comment"> * @since Moodle 3.0</span>
<a name="l1029"><span class="linenum">1029</span></a>  <span class="comment"> */</span>
<a name="l1030"><span class="linenum">1030</span></a>  function <a class="function" onClick="logFunction('choice_view')" href="../../_functions/choice_view.html" onMouseOver="funcPopup(event,'choice_view')">choice_view</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>, <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>) {
<a name="l1031"><span class="linenum">1031</span></a>  
<a name="l1032"><span class="linenum">1032</span></a>  <span class="comment">    // Trigger course_module_viewed event.</span>
<a name="l1033"><span class="linenum">1033</span></a>      <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array(
<a name="l1034"><span class="linenum">1034</span></a>          'context' =&gt; <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>,
<a name="l1035"><span class="linenum">1035</span></a>          'objectid' =&gt; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;id
<a name="l1036"><span class="linenum">1036</span></a>      );
<a name="l1037"><span class="linenum">1037</span></a>  
<a name="l1038"><span class="linenum">1038</span></a>      <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a> = \mod_choice\event\<a class="class" onClick="logClass('course_module_viewed')" href="../../_classes/course_module_viewed.html" onMouseOver="classPopup(event,'course_module_viewed')">course_module_viewed</a>::<a class="function" onClick="logFunction('create')" href="../../_functions/create.html" onMouseOver="funcPopup(event,'create')">create</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l1039"><span class="linenum">1039</span></a>      <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('course_modules', <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>);
<a name="l1040"><span class="linenum">1040</span></a>      <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('course', <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>);
<a name="l1041"><span class="linenum">1041</span></a>      <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('add_record_snapshot')" href="../../_functions/add_record_snapshot.html" onMouseOver="funcPopup(event,'add_record_snapshot')">add_record_snapshot</a>('choice', <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>);
<a name="l1042"><span class="linenum">1042</span></a>      <a class="var it165" onMouseOver="hilite(165)" onMouseOut="lolite()" onClick="logVariable('event')" href="../../_variables/event.html">$event</a>-&gt;<a class="function" onClick="logFunction('trigger')" href="../../_functions/trigger.html" onMouseOver="funcPopup(event,'trigger')">trigger</a>();
<a name="l1043"><span class="linenum">1043</span></a>  
<a name="l1044"><span class="linenum">1044</span></a>  <span class="comment">    // Completion.</span>
<a name="l1045"><span class="linenum">1045</span></a>      <a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a> = <span class="keyword">new </span><a class="class" onClick="logClass('completion_info')" href="../../_classes/completion_info.html" onMouseOver="classPopup(event,'completion_info')">completion_info</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../_variables/course.html">$course</a>);
<a name="l1046"><span class="linenum">1046</span></a>      <a class="var it555" onMouseOver="hilite(555)" onMouseOut="lolite()" onClick="logVariable('completion')" href="../../_variables/completion.html">$completion</a>-&gt;<a class="function" onClick="logFunction('set_module_viewed')" href="../../_functions/set_module_viewed.html" onMouseOver="funcPopup(event,'set_module_viewed')">set_module_viewed</a>(<a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../_variables/cm.html">$cm</a>);
<a name="l1047"><span class="linenum">1047</span></a>  }
<a name="l1048"><span class="linenum">1048</span></a>  
<a name="l1049"><span class="linenum">1049</span></a>  <span class="comment">/**</span>
<a name="l1050"><span class="linenum">1050</span></a>  <span class="comment"> * Check if a choice is available for the current user.</span>
<a name="l1051"><span class="linenum">1051</span></a>  <span class="comment"> *</span>
<a name="l1052"><span class="linenum">1052</span></a>  <span class="comment"> * @param  stdClass  $choice            choice record</span>
<a name="l1053"><span class="linenum">1053</span></a>  <span class="comment"> * @return array                       status (available or not and possible warnings)</span>
<a name="l1054"><span class="linenum">1054</span></a>  <span class="comment"> */</span>
<a name="l1055"><span class="linenum">1055</span></a>  function <a class="function" onClick="logFunction('choice_get_availability_status')" href="../../_functions/choice_get_availability_status.html" onMouseOver="funcPopup(event,'choice_get_availability_status')">choice_get_availability_status</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>) {
<a name="l1056"><span class="linenum">1056</span></a>      <a class="var it1211" onMouseOver="hilite(1211)" onMouseOut="lolite()" onClick="logVariable('available')" href="../../_variables/available.html">$available</a> = true;
<a name="l1057"><span class="linenum">1057</span></a>      <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../../_variables/warnings.html">$warnings</a> = array();
<a name="l1058"><span class="linenum">1058</span></a>  
<a name="l1059"><span class="linenum">1059</span></a>      <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l1060"><span class="linenum">1060</span></a>  
<a name="l1061"><span class="linenum">1061</span></a>      if (!empty(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('timeopen')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/timeopen.html">timeopen</a>) &amp;&amp; (<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('timeopen')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/timeopen.html">timeopen</a> &gt; <a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a>)) {
<a name="l1062"><span class="linenum">1062</span></a>          <a class="var it1211" onMouseOver="hilite(1211)" onMouseOut="lolite()" onClick="logVariable('available')" href="../../_variables/available.html">$available</a> = false;
<a name="l1063"><span class="linenum">1063</span></a>          <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../../_variables/warnings.html">$warnings</a>['notopenyet'] = <a class="function" onClick="logFunction('userdate')" href="../../_functions/userdate.html" onMouseOver="funcPopup(event,'userdate')">userdate</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('timeopen')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/timeopen.html">timeopen</a>);
<a name="l1064"><span class="linenum">1064</span></a>      } else if (!empty(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('timeclose')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/timeclose.html">timeclose</a>) &amp;&amp; (<a class="var it1858" onMouseOver="hilite(1858)" onMouseOut="lolite()" onClick="logVariable('timenow')" href="../../_variables/timenow.html">$timenow</a> &gt; <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('timeclose')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/timeclose.html">timeclose</a>)) {
<a name="l1065"><span class="linenum">1065</span></a>          <a class="var it1211" onMouseOver="hilite(1211)" onMouseOut="lolite()" onClick="logVariable('available')" href="../../_variables/available.html">$available</a> = false;
<a name="l1066"><span class="linenum">1066</span></a>          <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../../_variables/warnings.html">$warnings</a>['expired'] = <a class="function" onClick="logFunction('userdate')" href="../../_functions/userdate.html" onMouseOver="funcPopup(event,'userdate')">userdate</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('timeclose')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/timeclose.html">timeclose</a>);
<a name="l1067"><span class="linenum">1067</span></a>      }
<a name="l1068"><span class="linenum">1068</span></a>      if (!<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>-&gt;<a onClick="logVariable('allowupdate')" class="var it43385" onMouseOver="hilite(43385)" onMouseOut="lolite()" href="../../_variables/allowupdate.html">allowupdate</a> &amp;&amp; <a class="function" onClick="logFunction('choice_get_my_response')" href="../../_functions/choice_get_my_response.html" onMouseOver="funcPopup(event,'choice_get_my_response')">choice_get_my_response</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>)) {
<a name="l1069"><span class="linenum">1069</span></a>          <a class="var it1211" onMouseOver="hilite(1211)" onMouseOut="lolite()" onClick="logVariable('available')" href="../../_variables/available.html">$available</a> = false;
<a name="l1070"><span class="linenum">1070</span></a>          <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../../_variables/warnings.html">$warnings</a>['choicesaved'] = '';
<a name="l1071"><span class="linenum">1071</span></a>      }
<a name="l1072"><span class="linenum">1072</span></a>  
<a name="l1073"><span class="linenum">1073</span></a>  <span class="comment">    // Choice is available.</span>
<a name="l1074"><span class="linenum">1074</span></a>      return array(<a class="var it1211" onMouseOver="hilite(1211)" onMouseOut="lolite()" onClick="logVariable('available')" href="../../_variables/available.html">$available</a>, <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../../_variables/warnings.html">$warnings</a>);
<a name="l1075"><span class="linenum">1075</span></a>  }
<a name="l1076"><span class="linenum">1076</span></a>  
<a name="l1077"><span class="linenum">1077</span></a>  <span class="comment">/**</span>
<a name="l1078"><span class="linenum">1078</span></a>  <span class="comment"> * This standard function will check all instances of this module</span>
<a name="l1079"><span class="linenum">1079</span></a>  <span class="comment"> * and make sure there are up-to-date events created for each of them.</span>
<a name="l1080"><span class="linenum">1080</span></a>  <span class="comment"> * If courseid = 0, then every chat event in the site is checked, else</span>
<a name="l1081"><span class="linenum">1081</span></a>  <span class="comment"> * only chat events belonging to the course specified are checked.</span>
<a name="l1082"><span class="linenum">1082</span></a>  <span class="comment"> * This function is used, in its new format, by restore_refresh_events()</span>
<a name="l1083"><span class="linenum">1083</span></a>  <span class="comment"> *</span>
<a name="l1084"><span class="linenum">1084</span></a>  <span class="comment"> * @param int $courseid</span>
<a name="l1085"><span class="linenum">1085</span></a>  <span class="comment"> * @return bool</span>
<a name="l1086"><span class="linenum">1086</span></a>  <span class="comment"> */</span>
<a name="l1087"><span class="linenum">1087</span></a>  function <a class="function" onClick="logFunction('choice_refresh_events')" href="../../_functions/choice_refresh_events.html" onMouseOver="funcPopup(event,'choice_refresh_events')">choice_refresh_events</a>(<a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a> = 0) {
<a name="l1088"><span class="linenum">1088</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l1089"><span class="linenum">1089</span></a>      require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../mod/choice/locallib.php.html">/mod/choice/locallib.php</a>');
<a name="l1090"><span class="linenum">1090</span></a>  
<a name="l1091"><span class="linenum">1091</span></a>      if (<a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>) {
<a name="l1092"><span class="linenum">1092</span></a>          if (! <a class="var it1191" onMouseOver="hilite(1191)" onMouseOut="lolite()" onClick="logVariable('choices')" href="../../_variables/choices.html">$choices</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>(&quot;choice&quot;, array(&quot;course&quot; =&gt; <a class="var it700" onMouseOver="hilite(700)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>))) {
<a name="l1093"><span class="linenum">1093</span></a>              return true;
<a name="l1094"><span class="linenum">1094</span></a>          }
<a name="l1095"><span class="linenum">1095</span></a>      } else {
<a name="l1096"><span class="linenum">1096</span></a>          if (! <a class="var it1191" onMouseOver="hilite(1191)" onMouseOut="lolite()" onClick="logVariable('choices')" href="../../_variables/choices.html">$choices</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>(&quot;choice&quot;)) {
<a name="l1097"><span class="linenum">1097</span></a>              return true;
<a name="l1098"><span class="linenum">1098</span></a>          }
<a name="l1099"><span class="linenum">1099</span></a>      }
<a name="l1100"><span class="linenum">1100</span></a>  
<a name="l1101"><span class="linenum">1101</span></a>      foreach (<a class="var it1191" onMouseOver="hilite(1191)" onMouseOut="lolite()" onClick="logVariable('choices')" href="../../_variables/choices.html">$choices</a> as <a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>) {
<a name="l1102"><span class="linenum">1102</span></a>          <a class="function" onClick="logFunction('choice_set_events')" href="../../_functions/choice_set_events.html" onMouseOver="funcPopup(event,'choice_set_events')">choice_set_events</a>(<a class="var it1330" onMouseOver="hilite(1330)" onMouseOut="lolite()" onClick="logVariable('choice')" href="../../_variables/choice.html">$choice</a>);
<a name="l1103"><span class="linenum">1103</span></a>      }
<a name="l1104"><span class="linenum">1104</span></a>      return true;
<a name="l1105"><span class="linenum">1105</span></a>  }
<a name="l1106"><span class="linenum">1106</span></a>  
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'join': ['join', 'Join a room. For internal use by the Games SDK only. Calling this method directly is unsupported. (rooms.join) ', [['lib/google/src/Google/Service','Games.php',1716],['lib/google/src/Google/Service','Games.php',2100]], 1030],
'trigger': ['trigger', '', [['lib/evalmath','evalmath.class.php',448],['lib/classes/event','base.php',765]], 964],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required, Some conversions and safety checks are carried out. Lobs are supported. If the return ID isn\'t required, then this just reports success as true/false. $data is an object containing needed data ', [['lib/dml','pdo_moodle_database.php',387],['lib/dml','oci_native_moodle_database.php',1297],['lib/dml','pgsql_native_moodle_database.php',889],['lib/dml','mssql_native_moodle_database.php',962],['lib/dml','mysqli_native_moodle_database.php',1185],['question/engine/upgrade','upgradelib.php',124],['lib/dml','sqlsrv_native_moodle_database.php',1045],['lib/dml/tests','dml_test.php',5548]], 1611],
'choice_get_all_responses': ['choice_get_all_responses', 'Get all the responses on a given choice. ', [['mod/choice','lib.php',977]], 2],
'choice_refresh_events': ['choice_refresh_events', 'This standard function will check all instances of this module and make sure there are up-to-date events created for each of them. If courseid = 0, then every chat event in the site is checked, else only chat events belonging to the course specified are checked. This function is used, in its new format, by restore_refresh_events() ', [['mod/choice','lib.php',1077]], 0],
'choice_reset_course_form_definition': ['choice_reset_course_form_definition', 'Implementation of the function for printing the form elements that control whether the course reset functionality affects the choice. ', [['mod/choice','lib.php',674]], 0],
'count_records': ['count_records', 'Count a list of records. ', [['competency/classes','persistent.php',815],['mod/glossary/classes','entry_query_builder.php',152],['lib/dml','moodle_database.php',1766]], 1630],
'print_error': ['print_error', 'Abort execution by throwing of a general exception, default exception handler displays the error message in most cases. ', [['lib','setuplib.php',481]], 1488],
'groups_get_activity_groupmode': ['groups_get_activity_groupmode', 'Returns effective groupmode used in activity, course setting overrides activity setting if groupmodeforce enabled. ', [['lib','grouplib.php',468]], 136],
'choice_get_view_actions': ['choice_get_view_actions', 'List the actions that correspond to a view of this module. This is used by the participation report. ', [['mod/choice','lib.php',645]], 0],
'get_all_instances_in_courses': ['get_all_instances_in_courses', 'Returns an array of all the active instances of a particular module in given courses, sorted in the order they are defined ', [['lib','datalib.php',1382]], 23],
'choice_supports': ['choice_supports', '', [['mod/choice','lib.php',799]], 0],
'format_string': ['format_string', 'Given a simple string, this function returns the string processed by enabled string filters if $CFG->filterall is enabled ', [['lib','weblib.php',1379]], 880],
'userdate': ['userdate', 'Returns a formatted string that represents a date in user time. ', [['lib','moodlelib.php',2155],['lib/adodb','adodb.inc.php',2842],['lib/adodb','adodb.inc.php',3569]], 525],
'set_field': ['set_field', 'Set a single field in every table record where all the given conditions met. ', [['lib/dml','moodle_database.php',1737],['availability/condition/profile/tests','condition_test.php',349]], 485],
'choice_get_my_response': ['choice_get_my_response', 'Get my responses on a given choice. ', [['mod/choice','lib.php',964]], 15],
'choice_show_reportlink': ['choice_show_reportlink', '', [['mod/choice','lib.php',451]], 1],
'addelement': ['addelement', 'Adds a custom element to your HTML definition ', [['lib/htmlpurifier/HTMLPurifier','HTMLDefinition.php',124],['lib/htmlpurifier/HTMLPurifier','HTMLModule.php',130],['lib/pear/HTML','QuickForm.php',592]], 3302],
'choice_get_extra_capabilities': ['choice_get_extra_capabilities', 'Returns all other caps used in module ', [['mod/choice','lib.php',780]], 0],
'choice_page_type_list': ['choice_page_type_list', 'Return a list of page types ', [['mod/choice','lib.php',877]], 0],
'is_enabled': ['is_enabled', 'Tools cannot be disabled. ', [['lib/classes/plugininfo','tool.php',39],['admin/tool/recyclebin/classes','category_bin.php',54],['admin/tool/log/classes/plugininfo','logstore.php',35],['admin/tool/recyclebin/classes','course_bin.php',54],['mod/assign/feedback/offline','locallib.php',380],['admin/tool/recyclebin/classes','base_bin.php',38],['lib','adminlib.php',1955],['search/classes','base.php',190],['lib','medialib.php',318],['lib','medialib.php',635],['lib','medialib.php',1268],['admin/tool/health','index.php',393],['lib/classes/plugininfo','mnetservice.php',33],['lib/classes/message/inbound','manager.php',37],['mod/assignment/classes/plugininfo','assignment.php',32],['competency/classes','api.php',49],['mod/assign','assignmentplugin.php',223],['lib/classes/plugininfo','orphaned.php',37],['search/tests/fixtures','mock_search_area.php',38],['tag/classes','area.php',106],['lib/classes/plugininfo','base.php',383],['mod/assign/feedback/editpdf','locallib.php',340],['tag/classes','tag.php',1269],['mod/assign/submission/comments','locallib.php',172],['lib','completionlib.php',269]], 276],
'choice_reset_course_form_defaults': ['choice_reset_course_form_defaults', 'Course reset form defaults. ', [['mod/choice','lib.php',685]], 0],
'get_lock': ['get_lock', 'Get the current lock for this task. ', [['lib/classes/task','task_base.php',69],['lib/classes/lock','postgres_lock_factory.php',171],['lib/dml','oci_native_moodle_package.sql',41],['lib/dml','oci_native_moodle_package.sql',77],['lib/classes/lock','file_lock_factory.php',125],['lib/classes/lock','db_record_lock_factory.php',109],['lib/classes/lock','lock_factory.php',77]], 24],
'list': ['list', '', [['mod/data/preset/imagegallery','jstemplate.js',9]], 2229],
'delete_records': ['delete_records', 'Delete the records from a table where all the given conditions met. If conditions not specified, table is truncated. ', [['lib/dml','sqlite3_pdo_moodle_database.php',345],['lib/dml','moodle_database.php',1864]], 773],
'choice_user_submit_response': ['choice_user_submit_response', 'Process user submitted answers for a choice, and either updating them or saving new answers. ', [['mod/choice','lib.php',247]], 15],
'get_records_sql': ['get_records_sql', 'Get a number of records as an array of objects. ', [['lib/dml','pdo_moodle_database.php',309],['lib/dml','oci_native_moodle_database.php',1145],['lib/dml','pgsql_native_moodle_database.php',732],['lib/dml','mssql_native_moodle_database.php',805],['lib/dml','mysqli_native_moodle_database.php',1057],['lib/dml','sqlsrv_native_moodle_database.php',890],['lib/dml/tests','dml_test.php',5545]], 700],
'choice_can_view_results': ['choice_can_view_results', 'Return true if we are allowd to view the choice results. ', [['mod/choice','lib.php',990]], 8],
'groups_get_activity_group': ['groups_get_activity_group', 'Returns group active in activity, changes the group by default if \'group\' page param present ', [['lib','grouplib.php',814]], 97],
'choice_reset_userdata': ['choice_reset_userdata', 'Actual implementation of the reset course functionality, delete all the choice responses for course $data->courseid. ', [['mod/choice','lib.php',694]], 0],
'update_record': ['update_record', 'Update a record in a table ', [['lib/dml','pdo_moodle_database.php',461],['lib/dml','oci_native_moodle_database.php',1404],['lib/dml','pgsql_native_moodle_database.php',1089],['lib/dml','mssql_native_moodle_database.php',1067],['lib/dml','mysqli_native_moodle_database.php',1405],['lib/dml','sqlsrv_native_moodle_database.php',1148],['lib/dml/tests','dml_test.php',5551]], 650],
'add_record_snapshot': ['add_record_snapshot', 'Add cached data that will be most probably used in event observers. ', [['lib/classes/event','base.php',840]], 332],
'get_records': ['get_records', 'Load a list of records. ', [['competency/classes','persistent.php',709],['mod/glossary/classes','entry_query_builder.php',295],['lib/dml','moodle_database.php',1285],['lib','coursecatlib.php',651],['question','category_class.php',63]], 965],
'instance': ['instance', 'Returns an instance of the cache_factor method. ', [['cache','disabledlib.php',171],['cache','disabledlib.php',296],['lib/classes','useragent.php',101],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',80],['lib/htmlpurifier/HTMLPurifier','URISchemeRegistry.php',9],['search/classes','manager.php',109],['cache','locallib.php',52],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',53],['lib/classes','plugin_manager.php',103],['lib/htmlpurifier','HTMLPurifier.php',251],['course/format','lib.php',156],['lib/classes/update','checker.php',62],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',31],['admin/tool/installaddon/classes','installer.php',40],['lib','modinfolib.php',373],['cache/classes','helper.php',76],['lib/tests','string_manager_standard_test.php',124],['lib/portfolio','exporter.php',251],['lib/classes/update','validator.php',88],['search/classes','document_factory.php',49],['lib','accesslib.php',6235],['lib','accesslib.php',6487],['lib','accesslib.php',6665],['lib','accesslib.php',6919],['lib','accesslib.php',7180],['lib','accesslib.php',7392],['backup/cc/cc_lib','cc_utils.php',387],['backup/cc/cc_lib','cc_utils.php',443],['lib','filterlib.php',80],['search/tests/fixtures','testable_core_search.php',43],['lib/tests/fixtures','testable_update_checker.php',45],['backup/cc','validator.php',35],['cache/classes','config.php',87],['cache/classes','factory.php',114],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',29]], 4647],
'choice_delete_responses': ['choice_delete_responses', '', [['mod/choice','lib.php',520]], 6],
'choice_add_instance': ['choice_add_instance', 'Given an object containing all the necessary data, (defined by the form in mod_form.php) this function will create a new instance and return the id number of the new instance. ', [['mod/choice','lib.php',106]], 0],
'choice_get_availability_status': ['choice_get_availability_status', 'Check if a choice is available for the current user. ', [['mod/choice','lib.php',1049]], 7],
'heading': ['heading', 'Outputs a heading ', [['lib','outputrenderers.php',3072],['lib','outputrenderers.php',4364],['lib','outputrenderers.php',4552],['grade/report/singleview/classes/local/screen','screen.php',197],['grade/report/singleview/classes/local/screen','user.php',264],['grade/report/singleview/classes/local/screen','grade.php',283]], 796],
'choice_user_outline': ['choice_user_outline', '', [['mod/choice','lib.php',72]], 0],
'choice_get_post_actions': ['choice_get_post_actions', 'List the actions that correspond to a post of this module. This is used by the participation report. ', [['mod/choice','lib.php',659]], 0],
'get_string': ['get_string', 'Get String returns a requested string ', [['lib/classes','string_manager_install.php',95],['lib','moodlelib.php',6735],['lib','moodlelib.php',9695],['lib/external','externallib.php',102],['question/behaviour','behaviourbase.php',770],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38]], 20134],
'choice_get_choice': ['choice_get_choice', 'Gets a full choice record ', [['mod/choice','lib.php',623]], 18],
'add': ['add', 'Add HashTable item ', [['lib/phpexcel/PHPExcel','HashTable.php',78],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',95],['lib/horde/framework/Horde/Imap/Client','Tokenize.php',109],['lib/google/src/Google/Http','Batch.php',52],['lib/horde/framework/Horde/Imap/Client/Data/Format','List.php',37],['lib','csslib.php',1508],['lib/horde/framework/Horde/Mail/Rfc822','List.php',116],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Memory.php',33],['lib/horde/framework/Horde/Support','ConsistentHash.php',148],['lib/horde/framework/Horde','Variables.php',297],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Template.php.in',29],['lib','outputcomponents.php',2705],['lib','outputcomponents.php',3380],['lib/phpexcel/PHPExcel/Shared/PCLZip','pclzip.lib.php',436],['lib','adminlib.php',735],['lib','adminlib.php',894],['lib','adminlib.php',1446],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Cleanup.php',27],['lib/xhprof/xhprof_html/jquery','jquery-1.2.6.js',3450],['lib/horde/framework/Horde/Imap/Client/Interaction','Pipeline.php',80],['lib/google/src/Google/Service','Webmasters.php',436],['lib','navigationlib.php',304],['lib','navigationlib.php',761],['lib','navigationlib.php',3305],['lib','navigationlib.php',3583],['lib/horde/framework/Horde/Imap/Client','Ids.php',155],['backup/cc/cc_lib/gral_lib','cssparser.php',121],['lib/xhprof/xhprof_html/jquery','jquery.autocomplete.js',428],['lib/horde/framework/Horde','Stream.php',116],['comment','lib.php',679],['lib/mustache/src/Mustache','HelperCollection.php',56],['lib/htmlpurifier/HTMLPurifier','UnitConverter.php',207],['backup/cc/cc_lib','cc_utils.php',395],['backup/cc/cc_lib','cc_utils.php',454],['lib/lessphp/Output','Mapped.php',50],['lib','licenselib.php',32],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Decorator.php',50],['lib/phpexcel/PHPExcel/Reader/Excel5','MD5.php',74],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Null.php',14],['lib/horde/framework/Horde/Mail/Rfc822','GroupList.php',25],['lib/htmlpurifier/HTMLPurifier','IDAccumulator.php',31],['tag/classes','tag.php',152],['blog','locallib.php',242],['lib/classes','notification.php',50],['lib/lessphp','Output.php',18],['tag/classes/output','tagfeed.php',61],['backup/cc','validator.php',51],['lib/horde/framework/Horde/Stream','TempString.php',118],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Serializer.php',11]], 6188],
'clone': ['clone', '', [['lib/editor/tinymce/tiny_mce/3.5.11/plugins/media/js','media.js',11]], 370],
'choice_print_overview': ['choice_print_overview', 'Prints choice summaries on MyMoodle Page ', [['mod/choice','lib.php',888]], 0],
'has_capability': ['has_capability', 'Wrapper round the has_capability funciton that automatically passes in the quiz context. ', [['mod/quiz','attemptlib.php',299],['mod/quiz','attemptlib.php',922],['lib','accesslib.php',344]], 2064],
'delete_records_select': ['delete_records_select', '', [['lib/dml','pdo_moodle_database.php',208],['lib/dml','oci_native_moodle_database.php',1495],['lib/dml','pgsql_native_moodle_database.php',1162],['lib/dml','mssql_native_moodle_database.php',1146],['lib/dml','mysqli_native_moodle_database.php',1477],['lib/dml','sqlsrv_native_moodle_database.php',1220],['lib/dml/tests','dml_test.php',5553]], 163],
'choice_get_option_text': ['choice_get_option_text', 'Returns text string which is the answer that matches the id ', [['mod/choice','lib.php',605]], 7],
'release': ['release', 'Release this lock ', [['lib/classes/lock','lock.php',93],['lib/testing/classes','test_lock.php',82]], 42],
'fields': ['fields', '', [['lib/adodb/drivers','adodb-odbtp.inc.php',720],['lib/adodb/drivers','adodb-sqlite3.inc.php',403],['mod/quiz/classes','admin_review_setting.php',65],['lib/adodb/drivers','adodb-ibase.inc.php',865],['lib/adodb/drivers','adodb-postgres64.inc.php',968],['lib/adodb/drivers','adodb-odbc.inc.php',644],['lib/adodb/drivers','adodb-sqlite.inc.php',420],['lib/adodb/drivers','adodb-pdo.inc.php',742],['lib','outputcomponents.php',235],['lib/adodb/drivers','adodb-oci8po.inc.php',104],['lib/adodb/drivers','adodb-mssql.inc.php',906],['lib/adodb/drivers','adodb-mysql.inc.php',774],['lib/adodb/drivers','adodb-mssqlnative.inc.php',895],['lib/adodb/drivers','adodb-oracle.inc.php',267],['lib/adodb','adodb.inc.php',3781],['lib/adodb','adodb.inc.php',4459],['lib/adodb/drivers','adodb-ado5.inc.php',412],['lib/adodb/drivers','adodb-db2.inc.php',756],['lib/adodb/drivers','adodb-oci8.inc.php',1701],['lib/adodb/drivers','adodb-mysqli.inc.php',973],['lib/adodb/drivers','adodb-ado.inc.php',375],['lib/adodb/drivers','adodb-ads.inc.php',690]], 156],
'choice_user_complete': ['choice_user_complete', 'Callback for the "Complete" report - prints the activity summary for the given user ', [['mod/choice','lib.php',83]], 0],
'prepare_choice_show_results': ['prepare_choice_show_results', '', [['mod/choice','lib.php',475]], 3],
'get_lock_factory': ['get_lock_factory', 'Get an instance of the currently configured locking subclass. ', [['lib/classes/lock','lock_config.php',40]], 11],
'shift_course_mod_dates': ['shift_course_mod_dates', 'Change dates in module - used from course reset. ', [['lib','moodlelib.php',5026]], 10],
'is_enrolled': ['is_enrolled', 'Returns true if user is enrolled (is participating) in course this is intended for students and teachers. ', [['lib','accesslib.php',2038]], 145],
'get_in_or_equal': ['get_in_or_equal', 'Constructs \'IN()\' or \'=\' sql fragment ', [['lib/dml','oci_native_moodle_database.php',1635],['lib/dml','moodle_database.php',711]], 438],
'choice_set_events': ['choice_set_events', 'This creates new calendar events given as timeopen and timeclose by $choice. ', [['mod/choice','locallib.php',28]], 3],
'choice_get_completion_state': ['choice_get_completion_state', 'Obtains the automatic completion state for this choice based on any conditions in forum settings. ', [['mod/choice','lib.php',850]], 0],
'record_exists': ['record_exists', 'Check if a record exists by ID. ', [['competency/classes','persistent.php',842],['lib/dml','moodle_database.php',1817]], 901],
'get_enrolled_users': ['get_enrolled_users', 'Returns list of users enrolled into course. ', [['lib','accesslib.php',2439],['enrol','externallib.php',409]], 61],
'count_records_sql': ['count_records_sql', 'Get the result of a SQL SELECT COUNT(...) query. ', [['lib/dml','moodle_database.php',1796]], 155],
'choice_extend_settings_navigation': ['choice_extend_settings_navigation', 'Adds module specific settings to the settings block ', [['mod/choice','lib.php',815]], 0],
'choice_update_instance': ['choice_update_instance', 'Given an object containing all the necessary data, (defined by the form in mod_form.php) this function will update an existing instance with new data. ', [['mod/choice','lib.php',144]], 0],
'print_string': ['print_string', 'Prints out a translated string. ', [['lib','moodlelib.php',6877]], 458],
'choice_view': ['choice_view', 'Mark the activity completed (if required) and trigger the course_module_viewed event. ', [['mod/choice','lib.php',1021]], 3],
'choice_prepare_options': ['choice_prepare_options', '', [['mod/choice','lib.php',202]], 2],
'box': ['box', 'Outputs a box. ', [['lib','outputrenderers.php',3089]], 288],
'update_state': ['update_state', 'Updates (if necessary) the completion state of activity $cm for the given user. ', [['lib','completionlib.php',507]], 40],
'get_record': ['get_record', 'Load a single record. ', [['competency/classes','persistent.php',738],['lib/dml','moodle_database.php',1462]], 3224],
'create': ['create', 'Auto-scan an incoming line to determine the response type. ', [['lib/horde/framework/Horde/Imap/Client/Interaction','Server.php',65],['lib/google/src/Google/Service','Partners.php',492],['lib/simplepie/library/SimplePie','Cache.php',95],['lib/google/src/Google/Service','YouTubeReporting.php',237],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',81],['lib/google/src/Google/Service','MapsEngine.php',1677],['lib/google/src/Google/Service','MapsEngine.php',1977],['lib/google/src/Google/Service','MapsEngine.php',2253],['lib/google/src/Google/Service','MapsEngine.php',2330],['lib/google/src/Google/Service','MapsEngine.php',2898],['lib/spout/src/Spout/Writer','WriterFactory.php',18],['lib/google/src/Google/Service','Dns.php',290],['lib/google/src/Google/Service','Dns.php',363],['lib/google/src/Google/Service','Appengine.php',438],['tag/classes','collection.php',188],['lib/adodb','adodb-xmlschema.inc.php',152],['lib/adodb','adodb-xmlschema.inc.php',473],['lib/adodb','adodb-xmlschema.inc.php',738],['lib/adodb','adodb-xmlschema.inc.php',884],['lib/adodb','adodb-xmlschema.inc.php',1129],['mod/quiz','attemptlib.php',100],['mod/quiz','attemptlib.php',596],['lib','weblib.php',3206],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',58],['lib/google/src/Google/Service','Dataflow.php',273],['lib/simplepie/library/SimplePie','Registry.php',153],['competency/classes','persistent.php',387],['lib/google/src/Google/Service','Cloudresourcemanager.php',373],['lib/phpexcel/PHPExcel/Shared/PCLZip','pclzip.lib.php',270],['lib/google/src/Google/Service','TagManager.php',1007],['lib/google/src/Google/Service','TagManager.php',1097],['lib/google/src/Google/Service','TagManager.php',1249],['lib/google/src/Google/Service','TagManager.php',1342],['lib/google/src/Google/Service','TagManager.php',1436],['lib/google/src/Google/Service','TagManager.php',1530],['lib/google/src/Google/Service','TagManager.php',1681],['mod/lesson','locallib.php',1011],['mod/lesson','locallib.php',2163],['mod/lesson','locallib.php',3212],['lib','modinfolib.php',1732],['repository','lib.php',206],['repository','lib.php',1910],['lib','navigationlib.php',268],['lib/htmlpurifier/HTMLPurifier','Config.php',114],['lib/google/src/Google/Service','Container.php',284],['lib/google/src/Google/Service','Genomics.php',632],['lib/google/src/Google/Service','Genomics.php',721],['lib/google/src/Google/Service','Genomics.php',1312],['lib/google/src/Google/Service','Genomics.php',1427],['lib/google/src/Google/Service','Games.php',1649],['lib/google/src/Google/Service','Games.php',2013],['lib/google/src/Google/Service','Fitness.php',377],['lib/google/src/Google/Service','Gmail.php',747],['lib/google/src/Google/Service','Gmail.php',905],['mod/quiz/classes','structure.php',65],['lib/htmlpurifier/HTMLPurifier','ElementDef.php',135],['lib/adodb','adodb-xmlschema03.inc.php',170],['lib/adodb','adodb-xmlschema03.inc.php',514],['lib/adodb','adodb-xmlschema03.inc.php',779],['lib/adodb','adodb-xmlschema03.inc.php',930],['lib/adodb','adodb-xmlschema03.inc.php',1228],['lib/google/src/Google/Service','Proximitybeacon.php',500],['tag/classes','area.php',205],['course','lib.php',3003],['question/type/ddmarker','shapes.php',170],['lib/classes/event','base.php',149],['lib','coursecatlib.php',325],['repository/filesystem','lib.php',498],['lib/google/src/Google/Service','Storagetransfer.php',281],['calendar','lib.php',2686],['lib/htmlpurifier/HTMLPurifier','Lexer.php',53],['lib/google/src/Google/Service','Classroom.php',445],['lib/google/src/Google/Service','Classroom.php',596],['lib/google/src/Google/Service','Classroom.php',673],['lib/google/src/Google/Service','Classroom.php',783],['lib/google/src/Google/Service','Classroom.php',912],['lib/spout/src/Spout/Reader','ReaderFactory.php',18],['lib/google/src/Google/Service','Pubsub.php',220],['lib/google/src/Google/Service','Pubsub.php',365],['lib/google/src/Google/Service','CloudMonitoring.php',258]], 3276],
'choice_delete_instance': ['choice_delete_instance', 'Given an ID of an instance of this module, this function will permanently delete the instance and any data that depends on it. ', [['mod/choice','lib.php',568]], 0],
'choice_get_response_data': ['choice_get_response_data', '', [['mod/choice','lib.php',738]], 5],
'set_module_viewed': ['set_module_viewed', 'Update the module completion status (set it viewed). ', [['mod/assign','locallib.php',8075],['lib','completionlib.php',657]], 29],
'defined': ['defined', '', [], 4731],
'array_merge': ['array_merge', '', [], 2944],
'array_diff': ['array_diff', '', [], 102],
'array_keys': ['array_keys', '', [], 1256],
'array_unique': ['array_unique', '', [], 171],
'array_key_exists': ['array_key_exists', '', [], 1445],
'is_array': ['is_array', '', [], 1608],
'trim': ['trim', '', [], 1948],
'time': ['time', '', [], 1959],
'define': ['define', '', [], 2373],
'count': ['count', '', [], 4095],
'is_null': ['is_null', '', [], 2003],
'asort': ['asort', '', [], 114],
'link': ['link', '', [], 695],
'in_array': ['in_array', '', [], 1234]};
CLASS_DATA={
'html_writer': ['html_writer', 'Simple html output class ', [['lib','outputcomponents.php',1062]], 5120],
'answer_submitted': ['answer_submitted', 'The mod_choice answer submitted event class. ', [['mod/choice/classes/event','answer_submitted.php',29]], 2],
'context_module': ['context_module', 'Course module context class ', [['lib','accesslib.php',7039]], 1106],
'user_picture': ['user_picture', 'Data structure representing a user picture. ', [['lib','outputcomponents.php',142]], 165],
'lock_config': ['lock_config', 'Lock configuration class, used to get an instance of the currently configured lock factory. ', [['lib/classes/lock','lock_config.php',30]], 11],
'answer_deleted': ['answer_deleted', 'The mod_choice answer updated event class. ', [['mod/choice/classes/event','answer_deleted.php',29]], 1],
'course_module_viewed': ['course_module_viewed', 'The mod_page course module viewed event class. ', [['mod/page/classes/event','course_module_viewed.php',28],['mod/chat/classes/event','course_module_viewed.php',29],['mod/quiz/classes/event','course_module_viewed.php',29],['mod/data/classes/event','course_module_viewed.php',30],['mod/choice/classes/event','course_module_viewed.php',28],['mod/forum/classes/event','course_module_viewed.php',29],['mod/resource/classes/event','course_module_viewed.php',29],['mod/book/classes/event','course_module_viewed.php',28],['mod/imscp/classes/event','course_module_viewed.php',30],['mod/lti/classes/event','course_module_viewed.php',29],['mod/feedback/classes/event','course_module_viewed.php',28],['mod/survey/classes/event','course_module_viewed.php',29],['mod/folder/classes/event','course_module_viewed.php',29],['mod/glossary/classes/event','course_module_viewed.php',28],['mod/scorm/classes/event','course_module_viewed.php',28],['mod/url/classes/event','course_module_viewed.php',29],['mod/wiki/classes/event','course_module_viewed.php',28],['lib/tests/fixtures','event_fixtures.php',232],['mod/lesson/classes/event','course_module_viewed.php',30],['mod/workshop/classes/event','course_module_viewed.php',32]], 37],
'answer_updated': ['answer_updated', 'The mod_choice answer updated event class. ', [['mod/choice/classes/event','answer_updated.php',29]], 2],
'completion_info': ['completion_info', 'Class represents completion information for a course. ', [['lib','completionlib.php',210]], 141],
'moodle_url': ['moodle_url', 'Class for creating and manipulating urls. ', [['lib','weblib.php',238]], 3088],
'core_collator': ['core_collator', 'A collator class with static methods that can be used for sorting. ', [['lib/classes','collator.php',28]], 152]};
CONST_DATA={
'CHOICE_SHOWRESULTS_ALWAYS': ['CHOICE_SHOWRESULTS_ALWAYS', '', [['mod/choice','lib.php',40]], 6],
'MUST_EXIST': ['MUST_EXIST', '', [['lib','dmllib.php',52]], 1384],
'CHOICE_SHOWRESULTS_AFTER_CLOSE': ['CHOICE_SHOWRESULTS_AFTER_CLOSE', '', [['mod/choice','lib.php',39]], 5],
'FEATURE_GROUPS': ['FEATURE_GROUPS', '', [['lib','moodlelib.php',414]], 25],
'CHOICE_SHOWRESULTS_AFTER_ANSWER': ['CHOICE_SHOWRESULTS_AFTER_ANSWER', '', [['mod/choice','lib.php',38]], 5],
'FEATURE_COMPLETION_HAS_RULES': ['FEATURE_COMPLETION_HAS_RULES', '', [['lib','moodlelib.php',407]], 12],
'COMPLETION_COMPLETE': ['COMPLETION_COMPLETE', '', [['lib','completionlib.php',76]], 90],
'FEATURE_GROUPINGS': ['FEATURE_GROUPINGS', '', [['lib','moodlelib.php',416]], 23],
'SQL_PARAMS_NAMED': ['SQL_PARAMS_NAMED', '', [['lib/dml','moodle_database.php',32]], 315],
'CHOICE_SHOWRESULTS_NOT': ['CHOICE_SHOWRESULTS_NOT', '', [['mod/choice','lib.php',37]], 2],
'FEATURE_SHOW_DESCRIPTION': ['FEATURE_SHOW_DESCRIPTION', '', [['lib','moodlelib.php',437]], 22],
'FEATURE_MOD_INTRO': ['FEATURE_MOD_INTRO', '', [['lib','moodlelib.php',426]], 31],
'FEATURE_GRADE_OUTCOMES': ['FEATURE_GRADE_OUTCOMES', '', [['lib','moodlelib.php',396]], 23],
'COMPLETION_INCOMPLETE': ['COMPLETION_INCOMPLETE', '', [['lib','completionlib.php',70]], 53],
'CHOICE_DISPLAY_VERTICAL': ['CHOICE_DISPLAY_VERTICAL', '', [['mod/choice','lib.php',43]], 3],
'FEATURE_COMPLETION_TRACKS_VIEWS': ['FEATURE_COMPLETION_TRACKS_VIEWS', '', [['lib','moodlelib.php',405]], 23],
'FEATURE_GRADE_HAS_GRADE': ['FEATURE_GRADE_HAS_GRADE', '', [['lib','moodlelib.php',394]], 29],
'CHOICE_DISPLAY_HORIZONTAL': ['CHOICE_DISPLAY_HORIZONTAL', '', [['mod/choice','lib.php',42]], 3],
'FEATURE_BACKUP_MOODLE2': ['FEATURE_BACKUP_MOODLE2', '', [['lib','moodlelib.php',434]], 35],
'CHOICE_PUBLISH_NAMES': ['CHOICE_PUBLISH_NAMES', '', [['mod/choice','lib.php',35]], 5],
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',140],['','install.php',93],['lib','setup.php',391]], 4153],
'CHOICE_PUBLISH_ANONYMOUS': ['CHOICE_PUBLISH_ANONYMOUS', '', [['mod/choice','lib.php',34]], 2]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Aug 11 10:00:09 2016</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
