<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /message/tests/messagelib_test.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Aug 11 10:00:09 2016 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='message/tests';
filename='messagelib_test.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/message/tests/</a> -> <a href="messagelib_test.php.html">messagelib_test.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="messagelib_test.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="messagelib_test.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * Test api's in message lib.</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * @package core_message</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @category test</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @copyright 2014 Rajesh Taneja &lt;rajesh@moodle.com&gt;</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> */</span>
<a name="l25"><span class="linenum">  25</span></a>  
<a name="l26"><span class="linenum">  26</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die();
<a name="l27"><span class="linenum">  27</span></a>  
<a name="l28"><span class="linenum">  28</span></a>  global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l29"><span class="linenum">  29</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/dirroot.html">dirroot</a> . '<a class="filename" href="../../message/lib.php.html">/message/lib.php</a>');
<a name="l30"><span class="linenum">  30</span></a>  
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment">/**</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> * Test api's in message lib.</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> *</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> * @package core_message</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> * @category test</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment"> * @copyright 2014 Rajesh Taneja &lt;rajesh@moodle.com&gt;</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment"> * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment"> */</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('core_message_messagelib_testcase')" href="../../_classes/core_message_messagelib_testcase.html" onMouseOver="classPopup(event,'core_message_messagelib_testcase')">core_message_messagelib_testcase</a> extends advanced_testcase {
<a name="l40"><span class="linenum">  40</span></a>  
<a name="l41"><span class="linenum">  41</span></a>  <span class="comment">    /** @var phpunit_message_sink keep track of messages. */</span>
<a name="l42"><span class="linenum">  42</span></a>      protected <a class="var it26257" onMouseOver="hilite(26257)" onMouseOut="lolite()" onClick="logVariable('messagesink')" href="../../_variables/messagesink.html">$messagesink</a> = null;
<a name="l43"><span class="linenum">  43</span></a>  
<a name="l44"><span class="linenum">  44</span></a>      <span class="comment">/**</span>
<a name="l45"><span class="linenum">  45</span></a>  <span class="comment">     * Test set up.</span>
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment">     *</span>
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment">     * This is executed before running any test in this file.</span>
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment">     */</span>
<a name="l49"><span class="linenum">  49</span></a>      public function <a class="function" onClick="logFunction('setUp')" href="../../_functions/setup.html" onMouseOver="funcPopup(event,'setup')">setUp</a>() {
<a name="l50"><span class="linenum">  50</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('preventResetByRollback')" href="../../_functions/preventresetbyrollback.html" onMouseOver="funcPopup(event,'preventresetbyrollback')">preventResetByRollback</a>(); <span class="comment">// Messaging is not compatible with transactions.</span>
<a name="l51"><span class="linenum">  51</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('messagesink')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/messagesink.html">messagesink</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('redirectMessages')" href="../../_functions/redirectmessages.html" onMouseOver="funcPopup(event,'redirectmessages')">redirectMessages</a>();
<a name="l52"><span class="linenum">  52</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('resetAfterTest')" href="../../_functions/resetaftertest.html" onMouseOver="funcPopup(event,'resetaftertest')">resetAfterTest</a>();
<a name="l53"><span class="linenum">  53</span></a>      }
<a name="l54"><span class="linenum">  54</span></a>  
<a name="l55"><span class="linenum">  55</span></a>      <span class="comment">/**</span>
<a name="l56"><span class="linenum">  56</span></a>  <span class="comment">     * Send a fake message.</span>
<a name="l57"><span class="linenum">  57</span></a>  <span class="comment">     *</span>
<a name="l58"><span class="linenum">  58</span></a>  <span class="comment">     * {@link message_send()} does not support transaction, this function will simulate a message</span>
<a name="l59"><span class="linenum">  59</span></a>  <span class="comment">     * sent from a user to another. We should stop using it once {@link message_send()} will support</span>
<a name="l60"><span class="linenum">  60</span></a>  <span class="comment">     * transactions. This is not clean at all, this is just used to add rows to the table.</span>
<a name="l61"><span class="linenum">  61</span></a>  <span class="comment">     *</span>
<a name="l62"><span class="linenum">  62</span></a>  <span class="comment">     * @param stdClass $userfrom user object of the one sending the message.</span>
<a name="l63"><span class="linenum">  63</span></a>  <span class="comment">     * @param stdClass $userto user object of the one receiving the message.</span>
<a name="l64"><span class="linenum">  64</span></a>  <span class="comment">     * @param string $message message to send.</span>
<a name="l65"><span class="linenum">  65</span></a>  <span class="comment">     * @return int the id of the message</span>
<a name="l66"><span class="linenum">  66</span></a>  <span class="comment">     */</span>
<a name="l67"><span class="linenum">  67</span></a>      protected function <a class="function" onClick="logFunction('send_fake_message')" href="../../_functions/send_fake_message.html" onMouseOver="funcPopup(event,'send_fake_message')">send_fake_message</a>(<a class="var it6660" onMouseOver="hilite(6660)" onMouseOut="lolite()" onClick="logVariable('userfrom')" href="../../_variables/userfrom.html">$userfrom</a>, <a class="var it6922" onMouseOver="hilite(6922)" onMouseOut="lolite()" onClick="logVariable('userto')" href="../../_variables/userto.html">$userto</a>, <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../_variables/message.html">$message</a> = 'Hello world!') {
<a name="l68"><span class="linenum">  68</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l69"><span class="linenum">  69</span></a>  
<a name="l70"><span class="linenum">  70</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a> = new stdClass();
<a name="l71"><span class="linenum">  71</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('useridfrom')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/useridfrom.html">useridfrom</a> = <a class="var it6660" onMouseOver="hilite(6660)" onMouseOut="lolite()" onClick="logVariable('userfrom')" href="../../_variables/userfrom.html">$userfrom</a>-&gt;<a onClick="logVariable('id')" class="var it43355" onMouseOver="hilite(43355)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l72"><span class="linenum">  72</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('useridto')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/useridto.html">useridto</a> = <a class="var it6922" onMouseOver="hilite(6922)" onMouseOut="lolite()" onClick="logVariable('userto')" href="../../_variables/userto.html">$userto</a>-&gt;<a onClick="logVariable('id')" class="var it44088" onMouseOver="hilite(44088)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l73"><span class="linenum">  73</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('subject')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/subject.html">subject</a> = 'No subject';
<a name="l74"><span class="linenum">  74</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('fullmessage')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/fullmessage.html">fullmessage</a> = <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../_variables/message.html">$message</a>;
<a name="l75"><span class="linenum">  75</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('smallmessage')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/smallmessage.html">smallmessage</a> = <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../_variables/message.html">$message</a>;
<a name="l76"><span class="linenum">  76</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('timecreated')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l77"><span class="linenum">  77</span></a>  
<a name="l78"><span class="linenum">  78</span></a>          return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('message', <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>);
<a name="l79"><span class="linenum">  79</span></a>      }
<a name="l80"><span class="linenum">  80</span></a>  
<a name="l81"><span class="linenum">  81</span></a>      <span class="comment">/**</span>
<a name="l82"><span class="linenum">  82</span></a>  <span class="comment">     * Test message_get_blocked_users.</span>
<a name="l83"><span class="linenum">  83</span></a>  <span class="comment">     */</span>
<a name="l84"><span class="linenum">  84</span></a>      public function <a class="function" onClick="logFunction('test_message_get_blocked_users')" href="../../_functions/test_message_get_blocked_users.html" onMouseOver="funcPopup(event,'test_message_get_blocked_users')">test_message_get_blocked_users</a>() {
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment">        // Set this user as the admin.</span>
<a name="l86"><span class="linenum">  86</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('setAdminUser')" href="../../_functions/setadminuser.html" onMouseOver="funcPopup(event,'setadminuser')">setAdminUser</a>();
<a name="l87"><span class="linenum">  87</span></a>  
<a name="l88"><span class="linenum">  88</span></a>  <span class="comment">        // Create a user to add to the admin's contact list.</span>
<a name="l89"><span class="linenum">  89</span></a>          <a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>();
<a name="l90"><span class="linenum">  90</span></a>          <a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>();
<a name="l91"><span class="linenum">  91</span></a>  
<a name="l92"><span class="linenum">  92</span></a>  <span class="comment">        // Add users to the admin's contact list.</span>
<a name="l93"><span class="linenum">  93</span></a>          <a class="function" onClick="logFunction('message_add_contact')" href="../../_functions/message_add_contact.html" onMouseOver="funcPopup(event,'message_add_contact')">message_add_contact</a>(<a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a>-&gt;<a onClick="logVariable('id')" class="var it42951" onMouseOver="hilite(42951)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l94"><span class="linenum">  94</span></a>          <a class="function" onClick="logFunction('message_add_contact')" href="../../_functions/message_add_contact.html" onMouseOver="funcPopup(event,'message_add_contact')">message_add_contact</a>(<a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a>-&gt;<a onClick="logVariable('id')" class="var it42952" onMouseOver="hilite(42952)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 1);
<a name="l95"><span class="linenum">  95</span></a>  
<a name="l96"><span class="linenum">  96</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(1, <a class="function" onClick="logFunction('message_get_blocked_users')" href="../../_functions/message_get_blocked_users.html" onMouseOver="funcPopup(event,'message_get_blocked_users')">message_get_blocked_users</a>());
<a name="l97"><span class="linenum">  97</span></a>  
<a name="l98"><span class="linenum">  98</span></a>  <span class="comment">        // Block other user.</span>
<a name="l99"><span class="linenum">  99</span></a>          <a class="function" onClick="logFunction('message_block_contact')" href="../../_functions/message_block_contact.html" onMouseOver="funcPopup(event,'message_block_contact')">message_block_contact</a>(<a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a>-&gt;<a onClick="logVariable('id')" class="var it42951" onMouseOver="hilite(42951)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l100"><span class="linenum"> 100</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(2, <a class="function" onClick="logFunction('message_get_blocked_users')" href="../../_functions/message_get_blocked_users.html" onMouseOver="funcPopup(event,'message_get_blocked_users')">message_get_blocked_users</a>());
<a name="l101"><span class="linenum"> 101</span></a>  
<a name="l102"><span class="linenum"> 102</span></a>  <span class="comment">        // Test deleting users.</span>
<a name="l103"><span class="linenum"> 103</span></a>          <a class="function" onClick="logFunction('delete_user')" href="../../_functions/delete_user.html" onMouseOver="funcPopup(event,'delete_user')">delete_user</a>(<a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a>);
<a name="l104"><span class="linenum"> 104</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(1, <a class="function" onClick="logFunction('message_get_blocked_users')" href="../../_functions/message_get_blocked_users.html" onMouseOver="funcPopup(event,'message_get_blocked_users')">message_get_blocked_users</a>());
<a name="l105"><span class="linenum"> 105</span></a>      }
<a name="l106"><span class="linenum"> 106</span></a>  
<a name="l107"><span class="linenum"> 107</span></a>      <span class="comment">/**</span>
<a name="l108"><span class="linenum"> 108</span></a>  <span class="comment">     * Test message_get_contacts.</span>
<a name="l109"><span class="linenum"> 109</span></a>  <span class="comment">     */</span>
<a name="l110"><span class="linenum"> 110</span></a>      public function <a class="function" onClick="logFunction('test_message_get_contacts')" href="../../_functions/test_message_get_contacts.html" onMouseOver="funcPopup(event,'test_message_get_contacts')">test_message_get_contacts</a>() {
<a name="l111"><span class="linenum"> 111</span></a>          global <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l112"><span class="linenum"> 112</span></a>  
<a name="l113"><span class="linenum"> 113</span></a>  <span class="comment">        // Set this user as the admin.</span>
<a name="l114"><span class="linenum"> 114</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('setAdminUser')" href="../../_functions/setadminuser.html" onMouseOver="funcPopup(event,'setadminuser')">setAdminUser</a>();
<a name="l115"><span class="linenum"> 115</span></a>  
<a name="l116"><span class="linenum"> 116</span></a>          <a class="var it16330" onMouseOver="hilite(16330)" onMouseOut="lolite()" onClick="logVariable('noreplyuser')" href="../../_variables/noreplyuser.html">$noreplyuser</a> = <a class="class" onClick="logClass('core_user')" href="../../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('get_noreply_user')" href="../../_functions/get_noreply_user.html" onMouseOver="funcPopup(event,'get_noreply_user')">get_noreply_user</a>();
<a name="l117"><span class="linenum"> 117</span></a>          <a class="var it13960" onMouseOver="hilite(13960)" onMouseOut="lolite()" onClick="logVariable('supportuser')" href="../../_variables/supportuser.html">$supportuser</a> = <a class="class" onClick="logClass('core_user')" href="../../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('get_support_user')" href="../../_functions/get_support_user.html" onMouseOver="funcPopup(event,'get_support_user')">get_support_user</a>();
<a name="l118"><span class="linenum"> 118</span></a>  
<a name="l119"><span class="linenum"> 119</span></a>  <span class="comment">        // Create a user to add to the admin's contact list.</span>
<a name="l120"><span class="linenum"> 120</span></a>          <a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>();
<a name="l121"><span class="linenum"> 121</span></a>          <a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>();
<a name="l122"><span class="linenum"> 122</span></a>          <a class="var it687" onMouseOver="hilite(687)" onMouseOut="lolite()" onClick="logVariable('user3')" href="../../_variables/user3.html">$user3</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(); <span class="comment">// Stranger.</span>
<a name="l123"><span class="linenum"> 123</span></a>  
<a name="l124"><span class="linenum"> 124</span></a>  <span class="comment">        // Add users to the admin's contact list.</span>
<a name="l125"><span class="linenum"> 125</span></a>          <a class="function" onClick="logFunction('message_add_contact')" href="../../_functions/message_add_contact.html" onMouseOver="funcPopup(event,'message_add_contact')">message_add_contact</a>(<a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a>-&gt;<a onClick="logVariable('id')" class="var it42951" onMouseOver="hilite(42951)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l126"><span class="linenum"> 126</span></a>          <a class="function" onClick="logFunction('message_add_contact')" href="../../_functions/message_add_contact.html" onMouseOver="funcPopup(event,'message_add_contact')">message_add_contact</a>(<a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a>-&gt;<a onClick="logVariable('id')" class="var it42952" onMouseOver="hilite(42952)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l127"><span class="linenum"> 127</span></a>  
<a name="l128"><span class="linenum"> 128</span></a>  <span class="comment">        // Send some messages.</span>
<a name="l129"><span class="linenum"> 129</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('send_fake_message')" href="../../_functions/send_fake_message.html" onMouseOver="funcPopup(event,'send_fake_message')">send_fake_message</a>(<a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>);
<a name="l130"><span class="linenum"> 130</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('send_fake_message')" href="../../_functions/send_fake_message.html" onMouseOver="funcPopup(event,'send_fake_message')">send_fake_message</a>(<a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>);
<a name="l131"><span class="linenum"> 131</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('send_fake_message')" href="../../_functions/send_fake_message.html" onMouseOver="funcPopup(event,'send_fake_message')">send_fake_message</a>(<a class="var it687" onMouseOver="hilite(687)" onMouseOut="lolite()" onClick="logVariable('user3')" href="../../_variables/user3.html">$user3</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>);
<a name="l132"><span class="linenum"> 132</span></a>  
<a name="l133"><span class="linenum"> 133</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it31182" onMouseOver="hilite(31182)" onMouseOut="lolite()" onClick="logVariable('onlinecontacts')" href="../../_variables/onlinecontacts.html">$onlinecontacts</a>, <a class="var it31183" onMouseOver="hilite(31183)" onMouseOut="lolite()" onClick="logVariable('offlinecontacts')" href="../../_variables/offlinecontacts.html">$offlinecontacts</a>, <a class="var it24829" onMouseOver="hilite(24829)" onMouseOut="lolite()" onClick="logVariable('strangers')" href="../../_variables/strangers.html">$strangers</a>) = <a class="function" onClick="logFunction('message_get_contacts')" href="../../_functions/message_get_contacts.html" onMouseOver="funcPopup(event,'message_get_contacts')">message_get_contacts</a>();
<a name="l134"><span class="linenum"> 134</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(0, <a class="var it31182" onMouseOver="hilite(31182)" onMouseOut="lolite()" onClick="logVariable('onlinecontacts')" href="../../_variables/onlinecontacts.html">$onlinecontacts</a>);
<a name="l135"><span class="linenum"> 135</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(2, <a class="var it31183" onMouseOver="hilite(31183)" onMouseOut="lolite()" onClick="logVariable('offlinecontacts')" href="../../_variables/offlinecontacts.html">$offlinecontacts</a>);
<a name="l136"><span class="linenum"> 136</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(1, <a class="var it24829" onMouseOver="hilite(24829)" onMouseOut="lolite()" onClick="logVariable('strangers')" href="../../_variables/strangers.html">$strangers</a>);
<a name="l137"><span class="linenum"> 137</span></a>  
<a name="l138"><span class="linenum"> 138</span></a>  <span class="comment">        // Send message from noreply and support users.</span>
<a name="l139"><span class="linenum"> 139</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('send_fake_message')" href="../../_functions/send_fake_message.html" onMouseOver="funcPopup(event,'send_fake_message')">send_fake_message</a>(<a class="var it16330" onMouseOver="hilite(16330)" onMouseOut="lolite()" onClick="logVariable('noreplyuser')" href="../../_variables/noreplyuser.html">$noreplyuser</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>);
<a name="l140"><span class="linenum"> 140</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('send_fake_message')" href="../../_functions/send_fake_message.html" onMouseOver="funcPopup(event,'send_fake_message')">send_fake_message</a>(<a class="var it13960" onMouseOver="hilite(13960)" onMouseOut="lolite()" onClick="logVariable('supportuser')" href="../../_variables/supportuser.html">$supportuser</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>);
<a name="l141"><span class="linenum"> 141</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it31182" onMouseOver="hilite(31182)" onMouseOut="lolite()" onClick="logVariable('onlinecontacts')" href="../../_variables/onlinecontacts.html">$onlinecontacts</a>, <a class="var it31183" onMouseOver="hilite(31183)" onMouseOut="lolite()" onClick="logVariable('offlinecontacts')" href="../../_variables/offlinecontacts.html">$offlinecontacts</a>, <a class="var it24829" onMouseOver="hilite(24829)" onMouseOut="lolite()" onClick="logVariable('strangers')" href="../../_variables/strangers.html">$strangers</a>) = <a class="function" onClick="logFunction('message_get_contacts')" href="../../_functions/message_get_contacts.html" onMouseOver="funcPopup(event,'message_get_contacts')">message_get_contacts</a>();
<a name="l142"><span class="linenum"> 142</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(0, <a class="var it31182" onMouseOver="hilite(31182)" onMouseOut="lolite()" onClick="logVariable('onlinecontacts')" href="../../_variables/onlinecontacts.html">$onlinecontacts</a>);
<a name="l143"><span class="linenum"> 143</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(2, <a class="var it31183" onMouseOver="hilite(31183)" onMouseOut="lolite()" onClick="logVariable('offlinecontacts')" href="../../_variables/offlinecontacts.html">$offlinecontacts</a>);
<a name="l144"><span class="linenum"> 144</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(3, <a class="var it24829" onMouseOver="hilite(24829)" onMouseOut="lolite()" onClick="logVariable('strangers')" href="../../_variables/strangers.html">$strangers</a>);
<a name="l145"><span class="linenum"> 145</span></a>  
<a name="l146"><span class="linenum"> 146</span></a>  <span class="comment">        // Block 1 user.</span>
<a name="l147"><span class="linenum"> 147</span></a>          <a class="function" onClick="logFunction('message_block_contact')" href="../../_functions/message_block_contact.html" onMouseOver="funcPopup(event,'message_block_contact')">message_block_contact</a>(<a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a>-&gt;<a onClick="logVariable('id')" class="var it42952" onMouseOver="hilite(42952)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l148"><span class="linenum"> 148</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it31182" onMouseOver="hilite(31182)" onMouseOut="lolite()" onClick="logVariable('onlinecontacts')" href="../../_variables/onlinecontacts.html">$onlinecontacts</a>, <a class="var it31183" onMouseOver="hilite(31183)" onMouseOut="lolite()" onClick="logVariable('offlinecontacts')" href="../../_variables/offlinecontacts.html">$offlinecontacts</a>, <a class="var it24829" onMouseOver="hilite(24829)" onMouseOut="lolite()" onClick="logVariable('strangers')" href="../../_variables/strangers.html">$strangers</a>) = <a class="function" onClick="logFunction('message_get_contacts')" href="../../_functions/message_get_contacts.html" onMouseOver="funcPopup(event,'message_get_contacts')">message_get_contacts</a>();
<a name="l149"><span class="linenum"> 149</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(0, <a class="var it31182" onMouseOver="hilite(31182)" onMouseOut="lolite()" onClick="logVariable('onlinecontacts')" href="../../_variables/onlinecontacts.html">$onlinecontacts</a>);
<a name="l150"><span class="linenum"> 150</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(1, <a class="var it31183" onMouseOver="hilite(31183)" onMouseOut="lolite()" onClick="logVariable('offlinecontacts')" href="../../_variables/offlinecontacts.html">$offlinecontacts</a>);
<a name="l151"><span class="linenum"> 151</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(3, <a class="var it24829" onMouseOver="hilite(24829)" onMouseOut="lolite()" onClick="logVariable('strangers')" href="../../_variables/strangers.html">$strangers</a>);
<a name="l152"><span class="linenum"> 152</span></a>  
<a name="l153"><span class="linenum"> 153</span></a>  <span class="comment">        // Noreply user being valid user.</span>
<a name="l154"><span class="linenum"> 154</span></a>          <a class="class" onClick="logClass('core_user')" href="../../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('reset_internal_users')" href="../../_functions/reset_internal_users.html" onMouseOver="funcPopup(event,'reset_internal_users')">reset_internal_users</a>();
<a name="l155"><span class="linenum"> 155</span></a>          <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('noreplyuserid')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/noreplyuserid.html">noreplyuserid</a> = <a class="var it687" onMouseOver="hilite(687)" onMouseOut="lolite()" onClick="logVariable('user3')" href="../../_variables/user3.html">$user3</a>-&gt;<a onClick="logVariable('id')" class="var it42956" onMouseOver="hilite(42956)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>;
<a name="l156"><span class="linenum"> 156</span></a>          <a class="var it16330" onMouseOver="hilite(16330)" onMouseOut="lolite()" onClick="logVariable('noreplyuser')" href="../../_variables/noreplyuser.html">$noreplyuser</a> = <a class="class" onClick="logClass('core_user')" href="../../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('get_noreply_user')" href="../../_functions/get_noreply_user.html" onMouseOver="funcPopup(event,'get_noreply_user')">get_noreply_user</a>();
<a name="l157"><span class="linenum"> 157</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it31182" onMouseOver="hilite(31182)" onMouseOut="lolite()" onClick="logVariable('onlinecontacts')" href="../../_variables/onlinecontacts.html">$onlinecontacts</a>, <a class="var it31183" onMouseOver="hilite(31183)" onMouseOut="lolite()" onClick="logVariable('offlinecontacts')" href="../../_variables/offlinecontacts.html">$offlinecontacts</a>, <a class="var it24829" onMouseOver="hilite(24829)" onMouseOut="lolite()" onClick="logVariable('strangers')" href="../../_variables/strangers.html">$strangers</a>) = <a class="function" onClick="logFunction('message_get_contacts')" href="../../_functions/message_get_contacts.html" onMouseOver="funcPopup(event,'message_get_contacts')">message_get_contacts</a>();
<a name="l158"><span class="linenum"> 158</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(0, <a class="var it31182" onMouseOver="hilite(31182)" onMouseOut="lolite()" onClick="logVariable('onlinecontacts')" href="../../_variables/onlinecontacts.html">$onlinecontacts</a>);
<a name="l159"><span class="linenum"> 159</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(1, <a class="var it31183" onMouseOver="hilite(31183)" onMouseOut="lolite()" onClick="logVariable('offlinecontacts')" href="../../_variables/offlinecontacts.html">$offlinecontacts</a>);
<a name="l160"><span class="linenum"> 160</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(2, <a class="var it24829" onMouseOver="hilite(24829)" onMouseOut="lolite()" onClick="logVariable('strangers')" href="../../_variables/strangers.html">$strangers</a>);
<a name="l161"><span class="linenum"> 161</span></a>  
<a name="l162"><span class="linenum"> 162</span></a>  <span class="comment">        // Test deleting users.</span>
<a name="l163"><span class="linenum"> 163</span></a>          <a class="function" onClick="logFunction('delete_user')" href="../../_functions/delete_user.html" onMouseOver="funcPopup(event,'delete_user')">delete_user</a>(<a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a>);
<a name="l164"><span class="linenum"> 164</span></a>          <a class="function" onClick="logFunction('delete_user')" href="../../_functions/delete_user.html" onMouseOver="funcPopup(event,'delete_user')">delete_user</a>(<a class="var it687" onMouseOver="hilite(687)" onMouseOut="lolite()" onClick="logVariable('user3')" href="../../_variables/user3.html">$user3</a>);
<a name="l165"><span class="linenum"> 165</span></a>  
<a name="l166"><span class="linenum"> 166</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it31182" onMouseOver="hilite(31182)" onMouseOut="lolite()" onClick="logVariable('onlinecontacts')" href="../../_variables/onlinecontacts.html">$onlinecontacts</a>, <a class="var it31183" onMouseOver="hilite(31183)" onMouseOut="lolite()" onClick="logVariable('offlinecontacts')" href="../../_variables/offlinecontacts.html">$offlinecontacts</a>, <a class="var it24829" onMouseOver="hilite(24829)" onMouseOut="lolite()" onClick="logVariable('strangers')" href="../../_variables/strangers.html">$strangers</a>) = <a class="function" onClick="logFunction('message_get_contacts')" href="../../_functions/message_get_contacts.html" onMouseOver="funcPopup(event,'message_get_contacts')">message_get_contacts</a>();
<a name="l167"><span class="linenum"> 167</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(0, <a class="var it31182" onMouseOver="hilite(31182)" onMouseOut="lolite()" onClick="logVariable('onlinecontacts')" href="../../_variables/onlinecontacts.html">$onlinecontacts</a>);
<a name="l168"><span class="linenum"> 168</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(0, <a class="var it31183" onMouseOver="hilite(31183)" onMouseOut="lolite()" onClick="logVariable('offlinecontacts')" href="../../_variables/offlinecontacts.html">$offlinecontacts</a>);
<a name="l169"><span class="linenum"> 169</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(1, <a class="var it24829" onMouseOver="hilite(24829)" onMouseOut="lolite()" onClick="logVariable('strangers')" href="../../_variables/strangers.html">$strangers</a>);
<a name="l170"><span class="linenum"> 170</span></a>      }
<a name="l171"><span class="linenum"> 171</span></a>  
<a name="l172"><span class="linenum"> 172</span></a>      <span class="comment">/**</span>
<a name="l173"><span class="linenum"> 173</span></a>  <span class="comment">     * Test message_count_messages.</span>
<a name="l174"><span class="linenum"> 174</span></a>  <span class="comment">     */</span>
<a name="l175"><span class="linenum"> 175</span></a>      public function <a class="function" onClick="logFunction('test_message_count_messages')" href="../../_functions/test_message_count_messages.html" onMouseOver="funcPopup(event,'test_message_count_messages')">test_message_count_messages</a>() {
<a name="l176"><span class="linenum"> 176</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l177"><span class="linenum"> 177</span></a>  
<a name="l178"><span class="linenum"> 178</span></a>  <span class="comment">        // Create users to send and receive message.</span>
<a name="l179"><span class="linenum"> 179</span></a>          <a class="var it6660" onMouseOver="hilite(6660)" onMouseOut="lolite()" onClick="logVariable('userfrom')" href="../../_variables/userfrom.html">$userfrom</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>();
<a name="l180"><span class="linenum"> 180</span></a>          <a class="var it6922" onMouseOver="hilite(6922)" onMouseOut="lolite()" onClick="logVariable('userto')" href="../../_variables/userto.html">$userto</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>();
<a name="l181"><span class="linenum"> 181</span></a>  
<a name="l182"><span class="linenum"> 182</span></a>          <a class="function" onClick="logFunction('message_post_message')" href="../../_functions/message_post_message.html" onMouseOver="funcPopup(event,'message_post_message')">message_post_message</a>(<a class="var it6660" onMouseOver="hilite(6660)" onMouseOut="lolite()" onClick="logVariable('userfrom')" href="../../_variables/userfrom.html">$userfrom</a>, <a class="var it6922" onMouseOver="hilite(6922)" onMouseOut="lolite()" onClick="logVariable('userto')" href="../../_variables/userto.html">$userto</a>, 'Message 1', <a class="constant" onClick="logConstant('FORMAT_PLAIN')" href="../../_constants/FORMAT_PLAIN.html" onMouseOver="constPopup(event,'FORMAT_PLAIN')">FORMAT_PLAIN</a>);
<a name="l183"><span class="linenum"> 183</span></a>          <a class="function" onClick="logFunction('message_post_message')" href="../../_functions/message_post_message.html" onMouseOver="funcPopup(event,'message_post_message')">message_post_message</a>(<a class="var it6660" onMouseOver="hilite(6660)" onMouseOut="lolite()" onClick="logVariable('userfrom')" href="../../_variables/userfrom.html">$userfrom</a>, <a class="var it6922" onMouseOver="hilite(6922)" onMouseOut="lolite()" onClick="logVariable('userto')" href="../../_variables/userto.html">$userto</a>, 'Message 2', <a class="constant" onClick="logConstant('FORMAT_PLAIN')" href="../../_constants/FORMAT_PLAIN.html" onMouseOver="constPopup(event,'FORMAT_PLAIN')">FORMAT_PLAIN</a>);
<a name="l184"><span class="linenum"> 184</span></a>          <a class="function" onClick="logFunction('message_post_message')" href="../../_functions/message_post_message.html" onMouseOver="funcPopup(event,'message_post_message')">message_post_message</a>(<a class="var it6922" onMouseOver="hilite(6922)" onMouseOut="lolite()" onClick="logVariable('userto')" href="../../_variables/userto.html">$userto</a>, <a class="var it6660" onMouseOver="hilite(6660)" onMouseOut="lolite()" onClick="logVariable('userfrom')" href="../../_variables/userfrom.html">$userfrom</a>, 'Message 3', <a class="constant" onClick="logConstant('FORMAT_PLAIN')" href="../../_constants/FORMAT_PLAIN.html" onMouseOver="constPopup(event,'FORMAT_PLAIN')">FORMAT_PLAIN</a>);
<a name="l185"><span class="linenum"> 185</span></a>  
<a name="l186"><span class="linenum"> 186</span></a>  <span class="comment">        // Return 0 when no message.</span>
<a name="l187"><span class="linenum"> 187</span></a>          <a class="var it925" onMouseOver="hilite(925)" onMouseOut="lolite()" onClick="logVariable('messages')" href="../../_variables/messages.html">$messages</a> = array();
<a name="l188"><span class="linenum"> 188</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>(0, <a class="function" onClick="logFunction('message_count_messages')" href="../../_functions/message_count_messages.html" onMouseOver="funcPopup(event,'message_count_messages')">message_count_messages</a>(<a class="var it925" onMouseOver="hilite(925)" onMouseOut="lolite()" onClick="logVariable('messages')" href="../../_variables/messages.html">$messages</a>, 'Test', 'Test'));
<a name="l189"><span class="linenum"> 189</span></a>  
<a name="l190"><span class="linenum"> 190</span></a>  <span class="comment">        // Check number of messages from userfrom and userto.</span>
<a name="l191"><span class="linenum"> 191</span></a>          <a class="var it925" onMouseOver="hilite(925)" onMouseOut="lolite()" onClick="logVariable('messages')" href="../../_variables/messages.html">$messages</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('messagesink')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/messagesink.html">messagesink</a>-&gt;<a class="function" onClick="logFunction('get_messages')" href="../../_functions/get_messages.html" onMouseOver="funcPopup(event,'get_messages')">get_messages</a>();
<a name="l192"><span class="linenum"> 192</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>(2, <a class="function" onClick="logFunction('message_count_messages')" href="../../_functions/message_count_messages.html" onMouseOver="funcPopup(event,'message_count_messages')">message_count_messages</a>(<a class="var it925" onMouseOver="hilite(925)" onMouseOut="lolite()" onClick="logVariable('messages')" href="../../_variables/messages.html">$messages</a>, 'useridfrom', <a class="var it6660" onMouseOver="hilite(6660)" onMouseOut="lolite()" onClick="logVariable('userfrom')" href="../../_variables/userfrom.html">$userfrom</a>-&gt;<a onClick="logVariable('id')" class="var it43355" onMouseOver="hilite(43355)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l193"><span class="linenum"> 193</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>(1, <a class="function" onClick="logFunction('message_count_messages')" href="../../_functions/message_count_messages.html" onMouseOver="funcPopup(event,'message_count_messages')">message_count_messages</a>(<a class="var it925" onMouseOver="hilite(925)" onMouseOut="lolite()" onClick="logVariable('messages')" href="../../_variables/messages.html">$messages</a>, 'useridfrom', <a class="var it6922" onMouseOver="hilite(6922)" onMouseOut="lolite()" onClick="logVariable('userto')" href="../../_variables/userto.html">$userto</a>-&gt;<a onClick="logVariable('id')" class="var it44088" onMouseOver="hilite(44088)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l194"><span class="linenum"> 194</span></a>      }
<a name="l195"><span class="linenum"> 195</span></a>  
<a name="l196"><span class="linenum"> 196</span></a>      <span class="comment">/**</span>
<a name="l197"><span class="linenum"> 197</span></a>  <span class="comment">     * Test message_count_unread_messages.</span>
<a name="l198"><span class="linenum"> 198</span></a>  <span class="comment">     */</span>
<a name="l199"><span class="linenum"> 199</span></a>      public function <a class="function" onClick="logFunction('test_message_count_unread_messages')" href="../../_functions/test_message_count_unread_messages.html" onMouseOver="funcPopup(event,'test_message_count_unread_messages')">test_message_count_unread_messages</a>() {
<a name="l200"><span class="linenum"> 200</span></a>  <span class="comment">        // Create users to send and receive message.</span>
<a name="l201"><span class="linenum"> 201</span></a>          <a class="var it35912" onMouseOver="hilite(35912)" onMouseOut="lolite()" onClick="logVariable('userfrom1')" href="../../_variables/userfrom1.html">$userfrom1</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>();
<a name="l202"><span class="linenum"> 202</span></a>          <a class="var it35913" onMouseOver="hilite(35913)" onMouseOut="lolite()" onClick="logVariable('userfrom2')" href="../../_variables/userfrom2.html">$userfrom2</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>();
<a name="l203"><span class="linenum"> 203</span></a>          <a class="var it6922" onMouseOver="hilite(6922)" onMouseOut="lolite()" onClick="logVariable('userto')" href="../../_variables/userto.html">$userto</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>();
<a name="l204"><span class="linenum"> 204</span></a>  
<a name="l205"><span class="linenum"> 205</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>(0, <a class="function" onClick="logFunction('message_count_unread_messages')" href="../../_functions/message_count_unread_messages.html" onMouseOver="funcPopup(event,'message_count_unread_messages')">message_count_unread_messages</a>(<a class="var it6922" onMouseOver="hilite(6922)" onMouseOut="lolite()" onClick="logVariable('userto')" href="../../_variables/userto.html">$userto</a>));
<a name="l206"><span class="linenum"> 206</span></a>  
<a name="l207"><span class="linenum"> 207</span></a>  <span class="comment">        // Send fake messages.</span>
<a name="l208"><span class="linenum"> 208</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('send_fake_message')" href="../../_functions/send_fake_message.html" onMouseOver="funcPopup(event,'send_fake_message')">send_fake_message</a>(<a class="var it35912" onMouseOver="hilite(35912)" onMouseOut="lolite()" onClick="logVariable('userfrom1')" href="../../_variables/userfrom1.html">$userfrom1</a>, <a class="var it6922" onMouseOver="hilite(6922)" onMouseOut="lolite()" onClick="logVariable('userto')" href="../../_variables/userto.html">$userto</a>);
<a name="l209"><span class="linenum"> 209</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('send_fake_message')" href="../../_functions/send_fake_message.html" onMouseOver="funcPopup(event,'send_fake_message')">send_fake_message</a>(<a class="var it35913" onMouseOver="hilite(35913)" onMouseOut="lolite()" onClick="logVariable('userfrom2')" href="../../_variables/userfrom2.html">$userfrom2</a>, <a class="var it6922" onMouseOver="hilite(6922)" onMouseOut="lolite()" onClick="logVariable('userto')" href="../../_variables/userto.html">$userto</a>);
<a name="l210"><span class="linenum"> 210</span></a>  
<a name="l211"><span class="linenum"> 211</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>(2, <a class="function" onClick="logFunction('message_count_unread_messages')" href="../../_functions/message_count_unread_messages.html" onMouseOver="funcPopup(event,'message_count_unread_messages')">message_count_unread_messages</a>(<a class="var it6922" onMouseOver="hilite(6922)" onMouseOut="lolite()" onClick="logVariable('userto')" href="../../_variables/userto.html">$userto</a>));
<a name="l212"><span class="linenum"> 212</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>(1, <a class="function" onClick="logFunction('message_count_unread_messages')" href="../../_functions/message_count_unread_messages.html" onMouseOver="funcPopup(event,'message_count_unread_messages')">message_count_unread_messages</a>(<a class="var it6922" onMouseOver="hilite(6922)" onMouseOut="lolite()" onClick="logVariable('userto')" href="../../_variables/userto.html">$userto</a>, <a class="var it35912" onMouseOver="hilite(35912)" onMouseOut="lolite()" onClick="logVariable('userfrom1')" href="../../_variables/userfrom1.html">$userfrom1</a>));
<a name="l213"><span class="linenum"> 213</span></a>      }
<a name="l214"><span class="linenum"> 214</span></a>  
<a name="l215"><span class="linenum"> 215</span></a>      <span class="comment">/**</span>
<a name="l216"><span class="linenum"> 216</span></a>  <span class="comment">     * Test message_count_blocked_users.</span>
<a name="l217"><span class="linenum"> 217</span></a>  <span class="comment">     *</span>
<a name="l218"><span class="linenum"> 218</span></a>  <span class="comment">     */</span>
<a name="l219"><span class="linenum"> 219</span></a>      public function <a class="function" onClick="logFunction('test_message_count_blocked_users')" href="../../_functions/test_message_count_blocked_users.html" onMouseOver="funcPopup(event,'test_message_count_blocked_users')">test_message_count_blocked_users</a>() {
<a name="l220"><span class="linenum"> 220</span></a>  <span class="comment">        // Set this user as the admin.</span>
<a name="l221"><span class="linenum"> 221</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('setAdminUser')" href="../../_functions/setadminuser.html" onMouseOver="funcPopup(event,'setadminuser')">setAdminUser</a>();
<a name="l222"><span class="linenum"> 222</span></a>  
<a name="l223"><span class="linenum"> 223</span></a>  <span class="comment">        // Create users to add to the admin's contact list.</span>
<a name="l224"><span class="linenum"> 224</span></a>          <a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>();
<a name="l225"><span class="linenum"> 225</span></a>          <a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>();
<a name="l226"><span class="linenum"> 226</span></a>  
<a name="l227"><span class="linenum"> 227</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>(0, <a class="function" onClick="logFunction('message_count_blocked_users')" href="../../_functions/message_count_blocked_users.html" onMouseOver="funcPopup(event,'message_count_blocked_users')">message_count_blocked_users</a>());
<a name="l228"><span class="linenum"> 228</span></a>  
<a name="l229"><span class="linenum"> 229</span></a>  <span class="comment">        // Add 1 blocked and 1 normal contact to admin's contact list.</span>
<a name="l230"><span class="linenum"> 230</span></a>          <a class="function" onClick="logFunction('message_add_contact')" href="../../_functions/message_add_contact.html" onMouseOver="funcPopup(event,'message_add_contact')">message_add_contact</a>(<a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a>-&gt;<a onClick="logVariable('id')" class="var it42951" onMouseOver="hilite(42951)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l231"><span class="linenum"> 231</span></a>          <a class="function" onClick="logFunction('message_add_contact')" href="../../_functions/message_add_contact.html" onMouseOver="funcPopup(event,'message_add_contact')">message_add_contact</a>(<a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a>-&gt;<a onClick="logVariable('id')" class="var it42952" onMouseOver="hilite(42952)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 1);
<a name="l232"><span class="linenum"> 232</span></a>  
<a name="l233"><span class="linenum"> 233</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>(0, <a class="function" onClick="logFunction('message_count_blocked_users')" href="../../_functions/message_count_blocked_users.html" onMouseOver="funcPopup(event,'message_count_blocked_users')">message_count_blocked_users</a>(<a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a>));
<a name="l234"><span class="linenum"> 234</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>(1, <a class="function" onClick="logFunction('message_count_blocked_users')" href="../../_functions/message_count_blocked_users.html" onMouseOver="funcPopup(event,'message_count_blocked_users')">message_count_blocked_users</a>());
<a name="l235"><span class="linenum"> 235</span></a>      }
<a name="l236"><span class="linenum"> 236</span></a>  
<a name="l237"><span class="linenum"> 237</span></a>      <span class="comment">/**</span>
<a name="l238"><span class="linenum"> 238</span></a>  <span class="comment">     * Test message_add_contact.</span>
<a name="l239"><span class="linenum"> 239</span></a>  <span class="comment">     */</span>
<a name="l240"><span class="linenum"> 240</span></a>      public function <a class="function" onClick="logFunction('test_message_add_contact')" href="../../_functions/test_message_add_contact.html" onMouseOver="funcPopup(event,'test_message_add_contact')">test_message_add_contact</a>() {
<a name="l241"><span class="linenum"> 241</span></a>  <span class="comment">        // Set this user as the admin.</span>
<a name="l242"><span class="linenum"> 242</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('setAdminUser')" href="../../_functions/setadminuser.html" onMouseOver="funcPopup(event,'setadminuser')">setAdminUser</a>();
<a name="l243"><span class="linenum"> 243</span></a>  
<a name="l244"><span class="linenum"> 244</span></a>  <span class="comment">        // Create a user to add to the admin's contact list.</span>
<a name="l245"><span class="linenum"> 245</span></a>          <a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>();
<a name="l246"><span class="linenum"> 246</span></a>          <a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>();
<a name="l247"><span class="linenum"> 247</span></a>          <a class="var it687" onMouseOver="hilite(687)" onMouseOut="lolite()" onClick="logVariable('user3')" href="../../_variables/user3.html">$user3</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>();
<a name="l248"><span class="linenum"> 248</span></a>  
<a name="l249"><span class="linenum"> 249</span></a>          <a class="function" onClick="logFunction('message_add_contact')" href="../../_functions/message_add_contact.html" onMouseOver="funcPopup(event,'message_add_contact')">message_add_contact</a>(<a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a>-&gt;<a onClick="logVariable('id')" class="var it42951" onMouseOver="hilite(42951)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l250"><span class="linenum"> 250</span></a>          <a class="function" onClick="logFunction('message_add_contact')" href="../../_functions/message_add_contact.html" onMouseOver="funcPopup(event,'message_add_contact')">message_add_contact</a>(<a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a>-&gt;<a onClick="logVariable('id')" class="var it42952" onMouseOver="hilite(42952)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 0);
<a name="l251"><span class="linenum"> 251</span></a>  <span class="comment">        // Add duplicate contact and make sure only 1 record exists.</span>
<a name="l252"><span class="linenum"> 252</span></a>          <a class="function" onClick="logFunction('message_add_contact')" href="../../_functions/message_add_contact.html" onMouseOver="funcPopup(event,'message_add_contact')">message_add_contact</a>(<a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a>-&gt;<a onClick="logVariable('id')" class="var it42952" onMouseOver="hilite(42952)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 1);
<a name="l253"><span class="linenum"> 253</span></a>  
<a name="l254"><span class="linenum"> 254</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertNotEmpty')" href="../../_functions/assertnotempty.html" onMouseOver="funcPopup(event,'assertnotempty')">assertNotEmpty</a>(<a class="function" onClick="logFunction('message_get_contact')" href="../../_functions/message_get_contact.html" onMouseOver="funcPopup(event,'message_get_contact')">message_get_contact</a>(<a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a>-&gt;<a onClick="logVariable('id')" class="var it42951" onMouseOver="hilite(42951)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l255"><span class="linenum"> 255</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertNotEmpty')" href="../../_functions/assertnotempty.html" onMouseOver="funcPopup(event,'assertnotempty')">assertNotEmpty</a>(<a class="function" onClick="logFunction('message_get_contact')" href="../../_functions/message_get_contact.html" onMouseOver="funcPopup(event,'message_get_contact')">message_get_contact</a>(<a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a>-&gt;<a onClick="logVariable('id')" class="var it42952" onMouseOver="hilite(42952)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l256"><span class="linenum"> 256</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>(false, <a class="function" onClick="logFunction('message_get_contact')" href="../../_functions/message_get_contact.html" onMouseOver="funcPopup(event,'message_get_contact')">message_get_contact</a>(<a class="var it687" onMouseOver="hilite(687)" onMouseOut="lolite()" onClick="logVariable('user3')" href="../../_variables/user3.html">$user3</a>-&gt;<a onClick="logVariable('id')" class="var it42956" onMouseOver="hilite(42956)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l257"><span class="linenum"> 257</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>(1, <a class="function" onClick="logFunction('message_count_blocked_users')" href="../../_functions/message_count_blocked_users.html" onMouseOver="funcPopup(event,'message_count_blocked_users')">message_count_blocked_users</a>());
<a name="l258"><span class="linenum"> 258</span></a>      }
<a name="l259"><span class="linenum"> 259</span></a>  
<a name="l260"><span class="linenum"> 260</span></a>      <span class="comment">/**</span>
<a name="l261"><span class="linenum"> 261</span></a>  <span class="comment">     * Test message_remove_contact.</span>
<a name="l262"><span class="linenum"> 262</span></a>  <span class="comment">     */</span>
<a name="l263"><span class="linenum"> 263</span></a>      public function <a class="function" onClick="logFunction('test_message_remove_contact')" href="../../_functions/test_message_remove_contact.html" onMouseOver="funcPopup(event,'test_message_remove_contact')">test_message_remove_contact</a>() {
<a name="l264"><span class="linenum"> 264</span></a>  <span class="comment">        // Set this user as the admin.</span>
<a name="l265"><span class="linenum"> 265</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('setAdminUser')" href="../../_functions/setadminuser.html" onMouseOver="funcPopup(event,'setadminuser')">setAdminUser</a>();
<a name="l266"><span class="linenum"> 266</span></a>  
<a name="l267"><span class="linenum"> 267</span></a>  <span class="comment">        // Create a user to add to the admin's contact list.</span>
<a name="l268"><span class="linenum"> 268</span></a>          <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>();
<a name="l269"><span class="linenum"> 269</span></a>  
<a name="l270"><span class="linenum"> 270</span></a>  <span class="comment">        // Add the user to the admin's contact list.</span>
<a name="l271"><span class="linenum"> 271</span></a>          <a class="function" onClick="logFunction('message_add_contact')" href="../../_functions/message_add_contact.html" onMouseOver="funcPopup(event,'message_add_contact')">message_add_contact</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l272"><span class="linenum"> 272</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertNotEmpty')" href="../../_functions/assertnotempty.html" onMouseOver="funcPopup(event,'assertnotempty')">assertNotEmpty</a>(<a class="function" onClick="logFunction('message_get_contact')" href="../../_functions/message_get_contact.html" onMouseOver="funcPopup(event,'message_get_contact')">message_get_contact</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l273"><span class="linenum"> 273</span></a>  
<a name="l274"><span class="linenum"> 274</span></a>  <span class="comment">        // Remove user from admin's contact list.</span>
<a name="l275"><span class="linenum"> 275</span></a>          <a class="function" onClick="logFunction('message_remove_contact')" href="../../_functions/message_remove_contact.html" onMouseOver="funcPopup(event,'message_remove_contact')">message_remove_contact</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l276"><span class="linenum"> 276</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>(false, <a class="function" onClick="logFunction('message_get_contact')" href="../../_functions/message_get_contact.html" onMouseOver="funcPopup(event,'message_get_contact')">message_get_contact</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l277"><span class="linenum"> 277</span></a>      }
<a name="l278"><span class="linenum"> 278</span></a>  
<a name="l279"><span class="linenum"> 279</span></a>      <span class="comment">/**</span>
<a name="l280"><span class="linenum"> 280</span></a>  <span class="comment">     * Test message_block_contact.</span>
<a name="l281"><span class="linenum"> 281</span></a>  <span class="comment">     */</span>
<a name="l282"><span class="linenum"> 282</span></a>      public function <a class="function" onClick="logFunction('test_message_block_contact')" href="../../_functions/test_message_block_contact.html" onMouseOver="funcPopup(event,'test_message_block_contact')">test_message_block_contact</a>() {
<a name="l283"><span class="linenum"> 283</span></a>  <span class="comment">        // Set this user as the admin.</span>
<a name="l284"><span class="linenum"> 284</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('setAdminUser')" href="../../_functions/setadminuser.html" onMouseOver="funcPopup(event,'setadminuser')">setAdminUser</a>();
<a name="l285"><span class="linenum"> 285</span></a>  
<a name="l286"><span class="linenum"> 286</span></a>  <span class="comment">        // Create a user to add to the admin's contact list.</span>
<a name="l287"><span class="linenum"> 287</span></a>          <a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>();
<a name="l288"><span class="linenum"> 288</span></a>          <a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>();
<a name="l289"><span class="linenum"> 289</span></a>  
<a name="l290"><span class="linenum"> 290</span></a>  <span class="comment">        // Add users to the admin's contact list.</span>
<a name="l291"><span class="linenum"> 291</span></a>          <a class="function" onClick="logFunction('message_add_contact')" href="../../_functions/message_add_contact.html" onMouseOver="funcPopup(event,'message_add_contact')">message_add_contact</a>(<a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a>-&gt;<a onClick="logVariable('id')" class="var it42951" onMouseOver="hilite(42951)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l292"><span class="linenum"> 292</span></a>          <a class="function" onClick="logFunction('message_add_contact')" href="../../_functions/message_add_contact.html" onMouseOver="funcPopup(event,'message_add_contact')">message_add_contact</a>(<a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a>-&gt;<a onClick="logVariable('id')" class="var it42952" onMouseOver="hilite(42952)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l293"><span class="linenum"> 293</span></a>  
<a name="l294"><span class="linenum"> 294</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>(0, <a class="function" onClick="logFunction('message_count_blocked_users')" href="../../_functions/message_count_blocked_users.html" onMouseOver="funcPopup(event,'message_count_blocked_users')">message_count_blocked_users</a>());
<a name="l295"><span class="linenum"> 295</span></a>  
<a name="l296"><span class="linenum"> 296</span></a>  <span class="comment">        // Block 1 user.</span>
<a name="l297"><span class="linenum"> 297</span></a>          <a class="function" onClick="logFunction('message_block_contact')" href="../../_functions/message_block_contact.html" onMouseOver="funcPopup(event,'message_block_contact')">message_block_contact</a>(<a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a>-&gt;<a onClick="logVariable('id')" class="var it42952" onMouseOver="hilite(42952)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l298"><span class="linenum"> 298</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>(1, <a class="function" onClick="logFunction('message_count_blocked_users')" href="../../_functions/message_count_blocked_users.html" onMouseOver="funcPopup(event,'message_count_blocked_users')">message_count_blocked_users</a>());
<a name="l299"><span class="linenum"> 299</span></a>  
<a name="l300"><span class="linenum"> 300</span></a>      }
<a name="l301"><span class="linenum"> 301</span></a>  
<a name="l302"><span class="linenum"> 302</span></a>      <span class="comment">/**</span>
<a name="l303"><span class="linenum"> 303</span></a>  <span class="comment">     * Test message_unblock_contact.</span>
<a name="l304"><span class="linenum"> 304</span></a>  <span class="comment">     */</span>
<a name="l305"><span class="linenum"> 305</span></a>      public function <a class="function" onClick="logFunction('test_message_unblock_contact')" href="../../_functions/test_message_unblock_contact.html" onMouseOver="funcPopup(event,'test_message_unblock_contact')">test_message_unblock_contact</a>() {
<a name="l306"><span class="linenum"> 306</span></a>  <span class="comment">        // Set this user as the admin.</span>
<a name="l307"><span class="linenum"> 307</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('setAdminUser')" href="../../_functions/setadminuser.html" onMouseOver="funcPopup(event,'setadminuser')">setAdminUser</a>();
<a name="l308"><span class="linenum"> 308</span></a>  
<a name="l309"><span class="linenum"> 309</span></a>  <span class="comment">        // Create a user to add to the admin's contact list.</span>
<a name="l310"><span class="linenum"> 310</span></a>          <a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>();
<a name="l311"><span class="linenum"> 311</span></a>          <a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>();
<a name="l312"><span class="linenum"> 312</span></a>  
<a name="l313"><span class="linenum"> 313</span></a>  <span class="comment">        // Add users to the admin's contact list.</span>
<a name="l314"><span class="linenum"> 314</span></a>          <a class="function" onClick="logFunction('message_add_contact')" href="../../_functions/message_add_contact.html" onMouseOver="funcPopup(event,'message_add_contact')">message_add_contact</a>(<a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a>-&gt;<a onClick="logVariable('id')" class="var it42951" onMouseOver="hilite(42951)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l315"><span class="linenum"> 315</span></a>          <a class="function" onClick="logFunction('message_add_contact')" href="../../_functions/message_add_contact.html" onMouseOver="funcPopup(event,'message_add_contact')">message_add_contact</a>(<a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a>-&gt;<a onClick="logVariable('id')" class="var it42952" onMouseOver="hilite(42952)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 1); <span class="comment">// Add blocked contact.</span>
<a name="l316"><span class="linenum"> 316</span></a>  
<a name="l317"><span class="linenum"> 317</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>(1, <a class="function" onClick="logFunction('message_count_blocked_users')" href="../../_functions/message_count_blocked_users.html" onMouseOver="funcPopup(event,'message_count_blocked_users')">message_count_blocked_users</a>());
<a name="l318"><span class="linenum"> 318</span></a>  
<a name="l319"><span class="linenum"> 319</span></a>  <span class="comment">        // Unblock user.</span>
<a name="l320"><span class="linenum"> 320</span></a>          <a class="function" onClick="logFunction('message_unblock_contact')" href="../../_functions/message_unblock_contact.html" onMouseOver="funcPopup(event,'message_unblock_contact')">message_unblock_contact</a>(<a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a>-&gt;<a onClick="logVariable('id')" class="var it42952" onMouseOver="hilite(42952)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l321"><span class="linenum"> 321</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>(0, <a class="function" onClick="logFunction('message_count_blocked_users')" href="../../_functions/message_count_blocked_users.html" onMouseOver="funcPopup(event,'message_count_blocked_users')">message_count_blocked_users</a>());
<a name="l322"><span class="linenum"> 322</span></a>      }
<a name="l323"><span class="linenum"> 323</span></a>  
<a name="l324"><span class="linenum"> 324</span></a>      <span class="comment">/**</span>
<a name="l325"><span class="linenum"> 325</span></a>  <span class="comment">     * Test message_search_users.</span>
<a name="l326"><span class="linenum"> 326</span></a>  <span class="comment">     */</span>
<a name="l327"><span class="linenum"> 327</span></a>      public function <a class="function" onClick="logFunction('test_message_search_users')" href="../../_functions/test_message_search_users.html" onMouseOver="funcPopup(event,'test_message_search_users')">test_message_search_users</a>() {
<a name="l328"><span class="linenum"> 328</span></a>  <span class="comment">        // Set this user as the admin.</span>
<a name="l329"><span class="linenum"> 329</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('setAdminUser')" href="../../_functions/setadminuser.html" onMouseOver="funcPopup(event,'setadminuser')">setAdminUser</a>();
<a name="l330"><span class="linenum"> 330</span></a>  
<a name="l331"><span class="linenum"> 331</span></a>  <span class="comment">        // Create a user to add to the admin's contact list.</span>
<a name="l332"><span class="linenum"> 332</span></a>          <a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test1', 'lastname' =&gt; 'user1'));
<a name="l333"><span class="linenum"> 333</span></a>          <a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test2', 'lastname' =&gt; 'user2'));
<a name="l334"><span class="linenum"> 334</span></a>  
<a name="l335"><span class="linenum"> 335</span></a>  <span class="comment">        // Add users to the admin's contact list.</span>
<a name="l336"><span class="linenum"> 336</span></a>          <a class="function" onClick="logFunction('message_add_contact')" href="../../_functions/message_add_contact.html" onMouseOver="funcPopup(event,'message_add_contact')">message_add_contact</a>(<a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a>-&gt;<a onClick="logVariable('id')" class="var it42951" onMouseOver="hilite(42951)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l337"><span class="linenum"> 337</span></a>          <a class="function" onClick="logFunction('message_add_contact')" href="../../_functions/message_add_contact.html" onMouseOver="funcPopup(event,'message_add_contact')">message_add_contact</a>(<a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a>-&gt;<a onClick="logVariable('id')" class="var it42952" onMouseOver="hilite(42952)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>); <span class="comment">// Add blocked contact.</span>
<a name="l338"><span class="linenum"> 338</span></a>  
<a name="l339"><span class="linenum"> 339</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(1, <a class="function" onClick="logFunction('message_search_users')" href="../../_functions/message_search_users.html" onMouseOver="funcPopup(event,'message_search_users')">message_search_users</a>(0, 'Test1'));
<a name="l340"><span class="linenum"> 340</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(2, <a class="function" onClick="logFunction('message_search_users')" href="../../_functions/message_search_users.html" onMouseOver="funcPopup(event,'message_search_users')">message_search_users</a>(0, 'Test'));
<a name="l341"><span class="linenum"> 341</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(1, <a class="function" onClick="logFunction('message_search_users')" href="../../_functions/message_search_users.html" onMouseOver="funcPopup(event,'message_search_users')">message_search_users</a>(0, 'user1'));
<a name="l342"><span class="linenum"> 342</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(2, <a class="function" onClick="logFunction('message_search_users')" href="../../_functions/message_search_users.html" onMouseOver="funcPopup(event,'message_search_users')">message_search_users</a>(0, 'user'));
<a name="l343"><span class="linenum"> 343</span></a>      }
<a name="l344"><span class="linenum"> 344</span></a>  
<a name="l345"><span class="linenum"> 345</span></a>      <span class="comment">/**</span>
<a name="l346"><span class="linenum"> 346</span></a>  <span class="comment">     * Test message_search.</span>
<a name="l347"><span class="linenum"> 347</span></a>  <span class="comment">     */</span>
<a name="l348"><span class="linenum"> 348</span></a>      public function <a class="function" onClick="logFunction('test_message_search')" href="../../_functions/test_message_search.html" onMouseOver="funcPopup(event,'test_message_search')">test_message_search</a>() {
<a name="l349"><span class="linenum"> 349</span></a>          global <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>;
<a name="l350"><span class="linenum"> 350</span></a>  
<a name="l351"><span class="linenum"> 351</span></a>  <span class="comment">        // Set this user as the admin.</span>
<a name="l352"><span class="linenum"> 352</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('setAdminUser')" href="../../_functions/setadminuser.html" onMouseOver="funcPopup(event,'setadminuser')">setAdminUser</a>();
<a name="l353"><span class="linenum"> 353</span></a>  
<a name="l354"><span class="linenum"> 354</span></a>  <span class="comment">        // Create a user to add to the admin's contact list.</span>
<a name="l355"><span class="linenum"> 355</span></a>          <a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test1', 'lastname' =&gt; 'user1'));
<a name="l356"><span class="linenum"> 356</span></a>          <a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test2', 'lastname' =&gt; 'user2'));
<a name="l357"><span class="linenum"> 357</span></a>  
<a name="l358"><span class="linenum"> 358</span></a>  <span class="comment">        // Send few messages, real (read).</span>
<a name="l359"><span class="linenum"> 359</span></a>          <a class="function" onClick="logFunction('message_post_message')" href="../../_functions/message_post_message.html" onMouseOver="funcPopup(event,'message_post_message')">message_post_message</a>(<a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, 'Message 1', <a class="constant" onClick="logConstant('FORMAT_PLAIN')" href="../../_constants/FORMAT_PLAIN.html" onMouseOver="constPopup(event,'FORMAT_PLAIN')">FORMAT_PLAIN</a>);
<a name="l360"><span class="linenum"> 360</span></a>          <a class="function" onClick="logFunction('message_post_message')" href="../../_functions/message_post_message.html" onMouseOver="funcPopup(event,'message_post_message')">message_post_message</a>(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a>, 'Message 2', <a class="constant" onClick="logConstant('FORMAT_PLAIN')" href="../../_constants/FORMAT_PLAIN.html" onMouseOver="constPopup(event,'FORMAT_PLAIN')">FORMAT_PLAIN</a>);
<a name="l361"><span class="linenum"> 361</span></a>          <a class="function" onClick="logFunction('message_post_message')" href="../../_functions/message_post_message.html" onMouseOver="funcPopup(event,'message_post_message')">message_post_message</a>(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it686" onMouseOver="hilite(686)" onMouseOut="lolite()" onClick="logVariable('user2')" href="../../_variables/user2.html">$user2</a>, 'Message 3', <a class="constant" onClick="logConstant('FORMAT_PLAIN')" href="../../_constants/FORMAT_PLAIN.html" onMouseOver="constPopup(event,'FORMAT_PLAIN')">FORMAT_PLAIN</a>);
<a name="l362"><span class="linenum"> 362</span></a>  
<a name="l363"><span class="linenum"> 363</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(2, <a class="function" onClick="logFunction('message_search')" href="../../_functions/message_search.html" onMouseOver="funcPopup(event,'message_search')">message_search</a>(array('Message'), true, false));
<a name="l364"><span class="linenum"> 364</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(3, <a class="function" onClick="logFunction('message_search')" href="../../_functions/message_search.html" onMouseOver="funcPopup(event,'message_search')">message_search</a>(array('Message'), true, true));
<a name="l365"><span class="linenum"> 365</span></a>  
<a name="l366"><span class="linenum"> 366</span></a>  <span class="comment">        // Send fake message (not-read).</span>
<a name="l367"><span class="linenum"> 367</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('send_fake_message')" href="../../_functions/send_fake_message.html" onMouseOver="funcPopup(event,'send_fake_message')">send_fake_message</a>(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a>, 'Message 4');
<a name="l368"><span class="linenum"> 368</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('send_fake_message')" href="../../_functions/send_fake_message.html" onMouseOver="funcPopup(event,'send_fake_message')">send_fake_message</a>(<a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, 'Message 5');
<a name="l369"><span class="linenum"> 369</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(3, <a class="function" onClick="logFunction('message_search')" href="../../_functions/message_search.html" onMouseOver="funcPopup(event,'message_search')">message_search</a>(array('Message'), true, false));
<a name="l370"><span class="linenum"> 370</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(5, <a class="function" onClick="logFunction('message_search')" href="../../_functions/message_search.html" onMouseOver="funcPopup(event,'message_search')">message_search</a>(array('Message'), true, true));
<a name="l371"><span class="linenum"> 371</span></a>  
<a name="l372"><span class="linenum"> 372</span></a>  <span class="comment">        // If courseid given then should be 0.</span>
<a name="l373"><span class="linenum"> 373</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>(false, <a class="function" onClick="logFunction('message_search')" href="../../_functions/message_search.html" onMouseOver="funcPopup(event,'message_search')">message_search</a>(array('Message'), true, true, ''));
<a name="l374"><span class="linenum"> 374</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>(false, <a class="function" onClick="logFunction('message_search')" href="../../_functions/message_search.html" onMouseOver="funcPopup(event,'message_search')">message_search</a>(array('Message'), true, true, 2));
<a name="l375"><span class="linenum"> 375</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertCount(5, <a class="function" onClick="logFunction('message_search')" href="../../_functions/message_search.html" onMouseOver="funcPopup(event,'message_search')">message_search</a>(array('Message'), true, true, <a class="constant" onClick="logConstant('SITEID')" href="../../_constants/SITEID.html" onMouseOver="constPopup(event,'SITEID')">SITEID</a>));
<a name="l376"><span class="linenum"> 376</span></a>      }
<a name="l377"><span class="linenum"> 377</span></a>  
<a name="l378"><span class="linenum"> 378</span></a>      <span class="comment">/**</span>
<a name="l379"><span class="linenum"> 379</span></a>  <span class="comment">     * The data provider for message_get_recent_conversations.</span>
<a name="l380"><span class="linenum"> 380</span></a>  <span class="comment">     *</span>
<a name="l381"><span class="linenum"> 381</span></a>  <span class="comment">     * This provides sets of data to for testing.</span>
<a name="l382"><span class="linenum"> 382</span></a>  <span class="comment">     * @return array</span>
<a name="l383"><span class="linenum"> 383</span></a>  <span class="comment">     */</span>
<a name="l384"><span class="linenum"> 384</span></a>      public function <a class="function" onClick="logFunction('message_get_recent_conversations_provider')" href="../../_functions/message_get_recent_conversations_provider.html" onMouseOver="funcPopup(event,'message_get_recent_conversations_provider')">message_get_recent_conversations_provider</a>() {
<a name="l385"><span class="linenum"> 385</span></a>          return array(
<a name="l386"><span class="linenum"> 386</span></a>              'Test that conversations with messages contacts is correctly ordered.' =&gt; array(
<a name="l387"><span class="linenum"> 387</span></a>                  'users' =&gt; array(
<a name="l388"><span class="linenum"> 388</span></a>                      'user1',
<a name="l389"><span class="linenum"> 389</span></a>                      'user2',
<a name="l390"><span class="linenum"> 390</span></a>                      'user3',
<a name="l391"><span class="linenum"> 391</span></a>                  ),
<a name="l392"><span class="linenum"> 392</span></a>                  'contacts' =&gt; array(
<a name="l393"><span class="linenum"> 393</span></a>                  ),
<a name="l394"><span class="linenum"> 394</span></a>                  'messages' =&gt; array(
<a name="l395"><span class="linenum"> 395</span></a>                      array(
<a name="l396"><span class="linenum"> 396</span></a>                          'from'          =&gt; 'user1',
<a name="l397"><span class="linenum"> 397</span></a>                          'to'            =&gt; 'user2',
<a name="l398"><span class="linenum"> 398</span></a>                          'state'         =&gt; 'unread',
<a name="l399"><span class="linenum"> 399</span></a>                          'subject'       =&gt; 'S1',
<a name="l400"><span class="linenum"> 400</span></a>                      ),
<a name="l401"><span class="linenum"> 401</span></a>                      array(
<a name="l402"><span class="linenum"> 402</span></a>                          'from'          =&gt; 'user2',
<a name="l403"><span class="linenum"> 403</span></a>                          'to'            =&gt; 'user1',
<a name="l404"><span class="linenum"> 404</span></a>                          'state'         =&gt; 'unread',
<a name="l405"><span class="linenum"> 405</span></a>                          'subject'       =&gt; 'S2',
<a name="l406"><span class="linenum"> 406</span></a>                      ),
<a name="l407"><span class="linenum"> 407</span></a>                      array(
<a name="l408"><span class="linenum"> 408</span></a>                          'from'          =&gt; 'user1',
<a name="l409"><span class="linenum"> 409</span></a>                          'to'            =&gt; 'user2',
<a name="l410"><span class="linenum"> 410</span></a>                          'state'         =&gt; 'unread',
<a name="l411"><span class="linenum"> 411</span></a>                          'timecreated'   =&gt; 0,
<a name="l412"><span class="linenum"> 412</span></a>                          'subject'       =&gt; 'S3',
<a name="l413"><span class="linenum"> 413</span></a>                      ),
<a name="l414"><span class="linenum"> 414</span></a>                      array(
<a name="l415"><span class="linenum"> 415</span></a>                          'from'          =&gt; 'user1',
<a name="l416"><span class="linenum"> 416</span></a>                          'to'            =&gt; 'user3',
<a name="l417"><span class="linenum"> 417</span></a>                          'state'         =&gt; 'read',
<a name="l418"><span class="linenum"> 418</span></a>                          'timemodifier'  =&gt; 1,
<a name="l419"><span class="linenum"> 419</span></a>                          'subject'       =&gt; 'S4',
<a name="l420"><span class="linenum"> 420</span></a>                      ),
<a name="l421"><span class="linenum"> 421</span></a>                      array(
<a name="l422"><span class="linenum"> 422</span></a>                          'from'          =&gt; 'user3',
<a name="l423"><span class="linenum"> 423</span></a>                          'to'            =&gt; 'user1',
<a name="l424"><span class="linenum"> 424</span></a>                          'state'         =&gt; 'read',
<a name="l425"><span class="linenum"> 425</span></a>                          'timemodifier'  =&gt; 1,
<a name="l426"><span class="linenum"> 426</span></a>                          'subject'       =&gt; 'S5',
<a name="l427"><span class="linenum"> 427</span></a>                      ),
<a name="l428"><span class="linenum"> 428</span></a>                      array(
<a name="l429"><span class="linenum"> 429</span></a>                          'from'          =&gt; 'user1',
<a name="l430"><span class="linenum"> 430</span></a>                          'to'            =&gt; 'user3',
<a name="l431"><span class="linenum"> 431</span></a>                          'state'         =&gt; 'read',
<a name="l432"><span class="linenum"> 432</span></a>                          'timecreated'   =&gt; 0,
<a name="l433"><span class="linenum"> 433</span></a>                          'subject'       =&gt; 'S6',
<a name="l434"><span class="linenum"> 434</span></a>                      ),
<a name="l435"><span class="linenum"> 435</span></a>                  ),
<a name="l436"><span class="linenum"> 436</span></a>                  'expectations' =&gt; array(
<a name="l437"><span class="linenum"> 437</span></a>                      'user1' =&gt; array(
<a name="l438"><span class="linenum"> 438</span></a>  <span class="comment">                        // User1 has conversed most recently with user3. The most recent message is M5.</span>
<a name="l439"><span class="linenum"> 439</span></a>                          array(
<a name="l440"><span class="linenum"> 440</span></a>                              'messageposition'   =&gt; 0,
<a name="l441"><span class="linenum"> 441</span></a>                              'with'              =&gt; 'user3',
<a name="l442"><span class="linenum"> 442</span></a>                              'subject'           =&gt; 'S5',
<a name="l443"><span class="linenum"> 443</span></a>                          ),
<a name="l444"><span class="linenum"> 444</span></a>  <span class="comment">                        // User1 has also conversed with user2. The most recent message is S2.</span>
<a name="l445"><span class="linenum"> 445</span></a>                          array(
<a name="l446"><span class="linenum"> 446</span></a>                              'messageposition'   =&gt; 1,
<a name="l447"><span class="linenum"> 447</span></a>                              'with'              =&gt; 'user2',
<a name="l448"><span class="linenum"> 448</span></a>                              'subject'           =&gt; 'S2',
<a name="l449"><span class="linenum"> 449</span></a>                          ),
<a name="l450"><span class="linenum"> 450</span></a>                      ),
<a name="l451"><span class="linenum"> 451</span></a>                      'user2' =&gt; array(
<a name="l452"><span class="linenum"> 452</span></a>  <span class="comment">                        // User2 has only conversed with user1. Their most recent shared message was S2.</span>
<a name="l453"><span class="linenum"> 453</span></a>                          array(
<a name="l454"><span class="linenum"> 454</span></a>                              'messageposition'   =&gt; 0,
<a name="l455"><span class="linenum"> 455</span></a>                              'with'              =&gt; 'user1',
<a name="l456"><span class="linenum"> 456</span></a>                              'subject'           =&gt; 'S2',
<a name="l457"><span class="linenum"> 457</span></a>                          ),
<a name="l458"><span class="linenum"> 458</span></a>                      ),
<a name="l459"><span class="linenum"> 459</span></a>                      'user3' =&gt; array(
<a name="l460"><span class="linenum"> 460</span></a>  <span class="comment">                        // User3 has only conversed with user1. Their most recent shared message was S5.</span>
<a name="l461"><span class="linenum"> 461</span></a>                          array(
<a name="l462"><span class="linenum"> 462</span></a>                              'messageposition'   =&gt; 0,
<a name="l463"><span class="linenum"> 463</span></a>                              'with'              =&gt; 'user1',
<a name="l464"><span class="linenum"> 464</span></a>                              'subject'           =&gt; 'S5',
<a name="l465"><span class="linenum"> 465</span></a>                          ),
<a name="l466"><span class="linenum"> 466</span></a>                      ),
<a name="l467"><span class="linenum"> 467</span></a>                  ),
<a name="l468"><span class="linenum"> 468</span></a>              ),
<a name="l469"><span class="linenum"> 469</span></a>              'Test that users with contacts and messages to self work as expected' =&gt; array(
<a name="l470"><span class="linenum"> 470</span></a>                  'users' =&gt; array(
<a name="l471"><span class="linenum"> 471</span></a>                      'user1',
<a name="l472"><span class="linenum"> 472</span></a>                      'user2',
<a name="l473"><span class="linenum"> 473</span></a>                      'user3',
<a name="l474"><span class="linenum"> 474</span></a>                  ),
<a name="l475"><span class="linenum"> 475</span></a>                  'contacts' =&gt; array(
<a name="l476"><span class="linenum"> 476</span></a>                      'user1' =&gt; array(
<a name="l477"><span class="linenum"> 477</span></a>                          'user2' =&gt; 0,
<a name="l478"><span class="linenum"> 478</span></a>                          'user3' =&gt; 0,
<a name="l479"><span class="linenum"> 479</span></a>                      ),
<a name="l480"><span class="linenum"> 480</span></a>                      'user2' =&gt; array(
<a name="l481"><span class="linenum"> 481</span></a>                          'user3' =&gt; 0,
<a name="l482"><span class="linenum"> 482</span></a>                      ),
<a name="l483"><span class="linenum"> 483</span></a>                  ),
<a name="l484"><span class="linenum"> 484</span></a>                  'messages' =&gt; array(
<a name="l485"><span class="linenum"> 485</span></a>                      array(
<a name="l486"><span class="linenum"> 486</span></a>                          'from'          =&gt; 'user1',
<a name="l487"><span class="linenum"> 487</span></a>                          'to'            =&gt; 'user1',
<a name="l488"><span class="linenum"> 488</span></a>                          'state'         =&gt; 'unread',
<a name="l489"><span class="linenum"> 489</span></a>                          'subject'       =&gt; 'S1',
<a name="l490"><span class="linenum"> 490</span></a>                      ),
<a name="l491"><span class="linenum"> 491</span></a>                      array(
<a name="l492"><span class="linenum"> 492</span></a>                          'from'          =&gt; 'user1',
<a name="l493"><span class="linenum"> 493</span></a>                          'to'            =&gt; 'user1',
<a name="l494"><span class="linenum"> 494</span></a>                          'state'         =&gt; 'unread',
<a name="l495"><span class="linenum"> 495</span></a>                          'subject'       =&gt; 'S2',
<a name="l496"><span class="linenum"> 496</span></a>                      ),
<a name="l497"><span class="linenum"> 497</span></a>                  ),
<a name="l498"><span class="linenum"> 498</span></a>                  'expectations' =&gt; array(
<a name="l499"><span class="linenum"> 499</span></a>                      'user1' =&gt; array(
<a name="l500"><span class="linenum"> 500</span></a>  <span class="comment">                        // User1 has conversed most recently with user1. The most recent message is S2.</span>
<a name="l501"><span class="linenum"> 501</span></a>                          array(
<a name="l502"><span class="linenum"> 502</span></a>                              'messageposition'   =&gt; 0,
<a name="l503"><span class="linenum"> 503</span></a>                              'with'              =&gt; 'user1',
<a name="l504"><span class="linenum"> 504</span></a>                              'subject'           =&gt; 'S2',
<a name="l505"><span class="linenum"> 505</span></a>                          ),
<a name="l506"><span class="linenum"> 506</span></a>                      ),
<a name="l507"><span class="linenum"> 507</span></a>                  ),
<a name="l508"><span class="linenum"> 508</span></a>              ),
<a name="l509"><span class="linenum"> 509</span></a>              'Test conversations with a single user, where some messages are read and some are not.' =&gt; array(
<a name="l510"><span class="linenum"> 510</span></a>                  'users' =&gt; array(
<a name="l511"><span class="linenum"> 511</span></a>                      'user1',
<a name="l512"><span class="linenum"> 512</span></a>                      'user2',
<a name="l513"><span class="linenum"> 513</span></a>                  ),
<a name="l514"><span class="linenum"> 514</span></a>                  'contacts' =&gt; array(
<a name="l515"><span class="linenum"> 515</span></a>                  ),
<a name="l516"><span class="linenum"> 516</span></a>                  'messages' =&gt; array(
<a name="l517"><span class="linenum"> 517</span></a>                      array(
<a name="l518"><span class="linenum"> 518</span></a>                          'from'          =&gt; 'user1',
<a name="l519"><span class="linenum"> 519</span></a>                          'to'            =&gt; 'user2',
<a name="l520"><span class="linenum"> 520</span></a>                          'state'         =&gt; 'read',
<a name="l521"><span class="linenum"> 521</span></a>                          'subject'       =&gt; 'S1',
<a name="l522"><span class="linenum"> 522</span></a>                      ),
<a name="l523"><span class="linenum"> 523</span></a>                      array(
<a name="l524"><span class="linenum"> 524</span></a>                          'from'          =&gt; 'user2',
<a name="l525"><span class="linenum"> 525</span></a>                          'to'            =&gt; 'user1',
<a name="l526"><span class="linenum"> 526</span></a>                          'state'         =&gt; 'read',
<a name="l527"><span class="linenum"> 527</span></a>                          'subject'       =&gt; 'S2',
<a name="l528"><span class="linenum"> 528</span></a>                      ),
<a name="l529"><span class="linenum"> 529</span></a>                      array(
<a name="l530"><span class="linenum"> 530</span></a>                          'from'          =&gt; 'user1',
<a name="l531"><span class="linenum"> 531</span></a>                          'to'            =&gt; 'user2',
<a name="l532"><span class="linenum"> 532</span></a>                          'state'         =&gt; 'unread',
<a name="l533"><span class="linenum"> 533</span></a>                          'timemodifier'  =&gt; 1,
<a name="l534"><span class="linenum"> 534</span></a>                          'subject'       =&gt; 'S3',
<a name="l535"><span class="linenum"> 535</span></a>                      ),
<a name="l536"><span class="linenum"> 536</span></a>                      array(
<a name="l537"><span class="linenum"> 537</span></a>                          'from'          =&gt; 'user1',
<a name="l538"><span class="linenum"> 538</span></a>                          'to'            =&gt; 'user2',
<a name="l539"><span class="linenum"> 539</span></a>                          'state'         =&gt; 'unread',
<a name="l540"><span class="linenum"> 540</span></a>                          'timemodifier'  =&gt; 1,
<a name="l541"><span class="linenum"> 541</span></a>                          'subject'       =&gt; 'S4',
<a name="l542"><span class="linenum"> 542</span></a>                      ),
<a name="l543"><span class="linenum"> 543</span></a>                  ),
<a name="l544"><span class="linenum"> 544</span></a>                  'expectations' =&gt; array(
<a name="l545"><span class="linenum"> 545</span></a>  <span class="comment">                    // The most recent message between user1 and user2 was S4.</span>
<a name="l546"><span class="linenum"> 546</span></a>                      'user1' =&gt; array(
<a name="l547"><span class="linenum"> 547</span></a>                          array(
<a name="l548"><span class="linenum"> 548</span></a>                              'messageposition'   =&gt; 0,
<a name="l549"><span class="linenum"> 549</span></a>                              'with'              =&gt; 'user2',
<a name="l550"><span class="linenum"> 550</span></a>                              'subject'           =&gt; 'S4',
<a name="l551"><span class="linenum"> 551</span></a>                          ),
<a name="l552"><span class="linenum"> 552</span></a>                      ),
<a name="l553"><span class="linenum"> 553</span></a>                      'user2' =&gt; array(
<a name="l554"><span class="linenum"> 554</span></a>  <span class="comment">                        // The most recent message between user1 and user2 was S4.</span>
<a name="l555"><span class="linenum"> 555</span></a>                          array(
<a name="l556"><span class="linenum"> 556</span></a>                              'messageposition'   =&gt; 0,
<a name="l557"><span class="linenum"> 557</span></a>                              'with'              =&gt; 'user1',
<a name="l558"><span class="linenum"> 558</span></a>                              'subject'           =&gt; 'S4',
<a name="l559"><span class="linenum"> 559</span></a>                          ),
<a name="l560"><span class="linenum"> 560</span></a>                      ),
<a name="l561"><span class="linenum"> 561</span></a>                  ),
<a name="l562"><span class="linenum"> 562</span></a>              ),
<a name="l563"><span class="linenum"> 563</span></a>              'Test conversations with a single user, where some messages are read and some are not, and messages ' .
<a name="l564"><span class="linenum"> 564</span></a>              'are out of order' =&gt; array(
<a name="l565"><span class="linenum"> 565</span></a>  <span class="comment">            // This can happen through a combination of factors including multi-master DB replication with messages</span>
<a name="l566"><span class="linenum"> 566</span></a>  <span class="comment">            // read somehow (e.g. API).</span>
<a name="l567"><span class="linenum"> 567</span></a>                  'users' =&gt; array(
<a name="l568"><span class="linenum"> 568</span></a>                      'user1',
<a name="l569"><span class="linenum"> 569</span></a>                      'user2',
<a name="l570"><span class="linenum"> 570</span></a>                  ),
<a name="l571"><span class="linenum"> 571</span></a>                  'contacts' =&gt; array(
<a name="l572"><span class="linenum"> 572</span></a>                  ),
<a name="l573"><span class="linenum"> 573</span></a>                  'messages' =&gt; array(
<a name="l574"><span class="linenum"> 574</span></a>                      array(
<a name="l575"><span class="linenum"> 575</span></a>                          'from'          =&gt; 'user1',
<a name="l576"><span class="linenum"> 576</span></a>                          'to'            =&gt; 'user2',
<a name="l577"><span class="linenum"> 577</span></a>                          'state'         =&gt; 'read',
<a name="l578"><span class="linenum"> 578</span></a>                          'subject'       =&gt; 'S1',
<a name="l579"><span class="linenum"> 579</span></a>                          'timemodifier'  =&gt; 1,
<a name="l580"><span class="linenum"> 580</span></a>                      ),
<a name="l581"><span class="linenum"> 581</span></a>                      array(
<a name="l582"><span class="linenum"> 582</span></a>                          'from'          =&gt; 'user2',
<a name="l583"><span class="linenum"> 583</span></a>                          'to'            =&gt; 'user1',
<a name="l584"><span class="linenum"> 584</span></a>                          'state'         =&gt; 'read',
<a name="l585"><span class="linenum"> 585</span></a>                          'subject'       =&gt; 'S2',
<a name="l586"><span class="linenum"> 586</span></a>                          'timemodifier'  =&gt; 2,
<a name="l587"><span class="linenum"> 587</span></a>                      ),
<a name="l588"><span class="linenum"> 588</span></a>                      array(
<a name="l589"><span class="linenum"> 589</span></a>                          'from'          =&gt; 'user1',
<a name="l590"><span class="linenum"> 590</span></a>                          'to'            =&gt; 'user2',
<a name="l591"><span class="linenum"> 591</span></a>                          'state'         =&gt; 'unread',
<a name="l592"><span class="linenum"> 592</span></a>                          'subject'       =&gt; 'S3',
<a name="l593"><span class="linenum"> 593</span></a>                      ),
<a name="l594"><span class="linenum"> 594</span></a>                      array(
<a name="l595"><span class="linenum"> 595</span></a>                          'from'          =&gt; 'user1',
<a name="l596"><span class="linenum"> 596</span></a>                          'to'            =&gt; 'user2',
<a name="l597"><span class="linenum"> 597</span></a>                          'state'         =&gt; 'unread',
<a name="l598"><span class="linenum"> 598</span></a>                          'subject'       =&gt; 'S4',
<a name="l599"><span class="linenum"> 599</span></a>                      ),
<a name="l600"><span class="linenum"> 600</span></a>                  ),
<a name="l601"><span class="linenum"> 601</span></a>                  'expectations' =&gt; array(
<a name="l602"><span class="linenum"> 602</span></a>  <span class="comment">                    // The most recent message between user1 and user2 was S2, even though later IDs have not been read.</span>
<a name="l603"><span class="linenum"> 603</span></a>                      'user1' =&gt; array(
<a name="l604"><span class="linenum"> 604</span></a>                          array(
<a name="l605"><span class="linenum"> 605</span></a>                              'messageposition'   =&gt; 0,
<a name="l606"><span class="linenum"> 606</span></a>                              'with'              =&gt; 'user2',
<a name="l607"><span class="linenum"> 607</span></a>                              'subject'           =&gt; 'S2',
<a name="l608"><span class="linenum"> 608</span></a>                          ),
<a name="l609"><span class="linenum"> 609</span></a>                      ),
<a name="l610"><span class="linenum"> 610</span></a>                      'user2' =&gt; array(
<a name="l611"><span class="linenum"> 611</span></a>                          array(
<a name="l612"><span class="linenum"> 612</span></a>                              'messageposition'   =&gt; 0,
<a name="l613"><span class="linenum"> 613</span></a>                              'with'              =&gt; 'user1',
<a name="l614"><span class="linenum"> 614</span></a>                              'subject'           =&gt; 'S2',
<a name="l615"><span class="linenum"> 615</span></a>                          ),
<a name="l616"><span class="linenum"> 616</span></a>                      ),
<a name="l617"><span class="linenum"> 617</span></a>                  ),
<a name="l618"><span class="linenum"> 618</span></a>              ),
<a name="l619"><span class="linenum"> 619</span></a>          );
<a name="l620"><span class="linenum"> 620</span></a>      }
<a name="l621"><span class="linenum"> 621</span></a>  
<a name="l622"><span class="linenum"> 622</span></a>      <span class="comment">/**</span>
<a name="l623"><span class="linenum"> 623</span></a>  <span class="comment">     * Test message_get_recent_conversations with a mixture of messages.</span>
<a name="l624"><span class="linenum"> 624</span></a>  <span class="comment">     *</span>
<a name="l625"><span class="linenum"> 625</span></a>  <span class="comment">     * @dataProvider message_get_recent_conversations_provider</span>
<a name="l626"><span class="linenum"> 626</span></a>  <span class="comment">     * @param array $usersdata The list of users to create for this test.</span>
<a name="l627"><span class="linenum"> 627</span></a>  <span class="comment">     * @param array $messagesdata The list of messages to create.</span>
<a name="l628"><span class="linenum"> 628</span></a>  <span class="comment">     * @param array $expectations The list of expected outcomes.</span>
<a name="l629"><span class="linenum"> 629</span></a>  <span class="comment">     */</span>
<a name="l630"><span class="linenum"> 630</span></a>      public function <a class="function" onClick="logFunction('test_message_get_recent_conversations')" href="../../_functions/test_message_get_recent_conversations.html" onMouseOver="funcPopup(event,'test_message_get_recent_conversations')">test_message_get_recent_conversations</a>(<a class="var it35914" onMouseOver="hilite(35914)" onMouseOut="lolite()" onClick="logVariable('usersdata')" href="../../_variables/usersdata.html">$usersdata</a>, <a class="var it1802" onMouseOver="hilite(1802)" onMouseOut="lolite()" onClick="logVariable('contacts')" href="../../_variables/contacts.html">$contacts</a>, <a class="var it35915" onMouseOver="hilite(35915)" onMouseOut="lolite()" onClick="logVariable('messagesdata')" href="../../_variables/messagesdata.html">$messagesdata</a>, <a class="var it23497" onMouseOver="hilite(23497)" onMouseOut="lolite()" onClick="logVariable('expectations')" href="../../_variables/expectations.html">$expectations</a>) {
<a name="l631"><span class="linenum"> 631</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l632"><span class="linenum"> 632</span></a>  
<a name="l633"><span class="linenum"> 633</span></a>  <span class="comment">        // Create all of the users.</span>
<a name="l634"><span class="linenum"> 634</span></a>          <a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a> = array();
<a name="l635"><span class="linenum"> 635</span></a>          foreach (<a class="var it35914" onMouseOver="hilite(35914)" onMouseOut="lolite()" onClick="logVariable('usersdata')" href="../../_variables/usersdata.html">$usersdata</a> as <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>) {
<a name="l636"><span class="linenum"> 636</span></a>              <a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>[<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>] = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('username' =&gt; <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>));
<a name="l637"><span class="linenum"> 637</span></a>          }
<a name="l638"><span class="linenum"> 638</span></a>  
<a name="l639"><span class="linenum"> 639</span></a>          foreach (<a class="var it1802" onMouseOver="hilite(1802)" onMouseOut="lolite()" onClick="logVariable('contacts')" href="../../_variables/contacts.html">$contacts</a> as <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a> =&gt; <a class="var it1803" onMouseOver="hilite(1803)" onMouseOut="lolite()" onClick="logVariable('contact')" href="../../_variables/contact.html">$contact</a>) {
<a name="l640"><span class="linenum"> 640</span></a>              foreach (<a class="var it1803" onMouseOver="hilite(1803)" onMouseOut="lolite()" onClick="logVariable('contact')" href="../../_variables/contact.html">$contact</a> as <a class="var it18203" onMouseOver="hilite(18203)" onMouseOut="lolite()" onClick="logVariable('contactname')" href="../../_variables/contactname.html">$contactname</a> =&gt; <a class="var it14114" onMouseOver="hilite(14114)" onMouseOut="lolite()" onClick="logVariable('blocked')" href="../../_variables/blocked.html">$blocked</a>) {
<a name="l641"><span class="linenum"> 641</span></a>                  <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a> = new stdClass();
<a name="l642"><span class="linenum"> 642</span></a>                  <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('userid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>     = <a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>[<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>]-&gt;id;
<a name="l643"><span class="linenum"> 643</span></a>                  <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('contactid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/contactid.html">contactid</a>  = <a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>[<a class="var it18203" onMouseOver="hilite(18203)" onMouseOut="lolite()" onClick="logVariable('contactname')" href="../../_variables/contactname.html">$contactname</a>]-&gt;id;
<a name="l644"><span class="linenum"> 644</span></a>                  <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('blocked')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/blocked.html">blocked</a>    = <a class="var it14114" onMouseOver="hilite(14114)" onMouseOut="lolite()" onClick="logVariable('blocked')" href="../../_variables/blocked.html">$blocked</a>;
<a name="l645"><span class="linenum"> 645</span></a>                  <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('message_contacts', <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>);
<a name="l646"><span class="linenum"> 646</span></a>              }
<a name="l647"><span class="linenum"> 647</span></a>          }
<a name="l648"><span class="linenum"> 648</span></a>  
<a name="l649"><span class="linenum"> 649</span></a>          <a class="var it35916" onMouseOver="hilite(35916)" onMouseOut="lolite()" onClick="logVariable('defaulttimecreated')" href="../../_variables/defaulttimecreated.html">$defaulttimecreated</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l650"><span class="linenum"> 650</span></a>          foreach (<a class="var it35915" onMouseOver="hilite(35915)" onMouseOut="lolite()" onClick="logVariable('messagesdata')" href="../../_variables/messagesdata.html">$messagesdata</a> as <a class="var it7438" onMouseOver="hilite(7438)" onMouseOut="lolite()" onClick="logVariable('messagedata')" href="../../_variables/messagedata.html">$messagedata</a>) {
<a name="l651"><span class="linenum"> 651</span></a>              <a class="var it114" onMouseOver="hilite(114)" onMouseOut="lolite()" onClick="logVariable('from')" href="../../_variables/from.html">$from</a>       = <a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>[<a class="var it7438" onMouseOver="hilite(7438)" onMouseOut="lolite()" onClick="logVariable('messagedata')" href="../../_variables/messagedata.html">$messagedata</a>['from']];
<a name="l652"><span class="linenum"> 652</span></a>              <a class="var it115" onMouseOver="hilite(115)" onMouseOut="lolite()" onClick="logVariable('to')" href="../../_variables/to.html">$to</a>         = <a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>[<a class="var it7438" onMouseOver="hilite(7438)" onMouseOut="lolite()" onClick="logVariable('messagedata')" href="../../_variables/messagedata.html">$messagedata</a>['to']];
<a name="l653"><span class="linenum"> 653</span></a>              <a class="var it1792" onMouseOver="hilite(1792)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../../_variables/subject.html">$subject</a>    = <a class="var it7438" onMouseOver="hilite(7438)" onMouseOut="lolite()" onClick="logVariable('messagedata')" href="../../_variables/messagedata.html">$messagedata</a>['subject'];
<a name="l654"><span class="linenum"> 654</span></a>  
<a name="l655"><span class="linenum"> 655</span></a>              if (isset(<a class="var it7438" onMouseOver="hilite(7438)" onMouseOut="lolite()" onClick="logVariable('messagedata')" href="../../_variables/messagedata.html">$messagedata</a>['state']) &amp;&amp; <a class="var it7438" onMouseOver="hilite(7438)" onMouseOut="lolite()" onClick="logVariable('messagedata')" href="../../_variables/messagedata.html">$messagedata</a>['state'] == 'unread') {
<a name="l656"><span class="linenum"> 656</span></a>                  <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = 'message';
<a name="l657"><span class="linenum"> 657</span></a>                  <a class="var it5664" onMouseOver="hilite(5664)" onMouseOut="lolite()" onClick="logVariable('messageid')" href="../../_variables/messageid.html">$messageid</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('send_fake_message')" href="../../_functions/send_fake_message.html" onMouseOver="funcPopup(event,'send_fake_message')">send_fake_message</a>(<a class="var it114" onMouseOver="hilite(114)" onMouseOut="lolite()" onClick="logVariable('from')" href="../../_variables/from.html">$from</a>, <a class="var it115" onMouseOver="hilite(115)" onMouseOut="lolite()" onClick="logVariable('to')" href="../../_variables/to.html">$to</a>, <a class="var it1792" onMouseOver="hilite(1792)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../../_variables/subject.html">$subject</a>, <a class="constant" onClick="logConstant('FORMAT_PLAIN')" href="../../_constants/FORMAT_PLAIN.html" onMouseOver="constPopup(event,'FORMAT_PLAIN')">FORMAT_PLAIN</a>);
<a name="l658"><span class="linenum"> 658</span></a>              } else {
<a name="l659"><span class="linenum"> 659</span></a>  <span class="comment">                // If there is no state, or the state is not 'unread', assume the message is read.</span>
<a name="l660"><span class="linenum"> 660</span></a>                  <a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> = 'message_read';
<a name="l661"><span class="linenum"> 661</span></a>                  <a class="var it5664" onMouseOver="hilite(5664)" onMouseOut="lolite()" onClick="logVariable('messageid')" href="../../_variables/messageid.html">$messageid</a> = <a class="function" onClick="logFunction('message_post_message')" href="../../_functions/message_post_message.html" onMouseOver="funcPopup(event,'message_post_message')">message_post_message</a>(<a class="var it114" onMouseOver="hilite(114)" onMouseOut="lolite()" onClick="logVariable('from')" href="../../_variables/from.html">$from</a>, <a class="var it115" onMouseOver="hilite(115)" onMouseOut="lolite()" onClick="logVariable('to')" href="../../_variables/to.html">$to</a>, <a class="var it1792" onMouseOver="hilite(1792)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../../_variables/subject.html">$subject</a>, <a class="constant" onClick="logConstant('FORMAT_PLAIN')" href="../../_constants/FORMAT_PLAIN.html" onMouseOver="constPopup(event,'FORMAT_PLAIN')">FORMAT_PLAIN</a>);
<a name="l662"><span class="linenum"> 662</span></a>              }
<a name="l663"><span class="linenum"> 663</span></a>  
<a name="l664"><span class="linenum"> 664</span></a>              <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('updatemessage')" href="../../_variables/updatemessage.html">$updatemessage</a> = new stdClass();
<a name="l665"><span class="linenum"> 665</span></a>              <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('updatemessage')" href="../../_variables/updatemessage.html">$updatemessage</a>-&gt;<a onClick="logVariable('id')" class="var it44103" onMouseOver="hilite(44103)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it5664" onMouseOver="hilite(5664)" onMouseOut="lolite()" onClick="logVariable('messageid')" href="../../_variables/messageid.html">$messageid</a>;
<a name="l666"><span class="linenum"> 666</span></a>              if (isset(<a class="var it7438" onMouseOver="hilite(7438)" onMouseOut="lolite()" onClick="logVariable('messagedata')" href="../../_variables/messagedata.html">$messagedata</a>['timecreated'])) {
<a name="l667"><span class="linenum"> 667</span></a>                  <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('updatemessage')" href="../../_variables/updatemessage.html">$updatemessage</a>-&gt;<a onClick="logVariable('timecreated')" class="var it44103" onMouseOver="hilite(44103)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a> = <a class="var it7438" onMouseOver="hilite(7438)" onMouseOut="lolite()" onClick="logVariable('messagedata')" href="../../_variables/messagedata.html">$messagedata</a>['timecreated'];
<a name="l668"><span class="linenum"> 668</span></a>              } else if (isset(<a class="var it7438" onMouseOver="hilite(7438)" onMouseOut="lolite()" onClick="logVariable('messagedata')" href="../../_variables/messagedata.html">$messagedata</a>['timemodifier'])) {
<a name="l669"><span class="linenum"> 669</span></a>                  <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('updatemessage')" href="../../_variables/updatemessage.html">$updatemessage</a>-&gt;<a onClick="logVariable('timecreated')" class="var it44103" onMouseOver="hilite(44103)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a> = <a class="var it35916" onMouseOver="hilite(35916)" onMouseOut="lolite()" onClick="logVariable('defaulttimecreated')" href="../../_variables/defaulttimecreated.html">$defaulttimecreated</a> + <a class="var it7438" onMouseOver="hilite(7438)" onMouseOut="lolite()" onClick="logVariable('messagedata')" href="../../_variables/messagedata.html">$messagedata</a>['timemodifier'];
<a name="l670"><span class="linenum"> 670</span></a>              } else {
<a name="l671"><span class="linenum"> 671</span></a>                  <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('updatemessage')" href="../../_variables/updatemessage.html">$updatemessage</a>-&gt;<a onClick="logVariable('timecreated')" class="var it44103" onMouseOver="hilite(44103)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a> = <a class="var it35916" onMouseOver="hilite(35916)" onMouseOut="lolite()" onClick="logVariable('defaulttimecreated')" href="../../_variables/defaulttimecreated.html">$defaulttimecreated</a>;
<a name="l672"><span class="linenum"> 672</span></a>              }
<a name="l673"><span class="linenum"> 673</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>(<a class="var it61" onMouseOver="hilite(61)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('updatemessage')" href="../../_variables/updatemessage.html">$updatemessage</a>);
<a name="l674"><span class="linenum"> 674</span></a>          }
<a name="l675"><span class="linenum"> 675</span></a>  
<a name="l676"><span class="linenum"> 676</span></a>          foreach (<a class="var it23497" onMouseOver="hilite(23497)" onMouseOut="lolite()" onClick="logVariable('expectations')" href="../../_variables/expectations.html">$expectations</a> as <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a> =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>) {
<a name="l677"><span class="linenum"> 677</span></a>  <span class="comment">            // Get the recent conversations for the specified user.</span>
<a name="l678"><span class="linenum"> 678</span></a>              <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a> = <a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>[<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../../_variables/username.html">$username</a>];
<a name="l679"><span class="linenum"> 679</span></a>              <a class="var it32726" onMouseOver="hilite(32726)" onMouseOut="lolite()" onClick="logVariable('conversations')" href="../../_variables/conversations.html">$conversations</a> = <a class="function" onClick="logFunction('message_get_recent_conversations')" href="../../_functions/message_get_recent_conversations.html" onMouseOver="funcPopup(event,'message_get_recent_conversations')">message_get_recent_conversations</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>);
<a name="l680"><span class="linenum"> 680</span></a>              foreach (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a> as <a class="var it4568" onMouseOver="hilite(4568)" onMouseOut="lolite()" onClick="logVariable('expectation')" href="../../_variables/expectation.html">$expectation</a>) {
<a name="l681"><span class="linenum"> 681</span></a>                  <a class="var it13601" onMouseOver="hilite(13601)" onMouseOut="lolite()" onClick="logVariable('otheruser')" href="../../_variables/otheruser.html">$otheruser</a> = <a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../../_variables/users.html">$users</a>[<a class="var it4568" onMouseOver="hilite(4568)" onMouseOut="lolite()" onClick="logVariable('expectation')" href="../../_variables/expectation.html">$expectation</a>['with']];
<a name="l682"><span class="linenum"> 682</span></a>                  <a class="var it32729" onMouseOver="hilite(32729)" onMouseOut="lolite()" onClick="logVariable('conversation')" href="../../_variables/conversation.html">$conversation</a> = <a class="var it32726" onMouseOver="hilite(32726)" onMouseOut="lolite()" onClick="logVariable('conversations')" href="../../_variables/conversations.html">$conversations</a>[<a class="var it4568" onMouseOver="hilite(4568)" onMouseOut="lolite()" onClick="logVariable('expectation')" href="../../_variables/expectation.html">$expectation</a>['messageposition']];
<a name="l683"><span class="linenum"> 683</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>(<a class="var it13601" onMouseOver="hilite(13601)" onMouseOut="lolite()" onClick="logVariable('otheruser')" href="../../_variables/otheruser.html">$otheruser</a>-&gt;<a onClick="logVariable('id')" class="var it44032" onMouseOver="hilite(44032)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it32729" onMouseOver="hilite(32729)" onMouseOut="lolite()" onClick="logVariable('conversation')" href="../../_variables/conversation.html">$conversation</a>-&gt;<a onClick="logVariable('id')" class="var it44104" onMouseOver="hilite(44104)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l684"><span class="linenum"> 684</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>(<a class="var it4568" onMouseOver="hilite(4568)" onMouseOut="lolite()" onClick="logVariable('expectation')" href="../../_variables/expectation.html">$expectation</a>['subject'], <a class="var it32729" onMouseOver="hilite(32729)" onMouseOut="lolite()" onClick="logVariable('conversation')" href="../../_variables/conversation.html">$conversation</a>-&gt;<a onClick="logVariable('smallmessage')" class="var it44104" onMouseOver="hilite(44104)" onMouseOut="lolite()" href="../../_variables/smallmessage.html">smallmessage</a>);
<a name="l685"><span class="linenum"> 685</span></a>              }
<a name="l686"><span class="linenum"> 686</span></a>          }
<a name="l687"><span class="linenum"> 687</span></a>      }
<a name="l688"><span class="linenum"> 688</span></a>  
<a name="l689"><span class="linenum"> 689</span></a>      <span class="comment">/**</span>
<a name="l690"><span class="linenum"> 690</span></a>  <span class="comment">     * Test message_get_recent_notifications.</span>
<a name="l691"><span class="linenum"> 691</span></a>  <span class="comment">     */</span>
<a name="l692"><span class="linenum"> 692</span></a>      public function <a class="function" onClick="logFunction('test_message_get_recent_notifications')" href="../../_functions/test_message_get_recent_notifications.html" onMouseOver="funcPopup(event,'test_message_get_recent_notifications')">test_message_get_recent_notifications</a>() {
<a name="l693"><span class="linenum"> 693</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>;
<a name="l694"><span class="linenum"> 694</span></a>  
<a name="l695"><span class="linenum"> 695</span></a>  <span class="comment">        // Set this user as the admin.</span>
<a name="l696"><span class="linenum"> 696</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('setAdminUser')" href="../../_functions/setadminuser.html" onMouseOver="funcPopup(event,'setadminuser')">setAdminUser</a>();
<a name="l697"><span class="linenum"> 697</span></a>  
<a name="l698"><span class="linenum"> 698</span></a>  <span class="comment">        // Create a user to send messages from.</span>
<a name="l699"><span class="linenum"> 699</span></a>          <a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test1', 'lastname' =&gt; 'user1'));
<a name="l700"><span class="linenum"> 700</span></a>  
<a name="l701"><span class="linenum"> 701</span></a>  <span class="comment">        // Add two messages - will mark them as notifications later.</span>
<a name="l702"><span class="linenum"> 702</span></a>          <a class="var it30890" onMouseOver="hilite(30890)" onMouseOut="lolite()" onClick="logVariable('m1')" href="../../_variables/m1.html">$m1</a> = <a class="function" onClick="logFunction('message_post_message')" href="../../_functions/message_post_message.html" onMouseOver="funcPopup(event,'message_post_message')">message_post_message</a>(<a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, 'Message 1', <a class="constant" onClick="logConstant('FORMAT_PLAIN')" href="../../_constants/FORMAT_PLAIN.html" onMouseOver="constPopup(event,'FORMAT_PLAIN')">FORMAT_PLAIN</a>);
<a name="l703"><span class="linenum"> 703</span></a>          <a class="var it10445" onMouseOver="hilite(10445)" onMouseOut="lolite()" onClick="logVariable('m2')" href="../../_variables/m2.html">$m2</a> = <a class="function" onClick="logFunction('message_post_message')" href="../../_functions/message_post_message.html" onMouseOver="funcPopup(event,'message_post_message')">message_post_message</a>(<a class="var it685" onMouseOver="hilite(685)" onMouseOut="lolite()" onClick="logVariable('user1')" href="../../_variables/user1.html">$user1</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, 'Message 2', <a class="constant" onClick="logConstant('FORMAT_PLAIN')" href="../../_constants/FORMAT_PLAIN.html" onMouseOver="constPopup(event,'FORMAT_PLAIN')">FORMAT_PLAIN</a>);
<a name="l704"><span class="linenum"> 704</span></a>  
<a name="l705"><span class="linenum"> 705</span></a>  <span class="comment">        // Mark the second message as a notification.</span>
<a name="l706"><span class="linenum"> 706</span></a>          <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('updatemessage')" href="../../_variables/updatemessage.html">$updatemessage</a> = new stdClass();
<a name="l707"><span class="linenum"> 707</span></a>          <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('updatemessage')" href="../../_variables/updatemessage.html">$updatemessage</a>-&gt;<a onClick="logVariable('id')" class="var it44103" onMouseOver="hilite(44103)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it10445" onMouseOver="hilite(10445)" onMouseOut="lolite()" onClick="logVariable('m2')" href="../../_variables/m2.html">$m2</a>;
<a name="l708"><span class="linenum"> 708</span></a>          <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('updatemessage')" href="../../_variables/updatemessage.html">$updatemessage</a>-&gt;<a onClick="logVariable('notification')" class="var it44103" onMouseOver="hilite(44103)" onMouseOut="lolite()" href="../../_variables/notification.html">notification</a> = 1;
<a name="l709"><span class="linenum"> 709</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('message_read', <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('updatemessage')" href="../../_variables/updatemessage.html">$updatemessage</a>);
<a name="l710"><span class="linenum"> 710</span></a>  
<a name="l711"><span class="linenum"> 711</span></a>  <span class="comment">        // Mark the first message as a notification and change the timecreated to 0.</span>
<a name="l712"><span class="linenum"> 712</span></a>          <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('updatemessage')" href="../../_variables/updatemessage.html">$updatemessage</a>-&gt;<a onClick="logVariable('id')" class="var it44103" onMouseOver="hilite(44103)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it30890" onMouseOver="hilite(30890)" onMouseOut="lolite()" onClick="logVariable('m1')" href="../../_variables/m1.html">$m1</a>;
<a name="l713"><span class="linenum"> 713</span></a>          <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('updatemessage')" href="../../_variables/updatemessage.html">$updatemessage</a>-&gt;<a onClick="logVariable('notification')" class="var it44103" onMouseOver="hilite(44103)" onMouseOut="lolite()" href="../../_variables/notification.html">notification</a> = 1;
<a name="l714"><span class="linenum"> 714</span></a>          <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('updatemessage')" href="../../_variables/updatemessage.html">$updatemessage</a>-&gt;<a onClick="logVariable('timecreated')" class="var it44103" onMouseOver="hilite(44103)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a> = 0;
<a name="l715"><span class="linenum"> 715</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('message_read', <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('updatemessage')" href="../../_variables/updatemessage.html">$updatemessage</a>);
<a name="l716"><span class="linenum"> 716</span></a>  
<a name="l717"><span class="linenum"> 717</span></a>          <a class="var it1809" onMouseOver="hilite(1809)" onMouseOut="lolite()" onClick="logVariable('notifications')" href="../../_variables/notifications.html">$notifications</a> = <a class="function" onClick="logFunction('message_get_recent_notifications')" href="../../_functions/message_get_recent_notifications.html" onMouseOver="funcPopup(event,'message_get_recent_notifications')">message_get_recent_notifications</a>(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>);
<a name="l718"><span class="linenum"> 718</span></a>  
<a name="l719"><span class="linenum"> 719</span></a>  <span class="comment">        // Get the messages.</span>
<a name="l720"><span class="linenum"> 720</span></a>          <a class="var it35917" onMouseOver="hilite(35917)" onMouseOut="lolite()" onClick="logVariable('firstmessage')" href="../../_variables/firstmessage.html">$firstmessage</a> = <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it1809" onMouseOver="hilite(1809)" onMouseOut="lolite()" onClick="logVariable('notifications')" href="../../_variables/notifications.html">$notifications</a>);
<a name="l721"><span class="linenum"> 721</span></a>          <a class="var it35918" onMouseOver="hilite(35918)" onMouseOut="lolite()" onClick="logVariable('secondmessage')" href="../../_variables/secondmessage.html">$secondmessage</a> = <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it1809" onMouseOver="hilite(1809)" onMouseOut="lolite()" onClick="logVariable('notifications')" href="../../_variables/notifications.html">$notifications</a>);
<a name="l722"><span class="linenum"> 722</span></a>  
<a name="l723"><span class="linenum"> 723</span></a>  <span class="comment">        // Confirm that we have received the notifications with the maximum timecreated, rather than the max id.</span>
<a name="l724"><span class="linenum"> 724</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>('Message 2', <a class="var it35917" onMouseOver="hilite(35917)" onMouseOut="lolite()" onClick="logVariable('firstmessage')" href="../../_variables/firstmessage.html">$firstmessage</a>-&gt;<a onClick="logVariable('smallmessage')" class="var it44105" onMouseOver="hilite(44105)" onMouseOut="lolite()" href="../../_variables/smallmessage.html">smallmessage</a>);
<a name="l725"><span class="linenum"> 725</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assertEquals')" href="../../_functions/assertequals.html" onMouseOver="funcPopup(event,'assertequals')">assertEquals</a>('Message 1', <a class="var it35918" onMouseOver="hilite(35918)" onMouseOut="lolite()" onClick="logVariable('secondmessage')" href="../../_variables/secondmessage.html">$secondmessage</a>-&gt;<a onClick="logVariable('smallmessage')" class="var it44106" onMouseOver="hilite(44106)" onMouseOut="lolite()" href="../../_variables/smallmessage.html">smallmessage</a>);
<a name="l726"><span class="linenum"> 726</span></a>      }
<a name="l727"><span class="linenum"> 727</span></a>  
<a name="l728"><span class="linenum"> 728</span></a>      <span class="comment">/**</span>
<a name="l729"><span class="linenum"> 729</span></a>  <span class="comment">     * Test that message_can_post_message returns false if the sender does not have the</span>
<a name="l730"><span class="linenum"> 730</span></a>  <span class="comment">     * moode/site:sendmessage capability.</span>
<a name="l731"><span class="linenum"> 731</span></a>  <span class="comment">     */</span>
<a name="l732"><span class="linenum"> 732</span></a>      public function <a class="function" onClick="logFunction('test_message_can_post_message_returns_false_without_capability')" href="../../_functions/test_message_can_post_message_returns_false_without_capability.html" onMouseOver="funcPopup(event,'test_message_can_post_message_returns_false_without_capability')">test_message_can_post_message_returns_false_without_capability</a>() {
<a name="l733"><span class="linenum"> 733</span></a>          <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test1', 'lastname' =&gt; 'User1'));
<a name="l734"><span class="linenum"> 734</span></a>          <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test2', 'lastname' =&gt; 'User2'));
<a name="l735"><span class="linenum"> 735</span></a>          <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_system')" href="../../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>();
<a name="l736"><span class="linenum"> 736</span></a>          <a class="var it788" onMouseOver="hilite(788)" onMouseOut="lolite()" onClick="logVariable('roleid')" href="../../_variables/roleid.html">$roleid</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_role')" href="../../_functions/create_role.html" onMouseOver="funcPopup(event,'create_role')">create_role</a>();
<a name="l737"><span class="linenum"> 737</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('role_assign')" href="../../_functions/role_assign.html" onMouseOver="funcPopup(event,'role_assign')">role_assign</a>(<a class="var it788" onMouseOver="hilite(788)" onMouseOut="lolite()" onClick="logVariable('roleid')" href="../../_variables/roleid.html">$roleid</a>, <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a>-&gt;<a onClick="logVariable('id')" class="var it44107" onMouseOver="hilite(44107)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l738"><span class="linenum"> 738</span></a>  
<a name="l739"><span class="linenum"> 739</span></a>          <a class="function" onClick="logFunction('assign_capability')" href="../../_functions/assign_capability.html" onMouseOver="funcPopup(event,'assign_capability')">assign_capability</a>('moodle/site:sendmessage', <a class="constant" onClick="logConstant('CAP_PROHIBIT')" href="../../_constants/CAP_PROHIBIT.html" onMouseOver="constPopup(event,'CAP_PROHIBIT')">CAP_PROHIBIT</a>, <a class="var it788" onMouseOver="hilite(788)" onMouseOut="lolite()" onClick="logVariable('roleid')" href="../../_variables/roleid.html">$roleid</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l740"><span class="linenum"> 740</span></a>  
<a name="l741"><span class="linenum"> 741</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertFalse(<a class="function" onClick="logFunction('message_can_post_message')" href="../../_functions/message_can_post_message.html" onMouseOver="funcPopup(event,'message_can_post_message')">message_can_post_message</a>(<a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>, <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a>));
<a name="l742"><span class="linenum"> 742</span></a>      }
<a name="l743"><span class="linenum"> 743</span></a>  
<a name="l744"><span class="linenum"> 744</span></a>      <span class="comment">/**</span>
<a name="l745"><span class="linenum"> 745</span></a>  <span class="comment">     * Test that message_can_post_message returns false if the receiver only accepts</span>
<a name="l746"><span class="linenum"> 746</span></a>  <span class="comment">     * messages from contacts and the sender isn't a contact.</span>
<a name="l747"><span class="linenum"> 747</span></a>  <span class="comment">     */</span>
<a name="l748"><span class="linenum"> 748</span></a>      public function <a class="function" onClick="logFunction('test_message_can_post_message_returns_false_non_contact_blocked')" href="../../_functions/test_message_can_post_message_returns_false_non_contact_blocked.html" onMouseOver="funcPopup(event,'test_message_can_post_message_returns_false_non_contact_blocked')">test_message_can_post_message_returns_false_non_contact_blocked</a>() {
<a name="l749"><span class="linenum"> 749</span></a>          <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test1', 'lastname' =&gt; 'User1'));
<a name="l750"><span class="linenum"> 750</span></a>          <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test2', 'lastname' =&gt; 'User2'));
<a name="l751"><span class="linenum"> 751</span></a>  
<a name="l752"><span class="linenum"> 752</span></a>          <a class="function" onClick="logFunction('set_user_preference')" href="../../_functions/set_user_preference.html" onMouseOver="funcPopup(event,'set_user_preference')">set_user_preference</a>('message_blocknoncontacts', true, <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>);
<a name="l753"><span class="linenum"> 753</span></a>  
<a name="l754"><span class="linenum"> 754</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertFalse(<a class="function" onClick="logFunction('message_can_post_message')" href="../../_functions/message_can_post_message.html" onMouseOver="funcPopup(event,'message_can_post_message')">message_can_post_message</a>(<a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>, <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a>));
<a name="l755"><span class="linenum"> 755</span></a>      }
<a name="l756"><span class="linenum"> 756</span></a>  
<a name="l757"><span class="linenum"> 757</span></a>      <span class="comment">/**</span>
<a name="l758"><span class="linenum"> 758</span></a>  <span class="comment">     * Test that message_can_post_message returns false if the receiver has blocked the</span>
<a name="l759"><span class="linenum"> 759</span></a>  <span class="comment">     * sender from messaging them.</span>
<a name="l760"><span class="linenum"> 760</span></a>  <span class="comment">     */</span>
<a name="l761"><span class="linenum"> 761</span></a>      public function <a class="function" onClick="logFunction('test_message_can_post_message_returns_false_if_blocked')" href="../../_functions/test_message_can_post_message_returns_false_if_blocked.html" onMouseOver="funcPopup(event,'test_message_can_post_message_returns_false_if_blocked')">test_message_can_post_message_returns_false_if_blocked</a>() {
<a name="l762"><span class="linenum"> 762</span></a>          <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test1', 'lastname' =&gt; 'User1'));
<a name="l763"><span class="linenum"> 763</span></a>          <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test2', 'lastname' =&gt; 'User2'));
<a name="l764"><span class="linenum"> 764</span></a>  
<a name="l765"><span class="linenum"> 765</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('setUser')" href="../../_functions/setuser.html" onMouseOver="funcPopup(event,'setuser')">setUser</a>(<a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>);
<a name="l766"><span class="linenum"> 766</span></a>          <a class="function" onClick="logFunction('message_block_contact')" href="../../_functions/message_block_contact.html" onMouseOver="funcPopup(event,'message_block_contact')">message_block_contact</a>(<a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a>-&gt;<a onClick="logVariable('id')" class="var it44107" onMouseOver="hilite(44107)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l767"><span class="linenum"> 767</span></a>  
<a name="l768"><span class="linenum"> 768</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertFalse(<a class="function" onClick="logFunction('message_can_post_message')" href="../../_functions/message_can_post_message.html" onMouseOver="funcPopup(event,'message_can_post_message')">message_can_post_message</a>(<a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>, <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a>));
<a name="l769"><span class="linenum"> 769</span></a>      }
<a name="l770"><span class="linenum"> 770</span></a>  
<a name="l771"><span class="linenum"> 771</span></a>      <span class="comment">/**</span>
<a name="l772"><span class="linenum"> 772</span></a>  <span class="comment">     * Test that message_can_post_message returns false if the receiver has blocked the</span>
<a name="l773"><span class="linenum"> 773</span></a>  <span class="comment">     * sender from messaging them.</span>
<a name="l774"><span class="linenum"> 774</span></a>  <span class="comment">     */</span>
<a name="l775"><span class="linenum"> 775</span></a>      public function <a class="function" onClick="logFunction('test_message_can_post_message_returns_true')" href="../../_functions/test_message_can_post_message_returns_true.html" onMouseOver="funcPopup(event,'test_message_can_post_message_returns_true')">test_message_can_post_message_returns_true</a>() {
<a name="l776"><span class="linenum"> 776</span></a>          <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test1', 'lastname' =&gt; 'User1'));
<a name="l777"><span class="linenum"> 777</span></a>          <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test2', 'lastname' =&gt; 'User2'));
<a name="l778"><span class="linenum"> 778</span></a>  
<a name="l779"><span class="linenum"> 779</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertTrue(<a class="function" onClick="logFunction('message_can_post_message')" href="../../_functions/message_can_post_message.html" onMouseOver="funcPopup(event,'message_can_post_message')">message_can_post_message</a>(<a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>, <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a>));
<a name="l780"><span class="linenum"> 780</span></a>      }
<a name="l781"><span class="linenum"> 781</span></a>  
<a name="l782"><span class="linenum"> 782</span></a>      <span class="comment">/**</span>
<a name="l783"><span class="linenum"> 783</span></a>  <span class="comment">     * Test that message_is_user_non_contact_blocked returns false if the recipient allows</span>
<a name="l784"><span class="linenum"> 784</span></a>  <span class="comment">     * messages from non-contacts.</span>
<a name="l785"><span class="linenum"> 785</span></a>  <span class="comment">     */</span>
<a name="l786"><span class="linenum"> 786</span></a>      public function <a class="function" onClick="logFunction('test_message_is_user_non_contact_blocked_false_without_preference')" href="../../_functions/test_message_is_user_non_contact_blocked_false_without_preference.html" onMouseOver="funcPopup(event,'test_message_is_user_non_contact_blocked_false_without_preference')">test_message_is_user_non_contact_blocked_false_without_preference</a>() {
<a name="l787"><span class="linenum"> 787</span></a>          <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test1', 'lastname' =&gt; 'User1'));
<a name="l788"><span class="linenum"> 788</span></a>          <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test2', 'lastname' =&gt; 'User2'));
<a name="l789"><span class="linenum"> 789</span></a>  
<a name="l790"><span class="linenum"> 790</span></a>          <a class="function" onClick="logFunction('set_user_preference')" href="../../_functions/set_user_preference.html" onMouseOver="funcPopup(event,'set_user_preference')">set_user_preference</a>('message_blocknoncontacts', false, <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>);
<a name="l791"><span class="linenum"> 791</span></a>  
<a name="l792"><span class="linenum"> 792</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertFalse(<a class="function" onClick="logFunction('message_is_user_non_contact_blocked')" href="../../_functions/message_is_user_non_contact_blocked.html" onMouseOver="funcPopup(event,'message_is_user_non_contact_blocked')">message_is_user_non_contact_blocked</a>(<a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>, <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a>));
<a name="l793"><span class="linenum"> 793</span></a>      }
<a name="l794"><span class="linenum"> 794</span></a>  
<a name="l795"><span class="linenum"> 795</span></a>      <span class="comment">/**</span>
<a name="l796"><span class="linenum"> 796</span></a>  <span class="comment">     * Test that message_is_user_non_contact_blocked returns true if the recipient doesn't</span>
<a name="l797"><span class="linenum"> 797</span></a>  <span class="comment">     * allow messages from non-contacts and the sender isn't a contact.</span>
<a name="l798"><span class="linenum"> 798</span></a>  <span class="comment">     */</span>
<a name="l799"><span class="linenum"> 799</span></a>      public function <a class="function" onClick="logFunction('test_message_is_user_non_contact_blocked_true_with_preference')" href="../../_functions/test_message_is_user_non_contact_blocked_true_with_preference.html" onMouseOver="funcPopup(event,'test_message_is_user_non_contact_blocked_true_with_preference')">test_message_is_user_non_contact_blocked_true_with_preference</a>() {
<a name="l800"><span class="linenum"> 800</span></a>          <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test1', 'lastname' =&gt; 'User1'));
<a name="l801"><span class="linenum"> 801</span></a>          <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test2', 'lastname' =&gt; 'User2'));
<a name="l802"><span class="linenum"> 802</span></a>  
<a name="l803"><span class="linenum"> 803</span></a>          <a class="function" onClick="logFunction('set_user_preference')" href="../../_functions/set_user_preference.html" onMouseOver="funcPopup(event,'set_user_preference')">set_user_preference</a>('message_blocknoncontacts', true, <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>);
<a name="l804"><span class="linenum"> 804</span></a>  
<a name="l805"><span class="linenum"> 805</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertTrue(<a class="function" onClick="logFunction('message_is_user_non_contact_blocked')" href="../../_functions/message_is_user_non_contact_blocked.html" onMouseOver="funcPopup(event,'message_is_user_non_contact_blocked')">message_is_user_non_contact_blocked</a>(<a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>, <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a>));
<a name="l806"><span class="linenum"> 806</span></a>      }
<a name="l807"><span class="linenum"> 807</span></a>  
<a name="l808"><span class="linenum"> 808</span></a>      <span class="comment">/**</span>
<a name="l809"><span class="linenum"> 809</span></a>  <span class="comment">     * Test that message_is_user_non_contact_blocked returns false if the recipient doesn't</span>
<a name="l810"><span class="linenum"> 810</span></a>  <span class="comment">     * allow messages from non-contacts but the sender is a contact.</span>
<a name="l811"><span class="linenum"> 811</span></a>  <span class="comment">     */</span>
<a name="l812"><span class="linenum"> 812</span></a>      public function <a class="function" onClick="logFunction('test_message_is_user_non_contact_blocked_false_with_if_contact')" href="../../_functions/test_message_is_user_non_contact_blocked_false_with_if_contact.html" onMouseOver="funcPopup(event,'test_message_is_user_non_contact_blocked_false_with_if_contact')">test_message_is_user_non_contact_blocked_false_with_if_contact</a>() {
<a name="l813"><span class="linenum"> 813</span></a>          <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test1', 'lastname' =&gt; 'User1'));
<a name="l814"><span class="linenum"> 814</span></a>          <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test2', 'lastname' =&gt; 'User2'));
<a name="l815"><span class="linenum"> 815</span></a>  
<a name="l816"><span class="linenum"> 816</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('setUser')" href="../../_functions/setuser.html" onMouseOver="funcPopup(event,'setuser')">setUser</a>(<a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>);
<a name="l817"><span class="linenum"> 817</span></a>          <a class="function" onClick="logFunction('set_user_preference')" href="../../_functions/set_user_preference.html" onMouseOver="funcPopup(event,'set_user_preference')">set_user_preference</a>('message_blocknoncontacts', true, <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>);
<a name="l818"><span class="linenum"> 818</span></a>          <a class="function" onClick="logFunction('message_add_contact')" href="../../_functions/message_add_contact.html" onMouseOver="funcPopup(event,'message_add_contact')">message_add_contact</a>(<a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a>-&gt;<a onClick="logVariable('id')" class="var it44107" onMouseOver="hilite(44107)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l819"><span class="linenum"> 819</span></a>  
<a name="l820"><span class="linenum"> 820</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertFalse(<a class="function" onClick="logFunction('message_is_user_non_contact_blocked')" href="../../_functions/message_is_user_non_contact_blocked.html" onMouseOver="funcPopup(event,'message_is_user_non_contact_blocked')">message_is_user_non_contact_blocked</a>(<a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>, <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a>));
<a name="l821"><span class="linenum"> 821</span></a>      }
<a name="l822"><span class="linenum"> 822</span></a>  
<a name="l823"><span class="linenum"> 823</span></a>      <span class="comment">/**</span>
<a name="l824"><span class="linenum"> 824</span></a>  <span class="comment">     * Test that message_is_user_blocked returns false if the sender is not a contact of</span>
<a name="l825"><span class="linenum"> 825</span></a>  <span class="comment">     * the recipient.</span>
<a name="l826"><span class="linenum"> 826</span></a>  <span class="comment">     */</span>
<a name="l827"><span class="linenum"> 827</span></a>      public function <a class="function" onClick="logFunction('test_message_is_user_blocked_false_no_contact')" href="../../_functions/test_message_is_user_blocked_false_no_contact.html" onMouseOver="funcPopup(event,'test_message_is_user_blocked_false_no_contact')">test_message_is_user_blocked_false_no_contact</a>() {
<a name="l828"><span class="linenum"> 828</span></a>          <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test1', 'lastname' =&gt; 'User1'));
<a name="l829"><span class="linenum"> 829</span></a>          <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test2', 'lastname' =&gt; 'User2'));
<a name="l830"><span class="linenum"> 830</span></a>  
<a name="l831"><span class="linenum"> 831</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertFalse(<a class="function" onClick="logFunction('message_is_user_blocked')" href="../../_functions/message_is_user_blocked.html" onMouseOver="funcPopup(event,'message_is_user_blocked')">message_is_user_blocked</a>(<a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>, <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a>));
<a name="l832"><span class="linenum"> 832</span></a>      }
<a name="l833"><span class="linenum"> 833</span></a>  
<a name="l834"><span class="linenum"> 834</span></a>      <span class="comment">/**</span>
<a name="l835"><span class="linenum"> 835</span></a>  <span class="comment">     * Test that message_is_user_blocked returns false if the sender is a contact that is</span>
<a name="l836"><span class="linenum"> 836</span></a>  <span class="comment">     * blocked by the recipient but has the moodle/site:readallmessages capability.</span>
<a name="l837"><span class="linenum"> 837</span></a>  <span class="comment">     */</span>
<a name="l838"><span class="linenum"> 838</span></a>      public function <a class="function" onClick="logFunction('test_message_is_user_blocked_false_if_readallmessages')" href="../../_functions/test_message_is_user_blocked_false_if_readallmessages.html" onMouseOver="funcPopup(event,'test_message_is_user_blocked_false_if_readallmessages')">test_message_is_user_blocked_false_if_readallmessages</a>() {
<a name="l839"><span class="linenum"> 839</span></a>          <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test1', 'lastname' =&gt; 'User1'));
<a name="l840"><span class="linenum"> 840</span></a>          <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test2', 'lastname' =&gt; 'User2'));
<a name="l841"><span class="linenum"> 841</span></a>  
<a name="l842"><span class="linenum"> 842</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('setUser')" href="../../_functions/setuser.html" onMouseOver="funcPopup(event,'setuser')">setUser</a>(<a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>);
<a name="l843"><span class="linenum"> 843</span></a>          <a class="function" onClick="logFunction('message_block_contact')" href="../../_functions/message_block_contact.html" onMouseOver="funcPopup(event,'message_block_contact')">message_block_contact</a>(<a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a>-&gt;<a onClick="logVariable('id')" class="var it44107" onMouseOver="hilite(44107)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l844"><span class="linenum"> 844</span></a>  
<a name="l845"><span class="linenum"> 845</span></a>          <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_system')" href="../../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>();
<a name="l846"><span class="linenum"> 846</span></a>          <a class="var it788" onMouseOver="hilite(788)" onMouseOut="lolite()" onClick="logVariable('roleid')" href="../../_variables/roleid.html">$roleid</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_role')" href="../../_functions/create_role.html" onMouseOver="funcPopup(event,'create_role')">create_role</a>();
<a name="l847"><span class="linenum"> 847</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('role_assign')" href="../../_functions/role_assign.html" onMouseOver="funcPopup(event,'role_assign')">role_assign</a>(<a class="var it788" onMouseOver="hilite(788)" onMouseOut="lolite()" onClick="logVariable('roleid')" href="../../_variables/roleid.html">$roleid</a>, <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a>-&gt;<a onClick="logVariable('id')" class="var it44107" onMouseOver="hilite(44107)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l848"><span class="linenum"> 848</span></a>  
<a name="l849"><span class="linenum"> 849</span></a>          <a class="function" onClick="logFunction('assign_capability')" href="../../_functions/assign_capability.html" onMouseOver="funcPopup(event,'assign_capability')">assign_capability</a>('moodle/site:readallmessages', <a class="constant" onClick="logConstant('CAP_ALLOW')" href="../../_constants/CAP_ALLOW.html" onMouseOver="constPopup(event,'CAP_ALLOW')">CAP_ALLOW</a>, <a class="var it788" onMouseOver="hilite(788)" onMouseOut="lolite()" onClick="logVariable('roleid')" href="../../_variables/roleid.html">$roleid</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l850"><span class="linenum"> 850</span></a>  
<a name="l851"><span class="linenum"> 851</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertFalse(<a class="function" onClick="logFunction('message_is_user_blocked')" href="../../_functions/message_is_user_blocked.html" onMouseOver="funcPopup(event,'message_is_user_blocked')">message_is_user_blocked</a>(<a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>, <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a>));
<a name="l852"><span class="linenum"> 852</span></a>      }
<a name="l853"><span class="linenum"> 853</span></a>  
<a name="l854"><span class="linenum"> 854</span></a>      <span class="comment">/**</span>
<a name="l855"><span class="linenum"> 855</span></a>  <span class="comment">     * Test that message_is_user_blocked returns true if the sender is a contact that is</span>
<a name="l856"><span class="linenum"> 856</span></a>  <span class="comment">     * blocked by the recipient and does not have the moodle/site:readallmessages capability.</span>
<a name="l857"><span class="linenum"> 857</span></a>  <span class="comment">     */</span>
<a name="l858"><span class="linenum"> 858</span></a>      public function <a class="function" onClick="logFunction('test_message_is_user_blocked_true_if_blocked')" href="../../_functions/test_message_is_user_blocked_true_if_blocked.html" onMouseOver="funcPopup(event,'test_message_is_user_blocked_true_if_blocked')">test_message_is_user_blocked_true_if_blocked</a>() {
<a name="l859"><span class="linenum"> 859</span></a>          <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test1', 'lastname' =&gt; 'User1'));
<a name="l860"><span class="linenum"> 860</span></a>          <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_user')" href="../../_functions/create_user.html" onMouseOver="funcPopup(event,'create_user')">create_user</a>(array('firstname' =&gt; 'Test2', 'lastname' =&gt; 'User2'));
<a name="l861"><span class="linenum"> 861</span></a>  
<a name="l862"><span class="linenum"> 862</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('setUser')" href="../../_functions/setuser.html" onMouseOver="funcPopup(event,'setuser')">setUser</a>(<a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>);
<a name="l863"><span class="linenum"> 863</span></a>          <a class="function" onClick="logFunction('message_block_contact')" href="../../_functions/message_block_contact.html" onMouseOver="funcPopup(event,'message_block_contact')">message_block_contact</a>(<a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a>-&gt;<a onClick="logVariable('id')" class="var it44107" onMouseOver="hilite(44107)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l864"><span class="linenum"> 864</span></a>  
<a name="l865"><span class="linenum"> 865</span></a>          <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_system')" href="../../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>();
<a name="l866"><span class="linenum"> 866</span></a>          <a class="var it788" onMouseOver="hilite(788)" onMouseOut="lolite()" onClick="logVariable('roleid')" href="../../_variables/roleid.html">$roleid</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('create_role')" href="../../_functions/create_role.html" onMouseOver="funcPopup(event,'create_role')">create_role</a>();
<a name="l867"><span class="linenum"> 867</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDataGenerator')" href="../../_functions/getdatagenerator.html" onMouseOver="funcPopup(event,'getdatagenerator')">getDataGenerator</a>()-&gt;<a class="function" onClick="logFunction('role_assign')" href="../../_functions/role_assign.html" onMouseOver="funcPopup(event,'role_assign')">role_assign</a>(<a class="var it788" onMouseOver="hilite(788)" onMouseOut="lolite()" onClick="logVariable('roleid')" href="../../_variables/roleid.html">$roleid</a>, <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a>-&gt;<a onClick="logVariable('id')" class="var it44107" onMouseOver="hilite(44107)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l868"><span class="linenum"> 868</span></a>  
<a name="l869"><span class="linenum"> 869</span></a>          <a class="function" onClick="logFunction('assign_capability')" href="../../_functions/assign_capability.html" onMouseOver="funcPopup(event,'assign_capability')">assign_capability</a>('moodle/site:readallmessages', <a class="constant" onClick="logConstant('CAP_PROHIBIT')" href="../../_constants/CAP_PROHIBIT.html" onMouseOver="constPopup(event,'CAP_PROHIBIT')">CAP_PROHIBIT</a>, <a class="var it788" onMouseOver="hilite(788)" onMouseOut="lolite()" onClick="logVariable('roleid')" href="../../_variables/roleid.html">$roleid</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l870"><span class="linenum"> 870</span></a>  
<a name="l871"><span class="linenum"> 871</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;assertTrue(<a class="function" onClick="logFunction('message_is_user_blocked')" href="../../_functions/message_is_user_blocked.html" onMouseOver="funcPopup(event,'message_is_user_blocked')">message_is_user_blocked</a>(<a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../_variables/recipient.html">$recipient</a>, <a class="var it12912" onMouseOver="hilite(12912)" onMouseOut="lolite()" onClick="logVariable('sender')" href="../../_variables/sender.html">$sender</a>));
<a name="l872"><span class="linenum"> 872</span></a>      }
<a name="l873"><span class="linenum"> 873</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'message_is_user_blocked': ['message_is_user_blocked', 'Checks if the recipient has specifically blocked the sending user. ', [['message','lib.php',2946]], 6],
'setup': ['setup', '', [['lib/htmlpurifier/HTMLPurifier/HTMLModule','Target.php',16],['search/tests/generator','lib.php',37],['mod/quiz/tests','repaginate_test.php',71],['lib/tests','statslib_test.php',51],['comment/tests','externallib_test.php',44],['lib/htmlpurifier/HTMLPurifier/HTMLModule','SafeEmbed.php',16],['mod/feedback/tests','events_test.php',59],['search/tests','engine_test.php',40],['question/behaviour/adaptive/tests','mark_display_test.php',47],['mod/wiki/tests','search_test.php',46],['mnet/tests','events_test.php',37],['blocks/comments/tests','events_test.php',43],['mod/workshop/eval/best/tests','lib_test.php',43],['lib/htmlpurifier/HTMLPurifier/HTMLModule','Proprietary.php',17],['message/tests','events_test.php',30],['lib/grade/tests/fixtures','lib.php',52],['mod/glossary/tests','search_test.php',47],['question/behaviour/deferredcbm/tests','behaviourtype_test.php',46],['lib/ddl/tests','ddl_test.php',32],['mod/assign/feedback/editpdf/tests','editpdf_test.php',46],['question/type/gapselect/tests','questiontype_test.php',43],['rating/tests','rating_test.php',42],['webservice/xmlrpc/tests','locallib_test.php',41],['calendar/tests','externallib_test.php',43],['mod/book/tool/importhtml/tests','locallib_test.php',41],['lib/htmlpurifier/HTMLPurifier/HTMLModule','Iframe.php',26],['question/type/tests','question_first_matching_answer_grading_strategy_test.php',61],['question/type/ddimageortext/tests','questiontype_test.php',43],['availability/tests','tree_test.php',38],['mod/choice/tests','events_test.php',50],['lib/htmlpurifier/HTMLPurifier/HTMLModule','Object.php',23],['webservice/tests','events_test.php',38],['mod/lesson/tests','events_test.php',40],['backup/util/plan/tests','step_test.php',39],['mod/book/tool/exportimscp/tests','events_test.php',39],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',71],['question/behaviour/informationitem/tests','behaviourtype_test.php',45],['report/usersessions/tests','lib_test.php',55],['lib/form/tests','dateselector_test.php',50],['admin/tool/recyclebin/tests','events_test.php',38],['lib/tests','blocklib_test.php',42],['course/tests','externallib_test.php',42],['search/tests','document_test.php',46],['report/loglive/tests','events_test.php',38],['question/engine/tests','questionattempt_test.php',50],['report/log/tests','lib_test.php',53],['competency/tests','exporter_test.php',42],['lib/phpunit/classes','database_driver_testcase.php',104],['admin/tool/langimport/tests','events_test.php',36],['question/engine/tests','questionattemptstepiterator_test.php',44],['enrol/tests','role_external_test.php',35],['lib/htmlpurifier/HTMLPurifier','HTMLModuleManager.php',227],['webservice/xmlrpc/tests','xmlrpc_server_test.php',41],['lib/htmlpurifier/HTMLPurifier/HTMLModule','SafeScripting.php',17],['lib/tests','rsslib_test.php',43],['lib/tests','gdlib_test.php',41],['question/type/ddwtos/tests','questiontype_test.php',43],['availability/condition/date/tests','condition_test.php',38],['question/type/essay/tests','questiontype_test.php',42],['lib/tests','collator_test.php',48],['admin/tool/monitor/tests','generator_test.php',39],['question/type/calculatedsimple/tests','questiontype_test.php',51],['backup/util/plan/tests','task_test.php',39],['admin/tool/lp/tests','externallib_test.php',75],['course/tests','search_test.php',46],['lib/tests','csvclass_test.php',39],['lib/phpunit/tests','basic_test.php',40],['lib/tests','externallib_test.php',35],['webservice/tests','lib_test.php',40],['mod/assign/submission/file/tests','locallib_test.php',53],['mod/assign/submission/onlinetext/tests','events_test.php',53],['question/engine/tests','questionattempt_with_steps_test.php',47],['lib/htmlpurifier/HTMLPurifier/HTMLModule','Name.php',13],['search/engine/solr/tests','engine_test.php',71],['message/tests','inbound_test.php',36],['lib/tests','eventslib_test.php',34],['admin/tool/capability/tests','events_test.php',36],['backup/util/dbops/tests','backup_dbops_test.php',40],['lib/tests','questionlib_test.php',45],['cache/tests','config_writer_test.php',44],['lib/tests','coursecatlib_test.php',38],['calendar/tests','lib_test.php',38],['lib/htmlpurifier','locallib.php',178],['backup/util/structure/tests','structure_test.php',56],['lib/htmlpurifier/HTMLPurifier','HTMLModule.php',273],['question/type/match/tests','questiontype_test.php',45],['message/tests','externallib_test.php',35],['mod/workshop/form/numerrors/tests','lib_test.php',43],['webservice/xmlrpc/tests','lib_test.php',41],['badges/tests','badgeslib_test.php',41],['report/questioninstances/tests','events_test.php',36],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',23],['question/type/truefalse/tests','questiontype_test.php',44],['admin/tool/monitor/tests','events_test.php',33],['lib/tests','moodle_page_test.php',40],['mod/folder/tests','events_test.php',30],['competency/tests','persistent_test.php',37],['mod/lti/tests','externallib_test.php',45],['blocks/online_users/tests','online_users_test.php',44],['lib/htmlpurifier/HTMLPurifier/HTMLModule','TargetBlank.php',17],['question/engine/tests','questionattemptiterator_test.php',45],['mod/scorm/tests','events_test.php',50],['message/output/airnotifier/tests','externallib_test.php',42],['mod/scorm/tests','lib_test.php',45],['question/behaviour/immediatecbm/tests','behaviourtype_test.php',45],['admin/tool/monitor/tests','task_check_subscriptions_test.php',36],['lib','tablelib.php',437],['lib/htmlpurifier/HTMLPurifier/HTMLModule','Tables.php',16],['lib/htmlpurifier/HTMLPurifier/HTMLModule','StyleAttribute.php',27],['lib/htmlpurifier/HTMLPurifier/HTMLModule','List.php',30],['mod/folder/tests','search_test.php',46],['lib/htmlpurifier/HTMLPurifier/HTMLModule','Presentation.php',24],['calendar/tests','calendartype_test.php',59],['notes/tests','lib_test.php',53],['admin/tool/cohortroles/tests','api_test.php',49],['question/behaviour/missing/tests','behaviourtype_test.php',45],['lib/htmlpurifier/HTMLPurifier/HTMLModule','Edit.php',18],['report/stats/tests','events_test.php',38],['user/tests','search_test.php',44],['mod/workshop/form/rubric/tests','lib_test.php',42],['mod/assign/submission/file/tests','events_test.php',59],['mod/quiz/tests','external_test.php',77],['admin/tool/recyclebin/tests','course_bin_test.php',46],['question/behaviour/interactive/tests','behaviourtype_test.php',45],['competency/tests','external_test.php',96],['lib/antivirus/clamav/tests','scanner_test.php',31],['question/behaviour/manualgraded/tests','behaviourtype_test.php',45],['report/stats/tests','lib_test.php',51],['calendar/tests','events_test.php',48],['mod/forum/tests','events_test.php',38],['lib/htmlpurifier/HTMLPurifier/HTMLModule','Text.php',32],['tag/tests','taglib_test.php',32],['filter/algebra/tests','filter_test.php',47],['question/type/random/tests','questiontype_test.php',42],['question/type/multianswer/tests','questiontype_test.php',46],['lib/tests','myprofilelib_test.php',54],['mod/workshop/allocation/random/tests','allocator_test.php',42],['lib/tests','notification_test.php',39],['mod/resource/tests','search_test.php',46],['mod/book/tool/print/tests','events_test.php',39],['auth/manual/tests','manual_test.php',47],['mod/survey/tests','events_test.php',36],['mod/forum/tests','lib_test.php',33],['question/behaviour/interactivecountback/tests','behaviourtype_test.php',45],['enrol/imsenterprise/tests','imsenterprise_test.php',47],['badges/tests','external_test.php',45],['mod/forum/tests','mail_test.php',34],['question/type/numerical/tests','questiontype_test.php',50],['admin/tool/monitor/tests','task_clean_events_test.php',35],['enrol/lti/tests','helper_test.php',46],['lib/tests','medialib_test.php',39],['webservice/tests','externallib_test.php',33],['lib/htmlpurifier/HTMLPurifier','Definition.php',41],['filter/glossary','filter.php',43],['mod/book/tests','search_test.php',46],['admin/tool/monitor/tests','subscription_test.php',34],['lib/tests','lock_test.php',39],['lib/htmlpurifier/HTMLPurifier/HTMLModule','Bdo.php',25],['lib/form/tests','duration_test.php',47],['question/behaviour/adaptive/tests','behaviourtype_test.php',45],['question/type/numerical/tests','form_test.php',65],['lib/form/tests','datetimeselector_test.php',50],['question/tests','events_test.php',34],['calendar/tests','ical_test.php',40],['backup/util/checks/tests','checks_test.php',42],['backup/util/plan/tests','plan_test.php',39],['mod/survey/tests','externallib_test.php',45],['availability/condition/grouping/tests','condition_test.php',37],['search/engine/solr/classes','schema.php',104],['mod/book/tests','events_test.php',39],['mod/assign/tests','search_test.php',47],['lib/htmlpurifier/HTMLPurifier/HTMLModule','Legacy.php',29],['lib/tests','event_user_graded_test.php',44],['availability/condition/completion/tests','condition_test.php',40],['mod/wiki/tests','externallib_test.php',45],['lib/htmlpurifier/HTMLPurifier/HTMLModule','Scripting.php',41],['mod/assign','gradingtable.php',1425],['question/engine/tests','helpers.php',704],['question/behaviour/immediatefeedback/tests','behaviourtype_test.php',45],['question/engine/tests','unitofwork_test.php',50],['admin/tool/monitor/tests','eventobservers_test.php',38],['cache/tests','cache_test.php',44],['question/behaviour/deferredfeedback/tests','behaviourtype_test.php',45],['report/log/tests','events_test.php',38],['lib/tests','unoconv_test.php',42],['filter/mathjaxloader','filter.php',97],['lib/markdown','Markdown.php',132],['mod/wiki/tests','events_test.php',44],['lib/dml/tests','recordset_walk_test.php',38],['mod/forum/tests','search_test.php',48],['calendar/tests','rrule_manager_tests.php',30],['lib/tests','filterlib_test.php',45],['lib/htmlpurifier/HTMLPurifier/HTMLModule','Image.php',19],['mod/feedback/tests','upgradelib_test.php',54],['mod/scorm/tests','externallib_test.php',45],['question/type/shortanswer/tests','questiontype_test.php',48],['lib/filestorage/tests','zip_packer_test.php',40],['report/completion/tests','events_test.php',38],['availability/condition/profile/tests','condition_test.php',48],['question/tests','externallib_test.php',45],['mod/forum/tests','generator_test.php',39],['mod/data/tests','search_test.php',93],['message/tests','messagelib_test.php',44],['search/tests','manager_test.php',44],['lib/htmlpurifier/HTMLPurifier/HTMLModule','SafeObject.php',19],['notes/tests','events_test.php',44],['blog/tests','lib_test.php',42],['question/type/description/tests','questiontype_test.php',44],['backup/controller/tests','controller_test.php',41],['mod/glossary/tests','events_test.php',38],['lib','filterlib.php',400],['lib/tests','events_test.php',32],['mod/forum/tests','maildigest_test.php',41],['grade/report/user/tests','lib_test.php',54],['lib/htmlpurifier/HTMLPurifier/HTMLModule','Hypertext.php',17],['lib/tests','ajaxlib_test.php',32],['question/type/multichoice/tests','questiontype_test.php',43],['lib/htmlpurifier/HTMLPurifier/HTMLModule','Nofollow.php',18],['lib/htmlpurifier/HTMLPurifier/HTMLModule','Forms.php',29],['filter/tex/tests','filter_test.php',43],['admin/tool/monitor/tests','rule_manager_test.php',37],['backup/converter/moodle1/tests','moodle1_converter_test.php',41],['mod/assign/tests','base_test.php',85],['mod/resource/tests','events_test.php',36],['question/type/calculated/tests','questiontype_test.php',48],['mod/workshop/tests','locallib_test.php',42],['lib/tests','customcontext_test.php',103],['availability/condition/group/tests','condition_test.php',37],['mod/forum/tests','subscriptions_test.php',32],['cache/tests','administration_helper_test.php',45],['my/tests','events_test.php',40],['mod/assign/tests','lib_test.php',42],['availability/tests','info_test.php',39],['tag/tests','events_test.php',36],['admin/tool/recyclebin/tests','category_bin_test.php',46],['lib/editor/atto/plugins/equation/tests','upgradelib_testcase.php',44],['lib/dml/tests','dml_test.php',30],['question/type/ddmarker/tests','questiontype_test.php',44],['backup/util/factories/tests','factories_test.php',43],['mod/data/tests','events_test.php',32],['mod/workshop/form/accumulative/tests','lib_test.php',41],['lib/htmlpurifier/HTMLPurifier/HTMLModule','Tidy.php',36],['report/outline/tests','lib_test.php',53],['lib/htmlpurifier/HTMLPurifier/HTMLModule','Ruby.php',18],['mod/assign/submission/onlinetext/tests','locallib_test.php',53],['admin/tool/lpmigrate/tests','processor_test.php',42],['mod/forum/tests','externallib_test.php',34],['lib/tests','user_test.php',34],['mod/workshop/tests','events_test.php',49],['lib/markdown','MarkdownExtra.php',99],['mod/assign/tests','externallib_test.php',33],['question/engine/upgrade/tests','helper.php',100],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',14]], 153],
'test_message_remove_contact': ['test_message_remove_contact', 'Test message_remove_contact. ', [['message/tests','messagelib_test.php',260]], 0],
'assertequals': ['assertequals', 'Asserts that two variables are equal. ', [['lib/tests','completionlib_test.php',68]], 12471],
'message_count_messages': ['message_count_messages', 'Count the number of messages with a field having a specified value. if $field is empty then return count of the whole array if $field is non-existent then return 0 ', [['message','lib.php',590]], 3],
'message_search_users': ['message_search_users', 'Search through course users. ', [['message','lib.php',1705]], 7],
'message_get_blocked_users': ['message_get_blocked_users', 'Retrieve users blocked by $user1 ', [['message','lib.php',220]], 5],
'test_message_can_post_message_returns_false_if_blocked': ['test_message_can_post_message_returns_false_if_blocked', 'Test that message_can_post_message returns false if the receiver has blocked the sender from messaging them. ', [['message/tests','messagelib_test.php',757]], 0],
'test_message_can_post_message_returns_false_non_contact_blocked': ['test_message_can_post_message_returns_false_non_contact_blocked', 'Test that message_can_post_message returns false if the receiver only accepts messages from contacts and the sender isn\'t a contact. ', [['message/tests','messagelib_test.php',744]], 0],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required, Some conversions and safety checks are carried out. Lobs are supported. If the return ID isn\'t required, then this just reports success as true/false. $data is an object containing needed data ', [['lib/dml','pdo_moodle_database.php',387],['lib/dml','oci_native_moodle_database.php',1297],['lib/dml','pgsql_native_moodle_database.php',889],['lib/dml','mssql_native_moodle_database.php',962],['lib/dml','mysqli_native_moodle_database.php',1185],['question/engine/upgrade','upgradelib.php',124],['lib/dml','sqlsrv_native_moodle_database.php',1045],['lib/dml/tests','dml_test.php',5548]], 1611],
'message_get_recent_notifications': ['message_get_recent_notifications', 'Get the users recent event notifications ', [['message','lib.php',818]], 2],
'test_message_is_user_blocked_false_if_readallmessages': ['test_message_is_user_blocked_false_if_readallmessages', 'Test that message_is_user_blocked returns false if the sender is a contact that is blocked by the recipient but has the moodle/site:readallmessages capability. ', [['message/tests','messagelib_test.php',834]], 0],
'message_count_unread_messages': ['message_count_unread_messages', 'Returns the count of unread messages for user. Either from a specific user or from all users. ', [['message','lib.php',610]], 8],
'message_block_contact': ['message_block_contact', 'Block a user. ', [['message','lib.php',1139]], 12],
'preventresetbyrollback': ['preventresetbyrollback', 'Call this method from test if you want to make sure that the resetting of database is done the slow way without transaction rollback. ', [['lib/phpunit/classes','advanced_testcase.php',230]], 51],
'message_is_user_non_contact_blocked': ['message_is_user_non_contact_blocked', 'Checks if the recipient is allowing messages from users that aren\'t a contact. If not then it checks to make sure the sender is in the recipient\'s contacts. ', [['message','lib.php',2913]], 7],
'test_message_can_post_message_returns_true': ['test_message_can_post_message_returns_true', 'Test that message_can_post_message returns false if the receiver has blocked the sender from messaging them. ', [['message/tests','messagelib_test.php',771]], 0],
'list': ['list', '', [['mod/data/preset/imagegallery','jstemplate.js',9]], 2229],
'message_post_message': ['message_post_message', 'Send a message from one user to another. Will be delivered according to the message recipients messaging preferences ', [['message','lib.php',2309]], 23],
'test_message_search_users': ['test_message_search_users', 'Test message_search_users. ', [['message/tests','messagelib_test.php',324]], 0],
'redirectmessages': ['redirectmessages', 'Starts message redirection. ', [['lib/phpunit/classes','advanced_testcase.php',446]], 40],
'role_assign': ['role_assign', 'Assigns the specified role to a user in the context. ', [['lib/testing/generator','data_generator.php',936],['lib','accesslib.php',1661]], 269],
'delete_user': ['delete_user', 'Marks user deleted in internal user database and notifies the auth plugin. Also unenrols user from all roles and does other cleanup. ', [['lib','moodlelib.php',3893]], 43],
'message_search': ['message_search', 'Search a user\'s messages ', [['message','lib.php',1798]], 8],
'message_can_post_message': ['message_can_post_message', 'Determines if a user is permitted to send another user a private message. If no sender is provided then it defaults to the logged in user. ', [['message','lib.php',2879]], 5],
'message_remove_contact': ['message_remove_contact', 'remove a contact ', [['message','lib.php',1101]], 4],
'update_record': ['update_record', 'Update a record in a table ', [['lib/dml','pdo_moodle_database.php',461],['lib/dml','oci_native_moodle_database.php',1404],['lib/dml','pgsql_native_moodle_database.php',1089],['lib/dml','mssql_native_moodle_database.php',1067],['lib/dml','mysqli_native_moodle_database.php',1405],['lib/dml','sqlsrv_native_moodle_database.php',1148],['lib/dml/tests','dml_test.php',5551]], 650],
'message_get_recent_conversations_provider': ['message_get_recent_conversations_provider', 'The data provider for message_get_recent_conversations. ', [['message/tests','messagelib_test.php',378]], 0],
'message_get_contact': ['message_get_contact', 'Load a user\'s contact record ', [['message','lib.php',1229]], 5],
'message_get_recent_conversations': ['message_get_recent_conversations', 'Get the users recent conversations meaning all the people they\'ve recently sent or received a message from plus the most recent message sent to or received from each other user ', [['message','lib.php',712]], 2],
'message_add_contact': ['message_add_contact', 'Add the selected user as a contact for the current user ', [['message','lib.php',1024]], 25],
'test_message_is_user_blocked_true_if_blocked': ['test_message_is_user_blocked_true_if_blocked', 'Test that message_is_user_blocked returns true if the sender is a contact that is blocked by the recipient and does not have the moodle/site:readallmessages capability. ', [['message/tests','messagelib_test.php',854]], 0],
'message_unblock_contact': ['message_unblock_contact', 'Unblock a contact. Note that this reverts the previously blocked user back to a non-contact. ', [['message','lib.php',1129]], 5],
'resetaftertest': ['resetaftertest', 'Reset everything after current test. ', [['lib/phpunit/classes','advanced_testcase.php',246]], 1528],
'get_support_user': ['get_support_user', 'Return support user record, this is currently used in messaging system only for sending messages to support email. $CFG->supportuserid is set then returns user record $CFG->supportemail is set then return dummy record with $CFG->supportemail else return admin user record with hard-coded $user->emailstop = 0, so user gets support message. ', [['lib/classes','user.php',166]], 21],
'test_message_count_blocked_users': ['test_message_count_blocked_users', 'Test message_count_blocked_users. ', [['message/tests','messagelib_test.php',215]], 0],
'test_message_is_user_non_contact_blocked_true_with_preference': ['test_message_is_user_non_contact_blocked_true_with_preference', 'Test that message_is_user_non_contact_blocked returns true if the recipient doesn\'t allow messages from non-contacts and the sender isn\'t a contact. ', [['message/tests','messagelib_test.php',795]], 0],
'setadminuser': ['setadminuser', 'Set current $USER to admin account, reset access cache. ', [['lib/phpunit/classes','advanced_testcase.php',539]], 597],
'send_fake_message': ['send_fake_message', 'Send a fake message. ', [['message/tests','messagelib_test.php',55]], 10],
'test_message_get_recent_notifications': ['test_message_get_recent_notifications', 'Test message_get_recent_notifications. ', [['message/tests','messagelib_test.php',689]], 0],
'set_user_preference': ['set_user_preference', 'Sets a preference for the specified user. ', [['lib','moodlelib.php',1827]], 172],
'test_message_can_post_message_returns_false_without_capability': ['test_message_can_post_message_returns_false_without_capability', 'Test that message_can_post_message returns false if the sender does not have the moode/site:sendmessage capability. ', [['message/tests','messagelib_test.php',728]], 0],
'getdatagenerator': ['getdatagenerator', 'Get data generator ', [['lib/phpunit/classes','advanced_testcase.php',570]], 4450],
'test_message_block_contact': ['test_message_block_contact', 'Test message_block_contact. ', [['message/tests','messagelib_test.php',279]], 0],
'instance': ['instance', 'Returns an instance of the cache_factor method. ', [['cache','disabledlib.php',171],['cache','disabledlib.php',296],['lib/classes','useragent.php',101],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',80],['lib/htmlpurifier/HTMLPurifier','URISchemeRegistry.php',9],['search/classes','manager.php',109],['cache','locallib.php',52],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',53],['lib/classes','plugin_manager.php',103],['lib/htmlpurifier','HTMLPurifier.php',251],['course/format','lib.php',156],['lib/classes/update','checker.php',62],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',31],['admin/tool/installaddon/classes','installer.php',40],['lib','modinfolib.php',373],['cache/classes','helper.php',76],['lib/tests','string_manager_standard_test.php',124],['lib/portfolio','exporter.php',251],['lib/classes/update','validator.php',88],['search/classes','document_factory.php',49],['lib','accesslib.php',6235],['lib','accesslib.php',6487],['lib','accesslib.php',6665],['lib','accesslib.php',6919],['lib','accesslib.php',7180],['lib','accesslib.php',7392],['backup/cc/cc_lib','cc_utils.php',387],['backup/cc/cc_lib','cc_utils.php',443],['lib','filterlib.php',80],['search/tests/fixtures','testable_core_search.php',43],['lib/tests/fixtures','testable_update_checker.php',45],['backup/cc','validator.php',35],['cache/classes','config.php',87],['cache/classes','factory.php',114],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',29]], 4647],
'assertnotempty': ['assertnotempty', '', [['lib/htmlpurifier/HTMLPurifier/ConfigSchema','ValidatorAtom.php',98]], 402],
'get_messages': ['get_messages', 'Returns all redirected messages. ', [['lib/phpunit/classes','phpmailer_sink.php',60],['mod/lesson','locallib.php',1270],['message','externallib.php',638],['lib/classes/update','validator.php',152],['lib/phpunit/classes','message_sink.php',58]], 112],
'create_user': ['create_user', 'Create a test user ', [['lib/testing/generator','data_generator.php',137]], 1376],
'test_message_is_user_non_contact_blocked_false_without_preference': ['test_message_is_user_non_contact_blocked_false_without_preference', 'Test that message_is_user_non_contact_blocked returns false if the recipient allows messages from non-contacts. ', [['message/tests','messagelib_test.php',782]], 0],
'test_message_get_recent_conversations': ['test_message_get_recent_conversations', 'Test message_get_recent_conversations with a mixture of messages. ', [['message/tests','messagelib_test.php',622]], 0],
'create_role': ['create_role', 'Creates a new role in the system. ', [['lib/testing/generator','data_generator.php',726],['lib','accesslib.php',1453]], 100],
'test_message_count_unread_messages': ['test_message_count_unread_messages', 'Test message_count_unread_messages. ', [['message/tests','messagelib_test.php',196]], 0],
'test_message_unblock_contact': ['test_message_unblock_contact', 'Test message_unblock_contact. ', [['message/tests','messagelib_test.php',302]], 0],
'reset_internal_users': ['reset_internal_users', 'Reset self::$noreplyuser and self::$supportuser. This is only used by phpunit, and there is no other use case for this function. Please don\'t use it outside phpunit. ', [['lib/classes','user.php',211]], 7],
'test_message_count_messages': ['test_message_count_messages', 'Test message_count_messages. ', [['message/tests','messagelib_test.php',172]], 0],
'test_message_search': ['test_message_search', 'Test message_search. ', [['message/tests','messagelib_test.php',345]], 0],
'assign_capability': ['assign_capability', '', [['lib/tests','coursecatlib_test.php',66],['lib','accesslib.php',1538]], 303],
'test_message_get_blocked_users': ['test_message_get_blocked_users', 'Test message_get_blocked_users. ', [['message/tests','messagelib_test.php',81]], 0],
'test_message_add_contact': ['test_message_add_contact', 'Test message_add_contact. ', [['message/tests','messagelib_test.php',237]], 0],
'message_count_blocked_users': ['message_count_blocked_users', 'Count the number of users blocked by $user1 ', [['message','lib.php',633]], 12],
'get_noreply_user': ['get_noreply_user', 'Return noreply user record, this is currently used in messaging system only for sending messages from noreply email. It will return record of $CFG->noreplyuserid if set else return dummy user object with hard-coded $user->emailstop = 1 so noreply can be sent to user. ', [['lib/classes','user.php',137]], 34],
'setuser': ['setuser', '', [['lib/google/src/Google/Service','Replicapool.php',1091],['lib/google/src/Google/Service','Computeaccounts.php',1294],['lib/google/src/Google/Service','Appengine.php',1341],['lib/google/src/Google/Service','DeploymentManager.php',1530],['lib/google/src/Google/Service','CloudUserAccounts.php',1733],['lib/google/src/Google/Service','Replicapoolupdater.php',852],['lib/google/src/Google/Service','Replicapoolupdater.php',1194],['lib/google/src/Google/Service','Autoscaler.php',1005],['lib/google/src/Google/Service','Appsactivity.php',273],['lib/google/src/Google/Service','Appsactivity.php',420],['lib/google/src/Google/Service','Drive.php',2824],['lib/phpunit/classes','advanced_testcase.php',511],['lib/google/src/Google/Service','AndroidEnterprise.php',2240],['lib/google/src/Google/Service','AndroidEnterprise.php',2634],['lib/google/src/Google/Service','AndroidEnterprise.php',3101],['lib/google/src/Google/Service','Resourceviews.php',820],['lib/google/src/Google/Service','SQLAdmin.php',2990],['lib/google/src/Google/Service','Compute.php',14264]], 1070],
'test_message_is_user_non_contact_blocked_false_with_if_contact': ['test_message_is_user_non_contact_blocked_false_with_if_contact', 'Test that message_is_user_non_contact_blocked returns false if the recipient doesn\'t allow messages from non-contacts but the sender is a contact. ', [['message/tests','messagelib_test.php',808]], 0],
'message_get_contacts': ['message_get_contacts', 'Retrieve $user1\'s contacts (online, offline and strangers) ', [['message','lib.php',301]], 7],
'test_message_get_contacts': ['test_message_get_contacts', 'Test message_get_contacts. ', [['message/tests','messagelib_test.php',107]], 0],
'test_message_is_user_blocked_false_no_contact': ['test_message_is_user_blocked_false_no_contact', 'Test that message_is_user_blocked returns false if the sender is not a contact of the recipient. ', [['message/tests','messagelib_test.php',823]], 0],
'defined': ['defined', '', [], 4731],
'time': ['time', '', [], 1959],
'array_shift': ['array_shift', '', [], 700]};
CLASS_DATA={
'core_message_messagelib_testcase': ['core_message_messagelib_testcase', 'Test api\'s in message lib. ', [['message/tests','messagelib_test.php',31]], 0],
'core_user': ['core_user', 'User class to access user details. ', [['lib/classes','user.php',27]], 457],
'context_system': ['context_system', 'System context class ', [['lib','accesslib.php',6157]], 1147]};
CONST_DATA={
'FORMAT_PLAIN': ['FORMAT_PLAIN', '', [['lib','weblib.php',52]], 152],
'CAP_PROHIBIT': ['CAP_PROHIBIT', '', [['lib','accesslib.php',139]], 130],
'SITEID': ['SITEID', '', [['admin/cli','install.php',219],['lib/db','install.php',87],['','install.php',242],['lib','setup.php',755]], 608],
'CAP_ALLOW': ['CAP_ALLOW', '', [['lib','accesslib.php',135]], 1484],
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',140],['','install.php',93],['lib','setup.php',391]], 4153]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Aug 11 10:00:09 2016</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
